<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòé üëÉüèæ üï∫üèæ Conteneurs et fen√™tres. De Hello World √† Kubernetes. Premi√®re partie, introduction üëåüèº üòã üïì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque je parle avec des ing√©nieurs Linux et que je leur parle des probl√®mes du cluster Kubernetes sous Windows, ils me regardent avec m√©fiance. Cert...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conteneurs et fen√™tres. De Hello World √† Kubernetes. Premi√®re partie, introduction</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465057/"><img src="https://habrastorage.org/webt/bc/07/6v/bc076v0wh43xbyd-26odfwkr_lq.jpeg"><br><br>  Lorsque je parle avec des ing√©nieurs Linux et que je leur parle des probl√®mes du cluster Kubernetes sous Windows, ils me regardent avec m√©fiance.  Certains ne croient m√™me pas que <s>ce soit l√©gitime</s> .  Les conteneurs sur Windows ne sont pas aussi courants et demand√©s que sur Linux.  Mais je pense que cela vaut la peine de parler de ce sujet, ne serait-ce que pour comprendre le concept g√©n√©ral et les principales diff√©rences entre les conteneurs Windows et Linux.  La premi√®re entr√©e, je vais parcourir la toile avec un pinceau large, puis, dans les articles suivants, j'essaierai de me plonger progressivement dans les nuances. <br><a name="habracut"></a><br><h4>  Conteneurs Windows </h4><br>  Selon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article:</a> <br><blockquote>  De nombreux d√©veloppeurs .NET ou SQL Server se mordent les coudes et envient leurs coll√®gues Linux. </blockquote><br>  En effet, les conteneurs sur Windows √©taient exotiques jusqu'√† r√©cemment.  Et le pire, c'est que la documentation devait √™tre collect√©e en morceaux, sur chaque ressource, qu'il s'agisse du site officiel de Docker ou de Microsoft, tout √©tait pr√©sent√© sous forme de pr√©sentation sans description de ¬´comment et pourquoi¬ª, et apr√®s un mois ou deux, les informations existantes devenaient obsol√®tes.  Et il n'y a rien de surnaturel √† cela - les conteneurs et les technologies qui leur sont associ√©s se d√©veloppent √† une vitesse irr√©aliste. <br><br>  Pour le moment, tout va mieux avec la documentation et pour plonger dans le monde des conteneurs pour Windows, il suffit de lire la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle de Microsoft</a> et de suivre ses changements.  Fait int√©ressant, la documentation est bien √©crite et en russe, bien qu'avec une √©tude approfondie, vous ne pouvez pas √©viter de cliquer sur des liens vers diverses ressources comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.docker.com/</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://kubernetes.io/</a> o√π tout est √©crit √† l'ancienne bon anglais. <br><br>  Maintenant, les r√©ponses √† toutes les questions peuvent √™tre trouv√©es dans la documentation officielle, mais certaines nuances sont mieux connues √† l'avance.  Cela vous sera peut-√™tre utile et vous fera gagner du temps lorsque vous serez plong√© dans la technologie des conteneurs sous le drapeau Microsoft. <br><br><h3>  Vous ne pouvez pas ex√©cuter de conteneurs Windows sur Linux et sur Windows * </h3><br>  La technologie des conteneurs facilite la gestion de l'environnement gr√¢ce aux images d'application reconfigur√©es.  C'est comme un Apple Appstore ou Google Play, mais uniquement pour les ing√©nieurs et les d√©veloppeurs.  Comme dans les magasins d'applications mobiles, vous ne pouvez pas mettre l'application depuis Google Play sur iOS.  Ainsi, sur l'h√¥te Docker avec le syst√®me d'exploitation Linux, vous ne pouvez pas d√©marrer le conteneur avec le syst√®me d'exploitation Windows.  L'inverse est √©galement vrai, mais avec quelques ¬´mais¬ª, car l'h√¥te Docker avec Windows peut toujours fournir √† Linux un environnement pour ex√©cuter des conteneurs. <br><br>  En outre, vous ne pouvez pas d√©marrer un conteneur Windows dans un environnement Windows sans vous assurer que les versions du syst√®me d'exploitation sont compatibles.  Lorsque vous travaillez avec des conteneurs de Microsoft, vous devrez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">revoir la compatibilit√© des versions de conteneurs Windows</a> et ouvrir r√©guli√®rement ce document. <br><br>  En parlant de versioning - Microsoft avec l'av√®nement des conteneurs a d√©cid√© de publier de nouvelles versions semi-annuelles de Windows semi-annuelles.  Il s'agit de versions telles que Windows Server 1703, 1709, 1803, 1809, 1903. Les chiffres indiquent l'ann√©e et le mois de publication et ils sont pris en charge pendant 18 mois.  Les deux premiers sont d√©j√† en paix et sont en fin de service.  De plus, il existe des versions LTS telles que Windows Server 2016 et Windows Server 2019. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Liste des versions.</a> <br><br>  Donc, si vous avez collect√© le conteneur sur un h√¥te avec une version de Windows 1803, vous ne pouvez ex√©cuter ce conteneur que sur des h√¥tes avec Windows 1803. En cons√©quence, afin de ne pas reconstruire le conteneur lui-m√™me √† chaque fois, vous devrez utiliser la version LTS de Windows, qui avec des vitesses de d√©veloppement de technologie moderne pas toujours justifi√©.  Ou, n√©anmoins, pensez au versionnage et r√©assemblez toujours les conteneurs en suivant le programme √©tape par √©tape du semestre. <br><br>  La derni√®re balise dans les conteneurs Dokerfile pour Windows n'est pas toujours pr√©sente et g√©n√©ralement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©conseill√©e</a> .  Dans le bon sens, vous devez toujours savoir quelle est votre version de Windows et apporter les modifications appropri√©es au Dockerfile. <br><blockquote>  Les conteneurs font partie de l'approche Infrastructure as Code.  Il est n√©cessaire de r√©assembler les conteneurs en permanence, ce n'est pas seulement simple et amusant, mais c'est la magie principale, qui permet aux applications de toujours travailler sur des logiciels frais et am√©lior√©s.  Mais dans notre cas, nous sommes confront√©s √† une limitation: cela ne fonctionnera pas de conserver un Dockerfile universel pour tous les syst√®mes Windows.  Il faut en tenir compte. </blockquote><br>  Tout ce qui pr√©c√®de est vrai pour les conteneurs fonctionnant en mode d'isolation de processus.  En mode d'isolation Hyper-V, la compatibilit√© descendante s'applique - vous pouvez ex√©cuter tous les conteneurs qui sont construits sur les versions actuelle et pr√©c√©dente.  En g√©n√©ral, en utilisant l'isolation Hyper-V, vous pouvez √©galement ex√©cuter des conteneurs Linux sur un h√¥te Windows.  Mais ce mode prend en charge jusqu'√† pr√©sent moins de goodies, ce qui est juste le manque de Kubernetes. <br><br>  La diff√©rence entre l'isolement de processus et l'isolement Hyper-V fait l'objet d'un article s√©par√©.  Pour l'instant, je dirai simplement que les sc√©narios avec l'isolement Hyper-V ne sont pas compl√®tement √©vidents pour moi, et par d√©faut, Windows utilise l'isolement des processus. <br><br>  Un autre casse-t√™te consiste √† trouver la version correcte des images sur le Docker Hub.  Certaines images sont g√©n√©ralement manquantes pour Windows.  Par exemple, vous ne trouverez pas la version officielle de Nginx, MySQL, Nodejs, ainsi que des centaines d'autres applications pour Windows et vous devrez collecter les conteneurs vous-m√™me ou utiliser des conteneurs collect√©s et fournis par les membres de la communaut√©. <br><br>  <b>Windows co√ªte de l'argent.</b> <br><br>  N'oubliez pas que Windows est toujours payant.  Par exemple, les versions semestrielles sont disponibles via un abonnement Visual Studio ou avec la Software Assurance dans le contrat de licence Microsoft existant.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien</a> <br><br>  Mais Microsoft dispose d'un grand nombre de fa√ßons de se faire payer gratuitement.  Il s'agit du programme BizSpark et de toutes sortes de versions d'essai de Windows Server 2019 pendant 180 jours et ainsi de suite. <br><br>  <b>Les conteneurs Windows ne sont pas l√©gers.</b> <br><br>  Il est g√©n√©ralement admis que les conteneurs sont l√©gers, mais que la v√©rit√© pour Linux n'est pas toujours vraie pour Windows.  La grande majorit√© des conteneurs Windows, √† premi√®re vue, p√®sent beaucoup trop cher.  Et au deuxi√®me coup d'≈ìil, l'impression ne change pas.  Par exemple, une image aspnet de base: 4,8 p√®se environ 7,5 Go. <br><br><img src="https://habrastorage.org/webt/2t/zr/s3/2tzrs3pzqh4hbugsl42sp427mne.png"><br><br>  M√™me si vous h√©bergez les images de base dans un r√©f√©rentiel local, le t√©l√©chargement initial de l'image sur l'h√¥te prendra un certain temps, sans parler des r√©f√©rentiels distants tels que le Docker Hub. <br><br>  Oui, vous pouvez utiliser le serveur Windows Nano l√©ger dans certains sc√©narios, mais h√©las, il a un tas de limitations.  Et plus encore, vous n'√™tes pas sur le chemin avec Windows Nano Server si vous d√©veloppez pour le .Net Framework. <br><br>  <b>Pour g√©rer, vous devez bien conna√Ætre CMD et Powershell.</b> <br><br>  Vous devrez tr√®s probablement travailler avec la version principale de Windows Server sur les h√¥tes Docker.  Windows Server poss√®de une multitude de capacit√©s de gestion √† distance.  L'approche g√©n√©rale est qu'ayant un serveur Windows avec une interface graphique, vous pouvez connecter tous les composants logiciels enfichables graphiques √† n'importe quel serveur principal. <br><br>  Cette approche ne fonctionne pas dans les sc√©narios de conteneur, bien que le conteneur contienne une version compl√®te de Windows Server.  √Ä l'int√©rieur d'un conteneur Windows, il est th√©oriquement possible de se connecter via WMI, mais ce n'est pas si simple, ne serait-ce que parce que le syst√®me d'exploitation h√¥te va intercepter ce trafic pour lui-m√™me.  Il peut y avoir plusieurs dizaines et centaines de conteneurs sur un h√¥te, et dans ce cas, diriger le trafic vers le bon conteneur est tout. <br><br>  CMD et Powershell seront n√©cessaires √† la fois pour l'administration des conteneurs et pour l'h√¥te sur lequel Docker est install√©.  De plus, la connaissance de ces shells est n√©cessaire pour √©crire un Dockerfile, car toutes les instructions RUN seront ex√©cut√©es dans les shells susmentionn√©s. <br><br>  Se souvenir de toutes les longues applets de commande Powershell est assez d√©licat.  Ce ne sont pas des commandes bash concises pour vous.  Bien que maintenant la plupart des applets de commande aient des alias clairs pour tout ing√©nieur Linux.  Dans PowerShell, vous pouvez utiliser: <br><br><pre><code class="plaintext hljs">rm  Remove-Item pwd  Get-Location. cat  Get-Content touch  New-Item etc. #     Linux    .  rm ‚Äìrf  . #   Powershell   man      Get-Help &lt;&gt;</code> </pre> <br>  Parmi les choses extr√™mement utiles, c'est qu'en utilisant Powershell, vous pouvez ex√©cuter un simple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">serveur Web</a> dans un conteneur √† des fins de test.  Dans Powershell, tout appara√Æt comme des objets.  Si vous √™tes un partisan de la POO, vous appr√©cierez rapidement les avantages de cette coque. <br><br>  Pour conclure l'article introductif, je tiens √† dire que je n'ai d√©lib√©r√©ment pas abord√© la question de l'orchestration et de la gestion des clusters.  Docker sous Windows rattrape son retard et les applications d'orchestration telles que Swarm et Kubernetes sous Windows ne r√©alisent pas pleinement leur fonctionnalit√©. <br><br>  Pour le moment √©galement, si vous souhaitez augmenter le cluster Docker, il sera probablement multi-plateforme.  Autrement dit, vous devrez avoir un ou plusieurs h√¥tes Linux dans le cluster.  Par exemple, pour Kubernetes, les n≈ìuds ma√Ætres doivent √™tre sous Linux.  Et dans Swarm, les conteneurs Linux sont n√©cessaires, par exemple, pour impl√©menter un √©quilibreur sur Nginx ou ex√©cuter d'autres applications de cluster populaires qui ne sont disponibles que pour Linux. <br><br>  PS L'utilisation de Windows dans des conteneurs a un ensemble tr√®s limit√© de scripts √† utiliser.  Cependant, ces sc√©narios peuvent √™tre extr√™mement productifs.  Bien s√ªr, la premi√®re chose qui me vient √† l'esprit est les applications Web IIS, mais mon exp√©rience montre que les services autonomes Windows et certains services tels que MSMQ sont bien isol√©s dans des conteneurs. <br><br>  UPD  Il y a une l√©g√®re inexactitude dans l'article; vous pouvez cr√©er un cluster Docker uniquement sur les h√¥tes Windows.  De plus, ce n'est pas seulement Swarm, mais aussi un produit d√©velopp√© par Micrisoft pour orchestrer le cluster Service Fabric <br><br>  UPD2.  Les conteneurs Docker pour Windows 10 ne sont disponibles qu'en mode d'isolation Hyper-V et utilisent des images de base autres que Windows Server. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465057/">https://habr.com/ru/post/fr465057/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465041/index.html">Comment effectuer une transaction BTC sans d√©poser de petites pi√®ces</a></li>
<li><a href="../fr465045/index.html">Kali Linux NetHunter sur Android: pourquoi et comment installer</a></li>
<li><a href="../fr465047/index.html">Tests unitaires dans SGBD - comment nous le faisons dans Sportmaster, deuxi√®me partie</a></li>
<li><a href="../fr465049/index.html">10 livres sur la gestion de projet Agile √† emporter avec vous en 2020</a></li>
<li><a href="../fr465055/index.html">Six comp√©tences pour faire passer votre carri√®re en Data Science au niveau sup√©rieur.</a></li>
<li><a href="../fr465059/index.html">PoE √† une distance de plus de 200 m√®tres. Surveillance et red√©marrage automatique des clients PoE</a></li>
<li><a href="../fr465061/index.html">Pourquoi au lieu d'une semaine de travail de quatre jours, il vaut mieux penser √† une journ√©e de travail de six heures</a></li>
<li><a href="../fr465063/index.html">Les 10 erreurs les plus courantes lors de l'utilisation de la plate-forme Spring. 2e partie</a></li>
<li><a href="../fr465069/index.html">Nouveau dans Hadoop: d√©couvrez les diff√©rents formats de fichiers dans Hadoop</a></li>
<li><a href="../fr465071/index.html">TechTrain 2019 IT festival: comment JUG.ru, JUGNsk et JUG.MSK y ont particip√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>