<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯд▓ЁЯП╛ ЁЯПй тШЭЁЯП╗ рдШрд┐рдбреНрд░рд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рдзрд╛рд░рдг рджрд░рд╛рд░ рдХреЛ рддреЛрдбрд╝рдирд╛ - рднрд╛рдЧ 2 ЁЯХ░я╕П ЁЯд╛ЁЯП╗ ЁЯд▒ЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд▓реЗрдЦ рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ , Ghidra рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдордиреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреНрд░реИрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо (рдЬрд┐рд╕реЗ рд╣рдордиреЗ crackmes.one рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рд╣реИ) рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдШрд┐рдбреНрд░рд╛ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рдзрд╛рд░рдг рджрд░рд╛рд░ рдХреЛ рддреЛрдбрд╝рдирд╛ - рднрд╛рдЧ 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447488/">  рд▓реЗрдЦ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ</a> , Ghidra рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдордиреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреНрд░реИрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо (рдЬрд┐рд╕реЗ рд╣рдордиреЗ crackmes.one рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рд╣реИ) рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ред  рд╣рдореЗрдВ рд╕рдордЭ рдореЗрдВ рдЖрдпрд╛ рдХрд┐ рдбрд┐рдХрдореНрдкрд╛рдЗрд▓рд░ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ "рдЕрдпреЛрдЧреНрдп" рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рдмрджрд▓рд╛ рдЬрд╛рдП, рдФрд░ "рдЯреЙрдк рд▓реЗрд╡рд▓" рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рднреА рд╕рдордЭрд╛, рдЕрд░реНрдерд╛рддред  рдЬреЛ <b>рдореБрдЦреНрдп ()</b> рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдЗрд╕ рднрд╛рдЧ рдореЗрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдерд╛, рд╣рдо <strong>_construct_key ()</strong> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдХрд┐ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рд╛, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рдбреЗрдЯрд╛ рдкрдврд╝рдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред <br><a name="habracut"></a><br><h2>  рдЪрд░рдг 5 - _construct_key () рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЕрд╡рд▓реЛрдХрди </h2><br>  рдЖрдЗрдП рдЗрд╕ рд╕рдорд╛рд░реЛрд╣ рдХреА рдкреВрд░реА рд╕реВрдЪреА рдХреЛ рддреБрд░рдВрдд рджреЗрдЦреЗрдВ: <br><br><div class="spoiler">  <b class="spoiler_title">рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ _construct_key ()</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ** __cdecl _construct_key(FILE *param_1) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iVar1; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> sVar2; uint uVar3; uint local_3c; byte local_36; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> local_35; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> local_34; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *local_30 [<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *local_20; undefined4 local_19; undefined local_15; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **local_14; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> local_10; local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)__prepare_key(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_14 == (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { local_19 = <span class="hljs-number"><span class="hljs-number">0</span></span>; local_15 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_19,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,param_1); iVar1 = _text((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)&amp;local_19,*(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iVar1 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { _text(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); _text(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) == <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp;&amp; (*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">5</span></span>)) { local_30[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *local_14; local_30[<span class="hljs-number"><span class="hljs-number">1</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>; local_30[<span class="hljs-number"><span class="hljs-number">2</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x218</span></span>; local_30[<span class="hljs-number"><span class="hljs-number">3</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x324</span></span>; local_20 = *local_14 + <span class="hljs-number"><span class="hljs-number">0x430</span></span>; local_10 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (local_10 &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { local_35 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_35,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*local_30[local_10] != local_35) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } local_36 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_36,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_36 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } *(uint *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = (uint)local_36; _text(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,*(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>),param_1); sVar2 = _text(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sVar2 != *(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>)) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } local_3c = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_3c,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); local_3c = local_3c + <span class="hljs-number"><span class="hljs-number">7</span></span>; uVar3 = _text(param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_3c &lt; uVar3) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } *(uint *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x108</span></span>) = local_3c; _text(param_1,local_3c,<span class="hljs-number"><span class="hljs-number">0</span></span>); local_10 = local_10 + <span class="hljs-number"><span class="hljs-number">1</span></span>; } local_34 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_34,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *)(*local_14 + <span class="hljs-number"><span class="hljs-number">0x53c</span></span>) == local_34) { _text(<span class="hljs-string"><span class="hljs-string">"Markers seem to still exist"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> local_14; }</code> </pre> <br></div></div><br>  рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╣рдо <strong>рдореБрдЦреНрдп () рдХреЗ</strong> рд╕рд╛рде рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдХрд░реЗрдВрдЧреЗ - рдПрдХ рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП рд╣рдо "veiled" рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдкрд░ рдЬрд╛рдПрдВрдЧреЗред  рдЬреИрд╕рд╛ рдХрд┐ рдЕрдкреЗрдХреНрд╖рд┐рдд рдерд╛, рдпреЗ рд╕рднреА рдХрд╛рд░реНрдп рдорд╛рдирдХ рд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рд╕реЗ рд╣реИрдВред рдореИрдВ рдлрд┐рд░ рд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдирд╛рдо рдмрджрд▓рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд░реНрдгрди рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ - рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рд▓реЗрдЦ рдХреЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдкрд░ рд╡рд╛рдкрд╕ рд▓реМрдЯреЗрдВред  рдирд╛рдо рдмрджрд▓рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдирдХ рдХрд╛рд░реНрдп "рдкрд╛рдП рдЧрдП" рдереЗ: <br><br><ul><li>  рдлрд╝реНрд░реЗрдб () </li><li>  strncmp () </li><li>  рд╕реНрдЯреНрд░рд▓реЗрди () </li><li>  рдлреБрдЯреЗрд▓ () </li><li>  fseek () </li><li>  рдбрд╛рд▓рддрд╛ рд╣реИ () </li></ul><br>  рд╣рдордиреЗ рдЕрдкрдиреЗ рдХреЛрдб рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдЖрд╡рд░рдг рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдирд╛рдо рдмрджрд▓ рджрд┐рдпрд╛ рд╣реИ (рдЬреЛ рдХрд┐ рдбрд┐рдХрдВрдкрд╛рдЗрд▓рд░ рдиреЗ <strong>_text</strong> рд╢рдмреНрдж рдХреЗ рдкреАрдЫреЗ рдЫрд┐рдкрд╛рдпрд╛ рд╣реИ) рд╕реВрдЪрдХрд╛рдВрдХ 2 рдХреЛ рдЬреЛрдбрд╝рдХрд░ (рддрд╛рдХрд┐ рдореВрд▓ рд╕реА-рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдХреЛрдИ рднреНрд░рдо рди рд╣реЛ)ред  рд▓рдЧрднрдЧ рдпреЗ рд╕рднреА рдХрд╛рд░реНрдп рдлрд╛рдЗрд▓ рдзрд╛рд░рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВред  рдпрд╣ рдЖрд╢реНрдЪрд░реНрдп рдХреА рдмрд╛рдд рдирд╣реАрдВ рд╣реИ - рдХреЛрдб рдкрд░ рдПрдХ рддреНрд╡рд░рд┐рдд рдирдЬрд╝рд░ рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдХрд┐ рдпрд╣ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдкрдврд╝рддрд╛ рд╣реИ (рдЬрд┐рд╕рдХрд╛ рд╡рд┐рд╡рд░рдг рдХреЗрд╡рд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ) рдФрд░ <strong>рд╕реНрдерд╛рдиреАрдп_14</strong> рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рджреЛ рдЖрдпрд╛рдореА рд╕рд░рдгреА рдХреЗ рд╕рд╛рде рд░реАрдб рдбреЗрдЯрд╛ рдХреА рддреБрд▓рдирд╛ рдХрд░рддрд╛ рд╣реИред <br><br>  рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕ рд╕рд░рдгреА рдореЗрдВ рдХреБрдВрдЬреА рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╣реИред  рдЗрд╕реЗ рдХреЙрд▓ рдХрд░реЗрдВ, <strong>key_array рдХрд╣реЗрдВ</strong> ред  рдЪреВрдВрдХрд┐ рд╣рд╛рдЗрдбреНрд░рд╛ рдЖрдкрдХреЛ рди рдХреЗрд╡рд▓ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдирд╛рдо рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ рдЪрд░ рднреА рд╣реИ, рд╣рдо рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╕рдордЭ рдореЗрдВ рдирд╣реАрдВ <strong>рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдерд╛рдиреАрдп_14</strong> рдХреЛ рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ <strong>рдпреЛрдЧреНрдп</strong> <strong>key_array</strong> рдореЗрдВ рдмрджрд▓ <strong>рджреЗрдВрдЧреЗ</strong> ред  рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: рд╕рд╣реА рдорд╛рдЙрд╕ рдмрдЯрди рдХреЗ рдореЗрдиреВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ ( <strong>рд╕реНрдерд╛рдиреАрдп рдирд╛рдо рдмрджрд▓реЗрдВ</strong> ) рдпрд╛ рдХреАрдмреЛрд░реНрдб рд╕реЗ <strong>рдПрд▓</strong> рдХреБрдВрдЬреА рджреНрд╡рд╛рд░рд╛ред <br><br>  рдЗрд╕рд▓рд┐рдП, рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдХреА рдШреЛрд╖рдгрд╛ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж, рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдХрд╛рд░реНрдп <strong>_prepare_key () рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ</strong> : <br><br><pre> <code class="cpp hljs">key_array = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)__prepare_key(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key_array == (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { key_array = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; }</code> </pre><br>  рд╣рдо <strong>_prepare_key ()</strong> рдкрд░ <strong>рд▓реМрдЯреЗрдВрдЧреЗ</strong> , рдпрд╣ рд╣рдорд╛рд░реА рдХреЙрд▓ рдкрджрд╛рдиреБрдХреНрд░рдо рдореЗрдВ рдиреЗрд╕реНрдЯрд┐рдВрдЧ рдХрд╛ рддреАрд╕рд░рд╛ рд╕реНрддрд░ рд╣реИ: <strong>рдореБрдЦреНрдп () -&gt; _construct_key () -&gt; _prepare_key ()</strong> ред  рдЗрд╕ рдмреАрдЪ, рд╣рдо рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рддрд░рд╣ рдЗрд╕ "рдкрд░реАрдХреНрд╖рдг" рджреЛ рдЖрдпрд╛рдореА рд╕рд░рдгреА рдХреЛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред  рдФрд░ рдХреЗрд╡рд▓ рдЕрдЧрд░ рдпрд╣ рд╕рд░рдгреА рдЦрд╛рд▓реА рдирд╣реАрдВ рд╣реИ, рддреЛ рдлрд╝рдВрдХреНрд╢рди рдЕрдкрдиреЗ рдХрд╛рдо рдХреЛ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЙрдкрд░реЛрдХреНрдд рд╕реНрдерд┐рддрд┐ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж <b>рджреВрд╕рд░реЗ</b> рдмреНрд▓реЙрдХ рджреНрд╡рд╛рд░рд╛ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ <b>рд╣реИ</b> ред <br><br>  рддрдм рдкреНрд░реЛрдЧреНрд░рд╛рдо рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрд╣рд▓реЗ 4 рдмрд╛рдЗрдЯреНрд╕ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ <b>key_array</b> рд╕рд░рдгреА рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдЕрдиреБрднрд╛рдЧ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рддрд╛ рд╣реИред  (рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рдирд╛рдо рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж рд╣реИ, рдЬрд┐рд╕рдореЗрдВ <b>рд╕реНрдерд╛рдиреАрдп_19</b> рдЪрд░ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ <b>,</b> рдореИрдВрдиреЗ <b>рдкрд╣рд▓реЗ_4bytes рдХрд╛</b> рдирд╛рдо <b>рдмрджрд▓рд╛</b> ред) <br><br><pre> <code class="cpp hljs">first_4bytes = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*   4    */</span></span> fread2(&amp;first_4bytes,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,param_1); <span class="hljs-comment"><span class="hljs-comment">/*   key_array[1][0...3] */</span></span> iVar1 = strncmp2((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)&amp;first_4bytes,*(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iVar1 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... }</code> </pre><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЖрдЧреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗрд╡рд▓ рддрднреА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдкрд╣рд▓реЗ 4 рдмрд╛рдЗрдЯреНрд╕ рд╕рдВрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ (рдпрд╣ рдпрд╛рдж рд░рдЦреЗрдВ)ред  рддрдм рд╣рдо рдлрд╝рд╛рдЗрд▓ рд╕реЗ 2 2-рдмрд╛рдЗрдЯ рдмреНрд▓реЙрдХ рдкрдврд╝рддреЗ рд╣реИрдВ (рдФрд░ рдбреЗрдЯрд╛ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдлрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣реА <b>key_array</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ): <br><br><pre> <code class="cpp hljs">fread2(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); fread2(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1);</code> </pre><br>  рдФрд░ рдлрд┐рд░ - рдЖрдЧреЗ рдХреА рд╕реНрдерд┐рддрд┐ рд╕рд╣реА рд╣реЛрдиреЗ рдкрд░ рд╣реА рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) == <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp;&amp; (*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">5</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">//   ... }</span></span></code> </pre><br>  рдпрд╣ рджреЗрдЦрдирд╛ рдЖрд╕рд╛рди рд╣реИ рдХрд┐ рдКрдкрд░ рдкрдврд╝реЗ рдЧрдП 2-рдмрд╛рдЗрдЯ рдмреНрд▓реЙрдХ рдореЗрдВ рд╕реЗ рдкрд╣рд▓рд╛ рдирдВрдмрд░ 5 рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рджреВрд╕рд░рд╛ рдирдВрдмрд░ 4 рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдХреЗрд╡рд▓ 32-рдмрд┐рдЯ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдкрд░ 2 рдмрд╛рдЗрдЯреНрд╕ рд╣реИрдВ)ред <br><br>  рдЕрдЧрд▓рд╛ рдпрд╣ рд╣реИ: <br><br><pre> <code class="cpp hljs">local_30[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *key_array; <span class="hljs-comment"><span class="hljs-comment">// .. key_array[0] local_30[1] = *key_array + 0x10c; local_30[2] = *key_array + 0x218; local_30[3] = *key_array + 0x324; local_20 = *key_array + 0x430;</span></span></code> </pre><br>  рдпрд╣рд╛рдБ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ <b>local_30</b> рд╕рд░рдгреА (char * local_30 [4] рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд) рдореЗрдВ <b>key_array</b> рдкреЙрдЗрдВрдЯрд░ рдХреЗ рдСрдлрд╝рд╕реЗрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдпрд╣реА рд╣реИ, <b>рд╕реНрдерд╛рдиреАрдп_30</b> рдорд╛рд░реНрдХрд░ рд▓рд╛рдЗрдиреЛрдВ рдХреА рдПрдХ рд╕рд░рдгреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рд╕рдВрднрд╡рддрдГ рдкрдврд╝рд╛ рдЬрд╛рдПрдЧрд╛ред  рдЗрд╕ рдзрд╛рд░рдгрд╛ рдХреЗ рддрд╣рдд, рдореИрдВрдиреЗ <b>рд╕реНрдерд╛рдиреАрдп_30</b> рдХреЛ <b>рдорд╛рд░реНрдХрд░реЛрдВ рдореЗрдВ</b> рдмрджрд▓ рджрд┐рдпрд╛ред  рдХреЛрдб рдХреЗ рдЗрд╕ рдЦрдВрдб рдореЗрдВ, рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐ рдереЛрдбрд╝реА рд╕рдВрджрд┐рдЧреНрдз рд▓рдЧрддреА рд╣реИ, рдЬрд╣рд╛рдВ рдЕрдВрддрд┐рдо рдСрдлрд╕реЗрдЯ рдХрд╛ рдХрд╛рдо (рд╕реВрдЪрдХрд╛рдВрдХ 0x430 рдкрд░, рдЕрд░реНрдерд╛рдд 1072) рдЕрдЧрд▓реЗ <b>рдорд╛рд░реНрдХрд░</b> рддрддреНрд╡ рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдПрдХ рдЕрд▓рдЧ <b>рд╕реНрдерд╛рдиреАрдп_20</b> рдЪрд░ ( <b>рдЪрд╛рд░ *</b> ) рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдЕрднреА рддрдХ рд╕рдордЭ рд▓реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЕрднреА рдХреЗ рд▓рд┐рдП - рдЪрд▓реЛ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ! <br><br>  рдЖрдЧреЗ рд╣рдо рдПрдХ рдЪрдХреНрд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ: <br><br><pre> <code class="cpp hljs"> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// local_10   i while (i &lt; 5) { // ... i = i + 1; }</span></span></code> </pre><br>  рдпрд╛рдиреА  0 рд╕реЗ 4 рд╕рдорд╛рд╡реЗрд╢реА рддрдХ рдХреЗрд╡рд▓ 5 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВред  рд▓реВрдк рдореЗрдВ, рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрдврд╝рдирд╛ рдФрд░ рд╣рдорд╛рд░реЗ <b>рдорд╛рд░реНрдХрд░</b> рд╕рд░рдгреА рдХреЗ рдЕрдиреБрдкрд╛рд▓рди рдХреА рдЬрд╛рдВрдЪ рддреБрд░рдВрдд рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c_marker = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_35 /*  .    */ fread2(&amp;c_marker, 1, 1, param_1); if (*markers[i] != c_marker) { /*    -      */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br>  рдпрд╣реА рд╣реИ, рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЕрдЧрд▓рд╛ рдмрд╛рдЗрдЯ <b>c_marker</b> рдЪрд░ (рдореВрд▓ рд╡рд┐рдШрдЯрд┐рдд рдХреЛрдб - <b>local_35 рдореЗрдВ</b> ) рдкрдврд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ ith <b>рдорд╛рд░реНрдХрд░</b> рддрддреНрд╡ рдХреЗ рдкрд╣рд▓реЗ рдЪрд░рд┐рддреНрд░ рдХреЗ рдЕрдиреБрдкрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИред  рдПрдХ рдмреЗрдореЗрд▓ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, <b>key_array</b> рд╕рд░рдгреА <b>рд╢реВрдиреНрдп рд╣реЛ</b> рдЬрд╛рддреА рд╣реИ рдФрд░ рдПрдХ рдЦрд╛рд▓реА рдбрдмрд▓ рдкреЙрдЗрдВрдЯрд░ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИред  рдЖрдЧреЗ рдХреЛрдб рдХреЗ рд╕рд╛рде, рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рддрдм рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рд░реАрдб рдбреЗрдЯрд╛ рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИред <br><br>  рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ, рдЬреИрд╕рд╛ рдХрд┐ рд╡реЗ рдХрд╣рддреЗ рд╣реИрдВ, "рдХреБрддреНрддреЗ рдХреЛ рджрдлрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред"  рдЖрдЗрдП рдЗрд╕ рдЪрдХреНрд░ рдкрд░ рдХрд░реАрдм рд╕реЗ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред  рдпрд╣ 5 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИред  рдпрджрд┐ рдЖрдк рдХреЛрдбрд╛рдВрддрд░рдХ рдХреЛрдб рдХреЛ рджреЗрдЦ рдХрд░ рдпрд╣ рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><img src="https://habrastorage.org/webt/si/b4/q8/sib4q8jsxe2zyxpxi2gcwy0vfba.png"><br><br><img src="https://habrastorage.org/webt/tr/8q/oh/tr8qoh9ayg-7v9t6rv1vwtsuy_c.png"><br><br>  рджрд░рдЕрд╕рд▓, рд╕реАрдПрдордкреА рдХрдорд╛рдВрдб <b>рд╕реНрдерд╛рдиреАрдп_10</b> рдЪрд░ (рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <b>i</b> ) рдХреЗ рдореВрд▓реНрдп рдХреА <i>рддреБрд▓рдирд╛</i> 4 рдирдВрдмрд░ рдХреЗ рд╕рд╛рде рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдорд╛рди 4 (JLE рдХрдорд╛рдВрдб) <i>рд╕реЗ рдХрдо рдпрд╛ рдмрд░рд╛рдмрд░ рд╣реИ</i> , рддреЛ <b>LAB_004017eb</b> рд▓реЗрдмрд▓ рдкрд░ рд╕рдВрдХреНрд░рдордг рдХрд┐рдпрд╛ <b>рдЬрд╛рддрд╛ рд╣реИ</b> , рдЕрд░реНрдерд╛рдд  рдЪрдХреНрд░ рдХреЗ рд╢рд░реАрд░ рдХреА рд╢реБрд░реБрдЖрддред  рдпрд╛рдиреА  рд╢рд░реНрдд <b>I</b> = 0, 1, 2, 3 рдФрд░ 4 рдХреЗ рд▓рд┐рдП рдкреВрд░реА рд╣реЛрдЧреА - рдХреЗрд╡рд▓ 5 рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ!  рд╕рдмрдХреБрдЫ рдареАрдХ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди <b>рдорд╛рд░реНрдХрд░</b> рднреА рдПрдХ рд▓реВрдк рдореЗрдВ рдЗрд╕ рдЪрд░ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдХреНрд░рдорд┐рдд <b>рд╣реЛрддреЗ рд╣реИрдВ</b> , рдФрд░ рдЖрдЦрд┐рд░рдХрд╛рд░, рдпрд╣ рд╕рд░рдгреА рдХреЗрд╡рд▓ 4 рддрддреНрд╡реЛрдВ рдХреЗ рд╕рд╛рде рдШреЛрд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *markers [<span class="hljs-number"><span class="hljs-number">4</span></span>];</code> </pre><br>  рддреЛ, рдХреЛрдИ рд╡реНрдпрдХреНрддрд┐ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХрд┐рд╕реА рдХреЛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИ :) рдпрд╛рдж рд░рдЦреЗрдВ, рдореИрдВрдиреЗ рдХрд╣рд╛ рдХрд┐ рдпрд╣ рд░реЗрдЦрд╛ рд╕рдВрджрд┐рдЧреНрдз рд╣реИ? <br><br><pre> <code class="cpp hljs">local_20 = *key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>;</code> </pre><br>  рдмрд╕ рдРрд╕реЗ рд╣реА!  рдлрд╝рдВрдХреНрд╢рди рдХреА рд╕рдВрдкреВрд░реНрдг рд╕реВрдЪреА рдХреЛ рджреЗрдЦреЗрдВ рдФрд░ <b>рд╕реНрдерд╛рдиреАрдп_20</b> рдЪрд░ рдХреЗ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдФрд░ рд╕рдВрджрд░реНрдн рдХреЛ рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред  рд╡рд╣ рд╡рд╣рд╛рдБ рдирд╣реАрдВ рд╣реИ!  рд╣рдо рдЗрд╕рд╕реЗ рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВ: рдЗрд╕ рдСрдлрд╕реЗрдЯ рдХреЛ рднреА <b>рдорд╛рд░реНрдХрд░реЛрдВ</b> рд╕рд░рдгреА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рд╕рд░рдгреА рдореЗрдВ 5 рддрддреНрд╡ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред  рдЪрд▓реЛ рдЗрд╕реЗ рдареАрдХ рдХрд░рддреЗ рд╣реИрдВред  рдЪрд░ рдШреЛрд╖рдгрд╛ рдкрд░ рдЬрд╛рдПрдВ, <b>Ctrl + L</b> (рд░рд┐рдЯрд╛рдЗрдк рдЪрд░) <b>рджрдмрд╛рдПрдВ</b> рдФрд░ рд╕рд╛рд╣рд╕рдкреВрд░реНрд╡рдХ рд╕рд░рдгреА рдХреЗ рдЖрдХрд╛рд░ рдХреЛ 5 рдореЗрдВ рдмрджрд▓реЗрдВ: <br><br><img src="https://habrastorage.org/webt/t0/sq/xw/t0sqxw-hbw5dqo9mca3m43r5cei.png"><br><br>  рд╣реЛ рдЧрдпрд╛ред  <b>рдорд╛рд░реНрдХрд░реЛрдВ</b> рдХреЛ рдкреЙрдЗрдВрдЯрд░ рдСрдлрд╝рд╕реЗрдЯ рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рдХреЛрдб рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ, рдФрд░ - рд▓реЛ рдФрд░ рдирд┐рд╣рд╛рд░рдирд╛!  - рдПрдХ рдЕрд╕рдВрдЧрдд рдЕрддрд┐рд░рд┐рдХреНрдд рдЪрд░ рдЧрд╛рдпрдм рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╕рдм рдХреБрдЫ рдЬрдЧрд╣ рдореЗрдВ рдЧрд┐рд░ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs">markers[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *key_array; markers[<span class="hljs-number"><span class="hljs-number">1</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>; markers[<span class="hljs-number"><span class="hljs-number">2</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x218</span></span>; markers[<span class="hljs-number"><span class="hljs-number">3</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x324</span></span>; markers[<span class="hljs-number"><span class="hljs-number">4</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ...   !</span></span></code> </pre><br>  рд╣рдо рдЕрдкрдиреЗ <b>рд▓реВрдк рдореЗрдВ</b> рд▓реМрдЯрддреЗ рд╣реИрдВ (рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ, рдпрд╣ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рдзреНрдпрд╛рди рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ)ред  рдЕрдЧрд▓рд╛, рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдмрд╛рдЗрдЯ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХреЗ рдореВрд▓реНрдп рдХреА рдЬрд╛рдБрдЪ рдХреА рдЬрд╛рддреА рд╣реИ: <br><br><pre> <code class="cpp hljs">byte n_strlen1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_36 /*  .    */ fread2(&amp;n_strlen1,1,1,param_1); if (n_strlen1 == 0) { /*      */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br>  рдареАрдХ рд╣реИ, рдпрд╣ <b>n_strlen1</b> nonzero рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдХреНрдпреЛрдВ?  рдЕрдм рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рд╕рд╛рде рд╣реА рдЖрдк рдпрд╣ рд╕рдордЭ рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рдореИрдВрдиреЗ рдЗрд╕ рдЪрд░ рдХреЛ рдирд┐рдореНрди рдирд╛рдо рдХреНрдпреЛрдВ рджрд┐рдпрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">/*   n_strlen1)  (markers[i] + 0x104) */</span></span> *(uint *)(markers[i] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = (uint)n_strlen1; <span class="hljs-comment"><span class="hljs-comment">/*    (n_strlen1)  (--&gt;  ?) */</span></span> fread2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,*(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(markers[i] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>),param_1); n_strlen2 = strlen2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   sVar2 if (n_strlen2 != *(size_t *)(markers[i] + 0x104)) { /*    (n_strlen2)  == n_strlen1 */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br>  рдореИрдВрдиреЗ рдЙрди рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рд╛, рдЬрд┐рди рдкрд░ рд╕рдм рдХреБрдЫ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  <b>N_strlen1</b> рдмрд╛рдЗрдЯреНрд╕ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрдврд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ (рдЕрд░реНрдерд╛рдд рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ) <b>рдорд╛рд░реНрдХрд░реЛрдВ рдореЗрдВ [i]</b> рд╕рд░рдгреА - рдЕрд░реНрдерд╛рддреН, "рд╕реНрдЯреЙрдк-рд╕рд┐рдВрдмрд▓" рдХреЗ рдмрд╛рдж, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <b>key_array</b> рд╕реЗ рд╡рд╣рд╛рдВ рд▓рд┐рдЦреЗ <b>рдЧрдП рд╣реИрдВ</b> ред  <b>рдЕрдВрдХ</b> 0x104 (260) рдкрд░ <b>рдорд╛рд░реНрдХрд░ [i]</b> рдореЗрдВ рдорд╛рди <b>n_strlen1</b> рд╕рд╣реЗрдЬрдирд╛ рдпрд╣рд╛рдВ рдХреЛрдИ рднреВрдорд┐рдХрд╛ рдирд╣реАрдВ рдирд┐рднрд╛рддрд╛ рд╣реИ (рдКрдкрд░ рдХреЛрдб рдореЗрдВ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рджреЗрдЦреЗрдВ)ред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЗрд╕ рдХреЛрдб рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рдпрд╣реА рд╕реНрдерд┐рддрд┐ рд╣реИ): <br><br><pre> <code class="cpp hljs">fread2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>) n_strlen1, param_1); n_strlen2 = strlen2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n_strlen2 != (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>) n_strlen1) { ... }</code> </pre><br>  рдпрд╣ рднреА рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рд░реАрдб рд▓рд╛рдЗрди рдХреА рд▓рдВрдмрд╛рдИ <b>n_strlen1 рд╣реИ</b> ред  рдпрд╣ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ <b>рдлрд╝реНрд░реЗрдб</b> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди <b>рдлрд╝реНрд░реЗрдб</b> рдмрд╣реБрдд рд╕рд╛рд░реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдмрд╛рдЗрдЯреНрд╕ <i>рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ</i> рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдВрдб-рдСрдлрд╝-рдлрд╝рд╛рдЗрд▓ рдорд╛рд░реНрдХрд░ (рдИрдУрдПрдл) рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдВрдХреЗрдд рд╕реЗ рдХрдо рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣реА рд╣реИ, рд╕рдм рдХреБрдЫ рд╕рдЦреНрдд рд╣реИ: рд▓рд╛рдЗрди рдХреА рд▓рдВрдмрд╛рдИ (рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ) рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдлрд┐рд░ рд▓рд╛рдЗрди рдЦреБрдж рдЬрд╛рддреА рд╣реИ - рдФрд░ рдмрд┐рд▓реНрдХреБрд▓ 5 рдмрд╛рд░ред  рд▓реЗрдХрд┐рди рд╣рдо рдЦреБрдж рд╕реЗ рдЖрдЧреЗ рдирд┐рдХрд▓ рд░рд╣реЗ рд╣реИрдВред <br><br>  рдЖрдЧреЗ рдкрд╛рдиреА рдЗрд╕ рдХреЛрдб (рдЬреЛ рдореИрдВрдиреЗ рднреА рддреБрд░рдВрдд рдЯрд┐рдкреНрдкрдгреА рдХреА): <br><br><pre> <code class="cpp hljs">uint n_pos = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_3c /*  .    */ fread2(&amp;n_pos,1,1,param_1); /*   7 */ n_pos = n_pos + 7; /*     */ uint n_filepos = ftell2(param_1); //   uVar3 if (n_pos &lt; n_filepos) { /* n_pos   &gt;= n_filepos */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br>  рдпрд╣ рдЕрднреА рднреА рдпрд╣рд╛рдВ рд╕рд░рд▓ рд╣реИ: рд╣рдо рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЕрдЧрд▓рд╛ рдмрд╛рдЗрдЯ рд▓реЗрддреЗ рд╣реИрдВ, 7 рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдореА рдорд╛рди рдХреА рддреБрд▓рдирд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдлреЗрд▓ ()</a> рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдлрд╝рд╛рдЗрд▓ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдХрд░реНрд╕рд░ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдХрд░рддреЗ рд╣реИрдВред  <b>N_pos</b> рдХрд╛ рдорд╛рди рдХрд░реНрд╕рд░ рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдХрдо рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдпрд╛рдиреА рдлрд╝рд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рдСрдлрд╕реЗрдЯ)ред <br><br>  рд▓реВрдк рдореЗрдВ рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐: <br><br><pre> <code class="cpp hljs">fseek2(param_1,n_pos,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br>  рдпрд╛рдиреА  рдлрд╝рд╛рдЗрд▓ рдХрд░реНрд╕рд░ рдХреЛ (рд╢реБрд░реБрдЖрдд рд╕реЗ) рд╕реНрдерд┐рддрд┐ рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">fseek ()</a> рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ <b>n_pos</b> рджреНрд╡рд╛рд░рд╛ рдкреБрди: рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░реЗрдВред  рдареАрдХ рд╣реИ, рд╣рдо рдЗрди рд╕рднреА рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ 5 рдмрд╛рд░ рд▓реВрдк рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВред  <b>_Construct_key ()</b> рдлрд╝рдВрдХреНрд╢рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ <b>рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ</b> : <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i_lastmarker = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_34 /*   4    (int32) */ fread2(&amp;i_lastmarker,4,1,param_1); if (*(int *)(*key_array + 0x53c) == i_lastmarker) { /*    == key_array[0][1340] ...   :) */ puts2("Markers seem to still exist"); } else { _free_key(key_array); key_array = (char **)0x0; }</span></span></code> </pre><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХрд╛ рдЕрдВрддрд┐рдо рдмреНрд▓реЙрдХ 4-рдмрд╛рдЗрдЯ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдпрд╣ <b>key_array [0] [1340]</b> рдореЗрдВ рдореВрд▓реНрдп рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдХрдВрд╕реЛрд▓ рдореЗрдВ рдПрдХ рдмрдзрд╛рдИ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред  рдЕрдиреНрдпрдерд╛, рдЦрд╛рд▓реА рд╕рд░рдгреА рдЕрднреА рднреА рдХрд┐рд╕реА рднреА рдкреНрд░рд╢рдВрд╕рд╛ рдХреЗ рдмрд┐рдирд╛ рд▓реМрдЯрддреА рд╣реИ :) <br><br><h2>  рдЪрд░рдг 6 - __prepare_key () рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЕрд╡рд▓реЛрдХрди </h2><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдПрдХ <b>рдЕрдирд╕реИрдмрд▓реНрдб</b> рдлрдВрдХреНрд╢рди <b>рдмрдЪрд╛ рд╣реИ</b> - <b>__prepare_key ()</b> ред  рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЗрд╕ рдмрд╛рдд рдореЗрдВ рд╣реИ рдХрд┐ рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛ <b>key_array</b> рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <b>_construct_key ()</b> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдмрд╛рдХреА рд╣реИ рдХрд┐ рд╡рд╣рд╛рдВ рдХрд┐рд╕ рддрд░рд╣ рдХрд╛ рдбреЗрдЯрд╛ рд╣реИ! <br><br>  рдореИрдВ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ рдФрд░ рддреБрд░рдВрдд рдЪрд░ рдХреЗ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдирд╛рдо рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдкреВрд░реА рд╕реВрдЪреА рджреВрдВрдЧрд╛: <br><br><div class="spoiler">  <b class="spoiler_title">__Prepare_key () рдлрд╝рдВрдХреНрд╢рди рд╕реВрдЪреАрдХрд░рдг</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ** __prepare_key(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **key_array; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *pvVar1; <span class="hljs-comment"><span class="hljs-comment">/* key_array = new char*[2]; // 2 4-  (char*) */</span></span> key_array = (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key_array == (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { key_array = (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { pvVar1 = calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0x540</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* key_array[0] = new char[1340] */</span></span> *key_array = pvVar1; pvVar1 = calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* key_array[1] = new char[8] */</span></span> key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = pvVar1; <span class="hljs-comment"><span class="hljs-comment">/* "VOID" */</span></span> *(undefined4 *)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x404024</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 5  4 (2- ) */</span></span> *(undefined2 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) = <span class="hljs-number"><span class="hljs-number">5</span></span>; *(undefined2 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* key_array[0][0] = 'b' */</span></span> *(undefined *)*key_array = <span class="hljs-number"><span class="hljs-number">0x62</span></span>; *(undefined4 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'W' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x218</span></span>) = <span class="hljs-number"><span class="hljs-number">0x57</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'p' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x324</span></span>) = <span class="hljs-number"><span class="hljs-number">0x70</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'l' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>) = <span class="hljs-number"><span class="hljs-number">0x6c</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 152 ( ASCII) */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>) = <span class="hljs-number"><span class="hljs-number">0x98</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*   = 1122 (int32) */</span></span> *(undefined4 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x53c</span></span>) = <span class="hljs-number"><span class="hljs-number">0x462</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> key_array; }</code> </pre><br></div></div><br>  рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рд▓рд╛рдпрдХ рдПрдХрдорд╛рддреНрд░ рд╕реНрдерд╛рди рдпрд╣ рд░реЗрдЦрд╛ рд╣реИ: <br><br><pre> <code class="cpp hljs">*(undefined4 *)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x404024</span></span>;</code> </pre><br>  рдореИрдВ рдХреИрд╕реЗ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реВрдБ рдХрд┐ рдпрд╣рд╛рдБ "VOID" рд▓рд╛рдЗрди рд╣реИ?  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ 0x404024 рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдПрдбреНрд░реЗрд╕ рд╕реНрдкреЗрд╕ рдореЗрдВ <b>рдПрдбреНрд░реЗрд╕ рд╣реИ</b> ред  рдЗрд╕ рдореВрд▓реНрдп рдкрд░ рдбрдмрд▓-рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рд╕реЗ рд╣рдо рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/8a/eu/0j/8aeu0jkpr-ea7euhrlcgvm0rxq8.png"><br><br>  рд╡реИрд╕реЗ, рдЗрд╕ рд▓рд╛рдЗрди рдХреЗ рд▓рд┐рдП рдХреЛрдбрд╛рдВрддрд░рдХ рдХреЛрдб рд╕реЗ рд╕рдордЭрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br> <code>004015da c7 00 24 MOV dword ptr [EAX], .rdata = 56h V <br> 40 40 00 <br></code> <br>  VOID рд▓рд╛рдЗрди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ <b>.rdata</b> рд╕реЗрдХреНрд╢рди рдХреЗ рдмрд╣реБрдд рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реИ (рд╕рдВрдмрдВрдзрд┐рдд рдкрддреЗ рд╕реЗ рд╢реВрдиреНрдп рдСрдлрд╕реЗрдЯ рдкрд░)ред <br><br>  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдкрд░, рдирд┐рдореНрди рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рджреЛ-рдЖрдпрд╛рдореА рд╕рд░рдгреА рдмрдирд╛рдИ рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП: <br><br> <code>[0] [0]:'b' [268]:'l' [536]:'W' [804]:'p' [1072]:152 [1340]:1122 <br> [1] [0-3]:"VOID" [4-5]:5 [6-7]:4 <br></code> <br><h2>  рдЪрд░рдг 7 - рджрд░рд╛рд░ рдХреЗ рд▓рд┐рдП рджреНрд╡рд┐рдЖрдзрд╛рд░реА рддреИрдпрд╛рд░ рдХрд░реЗрдВ </h2><br>  рдЕрдм рд╣рдо рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рдВрд╢реНрд▓реЗрд╖рдг рдХреЛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рд╣рд╛рдереЛрдВ рдореЗрдВ рд╕рднреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдбреЗрдЯрд╛: <br>  1) рд╕рддреНрдпрд╛рдкрди рдбреЗрдЯрд╛ ("рдкреНрд░рддреАрдХреЛрдВ рдХреЛ рд░реЛрдХреЗрдВ") рдФрд░ рд╕рддреНрдпрд╛рдкрди рд╕рд░рдгреА рдореЗрдВ рдЙрдирдХреА рд╕реНрдерд┐рддрд┐; <br>  2) рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХрд╛ рдХреНрд░рдо <br><br>  рдЖрдЗрдП рд╣рдо <b>_construct_key ()</b> рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЬрд┐рд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЙрд╕рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред  рддреЛ, рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХрд╛ рдХреНрд░рдо рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реЛрдЧрд╛: <br><br><div class="spoiler">  <b class="spoiler_title">рдлрд╝рд╛рдЗрд▓ рд╕рдВрд░рдЪрдирд╛</b> <div class="spoiler_text"><ol><li>  4 рдмрд╛рдЗрдЯреНрд╕ == key_array [1] [0 ... 3] == "VOID" </li><li>  2 рдмрд╛рдЗрдЯреНрд╕ == key_array [1] [4] == 5 </li><li>  2 рдмрд╛рдЗрдЯреНрд╕ == key_array [1] [6] == 4 </li><li>  1 рдмрд╛рдЗрдЯ == key_array [0] [0] == 'b' (рдЯреЛрдХрди) </li><li>  1 рдмрд╛рдЗрдЯ == (рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреА рд▓рдВрдмрд╛рдИ) == n_strlen1 </li><li>  n_strlen1 рдмрд╛рдЗрдЯреНрд╕ == (рдХреЛрдИ рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ) == n_strlen1 </li><li>  1 рдмрд╛рдЗрдЯ == (+7 == рдЕрдЧрд▓рд╛ рдЯреЛрдХрди) == n_pos </li><li>  1 рдмрд╛рдЗрдЯ == key_array [0] [0] == 'l' (рдЯреЛрдХрди) </li><li>  1 рдмрд╛рдЗрдЯ == (рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреА рд▓рдВрдмрд╛рдИ) == n_strlen1 </li><li>  n_strlen1 рдмрд╛рдЗрдЯреНрд╕ == (рдХреЛрдИ рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ) == n_strlen1 </li><li>  1 рдмрд╛рдЗрдЯ == (+7 == рдЕрдЧрд▓рд╛ рдЯреЛрдХрди) == n_pos </li><li>  1 рдмрд╛рдЗрдЯ == key_array [0] [0] == 'W' (рдЯреЛрдХрди) </li><li>  1 рдмрд╛рдЗрдЯ == (рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреА рд▓рдВрдмрд╛рдИ) == n_strlen1 </li><li>  n_strlen1 рдмрд╛рдЗрдЯреНрд╕ == (рдХреЛрдИ рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ) == n_strlen1 </li><li>  1 рдмрд╛рдЗрдЯ == (+7 == рдЕрдЧрд▓рд╛ рдЯреЛрдХрди) == n_pos </li><li>  1 рдмрд╛рдЗрдЯ == key_array [0] [0] == 'p' (рдЯреЛрдХрди) </li><li>  1 рдмрд╛рдЗрдЯ == (рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреА рд▓рдВрдмрд╛рдИ) == n_strlen1 </li><li>  n_strlen1 рдмрд╛рдЗрдЯреНрд╕ == (рдХреЛрдИ рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ) == n_strlen1 </li><li>  1 рдмрд╛рдЗрдЯ == (+7 == рдЕрдЧрд▓рд╛ рдЯреЛрдХрди) == n_pos </li><li>  1 рдмрд╛рдЗрдЯ == key_array [0] [0] == 152 (рдЯреЛрдХрди) </li><li>  1 рдмрд╛рдЗрдЯ == (рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреА рд▓рдВрдмрд╛рдИ) == n_strlen1 </li><li>  n_strlen1 рдмрд╛рдЗрдЯреНрд╕ == (рдХреЛрдИ рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ) == n_strlen1 </li><li>  1 рдмрд╛рдЗрдЯ == (+7 == рдЕрдЧрд▓рд╛ рдЯреЛрдХрди) == n_pos </li><li>  4 рдмрд╛рдЗрдЯреНрд╕ == (key_array [1340]) == 1122 </li></ol><br></div></div><br>  рд╕реНрдкрд╖реНрдЯрддрд╛ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХреНрд╕реЗрд▓ рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рдЯреИрдмрд▓реЗрдЯ рдмрдирд╛рдпрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/kr/i-/7a/kri-7arjlro0ye_los64uhakbfq.png"><br><br>  рдпрд╣рд╛рдВ 7 рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдореЗрдВ - рд╡рд░реНрдгреЛрдВ рдФрд░ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡рдпрдВ рдбреЗрдЯрд╛, 6 рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдореЗрдВ - рдЙрдирдХреА рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рдЕрднреНрдпрд╛рд╡реЗрджрди, 8 рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдореЗрдВ - рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХрд╛ рдЖрдХрд╛рд░ (рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ), 9 рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдореЗрдВ - рдлрд╝рд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдСрдлрд╕реЗрдЯред  рдпрд╣ рджреГрд╢реНрдп рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐  рдЖрдкрдХреЛ рднрд╡рд┐рд╖реНрдп рдХреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдПрдХ рдкреАрд▓реЗ рд░рдВрдЧ рдХреА рднрд░рдг рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд), рдЬрдмрдХрд┐ рдЗрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рд▓рдВрдмрд╛рдИ рдХреЗ рдореВрд▓реНрдпреЛрдВ, рд╕рд╛рде рд╣реА рдЕрдЧрд▓реЗ рд╕реНрдЯреЙрдк рдкреНрд░рддреАрдХ рдХреЗ рд╕реНрдерд┐рддрд┐ рдСрдлрд╕реЗрдЯ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реВрддреНрд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдКрдкрд░ (рд▓рд╛рдЗрдиреЛрдВ 1-4 рдореЗрдВ), <b>key_array</b> рдЪреЗрдХ рдРрд░реЗ рдХреА рд╕рдВрд░рдЪрдирд╛ <b>рджрд┐рдЦрд╛рдИ рдЧрдИ рд╣реИ</b> ред <br><br>  рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд▓ рд╣реА рдкреНрд▓рд╕ рдЕрдиреНрдп рд╕реНрд░реЛрдд рд╕рд╛рдордЧреНрд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдБ</a> рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред <br><br><h3>  рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдкреАрдврд╝реА рдФрд░ рд╕рддреНрдпрд╛рдкрди </h3><br>  рдХреЗрд╡рд▓ рдПрдХ рдЪреАрдЬ рдмрдЪреА рд╣реИ рдЬреЛ рд╡рд╛рдВрдЫрд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ рдФрд░ рдЗрд╕реЗ рд╣рдорд╛рд░реА рджрд░рд╛рд░ рдХреЗ рд╕рд╛рде рдЦрд┐рд▓рд╛рддреА рд╣реИред  рдлрд╝рд╛рдЗрд▓ рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд┐рдЦреА: <br><br><div class="spoiler">  <b class="spoiler_title">рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys, os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess out_str = [<span class="hljs-string"><span class="hljs-string">'!'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">' solved'</span></span>, <span class="hljs-string"><span class="hljs-string">' this'</span></span>, <span class="hljs-string"><span class="hljs-string">' crackme!'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(file_path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(file_path, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> outfile: outfile.write(<span class="hljs-string"><span class="hljs-string">'VOID'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'2h'</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'b'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos = <span class="hljs-number"><span class="hljs-number">10</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'l'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'W'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'p'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-number"><span class="hljs-number">152</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-number"><span class="hljs-number">1122</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> err: print(err) <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(sys.argv) != <span class="hljs-number"><span class="hljs-number">2</span></span>: print(<span class="hljs-string"><span class="hljs-string">'USAGE: {this_script.py} path_to_crackme[.exe]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> os.path.isfile(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]): print(<span class="hljs-string"><span class="hljs-string">'File "{}" unavailable!'</span></span>.format(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> file_path = os.path.splitext(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>])[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-string"><span class="hljs-string">'.dat'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: write_file(file_path) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: outputstr = subprocess.check_output(<span class="hljs-string"><span class="hljs-string">'"{}" -f "{}"'</span></span>.format(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>], file_path), stderr=subprocess.STDOUT) print(outputstr.decode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> err: print(err) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: main()</code> </pre><br></div></div><br>  рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХрд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рджрд░рд╛рд░реЗрдВ рдХреЗ рд▓рд┐рдП рд░рд╛рд╕реНрддрд╛ рд▓реЗрддреА рд╣реИ, рдлрд┐рд░ рдЙрд╕реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рддреЗ рд╣реБрдП, рдЗрд╕реА рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рджрд░рд╛рд░ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред <br><br>  рдкрд╛рда рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, <b>рд╕реНрдЯреНрд░рдХреНрдЪрд░</b> рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  <b>рдкреИрдХ ()</b> рд╡рд┐рдзрд┐ рдЖрдкрдХреЛ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ ("рдмреА" = "рдмрд╛рдЗрдЯ", "рдЖрдИ" = рдЗрдВрдЯ, рдЖрджрд┐), рдФрд░ рдЖрдк рдЕрдиреБрдХреНрд░рдо рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ ("&gt;" = "рдмрд┐рдЧ" -рдПрдВрдбрд┐рдпрди "," &lt;"=" рд▓рд┐рдЯрд┐рд▓-рдПрдВрдбрд┐рдпрди ")ред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЖрджреЗрд╢ рд▓рд┐рдЯрд┐рд▓-рдПрдВрдбрд┐рдпрди рд╣реИред  рдХреНрдпреЛрдВрдХрд┐  рд╣рдордиреЗ рдкрд╣рд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдкрд╣рд▓реЗ рд╣реА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд▓рд┐рдпрд╛ рдерд╛ рдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣рдорд╛рд░рд╛ рдорд╛рдорд▓рд╛ рд╣реИ, рдлрд┐рд░ рд╣рдо рдХреЗрд╡рд▓ рдкреНрд░рдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдПрдХ рдкреВрд░реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рднреА рдХреЛрдб рдкреНрд░реЛрдЧреНрд░рд╛рдо рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдкреБрди: рдкреЗрд╢ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╣рдордиреЗ рдкрд╛рдпрд╛ред  рд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рдореБрджреНрд░рд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд░реЗрдЦрд╛ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ "рдореИрдВрдиреЗ рдЗрд╕ рдХреНрд░реИрдХрдореЗ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рд╣реИ!"  (рдЖрдк рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рдкрдВрдХреНрддрд┐ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ)ред <br><br>  рдЖрдЙрдЯрдкреБрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/th/mx/pz/thmxpzy22t8leydwou56w3emrze.png"><br><br>  рд╣реБрд░реНрд░реЗ, рд╕рдм рдХреБрдЫ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ!  рдЗрд╕рд▓рд┐рдП, рдереЛрдбрд╝рд╛ рдкрд╕реАрдирд╛ рдЖрдиреЗ рдФрд░ рдХреБрдЫ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ рдФрд░ рдЗрд╕реЗ "рдХреНрд░реИрдХ" рдХрд░ рджрд┐рдпрд╛ред  рдмреЗрд╢рдХ, рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рд╕рд╛рдзрд╛рд░рдг рджрд░рд╛рд░ рд╣реИ, рдПрдХ рдкрд░реАрдХреНрд╖рдг рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣реИ, рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рджреВрд╕рд░реА рдХрдард┐рдирд╛рдИ рд╕реНрддрд░ (рдЙрд╕ рд╕рд╛рдЗрдЯ рдкрд░ рдкреНрд░рд╕реНрддреБрдд 5 рдореЗрдВ рд╕реЗ)ред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдо рдХреЙрд▓ рдФрд░ рджрд░реНрдЬрдиреЛрдВ - рд╕реИрдХрдбрд╝реЛрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдПрдХ рдЬрдЯрд┐рд▓ рдкрджрд╛рдиреБрдХреНрд░рдо рд╕реЗ рдирд┐рдкрдЯреЗрдВрдЧреЗ, рдФрд░ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ - рдЖрдВрддрд░рд┐рдХ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдФрд░ рдкреА-рдХреЛрдб рдХреЗ рдЙрдкрдпреЛрдЧ рддрдХ рдбреЗрдЯрд╛, рдХрдЪрд░рд╛ рдХреЛрдб рдФрд░ рдЕрдиреНрдп рдУрдлрд╝реНрд╕реНрдХреНрдпреВрд╢рди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЕрдиреБрднрд╛рдЧ ... рд▓реЗрдХрд┐рди рдпрд╣, рдЬреИрд╕рд╛ рдХрд┐ рд╡реЗ рдХрд╣рддреЗ рд╣реИрдВ, рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИред рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рдХрд╣рд╛рдиреАред <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рд╕рд╛рдордЧреНрд░реАред</a></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi447488/">https://habr.com/ru/post/hi447488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi447474/index.html">рд╣рд╛рд░реНрд╡реЗрд▓ рдбреЗрдХрд╛рдЯреНрд░реЙрди рдХрдВрдкреНрдпреВрдЯрд░ рдкреНрд░рддрд┐рдХреГрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рдШреБ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдбреЗрдХрд╛рдЯреНрд░реЙрди рдПрдирд╛рд▓реЙрдЧ рдФрд░ рди рдХреЗрд╡рд▓</a></li>
<li><a href="../hi447476/index.html">рдЙрджрд╛рддреНрдд рдкрд╛рда рдореЗрдВ LaTeX рдХреА рд╕реНрдерд╛рдкрдирд╛</a></li>
<li><a href="../hi447478/index.html">рдЯреАрдо рд╡рд┐рдХрд╛рд╕ рдХреЗ рдЖрдзрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдпрддрд╛ рдФрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд╛ рднреНрд░рдо</a></li>
<li><a href="../hi447480/index.html">рдХреЙрд╕реНрдореЛрдиреЙрдЯрд┐рдХреНрд╕ рдбреЗ 2019: рд╢рд╣рд░ рджреНрд╡рд╛рд░рд╛ рдШрдЯрдирд╛рдУрдВ</a></li>
<li><a href="../hi447482/index.html">рд╕рд╛рдЗрдмрд░ рд▓реЙ рд╕реНрдХреВрд▓ред 5-рджрд┐рд╡рд╕реАрдп рдбрд┐рдЬрд┐рдЯрд▓ рдХрд╛рдиреВрди рдЧрд╣рди</a></li>
<li><a href="../hi447490/index.html">рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рдЕрдкрдиреА рд▓реЗрдЦрди рд╢реИрд▓реА рдХреИрд╕реЗ рд╕реБрдзрд╛рд░реЗрдВ: 5 рдЯрд┐рдкреНрд╕</a></li>
<li><a href="../hi447494/index.html">рд╕реНрдерд┐рд░рддрд╛ GAN рд▓рд░реНрдирд┐рдВрдЧ (рдЧрд╣рд░реА рдЦреБрджрд╛рдИ)</a></li>
<li><a href="../hi447496/index.html">рд░рд╛рд╕реНрдкрдмреЗрд░реА рдХреЛ рд╡реЗрдмрд╕реЛрдХреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдирд╛</a></li>
<li><a href="../hi447498/index.html">рдЬреЗрдкрд░реНрд╕ 2019 рд╕реЗ рдлреЛрдЯреЛ рд░рд┐рдкреЛрд░реНрдЯ + рд╕реЗрдВрдЯ рдкреАрдЯрд░реНрд╕рдмрд░реНрдЧ рдореЗрдВ рдЬреЛрдХрд░ 2019 рдХреА рдШреЛрд╖рдгрд╛</a></li>
<li><a href="../hi447500/index.html">рдХреНрдпреЛрдВ рдСрдкрд░реЗрдЯрд░ eSIM рд╕реЗ рдбрд░ рдЧрдП</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>