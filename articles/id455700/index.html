<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåµ üé™ üÜô 4 trik yang membantu kami mengoptimalkan frontend üë©üèº‚Äçüè´ üÜí ‚è™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Animasi yang indah telah lama menjadi tren tren desain. Desainer UI membuat komidi putar yang rumit, unduhan, animasi menu, dan dekorasi lainnya, dan ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>4 trik yang membantu kami mengoptimalkan frontend</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/epayments/blog/455700/"><p>  Animasi yang indah telah lama menjadi tren tren desain.  Desainer UI membuat komidi putar yang rumit, unduhan, animasi menu, dan dekorasi lainnya, dan pengembang antarmuka menerjemahkannya menjadi kode.  Tapi situs itu seharusnya tidak hanya terlihat bagus, tetapi juga berfungsi dengan cepat. </p><br><p>  Frontend modern harus mengoptimalkan kodenya.  Ini terutama berlaku untuk produk-produk di mana sebagian besar audiens pergi ke situs dari perangkat seluler.  Beberapa metode animasi tertinggal bahkan di Chrome pada komputer papan atas, tetapi harus berfungsi dengan lancar pada smartphone biasa. </p><br><p>  Pengembang kami menggunakan sejumlah besar teknik yang membantu mengoptimalkan situs dan mempercepat pekerjaannya.  Saya mengumpulkan 4 yang paling menarik dari mereka.  Kami berbagi pengetahuan yang akan berguna bagi pemula dan profesional, serta memberikan tautan ke tutorial yang bermanfaat. </p><br><p><img src="https://habrastorage.org/webt/1e/2e/ic/1e2eic7lnnlwnm22gy1y2ah8zto.jpeg"></p><a name="habracut"></a><br><h2 id="1-animaciya-na-scss">  1. Animasi di SCSS </h2><br><p>  <strong>Situs ini memiliki banyak animasi.</strong>  <strong>Kami membutuhkan browser untuk memainkannya dengan frame rate stabil 60 fps.</strong>  <strong>Dalam CSS murni, ini sulit dilakukan, jadi kami menggunakan SCSS.</strong> </p><br><p>  Untuk membuat bilah geser, kami menggunakan pustaka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Swiper</a> .  Untuk penggeser horizontal, penggunaan pustaka ini dibenarkan, karena kami perlu memberikan dukungan untuk svayp dari pengguna.  Tetapi untuk korsel tak berujung vertikal, Swiper tidak diperlukan, tidak ada interaksi pengguna.  Karena itu, kami ingin mengulangi fungsionalitas yang sama hanya menggunakan fitur CSS. </p><br><p>  Kondisi pertama dan paling penting ketika bekerja dengan animasi CSS adalah hanya menggunakan properti transform dan opacity.  Browser dapat secara mandiri mengoptimalkan animasi dari properti ini dan menghasilkan 60 fps yang stabil.  Namun, menggunakan @keyframe saja tidak mungkin untuk menulis animasi yang berbeda untuk elemen yang berbeda, dan menjiwai setiap elemen secara individual dalam CSS murni terlalu memakan waktu.  Bagaimana cara cepat menulis animasi yang kita butuhkan?  Kami memilih SCSS, dialek SASS - ekstensi CSS yang lebih fungsional. </p><br><p>  Mari kita menganalisis penggunaan SCSS menggunakan contoh slider vertikal kami. </p><br><p><img src="https://habrastorage.org/webt/bt/si/ia/btsiiagvb3utwdiuf4hasoszp7a.gif"></p><br><p>  Yang kami miliki ada wadah yang tingginya sama dengan tinggi tiga elemen korsel.  Di dalamnya ada wadah lain yang berisi semua elemen korsel. </p><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper slider-items"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Kami menghapus visibilitas elemen kontainer yang akan melampaui itu dan mengatur ketinggian blok. </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider { position: relative; overflow: hidden; height: $itemHeight * 3; .vertical-carousel-slider-item { height: $itemHeight; } }</code> </pre> <br><p>  Perhitungan animasi berubah hanya jika jumlah elemen dalam korsel berubah.  Selanjutnya, kami menulis mixin yang mengambil satu parameter input - <code>$itemCount</code> </p><br><pre> <code class="plaintext hljs">@mixin verticalSlideAnimation($itemCount) { }</code> </pre> <br><p>  Di mixin, buat keyframe untuk setiap elemen, atur status awal untuk itu, dan gunakan <code>:nth-child</code> menentukan animasi untuk elemen. </p><br><pre> <code class="plaintext hljs">for $i from * 1 through $itemCount { $animationName: carousel-item-#{$itemCount}-#{$i}; @keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } } .vertical-carousel-slider-item:nchild(#{$i}) { animation: $stepDuration * $itemCount $animation ease infinite; } }</code> </pre> <br><p>  Selanjutnya, selama animasi, kita hanya akan memindahkan elemen di sepanjang sumbu y dan mengubah skala untuk elemen di tengah. </p><br><p>  Status elemen korsel: </p><br><ol><li>  Damai </li><li>  Y offset </li><li>  Y offset </li><li>  Y diimbangi dengan penurunan </li></ol><br><p>  Setiap item akan naik <code>$itemCount</code> kali, naik satu kali dan turun satu kali selama pergerakan.  Oleh karena itu, kami akan membuat dan menghitung animasi untuk setiap gerakan ke atas. </p><br><pre> <code class="plaintext hljs">@keyframes #{$animationName} { 0% { transform: translate3d(0, 0, 0) scale(.95); } @for $j from 0 through $itemCount { $isFocusedStep: $i == $j + 2; $isNotPrevStep: $i != $j + 1; $offset: 100% / $itemCount * ($animationTime / $stepDuration); @if ($isFocusedStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount, $offset)} { transform: getTranslate($j) scale(1); } #{getPercentForStep($j + 1, $itemCount)} { transform: getTranslate($j + 1) scale(.95); } } @else if ($isNotPrevStep) { #{getPercentForStep($j, $itemCount, $offset)} { transform: getTranslate($j - 1) scale(.95); } #{getPercentForStep($j, $itemCount)} { transform: getTranslate($j) scale(.95); } } } }</code> </pre> <br><p>  Tetap mendefinisikan beberapa variabel dan fungsi: </p><br><ul><li>  <code>$animationTime</code> - gerakan tween time </li><li>  <code>$stepDuration</code> - total waktu eksekusi dari satu langkah animasi ( <code>$animationTime</code> + waktu istirahat korsel) </li><li>  <code>getPercentForStep($step, $itemCount, $offset)</code> - fungsi yang mengembalikan dalam persen titik ekstrim dari salah satu negara. </li><li>  <code>getTranslate($step)</code> - mengembalikan terjemahan tergantung pada langkah animasi </li></ul><br><p>  Contoh implementasi fungsi: </p><br><pre> <code class="plaintext hljs">@function getPercentForStep($step, $count, $offset: 0) { @return 100% * $step / $count - $offset; } @function getTranslate($step) { @return translate3d(0, -100% * $step, 0); }</code> </pre> <br><p>  Kami memiliki korsel yang berfungsi dengan elemen yang meningkat di tengah.  Tetap membuat bayangan di bawah elemen yang meningkat.  Awalnya, setiap elemen carousel memiliki elemen pseudo: after, yang pada gilirannya memiliki bayangan.  Agar tidak menganimasikan properti bayangan, kami menggunakan properti opacity untuk itu, mis.  hanya menunjukkan dan menyembunyikan bayangannya. </p><br><p>  Tetapi dalam implementasi baru untuk solusi seperti itu, Anda perlu menghasilkan banyak kerangka kunci tambahan untuk setiap elemen pseudo.  Kami memutuskan untuk melakukannya dengan lebih mudah: akan ada satu blok dengan bayangan dan itu akan menempati ruang tepat di bawah elemen tengah korsel. </p><br><p>  Tambahkan div yang bertanggung jawab atas bayangan. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-vertical-carousel-slider"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-item"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical-carousel-slider-shadow"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Kami menyesuaikan dgn mode dan menambahkan animasi. </p><br><pre> <code class="plaintext hljs">@keyframes shadowAnimation { 0% { opacity: 1; } 80% { opacity: 1; } 90% { opacity: 0; } 100% { opacity: 1; } } .vertical-carousel-slider-shadow { top: $itemHeight; left: 0; right: 0; height: $itemHeight; animation: $stepDuration shadowAnimation ease infinite; }</code> </pre> <br><p>  Dalam hal ini, Anda tidak perlu membuat dan memikirkan cara untuk menghidupkan bayangan di bawah setiap elemen, kami hanya menganimasikan satu blok, ia memiliki dua status - terlihat dan disembunyikan </p><br><p>  Hasilnya, kami memiliki korsel CSS murni yang menjiwai hanya dengan properti yang dioptimalkan dengan baik.  Ini memungkinkan browser untuk menggunakan akselerasi perangkat keras untuk rendering.  Karenanya, laba nyata dibandingkan dengan animasi JS: </p><br><ol><li>  Saat menggulir halaman dengan animasi pada perangkat yang lemah, frame dengan jelas dilompati dalam animasi JS, menjatuhkan FPS ke 15-20.  Animasi CSS jelas meningkatkan hal-hal.  Pada perangkat ini, angka ini setidaknya 50-55 FPS. </li><li>  Kami menyingkirkan pekerjaan modul pihak ketiga di mana tidak diperlukan. </li><li>  Animasi akan diputar bahkan ketika JS dinonaktifkan </li></ol><br><p>  Animasi JS harus digunakan jika kontrol ketat atas setiap frame diperlukan: jeda, putar balik, mundur, reaksi terhadap tindakan pengguna.  Dalam kasus lain, kami sarankan menggunakan CSS murni. </p><br><p>  <strong>Tautan yang bermanfaat</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan animasi kabur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan untuk Properti CSS dan Tugas Browser</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan Animasi Bayangan</a> </li></ul><br><h2 id="2-ispolzovanie-intersection-observer-api">  2. Menggunakan API Pengamat titik-temu </h2><br><p>  <strong>Animasi yang tidak dilihat pengunjung situs diputar di suatu tempat yang tidak terlihat dan memuat CPU.</strong>  <strong>Menggunakan Pengamat Persimpangan, kami menentukan jenis animasi apa yang terlihat di layar sekarang, dan hanya memutarnya.</strong> </p><br><p>  Semua trik dari paragraf terakhir dapat dikombinasikan dengan Pengamat titik-temu.  Alat ini membantu untuk tidak memuat peramban dengan animasi yang tidak dilihat pengunjung situs.  Sebelumnya, ‚Äúpendengar‚Äù intensif sumber daya digunakan untuk memahami apakah pengunjung melihat elemen animasi dan ini tidak menghasilkan ‚Äúknalpot‚Äù yang kuat.  Perbedaan antara menggunakan animasi di luar viewport dan menggunakan pendengar sangat minim.  Intersection Observer API membutuhkan lebih sedikit sumber daya dan membantu memainkan hanya animasi yang terlihat oleh pengunjung. </p><br><p>  Di situs kami, animasi hanya diaktifkan ketika elemen muncul di viewport.  Jika kami tidak melakukan ini, maka halaman akan kelebihan beban dengan eksekusi terus menerus dari animasi pengulangan yang tetap tidak terlihat.  Intersection Observer API memungkinkan Anda untuk memantau persimpangan elemen dengan induk atau ruang lingkup dokumen. </p><br><p>  <strong>Contoh implementasi</strong> </p><br><p>  Sebagai contoh, kami menunjukkan cara mengoptimalkan animasi di JS.  Idenya sederhana - animasi dimainkan saat elemen animasi ada di viewport.  Untuk implementasi, kami menggunakan API Pengamat titik-temu. </p><br><p>  Tambahkan penanganan kelas yang <code>is-paused</code> pada gaya </p><br><pre> <code class="plaintext hljs">.b-vertical-carousel-slider.is-paused { .vertical-carousel-slider-wrapper { .vertical-carousel-slider-item { animation-play-state: paused; } } .vertical-carousel-slider-shadow { animation-play-state: paused; } }</code> </pre> <br><p>  Yaitu  ketika kelas ini muncul, animasi akan dijeda. </p><br><p>  Sekarang kami menjelaskan logika menambah dan menghapus kelas ini </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.IntersectionObserver) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> el = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.b-vertical-carousel-slider'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntersectionObserver(intersectionObserverCallback); observer.observe(el); }</code> </pre> <br><p>  Di sini kami membuat instance IntersectionObserver, menentukan fungsi <code>intersectionObserverCallback</code> , yang akan berfungsi ketika visibilitas berubah. </p><br><p>  Sekarang tentukan <code>intersectionObserverCallback</code> </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersectionObserverCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entries</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } helperDOM.toggleClass(el, <span class="hljs-string"><span class="hljs-string">'is-paused'</span></span>, entries[<span class="hljs-number"><span class="hljs-number">0</span></span>].intersectionRatio &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>); };</code> </pre> <br><p>  Sekarang animasi dimainkan hanya pada elemen-elemen yang terlihat.  Segera setelah elemen menghilang dari bidang tampilan, animasi dijeda.  Ketika pengunjung kembali kepadanya, pemutaran akan dilanjutkan. </p><br><p>  <strong>Tautan yang bermanfaat</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Browser yang mendukung Pengamat titik-temu</a> </li><li>  Untuk browser yang tidak mendukungnya, Anda perlu menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">polyfil</a> </li></ul><br><h2 id="3-rendering-svg">  3. rendering SVG </h2><br><p>  <strong>Sejumlah besar gambar atau penggunaan sprite menyebabkan celah dan keterlambatan pada detik pertama setelah pemuatan.</strong>  <strong>Memasukkan SVG dalam kode halaman membantu secara visual membuat pemuatan menjadi lebih lancar.</strong> </p><br><p>  Ketika kami memilih metode untuk bekerja dengan gambar, kami memiliki 2 opsi optimisasi: menanamkan SVG dalam HTML atau menggunakan sprite.  Kami memutuskan untuk menanamkan.  Kami menyematkan kode XML dari setiap gambar langsung ke kode HTML halaman.  Ini sedikit meningkatkan ukurannya, tetapi SVG segera disajikan sesuai dengan dokumen. </p><br><p>  Banyak pengembang terus menggunakan sprite SVG.  Apa esensi dari metode ini: array gambar (misalnya, ikon) dikumpulkan dalam kanvas gambar besar, yang disebut sprite.  Ketika Anda perlu menunjukkan ikon tertentu, sprite dipanggil, setelah itu koordinat dari bagian tertentu di mana ia berada diberikan.  Ini telah dilakukan sejak lama, bahkan pada versi HTTP pertama.  Sprite membantu secara agresif men-cache file dan mengurangi jumlah permintaan server.  Ini penting karena banyak permintaan secara bersamaan memperlambat browser.  Menggunakan sprite SVG adalah penopang yang biasa digunakan untuk mengabaikan logika bekerja demi menghemat sumber daya.  Sekarang jumlah permintaan tidak begitu penting, jadi kami sarankan untuk menyematkan. </p><br><p>  Pertama-tama, ini memengaruhi kinerja secara positif dari sudut pandang pengunjung.  Dia melihat bagaimana ikon dimuat secara instan dan tidak menderita detik pertama setelah memuat halaman.  Saat menggunakan gambar sprite atau PNG, halaman yang memuat sedikit melambat.  Ini terutama dirasakan jika pengunjung segera menggulir halaman yang dimuat - FPS akan turun menjadi 5-15 pada perangkat non-top.  Memasukkan SVG dalam HTML membantu mengurangi latensi halaman (subyektif, dari sudut pandang klien) dan menyingkirkan jalur dan lompatan frame saat memuat. </p><br><h2 id="4-keshirovanie-s-ispolzovaniem-service-worker-i-http-cache">  4. Caching menggunakan Pekerja Layanan dan HTTP Cache </h2><br><p>  <strong>Masuk akal untuk memuat ulang halaman yang tidak berubah dan menggunakan lalu lintas pengunjung.</strong>  <strong>Ada banyak strategi caching, kami memutuskan pada kombinasi yang paling efisien.</strong> </p><br><p>  Perlu mengoptimalkan penggunaan tidak hanya CPU / GPU, tetapi juga jaringan.  Perangkat seluler merupakan batasan tidak hanya dalam hal sumber daya, tetapi juga dalam hal kecepatan dan lalu lintas Internet.  Caching membantu kami di sini.  Ini memungkinkan Anda untuk menyimpan respons terhadap permintaan HTTP dan menggunakannya tanpa menerima respons dari server lagi. </p><br><p>  Ketika kami mempertimbangkan strategi caching, kami memilih untuk menggunakan Pekerja Layanan dan HTTP Cache pada saat yang sama.  Mari kita mulai dengan yang pertama dan lebih maju.  Service Worker adalah file js yang dapat mengontrol halaman atau file, memotong dan memodifikasi permintaan, serta permintaan cache secara terprogram.  Ini bertindak sebagai proksi antara situs dan server dan menentukan perilaku offline mereka.  Semua ini dilakukan di "depan", tanpa menghubungkan "backend". </p><br><p>  Pekerja Layanan memiliki variabilitas yang luar biasa.  Kita dapat memprogram perilaku itu sesuka kita.  Misalnya, kita tahu bahwa pengunjung yang membuka halaman nomor 1, dengan probabilitas 90% akan masuk ke halaman nomor 2.  Kami meminta SW untuk memuat halaman kedua dengan latar belakang saat pengunjung masih di halaman pertama.  Ketika dia pergi ke sana, halaman akan dimuat secara instan.  Ini dapat digunakan untuk berbagai tugas: </p><br><ul><li>  Sinkronisasi data latar belakang </li><li>  Kalkulator offline </li><li>  Templating khusus </li><li>  Reaksi terhadap waktu dan tanggal tertentu. </li></ul><br><p>  File Pekerja Layanan dapat dibuat di berbagai layanan.  Kami merekomendasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Workbox</a> .  Ini cukup sederhana dan memungkinkan Anda untuk membuat seperangkat aturan dengan mana caching dilakukan, misalnya, precache. </p><br><p>  Pekerja layanan tidak mendukung semua browser, seperti IE, Safari, atau Chrome sebelum versi 40.0.  Jika perangkat tidak dapat bekerja dengannya, ini mengikuti aturan cache HTTP Cache.  Kami menambahkan header HTTP berikut ke halaman: </p><br><pre> <code class="plaintext hljs">cache-control: no-cache last-modified: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  Dalam hal ini, browser menambahkan respons ke permintaan ke repositori, tetapi setiap permintaan berikutnya mengirimkan header untuk memeriksa perubahan. </p><br><pre> <code class="plaintext hljs">if-modified-since: Mon, 06 May 2019 04:26:29 GMT</code> </pre> <br><p>  Jika tidak terjadi perubahan, browser menerima respons dengan kode 304 Tidak dimodifikasi dan menggunakan konten yang disimpan dalam cache.  Jika ada perubahan pada dokumen, respons dikembalikan dengan kode 200 dan respons baru ditulis ke penyimpanan browser. </p><br><p>  Beberapa saat kemudian, kami mengubah metode caching dan memeriksa jumlah hash dalam nama file.  Ini memastikan bahwa sumber daya akan tetap unik.  Karenanya, kami dapat men-cache konten secara agresif.  Header berikut ditambahkan sebagai tanggapan: </p><br><pre> <code class="plaintext hljs">Cache-control:max-age=31536000, immutable</code> </pre> <br><p>  Max-age menunjukkan waktu caching maksimum, dalam kasus kami adalah 1 tahun.  Nilai abadi berarti bahwa jawaban seperti itu tidak perlu diperiksa untuk perubahan. </p><br><p>  <strong>Tautan yang bermanfaat</strong> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/">Manual Caching HTTP</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan Penggunaan API Pekerja Layanan</a> </li></ul><br><p>  Ini bukan cara untuk mengoptimalkan situs.  Ini dapat menambahkan penolakan bootstrap, mengurangi jumlah elemen dan acara DOM, dan banyak lagi.  Tetapi ini adalah tips yang membantu kami membuat situs menjadi cepat dan responsif, meskipun animasi dalam jumlah besar. </p><br><h3 id="priglashaem-v-nashu-komandu">  Kami mengundang Anda ke tim kami </h3><br><p>  Kami selalu mencari spesialis keren di kantor kami di St. Petersburg untuk tugas ambisius kami: pengembang, penguji, perancang.  Di bawah ini ada lowongan - bergabunglah dengan kami. </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengembang frontend</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Insinyur QA</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Insinyur pengembangan perangkat lunak dalam pengujian</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id455700/">https://habr.com/ru/post/id455700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id455686/index.html">Bagaimana Memilih Alat Manajemen Proyek Terbaik Jika Anda Seorang Milenial?</a></li>
<li><a href="../id455692/index.html">ASZP: restyling atau teater dimulai dengan gantungan</a></li>
<li><a href="../id455694/index.html">Arsitektur Penagihan Generasi Selanjutnya: Transisi ke Tarantool</a></li>
<li><a href="../id455696/index.html">Keadaan elektronik masa depan. Bagian 2</a></li>
<li><a href="../id455698/index.html">Buku "Bagaimana JavaScript Bekerja"</a></li>
<li><a href="../id455702/index.html">Pembuatan angka efektif dalam interval yang diberikan</a></li>
<li><a href="../id455710/index.html">Mengapa kita di Leroy Merlin membutuhkan departemen pengembangan Rusia kita sendiri untuk 200 orang</a></li>
<li><a href="../id455714/index.html">Ekspor Formulir Google secara otomatis ke Notion menggunakan IFTTT dan Django</a></li>
<li><a href="../id455716/index.html">15 Praktik Terbaik untuk Menyebarkan Perangkat Lunak Business Intelligence</a></li>
<li><a href="../id455720/index.html">Bagaimana kami membangun UI untuk sistem iklan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>