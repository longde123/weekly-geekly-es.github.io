<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç§ üë®üèª‚Äçüéì ü§ôüèø BASS - uma estrutura para s√≠ntese autom√°tica de assinaturas de antiv√≠rus ü§ôüèΩ üëÉüèº üë®‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal. Faltam menos de dez dias para o in√≠cio do curso de "Engenharia Reversa" . Nesse sentido, queremos compartilhar outra tradu√ß√£o interessant...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BASS - uma estrutura para s√≠ntese autom√°tica de assinaturas de antiv√≠rus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/456426/">  Ol√° pessoal.  Faltam menos de dez dias para o in√≠cio do curso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Engenharia Reversa"</a> . Nesse sentido, queremos compartilhar outra tradu√ß√£o interessante sobre o assunto.  Vamos l√°! <br><br><img src="https://habrastorage.org/webt/ff/sk/na/ffsknagvtnwxc02g9xpjlu-0p1i.png"><br><br><h2>  Breve revis√£o </h2><br><img src="https://habrastorage.org/webt/hi/fs/gs/hifsgsy2jdczl7lk9n3zj1luisy.png"><br><br>  A imagem das amea√ßas est√° mudando rapidamente - novos ataques cibern√©ticos est√£o constantemente aparecendo e os antigos est√£o se tornando mais sofisticados.  Nessas circunst√¢ncias, os profissionais de seguran√ßa enfrentam desafios cada vez mais complexos.  Todos os dias eles precisam processar e analisar milh√µes de amostras de malware anteriormente desconhecido e completamente novo, desenvolver assinaturas antiv√≠rus eficazes para descrever fam√≠lias inteiras de programas maliciosos e garantir a escalabilidade das ferramentas √† medida que o n√∫mero de amostras para an√°lise aumenta.  Ao mesmo tempo, √© necess√°rio levar em conta os recursos limitados para ferramentas de automa√ß√£o de an√°lise de malware.  Para ajudar os profissionais de TI a lidar com esses diversos desafios, o Talos oferece uma nova plataforma de c√≥digo aberto chamada BASS. <a name="habracut"></a><br><br>  O BASS (lido como ‚Äúbaixo‚Äù) √© uma estrutura para gerar automaticamente assinaturas de antiv√≠rus com base em amostras de clusters de c√≥digos maliciosos formados anteriormente.  Ele visa reduzir o consumo de recursos pelo n√∫cleo do ClamAV, aumentando a propor√ß√£o de assinaturas baseadas em modelo em rela√ß√£o √†s assinaturas de hash e simplificar o trabalho dos analistas no desenvolvimento de assinaturas baseadas em modelo.  Com o suporte ao cont√™iner do Docker, a estrutura √© bem dimensionada. <br><br>  Vale a pena notar que at√© agora apenas a vers√£o alfa do BASS est√° dispon√≠vel e ainda h√° muito a ser finalizado.  Este projeto tem c√≥digo-fonte aberto e estamos trabalhando ativamente nele, por isso teremos o maior prazer em receber coment√°rios da comunidade e recomenda√ß√µes para sua melhoria.  O c√≥digo fonte do BASS est√° dispon√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  O projeto BASS foi anunciado em 2017 na confer√™ncia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">REcon</a> em Montreal, Canad√°. <br><br><h2>  Relev√¢ncia </h2><br>  Os especialistas da Talos recebem mais de 1,5 milh√£o de amostras exclusivas diariamente.  Na maioria das vezes, eles se relacionam a amea√ßas conhecidas e s√£o imediatamente eliminados por um scanner de malware (ClamAV).  No entanto, ap√≥s a verifica√ß√£o, existem muitos arquivos que ainda precisam de an√°lises adicionais.  N√≥s os executamos na sandbox e realizamos an√°lises din√¢micas, o que nos permite separ√°-las em maliciosas e seguras.  Processamos as amostras de malware selecionadas nesse est√°gio para criar assinaturas do ClamAV com base nelas, o que ajudar√° a filtrar ainda mais essas amea√ßas em um est√°gio anterior, durante a verifica√ß√£o. <br><br><img src="https://habrastorage.org/webt/5f/oh/6o/5foh6op04xmtrj7-7wuhy0ifkfm.jpeg"><br><br>  Durante tr√™s meses, de fevereiro a abril de 2017, foram adicionadas 560.000 novas assinaturas ao banco de dados ClamAV, ou seja, um aumento de 9.500 assinaturas por dia.  Uma parte significativa deles recebemos automaticamente na forma de assinaturas de hash.  Essas assinaturas t√™m uma desvantagem significativa em compara√ß√£o com as assinaturas de modelo ou bytecode (esses s√£o outros dois tipos suportados pelo n√∫cleo do ClamAV): uma assinatura de hash corresponde a apenas um arquivo.  Al√©m disso, um aumento no n√∫mero de assinaturas de hash leva ao fato de que o banco de dados ClamAV ocupa mais mem√≥ria.  √â por isso que preferimos assinaturas baseadas em padr√µes.  Eles s√£o muito mais simples e r√°pidos de gerenciar que o bytecode e, ao mesmo tempo, permitem que voc√™ descreva grupos inteiros de arquivos. <br><br><h2>  Baixo </h2><br>  A estrutura do BASS foi projetada para facilitar a cria√ß√£o de modelos baseados em assinatura do ClamAV.  Ele os gera automaticamente, processando segmentos de c√≥digo execut√°vel bin√°rio. <br><br><img src="https://habrastorage.org/webt/ce/jt/ew/cejtew2tpxdzibmmqztxp88tija.jpeg"><br><br>  O BASS usa como base clusters de c√≥digos maliciosos, mas n√£o inclui os meios para cri√°-los.  Devido a isso, a tecnologia permanece conveniente e flex√≠vel.  Intencionalmente, tornamos a interface de entrada universal, para facilitar a adapta√ß√£o a novas fontes de clusters.  Agora usamos v√°rias dessas fontes, incluindo clusters baseados em indicadores de comprometimento (IoC) de nossa caixa de prote√ß√£o, hash estrutural (quando temos um arquivo execut√°vel maliciosamente intencional e estamos procurando por amostras adicionais com estrutura semelhante a ele) e malware recebido de campanhas de spam. <br><br>  No primeiro est√°gio, inst√¢ncias maliciosas passam pelos descompactadores do kernel ClamAV.  Ele pode descompactar arquivos de v√°rios formatos e arquivos execut√°veis ‚Äã‚Äãcompactados (por exemplo, UPX) e tamb√©m extrair objetos incorporados (como arquivos EXE nos documentos do Word).  Os artefatos recebidos s√£o cuidadosamente analisados, as informa√ß√µes est√£o sendo coletadas.  Agora, para o pr√≥ximo est√°gio, a filtragem, usamos seus tamanhos e a seq√º√™ncia m√°gica do UNIX. <br><br>  Em seguida, o cluster de c√≥digo malicioso √© filtrado.  Se os arquivos n√£o atenderem aos requisitos do BASS (embora a plataforma funcione apenas com arquivos execut√°veis ‚Äã‚Äãdo PE, mas n√£o seja dif√≠cil adicionar suporte aos arquivos bin√°rios ELF e MACH-O), eles ser√£o exclu√≠dos do cluster ou, se houver poucos objetos restantes, o cluster ser√° completamente rejeitado. <br><br>  O cluster filtrado prossegue para a fase de gera√ß√£o de assinatura.  Primeiro, os arquivos bin√°rios s√£o desmontados.  Para fazer isso, usamos o IDA Pro, mas ele pode ser facilmente substitu√≠do por outro desmontador com recursos semelhantes, por exemplo, radare2. <br><br><img src="https://habrastorage.org/webt/cz/ah/gl/czahglwn1x_oflib8pokrduqeso.jpeg"><br><br>  Ap√≥s a desmontagem, √© necess√°rio identificar um c√≥digo comum nas amostras para gerar assinaturas em sua base.  Esta etapa √© importante por dois motivos.  Primeiro, o algoritmo de gera√ß√£o de assinaturas requer recursos computacionais significativos e funciona melhor com segmentos de c√≥digo curto.  Em segundo lugar, √© prefer√≠vel obter assinaturas de amostras de c√≥digo semelhantes, n√£o apenas sintaticamente, mas tamb√©m semanticamente.  Para comparar o c√≥digo, usamos o utilit√°rio BinDiff.  Novamente, tamb√©m √© f√°cil substituir, e no futuro poderemos integrar outros utilit√°rios na estrutura para compara√ß√£o. <br><br>  Se o cluster for pequeno, o BinDiff compara cada execut√°vel com todos os outros.  Caso contr√°rio, o escopo da compara√ß√£o ser√° reduzido, caso contr√°rio, o processo poder√° ser muito longo.  Com base nos resultados obtidos, √© constru√≠do um gr√°fico em que os v√©rtices denotam as fun√ß√µes e as arestas indicam sua similaridade.  Para encontrar uma boa fun√ß√£o geral, basta encontrar um subgr√°fico conectado com um alto √≠ndice de similaridade geral. <br><br><img src="https://habrastorage.org/webt/uz/tk/nt/uztkntwexposekzfrzoskpmfotq.jpeg"><br><br>  O subgrafo ∆í1, ∆í2, ∆í4, ∆í6 com altos indicadores de similaridade de v√©rtices (veja a figura acima) √© um excelente candidato para o papel de uma fun√ß√£o comum. <br><br>  Assim que v√°rios desses candidatos s√£o recrutados, os comparamos com a lista branca para evitar a cria√ß√£o de assinaturas com base nas fun√ß√µes comuns das bibliotecas associadas estaticamente √† amostra.  Para fazer isso, as fun√ß√µes s√£o enviadas para a inst√¢ncia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Kam1n0</a> , cujo banco de dados anteriormente preenchemos com fun√ß√µes de amostras obviamente puras.  Se um clone de qualquer fun√ß√£o for detectado, o procedimento de sele√ß√£o de subgr√°ficos √© repetido para selecionar o mais adequado dos demais.  Se a verifica√ß√£o n√£o revelar nada, o conjunto de fun√ß√µes √© passado para o pr√≥ximo est√°gio. <br><br>  Ent√£o a gera√ß√£o da assinatura come√ßa diretamente.  As assinaturas ClamAV baseadas em modelo s√£o projetadas para detectar subsequ√™ncias em dados bin√°rios.  Portanto, aplicamos a todas as fun√ß√µes extra√≠das o algoritmo de busca para a maior subsequ√™ncia comum (LCS, Longest Common Subsequence). <br><br>  Do ponto de vista computacional, esse algoritmo √© bastante caro, mesmo para duas amostras e √© visivelmente mais dif√≠cil para v√°rias, por isso usamos sua variedade heur√≠stica, descrita por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Christian Blichmann</a> .  O resultado pode ser algo como isto: <br><br><img src="https://habrastorage.org/webt/zb/9_/il/zb9_ilfd2g0rcqw1nw1h5iblsi4.jpeg"><br><br>  Por fim, voc√™ deve test√°-lo antes de publicar a assinatura.  Verificamos automaticamente a assinatura usando nosso conjunto de testes quanto a falsos positivos.  Para maior confiabilidade, usamos o Sigalyzer, um novo recurso do plug-in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CASC IDA Pro ClamAV para gerar e analisar assinaturas</a> (ele ser√° atualizado posteriormente).  O Sigalyzer marca se√ß√µes do bin√°rio que correspondem √† assinatura do ClamAV que funcionou para ele.  Assim, √© formada uma representa√ß√£o visual visual da assinatura. <br><br><h2>  Arquitetura </h2><br>  O BASS √© implementado como um cluster de cont√™ineres do Docker.  A estrutura √© escrita em Python e interage com todas as ferramentas necess√°rias por meio de servi√ßos da web.  A arquitetura foi criada por analogia com o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VxClass</a> , que tamb√©m gerou assinaturas do ClamAV usando o IDA Pro e o BinDiff, mas depois seria fechado e, ao contr√°rio do BASS, n√£o acess√≠vel ao p√∫blico em geral. <br><br><img src="https://habrastorage.org/webt/wg/ma/x2/wgmax2n6nevnscpmjx_lijw9kmq.jpeg"><br><br><h2>  Limita√ß√µes </h2><br>  O BASS trabalha exclusivamente com execut√°veis ‚Äã‚Äãbin√°rios, pois a assinatura √© gerada a partir do c√≥digo de amostra.  Al√©m disso, ele analisa apenas os execut√°veis ‚Äã‚Äãx86 e x86_64.  O suporte para outras arquiteturas pode aparecer no futuro. <br><br>  At√© agora, o BASS n√£o lida bem com v√≠rus de arquivo, que incorporam trechos de c√≥digo pequenos e muito diferentes em objetos infectados e com backdoors, consistindo principalmente em c√≥digo bin√°rio inofensivo (geralmente roubado), complementado por fun√ß√µes maliciosas.  Estamos enfrentando essas defici√™ncias trabalhando para otimizar a fase de agrupamento. <br><br>  E, mais uma vez, queremos lembr√°-lo de que o BASS est√° no est√°gio de teste alfa e at√© agora nem tudo est√° funcionando bem.  Mas esperamos que possamos beneficiar a comunidade desenvolvendo essa estrutura como um projeto de c√≥digo aberto, e teremos prazer em receber quaisquer id√©ias e cr√≠ticas. <br><br><h2>  App </h2><br>  <i>A diferen√ßa entre a maior substring comum e a maior subsequ√™ncia comum</i> <br><br>  A ilustra√ß√£o a seguir mostra a diferen√ßa entre a maior substring comum e a maior subsequ√™ncia comum.  A maior subsequ√™ncia comum √© indicada em nossa publica√ß√£o pelo acr√¥nimo em ingl√™s LCS. <br><br><img src="https://habrastorage.org/webt/ul/ww/a8/ulwwa8nqjhgoblgtzgq_kkaygfc.jpeg"><br><br>  S√≥ isso.  E j√° em 20 de junho ser√° poss√≠vel conhecer detalhadamente o programa do curso em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">casa aberta</a> , que ser√° realizada no modo de webinar. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt456426/">https://habr.com/ru/post/pt456426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt456414/index.html">Prote√ß√£o contra inc√™ndio em data centers ou como os dados s√£o armazenados</a></li>
<li><a href="../pt456416/index.html">Agile for All Book</a></li>
<li><a href="../pt456418/index.html">Uma Breve Hist√≥ria da Trapa√ßa de Jogos de V√≠deo</a></li>
<li><a href="../pt456422/index.html">An√∫ncio de uma nova vers√£o do Styled Components v5: Animal Grin</a></li>
<li><a href="../pt456424/index.html">Utreexo: compactando muito Bitcoin UTXO</a></li>
<li><a href="../pt456428/index.html">Como implementar uma abordagem de BI para an√°lise de dados: recomenda√ß√µes pr√°ticas</a></li>
<li><a href="../pt456430/index.html">A eterna quest√£o da d√≠vida t√©cnica</a></li>
<li><a href="../pt456432/index.html">Security Week 25: vulnerabilidade do Evernote e centenas de lojas on-line invadidas</a></li>
<li><a href="../pt456434/index.html">Profiss√µes do futuro: ‚ÄúQuem voc√™ trabalhar√° em Marte?‚Äù</a></li>
<li><a href="../pt456436/index.html">Tarefa JS curta para segunda-feira</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>