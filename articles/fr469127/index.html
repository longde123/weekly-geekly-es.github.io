<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè≥Ô∏è‚Äçüåà üì∑ ‚èèÔ∏è Optimisation ou comment ne pas se tirer une balle dans le pied üìÉ üë®üèª ‚ûø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonne journ√©e √† tous. Aujourd'hui, je veux vous parler d'optimisation. Qu'est-ce que c'est, pourquoi est-il n√©cessaire, et surtout, comment s'assurer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimisation ou comment ne pas se tirer une balle dans le pied</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469127/"><p>  Bonne journ√©e √† tous.  Aujourd'hui, je veux vous parler d'optimisation.  Qu'est-ce que c'est, pourquoi est-il n√©cessaire, et surtout, comment s'assurer qu'il ne fait pas douloureusement souffrir alors. </p><br><a name="habracut"></a><p>  Tout d'abord, nous comprendrons ce qu'est l'optimisation en g√©n√©ral et ce qu'est l'optimisation dans JS.  Ainsi, l'optimisation est l'am√©lioration de quelque chose selon une caract√©ristique quantitative.  JS a identifi√© quatre caract√©ristiques quantitatives pour lui-m√™me: </p><br><p>  <b>La quantit√© de code</b> - il est g√©n√©ralement admis que moins il y a de lignes de code √©crites, plus elles sont productives et meilleures.  Mon opinion est fondamentalement diff√©rente, car en √©crivant une ligne de code, vous pouvez cr√©er une telle fuite de m√©moire ou un cycle perp√©tuel que le navigateur meurt simplement. </p><br><p>  <b>La vitesse (performance)</b> est la soi-disant complexit√© de calcul, c'est-√†-dire le nombre d'actions que l'analyseur devra effectuer pour ex√©cuter l'instruction. </p><br><p>  <b>Vitesse de construction</b> - ce n'est un secret pour personne que presque aucun des projets ne peut se passer de constructeurs comme Webpack ou Gulp, donc cette caract√©ristique affiche l'exactitude des param√®tres du g√©n√©rateur de projet.  Croyez-moi, lorsque le serveur est un peu plus intelligent que le moulin √† caf√©, cela devient important. </p><br><p>  <b>R√©utilisation du code</b> - cette caract√©ristique montre √† quel point l'architecture de r√©utilisation des fonctions, composants et modules est bien construite. <br>  Examinez chacune des cat√©gories plus en d√©tail, nous analyserons les caract√©ristiques qu'elle comprend et ce dont elle d√©pend. </p><br><p>  <b>Volume de code:</b> <br><br></p><ul><li>  Doublage.  Combien de code du m√™me type a √©t√© √©crit √† diff√©rents endroits; </li><li>  Commentaires  Les commentaires dans le code sont bons, mais j'ai rencontr√© des projets dans lesquels il y avait plus de commentaires que de code; </li><li>  Manque d'unification.  Un bon exemple d'un tel probl√®me sont les fonctions similaires, qui ont des nuances en fonction de certaines propri√©t√©s. </li><li>  La pr√©sence de code mort.  Tr√®s souvent, dans les projets, il existe des fonctions de d√©bogage ou des fonctions qui ne sont pas du tout utilis√©es. </li></ul><br><p>  <b>Performances:</b> </p><br><ul><li>  Utilisation du m√©canisme de mise en cache du navigateur; </li><li>  Optimisation du code bas√©e sur les environnements dans lesquels il sera ex√©cut√©; </li><li>  La pr√©sence de fuites de m√©moire; </li><li>  Utilisation de travailleurs Web; </li><li>  Utilisation de r√©f√©rences aux √©l√©ments de l'arborescence DOM; </li><li>  Utilisation de variables globales; </li><li>  La pr√©sence d'appels r√©cursifs; </li><li>  Simplification des calculs math√©matiques. </li></ul><br><p>  <b>Vitesse de construction:</b> </p><br><ul><li>  Le nombre de d√©pendances externes; </li><li>  Conversions de code.  Cela fait r√©f√©rence au nombre de morceaux et √† leur taille, aux conversions css, au collage de fichiers, √† l'optimisation graphique et bien plus encore. </li></ul><br><p>  <b>R√©utilisation du code:</b> </p><br><ul><li>  Nombre de composants; </li><li>  R√©p√©tabilit√© des composants </li><li>  Flexibilit√© et personnalisation. </li></ul><br><p>  Comme dit dans les articles pr√©c√©dents, pour changer quelque chose, vous devez d√©terminer le point de d√©part et comprendre √† quel point tout est mauvais.  Par o√π commencer un processus aussi volumineux?  Commencez par la chose la plus simple: acc√©l√©rer le montage et r√©duire le temps de d√©passement du projet.  Vous demandez pourquoi cela vaut la peine de commencer par cela?  En raison du fait qu'ils d√©pendent les uns des autres.  R√©duire la quantit√© de code augmentera la vitesse de g√©n√©ration des g√©n√©rations et, par cons√©quent, augmentera votre productivit√©. </p><br><p>  L'optimisation du temps de construction nous introduit in√©vitablement au concept de construction ¬´√† froid¬ª - c'est le processus lorsqu'un projet d√©marre √† z√©ro et au point que toutes les d√©pendances sont affect√©es et que le code est compl√®tement recompil√©.  Ne confondez pas avec Rebild - il s'agit de reconstruire le code client sans extraire les d√©pendances externes et autres guirlandes. </p><br><p>  Augmenter la vitesse de construction de la construction aidera: </p><br><ul><li>  Utilisation d'assembleurs modernes.  Les technologies ne s'arr√™tent pas, et si vous avez le premier webpack, alors lorsque vous passez au quatri√®me, vous verrez une augmentation agr√©able qui ne fait d√©j√† rien; </li><li>  Se d√©barrasser de toutes les d√©pendances mortes.  De temps en temps, les d√©veloppeurs, essayant de trouver la v√©rit√© au fond de la bo√Æte d'acide sulfurique, oublient de nettoyer apr√®s leurs propres exp√©riences. le paquet? "  Oui, ils ne seront pas inclus dans l'assemblage lui-m√™me, mais le colis sera d√©gonfl√©.  La question est, pourquoi? </li><li>  Divisez l'assemblage en plusieurs profils en fonction de vos besoins.  Minimum deux: prod et dev.  Exemple: obfuscation de code.  Sur prod, cela est obligatoire, car moins de poids = un chargement plus rapide, mais sur l'obfuscation dev ne interf√®re et passe le temps de construction sur des manipulations inutiles; </li><li>  Parall√©lisation des diff√©rentes √©tapes d'assemblage; </li><li>  Utilisation de clients npm pouvant mettre en cache. </li></ul><br><p>  Pour acc√©l√©rer la reconstruction et la g√©n√©ration "√† froid", il faudra supprimer les commentaires inutiles et les morceaux de code morts.  Cependant, que faire si vous avez un gros projet et qu'il n'est pas possible de l'inspecter vous-m√™me?  Dans de tels cas, les analyseurs de code viennent √† la rescousse. </p><br><p>  Personnellement, j'utilise p√©riodiquement <b>SonarQube</b> , pas le meilleur, mais flexible.  Le cas √©ch√©ant, il peut apprendre les caract√©ristiques du projet.  De temps en temps, il fait des choses qui au moins se tiennent debout, au moins tombent, mais, comme tout instrument, il doit pouvoir l'utiliser et ne pas oublier d'√™tre sceptique quant √† ses propos.  Malgr√© tous ses inconv√©nients, il r√©siste √† la recherche de code mort, de commentaires, de pr√©sence de copier-coller et de petites choses, comme l'absence de comparaison stricte. </p><br><p>  La diff√©rence fondamentale entre SonarQube et ESlint / TSLint / Prettier et d'autres comme eux est qu'il v√©rifie la qualit√© du code, isole le doublage, la complexit√© du calcul et donne √©galement des recommandations sur les changements n√©cessaires.  Les analogues v√©rifient simplement le code pour les erreurs, la syntaxe et le formatage. </p><br><p>  En pratique, je suis tomb√© sur la <b>codacy</b> , un bon service avec un abonnement gratuit et payant.  Il sera utile si vous avez besoin de v√©rifier quelque chose sur le c√¥t√©, sans avoir √† d√©ployer cette ¬´moissonneuse¬ª √† la maison.  Il a une interface intuitive, une indication d√©taill√©e de ce qui ne va pas avec le code et bien plus encore. </p><br><p>  Dans cet article, je n'aborderai pas le sujet de la configuration de la build, des morceaux et du reste, car tout d√©pend des besoins du projet et du constructeur install√©.  J'en parlerai peut-√™tre dans d'autres articles. </p><br><p>  Les manipulations effectu√©es ont aid√© √† acc√©l√©rer l'assemblage - profit, mais que faire ensuite?  √âtant donn√© que les analyseurs peuvent trouver le doublage de code, il sera utile de le placer dans des modules ou composants s√©par√©s, augmentant ainsi la r√©utilisation du code. </p><br><p>  Il n'y avait qu'une seule section que nous n'avons pas touch√©e - la vitesse du code lui-m√™me.  Le m√©canisme m√™me de l'amener √† un sens de la productivit√© de celui-ci est appel√© par tout le mot d√©test√© refactoring.  Examinons de plus pr√®s ce qui vaut la peine d'√™tre refactoris√© et ce qui ne l'est pas. </p><br><p>  R√®gle de vie: si √ßa marche, ne le touchez pas, √ßa ne devrait pas vous guider dans ce processus.  La premi√®re r√®gle en informatique: faites une sauvegarde, puis vous direz merci √† vous-m√™me.  √Ä l'avant, avant d'effectuer des modifications, effectuez des tests afin de ne pas perdre de fonctionnalit√© √† l'avenir.  Alors demandez-vous - comment d√©terminer les temps de chargement et les fuites de m√©moire? </p><br><p>  Cela aidera DevTool.  Il montrera non seulement une fuite de m√©moire, vous indiquera le temps de chargement de la page, le rabattement de l'animation, et si vous avez de la chance, il effectuera un audit pour vous, mais ce n'est pas exact.  DevTools a √©galement une fonctionnalit√© int√©ressante, telle que la limitation de la vitesse de t√©l√©chargement, qui vous permettra de pr√©dire la vitesse de chargement des pages avec une mauvaise connexion Internet. </p><br><p>  Nous avons pu identifier les probl√®mes, maintenant r√©solvons-les! </p><br><p>  Pour commencer, nous allons r√©duire le temps de chargement en utilisant le m√©canisme de mise en cache du navigateur.  Le navigateur peut tout mettre en cache et ensuite fournir √† l'utilisateur les donn√©es du cache.  Localstorage et sessionstorage que personne ne vous a pris.  Ils vous permettent de stocker certaines des donn√©es qui aident √† acc√©l√©rer le SPA lors des t√©l√©chargements ult√©rieurs et √† r√©duire les demandes de serveur inutiles. </p><br><p>  Il est jug√© n√©cessaire d'optimiser le code en fonction de l'environnement dans lequel il sera ex√©cut√©, mais comme le montre la pratique, il consomme beaucoup de temps et d'efforts, sans apporter une augmentation tangible.  Je propose de ne consid√©rer cela que comme une recommandation. <br>  Il est naturellement conseill√© d'√©liminer toutes les fuites de m√©moire.  Je ne vais pas me concentrer sur cela, je pense que tout le monde sait comment les √©liminer, et sinon, il suffit de google. </p><br><p>  Un autre de nos assistants est un webworker.  Les travailleurs Web sont des threads appartenant √† un navigateur qui peuvent √™tre utilis√©s pour ex√©cuter du code JS sans bloquer la boucle d'√©v√©nements.  Les travailleurs Web peuvent effectuer des t√¢ches lourdes et longues sur le plan informatique sans bloquer le flux de l'interface utilisateur.  En effet, lorsqu'ils sont utilis√©s, les calculs sont effectu√©s en parall√®le.  Devant nous, c'est du vrai multithreading.  Il existe trois types de travailleurs Web: </p><br><ol><li>  Travailleurs d√©di√©s - Les instances de travailleurs Web d√©di√©s sont cr√©√©es par le processus principal.  Seul le processus lui-m√™me peut √©changer des donn√©es avec eux. </li><li>  Travailleurs partag√©s (travailleurs partag√©s) - L'acc√®s √† un travailleur partag√© peut √™tre obtenu par n'importe quel processus ayant la m√™me source que le travailleur (par exemple, diff√©rents onglets du navigateur, iframe et d'autres travailleurs partag√©s). </li><li>  Les travailleurs des services sont des travailleurs √©v√©nementiels enregistr√©s en utilisant leur source et leur chemin d'acc√®s.  Ils peuvent contr√¥ler la page Web √† laquelle ils sont li√©s en interceptant et en modifiant les commandes de navigation et les demandes de ressources, et en mettant en cache des donn√©es qui peuvent √™tre contr√¥l√©es tr√®s pr√©cis√©ment.  Tout cela nous donne d'excellents outils pour contr√¥ler le comportement de l'application dans une certaine situation (par exemple, lorsque le r√©seau n'est pas disponible). </li></ol><br><p>  Comment travailler avec eux peut √™tre facilement trouv√© sur Internet. </p><br><p>  Nous avons en quelque sorte compris les approches et les probl√®mes des tiers, maintenant je propose de parler du code lui-m√™me. </p><br><p>  Tout d'abord, essayez de vous d√©barrasser des appels directs √† l'arborescence DOM, car cette op√©ration prend du temps.  Imaginons que vous manipuliez constamment une sorte d'objet dans votre code.  Au lieu de travailler avec cet objet par r√©f√©rence, vous tirez constamment l'arborescence DOM pour rechercher cet √©l√©ment et travailler avec, et nous impl√©mentons le mod√®le de mise en cache dans le code. </p><br><p>  La deuxi√®me √©tape consiste √† se d√©barrasser des variables globales.  ES6 nous a donn√© une merveilleuse invention de l'humanit√© appel√©e variables de bloc (en termes simples, d√©clarations de variables de <b>var</b> √† <b>let</b> et <b>const</b> ). </p><br><p>  Et enfin, le plus d√©licieux.  Ici, malheureusement, tout le monde n'a pas assez d'exp√©rience pour comprendre la nuance.  Je suis contre l'utilisation de fonctions r√©cursives.  Oui, ils r√©duisent la quantit√© de code √©crit, mais cela ne peut pas se passer d'un hic: souvent ces fonctions r√©cursives n'ont pas de conditions de sortie, elles sont simplement oubli√©es.  Comme dans l'adage ¬´on peut se casser un doigt avec un marteau, mais ce n'est pas un probl√®me de marteau, mais un propri√©taire de doigt¬ª ou une blague sur les chats: les fonctions r√©cursives ne sont pas mauvaises, il faut pouvoir les cuisiner. </p><br><p>  Malgr√© toute la puissance des applications frontales modernes, vous ne devez pas oublier les bases.  Un exemple clair de gaspillage et d'irrationalit√© est l'ajout de nouveaux √©l√©ments au d√©but du tableau.  Qui sait, il a compris, et celui qui ne sait pas - maintenant je vais le dire.  Tout le monde sait que les √©l√©ments de tableau ont leur propre index, et lorsque nous allons ajouter un nouvel √©l√©ment de tableau √† son d√©but, la s√©quence d'actions sera la suivante: </p><br><ol><li>  D√©finition de la longueur du tableau </li><li>  Num√©rotation de chaque √©l√©ment. </li><li>  D√©calage de chaque √©l√©ment du tableau </li><li>  Ins√©rer un nouvel √©l√©ment dans un tableau </li><li>  R√©indexation des √©l√©ments du tableau. </li></ol><br><p>  <b>R√©sum√©:</b> </p><br><p>  Il est temps d'arr√™ter, et pour ceux qui sont √† l'aise avec le format des m√©mos, gardez une liste d'√©tapes gr√¢ce auxquelles vous pouvez comprendre √† quel stade d'optimisation vous √™tes maintenant et que faire ensuite: </p><br><ol><li>  Nous d√©terminons combien tout est bon / mauvais, supprimons les mesures. </li><li>  Nous supprimons tout ce qui n'est pas n√©cessaire: d√©pendances inutilis√©es, code mort, commentaires inutiles. </li><li>  Nous personnalisons et acc√©l√©rons le temps d'assemblage, configurons diff√©rents profils pour les contours. </li><li>  Nous analysons le code et d√©cidons quelles parties nous allons optimiser et r√©√©crire. </li><li>  Nous √©crivons des tests pour √©viter la perte de fonctionnalit√©. </li><li>  Nous commen√ßons le refactoring, nous d√©barrassons des variables globales, des fuites de m√©moire, du doublage de code et d'autres ordures, et n'oublions pas la mise en cache. </li><li>  Nous simplifions la complexit√© des calculs et apportons tout ce qui est possible au web travailleur. </li></ol><br><p>  Tout n'est pas aussi compliqu√© qu'il n'y para√Æt √† premi√®re vue.  Votre s√©quence sera probablement diff√©rente de la mienne, ne serait-ce que parce que vous avez votre propre t√™te sur les √©paules.  Vous ajouterez de nouveaux √©l√©ments ou, √† l'inverse, r√©duirez leur nombre, mais la base de la liste sera similaire.  J'ai sp√©cifiquement d√©crit la division afin que cette activit√© puisse √™tre men√©e en parall√®le avec le travail principal.  Souvent, le client n'est pas pr√™t √† payer pour les retouches, d'accord? </p><br><p>  <b>Et enfin.</b> </p><br><p>  Je crois en toi et tu r√©ussiras.  Pensez-vous que je suis na√Øf?  Je suppose que vous serez surpris, mais depuis que vous avez trouv√© cet article, lisez-le jusqu'au bout, cela signifie (j'ai de bonnes nouvelles pour vous) que vous avez des cerveaux et que vous essayez de les d√©velopper.  Je vous souhaite du succ√®s dans une entreprise aussi difficile que l'optimisation du front! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr469127/">https://habr.com/ru/post/fr469127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr469111/index.html">Remplacer l'objet par var: qu'est-ce qui pourrait mal tourner?</a></li>
<li><a href="../fr469115/index.html">Guide Discovery.js: D√©marrage rapide</a></li>
<li><a href="../fr469117/index.html">Programmation sous BC 0010 en 2019</a></li>
<li><a href="../fr469119/index.html">Les adresses IPv4 dans RIPE sont termin√©es. Compl√®tement termin√© ...</a></li>
<li><a href="../fr469125/index.html">Th√®me sombre de Thunderbird comme raison d'ex√©cuter un analyseur de code</a></li>
<li><a href="../fr469129/index.html">En raison du th√®me sombre, Thunderbird a d√ª ex√©cuter un analyseur de code</a></li>
<li><a href="../fr469131/index.html">G√©nie</a></li>
<li><a href="../fr469133/index.html">Quels gadgets Amazon a-t-il introduits lors de son Hardware Event 2019</a></li>
<li><a href="../fr469135/index.html">Id√©es fausses courantes sur la POO</a></li>
<li><a href="../fr469137/index.html">Le cerveau est la derni√®re fronti√®re de la vie priv√©e</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>