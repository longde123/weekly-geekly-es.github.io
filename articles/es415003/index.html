<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📦 🧑🏽 👦🏿 Carga de archivos sin restricciones en Apple.com 👃🏿 💼 🧜🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Atención: esta es una traducción frívola de una nota sobre exactamente cómo Jonathan Bouman encontró el AWS S3 público, que se utilizó en uno de los s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Carga de archivos sin restricciones en Apple.com</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415003/"> Atención: esta es una <u>traducción frívola de una</u> nota sobre exactamente cómo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jonathan Bouman</a> encontró el AWS S3 público, que se utilizó en uno de los subdominios de apple.com.  Además, la nota es buena porque demuestra los beneficios de varias pequeñas utilidades junto con la paciencia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e31/c98/793/e31c98793f41314f4fc544503f2803de.gif"><br><a name="habracut"></a><br>  Toma café y comienza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aquatone</a> .  Esta utilidad puede detectar subdominios en un dominio dado usando fuentes abiertas y fuerza bruta con un diccionario. <br><br><img src="https://habrastorage.org/webt/74/w6/pi/74w6pis7qxygs0akdl4spqcomfi.png"><br><br>  Aquatone tiene cuatro equipos diferentes: <br><br><ol><li>  Aquatone-discover - busca varios subdominios </li><li>  Aquatone-scan: escanea el resultado del elemento 1.  para abrir puertos </li><li>  Aquatone-recolectar: ​​crea capturas de pantalla de cada subdominio y recopila todos los resultados en un informe html </li><li>  Aquatone-takeover: intenta encontrar subdominios inactivos alojados por hosts externos.  ¿Encontraste uno?  ¡Regístrese y obtenga su recompensa! </li></ol><br><img src="https://habrastorage.org/webt/tp/tu/l6/tptul6mj8p2h5acita-m9ku-usg.png"><br>  <sup>Informe de salida de Aquatone</sup> <br>  Nos sentamos, esperamos, soñamos. <br><br>  Por lo general, lleva unos minutos buscar, escanear y recopilar. <br>  ¿Qué hay de Apple.com?  Tomó 30 minutos, 84 informes, 18k hosts únicos. <br><br>  ¿Somos los primeros en usar aquatone para el análisis de apple.com?  Definitivamente no.  ¿Han leído otras personas las 84 páginas?  Definitivamente no. <br><br>  Comience con la página 50 y lea solo las últimas 34 páginas. <br><br>  <b>Buscar anomalías de patrones</b> <br><br>  Después de 50 minutos de lectura de informes, se nota una plantilla.  Una de ellas es que apple.com a veces usa AWS S3 para almacenar archivos utilizados por sus subdominios.  Por lo tanto, si puede obtener acceso de escritura a uno de S3, puede proporcionar acceso a uno de los subdominios de apple.com. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba6/63e/31c/ba663e31cf3c690db10fdbaa8a306bc1.gif"><br><br>  Leer todos los informes 84x es aburrido.  Todos los informes contienen encabezados http enviados por el servidor.  S3: siempre envía el encabezado X-Amz-Bucket-Region.  Busque este título en los informes: <br><br><img src="https://habrastorage.org/webt/sc/ra/qd/scraqd7fwockju7te9wqwck5vvu.png"><br><br>  Ahora se debe hacer clic en cada uno manualmente para ver qué sucederá si abre la URL.  Casi todos los subdominios dan acceso denegado. <br><br><img src="https://habrastorage.org/webt/4c/2r/lf/4c2rlfg1db6ublcdugpwnufyhgk.png"><br><br>  Excepto uno: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">live-promotions.apple.com</a> <br><br><img src="https://habrastorage.org/webt/wt/-v/la/wt-vla7xye3kfleiqhmhvtr0hmu.png"><br>  <sup>Respuesta S3, que contiene el nombre del depósito y el contenido del directorio.</sup> <br><br>  Entonces ahora está el nombre S3 Bucket.  Esto le permite conectarse directamente a él. <br><br>  Cómo acceder, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ver aquí</a> . <br><br>  Debe instalar la interfaz de línea de comandos de AWS y puede intentar abrir este depósito con el nombre de la respuesta anterior. <br><br>  Después de eso, puede intentar descargar la página de inicio de sesión falsa y abrirla en el navegador. <br><br><pre><code class="hljs ruby">aws s3 cp login.html <span class="hljs-symbol"><span class="hljs-symbol">s3:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/$bucketName --grants read=uri=http:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/acs.amazonaws.com/groups</span></span><span class="hljs-regexp"><span class="hljs-regexp">/global/</span></span>AllUsers</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/e31/c98/793/e31c98793f41314f4fc544503f2803de.gif"><br>  <sup>cocinero alerta</sup> <br><br>  <b>Conclusión</b> <br>  Se obtuvo acceso completo a lectura / escritura al S3 Bucket de Apple, que está disponible en uno de sus subdominios.  Lo suficiente como para inundar el sitio de phishing o robar cookies. <br><br>  <b>Solución</b> <br>  Nunca otorgue permisos de lectura / escritura a usuarios anónimos <br>  Afortunadamente, la protección S3 es bastante simple y predeterminada. <br>  ver doc: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">docs.aws.amazon.com/AmazonS3/latest/dev/access-control-overview.html</a> <br><br>  <b>¿Qué fue eso?</b> <br><br>  - Página de phishing cargada en live-promotions.apple.com <br>  - Podrías robar cookies de visitantes <br>  - Fue posible extraer archivos confidenciales del bucket (contenía proyectos en xcode) <br><br>  <b>Salón de la fama</b> <br><br>  Después de 4 horas, recibí una respuesta de Apple confirmando el error.  Se corrigió ese día y ahora se menciona en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Salón de la Fama</a> <br><br><div class="spoiler">  <b class="spoiler_title">Carta + pantalla de la audiencia</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3f/67/xf/3f67xf9rf1umonhzjvmvasqtyoy.png"><br><img src="https://habrastorage.org/webt/6x/hu/mp/6xhump7dcssa8g1lxrps_z3noka.png"><br></div></div><br>  <b>Cronograma</b> <br><br>  19/06/2018 Descubierto y reportado error <br>  19/06/2018 Apple confirmó el error <br>  19/06/2018 Apple reparó el error <br>  22/06/2018 Apple me mencionó en el Salón de la Fama <br>  22/06/2018 Publicó este blog </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415003/">https://habr.com/ru/post/es415003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414993/index.html">Identificación y clasificación de comentarios tóxicos. Conferencia en Yandex</a></li>
<li><a href="../es414995/index.html">Notas de aficionados, o The Tale of How the Scala FPGA Developer Configured</a></li>
<li><a href="../es414997/index.html">ML-Blitz: análisis de las tareas de la primera ronda de clasificación</a></li>
<li><a href="../es414999/index.html">Probador 3D de vigilancia y termistor</a></li>
<li><a href="../es415001/index.html">El operador del automóvil robótico Uber, que derribó a un ciclista, vio el espectáculo de Voz en el momento de la colisión.</a></li>
<li><a href="../es415005/index.html">Paneles solares, comandos de voz y carreras off-road: el presente y el futuro de las bicicletas eléctricas.</a></li>
<li><a href="../es415007/index.html">Cómo configurar Bluetooth en Linux de una manera complicada</a></li>
<li><a href="../es415009/index.html">¿Quién es ese en el reclutamiento de América del Norte? Parte 1</a></li>
<li><a href="../es415011/index.html">Informe del Club de Roma 2018, Capítulo 3.10: “Impuesto sobre los ritmos”</a></li>
<li><a href="../es415015/index.html">Calificación de los empleadores de TI en Nizhny Novgorod: un estudio de las preferencias de los estudiantes de especialidades técnicas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>