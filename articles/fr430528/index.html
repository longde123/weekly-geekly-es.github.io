<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèø üë®üèø‚Äçüåæ üíä Programmation avec PyUSB 1.0 üòì üîè ü¶Ç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Du traducteur : 
 Ceci est une traduction du manuel de programmation avec PyUSB 1.0 
 Ce guide a √©t√© √©crit par les d√©veloppeurs PyUSB, mais en parcour...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmation avec PyUSB 1.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430528/">  <i><b>Du traducteur</b> :</i> <i><br></i>  <i>Ceci est une traduction du <a href="">manuel de programmation avec PyUSB 1.0</a></i> <i><br></i>  <i>Ce guide a √©t√© √©crit par les d√©veloppeurs PyUSB, mais en parcourant rapidement les commits, je crois que walac est l'auteur principal.</i> <br><br><h2>  Laisse moi me pr√©senter </h2><br>  <b>PyUSB 1.0</b> est une biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python</a> qui fournit un acc√®s facile √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">USB</a> .  PyUSB offre diverses fonctions: <br><br><ul><li>  <i><b>100% √©crit en Python:</b></i> <br>  Contrairement aux versions 0.x √©crites en C, la version 1.0 est √©crite en Python.  Cela permet aux programmeurs Python sans exp√©rience C de mieux comprendre le fonctionnement de PyUSB. </li><li> <i><b>Neutralit√© de la plateforme:</b></i> <br>  La version 1.0 inclut un sch√©ma de backend frontal.  Il isole l'API des d√©tails d'impl√©mentation sp√©cifiques au syst√®me.  L'interface <u>IBackend</u> relie ces deux couches.  PyUSB est livr√© avec des backends int√©gr√©s pour libusb 0.1, libusb 1.0 et OpenUSB.  Vous pouvez √©crire votre backend vous-m√™me si vous le souhaitez. </li><li>  <i><b>Portabilit√©:</b></i> <br>  PyUSB devrait fonctionner sur n'importe quelle plate-forme avec Python&gt; = 2.4, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ctypes</a> et au moins l'un des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">backends int√©gr√©s</a> pris en charge. </li><li>  <i><b>Simplicit√©:</b></i> <br>  L'interaction avec un p√©riph√©rique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">USB</a> n'a jamais √©t√© aussi facile!  L'USB est un protocole complexe et PyUSB a de bons pr√©r√©glages pour les configurations les plus courantes. </li><li>  <i><b>Support d'engrenage isochrone:</b></i> <br>  PyUSB prend en charge les transferts isochrones si le backend sous-jacent les prend en charge. </li></ul><br>  Bien que PyUSB rend la programmation USB moins p√©nible, ce tutoriel suppose que vous avez une connaissance minimale du protocole USB.  Si vous ne savez rien de l'USB, je recommande l' <b>excellent</b> livre <b>USB Complete de</b> Jan Axelson. <br><a name="habracut"></a><br><h2>  Assez parl√©, √©crivons le code! </h2><br><h3>  Qui est qui </h3><br>  Pour commencer, donnons une description des modules PyUSB.  Tous les modules PyUSB sont sous <u>usb</u> , avec les modules suivants: <br><table><tbody><tr><th>  Module </th><th>  La description </th></tr><tr><td>  noyau </td><td>  Le module USB principal. </td></tr><tr><td>  util </td><td>  Fonctions auxiliaires. </td></tr><tr><td>  contr√¥le </td><td>  Demandes de gestion standard. </td></tr><tr><td>  h√©ritage </td><td>  Couche de compatibilit√© version 0.x. </td></tr><tr><td>  backend </td><td>  Un sous-package contenant des backends int√©gr√©s. </td></tr></tbody></table><br>  Par exemple, pour importer un module <u>principal</u> , entrez les informations suivantes: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; dev = usb.core.find()</code> </pre> <br><h3>  Eh bien, commen√ßons </h3><br>  Ce qui suit est un programme simple qui envoie la cha√Æne ¬´test¬ª √† la premi√®re source de donn√©es trouv√©e (point final OUT): <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-comment"><span class="hljs-comment">#    dev = usb.core.find(idVendor=0xfffe, idProduct=0x0001) #   ? if dev is None: raise ValueError('Device not found') #   .  ,   #    dev.set_configuration() #    cfg = dev.get_active_configuration() intf = cfg[(0,0)] ep = usb.util.find_descriptor( intf, #     custom_match = \ lambda e: \ usb.util.endpoint_direction(e.bEndpointAddress) == \ usb.util.ENDPOINT_OUT) assert ep is not None #   ep.write('test')</span></span></code> </pre><br>  Les deux premi√®res lignes importent les modules du package PyUSB.  <u>usb.core</u> est le module principal et <u>usb.util</u> contient des fonctions d'assistance.  La commande suivante recherche notre appareil et renvoie une instance de l'objet s'il le trouve.  Sinon, renvoie <u>Aucun</u> .  Ensuite, nous d√©finissons la configuration que nous utiliserons.  Remarque: l'absence d'arguments signifie que la configuration souhait√©e a √©t√© d√©finie par d√©faut.  Comme vous le verrez, de nombreuses fonctionnalit√©s PyUSB ont des param√®tres par d√©faut pour la plupart des appareils courants.  Dans ce cas, la premi√®re configuration trouv√©e est d√©finie. <br><br>  Ensuite, nous recherchons le point final auquel nous sommes int√©ress√©s.  Nous le recherchons dans la premi√®re interface que nous avons.  Apr√®s avoir trouv√© ce point, nous lui envoyons des donn√©es. <br><br>  Si nous connaissons √† l'avance l'adresse du point de terminaison, nous pouvons simplement appeler la fonction d' <u>√©criture</u> de l'objet p√©riph√©rique: <br><br><pre> <code class="python hljs">dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>)</code> </pre><br>  Ici, nous √©crivons la cha√Æne ¬´test¬ª au point d'arr√™t √† l'adresse <i>1</i> .  Toutes ces fonctions seront mieux discut√©es dans les sections suivantes. <br><br><h3>  Qu'est-ce qui ne va pas? </h3><br>  Chaque fonction dans PyUSB l√®ve une exception en cas d'erreur.  Outre les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exceptions Python standard</a> , PyUSB d√©finit <u>usb.core.USBError</u> pour les erreurs li√©es √† l'USB. <br><br>  Vous pouvez √©galement utiliser les fonctions de journal PyUSB.  Il utilise le module de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">journalisation</a> .  Pour l'utiliser, d√©finissez la <u>variable d'</u> environnement <u>PYUSB_DEBUG</u> avec l'un des niveaux de journalisation suivants: <u>critique</u> , <u>erreur</u> , <u>avertissement</u> , <u>info</u> ou <u>d√©bogage</u> . <br><br>  Par d√©faut, les messages sont envoy√©s √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sys.stderr</a> .  Si vous le souhaitez, vous pouvez rediriger les messages du journal vers un fichier en d√©finissant la variable d'environnement <u>PYUSB_LOG_FILENAME</u> .  Si sa valeur est le chemin d'acc√®s correct au fichier, les messages y seront √©crits, sinon ils seront envoy√©s √† <u>sys.stderr</u> . <br><br><h3>  O√π es tu </h3><br>  La fonction <u>find ()</u> du module <u>principal</u> est utilis√©e pour rechercher et num√©roter les p√©riph√©riques connect√©s au syst√®me.  Par exemple, supposons que notre appareil poss√®de un ID de fournisseur avec une valeur de 0xfffe et un ID de produit de 0x0001.  Si nous devons trouver cet appareil, nous le ferons: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core dev = usb.core.find(idVendor=<span class="hljs-number"><span class="hljs-number">0xfffe</span></span>, idProduct=<span class="hljs-number"><span class="hljs-number">0x0001</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dev <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> ValueError(<span class="hljs-string"><span class="hljs-string">'Our device is not connected'</span></span>)</code> </pre><br>  C'est tout, la fonction renverra l'objet <u>usb.core.Device</u> qui repr√©sente notre appareil.  Si le p√©riph√©rique n'est pas trouv√©, il renverra <u>Aucun</u> .  En fait, vous pouvez utiliser n'importe quel champ de la classe Device <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Descriptor</a> de votre choix.  Par exemple, que faire si nous voulons savoir si une imprimante USB est connect√©e au syst√®me?  C'est tr√®s simple: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,   if usb.core.find(bDeviceClass=7) is None: raise ValueError('No printer found')</span></span></code> </pre><br>  7 est le code de la classe d'imprimante selon la sp√©cification USB.  Oh, attendez, que faire si je veux num√©roter toutes les imprimantes disponibles?  Pas de probl√®me: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     ... printers = usb.core.find(find_all=True, bDeviceClass=7) # Python 2, Python 3,     import sys sys.stdout.write('There are ' + len(printers) + ' in the system\n.')</span></span></code> </pre><br>  Qu'est-il arriv√©?  Eh bien, il est temps pour une petite explication ... <u>find</u> a un param√®tre appel√© <u>find_all</u> et par d√©faut √† False.  Quand c'est faux <a name="orig1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[1]</a> , <u>find</u> renverra le premier appareil qui correspond aux crit√®res sp√©cifi√©s (nous en reparlerons bient√¥t).  Si vous transmettez une valeur <i>vraie</i> au param√®tre, <u>find</u> renverra √† la place une liste de tous les p√©riph√©riques correspondant aux crit√®res.  C'est tout!  C'est simple, non? <br><br>  Avons-nous fini?  Non!  Je n'ai pas encore tout dit: de nombreux appareils mettent en fait leurs informations de classe dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Descripteur d'</a> interface au lieu du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Descripteur d'</a> appareil.  Donc, pour vraiment trouver toutes les imprimantes connect√©es au syst√®me, nous devrons passer par toutes les configurations, ainsi que toutes les interfaces, et v√©rifier si l'une des interfaces est d√©finie sur bInterfaceClass 7. Si vous √™tes un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programmeur</a> comme moi, vous pouvez vous demander: existe-t-il un moyen plus simple de mettre cela en ≈ìuvre?  R√©ponse: oui, il l'est.  Pour commencer, regardons le code pr√™t √† l'emploi pour trouver toutes les imprimantes connect√©es: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">find_class</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, class_)</span></span></span><span class="hljs-function">:</span></span> self._class = class_ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, device)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#  ,   if device.bDeviceClass == self._class: return True # ,   ,   # ,     for cfg in device: # find_descriptor:  ? intf = usb.util.find_descriptor( cfg, bInterfaceClass=self._class ) if intf is not None: return True return False printers = usb.core.find(find_all=1, custom_match=find_class(7))</span></span></code> </pre><br>  Le param√®tre <u>custom_match</u> accepte tout objet appel√© qui re√ßoit l'objet p√©riph√©rique.  Il doit renvoyer true pour un appareil appropri√© et false pour un appareil inappropri√©.  Vous pouvez √©galement combiner <u>custom_match</u> avec des champs d'appareil si vous le souhaitez: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,    : printers = usb.core.find(find_all=1, custom_match=find_class(7), idVendor=0xfffe)</span></span></code> </pre><br>  Ici, nous nous int√©ressons aux imprimantes du fournisseur 0xfffe. <br><br><h3>  D√©crivez-vous </h3><br>  Ok, nous avons trouv√© notre appareil, mais avant d'interagir avec lui, nous aimerions en savoir plus.  Eh bien, vous savez, les configurations, les interfaces, les points de terminaison, les types de flux de donn√©es ... <br>  Si vous avez un p√©riph√©rique, vous pouvez acc√©der √† n'importe quel champ du descripteur de p√©riph√©rique en tant que propri√©t√©s d'objet: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.bLength &gt;&gt;&gt; dev.bNumConfigurations &gt;&gt;&gt; dev.bDeviceClass &gt;&gt;&gt; <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre><br>  Pour acc√©der aux configurations disponibles dans l'appareil, vous pouvez it√©rer l'appareil: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  De la m√™me mani√®re, vous pouvez it√©rer la configuration pour acc√©der aux interfaces, ainsi qu'it√©rer les interfaces pour acc√©der √† leurs points de contr√¥le.  Chaque type d'objet a des champs du descripteur correspondant comme attributs.  Jetez un oeil √† un exemple: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cfg <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dev: sys.stdout.write(str(cfg.bConfigurationValue) + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> intf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cfg: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t'</span></span> + \ str(intf.bInterfaceNumber) + \ <span class="hljs-string"><span class="hljs-string">','</span></span> + \ str(intf.bAlternateSetting) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ep <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> intf: sys.stdout.write(<span class="hljs-string"><span class="hljs-string">'\t\t'</span></span> + \ str(ep.bEndpointAddress) + \ <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre><br>  Vous pouvez √©galement utiliser des index pour un acc√®s al√©atoire aux descripteurs, comme ici: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt;&gt; cfg = dev[1] &gt;&gt;&gt; #      &gt;&gt;&gt; intf = cfg[(0,0)] &gt;&gt;&gt; #    &gt;&gt;&gt; ep = intf[2]</span></span></code> </pre><br>  Comme vous pouvez le voir, les indices sont compt√©s √† partir de 0. Mais attendez!  Il y a quelque chose d'√©trange dans la fa√ßon dont j'acc√®de √† l'interface ... Oui, vous avez raison, l'index de configuration prend une s√©rie de deux valeurs, dont la premi√®re est l'index d'interface et la seconde est un param√®tre alternatif.  En g√©n√©ral, pour acc√©der √† la premi√®re interface, mais avec le second param√®tre, nous √©crirons <u>cfg [(0,1)]</u> . <br><br>  Il est maintenant temps d'apprendre une mani√®re puissante de rechercher des descripteurs - une fonction <u>find_descriptor</u> utile.  Nous l'avons d√©j√† vu dans l'exemple de recherche d'imprimante.  <u>find_descriptor</u> fonctionne presque de la m√™me mani√®re que <u>find</u> , √† deux exceptions pr√®s: <br><br><ul><li>  <u>find_descriptor</u> re√ßoit comme premier param√®tre le descripteur source que vous recherchez. </li><li>  Il n'y a pas de param√®tre <u>backend</u> dedans <a name="orig2"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[2]</a> . </li></ul><br>  Par exemple, si nous avons un descripteur de configuration <u>cfg</u> , et que nous voulons trouver tous les param√®tres alternatifs pour l'interface 1, nous le ferons: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.util alt = usb.util.find_descriptor(cfg, find_all=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, bInterfaceNumber=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  Notez que <u>find_descriptor se</u> trouve dans le module <u>usb.util</u> .  Il accepte √©galement le param√®tre <u>custom_match</u> d√©crit pr√©c√©demment. <br><br>  <b>Nous traitons avec plusieurs appareils identiques</b> <br><br>  Parfois, vous pouvez connecter deux appareils identiques √† un ordinateur.  Comment pouvez-vous les distinguer?  <u>Les</u> objets de <u>p√©riph√©rique</u> sont livr√©s avec deux attributs suppl√©mentaires qui ne font pas partie de la sp√©cification USB, mais sont tr√®s utiles: les attributs de <u>bus</u> et d' <u>adresse</u> .  Tout d'abord, il convient de dire que ces attributs proviennent du backend et que le backend peut ne pas les prendre en charge - dans ce cas, ils sont d√©finis sur <u>Aucun</u> .  Cependant, ces attributs repr√©sentent le num√©ro et l'adresse du bus de p√©riph√©rique et, comme vous l'avez peut-√™tre devin√©, peuvent √™tre utilis√©s pour distinguer deux p√©riph√©riques avec les m√™mes valeurs d'attribut <u>idVendor</u> et <u>idProduct</u> . <br><br><h3>  Comment dois-je travailler? </h3><br>  Apr√®s la connexion, les p√©riph√©riques USB doivent √™tre configur√©s √† l'aide de quelques requ√™tes standard.  Lorsque j'ai commenc√© √† √©tudier la sp√©cification <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">USB</a> , j'ai √©t√© d√©courag√© par les descripteurs, les configurations, les interfaces, les param√®tres alternatifs, les types de transfert et tout √ßa ... Et pire que tout, vous ne pouvez pas simplement les ignorer: l'appareil ne fonctionne pas sans d√©finir la configuration, m√™me si elle en est une!  PyUSB essaie de vous rendre la vie aussi simple que possible.  Par exemple, apr√®s avoir re√ßu votre objet appareil, tout d'abord, avant d'interagir avec lui, vous devez envoyer une demande <u>set_configuration</u> .  Le param√®tre de configuration de cette requ√™te qui vous int√©resse est <u>bConfigurationValue</u> .  La plupart des appareils n'ont pas plus d'une configuration, et le suivi de la valeur de configuration √† utiliser est ennuyeux (bien que la plupart du code que j'ai vu soit cod√© en dur).  Par cons√©quent, dans PyUSB, vous pouvez simplement envoyer une demande <u>set_configuration</u> sans arguments.  Dans ce cas, il installera la premi√®re configuration trouv√©e (si votre appareil n'en a qu'une, vous n'avez pas du tout √† vous soucier de la valeur de configuration).  Par exemple, supposons que vous ayez un p√©riph√©rique avec un descripteur de configuration et que son champ bConfigurationValue soit 5 <a name="orig3"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[3]</a> , les requ√™tes suivantes fonctionneront de la m√™me mani√®re: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_configuration(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  &gt;&gt;&gt; dev.set_configuration() #  ,   5 -  #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; cfg.set() #  &gt;&gt;&gt; cfg = util.find_descriptor(dev, bConfigurationValue=5) &gt;&gt;&gt; dev.set_configuration(cfg)</span></span></code> </pre><br>  Ouah!  Vous pouvez utiliser l'objet <u>Configuration</u> comme param√®tre pour <u>set_configuration</u> !  Oui, il a √©galement une m√©thode <u>d√©finie</u> pour se configurer dans la configuration actuelle. <br><br>  Une autre option dont vous avez besoin ou n'aurez pas besoin de configurer est l'option de changer les interfaces.  Chaque p√©riph√©rique ne peut avoir qu'une seule configuration activ√©e √† la fois, et chaque configuration peut avoir plusieurs interfaces, et vous pouvez utiliser toutes les interfaces en m√™me temps.  Vous comprenez mieux ce concept si vous consid√©rez l'interface comme un p√©riph√©rique logique.  Par exemple, imaginons une imprimante multifonction, qui est √† la fois une imprimante et un scanner.  Afin de ne pas compliquer (ou du moins de le rendre aussi simple que possible), supposons qu'il n'a qu'une seule configuration.  Parce que  nous avons une imprimante et un scanner, la configuration a 2 interfaces: une pour l'imprimante et une pour le scanner.  Un p√©riph√©rique avec plusieurs interfaces est appel√© p√©riph√©rique composite.  Lorsque vous connectez votre imprimante multifonction √† votre ordinateur, le syst√®me d'exploitation charge deux pilotes diff√©rents: un pour chaque p√©riph√©rique ¬´logique¬ª que vous avez <a name="orig4"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[4]</a> . <br><br>  Qu'en est-il des param√®tres d'interface alternatifs?  C'est une bonne chose que vous ayez demand√©.  Une interface a un ou plusieurs param√®tres alternatifs.  Une interface avec un seul param√®tre alternatif est consid√©r√©e comme n'ayant aucun param√®tre alternatif <a name="orig5"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[5]</a> .  Param√®tres alternatifs pour les interfaces en tant que configuration pour les appareils, c'est-√†-dire que pour chaque interface, vous ne pouvez avoir qu'un seul param√®tre alternatif actif.  Par exemple, la sp√©cification USB sugg√®re qu'un appareil ne peut pas avoir de point de contr√¥le isochrone dans sa configuration alternative principale <a name="orig6"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[6]</a> , de sorte que le dispositif de diffusion en continu doit avoir au moins deux param√®tres alternatifs, un second param√®tre ayant un point de contr√¥le isochrone.  Mais, contrairement aux configurations, les interfaces avec une seule configuration alternative n'ont pas besoin d'√™tre configur√©es <a name="orig7"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[7]</a> .  Vous s√©lectionnez un autre param√®tre d'interface √† l'aide de la fonction <u>set_interface_altsetting</u> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dev.set_interface_altsetting(interface = <span class="hljs-number"><span class="hljs-number">0</span></span>, alternate_setting = <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br>  <b>Avertissement</b> <br><br>  La sp√©cification USB indique que l'appareil est autoris√© √† renvoyer une erreur s'il re√ßoit une demande SET_INTERFACE pour une interface qui n'a pas de param√®tres alternatifs suppl√©mentaires.  Donc, si vous n'√™tes pas s√ªr que l'interface poss√®de plusieurs param√®tres alternatifs ou qu'elle accepte la demande SET_INTERFACE, la m√©thode la plus s√ªre consiste √† appeler <u>set_interface_altsetting</u> √† l'int√©rieur du bloc try-except, comme ici: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: dev.set_interface_altsetting(...) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> USBError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Vous pouvez √©galement utiliser l'objet <u>Interface en</u> tant que param√®tre de fonction, l' <u>interface</u> et <u>les</u> param√®tres de <u>remplacement</u> sont automatiquement h√©rit√©s des <u>champs</u> <u>bInterfaceNumber</u> et <u>bAlternateSetting</u> .  Un exemple: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>intf = find_descriptor(...) &gt;&gt;&gt; dev.set_interface_altsetting(intf) &gt;&gt;&gt; intf.set_altsetting() <span class="hljs-comment"><span class="hljs-comment"># !       </span></span></code> </pre><br>  <b>Avertissement</b> <br><br>  L'objet <u>Interface</u> doit appartenir au descripteur de configuration actif. <br><br><h3>  Parle-moi ch√©rie </h3><br>  Et maintenant, il est temps pour nous de comprendre comment interagir avec les p√©riph√©riques USB.  L'USB propose quatre types de flux de donn√©es: transfert en masse, transfert d'interruption, transfert isochrone et transfert de contr√¥le.  Je n'ai pas l'intention d'expliquer le but de chaque fil et les diff√©rences entre eux.  Par cons√©quent, je suppose que vous avez au moins une connaissance de base des flux de donn√©es USB. <br><br>  Le flux de donn√©es de contr√¥le est le seul flux dont la structure est d√©crite dans la sp√©cification, le reste envoie et re√ßoit simplement des donn√©es brutes d'un point de vue USB.  Par cons√©quent, vous disposez de diverses fonctions pour travailler avec des flux de contr√¥le et les autres flux sont trait√©s par les m√™mes fonctions. <br><br>  Vous pouvez acc√©der au flux de donn√©es de contr√¥le √† l'aide de la m√©thode <u>ctrl_transfer</u> .  Il est utilis√© √† la fois pour les flux sortants (OUT) et entrants (IN).  Le sens du flux est d√©termin√© par le param√®tre <u>bmRequestType</u> . <br><br>  Les param√®tres <u>ctrl_transfer</u> co√Øncident presque avec la structure de la demande de contr√¥le.  L'exemple suivant montre comment organiser un flux de donn√©es de contr√¥le. <a name="orig8"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[8]</a> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0x40</span></span>, CTRL_LOOPBACK_WRITE, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, msg) == len(msg) &gt;&gt;&gt; ret = dev.ctrl_transfer(<span class="hljs-number"><span class="hljs-number">0xC0</span></span>, CTRL_LOOPBACK_READ, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, len(msg)) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  Cet exemple suppose que notre appareil comprend deux demandes de contr√¥le utilisateur qui agissent comme un canal de bouclage.  Ce que vous √©crivez avec le message <u>CTRL_LOOPBACK_WRITE</u> , vous pouvez le lire avec le message <u>CTRL_LOOPBACK_READ</u> . <br><br>  Les quatre premiers param√®tres - <u>bmRequestType</u> , <u>bmRequest</u> , <u>wValue</u> et <u>wIndex</u> - sont les champs de la structure standard du flux de contr√¥le.  Le cinqui√®me param√®tre est soit les donn√©es transf√©r√©es pour le flux de donn√©es sortant, soit le nombre de donn√©es lues dans le flux entrant.  Les donn√©es transmises peuvent √™tre n'importe quel type de s√©quence, qui peut √™tre fournie en tant que param√®tre √† l'entr√©e de la m√©thode <u>__init__</u> pour la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">matrice</a> .  Si aucune donn√©e n'est transf√©r√©e, le param√®tre doit √™tre d√©fini sur <u>Aucun</u> (ou 0 dans le cas d'un flux de donn√©es entrant).  Il existe un autre param√®tre facultatif indiquant le d√©lai d'expiration de l'op√©ration.  Si vous ne le r√©ussissez pas, le d√©lai d'expiration par d√©faut sera utilis√© (plus √† ce sujet plus tard).  Dans le flux de donn√©es sortant, la valeur de retour est le nombre d'octets r√©ellement envoy√©s au p√©riph√©rique.  Dans le flux entrant, la valeur de retour est un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tableau</a> avec les donn√©es lues. <br><br>  Pour les autres flux, vous pouvez utiliser les m√©thodes d' <u>√©criture</u> et de <u>lecture</u> , respectivement, pour √©crire et lire des donn√©es.  Vous n'avez pas √† vous soucier du type de flux - il est automatiquement d√©tect√© par l'adresse du point de contr√¥le.  Voici notre exemple de bouclage, √† condition que nous ayons un tuyau de bouclage au point d'arr√™t 1: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>msg = <span class="hljs-string"><span class="hljs-string">'test'</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> len(dev.write(<span class="hljs-number"><span class="hljs-number">1</span></span>, msg, <span class="hljs-number"><span class="hljs-number">100</span></span>)) == len(msg) &gt;&gt;&gt; ret = dev.read(<span class="hljs-number"><span class="hljs-number">0x81</span></span>, len(msg), <span class="hljs-number"><span class="hljs-number">100</span></span>) &gt;&gt;&gt; sret = <span class="hljs-string"><span class="hljs-string">''</span></span>.join([chr(x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ret]) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sret == msg</code> </pre><br>  Les premier et troisi√®me param√®tres sont les m√™mes pour les deux m√©thodes - il s'agit de l'adresse du point de contr√¥le et du d√©lai d'expiration, respectivement.  Le deuxi√®me param√®tre est la donn√©e transmise (√©criture) ou le nombre d'octets √† lire (lecture).  Les donn√©es renvoy√©es seront soit une instance d'un objet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tableau</a> pour la m√©thode de <u>lecture</u> , soit le nombre d'octets √©crits pour la m√©thode d' <u>√©criture</u> . <br><br>  Avec les versions beta 2, au lieu du nombre d'octets, vous pouvez passer en <u>lecture</u> ou <u>ctrl_transfer</u> un objet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tableau</a> vers lequel les donn√©es seront lues.  Dans ce cas, le nombre d'octets √† lire sera la longueur du tableau multipli√©e par la valeur de <u>array.itemsize</u> . <br><br>  Dans <u>ctrl_transfer</u> , le param√®tre <u>timeout</u> est facultatif.  Lorsque le <u>d√©lai est</u> omis, la propri√©t√© <u>Device.default_timeout</u> est <u>utilis√©e</u> comme d√©lai op√©rationnel. <br><br><h3>  Contr√¥lez-vous </h3><br>  En plus des fonctions de <u>flux de</u> donn√©es, le module <u>usb.control</u> fournit des fonctions qui incluent des demandes de contr√¥le USB standard, et le module <u>usb.util</u> a une fonction <u>get_string</u> pratique <u>qui</u> affiche sp√©cifiquement les descripteurs de ligne. <br><br><h2>  Sujets suppl√©mentaires </h2><br><h3>  Derri√®re chaque grande abstraction se cache une grande r√©alisation </h3><br>  Auparavant, il n'y avait que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">libusb</a> .  Puis vint libusb 1.0 et nous avons eu libusb 0.1 et 1.0.  Apr√®s cela, nous avons cr√©√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenUSB</a> et maintenant nous vivons dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tour de Babel de la</a> biblioth√®que USB <a name="orig9"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[9]</a> .  Comment PyUSB g√®re-t-il cela?  Eh bien, PyUSB est une biblioth√®que d√©mocratique, vous pouvez choisir la biblioth√®que que vous souhaitez.  En fait, vous pouvez √©crire votre propre biblioth√®que USB √† partir de z√©ro et dire √† PyUSB de l'utiliser. <br><br>  La fonction <u>find</u> a un autre param√®tre, dont je ne vous ai pas parl√©.  Il s'agit du param√®tre <u>backend</u> .  Si vous ne le transf√©rez pas, l'un des backends int√©gr√©s sera utilis√©.  Un backend est un objet h√©rit√© de <u>usb.backend.IBackend</u> , responsable de l'introduction de <u>fichiers</u> ind√©sirables USB sp√©cifiques au syst√®me d'exploitation.  Comme vous l'avez peut-√™tre devin√©, les libusb 0.1, libusb 1.0 et OpenUSB int√©gr√©s sont des backends. <br><br>  Vous pouvez √©crire votre propre backend et l'utiliser.  <u>H√©ritez</u> juste d' <u>IBackend</u> et activez les m√©thodes n√©cessaires.  Vous devrez peut-√™tre consulter la documentation <u>usb.backend</u> pour comprendre comment cela se fait. <br><br><h3>  Ne sois pas √©go√Øste </h3><br>  Python poss√®de ce que nous appelons <i>la gestion automatique de la m√©moire</i> .  Cela signifie que la machine virtuelle d√©cidera quand d√©charger les objets de la m√©moire.  Sous le capot, PyUSB g√®re toutes les ressources de bas niveau avec lesquelles vous devez travailler (approbation de l'interface, r√©glage de l'appareil, etc.) et la plupart des utilisateurs n'ont pas √† s'en soucier.  Mais, en raison de la nature non d√©finie de la destruction automatique des objets par Python, les utilisateurs ne peuvent pas pr√©dire quand les ressources allou√©es seront lib√©r√©es.  Certaines applications doivent allouer et lib√©rer des ressources de mani√®re d√©terministe.  Pour de telles applications, le module <u>usb.util</u> fournit des fonctions d'interaction avec la gestion des ressources. <br><br>  Si vous souhaitez demander et lib√©rer des interfaces manuellement, vous pouvez utiliser les fonctions <u>claim_interface</u> et <u>release_interface</u> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fonction </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">claim_interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> demandera l'interface sp√©cifi√©e si le p√©riph√©rique ne l'a pas encore fait. Si l'appareil a d√©j√† demand√© une interface, il ne fait rien. Juste </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">release_interface</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lib√©rera l'interface sp√©cifi√©e, si elle est demand√©e. Si l'interface n'est pas demand√©e, elle ne fait rien. Vous pouvez utiliser l'interrogation manuelle de l'interface pour r√©soudre le </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">probl√®me de s√©lection de configuration</font></a><font style="vertical-align: inherit;"> d√©crit dans la documentation de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Si vous souhaitez lib√©rer toutes les ressources allou√©es par l'objet p√©riph√©rique (y compris les interfaces demand√©es), vous pouvez utiliser la fonction </font><u><font style="vertical-align: inherit;">dispose_resources</font></u></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Il lib√®re toutes les ressources allou√©es et place l'objet p√©riph√©rique (mais pas dans le mat√©riel du p√©riph√©rique lui-m√™me) dans l'√©tat dans lequel il a √©t√© renvoy√© apr√®s avoir utilis√© la fonction </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D√©finition manuelle de la biblioth√®que </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, un backend est un wrapper sur une biblioth√®que partag√©e qui impl√©mente une API pour acc√©der √† USB. Par d√©faut, les utilisations de back - </font><font style="vertical-align: inherit;">end </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ctypes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disposent </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library ()</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sous Linux et d'autres syst√®mes d'exploitation de type Unix, </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find_library</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> essaie d'ex√©cuter des programmes externes (tels que </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sbin / ldconfig</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gcc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objdump</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) afin de trouver le fichier de biblioth√®que. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur les syst√®mes dans lesquels ces programmes sont manquants et / ou le cache de biblioth√®que est d√©sactiv√©, cette fonction ne peut pas √™tre utilis√©e. Pour surmonter ces limitations, PyUSB vous permet de soumettre la fonction personnalis√©e find_library () au backend. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un exemple d'un tel sc√©nario serait:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.core &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usb.backend.libusb1 &gt;&gt;&gt; &gt;&gt;&gt; backend = usb.backend.libusb1.get_backend(find_library=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: <span class="hljs-string"><span class="hljs-string">"/usr/lib/libusb-1.0.so"</span></span>) &gt;&gt;&gt; dev = usb.core.find(..., backend=backend)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Notez que find_library est un argument de la fonction get_backend () dans lequel vous fournissez la fonction charg√©e de trouver la bonne biblioth√®que pour le backend. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√®gles de la vieille √©cole </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous √©crivez une application en utilisant les anciennes API PyUSB (0. quelque chose-l√†), vous vous demandez peut-√™tre si vous devez mettre √† jour votre code pour utiliser la nouvelle API. </font><font style="vertical-align: inherit;">Eh bien, vous devriez le faire, mais ce n‚Äôest pas n√©cessaire. </font><font style="vertical-align: inherit;">PyUSB 1.0 est fourni avec le </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">module de</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compatibilit√© </font><u><font style="vertical-align: inherit;">usb.legacy</font></u><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il inclut l'ancienne API bas√©e sur la nouvelle API. </font><font style="vertical-align: inherit;">"Eh bien, devrais-je simplement remplacer ma ligne </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USB</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> d' </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">importation</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par </font><u><font style="vertical-align: inherit;">Import USB.legacy en tant qu'USB</font></u><font style="vertical-align: inherit;"> pour faire fonctionner ma demande?", Demandez-vous. </font><font style="vertical-align: inherit;">La r√©ponse est oui, cela fonctionnera, mais ce n'est pas n√©cessaire. </font><font style="vertical-align: inherit;">Si vous ex√©cutez votre application sans modification, cela fonctionnera car la ligne </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USB d'</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> importation importe tous les symboles publics de </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usb.legacy</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Si vous rencontrez un probl√®me - vous avez probablement trouv√© un bug.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aidez-moi s'il vous pla√Æt </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous avez besoin d'aide, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne m'√©crivez pas d'e-mail</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il existe une liste de diffusion pour cela. </font><font style="vertical-align: inherit;">Les instructions d'abonnement se trouvent sur le site Web de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PyUSB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="prim"></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Quand j'√©cris Vrai ou Faux (avec une majuscule), je veux dire les valeurs correspondantes du langage Python. Et quand je dis vrai (vrai) ou faux (faux), je veux dire toute expression Python qui est consid√©r√©e comme vraie ou fausse. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Cette similitude s'est produite dans l'original et aide √† comprendre les concepts de vrai et de faux en traduction. - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Voir la documentation sp√©cifique pour le backend. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La sp√©cification USB n'impose aucune valeur sp√©cifique √† la valeur de configuration. Il en va de m√™me pour les num√©ros d'interface et les autres param√®tres. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En fait, tout est un peu plus compliqu√©, mais ce n'est qu'une explication pour nous. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[5]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Je sais que cela semble bizarre.</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[6]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En effet, s'il n'y a pas de bande passante pour les flux de donn√©es isochrones pendant la configuration de l'appareil, elle peut √™tre num√©rot√©e avec succ√®s. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[7]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cela ne se produit pas pour la configuration car le p√©riph√©rique est autoris√© √† √™tre dans un √©tat non configur√©. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[8]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dans PyUSB, les flux de donn√©es de contr√¥le acc√®dent au point de contr√¥le 0. Tr√®s tr√®s tr√®s rarement, un appareil dispose d'un point de contr√¥le de contr√¥le alternatif (je n'ai jamais rencontr√© un tel appareil). </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[9]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ce n'est qu'une blague, ne la prenez pas au s√©rieux. </font><font style="vertical-align: inherit;">De grands choix valent mieux que pas de choix.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430528/">https://habr.com/ru/post/fr430528/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430518/index.html">Comment rendre le cadre de la Terre du Milieu: L'Ombre du Mordor</a></li>
<li><a href="../fr430520/index.html">Pr√©sentation de Spring Data MongoDB</a></li>
<li><a href="../fr430522/index.html">Avez-vous besoin d'une culture d'entreprise en informatique? Confession du chef de marque du studio Krasnodar Plarium</a></li>
<li><a href="../fr430524/index.html">Architecture de r√©seau de neurones</a></li>
<li><a href="../fr430526/index.html">Machines √† sous: d'o√π viennent-elles en URSS et comment sont-elles arrang√©es</a></li>
<li><a href="../fr430530/index.html">Serveur simul√© pour l'automatisation des tests mobiles</a></li>
<li><a href="../fr430532/index.html">S√©curit√© dans les applications iOS</a></li>
<li><a href="../fr430534/index.html">Cr√©ation d'un mod√®le pour Zabbix en utilisant le DVR Trassir SDK comme exemple</a></li>
<li><a href="../fr430536/index.html">Conception de fonctions de fen√™tre r√©sum√©es en une unit√© avec un niveau donn√© de chevauchement</a></li>
<li><a href="../fr430538/index.html">Lisez-vous Scaladoc pour les m√©thodes de collecte ¬´√©videntes¬ª? Ou pourquoi la paresse n'est pas toujours bonne</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>