<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦅 ⚱️ 🔼 Traslado del portal web: del monolito a la arquitectura de microservicios 🌳 👦🏼 🐠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Compartimos la experiencia de modernizar la arquitectura del portal web, lo que hizo posible que el producto sea conveniente, estable y tolerante a fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Traslado del portal web: del monolito a la arquitectura de microservicios</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/449538/">  Compartimos la experiencia de modernizar la arquitectura del portal web, lo que hizo posible que el producto sea conveniente, estable y tolerante a fallas: ¡el tráfico aumentó de 350 mil a 7 millones de usuarios!  La historia será útil para aquellos que planean expandir su producto.  Primero, veremos qué factores pueden interferir con el trabajo y el desarrollo del portal web: <a name="habracut"></a><br><br><ul><li>  <b>Obsolescencia</b>  El enfoque de usabilidad, la adaptación a diferentes dispositivos, la apariencia y la estructura elementales dejan de satisfacer las necesidades de la audiencia con el tiempo. </li><li>  <b>Obsolescencia tecnológica.</b>  Los estándares web y la tecnología están en constante evolución.  Los cambios afectan tanto a las herramientas del desarrollador (por ejemplo, marcos, bases de datos, otro software) como a los fundamentos fundamentales de la web.  De lo relativamente reciente: una transición masiva de http a https y el abandono del soporte para DNS heredado. <br></li><li>  <b>Errores y bloqueos.</b>  Los desarrolladores pueden hacer frente imperfectamente a su tarea y permitir fallas.  Como resultado de esto, pueden ocurrir violaciones del sitio, comenzando con el hecho de que los botones no funcionan la primera vez, hasta que los sistemas fallan por completo. <br></li></ul><br>  <b>Caso</b> <br><br>  Nos contactó un cliente cuyo portal web necesitaba un mayor desarrollo.  En cierto punto, se alcanzó un techo de 350 mil visitantes únicos cada mes.  Esto parecía insuficiente: el proyecto claramente tenía perspectivas y teníamos que averiguar qué era lo que impedía ampliar aún más el recurso. <br><br>  <b>Auditoria</b> <br><br>  Resultó que el viejo motor Bitrix no estaba adaptado a cargas y escalas.  Cada uno de los componentes del sistema se entrecruzó estrechamente y dependió el uno del otro.  La corrección constante de errores era una tarea tan insoportable que propusimos una arquitectura de microservicio flexible y comprensible.  En ellos, cada componente es lo suficientemente independiente como para que los errores en su interior no "dañen" los elementos restantes del sistema. <br><br>  Bitrix siguió siendo la base de la arquitectura; al menos, la autorización está vinculada a ella, pero donde fue posible y prometió una gran eficiencia, transferimos la funcionalidad a los microservicios.  Se convirtieron en la piedra angular del proyecto. <br><br>  La nueva arquitectura combinada nos ha proporcionado un funcionamiento estable y más rápido de los sistemas y una ausencia casi completa de errores en algunos módulos.  También sirvió de base para el trabajo efectivo de los vendedores.  Gracias a la arquitectura mejorada, los especialistas en promoción lograron aumentar la asistencia del recurso en 20 veces. <br><br><img src="https://habrastorage.org/webt/7d/bt/kv/7dbtkvfsxywcnuakaw_wdu92ebs.jpeg"><br><br>  <b>Microservicios</b> <br><br>  En microservicios independientes, distinguimos módulos como un cargador de archivos, búsqueda y noticias.  Además de estas cosas fáciles de usar y obvias, se implementaron muchos otros elementos funcionales en forma de microservicios: <br><br><ul><li>  Descarga, almacenamiento y gestión de datos de proyectos de código abierto; </li><li>  Creación dinámica de canales RSS; </li><li>  Creación dinámica de un sistema de bloques, disposición de materiales de cualquier servicio en bloques estructurales; </li><li>  Agregar datos adicionales a los materiales de servicio; </li><li>  Servicio de soporte técnico; </li><li>  Un solo catálogo de varios datos. </li></ul><br>  Además de todo lo anterior, hemos creado muchos microservicios para un trabajo conveniente con el panel de administración. <br><br><img src="https://habrastorage.org/webt/mx/7t/e-/mx7te-grrfkdfydja2xll-yjc-w.png"><br><br>  Cada bloque funcional del sitio se ha convertido en una unidad bastante autónoma.  Se utiliza un proceso dedicado para cargar y renderizar, minimizando la intersección con otros servicios. <br><br>  De acuerdo, cuando un usuario realiza un pago, no querrá esperar mucho tiempo para cargar el script responsable de reproducir el video que no necesita en otra parte de la página.  De hecho, esto es lo que sucede en los sistemas monolíticos: las funcionalidades secundarias a veces interfieren con el trabajo de componentes realmente importantes. <br><br>  Dimos el primer paso y facilitamos la vida de los usuarios y desarrolladores, lanzando más de 20 nuevos servicios por año.  Como resultado: <br><br><ul><li>  Resolvimos el problema de la escala. </li><li>  Implementado un proceso de desarrollo más eficiente por equipos distribuidos. </li><li>  Configure la gestión dinámica de recursos para un funcionamiento rápido y sin problemas del sistema. </li></ul><br><br>  <b>Actualización de pila de tecnología</b> <br><br>  Paralelamente, actualizamos la pila de tecnología.  Si el portal se basó originalmente en php 5.6 y MySQL 5.6, en el transcurso de la mejora del motor, lo cambiamos a php 7.0 y MySQL 5.7.  Implementé el marco Yii2, proporcioné el almacenamiento en caché de memcache. <br><br><img src="https://habrastorage.org/webt/zc/zb/6b/zczb6baxnrskcroqim0i0ry1dt8.jpeg"><br><br>  <b>Cola de tareas</b> <br><br>  Para paralelizar mejor las tareas, transferimos los trabajadores web (controladores internos) a la cola RabbitMQ.  Optimiza la secuencia de eventos de activación, lo que reduce la carga en el sistema.  Trabajar con el sitio se ha vuelto mucho más rápido y más cómodo. <br><br>  <b>Integración continua</b> <br><br>  Un proceso de desarrollo transparente y manejable es compatible con GitLab CI.  Este es un desarrollo continuo sin interrupciones que deja a los programadores y evaluadores más tiempo con preguntas importantes en lugar de parchear agujeros. <br><br>  Para minimizar los errores, introdujimos bucles de desarrollo adicionales.  La cadena consta de varios bucles de prueba de aplicaciones e infraestructura: pre-lanzamiento, donde se llevan a cabo las últimas pruebas de ensamblaje (pre-prod), combate (prod), varios bucles de prueba para probar varias compilaciones a la vez, así como un bucle para desarrolladores. <br><br>  <b>Sistema de montaje</b> <br><br>  En la etapa inicial, las compilaciones se crean a partir de las fuentes del proyecto.  En lugar de un conjunto dispares de clases, estilos y controladores, se utilizan entidades combinadas, cada una en el shell de un archivo ejecutable.  Solo las construcciones necesarias se colocan en el ensamblaje para realizar eventos en la página.  Esto además proporciona flexibilidad y velocidad del sitio. <br><br>  <b>Monitoreo de errores</b> <br><br>  GitLab CI proporciona funciones avanzadas para la validación de código y pruebas automatizadas.  A la más mínima discrepancia de ensamblajes con los parámetros dados, el sistema notifica a los desarrolladores y no permite iniciar el proceso posterior de implementación de componentes antes de corregir los errores.  Además, instalamos Sentry, una herramienta completa de monitoreo de errores. <br><br><img src="https://habrastorage.org/webt/it/ut/p8/itutp8xvbdiiouv1swb1idprlxe.png"><br><br>  <b>Optimización de procesos.</b> <br><br>  Para mantener el sistema en un estado de alto rendimiento, hemos optimizado constantemente la infraestructura y los procesos comerciales.  Las bibliotecas compartidas y los prototipos de servicios se convirtieron en la base para la rápida implementación de nuevas funciones: tomamos plantillas preparadas y en poco tiempo obtenemos un producto que funciona. <br><br>  <b>Monitoreo y operación</b> <br><br>  Todos los procesos están a la vista.  Al monitorear el estado de cada nodo, proporcionamos Zabbix, un sistema de seguimiento integral.  Tuvimos la oportunidad de analizar el núcleo de la estructura del proyecto y verlo de manera compacta. <br><br>  También conectamos la plataforma Grafana, que convierte los datos secos en un tablero visual para la comodidad de los empleados del cliente. <br><br>  <b>Estabilización y refactorización.</b> <br><br>  Según sea necesario, reestructuramos el sistema: el código se simplifica y se vuelve conciso.  Al mismo tiempo, siempre hay espacio para crecer, ya que el dopaje regular de los sistemas acelera el sitio.  Como resultado, el recurso se ha vuelto más amigable para los motores de búsqueda y los usuarios. <br><br>  <b>La nueva arquitectura es la base del crecimiento.</b> <br><br>  Al comienzo del trabajo, el recurso tenía un potencial modesto para la promoción y no era lo suficientemente conveniente para los clientes, lo que impedía los procesos comerciales de la empresa.  Para mejorar el proceso de interacción del usuario con el sitio, actualizamos casi por completo la arquitectura del portal y su estructura, creamos un mecanismo flexible que se integra con una gran cantidad de servicios y aplicaciones, gracias a nuestra propia API.  Muchos servicios han estado funcionando de manera óptima durante más de un año, sin requerir intervención; el número de errores en su trabajo ha disminuido a casi cero. <br><br>  El nuevo sitio es una herramienta poderosa para el desarrollo de negocios, con el potencial para una mayor expansión.  Utilizando la arquitectura actualizada de la aplicación web, los vendedores del proyecto pudieron implementar su gama de actividades promocionales y aumentar el tráfico de 350 mil visitantes únicos por mes a más de 7 millones.  Además, después de un aumento múltiple en la audiencia, el portal continúa funcionando de manera estable. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/449538/">https://habr.com/ru/post/449538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449526/index.html">Presentamos Tartiflette: una implementación de código abierto de GraphQL para Python 3.6+</a></li>
<li><a href="../449528/index.html">En la descomposición de la respuesta multicanal de un sistema en modos de vibración "pseudo-patentados"</a></li>
<li><a href="../449532/index.html">ok.tech: encuentro de Cassandra</a></li>
<li><a href="../449534/index.html">Concept car SLA: como se hace en China</a></li>
<li><a href="../449536/index.html">iOS Digest No. 4 (5 de abril - 26 de abril)</a></li>
<li><a href="../449540/index.html">Efecto de sombreado de Doodle</a></li>
<li><a href="../449542/index.html">Medicine se traslada a la web, salas de chat y aplicaciones móviles. Conversación con BestDoctor</a></li>
<li><a href="../449544/index.html">El mundo moderno se basa en API</a></li>
<li><a href="../449546/index.html">V8: un año con Specter</a></li>
<li><a href="../449548/index.html">Centro de datos espaciales. Informe de video desde el lanzamiento</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>