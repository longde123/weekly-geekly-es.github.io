<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåç ‚õπüèΩ üò™ Konfiguration und Dateien des gew√ºnschten PowerShell-Status: Teil 1. Konfigurieren des DSC Pull-Servers f√ºr die Arbeit mit der SQL-Datenbank üëø ‚ôâÔ∏è üë©‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die PowerShell Desired State Configuration (DSC) erleichtert die Bereitstellung und Konfiguration des Betriebssystems, der Serverrollen und Anwendunge...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Konfiguration und Dateien des gew√ºnschten PowerShell-Status: Teil 1. Konfigurieren des DSC Pull-Servers f√ºr die Arbeit mit der SQL-Datenbank</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/452064/"><img src="https://habrastorage.org/webt/-4/vu/2i/-4vu2idi-kona7rk1zluhuqtrlk.png"><br><br>  Die PowerShell Desired State Configuration (DSC) erleichtert die Bereitstellung und Konfiguration des Betriebssystems, der Serverrollen und Anwendungen, wenn Sie √ºber Hunderte von Servern verf√ºgen. <br><br>  Bei Verwendung von DSC vor Ort, d. H.  Nicht in MS Azure gibt es einige Nuancen.  Sie sind besonders greifbar, wenn die Organisation gro√ü ist (von 300 Arbeitsstationen und Servern) und die Welt der Container noch nicht ge√∂ffnet hat: <br><br><ul><li>  Es gibt keine vollst√§ndigen Berichte √ºber den Status von Systemen.  Wenn die erforderliche Konfiguration auf einigen Servern nicht angewendet wurde, wissen wir ohne diese Berichte nichts dar√ºber.  Es ist ziemlich schwierig, Informationen vom eingebauten Berichtsserver abzurufen, und f√ºr eine gro√üe Anzahl von Hosts ist dies auch eine lange Zeit. </li><li>  Es gibt keine Skalierbarkeit und Fehlertoleranz.  Es ist unm√∂glich, eine Farm von Polling-DSC-Webservern zu erstellen, die √ºber eine einzige fehlertolerante Datenbank und ein gemeinsames Repository mit Konfigurationsdateien, Modulen und Registrierungsschl√ºsseln verf√ºgt. </li></ul><br>  Heute werde ich Ihnen erkl√§ren, wie Sie das erste Problem l√∂sen und die Daten f√ºr die Berichterstellung erhalten.  Alles w√§re einfacher, wenn SQL als Datenbank verwendet werden k√∂nnte.  MS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verspricht</a> integrierte Unterst√ºtzung nur in Windows Server 2019 oder im Build Windows Server 1803. Au√üerdem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">k√∂nnen keine</a> Daten mit dem OleDB-Anbieter abgerufen werden, da der DSC-Server einen benannten Parameter verwendet, der von OleDbCommand nicht vollst√§ndig unterst√ºtzt wird. <br><br>  Ich habe diesen Weg gefunden: F√ºr diejenigen, die Windows Server 2012 und 2016 verwenden, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die</a> Verwendung der SQL-Datenbank als Backend f√ºr den Polling-DSC-Server <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">konfigurieren</a> .  Erstellen Sie dazu einen ‚ÄûProxy‚Äú in Form einer MDB-Datei mit verkn√ºpften Tabellen, die von Clientberichten empfangene Daten an die SQL Server-Datenbank umleitet. <br><a name="habracut"></a><br>  <i>Hinweis: F√ºr Windows Server 2016 m√ºssen Sie <a href="">AccessDatabaseEngine2016x86 verwenden</a> , da Microsoft.Jet.OLEDB.4.0 nicht mehr unterst√ºtzt wird.</i> <br><br>  Ich werde nicht auf den Bereitstellungsprozess des Polling-DSC-Servers eingehen, er wird hier sehr gut beschrieben.  Ich nehme nur ein paar Punkte zur Kenntnis.  Wenn wir den Polling-DSC auf demselben Webserver wie WSUS oder Kaspersky Security Center bereitstellen, m√ºssen im Konfigurationserstellungsskript die folgenden Parameter ge√§ndert werden: <br><br><ol><li><pre><code class="sql hljs">UseSecurityBestPractices     = $false</code> </pre> <br>  Andernfalls wird TLS 1.0 deaktiviert und Sie k√∂nnen keine Verbindung zur SQL-Datenbank herstellen.  Kaspersky Security Center funktioniert auch nicht (das Problem sollte in Kaspersky Security Center v11 behoben sein). </li><li><pre> <code class="sql hljs">Enable32BitAppOnWin64   = $true</code> </pre> <br>  Wenn Sie diese √Ñnderung nicht vornehmen, k√∂nnen Sie den AppPool DSC-Server unter IIS nicht mit WSUS starten. </li><li>  Deaktivieren Sie bei der Installation eines DSC-Servers mit WSUS das statische und dynamische Caching f√ºr die DSC-Site. </li></ol><br>  Fahren wir mit dem Einrichten des DSC-Servers f√ºr die Verwendung der SQL-Datenbank fort. <br><br><h3>  Erstellen einer SQL-Datenbank </h3><br><ol><li>  Erstellen Sie eine leere SQL-Datenbank mit dem Namen DSC. <br><br><img src="https://habrastorage.org/webt/24/je/ik/24jeikjjhurylsfpxfdz-hkdkoo.png"><br><br><img src="https://habrastorage.org/webt/-i/km/hz/-ikmhzvewzfmt8ygqaidws2erzm.png"></li><li>  Erstellen Sie ein Konto, um eine Verbindung zu dieser Datenbank herzustellen.  Stellen Sie vorab sicher, dass die Authentifizierung von Windows- und SQL-Konten auf dem SQL Server aktiviert ist. <br><br><img src="https://habrastorage.org/webt/z-/qz/tx/z-qztxe410jqyjoj7rwna3t9-am.png"><br><br><img src="https://habrastorage.org/webt/uh/no/vm/uhnovmv8wsywdxi6ahxiinvkj4y.png"></li><li>  Wechseln Sie zum Abschnitt Benutzerzuordnung.  W√§hlen Sie eine Datenbank aus, in diesem Fall DSC.  Wir geben die Rechte des Inhabers der Datenbank. <br><br><img src="https://habrastorage.org/webt/cl/fg/vg/clfgvg0ya7csozw1ner_egxdxs8.png"></li><li>  Fertig. <br><br><img src="https://habrastorage.org/webt/9i/la/7n/9ila7nedgtygol496l7da239i1k.png"></li></ol><br><h3>  Erstellen eines Schemas f√ºr eine DSC-Datenbank </h3><br>  Es gibt zwei M√∂glichkeiten, ein Schema f√ºr eine DSC-Datenbank zu erstellen: <br><br><ul><li>  unabh√§ngig √ºber ein Skript in TSQL <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ANSI_NULLS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> QUOTED_IDENTIFIER <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[Devices]( [TargetName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationID] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ServerCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [TargetCheckSum] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeCompliant] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastComplianceTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LastHeartbeatTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [Dirty] [<span class="hljs-built_in"><span class="hljs-built_in">bit</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusCode] [<span class="hljs-built_in"><span class="hljs-built_in">int</span></span>] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[RegistrationData]( [AgentId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationNames] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> [dbo].[StatusReport]( [JobId] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Id</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [OperationType] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RefreshMode] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [LCMVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ReportFormatVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [ConfigurationVersion] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [NodeName] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [IPAddress] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StartTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [EndTime] [datetime] <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [<span class="hljs-keyword"><span class="hljs-keyword">Errors</span></span>] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [StatusData] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, [RebootRequested] [<span class="hljs-keyword"><span class="hljs-keyword">nvarchar</span></span>](<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> [PRIMARY] TEXTIMAGE_ON [PRIMARY] <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> </li><li>  Importieren Sie Daten aus leeren Ger√§ten.mdb als Teil des PS-Moduls PSDesiredStateConfiguration √ºber den SQL-Datenimport-Assistenten. <br><br>  Devices.mdb, mit dem wir arbeiten werden, befindet sich unter C: \ Windows \ SysWOW64 \ WindowsPowerShell \ v1.0 \ Modules \ PSDesiredStateConfiguration \ PullServer. <br></li></ul><br><ol><li>  F√ºhren Sie zum Importieren von Daten den SQL Server-Import- und Exportassistenten aus. <br><br><img src="https://habrastorage.org/webt/im/3v/ww/im3vwwj9ib9wucm4xnl70jow1yy.png"></li><li>  Wir w√§hlen aus, wo wir die Daten sammeln m√∂chten - in unserem Fall handelt es sich um eine Microsoft Access-Datenbank.  Klicken Sie auf Weiter. <br><br><img src="https://habrastorage.org/webt/l5/rc/dq/l5rcdqtxvaajv5h5mbil72vv3k0.png"></li><li>  W√§hlen Sie die Datei aus, aus der wir das Schema importieren. <br><br><img src="https://habrastorage.org/webt/th/dt/xu/thdtxutqcvsrv0laifxjhsbse2w.png"></li><li>  Wir geben an, wohin importiert werden soll - wir haben diese SQL-Datenbank. <br><br><img src="https://habrastorage.org/webt/dc/sc/p5/dcscp5f9n-cdmm0qfo0gv_-k0oy.png"></li><li>  Wir w√§hlen den SQL Server (Servername) und die Datenbank aus, in die wir die Daten importieren (Datenbank). <br><br><img src="https://habrastorage.org/webt/kr/sd/ds/krsddsbr4jpvi9dgvc3f_qcxwqy.png"></li><li>  Wir w√§hlen die Option Daten aus einer oder mehreren Tabellen oder Ansichten kopieren (Daten aus Tabellen oder Ansichten kopieren). <br><br><img src="https://habrastorage.org/webt/nu/aq/q8/nuaqq8akzpdz07fwf1gedrxcfns.png"></li><li>  Wir w√§hlen die Tabellen aus, aus denen wir das Datenbankschema importieren wollen. <br><br><img src="https://habrastorage.org/webt/bf/7k/at/bf7kat56ltu-amw0nhvgbp2tkpw.png"></li><li>  Aktivieren Sie Sofort ausf√ºhren und klicken Sie auf Fertig stellen. <br><br><img src="https://habrastorage.org/webt/7i/au/wo/7iauwo3j_x0qzfwqgfc1u8tyfks.png"></li><li>  Fertig. <br><br><img src="https://habrastorage.org/webt/oi/49/w0/oi49w0cedn8ilblfijwlhjsumfm.png"></li><li>  Daher sollten Tabellen in der DSC-Datenbank angezeigt werden. <br><br><img src="https://habrastorage.org/webt/z3/ui/pp/z3uippubkjjk0r2fqolnoweezme.png"></li></ol><br><h3>  Konfigurieren einer MDB-Proxy-Datei </h3><br>  <b>Erstellen einer ODBC-Verbindung zum SQL Server.</b>  Es wird davon ausgegangen, dass MS Access nicht mit DSC auf dem Server installiert ist. Daher wird die Konfiguration von database.dbb auf einem Zwischenhost mit installiertem MS Access durchgef√ºhrt. <br><br>  Erstellen Sie eine System-ODBC-Verbindung zum SQL Server (die Bittiefe der Verbindung muss mit der Bittiefe von MS Access - 64 oder 32 √ºbereinstimmen).  Es kann erstellt werden mit: <br>  - Powershell-Cmdlet: <br><br><pre> <code class="sql hljs">Add-OdbcDsn ‚ÄìName DSC ‚ÄìDriverName 'SQL Server' ‚ÄìPlatform '&lt;64-bit or 32-bit&gt;' ‚ÄìDsnType System ‚ÄìSetPropertyValue @('Description=DSC Pull Server',"Server=&lt;Name of your SQL Server&gt;",'Trusted_Connection=yes','Database=DSC') ‚ÄìPassThru</code> </pre> <br>  - oder manuell mit dem Verbindungsassistenten: <br><br><ol><li>  √ñffnen Sie die Verwaltung.  Wir w√§hlen ODBC-Datenquellen abh√§ngig von der installierten Version von MS Access aus.  Wechseln Sie zur Registerkarte System-DSN und erstellen Sie eine Systemverbindung (Hinzuf√ºgen). <br><br><img src="https://habrastorage.org/webt/pt/k5/cu/ptk5cuuxfa2deeqiw_h6vb4vy_4.png"></li><li>  Wir geben an, dass wir eine Verbindung zum SQL Server herstellen werden.  Klicken Sie auf Fertig stellen. <br><br><img src="https://habrastorage.org/webt/ey/b_/dz/eyb_dz43l6-xzg3yupw4zgrasbi.png"></li><li>  Geben Sie den Namen und den Server an, zu dem eine Verbindung hergestellt werden soll.  Dann muss auf dem DSC-Server eine Verbindung mit denselben Parametern hergestellt werden. <br><br><img src="https://habrastorage.org/webt/_d/py/lq/_dpylq1y7uycuiq08tkq-jp1eri.png"></li><li>  Wir geben an, dass wir f√ºr die Verbindung zum SQL Server die zuvor erstellte Anmeldung mit dem Namen DSC verwenden. <br><br><img src="https://habrastorage.org/webt/_2/bw/bs/_2bwbsadgrihkikrnnh2eq2tkbs.png"></li><li>  Geben Sie die Datenbank in den DSC-Verbindungseinstellungen an. <br><br><img src="https://habrastorage.org/webt/eg/ex/eg/egexegl50aplc4fr_f1jbfx3edq.png"></li><li>  Klicken Sie auf Fertig stellen. <br><br><img src="https://habrastorage.org/webt/di/a8/_n/dia8_nwzir-nhafd9rezwstdwjq.png"></li><li>  Bevor Sie die Einstellungen vornehmen, √ºberpr√ºfen Sie, ob die Verbindung funktioniert (Testdatenquelle). <br><br><img src="https://habrastorage.org/webt/kt/ft/tm/ktfttmjcb_8gyb3s-o_xnwewyfy.png"></li><li>  Fertig. <br><br><img src="https://habrastorage.org/webt/4r/4z/aa/4r4zaalbv3rms8xsfjoijzvtige.png"></li></ol><br>  <b>Erstellen der Datenbank device.mdb in MS Access.</b>  Wir starten MS Access und erstellen eine leere Datenbank namens device.mdb. <br><br><img src="https://habrastorage.org/webt/tq/4n/ia/tq4niasnq5av17ozevpg365y_qy.png"><br><br><ol><li>  Gehen Sie zur Registerkarte Externe Daten und klicken Sie auf die ODBC-Datenbank.  W√§hlen Sie im angezeigten Fenster die Option Verkn√ºpfte Tabelle f√ºr die Kommunikation mit der Datenquelle erstellen. <br><br><img src="https://habrastorage.org/webt/aq/ql/vq/aqqlvqqilfgqgdakivqfna9irvu.png"></li><li>  W√§hlen Sie im neuen Fenster die Registerkarte Maschinendatenquelle und klicken Sie auf OK.  Geben Sie im neuen Fenster die Anmeldeinformationen f√ºr die Verbindung zum SQL Server ein. <br><br><img src="https://habrastorage.org/webt/rr/8c/zl/rr8czlircqalebpljfw47h5eax4.png"></li><li>  Wir w√§hlen die Tabellen aus, die verkn√ºpft werden m√ºssen.  Wir aktivieren das Kontrollk√§stchen Passwort speichern und klicken auf OK.  Das Passwort sollte jedes Mal f√ºr alle drei Tabellen gespeichert werden. <br><br><img src="https://habrastorage.org/webt/dy/f9/w5/dyf9w58ztue8ugsagfiieghgqsc.png"></li><li>  In den Indizes m√ºssen Sie Folgendes ausw√§hlen: <br>  - TargetName f√ºr die Tabelle dbo_Devices; <br><br><img src="https://habrastorage.org/webt/e-/fl/s_/e-fls_elpbmiktv67egcweaxlvq.png"><br><br>  - NodeName oder IPAddress f√ºr dbo_RegistrationData; <br><br><img src="https://habrastorage.org/webt/xo/ug/do/xougdoiodatj1tlmsalqpdfzauk.png"><br><br>  - NodeName oder IPAddress f√ºr dbo_StatusReport. <br><br><img src="https://habrastorage.org/webt/w7/lj/us/w7ljush_8zrt8hupqoqvrtsgk4g.png"></li><li>  Benennen Sie die Tabellen in MS Access um: Entfernen Sie das Pr√§fix dbo_, damit DSC sie verwenden kann. <br><br><img src="https://habrastorage.org/webt/6w/o-/1q/6wo-1qvgkwua75cv1nd1rsmng1k.png"></li><li>  Fertig. <br><br><img src="https://habrastorage.org/webt/58/16/x8/5816x8uw93muoywridyx-dwjugw.png"></li><li>  Speichern Sie die Datei und schlie√üen Sie MS Access.  Kopieren Sie nun die resultierende Ger√§te.mdb auf den DSC-Server (standardm√§√üig unter C: \ Programme \ WindowsPowershell \ DSCService) und ersetzen Sie sie durch die vorhandene (falls vorhanden). </li></ol><br><h3>  Konfigurieren eines DSC-Servers f√ºr die Verwendung von SQL </h3><br><ol><li>  Wir kehren zum DSC-Server zur√ºck.  Um mit unserer Proxy-Datei eine Verbindung zum SQL Server herzustellen, erstellen Sie eine neue ODBC-Verbindung auf dem DSC-Server.  Der Name, die Bittiefe und die Verbindungseinstellungen sollten mit denen beim Erstellen der MDB-Datei √ºbereinstimmen.  Hier k√∂nnen Sie die bereits konfigurierte leere Ger√§te.mdb kopieren. <br></li><li>  Um device.mdb zu verwenden, m√ºssen Sie √Ñnderungen an der web.config des abfragenden DSC-Servers vornehmen (standardm√§√üig C: \ inetpub \ PSDSCPullServer \ web.config): </li></ol><br><br>  - f√ºr Windows Server 2012 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br>  - f√ºr Windows Server 2016 <br><br><pre> <code class="sql hljs">&lt;add key="dbprovider" value="System.Data.OleDb"&gt; &lt;add key="dbconnectionstr" value="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Program Files\WindowsPowerShell\DscService\Devices.mdb;"&gt;</code> </pre> <br><br>  Damit ist die Einrichtung des DSC-Servers abgeschlossen. <br><br><h3>  √úberpr√ºfen des Zustands des DSC-Servers </h3><br><ol><li>  √úberpr√ºfen Sie, ob der DSC-Server √ºber einen Webbrowser zug√§nglich ist. <br><br><img src="https://habrastorage.org/webt/oi/oe/1z/oioe1zuj9x9gvl9eeek9sc38nz8.png"></li><li>  √úberpr√ºfen wir nun, ob der Polling-DSC-Server ordnungsgem√§√ü funktioniert.  Zu diesem Zweck verf√ºgt das Modul xPSDesiredStateConfiguration √ºber ein Skript pullserversetuptests.ps1.  Bevor Sie dieses Skript ausf√ºhren, m√ºssen Sie das Powershell-Modul mit dem Namen Pester installieren.  Installieren Sie es Install-Module -Name Pester. </li><li>  √ñffnen Sie C: \ Programme \ WindowsPowerShell \ Modules \ xPSDesiredStateConfiguration \ &lt;Modulversion&gt; \ DSCPullServerSetup \ PullServerDeploymentVerificationTest (im Beispiel Version 8.0.0.0.0). <br><br><img src="https://habrastorage.org/webt/_5/db/gl/_5dbglhxbi5mgboeexxi_pw7oxk.png"></li><li>  √ñffnen Sie PullServerSetupTests.ps1 und √ºberpr√ºfen Sie den Pfad zur web.config des DSC-Servers.  Rot hat den Pfad zu web.config markiert, der das Skript √ºberpr√ºft.  √Ñndern Sie gegebenenfalls diesen Pfad. <br><br><img src="https://habrastorage.org/webt/et/te/mn/ettemnvebjfc3kgviqzqsob_eas.png"></li><li>  F√ºhren Sie pullserversetuptests.ps1 aus <br>  Invoke-Pester. \ PullServerSetupTests.ps1 <br>  Alles arbeitet. <br><br><img src="https://habrastorage.org/webt/qc/qp/m5/qcqpm5a4iwsl_-9d7n2uzll9zjg.png"></li><li>  In SQL Management Studio sehen wir, dass die verwalteten Hosts Berichte an den DSC-Berichtsserver senden und die Daten an die DSC-Datenbank auf dem SQL Server gesendet werden. <br><br><img src="https://habrastorage.org/webt/ba/oo/04/baoo048uqhsyxpsv4yaaftqmwvi.png"></li></ol><br>  Das ist alles.  In den folgenden Artikeln m√∂chte ich erl√§utern, wie Berichte zu den empfangenen Daten erstellt werden, und Fragen zur Fehlertoleranz und Skalierbarkeit ansprechen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452064/">https://habr.com/ru/post/de452064/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452052/index.html">Wie wir die Kosten f√ºr eine Einf√ºhrungsstunde halbiert haben, indem wir uns eine L√∂sung von Fluggesellschaften angesehen haben</a></li>
<li><a href="../de452054/index.html">Warum WhatsApp niemals sicher sein wird</a></li>
<li><a href="../de452056/index.html">Golang DevDay: 31. Mai, Nowosibirsk + Sendung</a></li>
<li><a href="../de452060/index.html">Information Hope Pr√§dikate</a></li>
<li><a href="../de452062/index.html">Wie beginnt dein Morgen?</a></li>
<li><a href="../de452066/index.html">Excelsior JET stellt die Entwicklung seines AOT-Compilers nach 18 Jahren Arbeit ein</a></li>
<li><a href="../de452068/index.html">12. Check Point Erste Schritte R80.20. Protokolle und Berichte</a></li>
<li><a href="../de452072/index.html">Wir implementieren CircularRevealAnimation auf Flutter und ver√∂ffentlichen gleichzeitig die Bibliothek auf pub.dev</a></li>
<li><a href="../de452074/index.html">Das erste Spiel √ºber die Einheit oder was ich sechs Monate gebraucht habe</a></li>
<li><a href="../de452076/index.html">UC-Browser brechen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>