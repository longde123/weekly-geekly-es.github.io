<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåßÔ∏è üçò üç¨ Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 13 ‚Üí Abs√§tze üïî ‚è±Ô∏è üßë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bevor wir zu dokumentierten Methoden zum Erstellen zusammengesetzter Zeichenfolgen √ºbergehen, m√ºssen wir uns mit einem Objekt wie einem Absatz vertrau...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 13 ‚Üí Abs√§tze</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/434336/">  Bevor wir zu dokumentierten Methoden zum Erstellen zusammengesetzter Zeichenfolgen √ºbergehen, m√ºssen wir uns mit einem Objekt wie einem Absatz vertraut machen.  Es ist ein automatisch formatierter Textblock, der aus mehreren Zeilen besteht.  In dieser Lektion werden wir uns mit dem Erstellen einfacher Abs√§tze befassen. <br><br><img src="https://habrastorage.org/webt/m7/wu/vw/m7wuvw0aeqqqfed0yocjongme0g.png"><br><a name="habracut"></a><br><blockquote><h4>  Der Inhalt der Unterrichtsreihe ‚ÄûArbeiten mit der KOMPAS-3D-API‚Äú </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Grundlagen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeichnungsentwurf</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Richtige Verbindung zu KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptinschrift</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grafische Grundelemente</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Speichern eines Dokuments in verschiedenen Formaten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einstellungen kennenlernen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anspruchsvollere Schreibmethoden im Schriftfeld</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschriftungszellen lesen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sonderzeichen einschlie√ülich einer Zeichenfolge</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einfache Textbeschriftungen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusammengesetzte Zeichenfolgen</a> </li><li>  <b>Abs√§tze</b> </li><li>  Mehrzeiliger Text </li></ol></blockquote><h2>  <font color="#00B2FF"><b>Absatzparameter</b> ( <b>ksParagraphParam</b> )</font> </h2><br>  Ein Absatz wird von der Schnittstelle <b>ksParagraphParam beschrieben</b> .  Um es zu erhalten, m√ºssen Sie die <b>GetParamStruct-</b> Methode der <b>KompasObject-</b> Schnittstelle verwenden. Dazu m√ºssen Sie die Konstante <b>ko_ParagraphParam</b> ( <i>0x0000001B</i> ) an sie √ºbergeben.  Ber√ºcksichtigen Sie die Eigenschaften der <b>ksParagraphParam-</b> Schnittstelle. <br><br>  <b>ang</b> - der Winkel des Textes in Grad.  Es wird von der horizontalen Linie gegen den Uhrzeigersinn verz√∂gert.  √Ñhnlich dem <b>ang-</b> Parameter der <b>ksText-</b> Methode. <br><br>  <b>H√∂he</b> - Die H√∂he des Absatzes in Millimetern. <br><br>  <b>hFormat</b> - Text horizontal formatieren.  Diese Eigenschaft wird verwendet, wenn der Text in der Breite nicht in den Absatz passt.  G√ºltige Werte sind in der folgenden Tabelle aufgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/-s/mj/m9/-smjm9ygdwb7dufeynhaolmpvuo.png"><br><br>  <b>Stil</b> - Stil des Textes (beschrieben in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 11</a> ). <br><br>  <b>vFormat</b> - Text vertikal formatieren.  Diese Eigenschaft wird verwendet, wenn der Text nicht in die H√∂he des Absatzes passt.  G√ºltige Werte sind in der folgenden Tabelle aufgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/jc/hj/9r/jchj9re-6fbg2cp6vc_x6dvsl2o.png"><br><br>  Bei der Arbeit mit der <b>vFormat-</b> Eigenschaft sind zwei <b>Dinge</b> zu beachten: <br><br><ol><li>  Gem√§√ü der KOMPAS-Dokumentation sind die g√ºltigen Werte der <b>vFormat-</b> Eigenschaft <i>0</i> und <i>-1</i> , dies ist jedoch nicht der <b>Fall</b> .  G√ºltige Werte sind <i>0</i> und <i>1</i> . </li><li>  COMPASS √§ndert die H√∂he der Zeichen nicht.  Es √§ndert nur den Abstand zwischen den Linien.  Wenn die H√∂he der Zeilen geringer als die H√∂he des Absatzes ist, k√∂nnen sie sich √ºberlappen.  Ein Beispiel f√ºr eine solche √úberlagerung ist in der folgenden Abbildung dargestellt. </li></ol><br> <a href=""><img src="https://habrastorage.org/webt/bk/hp/se/bkhpsesuq36ncmmwbotgfwuxdla.png"></a> <br><br>  <b>width</b> - Die Breite des Absatzes in Millimetern. <br>  Mit den Eigenschaften <b>height</b> , <b>hFormat</b> , <b>vFormat</b> und <b>width</b> k√∂nnen wir das Problem des Platzierens von Text in einem bestimmten Rechteck l√∂sen.  Diese Methode ist viel zuverl√§ssiger und effizienter als die in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 11</a> <b>beschriebene</b> Methode <b>ksGetTextLength</b> . <br><br>  <i>x</i> und <i>y</i> sind die Koordinaten des Ankerpunktes.  Die Position des Absatzes relativ zum Ankerpunkt entlang der horizontalen Achse wird durch die <b>ksSetTextAlign-</b> Methode der <b>ksDocument2D-</b> Schnittstelle <b>angepasst</b> (obwohl diese M√∂glichkeit nicht dokumentiert ist).  Der vertikale Ankerpunkt entspricht immer dem unteren Rand der ersten Zeile des Absatzes.  Dieses Verhalten kann nicht ge√§ndert werden. <br>  Die <b>ksParagraphParam-</b> Schnittstelle <b>verf√ºgt</b> nur √ºber eine Methode: <b>Init ()</b> .  Es initialisiert die Eigenschaftswerte der Schnittstelle.  Es hat keine Eingabeparameter.  Wenn erfolgreich, wird <i>true zur√ºckgegeben</i> . <br><br><h2>  <font color="#00B2FF">Absatzgeb√§ude</font> </h2><br>  Das Erstellen eines Absatzes besteht aus drei aufeinander folgenden Schritten. <br><br><ol><li>  Erkl√§rung des Absatzanfangs.  Dazu wird die <b>ksParagraph-</b> Methode der <b>ksDocument2D-</b> Schnittstelle <b>aufgerufen</b> .  Als einziger Parameter akzeptiert diese Methode die Schnittstelle <b>ksParagraphParam</b> , mit der die Parameter des Absatzes festgelegt werden.  Bei Erfolg gibt die <b>ksParagraph-</b> Methode Eins zur√ºck und im Fehlerfall <i>Null</i> . </li><li>  Den Absatz ausf√ºllen.  F√ºr jede in einem Absatz angezeigte Zeile wird die <b>ksTextLine-</b> Methode der <b>ksDocument2D-</b> Schnittstelle <b>aufgerufen</b> .  Als einziger Parameter akzeptiert es die <b>Schnittstelle</b> <b>ksTextItemParam</b> oder <b>ksTextLineParam</b> (in fr√ºheren Lektionen in der Schleife beschrieben), die die Zeichenfolge beschreibt.  Bitte beachten Sie, dass die Ausgabezeilen nicht die Zeichen <i>@</i> , <i>$</i> , <i>&amp;</i> , <i>~</i> , <i>^</i> und <i># enthalten d√ºrfen</i> , da es sich um Steuerzeichen handelt.  Die Arbeit mit ihnen wird in den n√§chsten Lektionen des Zyklus ber√ºcksichtigt. </li><li>  Ende des Absatzes.  Dazu wird die Methode <b>ksEndObj ()</b> der Schnittstelle <b>ksDocument2D</b> <b>aufgerufen</b> .  Es hat keine Eingabeparameter und gibt bei Erfolg einen ganzzahligen Zeiger auf das erstellte Objekt (Absatz) zur√ºck.  Im Fehlerfall wird <i>Null zur√ºckgegeben</i> . </li></ol><br><h2>  <font color="#00B2FF">Ein Beispiel.</font>  <font color="#00B2FF">Der einfachste Absatz</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Unten finden Sie den Quellcode des Programms, der die Konstruktion eines einfachen Absatzes demonstriert.</b> <div class="spoiler_text"><pre><code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre> <br></div></div><br>  Wie immer wird hier der Einfachheit halber der Code weggelassen, der f√ºr die Erstellung und Ausf√ºhrung des Dokuments verantwortlich ist (dieses Thema wurde in fr√ºheren Lektionen behandelt). <br><br>  In diesem Beispiel bestimmt KOMPAS selbst die Gr√∂√üe des Absatzes anhand seines Inhalts.  Die folgende Abbildung zeigt den generierten Absatz. <br><br><img src="https://habrastorage.org/webt/jz/hi/b-/jzhib-bs44smvqvokcomp3shwmg.png"><br><br>  Bitte beachten Sie: Der Text wird als einzelne Zeile angezeigt.  Wir haben die Breite des Absatzes nicht angegeben, daher erh√∂ht KOMPAS ihn bei Bedarf automatisch.  Wenn die Breite festgelegt w√ºrde, w√ºrde das COMPASS-Verhalten durch den Wert der <b>hFormat-</b> Eigenschaft der <b>ksParagraphParam-</b> Schnittstelle bestimmt. <br><br>  Um einen mehrzeiligen und zusammengesetzten Text zu erstellen, m√ºssen Sie die Zeichnungsfunktionen verwenden, die in der vorherigen Lektion teilweise erl√§utert wurden. <br><br><h2>  <font color="#00B2FF">Ein Beispiel.</font>  <font color="#00B2FF">Mehrzeiliger Text</font> </h2><br>  Verwenden Sie das <b>NEW_LINE-</b> Flag ( <i>0x1000</i> ), um explizit in eine neue Zeile zu <i>umbrechen</i> . <br><br><div class="spoiler">  <b class="spoiler_title">Das folgende Beispielprogramm demonstriert das Erstellen eines mehrzeiligen Absatzes mit diesem Flag.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  In diesem Beispiel wird ein dreizeiliger Absatz erstellt.  Die erste Zeile wird wie gewohnt angezeigt.  F√ºr das zweite wird das <b>NEW_LINE-</b> Flag <b>gesetzt</b> .  Er spricht √ºber den Beginn einer neuen Zeile.  Das dritte wird wie gewohnt angezeigt, aber das <b>NEW_LINE-</b> Flag ist weiterhin aktiv, da wir mit derselben Instanz der <b>ksTextItemParam-</b> Schnittstelle arbeiten.  Die folgende Abbildung zeigt den von diesem Programm generierten Absatz. <br><br> <a href=""><img src="https://habrastorage.org/webt/sw/3e/xl/sw3exlx1wgbxrnw6s7fmjshf4qm.png"></a> <br>  Jetzt werden die Zeilen korrekt angezeigt. <br><br><h1>  <font color="#00B2FF">Herausforderungen f√ºr die Arbeit mit Abs√§tzen</font> </h1><br><h2>  <font color="#00B2FF">Textausrichtung</font> </h2><br>  Die Textausrichtung wird durch die <b>ksSetTextLineAlign-</b> Methode der <b>ksDocument2D-</b> Schnittstelle festgelegt.  Es gibt nur einen ganzzahligen Parameter - Set Alignment.  Die g√ºltigen Werte sind in der folgenden Tabelle aufgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/f2/yu/vd/f2yuvdi3o2kl2f7a5nsgglbsdli.png"><br><br>  Bei Erfolg gibt die Methode <b>ksSetTextLineAlign</b> das vorherige Ausrichtungsflag zur√ºck und gibt im Fehlerfall <i>-1 zur√ºck</i> . <br><br>  Beachten Sie, dass die <b>ksSetTextLineAlign-</b> Methode nur innerhalb des Blocks verwendet werden kann (in unserem Fall innerhalb des Absatzes).  Dies bedeutet, dass die Ausrichtung f√ºr die Textausgabe mit der <b>ksText-</b> Methode nicht festgelegt werden kann.  Diese Einschr√§nkung ist darauf zur√ºckzuf√ºhren, dass KOMPAS in diesem Fall nicht wei√ü, an welchen R√§ndern der Text ausgerichtet werden muss. <br>  Ein weiterer wichtiger Punkt h√§ngt mit dem Umfang der <b>ksSetTextLineAlign-</b> Methode zusammen - welche Ausgabezeilen davon betroffen sind.  Betrachten Sie ein Beispiel (hier wird im Vergleich zu ihren Originalen eine sehr vereinfachte Syntax verwendet): <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú ‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú  ‚Äù);</code> </pre><br>  Wie werden die Linien ausgerichtet?  Entgegen unseren Erwartungen werden beide Linien nach rechts ausgerichtet.  Warum?  Tatsache ist, dass die Methode <b>ksSetTextLineAlign</b> zun√§chst die Ausrichtung der letzten Ausgabezeile √§ndert.  In unserem Beispiel passiert Folgendes: Die erste Zeile legt die Ausrichtung der Mitte fest.  Da keine vorherige Ausgabezeile vorhanden ist, √§ndert dieser Aufruf die Standardausrichtung (links). <br><br>  Dann drucken wir die Zeile "Mitte".  Zun√§chst wird die zuvor festgelegte Mittenausrichtung verwendet. <br><br>  In der dritten Zeile √§ndern wir erneut die Ausrichtung.  Zun√§chst √§ndert die Methode die Ausrichtung der vorherigen Zeile ("Mitte").  Daher ist es wie geplant nach rechts und nicht zur Mitte ausgerichtet.  Die gleiche Ausrichtung wird standardm√§√üig ausgerichtet. <br>  Wir zeigen die Zeile "Rechts" an.  Da die <b>ksSetTextLineAlign-</b> Methode nicht mehr aufgerufen wird, wird die zuvor festgelegte Ausrichtung (rechts) verwendet. <br>  Somit sind beide Linien nach rechts ausgerichtet.  Lassen Sie uns nun das Beispiel ein wenig √§ndern: <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú ‚Äù); ksTextLine(‚Äú‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú  ‚Äù);</code> </pre><br>  Wir haben lediglich die Ausgabe einer leeren Zeichenfolge hinzugef√ºgt, ohne die Ausrichtung zu √§ndern.  Jetzt werden die Zeilen korrekt angezeigt.  Dies geschieht, weil die Ausgabe einer leeren Zeichenfolge die eingestellte richtige Ausrichtung ‚Äûabsorbiert‚Äú.  Der zweite Aufruf der Methode <b>ksSetTextLineAlign</b> wirkt sich auf eine leere Zeile und in keiner Weise auf die Mittellinie aus. <br>  Das folgende Beispiel zeigt die korrekte Ausrichtung, ohne dass eine leere Zeichenfolge angezeigt wird. <br><br><pre> <code class="plaintext hljs">ksTextLine(‚Äú ‚Äù); ksSetTextLineAlign(1); ksTextLine(‚Äú  ‚Äù); ksSetTextLineAlign(2);</code> </pre><br>  Die Aufrufe <b>ksTextLine</b> und <b>ksSetTextLineAlign</b> werden ausgetauscht.  Da die <b>ksSetTextLineAlign-</b> Methode haupts√§chlich die zuletzt angezeigte Zeile betrifft, werden die Ausrichtungen korrekt festgelegt und die Zeilen wie gew√ºnscht angezeigt. <br><br><h2>  <font color="#00B2FF">Beispiel</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Das Folgende ist der Quellcode eines Programms, das die Textausrichtung in einem Absatz demonstriert.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); paragraphParam-&gt;set_width(60.0); paragraphParam-&gt;set_hFormat(2); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L"    "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(1); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L"    "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(3); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  In diesem Beispiel wird neben der Textausrichtung auch die Verwendung der <b>width-</b> und <b>hFormat-</b> Eigenschaften der <b>ksParagraphParam-</b> Schnittstelle demonstriert.  Sie werden verwendet, um die Breite zu begrenzen.  Wenn wir sie nicht √§ndern w√ºrden, w√ºrde KOMPAS die Breite des Absatzes erh√∂hen und wir w√ºrden keine Ausrichtung nach links und zur Breite sehen. <br><br>  Leerzeilen werden angezeigt, um die Lesbarkeit des Absatzes zu verbessern.  Sie wirken sich nicht auf die korrekte Ausrichtung aus. <br><br>  Die folgende Abbildung zeigt den von diesem Programm generierten Absatz. <br><br> <a href=""><img src="https://habrastorage.org/webt/jh/kh/bx/jhkhbxlyjawnod_y31k2re1vuz8.png"></a> <br><br><h2>  <font color="#00B2FF">Aktivieren oder deaktivieren Sie den Stil</font> </h2><br>  In der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">11. Lektion des Zyklus haben</a> wir die Flags untersucht, die den Stil steuern ( <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>BOLD_ON</i> , <i>UNDERLINE_ON</i> und <i>UNDERLINE_OFF</i> ).  Dann haben wir sie in Bezug auf die <b>ksText-</b> Methode untersucht.  Ein wichtiger Unterschied zwischen ihrer Verwendung in einem Absatz besteht darin, dass die Aktion nicht auf den Aufruf der <b>ksTextLine-</b> Methode beschr√§nkt ist, sondern sich auf den gesamten Absatz erstreckt.  Schauen wir uns einige Beispiele an. <br><br><pre> <code class="plaintext hljs">TextItemFont-&gt;SetBitVectorValue(BOLD_ON, true); TextItemParam-&gt;s = SysAllocString(L‚Äù ‚Äù); Document2D-&gt;ksTextLine(TextItemParam); TextItemFont-&gt;Init(); TextItemParam-&gt;s = SysAllocString(L‚Äù ‚Äù); Document2D-&gt;ksTextLine(TextItemParam);</code> </pre><br>  Die erste Zeile wird fett angezeigt.  Es gibt keine Fragen dazu.  Aber wie wird die zweite Zeile angezeigt?  Das Flag <i>BOLD_ON wurde</i> f√ºr sie zur√ºckgesetzt.  Daher k√∂nnen wir davon ausgehen, dass es in normaler Schrift angezeigt wird.  Aber das ist nicht so.  Nachdem <i>KOMPAS</i> das <i>BOLD_ON-</i> Flag erf√ºllt hat, versteht es den Befehl wie folgt: Alle nachfolgenden Zeilen dieses Absatzes sind fett gedruckt.  Daher werden alle nachfolgenden Zeilen fett angezeigt, bis der Absatz abgeschlossen ist oder KOMPAS auf das <i>damit gekoppelte BOLD_OFF-</i> Flag st√∂√üt.  Betrachten Sie ein Beispiel: <br><br><pre> <code class="plaintext hljs">TextItemFont.SetBitVectorValue(BOLD_ON, true); TextItemParam.s = SysAllocString(L‚Äù ‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemFont.SetBitVectorValue(BOLD_OFF, true); TextItemParam.s = SysAllocString(L‚Äú ‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemParam.s = SysAllocString(L‚Äù ‚Äù); Document2D.ksTextLine(TextItemParam);</code> </pre><br>  Die erste Zeile ist fett gedruckt.  F√ºr die zweite Zeile <i>l√∂schen</i> wir <i>das BOLD_ON-</i> Flag und spannen das damit <i>gepaarte</i> BOLD_OFF-Flag, wodurch der fette Stil aufgehoben wird.  Aus diesem Grund werden die zweite und dritte Zeile ohne Fettdruck angezeigt. <br><br>  Dieses Verhalten gilt f√ºr die Flags <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>UNDERLINE_ON</i> und <i>UNDERLINE_OFF</i> , jedoch nicht f√ºr das Flag <i>NEW_LINE</i> , da es kein Paar √ºberschreibender Flags enth√§lt. <br><br><h2>  <font color="#00B2FF">Beispiel</font> </h2><br><div class="spoiler">  <b class="spoiler_title">Das Folgende ist der Quellcode des Programms, der die Ausgabe von Text mit verschiedenen Stilen unter Verwendung von Abs√§tzen zeigt.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); // str = SysAllocString(L"  "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); // str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); // str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemFont.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  Der wichtigste Teil dieses Programms ist die richtige Einstellung der Flags f√ºr die Ausgangsleitungen.  Lassen Sie es uns genauer analysieren (die entsprechenden Zeilen des Programms sind mit einem Zeichenpaar ‚Äû <i>//</i> ‚Äú gekennzeichnet). <br><br>  Die erste Zeile wird unver√§ndert angezeigt.  Daher sind keine Flags daf√ºr gesetzt. <br><br>  Die zweite Linie sollte ohne Steigung und mit einer neuen Linie angezeigt werden.  Daher werden die Flags daf√ºr gesetzt: <i>NEW_LINE</i> (in einer neuen Zeile beginnen) und <i>ITALIC_OFF</i> ( <i>Kursivschrift</i> deaktivieren). <br><br>  Die dritte Zeile sollte kursiv und fett gedruckt sein.  Dazu <i>spannen</i> wir die Flags: <i>NEW_LINE</i> , <i>ITALIC_ON</i> (Kursivschrift <i>aktivieren</i> ) und <i>BOLD_ON</i> (Fettdruck <i>aktivieren</i> ).  Alle anderen Flags werden zur√ºckgesetzt. <br><br>  Die vierte Zeile sollte kursiv, unterstrichen und nicht fett gedruckt sein.  Dazu <i>spannen</i> wir die Flags: <i>NEW_LINE</i> , <i>BOLD_OFF</i> (fett deaktivieren, links von der vorherigen Zeile) und <i>UNDERLINE_ON</i> (unterstrichen aktivieren). <br><br>  Wenn der Absatz mehr Zeilen enth√§lt, werden diese in kursiv unterstrichener Schrift angezeigt.  Um den unterstrichenen Stil zu deaktivieren, m√ºssen Sie das Flag UNDERLINE_ON l√∂schen und das Flag <i>UNDERLINE_OFF spannen</i> . <br><br>  Die folgende Abbildung zeigt das Ergebnis dieses Programms. <br><br> <a href=""><img src="https://habrastorage.org/webt/p-/gc/sy/p-gcsy8wpi5wz8gxaa69q55uut4.png"></a> <br><br><h2>  <font color="#00B2FF">Informationen von der Pr√§sentation trennen</font> </h2><br>  Wenn Sie der Struktur Ihrer Programme folgen, haben Sie wahrscheinlich einen schwerwiegenden Nachteil des vorherigen Beispiels festgestellt: Der Code, der f√ºr die Generierung der Ausgabe verantwortlich ist, wird mit dem Code gemischt, der f√ºr die Implementierung der Ausgabe verantwortlich ist.  Bei einem guten Programmierstil ist es √ºblich, Informationen von der Pr√§sentation zu trennen. <br><br>  Wenn die Ausgabeinformationen aus mehreren Zeilen von <b>ksTextItemParam bestehen</b> , k√∂nnen sie zu einer Schnittstelle <b>ksTextLineParam</b> kombiniert werden.  Die <b>ksTextLine-</b> Methode kann diese beiden Schnittstellen verarbeiten.  Dieser Ansatz hat jedoch eine unangenehme Einschr√§nkung: Wenn die <b>ksTextLine-</b> Methode die <b>ksTextLineParam-</b> Schnittstelle akzeptiert, werden die <b>Flags</b> <i>NEW_LINE</i> (und <i>SPECIAL_SYMBOL_END</i> ) ignoriert.  Das hei√üt, alle Informationen werden in einer Zeile angezeigt, auch wenn f√ºr einige <b>ksTextItemParam-</b> <i>Instanzen</i> das Flag <b>NEW_LINE gesetzt</b> ist.  Um diese Einschr√§nkung zu <b>umgehen</b> , m√ºssen Sie <b>ksTextLine</b> f√ºr jede Zeile manuell aufrufen. <br><br><div class="spoiler">  <b class="spoiler_title">Das Folgende ist der Quellcode f√ºr ein Beispiel, das diese Technik demonstriert.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//    DynamicArrayPtr dynamicArray; dynamicArray = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); dynamicArray-&gt;ksClearArray(); //  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //   BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); str = SysAllocString(L"  "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //     for(unsigned int i = 0; i &lt; dynamicArray-&gt;ksGetArrayCount(); ++i) { dynamicArray-&gt;ksGetArrayItem(i, textItemParam); Document2D-&gt;ksTextLine(textItemParam); } //  Document2D-&gt;ksEndObj(); //  textItemFont.Unbind(); textItemParam.Unbind(); paragraphParam.Unbind(); dynamicArray-&gt;ksDeleteArray(); dynamicArray.Unbind();</code> </pre><br></div></div><br>  In diesem Beispiel werden die Ausgabezeilen zuerst in das <b>DynamicArray geschrieben</b> und erst dann in den Absatz ausgegeben.  Auf diese Weise k√∂nnen Sie Informationen von der Pr√§sentation trennen.  Wenn das <i>NEW_LINE-</i> Flag in unserem Beispiel nicht verwendet w√ºrde, k√∂nnten wir mit einem Aufruf der <b>ksTextLine-</b> Methode <b>auskommen</b> . <br><br>  Das Ergebnis dieses Programms √§hnelt dem Ergebnis des vorherigen Beispiels. <br><br>  <b>Fazit</b> <br><br>  In dieser Lektion haben wir uns angesehen, wie Sie einen Absatz erstellen und ihn zum Anzeigen von mehrzeiligem Text verwenden.  Wir haben auch gelernt, Informationen von ihrer Pr√§sentation zu trennen.  Leider erfordert die korrekte Ausgabe von mehrzeiligem Text das manuelle Durchlaufen eines Arrays von Zeichenfolgen.  Dies ist nicht sehr praktisch.  In der n√§chsten Lektion werde ich zeigen, wie dieses Problem gel√∂st werden kann. <br><br>  <b>Um fortzufahren, folgen Sie den Nachrichten des Blogs.</b> <br><br> <a href=""><img align="left" src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., Autor des Buches "Anwendungsentwicklung f√ºr COMPAS in Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de434336/">https://habr.com/ru/post/de434336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de434326/index.html">Ballett in der Luft: kontrollierte Partikelschwebung durch Schallwellen</a></li>
<li><a href="../de434328/index.html">Elektronische Signatur f√ºr die Teilnahme an der Beschaffung</a></li>
<li><a href="../de434330/index.html">Was ist neu in YouTrack 2018.4?</a></li>
<li><a href="../de434332/index.html">Und noch einmal zu KIB SearchInform: Wir besch√§ftigen uns mit den neuesten Entwicklungen</a></li>
<li><a href="../de434334/index.html">Wie Baghunter Luftpostbriefe auf ZeroNights abfingen</a></li>
<li><a href="../de434338/index.html">Qt News, Mai 2018 - Dezember 2018</a></li>
<li><a href="../de434340/index.html">Wie wir Wi-Fi in der U-Bahn von Delhi gepr√ºft haben und was daraus wurde</a></li>
<li><a href="../de434342/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 22: ‚ÄûInformationssicherheit MIT‚Äú, Teil 1</a></li>
<li><a href="../de434344/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 22: ‚ÄûInformationssicherheit MIT‚Äú, Teil 2</a></li>
<li><a href="../de434346/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 22: ‚ÄûInformationssicherheit MIT‚Äú, Teil 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>