<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฅ ๐ ๐๐ผ ุชูููู ูุฌููุนุฉ Kubernetes HA ุนูู ุงููุนุงุฏู ุงููุฌุฑุฏุฉ ุจุงุณุชุฎุฏุงู GlusterFS & MetalLB. ุงูุฌุฒุก 2/3 ๐๐ฟ ๐คท โ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุฌุฒุก 1/3 ููุง 
 ุงูุฌุฒุก 3/3 ููุง 


 ูุฑุญุจุง ููุฑุญุจุง ุจูู ูุฑุฉ ุฃุฎุฑู! ูุฐุง ูู ุงูุฌุฒุก ุงูุซุงูู ูู ุงูููุงูุฉ ุญูู ุฅูุดุงุก ูุฌููุนุฉ Kubernetes ุนูู ุงููุนุฏู ุงูุนุงุฑู. ูู ููุช ุณุงุจู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชูููู ูุฌููุนุฉ Kubernetes HA ุนูู ุงููุนุงุฏู ุงููุฌุฑุฏุฉ ุจุงุณุชุฎุฏุงู GlusterFS & MetalLB. ุงูุฌุฒุก 2/3</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/443110/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/oa/xl/av/oaxlavwz_atdglepw3r_vn6hmxm.jpeg"></p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฌุฒุก 1/3</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ููุง</strong></a> <br>  <strong>ุงูุฌุฒุก 3/3</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ููุง</strong></a> </p><br><p style=";text-align:right;direction:rtl">  ูุฑุญุจุง ููุฑุญุจุง ุจูู ูุฑุฉ ุฃุฎุฑู!  ูุฐุง ูู ุงูุฌุฒุก ุงูุซุงูู ูู ุงูููุงูุฉ ุญูู ุฅูุดุงุก ูุฌููุนุฉ Kubernetes ุนูู ุงููุนุฏู ุงูุนุงุฑู.  ูู ููุช ุณุงุจู ูููุง ุจุชูููู ูุฌููุนุฉ Kubernetes HA ุจุงุณุชุฎุฏุงู etcd ุฎุงุฑุฌู ุ ูุงุฌุณุชูุฑ ูููุฒุงู ุชุญููู.  ุญุณููุง ุ ุญุงู ุงูููุช ุงูุขู ูุฅุนุฏุงุฏ ุจูุฆุฉ ุฅุถุงููุฉ ูุฃุฏูุงุช ูุณุงุนุฏุฉ ูุฌุนู ุงููุฌููุนุฉ ุฃูุซุฑ ูุงุฆุฏุฉ ูุฃูุฑุจ ููุช ูููู ุฅูู ุญุงูุฉ ุงูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฌุฒุก ูู ุงูููุงูุฉ ุ ุณูุฑูุฒ ุนูู ุชูููู ููุงุฒู ุงูุชุญููู ุงูุฏุงุฎูู ูุฎุฏูุงุช ุงููุชูุฉ - ุณูููู ูุฐุง MetalLB.  ุณูููู ุฃูุถูุง ุจุชุซุจูุช ูุชูููู ุชุฎุฒูู ุงููููุงุช ุงูููุฒุน ุจูู ุนูุฏ ุงูุนูู ูุฏููุง.  ุณูู ูุณุชุฎุฏู GlusterFS ููุญุฏุงุช ุงูุชุฎุฒูู ุงูุซุงุจุชุฉ ุงููุชููุฑุฉ ูู Kubernetes. <br>  ุจุนุฏ ุงูุงูุชูุงุก ูู ุฌููุน ุงูุฎุทูุงุช ุ ุณูุจุฏู ูุฎุทุท ุงููุฌููุนุฉ ุงูุฎุงุต ุจูุง ููุง ููู: </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/_v/yp/pe/_vyppenp91uzmkowqv1qcyomnrc.jpeg"></a> </p><a name="habracut"></a><br><h3 id="1-nastroyka-metallb-v-kachestve-vnutrennego-balansirovschika-nagruzki" style=";text-align:right;direction:rtl">  1. ูู ุจุฅุนุฏุงุฏ MetalLB ูููุงุฒู ุชุญููู ุฏุงุฎูู. </h3><br><p style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุญูู MetalLB ุ ูุจุงุดุฑุฉ ูู ุตูุญุฉ ุงููุณุชูุฏ: </p><br><blockquote style=";text-align:right;direction:rtl"> MetalLB ูู ุชุทุจูู ููุงุฒู ุงูุชุญููู ููุฌููุนุงุช Kubernetes ุงูุนุงุฑูุฉ ุงููุนุฏููุฉ ูุน ุจุฑูุชููููุงุช ุงูุชูุฌูู ุงูููุงุณูุฉ. <br><br>  ูุง ุชูุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kubernetes</a> ุชุทุจูู ููุงุฒูู ุชุญููู ุงูุดุจูุฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุน ุงูุฎุฏูุฉ LoadBalancer</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุนุงุฏู ุงููุฌุฑุฏุฉ</a> .  ุฌููุน ุฎูุงุฑุงุช ุชุทุจูู Network LB ุงูุชู ุชุฃุชู ูุนูุง Kubernetes ุนุจุงุฑุฉ ุนู ุจุฑุงูุฌ ูุณูุทุฉ ุ ููู ุชุตู ุฅูู ุงูุนุฏูุฏ ูู ููุตุงุช IaaS (GCP ุ AWS ุ Azure ุ ุฅูุฎ).  ุฅุฐุง ููุช ูุง ุชุนูู ุนูู ูุธุงู ุฃุณุงุณู ูุฏุนูู ูู IaaS (GCP ุ AWS ุ Azure ุ ููุง ุฅูู ุฐูู) ุ ูุณูุธู ุจุฑูุงูุฌ LoadBalancer ูู ุญุงูุฉ "ุงูุงุณุชุนุฏุงุฏ" ููุชุฑุฉ ุบูุฑ ูุญุฏุฏุฉ ุนูุฏ ุงูุฅูุดุงุก. <br><br>  ูุฏู ูุดุบูู ุฎุงุฏู BM ุฃุฏูุงุชูู ุฃูู ูุงุนููุฉ ูุฅุฏุฎุงู ุญุฑูุฉ ูุฑูุฑ ุงููุณุชุฎุฏู ูู ูุฌููุนุงุชูู ุ ูุฎุฏูุงุช NodePort ู externalIPs.  ูู ูู ูุฐู ุงูุฎูุงุฑุงุช ูุฏููุง ุฃูุฌู ูุตูุฑ ูุจูุฑุฉ ูู ุงูุฅูุชุงุฌ ุ ุงูุฃูุฑ ุงูุฐู ูุญูู ูุฌููุนุงุช BM ุฅูู ููุงุทููู ูู ุงูุฏุฑุฌุฉ ุงูุซุงููุฉ ูู ุงููุธุงู ุงูุจูุฆู Kubernetes. <br><br>  ุชุณุนู MetalLB ุฅูู ุชุตุญูุญ ูุฐุง ุงูุฎูู ูู ุฎูุงู ุชูุฏูู ุชุทุจูู Network LB ุ ูุงูุฐู ูุชูุงูู ูุน ูุนุฏุงุช ุงูุดุจูุฉ ุงูููุงุณูุฉ ุ ุจุญูุซ "ุชุนูู ููุท" ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ ุนูู ูุฌููุนุงุช BM ุจุฃูุตู ุณุฑุนุฉ. </blockquote><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ุจุงุณุชุฎุฏุงู ูุฐู ุงูุฃุฏุงุฉ ุ ูุทูู ุฎุฏูุงุช ูู ูุธุงู Kubernetes ุจุงุณุชุฎุฏุงู ููุงุฒู ุงูุชุญููู ุ ูุงูุฐู ุจูุถู ุงููุซูุฑ ูู ุงูุดูุฑ ููุฑูู MetalLB.  ุนูููุฉ ุงูุฅุนุฏุงุฏ ุจุณูุทุฉ ุญูุง ููุจุงุดุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ููุช ุณุงุจู ูู ุงููุซุงู ุ ุงุฎุชุฑูุง ุงูุดุจูุฉ ุงููุฑุนูุฉ 192.168.0.0/24 ูุชูุจูุฉ ุงุญุชูุงุฌุงุช ูุฌููุนุชูุง.  ุงูุขู ุ ุฎุฐ ุจุนุถูุง ูู ูุฐู ุงูุดุจูุฉ ุงููุฑุนูุฉ ูููุงุฒู ุงูุชุญููู ุงููุณุชูุจูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฏุฎู ูุธุงู ุงูุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ <strong>kubectl ุงูุชู ุชู</strong> ุชูููููุง <strong>ููุนูู</strong> : </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">control# kubectl apply -f https://raw.githubusercontent.com/google/metallb/v0.7.3/manifests/metallb.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุคุฏู ุฐูู ุฅูู ูุดุฑ MetalLB ูู ุงููุชูุฉ ุ ูู <code>metallb-system</code> .  ุชุฃูุฏ ูู ุฃู ุฌููุน ููููุงุช MetalLB ุชุนูู ุจุดูู ุตุญูุญ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get pod --namespace=metallb-system NAME READY STATUS RESTARTS AGE controller-7cc9c87cfb-ctg7p 1/1 Running 0 5d3h speaker-82qb5 1/1 Running 0 5d3h speaker-h5jw7 1/1 Running 0 5d3h speaker-r2fcg 1/1 Running 0 5d3h</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุชูููู MetalLB ุจุงุณุชุฎุฏุงู configmap.  ูู ูุฐุง ุงููุซุงู ุ ูุณุชุฎุฏู ุชุฎุตูุต Layer 2. ููุญุตูู ุนูู ูุนูููุงุช ุญูู ุฎูุงุฑุงุช ุงูุชุฎุตูุต ุงูุฃุฎุฑู ุ ุฑุงุฌุน ูุซุงุฆู MetalLB. </p><br><p style=";text-align:right;direction:rtl">  ูู <strong>ุจุฅูุดุงุก ููู metallb-config.yaml</strong> ูู ุฃู ุฏููู ุฏุงุฎู ูุทุงู IP ุงููุญุฏุฏ ููุดุจูุฉ ุงููุฑุนูุฉ ููุฌููุนุชูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# vi metallb-config.yaml apiVersion: v1 kind: ConfigMap metadata: namespace: metallb-system name: config data: config: | address-pools: - name: default protocol: layer2 addresses: - 192.168.0.240-192.168.0.250</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุทุจูู ูุฐุง ุงูุฅุนุฏุงุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl apply -f metallb-config.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุญูู ูุชุนุฏูู configmap ูู ููุช ูุงุญู ุฅุฐุง ูุฒู ุงูุฃูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl describe configmaps -n metallb-system control# kubectl edit configmap config -n metallb-system</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฏููุง ููุงุฒู ุงูุชุญููู ุงููุญูู ุงูููููุฉ ูุฏููุง.  ุฏุนููุง ูุฑู ููู ุชุนูู ุ ูุฐูู ุจุงุณุชุฎุฏุงู ุฎุฏูุฉ Nginx ููุซุงู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# vi nginx-deployment.yaml apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment spec: selector: matchLabels: app: nginx replicas: 3 template: metadata: labels: app: nginx spec: containers: - name: nginx image: nginx:latest ports: - containerPort: 80 control# vi nginx-service.yaml apiVersion: v1 kind: Service metadata: name: nginx spec: type: LoadBalancer selector: app: nginx ports: - port: 80 name: http</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุซู ูู ุจุฅูุดุงุก ุงุฎุชุจุงุฑ ูุดุฑ ูุฎุฏูุฉ Nginx: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl apply -f nginx-deployment.yaml control# kubectl apply -f nginx-service.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงูุขู - ุชุญูู ูู ุงููุชูุฌุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get po NAME READY STATUS RESTARTS AGE nginx-deployment-6574bd76c-fxgxr 1/1 Running 0 19s nginx-deployment-6574bd76c-rp857 1/1 Running 0 19s nginx-deployment-6574bd76c-wgt9n 1/1 Running 0 19s control# kubectl get svc NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE nginx LoadBalancer 10.100.226.110 192.168.0.240 80:31604/TCP 107s</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู ุฅูุดุงุก 3 ูุฑูู Nginx ุ ููุง ุฃุดุฑูุง ูู ุงููุดุฑ ูุณุจููุง.  ุณุชููู ุฎุฏูุฉ Nginx ุจุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ุฅูู ุฌููุน ูุฐู ุงููุฑูู ููููุง ููุฎุทุท ุงูููุงุฒูุฉ ุงูุฏูุฑูุฉ.  ูููููู ุฃูุถูุง ุฑุคูุฉ ุนููุงู IP ุงูุฎุงุฑุฌู ุงููุณุชูู ูู ููุงุฒู ุงูุชุญููู MetalLB ุงูุฎุงุต ุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ุฌุฑูุจ ุงูุขู ุงูุงูุชูุงู ุฅูู ุนููุงู IP 192.168.0.240 ูุณุชุธูุฑ ูู ุตูุญุฉ Nginx index.html.  ุชุฐูุฑ ุฅุฒุงูุฉ ูุดุฑ ุงูุงุฎุชุจุงุฑ ูุฎุฏูุฉ Nginx. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl delete svc nginx service "nginx" deleted control# kubectl delete deployment nginx-deployment deployment.extensions "nginx-deployment" deleted</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ูู ุฐูู ูุน MetalLB ุ ุฏุนูุง ููุชูู - ุณูููู ุจุชูููู ูุญุฏุงุช ุชุฎุฒูู GlusterFS ูู Kubernetes. </p><br><h3 id="2-nastroyka-glusterfs-s-heketi-na-rabochih-nodah" style=";text-align:right;direction:rtl">  2. ุชูููู GlusterFS ูุน Heketi ุนูู ุนูุฏ ุงูุนูู. </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุง ูููู ุงุณุชุฎุฏุงู ูุชูุฉ Kubernetes ุจุฏูู ูุญุฏุงุช ุชุฎุฒูู ุจุฏุงุฎููุง.  ููุง ุชุนูููู ุ ูุฅู ุงููููุฏ ุณุฑูุน ุงูุฒูุงู ุ ุฃู  ูููู ุฅูุดุงุคูุง ูุญุฐููุง ูู ุฃู ููุช.  ุณูุชู ููุฏ ุฌููุน ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุจุฏุงุฎููุง.  ูุจุงูุชุงูู ุ ูู ุงููุชูุฉ ุงูุญููููุฉ ุ ููุฒู ุงูุชุฎุฒูู ุงูููุฒุน ูุถูุงู ุชุจุงุฏู ุงูุฅุนุฏุงุฏุงุช ูุงูุจูุงูุงุช ุจูู ุงูุนูุฏ ูุงูุชุทุจููุงุช ุฏุงุฎูู. </p><br><p style=";text-align:right;direction:rtl">  ูู Kubernetes ุ ุชุชููุฑ ูุญุฏุงุช ุงูุชุฎุฒูู ุจุนุฏุฉ ุทุฑู ุ ุงุฎุชุฑ ูุง ุชุฑูุฏ.  ูู ูุฐุง ุงููุซุงู ุ ุณุฃูุถุญ ููููุฉ ุฅูุดุงุก ุชุฎุฒูู GlusterFS ูุฃู ุชุทุจููุงุช ุฏุงุฎููุฉ ุ ููู ูุดุจู ูุญุฏุงุช ุงูุชุฎุฒูู ุงูุซุงุจุชุฉ.  ูู ููุช ุณุงุจู ุ ุงุณุชุฎุฏูุช ุงูุชุซุจูุช "ุงููุธุงู" ูู GlusterFS ูุฌููุน ุงูุนูุฏ ุงูุนุงููุฉ Kubernetes ููุฐุง ุงูุบุฑุถ ุ ุซู ููุช ุจุจุณุงุทุฉ ุจุฅูุดุงุก ูุญุฏุงุช ุชุฎุฒูู hostPath ูู ุฏูุงุฆู GlusterFS. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฏููุง ุฃุฏุงุฉ ุฌุฏูุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>Heketi</strong></a> ูููุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ูู ูุซุงุฆู Heketi: </p><br><blockquote style=";text-align:right;direction:rtl">  ุจููุฉ ุชุญุชูุฉ ูุฅุฏุงุฑุฉ ูุญุฏุฉ ุงูุชุฎุฒูู ูุฑูุญุฉ ูู GlusterFS. <br><br>  ููุฏู Heketi ูุงุฌูุฉ ุฅุฏุงุฑุฉ ูุฑูุญุฉ ูููู ุงุณุชุฎุฏุงููุง ูุฅุฏุงุฑุฉ ุฏูุฑุฉ ุญูุงุฉ ูุญุฏุงุช ุชุฎุฒูู GlusterFS.  ุจูุถู Heketi ุ ูููู ููุฎุฏูุงุช ุงูุณุญุงุจูุฉ ูุซู OpenStack Manila ู Kubernetes ู OpenShift ุชูููุฑ ูุญุฏุงุช ุชุฎุฒูู GlusterFS ุจุดูู ุญููู ูุน ุฃู ููุน ูู ุงูููุซูููุฉ ุงููุฏุนููุฉ.  ูุญุฏุฏ Heketi ูููุน ุงููุชู ูู ุงููุชูุฉ ุชููุงุฆููุง ุ ููุง ูููุฑ ูููุน ุงููุชู ูุงููุณุฎ ุงููุชูุงุซูุฉ ุงูุฎุงุตุฉ ุจูุง ูู ููุงุทู ูุฎุชููุฉ ูู ุงููุดู.  ูุฏุนู Heketi ุฃูุถูุง ุฃู ุนุฏุฏ ูู ูุฌููุนุงุช GlusterFS ุ ููุง ูุณูุญ ููุฎุฏูุงุช ุงูุณุญุงุจูุฉ ุจุชูุฏูู ุชุฎุฒูู ูููุงุช ุนุจุฑ ุงูุฅูุชุฑูุช ุ ูููุณ ููุท ูุฌููุนุฉ GlusterFS ูุงุญุฏุฉ. </blockquote><p style=";text-align:right;direction:rtl">  ูุจุฏู ุฌูุฏูุง ุ ูุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุณุชุฌุนู ูุฐู ุงูุฃุฏุงุฉ ูุฌููุนุฉ VM ุงูุฎุงุตุฉ ุจูุง ุฃูุฑุจ ุฅูู ูุฌููุนุงุช ุณุญุงุจุฉ Kubernetes ุงููุจูุฑุฉ.  ูู ุงูููุงูุฉ ุ ุณุชุชููู ูู ุฅูุดุงุก <strong>PersistentVolumeClaims</strong> ุ ูุงูุฐู ุณูุชู ุฅูุดุงุคู ุชููุงุฆููุง ุ ูุฃูุซุฑ ูู ุฐูู ุจูุซูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุฃู ุชุฃุฎุฐ ูุญุฑูุงุช ุฃูุฑุงุต ุตูุจุฉ ุฅุถุงููุฉ ูููุธุงู ูุชูููู GlusterFS ุฃู ูุฌุฑุฏ ุฅูุดุงุก ุจุนุถ ุฃุฌูุฒุฉ ูุชูุฉ ููููุฉ.  ูู ูุฐุง ุงููุซุงู ุ ุณุฃุณุชุฎุฏู ุงูุทุฑููุฉ ุงูุซุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฃุฌูุฒุฉ ูุชูุฉ ููููุฉ ุนูู ุฌููุน ุงูุนูุฏ ุงูุนูู ุงูุซูุงุซุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">worker1-3# dd if=/dev/zero of=/home/gluster/image bs=1M count=10000</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูู ุชุญุตู ุนูู ููู ุจุญุฌู 10 ุฌูุฌุงุจุงูุช.  ุซู ุงุณุชุฎุฏู <strong>losetup</strong> - ูุฅุถุงูุชู ุฅูู ูุฐู ุงูุนูุฏ ุ ูุฌูุงุฒ ุงุณุชุฑุฌุงุน: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">worker1-3# losetup /dev/loop0 /home/gluster/image</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  <em>ูุฑุฌู ููุงุญุธุฉ: ุฅุฐุง ูุงู ูุฏูู ุจุงููุนู ููุน ูู ุฃุฌูุฒุฉ ุงูุงุณุชุฑุฌุงุน 0 ุ ูุณุชุญุชุงุฌ ุฅูู ุงุฎุชูุงุฑ ุฃู ุฑูู ุขุฎุฑ.</em> </blockquote><p style=";text-align:right;direction:rtl">  ุฃุฎุฐุช ุงูููุช ููุฌุฏุช ููุงุฐุง Heketi ูุง ูุฑูุฏ ุฃู ูุนูู ุจุดูู ุตุญูุญ.  ูุฐูู ุ ูููุน ุญุฏูุซ ุฃู ูุดููุงุช ูู ุงูุชููููุงุช ุงููุณุชูุจููุฉ ุ ุชุฃูุฏ ุฃููุงู ูู ุฃููุง ูููุง ุจุชุญููู <strong>ูุญุฏุฉ dm_thin_pool</strong> kernel ูุชุซุจูุช ุญุฒูุฉ <strong>glusterfs-client</strong> ุนูู ุฌููุน ุนูุฏ ุงูุนูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">worker1-3# modprobe dm_thin_pool worker1-3# apt-get update &amp;&amp; apt-get -y install glusterfs-client</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุฃูุช ุงูุขู ุจุญุงุฌุฉ ุฅูู ุงูููู <strong>/ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ / ุงูููุนุงู / ุงูุตูุฑุฉ</strong> ูุงูุฌูุงุฒ <strong>/ dev / loop0</strong> ููููู ุญุงุถุฑูุง ูู ุฌููุน ููุงุท ุงูุนูู.  ุชุฐูุฑ ุฃู ุชูุดุฆ ุฎุฏูุฉ systemd ุณุชุจุฏุฃ ุชููุงุฆููุง ุชุดุบูู <strong>losetup</strong> ู <strong>modprobe ูู</strong> ูู ูุฑุฉ ูุชู ูููุง ุชุดุบูู ูุฐู ุงูุฎูุงุฏู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">worker1-3# vi /etc/systemd/system/loop_gluster.service [Unit] Description=Create the loopback device for GlusterFS DefaultDependencies=false Before=local-fs.target After=systemd-udev-settle.service Requires=systemd-udev-settle.service [Service] Type=oneshot ExecStart=/bin/bash -c "modprobe dm_thin_pool &amp;&amp; [ -b /dev/loop0 ] || losetup /dev/loop0 /home/gluster/image" [Install] WantedBy=local-fs.target</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุดุบููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">worker1-3# systemctl enable /etc/systemd/system/loop_gluster.service Created symlink /etc/systemd/system/local-fs.target.wants/loop_gluster.service โ /etc/systemd/system/loop_gluster.service.</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชูุงู ุงูุนูู ุงูุชุญุถูุฑู ุ ููุญู ุนูู ุงุณุชุนุฏุงุฏ ููุดุฑ GlusterFS ู Heketi ูู ูุฌููุนุชูุง.  ููุฐุง ุ ุณุฃุณุชุฎุฏู ูุฐุง <a href="">ุงูุฏููู</a> ุงูุฑุงุฆุน.  ูุชู ุชุดุบูู ูุนุธู ุงูุฃูุงูุฑ ูู ููุจููุชุฑ ุชุญูู ุฎุงุฑุฌู ุ ููุชู ุชุดุบูู ุฃูุงูุฑ ุตุบูุฑุฉ ุฌุฏูุง ูู ุฃู ุนูุฏุฉ ุฑุฆูุณูุฉ ุฏุงุฎู ุงููุชูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูู ุจูุณุฎ ุงููุณุชูุฏุน ูุฅูุดุงุก DaemonSet GlusterFS: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# git clone https://github.com/heketi/heketi control# cd heketi/extras/kubernetes control# kubectl create -f glusterfs-daemonset.json</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนูุง ูุญุชูู ุจุนููุฏ ุงูุนูู ุงูุซูุงุซุฉ ุงูุฎุงุตุฉ ุจู GlusterFS ุ  ุจุนุฏ ูุถุน ุงูุนูุงูุงุช ุนูููุง ุ ุณูุชู ุฅูุดุงุก ูุฑูู GlusterFS: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl label node worker1 storagenode=glusterfs control# kubectl label node worker2 storagenode=glusterfs control# kubectl label node worker3 storagenode=glusterfs control# kubectl get pod NAME READY STATUS RESTARTS AGE glusterfs-5dtdj 1/1 Running 0 1m6s glusterfs-hzdll 1/1 Running 0 1m9s glusterfs-p8r59 1/1 Running 0 2m1s</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุขู ุจุฅูุดุงุก ุญุณุงุจ ุฎุฏูุฉ Heketi: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl create -f heketi-service-account.json</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ููุฏู ูุญุณุงุจ ูุฐู ุงูุฎุฏูุฉ ุงููุฏุฑุฉ ุนูู ุฅุฏุงุฑุฉ ุงููุฑูู ุงููุงูุนุฉ.  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุฏุงูุฉ ูุชูุฉ ูุทููุจุฉ ูุญุณุงุจ ุงูุฎุฏูุฉ ุงูุฐู ุชู ุฅูุดุงุคู ุญุฏูุซูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl create clusterrolebinding heketi-gluster-admin --clusterrole=edit --serviceaccount=default:heketi-service-account</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ูููู ุจุฅูุดุงุก ููุชุงุญ ุณุฑ Kubernetes ูููุน ุชูููู ูุซูู Heketi ุงูุฎุงุต ุจูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl create secret generic heketi-config-secret --from-file=./heketi.json</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ุงููุตุฏุฑ ุงูุฃูู ุชุญุช Heketi ุ ูุงูุฐู ูุณุชุฎุฏูู ูู ุนูููุงุช ุงูุฅุนุฏุงุฏ ุงูุฃููู ุซู ุงุญุฐูู ูุงุญููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl create -f heketi-bootstrap.json service "deploy-heketi" created deployment "deploy-heketi" created control# kubectl get pod NAME READY STATUS RESTARTS AGE deploy-heketi-1211581626-2jotm 1/1 Running 0 2m glusterfs-5dtdj 1/1 Running 0 6m6s glusterfs-hzdll 1/1 Running 0 6m9s glusterfs-p8r59 1/1 Running 0 7m1s</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅูุดุงุก ุฎุฏูุฉ Bootstrap Heketi ูุจุฏุก ุชุดุบูููุง ุ ุณูุญุชุงุฌ ุฅูู ุงูุชุจุฏูู ุฅูู ุฅุญุฏู ุงูุนูุฏ ุงูุฑุฆูุณูุฉ ุงูุฎุงุตุฉ ุจูุง ุ ุญูุซ ุณูููู ุจุชุดุบูู ุงูุนุฏูุฏ ูู ุงูุฃูุงูุฑ ุ ูุธุฑูุง ูุฃู ุนูุฏุฉ ุงูุชุญูู ุงูุฎุงุฑุฌูุฉ ุงูุฎุงุตุฉ ุจูุง ููุณุช ุฏุงุฎู ูุฌููุนุชูุง ุ ูุฐูู ูุง ูููููุง ุงููุตูู ุฅูู ูุฑูู ุงูุนูู ูุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูููุฌููุนุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฏุนูุง ูููู ุจุชูุฒูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ heketi-client ููุณุฎูุง ุฅูู ูุฌูุฏ ูุธุงู bin: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1# wget https://github.com/heketi/heketi/releases/download/v8.0.0/heketi-client-v8.0.0.linux.amd64.tar.gz master1# tar -xzvf ./heketi-client-v8.0.0.linux.amd64.tar.gz master1# cp ./heketi-client/bin/heketi-cli /usr/local/bin/ master1# heketi-cli heketi-cli v8.0.0</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุงุจุญุซ ุนู ุนููุงู IP ูุฌูุงุฒ heketi ููู ุจุชุตุฏูุฑู ููุชุบูุฑ ูููุธุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1# kubectl --kubeconfig /etc/kubernetes/admin.conf describe pod deploy-heketi-1211581626-2jotm For me this pod have a 10.42.0.1 ip master1# curl http://10.42.0.1:57598/hello Handling connection for 57598 Hello from Heketi master1# export HEKETI_CLI_SERVER=http://10.42.0.1:57598</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ููุฒูุฏ Heketi ุจูุนูููุงุช ุญูู ูุฌููุนุฉ GlusterFS ุงูุชู ูุฌุจ ุฃู ุชุฏูุฑูุง.  ูุญู ููุฏููุง ูู ุฎูุงู ููู ุทูุจูููุฌูุง.  ุงููููู ูู ุจูุงู JSON ูุน ูุงุฆูุฉ ุจุฌููุน ุงูุนูุฏ ูุงูุฃูุฑุงุต ูุงููุฌููุนุงุช ุงูุชู ุชุณุชุฎุฏููุง GlusterFS. </p><br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ  ุชุฃูุฏ ูู ุฃู <code>hostnames/manage</code> ุชุดูุฑ ุฅูู ุงูุงุณู ุงูุฏููู ุ ููุง ูู ุงูุญุงู ูู ูุณู <code>kubectl get node</code> ุ ูุฃู <code>hostnames/storage</code> ูู ุนููุงู IP ูุนูุฏ ุงูุชุฎุฒูู. </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1:~/heketi-client# vi topology.json { "clusters": [ { "nodes": [ { "node": { "hostnames": { "manage": [ "worker1" ], "storage": [ "192.168.0.7" ] }, "zone": 1 }, "devices": [ "/dev/loop0" ] }, { "node": { "hostnames": { "manage": [ "worker2" ], "storage": [ "192.168.0.8" ] }, "zone": 1 }, "devices": [ "/dev/loop0" ] }, { "node": { "hostnames": { "manage": [ "worker3" ], "storage": [ "192.168.0.9" ] }, "zone": 1 }, "devices": [ "/dev/loop0" ] } ] } ] }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุซู ูู ุจุชูุฒูู ูุฐุง ุงูููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1:~/heketi-client# heketi-cli topology load --json=topology.json Creating cluster ... ID: e83467d0074414e3f59d3350a93901ef Allowing file volumes on cluster. Allowing block volumes on cluster. Creating node worker1 ... ID: eea131d392b579a688a1c7e5a85e139c Adding device /dev/loop0 ... OK Creating node worker2 ... ID: 300ad5ff2e9476c3ba4ff69260afb234 Adding device /dev/loop0 ... OK Creating node worker3 ... ID: 94ca798385c1099c531c8ba3fcc9f061 Adding device /dev/loop0 ... OK</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูุณุชุฎุฏู Heketi ูุชูููุฑ ูุญุฏุงุช ุชุฎุฒูู ูุชุฎุฒูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุงุณู ุงููุฑูู ุบุฑูุจ ุจุนุถ ุงูุดูุก ุ ููู ูู ุดูุก ุนูู ูุง ูุฑุงู.  ูู ุฃูุถูุง ุจุฅูุดุงุก ูุณุชูุฏุน heketi: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1:~/heketi-client# heketi-cli setup-openshift-heketi-storage master1:~/heketi-client# kubectl --kubeconfig /etc/kubernetes/admin.conf create -f heketi-storage.json secret/heketi-storage-secret created endpoints/heketi-storage-endpoints created service/heketi-storage-endpoints created job.batch/heketi-storage-copy-job created</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุฌููุน ุงูุฃูุงูุฑ ุงูุชู ุชุญุชุงุฌ ุฅูู ุชุดุบูููุง ูู ุงูุนูุฏุฉ ุงูุฑุฆูุณูุฉ.  ุฏุนูุง ูุนูุฏ ุฅูู ุนูุฏุฉ ุงูุชุญูู ููุณุชูุฑ ูู ููุงู ุ  ุฃููุงู ููุจู ูู ุดูุก ุ ุชุฃูุฏ ูู ุชูููุฐ ุขุฎุฑ ุฃูุฑ ููุฏ ุงูุชุดุบูู ุจูุฌุงุญ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get pod NAME READY STATUS RESTARTS AGE glusterfs-5dtdj 1/1 Running 0 39h glusterfs-hzdll 1/1 Running 0 39h glusterfs-p8r59 1/1 Running 0 39h heketi-storage-copy-job-txkql 0/1 Completed 0 69s</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุชู ูููุฉ heketi-storage-copy-job. </p><br><blockquote style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุญุฒูุฉ <strong>glusterfs-client</strong> ูุซุจุชุฉ ุญุงูููุง ุนูู ุนูุฏ ุงูุนูู ุ <strong>ูุณูุญุฏุซ</strong> ุฎุทุฃ. </blockquote><p style=";text-align:right;direction:rtl">  ุญุงู ุงูููุช ูุฅุฒุงูุฉ ููู ุงูุชุซุจูุช Heketi Bootstrap ูุงูููุงู ุจุจุนุถ ุงูุชูุธูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl delete all,service,jobs,deployment,secret --selector="deploy-heketi"</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงููุฑุญูุฉ ุงูุฃุฎูุฑุฉ ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุณุฎุฉ ุทูููุฉ ุงูุฃุฌู ูู Heketi: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# cd ./heketi/extras/kubernetes control:~/heketi/extras/kubernetes# kubectl create -f heketi-deployment.json secret/heketi-db-backup created service/heketi created deployment.extensions/heketi created control# kubectl get pod NAME READY STATUS RESTARTS AGE glusterfs-5dtdj 1/1 Running 0 39h glusterfs-hzdll 1/1 Running 0 39h glusterfs-p8r59 1/1 Running 0 39h heketi-b8c5f6554-knp7t 1/1 Running 0 22m</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุญุฒูุฉ glusterfs-client ูุซุจุชุฉ ุญุงูููุง ุนูู ุนูุฏ ุงูุนูู ุ ูุณูุญุฏุซ ุฎุทุฃ.  ููุฏ ุงูุชูููุง ุชูุฑูุจูุง ุ ูุชู ุงูุขู ุชุฎุฒูู ูุงุนุฏุฉ ุจูุงูุงุช Heketi ูู ูุญุฏุฉ ุชุฎุฒูู GlusterFS ููุง ุชุชู ุฅุนุงุฏุฉ ุถุจุทูุง ูู ูู ูุฑุฉ ูุชู ูููุง ุฅุนุงุฏุฉ ุชุดุบูู ูููุฏ Heketi. </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏุก ุงุณุชุฎุฏุงู ูุชูุฉ GlusterFS ูุน ุชุฎุตูุต ููุงุฑุฏ ุฏููุงูููู ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก StorageClass. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฏุนูุง ูุนุซุฑ ุนูู ููุทุฉ ููุงูุฉ ุงูุชุฎุฒูู Gluster ุ ูุงูุชู ุณูุชู ุชูุฑูุฑูุง ุฅูู StorageClass ููุนููุฉ (ููุงุท ููุงูุฉ ุงูุชุฎุฒูู heketi): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get endpoints NAME ENDPOINTS AGE heketi 10.42.0.2:8080 2d16h ....... ... ..</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุฅูุดุงุก ุจุนุถ ุงููููุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# vi storage-class.yml apiVersion: storage.k8s.io/v1beta1 kind: StorageClass metadata: name: slow provisioner: kubernetes.io/glusterfs parameters: resturl: "http://10.42.0.2:8080" control# vi test-pvc.yml kind: PersistentVolumeClaim apiVersion: v1 metadata: name: gluster1 annotations: volume.beta.kubernetes.io/storage-class: "slow" spec: accessModes: - ReadWriteOnce resources: requests: storage: 1Gi</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู ูุฐู ุงููููุงุช ูุฅูุดุงุก ูุฆุฉ ู pvc: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl create -f storage-class.yaml storageclass "slow" created control# kubectl get storageclass NAME PROVISIONER AGE slow kubernetes.io/glusterfs 2d8h control# kubectl create -f test-pvc.yaml persistentvolumeclaim "gluster1" created control# kubectl get pvc NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE gluster1 Bound pvc-27f733cd-1c77-11e9-bb07-7efe6b0e6fa5 1Gi RWO slow 2d8h</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููููุง ุฃูุถุง ูุดุงูุฏุฉ ุญุฌู ุงูููุฑูุถูุฆูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get pv NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE pvc-27f733cd-1c77-11e9-bb07-7efe6b0e6fa5 1Gi RWO Delete Bound default/gluster1 slow 2d8h</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฏููุง ุงูุขู ูุญุฏุฉ ุชุฎุฒูู GlusterFS ุชู ุฅูุดุงุคูุง ุฏููุงูููููุง ูุชุฑุชุจุท ุจู <strong>PersistentVolumeClaim</strong> ุ ููููููุง ุงุณุชุฎุฏุงู ูุฐุง ุงูุจูุงู ูู ุฃู ูุฎุทุท ูุฑุนู. </p><br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุงุญุฏุฉ ุจุณูุทุฉ ุชุญุช Nginx ูุงุฎุชุจุงุฑู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# vi nginx-test.yml apiVersion: v1 kind: Pod metadata: name: nginx-pod1 labels: name: nginx-pod1 spec: containers: - name: nginx-pod1 image: gcr.io/google_containers/nginx-slim:0.8 ports: - name: web containerPort: 80 volumeMounts: - name: gluster-vol1 mountPath: /usr/share/nginx/html volumes: - name: gluster-vol1 persistentVolumeClaim: claimName: gluster1 control# kubectl create -f nginx-test.yaml pod "nginx-pod1" created</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุตูุญ ุฃุณูู (ุงูุชุธุฑ ุจุถุน ุฏูุงุฆู ุ ูุฏ ุชุญุชุงุฌ ุฅูู ุชูุฒูู ุงูุตูุฑุฉ ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ ุจุงููุนู): </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl get pods NAME READY STATUS RESTARTS AGE glusterfs-5dtdj 1/1 Running 0 4d10h glusterfs-hzdll 1/1 Running 0 4d10h glusterfs-p8r59 1/1 Running 0 4d10h heketi-b8c5f6554-knp7t 1/1 Running 0 2d18h nginx-pod1 1/1 Running 0 47h</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชูู ุงูุขู ุฅูู ุงูุญุงููุฉ ููู ุจุฅูุดุงุก ููู index.html: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">control# kubectl exec -ti nginx-pod1 /bin/sh # cd /usr/share/nginx/html # echo 'Hello there from GlusterFS pod !!!' &gt; index.html # ls index.html # exit</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูู ุชุญุชุงุฌ ุฅูู ุงูุนุซูุฑ ุนูู ุนููุงู IP ุงูุฏุงุฎูู ูููููุฏ ูุญูููุฉ ูู ุฃู ุนูุฏุฉ ุฑุฆูุณูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1# curl 10.40.0.1 Hello there from GlusterFS pod !!!</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงู ุจุฐูู ุ ูุญู ุจุจุณุงุทุฉ ุงุฎุชุจุงุฑ ุญุฌู ุซุงุจุช ุฌุฏูุฏ. </p><br><blockquote style=";text-align:right;direction:rtl">  ุจุนุถ ุงูุฃูุงูุฑ ุงููููุฏุฉ ููุชุญูู ูู ูุชูุฉ <code>heketi-cli cluster list</code> ุงูุฌุฏูุฏุฉ ูู: <code>heketi-cli cluster list</code> <code>heketi-cli volume list</code> .  ูููู ุชุดุบูููุง ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู ุฅุฐุง <strong>ุชู ุชุซุจูุช heketi-cli</strong> .  ูู ูุฐุง ุงููุซุงู ุ ูุฐุง ูู <strong>master1</strong> ุงูุนูุฏุฉ. </blockquote><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">master1# heketi-cli cluster list Clusters: Id:e83467d0074414e3f59d3350a93901ef [file][block] master1# heketi-cli volume list Id:6fdb7fef361c82154a94736c8f9aa53e Cluster:e83467d0074414e3f59d3350a93901ef Name:vol_6fdb7fef361c82154a94736c8f9aa53e Id:c6b69bd991b960f314f679afa4ad9644 Cluster:e83467d0074414e3f59d3350a93901ef Name:heketidbstorage</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุฌุญูุง ูู ุฅุนุฏุงุฏ ููุงุฒู ุชุญููู ุฏุงุฎูู ูุน ุชุฎุฒูู ูููุงุช ุ ูุฃุตุจุญุช ุงููุฌููุนุฉ ุงูุขู ุฃูุฑุจ ุฅูู ุญุงูุฉ ุงูุชุดุบูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฒุก ุงูุชุงูู ูู ุงูููุงูุฉ ุ ุณูู ูุฑูุฒ ุนูู ุฅูุดุงุก ูุธุงู ูุฑุงูุจุฉ ูุธุงู ุงููุฌููุนุฉ ุ ูุฅุทูุงู ูุดุฑูุน ุงุฎุชุจุงุฑ ููู ูุงุณุชุฎุฏุงู ุฌููุน ุงูููุงุฑุฏ ุงูุชู ูููุง ุจุชูููููุง. </p><br><p style=";text-align:right;direction:rtl">  ุงุจู ุนูู ุงุชุตุงู ููู ุงูุชูููู! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar443110/">https://habr.com/ru/post/ar443110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar443098/index.html">ุชุชู ูุชุงุจุฉ ุงูุจูุงูุงุช ุนูู ุงููุฑุต ุจุงุณุชุฎุฏุงู ุงููุบูุงุทูุณ ูุงูููุฒุฑ</a></li>
<li><a href="../ar443100/index.html">ุนุฏ ุงูุฃุฎุทุงุก ูู ุญุงุณุจุฉ ูููุฏูุฒ</a></li>
<li><a href="../ar443102/index.html">ุงูุชุบููุฑ ุงูุณูููู ูููุชุฌ: ููุงุฐุง ุชุฑูุน ูุงุฑู ูููุฏู ุฌููุฉ ุจูููุฉ 40 ููููู ุฏููุงุฑ ูุน ุณููููุง ูุงุจูุชุงูุ</a></li>
<li><a href="../ar443104/index.html">ุญุณุงุจ ุงูุชุนุจูุฑุงุช ุงูุฑูุฒูุฉ ูุน ุฃุฑูุงู ุงูุซูุงุซู ุบุงูุถ ูู ุงูุซุนุจุงู</a></li>
<li><a href="../ar443106/index.html">ุฃุนูู USB4: ูุง ูู ูุนุฑูู ุนู ุงููุนูุงุฑ</a></li>
<li><a href="../ar443112/index.html">ูู ุฃูุช ูุชุฃูุฏ ูู ุฃูู ุชุซู ูู VPN ุงูุฎุงุต ุจูุ</a></li>
<li><a href="../ar443114/index.html">ุฌุงุฆุฒุฉ DevProject: ููุงูู ูู DeveloperWeek 2019</a></li>
<li><a href="../ar443120/index.html">ุณูุณุชูุฑ ูุฌูุณ ุงูุฏููุง ูู ุงูุญุฑุจ ุถุฏ ุงูุจูุน ุบูุฑ ุงููุงูููู ูุจุทุงูุงุช SIM</a></li>
<li><a href="../ar443122/index.html">ุชุณุฑุจ 809 ููููู ุนููุงู ุจุฑูุฏ ุฅููุชุฑููู ูุฎุฏูุฉ Verifications.io ูุธุฑูุง ูููุงู MongoDB ุงูููุชูุญ ุนูููุง</a></li>
<li><a href="../ar443124/index.html">React.lazyุ ูููู ูุงุฐุง ูู ูู ููู ูุฏูู ููููุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>