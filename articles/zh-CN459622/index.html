<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🔧 👩🏿‍💻 🎭 正如世嘉土星的游戏是在1995年编写的 👨‍🏭 🎅🏿 👨‍🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="这是我在1995年开发Neversoft工作室的第一个游戏：Skeleton Warriors时写的一个文档。 这是我第一次不使用68K汇编语言的游戏。 

 周围时间拍的照片。 开发套件（“ Small Box”和ICE）在我右边。 


 游戏状态 
 以下文档简要描述了Sega Saturn的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>正如世嘉土星的游戏是在1995年编写的</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459622/"> 这是我在1995年开发Neversoft工作室的第一个游戏：Skeleton Warriors时写的一个文档。 这是我第一次不使用68K汇编语言的游戏。 <br><br> 周围时间拍的照片。 开发套件（“ Small Box”和ICE）在我右边。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9f8/5ca/5a6/9f85ca5a691bf0553595a2f7f71f4cb7.jpg"></div><br><h2> 游戏状态 </h2><br> 以下文档简要描述了Sega Saturn的Skeleton Warriors代码的状态，还提到了许多尚需完成的方面。 <br><br> 需要该文档以便加快Dan，Ken和James对现成代码的熟悉，并向他们解释每个模块的目的以及它们之间的交互。 他还让我欣赏了这段代码的悲惨境地，并希望让我下定决心。 <br><br> 我还谈到了在程序中嵌入数据（.GOV和.GOB文件）的情况，以及将来的操作。 <br><br><h2> 开发设备 </h2><br> 我们的目标平台是Sega Saturn，它具有两个SH2 Risc微处理器和一个68000。只要我们仅使用Master SH2主处理器，在确定如何执行此操作时将使用辅助SH2从属。  68000用于控制声音芯片，我们不必为其编写代码，因为它将使用Sega提供的声音库。 <br><a name="habracut"></a><br> 该程序几乎完全用纯C语言编写。我们使用GNU SH2编译器来获取SH2输出汇编器。 代码中有几个SH2模块，主要只包含数据。 到目前为止，我还没有在SH2上写任何有意义的东西。 <br><br> 作为开发系统，我们使用PsyQ。 这不是标准的Sega开发系统，但是使用它的每个人都认为它是最好的。 替代方法是Sega所拥有的Cross Products创建的SNASM。  Sega提供的大多数代码示例都应在SNASM开发系统中运行，但可以轻松转换为PsyQ。 <br><br>  PsyQ系统由安装在PC中的SCSI接口卡，插入Saturn并连接电缆的盒带组成。 源代码在PC上编译并下载到土星程序，土星程序将在此启动。 可以从PC调试代码。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hd/ds/us/hddsuslvlb94ldqa4-kdvqu0bws.png"></div><br>  <i>PsyQ开发系统</i> <br><br> 通信由驻留程序（PSYBIOS）控制，该驻留程序处理计算机之间的通信。 这使Saturn控制台可以从PC下载文件，就像从CD下载文件一样。 我们使用此功能下载每个级别的文件。 <br><br> 我的房间里有几个又大又大的抽屉，还有两台电脑。 两个框中较小的一个是E7000PC，它是内置的SH2仿真器。 如果PsyQ调试器没有停止程序，它将有助于弄清楚程序在哪里崩溃。 它对于跟踪对内存的写入也很有用，但是到目前为止，我几乎没有使用过此功能。 <br><br> 第二个大抽屉是一个叫做“小盒子”的东西（第一个“大盒子”大约是一个小冰箱的大小）。 本质上，它是Saturn，带有用于E7000和CD仿真器的附加接口。 在前面板上，它具有国家（地区）ID开关以及PAL和NTSC之间的开关。 <br><br> 第二台计算机内部是CD仿真器-大板，计算机的硬盘驱动器因此而假装成CD驱动器。 您可以在其中收集CD映像并进行实时仿真，以查看游戏在获得真实CD时的外观。 该仿真器或多或少都可以工作，尽管它存在一些问题，我们正在与世嘉合作。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abd/c86/769/abdc86769d1a94d340193eefb45319ee.jpg" alt="图片"></div><br>  <i>世嘉的开发套件本身</i> <br><br><h2> 编译与链接 </h2><br> 完成的程序的一般程序集由一个生成文件：MAKEFILE.MAK控制。 它包含整个项目的依赖关系和目标，包括编译.GOB和.GOV文件。 <br><br>  CCSH将各个C源代码模块（.C文件）编译为SH2对象模块（.OBJ）。 它首先调用名为CPPSH的GNU C预处理程序（位于C：\ GNUSH2 \ BIN中），然后调用CC1SH作为其输出以创建SH2汇编程序代码，最后调用ASSH（在C：\ PSYQ中）进行构建。转换为成品对象格式。 <br><br> 我们不使用C ++，因为有人告诉我它创建了巨大的目标文件。 但是，我没有和他一起工作，可以进行实验。 <br><br> 只需使用ASMSH将几个SH2汇编器文件（具有.S扩展名）直接收集到.OBJ文件中（这与ASSH不同，但是更复杂的宏汇编器）。 当前，它们仅用于嵌入数据，并且不包含与机器有关的代码。 <br><br> 可以将代码加载到其中的Saturn RAM分为两个1MB的块。 一个起价为06,000,000美元，另一个起价为002,000,000美元。  $ 00,200,000的块专门用于存储主角的图形。 程序代码以$ 06010000编写（前$ 10,000个字节用于系统空间，堆栈等）。 <br><br> 该代码与位置相关，并且可以在此特定地址（$ 06010000）上运行，并且仅此而已。 <br><br> 使用PSYLINK程序将.OBJ文件链接在一起，以创建MAIN.CPE文件，该文件是带有小标题的可执行程序，可以使用RUN命令将其下载到Saturn。  PSYLINK使用TEST.LNK文件指示要包括的.OBJ文件以及将其放置在何处。 <br><br><h2> 资料 </h2><br> 游戏分为几个级别，许多级别使用相同的数据，但基本上每个级别它们都不同。 每个级别的所有数据都收集在两个巨大的.GOV和.GOB文件中。  （如果是地雷，则是MINE.GOV和MINE.GOB）。  GOV文件包含一个简短的标头，然后是应该在视频内存中的所有数据。  .GOB文件包含必须在RAM中的所有数据。 <br><br> 该级别由下面显示的数据文件的一部分组成。 <br><br>  .SSQ-Sprite音序器文件 <br>  .SBM-用于位背景的位图文件 <br>  .MAP-这两个地图都填充了符号背景。 <br>  .TIL-填充符号的背景的图块和调色板。 <br>  .PTH-道路点和触发器的数据。 <br>  .TEX-道路纹理。 <br><br>  .SSQ和.SBM文件是由我越来越不舒服的SEQ排序器创建的。  .MAP，.TIL，.PTH和.TEX文件是由越来越令人震惊的TULE地图编辑器Dan创建的。 <br><br> 使用ASMSH汇编程序将这些文件汇编为相应的.GOV和.GOB文件。 若要查看此操作，请参阅LEVEL.S和LEVEL1.S文件。  .GOV文件还包括特定级别的一些数据。 <br><br><h2> 模组 </h2><br>  <strong>TEST.S-</strong>没什么特别的，设置一些标签。 <br><br>  <strong>MAIN.C</strong>是程序的顶层。 它包含设备的初始化，级别设置，用于通过级别的代码以及实际上应放置在更合适的模块中的各种其他小元素。 其中有很多垃圾，因为最简单的方法是在此模块中添加新内容以进行快速测试。 包含来自CD或PC上文件服务器的启动代码。 包含用于启用或禁用TIMING颜色条的标志。 <br><br>  <strong>GFXLIB.C-</strong>用于访问设备和执行各种图形功能的各种过程。 几乎所有的文档都是由Dan从头开始编写的，通常效率很低。 如果您经常从这里使用该过程，那么最好看看它的作用并在代码中编写一个更快的版本。 <br><br> 但是，所有功能都可以正常工作，并为粗略的实现和测试提供了一个出色的框架。 谢谢丹，没有他就不可能。 <br><br>  <strong>SMP_PAD.C-</strong>从土星操纵杆读取数据的各种过程，非常依赖于设备。 <br><br>  <strong>GLOBALS.C-</strong>所有全局变量和几个常用函数。 使用全局变量是可接受的编程习惯。 但是，由于各种原因，SH2中全局变量的执行速度相当慢，因此随着时间的流逝，我可能会在必要时将零件转换为全局结构。 包含描述<strong>MAN</strong>和<strong>PATH</strong>状态的变量。 <br><br>  <strong>MAN.C-</strong>处理人员的移动和显示（Lightstar王子，Talyn，Guardian或Grimskull王子-玩家控制的角色）。 到目前为止，这主要是运动和与道路碰撞的逻辑。 另外，它为每个动作提供适当的动画。 还有很多工作要做。 <br><br>  <strong>OB.C-</strong>处理游戏中物体的移动和显示，尤其是敌人的物体，例如骷髅战士和小外星人。 游戏的主要部分在此处进行编程：敌人AI，基本动作和触发器触发。 数据结构尚未准备就绪，尤其是碰撞和动画问题尚未完全解决。 还有很多工作要做。 <br><br>  <strong>DATA.S-</strong>各种表格，目前主要是玩家主要角色的动画。 <br><br>  <strong>LAYER.C-</strong>具有视差的滚动背景。 更新符号背景和滚动位图。 还在雾层中滚动线（波浪效果）。 到目前为止，符号映射图层的表没有压缩就可以存储。 它们需要压缩为我用于Genesis版本的RLE格式。 如果我们早于索尼获得土星的开发系统，那么这项任务可以交给肯。 <br><br>  <strong>PAL.C-</strong>调色板。 您可以选择2048种颜色。 屏幕上的任何像素都可以是这些颜色之一。 我从逻辑上将调色板划分为八个256色调色板。  PAL.C包含用于初始化，准备和循环更改的代码。 它们还需要调光和更复杂的循环移位，以及亮度闪烁等。 <br><br>  <strong>BUL.C</strong>是一个原始系统，用于将炮弹（投掷剑，拳打手，从武器发射的火箭等）作为单独的对象进行处理。 对于更复杂的外壳使用，仍需要大量工作。 您还需要正确的碰撞和动画代码。 <br><br>  <strong>PAD.C</strong>是一个简单的模块，用于以更方便的格式存储操纵杆的状态。 存储按钮是否最近被按下以及是否现在被按下。 <br><br>  <strong>START.C-</strong>告诉第一级的一行，以方便在批处理文件中进行更改。 <br><br>  <strong>PANEL.C-</strong>撤回强弱连胜的简单程序。 <br><br>  <strong>PATH.C-</strong>绘制道路以及处理与道路碰撞的可怕程序。 <br><br>  <strong>MATH.C-</strong>简单的正弦，余弦和点旋转角度。 <br><br>  [更新]这是MAN.C的示例代码。 一切都严格地用代码编写，并引用全局数据结构Man。 代码中写的一堆数字。 <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/**************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/* Trigger jumping if needed, also variable height jump logic */</span></span> Man_JumpTrigger() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( Man.JumpFudge ) { Man.JumpFudge--; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( Man.Mode != M_Crouch || Man_StandingRoom() ) <span class="hljs-comment"><span class="hljs-comment">// ok if not crouched, or there is headroom { if (Pad_Jump-&gt;Pressed) /* jump button pressed */ { if ((Man.Contact || (Man.Mode == M_Hang) || Man.JumpFudge) &amp;&amp; Pad_Jump-&gt;Triggered &amp;&amp; !Man.Blocking) /* and not already jumping */ { if (Man.Mode == M_Hang &amp;&amp; Pad1.Down.Pressed) { Man.Contact=0; Man.Mode=M_Jump; Man.AnimBase = LS_Jumping; /* Change base anim to jumping */ Man_TriggerSeq(LS_Jump); /* start the jumping start anim */ Man.YV.f = 0x10000; /* and have no YV */ Man.Yi += 4; /* and have no YV */ } else { Pad_Jump-&gt;Triggered = 0; if ( !JetPacCheat ) Man.YV.f = -0x00080000; /* Initial jump speed */ else Man.YV.f = -0x00008000; // Initial speed in Jetpac mode Man.Contact = 0; /* not on the ground any more */ Man.JumpTime = 0; /* just started jumping */ Man.AnimBase = LS_Jumping; /* Change base anim to jumping */ Man_TriggerSeq(LS_Jump); /* start the jumping start anim */ Man.XV.f+=Man.FlyVel; if (Man.HangEnd &amp;&amp; Man.Mode == M_Hang) // if hanging { // and on the end of a path Man.HangEnd = 0; Man.Xi += 12*Man.Facing; // the move past end of path Man.JumpTime = -3; // bit more fixed v jump time } Man.Mode = M_Jump; /* change mode to jumping */ } } else /* Already jumping */ { if (Man.JumpTime++ &lt; MaxJumpTime) /* Still in initial jump period */ Man.YV.f -= 0x0005000; /* So can maintain jump YV */ } } else /* jump button not pressed */ { Man.JumpTime = MaxJumpTime+1; /* so can't alter YV again until landed */ } } }</span></span></code> </pre> <br>  OB.C已成长为9,000行的庞大文件，其中包括游戏中单个对象的所有行为模式。 另外，代码中还写有大量数字，例如： <br><br><pre> <code class="cpp hljs">Drop_Arac(S_Ob *pOb) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pOb-&gt;Jump==<span class="hljs-number"><span class="hljs-number">1</span></span>) { pOb-&gt;yv.f+=<span class="hljs-number"><span class="hljs-number">0x7fff</span></span>; pOb-&gt;y.f+=pOb-&gt;yv.f; t=Path_GetYZ(pOb-&gt;xi,pOb-&gt;yi,pOb)<span class="hljs-number"><span class="hljs-number">-15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((t&gt;pOb-&gt;yi)&amp;&amp;(t&lt;pOb-&gt;y.i+<span class="hljs-number"><span class="hljs-number">20</span></span>)) { pOb-&gt;Jump=<span class="hljs-number"><span class="hljs-number">0</span></span>; pOb-&gt;y.i+=<span class="hljs-number"><span class="hljs-number">15</span></span>; Turn_Around(pOb); pOb-&gt;SeqFile=Sprites[SpriteMap[<span class="hljs-number"><span class="hljs-number">34</span></span>]]; Object_TriggerSeq(Arac_JumpLand,pOb); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pOb-&gt;Frame==<span class="hljs-number"><span class="hljs-number">16</span></span>) pOb-&gt;Jump=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pOb-&gt;AnimStat==AnimDone) { pOb-&gt;t1=<span class="hljs-number"><span class="hljs-number">0</span></span>; pOb-&gt;Mode=&amp;Pattern_Arac; } } Command_Arac(pOb); }</code> </pre> <br> 令人不快的景象。 这种代码风格来自游戏很小的时代，而我是在与68K一起工作时开发出来的。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/196/459/4d4/1964594d444419cadb02b8ed183f378f.jpg" alt="图片"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN459622/">https://habr.com/ru/post/zh-CN459622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN459612/index.html">高通连续近20年如何脱颖而出</a></li>
<li><a href="../zh-CN459614/index.html">机器人鸭激起稻田</a></li>
<li><a href="../zh-CN459616/index.html">MIPT开设了俄罗斯第一个计算机科学与软件工程高级硕士学位课程</a></li>
<li><a href="../zh-CN459618/index.html">一些鲜为人知的docker-compose功能</a></li>
<li><a href="../zh-CN459620/index.html">TDDx2，BDD，DDD，FDD，MDD和PDD，或者您想了解的有关驱动开发的任何知识</a></li>
<li><a href="../zh-CN459624/index.html">军用无人机</a></li>
<li><a href="../zh-CN459626/index.html">Windows通知工具：记录最薄的攻击面</a></li>
<li><a href="../zh-CN459628/index.html">开放发明网拥有三千多名被许可人-这对开源软件意味着什么</a></li>
<li><a href="../zh-CN459630/index.html">井字游戏第2部分：无状态复原/重做</a></li>
<li><a href="../zh-CN459638/index.html">建立有关电池的全球知识库</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>