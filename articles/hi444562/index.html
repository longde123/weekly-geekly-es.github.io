<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСк ЁЯЪ╡ЁЯП┐ ЁЯСйЁЯП╗тАНЁЯОд GHIDRA рдХрд╛ рдЖрдзреБрдирд┐рдХреАрдХрд░рдгред рд░рдо рд╕реЗрдЧрд╛ рдореЗрдЧрд╛ рдбреНрд░рд╛рдЗрд╡ рдХреЗ рд▓рд┐рдП рд▓реЛрдбрд░ тЬКЁЯП╛ ЁЯСЧ ЁЯдС</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЕрднрд┐рд╡рд╛рджрди, рд╕рд╛рдерд┐рдпреЛрдВред рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдЦреБрд▓реЗ-рд╕реНрд░реЛрдд-рд╕реНрд░реЛрдд GHIDRA рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рд╕реБрдирд╛ рд╣реИ, рд╢рд╛рдпрдж рдХреЗрд╡рд▓ рдПрдХ рдмрд╣рд░рд╛ / рдЕрдВрдзрд╛ / рдЧреВрдВрдЧрд╛ / рдХреЛрдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░ рдирд╣реАрдВ рд╣реИред ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GHIDRA рдХрд╛ рдЖрдзреБрдирд┐рдХреАрдХрд░рдгред рд░рдо рд╕реЗрдЧрд╛ рдореЗрдЧрд╛ рдбреНрд░рд╛рдЗрд╡ рдХреЗ рд▓рд┐рдП рд▓реЛрдбрд░</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444562/"><p><img src="https://habrastorage.org/webt/_v/rj/sh/_vrjshbx1kl_9rudbdgaly0wd8c.png"></p><br><p> рдЕрднрд┐рд╡рд╛рджрди, рд╕рд╛рдерд┐рдпреЛрдВред  рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдЦреБрд▓реЗ-рд╕реНрд░реЛрдд-рд╕реНрд░реЛрдд <code>GHIDRA</code> рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рд╕реБрдирд╛ рд╣реИ, рд╢рд╛рдпрдж рдХреЗрд╡рд▓ рдПрдХ рдмрд╣рд░рд╛ / рдЕрдВрдзрд╛ / рдЧреВрдВрдЧрд╛ / рдХреЛрдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░ рдирд╣реАрдВ рд╣реИред  рдмреЙрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛рдПрдВ рдЕрджреНрднреБрдд рд╣реИрдВ: рд╕рднреА рд╕рдорд░реНрдерд┐рдд рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рд▓рд┐рдП рдбреАрдХреЙрдореНрдкреЛрд▓рд░, рдирдП рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рд╕рд░рд▓ рдЬреЛрдбрд╝ (рдЖрдИрдЖрд░ рдореЗрдВ рд╕рдХреНрд╖рдо рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рдХрд╛рд░рдг рддрддреНрдХрд╛рд▓ рд╕рдХреНрд░рд┐рдп рд╡рд┐рдШрдЯрди рдХреЗ рд╕рд╛рде), рд▓рд┐рдкрд┐рдпреЛрдВ рдХрд╛ рдПрдХ рдЧреБрдЪреНрдЫрд╛ рдЬреЛ рдЬреАрд╡рди рдХреЛ рд╕рд░рд▓ рдмрдирд╛рддрд╛ рд╣реИ, <code>Undo</code> / <code>Redo</code> рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ / рдФрд░ рдпрд╣ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕рднреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдХреЗрд╡рд▓ рдПрдХ рдмрд╣реБрдд рдЫреЛрдЯрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред  рдпрд╣ рдХрд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдореИрдВ рдкреНрд░рднрд╛рд╡рд┐рдд рдерд╛, рд▓рдЧрднрдЧ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд╣рдирд╛ рд╣реИред <a name="habracut"></a></p><br><p>  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ рдореИрдВрдиреЗ <code>GHIDRA</code> рд▓рд┐рдП рдЕрдкрдирд╛ рдкрд╣рд▓рд╛ рдореЙрдбреНрдпреВрд▓ рдХреИрд╕реЗ рд▓рд┐рдЦрд╛ - <code>Sega Mega Drive / Genesis</code> рд▓рд┐рдП рдЧреЗрдо рдХреЗ рд▓рд┐рдП рдПрдХ рд░рдо рд▓реЛрдбрд░ред  рдЗрд╕реЗ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЭреЗ рдЬрд╝рд░реВрд░рдд рдереА ... рдмрд╕ рдХреБрдЫ рдШрдВрдЯреЗ!  рдЪрд▓реЛ рдЪрд▓рддреЗ рд╣реИрдВред </p><br><div class="spoiler">  <b class="spoiler_title">рд▓реЗрдХрд┐рди рдЖрдИрдбреАрдП рдХрд╛ рдХреНрдпрд╛?</b> <div class="spoiler_text"><p>  рдореИрдВрдиреЗ <code>IDA</code> рд▓рд┐рдП рдбрд╛рдЙрдирд▓реЛрдбрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рдХреБрдЫ рджрд┐рди рдмрд┐рддрд╛рдПред  рддрдм рдпрд╣ рд╕рдВрд╕реНрдХрд░рдг <code>6.5</code> рдерд╛, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрди рджрд┐рдиреЛрдВ рдореЗрдВ рдПрд╕рдбреАрдХреЗ рдкреНрд░рд▓реЗрдЦрди рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реА рд╕рдорд╕реНрдпрд╛рдПрдВ рдереАрдВред </p></div></div><br><h2 id="podgotavlivaem-sredu-razrabotki">  рд╣рдо рд╡рд┐рдХрд╛рд╕ рдХрд╛ рдорд╛рд╣реМрд▓ рддреИрдпрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ </h2><br><p>  <code>GHIDRA</code> рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рд▓рдЧрднрдЧ рд╣рд░ рдЪреАрдЬ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЛрдЪрд╛ ( <em>рдЗрд▓рдлрд╛рдХ</em> , рдЖрдк рдкрд╣рд▓реЗ рдХрд╣рд╛рдВ рдереЗ?)ред  рдФрд░, рдирдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдиреНрд╣реЛрдВрдиреЗ <code>Eclipse</code> - <code>GhidraDev</code> рд▓рд┐рдП рдПрдХ рдкреНрд▓рдЧ-рдЗрди рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ "рд░рд╛рдЗрдЯ" рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдореЗрдВ <em>рдорджрдж рдХрд░рддрд╛ рд╣реИ</em> ред  рдкреНрд▓рдЧрдЗрди рд╡рд┐рдХрд╛рд╕ рдХреЗ рдорд╛рд╣реМрд▓ рдореЗрдВ рдПрдХреАрдХреГрдд рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рд▓реЛрдбрд░, рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЙрдбреНрдпреВрд▓ рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдирд┐рд░реНрдпрд╛рдд рдореЙрдбреНрдпреВрд▓ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдирд┐рд░реНрдпрд╛рдд рдореЙрдбреНрдпреВрд▓ (рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВ рд╕рдордЭрддрд╛ рд╣реВрдВ, рдпрд╣ рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реЗ рдбреЗрдЯрд╛ рдХрд╛ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рд╣реИ) рдХреБрдЫ рд╣реА рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рдеред </p><br><p>  рдкреНрд▓рдЧрдЗрди рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>Java</code> рд▓рд┐рдП <code>Eclipse</code> рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ, <code>Help</code> рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ -&gt; <code>Install New Software...</code> , рдлрд┐рд░ <code>Add</code> рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ <code>Archive...</code> рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд▓рдЧрдЗрди рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣ рдЪрдпрди рд╕рдВрд╡рд╛рдж рдЦреЛрд▓реЗрдВред  <code>GhidraDev</code> рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣ <code>$(GHIDRA)/Extensions/Eclipse/GhidraDev</code> ред  рдЗрд╕реЗ рдЪреБрдиреЗрдВ, <code>Add</code> рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/iq/ox/e3/iqoxe3k8b5www3rqb6i0cy_xadg.png"></p><br><p>  рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪреА рдореЗрдВ, <code>Ghidra</code> рдкрд░ рдПрдХ daw <code>Ghidra</code> , <code>Next &gt;</code> рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ <code>Next &gt;</code> , рд╕рдордЭреМрддреЛрдВ рд╕реЗ рд╕рд╣рдордд рд╣реЛрдВ, <code>Install Anyway</code> рдХреНрд▓рд┐рдХ <code>Install Anyway</code> (рдХреНрдпреЛрдВрдХрд┐ рдкреНрд▓рдЧрдЗрди рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдирд╣реАрдВ рд╣реИ), рдФрд░ <code>Eclipse</code> рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/h_/5h/_a/h_5h_auzh5po7rvzaaywyvzxz9o.png"></p><br><p>  рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░, рдПрдХ рдирдпрд╛ <code>GhidraDev</code> рдЖрдЗрдЯрдо рдЖрдкрдХреА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдирд┐рд░реНрдорд╛рдг рдФрд░ рд╡рд┐рддрд░рдг рдХреЗ рд▓рд┐рдП IDE <code>GhidraDev</code> рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ (рдмреЗрд╢рдХ, рдЖрдк рдирдП <code>Eclipse</code> рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдЬрд╝рд╛рд░реНрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╡рд┐рдХрд╕рд┐рдд рдкреНрд▓рдЧ-рдЗрди рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдбреАрдмрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/ka/3m/tg/ka3mtgmipvkbbmib3bilgamwe44.png"></p><br><div class="spoiler">  <b class="spoiler_title">рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбрд┐рдмрдЧрд░ рдХрд╣рд╛рдВ рд╣реИ?</b> <div class="spoiler_text"><p>  рдХреНрдпрд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ <code>GHIDRA</code> рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдХреЛ <code>GHIDRA</code> рд╣реИ рдХрдордмрдЦреНрдд рдХрд░реНрдХрд╢ рдкреНрд░рдЪрд╛рд░ рд▓реЗрдЦ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд▓рдЧрднрдЧ рдПрдХ рд╣реА рд╕рд╛рдордЧреНрд░реА рд╣реЛрддреА рд╣реИ, рдЬреЛ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдЪ рдирд╣реАрдВ рд╣реИред  рдПрдХ рдЙрджрд╛рд╣рд░рдг?  рд╣рд╛рдБ, рдХреГрдкрдпрд╛: </p><br><blockquote>  рдЙрдкрдХрд░рдг рдХрд╛ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг 9.0 рд╣реИред  рдФрд░ рдЯреВрд▓ рдореЗрдВ рдХреНрд░рд┐рдкреНрдЯреИрдирд╛рд▓рд┐рд╕рд┐рд╕ рдЬреИрд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ, рдУрд▓реАрдбрдмрдЧ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд, рдШрд┐рджреНрд░рд╛ рдбреАрдмрдЧрд░ред </blockquote><p>  рдФрд░ рдпрд╣ рд╕рдм рдХрд╣рд╛рдБ рд╣реИ?  рдирд╣реАрдВ! </p><br><p>  рджреВрд╕рд░рд╛ рдмрд┐рдВрджреБ: рдЦреБрд▓рд╛рдкрдиред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рд▓рдЧрднрдЧ рд╡рд╣рд╛рдБ рд╣реИ, рд▓реЗрдХрд┐рди рд▓рдЧрднрдЧ рдХреЛрдИ рднреА рдирд╣реАрдВ рд╣реИред  <code>GHIDRA</code> рдореЗрдВ <code>Java</code> рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдШрдЯрдХреЛрдВ рдХреЗ рд╕реНрд░реЛрдд рд╕реНрд░реЛрдд рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк <code>Gradle</code> рд▓рд┐рдкрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧреБрдкреНрдд рд╕реЗ рдмрд╛рд╣рд░реА рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рдПрдХ рд╕рдореВрд╣ рдкрд░ рдирд┐рд░реНрднрд░рддрд╛рдПрдВ рд╣реИрдВ <del>  рдкреНрд░рдпреЛрдЧрд╢рд╛рд▓рд╛ </del>  <code>NSA</code> рд░рд┐рдкреЙрдЬрд┐рдЯрд░реАред <br>  рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдХреЛрдИ рдбрд┐рдХрдВрдкрд╛рдЗрд▓рд░ рдФрд░ <code>SLEIGH</code> (рдпрд╣ рдЖрдИрдЖрд░ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЙрдбреНрдпреВрд▓ рдФрд░ рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╣реИ)ред </p><br><p>  рдЦреИрд░ рдУрд╣ рдареАрдХ рд╣реИ, рдореИрдВ рдХреБрдЫ рд╕реЗ рд╡рд┐рдЪрд▓рд┐рдд рд╣реВрдБред </p></div></div><br><p>  рддреЛ, рдЖрдЗрдП <code>Eclipse</code> рдореЗрдВ рдПрдХ рдирдИ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВред </p><br><h2 id="sozdayom-proekt-zagruzchika">  рд▓реЛрдбрд░ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ </h2><br><p>  <code>GhidraDev</code> -&gt; <code>New</code> -&gt; <code>Ghidra Module Project...</code> </p><br><p>  рд╣рдо рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдирд╛рдо рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ (рд╣рдо рдЗрд╕ рдмрд╛рдд рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ <code>Loader</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рд╢рдмреНрджреЛрдВ рдХреЛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рд╕реЗ рдЪрд┐рдкрдХрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдХреНрд░рдо рдореЗрдВ <code>sega_loaderLoader.java</code> рдЬреИрд╕реА рдХреБрдЫ рднреА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЙрдиреНрд╣реЗрдВ рддрджрдиреБрд╕рд╛рд░ рдирд╛рдо рджреЗрддреЗ рд╣реИрдВ)ред </p><br><p><img src="https://habrastorage.org/webt/ok/iq/kx/okiqkxnztehs89bnjh3wzen848w.png"></p><br><p>  <code>Next &gt;</code> рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред  рдпрд╣рд╛рдВ рд╣рдо рдЙрди рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рдордиреЗ рдбреМрд╕ рд░рдЦрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ <code>Loader</code> ред  <code>Next &gt;</code> рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/3g/-c/_6/3g-c_6t4e10co47udy8txa7udiq.png"></p><br><p>  рдпрд╣рд╛рдВ рд╣рдо <code></code> рд╕рд╛рде рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкрде рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  <code>Next &gt;</code> рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/9p/j6/kc/9pj6kcva-wqfiggwzf3itwssqm8.png"></p><br><p>  <code>GHIDRA</code> рдкрд╛рдЗрдерди ( <code>GHIDRA</code> рдорд╛рдзреНрдпрдо рд╕реЗ) рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдореИрдВ <code>Java</code> рдореЗрдВ рд▓рд┐рдЦреВрдВрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдПрдХ рджрд╛рд╡ рдирд╣реАрдВ рд▓рдЧрд╛рддрд╛ рд╣реВрдВред  рдореИрдВ <code>Finish</code> рджрдмрд╛рддрд╛ рд╣реВрдВред </p><br><p><img src="https://habrastorage.org/webt/_d/dr/z5/_ddrz5hnlfc0g-fnztl248er0tw.png"></p><br><h2 id="pishem-kod">  рдПрдХ рдХреЛрдб рд▓рд┐рдЦрдирд╛ </h2><br><p>  рдЦрд╛рд▓реА рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЯреНрд░реА рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд▓рдЧрддрд╛ рд╣реИ: </p><br><p><img src="https://habrastorage.org/webt/mn/vf/fx/mnvffx-jubdk6uqdcpw5njysqfe.png"></p><br><p>  <code>java</code> рдХреЛрдб рд╡рд╛рд▓реА рд╕рднреА рдлрд╛рдЗрд▓реЗрдВ <code>/src/main/java</code> рд╢рд╛рдЦрд╛ рдореЗрдВ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/xz/sx/6_/xzsx6_dw-avgpgufemblxrnbutm.png"></p><br><h3 id="getname">  getName () </h3><br><p>  рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЪрд▓рд┐рдП рдмреВрдЯрд▓реЛрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд╛рдо рдЪреБрдиреЗрдВред  <code>getName()</code> рд╡рд┐рдзрд┐ рдЗрд╕реЗ рд▓реМрдЯрд╛рддреА рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Sega Mega Drive / Genesis Loader"</span></span>; }</code> </pre> <br><h3 id="findsupportedloadspecs">  findSupportedLoadSpecs () </h3><br><p>  <code>findSupportedLoadSpecs()</code> рд╡рд┐рдзрд┐ рддрдп рдХрд░рддреА рд╣реИ (рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рд╣рд┐рдд рдбреЗрдЯрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░) рдЬреЛ рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ <code>findSupportedLoadSpecs()</code> рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рд╕рд╛рде рд╣реА <code>IDA</code> )ред  <code>GHIDRA</code> рд╢рдмреНрджрд╛рд╡рд▓реА рдореЗрдВ <code>GHIDRA</code> рдЗрд╕реЗ <code>Compiler Language</code> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: рдкреНрд░реЛрд╕реЗрд╕рд░, рдПрдВрдбрд┐рдпрдирдиреЗрд╕, рдмрд┐рдЯрдиреЗрд╕ рдФрд░ рдХрдВрдкрд╛рдЗрд▓рд░ (рдпрджрд┐ рдЬреНрдЮрд╛рдд рд╣реЛ)ред </p><br><p>  рдпрд╣ рд╡рд┐рдзрд┐ рд╕рдорд░реНрдерд┐рдд рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдФрд░ рднрд╛рд╖рд╛рдУрдВ рдХреА рд╕реВрдЪреА рд▓реМрдЯрд╛рддреА рд╣реИред  рдпрджрд┐ рдбреЗрдЯрд╛ рдЧрд▓рдд рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реИ, рддреЛ рд╣рдо рдмрд╕ рдПрдХ рдЦрд╛рд▓реА рд╕реВрдЪреА рд▓реМрдЯрд╛рддреЗ рд╣реИрдВред </p><br><p>  рддреЛ, <code>Sega Mega Drive</code> рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╢рдмреНрдж " <code>SEGA</code> " рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рд╣реЗрдбрд░ рдХреЗ рдСрдлрд╕реЗрдЯ <code>0x100</code> рдкрд░ рдореМрдЬреВрдж рд╣реЛрддрд╛ рд╣реИ (рдпрд╣ рдПрдХ рд╢рд░реНрдд рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди 99% рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдкреВрд░рд╛ рд╣реЛрддрд╛ рд╣реИ)ред  рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд▓рд╛рдЗрди рдЖрдпрд╛рддрд┐рдд рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>ByteProvider provider</code> рдХреЛ <code>findSupportedLoadSpecs()</code> <code>ByteProvider provider</code> , рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдо рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВрдЧреЗред </p><br><p>  рдХрд┐рд╕реА рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдкрдврд╝рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рд╣рдо рдПрдХ <code>BinaryReader</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ <code>false</code> рддрд░реНрдХ <code>Big Endian</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрдврд╝рддреЗ рд╕рдордп рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЕрдм рд░реЗрдЦрд╛ рдкрдврд╝рддреЗ рд╣реИрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>reader</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА <code>readAsciiString(offset, size)</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: </p><br><pre> <code class="java hljs">reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))</code> </pre> <br><p>  рдпрджрд┐ <code>equals()</code> <code>true</code> , рддреЛ рд╣рдо Segov рд░рдо рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдФрд░ рд╕реВрдЪреА рдореЗрдВ <code>List&lt;LoadSpec&gt; loadSpecs = new ArrayList&lt;&gt;();</code>  рдореЛрдЯреЛрд░реЛрд▓рд╛ <code>m68k</code> рдЬреЛрдбрд╝рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреНрд░рдХрд╛рд░ рдХреА рдПрдХ рдирдИ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ <code>LoadSpec</code> , рдЬрд┐рд╕рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рд▓реЛрдбрд░ рдСрдмреНрдЬреЗрдХреНрдЯ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, <code>this</code> ) рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдПрдХ <code>ImageBase</code> рдЬрд┐рд╕рдореЗрдВ ROM рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдкреНрд░рдХрд╛рд░ рдХрд╛ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ <code>LanguageCompilerSpecPair</code> рдФрд░ рдПрдХ рдЭрдВрдбрд╛ - рдХреНрдпрд╛ рдпрд╣ <code>LoadSpec</code> рд╕реВрдЪреА рдореЗрдВ рджреВрд╕рд░реЛрдВ рдХреЗ рдмреАрдЪ <code>LoadSpec</code> рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рд╣рд╛рдВ, рд╕реВрдЪреА рдореЗрдВ рд╣рд╛рдВ) рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ <code>LoadSpec</code> рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ)ред </p><br><p>  <code>LanguageCompilerSpecPair</code> рд▓рд┐рдП рдирд┐рд░реНрдорд╛рддрд╛ рдкреНрд░рд╛рд░реВрдк рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ: </p><br><ol><li>  рдкрд╣рд▓рд╛ рддрд░реНрдХ <code>languageID</code> , " <em>ProcessorName: Endianness: рдмрд┐рдЯреНрд╕: ExactCpu</em> " рд░реВрдк рдХреА рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ " <em>68000: BE: 32: MC68020</em> " рд▓рд╛рдЗрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ <code>MC68000</code> рдбрд┐рд▓реАрд╡рд░реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдРрд╕реА рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИ)ред  <code>ExactCpu</code> <code>default</code> рд╣реЛ рд╕рдХрддрд╛ <code>default</code> </li><li>  рджреВрд╕рд░рд╛ рддрд░реНрдХ, <code>compilerSpecID</code> , рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ рдпрд╣рд╛рдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ <code></code> рдкреНрд░реЛрд╕реЗрд╕рд░ рд╡рд┐рд╡рд░рдг ( <code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ) рдХреЗ рд╕рд╛рде <code>68000.opinion</code> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ <code>68000.opinion</code> ред  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреЗрд╡рд▓ <code>default</code> рдпрд╣рд╛рдБ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рджрд░рдЕрд╕рд▓, рд╣рдо рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреЗ рд╣реИрдВ </li></ol><br><p>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рд╣реИрдВ (рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдм рддрдХ рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Collection&lt;LoadSpec&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findSupportedLoadSpecs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ List&lt;LoadSpec&gt; loadSpecs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))) { loadSpecs.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoadSpec(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageCompilerSpecPair(<span class="hljs-string"><span class="hljs-string">"68000:BE:32:MC68020"</span></span>, <span class="hljs-string"><span class="hljs-string">"default"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadSpecs; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЖрдИрдбреАрдП рдФрд░ GHIDRA рдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░</b> <div class="spoiler_text"><p>  рдПрдХ рдЕрдВрддрд░ рд╣реИ, рдФрд░ рдпрд╣ рдЕрднреА рднреА рдмрд╣реБрдд рдордЬрдмреВрдд рд╣реИред  <code>GHIDRA</code> рдЖрдк рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░, рдЕрд▓рдЧ-рдЕрд▓рдЧ рдбреЗрдЯрд╛ рд╕реНрд╡рд░реВрдкреЛрдВ рдХреЛ рд╕рдордЭреЗрдЧрд╛, рдПрдХ рд▓реЛрдбрд░, рдПрдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рдореЙрдбреНрдпреВрд▓, рдбрд┐рдХрдореНрдкрд╛рдЗрд▓рд░ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдФрд░ рдЕрдиреНрдп рдЕрдЪреНрдЫрд╛рдИрдпрд╛рдВ рд╣реЛрдЧреАред </p><br><p>  <code>IDA</code> , рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рдРрдб-рдСрди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИред </p><br><p>  рдХрд┐рддрдирд╛ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ?  рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, <code>GHIDRA</code> - рдХрдИ рдмрд╛рд░! </p></div></div><br><h3 id="load">  рд▓реЛрдб () </h3><br><p>  рдЗрд╕ рдкрджреНрдзрддрд┐ рдореЗрдВ, рд╣рдо рд╕реЗрдЧрдореЗрдВрдЯ рдмрдирд╛рдПрдВрдЧреЗ, рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВрдЧреЗ, рдХреЛрдб рдФрд░ рдкрд╣рд▓реЗ рд╕реЗ рдЬреНрдЮрд╛рдд рд▓реЗрдмрд▓ рдмрдирд╛рдПрдВрдЧреЗред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкреНрд░рд╡реЗрд╢ рджреНрд╡рд╛рд░ рдкрд░ рд╣рдорд╛рд░реА рдорджрдж рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><ol><li>  <code>ByteProvider provider</code> : рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрд╕реЗ рдЬрд╛рдирддреЗ рд╣реИрдВред  рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ </li><li>  <code>LoadSpec loadSpec</code> : рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ <code>LoadSpec loadSpec</code> рдХреЗ рдЖрдпрд╛рдд рдЪрд░рдг рдХреЗ рджреМрд░рд╛рди <code>findSupportedLoadSpecs</code> рдЧрдпрд╛ рд╣реИ <code>findSupportedLoadSpecs</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ <code>findSupportedLoadSpecs</code> ред  рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдпрджрд┐, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдХрдИ рдбреЗрдЯрд╛ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВред  рдЖрд░рд╛рдо рд╕реЗ </li><li>  <code>List&lt;Option&gt; options</code> : <code>List&lt;Option&gt; options</code> рд╕реВрдЪреА (рдХрд╕реНрдЯрдо рд╕рд╣рд┐рдд)ред  рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдЙрдирдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдирд╣реАрдВ рд╕реАрдЦрд╛ рд╣реИ </li><li>  <code>Program program</code> : рдореБрдЦреНрдп рд╡рд╕реНрддреБ рдЬреЛ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ: рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ, рдкрддрд╛ рд╕реНрдерд╛рди, рдЦрдВрдб, рд▓реЗрдмрд▓, рд╕рд░рдгрд┐рдпрд╛рдВ рдмрдирд╛рдирд╛, рдЖрджрд┐ред </li><li>  <code>MemoryConflictHandler handler</code> рдФрд░ <code>TaskMonitor monitor</code> : рд╣рдореЗрдВ рд╢рд╛рдпрдж рд╣реА рдХрднреА рдЙрдирдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рдХрд╛рдо рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ (рдЖрдорддреМрд░ рдкрд░, рдЗрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рддреИрдпрд╛рд░ рддрд░реАрдХреЛрдВ рд╕реЗ рдЧреБрдЬрд░рдирд╛) </li><li>  <code>MessageLog log</code> : рд▓рдХрдбрд╝рд╣рд╛рд░рд╛ </li></ol><br><p>  рддреЛ, рд╢реБрд░реБрдЖрдд рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдХреБрдЫ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ рдЬреЛ <code>GHIDRA</code> рд╕рдВрд╕реНрдерд╛рдУрдВ рдФрд░ рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рд╣рдорд╛рд░реЗ рдХрд╛рдо рдХреЛ рд╕рд░рд▓ <code>GHIDRA</code> ред  рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рд╣рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ <code>BinaryReader</code> рдЖрд╡рд╢реНрдпрдХрддрд╛ <code>BinaryReader</code> : </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  рдЕрдЧрд▓рд╛ред  рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдФрд░ <code>FlatProgramAPI</code> рд╡рд░реНрдЧ рдХреЗ рд▓рдЧрднрдЧ рдкреВрд░реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╕рд░рд▓ рдХрд░реЗрдЧрд╛ (рдЖрдк рдмрд╛рдж рдореЗрдВ рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ): </p><br><pre> <code class="java hljs">FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor);</code> </pre> <br><h4 id="zagolovok-roma">  рд░рдо рд╣реЗрдбрд┐рдВрдЧ </h4><br><p>  рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрдЧрд╛ рд░рдо рдХреА рд╣реЗрдбрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИред  рдкрд╣рд▓реЗ <code>0x100</code> рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ рд╡реИрдХреНрдЯрд░реЛрдВ рдХреЗ рд▓рд┐рдП 64 <code>DivideByZero</code> рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХреА рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рд╣реЛрддреА рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <code>Reset</code> , <code>Trap</code> , <code>DivideByZero</code> , <code>VBLANK</code> рдФрд░ рдЕрдиреНрдпред </p><br><p>  рдЗрд╕рдХреЗ рдмрд╛рдж рд░реЛрдорд╛, рдХреНрд╖реЗрддреНрд░реЛрдВ, <code>ROM</code> рдФрд░ <code>RAM</code> рдмреНрд▓реЙрдХреЛрдВ рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рде рд╕рдВрд░рдЪрдирд╛ рдЖрддреА рд╣реИ, рдЪреЗрдХрдмреЙрдХреНрд╕ (рдХреНрд╖реЗрддреНрд░ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рдЕрдиреБрд░реЛрдз рдкрд░ рдЪреЗрдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рди рдХрд┐ рдЙрдкрд╕рд░реНрдЧ) рдФрд░ рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реАред </p><br><p>  рдЖрдЗрдП рдЗрди рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>java</code> рдХрдХреНрд╖рд╛рдПрдВ рдмрдирд╛рдПрдВ, рд╕рд╛рде рд╣реА рдЙрди рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдиреНрд╣реЗрдВ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред </p><br><h4 id="vectorstable">  VectorsTable </h4><br><p>  рд╣рдо рдПрдХ рдирдпрд╛ рд╡рд░реНрдЧ <code>VectorsTable</code> , рдФрд░, рдзреНрдпрд╛рди рджреЗрддреЗ рд╣реИрдВ, рд╣рдо рд╕рдВрдХреЗрдд рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ <code>StructConverter</code> рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╡рд░реНрдЧ рдореЗрдВ рд╣рдо рд╡реИрдХреНрдЯрд░ рдХреЗ рдкрддреЗ (рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП) рдФрд░ рдЙрдирдХреЗ рдирд╛рдо рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВрдЧреЗред </p><br><p><img src="https://habrastorage.org/webt/au/3c/m-/au3cm-qdnrviqcgqtn_asztwbao.png"></p><br><p>  рд╣рдо рд╡реЗрдХреНрдЯрд░ рдирд╛рдореЛрдВ рдФрд░ рдЙрдирдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдПрдХ рд╕реВрдЪреА рдШреЛрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_SIZE = <span class="hljs-number"><span class="hljs-number">0x100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_COUNT = VECTORS_SIZE / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] VECTOR_NAMES = { <span class="hljs-string"><span class="hljs-string">"SSP"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reset"</span></span>, <span class="hljs-string"><span class="hljs-string">"BusErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"AdrErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"InvOpCode"</span></span>, <span class="hljs-string"><span class="hljs-string">"DivBy0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Check"</span></span>, <span class="hljs-string"><span class="hljs-string">"TrapV"</span></span>, <span class="hljs-string"><span class="hljs-string">"GPF"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trace"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv4"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadInt"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv13"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv16"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv17"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadIRQ"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ1"</span></span>, <span class="hljs-string"><span class="hljs-string">"EXT"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ3"</span></span>, <span class="hljs-string"><span class="hljs-string">"HBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ5"</span></span>, <span class="hljs-string"><span class="hljs-string">"VBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap4"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap5"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap6"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap8"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap13"</span></span>,<span class="hljs-string"><span class="hljs-string">"Trap14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv30"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv31"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv32"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv33"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv34"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv35"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv36"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv37"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv38"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv39"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3A"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3B"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3C"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3D"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3E"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3F"</span></span> };</code> </pre> <br><p>  рд╣рдо рдкрддреЗ рдФрд░ рд╡реЗрдХреНрдЯрд░ рдирд╛рдо рдХреЗ рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рд╡рд░реНрдЧ рдмрдирд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address address; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Address address, String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.address = address; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } }</code> </pre> <br><p>  рд╡реИрдХреНрдЯрд░ рдХреА рд╕реВрдЪреА <code>vectors</code> рд╕рд░рдгреА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рдПрдЧреА: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> VectorFunc[] vectors;</code> </pre> <br><p>  рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ рд▓рд┐рдП <code>VectorsTable</code> рд╣реЛрдЧрд╛: </p><br><ol><li>  <code>FlatProgramAPI fpa</code> рд╣рд╛рдЗрдбреНрд░рд╛ рдХреЗ <code>Address</code> рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП <code>long</code> рдкрддреЗ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП <code>FlatProgramAPI fpa</code> (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдкрддреЗ рдХреЗ рд╕рд░рд▓ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдорд╛рди рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪрд┐рдк рд╕реЗ <code>FlatProgramAPI fpa</code> рдкреВрд░рдХ рдХрд░рддрд╛ рд╣реИ - рдкрддрд╛ рд╕реНрдерд╛рди) </li><li>  <code>BinaryReader reader</code> - рд░реАрдбрд┐рдВрдЧ рдпрд╛рд░реНрдб </li></ol><br><p>  <code>toAddr()</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдПрдХ <code>toAddr()</code> рд╡рд┐рдзрд┐ рд╣реИ, рдФрд░ <code>reader</code> рдиреЗ <code>setPointerIndex()</code> рдФрд░ <code>readNextUnsignedInt()</code> ред  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЕрдзрд┐рдХ рдХреБрдЫ рднреА рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред  рд╣рдореЗрдВ рдХреЛрдб рдорд┐рд▓рддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; VECTORS_COUNT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0</span></span>); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc[VECTORS_COUNT]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { vectors[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc(fpa.toAddr(reader.readNextUnsignedInt()), VECTOR_NAMES[i]); } }</code> </pre> <br><p>  <code>toDataType()</code> рд╡рд┐рдзрд┐, рдЬрд┐рд╕реЗ рд╣рдореЗрдВ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреЛ рдПрдХ <code>Structure</code> рдСрдмреНрдЬреЗрдХреНрдЯ рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рд╕рдВрд░рдЪрдирд╛ рдлрд╝реАрд▓реНрдб рдХреЗ рдирд╛рдо, рдЙрдирдХреЗ рдЖрдХрд╛рд░, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝реАрд▓реНрдб рдкрд░ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЛ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рдЖрдк <code>null</code> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"VectorsTable"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { s.add(POINTER, <span class="hljs-number"><span class="hljs-number">4</span></span>, VECTOR_NAMES[i], <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br><p>  рдареАрдХ рд╣реИ, рдЪрд▓реЛ рдкреНрд░рддреНрдпреЗрдХ рд╡реИрдХреНрдЯрд░, рдпрд╛ рдкреВрд░реА рд╕реВрдЪреА (рдмреЙрдпрд▓рд░рдкреНрд▓реЗрдЯ рдХреЛрдб рдХрд╛ рдПрдХ рдЧреБрдЪреНрдЫрд╛) рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдиреНрдп рд╡рд┐рдзрд┐рдпрд╛рдБ</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> VectorFunc[] getVectors() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSSP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBusErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdrErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvOpCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDivBy0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">5</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrapV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">7</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">9</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">10</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">11</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">12</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">14</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">13</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">14</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">15</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">17</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">16</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">17</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">19</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">18</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">19</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">21</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">20</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">22</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">21</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">23</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">22</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv17</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">23</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadIRQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">24</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">26</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">25</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEXT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">27</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">26</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">27</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">29</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">28</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">29</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">30</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">31</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">33</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">32</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">33</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">35</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">34</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">36</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">35</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">37</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">36</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">38</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">37</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">39</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">38</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">39</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap8</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">40</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap9</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">42</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">41</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">43</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">42</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">43</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">45</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">44</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">45</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">46</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">47</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv30</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">49</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">48</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv31</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">49</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv32</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">51</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">50</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv33</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">52</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">51</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv34</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">53</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">52</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv35</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">54</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">53</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv36</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">55</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">54</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv37</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">56</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">55</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv38</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">57</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">56</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv39</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">58</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">57</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3A</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">59</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">58</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3B</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">59</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3C</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">61</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">60</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">61</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3E</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">63</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">62</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3F</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">63</span></span>]; }</code> </pre> </div></div><br><h4 id="gameheader">  GameHeader </h4><br><p>  рд╣рдо рдРрд╕рд╛ рд╣реА рдХрд░реЗрдВрдЧреЗ рдФрд░ рдПрдХ <code>GameHeader</code> рдХреНрд▓рд╛рд╕ <code>GameHeader</code> рдЬреЛ рдХрд┐ <code>StructConverter</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред </p><br><div class="spoiler">  <b class="spoiler_title">рдЦреЗрд▓ рд░рдо рд╣реЗрдбрд░ рд╕рдВрд░рдЪрдирд╛</b> <div class="spoiler_text"><table><thead><tr><th>  рдСрдлрд╝рд╕реЗрдЯ рдкреНрд░рд╛рд░рдВрдн рдХрд░реЗрдВ </th><th>  рд╕рдорд╛рдкреНрддрд┐ рдСрдлрд╕реЗрдЯ </th><th>  рд╡рд┐рд╡рд░рдг </th></tr></thead><tbody><tr><td>  $ 100 </td><td>  $ 10F </td><td>  рдХрдВрд╕реЛрд▓ рдирд╛рдо (рдЖрдорддреМрд░ рдкрд░ 'SEGA рдореЗрдЧрд╛ рдбреНрд░рд╛рдЗрд╡' рдпрд╛ 'SEGA рдЙрддреНрдкрддреНрддрд┐') </td></tr><tr><td>  $ 110 </td><td>  $ 11F </td><td>  рд░рд┐рд▓реАрдЬ рдХреА рддрд╛рд░реАрдЦ (рдЖрдорддреМрд░ рдкрд░ '┬й XXXX YYYY.MMM' рдЬрд╣рд╛рдВ XXXX рдХрдВрдкрдиреА рдХреЛрдб рд╣реИ, YYYY рд╡рд░реНрд╖ рдФрд░ MMM - рдорд╣реАрдирд╛ рд╣реИ) </td></tr><tr><td>  $ 120 </td><td>  $ 14F </td><td>  рдШрд░реЗрд▓реВ рдирд╛рдо </td></tr><tr><td>  $ 150 </td><td>  $ 17F </td><td>  рдЕрдВрддрд░реНрд░рд╛рд╖реНрдЯреНрд░реАрдп рдирд╛рдо </td></tr><tr><td>  $ 180 </td><td>  $ 18 рдбреА </td><td>  рд╕рдВрд╕реНрдХрд░рдг ('XX YYYYYYYYYYYY' рдЬрд╣рд╛рдВ XX рдЧреЗрдо рдХрд╛ рдкреНрд░рдХрд╛рд░ рд╣реИ рдФрд░ YY рдЧреЗрдо рдХреЛрдб рд╣реИ) </td></tr><tr><td>  $ 18 рдИ </td><td>  $ 18F </td><td>  checksum </td></tr><tr><td>  $ 190 </td><td>  $ 19F </td><td>  рдореИрдВ / рдУ рд╕рдорд░реНрдерди </td></tr><tr><td>  $ 1 рдП 0 </td><td>  $ 1 рдП 3 </td><td>  рд░реЛрдо рдкреНрд░рд╛рд░рдВрдн </td></tr><tr><td>  $ 1 рдП 4 </td><td>  $ 1 рдП 7 </td><td>  рд░реЛрдо рдЕрдВрдд </td></tr><tr><td>  $ 1 рдП 8 </td><td>  $ 1AB </td><td>  RAM рдкреНрд░рд╛рд░рдВрдн (рдЖрдорддреМрд░ рдкрд░ $ 00FF0000) </td></tr><tr><td>  $ 1AC </td><td>  $ 1AF </td><td>  RAM рдЕрдВрдд (рдЖрдорддреМрд░ рдкрд░ $ 00FFFFFF) </td></tr><tr><td>  $ 1B0 </td><td>  $ 1 рдмреА 2 </td><td>  'RA' рдФрд░ $ F8 SRAM рдХреЛ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИ </td></tr><tr><td>  $ 1 рдмреА 3 </td><td>  ---- </td><td>  рдЕрдкреНрд░рдпреБрдХреНрдд ($ 20) </td></tr><tr><td>  $ 1B4 </td><td>  $ 1 рдмреА 7 </td><td>  SRAM рдкреНрд░рд╛рд░рдВрдн (рдбрд┐рдлрд╝реЙрд▓реНрдЯ $ 00200000) </td></tr><tr><td>  $ 1 рдмреА 8 </td><td>  $ 1BB </td><td>  SRAM рдЕрдВрдд (рдбрд┐рдлрд╝реЙрд▓реНрдЯ $ 0020FFFF) </td></tr><tr><td>  $ 1BC </td><td>  $ 1FF </td><td>  рдиреЛрдЯреНрд╕ (рдЕрдкреНрд░рдпреБрдХреНрдд) </td></tr></tbody></table></div></div><br><p>  рд╣рдо рдлрд╝реАрд▓реНрдб рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдХреА рдкрд░реНрдпрд╛рдкреНрдд рд▓рдВрдмрд╛рдИ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реЗ рд▓рд┐рдП рджреЛ рдирдП рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ <code>readNextByteArray()</code> , <code>readNextUnsignedShort()</code> <code>reader</code> рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдбреЗрдЯрд╛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдПрдБред  рдкрд░рд┐рдгрд╛рдореА рдХреЛрдб рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: </p><br><div class="spoiler">  <b class="spoiler_title">GameHeader</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.BinaryReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.StructConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.flatapi.FlatProgramAPI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.DataType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.Structure; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.StructureDataType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StructConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] consoleName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] releaseDate = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] domesticName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] internationalName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] version = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> checksum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] ioSupport = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address romStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, romEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address ramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] sramCode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> unused = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address sramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, sramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] notes = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FlatProgramAPI fpa; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fpa = fpa; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; <span class="hljs-number"><span class="hljs-number">0x200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0x100</span></span>); consoleName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); releaseDate = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); domesticName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); internationalName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); version = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x0E</span></span>); checksum = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>) reader.readNextUnsignedShort(); ioSupport = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); romStart = fpa.toAddr(reader.readNextUnsignedInt()); romEnd = fpa.toAddr(reader.readNextUnsignedInt()); ramStart = fpa.toAddr(reader.readNextUnsignedInt()); ramEnd = fpa.toAddr(reader.readNextUnsignedInt()); sramCode = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x03</span></span>); unused = reader.readNextByte(); sramStart = fpa.toAddr(reader.readNextUnsignedInt()); sramEnd = fpa.toAddr(reader.readNextUnsignedInt()); notes = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x44</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"GameHeader"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ConsoleName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ReleaseDate"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"DomesticName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"InternationalName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-string"><span class="hljs-string">"Version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(WORD, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-string"><span class="hljs-string">"Checksum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"IoSupport"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-string"><span class="hljs-string">"SramCode"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(BYTE, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-string"><span class="hljs-string">"Unused"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-string"><span class="hljs-string">"Notes"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getConsoleName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> consoleName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getReleaseDate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> releaseDate; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getDomesticName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domesticName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getInternationalName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> internationalName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getVersion() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> version; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChecksum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checksum; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getIoSupport() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioSupport; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramEnd; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getSramCode() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unused; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSRAM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramCode == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'R'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xF8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getNotes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> notes; } }</code> </pre> </div></div><br><p>  рд╣реЗрдбрд░ рдХреЗ рд▓рд┐рдП рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдБ: </p><br><pre> <code class="java hljs">vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader);</code> </pre> <br><h4 id="segmenty">  рдЦрдВрдбреЛрдВ </h4><br><p>  рд╕реЗрдЧрд╛ рдХреЗ рдкрд╛рд╕ рд╕реНрдореГрддрд┐ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рдПрдХ рдкреНрд░рд╕рд┐рджреНрдз рдорд╛рдирдЪрд┐рддреНрд░ рд╣реИ, рдЬрд┐рд╕реЗ рдореИрдВ, рд╢рд╛рдпрдж, рдпрд╣рд╛рдВ рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рджреВрдВрдЧрд╛, рд▓реЗрдХрд┐рди рдореИрдВ рдХреЗрд╡рд▓ рд╡рд╣ рдХреЛрдб рджреВрдВрдЧрд╛ рдЬреЛ рдХрд┐ рд╕реЗрдЧрдореЗрдВрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рддреЛ, <code>FlatProgramAPI</code> рд╡рд░реНрдЧ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдПрдХ <code>createMemoryBlock()</code> рд╡рд┐рдзрд┐ рд╣реИ, рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдмрдирд╛рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рдЗрдирдкреБрдЯ рдкрд░, рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реНрдХ рд▓реЗрддрд╛ рд╣реИ: </p><br><ol><li>  <code>name</code> : рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдирд╛рдо </li><li>  <code>address</code> : рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдкрддрд╛ рд╢реБрд░реВ рдХрд░реЗрдВ </li><li>  <code>stream</code> : рдЯрд╛рдЗрдк <code>InputStream</code> рдХрд╛ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ, рдЬреЛ рдореЗрдореЛрд░реА рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдЖрдзрд╛рд░ рд╣реЛрдЧрд╛ред  рдпрджрд┐ рдЖрдк <code>null</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдПрдХ рдЕрд╕рд┐рдВрдЪрд┐рдд рдХреНрд╖реЗрддреНрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>68K RAM</code> рдпрд╛ <code>Z80 RAM</code> рд╣рдореЗрдВ рдмрд╕ рдЙрд╕реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА </li><li>  <code>size</code> : рдирд┐рд░реНрдорд┐рдд рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдЖрдХрд╛рд░ </li><li>  <code>isOverlay</code> : <code>true</code> рдпрд╛ <code>false</code> рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ <code>true</code> , рдФрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдУрд╡рд░рд▓реЗ рд╣реИред  рдореБрдЭреЗ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд╣рд╛рдВ рд╣реИ </li></ol><br><p>  рдЖрдЙрдЯрдкреБрдЯ рдкрд░, <code>createMemoryBlock()</code> рдПрдХ <code>MemoryBlock</code> рдкреНрд░рдХрд╛рд░ рдХрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ <code>MemoryBlock</code> , рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рд░рд╛рдЗрдЯреНрд╕ рдлреНрд▓реИрдЧ ( <code>Read</code> , <code>Write</code> , <code>createMemoryBlock()</code> рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реЙрд░реНрдо рдХрд╛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдорд┐рд▓рддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSegment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, InputStream stream, String name, Address address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> read, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> write, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> execute)</span></span></span><span class="hljs-function"> </span></span>{ MemoryBlock block = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { block = fpa.createMemoryBlock(name, address, stream, size, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); block.setRead(read); block.setWrite(read); block.setExecute(execute); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"Error creating %s segment"</span></span>, name)); } }</code> </pre> <br><p>  рдпрд╣рд╛рдБ рд╣рдордиреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдк рд╕реЗ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>Msg</code> рд╡рд░реНрдЧ рдХреА рд╕реНрдереИрддрд┐рдХ <code>error</code> рд╡рд┐рдзрд┐ рдХреЛ рдХрд╣рд╛ рд╣реИред </p><br><p>  рдЧреЗрдо рд░рдо рд╡рд╛рд▓реЗ рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ <code>0x3FFFFF</code> (рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдиреНрдп рдХреНрд╖реЗрддреНрд░реЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдЧрд╛)ред  рдЖрдЗрдП рдЗрд╕реЗ рдмрдирд╛рдПрдВ: </p><br><pre> <code class="java hljs">InputStream romStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0</span></span>); createSegment(fpa, romStream, <span class="hljs-string"><span class="hljs-string">"ROM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x000000</span></span>), Math.min(romStream.available(), <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>    <code>InputStream</code>    ,    0. </p><br><p>       ,     ( <code>SegaCD</code>  <code>Sega32X</code> ).        <code>OptionDialog</code> . , <code>showYesNoDialogWithNoAsDefaultButton()</code>      <code>YES</code>  <code>NO</code>   -  <code>NO</code> . </p><br><p>    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega CD segment?"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (romStream.available() &gt; <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>) { InputStream epaStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>); createSegment(fpa, epaStream, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega 32X segment?"</span></span>)) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"32X"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x800000</span></span>), <span class="hljs-number"><span class="hljs-number">0x200000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre> <br><p>      : </p><br><pre> <code class="java hljs">createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z80"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA00000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS1"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS2"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z802"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z803"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"FDC"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TMSS"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"VDP"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"RAM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xFF0000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header.hasSRAM()) { Address sramStart = header.getSramStart(); Address sramEnd = header.getSramEnd(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramStart.getOffset() &gt;= <span class="hljs-number"><span class="hljs-number">0x200000</span></span> &amp;&amp; sramEnd.getOffset() &lt;= <span class="hljs-number"><span class="hljs-number">0x20FFFF</span></span> &amp;&amp; sramStart.getOffset() &lt; sramEnd.getOffset()) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SRAM"</span></span>, sramStart, sramEnd.getOffset() - sramStart.getOffset() + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }</code> </pre> <br><h4 id="massivy-metki-i-konkretnye-adresa"> ,     </h4><br><p>       <code>CreateArrayCmd</code> .   ,     : </p><br><ol><li> <code>address</code> : ,      </li><li> <code>numElements</code> :    </li><li> <code>dataType</code> :       </li><li> <code>elementSize</code> :    </li></ol><br><p>        <code>applyTo(program)</code> ,   . </p><br><p>        ,    ,  <code>BYTE</code> , <code>WORD</code> , <code>DWORD</code>  .  ,    <code>FlatProgramAPI</code>   <code>createByte()</code> , <code>createWord()</code> , <code>createDword()</code>  .. </p><br><p>  ,    ,       (,     <code>VDP</code> ).  ,    : </p><br><ol><li>    <code>Program</code>   <code>getSymbolTable()</code> ,       ,   .. </li><li>      <code>createLabel()</code> ,     ,    .      , ,     <code>SourceType.IMPORTED</code>      </li></ol><br><p>          ,   : </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedByteArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, ByteDataType.dataType, ByteDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createByte(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create byte. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedWordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, WordDataType.dataType, WordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create word. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedDwordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, DWordDataType.dataType, DWordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createDWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create dword. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="java hljs">createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA04000</span></span>), <span class="hljs-string"><span class="hljs-string">"Z80_YM2612"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_PCBVER"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10002</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10004</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10006</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10008</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10010</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10012</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10014</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10016</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10018</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_RAMMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80BUS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80RES"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_FDC"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TIME"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TMSS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00002</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00004</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00006</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00008</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000A</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000C</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP___CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000E</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP____CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00011</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_PSG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </div></div><br><h4 id="primenenie-struktur-zagolovka">    </h4><br><p>           <code>createData()</code>  <code>DataUtilities</code> .       : </p><br><ol><li> <code>program</code> :   <code>Program</code> </li><li> <code>address</code> : ,      </li><li> <code>dataType</code> :   </li><li> <code>dataLength</code> :  .   <code>-1</code>    </li><li> <code>stackPointers</code> :  <code>true</code> ,  -     .  <code>false</code> </li><li> <code>clearDataMode</code> :          ,     (,     ) </li></ol><br><p>    : ..      (,  ),         .      <code>FlatProgramAPI</code>    <code>createFunction()</code> ,       . </p><br><p>                 : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markVectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0</span></span>), vectors.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (VectorFunc func : vectors.getVectors()) { fpa.createFunction(func.getAddress(), func.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000000"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x100</span></span>), header.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000100"</span></span>); } }</code> </pre> <br><h3 id="zavershaem-metod-load">   load() </h3><br><p>         <code>load()</code>    <code>setMessage()</code>   <code>TaskMonitor</code> ,     . </p><br><pre> <code class="java hljs">monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName()));</code> </pre> <br><p>     ,     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, LoadSpec loadSpec, List&lt;Option&gt; options, Program program, MemoryConflictHandler handler, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException, IOException </span></span>{ monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName())); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader); createSegments(fpa, provider, program, monitor); markVectorsTable(program, fpa); markHeader(program, fpa); monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Loading done"</span></span>, getName())); }</code> </pre> <br><h3 id="getdefaultoptions-i-validateoptions"> getDefaultOptions  validateOptions </h3><br><p>       ,      </p><br><h2 id="otlazhivaem-rezultaty-nashih-trudov">     </h2><br><p>        <code>Run</code> -&gt; <code>Debug As</code> -&gt; <code>1 Ghidra</code> .   . </p><br><p><img src="https://habrastorage.org/webt/fv/ua/ya/fvuaya-gohpzkoiiflp6v28eily.png"></p><br><h2 id="eksport-distributiva-i-ustanovka-v-ghidra">      GHIDRA </h2><br><p>     ,   -    .       <code>Eclipse</code>   <code>extension.properties</code> ,   : </p><br><pre> <code class="java hljs">description=Loader <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Sega Mega Drive / Genesis ROMs author=Dr. MefistO createdOn=<span class="hljs-number"><span class="hljs-number">20.03</span></span>.2019</code> </pre> <br><p>       <code>GhidraDev</code> -&gt; <code>Export</code> -&gt; <code>Ghidra Module Extension...</code>      : </p><br><p><img src="https://habrastorage.org/webt/4p/d-/4x/4pd-4xgokfhzsbfwdccrnzguqb0.png"></p><br><p><img src="https://habrastorage.org/webt/t2/gs/j3/t2gsj3lpwgtn-lueej69ostsil4.png"></p><br><p><img src="https://habrastorage.org/webt/z3/kn/ik/z3knik478dyvau73nau8j-rhiik.png"></p><br><p>      <code>dist</code>    zip- (-  <code>ghidra_9.0_PUBLIC_20190320_Sega.zip</code> )       <code>GHIDRA</code> . </p><br><p>     .  <code></code> ,  <code>File</code> -&gt; <code>Install Extensions...</code> ,     ,     . ... </p><br><p><img src="https://habrastorage.org/webt/ky/tk/uh/kytkuhf_3pciliw9ihhgthadbrs.png"></p><br><p><img src="https://habrastorage.org/webt/qj/bz/gf/qjbzgfycyjaeghezz_w1rehayo0.png"></p><br><h2 id="ishodniki-i-prochee">    </h2><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">github-</a> ,   . </p><br><p>     :   <code>IDA</code>  <code>GHIDRA</code>       .   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi444562/">https://habr.com/ru/post/hi444562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi444552/index.html">рдЯреАрдбреАрдПрдордПрд╕ рдлреЗрдпрд░рд╡реЗред рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВ</a></li>
<li><a href="../hi444554/index.html">рдПрд▓рд┐рдХреНрд╕рд┐рд░ рдкрд░ рд╕рдмрд╕реЗ рд╕рд░рд▓ JSON RESTful API</a></li>
<li><a href="../hi444556/index.html">рдЖрд░рдЬреАрдмреА рдФрд░ рд░рдВрдЧ рддрд╛рдкрдорд╛рди рдХреЗ рдореВрд▓реНрдпреЛрдВ рдореЗрдВ рдЕрдВрддрд░рд┐рдХреНрд╖ рд╕реЗ рдЪрдВрджреНрд░рдорд╛ рдФрд░ рд╕реВрд░рдЬ рдХрд╛ рд░рдВрдЧ</a></li>
<li><a href="../hi444558/index.html">CUBA 7 рдореЗрдВ рдирдпрд╛ рдХреНрдпрд╛ рд╣реИ</a></li>
<li><a href="../hi444560/index.html">рд╣рдо рдЖрдкрдХреЛ рд╕рдореНрдореЗрд▓рди рдореЗрдВ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ тАЬрдмрд╛рджрд▓ред рдлреИрд╢рди рдЯреНрд░реЗрдВрдбреНрд╕ тАЬ26 рдорд╛рд░реНрдЪ, 2019</a></li>
<li><a href="../hi444564/index.html">рдбрд┐рдЬрд┐рдЯрд▓ рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдбрд┐рдЬрд┐рдЯрд▓ рдЙрддреНрдкрд╛рдж рд╡рд┐рдХрд╛рд╕</a></li>
<li><a href="../hi444566/index.html">рд╕рд┐рдХреЛрд░рд╕реНрдХреА рдиреЗ рдмреЛрд░реНрдб рдкрд░ рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдорд╛рдирд╡ рд░рд╣рд┐рдд рд╣реЗрд▓реАрдХрд╛рдкреНрдЯрд░ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛</a></li>
<li><a href="../hi444568/index.html">2018 рдореЗрдВ C ++ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд╢реАрд░реНрд╖ 10 рдХреАрдбрд╝реЗ</a></li>
<li><a href="../hi444570/index.html">2018 рдХреЗ рд▓рд┐рдП C ++ рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдореЗрдВ рд╢реАрд░реНрд╖ 10 рддреНрд░реБрдЯрд┐рдпрд╛рдВ</a></li>
<li><a href="../hi444572/index.html">рдЪрдордХрддреА рдПрд▓рдИрдбреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>