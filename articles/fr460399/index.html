<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🍳 ⚫️ 🧑🏾‍🤝‍🧑🏼 Indicateur de chargement SVG sur Vue.js 🙇🏾 👨🏼‍🌾 ⛵️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut J'étudie en front-end, et en parallèle, dans le projet de formation, je développe SPA sur Vue.js pour le back-end, qui collecte les données du b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Indicateur de chargement SVG sur Vue.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460399/"><p>  Salut  J'étudie en front-end, et en parallèle, dans le projet de formation, je développe SPA sur Vue.js pour le back-end, qui collecte les données du bot de recherche.  Le bot génère de 0 à 500 entrées, et je dois: télécharger, trier selon les critères spécifiés, afficher dans le tableau. </p><br><p>  Ni le back-end ni le bot ne peuvent trier les données, je dois donc télécharger toutes les données et les traiter côté navigateur.  Le tri est très rapide, mais la vitesse de téléchargement dépend de la connexion et les 500 enregistrements indiqués peuvent être chargés de 10 à 40 secondes. </p><br><p> Au début, lors du chargement, j'ai montré un spiner, dont l'inconvénient est que l'utilisateur ne sait pas quand le téléchargement se terminera.  Dans mon cas, le nombre d'enregistrements que le bot a trouvé est connu à l'avance, vous pouvez donc montrer combien de% d'enregistrements sont chargés. </p><br><p>  Pour égayer l'attente de l'utilisateur, j'ai décidé de lui montrer le processus de chargement: </p><br><ol><li>  chiffres - combien de% des enregistrements sont déjà chargés </li><li>  calendrier - temps de chargement de chaque enregistrement </li><li>  remplissage -% charge.  Comme le graphique remplit un bloc rectangulaire lors de son chargement, il est clair quelle partie du bloc reste à remplir </li></ol><br><p>  Voici l'animation du résultat que je visais et que j'ai obtenu: </p><br><img src="https://habrastorage.org/webt/-o/wr/mc/-owrmchonzxft0kpoabdeumz2tm.gif"><br><p>  ... à mon avis, ça s'est avéré drôle. </p><br><p>  Dans l'article, je vais vous montrer comment progresser pas à pas vers le résultat.  Je n'ai pas dessiné de graphiques de fonctions dans le navigateur avant le village, donc le développement de l'indicateur m'a apporté des connaissances simples mais nouvelles sur l'utilisation de SVG et de Vue. </p><br><a name="habracut"></a><br><h3>  Choix d'une méthode de rendu Canvas ou SVG </h3><br><p>  J'ai utilisé <em>Canvas</em> dans un jeu de serpent simple sur JS et SVG, dans un projet, je l'ai simplement inséré dans la page dans la balise d' <em>objet</em> et j'ai remarqué que lors de la mise à l'échelle, les images SVG restaient toujours nettes (c'est pourquoi c'était un vecteur) et <em>Canvas</em> observé l'image floue.  Sur la base de cette observation, j'ai décidé de dessiner un graphique en utilisant SVG, car vous devez commencer un jour. </p><br><h3>  Plan de travail </h3><br><p>  Sur la base du cadre Vue sélectionné et de la méthode sélectionnée de formation d'images à l'aide de SVG, je me suis fait le plan de travail suivant: </p><br><ol><li>  Recherchez et étudiez des informations sur le sujet de l'utilisation de SVG avec Vue </li><li>  Expériences avec la formation et le changement de SVG dans le contexte de Vue </li><li>  Indicateur de chargement du prototype </li><li>  Affectation de l'indicateur de chargement dans un composant Vue distinct </li><li>  Application du composant dans le SPA </li></ol><br><h3>  Pour commencer </h3><br><ol><li><div class="spoiler">  <b class="spoiler_title">Création d'un projet vierge</b> <div class="spoiler_text"><p>  J'ai <em>installé cli vue</em> .  Pour créer un nouveau projet, je <em>saisis vue create loadprogresser</em> sur la ligne de commande, sélectionne les paramètres du projet par <em>défaut,</em> crée un nouveau projet vue avec le nom loadprogresser, puis en supprime les inutiles: </p><br><div class="scrollable-table"><table><tbody><tr><td align="center">  Était </td><td align="center">  Est devenu </td></tr><tr><td align="center"><img src="https://habrastorage.org/webt/ff/dx/gz/ffdxgzse2s6oqmujajql_cz-qjc.png" width="25%"><br><p>  Structure du projet par défaut </p><br></td><td align="center"><img src="https://habrastorage.org/webt/ju/7o/xw/ju7oxwnd0bt6ygl47di54eyiccq.png" width="50%"><br><p>  La structure après le "nettoyage" </p><br></td></tr><tr><td align="center"><img src="https://habrastorage.org/webt/db/vd/cz/dbvdczqbvxc4oi1mswth75ofpo0.png" width="50%"><br><p>  Salutations de Vue </p><br></td><td align="left"><pre><code class="plaintext hljs">&lt;template&gt; &lt;div&gt; &lt;h1&gt;Progresser&lt;/h1&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; export default {name: 'app'} &lt;/script&gt;;</code> </pre> <br><p>  Mon texte est «Progresser» dans App.vue </p><br></td></tr></tbody></table></div><br></div></div><br></li><li><h4>  Recherchez et étudiez des informations sur le sujet de l'utilisation de SVG avec Vue </h4><br><p>  Grand site avec des informations utiles sur HTML, CSS et SVG <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">css.yoksel.ru</a> Un bon exemple avec SVG est disponible dans la documentation de Vue elle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-même Exemple de graphique SVG</a> et un tel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> .  Sur la base de ces matériaux, le modèle de composant minimal avec SVG est né à partir duquel je commence: </p><br><pre> <code class="plaintext hljs">&lt;template&gt; &lt;div class="wrapper"&gt; &lt;svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"&gt; //svg    //   svg- &lt;/svg&gt; &lt;/div&gt; &lt;/template&gt;</code> </pre><br></li><li><h4>  Expériences avec la formation et le changement de SVG dans le contexte de Vue </h4><br><h5>  SVG rectangle rect </h5><br><p>  rect - un rectangle, la figure la plus simple.  Je crée un svg avec des dimensions 100x100px et dessine un rectangle rect avec les coordonnées initiales 25:25 et des tailles 50x50 px, la couleur de remplissage par défaut est le noir (pas de style) </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h5>  Style SVG et pseudo-classe de vol stationnaire: </h5><br><p>  Je vais essayer de styliser le rectangle rect en svg.  Pour ce faire, j'ajoute la classe «sample» à svg, dans la section style du fichier vue j'ajoute les styles .sample rect (je colore le rectangle rect avec du jaune) et .sample rect: hover qui stylise l'élément rect lorsque vous survolez dessus: </p><br><div class="spoiler">  <b class="spoiler_title">Code source</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;template&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"sample"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/svg"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100px"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100px"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">rect</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">25</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">25</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"50px"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"50px"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">template</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'app'</span></span> } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt; &lt;style&gt; .sample rect { fill: yellow; stroke: green; stroke-width: 4; transition: all 350ms; } .sample rect:hover { fill: gray; } &lt;/</span></span>style&gt;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Implémentation de JSfiddle</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><p>  Conclusion: svg s'intègre parfaitement dans le modèle vue-file et est stylisé avec les styles prescrits.  Un début a été fait! </p><br><h5>  Chemin SVG comme base de l'indicateur </h5><br><p>  Dans cette section, je remplacerai rect par path, <code>&lt;path :d="D" class="path"/&gt;</code> dans l'attribut d de la balise path, je passerai la chaîne D avec les coordonnées du chemin depuis vue.  La connexion est établie via <code>v-bind:d="D"</code> , qui est abrégé en <code>:d="D"</code> </p><br><p>  La ligne D = «M 0 0 0 50 50 50 50 0 Z» trace trois lignes avec les coordonnées 0: 0-&gt; 0: 50-&gt; 50: 50-&gt; 0:50 et ferme le contour avec la commande Z, formant un carré de 50x50px à partir de coordonnées 0: 0.  En utilisant le style de chemin, la forme reçoit une couleur de remplissage jaune et une bordure grise de 1px. </p><br><div class="spoiler">  <b class="spoiler_title">Source PATH jaune</b> <div class="spoiler_text"><pre> <code class="javascript hljs"> &lt;template&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"sample"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/svg"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100px"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100px"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">path</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"D"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"path"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">template</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'app'</span></span>, data(){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">D</span></span>:<span class="hljs-string"><span class="hljs-string">"M 0 0 0 50 50 50 50 0 Z"</span></span> } } } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt; &lt;style&gt; .path { fill:yellow; stroke:gray; } &lt;/</span></span>style&gt;</code> </pre><br></div></div><br></li><li><h4>  Indicateur de chargement du prototype </h4><br><p>  Dans la version minimale, j'ai fait un schéma simple.  Un conteneur svg d'une hauteur de 100 pixels, d'une largeur de 400 pixels est inséré dans le modèle, une balise de chemin est placée à l'intérieur, à l'attribut d dont j'ajoute la chaîne de chemin générée d à partir des données de vue, qui à son tour est formée à partir du tableau timePoints, où, toutes les 10 ms, un de 400 est ajouté (par largeur du conteneur) un nombre aléatoire compris entre 0 et 100. Tout est simple, dans le hook de cycle de vie créé, la méthode de mise à jour est appelée dans laquelle de nouveaux points (aléatoires) sont ajoutés au diagramme via la méthode addTime, puis la méthode getSVGTimePoints renvoie une chaîne à transmettre à PATH, via setTimeout redémarre la méthode de mise à jour </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  En savoir plus sur la formation de cordes pour PATH </h4><br><p>  La chaîne de PATH est formée dans la méthode getSVGTimePoints, à partir du tableau timePoints que je traite avec Reduce.  Comme valeur initiale de réduire, j'utilise «M 0 0» (commencer à la coordonnée 0: 0).  Plus loin dans réduire, de nouvelles paires de coordonnées <u>relatives</u> dX et dY seront ajoutées à la ligne.  La lettre majuscule "l" est responsable du fait que les coordonnées sont relatives (le grand "L" indique les coordonnées absolues), après "l" est placé dX puis dY, séparés par des espaces.  Dans ce prototype, dY = 1 (incrément de 1px), à l'avenir, le long de l'axe X, je me déplacerai avec l'incrément dX calculé à partir de la largeur du conteneur et du nombre de points qui doivent y être placés.  Dans la dernière ligne de génération de PATH <br> <code>path +=`L ${this.timePoints.length} 0`</code> <br>  J'ai forcé, à partir du dernier point, je termine la construction de la ligne sur l'axe X. Si vous devez fermer le contour, vous pouvez ajouter "Z" à la fin de la ligne, au début, je pensais que sans contour fermé, le chiffre résultant ne serait pas rempli (remplissage), mais cela s'est avéré être faux, là où il n'est pas fermé, le trait - le trait ne sera pas tracé. </p><br><pre> <code class="javascript hljs">getSVGTimePoints:<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> predY = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> path = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timePoints.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str, item</span></span></span><span class="hljs-function">)=&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dY = item - predY predY = item <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str + <span class="hljs-string"><span class="hljs-string">`l 1 </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${dY}</span></span></span><span class="hljs-string"> `</span></span> },<span class="hljs-string"><span class="hljs-string">'M 0 0 '</span></span>) path +=<span class="hljs-string"><span class="hljs-string">`L </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.timePoints.length}</span></span></span><span class="hljs-string"> 0`</span></span><span class="hljs-comment"><span class="hljs-comment">// Z`     return path },</span></span></code> </pre><br><p>  Je vais continuer à apporter des modifications.  Mon indicateur doit être mis à l'échelle en largeur et en hauteur afin que tous les points transmis s'insèrent dans le conteneur donné.  Pour ce faire, tournez-vous vers le DOM et découvrez les dimensions du conteneur </p><br><ol><li><h5>  ref - obtenir des informations sur un élément DOM </h5><br><p>  Au conteneur div (dans lequel svg est inséré), j'ajoute une classe wrapper pour passer la largeur et la hauteur à travers les styles.  Et pour que svg occupe tout l'espace du conteneur, règle sa hauteur et sa largeur à 100%.  RECT, à son tour, occupera également tout l'espace du conteneur et sera l'arrière-plan de PATH </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrapper"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loadprogresser"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sample"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/svg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rect</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"transparent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stroke</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"black"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><p>  Afin de trouver mon conteneur DIV dans la vue DOM virtuelle, j'ajoute l'attribut ref et je lui donne un nom par lequel je vais chercher <code>ref="loadprogresser"</code> .  Dans le hook de cycle de vie <code>mounted</code> , j'appellerai la méthode getScales (), dans laquelle, avec la chaîne <code>const {width, height} = this.$refs.loadprogresser.getBoundingClientRect()</code> je trouve la largeur et la hauteur de l'élément DIV après son apparition dans le DOM. </p><br><p>  En outre, des calculs simples de l'incrément le long de l'axe X, en fonction de la largeur du conteneur et du nombre de points que nous voulons y insérer.  L'échelle le long de l'axe Y est recalculée chaque fois que le maximum est trouvé dans la valeur transmise. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li><li><h5>  transformer - changer le système de coordonnées </h5><br><p>  À ce stade, je remarque que nous devons changer le système de coordonnées de sorte que la coordonnée 0: 0 commence à partir du coin inférieur gauche et que l'axe Y croisse, pas vers le bas.  Vous pouvez, bien sûr, faire des calculs pour chaque point, mais SVG a un attribut de transformation qui vous permet de transformer les coordonnées. </p><br><p>  Dans mon cas, je dois appliquer une échelle de -1 aux coordonnées Y (afin que les valeurs Y soient reculées) et déplacer l'origine à la hauteur du conteneur <u>moins</u> .  Étant donné que la hauteur du conteneur peut être quelconque (spécifiée via les styles), nous avons dû former une ligne de transformation de coordonnées dans le crochet <code>mounted</code> avec le code suivant: <code>this.transform = `scale( 1, -1) translate(0,${-this.wrapHeight})`</code> </p><br><p>  Mais la transformation appliquée à PATH seule ne fonctionnera pas, pour cela, vous devez encapsuler PATH dans un groupe (balise g) auquel les transformations de coordonnées sont appliquées: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">g</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:transform</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"transform"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"transparent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stroke</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"black"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">g</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  En conséquence, les coordonnées se sont inversées correctement, l'indicateur de téléchargement est devenu plus proche de la conception </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></li><li><h5>  Texte SVG et centrage du texte </h5><br><p>  Le texte est nécessaire pour afficher le% de charge.  Le placement du texte au centre verticalement et horizontalement dans SVG est assez simple à organiser (par rapport à HTML / CSS), les attributs viennent à la rescousse (je fixe immédiatement les valeurs) dominant-baseline = "central" et text-anchor = "middle" </p><br><p>  Le texte en SVG est affiché avec la balise correspondante: </p><br> <code>&lt;text x="50%" y="50%" dominant-baseline="central" text-anchor="middle"&gt;{{TextPrc}}&lt;/text&gt;</code> <br> <p>  où TextPrc est la liaison à la variable correspondante, calculée par un simple rapport du nombre attendu de points au montant transféré <code>this.TextPrc = `${((this.Samples * 100)/this.maxSamples) | 0} %`</code>  <code>this.TextPrc = `${((this.Samples * 100)/this.maxSamples) | 0} %`</code> . </p><br><p>  Les coordonnées du début x = "50%" y = "50%" correspondent au centre du conteneur, et les attributs de ligne de base dominante et d'ancrage de texte sont chargés de s'assurer que le texte est aligné verticalement et horizontalement. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Les choses de base sur le sujet ont été élaborées, nous devons maintenant sélectionner le prototype d'indicateur dans un composant séparé. </p><br></li></ol><br><br></li><li><h4>  Affectation de l'indicateur de chargement dans un composant Vue distinct </h4><br><p>  Pour commencer, je déterminerai les données que je transférerai au composant, ce seront: maxSamples - le nombre d'échantillons à 100% de largeur, et Point - l'unité de données (point) qui sera entrée dans le tableau de points (sur la base de laquelle, après traitement, elle sera formée horaire).  Les données transmises au composant par le parent, je les place dans la section accessoires </p><br><pre> <code class="javascript hljs">props:{ <span class="hljs-attr"><span class="hljs-attr">maxSamples</span></span>: {<span class="hljs-comment"><span class="hljs-comment">//-   100%-  type: Number, default: 400 }, Point:{//  value:0 } }</span></span></code> </pre><br><h5>  Problèmes de réactivité </h5><br><p>  La propriété calculée getPath est responsable du fait que le nouveau point passé au composant est traité, ce qui dépend de Point (et si c'est le cas, il est recalculé lorsque Point change) </p><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... &lt;path :d="getPath"/&gt; ... //  props:{ ... Point:{ value:0 } //  computed:{ getPath(){ this.addValue({value:this.Point.value}) return this.getSVGPoints()//this.d } },</span></span></code> </pre><br><p>  Au début, j'ai fait un Point de type Number, ce qui est logique, mais ensuite tous les points n'ont pas été traités, mais seulement différents des précédents.  Par exemple, si seul le nombre 10 est transféré du parent à un tel point, alors un seul point sera dessiné sur le graphique, tous les suivants seront ignorés car ils ne diffèrent pas des précédents. </p><br><p>  Le remplacement du type Point de Number par l'objet {value: 0} a conduit au résultat souhaité - la propriété calculée getPath () traite désormais chaque point transmis, via Point.value Je passe les valeurs des points </p><br><div class="spoiler">  <b class="spoiler_title">Source du composant Progresser.vue</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;template&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"wrapper"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"loadprogresser"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"wrapper__content"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2000/svg"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">g</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:transform</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"transform"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">path</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:d</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"getPath"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">g</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">text</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"50%"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"50%"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dominant-baseline</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"central"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">text-anchor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"middle"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {{TextPrc}} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">template</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">props</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">maxSamples</span></span>: {<span class="hljs-comment"><span class="hljs-comment">//-   100%-  type: Number, default: 400 }, Point:{ value:0 } }, data(){ return { Samples:0,//   wrapHeight:100,//      maxY:0,//  Y  (  ) scales:{ w:1,//   (   ) h:1 //   //(   Y   ) }, Points:[],//     (  Point.value) transform:'scale( 1, -1) translate(0,0)', TextPrc: '0%' } }, mounted: function(){ this.getScales() }, methods:{ getScales(){ const {width, height} = this.$refs.loadprogresser.getBoundingClientRect() //.    this.scales.w = width / this.maxSamples //  Y    this.wrapHeight = height this.transform = `scale( 1, -1) translate(0,${-this.wrapHeight}) rotate(0)` }, getVScale(){//    this.scales.h = (this.maxY == 0)? 0 : this.wrapHeight / this.maxY }, //          getYMax({value = 0}){ this.maxY = (value &gt; this.maxY) ? value : this.maxY }, addValue({value = 0}){ if (this.Samples &lt; this.maxSamples) { this.getYMax({value}) this.getVScale() this.Points.push(value) // Int this.Samples ++; this.TextPrc = `${((this.Samples * 100)/this.maxSamples) | 0} %` } }, getSVGPoints(){ //    Path let predY = 0 let path = this.Points.reduce((str, item)=&gt;{ let dY = (item - predY) * this.scales.h predY = item return str + `l ${this.scales.w} ${dY} ` },'M 0 0 ') path +=`L ${this.Points.length * this.scales.w} 0 `// Z`     return path }, }, computed:{ getPath(){ this.addValue({value:this.Point.value})//   return this.getSVGPoints()//this.d -  SVG PATH } } } &lt;/script&gt; &lt;style scoped&gt; .wrapper { width: 400px;/*     */ height: 100px;/*  ( )   */ font-size: 4rem; font-weight: 600; border-left: 1px gray solid; border-right: 1px gray solid; overflow: hidden; } .wrapper__content path { opacity: 0.5; fill: lightgreen; stroke: green; stroke-width: 1; } .wrapper__content text { opacity: 0.5; } &lt;/style&gt;</span></span></code> </pre><br></div></div><br><h5>  Appel à partir du composant parent et passage de paramètres </h5><br><p>  Pour travailler avec un composant, vous devez l'importer dans le composant parent <br> <code>import Progresser from "./components/Progresser"</code> <br>  et déclarer dans la section <br> <code>components: {Progresser }</code> </p> <br><p>  Dans le modèle du composant parent, le composant indicateur de progression est inséré avec la construction suivante: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progresser"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:maxSamples</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SamplesInProgresser"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:Point</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Point"</span></span></span><span class="hljs-tag"> &gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><p>  Grâce à la classe «progreser», tout d'abord, les tailles de bloc de l'indicateur sont définies.  MaxSamples (nombre maximal de points dans le graphique) de la variable parent SamplesInProgresser sont transférés aux accessoires du composant, et le point suivant (sous la forme d'un objet) de la variable Point de l'objet parent est transféré aux accessoires Point.  Le point du parent est calculé dans la fonction de mise à jour et représente des nombres aléatoires croissants.  Je reçois cette photo: </p><br><img src="https://habrastorage.org/webt/um/rb/y4/umrby4sqxabfzgz_ng1lnk6xgcy.gif"><br><div class="spoiler">  <b class="spoiler_title">Source parent App.vue</b> <div class="spoiler_text"><pre> <code class="javascript hljs">&lt;template&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"progresser"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:maxSamples</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"SamplesInProgresser"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:Point</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Point"</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/template&gt; &lt;script&gt; import Progresser from "./</span></span>components/Progresser<span class="hljs-string"><span class="hljs-string">" export default { name: 'app', data(){ return { SamplesInProgresser:400,// -  Point:{value:0},//"</span></span><span class="hljs-string"><span class="hljs-string">" index:0, // -   TimeM:100 //     } }, created: function () { this.update() }, methods:{ update(){ if (this.index &lt; this.SamplesInProgresser) { this.index++; this.Point = {value:(this.TimeM*Math.random() | 0)} this.TimeM *= 1.01 setTimeout(this.update, 0) } } }, components: { Progresser } } &lt;/script&gt; &lt;style&gt; #app { font-family: 'Avenir', Helvetica, Arial, sans-serif; margin-top: 60px; } /*     */ .progresser { width: 300px; height: 80px; } &lt;/style&gt;</span></span></code> </pre><br></div></div><br></li><li><h4>  Application du composant dans le SPA </h4><br><p>  Arriver au point où tout allait bien.  Et donc, j'ai des opérations asynchrones pour charger des enregistrements sur certaines identités de la base de données.  Le temps d'exécution d'une opération asynchrone n'est pas connu à l'avance.  Je mesurerai le temps d'exécution d'une manière triviale, en utilisant new Date (). GetTime () avant et après l'opération, et je transférerai le décalage horaire résultant au composant.  Naturellement, l'indicateur sera intégré dans le bloc qui apparaîtra à l'étape de chargement, et obscurcira la table pour laquelle les données sont chargées. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> getCandidatesData(){ ... this.LoadRecords = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-comment"><span class="hljs-comment">//   ,        ... this.SamplesInProgresser = uris.length //      ... for (let item of uris) {// uris  URL    try { const start = new Date().getTime()//   candidate = await this.$store.dispatch('GET_CANDIDATE', item) const stop = new Date().getTime()//   this.Point = {value:(stop-start)}//   Point ...</span></span></code> </pre><br><p>  Dans les données du composant parent que je prescris en ce qui concerne l'indication de charge: </p><br><pre> <code class="javascript hljs">data (){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ... <span class="hljs-comment"><span class="hljs-comment">//  LoadRecords:false, SamplesInProgresser:400, Point:{value:0} }</span></span></code> </pre><br><p>  Et dans le modèle: </p><br><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wait_loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">v-show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LoadRecords"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progresser"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:maxSamples</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SamplesInProgresser"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:Point</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Point"</span></span></span><span class="hljs-tag"> &gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progresser</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></li></ol><br><h4>  Conclusions </h4><br><p>  Comme prévu, rien de compliqué.  Jusqu'à un certain point, vous pouvez traiter SVG comme des balises HTML standard, avec leurs propres spécificités.  SVG est un outil puissant que j'utiliserai plus souvent dans mon travail pour la visualisation des données </p><br><h4>  Les références </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Télécharger le code source de l'indicateur</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article sur le chemin SVG</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460399/">https://habr.com/ru/post/fr460399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460383/index.html">Les transitions d'écran dans Legend of Zelda utilisent les fonctionnalités non documentées de NES</a></li>
<li><a href="../fr460387/index.html">Guide du débutant SELinux</a></li>
<li><a href="../fr460393/index.html">Contexte: à quoi s'attendre de Fedora Silverblue</a></li>
<li><a href="../fr460395/index.html">Analytics en tant que fonctionnalité: le processus d'utilisation des données dans Plesk</a></li>
<li><a href="../fr460397/index.html">Démarrage rapide avec WebComponents</a></li>
<li><a href="../fr460403/index.html">Avantages et inconvénients des HugePages</a></li>
<li><a href="../fr460405/index.html">Pourquoi avez-vous besoin de mécanismes de jeu cachés</a></li>
<li><a href="../fr460409/index.html">Arduino et claviers (guide complet)</a></li>
<li><a href="../fr460411/index.html">Mad Converter GIF'ok en autocollants animés pour Telegram</a></li>
<li><a href="../fr460413/index.html">7 sites et applications utiles pour apprendre l'anglais</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>