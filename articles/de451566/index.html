<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÉ üîä üë≤üèΩ Operation TaskMasters: Wie wir die angreifenden Organisationen der Cybergruppe in Russland und der GUS entlarvten ü§¶üèø üë®üèø‚Äçüè≠ ‚ÜóÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bild: Unsplash 

 Im Herbst 2018 enth√ºllten Experten des PT Expert Security Center die Aktivit√§ten einer kriminellen Gruppe, deren Aktivit√§ten darauf ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Operation TaskMasters: Wie wir die angreifenden Organisationen der Cybergruppe in Russland und der GUS entlarvten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/451566/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/lz/hs/uj/lzhsujgy5_y3llxp6xwz38yycfe.png"></a> <br><br>  <i>Bild: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Unsplash</a></i> <br><br>  Im Herbst 2018 enth√ºllten Experten des PT Expert Security Center die Aktivit√§ten einer kriminellen Gruppe, deren Aktivit√§ten darauf abzielten, vertrauliche Dokumente und Spionage zu stehlen.  Heute werden wir √ºber den Fortschritt der Untersuchung sprechen und die wichtigsten Methoden und Werkzeuge beschreiben, die die Gruppe verwendet hat. <br><br>  <i>Hinweis</i> : Der Link enth√§lt einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vollst√§ndigen</a> Untersuchungsbericht.  Es enth√§lt auch Kompromissindikatoren, anhand derer Anzeichen eines Angriffs identifiziert werden k√∂nnen. <a name="habracut"></a><br><br><h2>  Wen die Gruppe angreift und wann sie entdeckt wurde </h2><br>  Die Gruppierung wurde 2018 von Experten des PT Expert Security Center identifiziert.  Die Kriminellen verwendeten eine ungew√∂hnliche Methode zur Sicherung der Infrastruktur, die auf der Erstellung spezifischer Aufgaben (Tasks) im Taskplaner beruhte. Deshalb hat PT ESC die TaskMasters-Gruppe genannt. <br><br>  Mit dem Taskplaner k√∂nnen Sie Betriebssystembefehle ausf√ºhren und Software zu einem bestimmten in der Aufgabe angegebenen Zeitpunkt ausf√ºhren.  Dar√ºber hinaus k√∂nnen Sie mit dem von dieser Gruppierung verwendeten AtNow-Scheduler Aufgaben nicht nur lokal, sondern auch auf Remotecomputern im Netzwerk ausf√ºhren, und zwar unabh√§ngig von den Zeiteinstellungen dieser Knoten.  Dar√ºber hinaus erfordert dieses Dienstprogramm keine Installation.  Diese Funktionen vereinfachen die Angriffsautomatisierung. <br><br>  Hacker hackten Unternehmen aus verschiedenen L√§ndern mit einer erheblichen Anzahl von Opfern in Russland und der GUS.  Die meisten der angegriffenen Unternehmen sind der Branche zuzuschreiben.  Insgesamt sind wir uns des Kompromisses von mehr als 30 Organisationen in verschiedenen Branchen bewusst, einschlie√ülich des Energie- und √ñl- und Gassektors sowie von Regierungsstellen. <br><br>  Das Hauptziel der Gruppe ist es, vertrauliche Informationen zu stehlen.  Angreifer versuchen, lange Zeit im Unternehmensinformationssystem Fu√ü zu fassen und Zugriff auf die Schl√ºsselserver, Top-Management-Workstations und kritischen Gesch√§ftssysteme des Unternehmens zu erhalten. <br><br>  Die fr√ºhesten Spuren der Pr√§senz der Gruppe in der Infrastruktur stammen aus dem Jahr 2010, und zu diesem Zeitpunkt kontrollierten die Kriminellen bereits einige Server und Workstations vollst√§ndig, was bedeutet, dass die Penetration viel fr√ºher erfolgte. <br><br><h2>  Asiatischer Fu√üabdruck </h2><br>  Im Code auf GitHub der ASPXSpy2014-Webshell, der w√§hrend des Angriffs verwendet wurde, gibt es Links zu chinesischen Entwicklern.  Die gefundene Version enth√§lt jedoch stattdessen einen Link zu google.ru. <br><br><img src="https://habrastorage.org/webt/ag/oh/va/agohvad709ucmllwefycordfjhw.png"><br><br>  <i>ASPXSpy: √∂ffentliche und angegriffene Versionen</i> <br><br>  Bei Anfragen nach Web-Shells wurden IP-Adressen des Hosting-Anbieters und der Druckereien in Osteuropa identifiziert.  In den Ereignissen des Proxy-Server-Protokolls einer der angegriffenen Organisationen wurde jedoch der Moment angezeigt, in dem die Angreifer auf die residente chinesische IP-Adresse 115.171.23.103 wechselten, was h√∂chstwahrscheinlich auf die Trennung des Software-VPN zum Zeitpunkt des Angriffs zur√ºckzuf√ºhren war. <br><br>  W√§hrend des Angriffs verwendeten die Angreifer eine Kopie des WinRAR-Archivierers, der mit einem Schl√ºssel aktiviert wurde, der in Foren, deren Benutzer auf Chinesisch kommunizieren, weit verbreitet ist. <br><br><img src="https://habrastorage.org/webt/5d/tg/eh/5dtgeh4xjibopstd7zh6altqxas.png"><br><br>  <i>Lizenzierte Version von WinRAR in Softwareressourcen</i> <br><br><img src="https://habrastorage.org/webt/dc/qs/as/dcqsas2b1wfkqble9g_pntsvbcc.png"><br><br>  <i>WinRAR-Lizenzschl√ºssel in chinesischen Foren ver√∂ffentlicht</i> <br><br>  F√ºr eine der Aufgaben wurde die Domain Brengkolang.com verwendet, die √ºber einen chinesischen Registrar registriert wurde.  Au√üerdem enthalten viele Dienstprogramme Fehlermeldungen und andere fehlerhafte Englisch-Debugging-Informationen, die m√∂glicherweise darauf hinweisen, dass sie nicht f√ºr Entwickler nativ sind. <br><br><h2>  Wie Angreifer handeln </h2><br>  Der gesamte Angriffsvektor ist ziemlich vorhersehbar.  Nach dem Eindringen in das lokale Netzwerk untersuchen Angreifer die Infrastruktur, nutzen Systemschwachstellen aus (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CVE-2017-0176</a> ), laden sie auf gef√§hrdete Knoten herunter und entpacken eine Reihe von Dienstprogrammen.  Mit diesem Set suchen, kopieren und archivieren sie die f√ºr sie interessanten Dateien und senden sie dann an die Verwaltungsserver. <br><br>  Um im Netzwerk zu navigieren, f√ºhren Kriminelle Systembefehle auf Remote-Knoten mit dem Dienstprogramm AtNow aus, mit dem Sie Software ausf√ºhren und Befehle ausf√ºhren k√∂nnen, nachdem ein bestimmtes Zeitintervall verstrichen ist.  Verwalten der Knoten mithilfe kleiner Backdoors, √ºber die sie eine Verbindung zu den Verwaltungsservern herstellen.  Gleichzeitig gibt es Sicherungskan√§le in Form von Web-Shells, die auf externe Ressourcen hochgeladen werden, z. B. auf den Exchange-Server. <br><br><img src="https://habrastorage.org/webt/_t/4n/wv/_t4nwviraqyi6_wd43biwwuovt8.png"><br><br>  <i>Angriffsmuster</i> <br><br>  Die Gruppe verwendet die dynamische DNS-Infrastruktur f√ºr ihre Dom√§nen.  Angreifer verwenden eine Vielzahl von Dienstprogrammen und Tools, um Cyber-Angriffe durchzuf√ºhren und das Supply-Chain-Angriffsschema aktiv zu nutzen. <br><br>  Um das Netzwerk zu scannen und Systeme zu gef√§hrden, verwenden Angreifer kostenlose Software (einschlie√ülich NBTScan, PWDump, Mimikatz).  Neben Tools von Drittanbietern werden auch selbst entwickelte Programme verwendet. <br><br>  Die Hauptsoftware der TaskMasters-Gruppe, mit der infizierte Knoten gesteuert wurden, besteht aus zwei Komponenten: <br><br><ul><li>  RemShell Downloader - Lader, </li><li>  RemShell - Software mit grundlegenden Funktionen. </li></ul><br>  Lassen Sie uns jede der Komponenten genauer betrachten. <br><br><h2>  RemShell Downloader </h2><br>  Diese Komponente der Malware dient dazu, die Hauptnutzlast an das angegriffene System zu liefern.  Das allgemeine Arbeitsschema des Bootloaders ist in der folgenden Abbildung dargestellt. <br><br><img src="https://habrastorage.org/webt/wc/gq/q_/wcgqq_svfh88x9m3gxtf1qamhys.png"><br><br>  <i>RemShell Loader-Workflow</i> <br><br>  Der Loader greift unter der zuvor in seinem Code angegebenen Adresse auf die HTML-Seite zu und liest den Wert des Attributattributs des HTML-Tags: <br><br><img src="https://habrastorage.org/webt/of/ug/6c/ofug6cpcp-u6byrh-7ghxx7tf-a.png"><br><br>  <i>Beispiel f√ºr eine HTML-Datei</i> <br><br>  Anschlie√üend wird der Lesewert entschl√ºsselt, und je nachdem, was er dort enth√§lt, wechselt der Bootloader entweder in den Standby-Modus (Befehl Sleep) oder speichert die PE-Datei auf der Festplatte und startet sie.  Die heruntergeladene PE-Datei ist nur die Nutzlast - der Haupttrojaner von RemShell. <br><br><h2>  Trojaner RemShell </h2><br>  RemShell, die wichtigste Malware, die von Angreifern zur Kontrolle infizierter Knoten verwendet wird, bietet Angreifern die folgenden Optionen: <br><br><ol><li>  Terminal f√ºr die Remote-Host-Steuerung (Cmd-Shell). </li><li>  Hochladen von Dateien auf einen Remote-Host. </li><li>  Laden Sie Dateien von einem Remote-Host auf den Verwaltungsserver herunter. </li></ol><br>  Der Trojaner verwendet zwei Verwaltungsserver.  Der erste fungiert als Vermittler oder Proxy, der auf Anforderung von Malware die Adresse des Hauptverwaltungsservers bereitstellt.  Au√üerdem kann vom ersten Verwaltungsserver ein Befehl zum √úbertragen von Malware auf einen anderen Verwaltungsproxyserver empfangen werden. <br><br><img src="https://habrastorage.org/webt/7r/pg/ll/7rpgll7b5bjlvyyljapucz_hsec.png"><br><br>  <i>Migration vom ersten Verwaltungsserver zum prim√§ren</i> <br><br>  Wir haben verschiedene Variationen dieser Malware gefunden.  In einigen F√§llen gab es beispielsweise keinen Befehl zum Herunterladen von Dateien vom Knoten auf den Verwaltungsserver. In solchen F√§llen verwendeten die Angreifer ein propriet√§res Dienstprogramm zum Hochladen von Dateien.  In anderen F√§llen wurden Befehle hinzugef√ºgt, mit denen Sie eine Liste der auf dem System ausgef√ºhrten Prozesse abrufen und den Prozess anhand der PID (Prozesskennung) abschlie√üen k√∂nnen. <br>  Konfigurationsdaten wie die Adresse des steuernden Proxyservers, des Ports und des Benutzeragenten werden mit RC4 verschl√ºsselt und durch Konstanten im Malware-Code festgelegt. <br><br>  Die zwischen den Verwaltungsservern und der Malware gesendeten Daten werden mit dem RC4-Algorithmus verschl√ºsselt und zus√§tzlich mit Base64 codiert.  Der Schl√ºssel f√ºr RC4 wird unter Verwendung einer konstanten Zeichenfolge durch Berechnung des MD5-Hash generiert.  Das Ergebnis der Ausf√ºhrung von vom Verwaltungsserver empfangenen Befehlen wird als HTTP-Anforderung an die URL mit einem bestimmten Pr√§fix 1111 gesendet. <br><br>  Die Malware enth√§lt auch den Heartbeat-Mechanismus, der in zuf√§lligen Abst√§nden mit einer HTTP-Anforderung ‚Äûtippt‚Äú, die das Ergebnis des Befehls hostname an eine bestimmte URL mit einem bestimmten Pr√§fix von 0000 enth√§lt. <br><br><img src="https://habrastorage.org/webt/ng/-j/f_/ng-jf_ivno95yki2nb0wced6ygo.png"><br><br>  <i>Herzschlag</i> <br><br><h2>  Verwaltungsserver </h2><br>  Der Serverteil zum Verwalten von Malware auf infizierten Knoten wird durch Konsolen-ELF-Dateien dargestellt.  Die Serververwaltungsschnittstelle besteht aus einer Shell und unterst√ºtzt die in der folgenden Abbildung dargestellten Befehle. <br><br><img src="https://habrastorage.org/webt/dm/zc/oy/dmzcoy-l6yk0yizsuueiksglsta.png"><br><br>  Der Server protokolliert detailliert alle an den Remote-Host gesendeten Befehle.  Diese Protokolldateien werden verschl√ºsselt auf der Festplatte gespeichert.  Zum Verschl√ºsseln von Protokolldateien wird der RC4-Algorithmus verwendet. <br><br>  Wir konnten mehrere Instanzen der Serverseite der Malware analysieren.  In einem Fall wurde der AiMi-Entwickler erw√§hnt, auf den in anderen Tools der TaskMasters-Gruppierung verwiesen wurde. <br><br><img src="https://habrastorage.org/webt/pv/ie/sv/pviesv3b2-pss7d6tyedpcrk1yg.png"><br><br>  <i>Erw√§hnung von Entwicklern in den vom Skript angezeigten Informationen</i> <br><br><h2>  Web Shell 404-Eingabe-Shell </h2><br>  Das Autorisierungsfenster f√ºr den Zugriff auf die Funktionalit√§t der Web-Shell ist als Standardfehlerseite 404 des IIS-Webservers getarnt.  Um auf die Befehlszeile zuzugreifen und Befehle auszuf√ºhren, m√ºssen Sie ein Kennwort eingeben.  Das Passwortfeld wird ausgeblendet und angezeigt, wenn Sie auf den Link Zur√ºck klicken. <br><br><img src="https://habrastorage.org/webt/q_/wv/x1/q_wvx1r71d3xebktyd7fpwl-th0.png"><br><br><pre><code class="bash hljs">Click the &lt;a href=<span class="hljs-string"><span class="hljs-string">"#"</span></span> ondblclick=<span class="hljs-string"><span class="hljs-string">"history_back()"</span></span>&gt;Back&lt;/a&gt; button to try another link.&lt;/li&gt;</code> </pre> <br>  Zur Autorisierung verwendeten die Angreifer das Passwort 0p; / 9ol.  - Sie verwendeten dasselbe Passwort, um Archive zu verschl√ºsseln.  Der Web-Shell-Code enth√§lt den MD5-Hash dieses Kennworts. <br><br><img src="https://habrastorage.org/webt/jg/ia/vg/jgiavgy650zj9gonqkmegfuekk8.png"><br><br>  Insgesamt haben wir im Rahmen der Untersuchungen drei Modifikationen dieser Web-Shell gefunden.  Sie unterscheiden sich in der Funktionalit√§t: Eine davon wird nur zum Herunterladen von Dateien vom Server verwendet, die andere zum Hochladen von Dateien auf den Server, die dritte zum Ausf√ºhren von Betriebssystembefehlen. <br><br><h2>  Fazit </h2><br>  Unsere Studie zeigt, dass Cyberkriminelle nicht nur momentane finanzielle Ziele verfolgen k√∂nnen.  Zunehmend versuchen sie, Zugang zu Daten zu erhalten und die Kontrolle √ºber den Informationsfluss von Organisationen zu erfassen. <br><br>  Opfer von Cyberspionage k√∂nnen Unternehmen aus verschiedenen Wirtschaftsbereichen sein.  Um zu verstehen, wie man sich gegen solche Angriffe verteidigt, m√ºssen spezielle Tools verwendet werden.  Auch in der Ermittlungsphase ist es wichtig, die Taktik der Angreifer im Detail zu untersuchen.  F√ºr Unternehmen ist es ziemlich schwierig, dieses Problem selbst zu l√∂sen, da hierf√ºr nicht nur fortschrittliche Tools, sondern auch hochqualifizierte Spezialisten f√ºr Informationssicherheit erforderlich sind.  Die Umsetzung von Empfehlungen von Sicherheitsexperten erh√∂ht das Sicherheitsniveau der Infrastruktur und erschwert deren Hacking. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451566/">https://habr.com/ru/post/de451566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451552/index.html">Wir bauen Netzwerkvertriebskan√§le des Gadgets DO-RA auf</a></li>
<li><a href="../de451556/index.html">Flattern: Anwendungslokalisierung mit Android Studio</a></li>
<li><a href="../de451558/index.html">Ein Tag im Leben der QS-Automatisierung</a></li>
<li><a href="../de451560/index.html">Sehr geehrter Kunde, deshalb hat diese √Ñnderung so lange gedauert.</a></li>
<li><a href="../de451562/index.html">Wie kann man einer Sekte entkommen?</a></li>
<li><a href="../de451570/index.html">Zur Arbeit nach Frankreich ziehen: Geh√§lter, Visa und Lebensl√§ufe</a></li>
<li><a href="../de451572/index.html">Webentwicklungstechnologietrends 2019</a></li>
<li><a href="../de451574/index.html">Entwickeln Sie ein Dienstprogramm f√ºr GraalVM</a></li>
<li><a href="../de451576/index.html">Das Buch "Unser Code. Handwerk, Beruf, Kunst "</a></li>
<li><a href="../de451580/index.html">MODX Digest # 5 (22. April - 13. Mai 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>