<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèø ü¶ñ üèúÔ∏è A√±o nuevo IMaskjs 6 - React Native, Pipes, ESM üëáüèø üìπ üîü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! 


 Acabo de lanzar la sexta versi√≥n de la biblioteca imaskjs . Despu√©s de cada lanzamiento importante, me parece que esta es la √∫ltima ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A√±o nuevo IMaskjs 6 - React Native, Pipes, ESM</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/481922/"><p><img src="https://habrastorage.org/webt/ef/f1/eb/eff1ebw3d7h1yebue3fuxq76vns.png"><br>  Hola a todos! </p><br><p>  Acabo de lanzar la sexta versi√≥n de la biblioteca <a href="https://imask.js.org/">imaskjs</a> .  Despu√©s de cada lanzamiento importante, me parece que esta es la √∫ltima versi√≥n.  La biblioteca tiene m√°s de un a√±o, es estable y bastante popular entre la comunidad.  ¬øQu√© m√°s se puede hacer all√≠ e incluso en la versi√≥n principal?  En todos mis proyectos, trato de hacer tareas para no volver a ellas en el contexto actual.  ¬øQu√© puede cambiar en la m√°scara?  - Los navegadores no cambian sus API, javascript es el mismo, las tareas comerciales son las mismas: tel√©fonos, tarjetas, n√∫meros.  ¬øPor qu√© no puedes parar, recordar y no tocar m√°s? </p><a name="habracut"></a><br><p>  De vez en cuando, por supuesto, debe presionarlo hacia abajo para que parezca que el proyecto est√° vivo y la fecha de la √∫ltima confirmaci√≥n en github se actualiza.  ¬øNo soy el √∫nico que la mira cuando elijo una biblioteca? </p><br><p>  Pero parece que no hay una raz√≥n seria para los cambios.  En realidad lo hay.  En mi caso con la m√°scara, los principales cambios se refieren al ecosistema javascript: el lenguaje en s√≠ mismo ha ido mucho m√°s all√° del navegador y se extiende hasta donde se usaron las herramientas nativas antes, lo que impone nuevos requisitos para las herramientas.  Tambi√©n est√°n surgiendo nuevos marcos de interfaz de usuario que requieren cierta adaptaci√≥n.  Aunque me parece que la interfaz de la biblioteca est√° hecha de la manera m√°s simple y conveniente posible, por lo tanto, existe y no puede haber un problema con la integraci√≥n sin nada, en cualquier caso en el navegador.  Pero luego comenc√© a trabajar en un complemento para React Native. </p><br><h2 id="lezem-v-trubu-na-react-native">  Subimos a la tuber√≠a en React Native </h2><br><p>  Hasta donde yo s√©, React Native es un proyecto a gran escala que ha estado viviendo durante mucho tiempo, e incluso utiliza personas serias en la producci√≥n.  Hace un par de a√±os, intent√© usar RN en un peque√±o proyecto de prueba, y ese fue el final de mi pr√°ctica: fui a la web.  Casi al mismo tiempo, hice un complemento para la m√°scara en RN e intent√© con todas mis fuerzas hacerlo funcionar como quisiera, pero no pude.  Encontr√© <a href="https://github.com/uNmAnNeR/imaskjs/issues/12">varios errores</a> en el repositorio RN sobre el procesamiento de entrada y el posicionamiento del cursor, me tranquilic√© y decid√≠ esperar un poco. </p><br><p>  Ha pasado m√°s de un a√±o y pens√© que era hora de volver y ya deshacerme del complemento.  Result√≥ que pr√°cticamente nada ha cambiado durante este tiempo: los errores antiguos se cerraron debido a la falta de actividad, la interfaz de posicionamiento del cursor ha cambiado un poco, y eso es todo.  Me gustar√≠a pensar que el problema est√° en mi biblioteca, arreglar√© todo y funcionar√°.  Por desgracia, en mi opini√≥n, la m√°scara ya tiene la interfaz m√°s simple posible: la mayor parte de la l√≥gica se saca al n√∫cleo, solo se necesitan dos estados para procesar la entrada: el cursor y el valor antes y despu√©s del cambio.  En mi opini√≥n, no hay ning√∫n lugar m√°s f√°cil, pero todav√≠a no pude obtener RN. </p><br><p>  Una de las dificultades es que la secuencia de eventos de entrada en RN es diferente del navegador.  Por ejemplo, en el navegador para el evento de <em>entrada</em> , el cursor ya est√° en la nueva posici√≥n, pero en RN hay un evento <em>onSelectionChange</em> separado que ocurre despu√©s de cambiar el valor, y solo en iOS, en Android, viceversa.  Y el segundo punto: no puede cambiar el valor en el campo en el campo en el controlador de eventos del evento de cambio de valor en RN, lo mismo con el posicionamiento del cursor.  Por lo tanto, los retrasos en el cambio son inevitables y, como resultado, el texto y el cursor se contraen.  Estos errores ya tienen casi tres a√±os, as√≠ que no veo ninguna raz√≥n para esperar m√°s. Lanc√© el complemento tal cual, pero no recomiendo usarlo.  M√°s bien, lo hice para atraer la atenci√≥n del p√∫blico: tal vez los errores se solucionar√°n en RN, o tal vez alguien conecte el procesamiento de eventos en IMask al c√≥digo nativo, donde se pueden evitar dichos problemas. </p><br><h2 id="svoya-truba">  Tubo propio </h2><br><p>  Ahora un poco sobre lo bueno.  La m√°scara ahora se puede usar para formatear y convertir: </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> numberPipe = IMask.createPipe({ <span class="hljs-attr"><span class="hljs-attr">mask</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>, <span class="hljs-attr"><span class="hljs-attr">scale</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">thousandsSeparator</span></span>: <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-attr"><span class="hljs-attr">normalizeZeros</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">padFractionalZeros</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }); <span class="hljs-comment"><span class="hljs-comment">// `numberPipe` -    numberPipe('1'); // "1,00"</span></span></code> </pre> <br><p>  Puede reutilizar una m√°scara para trabajar con entrada y para formatear, por ejemplo en un formulario: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     const mask = IMask(el, { mask: Number, scale: 2, thousandsSeparator: ' ', normalizeZeros: true, padFractionalZeros: true, }); //   pipe    , //     IMask.pipe( 1, //  mask.masked, //     IMask.PIPE_TYPE.TYPED, //     IMask.PIPE_TYPE.UNMASKED //     ) // 1.00</span></span></code> </pre> <br><p>  En el complemento Angular, por conveniencia, envuelto en una tuber√≠a local. <br>  Una vez m√°s, lo m√°s simple y funcional posible, la implementaci√≥n de literalmente 5 l√≠neas de c√≥digo es, por cierto, un indicador de una arquitectura exitosa.  Sin embargo, se han agregado 5 l√≠neas de c√≥digo m√°s de una vez, y el tama√±o de toda la biblioteca ya se ha ejecutado seriamente. </p><br><h2 id="esm-moduli">  M√≥dulos de ESM </h2><br><p>  Hace un par de a√±os, cuando la m√°scara ten√≠a aproximadamente 30 Kb, les dije a todos que para una m√°scara esto no era mucho.  Ahora tiene casi 60 Kb e incluso me pareci√≥ un poco demasiado.  Hay una soluci√≥n simple: <del>  gzip </del>  toma solo lo que necesitas.  Idealmente, el recopilador deber√≠a analizar autom√°ticamente las dependencias y tirar todo lo que no se utiliza.  Aunque los m√≥dulos de ESM han estado en la m√°scara durante mucho tiempo, la sacudida de √°rboles casi no funcion√≥, porque  referencias a entidades internas estaban en el objeto ra√≠z IMask.  Esto se hizo debido a la presencia de dependencias c√≠clicas dentro de la m√°scara, y tambi√©n porque quer√≠a que la m√°scara pudiera importar un objeto ra√≠z o por separado en partes.  Por ejemplo, esto se hace en React: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; React.Component === Component; <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre> <br><p>  En IMask 6.0, el enlace duro entre los m√≥dulos se rompi√≥ y fue posible importar m√≥dulos individuales: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    // import IMask from 'imask'; //      import IMask from 'imask/esm/imask'; //   ,   //    import 'imask/esm/masked/number'; //      ,       const numberMask = IMask(element, { mask: Number });</span></span></code> </pre> <br><p>  En este caso, puede continuar utilizando el enfoque anterior y nada se romper√°, pero el movimiento de √°rboles tampoco funcionar√°. </p><br><p>  Bueno, para empezar: ¬°la nueva versi√≥n tiene soporte para componentes <em>contentables</em> y web!  Gracias a la comunidad por los comentarios y las solicitudes de grupo. </p><br><p>  Con cada nueva versi√≥n, los errores se vuelven m√°s delgados, los deseos m√°s ex√≥ticos.  Aqu√≠ de nuevo, parece que el asunto est√° llegando a su fin.  Y entonces parece que ser√° infinito hasta que el proyecto muera o aparezca algo mejor.  O tal vez la plataforma cambiar√° y aparecer√°n nuevas interfaces.  Pero aparentemente, los navegadores ahora est√°n en alg√∫n lugar entre la juventud y la madurez, y despu√©s de la muerte de <a href="https://github.com/text-mask/text-mask">text-mask</a> , no hay alternativas funcionales para IMask, y todav√≠a puedo encontrar una ca√≠da de tiempo en c√≥digo abierto, por lo que deber√≠a haber una m√°scara. </p><br><p>  ¬°Todo el √©xito y la inspiraci√≥n en el A√±o Nuevo, con la llegada! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/481922/">https://habr.com/ru/post/481922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../481906/index.html">Cerebro chino, o en defensa de la primavera</a></li>
<li><a href="../481910/index.html">Escribir comportamiento de deslizamiento vertical flexible</a></li>
<li><a href="../481912/index.html">Como una semana fui pasante en SRE-ingeniero. Mira a trav√©s de los ojos de un ingeniero de software</a></li>
<li><a href="../481914/index.html">Spring Boot vs Spring MVC vs Spring - ¬øC√≥mo se comparan?</a></li>
<li><a href="../481916/index.html">¬øPara qu√© fue recordado el a√±o 2019 en desarrollo?</a></li>
<li><a href="../481924/index.html">Apache Spark, evaluaci√≥n diferida y consultas SQL de varias p√°ginas</a></li>
<li><a href="../481926/index.html">Conozca la nueva soluci√≥n Veeam Backup para AWS</a></li>
<li><a href="../481930/index.html">Cultura de desarrollo: c√≥mo se eval√∫an el rendimiento y la eficiencia</a></li>
<li><a href="../481932/index.html">Implementaci√≥n de bases de datos y tiempo de inactividad cero</a></li>
<li><a href="../481934/index.html">An√°lisis: por qu√© las acciones de Tesla est√°n creciendo en precio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>