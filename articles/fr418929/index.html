<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ß üßëüèø‚Äçü§ù‚Äçüßëüèæ üë∂üèº Tests unitaires et Python üòê üë• üçú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'appelle Vadim, je suis l'un des principaux d√©veloppeurs de Mail.Ru Search. Je partagerai notre exp√©rience des tests unitaires. L'article se compo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tests unitaires et Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/418929/"><img src="https://habrastorage.org/webt/vw/s_/rj/vws_rjpt_tkcghfjw_emwmzdakc.jpeg"><br><br>  Je m'appelle Vadim, je suis l'un des principaux d√©veloppeurs de Mail.Ru Search.  Je partagerai notre exp√©rience des tests unitaires.  L'article se compose de trois parties: dans la premi√®re, je vais vous dire ce que nous r√©alisons g√©n√©ralement √† l'aide de tests unitaires;  la deuxi√®me partie d√©crit les principes que nous suivons;  et de la troisi√®me partie, vous apprendrez comment les principes mentionn√©s sont impl√©ment√©s en Python. <br><a name="habracut"></a><br><h1>  Buts </h1><br>  Il est tr√®s important de comprendre pourquoi vous appliquez des tests unitaires.  Des actions concr√®tes en d√©pendront.  Si vous utilisez les tests unitaires de mani√®re incorrecte, ou avec leur aide vous ne faites pas ce que vous vouliez, alors rien de bon n'en sortira.  Par cons√©quent, il est tr√®s important de comprendre √† l'avance quels objectifs vous poursuivez. <br><br>  Dans nos projets, nous poursuivons plusieurs objectifs. <br><br>  La premi√®re est une <b>r√©gression</b> banale: pour corriger quelque chose dans le code, lancez les tests et d√©couvrez que rien ne s'est cass√©.  Bien que, en fait, ce ne soit pas aussi simple qu'il y para√Æt. <br><br>  Le deuxi√®me objectif est <b>d'√©valuer l'impact de l'architecture</b> .  Si vous introduisez des tests unitaires obligatoires dans le projet, ou si vous √™tes simplement d'accord avec les d√©veloppeurs sur l'utilisation des tests unitaires, cela affectera imm√©diatement le style d'√©criture du code.  Il est impossible d'√©crire des fonctions sur 300 lignes avec 50 variables locales et 15 param√®tres si ces fonctions sont soumises √† des tests unitaires.  De plus, gr√¢ce √† ces tests, les interfaces deviendront plus compr√©hensibles et certaines zones probl√©matiques appara√Ætront.  Apr√®s tout, si le code n'est pas si chaud, le test sera une courbe et il attirera imm√©diatement votre attention. <br><br>  Le troisi√®me objectif est <b>de rendre le code plus clair</b> .  Supposons que vous soyez arriv√© √† un nouveau projet et que vous ayez re√ßu 50 Mo de code source.  Vous ne pourrez peut-√™tre tout simplement pas les comprendre.  S'il n'y a pas de tests unitaires, alors la seule fa√ßon de se familiariser avec le travail du code, en plus de lire la source, est la ¬´m√©thode poke¬ª.  Mais si le syst√®me est assez compliqu√©, cela peut prendre beaucoup de temps pour obtenir les morceaux de code n√©cessaires via l'interface.  Et gr√¢ce aux tests unitaires, vous pouvez voir comment le code est ex√©cut√© de n'importe o√π. <br><br>  Le quatri√®me objectif est <b>de simplifier le d√©bogage</b> .  Par exemple, vous avez trouv√© une classe et souhaitez la d√©boguer.  Si au lieu de tests unitaires, il n'y a que des tests syst√®me, ou pas de tests du tout, alors il ne reste plus qu'√† arriver au bon endroit via l'interface.  Il m'est arriv√© de participer √† un projet o√π, pour tester certaines fonctionnalit√©s, il a fallu une demi-heure pour cr√©er un utilisateur, lui faire payer de l'argent, changer son statut, lancer une sorte de cron, afin que ce statut soit transf√©r√© ailleurs, puis cliquer sur quelque chose dans l'interface, lancer quelque chose un autre cron ... Apr√®s une demi-heure, un programme de bonus pour cet utilisateur est finalement apparu.  Et si j'avais des tests unitaires, je pourrais imm√©diatement me rendre au bon endroit. <br><br>  Enfin, le but le plus important et le plus abstrait, qui unit tous les pr√©c√©dents, est le <b>confort</b> .  Lorsque je fais des tests unitaires, je ressens moins de stress lorsque je travaille avec du code, car je comprends ce qui se passe.  Je peux prendre une source inconnue, corriger trois lignes, ex√©cuter des tests et m'assurer que le code fonctionne comme pr√©vu.  Et ce n'est m√™me pas que les tests soient verts: ils peuvent √™tre rouges, mais exactement l√† o√π je m'attends.  Autrement dit, je comprends comment fonctionne le code. <br><br><h1>  Principes </h1><br>  Si vous comprenez vos objectifs, vous pouvez comprendre ce qui doit √™tre fait pour les atteindre.  Et ici les probl√®mes commencent.  Le fait est que de nombreux livres et articles ont √©t√© √©crits sur les tests unitaires, mais la th√©orie est encore tr√®s immature. <br><br>  Si vous avez d√©j√† lu des articles sur les tests unitaires, essay√© d‚Äôappliquer ce qui est d√©crit et que vous n‚Äôavez pas r√©ussi, il est tr√®s probable que la raison soit l‚Äôimperfection de la th√©orie.  Cela arrive tout le temps.  Comme tous les d√©veloppeurs, j'ai pens√© un jour que le probl√®me √©tait en moi.  Et puis il a r√©alis√©: il ne peut pas √™tre que je me suis tromp√© tant de fois.  Et il a d√©cid√© que dans les tests unitaires, il fallait partir de ses propres consid√©rations, pour agir de mani√®re plus sens√©e. <br><br>  Le conseil standard que vous pouvez trouver dans tous les livres et articles: ¬´vous devez tester non pas l'impl√©mentation, mais l'interface¬ª.  Apr√®s tout, l'impl√©mentation peut changer, mais pas l'interface.  Essayons-le pour que les tests ne tombent pas tout le temps √† chaque occasion.  Le conseil, semble-t-il, n'est pas mauvais, et tout semble logique.  Mais nous le savons tr√®s bien: pour tester quelque chose, vous devez s√©lectionner des valeurs de test.  Habituellement, lors du test de fonctions, les classes dites d'√©quivalence sont distingu√©es: l'ensemble de valeurs auquel la fonction se comporte uniform√©ment.  En gros, le test pour chaque si.  Mais pour savoir quelles classes d'√©quivalence nous avons, une impl√©mentation est n√©cessaire.  Vous ne le testez pas, mais vous en avez besoin, vous devez l'examiner afin de savoir quelles valeurs de test choisir. <br><br>  Parlez √† n'importe quel testeur: il vous dira qu'avec des tests manuels, il imagine toujours une impl√©mentation.  D'apr√®s son exp√©rience, il comprend parfaitement o√π les programmeurs font g√©n√©ralement des erreurs.  Le testeur ne v√©rifie pas tout, saisissant d'abord 5, puis 6, puis 7. Il v√©rifie 5, abc, ‚Äì7, et le nombre est de 100 caract√®res, car il sait que l'impl√©mentation de ces valeurs peut diff√©rer, mais pour 6 et 7, il est peu probable . <br><br>  Il n'est donc pas clair comment suivre le principe de "tester l'interface, pas l'impl√©mentation".  Vous ne pouvez pas simplement prendre, fermer les yeux et √©crire un test.  TDD essaie de r√©soudre ce probl√®me en partie.  La th√©orie sugg√®re d'introduire les classes d'√©quivalence une √† la fois et d'√©crire des tests pour elles.  J'ai lu beaucoup de livres et d'articles sur ce sujet, mais d'une mani√®re ou d'une autre √ßa ne colle pas.  Cependant, je suis d'accord avec la th√®se selon laquelle les tests devraient √™tre √©crits en premier.  Nous appelons ce test de principe en premier.  Nous n'avons pas TDD, et en relation avec ce qui pr√©c√®de, les tests ne sont pas √©crits avant la cr√©ation du code, mais en parall√®le avec lui. <br><br>  Je ne recommande certainement pas d'√©crire des tests r√©troactivement.  Apr√®s tout, ils influencent l'architecture, et si elle s'est d√©j√† install√©e, alors il est trop tard pour l'influencer - tout devra √™tre r√©√©crit.  En d'autres termes, la testabilit√© du code est une propri√©t√© distincte que le code devra <b>doter</b> , il ne le deviendra pas.  Par cons√©quent, nous essayons d'√©crire des tests avec du code.  Ne croyez pas aux histoires comme ¬´√©crivons un projet dans trois mois, puis couvrons tout avec des tests dans une semaine¬ª, cela n'arrivera jamais. <br><br>  La chose la plus importante √† comprendre: les tests unitaires ne sont pas un moyen de v√©rifier le code, pas un moyen de v√©rifier son exactitude.  Cela fait partie de votre architecture, de la conception de votre application.  Lorsque vous travaillez avec des tests unitaires, vous changez vos habitudes.  Les tests qui v√©rifient uniquement l'exactitude sont plut√¥t des tests d'acceptation.  Ce sera une erreur de penser que vous pouvez ensuite couvrir quelque chose avec des tests unitaires, ou qu'alors le code n'aura pas besoin d'√™tre v√©rifi√©. <br><br><h1>  Impl√©mentation de Python </h1><br>  Nous utilisons la biblioth√®que standard la plus unitaire de la famille xUnit.  L'histoire est la suivante: il y avait le langage SmallTalk, et en lui la biblioth√®que SUnit.  Tout le monde l'a aim√©, ils ont commenc√© √† le copier.  La biblioth√®que a √©t√© import√©e en Java sous le nom Junit, √† partir de l√† en C ++ sous le nom CppUnit et en Ruby sous le nom RUnit (puis elle a √©t√© renomm√©e RSpec).  Enfin, √† partir de Java, la biblioth√®que a ¬´migr√©¬ª vers Python sous le nom unittest.  Et ils l'ont import√© si litt√©ralement que m√™me CamelCase est rest√©, bien que cela ne corresponde pas √† PEP 8. <br><br>  √Ä propos de xUnit, il y a un merveilleux livre, ¬´xUnit Test Patterns¬ª.  Il d√©crit comment travailler avec les cadres de cette famille.  Le seul inconv√©nient du livre est sa taille: il est √©norme, mais environ 2/3 du contenu est un catalogue de motifs.  Et le premier tiers du livre est tout simplement merveilleux, c'est l'un des meilleurs livres sur l'informatique que j'ai rencontr√©. <br><br>  Un test unitaire est un code standard qui a une certaine architecture standard.  Tous les tests unitaires se composent de trois √©tapes: configuration, exercice et v√©rification.  Vous pr√©parez les donn√©es, ex√©cutez les tests et voyez si tout est dans le bon √©tat. <br><br><img src="https://habrastorage.org/webt/mi/ph/la/miphla26gfglcsjvog2giitgrko.jpeg"><br><br><h3>  Configuration </h3><br>  L'√©tape la plus difficile et int√©ressante.  Ramener le syst√®me √† son √©tat d'origine √† partir duquel vous souhaitez le tester peut √™tre tr√®s difficile.  Et l'√©tat du syst√®me peut √™tre arbitrairement complexe. <br><br>  Au moment o√π votre fonction est appel√©e, de nombreux √©v√©nements auraient pu se produire, un million d'objets auraient pu √™tre cr√©√©s en m√©moire.  Dans tous les composants associ√©s √† votre logiciel - dans le syst√®me de fichiers, la base de donn√©es, les caches - quelque chose est d√©j√† localis√©, et la fonction ne peut fonctionner que dans cet environnement.  Et si l'environnement n'est pas pr√©par√©, alors les actions de la fonction n'auront aucun sens. <br><br>  En g√©n√©ral, tout le monde pr√©tend que vous ne pouvez en aucun cas utiliser des syst√®mes de fichiers, des bases de donn√©es ou tout autre composant distinct, car cela rend votre test non modulaire, mais d'int√©gration.  √Ä mon avis, ce n'est pas vrai, car le test d'int√©gration est effectu√© par le test d'int√©gration.  Si vous utilisez certains composants non pas pour la v√©rification, mais simplement pour faire fonctionner le syst√®me, il n'y a rien de mal √† cela.  Votre code interagit avec de nombreux composants de l'ordinateur et du syst√®me d'exploitation.  Le seul probl√®me avec l'utilisation d'un syst√®me de fichiers ou d'une base de donn√©es est la vitesse. <br><br>  Directement dans le code, nous utilisons l' <b>injection de d√©pendances</b> .  Vous pouvez lancer des param√®tres dans la fonction au lieu des param√®tres par d√©faut.  Vous pouvez m√™me transf√©rer des liens vers des biblioth√®ques.  Ou vous pouvez glisser un talon au lieu d'une demande afin que le code des tests n'acc√®de pas au r√©seau.  Vous pouvez stocker des enregistreurs personnalis√©s dans les attributs de classe afin de ne pas √©crire sur le disque et gagner du temps. <br><br>  Pour les talons, nous utilisons la maquette habituelle de unittest.  Il existe √©galement une fonction de correctif qui, au lieu d'impl√©menter honn√™tement des d√©pendances, dit simplement: ¬´dans ce package, cette importation remplace une autre¬ª.  C'est pratique car vous n'avez rien √† jeter n'importe o√π.  Certes, il n'est pas clair qui a remplac√© quoi, alors utilisez-le soigneusement. <br><br>  Quant au syst√®me de fichiers, il est assez simple de simuler.  Il existe un module io avec <code>io.StringIO</code> et <code>io.BytesIO</code> .  Vous pouvez cr√©er des objets de type fichier qui n‚Äôacc√®dent pas r√©ellement au disque.  Mais si tout d'un coup cela ne vous suffit pas, alors il y a un merveilleux module tempfile avec des gestionnaires de contexte pour les fichiers temporaires, les r√©pertoires, les fichiers nomm√©s, n'importe quoi.  Tempfile est un supermodule si pour une raison quelconque IO ne vous convenait pas. <br><br>  Avec une base de donn√©es, tout est plus compliqu√©.  Il existe une recommandation standard: "N'utilisez pas une base r√©elle, mais fausse".  Je ne sais pas pour vous, mais dans ma vie je n'ai pas vu une seule base fausse et suffisamment fonctionnelle.  Chaque fois que je demandais des conseils sur ce qu'il fallait sp√©cifiquement prendre sous Python ou Perl, ils r√©pondaient que personne ne savait quoi que ce soit de pr√™t et proposaient d'√©crire quelque chose d'eux-m√™mes.  Je ne peux pas imaginer comment vous pouvez √©crire un √©mulateur, par exemple, PostgreSQL.  Une autre astuce: "puis obtenez SQLite."  Mais cela rompra l'isolement, car SQLite fonctionne avec le syst√®me de fichiers.  De plus, si vous utilisez quelque chose comme MySQL ou PostgreSQL, alors SQLite ne fonctionnera probablement pas.  S'il vous semble que vous n'utilisez pas les capacit√©s sp√©cifiques de produits sp√©cifiques, vous vous trompez probablement.  Certes, m√™me pour des choses courantes, telles que l'utilisation de dates, vous utilisez des fonctionnalit√©s sp√©cifiques que seul votre SGBD prend en charge. <br><br>  En cons√©quence, ils utilisent g√©n√©ralement une vraie base.  La solution n'est pas mauvaise, seulement nous devons montrer une certaine pr√©cision.  N'utilisez pas de base de donn√©es centralis√©e, car les tests peuvent se rompre entre eux.  Id√©alement, la base elle-m√™me devrait monter pendant les tests et s'arr√™ter apr√®s les tests. <br><br>  Une situation l√©g√®rement pire est lorsque vous devez ex√©cuter une base de donn√©es locale, qui sera utilis√©e.  Mais la question est de savoir comment les donn√©es y parviendront.  Nous avons d√©j√† dit qu'il doit y avoir un √©tat initial du syst√®me, il doit y avoir des donn√©es dans la base de donn√©es.  D'o√π ils viennent n'est pas une question facile. <br><br>  L'approche la plus na√Øve que j'ai rencontr√©e consiste √† utiliser une copie d'une v√©ritable base de donn√©es.  Une copie en a √©t√© r√©guli√®rement pr√©lev√©e, dont les donn√©es sensibles ont √©t√© supprim√©es.  Les auteurs ont estim√© que les donn√©es r√©elles sont les mieux adapt√©es aux tests.  De plus, l'√©criture de tests pour une copie d'une vraie base de donn√©es est un tourment.  Vous ne savez pas quelles donn√©es il y a.  Vous devez d'abord trouver sur quoi vous allez tester.  Si cette information n'est pas l√†, alors quoi faire n'est pas clair.  Il s'est av√©r√© que dans ce projet, ils ont d√©cid√© d'√©crire des tests pour le compte du service des op√©rations, qui ¬´ne changeront jamais¬ª.  Bien s√ªr, apr√®s un certain temps, elle a chang√©. <br><br>  Ceci est g√©n√©ralement suivi de la d√©cision: ¬´faisons un casting de la base r√©elle, copiez-la et ne synchronisez plus.  Ensuite, il sera possible d'√™tre li√© √† un objet sp√©cifique, de regarder ce qui s'y passe et d'√©crire des tests. ¬ª  La question se pose imm√©diatement: que se passera-t-il lorsque de nouvelles tables seront ajout√©es √† la base de donn√©es?  Apparemment, vous devrez saisir manuellement de fausses donn√©es. <br><br>  Mais comme nous le ferons de toute fa√ßon, pr√©parons imm√©diatement le casting de base manuellement.  Cette option est tr√®s similaire √† ce que l'on appelle g√©n√©ralement les fixtures dans Django: ils font un √©norme JSON, t√©l√©chargent des cas de test pour toutes les occasions, les envoient √† la base de donn√©es au d√©but des tests, et tout ira bien pour nous.  Cette approche pr√©sente √©galement de nombreux inconv√©nients.  Les donn√©es sont empil√©es en tas, on ne sait pas √† quel test elles se rapportent.  Personne ne peut comprendre si les donn√©es ont √©t√© supprim√©es ou non.  Et il y a des √©tats incompatibles de la base de donn√©es: par exemple, un test doit avoir aucun utilisateur dans la base de donn√©es, et l'autre pour les avoir.  Ces deux conditions ne peuvent pas √™tre stock√©es simultan√©ment dans le m√™me moule.  Dans ce cas, l'un des tests devra modifier la base de donn√©es.  Et comme vous devez encore g√©rer cela, il est plus facile de partir d'une base de donn√©es vide, de sorte que chaque test y mette les donn√©es n√©cessaires et, √† la fin du test, il efface la base de donn√©es.  Le seul inconv√©nient de cette approche est la difficult√© de cr√©er des donn√©es dans chaque test.  Dans l'un des projets o√π j'ai travaill√©, pour cr√©er un service, il fallait g√©n√©rer 8 entit√©s dans diff√©rentes tables: un service sur un compte personnel, un compte personnel sur un client, un client sur une entit√© juridique, une entit√© juridique dans une ville, un client dans une ville, etc.  Jusqu'√† ce que vous cr√©iez tout cela dans une cha√Æne, vous ne satisferez pas la cl√© √©trang√®re, rien ne fonctionne. <br><br>  Pour de telles situations, il existe des biblioth√®ques sp√©ciales qui facilitent grandement la vie.  Vous pouvez √©crire des outils auxiliaires, g√©n√©ralement appel√©s usines (ne pas confondre avec le mod√®le de conception).  Par exemple, nous avons utilis√© la biblioth√®que factory_boy, qui convient √† Django.  Il s'agit d'un clone de la biblioth√®que factory_girl, qui a √©t√© renomm√©e factory_bot l'ann√©e derni√®re pour des raisons d'exactitude politique.  √âcrire une telle biblioth√®que pour votre propre framework ne co√ªte rien.  Il est bas√© sur une id√©e tr√®s importante: vous cr√©ez une fabrique une fois pour les objets que vous souhaitez g√©n√©rer, √©tablissez des connexions pour celle-ci, puis dites √† l'utilisateur: ¬´lorsque vous √™tes cr√©√©, prenez un autre nom et g√©n√©rez vous-m√™me le groupe √† l'aide de la fabrique de groupe¬ª.  Et dans l'usine, tout est exactement pareil: g√©n√©rer le nom de telle mani√®re, les entit√©s li√©es telles ou telles. <br><br>  Par cons√©quent, une seule derni√®re ligne reste dans le code: <code>user = UserFactory()</code> .  L'utilisateur a √©t√© cr√©√©, et vous pouvez travailler avec lui, car sous le capot, il a g√©n√©r√© tout ce qui √©tait n√©cessaire.  Si vous le souhaitez, vous pouvez configurer quelque chose manuellement. <br><br>  Pour nettoyer les donn√©es apr√®s le test, nous utilisons des transactions triviales.  Au d√©but de chaque test, BEGIN est termin√©, le test fait quelque chose avec la base, et apr√®s le test, ROLLBACK est termin√©.  Si des transactions sont n√©cessaires dans le test lui-m√™me - par exemple, parce qu'il engage quelque chose de plus dans la base de donn√©es - il appelle la m√©thode que nous avons appel√©e <code>break_db</code> , indique au framework qu'il a cass√© la base de donn√©es, et le framework le relance.  Cela se fait lentement, mais comme il y a g√©n√©ralement tr√®s peu de tests qui n√©cessitent des transactions, tout est en ordre. <br><br><h3>  Exercice </h3><br>  Il n'y a rien de sp√©cial √† dire sur cette √©tape.  La seule chose qui peut mal tourner ici est de se tourner vers l'ext√©rieur, par exemple, vers Internet.  Pendant un certain temps, nous avons eu du mal avec cela administrativement: nous avons dit aux programmeurs que nous devons soit plonger les fonctions qui vont quelque part ou lancer des drapeaux sp√©ciaux pour que les fonctions ne le soient pas.  Si le test acc√®de √† etcd d'entreprise, ce n'est pas bon.  En cons√©quence, nous sommes arriv√©s √† la conclusion que tout √©tait gaspill√©: nous-m√™mes oublions constamment que certaines fonctions appellent une fonction qui appelle une fonction qui va √† etcd.  Par cons√©quent, dans le setUp de la classe de base, nous avons ajout√© le moki de tous les appels, c'est-√†-dire bloqu√© √† l'aide de stubs tous les appels o√π ils ne sont pas pass√©s. <br><br>  Les stubs peuvent √™tre facilement cr√©√©s √† l'aide de patchers, les mettre dans un dictionnaire s√©par√© et donner acc√®s √† tous les tests.  Par d√©faut, les tests ne peuvent aller nulle part, et si pour certains vous avez encore besoin d'ouvrir l'acc√®s, vous pouvez le rediriger.  Tr√®s confortable.  Jenkins n'enverra plus de SMS √† vos clients la nuit :) <br><br><h3>  V√©rifiez </h3><br>  √Ä ce stade, nous utilisons activement des assertions auto-√©crites, m√™me des lignes simples.  Si vous testez l'existence d'un fichier dans le test, alors au lieu d'affirmer <code>self.assertTrue(file_exists(f))</code> recommande d'√©crire affirmer <code>self.assertTrue(file_exists(f))</code> <code>not file exists</code> .  Holivar est li√© √† cela: dois-je continuer √† utiliser CamelCase dans les noms, comme dans unittest, ou dois-je suivre PEP 8?  Je n'ai pas de r√©ponse.  Si vous suivez PEP 8, alors dans le code de test, il y aura un g√¢chis de CamelCase et snake_case.  Et si vous utilisez CamelCase, cela ne correspond pas √† PEP 8. <br><br>  Et le dernier.  Supposons que vous ayez un code qui teste quelque chose et qu'il existe de nombreuses options de donn√©es sur lesquelles ce code doit √™tre ex√©cut√©.  Si vous utilisez py.test, vous pouvez ex√©cuter le m√™me test avec diff√©rentes donn√©es d'entr√©e.  Si vous n'avez pas py.test, vous pouvez utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un tel d√©corateur</a> .  Une table est pass√©e au d√©corateur, et un test se transforme en plusieurs autres, chacun testant l'un des cas. <br><br><h1>  Conclusion </h1><br>  Ne faites pas confiance aux articles et aux livres sans condition.  Si vous pensez qu'ils ont tort, il est possible qu'il en soit ainsi. <br><br>  N'h√©sitez pas √† utiliser des tests de d√©pendance.  Il n'y a rien de mal √† cela.  Si vous avez soulev√© memcached, car sans lui, votre code ne fonctionne pas normalement, √ßa va.  Mais il vaut mieux s'en passer, si possible. <br><br>  Faites attention aux usines.  C'est un sch√©ma tr√®s int√©ressant. <br><br>  PS Je vous invite √† la cha√Æne Telegram de mon auteur pour la programmation en Python - @pythonetc. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418929/">https://habr.com/ru/post/fr418929/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418919/index.html">A propos de la croissance professionnelle du designer et du travail avec stress. Et comment trouver de la force dans les moments les plus difficiles</a></li>
<li><a href="../fr418921/index.html">4 biblioth√®ques facilitant la vie d'un d√©veloppeur React</a></li>
<li><a href="../fr418923/index.html">PWA est juste</a></li>
<li><a href="../fr418925/index.html">Big Data - bro ou pas bro</a></li>
<li><a href="../fr418927/index.html">Amazon Dark Patterns</a></li>
<li><a href="../fr418931/index.html">RubyMine 2018.2: attacher un d√©bogueur √† des processus distants, chruby, une analyse de code am√©lior√©e et bien plus encore</a></li>
<li><a href="../fr418933/index.html">OnePlus Review 6. Quand les Chinois ont tout fait comme la derni√®re fois</a></li>
<li><a href="../fr418935/index.html">DZ Online Tech: ABBYY. Comment ne pas se confondre dans les r√©seaux de neurones?</a></li>
<li><a href="../fr418937/index.html">C√©l√©bration du 8e anniversaire avec une premi√®re sortie √† GeekUniversity</a></li>
<li><a href="../fr418941/index.html">N'ayez pas peur du microservice: Alexey Baitov sur l'utilisation de l'architecture des microservices dans la pratique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>