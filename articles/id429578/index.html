<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙏🏾 ☘️ 🦍 Kesalahan apa yang disembunyikan dalam kode Infer.NET? 🎅🏽 🍧 📙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publikasi kode sumber Microsoft untuk proyek-proyeknya adalah alasan yang bagus untuk memverifikasinya. Kali ini tidak terkecuali, dan hari ini kita m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kesalahan apa yang disembunyikan dalam kode Infer.NET?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/429578/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d3f/18a/6a6/d3f18a6a6127aceeae10d53591e0ce65.png"></div><br>  Publikasi kode sumber Microsoft untuk proyek-proyeknya adalah alasan yang bagus untuk memverifikasinya.  Kali ini tidak terkecuali, dan hari ini kita melihat tempat mencurigakan yang ditemukan dalam kode Infer.NET.  Turun dengan anotasi - langsung ke intinya! <br><a name="habracut"></a><br><h2>  Sedikit tentang proyek dan penganalisa </h2><br>  Infer.NET adalah sistem pembelajaran mesin yang dikembangkan oleh para spesialis dari Microsoft.  Kode sumber proyek baru-baru ini tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> , yang merupakan alasan untuk verifikasi.  Rincian lebih lanjut tentang proyek ini dapat ditemukan, misalnya, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Proyek ini diperiksa dengan menggunakan statis static analyzer PVS-Studio versi 6.26.  Biarkan saya mengingatkan Anda bahwa PVS-Studio sedang mencari kesalahan dalam kode di C \ C ++ \ C # (dan segera di Jawa) di bawah Windows, Linux, macOS.  Kode C # sejauh ini kami hanya menganalisis di bawah Windows.  Penganalisa dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diunduh dan dicoba</a> pada proyek Anda. <br><br>  Cek itu sendiri sangat sederhana dan tanpa masalah.  Sebelumnya, saya membongkar proyek dari GitHub, memulihkan paket yang diperlukan (dependensi), dan memastikan bahwa proyek tersebut berhasil dibangun.  Ini diperlukan agar penganalisa memiliki akses ke semua informasi yang diperlukan untuk analisis penuh.  Setelah berkumpul dalam beberapa klik, saya meluncurkan analisis solusi melalui plugin PVS-Studio untuk Visual Studio. <br><br>  Omong-omong, ini bukan proyek pertama dari Microsoft yang diuji menggunakan PVS-Studio - ada yang lain: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Roslyn</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MSBuild</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PowerShell</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CoreFX</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lainnya</a> . <br><br>  <b>Catatan</b>  Jika Anda atau kenalan Anda tertarik untuk menganalisis kode Java, Anda dapat menulis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dukungan</a> kepada kami dengan memilih "Saya ingin penganalisis untuk Java".  Tidak ada versi beta publik dari penganalisis, tetapi harus segera tersedia.  Di suatu tempat di laboratorium rahasia (melalui dinding), para pria secara aktif mengerjakannya. <br><br>  Tapi cukup bicara abstrak - mari kita lihat masalah dalam kode. <br><br><h2>  Apakah ini bug atau fitur? </h2><br>  Saya sarankan mencoba menemukan kesalahan sendiri - tugas yang sepenuhnya bisa diselesaikan.  Tidak ada lelucon dalam semangat apa yang ada dalam artikel " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">10 Kesalahan Teratas dalam Proyek C ++ untuk 2017</a> ", jujur.  Jadi, jangan buru-buru membaca penganalisis yang diberikan setelah cuplikan kode. <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MergeParallelTransitions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( transition1.DestinationStateIndex == transition2.DestinationStateIndex &amp;&amp; transition1.Group == transition2.Group) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transition1.IsEpsilon &amp;&amp; transition2.IsEpsilon) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!transition1.IsEpsilon &amp;&amp; !transition2.IsEpsilon) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsInfinity(transition1.Weight.Value) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsInfinity(transition1.Weight.Value)) { newElementDistribution.SetToSum( <span class="hljs-number"><span class="hljs-number">1.0</span></span>, transition1.ElementDistribution, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, transition2.ElementDistribution); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { newElementDistribution.SetToSum( transition1.Weight.Value, transition1.ElementDistribution, transition2.Weight.Value, transition2.ElementDistribution); } .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3001</a> Ada sub-ekspresi identik 'ganda.IsInfinity (transition1Weight.Value)' di sebelah kiri dan di sebelah kanan operator '&amp;&amp;'.  Runtime Automaton.Simplification.cs 479 <br><br>  Seperti yang Anda lihat dari potongan kode, metode ini bekerja dengan sepasang variabel - <i>transition1</i> dan <i>transition2</i> .  Penggunaan nama-nama yang mirip kadang-kadang cukup dibenarkan, tetapi perlu diingat bahwa dalam kasus ini kemungkinan tidak sengaja membuat kesalahan di suatu tempat dengan peningkatan nama. <br><br>  Inilah <i>yang</i> terjadi ketika memeriksa angka untuk infinity ( <i>double.IsInfinity</i> ).  Karena kesalahan, kami memeriksa nilai variabel yang sama 2 kali - <i>transition1Weight.Value</i> .  Nilai yang dicentang di subekspresi kedua adalah variabel <i>transition2Weight.Value</i> . <br><br>  Kode mencurigakan serupa lainnya. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> MethodBase </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToMethodInternal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IMethodReference imr</span></span></span><span class="hljs-function">)</span></span> { .... bf |= BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance; .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3001</a> Ada sub-ekspresi yang identik 'BindingFlags.Public' di sebelah kiri dan di sebelah kanan '|'  operator.  Kompiler CodeBuilder.cs 194 <br><br>  Saat membentuk nilai variabel <i>bf</i> , elemen enumerasi <i>BindingFlags.Public</i> digunakan dua kali.  Entah kode ini berisi operasi penandaan tambahan, atau alih-alih penggunaan <i>BindingFlags.Public yang</i> kedua <i>,</i> harus ada nilai enumerasi yang berbeda. <br><br>  Omong-omong, dalam kode sumber kode ini ditulis pada satu baris.  Sepertinya saya bahwa jika diformat dalam gaya tabel (seperti di sini), masalahnya lebih mudah untuk dideteksi. <br><br>  Mari kita lanjutkan.  Saya membawa seluruh tubuh metode dan sekali lagi saya sarankan Anda menemukan kesalahan (atau mungkin kesalahan) sendiri. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachPrefix</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IExpression expr, Action&lt;IExpression&gt; action</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// This method must be kept consistent with GetTargets. if (expr is IArrayIndexerExpression) ForEachPrefix(((IArrayIndexerExpression)expr).Target, action); else if (expr is IAddressOutExpression) ForEachPrefix(((IAddressOutExpression)expr).Expression, action); else if (expr is IPropertyReferenceExpression) ForEachPrefix(((IPropertyReferenceExpression)expr).Target, action); else if (expr is IFieldReferenceExpression) { IExpression target = ((IFieldReferenceExpression)expr).Target; if (!(target is IThisReferenceExpression)) ForEachPrefix(target, action); } else if (expr is ICastExpression) ForEachPrefix(((ICastExpression)expr).Expression, action); else if (expr is IPropertyIndexerExpression) ForEachPrefix(((IPropertyIndexerExpression)expr).Target, action); else if (expr is IEventReferenceExpression) ForEachPrefix(((IEventReferenceExpression)expr).Target, action); else if (expr is IUnaryExpression) ForEachPrefix(((IUnaryExpression)expr).Expression, action); else if (expr is IAddressReferenceExpression) ForEachPrefix(((IAddressReferenceExpression)expr).Expression, action); else if (expr is IMethodInvokeExpression) ForEachPrefix(((IMethodInvokeExpression)expr).Method, action); else if (expr is IMethodReferenceExpression) ForEachPrefix(((IMethodReferenceExpression)expr).Target, action); else if (expr is IUnaryExpression) ForEachPrefix(((IUnaryExpression)expr).Expression, action); else if (expr is IAddressReferenceExpression) ForEachPrefix(((IAddressReferenceExpression)expr).Expression, action); else if (expr is IDelegateInvokeExpression) ForEachPrefix(((IDelegateInvokeExpression)expr).Target, action); action(expr); }</span></span></code> </pre> <br>  Apakah kamu sudah menemukan?  Kami sedang memeriksa! <br><br>  <b>Peringatan PVS-Studio</b> : <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3003</a> Penggunaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pola</a> 'jika (A) {...} else jika (A) {...}' terdeteksi.  Ada kemungkinan kehadiran kesalahan logis.  Periksa baris: 1719, 1727. Kompiler CodeRecognizer.cs 1719 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3003</a> Penggunaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pola</a> 'jika (A) {...} else jika (A) {...}' terdeteksi.  Ada kemungkinan kehadiran kesalahan logis.  Periksa baris: 1721, 1729. Kompiler CodeRecognizer.cs 1721 </li></ul><br>  Sederhanakan kode ini untuk membuat masalahnya lebih jelas. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachPrefix</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IExpression expr, Action&lt;IExpression&gt; action</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expr <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> IUnaryExpression) ForEachPrefix(((IUnaryExpression)expr).Expression, action); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expr <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> IAddressReferenceExpression) ForEachPrefix(((IAddressReferenceExpression)expr).Expression, action); .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expr <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> IUnaryExpression) ForEachPrefix(((IUnaryExpression)expr).Expression, action); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (expr <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> IAddressReferenceExpression) ForEachPrefix(((IAddressReferenceExpression)expr).Expression, action) .... }</code> </pre> <br>  Ekspresi bersyarat dan <i>kemudian</i> cabang beberapa <i>jika pernyataan</i> digandakan.  Mungkin kode ini ditulis menggunakan metode salin-rekat, itulah sebabnya masalah muncul.  Sekarang ternyata cabang saat itu dari duplikat tidak akan pernah dieksekusi, karena: <br><br><ul><li>  jika ekspresi kondisional benar, tubuh <i>pernyataan if</i> pertama dari pasangan yang sesuai dijalankan; </li><li>  jika ekspresi kondisional salah dalam kasus pertama, itu akan salah dalam yang kedua. </li></ul><br>  Karena cabang saat itu berisi tindakan yang sama, sekarang terlihat seperti kode yang berlebihan yang membingungkan.  Ada kemungkinan bahwa ini adalah jenis masalah yang berbeda - alih-alih mengambil, pemeriksaan lain seharusnya dilakukan. <br><br>  Kami melanjutkan. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Compare</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Pair&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; x, Pair&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; y</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x.First &lt; y.First) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x.Second &gt;= y.Second) { <span class="hljs-comment"><span class="hljs-comment">// y strictly contains x return 1; } else { // No containment - order by left bound return 1; } } else if (x.First &gt; y.First) { if (x.Second &lt;= y.Second) { // x strictly contains y return -1; } else { // No containment - order by left bound return -1; } } .... }</span></span></code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3004</a> Pernyataan 'lalu' setara dengan pernyataan 'lain'.  Runtime RegexpTreeBuilder.cs 1080 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3004</a> Pernyataan 'lalu' setara dengan pernyataan 'lain'.  Runtime RegexpTreeBuilder.cs 1093 </li></ul><br>  Kode terlihat sangat mencurigakan, karena berisi dua pernyataan bersyarat dengan badan yang identik dari cabang <i>saat itu</i> dan yang <i>lain</i> .  Dalam kedua kasus, mungkin layak mengembalikan nilai yang berbeda.  Atau, jika ini adalah perilaku yang dikandung, akan berguna untuk menghapus pernyataan bersyarat yang berlebihan. <br><br>  Ada siklus yang menarik.  Contoh di bawah ini: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Set&lt;StochasticityPattern&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IntersectPatterns</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;StochasticityPattern&gt; patterns</span></span></span><span class="hljs-function">)</span></span> { Set&lt;StochasticityPattern&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Set&lt;StochasticityPattern&gt;(); result.AddRange(patterns); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> changed; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = result.Count; AddIntersections(result); changed = (result.Count != count); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (changed); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3020</a> 'break' tanpa syarat dalam satu loop.  Kompiler DefaultFactorManager.cs 474 <br><br>  Karena pernyataan <i>break</i> tanpa syarat, tepat satu iterasi dari loop dilakukan, dan variabel kontrol <i>berubah</i> bahkan tidak digunakan.  Secara umum, kode itu terlihat aneh dan mencurigakan. <br><br>  Metode yang sama (salinan persis) ditemukan di kelas lain.  Peringatan analisa yang sesuai: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3020</a> 'Istirahat' tanpa syarat dalam satu loop.  Visualizers.Windows FactorManagerView.cs 350 <br><br>  Ngomong-ngomong, sebuah metode bertemu dengan pernyataan <i>terus</i> tanpa syarat dalam satu lingkaran (penganalisa menemukannya dengan diagnostik yang sama), tetapi ada komentar di atasnya yang mengkonfirmasi bahwa ini adalah solusi sementara khusus: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// TEMPORARY continue;</span></span></code> </pre> <br>  Saya ingat bahwa tidak ada komentar semacam itu di dekat pernyataan <i>break</i> tanpa syarat. <br><br>  Mari kita lanjutkan. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DependencyInformation </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDependencyInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... IExpression resultIndex = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resultIndex != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parameter.IsDefined( <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(SkipIfMatchingIndexIsUniformAttribute), <span class="hljs-literal"><span class="hljs-literal">false</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (resultIndex == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InferCompilerException( parameter.Name + <span class="hljs-string"><span class="hljs-string">" has SkipIfMatchingIndexIsUniformAttribute but "</span></span> + StringUtil.MethodNameToString(method) + <span class="hljs-string"><span class="hljs-string">" has no resultIndex parameter"</span></span>); .... } .... } .... }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Peringatan</a> <b>PVS-Studio</b> : Ekspresi V3022 'resultIndex == null' selalu salah.  Compiler FactorManager.cs 382 <br><br>  Segera, saya perhatikan bahwa antara deklarasi dan verifikasi di atas, nilai variabel <i>resultIndex</i> dapat berubah.  Namun, antara cek <i>resultIndex! = Null</i> dan <i>resultIndex == null,</i> nilainya tidak dapat diubah.  Oleh karena itu, hasil dari ekspresi <i>resultIndex == null</i> akan selalu <i>salah</i> , yang berarti bahwa pengecualian tidak akan pernah dilempar. <br><br>  Saya harap Anda memiliki minat dalam menemukan kesalahan sendiri, tanpa saran saya, untuk menemukan masalah, tetapi untuk berjaga-jaga, saya akan mengusulkan untuk melakukannya lagi.  Kode metode kecil, saya akan memberikannya secara keseluruhan. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Tuple&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">, </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeMovieGenre</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> feature</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] genres = feature.Split(<span class="hljs-string"><span class="hljs-string">'|'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (genres.Length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; genres.Length &gt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentException(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"Movies should have between 1 and 3 genres; given {0}."</span></span>, genres.Length)); } <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-number"><span class="hljs-number">1.0</span></span> / genres.Length; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder( <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"{0}:{1}"</span></span>, offset + MovieGenreBuckets[genres[<span class="hljs-number"><span class="hljs-number">0</span></span>]], <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; genres.Length; ++i) { result.Append( <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format( <span class="hljs-string"><span class="hljs-string">"|{0}:{1}"</span></span>, offset + MovieGenreBuckets[genres[i].Trim()], <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tuple&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(MovieGenreBucketCount, result.ToString()); }</code> </pre> <br>  Mari kita lihat apa yang terjadi di sini.  String input diuraikan oleh karakter '|'.  Jika panjang array tidak seperti yang diharapkan, pengecualian harus dibuang.  <i>Tunggu sebentar</i> ... <i>genre</i> . <i>Panjang &lt;1 &amp;&amp; genre. Panjang&gt; 3</i> ?  Karena tidak ada angka yang langsung jatuh ke dalam rentang nilai yang diperlukan oleh ekspresi ( <i>[int.MinValue..1)</i> dan <i>(3..int.MaxValue]</i> ), hasil dari ekspresi akan selalu <i>salah</i> .  Oleh karena itu, pemeriksaan ini tidak melindungi terhadap apa pun, dan pengecualian yang diharapkan tidak akan dibuang. <br><br>  Inilah yang persisnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diingatkan</a> oleh penganalisa: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3022</a> Ekspresi 'genre. Panjang &lt;1 &amp;&amp; genre. Panjang&gt; 3' selalu salah.  Mungkin '||'  Operator harus digunakan di sini.  Fitur Evaluator.cs 242 <br><br>  Operasi fisi yang mencurigakan bertemu. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateTrueThetaAndPhi</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> expectedRepeatOfTopicInDoc = averageDocLength / numUniqueTopicsPerDoc; .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cnt = Poisson.Sample(expectedRepeatOfTopicInDoc); .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3041</a> Ungkapan itu secara implisit dilemparkan dari tipe 'int' ke tipe 'double'.  Pertimbangkan untuk menggunakan pemeran tipe eksplisit untuk menghindari hilangnya bagian fraksional.  Contoh: double A = (double) (X) / Y;  LDA Utilities.cs 74 <br><br>  Ini mencurigakan di sini: pembagian integer dilakukan (variabel <i>averageDocLength</i> dan <i>numUniqueTopicsPerDoc</i> bertipe <i>int</i> ), dan hasilnya ditulis ke variabel bertipe <i>double</i> .  Pertanyaannya adalah: apakah ini dilakukan secara khusus, atau apakah pembagian bilangan real masih tersirat?  Jika variabel <i>diharapkanRepeatOfTopicInDoc</i> bertipe <i>int</i> , ini akan menjernihkan kemungkinan pertanyaan. <br><br>  Di tempat lain, metode <i>Poisson.Sample</i> , argumen yang merupakan variabel mencurigakan yang <i>diharapkanRepeatOfTopicInDoc</i> , digunakan, misalnya, seperti dijelaskan di bawah ini. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numUniqueWordsPerTopic = Poisson.Sample((<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)averageWordsPerTopic);</code> </pre> <br>  <i>averageWordsPerTopic</i> adalah tipe <i>int</i> , yang sudah dikonversi menjadi <i>dua kali lipat</i> di tempat penggunaan. <br><br>  Dan berikut ini adalah tempat penggunaan lainnya: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> expectedRepeatOfWordInTopic = ((<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)numDocs) * averageDocLength / numUniqueWordsPerTopic; .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cnt = Poisson.Sample(expectedRepeatOfWordInTopic);</code> </pre> <br>  Harap perhatikan bahwa variabel memiliki nama yang sama seperti dalam contoh asli, hanya pembagian bilangan real yang digunakan untuk menginisialisasi <i>ekspektasiRepeatOfWordInTopic</i> (karena konversi eksplisit <i>numDocs</i> menjadi <i>dua kali lipat</i> ). <br><br>  Secara umum, ada baiknya melihat tempat awal di mana analis mengeluarkan peringatan. <br><br>  Tetapi refleksi tentang apakah itu layak diedit dan bagaimana, biarkan penulis kode (mereka tahu lebih baik), tetapi mari kita melangkah lebih jauh.  Ke divisi mencurigakan berikutnya. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NonconjugateGaussian </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BAverageLogarithm</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> v_opt = <span class="hljs-number"><span class="hljs-number">2</span></span> / <span class="hljs-number"><span class="hljs-number">3</span></span> * (Math.Log(mx * mz / Ex2 / <span class="hljs-number"><span class="hljs-number">2</span></span>) - m); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (v_opt != v) { .... } .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3041</a> Ungkapan itu secara implisit dilemparkan dari tipe 'int' ke tipe 'double'.  Pertimbangkan untuk menggunakan pemeran tipe eksplisit untuk menghindari hilangnya bagian fraksional.  Contoh: double A = (double) (X) / Y;  Runtime ProductExp.cs 137 <br><br>  Penganalisa lagi mendeteksi operasi mencurigakan dari divisi integer, seperti  <i>2</i> dan <i>3</i> adalah bilangan literer bilangan bulat, dan hasil dari ekspresi 2/3 adalah <i>0</i> .  Hasilnya, seluruh ekspresi berbentuk: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> v_opt = <span class="hljs-number"><span class="hljs-number">0</span></span> * expr;</code> </pre> <br>  Setuju, sedikit aneh.  Beberapa kali saya kembali ke peringatan ini, mencoba menemukan semacam tangkapan, dan tidak mencoba menambahkannya ke artikel.  Metode ini dipenuhi dengan matematika dan berbagai formula (yang, sejujurnya, saya tidak benar-benar ingin membongkar), Anda tidak pernah tahu apa yang diharapkan.  Selain itu, saya mencoba untuk menjadi skeptis mungkin tentang peringatan yang saya tulis di artikel, dan saya menggambarkannya hanya setelah mempelajarinya dengan lebih baik. <br><br>  Tapi kemudian saya sadar - mengapa saya perlu faktor <i>0</i> , ditulis sebagai <i>2/3</i> ?  Jadi tempat ini layak untuk dilihat. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteAttribute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TextWriter writer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> defaultValue, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Func&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; converter = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( defaultValue == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Equals(defaultValue)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> stringValue = converter == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.ToString() : converter(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); writer.Write(<span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{name}</span></span></span><span class="hljs-string">=\"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{stringValue}</span></span></span><span class="hljs-string">\" "</span></span>); }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3080</a> Kemungkinan null dereference.  Pertimbangkan untuk memeriksa 'nilai'.  Kompiler WriteHelpers.cs 78 <br><br>  Penegasan analisis yang cukup adil berdasarkan kondisi.  Referensi referensi nol dapat terjadi pada nilai ekspresi. <i>Setara (</i> nilai <i>default)</i> jika <i>nilai == nol</i> .  Karena ungkapan ini adalah operan kanan operator | |, untuk menghitungnya, operan kiri harus <i>salah</i> , dan untuk ini sudah cukup bahwa setidaknya salah satu variabel <i>nilai</i> <i>defaultValue</i> \ <i>nilai</i> tidak <i>nol</i> .  Akibatnya, jika <i>defaultValue! = Null</i> , dan <i>nilai == null</i> : <br><br><ul><li>  <i>defaultValue == null</i> -&gt; <i>false</i> ; </li><li>  <i>defaultValue == null &amp;&amp; value == null</i> -&gt; <i>false</i> ;  (pemeriksaan <i>nilai</i> tidak terjadi) </li><li>  <i>value.Equals (defaultValue)</i> -&gt; <i>NullReferenceException</i> , karena <i>nilainya</i> <i>nol</i> . </li></ul><br>  Mari kita lihat kasus serupa: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FeatureParameterDistribution</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> GaussianMatrix traitFeatureWeightDistribution, GaussianArray biasFeatureWeightDistribution</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert( (traitFeatureWeightDistribution == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; biasFeatureWeightDistribution == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) || traitFeatureWeightDistribution.All( w =&gt; w != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; w.Count == biasFeatureWeightDistribution.Count), <span class="hljs-string"><span class="hljs-string">"The provided distributions should be valid and consistent in the number of features."</span></span>); .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3080</a> Kemungkinan null dereference.  Pertimbangkan untuk memeriksa 'traitFeatureWeightDistribution'.  Fitur RekomendasiParameterDistribution.cs 65 <br><br>  Kami membuang kelebihan, hanya menyisakan logika untuk menghitung nilai Boolean, sehingga lebih mudah untuk mencari tahu: <br><br><pre> <code class="cs hljs">(traitFeatureWeightDistribution == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; biasFeatureWeightDistribution == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) || traitFeatureWeightDistribution.All( w =&gt; w != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; w.Count == biasFeatureWeightDistribution.Count)</code> </pre> <br>  Sekali lagi, operan kanan ||  Ini dihitung hanya jika hasil perhitungan kiri <i>salah</i> .  Operan kiri bisa <i>salah</i> , termasuk ketika <i>traitFeatureWeightDistribution == null</i> dan <i>biasFeatureWeightDistribution! = Null</i> .  Maka operan yang tepat dari operator || akan dihitung, dan panggilan ke <i>traitFeatureWeightDistribution. Semua</i> akan <i>menaikkan</i> <i>ArgumentNullException</i> . <br><br>  Sepotong kode menarik lainnya: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetQuantile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> probability, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] quantiles</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n = quantiles.Length; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (quantiles == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(quantiles)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentException(<span class="hljs-string"><span class="hljs-string">"quantiles array is empty"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(quantiles)); .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3095 Objek</a> 'quantiles' digunakan sebelum diverifikasi dengan null.  Periksa baris: 91, 92. Runtime OuterQuantiles.cs 91 <br><br>  Perhatikan bahwa properti <i>quantiles.Length pertama kali diakses</i> , dan kemudian <i>quantiles</i> diperiksa untuk <i>null</i> .  Akibatnya, jika <i>kuantil == nol</i> , metode ini akan melempar pengecualian, hanya sedikit salah, dan sedikit tidak sesuai dengan yang dibutuhkan.  Rupanya, mereka mengacaukan garis di beberapa tempat. <br><br>  Jika Anda berhasil menangani deteksi kesalahan sebelumnya sendiri, saya sarankan Anda menyeduh secangkir kopi dan mencoba mengulanginya, menemukan kesalahan dalam metode di bawah ini.  Untuk membuatnya sedikit lebih menarik, saya mengutip seluruh kode metode ini. <br><br>  ( <a href="">Tautan ke ukuran penuh</a> ) <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c2c/5ff/2d9/c2c5ff2d99aca64bbda4136acfa4b1d4.png" alt="Gambar 2"></p><br><br>  Oke, oke, itu lelucon (atau apakah Anda berhasil?!).  Mari sederhanakan tugasnya: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sample.Precision &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { precisionIsBetween = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; lowerBound = <span class="hljs-number"><span class="hljs-number">-1.0</span></span> / v; upperBound = -mean.Precision; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sample.Precision &lt; -mean.Precision) { precisionIsBetween = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; lowerBound = <span class="hljs-number"><span class="hljs-number">0</span></span>; upperBound = -mean.Precision; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// in this case, the precision should NOT be in this interval. precisionIsBetween = false; lowerBound = -mean.Precision; lowerBound = -1.0 / v; }</span></span></code> </pre> <br>  Apakah semakin baik?  Penganalisis mengeluarkan peringatan berikut untuk kode ini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3008 Variabel</a> 'lowerBound' ditugaskan nilai dua kali berturut-turut.  Mungkin ini sebuah kesalahan.  Periksa baris: 324, 323. Runtime GaussianOp.cs 324 <br><br>  Memang, di cabang yang <i>lain</i> terakhir, nilai variabel <i>lowerBound</i> ditugaskan dua kali berturut-turut.  Rupanya (dan dilihat dari kode di atas), variabel <i>upperBound</i> harus terlibat dalam salah satu tugas. <br><br>  Kami mengikuti lebih jauh. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteAucMatrix</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = <span class="hljs-number"><span class="hljs-number">0</span></span>; c &lt; classLabelCount; c++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> labelWidth = labels[c].Length; columnWidths[c + <span class="hljs-number"><span class="hljs-number">1</span></span>] = labelWidth &gt; MaxLabelWidth ? MaxLabelWidth : labelWidth; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> r = <span class="hljs-number"><span class="hljs-number">0</span></span>; r &lt; classLabelCount; r++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> countWidth = MaxValueWidth; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (countWidth &gt; columnWidths[c + <span class="hljs-number"><span class="hljs-number">1</span></span>]) { columnWidths[c + <span class="hljs-number"><span class="hljs-number">1</span></span>] = countWidth; } } .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3081 Penghitung</a> 'r' tidak digunakan di dalam loop bersarang.  Pertimbangkan untuk memeriksa penggunaan penghitung 'c'.  CommandLine ClassifierEvaluationModule.cs 459 <br><br>  Harap dicatat bahwa penghitung loop dalam - <i>r</i> - tidak digunakan dalam tubuh loop ini.  Karena itu, ternyata selama semua iterasi loop dalam operasi yang sama dilakukan pada elemen yang sama - setelah semua, indeks juga menggunakan counter loop luar ( <i>c</i> ), dan bukan dalam ( <i>r</i> ). <br><br>  Mari kita lihat apa lagi yang menurut saya menarik. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RegexpFormattingSettings</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> putOptionalInSquareBrackets, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> showAnyElementAsQuestionMark, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ignoreElementDistributionDetails, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> truncationLength, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> escapeCharacters, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> useLazyQuantifier</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.PutOptionalInSquareBrackets = putOptionalInSquareBrackets; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ShowAnyElementAsQuestionMark = showAnyElementAsQuestionMark; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.IgnoreElementDistributionDetails = ignoreElementDistributionDetails; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.TruncationLength = truncationLength; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.EscapeCharacters = escapeCharacters; }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Parameter</a> konstruktor V3117 'useLazyQuantifier' tidak digunakan.  Runtime RegexpFormattingSettings.cs 38 <br><br>  Konstruktor tidak menggunakan satu parameter - <i>useLazyQuantifier</i> .  Ini terlihat sangat mencurigakan dengan latar belakang fakta bahwa properti dengan nama dan tipe yang sesuai didefinisikan di kelas - <i>UseLazyQuantifier</i> .  Rupanya, mereka lupa menginisialisasi melalui parameter yang sesuai. <br><br>  Bertemu dengan beberapa penangan acara yang berpotensi berbahaya.  Contoh salah satunya diberikan di bawah ini: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RecommenderRun</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> EventHandler Started; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Report that the run has been started if (this.Started != null) { this.Started(this, EventArgs.Empty); } .... } .... }</span></span></code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3083</a> Doa yang tidak aman dari acara 'Dimulai', NullReferenceException dimungkinkan.  Pertimbangkan menugaskan acara ke variabel lokal sebelum menjalankannya.  Evaluator RecommenderRun.cs 115 <br><br>  Faktanya adalah bahwa antara cek untuk ketidaksetaraan <i>nol</i> dan panggilan dari pawang, suatu peristiwa dapat berhenti berlangganan, dan jika acara tersebut tidak memiliki pelanggan pada saat antara cek untuk <i>nol</i> dan panggilan dari penangan, <i>NullReferenceException</i> akan <i>dilemparkan</i> .  Untuk menghindari masalah seperti itu, misalnya, Anda dapat menyimpan tautan ke rantai delegasi dalam variabel lokal atau menggunakan operator '?.'  untuk memanggil penangan. <br><br>  Selain potongan kode di atas, ada 35 tempat seperti itu. <br><br>  Omong-omong, <b>785</b> peringatan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3024</a> juga dipenuhi.  Peringatan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3024</a> dikeluarkan saat membandingkan bilangan real menggunakan operator '! =' Atau '=='.  Saya tidak akan membahas mengapa perbandingan seperti itu tidak selalu benar - lebih lanjut tentang ini ditulis dalam dokumentasi, ada juga tautan ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">StackOverflow</a> (ini dia). <br><br>  Mempertimbangkan bahwa formula dan perhitungan sering dipenuhi, peringatan ini juga dapat menjadi penting, meskipun mereka dibawa ke level 3 (karena mereka jauh dari relevan di semua proyek). <br><br>  Jika Anda yakin bahwa peringatan ini tidak relevan, Anda dapat menghapusnya dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hampir satu klik</a> , mengurangi total operasi penganalisa. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/47e/77b/72d/47e77b72dbb716dadbd1623513150819.png"></div><br><br><h2>  Kesimpulan </h2><br>  Entah bagaimana ternyata untuk waktu yang lama saya belum menulis artikel tentang memeriksa proyek, dan menyentuh proses ini lagi cukup menyenangkan.  Saya harap Anda juga mempelajari sesuatu yang baru / bermanfaat dari artikel ini, atau setidaknya membacanya dengan penuh minat. <br><br>  Saya berharap para pengembang melakukan koreksi awal terhadap area masalah dan saya mengingatkan Anda bahwa membuat kesalahan adalah hal yang normal, namun kami adalah orang-orang.  Untuk ini, alat tambahan seperti analisa statis diperlukan untuk menemukan apa yang dilewatkan seseorang, bukan?  Pokoknya - semoga sukses dengan proyek ini, dan terima kasih untuk pekerjaannya! <br><br>  Dan ingatlah bahwa manfaat maksimum dari penganalisa statis dicapai dengan <i>penggunaan regulernya</i> . <br><br>  Semua yang terbaik! <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br>  Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Sergey Vasiliev.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apa Kesalahan Mengintai di Kode Infer.NET?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id429578/">https://habr.com/ru/post/id429578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id429564/index.html">"Saya hanya penggemar proyek dan pengguna bahasa Dart" - wawancara dengan Ari Lerner, penulis buku terkenal</a></li>
<li><a href="../id429568/index.html">Kurangi downtime Zimbra selama server mogok dengan Zextras Backup</a></li>
<li><a href="../id429570/index.html">Mengajar agen untuk bermain Mario Kart dengan filter</a></li>
<li><a href="../id429572/index.html">Mencegah percakapan pribadi di Skype menggunakan Devicelock DLP</a></li>
<li><a href="../id429574/index.html">Gratis Check Point untuk Kursus Pemula di CheckMates</a></li>
<li><a href="../id429580/index.html">Interaksi mikro di iOS. Kuliah Yandex</a></li>
<li><a href="../id429582/index.html">Indikator analog beban komputer</a></li>
<li><a href="../id429586/index.html">Cara menentukan waktu terbaik untuk berdagang di bursa</a></li>
<li><a href="../id429588/index.html">Seluruh kebenaran tentang RTOS. Artikel # 20. Semaphores: Layanan Tambahan dan Struktur Data</a></li>
<li><a href="../id429590/index.html">Analisis suara untuk pusat panggilan berbasis SOLR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>