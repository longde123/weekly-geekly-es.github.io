<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💎 🤝 👨🏾‍🤝‍👨🏼 Pengujian statis atau simpan Private Ryan 🏨 🐷 👧🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebuah rilis sering merayap tanpa diketahui. Dan kesalahan apa pun yang tiba-tiba ditemukan di hadapannya mengancam kita dengan perubahan tenggat wakt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengujian statis atau simpan Private Ryan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/playrix/blog/452926/">  Sebuah rilis sering merayap tanpa diketahui.  Dan kesalahan apa pun yang tiba-tiba ditemukan di hadapannya mengancam kita dengan perubahan tenggat waktu, perbaikan terbaru, pekerjaan hingga pagi hari dan menghabiskan waktu dengan gelisah.  Ketika terburu-buru seperti itu mulai terjadi secara sistematis, kami menyadari bahwa Anda tidak bisa hidup seperti itu lagi.  Diputuskan untuk mengembangkan sistem validasi komprehensif untuk menyelamatkan pengembang <s>Ryan</s> Artyom biasa, yang pulang sebelum dirilis pada jam 9 malam, atau jam 10, atau jam 11 ... yah, Anda mengerti.  Idenya adalah untuk pengembang untuk mencari tahu tentang kesalahan, sementara perubahan belum mencapai repositori, dan dia sendiri belum kehilangan konteks tugas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e0c/050/6ad/e0c0506adfa607df0102904b82c0d96a.png"></div><br>  Hari ini, perubahan yang dilakukan diperiksa dengan hati-hati terlebih dahulu secara lokal, dan kemudian dengan serangkaian tes integrasi di peternakan perakitan.  Pada artikel ini, kita akan berbicara tentang tahap pertama verifikasi - pengujian statis, yang memantau kebenaran sumber daya dan menganalisis kode.  Ini adalah subsistem pertama dalam rantai dan merupakan sebagian besar kesalahan yang ditemukan. <br><a name="habracut"></a><br><h2>  Bagaimana semuanya dimulai </h2><br>  Proses manual mengecek permainan sebelum rilis dimulai di QA satu setengah minggu sebelum rilis.  Secara alami, bug yang ada pada tahap ini perlu diperbaiki sesegera mungkin. <br><br>  Karena kurangnya waktu untuk solusi yang baik, "penopang" sementara ditambahkan, yang kemudian berakar untuk waktu yang lama dan dikelilingi oleh solusi lain yang tidak terlalu populer. <br><br>  Pertama-tama, kami memutuskan untuk mengotomatiskan penemuan kesalahan terbuka: crash, ketidakmampuan untuk menyelesaikan serangkaian tindakan utama untuk game (buka toko, lakukan pembelian, mainkan level).  Untuk melakukan ini, permainan dimulai dalam mode autogame khusus dan jika terjadi kesalahan, maka kita akan segera mengetahuinya setelah lulus tes di peternakan kami. <br><br>  Tetapi sebagian besar kesalahan yang ditemukan oleh penguji dan uji asap otomatis kami adalah kurangnya sumber daya atau pengaturan yang salah dari sistem yang berbeda.  Oleh karena itu, langkah selanjutnya adalah <i>pengujian statis</i> - memeriksa ketersediaan sumber daya, hubungan dan pengaturannya tanpa meluncurkan aplikasi.  Sistem ini diluncurkan oleh langkah tambahan di farm perakitan dan sangat menyederhanakan penemuan dan perbaikan kesalahan.  Tetapi mengapa membuang sumber daya farm perakitan jika Anda dapat mendeteksi kesalahan bahkan sebelum melakukan dan memasukkan kode masalah ke dalam repositori?  Ini bisa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dilakukan dengan kait precommit</a> , yang baru saja dimulai sebelum komit dibuat dan dikirim ke repositori. <br><br>  Dan ya, kami sangat keren sehingga pengujian statis sebelum melakukan dan di farm perakitan dilakukan oleh satu kode, yang sangat menyederhanakan dukungannya. <br><br>  Upaya kami dapat dibagi menjadi tiga bidang: <br><br><ul><li>  pembuatan sebuah peternakan perakitan - tempat di mana segala sesuatu yang telah dikumpulkan dan diperiksa akan dikumpulkan; </li><li>  pengembangan tes statis - memeriksa kebenaran sumber daya, hubungannya, meluncurkan analisis kode; </li><li>  pengembangan uji runtime - meluncurkan aplikasi dalam mode putar otomatis. </li></ul><br>  Tugas terpisah adalah mengatur peluncuran pengujian pada mesin oleh pengembang.  Itu perlu untuk meminimalkan waktu eksekusi secara lokal (pengembang tidak harus menunggu 10 menit untuk melakukan satu baris) dan memastikan bahwa setiap sistem yang membuat perubahan telah menginstal sistem kami. <br><br><h2>  Banyak persyaratan - satu sistem </h2><br>  Selama pengembangan, ada serangkaian perangkat yang dapat berguna: dengan dan tanpa curang, beta atau alfa, iOS atau Android.  Dalam setiap kasus, sumber daya yang berbeda, pengaturan, atau bahkan kode yang berbeda mungkin diperlukan.  Menulis skrip untuk pengujian statis untuk setiap kemungkinan perakitan menghasilkan sistem yang rumit dengan banyak parameter.  Selain sulit untuk mempertahankan dan memodifikasi, setiap proyek juga memiliki set sepeda kruk sendiri. <br><br>  Melalui trial and error, kami sampai pada satu sistem, setiap pengujian di mana dapat memperhitungkan konteks peluncuran dan memutuskan apakah akan menjalankannya, apa tepatnya dan bagaimana memeriksa.  Pada awal pengujian, kami mengidentifikasi tiga sifat utama: <br><br><ul><li>  jenis perakitan: untuk sumber rilis dan debugging, pemeriksaan akan berbeda dalam hal ketelitian, kelengkapan cakupan, serta pengaturan untuk pengidentifikasi dan verifikasi fungsionalitas yang tersedia; </li><li>  platform: apa yang valid untuk android mungkin salah untuk iOS, sumber daya juga dikumpulkan secara berbeda dan tidak semua sumber daya dalam versi android akan ada di iOS dan sebaliknya; </li><li>  lokasi peluncuran: di mana tepatnya kami meluncurkan - pada agen pembangunan di mana semua tes yang tersedia diperlukan atau di komputer pengguna di mana daftar startup perlu diminimalkan. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e86/9b4/a61/e869b4a61b7f46ba9d545058baa4af5a.png"></div><br><h2>  Sistem uji statis </h2><br>  Inti dari sistem dan set dasar tes statis diimplementasikan dalam python.  Dasarnya hanya beberapa entitas: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d09/e44/1fd/d09e441fd62385fb616c3875cdc67a4d.png"></div><br>  <i>Konteks pengujian</i> adalah konsep yang luas.  Ia menyimpan parameter build dan launch yang kita bicarakan di atas, serta meta-informasi yang diisi dan digunakan oleh tes. <br><br>  Pertama, Anda perlu memahami tes mana yang harus dijalankan.  Untuk ini, meta-informasi berisi jenis sumber daya yang kami tertarik secara khusus dalam peluncuran ini.  Jenis sumber daya ditentukan oleh tes yang terdaftar dalam sistem.  Tes dapat "dikaitkan" dengan satu atau beberapa tipe tunggal, dan jika, pada saat komit, ternyata file yang diperiksa oleh tes ini telah berubah, maka sumber daya yang terkait telah berubah.  Ini sesuai dengan ideologi kami - untuk menjalankan pemeriksaan lokal sesedikit mungkin: jika file yang bertanggung jawab atas tes tidak berubah, maka Anda tidak perlu menjalankannya. <br><br>  Sebagai contoh, ada deskripsi ikan, di mana model 3D dan tekstur ditunjukkan. Jika file deskripsi telah berubah, maka diperiksa bahwa model dan tekstur yang ditunjukkan di dalamnya ada.  Dalam kasus lain, tidak perlu menjalankan cek ikan. <br><br>  Di sisi lain, mengubah sumber daya mungkin memerlukan perubahan dan entitas tergantung padanya: jika set tekstur yang kami simpan dalam file xml telah berubah, maka perlu untuk memeriksa model 3D tambahan, karena mungkin ternyata tekstur yang Anda butuhkan dihapus.  Optimalisasi yang dijelaskan di atas hanya diterapkan secara lokal pada mesin pengguna pada saat komit, dan ketika diluncurkan di majelis perakitan, diasumsikan bahwa semua file telah berubah dan kami menjalankan semua tes. <br><br>  Masalah selanjutnya adalah ketergantungan dari beberapa tes pada yang lain: tidak mungkin untuk memeriksa ikan sebelum menemukan semua tekstur dan model.  Oleh karena itu, kami membagi semua eksekusi menjadi dua tahap: <br><br><ul><li>  persiapan konteks </li><li>  memeriksa </li></ul><br>  Pada tahap pertama, konteksnya diisi dengan informasi tentang sumber daya yang ditemukan (dalam kasus ikan, dengan pengidentifikasi pola dan tekstur).  Pada tahap kedua, menggunakan informasi yang disimpan, cukup periksa apakah sumber daya yang diinginkan ada.  Konteks yang disederhanakan disajikan di bawah ini. <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VerificationContext</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span>   <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, app_path, build_type, platform, changed_files=None)</span></span></span><span class="hljs-function">:</span></span>       self.__app_path = app_path       self.__build_type = build_type       self.__platform = platform       <span class="hljs-comment"><span class="hljs-comment">#          self.__modified_resources = set()       self.__expected_resources = set()       #      ,              self.__changed_files = changed_files       # -  ,          self.__resources = {} def expect_resources(self, resources):   self.__expected_resources.update(resources) def is_resource_expected(self, resource):   return resource in self.__expected_resources def register_resource(self, resource_type, resource_id, resource_data=None):   self.__resources.setdefault(resource_type, {})[resource_id] = resource_data def get_resource(self, resource_type, resource_id):   if resource_type not in self.__resources or resource_id not in self.__resources[resource_type]:       return None, None   return resource_id, self.__resources[resource_type][resource_id]</span></span></code> </pre> <br>  Setelah menentukan semua parameter yang mempengaruhi peluncuran tes, kami berhasil menyembunyikan semua logika di dalam kelas dasar.  Dalam tes tertentu, tetap hanya menulis tes itu sendiri dan nilai yang diperlukan untuk parameter. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestCase</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name, context, build_types=None, platforms=None, predicate=None,               expected_resources=None, modified_resources=None)</span></span></span><span class="hljs-function">:</span></span>      self.__name = name      self.__context = context      self.__build_types = build_types      self.__platforms = platforms      self.__predicate = predicate      self.__expected_resources = expected_resources      self.__modified_resources = modified_resources      <span class="hljs-comment"><span class="hljs-comment">#               #   ,          self.__need_run = self.__check_run()      self.__need_resource_run = False  @property  def context(self):      return self.__context  def fail(self, message):      print('Fail: {}'.format(message))  def __check_run(self):      build_success = self.__build_types is None or self.__context.build_type in self.__build_types      platform_success = self.__platforms is None or self.__context.platform in self.__platforms      hook_success = build_success      if build_success and self.__context.is_build('hook') and self.__predicate:          hook_success = any(self.__predicate(changed_file) for changed_file in self.__context.changed_files)      return build_success and platform_success and hook_success  def __set_context_resources(self):      if not self.__need_run:          return      if self.__modified_resources:          self.__context.modify_resources(self.__modified_resources)      if self.__expected_resources:          self.__context.expect_resources(self.__expected_resources)   def init(self):      """        ,                    ,          """      self.__need_resource_run = self.__modified_resources and any(self.__context.is_resource_expected(resource) for resource in self.__modified_resources)  def _prepare_impl(self):      pass  def prepare(self):      if not self.__need_run and not self.__need_resource_run:          return      self._prepare_impl()  def _run_impl(self):      pass  def run(self):      if self.__need_run:          self._run_impl()</span></span></code> </pre> <br>  Kembali ke contoh ikan, kita perlu dua tes, salah satunya menemukan tekstur dan mendaftarkannya dalam konteks, yang lain mencari tekstur untuk model yang ditemukan. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VerifyTexture</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TestCase)</span></span></span><span class="hljs-class">:</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span>      super(VerifyTexture, self).__init__(<span class="hljs-string"><span class="hljs-string">'VerifyTexture'</span></span>, context,                                          build_types=[<span class="hljs-string"><span class="hljs-string">'production'</span></span>, <span class="hljs-string"><span class="hljs-string">'hook'</span></span>],                                          platforms=[<span class="hljs-string"><span class="hljs-string">'windows'</span></span>, <span class="hljs-string"><span class="hljs-string">'ios'</span></span>],                                          expected_resources=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>,                                          modified_resources=[<span class="hljs-string"><span class="hljs-string">'Texture'</span></span>],                                          predicate=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> file_path: os.path.splitext(file_path)[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'.png'</span></span>)  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_prepare_impl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span>      texture_dir = os.path.join(self.context.app_path, <span class="hljs-string"><span class="hljs-string">'resources'</span></span>, <span class="hljs-string"><span class="hljs-string">'textures'</span></span>)      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> root, dirs, files <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> os.walk(texture_dir):          <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tex_file <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> files:              self.context.register_resource(<span class="hljs-string"><span class="hljs-string">'Texture'</span></span>, tex_file) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VerifyModels</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TestCase)</span></span></span><span class="hljs-class">:</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, context)</span></span></span><span class="hljs-function">:</span></span>      super(VerifyModels, self).__init__(<span class="hljs-string"><span class="hljs-string">'VerifyModels'</span></span>, context,                                         expected_resources=[<span class="hljs-string"><span class="hljs-string">'Texture'</span></span>],                                         predicate=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> file_path: os.path.splitext(file_path)[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'.obj'</span></span>)  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_run_impl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span>      models_descriptions = etree.parse(os.path.join(self.context.app_path, <span class="hljs-string"><span class="hljs-string">'resources'</span></span>, <span class="hljs-string"><span class="hljs-string">'models.xml'</span></span>))      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model_xml <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> models_descriptions.findall(<span class="hljs-string"><span class="hljs-string">'.//Model'</span></span>):          texture_id = model_xml.get(<span class="hljs-string"><span class="hljs-string">'texture'</span></span>)          texture = self.context.get_resource(<span class="hljs-string"><span class="hljs-string">'Texture'</span></span>, texture_id)          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> texture <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>:              self.fail(<span class="hljs-string"><span class="hljs-string">'Texture for model {} was not found: {}'</span></span>.format(model_xml.get(<span class="hljs-string"><span class="hljs-string">'id'</span></span>), texture_id))</code> </pre> <br><h2>  Penyebaran Proyek </h2><br>  Pengembangan game di Playrix dilakukan dengan mesinnya sendiri dan, karenanya, semua proyek memiliki struktur file dan kode yang sama menggunakan aturan yang sama.  Oleh karena itu, ada banyak tes umum yang ditulis satu kali dan ada dalam kode umum.  Cukup bagi proyek untuk memperbarui versi sistem pengujian dan menghubungkan pengujian baru ke diri mereka sendiri. <br><br>  Untuk menyederhanakan integrasi, kami menulis pelari yang menerima file konfigurasi dan tes desain (tentangnya nanti).  File konfigurasi berisi informasi dasar yang kami tulis di atas: jenis perakitan, platform, jalur ke proyek. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Runner</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span>  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, config_str, setup_function)</span></span></span><span class="hljs-function">:</span></span>      self.__tests = []      config_parser = RawConfigParser()      config_parser.read_string(config_str)      app_path = config_parser.get(<span class="hljs-string"><span class="hljs-string">'main'</span></span>, <span class="hljs-string"><span class="hljs-string">'app_path'</span></span>)      build_type = config_parser.get(<span class="hljs-string"><span class="hljs-string">'main'</span></span>, <span class="hljs-string"><span class="hljs-string">'build_type'</span></span>)      platform = config_parser.get(<span class="hljs-string"><span class="hljs-string">'main'</span></span>, <span class="hljs-string"><span class="hljs-string">'platform'</span></span>)      <span class="hljs-string"><span class="hljs-string">'''      get_changed_files         CVS      '''</span></span>      changed_files = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> build_type != <span class="hljs-string"><span class="hljs-string">'hook'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> get_changed_files()      self.__context = VerificationContext(app_path, build_type, platform, changed_files)      setup_function(self)  @property  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">context</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span>      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.__context  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, test)</span></span></span><span class="hljs-function">:</span></span>      self.__tests.append(test)  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span>      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.__tests:          test.init()      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.__tests:          test.prepare()      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.__tests:          test.run()</code> </pre> <br>  Keindahan dari file konfigurasi adalah dapat dihasilkan di farm assembly untuk rakitan berbeda dalam mode otomatis.  Tetapi melewati pengaturan untuk semua tes melalui file ini mungkin tidak nyaman.  Untuk melakukan ini, ada tuning xml khusus yang disimpan dalam repositori proyek dan daftar file yang diabaikan, topeng untuk mencari dalam kode, dan seterusnya tertulis di dalamnya. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh file konfigurasi</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">[main] app_path = {app_path} build_type = production platform = ios</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Tuning contoh xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerifySourceCodepage</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">allow_utf8</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">allow_utf8Bom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofix_path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ci/autofix"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IgnoreFiles</span></span></span><span class="hljs-tag">&gt;</span></span>*android/tmp/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IgnoreFiles</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerifySourceCodepage</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerifyCodeStructures</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Checker</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NsStringConversion"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Checker</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LogConstructions"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerifyCodeStructures</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br>  Selain bagian umum, proyek memiliki kekhasan dan perbedaan mereka sendiri, oleh karena itu, ada set tes proyek yang terhubung ke sistem melalui konfigurasi pelari.  Untuk kode dalam contoh, beberapa baris akan cukup untuk dijalankan: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(runner)</span></span></span><span class="hljs-function">:</span></span>  runner.add_test(VerifyTexture(runner.context))  runner.add_test(VerifyModels(runner.context)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>  raw_config = <span class="hljs-string"><span class="hljs-string">'''  [main]  app_path = {app_path}  build_type = production  platform = ios  '''</span></span>  runner = Runner(raw_config, setup)  runner.run()</code> </pre> <br><h2>  Penggaruk yang dikumpulkan </h2><br>  Meskipun python itu sendiri adalah cross-platform, kami secara teratur memiliki masalah dengan fakta bahwa pengguna memiliki lingkungan unik mereka sendiri, yang mungkin tidak memiliki versi yang kami harapkan, beberapa versi, atau tidak ada juru bahasa sama sekali.  Akibatnya, itu tidak berfungsi seperti yang kita harapkan atau tidak berfungsi sama sekali.  Ada beberapa iterasi untuk menyelesaikan masalah ini: <br><br><ol><li>  Python dan semua paket diinstal oleh pengguna.  Tapi ada dua "tetapi": tidak semua pengguna adalah pemrogram dan menginstal melalui instalasi pip untuk desainer, dan untuk programmer juga, bisa menjadi masalah. </li><li>  Ada skrip yang menginstal semua paket yang diperlukan.  Ini sudah lebih baik, tetapi jika pengguna memiliki python yang salah terinstal, maka konflik dapat terjadi dalam pekerjaan. </li><li>  Memberikan versi penerjemah dan dependensi yang benar dari penyimpanan artefak (Nexus) dan menjalankan tes di lingkungan virtual. </li></ol><br>  Masalah lainnya adalah kinerja.  Semakin banyak tes, semakin lama perubahan diperiksa pada komputer pengguna.  Setiap beberapa bulan ada profil dan optimalisasi kemacetan.  Jadi konteksnya ditingkatkan, cache untuk file teks muncul, mekanisme predikat ditingkatkan (menentukan bahwa file ini menarik untuk pengujian). <br><br>  Dan kemudian hanya menyelesaikan masalah tentang bagaimana menerapkan sistem pada semua proyek dan memaksa semua pengembang untuk memasukkan kait yang dimiliki sebelumnya, tetapi ini adalah cerita yang sama sekali berbeda ... <br><br><h2>  Kesimpulan </h2><br>  Selama proses pengembangan, kami menari di menyapu, berjuang keras, tetapi masih punya sistem yang memungkinkan kami untuk menemukan kesalahan selama komit, mengurangi pekerjaan penguji, dan tugas sebelum rilis tentang tekstur yang hilang adalah hal di masa lalu.  Untuk kebahagiaan total, pengaturan sederhana lingkungan dan optimalisasi tes individu tidak cukup, tetapi golem dari departemen ci bekerja keras dalam hal ini. <br><br>  Contoh lengkap kode yang digunakan sebagai contoh dalam artikel dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori kami</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452926/">https://habr.com/ru/post/id452926/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452910/index.html">Halo, Habr! Halo Tercon</a></li>
<li><a href="../id452914/index.html">ML di Scala dengan senyum, untuk mereka yang tidak takut bereksperimen</a></li>
<li><a href="../id452916/index.html">Bangun dan pergi. Operasi tulang belakang: kapan harus melakukan, apa yang berbahaya</a></li>
<li><a href="../id452922/index.html">Tabel Grid CSS Fleksibel</a></li>
<li><a href="../id452924/index.html">Apa yang perlu Anda lakukan untuk mencegah akun Google Anda dicuri</a></li>
<li><a href="../id452928/index.html">Kami mengembalikan mesin virtual dari Datastore yang diinisialisasi secara salah. Kisah satu omong kosong dengan akhir yang bahagia</a></li>
<li><a href="../id452938/index.html">Senjata dari printer 3D sudah kembali, dan sekarang mereka tidak bisa lagi dihentikan</a></li>
<li><a href="../id452942/index.html">GeekBrains Mengadakan 12 Pertemuan Daring Gratis dengan Ahli Pemrograman</a></li>
<li><a href="../id452944/index.html">Apa yang akan menjadi "Dialog" ahli bahasa dan analisis data</a></li>
<li><a href="../id452946/index.html">Membaca ulang Lou Greenaw “Windows 95 / NT Programming Philosophy”</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>