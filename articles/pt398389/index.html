<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍯 👵🏽 👦🏼 Gato piada KiQ ou como fizemos um brinquedo falante para adultos 👧🏿 👨‍✈️ 👨🏻‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No mundo, há uma quantidade incrível de brinquedos falantes para crianças, e isso só dá a impressão de que os adultos ficam entediados. Nossa equipe d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gato piada KiQ ou como fizemos um brinquedo falante para adultos</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/398389/"><img src="https://ksr-ugc.imgix.net/assets/013/958/564/d6c061618e04b2f7d81d1d88c07c543d_original.jpg?w=680&amp;fit=max&amp;v=1475469443&amp;auto=format&amp;q=92&amp;s=94a8eb1e4d730d541ec407637a1490ee" alt="Brinquedo kiq"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No mundo, há uma quantidade incrível de brinquedos falantes para crianças, e isso só dá a impressão de que os adultos ficam entediados. </font><font style="vertical-align: inherit;">Nossa equipe decidiu corrigir esta situação.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O começo da história</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo começou com o fato de que a mente inquiridora do meu amigo e colega </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netsnail</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> veio a brilhante idéia: piadas porque não só as crianças, mas os adultos não amuse temáticos? O benefício do ferro acessível e comprovado agora nunca é uma raridade, e pode não apenas piscar com as luzes, mas também </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cantar músicas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A esse respeito, ele me ligou e se ofereceu para </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">repetir a façanha épica para</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> garantir que o ESP8266 reproduz música MP3 na rede para que seja bom e </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se o hamster está rasgando em pedaços,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> há desempenho realmente suficiente, o que eu fiz em um rápido feriado de Ano Novo em 2016:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pW-BoVe46O8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O ESP8266 reproduz um rádio da Internet no vídeo, emitindo som usando o PWM de 5 bits via I2S hack. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, tocar rádio MP3 da Internet consumiu quase todo o recurso ESP8266 e soou "mais ou menos", enquanto a imaginação já nos atraía </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algo mais do</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que apenas uma coluna de rádio MP3. </font><font style="vertical-align: inherit;">Com esses impulsos criativos, fomos à nossa equipe e ao amado chef </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vladimir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de um pouco de reflexão, uma imagem mais detalhada e até uma </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cadeia lógica</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do que não apenas queremos, mas podemos fazer:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para substituir o MP3 por algo menos exigente em recursos e mais livre, paramos no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn portou</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com sucesso e rapidez para o ESP8266.</font></font><br>
<br>
</li>
<li>           SD , ..    ,    ESP8266     —    .<br>
<br>
</li>
<li> « »  - ,     random .     ,        .         Apple Notification Center Service (ANCS),     iPod, iPhone  iPad.<br>
<br>
</li>
<li>     Bluetooth Low Energy (BLE),            .<br>
<br>
</li>
<li>                .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pawn language</a>.<br>
<br>
</li>
<li>       ,           —          «»  «» (),   -        .</li>
</ul><br>
<h3> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicialmente, eu queria criar um protótipo muito simples, mas totalmente funcional, em uma placa tudo em um, então decidimos experimentar o </font><font style="vertical-align: inherit;">MediaTek </font><font style="vertical-align: inherit;">no </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkIt ONE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . E a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netsnail</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conseguiu quase imediatamente. Havia uma conexão com o telefone e, a partir do cartão SD, o MP3 tocava perfeitamente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece - aqui está a felicidade e uma plataforma pronta! Mas então nos deparamos com a </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dura realidade das</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitações de seu SDK fechado e a euforia passou. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Percebemos que a plataforma pronta em uma placa, satisfazendo todos os nossos desejos, não estava na natureza, o que significa que tivemos que criá-la do zero.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, tivemos que escolher (fevereiro de 2016) o chip BLE mais adequado, que precisava ser conectado ao ESP8266. </font><font style="vertical-align: inherit;">Como uma conexão entre o ESP8266 e o ​​chip BLE (ainda não sabíamos que tipo de chip seria), decidimos usar o TWI padrão (I2C). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas com o BLE, a escolha não foi muito boa:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TI CC2541</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - De alguma forma, não gostei imediatamente devido à arquitetura do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e 8 Kb de RAM pareciam uma vida fácil e sem promessas, considerando o número de serviços e características de BLE que precisávamos no brinquedo.</font></font><br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BCM20732</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - parecia muito promissor, mas na verdade o SDK acabou sendo muito grosseiro, e o "chaveiro" Broadcom WICED Smart BLE é tão buggy que eu não escrevo nada aqui para não jurar. </font><font style="vertical-align: inherit;">Deixe-me saber se a situação melhorou agora.</font></font><br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nRF52832</a> —  ,   .      BLE  — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">rekod</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>, SDK  ,    <i></i> .  BLE ANCS          iPhone    UART.           SEGGER J-Link,       .<br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nRF51822</a> —      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>,     SEGGER  nRF52832.      —     nRF52832     nRF51822  !</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, o primeiro ferro parecia </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uma aranha tarântula,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algo assim: </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic1.jpg" alt="aranha de ferro"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
foi muito triste detectar falhas devido à queda de cabos duplos, especialmente no módulo nRF51822, onde os pinos eram um pouco menores.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviços BLE no aplicativo nRF51822 e iOS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No entanto, eu e o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> com este iron spider começamos a implementar serviços e recursos BLE no nRF51822, dividindo tudo em cerca de metade:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviço do Centro de Notificação da Apple ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANCS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) - para receber notificações de eventos de um smartphone.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serviço de horário atual da Apple (CTS) - quando conectado, o brinquedo leva tempo do telefone.</font></font></li>
<li>HandShake Service (HSS) —  , ,   «»        .   ,     lientID      pair     Bluetooth,    ,      .      ,    .</li>
<li>Battery As Service (BAS) —       .</li>
<li>Content Service (CONTS) —       ,   (     ).</li>
<li>Settings Service (SETTS) —       ,      (, )  ..</li>
</ul><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O MaximKit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ao mesmo tempo estava fazendo um </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplicativo para iOS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://ksr-ugc.imgix.net/assets/013/983/125/8dfbfd651b320b4818fa9ed65ebf67fc_original.jpg?w=680&amp;fit=max&amp;v=1475618060&amp;auto=format&amp;q=92&amp;s=952c7ac032d25e8b72ec4425cad5891d" alt="imagem"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A imagem à direita mostra a tela principal do aplicativo. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> não aguentou nosso sofrimento por causa da queda de fios e fez o </font><font style="vertical-align: inherit;">primeiro protótipo normal </font><font style="vertical-align: inherit;">em casa com um </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ferro a laser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic2.jpg" alt="primeiro protótipo mais ou menos"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
não é visível na foto, mas já existe um slot para cartão microSD. </font><font style="vertical-align: inherit;">No pequeno xale quadrado abaixo - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALC5627</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o som já era muito melhor do que o PWM de 5 bits via I2S. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">O AXP209 foi</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
escolhido para </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">gerenciamento de</font></a><font style="vertical-align: inherit;"> energia</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Permite carregar e usar a bateria ao mesmo tempo, além de monitorar sua condição. </font><font style="vertical-align: inherit;">O chip é muito comum, mas tem muitas especificidades tanto na programação quanto nos componentes externos necessários, os chamados </font><font style="vertical-align: inherit;">"Arnês".</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mágica no ESP8266</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em paralelo, a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> portou o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FatFs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para o ESP8266, criou um gerenciador de inicialização para o ESP8266 e o ​​nRF51822, para que não fosse possível atualizar o firmware por cabo, mas para isso, colocando os arquivos de firmware em um cartão microSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pessoalmente, parece-me que os alienígenas o ajudaram, já que ele fez tudo isso em cerca de um mês. Mas ele não admite estar em contato com uma mente alienígena. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E então o segundo protótipo mais normal: </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic3.jpg" alt="primeiro protótipo mais ou menos"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mas o protótipo mais normal não subiu mais em um brinquedo macio. E mesmo que ele entrasse, com um movimento agudo de um brinquedo em um usuário em potencial, um "estranho" subiria, o que, obviamente, era inaceitável para o MVP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por isso, decidiu-se solicitar uma taxa aos profissionais e foi o que aconteceu como resultado:</font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic4.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esse design já se encaixa perfeitamente no gato, embora pareça algo desumano: </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic5.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ao mesmo tempo, confirmou-se o receio de que os eventos do telefone pudessem ocorrer com bastante frequência e, como resultado, o usuário ficaria irritado em vez de divertido. Foi necessária uma lógica de filtragem flexível, que pode ser facilmente alterada a qualquer momento sem piscar. Nesse sentido, tendo estudado o material e percebido que não há scripts rápidos e compactos para o ESP8266 (Lua e microPython são intérpretes), decidi portar a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">linguagem Pawn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que rapidamente (apenas 18 vezes mais lenta que a nativa) executa um bytecode compacto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A propósito, as fontes de peão são muito semelhantes ao C, por isso é um prazer modificar os scripts - basta compilá-los no bytecode AMX e copiá-los para um cartão SD.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aparelhos de trapaça. </font><font style="vertical-align: inherit;">Finja ser iOS no Android</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E então "de repente", todos nos lembramos que os telefones Android no mundo não são tão pequenos, mas ainda mais do que os telefones com iOS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, tive que acelerar para verificar se podemos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enganar os gadgets e fingir ser iOS no Android</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para que eles vejam o serviço ANCS indistinguível da Apple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No final, tudo deu certo e depois de uma semana os gadgets (e nosso gato não é exceção) acreditavam sinceramente que eu tinha um iPhone com serviço ANCS, conectando-me ao meu Nexus 5 e até ao antigo Samsung Galaxy com Android 4.4.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go cloud</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como ninguém gosta de ouvir uma piada várias vezes (fato), e também existem preferências e restrições culturais, foi decidido para cada usuário criar uma lista de reprodução exclusiva. Para fazer isso, o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ocorreu com o servidor na nuvem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas como decidir quem vai gostar? É isso mesmo - deixe o usuário decidir! Para fazer isso, fiz uma detecção básica de gestos no acelerômetro </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIS3DH</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> da STMicroelectronics. Gostei da piada - inclinei o gato como se fosse "sim", não gostei da piada - me inclinei para o lado, como se "não". </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ele acrescentou um "miosótis" para o telefone - se a conexão BLE for perdida e o acelerômetro detectar movimento, o gato estará sendo transportado para algum lugar e o telefone será esquecido.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Após o usuário "polikal" e, assim, designar suas preferências - as informações vão para um servidor no qual os "genomas" das listas de reprodução são comparados e novos conjuntos de piadas são gerados para o usuário. </font><font style="vertical-align: inherit;">Mas este é um tópico para um artigo separado.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumário</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, o entretenimento acabou sendo uma excelente plataforma que pode:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comunique-se com o telefone via BLE e receba notificações de eventos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comunique-se via Wi-Fi e faça o download de atualizações de conteúdo e firmware;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salvar e ler arquivos no FAT32 no microSD;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faça piadas repletas de codec speex;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Determinar as preferências do usuário usando um acelerômetro (detecção de gestos)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criar listas de reprodução para cada usuário com base em suas preferências de humor;</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que é digno de nota: “alças muito inteligentes” podem muito bem ser conectadas aos pinos correspondentes (até os orifícios dos conectores na placa são deixados) e “sensatez o gato” como bem entenderem. </font><font style="vertical-align: inherit;">Isso torna a plataforma multifuncional atraente para os geeks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com esta plataforma, iniciamos o kickstarter, chamando o brinquedo acabado de KiQ. </font><font style="vertical-align: inherit;">No primeiro dia, 40% foram coletados e agora 57%. </font><font style="vertical-align: inherit;">Mas esta é uma história completamente diferente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obrigado a todos que leram até esta linha. </font><font style="vertical-align: inherit;">À espera de perguntas interessantes de você.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt398389/">https://habr.com/ru/post/pt398389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt398377/index.html">O que é informação em termos de física?</a></li>
<li><a href="../pt398379/index.html">Seu táxi não tripulado chega</a></li>
<li><a href="../pt398381/index.html">Protótipo do robô de lapso de tempo do Arduino</a></li>
<li><a href="../pt398385/index.html">Ilusões do cérebro. A primeira alucinação universal do mundo</a></li>
<li><a href="../pt398387/index.html">Ataque de carro: batalha feroz</a></li>
<li><a href="../pt398391/index.html">"Cinza, golpe, legal ...", ou a lógica do controle do clima em uma casa inteligente</a></li>
<li><a href="../pt398393/index.html">A Nikon D5500a refrigerada tira fotos espantosas do espaço</a></li>
<li><a href="../pt398395/index.html">Uau: nobel em vez de ondas gravitacionais foi dado para a topologia</a></li>
<li><a href="../pt398397/index.html">Fontes de raios X ultrabright foram encontradas em duas galáxias antigas. Um novo fenômeno natural?</a></li>
<li><a href="../pt398399/index.html">Digestão automática: tecnologias do presente e do futuro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>