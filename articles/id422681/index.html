<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÉ üë©üèø‚Äç‚öñÔ∏è üöΩ Integrasi SAP dan Python atau cara mengambil data dari SAP lebih mudah üññüèº üìà üï¥üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selamat siang, Habr! 

 Saya ingin berbagi pengalaman tentang tugas menarik tentang cara mudah berinteraksi dengan sistem SAP menggunakan Python - ter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integrasi SAP dan Python atau cara mengambil data dari SAP lebih mudah</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422681/">  Selamat siang, Habr! <br><br>  Saya ingin berbagi pengalaman tentang tugas menarik tentang cara mudah berinteraksi dengan sistem SAP menggunakan Python - terlepas dari modul atau versi platform mana. <br><br>  Jika hanya solusi teknis yang menarik, lewati semua lirik dan lihat contoh penerapannya. <br><br><h3>  Lirik </h3><br>  Semua itu bermuara pada kenyataan bahwa salah satu pelanggan perlu mengunduh data dari sistem SAP ERP mereka, dengan memanipulasi laporan dan surat yang sudah dikirim kepada orang-orang yang tertarik melalui email, serta tindakan lainnya. <br><br>  Sebenarnya, ketika membahas solusi dari masalah seperti itu, kami, sebagai kontraktor, mengusulkan berbagai opsi dan salah satu yang paling jelas adalah melakukan semuanya dengan bantuan fungsionalitas SAP internal, dengan cara yang sederhana di antara "penjilat" untuk Zed semua dengan ABAP. <br><br>  Hal pertama yang kami temui adalah kriteria untuk memilih data yang tidak sepenuhnya transparan dari kata-kata pelanggan, yaitu, data tabel mana, mengapa, mengapa, tindakan apa yang harus dilakukan dengannya.  Jika Anda memberikan contoh, maka pelanggan perlu membongkar kehadiran karyawan kantor, dengan data dalam konteks lembar waktu dan liburan.  Itu juga perlu untuk membuat laporan tentang kinerja karyawan dengan analisis pada waktunya di tempat kerja, saya tidak akan merinci, tetapi saya akan mengatakan bahwa jumlah waktu yang dihabiskan mempengaruhi produktivitas, tetapi untuk mengetahuinya, Anda perlu menghitung jumlah waktu di tempat kerja dengan hasil kerja dan banyak lagi lain.  Ini hanyalah salah satu contoh laporan, dan pelanggan menghasilkan banyak selama diskusi. <br><br>  Setelah percakapan panjang, kami menyadari bahwa SAP Query atau BI \ BO dapat menjadi solusi seperti itu, tetapi pelanggan tidak terlalu senang dengan perkiraan biaya solusi dan bukan fleksibilitas yang paling nyaman. <br><a name="habracut"></a><br><h3>  Solusi python </h3><br>  Kemudian saya memikirkan kepala saya sendiri tentang sebuah artikel tentang sumber daya tentang perpustakaan pyrfc dan karena saya, karena tidak pernah menjadi programmer python, tetapi setelah membacanya sekali, saya memutuskan untuk mempelajarinya di rumah, dan yang mengejutkan saya, saya adalah seorang amatir yang tenang. dari bahasa pemrograman ini saya menemukan bahwa menghubungkan ke sistem SAP sangat sederhana, apalagi, dibutuhkan 20 menit. <br><br>  Dua puluh menit CARL !!! <br><br>  Bayangkan saja Anda dapat mengkonfigurasi antarmuka koneksi dengan sistem SAP ERP tanpa menggunakan bus data dan semua jenis PI \ XI di sana dalam waktu yang sangat singkat. <br><br><h3>  Implementasi </h3><br>  Setelah akhirnya memastikan bahwa ini adalah solusi yang berfungsi dan memuaskan pelanggan, saya mempelajari beberapa platform (saya mempelajarinya, saya membaca setiap 10 menit), saya memilih platform Odoo, antara lain, karena lebih mudah digunakan dan memiliki semua properti yang diperlukan, seperti: Bagus antarmuka, sistem hak akses, aplikasi seluler, server surat, antarmuka basis data yang baik (psql). <br><br>  Selanjutnya, semuanya sangat sederhana. <br><br>  Instal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Odoo</a> di mesin virtual pelanggan (saya mengambil versi 8) karena  ini adalah yang paling sederhana saat ini, saya tahu bahwa versi 12 sudah, tetapi tugas itu tidak memerlukan semua produk baru yang keren. <br><br>  Menginstal semua perpustakaan yang diperlukan, khususnya pyrfc - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan ke artikel tentang instalasi dan koneksi</a> . <br><br>  Lebih jauh, itu hanya perlu untuk menulis modul kecil di platform Odoo itu sendiri, untuk konektivitas, dan itu punya banyak alat untuk memvisualisasikan data. <br><br>  Terhubung ke sistem pelanggan: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection user = <span class="hljs-string"><span class="hljs-string">'user'</span></span> passwd = <span class="hljs-string"><span class="hljs-string">'secretuser'</span></span> saprouter = <span class="hljs-string"><span class="hljs-string">'/H/192.168.0.140/S/3297'</span></span> conn = Connection(user=user, passwd=password, mshost=<span class="hljs-string"><span class="hljs-string">'CLient'</span></span>, msserv=<span class="hljs-string"><span class="hljs-string">'192.168.0.140'</span></span>, sysid=<span class="hljs-string"><span class="hljs-string">'01'</span></span>, group=<span class="hljs-string"><span class="hljs-string">"SPACE"</span></span>, saprouter=saprouter, client=<span class="hljs-string"><span class="hljs-string">'900'</span></span>)</code> </pre> <br>  Panggil BAPI untuk informasi pengguna <br><br><pre> <code class="python hljs">b_result = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_GET_DETAIL'</span></span>, USERNAME = <span class="hljs-string"><span class="hljs-string">'user'</span></span>, CACHE_RESULTS = <span class="hljs-string"><span class="hljs-string">' '</span></span>)</code> </pre><br>  Perubahan pengguna <br><br><pre> <code class="python hljs">updated_address[<span class="hljs-string"><span class="hljs-string">'CITY'</span></span>] = <span class="hljs-string"><span class="hljs-string">u'Moscow'</span></span> r = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_CHANGE'</span></span>, USERNAME=<span class="hljs-string"><span class="hljs-string">'user'</span></span>, ADDRESS=updated_address)</code> </pre><br>  Alat yang paling penting untuk mendapatkan data dari SAP, ketika datang ke tabel, adalah modul fungsional RFC_READ_TABLE, ada modul lain di platform SAP yang dapat dipanggil, harus ada pengaturan pada mereka yang mengatakan bahwa mereka dapat dipanggil menggunakan RFC. <br><br>  Sebagai contoh: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection, ABAPApplicationError, ABAPRuntimeError, LogonError, CommunicationError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PrettyPrinter <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: config = ConfigParser() config.read(<span class="hljs-string"><span class="hljs-string">'sapnwrfc.cfg'</span></span>) - <span class="hljs-comment"><span class="hljs-comment"># ,        SAP ERP params_connection = config._sections['connection'] conn = Connection(**params_connection) #    options = [{ 'TEXT': "FCURR = 'USD'"}] pp = PrettyPrinter(indent=4) ROWS_AT_A_TIME = 10 rowskips = 0 while True: print u"----Begin of Batch---" result = conn.call('RFC_READ_TABLE', \ QUERY_TABLE = 'TCURR', \ OPTIONS = options, \ ROWSKIPS = rowskips, ROWCOUNT = ROWS_AT_A_TIME) pp.pprint(result['DATA']) rowskips += ROWS_AT_A_TIME if len(result['DATA']) &lt; ROWS_AT_A_TIME: break except CommunicationError: print u"Could not connect to server." raise except LogonError: print u"Could not log in. Wrong credentials?" raise except (ABAPApplicationError, ABAPRuntimeError): print u"An error occurred." raise</span></span></code> </pre><br><h3>  Hasil </h3><br>  Dalam gambar ini, daftar laporan yang diturunkan oleh metode ini, dan contoh salah satunya. <br><br><img src="https://habrastorage.org/webt/ws/jk/sp/wsjkspjwwobeqnjznhaudqgw8do.jpeg"><br><br><h3>  Ringkasan </h3><br>  Secara umum, metode ini membuka peluang besar untuk mengganti alat SAP yang sangat mahal dan yang lainnya dengan yang lebih fleksibel dan terbuka. <br><br>  Contoh kode diambil dari sumber terbuka.  Saya tidak memiliki hak untuk menggunakan kode pelanggan dalam artikel, dan saya bukan programmer Python, saya bisa saja membuat kesalahan di suatu tempat. <br><br>  Saya ingin menambahkan bahwa kami sudah menggunakan alat ini dalam berbagai tugas yang sangat terkait dengan perhitungan KPI, mengeluarkan data ke sumber lain (situs web, pemasok, dan basis data pelanggan), mengirimkan informasi dari sistem berdasarkan data dari SAP, dan banyak lagi. <br>  Secara umum, kesempatan seperti itu merupakan penemuan bagi saya, jika ada yang memiliki pengalaman serupa, saya akan senang mendengarkan. <br><br>  PS Saya tidak membahas masalah lisensi, jadi saya tidak bisa mengatakan dengan pasti apa pun tentang masalah ini. <br>  Terima kasih <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Habr Link</a> <br>  Hormat kami, Konsultan SAP </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422681/">https://habr.com/ru/post/id422681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422669/index.html">Oracle vs PostgreSQL. Mengapa memilih Oracle mungkin merupakan keputusan yang cerdas</a></li>
<li><a href="../id422671/index.html">5G dapat menggantikan kabel - tetapi tidak di mana-mana</a></li>
<li><a href="../id422675/index.html">Dibuat di luar angkasa: siapa yang akan melakukan serat pada ISS</a></li>
<li><a href="../id422677/index.html">Tiga bulan kemudian: bagaimana GDPR memengaruhi cookie</a></li>
<li><a href="../id422679/index.html">Masalah imajiner - alasan untuk perangkat lunak yang buruk</a></li>
<li><a href="../id422683/index.html">Di AS, dua pedagang mendirikan perusahaan pialang palsu untuk mencuri uang dari investor pemula</a></li>
<li><a href="../id422685/index.html">Jam pintar Samsung Galaxy Watch: tingkatkan dari Android Wear OS ke Tizen OS - pengalaman pribadi</a></li>
<li><a href="../id422687/index.html">Utusan dalam bahaya</a></li>
<li><a href="../id422689/index.html">Deteksi warna mobil menggunakan jaringan saraf dan TensorFlow</a></li>
<li><a href="../id422691/index.html">Kamera hybrid dan lidar meningkatkan kemampuan robomobiles, melengkapi informasi tentang dunia luar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>