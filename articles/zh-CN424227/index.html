<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚭 👱 🤕 在火炬和张量流中均匀分布点 👆 👩🏻‍🤝‍👨🏿 🆙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文是为那些对深度学习感兴趣的人而写的，他们想要使用pytorch和tensorflow库的不同方法来最大程度地减少许多变量的功能，以及对如何将顺序执行的程序转换为使用numpy执行的矢量化矩阵计算感兴趣的人。 您还可以学习如何使用PovRay和vapory可视化的数据制作动画片。 



 任务来...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在火炬和张量流中均匀分布点</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/424227/"><p> 本文是为那些对深度学习感兴趣的人而写的，他们想要使用pytorch和tensorflow库的不同方法来最大程度地减少许多变量的功能，以及对如何将顺序执行的程序转换为使用numpy执行的矢量化矩阵计算感兴趣的人。 您还可以学习如何使用PovRay和vapory可视化的数据制作动画片。 </p><br><p><img src="https://habrastorage.org/webt/kz/fa/h2/kzfah2g6zgoehvsimumi8hy9nie.jpeg"></p><a name="habracut"></a><br><h3 id="otkuda-zadacha"> 任务来自哪里 </h3><br><blockquote> 每个都将其功能最小化（c）匿名数据科学家 </blockquote><p>在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们博客的先前出版物之一中</a> ，即“ Rake No. 6”段落中，我们讨论了DSSM技术，该技术可让您将文本转换为矢量。 为了找到这样的映射，人们需要找到最小化相当复杂的损失函数的线性变换系数。 由于向量的维数较大，因此很难了解学习此类模型时发生的情况。 要开发一种直觉，让您选择优化方法并设置该方法的参数，可以考虑此任务的简化版本。 现在，让向量位于我们通常的三维空间中，那么它们很容易绘制。 损失函数将具有将点推开并吸引到单位球体的潜力。 在这种情况下，解决该问题的方法是在球体上均匀分布点。 当前解决方案的质量易于通过肉眼评估。 </p><br><p> 因此，我们将寻找给定数量<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="Mathworld定义">范围内的均匀分布</a> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> n </script> 点。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="维基书籍">这种分布</a>有时对于声学来说是必需的，以便了解向哪个方向发射晶体中的波。  Signalman-了解如何将卫星送入轨道以实现最佳质量的通信。 气象学家-用于放置气象监测站。 </p><br><p> 对于一些 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> n </script> 任务<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="含柏油固体的Stackoverflow响应">很容易解决</a> 。 例如，如果 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">n</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-8">8</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.656ex" height="1.937ex" viewBox="0 -728.2 2435.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMAIN-3D" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMAIN-38" x="1934" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> n = 8 </script>  ，我们可以采用立方体，并且其顶点将是问题的答案。 我们也很幸运 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> n </script> 将等于二十面体，十二面体或其他柏拉图实体的顶点数量。 否则，任务就不是那么简单。 </p><br><p> 对于足够多的点，有一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="离散螺旋数学">根据经验选择系数</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="离散螺旋数学">公式，</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="再次关于螺旋">这里</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="不均匀校正">这里</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="数学程序网站">这里</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="基础研究">这里</a>还有更多选择。 但是，本文致力于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="俄罗斯stackoverflow">解决</a>一个更通用，更复杂的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="俄罗斯stackoverflow">解决方案</a> 。 </p><br><p> 我们解决的问题与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="汤姆森的草图任务">汤姆森问题</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="汤姆森的维基百科问题">Wiki</a> ）非常相似。 散布 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> n </script> 随机点，然后使它们吸引到诸如球体的表面，并相互推离。 吸引力和排斥力取决于功能-电位。 在势函数的最小值处，这些点将最均匀地位于球上。 </p><br><p> 此任务与机器学习（ML）模型的学习过程非常相似，在此过程中，损失函数被最小化。 但是数据科学家通常会观察单个数字的减少情况，并且我们可以观察情况的变化。 如果成功，我们将看到随机放置在面为1的立方体内部的点如何沿着球体表面发散： </p><br><p><img src="https://habrastorage.org/webt/52/sl/vj/52slvj5tsk6xdd-d1ymry_lty1i.png"></p><br><p> 示意地，解决问题的算法可以表示如下。 位于三维空间中的每个点对应于矩阵的一行 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> X </script>  。 损失函数是从该矩阵计算出来的。 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> L </script> ，其最小值对应于球体上点的均匀分布。 可以使用<code>pytorch</code>和<code>tensorflow</code>找到最小值，从而可以通过矩阵计算损失函数的梯度 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> X </script> 并使用库中实现的一种方法降低到最低限度：SGD，ADAM，ADAGRAD等。 </p><br><p><img src="https://habrastorage.org/webt/aq/ol/q_/aqolq_qbiybgyykwurj9dzap1nw.png"></p><br><h3 id="schitaem-potencial"> 我们认为潜力 </h3><br><p> 由于Python的简单性，表达能力和与其他语言编写的库的接口功能，Python被广泛用于解决机器学习问题。 因此，本文中的代码示例是用Python编写的。 对于快速矩阵计算，我们将使用numpy库。 为了最小化许多变量的功能-pytorch和tensorflow。 </p><br><p> 我们在面的侧面1中随机散布点。让我们有500个点，并且弹性相互作用的强度是静电的1000倍： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np n = <span class="hljs-number"><span class="hljs-number">500</span></span> k = <span class="hljs-number"><span class="hljs-number">1000</span></span> X = np.random.rand(n, <span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><p> 这段代码生成了一个矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;usg=ALkJrhgMFXQL10Kx0EROIIQWb8uP7NhVCw#MJMATHI-58" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> X </script> 大小 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">3</span><span class="MJXp-mtext" id="MJXp-Span-23" style="color: red;">\次</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> 3 \次n </script> 填充从0到1的随机数： </p><br><p><img src="https://habrastorage.org/webt/vn/vf/s-/vnvfs-cf0qee5vhmzn3vwidsn64.png"></p><br><p> 我们假设该矩阵的每一行对应一个点。 并在三列中记录坐标 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">x</span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">y</span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> x，y，z </script> 我们所有的观点。 </p><br><p> 点与单位球体表面的弹性相互作用的潜力 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-36" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">k</span><span class="MJXp-mtext" id="MJXp-Span-39">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">t</span><span class="MJXp-mrow" id="MJXp-Span-44"><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-46">1</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">r</span><span class="MJXp-msubsup" id="MJXp-Span-49"><span class="MJXp-mrow" id="MJXp-Span-50" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-52" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-55">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> u_1 = k \ cdot（1- r）^ 2/2 </script>  。 点的静电相互作用的潜力 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> p </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> q </script>  -- <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-65">1</span><span class="MJXp-mrow" id="MJXp-Span-66"><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-72" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;">q</span></span><span class="MJXp-mrow" id="MJXp-Span-77"><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> u_2 = 1 / | r_p-r_q | </script>  。 完整的电势包括所有成对点的静电相互作用以及每个点与球体表面的弹性相互作用： </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">U</span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-95" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-99" style="color: red;">\和</span><span class="MJXp-mtext" id="MJXp-Span-100" style="color: red;">\极</span><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mrow" id="MJXp-Span-102" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.278em; margin-right: 0.278em;">限</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">n</span><span class="MJXp-mo" id="MJXp-Span-110">−</span><span class="MJXp-mn" id="MJXp-Span-111">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">p</span><span class="MJXp-mo" id="MJXp-Span-106">=</span><span class="MJXp-mn" id="MJXp-Span-107">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-112" style="color: red;">\和</span><span class="MJXp-mtext" id="MJXp-Span-113" style="color: red;">\极</span><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mrow" id="MJXp-Span-115" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.278em; margin-right: 0.278em;">限</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">q</span><span class="MJXp-mo" id="MJXp-Span-119">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">p</span><span class="MJXp-mo" id="MJXp-Span-121">+</span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">c</span><span class="MJXp-mn" id="MJXp-Span-130">1</span><span class="MJXp-mrow" id="MJXp-Span-131"><span class="MJXp-mtext" id="MJXp-Span-132" style="color: red;">\左</span><span class="MJXp-mrow" id="MJXp-Span-133"><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">c</span><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-142" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">c</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">t</span><span class="MJXp-mrow" id="MJXp-Span-158"><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">k</span><span class="MJXp-mtext" id="MJXp-Span-162">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">t</span><span class="MJXp-mtext" id="MJXp-Span-167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">m</span><span class="MJXp-mtext" id="MJXp-Span-171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">i</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">p</span><span class="MJXp-mo" id="MJXp-Span-180">=</span><span class="MJXp-mn" id="MJXp-Span-181">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">t</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-190">1</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-192"><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-194">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">c</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-msubsup" id="MJXp-Span-199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-201" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">t</span><span class="MJXp-msubsup" id="MJXp-Span-210"><span class="MJXp-mrow" id="MJXp-Span-211" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-213" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">w</span><span class="MJXp-mtext" id="MJXp-Span-225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">n</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> U（x_1，...，x_n）= \和\极限_ {p = 1} ^ {n-1} \和\极限_ {q = p + 1} ^ {n} \ frac 1 {\左| \ vec {x_p}-\ vec {x_q} \ right | } + k \ cdot \ sum \ limit _ {p = 1} ^ n \ left（1-| \ vec {x_p} | \ right）^ 2 \ rightarrow \ min </script></p><br><p> 原则上，可以使用以下公式计算电位值： </p><br><pre> <code class="python hljs">L_for = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_inv = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_sq = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n): p_distance = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>): p_distance += x[p, i]**<span class="hljs-number"><span class="hljs-number">2</span></span> p_distance = math.sqrt(p_distance) L_for_sq += k * (<span class="hljs-number"><span class="hljs-number">1</span></span> - p_distance)**<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">#     ,     for q in range(p + 1, n): if q != p: pq_distance = 0 for i in range(3): pq_distance += (x[p, i] - x[q, i]) ** 2 pq_distance = math.sqrt(pq_distance) L_for_inv += 1 / pq_distance #      L_for = (L_for_inv + L_for_sq) / n print('loss =', L_for)</span></span></code> </pre> <br><p> 但是有一点麻烦。 对于可悲的2000分，该程序将运行2秒钟。 如果我们使用向量化矩阵计算来计算此值，将会更快。 加速既可以通过使用“快速”语言fortran和C实现矩阵运算来实现，也可以通过使用矢量化处理器运算来实现，这些运算器允许在一个时钟周期内对大量输入数据执行操作。 </p><br><p> 让我们看一下矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">S</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">X</span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">t</span><span class="MJXp-msubsup" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-240" style="vertical-align: 0.5em;">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> S = X \ cdot X ^ T </script>  。 它具有许多有趣的属性，并且经常在与ML中的线性分类器理论相关的计算中找到。 因此，如果我们假设在矩阵的行中 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> X </script> 带有索引 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> p </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> q </script> 编写三维空间矢量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">c</span><span class="MJXp-mrow" id="MJXp-Span-252"><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-256"><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">c</span><span class="MJXp-mrow" id="MJXp-Span-262"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-265" style="vertical-align: -0.4em;">q</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ vec {r _ p}，\ vec {r_q} </script> 然后矩阵 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> S </script> 将由这些向量的标量积组成。 这样的载体 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> n </script> 件，然后是矩阵的尺寸 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> S </script> 等于 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">n</span><span class="MJXp-mtext" id="MJXp-Span-274" style="color: red;">\倍</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> n \倍n </script>  。 </p><br><p><img src="https://habrastorage.org/webt/kh/bw/ct/khbwctgydbzj51g5qwybvxtr9wo.png"></p><br><p> 在矩阵的对角线上 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> S </script> 向量长度的平方 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">c</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-msubsup" id="MJXp-Span-284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-286" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-msubsup" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-291" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-298">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">p</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ vec {r_p}：s_ {p p} = r_p ^ 2 </script>  。 了解了这一点，让我们考虑一下交互的全部潜力。 我们首先计算两个辅助矩阵。 在一个对角矩阵中 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> S </script> 将在行中重复，在另一行-列中重复。 </p><br><p><img src="https://habrastorage.org/webt/ms/np/ps/msnppskk5fbczwgqvelu3jgeo80.png"></p><br><p> 现在让我们看一下表达式<code>p_roll + q_roll - 2 * S</code> </p><br><p><img src="https://habrastorage.org/webt/cc/py/ii/ccpyiidioj3yrxqnpxxbuyt8ht0.png"></p><br><p> 索引项目 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">p</span><span class="MJXp-mrow" id="MJXp-Span-305"><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">q</span><span class="MJXp-mrow" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29">（p，q）</script> 矩阵<code>sq_dist</code>等于 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-msubsup" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-314">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-319">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">q</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-321">2</span><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">t</span><span class="MJXp-mrow" id="MJXp-Span-327"><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">c</span><span class="MJXp-mrow" id="MJXp-Span-333"><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mtext" id="MJXp-Span-339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">c</span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-346" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-mrow" id="MJXp-Span-347"><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-350"><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">c</span><span class="MJXp-mrow" id="MJXp-Span-356"><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-359" style="vertical-align: -0.4em;">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-361">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">c</span><span class="MJXp-mrow" id="MJXp-Span-365"><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;">q</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mrow" id="MJXp-Span-370" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-372" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> r_p ^ 2 + r_q ^ 2-2 \ cdot（\ vec {r_p}，\ vec {r_q}）=（\ vec {r_p}-\ vec {r_q}）^ 2 </script>  。 也就是说，我们具有点之间距离的平方的矩阵。 </p><br><h3 id="elektrostaticheskoe-ottalkivanie-na-sfere"> 球上的静电排斥 </h3><br><p>  <code>dist = np.sqrt(sq_dist)</code> -点之间距离的矩阵。 我们需要考虑它们之间的点的排斥力和对球体的吸引力来计算势能。 将单位放在对角线上，并用其倒数替换每个元素（只是不要以为我们求矩阵求逆！）： <code>rec_dist_one = 1 / (dist + np.eye(n))</code> 。 结果是在对角线上有一个单位的矩阵，其他元素是这些点之间的静电相互作用的电势。 </p><br><p> 现在我们将吸引的二次势加到单位球体的表面。 距球体表面的距离 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-376">1</span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">r</span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31">（1-r）</script>  。 平方并乘以 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> k </script>  ，它定义了粒子的静电排斥作用与球体吸引力之间的关系。 总<code>k = 1000</code> ， <code>all_interactions = rec_dist_one - torch.eye(n) + (d.sqrt() - torch.ones(n))**2</code> 。 期待已久的损失函数，我们将其最小化： <code>t = all_interactions.sum()</code> </p><br><p> 一个使用numpy库计算潜力的程序： </p><br><pre> <code class="python hljs">S = X.dot(XT) <span class="hljs-comment"><span class="hljs-comment">#    pp_sq_dist = np.diag(S) #  p_roll = pp_sq_dist.reshape(1, -1).repeat(n, axis=0) #     q_roll = pp_sq_dist.reshape(-1, 1).repeat(n, axis=1) #     pq_sq_dist = p_roll + q_roll - 2 * S #      pq_dist = np.sqrt(pq_sq_dist) #    pp_dist = np.sqrt(pp_sq_dist) #      surface_dist_sq = (pp_dist - np.ones(n)) ** 2 #       rec_pq_dist = 1 / (pq_dist + np.eye(n)) - np.eye(n) #      L_np_rec = rec_pq_dist.sum() / 2 #     L_np_surf = k * surface_dist_sq.sum() #       L_np = (L_np_rec + L_np_surf) / n #   ,     print('loss =', L_np)</span></span></code> </pre> <br><p> 这里的情况要好一些-在2000点处为200毫秒。 </p><br><p> 我们使用pytorch： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch pt_x = torch.from_numpy(X) <span class="hljs-comment"><span class="hljs-comment"># pt_x -   tensor   pytorch pt_S = pt_x.mm(pt_x.transpose(0, 1)) # mm - matrix multiplication pt_pp_sq_dist = pt_S.diag() pt_p_roll = pt_pp_sq_dist.repeat(n, 1) pt_q_roll = pt_pp_sq_dist.reshape(-1, 1).repeat(1, n) pt_pq_sq_dist = pt_p_roll + pt_q_roll - 2 * pt_S pt_pq_dist = pt_pq_sq_dist.sqrt() pt_pp_dist = pt_pp_sq_dist.sqrt() pt_surface_dist_sq = (pt_pp_dist - torch.ones(n, dtype=torch.float64)) ** 2 pt_rec_pq_dist = 1/ (pt_pq_dist + torch.eye(n, dtype=torch.float64)) - torch.eye(n, dtype=torch.float64) L_pt = (pt_rec_pq_dist.sum() / 2 + k * pt_surface_dist_sq.sum()) / n print('loss =', float(L_pt))</span></span></code> </pre> <br><p> 最后张量流： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf tf_x = tf.placeholder(name=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, dtype=tf.float64) tf_S = tf.matmul(tf_x, tf.transpose(tf_x)) tf_pp_sq_dist = tf.diag_part(tf_S) tf_p_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>)), (n, <span class="hljs-number"><span class="hljs-number">1</span></span>)) tf_q_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-number"><span class="hljs-number">1</span></span>, n)) tf_pq_sq_dist = tf_p_roll + tf_q_roll - <span class="hljs-number"><span class="hljs-number">2</span></span> * tf_S tf_pq_dist = tf.sqrt(tf_pq_sq_dist) tf_pp_dist = tf.sqrt(tf_pp_sq_dist) tf_surface_dist_sq = (tf_pp_dist - tf.ones(n, dtype=tf.float64)) ** <span class="hljs-number"><span class="hljs-number">2</span></span> tf_rec_pq_dist = <span class="hljs-number"><span class="hljs-number">1</span></span> / (tf_pq_dist + tf.eye(n, dtype=tf.float64)) - tf.eye(n, dtype=tf.float64) L_tf = (tf.reduce_sum(tf_rec_pq_dist) / <span class="hljs-number"><span class="hljs-number">2</span></span> + k * tf.reduce_sum(tf_surface_dist_sq)) / n glob_init = tf.local_variables_initializer() <span class="hljs-comment"><span class="hljs-comment">#     with tf.Session() as tf_s: #     glob_init.run() #   res, = tf_s.run([L_tf], feed_dict={tf_x: x}) #   print(res)</span></span></code> </pre> <br><p> 比较这三种方法的性能： </p><br><table><tbody><tr><td>  ñ </td><td> 蟒蛇 </td><td> 麻木 </td><td> 火炬 </td><td> 张量流 </td></tr><tr><td>  2000 </td><td>  4.03 </td><td>  0.083 </td><td>  1.11 </td><td>  0.205 </td></tr><tr><td>  10,000 </td><td>  99 </td><td>  2.82 </td><td>  2.18 </td><td>  7.9 </td></tr></tbody></table><br><p> 相对于纯python代码，矢量化计算所获得的十进制小数位数以上。 可以看到pytorch中的“样板”：小体积计算需要花费大量时间，但是随着计算量的增加，它几乎不会改变。 </p><br><h3 id="vizualizaciya"> 可视化 </h3><br><p> 如今，可以使用大量的程序包（例如Matlab，Wolfram Mathematica，Maple，Matplotlib等）来可视化数据。在这些程序包中，有许多复杂的函数可以完成复杂的事情。 不幸的是，如果您面对一个简单但非标准的任务，就会发现自己没有武装。 在这种情况下，我最喜欢的解决方案是povray。 这是一个非常强大的程序，通常用于创建照片级逼真的图像，但是它可以用作“可视化的汇编程序”。 通常，无论您要显示的表面多么困难，只要让povray绘制中心位于该表面的球体即可。 </p><br><p> 使用vapory库，您可以直接在python中创建一个povray场景，对其进行渲染并查看结果。 现在看起来像这样： </p><br><p><img src="https://habrastorage.org/webt/fh/1j/6x/fh1j6xkcdedx1m4s0x9clmsgjse.gif"></p><br><p> 图片如下： </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vapory <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_scene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(moment)</span></span></span><span class="hljs-function">:</span></span> angle = <span class="hljs-number"><span class="hljs-number">2</span></span> * math.pi * moment / <span class="hljs-number"><span class="hljs-number">360</span></span> r_camera = <span class="hljs-number"><span class="hljs-number">7</span></span> camera = vapory.Camera(<span class="hljs-string"><span class="hljs-string">'location'</span></span>, [r_camera * math.cos(angle), <span class="hljs-number"><span class="hljs-number">1.5</span></span>, r_camera * math.sin(angle)], <span class="hljs-string"><span class="hljs-string">'look_at'</span></span>, [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'angle'</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) light1 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">-3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) light2 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) plane = vapory.Plane([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">-1</span></span>, vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>])) box = vapory.Box([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'Col_Glass_Clear'</span></span>), vapory.Finish(<span class="hljs-string"><span class="hljs-string">'F_Glass9'</span></span>), vapory.Interior(<span class="hljs-string"><span class="hljs-string">'I_Glass1'</span></span>)) spheres = [vapory.Sphere( [float(r[<span class="hljs-number"><span class="hljs-number">0</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">1</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">2</span></span>])], <span class="hljs-number"><span class="hljs-number">0.05</span></span>, vapory.Texture(vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vapory.Scene(camera, objects=[light1, light2, plane, box] + spheres, included=[<span class="hljs-string"><span class="hljs-string">'glass.inc'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span>): flnm = <span class="hljs-string"><span class="hljs-string">'out/sphere_{:03}.png'</span></span>.format(t) scene = create_scene(t) scene.render(flnm, width=<span class="hljs-number"><span class="hljs-number">800</span></span>, height=<span class="hljs-number"><span class="hljs-number">600</span></span>, remove_temp=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) clear_output() display(Image.open(flnm))</code> </pre> <br><p> 使用ImageMagic从一堆文件中组装动画gif： </p><br><pre> <code class="bash hljs">convert -delay 10 -loop 0 sphere_*.png sphere_all.gif</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在github上，</a>您可以看到工作代码，此处提供了片段。 在第二篇文章中，我将讨论如何开始使函数最小化，以便使点从立方体中出来并在球体上均匀分布。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424227/">https://habr.com/ru/post/zh-CN424227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424209/index.html">无线宽限期：Snom A170耳机评测</a></li>
<li><a href="../zh-CN424211/index.html">了解容器存储接口（在Kubernetes等中）</a></li>
<li><a href="../zh-CN424215/index.html">榆树 舒适尴尬</a></li>
<li><a href="../zh-CN424217/index.html">进行圣战的理由以及对和平的呼吁</a></li>
<li><a href="../zh-CN424223/index.html">一次性客户。 细分重复购买</a></li>
<li><a href="../zh-CN424229/index.html">Kubernetes生产中：服务</a></li>
<li><a href="../zh-CN424231/index.html">如何在主机上赚钱</a></li>
<li><a href="../zh-CN424233/index.html">教导计算机检测痴呆症的准确性为93％</a></li>
<li><a href="../zh-CN424235/index.html">如何在Oracle Standard Edition中使用STATSPACK代替AWR</a></li>
<li><a href="../zh-CN424237/index.html">直接充电您的大脑！ Joker 2018的运行时，编译器和性能</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>