<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗼 👩🏼‍🤝‍👨🏿 🔻 为此编写一个简单的处理器和环境 😦 🌖 💎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="你好 在本文中，我将告诉您需要执行哪些步骤来为其创建一个简单的处理器和环境。 
 命令集架构（ISA） 


 首先，您需要确定处理器是什么。 以下参数很重要： 


- 机器字和寄存器的大小（处理器的位/“位”） 
- 机器指令（指令）及其大小 


 根据指令的大小，处理器体系结构可以分为两种类...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>为此编写一个简单的处理器和环境</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430680/"><p> 你好 在本文中，我将告诉您需要执行哪些步骤来为其创建一个简单的处理器和环境。 </p><a name="habracut"></a><br><h1 id="arhitektura-nabora-komand-isahttpsruwikipediaorgwikid090d180d185d0b8d182d0b5d0bad182d183d180d0b0_d0bdd0b0d0b1d0bed180d0b0_d0bad0bed0bcd0b0d0bdd0b4">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">命令集架构（ISA）</a> </h1><br><p> 首先，您需要确定处理器是什么。 以下参数很重要： </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">机器字</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">寄存器</a>的大小（处理器的位/“位”） </li><li> 机器指令（指令）及其大小 </li></ul><br><p> 根据指令的大小，处理器体系结构可以分为两种类型（实际上，它们的数量更多，但是其他选项不那么流行）： </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><em>RISC</em></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><em>中钢国际</em></a> </li></ul><br><p> 它们的主要区别在于<em>RISC</em>处理器具有相同的指令大小。 它们的指令很简单并且运行相对较快，而<em>CISC</em>处理器可以具有不同的指令大小，其中一些可能会花费一些时间。 </p><br><p> 我决定制作一个像<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><em>MIPS</em></a>一样的<em>RISC</em>处理器。 </p><br><p> 我这样做的原因有很多： </p><br><ul><li> 创建这种处理器的原型非常简单。 </li><li> 这种处理器的所有复杂性都转移到了汇编器和/或编译器之类的程序上。 </li></ul><br><p> 以下是我的处理器的主要功能： </p><br><ul><li> 机器字和寄存器大小-32位 </li><li>  64个寄存器（包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">命令计数器</a> ） </li><li>  2种指示 </li></ul><br><p>  <em>寄存器类型</em> （以下称为寄存器类型）如下所示： </p><br><p><img src="https://habrastorage.org/webt/se/sy/ys/sesyysl1k4_d-2ruukf-fgtkni8.png" alt="rtype" title="寄存器类型"></p><br><p> 这种指令的独特之处在于它们使用三个寄存器进行操作。 </p><br><p>  <em>即时类型</em> ： </p><br><p><img src="https://habrastorage.org/webt/vw/is/ij/vwisij-vr9pbu-sw6sz63dg7nqe.png" alt="itype" title="立即型"></p><br><p> 这种类型的指令有两个寄存器和一个数字。 </p><br><p>  <em>OP</em>是要执行的指令的编号（或指示该<em>寄存器类型的</em>指令）。 </p><br><p>  <em>R0</em> ， <em>R1</em> ， <em>R2</em>是用作指令的操作数的寄存器号。 </p><br><p>  <em>Func</em>是一个附加字段，用于指示<em>寄存器类型</em>指令的<em>类型</em> 。 </p><br><p>  <em>Imm</em>是写入值的字段，我们希望将其明确提供指令作为操作数。 </p><br><ul><li> 仅28条指令 </li></ul><br><p> 完整的指令列表可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github仓库中</a>找到。 </p><br><p> 这里只是其中的几个： </p><br><pre><code class="plaintext hljs">nor r0, r1, r2</code> </pre> <br><p>  <em>NOR</em>是一种<em>寄存器类型的</em>指令，它对寄存器r1和r2进行逻辑<strong><em>或运算</em></strong> ，然后将结果写入寄存器r0。 </p><br><p> 为了使用此指令，您需要在二进制数系统中将<em>OP</em>字段更改为<strong>0000</strong> ，将<em>Func</em>字段更改为<strong>0000000111</strong> 。 </p><br><pre> <code class="plaintext hljs">lw r0, n(r1)</code> </pre> <br><p>  <em>LW</em>是<em>立即数类型的</em>指令，它将<strong>r1 + n</strong>处的存储值加载到r0寄存器中。 </p><br><p> 为了依次使用此指令，您需要将<em>OP</em>字段更改为<strong>0111</strong> ，并将数字<strong>n</strong>写入<em>IMM</em>字段。 </p><br><h1 id="napisanie-koda-processora"> 编写处理器代码 </h1><br><p> 创建<em>ISA之后，</em>您可以开始编写处理器。 </p><br><p> 为此，我们需要某种设备描述语言的知识。 以下是其中一些： </p><br><ul><li>  Verilog </li><li>  VHDL（不要与前一个混淆！） </li></ul><br><p> 我选择了Verilog，因为 编程是我大学课程的一部分。 </p><br><p> 要编写处理器，您需要了解其操作逻辑： </p><br><ol><li> 在<em>命令计数器（PC）上</em>获取说明 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">解码</a>说明 </li><li> 指令执行 </li><li> 将已执行指令<em>的命令</em>大小添加到<em>计数器中</em> </li></ol><br><p> 等等广告无限。 </p><br><p> 事实证明，您需要创建几个模块： </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">注册文件</a> </li><li> 解码器 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ALU</a> </li></ul><br><p> 我们将分别分析每个模块。 </p><br><h2 id="registrovyy-fayl"> 注册文件 </h2><br><p> 寄存器文件提供对寄存器的访问。 使用它，您需要获取某些寄存器的值，或对其进行更改。 </p><br><p> 就我而言，我有64个寄存器。 在其中一个寄存器中写入对其他两个寄存器的操作结果，因此我需要提供仅更改一个寄存器并从其他两个寄存器中获取值的机会。 </p><br><h2 id="dekoder"> 解码器 </h2><br><p> 解码器是负责解码指令的单元。 它指示ALU和其他单元需要执行哪些操作。 </p><br><p> 例如， <em>addi语句</em>应将寄存器<strong>$ 0的值</strong> （始终存储<strong>0</strong> ）和<strong>20</strong>相加，并将结果放入寄存器$ t0中。 </p><br><pre> <code class="plaintext hljs">addi $t0, $zero, 20</code> </pre> <br><p> 此时，解码器确定以下指令： </p><br><ul><li> 立即型 </li><li> 必须将结果写入寄存器 </li></ul><br><p> 并将此信息传输到以下块。 </p><br><h2 id="alu">  ALU </h2><br><p> 控制权传递给ALU之后。 它通常执行所有数学，逻辑运算以及比较数字的运算。 </p><br><p> 也就是说，如果我们考虑相同的<em>addi</em>指令，则在此阶段会发生<strong>0</strong>和<strong>20</strong>的加法<em>运算</em> 。 </p><br><h2 id="drugie"> 其他 </h2><br><p> 除了上述块之外，处理器还应该能够： </p><br><ul><li> 获取和更改内存中的值 </li><li> 执行条件跳转 </li></ul><br><p> 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">那里</a>看到代码中的外观。 </p><br><h1 id="assembler"> 组装工 </h1><br><p> 编写处理器后，我们需要一个程序，该程序将文本命令转换为机器代码，以免手动执行。 因此，您需要编写汇编程序。 </p><br><p> 我决定用C编程语言实现它。 </p><br><p> 由于我的处理器具有<em>RISC</em>架构，为了简化我的生活，我决定设计汇编程序，以便可以轻松添加自己的伪指令（几个基本指令或其他伪指令的组合）。 </p><br><p> 您可以使用存储指令类型，其格式，指向返回机器指令代码的函数的指针及其名称的数据结构来实现此目的。 </p><br><p> 常规程序以段声明开始。 </p><br><p> 对于我们来说，两段<strong>.text</strong>就足够了-其中将存储程序的源代码-和<strong>.data-</strong>中将存储我们的数据和常量。 </p><br><p> 一条指令可能看起来像这样： </p><br><pre> <code class="plaintext hljs">.text jie $zero, $zero, $zero #  addi $t1, $zero, 2 # $t1 = $zero + 2 lw $t1, 5($t2) # $t1 = *($t2 + 5) syscall 0, $zero, $zero # syscall(0, 0, 0) la $t1, label# $t1 = label</code> </pre> <br><p> 首先，指示指令的名称，然后指示操作数。 </p><br><p> 在<strong>.data中</strong> ，指示数据声明。 </p><br><pre> <code class="plaintext hljs">.data .byte 23 #   1  .half 1337 #   2  .word 69000, 25000 #   4  .asciiz "Hello World!" #     ( ) .ascii "12312009" #   ( ) .space 45 #  45 </code> </pre> <br><p> 广告必须以句点和数据类型名称开头，后跟常量或参数。 </p><br><p> 如下分析（扫描）汇编文件很方便： </p><br><ol><li> 首先，扫描细分 </li><li> 如果它是<strong>.data</strong>段，则我们解析不同的数据类型或<strong>.text</strong>段 </li><li> 如果它是<strong>.text</strong>段，则我们解析命令或.data段 </li></ol><br><p> 要工作，汇编器需要遍历源文件两次。 他第一次考虑链接的偏移量（为它们服务）时，它们通常如下所示： </p><br><pre> <code class="plaintext hljs"> la $s4, loop #   loop  s4 loop: # ! mul $s2, $s2, $s1 # s2 = s2 * s1 addi $s1, $s1, -1 # s1 = s1 - 1 jil $s3, $s1, $s4 #  s3 &lt; s1    </code> </pre> <br><p> 在第二遍中，您已经可以生成文件。 </p><br><h1 id="itog"> 总结 </h1><br><p> 将来，您可以在我们的处理器上运行汇编程序的输出文件并评估结果。 </p><br><p> 同样，现成的汇编程序可以在C编译器中使用。 但这是以后。 </p><br><p> 参考文献： </p><br><ul><li> 使用Verilog设计数字计算机系统。  David J.Lilja和Sachin S.Sapatnekar </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">源代码</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">另一个处理器的源代码</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430680/">https://habr.com/ru/post/zh-CN430680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN430670/index.html">安排管理</a></li>
<li><a href="../zh-CN430672/index.html">C ++ CoreHard 2018年秋季报告“ Actor vs CSP vs Tasks ...”的文本版本</a></li>
<li><a href="../zh-CN430674/index.html">建立通用工作时间表的逻辑</a></li>
<li><a href="../zh-CN430676/index.html">上古：shshshsh，sssssss，VOIP，BBS和其他调制解调器的朋友</a></li>
<li><a href="../zh-CN430678/index.html">用LED灯测试十个调光器</a></li>
<li><a href="../zh-CN430682/index.html">月球微卫星项目的三年：成长阶段</a></li>
<li><a href="../zh-CN430684/index.html">扫描实时以太坊合约以查看未检查的发送错误。 第二部分</a></li>
<li><a href="../zh-CN430686/index.html">概述：WAZER的第一台水刀切割机</a></li>
<li><a href="../zh-CN430688/index.html">通过动画QR将数据传输到Gomobile和GopherJS</a></li>
<li><a href="../zh-CN430690/index.html">“未来的C ++”中的确定性异常和错误处理</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>