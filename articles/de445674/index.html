<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìó üßïüèΩ üë®üèæ‚Äçüíº PVS-Studio f√ºr Java macht sich auf den Weg. N√§chster Halt ist Elasticsearch üõ´ üî´ üö£üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das PVS-Studio-Team f√ºhrt seit vielen Jahren den Blog √ºber die √úberpr√ºfung von Open-Source-Projekten durch den gleichnamigen statischen Code-Analysato...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio f√ºr Java macht sich auf den Weg. N√§chster Halt ist Elasticsearch</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/445674/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e7d/542/517/e7d5425172ebed7d6953375ceefbd8b7.png" alt="Bild 1"></div><br>  Das PVS-Studio-Team f√ºhrt seit vielen Jahren den Blog √ºber die √úberpr√ºfung von Open-Source-Projekten durch den gleichnamigen statischen Code-Analysator.  Bisher wurden mehr als 300 Projekte gepr√ºft, die Fehlerbasis enth√§lt mehr als 12000 F√§lle.  Urspr√ºnglich wurde der Analysator zur √úberpr√ºfung von C- und C ++ - Code implementiert, die Unterst√ºtzung von C # wurde sp√§ter hinzugef√ºgt.  Daher entf√§llt bei allen gepr√ºften Projekten die Mehrheit (&gt; 80%) auf C und C ++.  Vor kurzem wurde Java zur Liste der unterst√ºtzten Sprachen hinzugef√ºgt, was bedeutet, dass es jetzt eine v√∂llig neue offene Welt f√ºr PVS-Studio gibt. Daher ist es an der Zeit, die Basis mit Fehlern aus Java-Projekten zu erg√§nzen. <br><br>  Die Java-Welt ist riesig und vielf√§ltig, sodass man nicht einmal wei√ü, wo man zuerst suchen muss, wenn man ein Projekt zum Testen des neuen Analysators ausw√§hlt.  Letztendlich fiel die Wahl auf die Volltextsuche und Analyse-Engine Elasticsearch.  Es ist ein ziemlich erfolgreiches Projekt, und es ist sogar besonders angenehm, Fehler in bedeutenden Projekten zu finden.  Welche Fehler konnte PVS-Studio f√ºr Java erkennen?  Weitere Gespr√§che √ºber die Ergebnisse der √úberpr√ºfung werden richtig sein. <br><a name="habracut"></a><br><h2>  Kurz √ºber Elasticsearch </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Elasticsearch</a> ist eine verteilte, RESTful-Such- und Analyse-Engine mit Open Source-Code, die eine wachsende Anzahl von Anwendungsf√§llen l√∂sen kann.  Sie k√∂nnen damit gro√üe Datenmengen speichern, eine schnelle Suche und Analyse durchf√ºhren (fast im Echtzeitmodus).  In der Regel wird es als zugrunde liegender Mechanismus / Technologie verwendet, der Anwendungen mit komplexen Funktionen und Suchanforderungen versorgt. <br><br>  Zu den wichtigsten Websites, die Elasticsearch verwenden, geh√∂ren Wikimedia, StumbleUpon, Quora, Foursquare, SoundCloud, GitHub, Netflix, Amazon, IBM und Qbox. <br><br>  Gut, genug Einf√ºhrung. <br><br><h2>  Die ganze Geschichte, wie die Dinge waren </h2><br>  Es gab keine Probleme mit dem Scheck selbst.  Die Abfolge der Aktionen ist recht einfach und hat nicht viel Zeit in Anspruch genommen: <br><br><ul><li>  Elasticsearch von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> heruntergeladen; </li><li>  Befolgen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anweisungen</a> zum Ausf√ºhren des Java-Analysators und f√ºhren Sie die Analyse aus. </li><li>  Erhielt den Bericht des Analysators, vertiefte sich in ihn und wies auf interessante F√§lle hin. </li></ul><br>  Kommen wir nun zum Hauptpunkt. <br><br><h2>  Achtung!  M√∂gliche NullPointerException </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6008</a> Null-Dereferenzierung von 'Linie'.  GoogleCloudStorageFixture.java (451) <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PathTrie&lt;RequestHandler&gt; defaultHandlers(....) { .... handlers.insert(<span class="hljs-string"><span class="hljs-string">"POST /batch/storage/v1"</span></span>, (request) -&gt; { .... <span class="hljs-comment"><span class="hljs-comment">// Reads the body line = reader.readLine(); byte[] batchedBody = new byte[0]; if ((line != null) || (line.startsWith("--" + boundary) == false)) // &lt;= { batchedBody = line.getBytes(StandardCharsets.UTF_8); } .... }); .... }</span></span></code> </pre> <br>  Der Fehler in diesem Codefragment besteht darin, dass der Aufruf der Methode <i>launchWith unter</i> der Bedingung der <i>if-</i> Anweisung dazu f√ºhrt, dass die <i>NullPointerException-</i> Ausnahme <i>ausgel√∂st</i> wird, wenn die Zeichenfolge aus dem Puffer nicht gelesen wurde.  Dies ist h√∂chstwahrscheinlich ein Tippfehler, und beim Schreiben einer Bedingung meinten Entwickler den Operator <i>&amp;&amp;</i> anstelle von <i>||</i>  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6008</a> M√∂gliche Null-Dereferenzierung von 'followIndexMetadata'.  TransportResumeFollowAction.java (171), TransportResumeFollowAction.java (170), TransportResumeFollowAction.java (194) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( ResumeFollowAction.Request request, String clusterNameAlias, IndexMetaData leaderIndexMetadata, IndexMetaData followIndexMetadata, ....)</span></span></span><span class="hljs-function"> throws IOException </span></span>{ MapperService mapperService = followIndexMetadata != null <span class="hljs-comment"><span class="hljs-comment">// &lt;= ? .... : null; validate(request, leaderIndexMetadata, followIndexMetadata, // &lt;= leaderIndexHistoryUUIDs, mapperService); .... }</span></span></code> </pre> <br>  Eine weitere Warnung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6008-</a> Diagnose.  Das Objekt <i>followIndexMetadata hat</i> mein Interesse geweckt.  Die Startmethode akzeptiert mehrere Argumente als Eingabe, unser Verd√§chtiger ist genau richtig.  Danach wird basierend auf der √úberpr√ºfung unseres Objekts auf <i>Null</i> ein neues Objekt erstellt, das an der weiteren Methodenlogik beteiligt ist.  Die Pr√ºfung auf <i>Null</i> zeigt uns, dass <i>followIndexMetadata</i> immer noch als Null-Objekt von au√üen kommen kann.  Nun, schauen wir weiter. <br><br>  Dann werden mehrere Argumente an die <i>Validierungsmethode</i> gesendet (wieder befindet sich unser betrachtetes Objekt unter ihnen).  Wenn wir uns die Implementierung der Validierungsmethode ansehen, passt alles zusammen.  Unser potenzielles Nullobjekt wird als drittes Argument an die <i>validate-</i> Methode √ºbergeben, wo es bedingungslos dereferenziert wird.  M√∂gliche <i>NullPointerException</i> als Ergebnis. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( final ResumeFollowAction.Request request, final IndexMetaData leaderIndex, final IndexMetaData followIndex, </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">// &lt;= ....) { .... Map&lt;String, String&gt; ccrIndexMetadata = followIndex.getCustomData(....); // &lt;= if (ccrIndexMetadata == null) { throw new IllegalArgumentException(....); } .... }}</span></span></span></span></span></span></code> </pre> <br>  Wir wissen nicht genau, mit welchen Argumenten die <i>Startmethode</i> aufgerufen wird.  Es ist durchaus m√∂glich, dass alle Argumente vor dem Aufruf der Methode irgendwo √ºberpr√ºft werden und keine Nullobjekt-Dereferenzierung auftritt.  Auf jeden Fall sollten wir zugeben, dass eine solche Code-Implementierung immer noch unzuverl√§ssig aussieht und Aufmerksamkeit verdient. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6060</a> Die ' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Knoten'</a> -Referenz wurde verwendet, bevor sie gegen Null verifiziert wurde.  RestTasksAction.java (152), RestTasksAction.java (151) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buildRow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Table table, boolean fullId, boolean detailed, DiscoveryNodes discoveryNodes, TaskInfo taskInfo)</span></span></span><span class="hljs-function"> </span></span>{ .... DiscoveryNode node = discoveryNodes.get(nodeId); .... <span class="hljs-comment"><span class="hljs-comment">// Node information. Note that the node may be null because it has // left the cluster between when we got this response and now. table.addCell(fullId ? nodeId : Strings.substring(nodeId, 0, 4)); table.addCell(node == null ? "-" : node.getHostAddress()); table.addCell(node.getAddress().address().getPort()); table.addCell(node == null ? "-" : node.getName()); table.addCell(node == null ? "-" : node.getVersion().toString()); .... }</span></span></code> </pre> <br>  Eine weitere Diagnoseregel mit dem gleichen Problem wurde hier ausgel√∂st.  <i>NullPointerException</i> .  Die Regel lautet f√ºr Entwickler: "Leute, was machst du?  Wie kannst du das machen?  Oh, es ist schrecklich!  Warum verwenden Sie das Objekt zuerst und pr√ºfen in der n√§chsten Zeile, ob es <i>null</i> ist?  Hier erfahren Sie, wie eine Nullobjekt-Dereferenzierung auftritt.  Leider hat auch der Kommentar eines Entwicklers nicht geholfen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6060</a> Die Referenz "Ursache" wurde verwendet, bevor sie gegen Null verifiziert wurde.  StartupException.java (76), StartupException.java (73) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printStackTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Consumer&lt;String&gt; consumer)</span></span></span><span class="hljs-function"> </span></span>{ Throwable originalCause = getCause(); Throwable cause = originalCause; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cause instanceof CreationException) { cause = getFirstGuiceCause((CreationException)cause); } String message = cause.toString(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= consumer.accept(message); if (cause != null) { // &lt;= // walk to the root cause while (cause.getCause() != null) { cause = cause.getCause(); } .... } .... }</span></span></code> </pre> <br>  In diesem Fall sollten wir ber√ºcksichtigen, dass die <i>getCause-</i> Methode der <i>Throwable-</i> Klasse m√∂glicherweise <i>null</i> <i>zur√ºckgibt</i> .  Das obige Problem wiederholt sich weiter, so dass seine Erkl√§rung unn√∂tig ist. <br><br><h2>  Sinnlose Bedingungen </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6007</a> Ausdruck 's.charAt (i)! =' \ T '' ist immer wahr.  Cron.java (1223) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findNextWhiteSpace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i, String s)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; i &lt; s.length() &amp;&amp; (s.charAt(i) != <span class="hljs-string"><span class="hljs-string">' '</span></span> || s.charAt(i) != <span class="hljs-string"><span class="hljs-string">'\t'</span></span>); i++) { <span class="hljs-comment"><span class="hljs-comment">// intentionally empty } return i; }</span></span></code> </pre> <br>  Die betrachtete Funktion gibt den Index des ersten Leerzeichens beginnend mit dem <i>i-</i> Index zur√ºck.  Was ist los?  Wir haben den Analysator, der warnt, dass <i>s.charAt (i)! = '\ T'</i> immer wahr ist, was den Ausdruck <i>(s.charAt (i)! = '' || s.charAt (i)! = '\ T bedeutet ')</i> wird auch immer wahr sein.  Ist das wahr?  Ich denke, Sie k√∂nnen dies leicht sicherstellen, indem Sie ein beliebiges Zeichen ersetzen. <br><br>  Infolgedessen gibt diese Methode immer den Index zur√ºck, der gleich <i>s.length () ist</i> , was falsch ist.  Ich w√ºrde es wagen vorzuschlagen, dass die obige Methode hier schuld ist: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">skipWhiteSpace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i, String s)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; i &lt; s.length() &amp;&amp; (s.charAt(i) == <span class="hljs-string"><span class="hljs-string">' '</span></span> || s.charAt(i) == <span class="hljs-string"><span class="hljs-string">'\t'</span></span>); i++) { <span class="hljs-comment"><span class="hljs-comment">// intentionally empty } return i; }</span></span></code> </pre> <br>  Die Entwickler haben die Methode implementiert, dann kopiert und unsere fehlerhafte Methode <i>findNextWhiteSpace erhalten,</i> nachdem einige √Ñnderungen vorgenommen wurden.  Sie haben die Methode immer wieder repariert, aber nicht repariert.  Um dies richtig zu machen, sollte man den Operator <i>&amp;&amp;</i> anstelle von <i>|| verwenden</i>  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6007 Der</a> Ausdruck 'verbleibend == 0' ist immer falsch.  PemUtils.java (439) <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> byte[] generateOpenSslKey(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] password, byte[] salt, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> keyLength) { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> copied = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> remaining; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (copied &lt; keyLength) { remaining = keyLength - copied; .... copied += bytesToCopy; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (remaining == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= break; } .... } .... }</span></span></code> </pre> <br>  <i>Anhand</i> der Bedingung der <i>kopierten &lt;keyLength-</i> Schleife k√∂nnen wir feststellen, dass <i>kopiert</i> immer kleiner als <i>keyLength ist</i> .  Daher ist es sinnlos, die verbleibende Variable mit 0 zu vergleichen, und es ist immer falsch. An diesem Punkt wird die Schleife nicht durch eine Bedingung beendet.  Code entfernen oder Verhaltenslogik √ºberdenken?  Ich denke, nur Entwickler werden in der Lage sein, alle Punkte √ºber das i zu setzen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6007 Der</a> Ausdruck 'healthCheckDn.indexOf (' = ')&gt; 0' ist immer falsch.  ActiveDirectorySessionFactory.java (73) <br><br><pre> <code class="cpp hljs">ActiveDirectorySessionFactory(RealmConfig config, SSLService sslService, ThreadPool threadPool) throws LDAPException { super(...., () -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { final String healthCheckDn = ....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (healthCheckDn.isEmpty() &amp;&amp; healthCheckDn.indexOf(<span class="hljs-string"><span class="hljs-string">'='</span></span>) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> healthCheckDn; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ....; }, ....); .... }</code> </pre> <br>  Wieder bedeutungsloser Ausdruck.  Entsprechend der Bedingung muss die Zeichenfolge <i>healthCheckDn</i> leer sein und das Zeichen '=' nicht an der ersten Position enthalten, damit der Lambda-Ausdruck die Zeichenfolgenvariable <i>healthCheckDn zur√ºckgibt</i> .  Puh, das ist alles dann!  Wie Sie wahrscheinlich verstanden haben, ist es unm√∂glich.  Wir werden nicht tief in den Code eintauchen, sondern es dem Ermessen der Entwickler √ºberlassen. <br><br>  Ich habe nur einige der fehlerhaften Beispiele angef√ºhrt, aber dar√ºber hinaus gab es viele diagnostische Ausl√∂sungen des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6007</a> , die einzeln betrachtet werden sollten, um relevante Schlussfolgerungen zu ziehen. <br><br><h2>  Kleine Methode kann einen langen Weg gehen </h2><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> byte </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">char64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x &gt; index_64.length) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index_64[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)x]; }</code> </pre> <br>  Hier haben wir also eine winzige Methode mit mehreren Zeilen.  Aber Bugs sind auf der Hut!  Die Analyse dieser Methode ergab das folgende Ergebnis: <br><br><ol><li>  V6007 Ausdruck '(int) x &lt;0' ist immer falsch.  BCrypt.java (429) </li><li>  V6025 M√∂glicherweise ist der Index '(int) x' au√üerhalb der Grenzen.  BCrypt.java (431) </li></ol><br>  Ausgabe N1.  Der Ausdruck <i>(int) x &lt;0</i> ist immer falsch (Ja, wieder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6007</a> ).  Die Variable <i>x</i> kann nicht negativ sein, da sie vom Typ <i>char ist</i> .  Der <i>Zeichentyp</i> ist eine Ganzzahl ohne Vorzeichen.  Es kann nicht als echter Fehler bezeichnet werden, dennoch ist die Pr√ºfung redundant und kann entfernt werden. <br><br>  Ausgabe N2.  M√∂glicher Array-Index au√üerhalb der Grenzen, was zur Ausnahme <i>ArrayIndexOutOfBoundsException f√ºhrt</i> <i>.</i>  Dann stellt sich die Frage, die an der Oberfl√§che liegt: "Warten Sie, wie w√§re es mit der Indexpr√ºfung?" <br><br>  Wir haben also ein Array mit fester Gr√∂√üe von 128 Elementen: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> final byte index_64[] = { <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">54</span></span>, <span class="hljs-number"><span class="hljs-number">55</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">57</span></span>, <span class="hljs-number"><span class="hljs-number">58</span></span>, <span class="hljs-number"><span class="hljs-number">59</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">61</span></span>, <span class="hljs-number"><span class="hljs-number">62</span></span>, <span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">29</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">34</span></span>, <span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span>, <span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">38</span></span>, <span class="hljs-number"><span class="hljs-number">39</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">43</span></span>, <span class="hljs-number"><span class="hljs-number">44</span></span>, <span class="hljs-number"><span class="hljs-number">45</span></span>, <span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-number"><span class="hljs-number">47</span></span>, <span class="hljs-number"><span class="hljs-number">48</span></span>, <span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">51</span></span>, <span class="hljs-number"><span class="hljs-number">52</span></span>, <span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span> };</code> </pre> <br>  Wenn die <i>char64-</i> Methode die Variable <i>x</i> empf√§ngt, wird die G√ºltigkeit des Index √ºberpr√ºft.  Wo ist der Fehler?  Warum ist ein Array-Index au√üerhalb der Grenzen noch m√∂glich? <br><br>  Die Pr√ºfung (int) x&gt; index_64.length ist nicht ganz korrekt.  Wenn die char64-Methode x mit dem Wert 128 empf√§ngt, sch√ºtzt die Pr√ºfung nicht vor ArrayIndexOutOfBoundsException.  Vielleicht passiert das in der Realit√§t nie.  Die Pr√ºfung ist jedoch falsch geschrieben, und man muss den Operator "gr√∂√üer als" (&gt;) durch "gr√∂√üer als oder gleich (&gt; =)" √§ndern. <br><br><h2>  Vergleiche, die ihr Bestes gaben </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6013 Die</a> Nummern 'displaySize' und 'that.displaySize' werden anhand der Referenz verglichen.  M√∂glicherweise war ein Gleichstellungsvergleich beabsichtigt.  ColumnInfo.java (122) <br><br><pre> <code class="cpp hljs">.... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final String table; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final String esType; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final Integer displaySize; .... @<span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == null || getClass() != o.getClass()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } ColumnInfo that = (ColumnInfo) o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> displaySize == that.displaySize &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= Objects.equals(table, that.table) &amp;&amp; Objects.equals(name, that.name) &amp;&amp; Objects.equals(esType, that.esType); }</span></span></code> </pre> <br>  Was hier falsch ist, ist, dass <i>displaySize-</i> Objekte vom Typ <i>Integer</i> mit dem Operator <i>==</i> verglichen werden, <i>dh als</i> Referenz.  Es ist durchaus m√∂glich, dass <i>ColumnInfo-</i> Objekte <i>verglichen</i> werden, deren <i>displaySize-</i> Felder unterschiedliche Referenzen, aber denselben Inhalt haben.  In diesem Fall liefert der Vergleich das negative Ergebnis, wenn wir erwartet haben, dass es wahr wird. <br><br>  Ich <i>wage</i> zu vermuten, dass ein solcher Vergleich das Ergebnis eines fehlgeschlagenen Refactorings sein k√∂nnte und das Feld <i>displaySize</i> anfangs vom Typ <i>int war</i> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6058</a> Die Funktion 'equals' vergleicht Objekte inkompatibler Typen: Integer, TimeValue.  DatafeedUpdate.java (375) <br><br><pre> <code class="cpp hljs">.... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final TimeValue queryDelay; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final TimeValue frequency; .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> final Integer scrollSize; .... <span class="hljs-function"><span class="hljs-function">boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isNoop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DatafeedConfig datafeed)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (frequency == null || Objects.equals(frequency, datafeed.getFrequency())) &amp;&amp; (queryDelay == null || Objects.equals(queryDelay, datafeed.getQueryDelay())) &amp;&amp; (scrollSize == null || Objects.equals(scrollSize, datafeed.getQueryDelay())) <span class="hljs-comment"><span class="hljs-comment">// &lt;= &amp;&amp; ....) }</span></span></code> </pre> <br>  Wieder falscher Objektvergleich.  Dieses Mal werden Objekte mit inkompatiblen Typen verglichen ( <i>Integer</i> und <i>TimeValue</i> ).  Das Ergebnis dieses Vergleichs ist offensichtlich und immer falsch.  Sie k√∂nnen sehen, dass Klassenfelder miteinander verglichen werden, nur die Namen der Felder m√ºssen ge√§ndert werden.  Hier ist der Punkt: Ein Entwickler hat beschlossen, den Prozess durch Kopieren und Einf√ºgen zu beschleunigen, und einen Fehler in das Gesch√§ft aufgenommen.  Die Klasse implementiert einen Getter f√ºr das <i>scrollSize-</i> Feld. <i>Um</i> den Fehler zu beheben, sollte die Methode <i>datafeed .getScrollSize () verwendet werden.</i> <br><br>  Schauen wir uns ein paar fehlerhafte Beispiele ohne Erkl√§rung an.  Probleme liegen auf der Hand. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6001</a> Links und rechts vom Operator '==' befinden sich identische Unterausdr√ºcke 'takeInMillis'.  TermVectorsResponse.java (152) <br><br><pre> <code class="cpp hljs">@<span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object obj)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index.equals(other.index) &amp;&amp; type.equals(other.type) &amp;&amp; Objects.equals(id, other.id) &amp;&amp; docVersion == other.docVersion &amp;&amp; found == other.found &amp;&amp; tookInMillis == tookInMillis <span class="hljs-comment"><span class="hljs-comment">// &lt;= &amp;&amp; Objects.equals(termVectorList, other.termVectorList); }</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6009</a> Funktion 'gleich' erh√§lt ein ungerades Argument.  Ein Objekt 'shardId.getIndexName ()' wird als Argument f√ºr seine eigene Methode verwendet.  SnapshotShardFailure.java (208) <br><br><pre> <code class="cpp hljs">@<span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shardId.id() == that.shardId.id() &amp;&amp; shardId.getIndexName().equals(shardId.getIndexName()) &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= Objects.equals(reason, that.reason) &amp;&amp; Objects.equals(nodeId, that.nodeId) &amp;&amp; status.getStatus() == that.status.getStatus(); }</span></span></code> </pre> <br><h2>  Verschiedenes </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6006</a> Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schl√ºsselwort 'throw' k√∂nnte fehlen.  JdbcConnection.java (88) <br><br><pre> <code class="cpp hljs">@<span class="hljs-function"><span class="hljs-function">Override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAutoCommit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(boolean autoCommit)</span></span></span><span class="hljs-function"> throws SQLException </span></span>{ checkOpen(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!autoCommit) { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SQLFeatureNotSupportedException(....); } }</code> </pre> <br>  Der Fehler ist offensichtlich und bedarf keiner Erkl√§rung.  Ein Entwickler hat eine Ausnahme erstellt, diese aber nirgendwo anders ausgel√∂st.  Eine solche anonyme Ausnahme wird erfolgreich erstellt und vor allem nahtlos entfernt.  Der Grund ist das Fehlen des <i>Wurfoperators</i> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6003</a> Die Verwendung des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Musters</a> 'if (A) {....} else if (A) {....}' wurde erkannt.  Es besteht die Wahrscheinlichkeit eines logischen Fehlers.  MockScriptEngine.java (94), MockScriptEngine.java (105) <br><br><pre> <code class="cpp hljs">@Override <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context.instanceClazz.equals(FieldScript.class)) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context.instanceClazz.equals(FieldScript.class)) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(context.instanceClazz.equals(TermsSetQueryScript.class)) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context.instanceClazz.equals(NumberSortScript.class)) .... }</code> </pre> <br>  In mehreren <i>F√§llen wird</i> eine der Bedingungen zweimal wiederholt, sodass die Situation eine kompetente <i>Code√ºberpr√ºfung</i> erfordert. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6039</a> Es gibt zwei ' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">if'</a> -Anweisungen mit identischen bedingten Ausdr√ºcken.  Die erste 'if'-Anweisung enth√§lt die Methodenr√ºckgabe.  Dies bedeutet, dass die zweite 'if'-Anweisung sinnlos ist.  SearchAfterBuilder.java (94), SearchAfterBuilder.java (93) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SearchAfterBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSortValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object[] values)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; values.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] == null) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof String) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Text) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Long) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Integer) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Short) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Byte) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Double) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Float) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (values[i] instanceof Boolean) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= if (values[i] instanceof Boolean) continue; // &lt;= throw new IllegalArgumentException(....); } .... }</span></span></code> </pre> <br>  Die gleiche Bedingung wird zweimal hintereinander verwendet.  Ist die zweite Bedingung √ºberfl√ºssig oder sollte anstelle von <i>Boolean ein</i> anderer Typ verwendet werden? <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V6009 Die</a> Funktion 'Teilzeichenfolge' empf√§ngt ungerade Argumente.  Das Argument 'queryStringIndex + 1' sollte nicht gr√∂√üer als 'queryStringLength' sein.  LoggingAuditTrail.java (660) <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">LogEntryBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">withRestUriAndMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RestRequest request)</span></span></span><span class="hljs-function"> </span></span>{ final <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> queryStringIndex = request.uri().indexOf(<span class="hljs-string"><span class="hljs-string">'?'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> queryStringLength = request.uri().indexOf(<span class="hljs-string"><span class="hljs-string">'#'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryStringLength &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { queryStringLength = request.uri().length(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryStringIndex &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { logEntry.with(....); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { logEntry.with(....); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (queryStringIndex &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>) { logEntry.with(...., request.uri().substring(queryStringIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-comment"><span class="hljs-comment">// &lt;= queryStringLength)); // &lt;= } .... }</span></span></code> </pre> <br>  Betrachten wir hier das fehlerhafte Szenario, das die Ausnahme <i>StringIndexOutOfBoundsException</i> verursachen <i>kann</i> .  Die Ausnahme tritt auf, wenn <i>request.uri ()</i> eine Zeichenfolge zur√ºckgibt, die das Zeichen '#' vor '?' Enth√§lt.  Es gibt keine √úberpr√ºfungen in der Methode. In diesem Fall brauen sich die Probleme zusammen.  M√∂glicherweise wird dies aufgrund verschiedener √úberpr√ºfungen des Objekts au√üerhalb der Methode niemals passieren, aber es ist nicht die beste Idee, Hoffnungen darauf zu setzen. <br><br><h2>  Fazit </h2><br>  Seit vielen Jahren hilft PVS-Studio dabei, Fehler im Code von kommerziellen und kostenlosen Open-Source-Projekten zu finden.  Erst k√ºrzlich wurde Java in die Liste der unterst√ºtzten Sprachen f√ºr die Analyse aufgenommen.  Elasticsearch wurde einer der ersten Tests f√ºr unseren Newcomer.  Wir hoffen, dass dieser Check f√ºr das Projekt n√ºtzlich und f√ºr die Leser interessant ist. <br><br>  PVS-Studio f√ºr Java ben√∂tigt neue Herausforderungen, neue Benutzer, aktives Feedback und Kunden, um sich schnell an die neue Welt anzupassen :).  Deshalb lade ich Sie ein, unseren Analysator sofort f√ºr Ihr Arbeitsprojekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunterzuladen</a> und zu testen! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de445674/">https://habr.com/ru/post/de445674/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de445662/index.html">Tick-tock: Die Zeit der Smartwatch ist vorbei, aber jetzt geben sie vor, Armb√§nder zu sein</a></li>
<li><a href="../de445666/index.html">Wir brauchen einen vorgefertigten Juni - unterrichten Sie ihn selbst oder wie wir einen Seminarkurs f√ºr Studenten gestartet haben</a></li>
<li><a href="../de445668/index.html">Neoquest 2019: Verbindung mit dem Himmel</a></li>
<li><a href="../de445670/index.html">Folgen des Umschreibens von Firefox-Komponenten in Rust</a></li>
<li><a href="../de445672/index.html">Myonenkatalyse in Bezug auf die Quantenchemie. Teil II: elektronisch vs. Myon chemische Bindung</a></li>
<li><a href="../de445676/index.html">Neu in Git 3: Schlie√üungen</a></li>
<li><a href="../de445678/index.html">4. Check Point Erste Schritte R80.20. Installation und Initialisierung</a></li>
<li><a href="../de445680/index.html">Neues Feature in Git 3: Schlie√üungen</a></li>
<li><a href="../de445682/index.html">PVS-Studio f√ºr Java wird an den Pfad gesendet. N√§chster Halt ist Elasticsearch</a></li>
<li><a href="../de445684/index.html">Monoblock gegen modulare USV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>