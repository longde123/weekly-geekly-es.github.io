<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎨 😋 🚠 390k. sites Web avec dossier .git ouvert 🤝 🤷 🔖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En juillet, le chercheur en sécurité Vladimir Smitka a décidé de vérifier sur Internet la présence de dossiers .git ouverts après qu'un audit similair...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>390k. sites Web avec dossier .git ouvert</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422725/"><p> En juillet, le chercheur en sécurité Vladimir Smitka a décidé de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vérifier sur Internet</a> la présence de dossiers <code>.git</code> ouverts après qu'un audit similaire ait été récemment mené pour les domaines Internet en République tchèque et en Slovaquie. </p><br><p><img src="https://habrastorage.org/webt/n2/8e/z-/n28ez-yrtekgvoihoembcicn4uc.png" alt="fuite"></p><br><p>  Comme le dit le proverbe: "cela ne s'est jamais produit, et le voici à nouveau."  Permettez-moi de vous rappeler, il y a 9 ans, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exactement la même histoire</a> avec le segment russe d'Internet touché par le syndrome de <code>.svn</code> ouvert.  Voici les résultats du travail minutieux d'un chercheur tchèque, des outils et des méthodes. </p><a name="habracut"></a><br><h1 id="prichiny-nalichiya-uyazvimosti">  Raisons de la vulnérabilité </h1><br><p>  Un attaquant peut extraire de nombreuses informations critiques pour la sécurité du site à partir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du répertoire</a> <code>.git</code> .  Voici à quoi ressemble une arborescence de projet typique. </p><br><pre> <code class="diff hljs">├── HEAD ├── branches ├── config ├── description ├── hooks │ ├── pre-commit.sample │ ├── pre-push.sample │ └── ... ├── info │ └── exclude ├── objects │ ├── info │ └── pack └── refs ├── heads └── tags</code> </pre> <br><p>  Les mots de passe et les clés d'accès à diverses API, bases de données et services cloud peuvent y être stockés. </p><br><p>  Souvent, comme prévu, une tentative d'ouverture du dossier <code>.git</code> génère une erreur HTTP 403, mais la raison est simplement le manque d' <code>index.html / index.php</code> et les droits d'indexation automatique du dossier, tandis que <strong>des fichiers individuels sont toujours disponibles</strong> .  Afin de vous assurer que le site n'est pas vulnérable, vous devez ouvrir la page <strong><code>/.git/HEAD</code></strong> . </p><br><p>  Ce fichier contient un lien vers la branche de projet actuelle. </p><br><pre> <code class="hljs cs">$ cat .git/HEAD <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span>: refs/heads/master</code> </pre> <br><p>  Même si l'indexation automatique des répertoires est désactivée, <strong>vous pouvez facilement restaurer l'intégralité</strong> <code>.git</code> <strong>dossier</strong> <code>.git</code> <strong>en</strong> téléchargeant des fichiers individuels et en déterminant les dépendances par le processeur d'expressions régulières, car la structure <code>.git</code> est clairement définie.  Il existe également un outil spécial - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitTools</a> , qui effectue automatiquement toutes les actions nécessaires. </p><br><h1 id="sredstva-proizvodstva">  Moyens de production </h1><br><p>  Malgré la complexité et l'ambition de la tâche, les coûts en termes d'argent étaient modestes.  Pour tout, pour tout, il a fallu 250 dollars américains. </p><br><h2 id="servera">  Serveur </h2><br><p>  Smithka a loué pour le projet 18 VPS et 4 serveurs physiques.  Selon lui, son choix n'est pas tombé sur AWS car le coût total du service, compte tenu des gigantesques volumes de trafic attendus, de l'espace disque important et des charges CPU élevées, n'a pas pu être facilement calculé.  Le prix des VPS loués a été fixé à l'avance. </p><br><h2 id="spisok-domenov">  Liste des domaines </h2><br><p>  La liste est basée sur les journaux de texte du projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenData Rapid7</a> au <code>JSON</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Transférer le schéma de la base de données DNS</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"$id"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://opendata.rapid7.com/sonar.fdns_v2/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"definitions"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"additionalProperties"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$id"</span></span>: <span class="hljs-string"><span class="hljs-string">"/properties/timestamp"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The time when this response was received in seconds since the epoch"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$id"</span></span>: <span class="hljs-string"><span class="hljs-string">"/properties/name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The record name"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$id"</span></span>: <span class="hljs-string"><span class="hljs-string">"/properties/type"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The record type"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$id"</span></span>: <span class="hljs-string"><span class="hljs-string">"/properties/value"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The response received for a record of the given name and type"</span></span> } } }</code> </pre> </div></div><br><p>  Après un certain filtrage des TLD et des domaines de deuxième niveau, la liste comptait encore <strong>plus de 230 millions d'entrées</strong> . </p><br><p>  Ensuite, la base de données a été divisée en blocs de 2 millions d'enregistrements et la charge a été répartie sur différents serveurs à l'aide d'une application PHP. </p><br><h2 id="soft">  Logiciels </h2><br><p>  Python était suspendu aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bibliothèques de</a> communication <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://aio">asyncio</a> async avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://aio">aiohttp</a> comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://aio">cheval de bataille</a> .  Une tentative d'utilisation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Requests</a> et d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Urllib3</a> à ces fins a échoué, dont la première aurait bien pu convenir, mais le chercheur n'a pas compris les délais d'attente dans la documentation.  Le second n'a pas géré la redirection de domaine, et pour cette raison, la mémoire des serveurs a été épuisée très rapidement. </p><br><p>  Pour identifier la plateforme et le profil des sites vulnérables, Smitha a utilisé l'utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WAD</a> , basé sur la base de données <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wappalyzer</a> , une extension pour le navigateur Web qui vous permet de déterminer les technologies utilisées sur la page. </p><br><p>  Des utilitaires de ligne de commande simples comme <code>GNU Parallels</code> ont également été utilisés pour accélérer le temps d'exécution du gestionnaire et empêcher l'arrêt du script en raison d'un blocage unique. </p><br><pre> <code class="hljs powershell">cat sites.txt | parallel -<span class="hljs-literal"><span class="hljs-literal">-bar</span></span> -<span class="hljs-literal"><span class="hljs-literal">-tmpdir</span></span> ./wad -<span class="hljs-literal"><span class="hljs-literal">-files</span></span> wad <span class="hljs-literal"><span class="hljs-literal">-u</span></span> {} <span class="hljs-operator"><span class="hljs-operator">-f</span></span> csv</code> </pre> <br><h1 id="rezultaty">  Résultats </h1><br><p>  Le scan a duré 2 semaines, en conséquence, le chercheur: </p><br><ul><li>  découvert 390 000 sites Web vulnérables; </li><li>  290 000 adresses e-mail collectées; </li><li>  a informé 90 000 destinataires de la vulnérabilité trouvée. </li></ul><br><p>  En réponse à ses efforts, Smithka a reçu: </p><br><ul><li>  18 mille erreurs de livraison de messages; <br><ul><li>  environ 2000 lettres de remerciements; </li><li>  30 fausses alarmes avec des systèmes de pots de miel; </li><li>  1 menace d'appeler la police canadienne; </li></ul></li></ul><br><p><img src="https://habrastorage.org/webt/i9/m8/ur/i9m8urwuwnqdxyctjkf7wwzuyyu.png" alt="plate-forme"></p><br><p>  Le langage de programmation le plus populaire s'est avéré être <strong>PHP</strong> .  Cependant, si vous normalisez le résultat à la part relative d'un PL particulier, alors PHP cède la place à la tête de Python et Node.js.  Cependant, la fiabilité de ces statistiques pour déterminer la part de marché d'un langage de programmation donné n'est pas claire. </p><br><p>  <strong>Apache</strong> est en haut de la liste de la popularité des serveurs Web, avec Nginx à la deuxième place et le clone chinois Nginx <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tengine</a> à la troisième place. </p><br><p>  L'OS le plus populaire était <strong>Ubuntu</strong> , puis Debian et CentOS en troisième place. </p><br><p><img src="https://habrastorage.org/webt/0m/0_/c6/0m0_c6twa-m7jul3thwbrsyxyjm.png" alt="OS"></p><br><p>  La nomination CMS s'est presque révélée être un théâtre à acteur unique, et cet acteur est <strong>WordPress</strong> avec 85% de toutes les plateformes trouvées. </p><br><h1 id="chto-zhe-dalshe">  Et ensuite </h1><br><p>  Réparer une vulnérabilité est facile. </p><br><h2 id="htaccess">  .htaccess </h2><br><pre> <code class="hljs apache"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteRule</span></span></span></span> <span class="hljs-string"><span class="hljs-string">"(^|/)\.(?!well-known\/)"</span></span> -<span class="hljs-meta"><span class="hljs-meta"> [F]</span></span></code> </pre> <br><h2 id="nginx">  .nginx </h2><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">location</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ /\.(?!well-known\/)</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">deny</span></span> all; }</code> </pre> <br><h2 id="apache22conf">  apache22.conf </h2><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;Directory ~ "/\.(?!well-known\/)"&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Order</span></span></span></span> deny,allow Deny from <span class="hljs-literal"><span class="hljs-literal">all</span></span> &lt;/Directory&gt;</code> </pre> <br><h2 id="apache24conf">  apache24.conf </h2><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;Directory ~ "/\.(?!well-known\/)"&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">Require</span></span> <span class="hljs-literal"><span class="hljs-literal">all</span></span> denied &lt;/Directory&gt;</code> </pre> <br><h2 id="caddyfile">  Caddyfile </h2><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">status</span></span> <span class="hljs-number"><span class="hljs-number">403</span></span> /blockdot rewrite { <span class="hljs-attribute"><span class="hljs-attribute">r</span></span> /\.(?!well-known\/) to /blockdot }</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422725/">https://habr.com/ru/post/fr422725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422715/index.html">La non-discrimination est la valeur fondamentale de l'open source</a></li>
<li><a href="../fr422717/index.html">Développement d'un chat bot avec une personnalité donnée. Conférence à Yandex</a></li>
<li><a href="../fr422719/index.html">Les attaquants ont compromis des milliers de routeurs MikroTik pour créer un botnet</a></li>
<li><a href="../fr422721/index.html">KivyMD - la vie continue</a></li>
<li><a href="../fr422723/index.html">GAN a appris à créer des visages avec une texture et une géométrie réalistes</a></li>
<li><a href="../fr422729/index.html">Comment un fournisseur de cloud peut-il gérer les licences logicielles et quelles solutions de blockchain peuvent fournir ici</a></li>
<li><a href="../fr422731/index.html">DEFCON 17. Piratage de 400 000 mots de passe, ou comment expliquer à un colocataire pourquoi la facture d'électricité a augmenté. Partie 1</a></li>
<li><a href="../fr422735/index.html">DEFCON 17. Piratage de 400 000 mots de passe, ou comment expliquer à un colocataire pourquoi la facture d'électricité a augmenté. 2e partie</a></li>
<li><a href="../fr422737/index.html">Antiquités: des cassettes audio que nous n'avons pas perdues</a></li>
<li><a href="../fr422739/index.html">Les centrales éoliennes et solaires du Sahara contribueront à améliorer le climat dans le désert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>