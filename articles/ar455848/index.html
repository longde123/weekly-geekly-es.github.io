<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จโ๐ค โ ๐ ุชูููุฉ ูุชุฌูุจ ุณููู ุบูุฑ ูุญุฏุฏ ุนูุฏ ุงููุตูู ุฅูู ููุฑุฏุฉ โ๏ธ ๐ โช๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุชูุงูู ูุฐู ุงูููุงูุฉ ุฃุณุจุงุจ ูุทุฑู ุชุฌูุจ ุงูุณููู ุบูุฑ ุงููุญุฏุฏ ุนูุฏ ุงููุตูู ุฅูู ููุฑุฏุฉ ูู c ++ ุงูุญุฏูุซุฉ. ูุชู ุชูููุฑ ุฃูุซูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฑุฏ. ูุง ุดูุก ูุชุฑุฌู ูุญุฏ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชูููุฉ ูุชุฌูุจ ุณููู ุบูุฑ ูุญุฏุฏ ุนูุฏ ุงููุตูู ุฅูู ููุฑุฏุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455848/" style=";text-align:right;direction:rtl">  ุชุชูุงูู ูุฐู ุงูููุงูุฉ ุฃุณุจุงุจ ูุทุฑู ุชุฌูุจ ุงูุณููู ุบูุฑ ุงููุญุฏุฏ ุนูุฏ ุงููุตูู ุฅูู ููุฑุฏุฉ ูู c ++ ุงูุญุฏูุซุฉ.  ูุชู ุชูููุฑ ุฃูุซูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฑุฏ.  ูุง ุดูุก ูุชุฑุฌู ูุญุฏุฏุฉ ุ ูู ุฐูู ูููุง ูููุนูุงุฑ. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h3><br>  ููุจุฏุก ุ ุฃูุตู ุจุฃู ุชูุฑุฃ ููุงูุงุช ุฃุฎุฑู ุนู ุณููุฌูุชูู ุนูู ุญุจุฑู: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุซูุงุซุฉ ุณููู ูู ููุท Singleton</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณููุฌูุชูู ูุงูุญุงูุงุช ุงููุดุชุฑูุฉ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">3 ุทุฑู ููุณุฑ ูุจุฏุฃ ุงููุณุคูููุฉ ุงููุฑุฏูุฉ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณููุฌูุชูู - ููุท ุฃู ูุถุงุฏุงุชุ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงุณุชุฎุฏุงู ููุท ุงูููุฑุฏ</a> <br><br>  ูุฃุฎูุฑูุง ุ ููุงู ุชุทุฑู ุฅูู ููุณ ุงูููุถูุน ุ ูููู ุชุจุงุทุฃ (ููุท ุจุณุจุจ ุนุฏู ูุฑุงุนุงุฉ ุงูุนููุจ ูุงููููุฏ): <br>  ูุงุฆูุงุช tialized (ุฃู ุ ุงููุงุฆูุงุช <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููุฑุฏุฉ ูุงููุงุฆู ุงูุนูุฑ</a> <br><br>  ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฐุง <b>ููุณ</b> ููุงููุง ุนู ุงูุฎุตุงุฆุต ุงููุนูุงุฑูุฉ ูู singleton ุ </li><li style=";text-align:right;direction:rtl">  ูุฐุง <b>ููุณ</b> ููุงููุง "ููู ูุตูุน ูููุฑุฏูุง ุฃุจูุถ ูุฑููููุง ูู ููุฑุฏุฉ ูุธูุนุฉ ูุฑููุจุฉ" ุ </li><li style=";text-align:right;direction:rtl">  ูุฐู <b>ููุณุช</b> ุญููุฉ ูุฑุฏูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงููุง <b>ููุณุช</b> ุญููุฉ ุตููุจูุฉ ุถุฏ ุงูููุฑุฏ. </li><li style=";text-align:right;direction:rtl">  ูุฐุง <b>ููุณ</b> ููุงู ููุงูุฉ ุณุนูุฏุฉ. </li></ul><br>  ูุฐู ุงูููุงูุฉ ุชุฏูุฑ ุญูู ุฌุงูุจ ูุงุญุฏ ููู ููุบุงูุฉ ุ ูููู ูุง ูุฒุงู ุงูุฌุงูุจ ุงูุชููู ูุงุณุชุฎุฏุงู ุงูููุฑุฏ ูู C ++ ุงูุญุฏูุซุฉ.  ูุชู ุฅููุงุก ุงูุงูุชูุงู ุงูุฑุฆูุณู ูู ุงูููุงู ูุญุธุฉ ุชุฏููุฑ ุงูููุฑุฏ ุ ููุง  ูู ูุนุธู ุงููุตุงุฏุฑ ุ ูุชู ุงููุดู ุนู ูุถูุฉ ุงูุชุฏููุฑ ุจุดูู ุณูุก.  ุนุงุฏุฉ ุ ูุชู ุงูุชุฑููุฒ ุนูู ุงููุญุธุฉ ุงูุชู ุชู ูููุง ุฅูุดุงุก ุงูููุฑุฏ ุ ูุญูู ุงูุชุฏููุฑ ุ ูู ุฃุญุณู ุงูุฃุญูุงู ุ ูุฅูู ูููู ุดูุฆูุง ูุซู "ุชู ุชุฏููุฑู ุจุชุฑุชูุจ ุนูุณู". <br><br>  <b>ุณูู ุฃุทูุจ ููู ุงุชุจุงุน ูุทุงู ุงูููุงูุฉ ูู ุงูุชุนูููุงุช ุ ุฎุงุตุฉู ุนุฏู ุชุฑุชูุจ ููุท ุงูููุฑุฏ ููุงุจู holivar ุงูููุฑุฏ.</b> <br><br>  ูุฐูู ุฏุนููุง ูุฐูุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุงุฐุง ูููู ุงููุนูุงุฑ </h3><br>  ููููุช ูู ูู C + 14 ุงููุณูุฏุฉ ุงูููุงุฆูุฉ N3936 ุ ููุง  ูุณูุฏุงุช C ++ 17 ุงููุชุงุญุฉ ุบูุฑ ูุญุฏุฏุฉ "ููุงุฆูุฉ". <br>  ุฃุนุทู ุงููุณู ุงูุฃูุซุฑ ุฃูููุฉ ูู ูุฌูููุง.  ูุชู ุชุณููุท ุงูุถูุก ุนูู ุงูุฃูุงูู ุงููุงูุฉ ูู ูุจูู. <br><br><blockquote style=";text-align:right;direction:rtl">  3.6.3 ุงูุฅููุงุก [basic.start.term] <br><br>  1. ูุชู ุงุณุชุฏุนุงุก ุงููุฏูุฑุงุช (12.4) ูููุงุฆูุงุช ุงูุชู ุชูุช ุชููุฆุชูุง (ุฃู ุงููุงุฆูุงุช ุงูุชู ุจุฏุฃ ุนูุฑูุง ุงูุงูุชุฑุงุถู (3.8)) ูุน ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ููุชูุฌุฉ ููุนูุฏุฉ ูู ุงูุฑุฆูุณู ููุชูุฌุฉ ูุงุณุชุฏุนุงุก std :: exit (18.5).  ูุชู ุงุณุชุฏุนุงุก ูุฏูุฑุงุช ุงููุงุฆูุงุช ุงูุชู ุชูุช ุชููุฆุชูุง ูุงูุชู ููุง ูุฏุฉ ุชุฎุฒูู ููุคุดุฑ ุชุฑุงุจุท ุถูู ูุคุดุฑ ุชุฑุงุจุท ูุนูู ููุชูุฌุฉ ููุนูุฏุฉ ูู ุงููุธููุฉ ุงูุฃูููุฉ ููุคุดุฑ ุงูุชุฑุงุจุท ููุชูุฌุฉู ูุฐูู ุงุณุชุฏุนุงุก ูุคุดุฑ ุงูุชุฑุงุจุท std :: exit.  <b>ูุชู ุฅููุงู ุชุณูุณู ุนูููุงุช ุงูุชุฏููุฑ ููู ุงููุงุฆูุงุช ุงูุชู ุชูุช ุชููุฆุชูุง ูุงูุชู ููุง ูุฏุฉ ุชุฎุฒูู ููุคุดุฑ ุงูุชุฑุงุจุท ุถูู ูุฐุง ุงูุฎูุท ูุจู ุจุฏุก ุฃุฏูุงุช ุงูุชุฏููุฑ ูุฃู ูุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ.</b>  <b>ุฅุฐุง ุชู ุฅููุงู ุชุณูุณู ุงููููุดุฆ ุฃู ุงูุชููุฆุฉ ุงูุฏููุงููููุฉ ููุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ูุคุดุฑ ุชุฑุงุจุท ูุจู ุงูุขุฎุฑ ุ ูุณูุชู ุฅููุงู ุชุณูุณู ุงููุฏูุฑ ุงูุซุงูู ูุจู ุจุฏุก ุงููุฏูุฑ ุงูุฃูู.</b>  <b>ุฅุฐุง ุชู ุฅููุงู ุชุณูุณู ุงููููุดุฆ ุฃู ุงูุชููุฆุฉ ุงูุฏููุงููููุฉ ููุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ูุจู ุฃุฎุฑู ุ ูุณูุชู ุฅููุงู ุชุณูุณู ุงููุฏูุฑุฉ ุงูุซุงููุฉ ูุจู ุจุฏุก ุงููุฏูุฑ ุงูุฃูู.</b>  [ููุงุญุธุฉ: ูุฐุง ุงูุชุนุฑูู ูุณูุญ ุจุงูุชุฏููุฑ ุงููุชุฒุงูู.  โููุงุญุธุฉ] ุฅุฐุง ุชู ุชููุฆุฉ ูุงุฆู ุจุดูู ุซุงุจุช ุ ูุชู ุฅุชูุงู ุงููุงุฆู ุจููุณ ุงูุชุฑุชูุจ ููุง ูู ุชู ุชููุฆุฉ ุงููุงุฆู ุฏููุงูููููุง.  ุจุงููุณุจุฉ ููุงุฆู ุงูุตููู ุฃู ููุน ุงููุฆุฉ ุ ูุชู ุฅุชูุงู ูุงูุฉ ุงููุดุงุฑูุน ุงููุฑุนูุฉ ูุฐูู ุงููุงุฆู ูุจู ุฅุชูุงู ุฃู ูุงุฆู ูุทุงู ูุชูุฉ ูู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ูุชู ุชููุฆุชูุง ุฃุซูุงุก ุฅูุดุงุก ุงููุดุงุฑูุน ุงููุฑุนูุฉ.  ุฅุฐุง ุชู ุฅููุงุก ุชุฏููุฑ ูุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุช ุฃู ุฎูุท ุชุฎุฒูู ูุคูุช ุนุจุฑ ุงุณุชุซูุงุก ุ ูุณูุชู ุงุณุชุฏุนุงุก std :: terminate (15.5.1). <br><br>  2. <b>ุฅุฐุง ูุงูุช ุงููุธููุฉ ุชุญุชูู ุนูู ูุงุฆู ูุชูุฉ ูุทุงู ุซุงุจุช ุฃู ูุฏุฉ ุชุฎุฒูู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุชู ุชู ุชุฏููุฑูุง ูุชุณูู ุงููุธููุฉ ุฃุซูุงุก ุชุฏููุฑ ูุงุฆู ูุน ูุฏุฉ ุชุฎุฒูู ุซุงุจุช ุฃู ุซุงุจุช ุ ูุฅู ุงูุจุฑูุงูุฌ ูุฏูู ุณููู ุบูุฑ ูุญุฏุฏ ุฅุฐุง ูุฑ ุชุฏูู ุงูุชุญูู ูู ุฎูุงู ุชุนุฑูู ูุงุฆู blockscope ุงููุฏูุฑ ูุณุจููุง.</b>  ูุจุงููุซู ุ ูุฅู ุงูุณููู ุบูุฑ ูุนุฑู ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ูุงุฆู ูุชูุฉ ุงููุทุงู ุจุดูู ุบูุฑ ูุจุงุดุฑ (ุฃู ูู ุฎูุงู ูุคุดุฑ) ุจุนุฏ ุชุฏููุฑู. <br><br>  <b>3. ูู ุญุงูุฉ ุฅุฌุฑุงุก ุชุณูุณู ูุงุณุชููุงู ุชููุฆุฉ ูุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ูุจู ุงุณุชุฏุนุงุก std :: atexit (ุงูุธุฑ "cstdlib" ุ 18.5) ุ ูุชู ุชุฑุชูุจ ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู std :: atexit ูุจู ุงูููุงููุฉ ุฅูู ุงููุฏูุฑ ูููุงุฆู.</b>  <b>ุฅุฐุง ุชู ุฅุฌุฑุงุก ุชุณูุณู ุงุณุชุฏุนุงุก std :: atexit ูุจู ุฅุชูุงู ุชููุฆุฉ ูุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ุ ูุฅู ุงูุชุณูุณู ุฅูู destructor ูููุงุฆู ูุชู ุชุณูุณูู ูุจู ุฃู ูุชู ุชูุฑูุฑ ุงูุงุณุชุฏุนุงุก ููุฏุงูุฉ ุฅูู std :: atexit.</b>  <b>ุฅุฐุง ุชู ุฅุฌุฑุงุก ุชุณูุณู ูุงุณุชุฏุนุงุก std :: atexit ูุจู ุฅุฌุฑุงุก ููุงููุฉ ุฃุฎุฑู ุฅูู std :: atexit ุ ูุชู ุฅุฌุฑุงุก ุงุณุชุฏุนุงุก ูููุธููุฉ ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู ุงูููุงููุฉ std :: atexit ุงูุซุงููุฉ ูุจู ุชุณูุณู ุงุณุชุฏุนุงุก ุงููุธููุฉ ุฅูู ุงูููุงููุฉ std :: atexit ุงูุฃููู .</b> <br><br>  4. ุฅุฐุง ูุงู ููุงู ุงุณุชุฎุฏุงู ููุงุฆู ุฃู ูุธููุฉ ููุชุจุฉ ููุงุณูุฉ ุบูุฑ ูุณููุญ ุจูุง ุฏุงุฎู ูุนุงูุฌุงุช ุงูุฅุดุงุฑุฉ (18.10) ูุง ูุญุฏุซ ูุจู (1.10) ุงูุงูุชูุงุก ูู ุชุฏููุฑ ุงููุงุฆูุงุช ุฐุงุช ูุฏุฉ ุงูุชุฎุฒูู ุงูุซุงุจุชุฉ ูุชูููุฐ ุงููุธุงุฆู ุงููุณุฌูุฉ std :: atexit (18.5) ) ุ ุงูุจุฑูุงูุฌ ูุฏูู ุณููู ุบูุฑ ูุญุฏุฏ.  [ููุงุญุธุฉ: ุฅุฐุง ูุงู ููุงู ุงุณุชุฎุฏุงู ููุงุฆู ุฐู ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ูุง ูุญุฏุซ ูุจู ุชุฏููุฑ ุงููุงุฆู ุ ูุฅู ุงูุจุฑูุงูุฌ ูุฏูู ุณููู ุบูุฑ ูุญุฏุฏ.  ุฅููุงุก ูู ูุคุดุฑ ุชุฑุงุจุท ูุจู ุงุณุชุฏุนุงุก std :: exit ุฃู ุงูุฎุฑูุฌ ูู main ูููู ุ ูููู ููุณ ูู ุงูุถุฑูุฑู ุ ูุชูุจูุฉ ูุฐู ุงููุชุทูุจุงุช.  ุชุณูุญ ูุฐู ุงููุชุทูุจุงุช ููุฏุฑุงุก ุณูุงุณู ุงูุนูููุงุช ููุงุฆูุงุช ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ.  -ููุงุญุธุฉ] <br><br>  5. ุงุณุชุฏุนุงุก ุฏุงูุฉ std :: abort () ุงููุนููุฉ ูู "cstdlib" ูููู ุงูุจุฑูุงูุฌ ุฏูู ุชูููุฐ ุฃู ูุฏูุฑุงุช ูุฏูู ุงุณุชุฏุนุงุก ุงููุธุงุฆู ุงูุชู ุชู ุชูุฑูุฑูุง ุฅูู std :: atexit () ุฃู std :: at_quick_exit (). </blockquote>  ุชูุณูุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุชูููุฐ ุชุฏููุฑ ุงููุงุฆูุงุช ุฐุงุช ูุฏุฉ ุชุฎุฒูู ุงูุฎููุท ุจุงูุชุฑุชูุจ ุงูุนูุณู ูุฅูุดุงุฆูุง ุ </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุจุฏูุฉ ุ ูุชู ุชุฏููุฑ ุงููุงุฆูุงุช ุฐุงุช ูุฏุฉ ุงูุชุฎุฒูู ุงูุซุงุจุชุฉ ููุชู ุฅุฌุฑุงุก ุงูููุงููุงุช ุฅูู ุงููุธุงุฆู ุงููุณุฌูุฉ ูุน std :: atexit ุจุงูุชุฑุชูุจ ุงูุนูุณู ูุฅูุดุงุก ูุซู ูุฐู ุงููุงุฆูุงุช ูุชุณุฌูู ูุฐู ุงููุธุงุฆู ุ </li><li style=";text-align:right;direction:rtl">  ุชุญุชูู ูุญุงููุฉ ุงููุตูู ุฅูู ูุงุฆู ูุนุทูุจ ูุน ูุฏุฉ ุชุฎุฒูู ูุคุดุฑ ุชุฑุงุจุท ุฃู ูุฏุฉ ุชุฎุฒูู ุซุงุจุช ุนูู ุณููู ุบูุฑ ูุญุฏุฏ.  ูู ูุชู ุชูููุฑ ุฅุนุงุฏุฉ ุชููุฆุฉ ูุฐู ุงููุงุฆูุงุช. </li></ul><br>  ููุงุญุธุฉ: ูุดุงุฑ ุฅูู ุงููุชุบูุฑุงุช ุงูุนุงูุฉ ูู ุงููุนูุงุฑ ุจุงุณู "ุงููุชุบูุฑ ุบูุฑ ุงููุญูู ูุน ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ".  ูุชูุฌุฉู ูุฐูู ุ ุงุชุถุญ ุฃู ุฌููุน ุงููุชุบูุฑุงุช ุงูุนุงูุฉ ูุฌููุน ุงูุฃุญุงุฏูุงุช (ุงูุฅุญุตุงุฆูุงุช ุงููุญููุฉ) ูุฌููุน ุงูููุงููุงุช ุฅูู std :: atexit ุชูุน ูู ูุงุฆูุฉ ุงูุชุธุงุฑ LIFO ูุงุญุฏุฉ ุนูุฏ ุฅูุดุงุฆูุง / ุชุณุฌูููุง. <br><br>  ูุชุฑุฏ ุงููุนูููุงุช ุงููููุฏุฉ ููุฐู ุงููุงุฏุฉ ุฃูุถูุง ูู ุงููุณู <b>3.6.2 ุชููุฆุฉ ุงููุชุบูุฑุงุช ุบูุฑ ุงููุญููุฉ [basic.start.init]</b> .  ุฃุญูู ููุท ุฃูู: <br><blockquote style=";text-align:right;direction:rtl">  ุงูุชููุฆุฉ ุงูุฏููุงููููุฉ ููุชุบูุฑ ุบูุฑ ูุญูู ูุน ูุฏุฉ ุชุฎุฒูู ุซุงุจุชุฉ ุฅูุง ูุฑุชุจุฉ ุฃู ุบูุฑ ูุฑุชุจุฉ.  [...] ูุฌุจ ุชููุฆุฉ ุงููุชุบูุฑุงุช ุฐุงุช ุงูุชููุฆุฉ ุงููุทููุจุฉ ุงููุนุฑูุฉ ุถูู ูุญุฏุฉ ุชุฑุฌูุฉ ูุงุญุฏุฉ ุจุชุฑุชูุจ ุชุนุฑููุงุชูุง ูู ูุญุฏุฉ ุงูุชุฑุฌูุฉ. </blockquote>  ุงูุชูุณูุฑ (ูุน ูุฑุงุนุงุฉ ุงููุต ุงููุงูู ูููุณู): ุชุชู ุชููุฆุฉ ุงููุชุบูุฑุงุช ุงูุนุงูุฉ ุฏุงุฎู ูุญุฏุฉ ุชุฑุฌูุฉ ูุงุญุฏุฉ ุจุชุฑุชูุจ ุงูุฅุนูุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุงุฐุง ุณูููู ูู ุงูููุฏ </h3><br>  ูุชู ูุดุฑ ุฌููุน ุฃูุซูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุงุฑุฏุฉ ูู ุงูููุงูุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุซุจ</a> . <br><br>  ูุชููู ุงูููุฏ ูู ุซูุงุซ ุทุจูุงุช ุ ููุง ูู ูุงู ููุชูุจูุง ุจูุงุณุทุฉ ุฃุดุฎุงุต ูุฎุชูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูููุฑุฏ. </li><li style=";text-align:right;direction:rtl">  ูุงุฆุฏุฉ (ูุฆุฉ ุจุงุณุชุฎุฏุงู ุงูููุฑุฏุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ุงููุณุชุฎุฏู (ุงููุชุบูุฑุงุช ุงูุนุงูููุฉ ูุงูุฑุฆูุณูุฉ). </li></ul><br>  ูุดุจู Singleton ูุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ููุชุจุฉ ุชุงุจุนุฉ ูุฌูุฉ ุฎุงุฑุฌูุฉ ุ ูุงููุณุชุฎุฏู ูู ุงููุณุชุฎุฏู. <br>  ุทุจูุฉ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูุตููุฉ ูุนุฒู ุทุจูุฉ ุงููุณุชุฎุฏู ุนู ุทุจูุฉ ููุฑุฏุฉ.  ูู ุงูุฃูุซูุฉ ุ ูุฏู ุงููุณุชุฎุฏู ุงููุฑุตุฉ ูููุตูู ุฅูู ุงูููุฑุฏ ุ ููููุง ุณูุชุตุฑู ููุง ูู ูุงู ุฐูู ูุณุชุญูููุง. <br><br>  ูููู ุงููุณุชุฎุฏู ุฃููุงู ุจุนูู ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุจุนุฏ ุฐูู ูููุถ ูู ุดูุก ุจููุฑุฉ ูู ุงูุฑุณุบ.  ุฃููุงู ูุญุงูู ุฅุตูุงุญู ูู ุทุจูุฉ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุ ูุฅุฐุง ูู ููุฌุญ ุงูุฃูุฑ ุ ูุญููุฆุฐู ูู ุงูุทุจูุฉ ุงูููุฑุฏุฉ. <br><br>  ูู ุงูููุฏ ุ ุณูู ูุณูุฑ ุจุงุณุชูุฑุงุฑ ุนูู ุทูู ุงูุญุงูุฉ - ุงูุขู ุนูู ุงูุฌุงูุจ ุงูุฎููู ุ ุซู ูู ุงูุธูุงู.  ูุชุณููู ุงูุชุจุฏูู ุฅูู ุงูุฌุงูุจ ุงููุธูู ุ ุชู ุงุฎุชูุงุฑ ุงูุญุงูุฉ ุงูุฃูุซุฑ ุตุนูุจุฉ - ุงููุตูู ุฅูู ููุฑุฏุฉ ูู ุฃุฏุงุฉ ุฅุชูุงู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ. <br><br>  <b>ููุงุฐุง ูู ุญุงูุฉ ุงูุงุชุตุงู ูู ุงููุฏูุฑ ุฃุตุนุจุ</b>  ูุธุฑูุง ูุฃูู ูููู ุงุณุชุฏุนุงุก ุฃุฏุงุฉ ุฅุชูุงู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ูู ุนูููุฉ ุชูููู ุงูุชุทุจูู ุฅูู ุงูุญุฏ ุงูุฃุฏูู ุ ุนูุฏูุง ูุตุจุญ ุงูุณุคุงู "ูู ุชู ุฅุชูุงู ุงูููุฑุฏุฉ ุฃู ูุง" ูุตุจุญ ุฐุง ุตูุฉ. <br><br>  <b>ุงููุถูุฉ ูู ููุน ูู ุงูุงุตุทูุงุนูุฉ.</b>  <b>ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ููุณุช ููุงู ุญุงุฌุฉ ูุฏุนูุงุช ูู ุงูููุฑุฏ ูู ุงููุฏูุฑ.</b>  ุญุชู ุนูุฏ ุงูุญุงุฌุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุชุณุฌูู ุชุฏููุฑ ุงููุงุฆูุงุช. <br><br>  ูุชุณุชุฎุฏู ุซูุงุซ ูุฆุงุช ูู ุงูููุฑุฏุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  SingletonClassic - ูุง ูุคุดุฑุงุช ุฐููุฉ.  ูู ุงููุงูุน ุ ุฅูู ููุณ ููุงุณููููุง ุชูุงููุง ุจุดูู ูุจุงุดุฑ ุ ููููู ุจุงูุชุฃููุฏ ุงูุฃูุซุฑ ููุงุณูููุฉ ุจูู ุงูุซูุงุซุฉ ุงูุฐูู ุชู ุจุญุซูู ุ </li><li style=";text-align:right;direction:rtl">  SingletonShared - ูุน ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง :: shared_ptrุ </li><li style=";text-align:right;direction:rtl">  SingletonWeak - ูุน ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง :: ุถุนูู. </li></ul><br>  ุฌููุน ุงูููุฑุฏุงุช ูู ููุงูุจ.  ูุชู ุงุณุชุฎุฏุงู ุงููุนููุฉ ูุงูุจ ููุฑุซ ููู.  ูู ูุนุธู ุงูุฃูุซูุฉ ุ ูุชู ุชุญุฏูุฏูุง ุจูุงุณุทุฉ ูุฆุฉ Payload ุ ูุงูุชู ุชููุฑ ูุธููุฉ ุนุงูุฉ ูุงุญุฏุฉ ูุฅุถุงูุฉ ุงูุจูุงูุงุช ุฅูู std :: set. <br><br>  ูุญุงูู ุฃุฏุงุฉ ุฅุชูุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูู ูุนุธู ุงูุฃูุซูุฉ ููุก ูุฆุงุช ุงูููู ููุงู.  ูุชู ุงุณุชุฎุฏุงู ุงูุฅุฎุฑุงุฌ ุงูุชุดุฎูุตู ุฅูู ูุญุฏุฉ ุงูุชุญูู ุฃูุถูุง ูู ูููุดุฆ ููุฑุฏ ุ ููุฏููุฑ ููุฑุฏ ุ ููุซูู (). <br><br>  <b>ููุงุฐุง ูู ุงูุตุนุจ ุฌุฏุงุ</b>  ูุชุณููู ููู ุฃููุง ูู ุงูุฌุงูุจ ุงููุธูู.  ููุงุดุฏุฉ ุงูููุฑุฏ ุงููุฏูุฑ ูู ุณููู ุบูุฑ ูุญุฏุฏ ุ ูููู ูุฏ ูุง ูุชุฌูู ุจุฃู ุดูู ูู ุงูุฃุดูุงู ุฎุงุฑุฌูุงู.  ูู ุงููุคูุฏ ุฃู ุญุดู ุงูููู ูู std :: set ุงููุฏูุฑ ูุง ูุถูู ุจุงูุชุฃููุฏ ุงููุธุงูุฑ ุงูุฎุงุฑุฌูุฉ ุ ูููู ูุง ุชูุฌุฏ ุทุฑููุฉ ุฃูุซุฑ ููุซูููุฉ (ูู ุงููุงูุน ุ ูู ุฏูู ูุฌูุณ ุงูุชุนุงูู ุงูุฎููุฌู ูู ูุธุงู Linux ูู ุฃูุซูุฉ ุบูุฑ ุตุญูุญุฉ ูุน ุงูููุฑุฏ ุงูููุงุณููู ุ ุชู ุจูุฌุงุญ STD :: set ุงููุฏูุฑุฉ ุ ููู MSVS ุถูู ูููุฏูุฒ - ุชููู).  ูุน ุณููู ุบูุฑ ูุญุฏุฏ ุ ูุฏ <b>ูุง</b> ูุญุฏุซ ุงูุฅุฎุฑุงุฌ ุฅูู ูุญุฏุฉ ุงูุชุญูู.  ูุฐูู ูู ุงูุฃูุซูุฉ ุงูุตุญูุญุฉ ุ ูุชููุน ุนุฏู ุงููุตูู ุฅูู ุงููุซูู () ุจุนุฏ ุงููุฏูุฑ ุ ููุฐูู ุนุฏู ูุฌูุฏ ุชุนุทู ูุบูุงุจ ุชุนููู ุ ููู ุงูุญุงูุงุช ุบูุฑ ุงูุตุญูุญุฉ ุ ุฅูุง ูุฌูุฏ ูุซู ูุฐุง ุงููุฏุงุก ุฃู ุงูุชุนุทู ุฃู ุชุนููู ุฃู ูู ุฐูู ูุฑุฉ ูุงุญุฏุฉ ูู ุฃู ูุฌููุนุงุช ุฃู ุฃููุง ูุงู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูููุฑุฏุฉ ุงูููุงุณูููุฉ </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Payload.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;set&gt; class Payload { public: Payload() = default; ~Payload() = default; Payload(const Payload &amp;) = delete; Payload(Payload &amp;&amp;) = delete; Payload&amp; operator=(const Payload &amp;) = delete; Payload&amp; operator=(Payload &amp;&amp;) = delete; void add(int value) { m_data.emplace(value); } private: std::set&lt;int&gt; m_data; };</span></span></span></span></code> </pre> <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">SingletonClassic.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; template&lt;typename T&gt; class SingletonClassic : public T { public: ~SingletonClassic() { std::cout &lt;&lt; "~SingletonClassic()" &lt;&lt; std::endl; } SingletonClassic(const SingletonClassic &amp;) = delete; SingletonClassic(SingletonClassic &amp;&amp;) = delete; SingletonClassic&amp; operator=(const SingletonClassic &amp;) = delete; SingletonClassic&amp; operator=(SingletonClassic &amp;&amp;) = delete; static SingletonClassic&amp; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; static SingletonClassic inst; return inst; } private: SingletonClassic() { std::cout &lt;&lt; "SingletonClassic()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonClassic 1 </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Classic_Example1_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  ุณููุฌูุชูู ููุงุณูู () <br>  ูุซูู () <br>  ~ SingletonClassic () <br></div></div><br>  ุชููู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุจุงุณุชุฏุนุงุก ุงูููุฑุฏ ูู ุงูููุดุฆ ููุชุฃูุฏ ูู ุฅูุดุงุก ุงูููุฑุฏ ูุจู ุฅูุดุงุก ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ. <br><br>  ููุดุฆ ุงููุณุชุฎุฏู std :: unique_ptr: ูุงุญุฏ ูุงุฑุบ ุ ูุงูุซุงูู ูุญุชูู ุนูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ. <br><br>  ุชุฑุชูุจ ุงูุฎูู: <br><br>  - ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง ูุงุฑุบุฉ :: unique_ptr. <br>  - ุงูููุฑุฏุฉ ุ <br>  - ูุงุฆุฏุฉ. <br><br>  ูุจูุงุก ุนูู ุฐูู ุ ุชุฑุชูุจ ุงูุชุฏููุฑ: <br><br>  - ูุงุฆุฏุฉ ุ <br>  - ุงูููุฑุฏุฉ ุ <br>  - ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง ูุงุฑุบุฉ :: unique_ptr. <br><br>  ุงุณุชุฏุนุงุก ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ destructor ุฅูู ุงูููุฑุฏ ูู ุงูุตุญูุญ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonClassic 2 </h3><br>  ูู ุดูุก ูู ููุณู ุ ูููู ุงููุณุชุฎุฏู ุงุณุชุบุฑู ุงูุฃูุฑ ูุฏูุฑ ูู ุดูุก ุจุณุทุฑ ูุงุญุฏ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Classic_Example2_incorrect.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is still the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  ุณููุฌูุชูู ููุงุณูู () <br>  ~ SingletonClassic () <br>  ูุซูู () <br></div></div><br>  ูุชู ุงูุญูุงุธ ุนูู ุชุฑุชูุจ ุงูุฎูู ูุงูุฏูุงุฑ.  ูุจุฏู ุฃู ูู ุดูุก ูุง ูุฒุงู.  ููู ูุง.  ุนู ุทุฑูู ุงุณุชุฏุนุงุก blankUnique.swap (utilityUnique) ุ ุงุฑุชูุจ ุงููุณุชุฎุฏู ุณููููุง ุบูุฑ ูุญุฏุฏ. <br><br>  <b>ููุงุฐุง ููุนู ุงููุณุชุฎุฏู ูุซู ูุฐู ุงูุฃุดูุงุก ุงูุบุจูุฉุ</b>  ูุฃูู ูุง ูุนุฑู ุดูุฆูุง ุนู ุงูุจููุฉ ุงูุฏุงุฎููุฉ ููููุชุจุฉ ุ ูุงูุชู ููุฑุช ูู ูููุฑุฏูุง ููุงุฆุฏุฉ. <br><br>  <b>ูุฅุฐุง ููุช ุชุนุฑู ุงููููู ุงูุฏุงุฎูู ููููุชุจุฉุ</b>  ... ุซู ุนูู ุฃู ุญุงู ุ ูู ุงูุณูู ููุบุงูุฉ ุงููุดุงุฑูุฉ ูู ุงูููุฏ ุงูุญูููู.  ูุนููู ุงูุฎุฑูุฌ ุนู ุทุฑูู debag ุงููุคููุฉ ุ ูุฃู  ูููู ูุง ุญุฏุซ ุจุงูุถุจุท ูู ูููู ุณููุง. <br><br>  <b>ููุงุฐุง ูุง ุชุชุทูุจ ุงูููุชุจุฉ ูุงุณุชุฎุฏุงููุง ุจุดูู ุตุญูุญุ</b>  <b>ุญุณููุง ุ ููุงู ูู ุฃููุงุน ุงูุฅุฑุณุงุก ุงูุชู ูุฌุจ ุฃู ุชูุชุจูุง ูุฃูุซูุฉ ...</b> ูููุงุฐุง ูุง ุชุฌุนู ููุชุจุฉ ููุณ ูู ุงูุณูู ุฃู ุชูุณุฏุ <br><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonClassic 3 </h3><br>  ูู ุณูุงู ุฅุนุฏุงุฏ ุงูููุงูุฉ ูุนุฏุฉ ุฃูุงู ุ ุงุนุชูุฏุช ุฃูู ูู ุงููุณุชุญูู ุงููุถุงุก ุนูู ุงูุณููู ุบูุฑ ุงููุญุฏุฏ ูู ุงููุซุงู ุงูุณุงุจู ูู ุทุจูุฉ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุ ููู ููู ุงูุญู ูุชุงุญูุง ุฅูุง ูู ุงูุทุจูุฉ ุงูููุฑุฏุฉ.  ููู ูุน ูุฑูุฑ ุงูููุช ุ ุชู ุงูุชูุตู ุฅูู ุญู. <br><br>  ูุจู ูุชุญ ุงูููุณุฏูู ุจุงูููุฏ ูุงูุดุฑุญ ุ ุฃูุชุฑุญ ุนูู ุงููุงุฑุฆ ูุญุงููุฉ ุฅูุฌุงุฏ ุทุฑููุฉ ููุฎุฑูุฌ ูู ุงููููู ุจููุฑุฏู (ููุท ูู ุทุจูุฉ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ!).  ุฃูุง ูุง ุฃุณุชุจุนุฏ ุฃู ููุงู ุญููู ุฃูุถู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Classic_Example3_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonClassic.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; class ClassicSingleThreadedUtility { public: ClassicSingleThreadedUtility() { thread_local auto flag_strong = std::make_shared&lt;char&gt;(0); m_flag_weak = flag_strong; SingletonClassic&lt;Payload&gt;::instance(); } ~ClassicSingleThreadedUtility() { if ( !m_flag_weak.expired() ) { auto &amp;instance = SingletonClassic&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance.add(i); } } private: std::weak_ptr&lt;char&gt; m_flag_weak; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified ClassicSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;ClassicSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;ClassicSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); { // To demonstrate normal processing before application ends auto utility = ClassicSingleThreadedUtility(); } // Guaranteed destruction order is still the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect ... // ... but utility uses a variable with thread storage duration to detect thread termination. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  ุณููุฌูุชูู ููุงุณูู () <br>  ูุซูู () <br>  ูุซูู () <br>  ~ SingletonClassic () <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุถูุญ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุงููุดููุฉ ุชุญุฏุซ ููุท ุนูุฏ ุชุตุบูุฑ ุงูุชุทุจูู.  ูููู ุงูุชุฎูุต ูู ุงูุณููู ุบูุฑ ุงููุญุฏุฏ ุนู ุทุฑูู ุชุฏุฑูุณ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ููุชุนุฑู ุนูู ุงูุญุฏ ุงูุฃุฏูู ููุชุทุจูู.  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏููุง ูุชุบูุฑูุง ููููุง ููุฅุนูุงู ูู ุงูููุน std :: shared_ptr ุ ูุญุชูู ุนูู ูุคูู ูุฏุฉ ุชุฎุฒูู ูุคุดุฑ ุชุฑุงุจุท (ุฑุงุฌุน ููุชุทูุงุช ูู ุงููุนูุงุฑ ูู ุงูููุงูุฉ ุฃุนูุงู) - ุฅูู ูุดุจู ุซุงุจุชูุง ุ ูููู ูุชู ุฅุชูุงูู ููุท ุนูุฏูุง ููุชูู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุญุงูู <b>ูุจู ุฅุชูุงู ุฃู ุฅุญุตุงุฆูุงุช</b> ุ ุจูุง ูู ุฐูู ูุจู ุงูุชุฏููุฑ ุงูููุฑุฏ.  ุงููุชุบูุฑ flag_strong ูู ุฃุญุฏ ุงูุฏูู ุจุงููุงูู ุ ููููู ูู ูุซูู ููุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุจุชุฎุฒูู ูุณุฎุชู ุงูุถุนููุฉ. <br><br>  ุจูุนูู ุถูู ุ ูููู ุฃู ูุณูู ุงูุญู ุงูุงุฎุชุฑุงู ุ ูุฃูู  ุฅูู ุบูุฑ ูุจุงุดุฑ ูุบูุฑ ูุงุถุญ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุญุฐุฑ ูุจูุฑูุง ุฌุฏูุง ุ ูุฃุญูุงููุง (ูู ุชุทุจูู ูุชุนุฏุฏ ุงูุฎููุท) ูุญุฐุฑ ุจุดูู ุนุงู ูู ุงูุฎุทุฃ.  ูููู ุจูุนูู ูุงุณุน ุ ูุฐุง ููุณ ุงุฎุชุฑุงููุง ุ ููููู ุญู ูุชู ุชุนุฑููู ุจุงููุงูู ุจูุงุณุทุฉ ุงูุฎุตุงุฆุต ุงูููุงุณูุฉ - ูู ูู ุงูุนููุจ ูุงููุฒุงูุง. <br></div></div><br><h3 style=";text-align:right;direction:rtl">  SingletonShared </h3><br>  ุฏุนูุง ููุชูู ุฅูู ููุฑุฏุฉ ูุนุฏูุฉ ุจูุงุกู ุนูู ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุงู :: shared_ptr. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">SingletonShared.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; template&lt;typename T&gt; class SingletonShared : public T { public: ~SingletonShared() { std::cout &lt;&lt; "~SingletonShared()" &lt;&lt; std::endl; } SingletonShared(const SingletonShared &amp;) = delete; SingletonShared(SingletonShared &amp;&amp;) = delete; SingletonShared&amp; operator=(const SingletonShared &amp;) = delete; SingletonShared&amp; operator=(SingletonShared &amp;&amp;) = delete; static std::shared_ptr&lt;SingletonShared&gt; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; // "new" and no std::make_shared because of private c-tor static auto inst = std::shared_ptr&lt;SingletonShared&gt;(new SingletonShared); return inst; } private: SingletonShared() { std::cout &lt;&lt; "SingletonShared()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br>  <b>Ai-ai-ai ุ ูุฌุจ ุนุฏู ุงุณุชุฎุฏุงู ุงููุดุบู ุงูุฌุฏูุฏ ูู ุงูููุฏ ุงูุญุฏูุซ ุ ุจุฏูุงู ูู ุฐูู ุ ููุงู ุญุงุฌุฉ ุฅูู std :: make_shared!</b>  ููุฐุง ูุง ูููุนู ููุดุฆ ุงูููุฑุฏุฉ ุงูุฎุงุตุฉ. <br><br>  <b>ูุง!</b>  <b>ูุฏู ูุดููุฉ ุฃูุถุง!</b>  <b>ุฃุนูู ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง :: make_shared freind ูุฑุฏูุฉ!</b>  ... ูุงูุญุตูู ุนูู ุชุจุงูู ูู antipattern PublicMorozov: ุจุงุณุชุฎุฏุงู ููุณ ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง :: make_shared ุ ุณูููู ูู ุงููููู ุฅูุดุงุก ุญุงูุงุช ุฅุถุงููุฉ ูู ุงูููุฑุฏ ุงูุชู ูู ูุชู ุชูููุฑูุง ูู ูุจู ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  SingletonShared ุฃูุซูุฉ 1 ู 2 </h3><br>  ุชุชูุงูู ุชูุงูุง ูุน ุงูุฃูุซูุฉ ุฑูู 1 ู 2 ูููุณุฎุฉ ุงูููุงุณูููุฉ.  ุชู ุฅุฌุฑุงุก ุชุบููุฑุงุช ูุจูุฑุฉ ุนูู ุทุจูุฉ ุงูููุฑุฏ ููุท ุ ุธูุช ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ููุง ูู.  ููุง ูู ุงูุญุงู ูู ุงูุฃูุซูุฉ ูุน ุงูููุฑุฏ ุงูููุงุณููู ุ ุงููุซุงู -1 ุตุญูุญ ุ ูุงููุซุงู 2 ููุถุญ ุงูุณููู ุบูุฑ ุงููุญุฏุฏ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Shared_Example1_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Payload.h&gt; #include &lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonShared&lt;Payload&gt;::instance(); } ~SharedSingleThreadedUtility() { if ( auto instance = SingletonShared&lt;Payload&gt;::instance() ) for ( int i = 0; i &lt; 100; ++i ) instance-&gt;add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonShared () <br>  ูุซูู () <br>  ~ SingletonShared () <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Shared_Example2_incorrect.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() { // To ensure that singleton will be constucted before utility SingletonShared&lt;Payload&gt;::instance(); } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( auto instance = SingletonShared::instance() ) // for ( int i = 0; i &lt; 100; ++i ) // instance-&gt;add(i); // ... so this code will demonstrate UB in colour auto instance = SingletonShared&lt;Payload&gt;::instance(); for ( int i = 0; i &lt; 100; ++i ) instance-&gt;add(i); } }; // 1. Create an empty unique_ptr // 2. Create singleton (because of modified SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order seems to be correct ... int main() { // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonShared () <br>  ~ SingletonShared () <br>  ูุซูู () <br></div></div><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonShared 3 </h3><br>  ูุงูุขู ุณูุญุงูู ุญู ูุฐู ุงููุดููุฉ ุจุดูู ุฃูุถู ูู ุงููุซุงู ุฑูู 3 ูู ุงูููุงุณูููุงุช. <br>  ุงูุญู ูุงุถุญ: ุชุญุชุงุฌ ููุท ุฅูู ุฅุทุงูุฉ ุนูุฑ ุงูููุฑุฏ ูู ุฎูุงู ุชุฎุฒูู ูุณุฎุฉ ูู std :: shared_ptr ุงูุชู ุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ุงูููุฑุฏ ูู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ.  ููุฐุง ุงูุญู ุ ูุน ุงูุชูุงู SingletonShared ุ ุชู ุงุณุชูุณุงุฎู ุนูู ูุทุงู ูุงุณุน ูู ุงููุตุงุฏุฑ ุงูููุชูุญุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Shared_Example3_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;Payload&gt;::instance()) { } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( m_singleton ) // for ( int i = 0; i &lt; 100; ++i ) // m_singleton-&gt;add(i); // ... so this code will allow to demonstrate UB in colour for ( int i = 0; i &lt; 100; ++i ) m_singleton-&gt;add(i); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;Payload&gt;&gt; m_singleton; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of SharedSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;SharedSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;SharedSingleThreadedUtility&gt;(); int main() { // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct ... // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect... // ... but utility have made a copy of shared_ptr when it was available, // so it's correct again. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonShared () <br>  ~ SingletonShared () <br></div></div><br>  ูุงูุขู ุ ุงูุงูุชูุงู ุ ูุงูุณุคุงู ูู: <b>ูู ุชุฑูุฏ ุญูุง ุฅุทุงูุฉ ุนูุฑ ููุฑุฏุฉุ</b> <br>  ุฃู ูู ุชุฑูุฏ ุงูุชุฎูุต ูู ุงูุณููู ุบูุฑ ุงููุญุฏุฏ ุ ูุงุฎุชูุงุฑ ุชูุฏูุฏ ุงูุญูุงุฉ ููุณููุฉ ูููุงุฉ ุนูู ุงูุณุทุญุ <br><br>  ุงูุฎูู ุงููุธุฑู ูู ุดูู ุงุณุชุจุฏุงู ุงูุฃูุฏุงู ุนู ุทุฑูู ูุคุฏู ุฅูู ุฎุทุฑ ุงูุฌููุฏ (ุฃู ูุฑุฌุน ุฏูุฑู - ูุณูููุง ูุง ุชุฑูุฏ). <br><br>  <b>ูุนู nuuuuu ุ ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุฌุจ ุฃู ุชุญุงูู ุจูุง ุจุฌุฏ!</b>  <b>ูุฌุจ ุนููู ุงูุฎุฑูุฌ ุจูุซู ูุฐุง ุงูููุช ุงูุทููู ุ ูุจุงูุชุฃููุฏ ูู ุชูุนู ุฐูู ุนู ุทุฑูู ุงูุตุฏูุฉ!</b> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">CallbackPayload.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;functional&gt; class CallbackPayload { public: CallbackPayload() = default; ~CallbackPayload() = default; CallbackPayload(const CallbackPayload &amp;) = delete; CallbackPayload(CallbackPayload &amp;&amp;) = delete; CallbackPayload&amp; operator=(const CallbackPayload &amp;) = delete; CallbackPayload&amp; operator=(CallbackPayload &amp;&amp;) = delete; void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { m_callbackFn = std::move(fn); } private: std::function&lt;void()&gt; m_callbackFn; };</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">SomethingWithVeryImportantDestructor.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; class SomethingWithVeryImportantDestructor { public: SomethingWithVeryImportantDestructor() { std::cout &lt;&lt; "SomethingWithVeryImportantDestructor()" &lt;&lt; std::endl; } ~SomethingWithVeryImportantDestructor() { std::cout &lt;&lt; "~SomethingWithVeryImportantDestructor()" &lt;&lt; std::endl; } SomethingWithVeryImportantDestructor(const SomethingWithVeryImportantDestructor &amp;) = delete; SomethingWithVeryImportantDestructor(SomethingWithVeryImportantDestructor &amp;&amp;) = delete; SomethingWithVeryImportantDestructor&amp; operator=(const SomethingWithVeryImportantDestructor &amp;) = delete; SomethingWithVeryImportantDestructor&amp; operator=(SomethingWithVeryImportantDestructor &amp;&amp;) = delete; };</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Shared_Example4_incorrect.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CallbackPayload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SomethingWithVeryImportantDestructor.h"</span></span></span><span class="hljs-meta"> class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;CallbackPayload&gt;::instance()) { std::cout &lt;&lt; "SharedSingleThreadedUtility()" &lt;&lt; std::endl; } ~SharedSingleThreadedUtility() { std::cout &lt;&lt; "~SharedSingleThreadedUtility()" &lt;&lt; std::endl; } void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { if ( m_singleton ) m_singleton-&gt;setCallback(std::move(fn)); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;CallbackPayload&gt;&gt; m_singleton; }; int main() { auto utility = std::make_shared&lt;SharedSingleThreadedUtility&gt;(); auto something = std::make_shared&lt;SomethingWithVeryImportantDestructor&gt;(); // lambda with "utility" and "something" captured utility-&gt;setCallback( [utility, something](){} ); return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonShared () <br>  SharedSingleThreadedUtility () <br>  SomethingWithVeryImportantDestructor () <br></div></div><br>  ุชู ุฅูุดุงุก ููุฑุฏุฉ. <br><br>  ุชู ุฅูุดุงุก ุฃุฏุงุฉ ูุณุงุนุฏุฉ. <br><br>  <b>ุชู ุฅูุดุงุก ุดูุก</b> ูุฏูุฑ <b>ููู ุฌุฏูุง</b> (ููุฏ ููุช ุจุฅุถุงูุฉ ูุฐุง ููุชุฎููู ุ ูุฃูู ุชูุฌุฏ ุนูู ุงูุฅูุชุฑูุช ููุดูุฑุงุช ูุซู "ุญุณููุง ุ ูู ูุชู ุงุณุชุฏุนุงุก ุงููุฏูุฑ ุงูููุฑุฏ ุ ูุฐุง ูุง ูุฐุง ุ ูุฌุจ ุฃู ูููู ููุฌูุฏูุง ุทูุงู ุงูููุช ุงูุจุฑุงูุฌ "). <br><br>  ูููู ูู ูุชู ุงุณุชุฏุนุงุก ุฃู ูุฏูุฑ ูุฃู ูู ูุฐู ุงูุฃุดูุงุก! <br><br>  ุจุณุจุจ ูุงุฐุงุ  ุจุณุจุจ ุงุณุชุจุฏุงู ุงูุฃูุฏุงู ุนู ุทุฑูู. <br><br><h3 style=";text-align:right;direction:rtl">  SingletonWeak </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">SingletonWeak.h</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;iostream&gt; template&lt;typename T&gt; class SingletonWeak : public T { public: ~SingletonWeak() { std::cout &lt;&lt; "~SingletonWeak()" &lt;&lt; std::endl; } SingletonWeak(const SingletonWeak &amp;) = delete; SingletonWeak(SingletonWeak &amp;&amp;) = delete; SingletonWeak&amp; operator=(const SingletonWeak &amp;) = delete; SingletonWeak&amp; operator=(SingletonWeak &amp;&amp;) = delete; static std::weak_ptr&lt;SingletonWeak&gt; instance() { std::cout &lt;&lt; "instance()" &lt;&lt; std::endl; // "new" and no std::make_shared because of private c-tor static auto inst = std::shared_ptr&lt;SingletonWeak&gt;(new SingletonWeak); return inst; } private: SingletonWeak() { std::cout &lt;&lt; "SingletonWeak()" &lt;&lt; std::endl; } };</span></span></span></span></code> </pre><br></div></div><br>  ูุซู ูุฐุง ุงูุชุนุฏูู ูููุฑุฏ ุงูููุฑุฏ ูู ุงููุตุงุฏุฑ ุงูููุชูุญุฉ ุ ุฅุฐุง ุฃุนุทู ุ ููุณ ุจุงูุชุฃููุฏ ูู ูุซูุฑ ูู ุงูุฃุญูุงู.  ููุฏ ูุงุจูุช ุจุนุถ ุงููุชุบูุฑุงุช ุงูุบุฑูุจุฉ ุงูุชู ุชุญููุช ูู ุงูุฏุงุฎู ุฅูู ุงูุฎุงุฑุฌ ุจุงุณุชุฎุฏุงู std ::ุถุนู_ptr ุ ูุงูุฐู ูุจุฏู ุฃูู ูุณุชุฎุฏู ุ ูุงูุฐู ุ ุนูู ูุง ูุจุฏู ุ ูุง ููุฏู ูุงุฆุฏุฉ ุฃูุซุฑ ูู ุฅุทุงูุฉ ุนูุฑ ุงูููุฑุฏ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุฑุฏุงุช ุจุงุณุชุฎุฏุงู ุงูุฃูุฑุงุถ ุงููููููุฉ ุฌูุณูุง :: ุถุนูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ูู ุงูุทุฑููุฉ ุงูุตุญูุญุฉ ูุฅูุดุงุก ูุฆุฉ sinlgeton ุจูุงุณุทุฉ ุถุนูู</a> </li></ul><br>  ุงูุฎูุงุฑ ุงูุฐู ุฃูุชุฑุญู ุ ุนูุฏ ุชุทุจููู ุจุดูู ุตุญูุญ ูู ุทุจูุงุช ุงูููุฑุฏ ูุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญูู ูู ุงูุฅุฌุฑุงุกุงุช ูู ุทุจูุฉ ุงููุณุชุฎุฏู ุงูููุถุญุฉ ูู ุงูุฃูุซูุฉ ุฃุนูุงู ุ ุจูุง ูู ุฐูู ูููุน ุญุงูุฉ ุชููู ุชุงู ุ </li><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ ููุช ุทู ุงูุชุทุจูู ุจุดูู ุฃูุซุฑ ุฏูุฉ ูู ุชุทุจูู thread_local ูู Classic_Example3_correct ุ ุฃู  ูุชูุญ ูู ุงูุงูุชุฑุงุจ ูู ุงูุญุงูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ูุง ุฃุนุงูู ูู ุงููุดููุฉ ุงููุธุฑูุฉ ุงููุชูุซูุฉ ูู ุงุณุชุจุฏุงู ุงูุฃูุฏุงู ุจุงููุณุงุฆู (ูุง ุฃุนุฑู ูุง ุฅุฐุง ูุงู ุฃู ุดูุก ููููุณ ุขุฎุฑ ุบูุฑ ุงูุฌููุฏ ูููู ุฃู ูุธูุฑ ูู ูุฐู ุงููุดููุฉ ุงููุธุฑูุฉ). </li></ul><br>  ููุน ุฐูู ุ ููุงู ุนูุจ: ุฅุทุงูุฉ ุนูุฑ ููุฑุฏุฉ ูุง <b>ูุฒุงู</b> ูููู ุฃู ุชุณูุญ <b>ููุง ุฃู ุชูุชุฑุจ ุฃูุซุฑ</b> ูู ุงูุญุงูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonWeak 1 </h3><br>  ูุดุงุจู Shared_Example3_correct.cpp. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Weak_Example1_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;Payload&gt;::instance()) { } ~WeakSingleThreadedUtility() { // Sometimes this check may result as "false" even in case of incorrect usage, // and there's no way to guarantee a demonstration of undefined behaviour in colour if ( auto strong = m_weak.lock() ) for ( int i = 0; i &lt; 100; ++i ) strong-&gt;add(i); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;Payload&gt;&gt; m_weak; }; // 1. Create an empty unique_ptr // 2. Create singleton (because of WeakSingleThreadedUtility c-tor) // 3. Create utility std::unique_ptr&lt;WeakSingleThreadedUtility&gt; emptyUnique; auto utilityUnique = std::make_unique&lt;WeakSingleThreadedUtility&gt;(); int main() { // This guarantee destruction in order: // - utilityUnique; // - singleton; // - emptyUnique. // This order is correct ... // ... but user swaps unique_ptrs emptyUnique.swap(utilityUnique); // Guaranteed destruction order is the same: // - utilityUnique; // - singleton; // - emptyUnique, // but now utilityUnique is empty, and emptyUnique is filled, // so destruction order is incorrect... // ... but utility have made a weak copy of shared_ptr when it was available, // so it's correct again. return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonWeak () <br>  ~ SingletonWeak () <br></div></div><br>  <b>ููุงุฐุง ูุญุชุงุฌ ุฅูู SingletonWeak ุ ูุฃู ูุง ุฃุญุฏ ูุฒุนุฌ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูุงุณุชุฎุฏุงู SingletonShared ูู SingletonWeakุ</b>  ูุนู ุ ูุง ุฃุญุฏ ูุฒุนุฌ.  ูุญุชู ูุง ุฃุญุฏ ูุฒุนุฌ ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ูุงุณุชุฎุฏุงู SingletonWeak ูู SingletonShared.  ููู ุงุณุชุฎุฏุงููุง ููุบุฑุถ ุงูููุตูุฏ ูู ุฃุณูู ููููุงู ูู ุงุณุชุฎุฏุงููุง ูุฃุบุฑุงุถ ุฃุฎุฑู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุซุงู ุนูู SingletonWeak 2 </h3><br>  ุชุดุจู Shared_Example4_incorrect ุ ููู ุญุงูุฉ ุชููู ุชุงู ููุท ูุง ุชุญุฏุซ ูู ูุฐู ุงูุญุงูุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Weak_Example2_correct.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CallbackPayload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SomethingWithVeryImportantDestructor.h"</span></span></span><span class="hljs-meta"> class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;CallbackPayload&gt;::instance()) { std::cout &lt;&lt; "WeakSingleThreadedUtility()" &lt;&lt; std::endl; } ~WeakSingleThreadedUtility() { std::cout &lt;&lt; "~WeakSingleThreadedUtility()" &lt;&lt; std::endl; } void setCallback(std::function&lt;void()&gt; &amp;&amp;fn) { if ( auto strong = m_weak.lock() ) strong-&gt;setCallback(std::move(fn)); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;CallbackPayload&gt;&gt; m_weak; }; int main() { auto utility = std::make_shared&lt;WeakSingleThreadedUtility&gt;(); auto something = std::make_shared&lt;SomethingWithVeryImportantDestructor&gt;(); // lambda with "utility" and "something" captured utility-&gt;setCallback( [utility, something](){} ); return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonWeak () <br>  ุถุนูู ูุญูุฏุงูููุถูุน () <br>  SomethingWithVeryImportantDestructor () <br>  ~ SingletonWeak () <br>  ~ SomethingWithVeryImportantDestructor () <br>  ~ ุถุนู ุถุนููุงููุณุชุฎุฏููู () <br></div></div><br><h3 style=";text-align:right;direction:rtl">  ุจุฏูุง ูู ุงูุงุณุชูุชุงุฌ </h3><br>  <b>ููุงุฐุง ุ ูุซู ูุฐุง ุงูุชุนุฏูู ููุฑุฏ ุณูููู ุงูุณููู ุบูุฑ ุงููุญุฏุฏุ</b>  ูุนุฏุช ุฃูู ูู ูููู ููุงู ููุงูุฉ ุณุนูุฏุฉ.  ุชูุถุญ ุงูุฃูุซูุฉ ุงูุชุงููุฉ ุฃู ุฅุฌุฑุงุกุงุช ุงูุชุฎุฑูุจ ุงููุงูุฑุฉ ูู ุทุจูุฉ ุงููุณุชุฎุฏู ูููู ุฃู ุชุฏูุฑ ุญุชู ููุชุจุฉ ุงูุชูููุฑ ุงูุตุญูุญุฉ ุจุงุณุชุฎุฏุงู ููุฑุฏุฉ (ููู ูุฌุจ ุฃู ูุนุชุฑู ุจุฃูู ูุง ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุงูุตุฏูุฉ). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Shared_Example5_incorrect.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonShared.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;cstdlib&gt; class SharedSingleThreadedUtility { public: SharedSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_singleton(SingletonShared&lt;Payload&gt;::instance()) { } ~SharedSingleThreadedUtility() { // Sometimes this check may result as "false" even for destroyed singleton // preventing from visual effects of undefined behaviour ... //if ( m_singleton ) // for ( int i = 0; i &lt; 100; ++i ) // m_singleton-&gt;add(i); // ... so this code will allow to demonstrate UB in colour for ( int i = 0; i &lt; 100; ++i ) m_singleton-&gt;add(i); } private: // A copy of smart pointer, not a reference std::shared_ptr&lt;SingletonShared&lt;Payload&gt;&gt; m_singleton; }; void cracker() { SharedSingleThreadedUtility(); } // 1. Register cracker() using std::atexit // 2. Create singleton // 3. Create utility auto reg = [](){ std::atexit(&amp;cracker); return 0; }(); auto utility = SharedSingleThreadedUtility(); // This guarantee destruction in order: // - utility; // - singleton. // This order is correct. // Additionally, there's a copy of shared_ptr in the class instance... // ... but there was std::atexit registered before singleton, // so cracker() will be invoked after destruction of utility and singleton. // There's second try to create a singleton - and it's incorrect. int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonShared () <br>  ~ SingletonShared () <br>  ูุซูู () <br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Weak_Example3_incorrect.cpp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SingletonWeak.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Payload.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; #include &lt;cstdlib&gt; class WeakSingleThreadedUtility { public: WeakSingleThreadedUtility() // To ensure that singleton will be constucted before utility : m_weak(SingletonWeak&lt;Payload&gt;::instance()) { } ~WeakSingleThreadedUtility() { // Sometimes this check may result as "false" even in case of incorrect usage, // and there's no way to guarantee a demonstration of undefined behaviour in colour if ( auto strong = m_weak.lock() ) for ( int i = 0; i &lt; 100; ++i ) strong-&gt;add(i); } private: // A weak copy of smart pointer, not a reference std::weak_ptr&lt;SingletonWeak&lt;Payload&gt;&gt; m_weak; }; void cracker() { WeakSingleThreadedUtility(); } // 1. Register cracker() using std::atexit // 2. Create singleton // 3. Create utility auto reg = [](){ std::atexit(&amp;cracker); return 0; }(); auto utility = WeakSingleThreadedUtility(); // This guarantee destruction in order: // - utility; // - singleton. // This order is correct. // Additionally, there's a copy of shared_ptr in the class instance... // ... but there was std::atexit registered before singleton, // so cracker() will be invoked after destruction of utility and singleton. // There's second try to create a singleton - and it's incorrect. int main() { return 0; }</span></span></span></span></code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฎุฑุงุฌ ูุญุฏุฉ ุงูุชุญูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุซูู () <br>  SingletonWeak () <br>  ~ SingletonWeak () <br>  ูุซูู () <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar455848/">https://habr.com/ru/post/ar455848/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar455834/index.html">ูุนุงููุฑ ูุฎูุงุฏู Linux: 5 ุฃุฏูุงุช ููุชูุญุฉ</a></li>
<li><a href="../ar455840/index.html">ููููุฉ ุงูุนูู ูุน ุงุณุชูุณุงุฑุงุช ูุชุนุฏุฏุฉ. ุชูููู ุ ุงููุฎูุถ ุ FP</a></li>
<li><a href="../ar455842/index.html">ูุดุฑ ูุงุฆูุฉ ูุฑุชุจุทุฉ ูููุฑุฏุฉ. ุทุจุนุฉ ุณุฑูุนุฉ</a></li>
<li><a href="../ar455844/index.html">ุฅูุดุงุก ูุญูู Roslyn ุจุงุณุชุฎุฏุงู ุงุฎุชุจุงุฑ ุงูุชุบููู ููุซุงู</a></li>
<li><a href="../ar455846/index.html">ุงูุญูุณุจุฉ ุงูููุฒุนุฉ ูู ุฌูููุง</a></li>
<li><a href="../ar455850/index.html">ุตูุฏูู ุงูุฃุฏูุงุช ููุจุงุญุซูู - ุงูุทุจุนุฉ ุงูุซุงูุซุฉ: ุงูุจุญุซ ุนู ุงููุตุงุฏุฑ ูุงูุนูู ูุนูุง</a></li>
<li><a href="../ar455852/index.html">ุฑูุน ุงูุฌููุจ ุงูุฃูููุฉ ูุงูุบุฑุณ ุงููุชุฒุงูู</a></li>
<li><a href="../ar455854/index.html">ููููุฉ ุชูููุฐ ููุงุฆู ุงูุณูุงู ูู iOS 13</a></li>
<li><a href="../ar455856/index.html">ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูุงูุฑุทูุจุฉ ุงููุงุณูููุฉ ูุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงูุถุบุท ุงูุฌูู ุนูู nRF52832</a></li>
<li><a href="../ar455858/index.html">ุดุจูุงุช ุชููุฒููู ุงููุงุจู ูุฃุตุบุฑูุง. ุงูุฌุฒุก 9: headend</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>