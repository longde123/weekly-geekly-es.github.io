<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♌️ 🚿 🤟🏾 Analyse des attaques de Cowrie Hanipot 🧘🏾 🤴🏽 👩🏼‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Statistiques pendant 24 heures après l'installation du hanipot sur le site de Digital Ocean à Singapour 

 Poo poo! Commençons tout de suite avec une ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analyse des attaques de Cowrie Hanipot</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436076/">  <b>Statistiques pendant 24 heures après l'installation du hanipot sur le site de Digital Ocean à Singapour</b> <br><br><h1>  Poo poo!  Commençons tout de suite avec une carte d'attaque. </h1><br>  Notre carte de superclasse montre des ASN uniques qui se sont connectés à notre hanipot Cowrie en 24 heures.  <font color="orange">Le jaune</font> correspond aux connexions SSH et le <font color="red">rouge</font> correspond à Telnet.  De telles animations impressionnent souvent le conseil d'administration de l'entreprise, ce qui vous permet d'obtenir plus de financement pour la sécurité et les ressources.  Néanmoins, la carte a une certaine valeur, démontrant clairement la répartition géographique et organisationnelle des sources d'attaques contre notre hôte en seulement 24 heures.  L'animation ne reflète pas la quantité de trafic provenant de chaque source. <br><a name="habracut"></a><br><h3>  Qu'est-ce qu'une carte Pew Pew? </h3><br>  <i>Pew map Pew</i> est une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">visualisation de cyberattaques</a> , généralement animées et très belles.  C'est une façon à la mode de vendre votre produit, connu pour être utilisé par Norse Corp.  L'entreprise a mal tourné: il s'est avéré que de belles animations étaient leur seul avantage, et ils ont utilisé des données fragmentaires pour l'analyse. <br><br><h3>  Fabriqué avec Leafletjs </h3><br>  Pour ceux qui veulent développer une carte d'attaque pour le grand écran dans le centre des opérations (votre patron l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aimera</a> ), il y a une bibliothèque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">leafletjs</a> .  Combinez-le avec le plug-in de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">couche de migration des dépliants</a> , le service Maxmind GeoIP, et vous avez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">terminé</a> . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ep/4i/nf/ep4infkfydwq1bq0w9qllkshgys.png"></a> <br><br><h1>  WTF: qu'est-ce que le hanipot Cowrie? </h1><br>  Khanipot est un système qui est placé sur le réseau spécifiquement pour attirer les attaquants.  Les connexions au système sont généralement illégales et vous permettent de détecter un attaquant à l'aide de journaux détaillés.  Les journaux stockent non seulement les informations de connexion habituelles, mais également les informations de session qui révèlent les <b>techniques, tactiques et procédures (TTP) de</b> l'attaquant. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le Cowrie Hanipot</a> sert à <b>enregistrer les connexions SSH et Telnet</b> .  Ces hanipot sont souvent affichés sur Internet pour suivre les outils, les scripts et les hôtes des attaquants. <br><br><blockquote>  Mon message aux entreprises qui pensent qu'elles ne sont pas attaquées est le suivant: «Vous regardez mal.» <br>  <i>- James Snook</i> </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/b6d/51f/054/b6d51f054d5d6e844819d6a4ae52ec4a.jpg"><br><br><h1>  Qu'y a-t-il dans les journaux? </h1><br><h3>  Nombre total de connexions </h3><br>  De nombreux hôtes ont reçu des tentatives de connexion répétées.  C'est normal, car la liste des informations d'identification est bloquée dans les scripts d'attaque et ils essaient plusieurs combinaisons.  Le Cowrie Hanipot est configuré pour accepter certaines combinaisons de nom d'utilisateur et de mot de passe.  Ceci est configuré dans le <b>fichier user.db.</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/baa/53b/95a/baa53b95a17508d61d6fc90f138ded6c.png"><br><br><h3>  Géographie des attaques </h3><br>  Selon les données de géolocalisation de Maxmind, j'ai calculé le nombre de connexions de chaque pays.  Le Brésil et la Chine dominent largement, de ces pays il y a souvent beaucoup de bruit provenant des scanners. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e5/00d/15b/8e500d15bb9b18fa0e0d09ea4920693c.png"><br><br><h3>  Propriétaire du bloc réseau </h3><br>  Une étude des propriétaires d'unités de réseau (ASN) peut identifier les organisations avec un grand nombre d'hôtes attaquants.  Bien sûr, et dans de tels cas, vous devez toujours vous rappeler que de nombreuses attaques proviennent d'hôtes infectés.  Il est raisonnable de supposer que la plupart des attaquants ne sont pas assez stupides pour analyser le Web à partir d'un ordinateur personnel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed2/f4d/a08/ed2f4da086d9540231d850cff7a8a40b.png"><br><br><h3>  Ports ouverts sur les systèmes attaquants (données Shodan.io) </h3><br>  L'exécution de la liste IP via l'excellente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API Shodan</a> identifie rapidement <b>les systèmes</b> de ports <b>ouverts</b> et le type de ports.  La figure ci-dessous montre la concentration des ports ouverts par pays et par organisation.  Il serait possible d'identifier des blocs de systèmes compromis, mais rien d'exceptionnel ne peut être vu dans le <b>petit échantillon</b> , à l'exception du grand nombre <b>de 500 ports ouverts en Chine</b> . <br><br>  Une découverte intéressante est le grand nombre de systèmes au Brésil qui n'ont <b>pas 22, 23</b> ou d' <b>autres ports</b> <b>ouverts</b> , selon Censys et Shodan.  Apparemment, ce sont des connexions à partir des ordinateurs des utilisateurs finaux. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0cb/72c/b3a/0cb72cb3a213c3808906fd2becd3179b.png"><br><br><h3>  Des bots?  Pas nécessairement </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les</a> données <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Censys</a> pour les ports 22 et 23 pour cette journée se sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">révélées</a> étranges.  J'ai supposé que la plupart des analyses et des attaques par mot de passe provenaient de robots.  Le script est distribué sur des ports ouverts, récupérant des mots de passe, et se copie à partir du nouveau système et continue d'être distribué en utilisant la même méthode. <br><br>  Mais ici, vous pouvez voir que seul un petit nombre d'hôtes analysant telnet a le port 23. Cela signifie que les systèmes sont compromis d'une autre manière ou que les attaquants exécutent les scripts manuellement. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e01/cca/89b/e01cca89b6f93be94d69ced873ebc3c4.png"><br><br><h3>  Connexions à domicile </h3><br>  Une autre découverte intéressante a été le grand nombre d'utilisateurs à domicile dans l'échantillon.  En utilisant <b>la recherche inversée,</b> j'ai identifié 105 connexions à partir d'ordinateurs personnels spécifiques.  Pour de nombreuses connexions à domicile, lorsque vous examinez DNS, le nom d'hôte s'affiche avec les mots dsl, home, cable, fibre, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64f/ddc/ed6/64fddced6a4b65050eeacf128da6821a.png"><br><br><h1>  Apprenez et explorez: élevez votre propre Hanipot </h1><br>  Récemment, j'ai écrit un petit manuel sur la façon d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">installer Cowrie sur votre système</a> .  Comme déjà mentionné, dans notre cas, Digital Ocean VPS a été utilisé à Singapour.  Pour 24 heures d'analyse, le coût était littéralement de quelques centimes et le temps de construction du système était de 30 minutes. <br><br>  Au lieu d'exécuter Cowrie sur Internet et d'attraper tout le bruit, vous pouvez profiter du hanipot sur le réseau local.  Publiez un avis si des demandes sont envoyées à certains ports.  Il s'agit soit d'un intrus à l'intérieur du réseau, soit d'un employé curieux, soit d'une analyse de vulnérabilité. <br><br><h1>  Conclusions </h1><br>  Après avoir vu les actions des attaquants par jour, il devient clair qu'il est impossible de distinguer une source évidente d'attaques dans une organisation, un pays ou même le système d'exploitation. <br><br>  Des sources largement répandues montrent que le bruit de balayage est constant et n'est pas associé à une source spécifique.  Quiconque travaille sur Internet doit s'assurer que son système dispose de <b>plusieurs niveaux de sécurité</b> .  Une solution courante et efficace pour <b>SSH</b> consiste à déplacer le service vers un port haut aléatoire.  Cela n'élimine pas la nécessité d'une protection et d'une surveillance strictes par mot de passe, mais garantit au moins que les journaux ne sont pas obstrués par une analyse constante.  Les connexions haut port sont plus susceptibles de cibler des attaques susceptibles de vous intéresser. <br><br>  Souvent, les ports Telnet ouverts se trouvent sur des routeurs ou d'autres appareils, ils ne peuvent donc pas être facilement déplacés vers un port haut.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les informations sur tous les ports ouverts</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la surface d'attaque</a> sont le seul moyen de s'assurer que ces services sont protégés par un pare-feu ou désactivés.  Si possible, vous ne devez pas utiliser Telnet du tout, ce protocole n'est pas crypté.  Si vous en avez besoin sans lui, alors surveillez-le attentivement et utilisez des mots de passe forts. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436076/">https://habr.com/ru/post/fr436076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436064/index.html">L'intelligence artificielle pour tous</a></li>
<li><a href="../fr436066/index.html">Mathématiques de l'apocalypse: théorie des jeux et crise nucléaire des Caraïbes</a></li>
<li><a href="../fr436068/index.html">Conférence C ++ Russie 2019</a></li>
<li><a href="../fr436070/index.html">Comment gérer les tests floconneux dans la communauté opensource</a></li>
<li><a href="../fr436072/index.html">Nettoyer, marquer: comment nous avons appris à chatbot à distinguer les problèmes des clients</a></li>
<li><a href="../fr436080/index.html">Semaine de la sécurité 03: 2019 - Année de la confidentialité</a></li>
<li><a href="../fr436082/index.html">Comment l'UEBA contribue à améliorer la cybersécurité</a></li>
<li><a href="../fr436086/index.html">Présentation de la mise à jour 4 pour Veeam Cloud Connect</a></li>
<li><a href="../fr436088/index.html">L'éditeur graphique GANpaint dessine des objets et montre les capacités GAN</a></li>
<li><a href="../fr436090/index.html">Oracle existe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>