<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöã ‚õπüèº üïµÔ∏è Automa√ß√£o do processo de controle de qualidade de dados de armazenamento corporativo ü§Ωüèº üîÖ üë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na Rostelecom, como em qualquer grande empresa, existe um data warehouse corporativo (WCD). Nosso WCD est√° em constante crescimento e expans√£o; nele c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automa√ß√£o do processo de controle de qualidade de dados de armazenamento corporativo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/434542/"> Na Rostelecom, como em qualquer grande empresa, existe um data warehouse corporativo (WCD).  Nosso WCD est√° em constante crescimento e expans√£o; nele constru√≠mos vitrines, relat√≥rios e cubos de dados √∫teis.  Em algum momento, fomos confrontados com o fato de que dados de baixa qualidade interferem conosco ao criar vitrines, as unidades resultantes n√£o convergem para as unidades dos sistemas de origem e causam uma falta de entendimento dos neg√≥cios.  Por exemplo, dados com valores nulos em chaves estrangeiras (chaves estrangeiras) n√£o s√£o conectados aos dados de outras tabelas. <br>  Breve diagrama do WCD: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd8/4e9/34f/bd84e934f59ab39d8142ed7c18b397a8.png"><br><br>  Entendemos que, para garantir a confian√ßa na qualidade dos dados, precis√°vamos de um processo regular de reconcilia√ß√£o.  Obviamente, automatizou e permitiu que cada um dos n√≠veis tecnol√≥gicos garantisse a qualidade dos dados e sua converg√™ncia, tanto na vertical quanto na horizontal.  Como resultado, analisamos simultaneamente tr√™s plataformas prontas para gerenciar reconcilia√ß√µes de v√°rios fornecedores e criamos as nossas.  Compartilhamos nossa experi√™ncia neste post. <br><a name="habracut"></a><br>  Todos os inconvenientes das plataformas acabadas s√£o conhecidos por todos: pre√ßo, flexibilidade limitada, falta de capacidade de adicionar e corrigir funcionalidades.  As pe√ßas profissionais (dados em ouro, etc.), treinamento e suporte tamb√©m est√£o fechados.  Tendo apreciado isso, rapidamente esquecemos a compra e nos concentramos no desenvolvimento de nossa solu√ß√£o. <br><br>  O n√∫cleo do nosso sistema √© escrito em Python, e o banco de dados de metadados para armazenar, registrar e armazenar resultados √© escrito em Oracle.  Existem muitas bibliotecas para Python, usamos o m√≠nimo necess√°rio para conex√µes Hive (pyhive), GreenPlum (pgdb), Oracle (cx_Oracle).  Conectar um tipo diferente de fonte tamb√©m n√£o deve ser um problema. <br><br>  O conjunto de dados resultante (conjunto de resultados) que colocamos na tabela Oracle resultante, avaliando o status da reconcilia√ß√£o (SUCCESS / ERROR).  O APEX √© configurado nas tabelas resultantes nas quais a visualiza√ß√£o dos resultados √© constru√≠da, conveniente para manuten√ß√£o e gerenciamento. <br><br>  Para executar verifica√ß√µes no Reposit√≥rio, √© usada a orquestra da Informatica, que baixa os dados.  Ap√≥s o recebimento do status de √™xito do download, esses dados come√ßam a ser verificados automaticamente.  O uso de parametriza√ß√£o de consulta e metadados WCD permite o uso de modelos de reconcilia√ß√£o de consulta para conjuntos de tabelas. <br><br>  Agora, sobre as reconcilia√ß√µes implementadas nesta plataforma. <br><br>  Come√ßamos com reconcilia√ß√µes t√©cnicas, que comparam a quantidade de dados na entrada e nas camadas do WCD com a aplica√ß√£o de certos filtros.  Pegamos o arquivo ctl que veio para a entrada WCD, lemos o n√∫mero de registros e o comparamos com a tabela no Stage ODL e / ou Stage ODS (1, 2, 3 no diagrama).  O crit√©rio de verifica√ß√£o √© definido na igualdade do n√∫mero de registros (contagem).  Se a quantidade convergir, o resultado ser√° SUCESSO, sem erro e an√°lise manual do erro. <br><br>  Essa cadeia de reconcilia√ß√µes t√©cnicas, comparada ao n√∫mero de registros, se estende √† camada ADS (8 no diagrama).  Os filtros s√£o alterados entre as camadas, que dependem do tipo de carregamento - DIM (livro de refer√™ncia), HDIM (livro de refer√™ncia hist√≥rico), FACT (tabelas de acumula√ß√£o reais), etc. -, bem como da vers√£o do SCD e da camada.  Quanto mais pr√≥ximos da camada de exibi√ß√£o, mais sofisticados s√£o os algoritmos de filtragem que usamos. <br><br>  Tamb√©m foi realizada uma verifica√ß√£o t√©cnica na entrada do Python, que detecta duplicatas nos campos-chave.  No nosso GreenPlum, os campos-chave (PK) n√£o s√£o protegidos contra duplicatas pelas ferramentas do sistema de banco de dados.  Por isso, escrevemos um script Python que l√™ os campos da tabela carregada a partir dos metadados PK e gera um script SQL que verifica se h√° duplicatas neles.  A flexibilidade da abordagem nos permite usar a PK que consiste em um ou v√°rios campos, o que √© extremamente conveniente.  Essa reconcilia√ß√£o se estende √† camada STG ADS. <br><br><pre><code class="python hljs">unique_check  <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> datetime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime log_tmstmp = datetime.now().strftime(<span class="hljs-string"><span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args, context)</span></span></span><span class="hljs-function">:</span></span> tab = args[<span class="hljs-number"><span class="hljs-number">0</span></span>] data = [] fld_str = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: sql = <span class="hljs-string"><span class="hljs-string">"""SELECT 't_'||lower(table_id) as tn, lower(column_name) as cn FROM src_column@meta_data WHERE  table_id = '%s' and is_primary_key = 'Y'"""</span></span> % (tab,) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fld <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> context[<span class="hljs-string"><span class="hljs-string">'ora_get_data'</span></span>](context[<span class="hljs-string"><span class="hljs-string">'ora_con'</span></span>], sql): fld_str = fld_str + (fld_str <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">","</span></span>) + fld[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fld_str: config = context[<span class="hljs-string"><span class="hljs-string">'script_config'</span></span>] con_gp = context[<span class="hljs-string"><span class="hljs-string">'pg_open_con'</span></span>](config[<span class="hljs-string"><span class="hljs-string">'user'</span></span>], config[<span class="hljs-string"><span class="hljs-string">'pwd'</span></span>], config[<span class="hljs-string"><span class="hljs-string">'host'</span></span>], config[<span class="hljs-string"><span class="hljs-string">'port'</span></span>], config[<span class="hljs-string"><span class="hljs-string">'dbname'</span></span>]) sql = <span class="hljs-string"><span class="hljs-string">"""select %s as pkg_id, 't_%s' as table_name, 'PK fields' as column_name, coalesce(sum(cnt), 0) as NOT_UNIQUE_PK, to_char(current_timestamp, 'YYYY-MM-DD HH24:MI:SS') as sys_creation from (select 1 as cnt from edw_%s.t_%s where %s group by %s  having count(*) &gt; 1 ) sq; """</span></span> % (context[<span class="hljs-string"><span class="hljs-string">"package"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>,tab.lower(), args[<span class="hljs-number"><span class="hljs-number">1</span></span>], tab.lower(), (context[<span class="hljs-string"><span class="hljs-string">"package"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (<span class="hljs-string"><span class="hljs-string">"package_id = "</span></span> + context[<span class="hljs-string"><span class="hljs-string">"package"</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"1=1"</span></span>), fld_str ) data.extend(context[<span class="hljs-string"><span class="hljs-string">'pg_get_data'</span></span>](con_gp, sql)) con_gp.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> [[(context[<span class="hljs-string"><span class="hljs-string">"package"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>),<span class="hljs-string"><span class="hljs-string">'t_'</span></span>+tab.lower(), <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, log_tmstmp]] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: sys.exit(do_check([sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>], sys.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>]], {}))</code> </pre> <br>  <i>Exemplo de c√≥digo python de reconcilia√ß√£o de exclusividade.</i>  <i>A chamada, a transfer√™ncia dos par√¢metros de conex√£o e a coloca√ß√£o dos resultados na tabela resultante s√£o realizadas pelo m√≥dulo de controle em Python.</i> <br><br>  A reconcilia√ß√£o pela aus√™ncia de valores NULL √© constru√≠da de forma semelhante √† anterior e tamb√©m em Python.  Lemos nos campos de metadados de carregamento que n√£o podem ter valores vazios (NULL) e verificamos sua plenitude.  A reconcilia√ß√£o √© usada antes da camada DDS (6 no primeiro diagrama). <br><br>  Na entrada do armazenamento, tamb√©m √© implementada uma an√°lise de tend√™ncia dos pacotes de dados que chegam √† entrada.  A quantidade de dados recebidos quando um novo pacote chega √© inserida na tabela de hist√≥rico.  Com uma altera√ß√£o significativa na quantidade de dados, a pessoa respons√°vel pela tabela e o SI (sistema de origem) recebe uma notifica√ß√£o por email (nos planos), v√™ um erro no APEX antes do pacote de dados entrar no Warehouse e descobre o motivo disso com o SI. <br><br>  Entre STG (STAGE) _ODS e ODS (camada de dados operacionais) (3 e 4 no diagrama), os campos de exclus√£o t√©cnica s√£o exibidos (indicador de exclus√£o = delete_ind), cuja corre√ß√£o tamb√©m √© verificada por meio de consultas SQL.  A entrada ausente deve ser marcada como exclu√≠da no ODS. <br><br>  O resultado do script de reconcilia√ß√£o √© esperado para ver zero erros.  No exemplo de reconcilia√ß√£o apresentado, os par√¢metros ~ # PKG_ID # ~ s√£o transmitidos pelo bloco de controle Python, e os par√¢metros do tipo ~ P_JOIN_CONDITION ~ e ~ PERIOD_COL ~ s√£o preenchidos a partir dos metadados da tabela, o pr√≥prio nome da tabela ~ TABLE ~ a partir dos par√¢metros de inicializa√ß√£o. <br><br>  A seguir, √© apresentada uma reconcilia√ß√£o parametrizada.  Exemplo de c√≥digo de reconcilia√ß√£o SQL entre STG_ODS e ODS para o tipo HDIM: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> package_id <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pkg_id, <span class="hljs-string"><span class="hljs-string">'T_~TABLE~'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> table_name, to_char(<span class="hljs-keyword"><span class="hljs-keyword">current_timestamp</span></span>, <span class="hljs-string"><span class="hljs-string">'YYYY-MM-DD HH24:MI:SS'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(empty_in_ods, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> empty_in_ods, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(not_equal_md5, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> not_equal_md5, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(deleted_in_ods, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> deleted_in_ods, <span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(not_deleted_in_ods, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> not_deleted_in_ods, max_load_dttm <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">max</span></span> (src.package_id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> package_id,    <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> tgt.md5 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> empty_in_ods,    <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> src.md5&lt;&gt;tgt.md5 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> tgt.~PK~ <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> tgt.deleted_ind = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> not_equal_md5,    <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> tgt.deleted_ind = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> src.md5=tgt.md5 <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> deleted_in_ods <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> EDW_STG_ODS.T_~<span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>~  src <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> EDW_ODS.T_~<span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>~  tgt       <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ~P_JOIN_CONDITION~ <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> tgt.active_ind =<span class="hljs-string"><span class="hljs-string">'Y'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> ~<span class="hljs-comment"><span class="hljs-comment">#PKG_ID#~ = 0   or src.package_id = ~#PKG_ID#~ ) aa, (select sum (case when src.~PK~ is null then 1 else 0 end) as not_deleted_in_ods, max (tgt.load_dttm) as max_load_dttm from EDW_STG_ODS.T_~TABLE~  src right join EDW_ODS.T_~TABLE~  tgt        on ~P_JOIN_CONDITION~ where tgt.deleted_ind = 0 and tgt.active_ind ='Y'  and tgt.~PERIOD_COL~ between (select min(~PERIOD_COL~) from EDW_STG_ODS.T_~TABLE~ where ~#PKG_ID#~ = 0 or package_id = ~#PKG_ID#~)                           and (select max(~PERIOD_COL~) from EDW_STG_ODS.T_~TABLE~ where ~#PKG_ID#~ = 0 or package_id = ~#PKG_ID#~) ) bb where 1=1</span></span></code> </pre> <br>  Um exemplo de um c√≥digo de reconcilia√ß√£o SQL entre STG_ODS e ODS para um tipo HDIM com par√¢metros substitu√≠dos: <br><br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--------------HDIM_CHECKS--------------- select package_id as pkg_id, 'TABLE_NAME' as table_name, to_char(current_timestamp, 'YYYY-MM-DD HH24:MI:SS'), coalesce(empty_in_ods, 0) as empty_in_ods, coalesce(not_equal_md5, 0) as not_equal_md5, coalesce(deleted_in_ods, 0) as deleted_in_ods, coalesce(not_deleted_in_ods, 0) as not_deleted_in_ods, max_load_dttm from (select    max (src.package_id) as package_id,    sum (case when tgt.md5 is null then 1 else 0 end) as empty_in_ods,    sum (case when src.md5&lt;&gt;tgt.md5 and tgt.ACTION_ID is not null and tgt.deleted_ind = 0 then 1 else 0 end) as not_equal_md5,    sum (case when tgt.deleted_ind = 1 and src.md5=tgt.md5 then 1 else 0 end) as deleted_in_ods from EDW_STG_ODS.TABLE_NAME  src left join EDW_ODS.TABLE_NAME  tgt       on SRC.PK_ID=TGT.PK_ID and tgt.active_ind ='Y' where 709083887 = 0   or src.package_id = 709083887 ) aa, (select sum (case when src.PK_ID is null then 1 else 0 end) as not_deleted_in_ods, max (tgt.load_dttm) as max_load_dttm from EDW_STG_ODS.TABLE_NAME  src right join EDW_ODS.TABLE_NAME  tgt        on SRC.PK_ID =TGT.PK_ID where tgt.del_ind = 0 and tgt.active_ind ='Y'  and tgt.DATE_SYS between (select min(DATE_SYS) from EDW_STG_ODS.TABLE_NAME where 70908 = 0 or package_id = 70908)                           and (select max(DATE_SYS) from EDW_STG_ODS.TABLE_NAME where 70908 = 0 or package_id = 70908) ) bb where 1=1</span></span></code> </pre> <br>  A partir do ODS, o hist√≥rico √© mantido nos diret√≥rios, portanto, deve ser verificado a aus√™ncia de interse√ß√µes e lacunas.  Isso √© feito contando o n√∫mero de valores incorretos no hist√≥rico e gravando o n√∫mero resultante de erros na tabela resultante.  Se houver erros de hist√≥rico na tabela, eles dever√£o ser pesquisados ‚Äã‚Äãmanualmente.  A reconcilia√ß√£o depende do tipo de download - HDIM (guia de refer√™ncia do hist√≥rico) em primeiro lugar.  Realizamos reconcilia√ß√µes da corre√ß√£o do hist√≥rico para diret√≥rios at√© a camada ADS. <br><br>  Na camada DDS (6 no primeiro diagrama), diferentes SIs (sistemas de origem) s√£o combinados em uma tabela; as tabelas HUB para gerar chaves substitutas para vincular dados de diferentes sistemas de origem s√£o exibidas.  Verificamos a exist√™ncia de exclusividade com uma verifica√ß√£o de python semelhante √† camada de est√°gio. <br><br>  Na camada DDS, √© necess√°rio verificar se, ap√≥s combinar com a tabela HUB, os valores dos tipos 0, -1, -2 n√£o apareceram nos campos-chave, o que significa jun√ß√£o incorreta da tabela, falta de dados.  Eles podem aparecer na aus√™ncia dos dados necess√°rios na tabela HUB.  E este √© um erro para a an√°lise manual. <br><br>  As reconcilia√ß√µes mais complexas para os dados da camada de exibi√ß√£o do ADS (8 no primeiro diagrama).  Para total confian√ßa na converg√™ncia do resultado obtido, a verifica√ß√£o com um sistema de origem para agrega√ß√£o do valor das cobran√ßas √© implementada aqui.  Por um lado, h√° uma classe de indicadores que incluem accruals agregados.  N√≥s as coletamos por um m√™s nas janelas do WCD.  Por outro lado, coletamos as mesmas cobran√ßas do sistema de origem.  √â permitida uma discrep√¢ncia n√£o superior a 1% ou um valor absoluto determinado e acordado.  Os conjuntos de resultados obtidos pela reconcilia√ß√£o s√£o colocados em conjuntos de dados criados especialmente que recebem tabelas Oracle.  A compara√ß√£o de dados √© feita na visualiza√ß√£o Oracle.  Visualiza√ß√£o dos resultados no APEX.  A presen√ßa de todo um conjunto de dados (conjunto de resultados) nos permite, se houver erros, aprofundar e analisar os dados detalhados do resultado, encontrar um artigo espec√≠fico sobre o qual ocorreu a discrep√¢ncia e procurar seus motivos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/097/e40/ec3/097e40ec3c68bb49522d89aa228dbd5e.jpg"><br>  <i>Apresenta√ß√£o dos resultados da reconcilia√ß√£o para usu√°rios no APEX</i> <br><br>  No momento, obtivemos um aplicativo vi√°vel e usado ativamente para reconciliar dados.  Obviamente, temos planos de desenvolver ainda mais a quantidade e a qualidade das reconcilia√ß√µes e o desenvolvimento da pr√≥pria plataforma.  O pr√≥prio desenvolvimento nos permite alterar e modificar a funcionalidade com rapidez suficiente. <br><br>  <i>Este artigo foi preparado pela equipe de gerenciamento de dados Rostelecom</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt434542/">https://habr.com/ru/post/pt434542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt434530/index.html">Calend√°rio padr√£o, corre√ß√µes no LDAP e outras inova√ß√µes no Zimbra 8.8.11</a></li>
<li><a href="../pt434532/index.html">A hist√≥ria de um projeto: quando uma equipe n√£o tem um desenvolvedor s√™nior</a></li>
<li><a href="../pt434534/index.html">ONYX BOOX ‚ÄúMeu Primeiro Livro‚Äù: leitura inofensiva para m√£e e beb√™</a></li>
<li><a href="../pt434538/index.html">A luta pelo espa√ßo: o que est√° acontecendo no mercado da Internet via sat√©lite</a></li>
<li><a href="../pt434540/index.html">O que fazer com pessoas que ser√£o substitu√≠das por rob√¥s?</a></li>
<li><a href="../pt434544/index.html">‚ÄúN√≥s n√£o queremos guerra‚Äù - Entrevista com Ben Williams, diretor do Adblock Plus</a></li>
<li><a href="../pt434548/index.html">Patriota do Zimb√°bue gasta US $ 5.000 para digitalizar pa√≠s nativo no Google Street View</a></li>
<li><a href="../pt434550/index.html">O interior dos jogos retr√¥: Punch-Out para NES</a></li>
<li><a href="../pt434552/index.html">GDG SPb. O que conseguimos fazer em um ano</a></li>
<li><a href="../pt434558/index.html">Comunidade de suporte da Sib√©ria: start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>