<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè≠ üéóÔ∏è ‚è™ Haxe 4: O que h√° de novo? üññüèΩ üëçüèæ üå∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trago a sua aten√ß√£o uma tradu√ß√£o do relat√≥rio de Alexander Kuzmenko (desde abril deste ano ele trabalha oficialmente como desenvolvedor do compilador ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Haxe 4: O que h√° de novo?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455389/"><p>  Trago a sua aten√ß√£o uma tradu√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de Alexander Kuzmenko</a> (desde abril deste ano ele trabalha oficialmente como desenvolvedor do compilador Haxe) sobre mudan√ßas na linguagem Haxe ocorridas desde o lan√ßamento do Haxe 3.4. </p><br><img src="https://habrastorage.org/webt/0m/0e/mw/0m0emw609dcl9ycql2oa069lzfu.jpeg" alt="imagem"><br><p>  Mais de dois anos e meio se passaram desde o lan√ßamento do Haxe 3.4.  Durante esse per√≠odo, foram lan√ßadas 7 vers√µes de patches, 5 vers√µes de pr√©-visualiza√ß√£o do Haxe 4 e 2 candidatos a vers√µes do Haxe 4. Era um longo caminho at√© a nova vers√£o e est√° quase pronta ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cerca de 20 problemas</a> ainda precisam ser resolvidos). </p><a name="habracut"></a><br><img src="https://habrastorage.org/webt/jh/wp/7_/jhwp7_vztjntd_31hhmpqqreabe.png" alt="H√° muito tempo ..."><br><p>  Alexander agradeceu √† comunidade Haxe por reportar bugs, por seu desejo de participar do desenvolvimento do idioma.  Gra√ßas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ao projeto haxe-evolution</a> , coisas como a seguir aparecer√£o no Haxe 4: </p><br><ul><li>  marca√ß√£o embutida </li><li>  fun√ß√µes embutidas no local da chamada </li><li>  fun√ß√µes de seta </li></ul><br><img src="https://habrastorage.org/webt/kn/qf/fu/knqffu_thrc2godjucb5t4izbt0.png" alt="imagem"><br><p>  Al√©m disso, dentro da estrutura deste projeto, est√£o sendo realizadas discuss√µes sobre poss√≠veis inova√ß√µes como: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Promessas</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">isso polim√≥rfico</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tipos</a> padr√£o (par√¢metros de tipo padr√£o). </p><br><p>  Em seguida, Alexander falou <b>sobre as mudan√ßas na sintaxe do idioma</b> . </p><br><img src="https://habrastorage.org/webt/pg/jn/sy/pgjnsymvkyhlespf0rcj-dw6j8s.png" alt="Nova sintaxe para descrever os tipos de fun√ß√£o"><br><p> A primeira √© a nova sintaxe para descrever os tipos de fun√ß√£o.  A sintaxe antiga era um pouco estranha. <br>  O Haxe √© uma linguagem de programa√ß√£o com v√°rios paradigmas, sempre com suporte para fun√ß√µes de primeira classe, mas a sintaxe para descrever os tipos de fun√ß√µes foi herdada de uma linguagem funcional (e difere da adotada em outros paradigmas).  E os programadores familiarizados com a programa√ß√£o funcional esperam que as fun√ß√µes dessa sintaxe sejam compat√≠veis com o curry autom√°tico.  Mas em Haxe n√£o √© assim. <br>  A principal desvantagem da sintaxe antiga, de acordo com Alexander, √© a incapacidade de determinar os nomes dos argumentos, e √© por isso que voc√™ precisa escrever coment√°rios de anota√ß√£o longos com uma descri√ß√£o dos argumentos. <br>  Mas agora temos uma nova sintaxe para descrever os tipos de fun√ß√£o (que, a prop√≥sito, foram adicionados ao idioma como parte da iniciativa haxe-evolution), onde existe uma oportunidade (embora isso seja opcional, mas recomendado).  A nova sintaxe √© mais f√°cil de ler e pode at√© ser considerada parte da documenta√ß√£o do c√≥digo. <br>  Outra desvantagem da sintaxe antiga para descrever os tipos de fun√ß√£o era sua <code>Void-&gt;Void</code> - a necessidade de especificar o tipo de argumento da fun√ß√£o, mesmo quando a fun√ß√£o n√£o aceita argumentos: <code>Void-&gt;Void</code> (essa fun√ß√£o n√£o aceita argumentos e n√£o retorna nada). <br>  Na nova sintaxe, isso √© implementado de forma mais elegante: <code>()-&gt;Void</code> </p><br><img src="https://habrastorage.org/webt/xv/nr/fq/xvnrfqcbcxakqrci6y_p1hibh_4.png" alt="Fun√ß√µes de seta"><br><p>  O segundo s√£o fun√ß√µes de seta ou express√µes lambda - uma forma curta de descrever fun√ß√µes an√¥nimas.  A comunidade pede h√° muito tempo para adicion√°-los ao idioma e, finalmente, aconteceu! <br>  Nessas fun√ß√µes, em vez da palavra-chave de <code>return</code> , a sequ√™ncia de caracteres <code>-&gt;</code> (portanto, o nome da sintaxe √© "fun√ß√£o da seta"). <br>  Na nova sintaxe, ainda √© poss√≠vel definir os tipos de argumentos (como o sistema de infer√™ncia autom√°tica de tipos nem sempre pode fazer isso da maneira que o programador deseja, por exemplo, o compilador pode decidir usar <code>Float</code> vez de <code>Int</code> ). <br>  A √∫nica limita√ß√£o da nova sintaxe √© a incapacidade de definir explicitamente o tipo de retorno.  Se necess√°rio, voc√™ pode optar por usar a sintaxe antiga ou a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sintaxe do tipo de verifica√ß√£o</a> no corpo da fun√ß√£o, que informar√° ao compilador o tipo de retorno. </p><br><img src="https://habrastorage.org/webt/wh/ri/-8/whri-8d5u0nvjgkiybnrjp1vrag.png" alt="As fun√ß√µes de seta n√£o possuem uma representa√ß√£o especial na √°rvore de sintaxe"><br><p>  As fun√ß√µes de seta n√£o t√™m uma representa√ß√£o especial na √°rvore de sintaxe, s√£o processadas da mesma maneira que as fun√ß√µes an√¥nimas regulares.  A sequ√™ncia <code>-&gt;</code> √© substitu√≠da pela palavra-chave <code>return</code> . </p><br><img src="https://habrastorage.org/webt/nd/8c/kt/nd8cktem7lhra7ll-qao6hdatva.png" alt="final - agora √© uma palavra-chave"><br><p>  A terceira altera√ß√£o - <code>final</code> agora se tornou uma palavra-chave (na <code>final</code> Haxe 3, uma das meta tags incorporadas no compilador). <br>  Se voc√™ aplic√°-lo a uma classe, ele proibir√° a heran√ßa, o mesmo se aplica √†s interfaces.  A aplica√ß√£o do qualificador <code>final</code> a um m√©todo de classe impedir√° que ele seja substitu√≠do em classes filho. <br>  No entanto, no Haxe, havia uma maneira de contornar as restri√ß√µes impostas pela palavra-chave <code>final</code> - voc√™ pode usar a metatag <code>@:hack</code> para isso (mas ainda assim, isso deve ser feito apenas se for absolutamente necess√°rio). </p><br><img src="https://habrastorage.org/webt/ec/v3/mp/ecv3mpajsnrn6kxkrwx3rwkqlwe.png" alt="Declarando campos opcionais em estruturas an√¥nimas"><br><p>  A quarta altera√ß√£o √© uma maneira de declarar campos opcionais em estruturas an√¥nimas.  Anteriormente, a meta tag <code>@:optional</code> era usada para isso, agora basta adicionar um ponto de interroga√ß√£o na frente do nome do campo. </p><br><img src="https://habrastorage.org/webt/r8/i3/qb/r8i3qbo2r2seeqtyns2yhsbr5r8.png" alt="Listagens abstratas"><br><p>  Em quinto lugar, as enumera√ß√µes abstratas se tornaram um membro completo da fam√≠lia de tipos Haxe e, em vez da metatag <code>@:enum</code> palavra-chave <code>@:enum</code> agora √© usada para declar√°-las. </p><br><img src="https://habrastorage.org/webt/ew/b3/xt/ewb3xtnkjr_fdk4jtcdj-ezboao.png" alt="Palavra-chave externa"><br><p>  Uma mudan√ßa semelhante afetou a meta tag <code>@:extern</code> . </p><br><img src="https://habrastorage.org/webt/pb/g3/ip/pbg3ipuxlefguxcw5m-2qybtuqq.png" alt="Nova sintaxe para uni√£o de tipo (interse√ß√£o de tipo)"><br><p>  S√©timo √© um novo tipo de sintaxe de interse√ß√£o que reflete melhor a ess√™ncia das estruturas em expans√£o. <br>  A mesma nova sintaxe √© usada para limitar as restri√ß√µes dos par√¢metros de tipo; ela transmite com mais precis√£o as restri√ß√µes impostas a um tipo.  Para uma pessoa n√£o familiarizada com o Haxe, a sintaxe antiga <code>MyClass&lt;T:(Type1, Type2)&gt;</code> pode ser percebida como um requisito para o tipo do par√¢metro <code>T</code> ser <code>Type1</code> ou <code>Type2</code> .  A nova sintaxe nos diz explicitamente que <code>T</code> deve ser do tipo 1 e do tipo 2 ao mesmo tempo. </p><br><img src="https://habrastorage.org/webt/e9/un/cj/e9uncj0a6tk4uh0keuuopuwokgy.png" alt="Sintaxe simplificada para declarar um dicion√°rio vazio"><br><p>  A oitava √© a capacidade de usar <code>[]</code> para declarar um cont√™iner de <code>Map</code> vazio (no entanto, se voc√™ n√£o especificar explicitamente o tipo da vari√°vel, o compilador emitir√° o tipo como uma matriz para este caso). </p><br><p>  Depois de falar sobre as mudan√ßas na sintaxe, vamos para a descri√ß√£o de <b>novas fun√ß√µes no idioma</b> . <br>  Vamos come√ßar com os novos iteradores de valor-chave </p><br><img src="https://habrastorage.org/webt/gw/sg/3v/gwsg3vpv6qco2n61v4zxh0dfzvw.png" alt="Iteradores de valor-chave"><br><p>  Uma nova sintaxe foi adicionada para uso. <br>  Para oferecer suporte a esses iteradores, o tipo deve implementar o m√©todo <code>keyValueIterator():KeyValueIterator&lt;K, V&gt;</code> ou os m√©todos <code>hasNext():Bool</code> e <code>next():{key:K, value:V}</code> .  Ao mesmo tempo, o tipo <code>KeyValueIterator&lt;K, V&gt;</code> √© sin√¥nimo de um iterador regular na estrutura an√¥nima <code>Iterator&lt;{key:K, value:V}&gt;</code> . <br>  Os iteradores de valores-chave s√£o implementados para alguns tipos da biblioteca padr√£o Haxe ( <code>String</code> , <code>Map</code> , <code>DynamicAccess</code> ), e tamb√©m est√° em andamento o trabalho para implement√°-los para matrizes. </p><br><img src="https://habrastorage.org/webt/67/-f/g0/67-fg0qimh9gu7b8qvkaazjf4ti.png" alt="Suporte para novos iteradores para tipos internos"><br><p>  Para cadeias, o √≠ndice de caracteres na cadeia √© usado como chave e o c√≥digo de caracteres no √≠ndice especificado √© usado como valor (se o pr√≥prio caractere for necess√°rio, o m√©todo <code>String.fromCharCode()</code> poder√° ser usado). <br>  Para o cont√™iner de <code>Map</code> , o novo iterador funciona da mesma forma que o antigo m√©todo de itera√ß√£o, ou seja, recebe uma matriz de chaves no cont√™iner e passa por ele, solicitando valores para cada uma das chaves. <br>  Para <code>DynamicAccess</code> (um inv√≥lucro para objetos an√¥nimos), o iterador trabalha usando reflex√£o (para obter uma lista dos campos de um objeto usando o m√©todo <code>Reflect.fields()</code> e obter valores de campo por seus nomes usando o m√©todo <code>Reflect.field()</code> ). </p><br><img src="https://habrastorage.org/webt/ml/u7/qj/mlu7qjpnq86muxduteld_riofzu.png" alt="Novo int√©rprete de macro"><br><p>  O Haxe 4 usa um int√©rprete de macro completamente novo, "eval".  Simon Krajewski, autor do int√©rprete, o descreveu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">com</a> alguns detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no blog oficial do Haxe</a> , bem como em seu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de progresso do ano passado</a> . <br>  As principais mudan√ßas no trabalho do int√©rprete: </p><br><ul><li>  √© v√°rias vezes mais r√°pido que o antigo int√©rprete de macros (4 vezes em m√©dia) </li><li>  suporta depura√ß√£o interativa (anteriormente, para macros, somente a sa√≠da do console podia ser usada) </li><li>  √© usado para executar o compilador no modo de int√©rprete (anteriormente o neko foi usado para isso. A prop√≥sito, eval tamb√©m supera o neko na velocidade). </li></ul><br><img src="https://habrastorage.org/webt/f3/ef/e8/f3efe8ko9czu8tdyo5kzjswkfto.png" alt="Suporte Unicode"><br><p>  O suporte a Unicode para todas as plataformas (com exce√ß√£o da neko) √© uma das maiores mudan√ßas no Haxe 4. Simon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falou sobre isso em</a> detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no ano passado</a> .  Mas aqui est√° uma breve vis√£o geral do estado atual do suporte a strings Unicode no Haxe: </p><br><ul><li>  para Lua, PHP, Python e eval (interpretador de macro), √© implementado suporte unicode completo (codifica√ß√£o UTF8) </li><li>  para outras plataformas (JavaScript, C #, Java, Flash, HashLink e C ++), a codifica√ß√£o UTF16 √© usada. </li></ul><br><p>  Portanto, as linhas no Haxe funcionam da mesma maneira para caracteres inclu√≠dos no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">plano multil√≠ngue principal</a> , mas para caracteres fora deste plano (por exemplo, para emoji), o c√≥digo para trabalhar com linhas pode produzir resultados diferentes dependendo da plataforma (mas isso √© ainda melhor, do que a situa√ß√£o que temos no Haxe 3, quando cada plataforma tinha seu pr√≥prio comportamento). </p><br><img src="https://habrastorage.org/webt/5o/o2/fp/5oo2fp2s4h2t9rpqnvfyrbwb7gs.png" alt="Novos iteradores de string"><br><p>  Para cadeias codificadas em Unicode (tanto em UTF8 quanto em UTF16), iteradores especiais foram adicionados √† biblioteca padr√£o do Haxe que funcionam igualmente em TODAS as plataformas para todos os caracteres (no plano multil√≠ngue principal e al√©m): </p><br><pre> <code class="plaintext hljs">haxe.iterators.StringIteratorUnicode haxe.iterators.StringKeyValueIteratorUnicode</code> </pre> <br><img src="https://habrastorage.org/webt/3k/zv/xu/3kzvxup9p5crewap3u76tnfqhlg.png" alt="Recursos para suporte a Unicode"><br><p>  Como a implementa√ß√£o de strings varia de plataforma para plataforma, √© necess√°rio ter em mente algumas das nuances de seu trabalho.  No UTF16, cada caractere ocupa 2 bytes, portanto, o acesso a um caractere em uma sequ√™ncia de caracteres por √≠ndice √© r√°pido, mas apenas dentro do plano multil√≠ngue principal.  Por outro lado, em UTF8 todos os caracteres s√£o suportados, mas isso √© conseguido ao custo de uma pesquisa lenta por um caractere em uma sequ√™ncia de caracteres (como os caracteres podem ocupar diferentes n√∫meros de bytes na mem√≥ria, acessar um caractere por √≠ndice requer itera√ß√£o na linha todas as vezes desde o in√≠cio).  Portanto, ao trabalhar com grandes seq√º√™ncias de caracteres em Lua e PHP, voc√™ deve ter em mente que o acesso a um caractere arbitr√°rio funciona muito lentamente (tamb√©m nessas plataformas, o comprimento da string √© calculado novamente a cada vez). <br>  No entanto, embora o suporte completo a Unicode seja declarado para Python, essa restri√ß√£o n√£o se aplica a ele porque as linhas nele s√£o implementadas de uma maneira ligeiramente diferente: para caracteres no plano multil√≠ngue principal, ele usa a codifica√ß√£o UTF16 e para caracteres mais amplos (3 e mais bytes) O Python usa UTF32. <br>  Otimiza√ß√µes adicionais s√£o implementadas para o interpretador de macro eval: a sequ√™ncia "sabe" se cont√©m caracteres Unicode.  No caso de n√£o conter esses caracteres, a sequ√™ncia √© interpretada como consistindo em caracteres ASCII (em que cada caractere ocupa 1 byte).  O acesso seq√ºencial por √≠ndice em eval tamb√©m √© otimizado: a posi√ß√£o do √∫ltimo caractere acessado √© armazenada em cache na linha.  Portanto, se voc√™ girar primeiro para o 10¬∫ caractere na sequ√™ncia, quando voc√™ voltar para o 20¬∫ caractere, eval o procurar√° n√£o desde o in√≠cio da linha, mas a partir do 10¬∫.  Al√©m disso, o comprimento da sequ√™ncia em eval √© armazenado em cache, ou seja, √© calculado apenas na primeira solicita√ß√£o. </p><br><img src="https://habrastorage.org/webt/je/gi/ne/jegineguad8fp4dlqyhfbboxy8c.png" alt="Suporte de namespace para sinalizadores de compila√ß√£o"><br><p>  O Haxe 4 apresenta suporte para namespaces para sinalizadores de compila√ß√£o, que podem ser √∫teis, por exemplo, para organizar c√≥digo ao escrever bibliotecas personalizadas. <br>  Al√©m disso, um namespace reservado para sinalizadores de compila√ß√£o apareceu - <code>target</code> , que √© usado pelo compilador para descrever a plataforma de destino e seu comportamento: </p><br><ul><li>  <code>target.name</code> - nome da plataforma (js, cpp, php, etc.) </li><li>  <code>target.utf16</code> - diz que o suporte a Unicode √© implementado usando UTF16 </li><li>  <code>target.sys</code> - indica se as classes do pacote sys est√£o dispon√≠veis (por exemplo, para trabalhar com o sistema de arquivos) </li><li>  <code>target.static</code> - indica se a plataforma √© est√°tica (em plataformas est√°ticas, os tipos base <code>Int</code> , <code>Float</code> e <code>Bool</code> n√£o podem ter <code>null</code> como valor) </li><li>  <code>target.threaded</code> - indica se a plataforma suporta multithreading </li></ul><br><img src="https://habrastorage.org/webt/qt/ue/c_/qtuec_vbswkwgylwnidy9xuaeou.png" alt="Suporte de namespace para metatags"><br><p>  Da mesma forma, o suporte ao namespace para metatags apareceu.  At√© o momento, n√£o h√° namespaces reservados para metatags no idioma, mas a situa√ß√£o pode mudar no futuro. </p><br><img src="https://habrastorage.org/webt/cc/yj/ye/ccyjyemwz1ti9vgddvccyu4iqeq.png" alt="Novo tipo - ReadOnlyArray"><br><p>  O tipo <code>ReadOnlyArray</code> adicionado √† biblioteca padr√£o do Haxe - uma abstra√ß√£o em uma matriz regular, na qual os m√©todos est√£o dispon√≠veis apenas para a leitura de dados da matriz. </p><br><img src="https://habrastorage.org/webt/jr/ia/2o/jria2ovebta0bwm-lezr7jvv7ao.png" alt="Campos finais e vari√°veis ‚Äã‚Äãlocais"><br><p>  Outra inova√ß√£o no idioma s√£o os campos finais e as vari√°veis ‚Äã‚Äãlocais. <br>  Se <code>final</code> usado no lugar da palavra-chave <code>var</code> ao declarar um campo de classe ou vari√°vel local, isso significa que o campo ou vari√°vel especificado n√£o pode ser reatribu√≠do (se o compilador tentar fazer isso, ocorrer√° um erro).  Mas, ao mesmo tempo, seu estado pode ser alterado, portanto o campo ou vari√°vel final n√£o √© uma constante. </p><br><img src="https://habrastorage.org/webt/j-/8u/f9/j-8uf9asp_ivqbxn8kypatexma0.png" alt="O compilador controla a inicializa√ß√£o dos campos finais"><br><p>  Os valores dos campos finais devem ser inicializados quando eles s√£o declarados ou no construtor, caso contr√°rio, o compilador lan√ßar√° um erro. </p><br><img src="https://habrastorage.org/webt/2h/yd/wi/2hydwitcbuwstefblzdr09sxqzk.png" alt="Hashlink"><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O HashLink</a> √© uma nova plataforma com sua pr√≥pria m√°quina virtual, criada especificamente para a Haxe.  O HashLink suporta a chamada ‚Äúcompila√ß√£o dupla‚Äù - o c√≥digo pode ser compilado no bytecode (que √© muito r√°pido, acelera o processo de depura√ß√£o de aplicativos desenvolvidos) ou no c√≥digo C (que √© caracterizado pelo desempenho aprimorado).  Nicholas dedicou o HashLink a v√°rias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">postagens do blog Haxe</a> e tamb√©m falou sobre ele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">na confer√™ncia de</a> Seattle do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ano passado</a> .  A tecnologia HashLink √© usada em jogos populares como Dead Cells e Northgard. </p><br><img src="https://habrastorage.org/webt/zy/a4/eh/zya4eh5l7t3zqihviw5qvtcrsfc.png" alt="Seguran√ßa nula"><br><p>  Outro novo recurso interessante do Haxe 4 √© a seguran√ßa nula, que ainda est√° em fase experimental (devido a falsos positivos e verifica√ß√µes de seguran√ßa de c√≥digo insuficientes). <br>  O que √© seguran√ßa nula?  Se sua fun√ß√£o n√£o declarar explicitamente que pode aceitar <code>null</code> como valores de par√¢metro, quando voc√™ tenta passar <code>null</code> para ela, o compilador lan√ßar√° o erro correspondente.  Al√©m disso, para par√¢metros de fun√ß√£o que podem assumir <code>null</code> como valor, o compilador exigir√° que voc√™ escreva c√≥digo adicional para verificar e manipular esses casos. <br>  Essa funcionalidade √© desativada por padr√£o, mas n√£o afeta a velocidade de execu√ß√£o do c√≥digo (se voc√™ ativ√°-la, no entanto), pois as verifica√ß√µes descritas s√£o realizadas apenas no est√°gio de compila√ß√£o.  Ele pode ser ativado para todo o c√≥digo, bem como gradualmente ativado para campos, classes e pacotes individuais (fornecendo uma transi√ß√£o gradual para um c√≥digo mais seguro).  Voc√™ pode usar meta tags e macros especiais para isso. <br>  Os modos nos quais a seguran√ßa nula pode funcionar s√£o: <code>Strict</code> (o mais rigoroso), <code>Loose</code> (o modo padr√£o) e <code>Off</code> (usado para desativar as verifica√ß√µes de pacotes e tipos individuais). </p><br><img src="https://habrastorage.org/webt/mn/9l/jh/mn9ljhu2_wwwonpjo7qhcoiasyw.png" alt="Modo de verifica√ß√£o de seguran√ßa nula padr√£o"><br><p>  Para a fun√ß√£o mostrada no slide, a verifica√ß√£o de seguran√ßa nula est√° ativada.  Vemos que esta fun√ß√£o possui um par√¢metro opcional <code>s</code> , ou seja, podemos passar <code>null</code> para ela como um valor de par√¢metro.  Ao tentar compilar c√≥digo com essa fun√ß√£o, o compilador produzir√° v√°rios erros: </p><br><ul><li>  ao tentar acessar algum campo do objeto <code>s</code> (pois pode ser <code>null</code> ) </li><li>  ao tentar atribuir uma vari√°vel str, que, como vemos, n√£o deve ser <code>null</code> (caso contr√°rio, dever√≠amos t√™-la declarado n√£o como <code>String</code> , mas como <code>Null&lt;String&gt;</code> ) </li><li>  ao tentar retornar um objeto <code>s</code> de uma fun√ß√£o (j√° que a fun√ß√£o n√£o deve retornar <code>null</code> ) </li></ul><br><p>  Como corrigir esses erros? </p><br><img src="https://habrastorage.org/webt/ku/w-/l8/kuw-l8prqna5xq7c21ushemgtqs.png" alt="Corrigir erros de seguran√ßa nulos"><br><p>  N√≥s apenas precisamos adicionar verifica√ß√£o <code>null</code> ao c√≥digo (dentro do bloco com verifica√ß√£o <code>null</code> , o compilador ‚Äúsabe‚Äù que <code>s</code> n√£o pode ser <code>null</code> e pode ser usado com seguran√ßa), al√©m de garantir que a fun√ß√£o n√£o retorne <code>null</code> ! </p><br><img src="https://habrastorage.org/webt/x1/xj/jp/x1xjjpwn8ikrulbtulxj_iixlq4.png" alt="Ao executar verifica√ß√µes de seguran√ßa nula, o compilador leva em considera√ß√£o a ordem de execu√ß√£o do programa"><br><p>  Al√©m disso, ao executar verifica√ß√µes de seguran√ßa nula, o compilador leva em considera√ß√£o a ordem na qual os programas s√£o executados.  Por exemplo, se depois de verificar o valor do par√¢metro <code>s</code> para nulo para finalizar a fun√ß√£o (ou lan√ßar uma exce√ß√£o), o compilador ‚Äúsaber√°‚Äù que ap√≥s essa verifica√ß√£o, o par√¢metro <code>s</code> n√£o poder√° mais ser <code>null</code> e poder√° ser usado com seguran√ßa. </p><br><img src="https://habrastorage.org/webt/6f/vq/cj/6fvqcjbu-dixmrxcfuwtd8mskvk.png" alt="Modo estrito para executar verifica√ß√µes de seguran√ßa nulas"><br><p>  Se o compilador habilitar o modo Rigoroso de verifica√ß√µes para seguran√ßa Nula, ele exigir√° verifica√ß√µes adicionais para <code>null</code> nos casos em que entre a verifica√ß√£o inicial do valor <code>null</code> e uma tentativa de acessar o campo do objeto em que qualquer c√≥digo foi executado, podendo defini-lo como <code>null</code> . </p><br><img src="https://habrastorage.org/webt/ci/6m/u4/ci6mu4zsvkdjf33vvbetz30mf2m.png" alt="Modo frouxo para executar verifica√ß√µes de seguran√ßa nulas"><br><p>  No modo Loose (usado por padr√£o), o compilador n√£o exigir√° essas verifica√ß√µes (a prop√≥sito, esse comportamento tamb√©m √© usado por padr√£o no TypeScript). </p><br><img src="https://habrastorage.org/webt/je/wo/5q/jewo5qwzmavidsf-jss4bwug79i.png" alt="Verificando a inicializa√ß√£o dos campos ao executar verifica√ß√µes de seguran√ßa nula"><br><p>  Al√©m disso, quando as verifica√ß√µes de seguran√ßa nula est√£o ativadas, o compilador verifica se os campos nas classes s√£o inicializados (diretamente quando s√£o declarados ou no construtor).  Caso contr√°rio, o compilador lan√ßar√° erros ao tentar passar um objeto dessa classe, bem como ao tentar chamar m√©todos nesses objetos, at√© que todos os campos do objeto sejam inicializados.  Essas verifica√ß√µes podem ser desativadas para campos individuais da classe, marcando-as com a metatag <code>@:nullSafety(Off)</code> <br>  Alexander <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falou</a> mais sobre seguran√ßa nula em Haxe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em outubro passado</a> . </p><br><img src="https://habrastorage.org/webt/ui/f3/za/uif3zavird4vri76gqfiaukfsxo.png" alt="Gerando Classes ES6 para JavaScript"><br><p>  O Haxe 4 introduziu a capacidade de gerar classes ES6 para JavaScript; √© ativado usando o sinalizador de compila√ß√£o <code>js-es=6</code> . </p><br><img src="https://habrastorage.org/webt/z7/5c/ow/z75cowptrmqn5bxfa7oerxkxsro.png" alt="Funcionalidade no local"><br><p>  A incorpora√ß√£o de fun√ß√µes no local de uma chamada (inlining do site da chamada) oferece mais op√ß√µes para controlar o equil√≠brio entre o desempenho e o tamanho do c√≥digo.  Essa funcionalidade tamb√©m √© usada na biblioteca padr√£o Haxe. <br>  Como ela √©?  Ele permite incorporar o corpo da fun√ß√£o (usando a <code>inline</code> ) apenas nos locais em que √© necess√°rio garantir alto desempenho (por exemplo, se necess√°rio, chamar um m√©todo suficientemente volumoso no loop), enquanto em outros locais o corpo da fun√ß√£o n√£o √© incorporado.  Como resultado, o tamanho do c√≥digo gerado ser√° ligeiramente aumentado. </p><br><img src="https://habrastorage.org/webt/ke/0y/wf/ke0ywfco0j5pbynruiqr4mgqhxw.png" alt="Extens√µes autom√°ticas para tipos"><br><p>  O uso autom√°tico (extens√µes autom√°ticas para tipos) significa que agora para tipos voc√™ pode declarar extens√µes est√°ticas no local da declara√ß√£o de tipo.  Isso elimina a necessidade de usar a constru√ß√£o de <code>using type;</code> cada vez <code>using type;</code>  em cada m√≥dulo em que os m√©todos de tipo e extens√£o s√£o usados.  No momento, esse tipo de extens√£o √© implementado apenas para transfer√™ncias, mas na vers√£o final (e nas compila√ß√µes noturnas) pode ser usado n√£o apenas para transfer√™ncias. </p><br><img src="https://habrastorage.org/webt/ru/ts/6s/ruts6snzqmgjdbx1g0kmjc92oxw.png" alt="Substituindo o Operador para Acessar os Campos de um Objeto"><br><p>  No Haxe 4, ser√° poss√≠vel redefinir o operador para acessar os campos de um objeto para tipos abstratos (apenas para campos que n√£o existem no tipo).  Para fazer isso, use m√©todos marcados com a meta tag <code>@:op(ab)</code> . </p><br><img src="https://habrastorage.org/webt/qv/fu/fj/qvfufjhriheejf1q6i0epu82pw8.png" alt="Marca√ß√£o incorporada"><br><p>  A marca√ß√£o interna √© outro recurso experimental do Haxe.  O c√≥digo de marca√ß√£o interno n√£o √© processado pelo compilador como um documento xml - o compilador o v√™ como uma sequ√™ncia envolvida na metatag <code>@:markup</code> .           . </p><br><img src="https://habrastorage.org/webt/ms/an/zi/msanzicye9bpsmkbw55m6zcs34a.png" alt="   "><br><p>    -,   - <code>@:markup</code>    ,     . </p><br><img src="https://habrastorage.org/webt/pg/ek/2w/pgek2wa4v-ocjxauyq6e9oopvfc.png" alt="      untyped-"><br><p>               (  <code>untyped</code> ).           . ,   ,  <code>Js.build()</code>     - <code>@:markup</code>     ,        <code>&lt;js&gt;</code> ,     js-. </p><br><img src="https://habrastorage.org/webt/gk/vd/1f/gkvd1f3duuldpzde1zmmgvwbkza.png" alt=" -  - "><br><p>  Haxe 4     -  - ,    ‚Äî       . </p><br><img src="https://habrastorage.org/webt/br/gp/0c/brgp0cim1eozg7jjcopjmtx1xys.png" alt="     "><br><p>       .  ,        .   ,   <code>Int</code> ,      ,    C. </p><br><img src="https://habrastorage.org/webt/cj/3g/lf/cj3glfbn9l5owjjunjtrsn2jzvw.png" alt="     "><br><p>         ‚Äî       . </p><br><p> <b>     :</b> </p><br><img src="https://habrastorage.org/webt/y4/hl/fw/y4hlfwwz_db02rgmsj4f1jgw6r8.png" alt=" JVM- "><br><p>    JVM-   JDK,            Java-.    .         . </p><br><img src="https://habrastorage.org/webt/wj/ut/_z/wjut_zypg87r1f508zovsks2dio.png" alt=""><br><p>      ,     <code>async</code> / <code>await</code>  <code>yield</code> .       (   C#,       ).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>     Haxe    github. </p><br><img src="https://habrastorage.org/webt/ou/7r/gh/ou7rghzmynbwwvah6l7rumqpl8i.png" alt=",    "><br><p>  Haxe  <a href="">,    </a> .     ( )     .        ,    . </p><br><img src="https://habrastorage.org/webt/ty/y4/xw/tyy4xwdn9olejstawrdlqbux_tu.png" alt=" API     "><br><p>       API     .     ,   ,    API    . </p><br><p>      Haxe 4  ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455389/">https://habr.com/ru/post/pt455389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455375/index.html">Escrevendo UDR em Pascal</a></li>
<li><a href="../pt455377/index.html">Arquitetura IoT</a></li>
<li><a href="../pt455379/index.html">(Est√°tico) Sele√ß√£o de cont√™ineres ideais em programas C ++</a></li>
<li><a href="../pt455381/index.html">O suporte t√©cnico da 3CX responde: captura o tr√°fego SIP no servidor PBX</a></li>
<li><a href="../pt455387/index.html">Compreendendo o aprendizado de m√°quina no Elastic Stack (aka Elasticsearch, aka ELK)</a></li>
<li><a href="../pt455391/index.html">Parte 1: RISC-V / RocketChip em um habitat n√£o natural</a></li>
<li><a href="../pt455393/index.html">Sobre o uso de m√©todos param√©tricos de estimativa espectral em radar - o m√©todo MUSIC. Adi√ß√£o ao artigo</a></li>
<li><a href="../pt455397/index.html">Como projetamos e implementamos a nova rede na Huawei no escrit√≥rio de Moscou, parte 1</a></li>
<li><a href="../pt455401/index.html">Tcl para Cisco IOS em exemplos simples</a></li>
<li><a href="../pt455403/index.html">De cinco centavos ao jogo das divindades</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>