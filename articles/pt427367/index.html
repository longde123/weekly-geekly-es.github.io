<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî™ üìµ üôéüèΩ Confer√™ncia BLACK HAT USA. Como um hacker de Hollywood usa c√¢meras de vigil√¢ncia. Parte 1 üë¶üèª üëé üàØÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sou Greg Heffner, e essa √© uma conversa sobre como um hacker de Hollywood usa c√¢meras de vigil√¢ncia. Alguns de voc√™s podem ou n√£o saber que quando meu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Confer√™ncia BLACK HAT USA. Como um hacker de Hollywood usa c√¢meras de vigil√¢ncia. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/427367/"> Sou Greg Heffner, e essa √© uma conversa sobre como um hacker de Hollywood usa c√¢meras de vigil√¢ncia.  Alguns de voc√™s podem ou n√£o saber que quando meu trabalho sobre este t√≥pico foi publicado pela primeira vez, um artigo apareceu no portal da Internet da Reuters. <br><br><img src="https://habrastorage.org/webt/i4/rf/hx/i4rfhxxkmocn8xisdvkdrguweii.jpeg"><br><br>  Para mim, como palestrante, foi realmente √≥timo.  Mas o problema era que o artigo decidiu enfatizar que eu trabalhava para uma institui√ß√£o espec√≠fica com um nome de tr√™s letras, sobre o qual havia muito poucas notas na imprensa recentemente.  E foram t√£o longe que alegaram que apresentei no BlackHat meu trabalho realizado para esta ag√™ncia de tr√™s letras.  Esta publica√ß√£o levou a alguns telefonemas muito interessantes do meu ex-empregador. <br><br>  Felizmente, temos pessoas que atendem √†s minhas liga√ß√µes, ent√£o eles basicamente gritaram com eles, n√£o comigo, mas eu ainda tinha que tranquilizar as pessoas e, no final, consegui convencer o ex-empregador de que √†s vezes as pessoas na Internet tamb√©m est√£o errados. <br><br>  Portanto, para ser bem claro, explicarei que a conversa de hoje n√£o √© sobre qualquer trabalho que j√° fiz para ex-empregadores, mas sobre o que fa√ßo para meu atual empregador.  Trabalho como analisador de vulnerabilidades em tempo integral na Tactical Network Solutions, tamb√©m ensino cursos de opera√ß√µes de dispositivos incorporados e, ocasionalmente, dedico-me √† invas√£o de dispositivos sem fio. <br><br>  Hoje vou falar sobre a seguran√ßa das c√¢meras de vigil√¢ncia, ou melhor, a falta dessa seguran√ßa.  No in√≠cio do passado, 2011, comecei a estudar a quest√£o da seguran√ßa do firmware de c√¢meras conectadas √† rede de vigil√¢ncia e descobri muitas coisas interessantes. <br><br>  Deixarei de lado a amea√ßa do "dia zero", falarei sobre isso quando chegar a ela. Primeiro, mostrarei como, no estilo de um verdadeiro hacker de Hollywood, posso tirar proveito das vulnerabilidades que descobri. <a name="habracut"></a><br><br>  Ent√£o, quando comecei a estudar c√¢meras de vigil√¢ncia, e devo dizer que estudei muitos dispositivos embutidos, mas n√£o c√¢meras, eu queria come√ßar com algo simples, o que certamente me garantiria uma vit√≥ria.  Eu escolhi a D-Link porque eles nunca decepcionam. <br><br><img src="https://habrastorage.org/webt/q7/3e/mg/q73emg7hxxrcxw-54gyva8_x7lm.jpeg"><br><br>  Optei pelo DCS-7410, com pre√ßo em torno de US $ 900, esta √© uma das c√¢meras meteorol√≥gicas externas mais caras da D-Link, trabalhando nos modos diurno e noturno.  Como as outras c√¢meras, sobre as quais falaremos hoje, ela possui uma interface administrativa e suporta o acesso ao fluxo de v√≠deo via Internet para um servidor da Web, al√©m de ser alimentada por uma rede (PoE).  Isso o torna um alvo muito atraente para um invasor. <br><br>  Especificamente, esta c√¢mera usa o Lighttpd II, um servidor da Web de c√≥digo aberto que n√£o √© frequentemente usado com dispositivos incorporados.  Os desenvolvedores criaram uma configura√ß√£o e regras s√£s que restringem o acesso ao que pode ser alcan√ßado atrav√©s do servidor web. <br><br>  No pr√≥ximo slide, voc√™ ver√° que, se quiser obter algo no diret√≥rio administrativo cgi / admin, precisar√° ter direitos de administrador.  Se voc√™ deseja obter algo no diret√≥rio de v√≠deo, pode ser qualquer usu√°rio, mas deve estar autorizado.  Eles t√™m entradas e regras de login para cada diret√≥rio individual na interface da web, exceto o diret√≥rio cgi-bin. <br><br><img src="https://habrastorage.org/webt/0s/9n/_m/0s9n_mc6kkwgmih0nvfh9wm6kau.jpeg"><br><br><img src="https://habrastorage.org/webt/kp/tn/3u/kptn3ugjtfshhp-mg_hxwl6kerk.jpeg"><br><br>  A maioria dos scripts de c√¢mera cgi est√° localizada no diret√≥rio protegido por cgi.  Um diret√≥rio cgi-bin desprotegido cont√©m apenas um arquivo, rtpd.cgi, que √© um script de shell bash usado para iniciar e parar o protocolo de transporte de c√¢mera RTP em tempo real. <br><br><img src="https://habrastorage.org/webt/zz/by/o_/zzbyo_ebtddfagw6jpwuqilckky.jpeg"><br><br>  No entanto, o script rtpd.cgi tem uma falha s√©ria.  Ele analisa os par√¢metros da consulta substituindo todos os e comerciais e na string $ QUERY_STRING por espa√ßos e, em seguida, obt√©m o resultado usando a fun√ß√£o eval: <br><br><img src="https://habrastorage.org/webt/ck/ev/ox/ckevoxngnwan-_0hf6yyiyysab0.jpeg"><br><br>  Portanto, se voc√™ quiser parar a c√¢mera, envie uma solicita√ß√£o: rtpd.cgi? Action = stop.  Quando usada como pretendido, a seguinte solicita√ß√£o HTTP alterar√° o nome? Action, cujo valor ser√° definido para a posi√ß√£o "start": <br><br><pre><code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?action=start</code> </pre> <br>  Mas como os dados em $ query_string s√£o executados √†s cegas pelo m√©todo eval, um invasor pode executar qualquer comando simplesmente especificando-o como parte dos par√¢metros http GET: <br><br><pre> <code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?reboot</code> </pre> <br>  Assim, o hacker poder√° reiniciar a c√¢mera.  Foi realmente dif√≠cil para mim categorizar essa vulnerabilidade, porque nem sequer √© uma inje√ß√£o de comandos, n√£o inserimos nada, mas simplesmente permitimos que o programa seja executado com outros par√¢metros.  Chamei essa vulnerabilidade de "Ron Burgundy", porque ela literalmente far√° o que voc√™ digitar na cadeia de consulta. <br><br><img src="https://habrastorage.org/webt/ef/5_/yl/ef5_ylb-0jr20nngw8uqftcnjbo.jpeg"><br><br>  Um invasor pode usar esta vulnerabilidade para obter uma senha de administrador de c√¢mera normal da NVRAM.  O comando a seguir √© executado pelo script de inicializa√ß√£o da c√¢mera ap√≥s a reinicializa√ß√£o e envia ao navegador uma resposta desse tipo: <br><br><img src="https://habrastorage.org/webt/wx/48/og/wx48ogrv2omgwfklhlt9ytd-9lu.jpeg"><br><br>  Agora voc√™ n√£o tem apenas acesso root, porque depois de receber a senha, voc√™ tamb√©m se torna um administrador, para poder fazer qualquer coisa com a c√¢mera e os v√≠deos. <br><br>  Acontece que o D-link, como muitos fabricantes, gosta muito de reutilizar o c√≥digo instalando o mesmo firmware, e esse √© o caso em muitos de seus produtos.  Mas isso afeta n√£o apenas os produtos D-link, porque uma pr√°tica semelhante √© usada pela Trendnet e por alguns outros fabricantes "sem marca" de tais dispositivos.  A reutiliza√ß√£o de c√≥digo agora √© generalizada, tanto entre fabricantes da mesma marca quanto entre marcas diferentes.  Essa vulnerabilidade est√° contida no firmware de muitos modelos de c√¢mera indexados no recurso de cole√ß√µes de vulnerabilidades do computador Shodan Dork. <br><br><img src="https://habrastorage.org/webt/yq/hr/x3/yqhrx3jj2aexfxgsfde9ggqsity.jpeg"><br><br>  Essa vulnerabilidade pode parecer familiar para algumas pessoas, e provavelmente porque, ap√≥s minha palestra sobre esse assunto, o Core Security definiu o √≠ndice de vulnerabilidade CVE-2013-1599 para esses produtos, indicando que ele est√° presente apenas em dispositivos D-link, sem mencionar nenhuma de outro fabricante usando o mesmo firmware em seus dispositivos.  Mesmo que um dos fabricantes corrija esse erro na nova vers√£o do firmware, a maioria dos dispositivos permanecer√° vulner√°vel por mais 3 anos, porque geralmente ningu√©m atualiza o firmware a tempo e alguns n√£o sabem o que √©.  Como eu disse, os produtos D-link s√£o um dos alvos mais acess√≠veis para ataques, ent√£o vamos olhar para c√¢meras de fabricantes mais conceituados, como a Cisco com o modelo PVC 2300. Esta √© uma c√¢mera IP de classe comercial de m√©dio porte no valor de US $ 500. <br><br><img src="https://habrastorage.org/webt/an/xc/gb/anxcgbta5vml8jvdwwrjkcj1bki.jpeg"><br><br>  Atualmente, ele tamb√©m possui um servidor da web e fornece autentica√ß√£o usando um arquivo de senha no formato HTTP. <br><br><img src="https://habrastorage.org/webt/yo/oj/w4/yoojw4gf_hxahsfnot12iafr8yw.jpeg"><br><br>  A maioria das pessoas conhece esse sistema - voc√™ instala seu arquivo de senha HTTP ou, mais precisamente, um link para um arquivo de senha centralizado em qualquer diret√≥rio que voc√™ deseja proteger com uma senha.  Portanto, se voc√™ examinar o firmware, a interface da web de cada diret√≥rio continha um arquivo de senha .htpasswd, exceto um diret√≥rio, oamp, localizado em / usr / local / www / oamp. <br><br><img src="https://habrastorage.org/webt/5y/9_/5t/5y9_5t4aajko9fpfqyrgo8rxukq.jpeg"><br><br>  Em vez de um arquivo de senha, ele continha v√°rios arquivos XML que serviam como links para o arquivo bin√°rio oamp.cgi.  Vamos ver o que esse cgi faz.  Acontece que ele implementa um tipo de mini-API, que √© completamente separada de tudo o que √© executado na interface da web. <br><br><img src="https://habrastorage.org/webt/du/hp/ze/duhpze4khdkjnwkpxcq71egk1fa.jpeg"><br><br>  Ele espera que voc√™ seja solicitado a executar determinadas a√ß√µes, incluindo o download do arquivo de configura√ß√£o, a atualiza√ß√£o do arquivo de configura√ß√£o, o download do arquivo de atualiza√ß√£o do firmware, a atualiza√ß√£o do firmware e muito mais.  Os desenvolvedores n√£o foram t√£o est√∫pidos; portanto, antes de executar sua solicita√ß√£o, oamp.cgi verifica se voc√™ tem o ID de sess√£o v√°lido correto. <br><br><img src="https://habrastorage.org/webt/-y/w-/tc/-yw-tczrcu1suqe5m7nhkbckry0.jpeg"><br><br>  Se voc√™ n√£o possui um identificador de sess√£o v√°lido, a √∫nica coisa que pode fazer √© inserir um login. <br><br><img src="https://habrastorage.org/webt/h4/-f/db/h4-fdbh_byljwbfst90cnc0fa1w.jpeg"><br><br>  Isso por si s√≥ √© interessante porque eles implementaram uma verifica√ß√£o de autentica√ß√£o que n√£o √© usada em nenhum outro lugar da interface.  Comecei a entender como eles controlam a entrada, ou seja, o login.  Eles contam com seu nome de usu√°rio e senha, e sem mais surpresas. <br><br><img src="https://habrastorage.org/webt/cc/of/dh/ccofdh7-rzwu3cslr4rzawektjm.jpeg"><br><br><img src="https://habrastorage.org/webt/xl/zw/ms/xlzwmsxf0zvnpzunpu4sgncnrc4.jpeg"><br><br>  E ent√£o eles fazem duas chamadas para a fun√ß√£o PRO_GetStr, e eu n√£o tenho id√©ia do que elas afetam.  Mas eu sei que a primeira chamada para essa fun√ß√£o fornece duas linhas - OAMP e o nome de usu√°rio L1_usr, e a segunda chamada - mais duas linhas, OAMP e a senha L1_pwd. <br><br><img src="https://habrastorage.org/webt/n1/ym/om/n1ymomdakif9vlzheuwya5mjfty.jpeg"><br><br><img src="https://habrastorage.org/webt/78/fy/t9/78fyt9djqavicl7cicsxnd-zrw4.jpeg"><br><br>  Em seguida, o primeiro valor √© retornado para o usu√°rio L1 e comparado com o nome de usu√°rio user, L1_usr especificado durante a autentica√ß√£o, e o segundo valor da sequ√™ncia tamb√©m √© retornado - senha senha L1_usr, que √© comparada com a senha inserida pelo usu√°rio no login. <br><br><img src="https://habrastorage.org/webt/jw/-p/jv/jw-pjvidwi9ol_sb5fiv1zxv6kc.jpeg"><br><br><img src="https://habrastorage.org/webt/zo/ah/py/zoahpyuevenlfpkgkozbbdc7nle.jpeg"><br><br>  Presumivelmente, esse nome de usu√°rio e senha L1, quaisquer que sejam os valores, fornecem o logon correto para essa interface OAMP.  O √∫nico outro lugar que eu pude encontrar no firmware, e que est√° realmente associado ao nome de usu√°rio e senha do usu√°rio, est√° no arquivo de configura√ß√£o. <br><br><img src="https://habrastorage.org/webt/mm/pb/k5/mmpbk5f98z45lefbabw5x0l7jt8.jpeg"><br><br>  E esses valores s√£o codificados em dispositivos que usam o arquivo de configura√ß√£o da se√ß√£o OAMP durante a opera√ß√£o.  Voc√™ v√™ que o valor de login do usu√°rio L1 est√° definido na linha L1_admin e o valor da senha do usu√°rio est√° na linha L1_51. <br><br>  E esse √© um problema real, porque toda essa interface OAMP e essas contas codificadas s√£o completamente indocumentadas, ent√£o ningu√©m sabe que elas est√£o l√°, exceto as pessoas que se preocuparam em examinar o firmware.  Obviamente, o administrador nunca far√° isso. <br><br>  Mas, mesmo que ele tenha descoberto, n√£o h√° como ele alterar esses valores, pois n√£o h√° interface de administrador nessa c√¢mera.  O problema das senhas secretas codificadas √© que, gra√ßas ao uso de backdoors, elas permanecem em segredo por um curto per√≠odo de tempo. <br><br>  Portanto, podemos usar essas contas backdoor para efetuar login e obter um ID de sess√£o.  Agora que podemos enviar esse ID de sess√£o junto com nossas solicita√ß√µes, tamb√©m podemos invocar outras a√ß√µes suportadas pelo oamp.cgi, incluindo o download do arquivo de configura√ß√£o. <br><br><img src="https://habrastorage.org/webt/an/w3/i1/anw3i17pq_cvs9ojuxuxrizzcqe.jpeg"><br><br><img src="https://habrastorage.org/webt/9a/_a/lp/9a_alpxed7vbjf9v1qx4pc9arqu.jpeg"><br><br>  O problema √© que, se voc√™ tentar descriptograf√°-lo usando o Base64, isso n√£o funcionar√°, voc√™ receber√° um monte de lixo.  Este √© o caso quando Base64 n√£o √© Base64. <br><br><img src="https://habrastorage.org/webt/g2/ty/mb/g2tymbmqw_ivhqvpxtvkzlnkr28.jpeg"><br><br>  A raz√£o para isso se torna √≥bvia quando voc√™ olha para o c√≥digo final Base64 no arquivo bin√°rio do firmware PVC-2300 - a base da codifica√ß√£o √© criada aqui, mas usa uma cadeia de chaves Base64 n√£o padr√£o, que foi descoberta ao analisar a criptografia e descriptografia do c√≥digo 64. Felizmente, com Usando o Python, √© muito f√°cil alterar uma string de chave em um m√≥dulo Python Base64 para uma string de chave personalizada, conforme mostrado no slide. <br><br><img src="https://habrastorage.org/webt/1j/lo/fb/1jlofb--8fxiriwhad4abpwuxju.jpeg"><br><br>  Portanto, com algumas seq√º√™ncias de caracteres Python, podemos descriptografar facilmente o arquivo de configura√ß√£o e transform√°-lo em texto sem formata√ß√£o, o que nos d√° op√ß√µes de login sob o login do administrador. <br><br><img src="https://habrastorage.org/webt/dd/a6/wm/dda6wmvvhgydwz8vxdu7utsslim.jpeg"><br><br>  Tendo ganho o controle da c√¢mera, podemos ver a sala do servidor.  O problema √© que a visualiza√ß√£o das salas do servidor realmente captura os primeiros 10 segundos, mas se torna uma tarefa bastante chata. <br><br><img src="https://habrastorage.org/webt/v9/sn/yq/v9snyqmqg0robtcbe86hp6iwe6o.jpeg"><br><br>  Portanto, voltei ao c√≥digo e comecei a estudar a possibilidade de baixar o firmware.  Isso √© realmente muito interessante, porque, em vez de baixar o arquivo de firmware para o dispositivo a partir do site oficial, voc√™ pode especificar sua pr√≥pria URL, o dispositivo ir√° para esse endere√ßo e far√° o download do que ele supostamente considera firmware. <br><br><img src="https://habrastorage.org/webt/bs/u1/gj/bsu1gjoyhq5ieybllbrxcjsd4ig.jpeg"><br><br>  A fun√ß√£o system2 simplesmente gera um comando a partir da string de formato e da URL antes de chamar a fun√ß√£o libc system, que permite que um invasor insira comandos arbitr√°rios do shell por meio do par√¢metro url.  O comando do invasor ser√° executado com direitos de superusu√°rio e, como a verifica√ß√£o √© realizada pelo valor da URL, √© muito f√°cil ignor√°-lo com o seguinte script: <br><br><pre> <code class="hljs ruby">$ wget --header=‚Äù<span class="hljs-symbol"><span class="hljs-symbol">sessionID:</span></span> <span class="hljs-number"><span class="hljs-number">57592414</span></span>‚Äù <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/oamp</span></span><span class="hljs-regexp"><span class="hljs-regexp">/System.xml?action=loadFirmware&amp;url=https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/127.0.0.1:6 5534/</span></span>;reboot;</code> </pre> <br>  Depois disso, o computador localizado neste URL √© reiniciado e voc√™ pode executar qualquer comando que desejar. <br><br><img src="https://habrastorage.org/webt/1r/wj/j5/1rwjj5ih0d0j1fybyteeg7mdnyw.jpeg"><br><br>  Essa vulnerabilidade foi testada em todas as vers√µes de firmware de dois modelos de c√¢meras de vigil√¢ncia da Cisco - PVC-2300 e WVC-2300, uma c√¢mera semelhante com duas antenas.  No momento da reda√ß√£o deste artigo, Shodan mostrava mais de 500 c√¢meras IP p√∫blicas e potencialmente vulner√°veis ‚Äã‚Äãpertencentes a hot√©is, salas de servidores e empresas de engenharia que desenvolviam equipamentos para a Esta√ß√£o Espacial Internacional. <br><br>  Portanto, o D-link e a Cisco n√£o protegem adequadamente as c√¢meras de vigil√¢ncia, embora voc√™ saiba que essas c√¢meras n√£o s√£o o produto principal.  Portanto, vejamos marcas especializadas especificamente no design e fabrica√ß√£o de c√¢meras de vigil√¢ncia.  Eu escolhi a IQ Invision, que produz c√¢meras caras de alta defini√ß√£o, como a IQ 832n, que custa mais de US $ 1000 cada, o que n√£o √© nada barato. <br><br><img src="https://habrastorage.org/webt/od/4n/47/od4n470mrojtlam7vrbiqpaagcw.jpeg"><br><br>  O principal motivo de meu interesse √© que esses s√£o os caras que fabricam c√¢meras instaladas no complexo comercial em que trabalho, portanto, havia motivos pessoais para isso.  Ent√£o, o que voc√™ ganha com uma c√¢mera de vigil√¢ncia profissional por mil d√≥lares? <br>  Por padr√£o, essas c√¢meras fornecem uma imagem de v√≠deo n√£o autenticada e nenhum dos extensos estudos de instala√ß√£o de c√¢meras conseguiu alterar essa configura√ß√£o padr√£o.  Enquanto a interface administrativa √© protegida por senha, a interface do usu√°rio fornece acesso a qualquer recurso da c√¢mera sem autentica√ß√£o, o que cria um amplo campo de ataque. <br><br><img src="https://habrastorage.org/webt/mn/gr/mn/mngrmndqcnufl90nrnj_lfhpvse.jpeg"><br><br>  As configura√ß√µes de autentica√ß√£o do administrador podem ser alteradas pelo administrador, mas tente adivinhar quantos administradores conectaram suas c√¢meras √† Internet sem alterar as configura√ß√µes padr√£o - quase tudo.  No entanto, a maioria dos administradores em nosso complexo era inteligente o suficiente para alterar essas configura√ß√µes, ent√£o comecei a analisar o que mais eu poderia fazer sem autentica√ß√£o.  Descobri que posso acessar livremente a p√°gina. <br><br><img src="https://habrastorage.org/webt/qo/m2/xc/qom2xc4tfzyzncf5bienr4e4a5m.jpeg"><br><br>  Ele cont√©m v√°rias configura√ß√µes da c√¢mera, como configura√ß√µes de foco, que n√£o s√£o t√£o interessantes quanto nomes de usu√°rio e senhas.  Mais interessante foi o c√≥digo por tr√°s desta p√°gina oidtable.cgi.  Se voc√™ desmontar esse bin√°rio, poder√° ver que a p√°gina aceita apenas um par√¢metro, grep, que √© usado para filtrar os resultados retornados √† p√°gina oidtable.cgi. <br><br><img src="https://habrastorage.org/webt/xq/xa/bw/xqxabwwpfodp1lbutwkjhnh0iws.jpeg"><br><br>  Depois de verificar se o valor do par√¢metro fornecido tem menos de 32 caracteres, oidtable.cgi coloca esse valor na linha de comando e passa para o popen: <br><br><img src="https://habrastorage.org/webt/7o/6t/gx/7o6tgx98hkegmfygblszjdmtqbm.jpeg"><br><br><img src="https://habrastorage.org/webt/i6/0a/4s/i60a4smzvkzi1hsop0lam0rcv9i.jpeg"><br><br>  O que vi me fez retratar o "facepalm" e me levou a injetar algumas equipes. <br><br><img src="https://habrastorage.org/webt/k2/2g/c3/k22gc3orqjsproq9bgagtpbwntk.jpeg"><br><br>  Voc√™ v√™ que aqui, assim como no caso da D-Link, eu posso executar o comando PS e obter a sa√≠da enviada de volta ao meu navegador.  Assim, sem autentica√ß√£o, posso inserir facilmente comandos arbitr√°rios do shell que ser√£o executados como raiz.  As listas de processos mostram que o Netcat j√° est√° instalado nessas c√¢meras com a capacidade de inserir tra√ßos-e, portanto, tenho certeza de que a maioria das pessoas aqui pode criar comandos mais interessantes para executar do que a lista de processos.  No entanto, meu principal objetivo era entrar no painel de administra√ß√£o e descobri como faz√™-lo. <br><br>  16:30 min <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Confer√™ncia BLACK HAT USA.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como um hacker de Hollywood usa c√¢meras de vigil√¢ncia.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/B8DjTcANBx0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando a seus amigos, um <b>desconto de 30% para os usu√°rios da Habr em um an√°logo exclusivo de servidores b√°sicos que inventamos para voc√™:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a verdade sobre o VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps da US $ 20 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD de 1Gbps at√© dezembro de gra√ßa</b> quando pagar por um per√≠odo de seis meses, voc√™ pode fazer o pedido <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  <b>Dell R730xd 2 vezes mais barato?</b>  Somente n√≥s temos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2 TVs Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 a partir de US $ 249</a> na Holanda e nos EUA!</b>  Leia sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427367/">https://habr.com/ru/post/pt427367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427357/index.html">Escrevendo shaders no Unity. GrabPass, PerRendererData</a></li>
<li><a href="../pt427359/index.html">Como ECS, C # Job System e SRP alteram a arquitetura</a></li>
<li><a href="../pt427361/index.html">Recursos de filtragem de janelas no FPGA</a></li>
<li><a href="../pt427363/index.html">Implementa√ß√£o do LoRaWAN em uma empresa agr√≠cola. Tudo sobre constru√ß√£o, lan√ßamento e solu√ß√µes</a></li>
<li><a href="../pt427365/index.html">Relat√≥rio do RedSlerm sobre monitoramento (Monit, Zabbix)</a></li>
<li><a href="../pt427369/index.html">Confer√™ncia BLACK HAT USA. Como um hacker de Hollywood usa c√¢meras de vigil√¢ncia. Parte 2</a></li>
<li><a href="../pt427371/index.html">Curso em v√≠deo "Fundamentos do trabalho com nota√ß√µes BPMN". Gr√°tis</a></li>
<li><a href="../pt427373/index.html">O Firefox pode ser monetizado com o complemento de VPN pago incorporado</a></li>
<li><a href="../pt427377/index.html">Administrador de sistema simples de CI / CD</a></li>
<li><a href="../pt427379/index.html">Junior Senior: Revis√£o do telefone IP Snom D715</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>