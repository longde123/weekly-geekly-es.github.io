<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äç‚öïÔ∏è üíÇ ‚ùé SOMBRERO NEGRO Conferencia de Estados Unidos. C√≥mo un hacker de Hollywood usa c√°maras de vigilancia. Parte 1 üëºüèΩ üëû üê©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Soy Greg Heffner, y esta es una conversaci√≥n sobre c√≥mo un hacker de Hollywood usa c√°maras de vigilancia. Algunos de ustedes pueden saber o no que cua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SOMBRERO NEGRO Conferencia de Estados Unidos. C√≥mo un hacker de Hollywood usa c√°maras de vigilancia. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/427367/">  Soy Greg Heffner, y esta es una conversaci√≥n sobre c√≥mo un hacker de Hollywood usa c√°maras de vigilancia.  Algunos de ustedes pueden saber o no que cuando se public√≥ mi trabajo sobre este tema, apareci√≥ un art√≠culo en el portal de Internet de Reuters. <br><br><img src="https://habrastorage.org/webt/i4/rf/hx/i4rfhxxkmocn8xisdvkdrguweii.jpeg"><br><br>  Para m√≠, como orador, fue realmente genial.  Pero el problema fue que el art√≠culo decidi√≥ enfatizar que trabajaba para una instituci√≥n espec√≠fica con un nombre de tres letras, sobre el cual hab√≠a muy pocas notas en la prensa recientemente.  Y llegaron tan lejos que afirmaron que present√© en BlackHat mi trabajo realizado para esta agencia de tres letras.  Esta publicaci√≥n gener√≥ algunas llamadas telef√≥nicas muy interesantes de mi antiguo empleador. <br><br>  Afortunadamente, tenemos personas que responden mis llamadas telef√≥nicas, as√≠ que b√°sicamente les gritaron a ellos, no a m√≠, pero a√∫n as√≠ tuve que tranquilizar a las personas y, al final, pude convencer al antiguo empleador de que a veces las personas en Internet tambi√©n est√°n equivocados. <br><br>  Por lo tanto, para ser muy claro, explicar√© que la conversaci√≥n de hoy no se trata de ning√∫n trabajo que haya realizado para empleadores anteriores, sino de lo que hago para mi empleador actual.  Trabajo como analizador de vulnerabilidades a tiempo completo para Tactical Network Solutions, tambi√©n ense√±o cursos de operaciones de dispositivos integrados y ocasionalmente incursiono en la pirater√≠a de dispositivos inal√°mbricos. <br><br>  Hoy hablar√© sobre la seguridad de las c√°maras de vigilancia, o m√°s bien, la falta de esta seguridad.  A principios del pasado, 2011, comenc√© a estudiar el tema de la seguridad del firmware de las c√°maras conectadas a la red de vigilancia, y descubr√≠ muchas cosas interesantes. <br><br>  Dejar√© de lado la amenaza del "d√≠a cero", hablar√© sobre ello cuando llegue a ella, primero te mostrar√© c√≥mo, al estilo de un verdadero hacker de Hollywood, puedo aprovechar las vulnerabilidades que descubr√≠. <a name="habracut"></a><br><br>  Entonces, cuando comenc√© a estudiar c√°maras de vigilancia, y debo decir que estudi√© muchos dispositivos incorporados, pero no c√°maras, quer√≠a comenzar con algo simple, que seguramente me garantizar√≠a una victoria.  Eleg√≠ D-Link porque nunca decepcionan. <br><br><img src="https://habrastorage.org/webt/q7/3e/mg/q73emg7hxxrcxw-54gyva8_x7lm.jpeg"><br><br>  Opt√© por la DCS-7410, con un precio de alrededor de $ 900, esta es una de las c√°maras clim√°ticas para exteriores m√°s caras D-Link, que funciona en modo diurno y nocturno.  Al igual que las otras c√°maras, de las que hablaremos hoy, tiene una interfaz administrativa y admite el acceso a la transmisi√≥n de video a trav√©s de Internet a un servidor web, y tambi√©n se alimenta a trav√©s de una red (PoE).  Esto lo convierte en un objetivo muy atractivo para un atacante. <br><br>  Espec√≠ficamente, esta c√°mara utiliza Lighttpd II, un servidor web de c√≥digo abierto que a menudo no se usa con dispositivos integrados.  Los desarrolladores crearon una configuraci√≥n sensata y reglas que restringen el acceso a lo que se puede alcanzar a trav√©s del servidor web. <br><br>  En la siguiente diapositiva, ver√° que si desea obtener algo en el directorio administrativo cgi / admin, debe tener derechos de administrador.  Si desea obtener algo en el directorio de videos, puede ser cualquier usuario, pero debe estar autorizado.  Tienen entradas y reglas de inicio de sesi√≥n para cada directorio individual en la interfaz web, excepto para el directorio cgi-bin. <br><br><img src="https://habrastorage.org/webt/0s/9n/_m/0s9n_mc6kkwgmih0nvfh9wm6kau.jpeg"><br><br><img src="https://habrastorage.org/webt/kp/tn/3u/kptn3ugjtfshhp-mg_hxwl6kerk.jpeg"><br><br>  La mayor√≠a de los scripts cgi de la c√°mara se encuentran en el directorio protegido cgi.  Un directorio cgi-bin desprotegido contiene solo un archivo, rtpd.cgi, que es un script de shell bash utilizado para iniciar y detener el protocolo de transporte de la c√°mara RTP en tiempo real. <br><br><img src="https://habrastorage.org/webt/zz/by/o_/zzbyo_ebtddfagw6jpwuqilckky.jpeg"><br><br>  Sin embargo, el script rtpd.cgi tiene una falla grave.  Analiza los par√°metros de la consulta reemplazando todos los s√≠mbolos &amp; en la cadena $ QUERY_STRING con espacios, y luego obtiene el resultado usando la funci√≥n eval: <br><br><img src="https://habrastorage.org/webt/ck/ev/ox/ckevoxngnwan-_0hf6yyiyysab0.jpeg"><br><br>  Entonces, si solo desea detener la c√°mara, simplemente env√≠e una solicitud: rtpd.cgi? Action = stop.  Cuando se utiliza seg√∫n lo previsto, la siguiente solicitud HTTP cambiar√° el nombre? Acci√≥n, cuyo valor se establecer√° en la posici√≥n "inicio": <br><br><pre><code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?action=start</code> </pre> <br>  Pero dado que los datos en $ query_string se ejecutan ciegamente por el m√©todo eval, un atacante puede ejecutar cualquier comando simplemente al especificarlo como parte de los par√°metros http GET: <br><br><pre> <code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?reboot</code> </pre> <br>  Por lo tanto, el hacker puede reiniciar la c√°mara.  De hecho, fue dif√≠cil para m√≠ categorizar esta vulnerabilidad, porque ni siquiera es una inyecci√≥n de comandos, no ingresamos nada, sino que simplemente permitimos que el programa se ejecute con otros par√°metros.  Llam√© a esta vulnerabilidad "Ron Burgundy", porque literalmente har√° lo que ingrese en la cadena de consulta. <br><br><img src="https://habrastorage.org/webt/ef/5_/yl/ef5_ylb-0jr20nngw8uqftcnjbo.jpeg"><br><br>  Un atacante podr√≠a usar esta vulnerabilidad para obtener una contrase√±a de administrador de c√°mara normal de NVRAM.  La secuencia de comandos de inicio de la c√°mara ejecuta el siguiente comando despu√©s de reiniciar y env√≠a a su navegador una respuesta de este tipo: <br><br><img src="https://habrastorage.org/webt/wx/48/og/wx48ogrv2omgwfklhlt9ytd-9lu.jpeg"><br><br>  Ahora no solo tiene acceso de root, porque despu√©s de recibir la contrase√±a, tambi√©n se convierte en administrador, por lo que puede hacer cualquier cosa con la c√°mara y los videos. <br><br>  Como resultado, D-link, como muchos fabricantes, realmente adora reutilizar el c√≥digo instalando el mismo firmware, y este es el caso en muchos de sus productos.  Pero esto no solo afecta a los productos D-link, ya que Trendnet y algunos otros fabricantes "no de marca" de dichos dispositivos utilizan una pr√°ctica similar.  La reutilizaci√≥n de c√≥digos ahora est√° muy extendida, tanto entre fabricantes de la misma marca como entre diferentes marcas.  Esta vulnerabilidad est√° contenida en el firmware de muchos modelos de c√°maras que est√°n indexados en el recurso de recopilaci√≥n de vulnerabilidad de computadora Shodan Dork. <br><br><img src="https://habrastorage.org/webt/yq/hr/x3/yqhrx3jj2aexfxgsfde9ggqsity.jpeg"><br><br>  Esta vulnerabilidad puede parecer familiar para algunas personas, y esto probablemente se deba a que despu√©s de mi discurso sobre este tema, Core Security estableci√≥ el √≠ndice de vulnerabilidad CVE-2013-1599 para estos productos, lo que indica que solo est√° presente en dispositivos D-link, sin mencionar ninguno de otro fabricante que usa el mismo firmware en sus dispositivos.  Incluso si uno de los fabricantes corrige este error en la nueva versi√≥n de firmware, la mayor√≠a de los dispositivos seguir√°n siendo vulnerables durante otros 3 a√±os, porque generalmente nadie actualiza el firmware a tiempo, y algunos no saben qu√© es.  Como dije, los productos D-link son uno de los objetivos m√°s asequibles para el ataque, as√≠ que echemos un vistazo a las c√°maras de fabricantes de mayor reputaci√≥n, como Cisco con el modelo PVC 2300. Esta es una c√°mara IP de clase empresarial de gama media con un valor de $ 500. <br><br><img src="https://habrastorage.org/webt/an/xc/gb/anxcgbta5vml8jvdwwrjkcj1bki.jpeg"><br><br>  Actualmente tambi√©n tiene un servidor web y proporciona autenticaci√≥n mediante un archivo de contrase√±a en formato HTTP. <br><br><img src="https://habrastorage.org/webt/yo/oj/w4/yoojw4gf_hxahsfnot12iafr8yw.jpeg"><br><br>  La mayor√≠a de las personas est√°n familiarizadas con este sistema: instala su archivo de contrase√±a HTTP, o m√°s precisamente, un enlace a un archivo de contrase√±a centralizado en cualquier directorio que desee proteger con una contrase√±a.  Por lo tanto, si observa el firmware, la interfaz web de cada directorio contiene un archivo de contrase√±a .htpasswd, excepto un directorio, oamp, ubicado en / usr / local / www / oamp. <br><br><img src="https://habrastorage.org/webt/5y/9_/5t/5y9_5t4aajko9fpfqyrgo8rxukq.jpeg"><br><br>  En lugar de un archivo de contrase√±a, conten√≠a un mont√≥n de archivos XML que serv√≠an como enlaces al archivo binario oamp.cgi.  Veamos qu√© hace este cgi.  Resulta que implementa una especie de mini-API, que est√° completamente separada de todo lo dem√°s que se ejecuta en la interfaz web. <br><br><img src="https://habrastorage.org/webt/du/hp/ze/duhpze4khdkjnwkpxcq71egk1fa.jpeg"><br><br>  Espera que se le soliciten ciertas acciones, incluida la descarga del archivo de configuraci√≥n, la actualizaci√≥n del archivo de configuraci√≥n, la descarga del archivo de actualizaci√≥n del firmware, la actualizaci√≥n del firmware y mucho m√°s.  Los desarrolladores no eran tan est√∫pidos, as√≠ que antes de ejecutar su solicitud, oamp.cgi verifica si tiene la ID de sesi√≥n v√°lida correcta. <br><br><img src="https://habrastorage.org/webt/-y/w-/tc/-yw-tczrcu1suqe5m7nhkbckry0.jpeg"><br><br>  Si no tiene un identificador de sesi√≥n v√°lido, lo √∫nico que puede hacer es ingresar un inicio de sesi√≥n. <br><br><img src="https://habrastorage.org/webt/h4/-f/db/h4-fdbh_byljwbfst90cnc0fa1w.jpeg"><br><br>  Esto en s√≠ mismo es interesante porque implementaron una verificaci√≥n de autenticaci√≥n que no se usa en ning√∫n otro lugar de la interfaz.  Comenc√© a entender c√≥mo controlan la entrada, es decir, iniciar sesi√≥n.  Conf√≠an en su nombre de usuario y contrase√±a y no m√°s sorpresas. <br><br><img src="https://habrastorage.org/webt/cc/of/dh/ccofdh7-rzwu3cslr4rzawektjm.jpeg"><br><br><img src="https://habrastorage.org/webt/xl/zw/ms/xlzwmsxf0zvnpzunpu4sgncnrc4.jpeg"><br><br>  Y luego hacen dos llamadas a la funci√≥n PRO_GetStr, y no tengo idea de lo que afectan.  Pero s√© que la primera llamada a esta funci√≥n le da dos l√≠neas: OAMP y el nombre de usuario L1_usr, y la segunda llamada: dos l√≠neas m√°s, OAMP y la contrase√±a L1_pwd. <br><br><img src="https://habrastorage.org/webt/n1/ym/om/n1ymomdakif9vlzheuwya5mjfty.jpeg"><br><br><img src="https://habrastorage.org/webt/78/fy/t9/78fyt9djqavicl7cicsxnd-zrw4.jpeg"><br><br>  Luego, se devuelve el primer valor para el usuario L1 y se compara con el nombre de usuario user, L1_usr especificado durante la autenticaci√≥n, y tambi√©n se devuelve el segundo valor de la cadena: contrase√±a de contrase√±a, L1_usr, que se compara con la contrase√±a ingresada por el usuario al iniciar sesi√≥n. <br><br><img src="https://habrastorage.org/webt/jw/-p/jv/jw-pjvidwi9ol_sb5fiv1zxv6kc.jpeg"><br><br><img src="https://habrastorage.org/webt/zo/ah/py/zoahpyuevenlfpkgkozbbdc7nle.jpeg"><br><br>  Presumiblemente, este nombre de usuario y contrase√±a L1, independientemente de los valores que tomen, proporcionan el inicio de sesi√≥n correcto para esta interfaz OAMP.  El √∫nico otro lugar que pude encontrar en el firmware, y que est√° realmente asociado con el nombre de usuario y la contrase√±a del usuario, es el archivo de configuraci√≥n. <br><br><img src="https://habrastorage.org/webt/mm/pb/k5/mmpbk5f98z45lefbabw5x0l7jt8.jpeg"><br><br>  Y estos valores est√°n codificados en dispositivos que usan el archivo de configuraci√≥n de la secci√≥n OAMP durante la operaci√≥n.  Ver√° que el valor de inicio de sesi√≥n del usuario L1 se establece en la l√≠nea L1_admin, y el valor de la contrase√±a del usuario est√° en la l√≠nea L1_51. <br><br>  Y este es un problema real, porque toda esta interfaz OAMP y estas cuentas codificadas est√°n completamente indocumentadas, por lo que nadie sabe que est√°n all√≠, excepto aquellas personas que se molestaron en buscar el firmware.  Por supuesto, el administrador nunca har√° esto. <br><br>  Pero incluso si se entera al respecto, no hay forma de que cambie estos valores, ya que no hay una interfaz de administrador en esta c√°mara.  El problema con las contrase√±as secretas codificadas es que, gracias al uso de puertas traseras, permanecen secretas por un corto tiempo. <br><br>  Por lo tanto, podemos usar estas cuentas de puerta trasera para iniciar sesi√≥n y obtener una ID de sesi√≥n.  Ahora que podemos enviar esta ID de sesi√≥n junto con nuestras solicitudes, tambi√©n podemos invocar cualquier otra acci√≥n compatible con oamp.cgi, incluida la descarga del archivo de configuraci√≥n de configuraci√≥n. <br><br><img src="https://habrastorage.org/webt/an/w3/i1/anw3i17pq_cvs9ojuxuxrizzcqe.jpeg"><br><br><img src="https://habrastorage.org/webt/9a/_a/lp/9a_alpxed7vbjf9v1qx4pc9arqu.jpeg"><br><br>  El problema es que si intentas descifrarlo usando Base64, esto no funciona, solo obtienes un mont√≥n de basura.  Este es el caso cuando Base64 no es Base64. <br><br><img src="https://habrastorage.org/webt/g2/ty/mb/g2tymbmqw_ivhqvpxtvkzlnkr28.jpeg"><br><br>  La raz√≥n de esto se vuelve obvia cuando observa el c√≥digo final de Base64 en el archivo binario del firmware PVC-2300: la base para la codificaci√≥n se crea aqu√≠, pero utiliza una cadena de clave Base64 no est√°ndar, que se descubri√≥ al analizar el cifrado y descifrado del c√≥digo 64. Afortunadamente, con Con Python, es muy f√°cil cambiar una cadena de clave en un m√≥dulo Python Base64 a una cadena de clave personalizada, como se muestra en la diapositiva. <br><br><img src="https://habrastorage.org/webt/1j/lo/fb/1jlofb--8fxiriwhad4abpwuxju.jpeg"><br><br>  Entonces, con un par de cadenas de Python, podemos descifrar f√°cilmente el archivo de configuraci√≥n y convertirlo en texto sin formato, lo que nos da opciones de inicio de sesi√≥n bajo el inicio de sesi√≥n del administrador. <br><br><img src="https://habrastorage.org/webt/dd/a6/wm/dda6wmvvhgydwz8vxdu7utsslim.jpeg"><br><br>  Habiendo ganado el control de la c√°mara, podemos ver la sala de servidores.  El problema es que ver las salas de servidores realmente captura los primeros 10 segundos, pero luego se convierte en una tarea bastante aburrida. <br><br><img src="https://habrastorage.org/webt/v9/sn/yq/v9snyqmqg0robtcbe86hp6iwe6o.jpeg"><br><br>  Por lo tanto, volv√≠ al c√≥digo y comenc√© a estudiar la posibilidad de descargar firmware.  Esto es realmente muy interesante, porque en lugar de descargar el archivo de firmware al dispositivo desde el sitio oficial, puede especificar su propia URL, el dispositivo ir√° a esta direcci√≥n y descargar√° lo que supuestamente considera firmware. <br><br><img src="https://habrastorage.org/webt/bs/u1/gj/bsu1gjoyhq5ieybllbrxcjsd4ig.jpeg"><br><br>  La funci√≥n system2 simplemente genera un comando a partir de la cadena de formato y la url antes de llamar a la funci√≥n del sistema libc, lo que permite a un atacante ingresar comandos de shell arbitrarios a trav√©s del par√°metro url.  El comando del atacante se ejecutar√° con derechos de superusuario y, dado que la verificaci√≥n se realiza mediante el valor de url, es muy f√°cil omitirlo con el siguiente script: <br><br><pre> <code class="hljs ruby">$ wget --header=‚Äù<span class="hljs-symbol"><span class="hljs-symbol">sessionID:</span></span> <span class="hljs-number"><span class="hljs-number">57592414</span></span>‚Äù <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/oamp</span></span><span class="hljs-regexp"><span class="hljs-regexp">/System.xml?action=loadFirmware&amp;url=https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/127.0.0.1:6 5534/</span></span>;reboot;</code> </pre> <br>  Despu√©s de eso, la computadora ubicada en esta URL se reinicia y puede ejecutar cualquier comando que desee. <br><br><img src="https://habrastorage.org/webt/1r/wj/j5/1rwjj5ih0d0j1fybyteeg7mdnyw.jpeg"><br><br>  Esta vulnerabilidad se prob√≥ en todas las versiones de firmware de dos modelos de c√°maras de vigilancia Cisco: PVC-2300 y WVC-2300, una c√°mara similar con dos antenas.  Al momento de escribir este art√≠culo, Shodan mostr√≥ m√°s de 500 c√°maras IP p√∫blicas y potencialmente vulnerables que pertenecen a hoteles, salas de servidores y compa√±√≠as de ingenier√≠a que desarrollan equipos para la Estaci√≥n Espacial Internacional. <br><br>  Por lo tanto, D-link y Cisco no protegen adecuadamente las c√°maras de vigilancia, aunque sabe que estas c√°maras no son su producto principal.  Por lo tanto, echemos un vistazo a las marcas que se especializan espec√≠ficamente en el dise√±o y fabricaci√≥n de c√°maras de vigilancia.  Eleg√≠ IQ Invision, que produce costosas c√°maras de alta definici√≥n, como la IQ 832n, que cuesta m√°s de $ 1000 cada una, lo que no es nada econ√≥mico. <br><br><img src="https://habrastorage.org/webt/od/4n/47/od4n470mrojtlam7vrbiqpaagcw.jpeg"><br><br>  La raz√≥n principal de mi inter√©s es que estos son los tipos que fabrican c√°maras instaladas en el complejo comercial donde trabajo, por lo que hubo razones personales para esto.  Entonces, ¬øqu√© obtienes usando una c√°mara de vigilancia profesional por mil d√≥lares? <br>  De manera predeterminada, estas c√°maras proporcionan una imagen de video no autenticada, y ninguno de los estudios exhaustivos de instalaci√≥n de c√°maras ha podido cambiar esta configuraci√≥n predeterminada.  Si bien la interfaz administrativa est√° protegida por contrase√±a, la interfaz de usuario proporciona acceso a los recursos de la c√°mara sin autenticaci√≥n, lo que crea un amplio campo de ataque. <br><br><img src="https://habrastorage.org/webt/mn/gr/mn/mngrmndqcnufl90nrnj_lfhpvse.jpeg"><br><br>  El administrador puede cambiar la configuraci√≥n de autenticaci√≥n del administrador, pero intente adivinar cu√°ntos administradores han conectado sus c√°maras a Internet sin cambiar la configuraci√≥n predeterminada, casi todo.  Sin embargo, la mayor√≠a de los administradores en nuestro complejo eran lo suficientemente inteligentes como para cambiar esta configuraci√≥n, as√≠ que comenc√© a ver qu√© m√°s pod√≠a hacer sin autenticaci√≥n.  Result√≥ que puedo acceder libremente a la p√°gina. <br><br><img src="https://habrastorage.org/webt/qo/m2/xc/qom2xc4tfzyzncf5bienr4e4a5m.jpeg"><br><br>  Contiene una gran cantidad de configuraciones de la c√°mara, como la configuraci√≥n de enfoque, que no son tan interesantes como los nombres de usuario y las contrase√±as.  M√°s interesante fue el c√≥digo detr√°s de esta p√°gina oidtable.cgi.  Si desmonta este binario, puede ver que la p√°gina acepta solo un par√°metro, grep, que se utiliza para filtrar los resultados devueltos a la p√°gina oidtable.cgi. <br><br><img src="https://habrastorage.org/webt/xq/xa/bw/xqxabwwpfodp1lbutwkjhnh0iws.jpeg"><br><br>  Despu√©s de comprobar que el valor del par√°metro proporcionado tiene menos de 32 caracteres, oidtable.cgi coloca este valor en la l√≠nea de comando y lo pasa a popen: <br><br><img src="https://habrastorage.org/webt/7o/6t/gx/7o6tgx98hkegmfygblszjdmtqbm.jpeg"><br><br><img src="https://habrastorage.org/webt/i6/0a/4s/i60a4smzvkzi1hsop0lam0rcv9i.jpeg"><br><br>  Lo que vi me hizo retratar el "facepalm" y me impuls√≥ a inyectar algunos equipos. <br><br><img src="https://habrastorage.org/webt/k2/2g/c3/k22gc3orqjsproq9bgagtpbwntk.jpeg"><br><br>  Usted ve que aqu√≠, al igual que en el caso de D-Link, puedo ejecutar el comando PS y obtener la salida enviada de regreso a mi navegador.  Por lo tanto, sin autenticaci√≥n, puedo ingresar f√°cilmente comandos de shell arbitrarios que se ejecutar√°n como root.  Las listas de procesos muestran que Netcat ya est√° instalado en estas c√°maras con la capacidad de ingresar guiones dash-e, as√≠ que estoy seguro de que la mayor√≠a de las personas aqu√≠ pueden encontrar comandos m√°s interesantes para ejecutar que la lista de procesos.  Sin embargo, mi objetivo principal era ingresar al panel de administraci√≥n, y descubr√≠ c√≥mo hacerlo. <br><br>  16:30 min <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SOMBRERO NEGRO Conferencia de Estados Unidos.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo un hacker de Hollywood usa c√°maras de vigilancia.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/B8DjTcANBx0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  <b>Ap√≥yenos</b> haciendo un pedido o recomend√°ndolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un an√°logo √∫nico de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps hasta diciembre de forma gratuita</b> al pagar por un per√≠odo de seis meses, puede ordenar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  ¬°Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Pa√≠ses Bajos y los Estados Unidos!</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es427367/">https://habr.com/ru/post/es427367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es427357/index.html">Escribiendo sombreadores en Unity. GrabPass, PerRendererData</a></li>
<li><a href="../es427359/index.html">C√≥mo ECS, C # Job System y SRP cambian la arquitectura</a></li>
<li><a href="../es427361/index.html">Caracter√≠sticas del filtrado de ventanas en FPGA</a></li>
<li><a href="../es427363/index.html">Implementaci√≥n de LoRaWAN en una empresa agr√≠cola. Todo sobre construcci√≥n, lanzamiento y soluciones.</a></li>
<li><a href="../es427365/index.html">Informe de RedSlerm sobre monitoreo (Monit, Zabbix)</a></li>
<li><a href="../es427369/index.html">SOMBRERO NEGRO Conferencia de Estados Unidos. C√≥mo un hacker de Hollywood usa c√°maras de vigilancia. Parte 2</a></li>
<li><a href="../es427371/index.html">Video curso "Fundamentos del trabajo con anotaciones BPMN". Gratis</a></li>
<li><a href="../es427373/index.html">Firefox se puede monetizar con el complemento VPN de pago incorporado</a></li>
<li><a href="../es427377/index.html">Administrador de sistema simple de CI / CD</a></li>
<li><a href="../es427379/index.html">Junior Senior: Revisi√≥n del tel√©fono Snom D715 IP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>