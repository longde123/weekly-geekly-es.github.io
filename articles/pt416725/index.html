<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∫Ô∏è üñêüèæ üï¶ Kotlin DSL: Teoria e Pr√°tica üíÜüèæ üêá üïî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Desenvolver testes de aplicativos n√£o √© uma experi√™ncia agrad√°vel. Esse processo leva muito tempo, requer muita concentra√ß√£o e √© extremamente procurad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kotlin DSL: Teoria e Pr√°tica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/416725/">  Desenvolver testes de aplicativos n√£o √© uma experi√™ncia agrad√°vel.  Esse processo leva muito tempo, requer muita concentra√ß√£o e √© extremamente procurado.  A linguagem Kotlin fornece um conjunto de ferramentas que facilita bastante a cria√ß√£o de sua pr√≥pria linguagem orientada a problemas (DSL).  Existe experi√™ncia quando o Kotlin DSL substituiu os construtores e os m√©todos est√°ticos para testar o m√≥dulo de planejamento de recursos, o que tornou a adi√ß√£o de novos testes e o suporte aos antigos de uma rotina um processo divertido. <br><br>  No decorrer do artigo, analisaremos todas as principais ferramentas do arsenal do desenvolvedor e como elas podem ser combinadas para resolver problemas de teste.  Iremos desde o design do Teste Ideal at√© o lan√ßamento do teste mais aproximado, limpo e compreens√≠vel para o sistema de planejamento de recursos baseado em Kotlin. <br><br>  O artigo ser√° √∫til para a pr√°tica de engenheiros, aqueles que consideram o Kotlin como uma linguagem para escrever testes compactos confortavelmente e aqueles que desejam melhorar o processo de teste em seu projeto. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/q_UM1EY2S5g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Este artigo √© baseado em uma apresenta√ß√£o de Ivan Osipov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">i_osipov</a> ) na confer√™ncia JPoint.  Mais narra√ß√£o √© conduzida em seu nome.  Ivan trabalha como programador em Haulmont.  O principal produto da empresa √© o CUBA, uma plataforma para o desenvolvimento de empresas e v√°rias aplica√ß√µes web.  Em particular, projetos de terceiriza√ß√£o est√£o sendo feitos nessa plataforma, entre os quais houve recentemente um projeto no campo da educa√ß√£o, no qual Ivan estava envolvido na constru√ß√£o de um cronograma para uma institui√ß√£o de ensino.  Aconteceu que, nos √∫ltimos tr√™s anos, Ivan trabalha com planejadores de uma maneira ou de outra, e especificamente em Haulmont, eles v√™m testando esse planejador h√° um ano. <br><a name="habracut"></a><br>  Para quem deseja executar exemplos - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mantenha um link para o GitHub</a> .  Sob o link, voc√™ encontrar√° todo o c√≥digo que iremos analisar, executar e escrever hoje.  Abra o c√≥digo e pronto! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec3/fa3/670/ec3fa3670fd1c8a3cf7222f7e746933c.jpg"><br><br>  Hoje vamos discutir: <br><br><ul><li>  o que s√£o linguagens orientadas a problemas; <br></li><li>  linguagens orientadas a problemas incorporadas; <br></li><li>  constru√ß√£o de um cronograma para uma institui√ß√£o educacional; <br></li><li>  como tudo √© testado com o Kotlin. <br></li></ul><br>  Hoje vou falar em detalhes sobre as ferramentas que temos no idioma, mostrar algumas demos e escreveremos todo o teste do come√ßo ao fim.  Ao mesmo tempo, gostaria de ser mais objetivo, por isso vou falar sobre algumas das desvantagens que identifiquei para mim durante o desenvolvimento. <br><br>  Vamos come√ßar falando sobre o m√≥dulo de cria√ß√£o de cronograma.  Assim, a constru√ß√£o do cronograma ocorre em v√°rias etapas.  Cada uma dessas etapas precisa ser testada separadamente.  Voc√™ precisa entender que, apesar de as etapas serem diferentes, temos um modelo de dados comum. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/031/be4/27d/031be427d58c5073a3bc619cbed65792.jpg"><br><br>  Esse processo pode ser representado da seguinte forma: na entrada, existem alguns dados com um modelo comum, na sa√≠da, h√° um cronograma.  Os dados s√£o validados, filtrados e, em seguida, s√£o criados grupos de treinamento.  Refere-se √† √°rea de assunto da programa√ß√£o da institui√ß√£o educacional.  Com base nos grupos constru√≠dos e com base em outros dados, colocamos a li√ß√£o.  Hoje falaremos apenas sobre a √∫ltima etapa - sobre a coloca√ß√£o de aulas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f64/032/4b1/f640324b1a2ff556a4da892822847a9c.jpg"><br><br>  Um pouco sobre como testar o agendador. <br><br>  Em primeiro lugar, como voc√™ j√° entendeu, os diferentes est√°gios devem ser testados separadamente.  Pode-se destacar um processo mais ou menos padr√£o de iniciar o teste: h√° inicializa√ß√£o de dados, h√° um lan√ßamento do agendador, h√° uma verifica√ß√£o dos resultados desse pr√≥prio agendador.  H√° um grande n√∫mero de casos de neg√≥cios diferentes que precisam ser cobertos e situa√ß√µes diferentes que precisam ser levadas em considera√ß√£o para que, ao criar um cronograma, essas situa√ß√µes tamb√©m persistam. <br><br>  √Äs vezes, um modelo pode ser pesado e, para criar uma √∫nica entidade, √© necess√°rio inicializar cinco entidades adicionais, ou at√© mais.  Assim, no total, √© obtida uma grande quantidade de c√≥digo, que escrevemos repetidamente para cada teste.  O suporte para esses testes leva uma quantidade consider√°vel de tempo.  Se voc√™ deseja atualizar o modelo, e isso √†s vezes acontece, a escala das altera√ß√µes afeta os testes. <br><br>  Vamos escrever um teste: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fda/0f5/94d/fda0f594d14b8043054bcae7fe3315ad.jpg"><br><br>  Vamos escrever o teste mais simples para que voc√™ geralmente entenda a imagem. <br>  O que vem √† mente quando voc√™ pensa em testar?  Talvez estes sejam alguns testes primitivos desse tipo: voc√™ cria uma classe, cria um m√©todo nela, marca-a com a anota√ß√£o <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Teste</a></i> .  Como resultado, usamos os recursos do JUnit e inicializamos alguns dados, valores padr√£o e valores espec√≠ficos de teste, fazemos o mesmo no restante do modelo e, finalmente, criamos um objeto do planejador, transferimos nossos dados para ele, come√ßamos, recebemos resultados e os verificamos.  Processo mais ou menos padr√£o.  Mas obviamente h√° duplica√ß√£o de c√≥digo.  A primeira coisa que vem √† mente √© a capacidade de colocar tudo em m√©todos est√°ticos.  Como existem v√°rios valores padr√£o, por que n√£o ocult√°-lo? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/521/543/590/521543590a00c6101abd4fcefd345e04.jpg"><br><br>  Este √© um bom primeiro passo para reduzir a duplica√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7f/c57/11c/c7fc5711ccf2a4e9dfb626ea64cffb9b.jpg"><br><br>  Olhando para isso, voc√™ entende que eu gostaria de manter o modelo mais compacto.  Aqui temos um padr√£o de construtor no qual, em algum lugar sob o cap√¥, o valor padr√£o √© inicializado e os valores espec√≠ficos do teste s√£o inicializados ali.  Est√° ficando melhor, no entanto, ainda estamos escrevendo o c√≥digo padr√£o, e estamos escrevendo novamente cada vez.  Imagine 200 testes - voc√™ deve escrever essas tr√™s linhas 200 vezes.  Obviamente, eu gostaria de me livrar disso de alguma forma.  Desenvolvendo a id√©ia, chegamos a um certo limite.  Assim, por exemplo, podemos criar um construtor de padr√µes em geral para tudo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/259/e9b/7a3/259e9b7a39e84a41466572b38afc280d.jpg"><br><br>  Voc√™ pode criar um agendador do zero at√© o final, definir todos os valores que precisamos, iniciar o agendamento e tudo est√° √≥timo.  Se voc√™ olhar em detalhes este exemplo e analis√°-lo em detalhes, acontece que muito c√≥digo desnecess√°rio est√° sendo gravado.  Gostaria de tornar os testes mais leg√≠veis para que voc√™ possa dar uma olhada e entender imediatamente, sem se aprofundar nos padr√µes e assim por diante. <br><br>  Portanto, temos algum c√≥digo desnecess√°rio.  A matem√°tica simples sugere que existem 55% mais letras do que precisamos, e eu gostaria de, de alguma forma, fugir delas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d55/610/ef7/d55610ef71d368b8d16c1fdef35cd2c5.jpg"><br><br>  Depois de algum tempo, o suporte para nossos testes acaba sendo mais caro, porque voc√™ precisa oferecer suporte a mais c√≥digo.  √Äs vezes, se n√£o fizermos nenhum esfor√ßo, a legibilidade deixa muito a desejar ou acaba sendo aceit√°vel, mas gostar√≠amos ainda melhor.  Talvez mais tarde come√ßaremos a adicionar algum tipo de estruturas, bibliotecas, para facilitar a grava√ß√£o de testes.  Devido a isso, aumentamos o n√≠vel de entrada para testar nosso aplicativo.  Aqui temos uma aplica√ß√£o j√° complicada, o n√≠vel de entrada nos testes √© significativo e estamos aumentando ainda mais. <br><br><h2>  Teste perfeito </h2><br>  √â √≥timo dizer o qu√£o ruim tudo √©, mas vamos pensar em como seria muito bom.  Um exemplo ideal que gostar√≠amos de obter como resultado: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2b/7c5/f48/e2b7c5f48dbd065e95b1617ad10622ba.jpg"><br><br>  Imagine que exista alguma declara√ß√£o na qual dizemos que este √© um teste com um nome espec√≠fico, e queremos usar um espa√ßo para separar as palavras no nome, n√£o o CamelCase.  Estamos construindo um cronograma, temos alguns dados e os resultados do planejador s√£o verificados.  Como trabalhamos principalmente com Java e todo o c√≥digo do aplicativo principal est√° escrito nesta linguagem, eu gostaria de ter recursos de teste compat√≠veis.  Eu gostaria de inicializar os dados o mais √≥bvio poss√≠vel para o leitor.  Quero inicializar alguns dados comuns e parte do modelo que precisamos.  Por exemplo, crie alunos, professores e descreva quando eles estiverem dispon√≠veis.  Este √© o nosso exemplo perfeito. <br><br><h2>  Idioma espec√≠fico do dom√≠nio </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/f81/c79/0a9/f81c790a921e43d645fc7380607cf8ea.jpg"><br><br>  Olhando para tudo isso, parece que parece algum tipo de linguagem orientada a problemas.  Voc√™ precisa entender o que √© e qual √© a diferen√ßa.  Os idiomas podem ser divididos em dois tipos: idiomas de uso geral (o que constantemente escrevemos, resolvemos absolutamente todas as tarefas e lidamos com absolutamente tudo) e idiomas orientados a problemas.  Assim, por exemplo, o SQL nos ajuda a extrair dados do banco de dados perfeitamente, e algumas outras linguagens tamb√©m ajudam a resolver outros problemas espec√≠ficos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f8/e45/2f6/2f8e452f62f39f0f56a2c73e355dddcb.jpg"><br><br>  Uma maneira de implementar linguagens orientadas a problemas √© a linguagem incorporada ou interna.  Essas linguagens s√£o implementadas com base em uma linguagem de uso geral.  Ou seja, v√°rias constru√ß√µes de nossa linguagem de prop√≥sito geral formam uma base - √© isso que usamos ao trabalhar com uma linguagem orientada a problemas.  Nesse caso, √© claro, surge uma oportunidade em uma linguagem orientada a problemas para usar todos os recursos e funcionalidades provenientes de uma linguagem de uso geral. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07f/4cb/57f/07f4cb57f84ba884bd558ee8e97202a2.jpg"><br><br>  Mais uma vez, d√™ uma olhada no nosso exemplo perfeito e pense em qual idioma escolher.  Temos tr√™s op√ß√µes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1d/b21/4b3/d1db214b39b5620875350b382622e662.jpg"><br><br>  A primeira op√ß√£o √© Groovy.  Uma linguagem maravilhosa e din√¢mica que se provou na constru√ß√£o de linguagens orientadas a problemas.  Novamente, voc√™ pode dar um exemplo de um arquivo de compila√ß√£o no Gradle, que muitos de n√≥s usamos.  H√° tamb√©m o Scala, que tem um grande n√∫mero de oportunidades para a implementa√ß√£o de algo pr√≥prio.  E, finalmente, existe o Kotlin, que tamb√©m nos ajuda a criar uma linguagem orientada a problemas, e hoje ela ser√° discutida.  Eu n√£o gostaria de criar guerras e comparar o Kotlin com outra coisa, mas permanece na sua consci√™ncia.  Hoje vou mostrar o que o Kotlin tem para o desenvolvimento de linguagens orientadas a problemas.  Quando voc√™ quiser comparar isso e dizer que um idioma √© melhor, retorne a este artigo e veja facilmente a diferen√ßa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/050/2e7/29e/0502e729ebf030ea5e4d9f038a4b7cc6.jpg"><br><br>  O que Kotlin nos d√° para o desenvolvimento de uma linguagem orientada a problemas? <br><br>  Em primeiro lugar, √© uma digita√ß√£o est√°tica e tudo o que se segue.  No est√°gio de compila√ß√£o, um grande n√∫mero de problemas √© detectado, e isso economiza bastante, principalmente no caso em que voc√™ n√£o deseja obter problemas relacionados √† sintaxe e √† grava√ß√£o em testes. <br>  Ent√£o, existe um √≥timo sistema de infer√™ncia de tipos que vem do Kotlin.  Isso √© maravilhoso, porque n√£o h√° necessidade de escrever nenhum tipo repetidamente, tudo √© exibido pelo compilador com um estrondo. <br><br>  Em terceiro lugar, h√° um excelente suporte para o ambiente de desenvolvimento, e isso n√£o √© surpreendente, porque a mesma empresa cria o principal ambiente de desenvolvimento para hoje e faz Kotlin. <br>  Finalmente, dentro da DSL, obviamente podemos usar o Kotlin.  Na minha opini√£o subjetiva, oferecer suporte a DSL √© muito mais f√°cil do que oferecer suporte a classes de utilit√°rio.  Como voc√™ ver√° mais adiante, a legibilidade √© um pouco melhor do que os construtores.  O que quero dizer com "melhor": voc√™ tem um pouco menos de sintaxe do que precisa escrever - algu√©m que l√™ sua linguagem orientada a problemas o leva mais r√°pido.  Finalmente, escrever sua bicicleta √© muito mais divertido!  Mas, de fato, implementar uma linguagem orientada a problemas √© muito mais f√°cil do que aprender alguma nova estrutura. <br><br>  Lembrarei mais uma vez o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link para o GitHub</a> , se voc√™ quiser escrever mais demos, poder√° entrar e pegar o c√≥digo no link. <br><br><h2>  Projetando o ideal no Kotlin </h2><br>  Vamos continuar a projetar nosso ideal, mas j√° em Kotlin.  Veja o nosso exemplo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e3/695/850/5e3695850435a204b9cbb3b94f6f7635.png"><br><br>  E, em etapas, come√ßaremos a reconstru√≠-lo. <br><br>  Temos um teste que se transforma em uma fun√ß√£o no Kotlin, que pode ser nomeada usando espa√ßos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/03d/699/a71/03d699a71ecf86e0e5c03b7a6de57995.png"><br><br>  Marc√°-lo-emos com a anota√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Teste</a> , que est√° dispon√≠vel para n√≥s na JUnit.  No Kotlin, voc√™ pode usar o formul√°rio abreviado para escrever fun√ß√µes e, atrav√©s de <i>=,</i> se livrar de chaves adicionais para a pr√≥pria fun√ß√£o. <br><br>  Hor√°rio nos transformamos em um bloco.  O mesmo acontece com muitos designs, pois ainda trabalhamos na Kotlin. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a7b/db9/656/a7bdb965641ca434f1eba5e7781b9b53.png"><br><br>  Vamos para o resto.  Aparelhos cacheados aparecem novamente, n√£o vamos nos livrar deles, mas pelo menos tentamos nos aproximar do nosso exemplo.  Ao construir constru√ß√µes com espa√ßos, podemos de alguma forma nos refinar e torn√°-los de alguma forma diferentes, mas parece-me que √© melhor fazer os m√©todos usuais que encapsular√£o o processamento, mas em geral isso ser√° √≥bvio para o usu√°rio . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/378/6e6/eaf/3786e6eafdb8ebd14c344af30698df56.png"><br><br>  Nosso aluno se transforma em um bloco no qual trabalhamos com propriedades, com m√©todos, e continuaremos analisando isso com voc√™. <br><br><img width="600" src="https://habrastorage.org/getpro/habr/post_images/76b/a76/554/76ba76554585689a4c2562167fd26833.png"><br><br>  Finalmente, os professores.  Aqui temos alguns blocos aninhados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/deb/a5d/f0a/deba5df0a67a08566e07370bf2f70bc0.png"><br><br>  No c√≥digo abaixo, passamos para as verifica√ß√µes.  Precisamos de verifica√ß√µes de compatibilidade com linguagens Java - e sim, o Kotlin √© compat√≠vel com Java. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8aa/09d/a05/8aa09da05c7c48282e01b0ea409e0f3c.png"><br><br><h2>  Arsenal de desenvolvimento DSL em Kotlin </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/5f6/113/6ef/5f61136ef41733e6fb88c5ff17d6975f.jpg"><br><br>  Vamos passar para a lista de ferramentas que temos.  Aqui eu trouxe um tablet, talvez ele liste tudo o que √© necess√°rio para desenvolver linguagens orientadas a problemas no Kotlin.  Voc√™ pode voltar para ela de vez em quando e refrescar sua mem√≥ria. <br><br>  A tabela mostra algumas compara√ß√µes da sintaxe orientada a problemas e da sintaxe usual dispon√≠vel no idioma. <br><br><h2>  Lambdas em Kotlin </h2><br> <code>val lambda: () -&gt; Unit = { }</code> <br> <br>  Vamos come√ßar com os tijolos mais b√°sicos que temos em Kotlin - estes s√£o lambdas. <br>  Hoje, por tipo lambda, vou me referir apenas a um tipo funcional.  Lambdas s√£o indicadas da seguinte forma: <code>( ) -&gt;  </code> . <br><br>  Inicializamos o lambda com a ajuda de chaves, dentro delas podemos escrever algum c√≥digo que ser√° chamado.  Ou seja, um lambda, de fato, apenas oculta esse c√≥digo em si.  A execu√ß√£o de um lambda parece uma chamada de fun√ß√£o, apenas par√™nteses. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a48/f4d/d49/a48f4dd497c8aa6b93ab2043e014ca02.jpg"><br><br>  Se queremos passar algum tipo de par√¢metro, primeiro devemos descrev√™-lo no tipo <br>  Em segundo lugar, temos acesso ao identificador padr√£o, que podemos usar, no entanto, se isso n√£o nos conv√©m, podemos definir nosso pr√≥prio nome de par√¢metro e us√°-los. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/194/fab/626/194fab62612fb71e6a5f148193ec1ff9.jpg"><br><br>  Ao mesmo tempo, podemos pular o uso desse par√¢metro e usar o sublinhado para n√£o produzir identificadores.  Nesse caso, para ignorar o identificador, seria poss√≠vel escrever nada, mas no caso geral de v√°rios par√¢metros, existe o "_" mencionado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ff/80e/de2/1ff80ede232393839186b9345065700c.jpg"><br><br>  Se queremos passar mais de um par√¢metro, precisamos definir explicitamente seus identificadores. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8d/d2b/952/c8dd2b952caa82b67157f41dc79535b0.jpg"><br><br>  Finalmente, o que acontecer√° se tentarmos passar o lambda para alguma fun√ß√£o e execut√°-lo l√°.  Ele parece na aproxima√ß√£o inicial da seguinte forma: temos uma fun√ß√£o para a qual passamos lambda entre colchetes e, se no Kotlin lambda √© escrito como o √∫ltimo par√¢metro, podemos coloc√°-lo fora desses colchetes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b80/d7c/0d8/b80d7c0d814f3c51a91f2c224707a2d5.jpg"><br><br>  Se n√£o houver mais nada entre par√™nteses, podemos remov√™-los.  Aqueles familiarizados com o Groovy devem estar familiarizados com isso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/74b/5dd/a95/74b5dda953b1df973a8d893f7a615195.jpg"><br><br>  Onde isso se aplica?  Absolutamente em todo lugar.  Ou seja, os aparelhos muito encaracolados de que j√° falamos, n√≥s os usamos, essas s√£o as mesmas lambdas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/69e/4bd/781/69e4bd781897ef0515384f81367899cc.jpg"><br><br>  Agora, vamos olhar para uma das variedades de lambdas, eu as chamo de lambdas com contexto.  Voc√™ encontrar√° outros nomes, por exemplo, lambda com receptor, e eles diferem dos lambdas comuns ao declarar um tipo da seguinte maneira: √† esquerda, adicionamos alguma classe de contexto, pode ser qualquer classe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bd/375/5b1/8bd3755b1085f3049a7ea32c7cc41f79.jpg"><br><br>  Para que √© isso?  Isso √© necess√°rio para que, dentro do lambda, tenhamos acesso √† palavra-chave this - esta √© a palavra-chave em si, ela nos diz o nosso contexto, ou seja, para algum objeto que vinculamos ao nosso lambda.  Assim, por exemplo, podemos criar um lambda que produzir√° alguma string, naturalmente, usaremos a classe string para declarar um contexto e a chamada de um lambda parecer√° com isso: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d80/552/181/d80552181518f155fc596c1bb3ddf2aa.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/788/63d/b17/78863db1732d9b92bff62bf82060771a.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/770/a1b/038/770a1b0388cd2380c491cdf5ca8c344c.jpg"><br><br>  Se voc√™ deseja passar um contexto como par√¢metro, tamb√©m pode faz√™-lo.  No entanto, n√£o podemos transmitir completamente o contexto, ou seja, um lambda com um contexto requer aten√ß√£o!  - contexto sim.  O que acontece se come√ßarmos a passar um lambda com um contexto para algum m√©todo?  Aqui, examinamos novamente nosso m√©todo exec: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15b/f36/3d9/15bf363d94919f7c73d775c5d28c6c53.jpg"><br><br>  Renomeie-o para o m√©todo do aluno - nada mudou: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e12/4cc/e3b/e124cce3bd7bdb776c3e946edf8ec52c.jpg"><br><br>  Ent√£o, passamos gradualmente para a nossa constru√ß√£o, a constru√ß√£o do aluno, que, sob o aparelho, oculta toda a inicializa√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eba/286/8b3/eba2868b306f476c35df51d8af500335.jpg"><br><br>  Vamos descobrir.  Temos algum tipo de fun√ß√£o de aluno que usa uma lambda no contexto do aluno. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3f/954/e2a/d3f954e2a7016ecf31a081559674d01f.jpg"><br><br>  Obviamente, precisamos de contexto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/362/4d8/3be/3624d83be81ee01223ad758e9e81c94d.jpg"><br><br>  Aqui, criamos um objeto e executamos esse lambda nele. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cab/d4a/940/cabd4a940deacfcdcb680c4916b29eae.jpg"><br><br>  Como resultado, tamb√©m podemos inicializar alguns valores padr√£o antes de iniciar o lambda, portanto, encapsulamos tudo o que precisamos para a fun√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b4/572/421/0b457242103fc70de806c9de62234135.jpg"><br><br>  Por esse motivo, dentro da lambda, temos acesso a essa palavra-chave - √© por isso que, provavelmente, existem lambdas com contexto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1b/819/fdb/b1b819fdb7488092550b2ac72265cd72.jpg"><br><br>  Naturalmente, podemos nos livrar dessa palavra-chave e temos a oportunidade de escrever essas constru√ß√µes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/50d/dbc/492/50ddbc4920ffb871918ce7c063a874a2.jpg"><br><br>  Novamente, se n√£o temos apenas m√©todos propriet√°rios, mas tamb√©m alguns m√©todos, tamb√©m podemos cham√°-los, parece bastante natural. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b72/155/316/b72155316d99a7e4816d1234644b761b.jpg"><br><br><h2>  Aplica√ß√£o </h2><br>  Todos esses lambdas no c√≥digo s√£o lambdas de contexto.  H√° um grande n√∫mero de contextos, eles se cruzam de uma maneira ou de outra e nos permitem construir nossa linguagem orientada a problemas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/83a/f30/2ff/83af302ff3c0a85db220c70f0d567743.jpg"><br><br>  Resumindo as lambdas - temos lambdas comuns, existem com o contexto e essas e outras podem ser usadas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fcc/1ac/dfc/fcc1acdfc43284500c38884d88212877.jpg"><br><br><h2>  Operadores </h2><br>  O Kotlin possui um conjunto limitado de operadores que voc√™ pode substituir usando conven√ß√µes e a palavra-chave operator. <br><br>  Vejamos o professor e sua acessibilidade.  Suponha que digamos que o professor trabalha √†s segundas-feiras das 8h √† 1 hora.  Tamb√©m queremos dizer que, al√©m desta hora, funciona a partir das 13h00 por 1 hora.  Eu gostaria de expressar isso usando o operador <b>+</b> .  Como isso pode ser feito? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/17b/360/9ab/17b3609ab2ebd28cf27f906934536e05.jpg"><br><br>  H√° algum m√©todo de disponibilidade que aceita uma lambda com um contexto <code>AvailabilityTable</code> .  Isso significa que h√° alguma classe chamada assim, e o m√©todo de segunda-feira √© declarado nessa classe.  Este m√©todo retorna <code>DayPointer</code> desde  voc√™ precisa anexar nosso operador a alguma coisa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/721/aea/73d/721aea73d36a41cf3dbecd328b1f5ab5.jpg"><br><br>  Vamos descobrir o que √© DayPointer.  Isso indica a tabela de disponibilidade de algum professor e o dia est√° na agenda dele.  Tamb√©m temos uma fun√ß√£o de tempo que, de alguma forma, transformar√° algumas linhas em √≠ndices inteiros: no Kotlin, temos uma classe <code>IntRange</code> para isso. <br><br>  √Ä esquerda est√° o <code>DayPointer</code> , √† direita est√° a hora e gostar√≠amos de combin√°-los com o operador <b>+</b> .  Para fazer isso, voc√™ pode criar nosso operador na classe <code>DayPointer</code> .  Ser√° necess√°rio um intervalo de valores do tipo Int e retornar√° <code>DayPointer</code> para que possamos encadear nossa DSL repetidamente. <br>  Agora, vamos dar uma olhada no design principal com o qual tudo come√ßa, com o qual nossa DSL come√ßa.  Sua implementa√ß√£o √© um pouco diferente, e agora vamos descobrir. <br>  Kotlin tem um conceito singleton embutido na linguagem.  Para fazer isso, em vez da palavra-chave da classe, a palavra-chave do <code>object</code> √© usada.  Se criarmos um m√©todo dentro de um singleton, poderemos acess√°-lo de tal maneira que n√£o seja necess√°rio criar uma inst√¢ncia dessa classe novamente.  Simplesmente nos referimos a ele como um m√©todo est√°tico em uma classe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3d/226/065/d3d2260651fc4049ec8d3e6878a0cc51.jpg"><br><br>  Se voc√™ observar o resultado da descompila√ß√£o (ou seja, no ambiente de desenvolvimento, clique em Ferramentas -&gt; Kotlin -&gt; Mostrar Bytecode do Kotlin -&gt; Descompilar), poder√° ver a seguinte implementa√ß√£o de singleton: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/8c9/577/3c68c957760612b06a5b008c734ddb33.jpg"><br><br>  Esta √© apenas uma aula comum, e nada de sobrenatural acontece aqui. <br>  Outra ferramenta interessante √© a declara√ß√£o de <code>invoke</code> .  Imagine que temos alguma classe A, temos sua inst√¢ncia e gostar√≠amos de execut√°-la, ou seja, chamar par√™nteses em um objeto dessa classe, e podemos fazer isso gra√ßas ao operador de chamada. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25f/3a1/f95/25f3a1f95c8c61dcb4937822bd9578e6.jpg"><br><br>  De fato, par√™nteses nos permitem chamar o m√©todo invoke e possui um modificador de operador.  Se passarmos um lambda com contexto para esse operador, obteremos essa constru√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b6b/61d/675/b6b61d67518cb1dc730bce8e309ae0dc.jpg"><br><br>  Criar inst√¢ncias a cada vez √© outra atividade, para que possamos combinar conhecimentos anteriores e atuais. <br><br>  Vamos fazer um singleton, cham√°-lo de agendamento, dentro dele declararemos o operador de chamada, dentro criaremos um contexto e ele aceitar√° uma lambda com o contexto que criamos aqui.  Acontece um √∫nico ponto de entrada em nossa DSL e, como resultado, obtemos o mesmo cronograma de constru√ß√£o com chaves. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/53a/41f/7d8/53a41f7d8e9067b6ce850045e745fb4f.jpg"><br><br>  Bem, falamos sobre programa√ß√£o, vamos dar uma olhada em nossos cheques. <br>  Temos professores, constru√≠mos algum tipo de cronograma e queremos verificar se no cronograma desse professor em um determinado dia de uma determinada li√ß√£o h√° algum objeto com o qual trabalharemos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22d/0e3/9ef/22d0e39ef38ceb43fd60654de876691b.jpg"><br><br>  Gostaria de usar colchetes e acessar nossa programa√ß√£o de uma maneira que pare√ßa visualmente o acesso a matrizes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e6/895/b9e/1e6895b9ed089ed99d4c2639e6e1f578.jpg"><br><br>  Isso pode ser feito usando o operador: get / set: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/815/9f5/a86/8159f5a8628b6c5bb21d219e395ea32b.jpg"><br><br>  Aqui n√£o estamos fazendo nada de novo, basta seguir as conven√ß√µes.  No caso do operador set, precisamos passar adicionalmente os valores para o nosso m√©todo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c8/03d/2f2/4c803d2f20ed8b7f79e308d47b734bd9.jpg"><br><br>  Assim, os colchetes para leitura se transformam em get e os colchetes atrav√©s dos quais atribu√≠mos se transformam em set. <br><br><h2>  Demo: objeto, operadores </h2><br>  Voc√™ pode ler mais texto ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">assistir ao v√≠deo aqui</a> .  O v√≠deo tem um hor√°rio de in√≠cio claro, mas nenhum hor√°rio de t√©rmino √© especificado - em princ√≠pio, uma vez iniciado, voc√™ pode assisti-lo antes do final do artigo. <br><br>  Por conveni√™ncia, descreverei brevemente a ess√™ncia do v√≠deo diretamente no texto. <br><br>  Vamos escrever um teste.  Temos algum objeto de agendamento e, se formos implementados por meio de ctrl + b, veremos tudo o que eu falei antes. <br><br><img src="https://habrastorage.org/webt/uk/pg/0d/ukpg0djbwn_hfyq4a7g9usa65aa.png"><br><br>  Dentro do objeto de agendamento, queremos inicializar os dados, realizar algumas verifica√ß√µes e, dentro dos dados, gostar√≠amos de dizer que: <br><br><ul><li>  nossa escola est√° aberta das 8 da manh√£; <br></li><li>  existe um certo conjunto de itens para os quais criaremos um cronograma; <br></li><li>  alguns professores descreveram algum tipo de acessibilidade; <br></li><li>  ter um aluno; <br></li><li>  em princ√≠pio, para um estudante, precisamos apenas dizer que ele est√° estudando um assunto espec√≠fico. <br></li></ul><br><img src="https://habrastorage.org/webt/v_/mq/ia/v_mqia50010hyrqza7zubejj62e.png"><br><br>  E aqui uma das desvantagens do Kotlin e das linguagens orientadas a problemas se manifesta em princ√≠pio: √© bastante dif√≠cil abordar alguns objetos que criamos anteriormente.  Nesta demonstra√ß√£o, indicarei tudo como √≠ndices, ou seja, rus √© o √≠ndice 0, matem√°tica √© o √≠ndice 2. E o professor naturalmente tamb√©m lidera alguma coisa.  Ele n√£o apenas vai trabalhar, mas est√° envolvido em alguma coisa.  Para os leitores deste artigo, gostaria de oferecer mais uma op√ß√£o de endere√ßamento, voc√™ pode criar tags exclusivas e armazenar entidades nelas no Map e, quando precisar acessar uma delas, sempre poder√° encontr√°-las por tag.  Continue a desmontar o DSL. <br><br>  Aqui, o que deve ser observado: em primeiro lugar, temos o operador +, para cuja implementa√ß√£o tamb√©m podemos ir e ver que realmente temos a classe DayPointer, que nos ajuda a vincular tudo isso com a ajuda do operador. <br><br>  E, gra√ßas ao fato de termos acesso ao contexto, o ambiente de desenvolvimento nos diz que, em nosso contexto, por meio dessa palavra-chave, temos acesso a alguma cole√ß√£o e a usaremos. <br><br><img src="https://habrastorage.org/webt/l_/3q/uw/l_3quwu2xaqlxikn71jhpnnero4.png"><br><br>  Ou seja, temos uma cole√ß√£o de eventos.  O evento encapsula um conjunto de propriedades, por exemplo: que h√° um aluno, um professor, em que dia eles se encontram e em que li√ß√£o. <br><br><img src="https://habrastorage.org/webt/fn/1f/xa/fn1fxa5legi4mwszf5xbudchoi0.png"><br><br>  Continuamos a escrever o teste ainda mais. <br><br><img src="https://habrastorage.org/webt/vj/bt/s9/vjbts9wb6fely-atqa-kr88i9qm.png"><br><br>  Aqui, novamente, usamos o operador get; n√£o √© t√£o f√°cil chegar √† sua implementa√ß√£o, mas podemos faz√™-lo. <br><br><img src="https://habrastorage.org/webt/iz/gd/dv/izgddvy3bomaqjp_6yvbfrbcgpe.png"><br><br>  De fato, apenas seguimos o contrato, para ter acesso a esse design. <br>  Vamos voltar √† apresenta√ß√£o e continuar a conversa sobre Kotlin.  Quer√≠amos que as verifica√ß√µes fossem implementadas no Kotlin e passamos por esses eventos: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4f/f23/a77/b4ff23a77974a299ecac5c1c3b5d984f.jpg"><br><br>  Um evento √© essencialmente um conjunto encapsulado de 4 propriedades.  Gostaria de decompor esse evento em um conjunto de propriedades, como uma tupla.  Em russo, essa constru√ß√£o √© chamada de <i>multi-declara√ß√£o</i> (eu encontrei apenas essa tradu√ß√£o) ou <i>declara√ß√£o de desestrutura√ß√£o</i> e funciona da seguinte forma: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f2c/185/5f1/f2c1855f1ee98b51a4bda6ce9cc0b0a8.jpg"><br><br>  Se um de voc√™s n√£o estiver familiarizado com esse recurso, ele funcionar√° da seguinte maneira: voc√™ pode pegar o evento e, no local em que ele √© usado, usando par√™nteses, decomp√µe-o em um conjunto de propriedades. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/444/95f/0a3/44495f0a381b71a20578736f0cb491af.jpg"><br><br>  Isso funciona porque temos um m√©todo componentN, ou seja, √© um m√©todo gerado pelo compilador gra√ßas ao modificador de dados que escrevemos antes da classe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/126/db9/d78/126db9d789acf9b3482f314d5a53261f.jpg"><br><br>  Junto com isso, um grande n√∫mero de outros m√©todos voa para n√≥s.  Estamos interessados ‚Äã‚Äãno m√©todo componentN, que √© gerado com base nas propriedades listadas na lista de par√¢metros do construtor prim√°rio. <br><br><img src="https://habrastorage.org/webt/hd/nf/ou/hdnfoutg14046a351gjyhodfprc.png"><br><br>  Se n√£o tiv√©ssemos um modificador de dados, seria necess√°rio escrever manualmente um operador que far√° a mesma coisa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2b/37f/a2f/e2b37fa2fad7cd8e201987c32fbf572b.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e59/bc7/479/e59bc7479e66cd96c4d0d5093ef33608.jpg"><br><br>  Portanto, temos alguns m√©todos componentN, e eles se decomp√µem em uma chamada: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96a/cae/aa9/96acaeaa91222d55c4a77b70c9b02903.jpg"><br><br>  Em ess√™ncia, √© o a√ß√∫car sint√°tico sobre o chamado de v√°rios m√©todos. <br><br>  J√° falamos sobre alguma tabela de disponibilidade e, de fato, eu o enganei.  Isso acontece  N√£o existe <code>avaiabilityTable</code> , n√£o existe na natureza, mas existe uma matriz de valores booleanos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/393/d7d/5d7/393d7d5d739ea9cecedadff695ca6874.jpg"><br><br>  Nenhuma classe adicional √© necess√°ria: voc√™ pode pegar a matriz de valores booleanos e renome√°-la para obter mais obviedade.  Isso pode ser feito usando as chamadas <i>tipealias</i> ou <i>alias de tipo</i> .  Infelizmente, n√£o recebemos b√¥nus adicionais por isso, √© apenas uma renomea√ß√£o.  Se voc√™ pegar a disponibilidade e renome√°-la novamente para a matriz de valores booleanos, nada ser√° alterado.  O c√≥digo funcionou e funcionar√°. <br><br>  Vamos dar uma olhada no professor, essa √© exatamente essa acessibilidade e falar sobre ele: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/521/031/f59/521031f59a8e7b222c2614b32ba88abd.jpg"><br><br>  Temos um professor e o m√©todo de disponibilidade √© chamado (voc√™ ainda n√£o perdeu o fio do racioc√≠nio? :-).  De onde ele veio?  Ou seja, um professor √© algum tipo de entidade que tem uma turma, e esse √© um c√≥digo comercial.  E n√£o pode haver m√©todo adicional. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54e/044/683/54e0446838b2360d695b45e5bacec69d.jpg"><br><br>  Este m√©todo aparece devido a fun√ß√µes de extens√£o.  Tomamos e fixamos em nossa classe alguma outra fun√ß√£o que podemos executar em objetos dessa classe. <br>  Se passarmos algum lambda para essa fun√ß√£o e, em seguida, execut√°-lo em uma propriedade existente, tudo estar√° bem - o m√©todo de disponibilidade em sua implementa√ß√£o inicializa a propriedade de disponibilidade.  Voc√™ pode se livrar disso.  J√° sabemos sobre o operador de chamada, que pode ser anexado a um tipo e, ao mesmo tempo, ser uma fun√ß√£o de extens√£o.  Se voc√™ passar um lambda para esse operador, ent√£o, na palavra-chave this, podemos executar esse lambda.  Como resultado, quando trabalhamos com um professor, a acessibilidade √© uma propriedade do professor, e n√£o um m√©todo adicional, e nenhum rassynchron acontece aqui. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d6/1af/f71/4d61aff7169c403c75493790720c0e6e.jpg"><br><br>  Como b√¥nus, fun√ß√µes de extens√£o podem ser criadas para tipos anul√°veis.  Isso √© bom, porque se houver uma vari√°vel com um tipo anul√°vel contendo um valor nulo, nossa fun√ß√£o j√° estar√° pronta para isso e n√£o cair√° do NullPointer.  Dentro desta fun√ß√£o, isso pode ser nulo e isso precisa ser tratado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/59a/e33/1c5/59ae331c58bcd16003f51f870b89549e.jpg"><br><br>  Resumindo as fun√ß√µes de extens√£o: voc√™ precisa entender que h√° acesso apenas √† API p√∫blica da classe, e a pr√≥pria classe n√£o √© modificada de forma alguma.  Uma fun√ß√£o de extens√£o √© determinada pelo tipo da vari√°vel e n√£o pelo tipo real.  Al√©m disso, um membro da classe com a mesma assinatura ser√° priorizado.  Voc√™ pode criar uma fun√ß√£o de extens√£o para uma classe, mas escrev√™-la em uma classe completamente diferente e, dentro dessa fun√ß√£o de extens√£o, haver√° acesso a dois contextos simultaneamente.  Acontece a interse√ß√£o de contextos.  E, finalmente, esta √© uma √≥tima oportunidade para levar e prender os operadores em geral a qualquer lugar onde desejamos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a04/1e8/610/a041e86102be21acf2c3170cf941d064.jpg"><br><br>  A pr√≥xima ferramenta s√£o fun√ß√µes infix.  Outro martelo perigoso nas m√£os do desenvolvedor.  Por que perigoso?  O que voc√™ v√™ √© c√≥digo.  Esse c√≥digo pode ser escrito em Kotlin, e n√£o fa√ßa isso!  Por favor, n√£o fa√ßa isso.  No entanto, a abordagem √© boa.  Gra√ßas a isso, √© poss√≠vel livrar-se de pontos, colchetes - de toda a sintaxe barulhenta da qual estamos tentando chegar o mais longe poss√≠vel e tornar nosso c√≥digo um pouco mais limpo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/909/8c3/4a0/9098c34a06b09bac0597004c6fbf6b1a.jpg"><br><br>  Como isso funciona?  Vamos dar um exemplo mais simples - uma vari√°vel inteira.  Vamos criar uma fun√ß√£o de extens√£o para ela, vamos cham√°-la shouldBeEqual, ela far√° algo, mas isso n√£o √© interessante.  Se adicionarmos o modificador infix √† esquerda, isso √© suficiente.  Voc√™ pode se livrar de pontos e colchetes, mas h√° algumas nuances. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39e/fc2/31f/39efc231fb88cee1ef014a36fcb6cc73.jpg"><br><br>  Com base nisso, apenas a constru√ß√£o de dados e asser√ß√µes √© implementada, unida. <br><img src="https://habrastorage.org/getpro/habr/post_images/80f/6dd/126/80f6dd126255196fc538026ea28656c1.jpg"><br><br>  Vamos descobrir.  Temos um SchedulingContext - o contexto geral da inicializa√ß√£o do agendamento.  Existe uma fun√ß√£o de dados que retorna o resultado desse planejamento.  Ao mesmo tempo, criamos uma fun√ß√£o de extens√£o e, ao mesmo tempo, as asser√ß√µes da fun√ß√£o infix, que iniciar√£o um lambda que verifica nossos valores. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/449/74c/fe5/44974cfe559d94d17e6435557757af80.jpg"><br><br>  H√° um sujeito, objeto e a√ß√£o, e voc√™ precisa conect√°-los de alguma forma.  Nesse caso, o resultado da execu√ß√£o de dados com chaves √© o assunto.  A lambda que passamos para o m√©todo assertions √© um objeto, e o pr√≥prio m√©todo assertions √© uma a√ß√£o.  Tudo isso parece ficar junto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/518/aac/4e9/518aac4e9d92ca84a79e6cdb09fea773.jpg"><br><br>  Falando no infix da fun√ß√£o, √© importante entender que este √© um passo para se livrar da sintaxe barulhenta.  No entanto, precisamos ter um assunto e um objeto dessa a√ß√£o e precisamos usar o modificador de infixo.  Pode haver exatamente um par√¢metro - ou seja, zero par√¢metros n√£o podem ser, dois n√£o podem ser, tr√™s - bem, voc√™ entende.  Voc√™ pode passar, por exemplo, lambdas para essa fun√ß√£o e, dessa maneira, constru√ß√µes que voc√™ nunca viu antes s√£o obtidas. <br><br>  Vamos para a pr√≥xima demonstra√ß√£o.  √â melhor assistir ao v√≠deo e n√£o ler o texto. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/q_UM1EY2S5g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Agora tudo parece pronto: o infixo da fun√ß√£o que voc√™ viu, a extens√£o da fun√ß√£o que voc√™ viu, a declara√ß√£o de desestrutura√ß√£o est√° pronta. <br><br>  Vamos voltar √† nossa apresenta√ß√£o, e aqui passaremos para um ponto bastante importante ao criar linguagens orientadas a problemas - o que voc√™ deve pensar √© no controle de contexto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ff/0d3/57a/9ff0d357a3e39d01bcb3d5d07d81d71e.jpg"><br><br>  H√° situa√ß√µes em que podemos usar o DSL e reutiliz√°-lo dentro dele, mas n√£o queremos fazer isso.  Nosso usu√°rio (possivelmente um usu√°rio inexperiente) grava dados dentro de dados, e isso n√£o faz sentido.  De alguma forma, gostar√≠amos de proibi-lo de fazer isso. <br><br>  Antes da vers√£o 1.1 do Kotlin, t√≠nhamos que fazer o seguinte: em resposta ao fato de termos um m√©todo de dados no <code>SchedulingContext</code> , tivemos que criar outro m√©todo de dados no <code>DataContext</code> , no qual aceitamos uma lambda (embora sem implementa√ß√£o), devemos marcar esse m√©todo anota√ß√£o <code>@Deprecated</code> e diga ao compilador para n√£o compilar isso.  Voc√™ v√™ que esse m√©todo √© iniciado - n√£o compile.  Usando essa abordagem, at√© recebemos alguma mensagem significativa quando escrevemos c√≥digo sem sentido. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfb/7a7/0b4/dfb7a70b4fba1c5cb0bf37715a4fe1bd.jpg"><br><br>  Ap√≥s a vers√£o Kotlin 1.1, uma maravilhosa anota√ß√£o <code>@DslMarker</code> .  Esta anota√ß√£o √© necess√°ria para sinalizar anota√ß√µes derivadas.  Com eles, por sua vez, marcaremos as linguagens orientadas a problemas.  Para cada linguagem orientada a problemas, voc√™ pode criar uma anota√ß√£o que marque <code>@DslMarker</code> e pendure-a em cada contexto necess√°rio.  N√£o √© mais necess√°rio escrever m√©todos adicionais que devem ser proibidos de compilar - tudo funciona.  N√£o compilado. <br><br>  No entanto, existe um caso especial quando trabalhamos com nosso modelo de neg√≥cios.  Geralmente √© escrito em Java.  ,   ,    .  ,     ?  <code>Student</code> .  ‚Äì   -,  Kotlin . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c6/111/c5c/4c6111c5c80ab5c4856e68c06880ed4a.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc3/572/a05/cc3572a054dabbe4e32362d845b30cf8.jpg"><br><br>    -    ,         :    .        ,     ,  . <br><br><img width="100%" src="https://habrastorage.org/getpro/habr/post_images/2fd/77d/125/2fd77d1250c0677a24c1c9c358f11663.jpg"><br><br>     . <br><br><ol><li>   ,     .   StudentContext.    ,        .    ‚Äì   , , ,   . <br></li><li>   ‚Äì      ,    ,     .        .  StudentContext  ,      IStudent       .  ,       Student,        IStudent  StudentContext.   DslMarker  ,  . <br></li><li>  :   deprecated     .   ,   .       ,   .       extension-,     .       . <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/9ea/10d/d6a/9ea10dd6af4495be38653339010e0a46.jpg"><br><br>  ,       ,    ,    . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d7/9f9/53f/1d79f953fc755000013d44d15f56fb73.jpg"><br><br>    .     . ,       ,   ,      .  ,           .   @DslMarker,      .   ,       @DslMarker,   @Deprecated,      ,    . <br><br> ,   : <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/q_UM1EY2S5g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><img src="https://habrastorage.org/getpro/habr/post_images/16c/690/f58/16c690f589bf90cc1547edc1ee985ae0.jpg"><br><br><h2>    </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro, reutilize as pe√ßas DSL. Hoje voc√™ j√° viu que o endere√ßamento de entidades criadas usando DSL pode ser problem√°tico. Existem maneiras de contornar isso, mas √© aconselh√°vel pensar com anteced√™ncia, a fim de ter um plano para isso.</font></font><br><br> ,     -  ,      , ,      , -   ,    .   ?    for ‚Äî    .       DSL,       , ,        DSL.     this     it.  ,   Kotlin  1.2.20    ,      .    ,         it. <br><br>    .    DSL,     --,        ,  . ,      . ,    ,        ,   - ,       ,     .   . , -    ,     .. <br><br> , .    ,     -  ‚Äì      DSL. ,     Kotlin-,   . ,   DSL   ,   ,   Kotlin-  .   -?     Gradle-,   ,   ,    ,   - .    - ,   ,    ‚Äì    ,       DSL. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/13e/4e0/05a/13e4e005af12def0ee687b008ffc41ac.jpg"><br><br>   DSL'   , .    ,     .  ,   DSL ,  ,   . - ‚Äì   . -, -      . ,       - . <br> ,  Kotlin.  ,     ,  ,       , , ,     .         (, - ,     ),      ,   DSL  , ,       ,     .      . <br><br>   ¬´¬ª,     .   ,       Kotlin   .     ,  ,    .    ,        ‚Äî  ,     . <br> ,   DSL.      ,       - .    DSL,      ,     10   ,      ,   -      .    DSL ‚Äì      ,     ,     . <br><br>  ,   .    , Telegram: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@ivan_osipov</a> , Twitter: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">@_osipov_</a> , : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">i_osipov</a> .    . <br><br><blockquote>  Minuto de publicidade.        <b>JPoint</b> ‚Äî  ,  19-20   -  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Joker 2018</a> ‚Äî    Java-.       .    ,         . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416725/">https://habr.com/ru/post/pt416725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416711/index.html">P√°ginas da hist√≥ria da Intel. Inc√™ndio na f√°brica de Penang</a></li>
<li><a href="../pt416713/index.html">Relat√≥rio do Clube de Roma 2018, cap√≠tulo 3.14: ‚ÄúNem um √∫nico PIB ...‚Äù</a></li>
<li><a href="../pt416719/index.html">Extens√£o PHP e Kotlin Native. Parte Dois, Consciente</a></li>
<li><a href="../pt416721/index.html">DIY House: casas de boneca para adultos</a></li>
<li><a href="../pt416723/index.html">Acessibilidade da API: interfaces de linguagem natural</a></li>
<li><a href="../pt416727/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 2: ‚ÄúControle de ataques de hackers‚Äù, parte 3</a></li>
<li><a href="../pt416729/index.html">O programa PYCON RUSSIA est√° pronto: 25 relat√≥rios e 3 workshops de palestrantes do Google, Red Hat, Yelp, Yandex</a></li>
<li><a href="../pt416731/index.html">Frost on glass: como fazer pl√°stico metglass resistente</a></li>
<li><a href="../pt416737/index.html">A * Path Finding Algorithm em um jogo Voxel 3d Unity</a></li>
<li><a href="../pt416739/index.html">Novo ASUS na Computex 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>