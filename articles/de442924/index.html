<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐲 💾 🎋 Erweitertes Terrain Texture Splatting 🍴 ☺️ 🐰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werde ich einen Textur-Splatting-Algorithmus erläutern, mit dem Sie natürlicheres Terrain erstellen können. Dieser Algorithmus kann ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erweitertes Terrain Texture Splatting</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442924/"><p><img src="https://habrastorage.org/storage2/b6f/b62/881/b6fb628815315bfeff081eaa87005316.png" alt="Bild"></p><br><p>  In diesem Artikel werde ich einen Textur-Splatting-Algorithmus erläutern, mit dem Sie natürlicheres Terrain erstellen können.  Dieser Algorithmus kann sowohl in Shadern von 3D-Spielen als auch in 2D-Spielen verwendet werden. </p><a name="habracut"></a><br><p>  Eine der häufigsten Methoden zur Geländetexturierung ist das Mischen mehrerer gekachelter Ebenen.  Jede Ebene verfügt über eine Deckkraftkarte, die das Ausmaß der Texturpräsenz im Gelände definiert.  Bei dieser Methode wird eine Deckkraftkarte auf die höheren Ebenen angewendet, wobei die Ebenen darunter angezeigt werden, unter denen die Deckkraftkarte teilweise oder vollständig transparent ist.  Die Opazitätskarte wird in Prozent gemessen.  Natürlich ergibt die Summe der Trübungen aller Schichten an jedem Punkt eines Geländes einhundert Prozent, da das Gelände nicht transparent sein kann.  Anstelle von Kacheltexturen erstreckt sich die Deckkraftkarte vollständig über das gesamte Gelände und weist daher einen relativ geringen Detaillierungsgrad auf. </p><br><p> Nun kommen wir zum interessantesten Teil - den Algorithmen zum Mischen von Texturen.  Der Einfachheit und Offensichtlichkeit halber wird unser Gelände aus Sand und großen Pflastersteinen bestehen. </p><br><p><img src="https://habrastorage.org/storage2/5b0/c19/132/5b0c191329d7745ed66ac379e9c9ac33.jpg" alt="Bild"></p><br><p>  Die einfachste Art des Mischens besteht darin, die Texturfarbe mit der Deckkraft zu multiplizieren und dann die Ergebnisse zu summieren. </p><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.rgb * a1 + texture2.rgb * a2; }</code> </pre> <br><p>  Eine solche Technik wird in Unity3D im Standard-Terrain-Editor verwendet.  Wie Sie sehen können, ist der Übergang glatt, aber unnatürlich.  Steine ​​sehen gleichmäßig von Sand verschmutzt aus, aber in der realen Welt passiert das nicht so.  Sand haftet nicht an Steinen, sondern fällt herunter und füllt Risse zwischen ihnen, sodass die Steinspitzen rein bleiben. </p><br><p>  Versuchen wir, dieses Verhalten in Excel-Plots zu simulieren.  Da Sand zwischen Kopfsteinpflaster "herunterfallen" soll, benötigen wir für jede Textur die Tiefenkarte.  In diesem Beispiel wird die Tiefenkarte aus einem Graustufenbild generiert und im Alphakanal einer Textur gespeichert.  In Unity3D kann dies im Texturinspektor durch Setzen des Flags "Alpha From Grayscale" erfolgen. </p><br><p>  Zunächst betrachten wir das vereinfachte Modell der Tiefenkarte von Sand und Steinen. </p><br><p><img src="https://habrastorage.org/storage2/af1/c47/aa1/af1c47aa1f596fcba486980109cd05d7.png" alt="Bild"></p><br><p>  Die blaue Linie auf dem Grundstück symbolisiert die Tiefenkarte von Sand und rot ist Kopfsteinpflaster.  Beachten Sie, dass die Steinspitzen höher als der Sand liegen.  In Anbetracht dieser Tatsache werden wir versuchen, Pixel dieser Textur zu zeichnen, die oben liegt. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.a &gt; texture2.a ? texture1.rgb : texture2.rgb; }</code> </pre> <br><p><img src="https://habrastorage.org/storage2/4cd/945/25e/4cd94525e9b523807684c68092d42cc0.jpg" alt="Bild"></p><br><p>  Ausgezeichnet!  Kopfsteinpflaster bleibt rein, während Sand in Rissen zwischen ihnen liegt.  Die Deckkraft der Ebene wurde jedoch noch nicht berücksichtigt.  Um es zu verwenden, addieren wir einfach die Tiefen-Tiefenkarte und die Opazitätskarte. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.a + a1 &gt; texture2.a + a2 ? texture1.rgb : texture2.rgb; }</code> </pre> <br><p>  Auf Kosten der Summierung ist die weniger transparente Textur höher als gewöhnlich. </p><br><p><img src="https://habrastorage.org/storage2/2cf/8e7/7b9/2cf8e77b9022d75336888982f6b7306a.png" alt="Bild"></p><br><p><img src="https://habrastorage.org/storage2/a67/e3f/e07/a67e3fe07d4a7cf50fe6e9c847288c62.jpg" alt="Bild"></p><br><p>  Wir haben also einen natürlicheren Übergang von Sand zu Steinen.  Wie Sie sehen können, füllen Sandkörner Risse zwischen Kopfsteinpflaster und verbergen sie allmählich.  Bei Berechnungen Pixel für Pixel treten jedoch Artefakte an der Grenze zwischen Texturen auf.  Um ein glattes Ergebnis zu erzielen, nehmen wir mehrere Pixel in die Tiefe anstatt eines und mischen sie. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> depth = <span class="hljs-number"><span class="hljs-number">0.2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ma = max(texture1.a + a1, texture2.a + a2) - depth; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b1 = max(texture1.a + a1 - ma, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b2 = max(texture2.a + a2 - ma, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (texture1.rgb * b1 + texture2.rgb * b2) / (b1 + b2); }</code> </pre> <br><p>  Im obigen Code erhalten wir zunächst einen Teil eines Bodens, der in einer bestimmten Tiefe gesehen wird. </p><br><p><img src="https://habrastorage.org/storage2/647/ecf/d8f/647ecfd8f18aa92a5a204caf7727870d.png" alt="Bild"></p><br><p>  Und dann normalisieren wir es, um neue Trübungen zu erhalten. </p><br><p><img src="https://habrastorage.org/storage2/f27/9a6/7c1/f279a67c188a58864db4536a68642529.png" alt="Bild"></p><br><p><img src="https://habrastorage.org/storage2/6cf/9fd/03c/6cf9fd03c46bbe439fdc38eeedfc5335.jpg" alt="Bild"></p><br><p>  Als Ergebnis haben wir den Algorithmus der Texturmischung gefunden, der es uns ermöglicht, nahe an ein natürliches Geländebild heranzukommen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de442924/">https://habr.com/ru/post/de442924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de442914/index.html">Battle Royale: Designgeheimnisse des beliebtesten Gaming-Genres</a></li>
<li><a href="../de442916/index.html">Sind Raubkopien von UKW-Radiosendern heute relevant?</a></li>
<li><a href="../de442918/index.html">Handbuch zum Bereitstellen von Modellen für maschinelles Lernen in einer Produktionsumgebung als API mithilfe von Flask</a></li>
<li><a href="../de442920/index.html">Coroutinen :: praktische Erfahrung</a></li>
<li><a href="../de442922/index.html">Mondmission "Bereshit" - Eigenschaften des Geräts, eine Reihe von Manövern und der längste Weg zum Mond</a></li>
<li><a href="../de442926/index.html">"Mausaufhebens" im Infrarotlicht: das Einbringen von Nanopartikeln in die subretinale Region des Mausauges</a></li>
<li><a href="../de442928/index.html">Schreiben eines flexiblen Codes mit SOLID</a></li>
<li><a href="../de442934/index.html">Wie man Leute in einem riesigen Unternehmen mit einem unbeliebten Stapel anstellt. Gespräch mit Wrike</a></li>
<li><a href="../de442936/index.html">Dies ist ein Muss: Die 3D-Technologie hat dazu beigetragen, intelligente Brillen für Ingenieure zu entwickeln</a></li>
<li><a href="../de442938/index.html">Fernarbeit mit einem gesunden (?) Arbeitgeber</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>