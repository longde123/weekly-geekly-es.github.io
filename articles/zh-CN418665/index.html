<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔪 🧓🏾 ⏱️ 为HoloLens改编MR项目 🛀🏻 🙆🏻 😗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="因此，我们有关Windows Mixed Reality的文章系列即将结束。 在其中，我们从头开始在格式实验室工作（实验室工作）中在Unity上开发了一个具有混合现实的应用程序。 今天是最后的话题，我们将讨论一个非常有趣的主题-HoloLens和该设备对该项目的适应。 立即加入！ 



 整个指南...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>为HoloLens改编MR项目</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/418665/"> 因此，我们有关Windows Mixed Reality的文章系列即将结束。 在其中，我们从头开始在格式实验室工作（实验室工作）中在Unity上开发了一个具有混合现实的应用程序。 今天是最后的话题，我们将讨论一个非常有趣的主题-HoloLens和该设备对该项目的适应。 立即加入！ <br><br><img src="https://habrastorage.org/webt/7l/qn/el/7lqnelncue7h3vwfqqxkqerm4u8.jpeg"><a name="habracut"></a><br><br><blockquote> 整个指南将包括5个部分。 它将每周补充一次。 您可以在下面转到所需的部分。 <br><br>  <b>第1部分：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">从Unity导出Windows Mixed Reality的UWP应用程序</a> ； <br>  <b>第2部分：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">设置环境（VR）</a> ； <br>  <b>第3部分：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">控制器</a> ； <br>  <b>第4部分：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">空间声音</a> ； <br>  <b>第5部分：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HoloLens和图形</a> 。 </blockquote><br><h2> 霍洛伦 </h2><br> 到目前为止，我们的应用程序仅适用于沉浸式耳机。 但是，只需对应用程序进行一些更改，就可以在其中实现对整个混合现实设备（包括HoloLens）范围的支持。 <br><br> 由于我们使用了混合现实工具包来控制摄像机，实现交互并添加按钮，因此我们仅需对项目进行一些更改。 <br><br><h4> 隐藏虚拟房间 </h4><br> 我们需要编写一个脚本来确定应用程序在沉浸式耳机或HoloLens设备上运行的设备上。 如果应用程序在HoloLens设备上运行，则必须隐藏虚拟空间，以便用户可以与实际环境进行交互。 为此，我们首先将Tag元素添加到RoomPrefab预制中，然后我们将在脚本中访问此标签。 <br><br>  1.在“层次结构”面板中选择RoomPrefab预制件。 <br><br>  2.在“检查器”面板的“标签”下拉列表中，选择“添加标签...”。 <br><br><img src="https://habrastorage.org/webt/qk/48/-o/qk48-otwilnhukhdowcvhdavqii.png"><br><br>  3.单击+号创建一个新标签，并将该标签命名为HMDUOnly。 <br><br><img src="https://habrastorage.org/webt/r7/yx/11/r7yx11_dfmnofazlnqssj3rgiog.png"><br><br>  4.现在，再次单击“层次结构”面板中的RoomPrefab预制件，然后从“检查器”面板的“标签”下拉菜单中选择HMDUOnly标签。 <br><br> 您可以通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">多种方式</a>在脚本中选择游戏对象。 我们可以将标签添加到需要隐藏的任何对象（如果有多个对象），然后依次隐藏每个对象。 调用FindGameObjectsWithTag方法不是最理想的方法，但是它非常适合我们。 <br><br>  5.从顶部的Unity菜单中，选择GameObject-&gt; Create Empty。 <br><br>  6.在“层次结构”面板中，将添加的空GameObject的名称更改为GameManager。 <br><br>  7.在“检查器”面板中，单击“添加组件”-&gt;“新建脚本”，并将该脚本命名为GameManager，选择C Sharp作为编程语言。 单击创建并添加以创建脚本。 <br><br>  8.要打开GameManager脚本，请在“检查器”面板或“资产”面板中双击它。 <br><br>  9.将GameManager脚本代码替换为以下代码。 在应用程序启动时，该测试仅需要执行一次。 我们将在Start（）函数中执行它，并删除Update（）函数。 <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-comment"><span class="hljs-comment">// We need the UnityEngine.XR.WSA namespace to access Holographic Settings which contain // functions which effect the performance and presentation of Holograms on Windows // Holographic platforms. using UnityEngine.XR.WSA; public class GameManager : MonoBehaviour { void Start () { // Check if the MR headset display is transparent (not opaque). if(!HolographicSettings.IsDisplayOpaque){ // If that is the case, then we need to hide the virtual living room GameObject[] HMDUOnlyObjects = GameObject.FindGameObjectsWithTag("HMDUOnly"); for (int i = 0; i &lt; HMDUOnlyObjects.Length; i++){ // Set active to false disables the object. HMDUOnlyObjects[i].SetActive(false); } } } }</span></span></code> </pre> <br> 最后，为了确保应用程序在HoloLens设备上正常运行，我们需要将摄像机的背景设为黑色。 <br><br>  10.在“层次结构”面板中，选择MixedRealityCameraParent-&gt; MixedRealityCamera对象。 向下滚动检查器面板，然后为混合现实相机管理器-&gt;透明显示设置-&gt;背景颜色参数（混合现实相机管理器-&gt;透明显示设置-&gt;背景颜色）选择黑色作为值。 <br><br><img src="https://habrastorage.org/webt/n0/gh/qc/n0ghqcj63thf4zmn62uld9iu6pc.png"><br><br><h4> 添加空间映射 </h4><br> 几乎一切准备就绪！ 现在我们需要启用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">空间映射</a> 。 空间成像技术提供了HoloLens环境中物理表面的详细视图，使开发人员可以创建混合现实应用程序，这种应用程序的可能性令人印象深刻。 在我们的情况下，空间映射将允许用户以自然的方式放置扬声器，从而不会被物理表面遮挡。 <br><br> 首先，让我们确保未隐藏边界框对象（边界框）中负责移动和旋转的控件。 <br><br>  1.在“项目”面板的“资产”-&gt;“预制件”文件夹中找到AppBarCustom预制件。 <br><br>  2.为“悬停偏移Y比例”属性（“悬停偏移比例”）设置值0。 <br><br><img src="https://habrastorage.org/webt/bv/tg/u8/bvtgu8gsj2xo8sg7n_ltnynmkgy.png"><br><br> 现在让我们向场景中添加空间映射组件。 <br><br>  3.在资产-&gt; HoloTookit-&gt; SpatialMapping-&gt; Prefabs文件夹中找到SpatialMapping预制件（资源-&gt; HoloTookit-&gt;空间映射-&gt;预制件）。 <br><br>  4.将其拖到场景的“层次结构”面板中。 <br><br><img src="https://habrastorage.org/webt/pu/gp/k3/pugpk3-irjbq5_tmpvbex8pcthg.png"><br><br><h4> 手势全息镜头 </h4><br> 到目前为止，我们的应用程序中的所有类型的交互都是使用运动控制器进行的。 如果应用程序将在HoloLens设备（或其仿真器）上运行，则需要使用另一种方法来移动扬声器并在程序代码中切换到该扬声器。  BoundingBox方法也可以在HoloLens中重用，但是我们希望通过进行一些更改来优化交互。 <br><br>  1.在“项目”面板中选择“扬声器”预制件。 <br><br>  2.单击添加组件-&gt;点击放置。 这是MR Toolkit中HoloLens的脚本，允许用户触摸物体或全息图并轻松地在空间中移动它们。 <br><br>  3.禁用它，使其默认情况下不启动。 要禁用脚本，只需在“检查器”面板中取消选中其名称旁边的复选框即可。 该组件还将向讲者预制中添加Interpolator脚本。 <br><br><img src="https://habrastorage.org/webt/fu/od/db/fuoddb8y3g7lu_bmbd86dugvcrk.png"><br><br>  4.通过选择添加组件-&gt;新建脚本，将该脚本添加到Speaker预制板，然后将此脚本命名为SpeakerMovement。 <br><br>  5.编辑脚本—双击它，并将脚本代码替换为以下代码。 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.XR.WSA; <span class="hljs-comment"><span class="hljs-comment">// namespace for the TwoHandManipulatable script using HoloToolkit.Unity.InputModule.Utilities.Interactions; // namespace for the TapToPlace script using HoloToolkit.Unity.SpatialMapping; public class SpeakerMovement : MonoBehaviour { void Start () { if(!HolographicSettings.IsDisplayOpaque){ GetComponent&lt;TwoHandManipulatable&gt;().enabled = false; GetComponent&lt;TapToPlace&gt;().enabled = true; } } }</span></span></code> </pre> <br> 通过为使用的场景指定名称空间，我们将使用与GameManager脚本中相同的测试来隐藏房间。 这次，当检测到HoloLens设备时，测试将关闭一个脚本，然后打开另一个脚本。 由于我们更改了扬声器的预制件，因此此更改将影响场景中的所有扬声器。 如果更改了Speaker预制实例之一，请单击“检查器”面板右上角的“应用”以更新该预制。 <br><br> 做完了！ 现在，您可以构建应用程序并在沉浸式耳机或HoloLens设备上运行它，然后将扬声器放在房间的任何地方，旋转并控制它们。 <br><br><h2> 图形（可选） </h2><br> 让我们看看如何改善应用程序的视觉效果，因为即使很小的改进也可以显着改变其感知。 如果您想学习如何使应用程序更具吸引力而又没有太多困难，可以使用以下说明。 <br><br><h4> 添加自定义天空盒 </h4><br>  1.在顶部菜单中，选择窗口-&gt;照明-&gt;设置（窗口-&gt;照明-&gt;设置）。 <br><br>  2.将Cloudymorning.mat天空盒从“资产”-&gt;“纹理”文件夹拖到“天空盒材质”属性。 <br><br><h4> 后处理 </h4><br> 注意事项 可以对场景中的任何摄像机执行以下操作，但是无法在编辑器中查看它们。 <br><br>  1.在场景的“层次结构”面板中选择MixedRealityCameraParent-&gt; MixedRealityCamera元素。 <br><br>  2.单击添加组件-&gt;后处理行为。 <br><br>  3.在Assets-&gt; PostProcessing文件夹中找到CustomProfile.asset元素，并将其拖动到Post Processing Behavior脚本的Profile属性中。 <br><br> 尽可能多地试验后处理概要文件，但请记住， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">后处理会消耗资源</a> 。 <br><br> 恭喜你！ 您已完成此练习。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">原来的</a> <br> 作者：埃里克·阿尔斯特罗姆（Eric Ahlstrom），巴克莱姆斯（Cbarkerms），麦迪逊·海特 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418665/">https://habr.com/ru/post/zh-CN418665/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418655/index.html">Windows Mixed Reality：开发人员指南（第1部分）</a></li>
<li><a href="../zh-CN418657/index.html">经济实惠的混合现实：如何创建虚拟空间</a></li>
<li><a href="../zh-CN418659/index.html">使用Quantum Katas探索量子编程</a></li>
<li><a href="../zh-CN418661/index.html">混合现实开发：您是否在虚拟客厅中放置了扬声器？</a></li>
<li><a href="../zh-CN418663/index.html">如何为另一个现实发出声音</a></li>
<li><a href="../zh-CN418667/index.html">使用HDFS 2对HDFS 3进行基准测试</a></li>
<li><a href="../zh-CN418669/index.html">安全周二28：NetSpectre，通过网络攻击第三方渠道</a></li>
<li><a href="../zh-CN418673/index.html">ERP市场为何增长：统计数据和趋势</a></li>
<li><a href="../zh-CN418675/index.html">我如何去柏林Droidcon</a></li>
<li><a href="../zh-CN418677/index.html">关于RTOS的全部真相。 第6条。 其他RTOS服务</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>