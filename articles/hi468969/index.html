<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП╛ ЁЯСитАНтЪХя╕П ЁЯСН API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Google рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ PowerShell рд╕реЗ рдмрдирд╛рдПрдВ ЁЯФК ЁЯФЗ ЁЯАДя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрддреЗ! 

 рдпрд╣ рдЖрд▓реЗрдЦ рд╡рд░реНрдгрди рдХрд░реЗрдЧрд╛ рдХрд┐ рдкрд╛рд╡рд░ рд╕реВрдЯ Google рд╕реБрдЗрдЯ рдХреЗ рд╕рд╛рде рдЬреА рд╕реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рд╕рд╣рднрд╛рдЧрд┐рддрд╛ рдХрд░рддрд╛ рд╣реИред 

 рд╕рдВрдЧрдарди рдореЗрдВ, рд╣рдо рдХрдИ рдЖрдВрдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Google рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ PowerShell рд╕реЗ рдмрдирд╛рдПрдВ</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468969/">  рдирдорд╕реНрддреЗ! <br><br>  рдпрд╣ рдЖрд▓реЗрдЦ рд╡рд░реНрдгрди рдХрд░реЗрдЧрд╛ рдХрд┐ рдкрд╛рд╡рд░ рд╕реВрдЯ Google рд╕реБрдЗрдЯ рдХреЗ рд╕рд╛рде рдЬреА рд╕реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╣реЗрд░рдлреЗрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рд╕рд╣рднрд╛рдЧрд┐рддрд╛ рдХрд░рддрд╛ рд╣реИред <br><br>  рд╕рдВрдЧрдарди рдореЗрдВ, рд╣рдо рдХрдИ рдЖрдВрддрд░рд┐рдХ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЕрдзрд┐рдХрд╛рдВрд╢ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП, рдЙрдирдореЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг Google рдпрд╛ рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмреАрдЪ рд╣рдо рдХреНрд░рдорд╢рдГ рдПрдХ рдкреНрд░рддрд┐рдХреГрддрд┐ рдирд╣реАрдВ рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм рдПрдХ рдирдпрд╛ рдХрд░реНрдордЪрд╛рд░реА рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрди рджреЛ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдореЗрдВ рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ / рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рджреЛрдиреЛрдВ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИред <br><a name="habracut"></a><br><h3>  <font color="#5D8DDF">рдкреНрд░рд╛рдзрд┐рдХрд░рдг</font> </h3><br>  рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреА рд░рдЪрдирд╛ рдХрд░рддреЗ рд╣реБрдП, рд╣рдордиреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓реЛрдЧреЛрдВ рдХреЛ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛, рдпрд╣ рдЖрдХрд╕реНрдорд┐рдХ рдпрд╛ рдЬрд╛рдирдмреВрдЭрдХрд░ рдмрдбрд╝реЗ рдмрджрд▓рд╛рд╡ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рд╕рд░рд▓ рдХрд░рддрд╛ рд╣реИред <br><br>  Google API рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП OAuth 2.0 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдорд╛рдорд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдпрд╣рд╛рдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Google API рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП OAuth 2.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a> ред <br><br>  рдореИрдВрдиреЗ рд╡рд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪреБрдиреА рдЬреЛ рдбреЗрд╕реНрдХрдЯреЙрдк рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред  рдПрдХ рд╕реЗрд╡рд╛ рдЦрд╛рддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рднреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЖрдВрджреЛрд▓рдиреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред <br><br>  рдиреАрдЪреЗ рджреА рдЧрдИ рдЫрд╡рд┐ Google рдкреГрд╖реНрда рд╕реЗ рдЪрдпрдирд┐рдд рдкрд░рд┐рджреГрд╢реНрдп рдХрд╛ рдПрдХ рдпреЛрдЬрдирд╛рдмрджреНрдз рд╡рд┐рд╡рд░рдг рд╣реИред <br><br><img src="https://habrastorage.org/webt/wx/sp/rw/wxsprwm-uqyd1koa-2xx4sgjkku.png"><br><br><ol><li>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ Google рдЦрд╛рддреЗ рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреГрд╖реНрда рдкрд░ рднреЗрдЬрддреЗ рд╣реИрдВ, рдЬреЛ GET рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ: <br><ul><li>  рдЖрд╡реЗрджрди рдЖрдИрдбреА </li><li>  рдЙрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрд╡реЗрджрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </li><li>  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреВрд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрддрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ </li><li>  рдЬрд┐рд╕ рддрд░рд╣ рд╕реЗ рд╣рдо рдЯреЛрдХрди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВрдЧреЗ </li><li>  рд╕рддреНрдпрд╛рдкрди рдХреЛрдб </li><li>  рд╕рддреНрдпрд╛рдкрди рдХреЛрдб рд╕рдВрдЪрд░рдг рдкреНрд░рд╛рд░реВрдк </li></ul><br></li><li>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреГрд╖реНрда рдкрд░ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ рдЬреАрдИрдЯреА рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рддреНрд░реБрдЯрд┐ рдпрд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдкреНрд░реЗрд╖рд┐рдд рд╣реЛрдЧрд╛ред </li><li>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди (рд╕реНрдХреНрд░рд┐рдкреНрдЯ) рдХреЛ рдЗрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдФрд░, рдпрджрд┐ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ </li><li>  рдпрджрд┐ рдЕрдиреБрд░реЛрдз рд╕рд╣реА рд╣реИ, рддреЛ Google API рд▓реМрдЯрд╛рддрд╛ рд╣реИ: <br><br><ul><li>  рдкрд╣реБрдВрдЪ рдЯреЛрдХрди рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдо рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </li><li>  рдЗрд╕ рдЯреЛрдХрди рдХреА рд╡реИрдзрддрд╛ </li><li>  рдкреНрд░рд╡реЗрд╢ рдЯреЛрдХрди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди рдЖрд╡рд╢реНрдпрдХ рд╣реИред </li></ul></li></ol><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ Google API рдХрдВрд╕реЛрд▓ рдкрд░ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ - Google API рдХрдВрд╕реЛрд▓</a> , рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯ OAuth рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдмрдирд╛рдПрдВред  рдЙрд╕реА рд╕реНрдерд╛рди рдкрд░ (рдпрд╛ рдмрд╛рдж рдореЗрдВ, рдмрдирд╛рдП рдЧрдП рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЗ рдЧреБрдгреЛрдВ рдореЗрдВ), рдЖрдкрдХреЛ рдЙрди рдкрддреЗ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдмрдВрджрд░рдЧрд╛рд╣реЛрдВ (рдиреАрдЪреЗ рджреЗрдЦреЗрдВ) рдХреЗ рд╕рд╛рде рдХрдИ рд╕реНрдерд╛рдиреАрдпрд╣реЛрд╕реНрдЯ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рд╣реЛрдВрдЧреАред <br><br>  рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдкрдврд╝рдирд╛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдкрд╣рд▓реЗ рдЪрд░рдг рдореЗрдВ рдПрдХ рдЕрд▓рдЧ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХреНрд╕реЗрд╕ рдФрд░ рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди рд▓реМрдЯрд╛рдПрдЧрд╛: <br><br><pre><code class="cs hljs">$client_secret = <span class="hljs-string"><span class="hljs-string">'Our Client Secret'</span></span> $client_id = <span class="hljs-string"><span class="hljs-string">'Our Client ID'</span></span> function Get-GoogleAuthToken { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (-not [System.Net.HttpListener]::IsSupported) { <span class="hljs-string"><span class="hljs-string">"HttpListener is not supported."</span></span> exit <span class="hljs-number"><span class="hljs-number">1</span></span> } $codeverifier = -<span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ((<span class="hljs-number"><span class="hljs-number">65.</span></span><span class="hljs-number"><span class="hljs-number">.90</span></span>) + (<span class="hljs-number"><span class="hljs-number">97.</span></span><span class="hljs-number"><span class="hljs-number">.122</span></span>) + (<span class="hljs-number"><span class="hljs-number">48.</span></span><span class="hljs-number"><span class="hljs-number">.57</span></span>) + <span class="hljs-number"><span class="hljs-number">45</span></span> + <span class="hljs-number"><span class="hljs-number">46</span></span> + <span class="hljs-number"><span class="hljs-number">95</span></span> + <span class="hljs-number"><span class="hljs-number">126</span></span> |Get-Random -Count <span class="hljs-number"><span class="hljs-number">60</span></span>| % {[<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>]$_}) $hasher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> System.Security.Cryptography.SHA256Managed $hashByteArray = $hasher.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($codeverifier)) $base64 = ((([System.Convert]::ToBase64String($hashByteArray)).replace(<span class="hljs-string"><span class="hljs-string">'='</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>)).replace(<span class="hljs-string"><span class="hljs-string">'+'</span></span>,<span class="hljs-string"><span class="hljs-string">'-'</span></span>)).replace(<span class="hljs-string"><span class="hljs-string">'/'</span></span>,<span class="hljs-string"><span class="hljs-string">'_'</span></span>) $ports = @(<span class="hljs-number"><span class="hljs-number">10600</span></span>,<span class="hljs-number"><span class="hljs-number">15084</span></span>,<span class="hljs-number"><span class="hljs-number">39700</span></span>,<span class="hljs-number"><span class="hljs-number">42847</span></span>,<span class="hljs-number"><span class="hljs-number">65387</span></span>,<span class="hljs-number"><span class="hljs-number">32079</span></span>) $port = $ports[(<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-random -Minimum <span class="hljs-number"><span class="hljs-number">0</span></span> -maximum <span class="hljs-number"><span class="hljs-number">5</span></span>)] Write-Host <span class="hljs-string"><span class="hljs-string">"Start browser..."</span></span> Start-Process <span class="hljs-string"><span class="hljs-string">"https://accounts.google.com/o/oauth2/v2/auth?code_challenge_method=S256&amp;code_challenge=$base64&amp;access_type=offline&amp;client_id=$client_id&amp;redirect_uri=http://localhost:$port&amp;response_type=code&amp;scope=https://www.googleapis.com/auth/admin.directory.user https://www.googleapis.com/auth/admin.directory.group"</span></span> $listener = New-Object System.Net.HttpListener $listener.Prefixes.Add(<span class="hljs-string"><span class="hljs-string">"http://localhost:"</span></span>+$port+<span class="hljs-string"><span class="hljs-string">'/'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {$listener.Start()} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-string"><span class="hljs-string">"Unable to start listener."</span></span> exit <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (($code -eq $<span class="hljs-literal"><span class="hljs-literal">null</span></span>)) { $context = $listener.GetContext() Write-Host <span class="hljs-string"><span class="hljs-string">"Connection accepted"</span></span> -f <span class="hljs-string"><span class="hljs-string">'mag'</span></span> $url = $context.Request.RawUrl $code = $url.split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'='</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($url.split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'='</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] -eq <span class="hljs-string"><span class="hljs-string">'error'</span></span>) { Write-Host <span class="hljs-string"><span class="hljs-string">"Error!"</span></span>$code -f <span class="hljs-string"><span class="hljs-string">'red'</span></span> $buffer = [System.Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"Error!"</span></span>+$code) $context.Response.ContentLength64 = $buffer.Length $context.Response.OutputStream.Write($buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, $buffer.Length) $context.Response.OutputStream.Close() $listener.Stop() exit <span class="hljs-number"><span class="hljs-number">1</span></span> } $buffer = [System.Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"Now you can close this browser tab."</span></span>) $context.Response.ContentLength64 = $buffer.Length $context.Response.OutputStream.Write($buffer, <span class="hljs-number"><span class="hljs-number">0</span></span>, $buffer.Length) $context.Response.OutputStream.Close() $listener.Stop() } Return Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/oauth2/v4/token"</span></span> -Body @{ code = $code client_id = $client_id client_secret = $client_secret redirect_uri = <span class="hljs-string"><span class="hljs-string">'http://localhost:'</span></span>+$port grant_type = <span class="hljs-string"><span class="hljs-string">'authorization_code'</span></span> code_verifier = $codeverifier } $code = $<span class="hljs-literal"><span class="hljs-literal">null</span></span></code> </pre> <br>  рд╣рдордиреЗ OAuth рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЗ рдЧреБрдгреЛрдВ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХреНрд▓рд╛рдЗрдВрдЯ рдЖрдИрдбреА рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реАрдХреНрд░реЗрдЯ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИ, рдФрд░ рдХреЛрдб рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рд▓рдВрдмрд╛рдИ рдореЗрдВ 43 рд╕реЗ 128 рд╡рд░реНрдгреЛрдВ рдХрд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИ, рдЬрд┐рд╕реЗ рдЧреИрд░-рдЖрд░рдХреНрд╖рд┐рдд рд╡рд░реНрдгреЛрдВ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: [AZ] / [az / [0-9 ] / "-" / "ред"  / "_" / "~"ред <br><br>  рдЖрдЧреЗ рдЗрд╕ рдХреЛрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рдЙрд╕ рднреЗрджреНрдпрддрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рдкрд╕ рдЖ рдЧрдпрд╛ред <br>  рдЖрдк рд╡рд░реНрддрдорд╛рди рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреЛрдб рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреЛ рдЗрд╕реЗ рд╡реНрдпрд░реНрде рдмрдирд╛рддрд╛ рд╣реИ - рдпрд╣ рдХреЗрд╡рд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ рдЬреЛ SHA256 рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ), рдпрд╛ SHA256 рд╣реИрд╢ рдмрдирд╛рдХрд░ BASEUUrl рдореЗрдВ рдЗрдирдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рджреЛ рд╡рд░реНрдгреЛрдВ рдореЗрдВ Base64 рд╕реЗ рднрд┐рдиреНрди) рдФрд░ рдЪрд░рд┐рддреНрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред рдкрдВрдХреНрддрд┐ рдХрд╛ рдЕрдВрдд: =ред <br><br>  рдЕрдЧрд▓рд╛, рд╣рдореЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ http рд╕реБрдирдирд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдПрдХ рдЕрдиреБрдкреНрд░реЗрд╖рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдХрд╛рд░реНрдп рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд░реНрд╡рд░ рдкрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╣рдо рдЗрд╕ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрдИ рдкреНрд░рд╢рд╛рд╕рдХ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдПрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╡рд╣ рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЛрд░реНрдЯ рдХрд╛ рдЪрдпрди рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдмрдВрджрд░рдЧрд╛рд╣реЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐  рдЙрдиреНрд╣реЗрдВ рдПрдкреАрдЖрдИ рдХрдВрд╕реЛрд▓ рдореЗрдВ рднрд░реЛрд╕реЗрдордВрдж рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  <i>access_type = рдСрдлрд╝рд▓рд╛рдЗрди рдХрд╛</i> рдЕрд░реНрде рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдмрд╛рддрдЪреАрдд рдХреЗ рдмрд┐рдирд╛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд рдЯреЛрдХрди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, <br>  <i>response_type = рдХреЛрдб</i> рдЗрд╕ рдмрд╛рдд рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд░реВрдк рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдб рдХреИрд╕реЗ рд╡рд╛рдкрд╕ рдЖрдПрдЧрд╛ (рдкреБрд░рд╛рдиреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкрджреНрдзрддрд┐ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддреЗ рд╣реБрдП рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкрд░ рдХреЛрдб рдХреЙрдкреА рдХрд┐рдпрд╛), <br>  <i>рдЧреБрдВрдЬрд╛рдЗрд╢ рдЧреБрдВрдЬрд╛рдЗрд╢</i> рдФрд░ рдкрд╣реБрдБрдЪ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЙрдиреНрд╣реЗрдВ рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдпрд╛% 20 (URL рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░) рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдкрд╣реБрдВрдЪ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдпрд╣рд╛рдВ рджреЗрдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Google рдПрдкреАрдЖрдИ рдХреЗ рд▓рд┐рдП OAuth 2.0 рд╕реНрдХреЛрдк</a> ред <br><br>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рд╕рдорд╛рдкрди рд╕рдВрджреЗрд╢ рд▓реМрдЯрд╛рдПрдЧрд╛, рдкреЛрд░реНрдЯ рдХреЛ рд╕реБрдирдирд╛ рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ рдФрд░ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП POST рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдЧрд╛ред  рд╣рдо рдЗрд╕реЗ рд╕рд╛рдВрдХреЗрддрд┐рдХ рдПрдкреАрдЖрдИ рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЖрдИрдбреА рдФрд░ рд░рд╣рд╕реНрдп рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕ рдкрддреЗ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдЕрдиреБрд╕рд╛рд░ allow_typeред <br><br>  рдЬрд╡рд╛рдм рдореЗрдВ, рд╣рдореЗрдВ рдПрдХ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдорд┐рд▓реЗрдЧрд╛, рд╕реЗрдХрдВрдб рдореЗрдВ рдЗрд╕рдХреА рдЕрд╡рдзрд┐ рдФрд░ рдПрдХ рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди, рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рд╣рдо рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рд▓рдВрдмреА рд╢реЗрд▓реНрдл рд▓рд╛рдЗрдл рдХреЗ рд╕рд╛рде рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдкрд░ рдЯреЛрдХрди рд╕реНрдЯреЛрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдЬрдм рддрдХ рд╣рдо рдкреНрд░рд╛рдкреНрдд рдкрд╣реБрдВрдЪ рдХреЛ рд░рджреНрдж рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддрдм рддрдХ рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди рдЖрд╡реЗрджрди рдкрд░ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрдПрдЧрд╛ред  рдЕрдВрдд рдореЗрдВ, рдореИрдВрдиреЗ рдЯреЛрдХрди рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝рд╛, рдЕрдЧрд░ рдЖрд╡реЗрджрди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реБрдЖ рдФрд░ рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрдпрд╛, рддреЛ рд╡рд╣ рдлрд┐рд░ рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛ (рд╣рдордиреЗ рдЯрд░реНрдорд┐рдирд▓ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЯреЛрдХрди рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдорд╛рдирд╛, рд▓реЗрдХрд┐рди рд╣рдо рдЗрд╕реЗ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА рдХреЛ рдЬрдЯрд┐рд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рдЕрдХреНрд╕рд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЦреЛрд▓рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ)ред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $token_result = Get-GoogleAuthToken $token = $token_result.<span class="hljs-function"><span class="hljs-function">access_token </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$token_result.refresh_token -eq $</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { Write-Host (<span class="hljs-string"><span class="hljs-string">"Session is not destroyed. Revoking token..."</span></span>) Invoke-WebRequest -Uri (<span class="hljs-string"><span class="hljs-string">"https://accounts.google.com/o/oauth2/revoke?token="</span></span>+$token) } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($token_result.refresh_token -eq $<span class="hljs-literal"><span class="hljs-literal">null</span></span>) $refresh_token = $token_result.refresh_token $minute = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:mm}"</span></span> -f ([timespan]::fromseconds($token_result.expires_in))))+((Get-date).Minute)<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($minute -lt <span class="hljs-number"><span class="hljs-number">0</span></span>) {$minute += <span class="hljs-number"><span class="hljs-number">60</span></span>} elseif ($minute -gt <span class="hljs-number"><span class="hljs-number">59</span></span>) {$minute -=<span class="hljs-number"><span class="hljs-number">60</span></span>} $token_expire = @{ hour = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:hh}"</span></span> -f ([timespan]::fromseconds($token_result.expires_in))))+((Get-date).Hour) minute = $minute }</code> </pre><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рджреЗрдЦрд╛ рд╣реЛрдЧрд╛, рдЬрдм рдПрдХ рдЯреЛрдХрди рд▓рд╛рддреЗ рд╕рдордп, Invoke-WebRequest рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрдирд╡реЛрдХ-рд░реЗрд╕реНрдЯрдореЗрдереЛрдб рдХреЗ рд╡рд┐рдкрд░реАрдд, рдпрд╣ рдкреНрд░рд╛рдкреНрдд рдбреЗрдЯрд╛ рдХреЛ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдиреБрд░реЛрдз рдХреА рд╕реНрдерд┐рддрд┐ рджрд┐рдЦрд╛рддрд╛ рд╣реИред <br><br>  рдЗрд╕рдХреЗ рдмрд╛рдж, рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЖрдкрдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдИрдореЗрд▓ рдХреЗ рдкрд╣рд▓реЗ рдФрд░ рдЕрдВрддрд┐рдо рдирд╛рдо рдХреЛ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдЧреА, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо + рдИрдореЗрд▓ рдмрди рдЬрд╛рдПрдЧрд╛ред <br><br><h3>  <font color="#5D8DDF">рдЕрдиреБрд░реЛрдз</font> </h3><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рд╣реЛрдВрдЧреЗ - рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕ рддрд░рд╣ рдХреЗ рд▓реЙрдЧрд┐рди рдХреЗ рд╕рд╛рде рдореМрдЬреВрдж рд╣реИ рддрд╛рдХрд┐ рдПрдХ рдирдпрд╛ рдмрдирд╛рдиреЗ рдпрд╛ рд╡рд░реНрддрдорд╛рди рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдкрд░ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред <br><br>  рдореИрдВрдиреЗ рд╕реНрд╡рд┐рдЪ рдХреЗ рдЙрдкрдпреЛрдЧ рд╕реЗ рдЪрдпрди рдХреЗ рд╕рд╛рде рдПрдХрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛: <br><br><pre> <code class="cs hljs">function GoogleQuery { param ( $type, $query ) <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($type) { <span class="hljs-string"><span class="hljs-string">"SearchAccount"</span></span> { Return Invoke-RestMethod -Method Get -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body @{ domain = <span class="hljs-string"><span class="hljs-string">'rocketguys.com'</span></span> query = <span class="hljs-string"><span class="hljs-string">"email:$query"</span></span> } } <span class="hljs-string"><span class="hljs-string">"UpdateAccount"</span></span> { $body = @{ name = @{ givenName = $query[<span class="hljs-string"><span class="hljs-string">'givenName'</span></span>] familyName = $query[<span class="hljs-string"><span class="hljs-string">'familyName'</span></span>] } suspended = <span class="hljs-string"><span class="hljs-string">'false'</span></span> password = $query[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] changePasswordAtNextLogin = <span class="hljs-string"><span class="hljs-string">'true'</span></span> phones = @(@{ primary = <span class="hljs-string"><span class="hljs-string">'true'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = $query[<span class="hljs-string"><span class="hljs-string">'phone'</span></span>] type = <span class="hljs-string"><span class="hljs-string">"mobile"</span></span> }) orgUnitPath = $query[<span class="hljs-string"><span class="hljs-string">'orgunit'</span></span>] } Return Invoke-RestMethod -Method Put -Uri (<span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users/"</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>]) -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-string"><span class="hljs-string">"CreateAccount"</span></span> { $body = @{ primaryEmail = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] name = @{ givenName = $query[<span class="hljs-string"><span class="hljs-string">'givenName'</span></span>] familyName = $query[<span class="hljs-string"><span class="hljs-string">'familyName'</span></span>] } suspended = <span class="hljs-string"><span class="hljs-string">'false'</span></span> password = $query[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] changePasswordAtNextLogin = <span class="hljs-string"><span class="hljs-string">'true'</span></span> phones = @(@{ primary = <span class="hljs-string"><span class="hljs-string">'true'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = $query[<span class="hljs-string"><span class="hljs-string">'phone'</span></span>] type = <span class="hljs-string"><span class="hljs-string">"mobile"</span></span> }) orgUnitPath = $query[<span class="hljs-string"><span class="hljs-string">'orgunit'</span></span>] } Return Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/users"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-string"><span class="hljs-string">"AddMember"</span></span> { $body = @{ userKey = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] } $ifrequest = Invoke-RestMethod -Method Get -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/groups"</span></span> -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body $body $array = @() <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $ifrequest.groups) {$array += $<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>.email} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($array -notcontains $query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]) { $body = @{ email = $query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>] role = <span class="hljs-string"><span class="hljs-string">"MEMBER"</span></span> } Return Invoke-RestMethod -Method Post -Uri (<span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/admin/directory/v1/groups/"</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]+<span class="hljs-string"><span class="hljs-string">"/members"</span></span>) -Headers @{Authorization = <span class="hljs-string"><span class="hljs-string">"Bearer "</span></span>+(Get-GoogleToken)} -Body (ConvertTo-Json $body) -ContentType <span class="hljs-string"><span class="hljs-string">'application/json; charset=utf-8'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Return ($query[<span class="hljs-string"><span class="hljs-string">'email'</span></span>]+<span class="hljs-string"><span class="hljs-string">" now is a member of "</span></span>+$query[<span class="hljs-string"><span class="hljs-string">'groupkey'</span></span>]) } } } }</code> </pre> <br>  рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ, рдЖрдкрдХреЛ рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╡рд╛рд▓реЗ рдПрдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╡рд░реНрддрдорд╛рди рдореЗрдВ, рдЯреЛрдХрди рдкреНрд░рдХрд╛рд░ рд╣рдореЗрд╢рд╛ рдмрд┐рдпрд░рд░ рд╣реИред  рдХреНрдпреЛрдВрдХрд┐  рд╣рдореЗрдВ рдпрд╣ рдЬрд╛рдБрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдЯреЛрдХрди рдХреА рд╕рдордп-рд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реБрдИ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЬрд╛рд░реА рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдПрдХ рдШрдВрдЯреЗ рдХреЗ рдмрд╛рдж рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ, рдореИрдВрдиреЗ рдПрдХ рдЕрдиреНрдп рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЬреЛ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд▓реМрдЯрд╛рддрд╛ рд╣реИред  рдкрд╣рд▓реА рдкрд╣реБрдВрдЪ рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдХреЛрдб рдХрд╛ рдПрдХ рд╣реА рдЯреБрдХрдбрд╝рд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs">function Get-GoogleToken { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((Get-date).Hour -gt $token_expire.hour) -or (((Get-date).Hour -ge $token_expire.hour) -and ((Get-date).Minute -gt $token_expire.minute))) { Write-Host <span class="hljs-string"><span class="hljs-string">"Token Expired. Refreshing..."</span></span> $request = (Invoke-RestMethod -Method Post -Uri <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/oauth2/v4/token"</span></span> -ContentType <span class="hljs-string"><span class="hljs-string">'application/x-www-form-urlencoded'</span></span> -Body @{ client_id = $client_id client_secret = $client_secret refresh_token = $refresh_token grant_type = <span class="hljs-string"><span class="hljs-string">'refresh_token'</span></span> }) $token = $request.access_token $minute = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:mm}"</span></span> -f ([timespan]::fromseconds($request.expires_in))))+((Get-date).Minute)<span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($minute -lt <span class="hljs-number"><span class="hljs-number">0</span></span>) {$minute += <span class="hljs-number"><span class="hljs-number">60</span></span>} elseif ($minute -gt <span class="hljs-number"><span class="hljs-number">59</span></span>) {$minute -=<span class="hljs-number"><span class="hljs-number">60</span></span>} $script:token_expire = @{ hour = ([<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>](<span class="hljs-string"><span class="hljs-string">"{0:hh}"</span></span> -f ([timespan]::fromseconds($request.expires_in))))+((Get-date).Hour) minute = $minute } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $token }</code> </pre> <br>  рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рд▓рд┐рдП рд▓реЙрдЧрд┐рди рдХреА рдЬрд╛рдБрдЪ: <br><br><pre> <code class="cs hljs">function Check_Google { $query = (GoogleQuery <span class="hljs-string"><span class="hljs-string">'SearchAccount'</span></span> $username) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($query.users -ne $<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { $user = $query.users[<span class="hljs-number"><span class="hljs-number">0</span></span>] Write-Host $user.name.fullName<span class="hljs-string"><span class="hljs-string">' - '</span></span>$user.PrimaryEmail<span class="hljs-string"><span class="hljs-string">' - suspended: '</span></span>$user.Suspended $GAresult = $user } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($GAresult) { $<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> = $GAresult } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {$<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> = <span class="hljs-string"><span class="hljs-string">'gg'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> }</code> </pre> <br>  рдИрдореЗрд▓ рдЕрдиреБрд░реЛрдз: $ рдХреНрд╡реЗрд░реА рдПрдкреАрдЖрдИ рдХреЛ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдЧреА, рдЬрд┐рд╕рдореЗрдВ рдИрдореЗрд▓ рд╕рд╣рд┐рдд рдЙрдкрдирд╛рдо рдкрд╛рдП рдЬрд╛рдПрдВрдЧреЗред  рдЖрдк рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <i>=,:,: {PREFIX} *</i> ред <br><br>  рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, GET рдЕрдиреБрд░реЛрдз рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдбреЗрдЯрд╛ рдбрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП (рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдПрдВ рдпрд╛ рдХрд┐рд╕реА рд╕рдореВрд╣ рдореЗрдВ рдПрдХ рд╕рджрд╕реНрдп рдЬреЛрдбрд╝реЗрдВ) - POST, рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП - PUT, рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рдореВрд╣ рд╕реЗ рдПрдХ рдкреНрд░рддрд┐рднрд╛рдЧреА) - DELEEред <br><br>  рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ рдлреЛрди рдирдВрдмрд░ (рдПрдХ рдЕрдорд╛рдиреНрдп рд╕реНрдЯреНрд░рд┐рдВрдЧ) рдФрд░ рдПрдХ рдХреНрд╖реЗрддреНрд░реАрдп рд╡рд┐рддрд░рдг рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд╣реЗрдЧреАред  рдпрд╣ рддрдп рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕ рд╕рдВрдЧрдарди рдХреА рдЗрдХрд╛рдИ рдХреЛ рдЪрдпрдирд┐рдд рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ OU рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдЖрдПрдЧрд╛: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $phone = Read-Host <span class="hljs-string"><span class="hljs-string">"   +7"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (-not $phone) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { $moscow = Read-Host <span class="hljs-string"><span class="hljs-string">"  ? (y/n) "</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (-not (($moscow -eq <span class="hljs-string"><span class="hljs-string">'y'</span></span>) -or ($moscow -eq <span class="hljs-string"><span class="hljs-string">'n'</span></span>))) $orgunit = <span class="hljs-string"><span class="hljs-string">'/'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($OU -like <span class="hljs-string"><span class="hljs-string">"*OU=Delivery,OU=Users,OU=ROOT,DC=rocket,DC=local"</span></span>) { Write-host <span class="hljs-string"><span class="hljs-string">"   /Team delivery"</span></span> $orgunit = <span class="hljs-string"><span class="hljs-string">"/Team delivery"</span></span> } $Password = -<span class="hljs-keyword"><span class="hljs-keyword">join</span></span> ( <span class="hljs-number"><span class="hljs-number">48.</span></span><span class="hljs-number"><span class="hljs-number">.57</span></span> + <span class="hljs-number"><span class="hljs-number">65.</span></span><span class="hljs-number"><span class="hljs-number">.90</span></span> + <span class="hljs-number"><span class="hljs-number">97.</span></span><span class="hljs-number"><span class="hljs-number">.122</span></span> | Get-Random -Count <span class="hljs-number"><span class="hljs-number">12</span></span> | % {[<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>]$_})+<span class="hljs-string"><span class="hljs-string">"*Ba"</span></span></code> </pre><br>  рдФрд░ рдлрд┐рд░ рдЦрд╛рддреЗ рдореЗрдВ рд╣реЗрд░рдлреЗрд░ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs">$query = @{ email = $email givenName = $firstname familyName = $lastname password = $password phone = $phone orgunit = $orgunit } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($GMailExist) { Write-Host <span class="hljs-string"><span class="hljs-string">"  "</span></span> -<span class="hljs-function"><span class="hljs-function">f </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mag</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GoogleQuery </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'UpdateAccount'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> $query</span></span></span><span class="hljs-function">) | fl write-host "      $Username  Google." } else</span></span> { Write-Host <span class="hljs-string"><span class="hljs-string">"  "</span></span> -<span class="hljs-function"><span class="hljs-function">f </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mag</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GoogleQuery </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'CreateAccount'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> $query</span></span></span><span class="hljs-function">) | fl } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">$moscow -eq </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"y"</span></span></span></span></span><span class="hljs-function">)</span></span>{ write-host <span class="hljs-string"><span class="hljs-string">"   moscowoffice"</span></span> $query = @{ groupkey = <span class="hljs-string"><span class="hljs-string">'moscowoffice@rocketguys.com'</span></span> email = $email } (GoogleQuery <span class="hljs-string"><span class="hljs-string">'AddMember'</span></span> $query) | fl }</code> </pre><br>  рдХрд┐рд╕реА рдЦрд╛рддреЗ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдФрд░ рдмрдирд╛рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдПрдХ рд╣реА рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рд╣реИ, рд╕рднреА рдЕрддрд┐рд░рд┐рдХреНрдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдлреЛрди рдирдВрдмрд░ рд╡рд╛рд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЖрдкрдХреЛ рдПрдХ рд╕рд░рдгреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдЙрд╕рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд░рд┐рдХреЙрд░реНрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕рдореВрд╣ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╕рдордп рддреНрд░реБрдЯрд┐ рдкреНрд░рд╛рдкреНрдд рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдкрд╣рд▓реЗ рдпрд╣ рдЬрд╛рдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЗрд╕ рд╕рдореВрд╣ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдпрд╛ рд░рдЪрдирд╛ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред <br><br>  <b>рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдореВрд╣реЛрдВ рдХреА рд░рдЪрдирд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдкреБрдирд░рд╛рд╡рд░реНрддреА рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдФрд░ рдХреЗрд╡рд▓ рдкреНрд░рддреНрдпрдХреНрд╖ рд╕рджрд╕реНрдпрддрд╛ рджрд┐рдЦрд╛рдПрдЧрд╛ред</b>  рдореВрд▓ рд╕рдореВрд╣ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢, рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕ рд╕рд╣рд╛рдпрдХ рд╕рдореВрд╣ рдХрд╛ рд╕рджрд╕реНрдп рд╣реИ, рд╡рд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдлрд▓ рд╣реИред <br><br><h3>  <font color="#5D8DDF">рдирд┐рд╖реНрдХрд░реНрд╖</font> </h3><br>  рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирдП рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╣реБрдЖ рд╣реИред  рд╣рдо рдПрд╕рдПрдордПрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬрддреЗ рд╣реИрдВ рдФрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдореЗрд▓ рдкрд░ рд▓реЙрдЧрд┐рди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдлреЛрди рдирдВрдмрд░ рдХреЗ рд╕рд╛рде, рдХрд░реНрдорд┐рдпреЛрдВ рдХреЗ рдЪрдпрди рд╡рд┐рднрд╛рдЧ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдк рдкреИрд╕реЗ рдмрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдЧреБрдкреНрдд рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЪреИрдЯ рдкрд░ рдкрд╛рд╕рд╡рд░реНрдб рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рджреВрд╕рд░рд╛ рдХрд╛рд░рдХ рднреА рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдореИрдХрдмреБрдХ рдПрдХ рдЕрдкрд╡рд╛рдж рд╣реЛрдЧрд╛)ред <br><br>  рдЕрдВрдд рддрдХ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджред  рд▓реЗрдЦреЛрдВ рдХреА рд▓реЗрдЦрди рд╢реИрд▓реА рдореЗрдВ рд╕реБрдзрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕реБрдЭрд╛рд╡ рджреЗрдЦрдХрд░ рдореБрдЭреЗ рдЦреБрд╢реА рд╣реЛрдЧреА рдФрд░ рдореИрдВ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд┐рдЦрддреЗ рд╕рдордп рдЖрдк рдХрдо рдЧрд▓рддрд┐рдпрд╛рдБ рдкрдХрдбрд╝реЗрдВред) <br><br>  рдЙрди рд▓рд┐рдВрдХреНрд╕ рдХреА рд╕реВрдЪреА рдЬреЛ рдЖрдкрдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдЖрдкрдХреЗ рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗ рд╕рдХрддреА рд╣реИрдВ: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">OAuth 2.0 рдореЛрдмрд╛рдЗрд▓ рдФрд░ рдбреЗрд╕реНрдХрдЯреЙрдк рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП OAuth 2.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">OAuth рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЧреНрд░рд╛рд╣рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХреЛрдб рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреЗ рд▓рд┐рдП рд╕рдмреВрдд рдХреБрдВрдЬреА</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PowerShell рдХреЗ рд╕рд╛рде рд░реИрдВрдбрдо рдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ASCII рддрд╛рд▓рд┐рдХрд╛ рдФрд░ рд╡рд┐рд╡рд░рдг</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PowerShell: рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╣реИрд╢ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Encode / Decode Base64Url</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Base64 рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдмрдирд╛рдо Base64url рдПрдиреНрдХреЛрдбрд┐рдВрдЧ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PowerShell 5.1 рдореЗрдВ рдЪрд╛рд▓рд╛рди-рд░реЗрд╕реНрдЯрдореИрдереЛрдб</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдлрд┐рд░ рднреА рддрд╛рдЬрд╝рд╛ рдЯреЛрдХрди рдирд╣реАрдВ рдорд┐рд▓ рд░рд╣рд╛ рд╣реИ, рдЬрдмрдХрд┐ access_type рдЪрд░рдг 1 рдореЗрдВ рдСрдлрд╝рд▓рд╛рдЗрди рд╣реИ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рддреБрд▓рдирд╛ рд╕рдВрдЪрд╛рд▓рдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдПрдкреАрдЖрдИ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдПрдкреАрдЖрдИ: рд╕рдореВрд╣</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдирд╡реЛрдХ-рд░реЗрд╕реНрдЯрдореИрдереЛрдб рдХреЗ рд▓рд┐рдП рддреНрд░реБрдЯрд┐ рд╣реИрдВрдбрд▓рд┐рдВрдЧ - рдкреЙрд╡рд░реНрд╕рд╢реЗрд▓</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi468969/">https://habr.com/ru/post/hi468969/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi468957/index.html">рдЕрд╕реНрдкрд╖реНрдЯреАрдХреГрдд рдХреЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рдЪрдХреНрд░реАрдп рдХрд╛рд▓рдХреЛрдард░реА рдкреАрдврд╝реА</a></li>
<li><a href="../hi468959/index.html">рдУрд▓рд╛ рдкрд░ рдмрд╣реБ-рдореЙрдбреНрдпреВрд▓ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдирд┐рд░реНрднрд░рддрд╛ рдкреНрд░рдмрдВрдзрди</a></li>
<li><a href="../hi468961/index.html">$ 560 рдХреЗ рд▓рд┐рдП рдЬреАрд╡рди рдореЗрдВ рджрд┐рдирдЪрд░реНрдпрд╛ рд╕реЗ рдХреИрд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛рдПрдВ? рдпрд╛ рдХреИрд╕реЗ рдЬреАрдирд╛ рд╣реИ, рдЬреАрдирд╛ рдирд╣реАрдВ</a></li>
<li><a href="../hi468963/index.html">рдмреИрдХрдЕрдк, рдкрд╛рдардХреЛрдВ рдХреЗ рдЕрдиреБрд░реЛрдз рдкрд░ рд╣рд┐рд╕реНрд╕рд╛: UrBackup рдУрд╡рд░рд╡реНрдпреВ, BackupPC, AMANDA</a></li>
<li><a href="../hi468967/index.html">рдЯреАрдПрдпреВ рдХреА рдЧрддрд┐рд╢реАрд▓рддрд╛ рдХреЗ рд╕рдореАрдХрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА "рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА"ред рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдкрд╣рдЪрд╛рди рдХреНрдпреЛрдВ рдмреЗрдХрд╛рд░ рд╣реИ, рдФрд░ "рдИрдорд╛рдирджрд╛рд░ рднреМрддрд┐рдХреА" рдирд┐рдпрдо</a></li>
<li><a href="../hi468971/index.html">рдирд┐рдВрдЯреЗрдВрдбреЛ рдбреАрдПрд╕ рдХреЗ рд▓рд┐рдП рдЬрд╛рд╡рд╛ рдореЗрдВ рд▓реЗрдЦрди</a></li>
<li><a href="../hi468973/index.html">рдкрд╛рдпрдерди рдореЗрдВ рдЯреЗрдиреНрд╕рд░рдлреНрд▓реЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдЧреНрд░рд╣ рдЪрд┐рддреНрд░реЛрдВ рдХреЛ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ</a></li>
<li><a href="../hi468989/index.html">рдпреВрдИрдмреАрдП рдорд╛рд░реНрдХреЗрдЯ рдбреЗрд╕ - рд▓реЙрдиреНрдЧ рд▓рд╛рдЗрд╡ рдпреВрдИрдмреАрдП</a></li>
<li><a href="../hi468991/index.html">рдореЙрдбреНрдпреВрд▓рд░ рд╕реНрдкреНрд░рд╛рдЗрдЯ рдЕрдХреНрд╖рд░ рдФрд░ рдЙрдирдХреЗ рдПрдиреАрдореЗрд╢рди</a></li>
<li><a href="../hi468993/index.html">рдУрдХреБрд▓рд╕ рдХреНрд╡реЗрд╕реНрдЯ рдПрдХ рдкреАрд╕реА рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ рдФрд░ рд╣рд╛рде рджреЗрдЦрддрд╛ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>