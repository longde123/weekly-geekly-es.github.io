<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🎨 🎖️ 📩 Pourquoi la validation régulière des e-mails ne suffit pas. Validation des enregistrements MX avec des exemples en PHP et Ruby 🏀 👊🏿 👨🏼‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Combien de fois ont-ils continué à répéter au monde ... Il y a un long et probablement sans fin débat sur le bon qui est régulier et il est nécessaire...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pourquoi la validation régulière des e-mails ne suffit pas. Validation des enregistrements MX avec des exemples en PHP et Ruby</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434640/">  Combien de fois ont-ils continué à répéter au monde ... Il y a un long et probablement sans fin débat sur le bon qui est régulier et il est nécessaire de vérifier le champ de messagerie de l'utilisateur. <br><br>  Oui, vous devez vraiment vérifier la saison régulière.  Mais nos produits sont en ligne.  Alors pourquoi ne pas utiliser son vrai pouvoir? <br><a name="habracut"></a><br>  De plus, il y a souvent des situations où les utilisateurs se trompent vraiment lors de la saisie d'une adresse e-mail (y compris dans un domaine).  Eh bien, ou, dans le champ e-mail, entrez n'importe quel "Habrakadabra" possible, qui vole facilement via regexp, mais ne peut pas être du courrier, car même ce domaine n'existe pas dans la nature :) <br><br>  Soit dit en passant, sur cette nuance, nous avons littéralement juste volé vers le haut: l'essentiel est que pour une raison quelconque, sur le site soulevé sur un CMS-ke plutôt populaire, les notifications par courrier électronique se sont déclenchées. <br><br>  Il s'est avéré que la raison en était l'adresse du spammeur. <br><br>  Il y avait plusieurs raisons: <br><br><ol><li> Le CMS est assez populaire et, par conséquent, il y a beaucoup de spammeurs enregistrés.  Et ce qui est plus intéressant - dans les paramètres, vous pouvez (et beaucoup le font d'ailleurs) - désactiver la vérification des e-mails.  Dans ce cas, vous pouvez (et c'est ce que font la plupart des bots) ici pour entrer n'importe quel déchet </li><li>  Les textes des lettres n'ont pas été réécrits à partir des lettres standard. </li></ol><br>  Total: les spammeurs ont massivement grimpé pour s'inscrire, ont jeté des e-mails à gauche sur le script, où nous avons essayé d'envoyer des lettres.  Le filtre anti-spam a vu qu'un certain nombre d'e-mails provenaient de notre e-mail, avec des textes qu'il avait déjà vus à plusieurs reprises depuis d'autres adresses e-mail, et en même temps un nombre considérable d'entre eux tombaient sur des adresses e-mail inexistantes. <br><br>  En général, l'adresse postale tombait périodiquement sous le spam. <br><br>  Par conséquent, l'expérience, respectivement, peut et doit être argumentée que la vérification de la disponibilité d'un domaine sur Internet, ainsi que la présence d'un service de messagerie (enregistrements MX pour un domaine), est ce qui, en théorie, devrait exister et fonctionner dans les systèmes d'enregistrement des utilisateurs. <br><br>  En fait, l'essence de la vérification est assez simple: lors de l'enregistrement, au stade de la validation des données utilisateur, nous séparons le domaine de la messagerie et voyons ce qu'il y a sur les MX. <br><br>  Est-ce difficile?  Pas vraiment.  Mais cela peut réduire considérablement la charge des services postaux.  Et soit dit en passant, il est beaucoup moins susceptible d'entrer dans les listes de spam (après tout, l'envoi d'un grand nombre de lettres à des adresses e-mail inexistantes est l'un des signes du spam). <br><br>  En PHP, curieusement, c'est assez simple: <br><br><pre><code class="php hljs">$email =<span class="hljs-string"><span class="hljs-string">"11@sdlkfjsdl.co.uk"</span></span>; $domain = substr(strrchr($email, <span class="hljs-string"><span class="hljs-string">"@"</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>); $res = getmxrr($domain, $mx_records, $mx_weight); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> == $res || <span class="hljs-number"><span class="hljs-number">0</span></span> == count($mx_records) || (<span class="hljs-number"><span class="hljs-number">1</span></span> == count($mx_records) &amp;&amp; ($mx_records[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || $mx_records[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">"0.0.0.0"</span></span> ) ) ){ <span class="hljs-comment"><span class="hljs-comment">//   -  mx-   echo "No MX for domain: $domain"; }else{ // ,  MX-   ,      echo "It seems that we have qualify MX-records for domain: $domain"; }</span></span></code> </pre> <br>  J'expliquerai le plutôt «monstrueux» si.  Le fait est que dans la documentation de la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">getmxrr</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">il y</a> avait des commentaires avec des références à son comportement qui n'étaient pas entièrement corrects.  Et bien que je ne puisse pas les trouver sur php7.1 - une vérification supplémentaire n'est pas une vérification supplémentaire :) <br><br>  Sur rubis, cela se fait de manière similaire: <br><br><pre> <code class="ruby hljs">domain = invite.email.split(<span class="hljs-string"><span class="hljs-string">'@'</span></span>).last.mb_chars.downcase.to_s.force_encoding(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>) <span class="hljs-comment"><span class="hljs-comment"># ,   .         UTF-8,     mail_servers = Resolv::DNS.open.getresources(domain, Resolv::DNS::Resource::IN::MX) if mail_servers.empty? # MX-.       false else true end</span></span></code> </pre> <br>  Dans le même temps, je précise qu'une telle vérification du champ e-mail peut non seulement sérieusement affecter la qualité des informations dans la base de données de votre projet (et réduire le risque d'envoi de notifications par les spammeurs), mais également entraîner une diminution des charges de travail.  Après tout, l'envoi de lettres à partir d'un script est un processus assez lent dans la pratique. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr434640/">https://habr.com/ru/post/fr434640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr434626/index.html">Nouveau téléchargeur Buhtrap</a></li>
<li><a href="../fr434628/index.html">bitContainer (pour la nourriture) - Yandex.Station fait maison</a></li>
<li><a href="../fr434634/index.html">Universal Radio Hacker - Un moyen facile d'explorer les protocoles radio numériques</a></li>
<li><a href="../fr434636/index.html">Comment exploiter les enfants</a></li>
<li><a href="../fr434638/index.html">Lancement d'une fusée de l'Est de vos propres yeux</a></li>
<li><a href="../fr434642/index.html">PornHub en remplacement de VK</a></li>
<li><a href="../fr434644/index.html">Kit de mise à pied</a></li>
<li><a href="../fr434646/index.html">Capteur médical sans fil portable (ouvert) pour prototypes d'IBM Research</a></li>
<li><a href="../fr434648/index.html">Notes en anglais # 1: terminez par ce "très"</a></li>
<li><a href="../fr434650/index.html">Maintenant officiellement. Pour l'extrémisme sur Internet, la responsabilité pénale est abolie (pour la première fois)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>