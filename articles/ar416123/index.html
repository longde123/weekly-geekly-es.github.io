<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คด๐ป ๐ฝ ๐คฑ๐ป ุงูุชุนุฑู ุนูู ุงูุจุถุงุฆุน ุนูู ุงูุฑููู ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุงุณุชุฎุฏุงู ุชูููุงุช Keras ู Tensorflow Object Detection API ๐ค๏ธ ๐พ ๐ฉ๐ฟโ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูููุงูุฉ ุณูู ูุชุญุฏุซ ุนู ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูุญู ูููุฉ ุนูู ุนูููุฉ ูุงุณุชุนุงุฏุฉ ุฑุณู ุจูุงูู ุญูููู ูู ุตูุฑ ุงูุฑููู ูุน ุงูุจุถุงุฆุน. ุจุงุณุชุฎุฏุงู Tensorflow O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชุนุฑู ุนูู ุงูุจุถุงุฆุน ุนูู ุงูุฑููู ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุงุณุชุฎุฏุงู ุชูููุงุช Keras ู Tensorflow Object Detection API</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/416123/" style=";text-align:right;direction:rtl">  ูู ุงูููุงูุฉ ุณูู ูุชุญุฏุซ ุนู ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูุญู ูููุฉ ุนูู ุนูููุฉ ูุงุณุชุนุงุฏุฉ ุฑุณู ุจูุงูู ุญูููู ูู ุตูุฑ ุงูุฑููู ูุน ุงูุจุถุงุฆุน.  ุจุงุณุชุฎุฏุงู Tensorflow Object Detection API ุ ุณูููู ุจุชุฏุฑูุจ ูููุฐุฌ ุงูุจุญุซ / ุงูุชูุทูู.  ุณูุญุณู ุฌูุฏุฉ ุงูุจุญุซ ุนู ุงูููุชุฌุงุช ุงูุตุบูุฑุฉ ูู ุตูุฑ ุนุงููุฉ ุงูุฏูุฉ ุจุงุณุชุฎุฏุงู ูุงูุฐุฉ ุนุงุฆูุฉ ูุฎูุงุฑุฒููุฉ ูุจุญ ุบูุฑ ูุตูู.  ูู Keras ุ ูููู ุจุชูููุฐ ูุตูู ููุณูุน ุญุณุจ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ.  ูุจุงูุชูุงุฒู ุ ุณูููู ุจููุงุฑูุฉ ุงูููุงุฑุจุงุช ูุงููุชุงุฆุฌ ุจุงููุฑุงุฑุงุช ุงูุชู ุงุชุฎุฐุช ููุฐ 4 ุณููุงุช.  ุฌููุน ุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ ูู ุงูููุงูุฉ ูุชุงุญุฉ ููุชูุฒูู ุ ูุฑูุฒ ุงูุนูู ุงููุงูู ููุฌูุฏ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GitHub</a> ููู ูุตูู ูุจุฑูุงูุฌ ุชุนูููู. <br><br><img src="https://habrastorage.org/webt/aw/27/ar/aw27argaeseqsgos5cbpwdwt89s.jpeg"><br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h3><br>  ูุง ูู ุงููุฎุทุทุ  ุฑุณู ุชุฎุทูุทู ูุนุฑุถ ุงูุจุถุงุฆุน ุนูู ูุนุฏุงุช ุงูุชุฏุงูู ุงูุฎุฑุณุงููุฉ ูู ุงููุชุฌุฑ. <br><br>  ูุง ูู ุฑูููุฌุฑุงูุ  ุชุฎุทูุท ุงูุจุถุงุฆุน ุนูู ูุนุฏุงุช ุชุฏุงูู ูุญุฏุฏุฉ ููุฌูุฏุฉ ูู ุงููุชุฌุฑ ููุง ูุงูุขู. <br><br>  Planogram - ููุง ูุฌุจ ุ realogram - ูุง ูุฏููุง. <br><br><img src="https://habrastorage.org/webt/ym/oo/ew/ymooewlirqpaosatarrenno8caw.jpeg"><br><br>  ุญุชู ุงูุขู ุ ูู ุงูุนุฏูุฏ ูู ุงููุชุงุฌุฑ ุ ูุฅู ุฅุฏุงุฑุฉ ุจููุฉ ุงูุจุถุงุฆุน ุนูู ุงูุฑููู ูุงูุฑููู ูุงูุนุฏุงุฏุงุช ูุงูุฑููู ูู ุนูู ูุฏูู ุญุตุฑู.  ูููู ุงูุขูุงู ูู ุงูููุธููู ุจุงูุชุญูู ูู ุชููุฑ ุงูููุชุฌุงุช ูุฏูููุง ุ ูุญุณุงุจ ุงูุฑุตูุฏ ุ ูุงูุชุญูู ูู ุงููููุน ุจุงููุชุทูุจุงุช.  ุฅููุง ุจุงูุธุฉ ุงูุซูู ุ ูุงูุฃุฎุทุงุก ูุญุชููุฉ ุฌุฏูุง.  ุนุฑุถ ุบูุฑ ุตุญูุญ ุฃู ููุต ูู ุงูุณูุน ูุคุฏู ุฅูู ุงูุฎูุงุถ ุงููุจูุนุงุช. <br><br>  ุฃูุถุง ุ ูุฏุฎู ุงูุนุฏูุฏ ูู ุงูุดุฑูุงุช ุงููุตูุนุฉ ูู ุงุชูุงููุงุช ูุน ุชุฌุงุฑ ุงูุชุฌุฒุฆุฉ ูุนุฑุถ ุณูุนูู.  ูุจูุง ุฃู ููุงู ุงููุซูุฑ ูู ุงูุดุฑูุงุช ุงููุตูุนุฉ ุ ูููุง ุจูููุง ูุจุฏุฃ ุงููุถุงู ูู ุฃุฌู ุฃูุถู ููุงู ุนูู ุงูุฑู.  ูุฑูุฏ ุงูุฌููุน ุฃู ูููู ููุชุฌู ูู ุงููุฑูุฒ ุฃูุงู ุฃุนูู ุงููุดุชุฑู ููุญุชู ุฃูุจุฑ ูุณุงุญุฉ ููููุฉ.  ููุงู ุญุงุฌุฉ ููุชุฏููู ุงููุณุชูุฑ. <br><br>  ููุชูู ุงูุขูุงู ูู ุงูุชุฌุงุฑ ูู ูุชุฌุฑ ุฅูู ุขุฎุฑ ููุชุฃูุฏ ูู ุฃู ููุชุฌุงุช ุดุฑูุชูู ุนูู ุงูุฑู ูุนุฑุถูุง ููููุง ููุนูุฏ.  ูู ุจุนุถ ุงูุฃุญูุงู ูููููู ูุณุงูู: ูู ุงููุทูู ุชุฌููุน ุชูุฑูุฑ ุฏูู ูุบุงุฏุฑุฉ ููุฒูู ูู ุงูุฐูุงุจ ุฅูู ููุทุฉ ุจูุน.  ููุงู ุญุงุฌุฉ ูุชุฏููู ุฏุงุฆู ููุฑุงุฌุนู ุงูุญุณุงุจุงุช. <br><br>  ูุจุทุจูุนุฉ ุงูุญุงู ุ ุชู ุญู ูููุฉ ุงูุฃุชูุชุฉ ูุชุจุณูุท ูุฐู ุงูุนูููุฉ ููุชุฑุฉ ุทูููุฉ.  ูุงูุช ูุนุงูุฌุฉ ุงูุตูุฑ ูู ุฃุตุนุจ ุงูุฃุฌุฒุงุก: ุงูุนุซูุฑ ุนูู ุงูููุชุฌุงุช ูุงูุชุนุฑู ุนูููุง.  ููู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ูุณุจููุง ููุท ุชู ุชุจุณูุท ูุฐู ุงููููุฉ ูุฏุฑุฌุฉ ุฃูู ุจุงููุณุจุฉ ูุญุงูุฉ ูุนููุฉ ูู ุดูู ูุจุณุท ุ ูููู ูุตู ุญููุง ุงููุงูู ูู ููุงูุฉ ูุงุญุฏุฉ.  ูุฐุง ูุง ุณููุนูู. <br><br>  ุชุญุชูู ุงูููุงูุฉ ุนูู ุญุฏ ุฃุฏูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ (ููุท ููุญุงูุงุช ุงูุชู ูููู ูููุง ุงูุฑูุฒ ุฃูุซุฑ ูุถูุญูุง ูู ุงููุต).  ุงูุญู ุงููุงูู ูุชุงุญ ูุจุฑูุงูุฌ ุชุนูููู ูุตูุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏูุงุชุฑ ุงูููุงุญุธุงุช jupyter</a> .  ูุง ุชุญุชูู ุงูููุงูุฉ ุนูู ูุตู ูุจููุฉ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุ ููุจุงุฏุฆ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ุ ูุงูุตูุบ ุงูุฑูุงุถูุฉ.  ูู ุงูููุงูุฉ ุ ูุณุชุฎุฏููุง ูุฃุฏุงุฉ ููุฏุณูุฉ ุ ุฏูู ุงูุฎูุถ ูู ุชูุงุตูู ุฌูุงุฒูุง. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุจูุงูุงุช ูุงูููุฌ </h3><br>  ููุง ูู ุงูุญุงู ูุน ุฃู ููุฌ ูุงุฆู ุนูู ุงูุจูุงูุงุช ุ ุชุชุทูุจ ุญููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจูุงูุงุช.  ููููู ุฃูุถูุง ุชุฌููุนูุง ูุฏูููุง: ูุงูุชูุงุท ุนุฏุฉ ูุฆุงุช ูู ุงูุนุฏุงุฏุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุฑููุฒูุง</a> ุจุงุณุชุฎุฏุงู ุ ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LabelImg</a> .  ููููู ุทูุจ ุงูุชุฑููุฒ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูู Yandex.Tolok. <br><br><img src="https://habrastorage.org/webt/ji/he/lv/jihelvxh9vkmixjzsxink1nknya.jpeg"><br><br>  ูุง ูููููุง ุงููุดู ุนู ุชูุงุตูู ูุดุฑูุน ุญูููู ุ ูุฐูู ุณูุดุฑุญ ุงูุชูููููุฌูุง ุนูู ุงูุจูุงูุงุช ุงูููุชูุญุฉ.  ูุงู ุงูุชุณูู ูุงูุชูุงุท ุงูุตูุฑ ูุณูููุง ุฌุฏูุง (ููู ููู ููููู ุฐูู ููุงู) ุ ูุงูุชูุช ุงูุฑุบุจุฉ ูู ุนูู ุชุฑููุฒ ููุตูุฑ ุงูููุฌูุฏุฉ ุนูู ุงูุฅูุชุฑูุช ุจููุฑุฏูุง ุจุนุฏ ุงููุงุฆู ุงููุตูู ุงููุงุฆุฉ.  ูุญุณู ุงูุญุธ ุ ุตุงุฏูุช ุฃุฑุดูู ุฃุฑุดูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฌููุนุฉ ุจูุงูุงุช ุงูุจูุงูุฉ</a> . <br><br>  ูู ุนุงู 2014 ุ ูุงู ููุธูู Idea Teknoloji ุ ุงุณุทูุจูู ุ ุชุฑููุง ุจุชุญููู 354 ุตูุฑุฉ ูู 40 ูุชุฌุฑูุง ุชู ุชุตููุนูุง ุนูู 4 ูุงููุฑุงุช.  ูู ูู ูู ูุฐู ุงูุตูุฑ ุ ุณูุทูุง ุงูุถูุก ุจุงููุณุชุทููุงุช ุนูู ุนุฏุฉ ุขูุงู ูู ุงูุฃุดูุงุก ุ ุชู ุชุตููู ุจุนุถูุง ุฅูู 10 ูุฆุงุช. <br><br>  ูุฐู ุตูุฑ ุนูุจ ุณุฌุงุฆุฑ.  ูุญู ูุง ูุดุฌุน ุฃู ูุดุฌุน ุนูู ุงูุชุฏุฎูู.  ุจุจุณุงุทุฉ ูู ููู ููุงู ุดูุก ุฃูุซุฑ ุญูุงุฏูุฉ.  ููุนุฏ ุจุฃููุง ูู ูู ููุงู ูู ุงูููุงูุฉ ุ ุญูุซ ูุณูุญ ุงููุถุน ุ ุณูู ูุณุชุฎุฏู ุตูุฑ ุงููุทุท. <br><br><img src="https://habrastorage.org/webt/04/8x/ek/048xekrylrnspiwd7vefbux_kgu.jpeg"><br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุงูุตูุฑ ุฐุงุช ุงูุนูุงูุงุช ูู ุงูุฑููู ุ ูุชุจูุง ููุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญู ุงูุชุนุฑู ุนูู ููุชุฌุงุช ุงูุชุฌุฒุฆุฉ ุนูู ุฑููู ุงูุจูุงูุฉ</a> ูุน ุญู ููุดููุฉ ุงูุชูุทูู ูุงูุชุตููู.  ูุฐุง ูุญุฏุฏ ููุนูุง ูู ุงูููุทุฉ ุงููุฑุฌุนูุฉ: ูุฌุจ ุฃู ูููู ุญููุง ุจุงุณุชุฎุฏุงู ุงูุฃุณุงููุจ ุงูุฌุฏูุฏุฉ ุฃุจุณุท ูุฃูุซุฑ ุฏูุฉ ุ ูุฅูุง ูุฅูู ููุณ ูุซูุฑูุง ููุงูุชูุงู.  ูุชููู ููุฌูู ูู ูุฌููุนุฉ ูู ุงูุฎูุงุฑุฒููุงุช: <br><br><img src="https://habrastorage.org/webt/j5/p4/t_/j5p4t_ul9ungv_luvlzxa5aa1gi.jpeg"><br><br>  ูู ุงูุขููุฉ ุงูุฃุฎูุฑุฉ ุ ุฃุญุฏุซุช ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ (CNN) ุซูุฑุฉ ูู ูุฌุงู ุฑุคูุฉ ุงูููุจููุชุฑ ูุบูุฑุช ุชูุงููุง ููุฌ ุญู ูุฐู ุงููุดุงูู.  ุนูู ูุฏู ุงูุณููุงุช ุงูููููุฉ ุงููุงุถูุฉ ุ ุฃุตุจุญุช ูุฐู ุงูุชูููุงุช ูุชุงุญุฉ ููุฌููุนุฉ ูุงุณุนุฉ ูู ุงููุทูุฑูู ุ ููุฏ ุฎูุถุช ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุนุงููุฉ ุงููุณุชูู ูุซู Keras ุญุฏ ุฏุฎูููุง ุจุดูู ููุญูุธ.  ุงูุขู ุ ูููู ูุฃู ูุทูุฑ ุชูุฑูุจูุง ุงุณุชุฎุฏุงู ุงูููุฉ ุงููุงููุฉ ููุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุจุนุฏ ุจุถุนุฉ ุฃูุงู ููุท ูู ุงูููุงุนุฏุฉ.  ุชุตู ุงูููุงูุฉ ุงุณุชุฎุฏุงู ูุฐู ุงูุชูููุงุช ุจุงุณุชุฎุฏุงู ูุซุงู ููุถุญ ููู ูููู ุจุณูููุฉ ุงุณุชุจุฏุงู ุณูุณูุฉ ูุงููุฉ ูู ุงูุฎูุงุฑุฒููุงุช ุจุดุจูุชูู ุนุตุจูุชูู ููุท ุฏูู ููุฏุงู ุงูุฏูุฉ. <br><br>  ุณูุญู ุงููุดููุฉ ูู ุฎุทูุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุงูุจูุงูุงุช.  ูููู ุจุถุฎ ุงููุญููุธุงุช ูุชุญููููุง ุฅูู ุนุฑุถ ููุงุฆู ููุนูู. </li><li style=";text-align:right;direction:rtl">  ุชุตููู ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ.  ูููู ุจุญู ูุดููุฉ ุงูุชุตููู ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุนุตุจูุฉ. </li><li style=";text-align:right;direction:rtl">  ุงุจุญุซ ุนู ุงูููุชุฌุงุช ูู ุงูุตูุฑุฉ.  ูุฏุฑุจ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ููุจุญุซ ุนู ุงูุณูุน. </li><li style=";text-align:right;direction:rtl">  ุชูููุฐ ุงูุจุญุซ.  ุณูุญุณู ุฌูุฏุฉ ุงููุดู ุจุงุณุชุฎุฏุงู ูุงูุฐุฉ ุนุงุฆูุฉ ูุฎูุงุฑุฒููุฉ ูููุน ุบูุฑ ุงูุญุฏ ุงูุฃูุตู. </li><li style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ  ุงุดุฑุญ ุจุงุฎุชุตุงุฑ ููุงุฐุง ุงูุญูุงุฉ ุงููุงูุนูุฉ ุฃูุซุฑ ุชุนููุฏูุง ูู ูุฐุง ุงููุซุงู. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ุงูุชูููููุฌูุง </h3><br>  ุงูุชูููุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ุณูุณุชุฎุฏููุง: Tensorflowุ Kerasุ Tensorflow Object Detection APIุ OpenCV.  ุนูู ุงูุฑุบู ูู ุฃู ูู ูู Windows ู Mac OS ููุงุณุจุงู ููุนูู ูุน Tensorflow ุ ูุง ุฒููุง ููุตู ุจุงุณุชุฎุฏุงู Ubuntu.  ุญุชู ุฅุฐุง ูู ุชูู ูุฏ ุนููุช ูุน ูุธุงู ุงูุชุดุบูู ูุฐุง ูู ูุจู ุ ูุฅู ุงุณุชุฎุฏุงูู ุณูููุฑ ูู ุงููุซูุฑ ูู ุงูููุช.  ุชุซุจูุช Tensorflow ููุนูู ูุน GPU ูู ููุถูุน ูุณุชุญู ููุงูุฉ ูููุตูุฉ.  ูุญุณู ุงูุญุธ ุ ุชูุฌุฏ ูุซู ูุฐู ุงูููุงูุงุช ุจุงููุนู.  ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุซุจูุช TensorFlow ุนูู Ubuntu 16.04 ุจุงุณุชุฎุฏุงู Nvidia GPU</a> .  ูุฏ ุชููู ุจุนุถ ุงูุชุนูููุงุช ููู ูุฏููุฉ. <br><br>  <b>ุงูุฎุทูุฉ 1. ุชุฌููุฒ ุงูุจูุงูุงุช ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุจุท ุฌูุซุจ</a> )</b> <br><br>  ุชุณุชุบุฑู ูุฐู ุงูุฎุทูุฉ ุ ููุงุนุฏุฉ ุ ููุชูุง ุฃุทูู ุจูุซูุฑ ูู ุงููุญุงูุงุฉ ููุณูุง.  ูุญุณู ุงูุญุธ ุ ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุฌุงูุฒุฉ ุ ุงูุชู ูููู ุจุชุญููููุง ุฅูู ุงูุดูู ุงูุฐู ูุญุชุงุฌู. <br><br>  ููููู ุชูุฒูู ููู ุงูุถุบุท ุจูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">wget https://github.com/gulvarol/grocerydataset/releases/download/1.0/GroceryDataset_part1.tar.gz wget https://github.com/gulvarol/grocerydataset/releases/download/1.0/GroceryDataset_part2.tar.gz tar -xvzf GroceryDataset_part1.tar.gz tar -xvzf GroceryDataset_part2.tar.gz</code> </pre> <br>  ูุญุตู ุนูู ูููู ุงููุฌูุฏ ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/n1/yi/8n/n1yi8n3faxzmxia70bxsee-b69u.jpeg"><br><br>  ุณูุณุชุฎุฏู ูุนูููุงุช ูู ุฏูุงุฆู ShelfImages ู ProductImagesFromShelves. <br>  ูุญุชูู ShelfImages ุนูู ุตูุฑ ููุฃุฑูู ููุณูุง.  ูู ุงูุงุณู ุ ูุชู ุชุฑููุฒ ูุนุฑู ุงูุญุงูู ูุน ูุนุฑู ุงูุตูุฑุฉ.  ูููู ุฃู ูููู ููุงู ุนุฏุฉ ุตูุฑ ูุญุงูู ูุงุญุฏ.  ุนูู ุณุจูู ุงููุซุงู ุ ุตูุฑุฉ ูุงุญุฏุฉ ูุงููุฉ ูุฎูุณ ุตูุฑ ูู ุฃุฌุฒุงุก ุจูุง ุชูุงุทุนุงุช. <br><br>  ููู C1_P01_N1_S2_2.JPG (ุงูุญุงูู C1_P01 ุ ููุทุฉ N1_S2_2): <br><br><img src="https://habrastorage.org/webt/nv/jd/or/nvjdorlqwj1qc7asuzktk7dqccs.jpeg"><br><br>  ูุฑุงุฌุน ุฌููุน ุงููููุงุช ููุฌูุน ุงููุนูููุงุช ูู ุฅุทุงุฑ ุจูุงูุงุช ุงูุจุงูุฏุง photos_df: <br><br><img src="https://habrastorage.org/webt/us/zq/zq/uszqzqw3haortnmdvscxp0sq1cq.png"><br>  ProductImagesFromShelves ูุญุชูู ุนูู ุตูุฑ ููุทูุนุฉ ููุณูุน ูู ุงูุฑููู ูู 11 ุฏูููุงู ูุฑุนููุง: 0 - ุบูุฑ ูุตููุฉ ุ 1 - ูุงุฑูุจูุฑู ุ 2 - ูููุช ุ ุฅูุฎ.  ููู ูุง ูุนูู ุนููุง ุ ุณูุณุชุฎุฏู ููุท ุฃุฑูุงู ุงููุฆุงุช ุฏูู ุชุญุฏูุฏ ุฃุณูุงุก.  ุชุญุชูู ุงููููุงุช ุงูููุฌูุฏุฉ ูู ุงูุฃุณูุงุก ุนูู ูุนูููุงุช ุญูู ุงูุญุงูู ูููุถุน ูุญุฌู ุงูุนุจูุฉ ุนููู. <br><br>  ููู C1_P01_N1_S3_1.JPG_1276_1828_276_448.png ูู ุงูุฏููู 1 (ุงููุฆุฉ 1 ุ ุงูุญุงูู C1_P01 ุ ุงูุตูุฑุฉ N1_S3_1 ุ ุฅุญุฏุงุซูุงุช ุงูุฒุงููุฉ ุงููุณุฑู ุงูุนููุง (1276 ุ 1828) ุ ุงูุนุฑุถ 276 ุ ุงูุงุฑุชูุงุน 448): <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/f0/-x/pc/f0-xpc4nqkymbj-ycs1my_sldhi.jpeg"></div><br>  ูุง ูุญุชุงุฌ ุฅูู ุตูุฑ ุงูุนุจูุงุช ุงููุฑุฏูุฉ ููุณูุง (ุณููุทุนูุง ูู ุตูุฑ ุงูุฑููู) ุ ููุฌูุน ูุนูููุงุช ุญูู ูุฆุชูุง ููููุนูุง ูู ุฅุทุงุฑ ุจูุงูุงุช ุงูุจุงูุฏุง products_df: <br><br><img src="https://habrastorage.org/webt/0x/nh/rv/0xnhrvv5nibludwh7svn54hj_ba.png"><br>  ูู ููุณ ุงูุฎุทูุฉ ุ ูููู ุจุชูุณูู ุฌููุน ูุนูููุงุชูุง ุฅูู ูุณููู: ุชุฏุฑูุจ ููุชุฏุฑูุจ ูุงูุชุญูู ูู ุตุญุชู ูุฑุตุฏ ุงูุชุฏุฑูุจ.  ุจุงูุทุจุน ุ ูุฐุง ูุง ูุณุชุญู ุงูููุงู ุจู ูู ุงููุดุงุฑูุน ุงูุญููููุฉ.  ููุฐูู ูุง ุชุซู ุจูู ููุนู ุฐูู.  ูุฌุจ ุนููู ุนูู ุงูุฃูู ุชุฎุตูุต ุงุฎุชุจุงุฑ ุขุฎุฑ ููุงุฎุชุจุงุฑ ุงูููุงุฆู.  ูููู ุญุชู ูุน ูุฐุง ุงูููุฌ ุบูุฑ ุงูุตุงุฏู ุ ูู ุงูููู ููุง ุฃูุง ูุฎุฏุน ุฃููุณูุง ูุซูุฑูุง. <br><br>  ููุง ุฃุดุฑูุง ูู ูุจู ุ ูููู ุฃู ูููู ููุงู ุนุฏุฉ ุตูุฑ ูุญุงูู ูุงุญุฏ.  ููููุง ูุฐูู ุ ูููู ุฃู ุชูุน ููุณ ุงูุญุฒูุฉ ูู ุนุฏุฉ ุตูุฑ.  ูุฐูู ุ ููุตุญู ุจุนุฏู ุงูุชูุณูู ููุณ ุจุงูุตูุฑ ุ ูุญุชู ุฃูุซุฑ ูู ุฐูู ุจุงูุนูุจุฉ ุ ูููู ุจุงูุฑููู.  ูุฐุง ุถุฑูุฑู ุญุชู ูุง ูุญุฏุซ ุฃู ููุชูู ุงูุดูุก ููุณู ุ ุงููุฃุฎูุฐ ูู ุฒูุงูุง ูุฎุชููุฉ ุ ูู ูู ูู ุงููุทุงุฑ ูุงูุชุญูู. <br><br>  ูุฌุนู ุชูุณูู 70/30 (30 ูช ูู ุงูุฑููู ูุชู ุงูุชุญูู ูููุง ุ ูุงูุจุงูู ููุชุฏุฑูุจ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># get distinct shelves shelves = list(set(photos_df['shelf_id'].values)) # use train_test_split from sklearn shelves_train, shelves_validation, _, _ = train_test_split(   shelves, shelves, test_size=0.3, random_state=6) # mark all records in data frames with is_train flag def is_train(shelf_id): return shelf_id in shelves_train photos_df['is_train'] = photos_df.shelf_id.apply(is_train) products_df['is_train'] = products_df.shelf_id.apply(is_train)</span></span></code> </pre> <br>  ุณูู ูุชุฃูุฏ ูู ุฃูู ุนูุฏ ุงูุงููุณุงู ุ ุณูููู ููุงู ูุง ูููู ูู ููุซูู ูู ูุตู ููุชุฏุฑูุจ ูุงูุชุญูู ูู ุงูุตุญุฉ: <br><img src="https://habrastorage.org/webt/9n/w_/xj/9nw_xjw1qiqc21sbi5q3s0pv3_q.jpeg"><br>  ูุธูุฑ ุงูููู ุงูุฃุฒุฑู ุนุฏุฏ ุงูููุชุฌุงุช ูู ูุฆุฉ ุงูุชุญูู ุ ูุงูุจุฑุชูุงูู ููุชุฏุฑูุจ.  ุงููุถุน ููุณ ุฌูุฏูุง ุฌุฏูุง ูุน ุงููุฆุฉ 3 ูููุตุงุฏูุฉ ุ ูููู ูู ุญูุซ ุงููุจุฏุฃ ููุงู ุนุฏุฏ ูููู ูู ููุซูููุง. <br><br>  ูู ูุฑุญูุฉ ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุ ูู ุงูููู ุนุฏู ุงุฑุชูุงุจ ุฎุทุฃ ุ ุญูุซ ุฃู ูู ุนูู ุฅุถุงูู ูุนุชูุฏ ุนูู ูุชุงุฆุฌู.  ูุง ุฒููุง ูุฑุชูุจ ุฎุทุฃู ูุงุญุฏูุง ููุถููุง ุณุงุนุงุช ุณุนูุฏุฉ ูู ูุญุงููุฉ ููู ุณุจุจ ุฌูุฏุฉ ุงูููุงุฐุฌ ุฏูู ุงููุชูุณุท.  ููุฏ ุดุนุฑุช ุจุงููุนู ุจุฃููู ุฎุงุณุฑ ูุชูููุงุช "ุงููุฏุฑุณุฉ ุงููุฏููุฉ" ุ ุญุชู ูุงุญุธุช ุนู ุทุฑูู ุงูุฎุทุฃ ุฃู ุจุนุถ ุงูุตูุฑ ุงูุฃุตููุฉ ุชู ุชุฏููุฑูุง 90 ุฏุฑุฌุฉ ุ ูุจุนุถูุง ููููุจ ุฑุฃุณุงู ุนูู ุนูุจ. <br><br>  ูู ููุณ ุงูููุช ุ ูุชู ุงูุชุฑููุฒ ููุง ูู ูุงูุช ุงูุตูุฑ ููุฌูุฉ ุจุดูู ุตุญูุญ.  ุจุนุฏ ุฅุตูุงุญ ุณุฑูุน ุ ุฃุตุจุญุช ุงูุฃููุฑ ุฃูุซุฑ ูุชุนุฉ. <br><br>  ุณูุญูุธ ุจูุงูุงุชูุง ูู ูููุงุช pkl ูุงุณุชุฎุฏุงููุง ูู ุงูุฎุทูุงุช ุงูุชุงููุฉ.  ุงููุฌููุน ูุฏููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏููู ุตูุฑ ุงูุฑููู ูุฃุฌุฒุงุฆูุง ูุน ุงูุญุฒู ุ </li><li style=";text-align:right;direction:rtl">  ุฅุทุงุฑ ุจูุงูุงุช ูุน ูุตู ููู ุฑู ูุน ููุงุญุธุฉ ูุง ุฅุฐุง ูุงู ูุฎุตุตูุง ููุชุฏุฑูุจ ุ </li><li style=";text-align:right;direction:rtl">  ุฅุทุงุฑ ุจูุงูุงุช ูุญุชูู ุนูู ูุนูููุงุช ุญูู ุฌููุน ุงูููุชุฌุงุช ุนูู ุงูุฑููู ุ ููุง ูุดูุฑ ุฅูู ูููุนูุง ูุญุฌููุง ููุฆุชูุง ููุถุน ุนูุงูุฉ ุนูู ูุง ุฅุฐุง ูุงูุช ูุฎุตุตุฉ ููุชุฏุฑูุจ. </li></ul><br>  ููุชุญูู ุ ูุนุฑุถ ุฑููุง ูุงุญุฏูุง ููููุง ูุจูุงูุงุชูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># function to display shelf photo with rectangled products def draw_shelf_photo(file):   file_products_df = products_df[products_df.file == file]   coordinates = file_products_df[['xmin', 'ymin', 'xmax', 'ymax']].values   im = cv2.imread(f'{shelf_images}{file}')   im = cv2.cvtColor(im, cv2.COLOR_BGR2RGB)      for xmin, ymin, xmax, ymax in coordinates:       cv2.rectangle(im, (xmin, ymin), (xmax, ymax), (0, 255, 0), 5)   plt.imshow(im) # draw one photo to check our data fig = plt.gcf() fig.set_size_inches(18.5, 10.5) draw_shelf_photo('C3_P07_N1_S6_1.JPG')</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/1m/7a/xr/1m7axrc3gcdvgt1sg0sc9-dbs0y.png"><br><br>  <b>ุงูุฎุทูุฉ 2. ุงูุชุตููู ุญุณุจ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุงุจุท ูู ุฌูุซุจ</a> )</b> <br><br>  ุชุตููู ุงูุตูุฑ ูู ุงููููุฉ ุงูุฑุฆูุณูุฉ ูู ูุฌุงู ุฑุคูุฉ ุงูููุจููุชุฑ.  ุงููุดููุฉ ูู "ุงููุฌูุฉ ุงูุฏูุงููุฉ": ุงูุชุตููุฑ ุงูููุชูุบุฑุงูู ูู ูุตูููุฉ ูุจูุฑุฉ ูู ุงูุฃุฑูุงู [0 ุ 255].  ุนูู ุณุจูู ุงููุซุงู ุ 800x600x3 (3 ูููุงุช RGB). <br><br><img src="https://habrastorage.org/webt/0w/mi/rx/0wmirxot0tx0_dl_b-m_gpdunse.jpeg"><br><br>  ููุงุฐุง ูุฐู ุงููููุฉ ุตุนุจุฉ: <br><br><img src="https://habrastorage.org/webt/gx/il/fh/gxilfhn6woijdjngbgrbgfzgjmo.png"><br><br>  ููุง ูููุง ูู ูุจู ุ ุญุฏุฏ ูุคููู ุงูุจูุงูุงุช ุงูุชู ูุณุชุฎุฏููุง 10 ุนูุงูุงุช ุชุฌุงุฑูุฉ.  ูุฐู ูููุฉ ูุจุณุทุฉ ููุบุงูุฉ ุ ูุธุฑูุง ููุฌูุฏ ุนุฏุฏ ุฃูุจุฑ ุจูุซูุฑ ูู ุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ ููุณุฌุงุฆุฑ ุนูู ุงูุฑููู.  ููู ูู ูุง ูู ููุฏุฑุฌ ุถูู ูุฐู ุงููุฆุงุช ุงูุนุดุฑ ุชู ุฅุฑุณุงูู ุฅูู 0 - ุบูุฑ ูุตูู: <br><br><img src="https://habrastorage.org/webt/wv/-j/hm/wv-jhmn18kt8ta1zhsai4fzdxbq.png">  " <br><br>  ุชูุฏู ููุงูุชูู ุฎูุงุฑุฒููุฉ ุชุตููู ุจุฏูุฉ 92ูช: <br><img src="https://habrastorage.org/webt/vv/d3/ub/vvd3ubvr_tvjxasrwvs7jap6h7o.jpeg"><br>  ูุงุฐุง ุณููุนู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณูููู ุจุฅุนุฏุงุฏ ุงูุจูุงูุงุช ููุชุฏุฑูุจ ุ </li><li style=";text-align:right;direction:rtl">  ูููู ุจุชุฏุฑูุจ ุดุจูุฉ ุนุตุจูุฉ ุชูุงููููุฉ ุจุงุณุชุฎุฏุงู ุจููุฉ ResNet v1 ุ </li><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุงูุตูุฑ ููุชุญูู ูู ุตุญุชูุง. </li></ul><br>  ูุจุฏู ุงูุฃูุฑ "ุถุฎููุง" ุ ููููุง ุงุณุชุฎุฏููุง ููุชู ูุซุงู Keras " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Trains a ResNet ุนูู ูุฌููุนุฉ ุจูุงูุงุช CIFAR10</a> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุชูุฏูุง</a> ููู ูุธููุฉ ResNet v1. <br><br>  ูุจุฏุก ุนูููุฉ ุงูุชุฏุฑูุจ ุ ุชุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏ ุตููููู: x - ุตูุฑ ููุญุฒู ุฐุงุช ุงูุจุนุฏ (ุนุฏุฏ ุงูุญุฒู ุ ุงูุงุฑุชูุงุน ุ ุงูุนุฑุถ ุ 3) ู y - ูุฆุงุชูุง ุฐุงุช ุงูุจุนุฏ (ุนุฏุฏ ุงูุนุจูุงุช ุ 10).  ูุญุชูู ุงูุตููู y ุนูู ูุง ูุณูู ุจุงูููุงูู ุงูุณุงุฎูุฉ.  ุฅุฐุง ูุงูุช ูุฆุฉ ุญุฒูุฉ ุงูุชุฏุฑูุจ ููุง ุฑูู 2 (ูู 0 ุฅูู 9) ุ ูุฅู ูุฐุง ูุชูุงูู ูุน ุงููุชุฌู [0 ุ 0 ุ 1 ุ 0 ุ 0 ุ 0 ุ 0 ุ 0 ุ 0 ุ 0]. <br><br>  ุงูุณุคุงู ุงูููู ูู ูุง ูุฌุจ ูุนูู ูุน ุงูุนุฑุถ ูุงูุงุฑุชูุงุน ุ ูุฃู ุฌููุน ุงูุตูุฑ ุชู ุงูุชูุงุทูุง ุจุฏุฑุฌุงุช ุฏูุฉ ูุฎุชููุฉ ูู ูุณุงูุงุช ูุฎุชููุฉ.  ูุญู ุจุญุงุฌุฉ ุฅูู ุงุฎุชูุงุฑ ุจุนุถ ุงูุญุฌู ุงูุซุงุจุช ุ ุงูุฐู ูููููุง ูู ุฎูุงูู ุฌูุจ ุฌููุน ุตูุฑูุง ููุญุฒู.  ูุฐุง ุงูุญุฌู ุงูุซุงุจุช ูู ูุนููุฉ ุชุนุฑูููุฉ ุชุญุฏุฏ ููููุฉ ุชุฏุฑูุจ ูุนูู ุดุจูุชูุง ุงูุนุตุจูุฉ. <br><br>  ูู ูุงุญูุฉ ุ ุฃุฑูุฏ ุฃู ุฃุฌุนู ูุฐุง ุงูุญุฌู ูุจูุฑูุง ูุฏุฑ ุงูุฅููุงู ุญุชู ูุง ุชูุฑ ุชูุงุตูู ูุงุญุฏุฉ ูู ุงูุตูุฑุฉ ุฏูู ุฃู ููุงุญุธูุง ุฃุญุฏ.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุน ูููุฉ ุถุฆููุฉ ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ุ ูููู ุฃู ูุคุฏู ุฐูู ุฅูู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุณุฑูุนุฉ: ุณูุนูู ุงููููุฐุฌ ุจุดูู ูุซุงูู ุนูู ุจูุงูุงุช ุงูุชุฏุฑูุจ ุ ูููู ุณูุก ุนูู ุจูุงูุงุช ุงูุชุญูู.  ููุฏ ุงุฎุชุฑูุง ุงูุญุฌู 120x80 ุ ูุฑุจูุง ูุญุตู ุนูู ูุชูุฌุฉ ุฃูุถู ุนูู ุญุฌู ูุฎุชูู.  ูุธููุฉ ุงูุชูุจูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># resize pack to fixed size SHAPE_WIDTH x SHAPE_HEIGHT def resize_pack(pack):   fx_ratio = SHAPE_WIDTH / pack.shape[1]   fy_ratio = SHAPE_HEIGHT / pack.shape[0]      pack = cv2.resize(pack, (0, 0), fx=fx_ratio, fy=fy_ratio)   return pack[0:SHAPE_HEIGHT, 0:SHAPE_WIDTH]</span></span></code> </pre> <br>  ุชุญุฌูู ูุนุฑุถ ุญุฒูุฉ ูุงุญุฏุฉ ููุชุญูู.  ูุตุนุจ ูุฑุงุกุฉ ุงุณู ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ ูู ูุจู ุดุฎุต ุ ุฏุนูุง ูุฑู ููู ุณุชุชุนุงูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุน ูููุฉ ุงูุชุตููู: <br><br><img src="https://habrastorage.org/webt/z_/8p/0f/z_8p0f5kuxx27mneryilqv81ols.png"><br><br>  ุจุนุฏ ุงูุชุญุถูุฑ ููููุง ููุนูุงูุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ ุ ูููู ุจุชูุณูู ุตูุงุฆู x ู y ุฅูู x_train / x_validation ู y_train / y_validation ุ ูุญุตู ุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">x_train shape: (1969, 120, 80, 3) y_train shape: (1969, 10) 1969 train samples 775 validation samples</code> </pre><br>  ูุชู ุชุญุถูุฑ ุงูุจูุงูุงุช ุ ูููู ุจูุณุฎ ูุธููุฉ ูููุดุฆ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุจููุฉ ResNet v1 ูู ูุซุงู Keras: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resnet_v1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input_shape, depth, num_classes=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span>   โฆ</code> </pre> <br>  ูููู ุจุจูุงุก ูููุฐุฌ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = resnet_v1(input_shape=x_train.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>:], depth=depth, num_classes=num_classes) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>,             optimizer=Adam(lr=lr_schedule(<span class="hljs-number"><span class="hljs-number">0</span></span>)), metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>])</code> </pre> <br>  ูุฏููุง ูุฌููุนุฉ ุจูุงูุงุช ูุญุฏูุฏุฉ ุฅูู ุญุฏ ูุง.  ูุฐูู ุ ูู ุฃุฌู ููุน ุงููููุฐุฌ ูู ุฑุคูุฉ ุงูุตูุฑุฉ ููุณูุง ูู ูู ูุฑุฉ ุฃุซูุงุก ุงูุชุฏุฑูุจ ุ ูุณุชุฎุฏู ุงูุชุนุฒูุฒ: ูู ุจุชุญููู ุงูุตูุฑุฉ ุนุดูุงุฆููุง ูุชุฏููุฑูุง ููููุงู.  ูููุฑ Keras ูุฐู ุงููุฌููุนุฉ ูู ุงูุฎูุงุฑุงุช ููุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># This will do preprocessing and realtime data augmentation: datagen = ImageDataGenerator(   featurewise_center=False,  # set input mean to 0 over the dataset   samplewise_center=False,  # set each sample mean to 0   featurewise_std_normalization=False,  # divide inputs by std of the dataset   samplewise_std_normalization=False,  # divide each input by its std   zca_whitening=False,  # apply ZCA whitening   rotation_range=5,  # randomly rotate images in the range (degrees, 0 to 180)   width_shift_range=0.1,  # randomly shift images horizontally (fraction of total width)   height_shift_range=0.1,  # randomly shift images vertically (fraction of total height)   horizontal_flip=False,  # randomly flip images   vertical_flip=False)  # randomly flip images datagen.fit(x_train)</span></span></code> </pre> <br>  ูุจุฏุฃ ุนูููุฉ ุงูุชุฏุฑูุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># let's run training process, 20 epochs is enough batch_size = 50 epochs = 15 model.fit_generator(datagen.flow(x_train, y_train, batch_size=batch_size),                   validation_data=(x_validation, y_validation),                   epochs=epochs, verbose=1, workers=4,                   callbacks=[LearningRateScheduler(lr_schedule)])</span></span></code> </pre> <br>  ุจุนุฏ ุงูุชุฏุฑูุจ ูุงูุชูููู ูุญุตู ุนูู ุงูุฏูุฉ ูู ุญุฏูุฏ 92ูช.  ูุฏ ุชุญุตู ุนูู ุฏูุฉ ูุฎุชููุฉ: ููุงู ุงููููู ูู ุงูุจูุงูุงุช ุ ูุฐูู ุชุนุชูุฏ ุงูุฏูุฉ ุฅูู ุญุฏ ูุจูุฑ ุนูู ูุฌุงุญ ุงููุณู.  ูู ูุฐุง ุงููุณู ุ ูู ูุญุตู ุนูู ุฏูุฉ ุฃุนูู ุจูุซูุฑ ูู ุชูู ุงููุดุงุฑ ุฅูููุง ูู ุงูููุงูุฉ ุ ููููุง ูู ููุนู ุดูุฆูุง ูู ุงููุงุญูุฉ ุงูุนูููุฉ ููุชุจูุง ููุฏูุง ุตุบูุฑูุง.  ุนูุงูุฉ ุนูู ุฐูู ุ ูููููุง ุจุณูููุฉ ุฅุถุงูุฉ ูุฆุฉ ุฌุฏูุฏุฉ ุ ููุฌุจ ุฃู ุชุฒูุฏ ุงูุฏูุฉ (ูุธุฑููุง) ุจุดูู ูุจูุฑ ุฅุฐุง ูููุง ุจุฅุนุฏุงุฏ ุงููุฒูุฏ ูู ุงูุจูุงูุงุช. <br><br>  ูููุงุฆุฏุฉ ุ ูุงุฑู ูุตูููุงุช ุงูุงุฑุชุจุงู: <br><img src="https://habrastorage.org/webt/ee/ns/tm/eenstmjcconudxyjjkmtpzcdmow.jpeg"><br>  ุชูุฑูุจุง ูู ุงููุฆุงุช ุชุญุฏุฏ ุดุจูุชูุง ุงูุนุตุจูุฉ ุจุดูู ุฃูุถู ุ ุจุงุณุชุซูุงุก ุงููุฆุชูู 4 ู 7. ูู ุงููููุฏ ุฃูุถูุง ุงููุธุฑ ุฅูู ุฃููุน ุงูููุซููู ููู ุฎููุฉ ูุตูููุฉ ุงุฑุชุจุงู: <br><img src="https://habrastorage.org/webt/qv/tm/lw/qvtmlwxgqvbdhut73zgsbbtfqqo.jpeg"><br>  ููููู ุฃูุถูุง ุฃู ุชููู ุณุจุจ ุฎุทุฃ ุงูุจุฑููุงู ูู ุงูุฅุจู ุ ูููู ููุงุฐุง ูุงู ูููุณุชูู ูุฎุทุฆูุง ูู Lucky Strike ุฃูุฑูุง ุบูุฑ ููููู ุชูุงููุง ุ ูููู ููุณ ูุฏููู ุดูุก ูุดุชุฑู.  ูุฐู ูู ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ููุดุจูุงุช ุงูุนุตุจูุฉ - ุงูุนุชุงูุฉ ุงููุงููุฉ ููุง ูุญุฏุซ ูู ุงูุฏุงุฎู.  ููููู ุจุงูุทุจุน ุชุตูุฑ ุจุนุถ ุงูุทุจูุงุช ุ ูููู ุจุงููุณุจุฉ ููุง ูุจุฏู ูุฐุง ุงูุชุตูุฑ ููุง ููู: <br><br><img src="https://habrastorage.org/webt/w1/tn/et/w1tnetor61yz-uwvmjlserwvh3m.jpeg"><br><br>  ูุฑุตุฉ ูุงุถุญุฉ ูุชุญุณูู ุฌูุฏุฉ ุงูุงุนุชุฑุงู ูู ุธุฑูููุง ูู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุตูุฑ. <br><br>  ูุฐูู ุ ุงููุตูู ุฌุงูุฒ.  ุงูุชูู ุฅูู ุงููุงุดู. <br><br>  <b>ุงูุฎุทูุฉ 3. ุงูุจุญุซ ุนู ุงูููุชุฌุงุช ูู ุงูุตูุฑุฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุจุท ุนูู ุฌูุซุจ</a> )</b> <br><br>  ุงูููุงู ุงููุงูุฉ ุงูุชุงููุฉ ูู ูุฌุงู ุฑุคูุฉ ุงูููุจููุชุฑ ูู ุงูุชุฌุฒุฆุฉ ุงูุฏูุงูู ุ ูุงูุชุนุฑูุจ ุ ูุงูุจุญุซ ุนู ุงููุงุฆูุงุช ุ ูุชุฌุฒุฆุฉ ุงููุซูู. <br><br><img src="https://habrastorage.org/webt/z0/y9/bf/z0y9bfe7f6qp143c3wubj8rvnd8.jpeg"><br><br>  ูููุชูุง ุชุญุชุงุฌ ุฅูู ูุดู ุงููุงุฆู.  ุชูุฏู ููุงูุฉ 2014 ููุฌูุง ูุนุชูุฏ ุนูู ุทุฑููุฉ Viola-Jones ู HOG ุจุฏูุฉ ุจุตุฑูุฉ: <br><br><img src="https://habrastorage.org/webt/11/jt/8j/11jt8jcggyutkrxyelswr8psm8s.jpeg"><br><br>  ุจูุถู ุงุณุชุฎุฏุงู ูููุฏ ุฅุญุตุงุฆูุฉ ุฅุถุงููุฉ ุ ูุฅู ุฏูุชูุง ุฌูุฏุฉ ุฌุฏูุง: <br><br><img src="https://habrastorage.org/webt/od/nb/yl/odnbylwn0yo-k92q_nu6mazz8fq.jpeg"><br><br>  ุงูุขู ุชู ุญู ูููุฉ ุงูุชุนุฑู ุนูู ุงูุฃุดูุงุก ุจูุฌุงุญ ุจูุณุงุนุฏุฉ ุงูุดุจูุงุช ุงูุนุตุจูุฉ.  ุณูุณุชุฎุฏู ูุธุงู Tensorflow Object Detection API ูุชุฏุฑูุจ ุดุจูุฉ ุนุตุจูุฉ ุจุงุณุชุฎุฏุงู ุจููุฉ Mobilenet V1 SSD.  ุชุฏุฑูุจ ูุซู ูุฐุง ุงููููุฐุฌ ูู ุงูุตูุฑ ูุชุทูุจ ุงููุซูุฑ ูู ุงูุจูุงูุงุช ููููู ุฃู ูุณุชุบุฑู ุฃูุงููุง ุ ูุฐูู ูุณุชุฎุฏู ูููุฐุฌูุง ูุฏุฑุจูุง ุนูู ุจูุงูุงุช COCO ููููุง ููุจุฏุฃ ุชุนูู ุงูููู. <br><br>  ูุฐุง ูู ุงูููููู ุงูุฑุฆูุณู ููุฐุง ุงูููุฌ.  ููุงุฐุง ูุง ูุญุชุงุฌ ุงูุทูู ุฅูู ุฅุธูุงุฑ ุงูููุงููู ูู ุงูุฃุดูุงุก ุญุชู ูุชุนูู ุงูุนุซูุฑ ุนูู ุงููุฑุฉ ูุชูููุฒูุง ุนู ุงูููุนุจุ  ูุฃู ุงูุทูู ูุฏูู 500 ููููู ุณูุฉ ูู ุชุทูุฑ ุงููุดุฑุฉ ุงูุจุตุฑูุฉ.  ุฌุนู ุงูุชุทูุฑ ุงูุฑุคูุฉ ุฃูุจุฑ ูุธุงู ุญุณู.  ูุง ููุฑุจ ูู 50 ูช (ูููู ูุฐุง ููุณ ุฏููููุง) ูู ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูู ุงูุฏูุงุบ ุงูุจุดุฑู ูู ุงููุณุคููุฉ ุนู ูุนุงูุฌุฉ ุงูุตูุฑ.  ูููู ูููุงูุฏูู ููุท ุฅุธูุงุฑ ุงููุฑุฉ ูุงูููุนุจ ุ ุซู ุชุตุญูุญ ุงูุทูู ุนุฏุฉ ูุฑุงุช ุญุชู ูุฌุฏ ููููุฒ ุฃุญุฏููุง ุนู ุงูุขุฎุฑ ุชูุงููุง. <br><br>  ูู ูุฌูุฉ ูุธุฑ ููุณููุฉ (ูุน ุงุฎุชูุงูุงุช ูููุฉ ุฃูุซุฑ ูู ุนุงูุฉ) ุ ูุนูู ููู ุงูุชุนูู ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุทุฑููุฉ ููุงุซูุฉ.  ุชุชููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูู ูุณุชููุงุช ุ ูู ูููุง ูุญุฏุฏ ุงูุฃุดูุงู ุงููุนูุฏุฉ ุจุดูู ูุชุฒุงูุฏ: ููู ูุญุฏุฏ ุงูููุงุท ุงูุฑุฆูุณูุฉ ุ ููุฌูุนูุง ูู ุฎุทูุท ุ ูุงูุชู ุจุฏูุฑูุง ุชุชุญุฏ ูู ุฃุดูุงู.  ูููุท ูู ุงููุณุชูู ุงูุฃุฎูุฑ ูู ูุฌูู ุงูุนูุงูุงุช ุงูููุฌูุฏุฉ ูุญุฏุฏ ุงููุงุฆู. <br><br>  ุงูุฃุดูุงุก ุงููุดุชุฑูุฉ ูู ุงูุนุงูู ุงูุญูููู ุชุดุชุฑู ูู ุงููุซูุฑ.  ุนูุฏ ููู ุงูุชุนูู ุ ูุณุชุฎุฏู ุงููุณุชููุงุช ุงููุฏุฑุจุฉ ุจุงููุนู ูุชุนุฑูู ุงูุณูุงุช ุงูุฃุณุงุณูุฉ ููุง ูุฏุฑุจ ุฅูุง ุงูุทุจูุงุช ุงููุณุคููุฉ ุนู ุชุญุฏูุฏ ุงูุฃุดูุงุก.  ููููุงู ุจุฐูู ุ ูููู ุจุถุน ูุฆุงุช ูู ุงูุตูุฑ ูุณุงุนุชูู ูู ุชุดุบูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณูููุงุช ุงูุนุงุฏูุฉ.  ุชู ุชุฏุฑูุจ ุงูุดุจูุฉ ูู ุงูุฃุตู ุนูู ูุฌููุนุฉ ุจูุงูุงุช COCO (ูุงุฆูุงุช Microsoft ุงูุดุงุฆุนุฉ ูู ุงูุณูุงู) ุ ููู 91 ูุฆุฉ ู 2500000 ุตูุฑุฉ!  ุงููุซูุฑ ุ ูุฅู ูู ููู 500 ููููู ุณูุฉ ูู ุงูุชุทูุฑ. <br><br>  ุจุงููุธุฑ ุฅูู ุงูุฃูุงู ููููุงู ุ ูุฅู ูุฐู ุงูุฑุณูู ุงููุชุญุฑูุฉ gif (ุจุทูุฆุฉ ููููุงู ุ ูุง ุชูุชูู ุนูู ุงูููุฑ) ูู tensorboard ุชุตูุฑ ุนูููุฉ ุงูุชุนูู.  ููุง ุชุฑู ุ ูุจุฏุฃ ุงููููุฐุฌ ูู ุฅูุชุงุฌ ูุชูุฌุฉ ุนุงููุฉ ุงูุฌูุฏุฉ ุชูุงููุง ุนูู ุงูููุฑ ุชูุฑูุจูุง ุ ุซู ูุฃุชู ุงูุทุญู: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d2d/356/aa4/d2d356aa49bedf31aa918930d8bf1545.gif" alt="ุงูุตูุฑุฉ"><br><br>  ูููู ูู "ุงููุฏุฑุจ" ููุธุงู Tensorflow Object Detection API ุจุดูู ูุณุชูู ุฅุฌุฑุงุก ุนูููุงุช ุชูุจูุฑ ุ ููุทุน ุฃุฌุฒุงุก ุนุดูุงุฆูุฉ ูู ุงูุตูุฑ ููุชุฏุฑูุจ ุ ูุงุฎุชูุงุฑ ุฃูุซูุฉ "ุณูุจูุฉ" (ุฃูุณุงู ุงูุตูุฑ ุงูุชู ูุง ุชุญุชูู ุนูู ุฃู ูุงุฆูุงุช).  ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ููุณุช ููุงู ุญุงุฌุฉ ุฅูู ูุนุงูุฌุฉ ูุณุจูุฉ ููุตูุฑ.  ููุน ุฐูู ุ ุนูู ุฌูุงุฒ ููุจููุชุฑ ููุฒูู ูุฒูุฏ ุจูุญุฑู ุฃูุฑุงุต ุซุงุจุชุฉ ููููุฉ ุตุบูุฑุฉ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุ ุฑูุถ ุงูุนูู ูุน ุตูุฑ ุนุงููุฉ ุงูุฏูุฉ: ูู ุงูุจุฏุงูุฉ ูุงู ูุนูู ููุชุฑุฉ ุทูููุฉ ุ ููุณุฑู ูุน ูุฑุต ุ ุซู ูุทูุฑ. <br><br>  ููุชูุฌุฉ ูุฐูู ุ ูููุง ุจุถุบุท ุงูุตูุฑ ุจุญุฌู 1000 ร 1000 ุจูุณู ูุน ุงูุญูุงุธ ุนูู ูุณุจุฉ ุงูุนุฑุถ ุฅูู ุงูุงุฑุชูุงุน.  ูููู ููุฐ ุถุบุท ุตูุฑุฉ ูุจูุฑุฉ ุ ูุชู ููุฏุงู ุงููุซูุฑ ูู ุงูุนูุงูุงุช ุ ุญูุซ ุชู ูุทุน ุงูุนุฏูุฏ ูู ุงููุฑุจุนุงุช ุฐุงุช ุงูุญุฌู ุงูุนุดูุงุฆู ูู ูู ุตูุฑุฉ ูู ุงูุญุงูู ูุถุบุทูุง ุฅูู 1000x1000.  ููุชูุฌุฉ ูุฐูู ุ ูุฅู ุญุฒู ุนุงููุฉ ุงูุฏูุฉ (ูููู ููุณุช ูุงููุฉ) ููู ุตุบูุฑุฉ (ูููู ูุซูุฑุฉ) ุณูุทุช ูู ุจูุงูุงุช ุงูุชุฏุฑูุจ.  ููุฑุฑ: ูุฐู ุงูุฎุทูุฉ ููุฑูุถุฉ ุ ูุนูู ุงูุฃุฑุฌุญ ุ ุบูุฑ ุถุฑูุฑูุฉ ุนูู ุงูุฅุทูุงู ุ ูุฑุจูุง ุถุงุฑุฉ. <br><br>  ูุชู ุญูุธ ุงูุตูุฑ ุงููุญุถุฑุฉ ูุงููุถุบูุทุฉ ูู ุฃุฏูุฉ ูููุตูุฉ (ุชูููู ูุชุฏุฑูุจ) ุ ููุชู ุชุดููู ูุตููุง (ูุน ุงูุญุฒู ุงูููุฌูุฏุฉ ุนูููุง) ูู ุดูู ุฅุทุงุฑูู ูู ุจูุงูุงุช ุงูุจุงูุฏุง (train_df ู Eval_df): <br><br><img src="https://habrastorage.org/webt/dl/lx/pn/dllxpn03xu5us7wr6h7y3rgzayg.png"><br>  ูุชุทูุจ ูุธุงู Tensorflow Object Detection API ุฅุฏุฎุงูุงู ููููุงุช tfrecord.  ููููู ุชุดููููุง ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ ุ ููููุง ุณูุฌุนููุง ุฑูุฒูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">class_text_to_int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(row_label)</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> row_label == <span class="hljs-string"><span class="hljs-string">'pack'</span></span>:       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:       <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df, group)</span></span></span><span class="hljs-function">:</span></span>   data = namedtuple(<span class="hljs-string"><span class="hljs-string">'data'</span></span>, [<span class="hljs-string"><span class="hljs-string">'filename'</span></span>, <span class="hljs-string"><span class="hljs-string">'object'</span></span>])   gb = df.groupby(group)   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [data(filename, gb.get_group(x))           <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> filename, x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(gb.groups.keys(), gb.groups)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_tf_example</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(group, path)</span></span></span><span class="hljs-function">:</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.gfile.GFile(os.path.join(path, <span class="hljs-string"><span class="hljs-string">'{}'</span></span>.format(group.filename)), <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> fid:       encoded_jpg = fid.read()   encoded_jpg_io = io.BytesIO(encoded_jpg)   image = Image.open(encoded_jpg_io)   width, height = image.size   filename = group.filename.encode(<span class="hljs-string"><span class="hljs-string">'utf8'</span></span>)   image_format = <span class="hljs-string"><span class="hljs-string">b'jpg'</span></span>   xmins = []   xmaxs = []   ymins = []   ymaxs = []   classes_text = []   classes = []   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index, row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> group.object.iterrows():       xmins.append(row[<span class="hljs-string"><span class="hljs-string">'xmin'</span></span>] / width)       xmaxs.append(row[<span class="hljs-string"><span class="hljs-string">'xmax'</span></span>] / width)       ymins.append(row[<span class="hljs-string"><span class="hljs-string">'ymin'</span></span>] / height)       ymaxs.append(row[<span class="hljs-string"><span class="hljs-string">'ymax'</span></span>] / height)       classes_text.append(row[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'utf8'</span></span>))       classes.append(class_text_to_int(row[<span class="hljs-string"><span class="hljs-string">'class'</span></span>]))   tf_example = tf.train.Example(features=tf.train.Features(feature={       <span class="hljs-string"><span class="hljs-string">'image/height'</span></span>: dataset_util.int64_feature(height),       <span class="hljs-string"><span class="hljs-string">'image/width'</span></span>: dataset_util.int64_feature(width),       <span class="hljs-string"><span class="hljs-string">'image/filename'</span></span>: dataset_util.bytes_feature(filename),       <span class="hljs-string"><span class="hljs-string">'image/source_id'</span></span>: dataset_util.bytes_feature(filename),       <span class="hljs-string"><span class="hljs-string">'image/encoded'</span></span>: dataset_util.bytes_feature(encoded_jpg),       <span class="hljs-string"><span class="hljs-string">'image/format'</span></span>: dataset_util.bytes_feature(image_format),       <span class="hljs-string"><span class="hljs-string">'image/object/bbox/xmin'</span></span>: dataset_util.float_list_feature(xmins),       <span class="hljs-string"><span class="hljs-string">'image/object/bbox/xmax'</span></span>: dataset_util.float_list_feature(xmaxs),       <span class="hljs-string"><span class="hljs-string">'image/object/bbox/ymin'</span></span>: dataset_util.float_list_feature(ymins),       <span class="hljs-string"><span class="hljs-string">'image/object/bbox/ymax'</span></span>: dataset_util.float_list_feature(ymaxs),       <span class="hljs-string"><span class="hljs-string">'image/object/class/text'</span></span>: dataset_util.bytes_list_feature(classes_text),       <span class="hljs-string"><span class="hljs-string">'image/object/class/label'</span></span>: dataset_util.int64_list_feature(classes),   }))   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf_example <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert_to_tf_records</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(images_path, examples, dst_file)</span></span></span><span class="hljs-function">:</span></span>   writer = tf.python_io.TFRecordWriter(dst_file)   grouped = split(examples, <span class="hljs-string"><span class="hljs-string">'filename'</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> grouped:       tf_example = create_tf_example(group, images_path)       writer.write(tf_example.SerializeToString())   writer.close() convert_to_tf_records(<span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{cropped_path}</span></span></span><span class="hljs-string">train/'</span></span>, train_df, <span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{detector_data_path}</span></span></span><span class="hljs-string">train.record'</span></span>) convert_to_tf_records(<span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{cropped_path}</span></span></span><span class="hljs-string">eval/'</span></span>, eval_df, <span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{detector_data_path}</span></span></span><span class="hljs-string">eval.record'</span></span>)</code> </pre><br>  ูุจูู ููุง ุฅุนุฏุงุฏ ุฏููู ุฎุงุต ูุจุฏุก ุงูุนูููุงุช: <br><br><img src="https://habrastorage.org/webt/ld/yd/rb/ldydrbk3ivkixsx9kep69b5eyoy.jpeg"><br><br>  ูุฏ ูููู ุงููููู ูุฎุชูููุง ุ ููููุง ูุฌุฏ ุฃูู ููุงุณุจ ุฌุฏูุง. <br><br>  ูุญุชูู ุฏููู ุงูุจูุงูุงุช ุนูู ุงููููุงุช ุงูุชู ุฃูุดุฃูุงูุง ุจุงุณุชุฎุฏุงู tfrecords (train.record ู Eval.record) ุ ุจุงูุฅุถุงูุฉ ุฅูู pack.pbtxt ูุน ุฃููุงุน ุงููุงุฆูุงุช ุงูุชู ุณูููู ุจุชุฏุฑูุจ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ููุง.  ูุฏููุง ููุน ูุงุญุฏ ููุท ูู ุงููุงุฆูุงุช ูุชุนุฑููู ุ ูุฐุง ูุฅู ุงูููู ูุตูุฑ ุฌุฏูุง: <br><br><img src="https://habrastorage.org/webt/pc/jw/x0/pcjwx0l3fc-wuzhiyt7lfo9xtcq.png"><br><br>  ูุญุชูู ุฏููู ุงูููุงุฐุฌ (ูููู ุฃู ูููู ููุงู ุงูุนุฏูุฏ ูู ุงูููุงุฐุฌ ูุญู ูุดููุฉ ูุงุญุฏุฉ) ูู ุงูุฏููู ุงููุฑุนู ssd_mobilenet_v1 ุนูู ุฅุนุฏุงุฏุงุช ุงูุชุฏุฑูุจ ูู ููู .config ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฏููููู ูุงุฑุบูู: ุงูุชุฏุฑูุจ ูุงูุชูููู.  ูู ุงููุทุงุฑ ุ ุณูุญูุธ "ุงููุฏุฑุจ" ููุงุท ุงูุชุญูู ุจุงููููุฐุฌ ุ ูุณูููู "ุงููููู" ุจุงุณุชูุงููุง ูุชุดุบูููุง ุนูู ุงูุจูุงูุงุช ููุชูููู ููุถุนูุง ูู ุฏููู ุงูุชูููู.  ุณูุชุงุจุน Tensorboard ูุฐูู ุงูุฏููููู ููุนุฑุถ ูุนูููุงุช ุงูุนูููุฉ. <br><br>  ูุตู ููุตู ูุจููุฉ ูููุงุช ุงูุชูููู ุ ุฅูุฎ.  ูููู ุงูุนุซูุฑ ุนูููุง <a href="">ููุง</a> <a href="">ูููุง</a> .  ูููู ุงูุนุซูุฑ ุนูู ุชุนูููุงุช ุชุซุจูุช Tensorflow Object Detection API <a href="">ููุง</a> . <br><br>  ูุฐูุจ ุฅูู ุฏููู ุงูููุงุฐุฌ / ุงูุจุญุซ / ูุดู ุงููุงุฆูุงุช ูููุฑุบ ุงููููุฐุฌ ุงููุฏุฑุจ ูุณุจููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2017_11_17.tar.gz tar -xvzf ssd_mobilenet_v1_coco_2017_11_17.tar.gz</code> </pre><br>  ูููู ุจูุณุฎ ุฏููู pack_detector ุงูุฐู ุฃุนุฏูุงู ููุงู. <br><br>  ุฃููุงู ุ ุงุจุฏุฃ ุนูููุฉ ุงูุชุฏุฑูุจ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">python3 train.py --logtostderr \   --train_dir=pack_detector/models/ssd_mobilenet_v1/train/ \   --pipeline_config_path=pack_detector/models/ssd_mobilenet_v1/ssd_mobilenet_v1_pack.config</code> </pre><br>  ูุจุฏุฃ ุนูููุฉ ุงูุชูููู.  ููุณ ูุฏููุง ุจุทุงูุฉ ููุฏูู ุซุงููุฉ ุ ูุฐูู ูุทูููุง ุนูู ุงููุนุงูุฌ (ุจุงุณุชุฎุฏุงู ุงูุชุนูููุงุช CUDA_VISIBLE_DEVICES = "").  ูุจุณุจุจ ูุฐุง ุ ุณูููู ูุชุฃุฎุฑุงู ููุบุงูุฉ ูููุง ูุชุนูู ุจุนูููุฉ ุงูุชุฏุฑูุจ ุ ูููู ูุฐุง ููุณ ุณูุฆูุง ููุบุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">CUDA_VISIBLE_DEVICES=<span class="hljs-string"><span class="hljs-string">""</span></span> python3 eval.py \   --logtostderr \   --checkpoint_dir=pack_detector/models/ssd_mobilenet_v1/train \   --pipeline_config_path=pack_detector/models/ssd_mobilenet_v1/ssd_mobilenet_v1_pack.config \   --eval_dir=pack_detector/models/ssd_mobilenet_v1/<span class="hljs-built_in"><span class="hljs-built_in">eval</span></span></code> </pre> <br>  ูุจุฏุฃ ุนูููุฉ tensorboard: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">tensorboard --logdir=pack_detector/models/ssd_mobilenet_v1</code> </pre> <br>  ุจุนุฏ ุฐูู ุ ูููููุง ุฑุคูุฉ ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุฌูููุฉ ุ ููุฐูู ุงูุนูู ุงููุนูู ูููููุฐุฌ ุนูู ุงูุจูุงูุงุช ุงูููุฏุฑุฉ (gif ูู ุงูุจุฏุงูุฉ): <br><br><img src="https://habrastorage.org/webt/qc/wt/rl/qcwtrlmdugb4zgyhy6gnnaoia9w.jpeg"><br><br>  ูููู ุฅููุงู ุนูููุฉ ุงูุชุฏุฑูุจ ูุงุณุชุฆูุงููุง ูู ุฃู ููุช.  ุนูุฏูุง ูุนุชูุฏ ุฃู ุงููููุฐุฌ ุฌูุฏ ุจูุง ููู ุงูููุงูุฉ ุ ูุฅููุง ูุญูุธ ููุทุฉ ุงูุชูุชูุด ูู ุดูู ุฑุณู ุจูุงูู ุงุณุชุฏูุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">python3 export_inference_graph.py \   --input_type image_tensor \   --pipeline_config_path pack_detector/models/ssd_mobilenet_v1/ssd_mobilenet_v1_pack.config \   --trained_checkpoint_prefix pack_detector/models/ssd_mobilenet_v1/train/model.ckpt-13756 \   --output_directory pack_detector/models/ssd_mobilenet_v1/pack_detector_2018_06_03</code> </pre> <br>  ูุฐุง ุ ูู ูุฐู ุงูุฎุทูุฉ ุ ุญุตููุง ุนูู ุฑุณู ุจูุงูู ููุงุณุชุฏูุงู ุ ูุงูุฐู ูููููุง ุงุณุชุฎุฏุงูู ููุจุญุซ ุนู ูุงุฆูุงุช ุงูุญุฒู.  ูุญู ููุฑ ูุงุณุชุฎุฏุงูู. <br><br>  <b>ุงูุฎุทูุฉ 4. ุชูููุฐ ุงูุจุญุซ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุจุท ุฌูุซุจ</a> )</b> <br><br>  ููุฌุฏ ุฑูุฒ ุงูุฑุณู ุงูุจูุงูู ููุงุณุชุฏูุงู ูุชููุฆุฉ ุงูุชููุฆุฉ ุนูู ุงูุฑุงุจุท ุฃุนูุงู.  ููุฒุงุช ุงูุจุญุซ ุงูุฑุฆูุณูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># let's write function that executes detection def run_inference_for_single_image(image, image_tensor, sess, tensor_dict):   # Run inference   expanded_dims = np.expand_dims(image, 0)   output_dict = sess.run(tensor_dict, feed_dict={image_tensor: expanded_dims})   # all outputs are float32 numpy arrays, so convert types as appropriate   output_dict['num_detections'] = int(output_dict['num_detections'][0])   output_dict['detection_classes'] = output_dict['detection_classes'][0].astype(np.uint8)   output_dict['detection_boxes'] = output_dict['detection_boxes'][0]   output_dict['detection_scores'] = output_dict['detection_scores'][0]   return output_dict # it is useful to be able to run inference not only on the whole image, # but also on its parts # cutoff - minimum detection score needed to take box def run_inference_for_image_part(image_tensor, sess, tensor_dict,                                image, cutoff, ax0, ay0, ax1, ay1):   boxes = []   im = image[ay0:ay1, ax0:ax1]   h, w, c = im.shape   output_dict = run_inference_for_single_image(im, image_tensor, sess, tensor_dict)   for i in range(100):       if output_dict['detection_scores'][i] &lt; cutoff:           break       y0, x0, y1, x1, score = *output_dict['detection_boxes'][i], \                               output_dict['detection_scores'][i]       x0, y0, x1, y1, score = int(x0*w), int(y0*h), \                               int(x1*w), int(y1*h), \                               int(score * 100)       boxes.append((x0+ax0, y0+ay0, x1+ax0, y1+ay0, score))   return boxes</span></span></code> </pre> <br>  ุชุนุซุฑ ุงููุธููุฉ ุนูู ูุฑุจุนุงุช ูููุฏุฉ ููุญุฒู ููุณ ูู ุงูุตูุฑุฉ ุจุฃููููุง ุ ูููู ูู ุฌุงูุจูุง.  ุชููู ุงููุธููุฉ ุฃูุถูุง ุจุชุตููุฉ ุงููุณุชุทููุงุช ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุจุฏุฑุฌุฉ ูุดู ููุฎูุถุฉ ูุญุฏุฏุฉ ูู ูุนููุฉ ุงููุทุน. <br><br>  ูุชุจูู ุฃููุง ูุนุถูุฉ.  ูู ูุงุญูุฉ ุ ูุน ูุทุน ุนุงูู ูููุฏ ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุ ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุน ูุทุน ููุฎูุถ ุ ูุจุฏุฃ ูู ุงูุนุซูุฑ ุนูู ุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ุงูุชู ููุณุช ุญุฒู.  ูู ุงูููุช ููุณู ุ ูุง ุฒููุง ูุง ูุฌุฏ ูู ุดูุก ูููุณ ูู ุงููุงุญูุฉ ุงููุซุงููุฉ: <br><img src="https://habrastorage.org/webt/-u/ao/7y/-uao7ylwycrzrn3xqd1kfh2q0bs.jpeg"><br>  ููุน ุฐูู ุ ูุงุญุธ ุฃูู ุฅุฐุง ูููุง ุจุชุดุบูู ุงููุธููุฉ ููุทุนุฉ ุตุบูุฑุฉ ูู ุงูุตูุฑุฉ ุ ูุฅู ุงูุชุนุฑู ูููู ุดุจู ูุซุงูู ูุน ุงููุทุน = 0.9: <br><br><img src="https://habrastorage.org/webt/gg/qn/ia/ggqniasnrkggb6bjnarwum_6i48.jpeg"><br><br>  ููุฑุฌุน ุฐูู ุฅูู ุญูููุฉ ุฃู ุทุฑุงุฒ MobileNet V1 SSD ููุจู ุงูุตูุฑ 300x300 ููุฏุฎูุงุช.  ุจุทุจูุนุฉ ุงูุญุงู ุ ูุน ูุฐุง ุงูุถุบุท ูุชู ููุฏุงู ุงููุซูุฑ ูู ุงูุนูุงูุงุช. <br><br>  ููู ูุฐู ุงูุนูุงูุงุช ุชุณุชูุฑ ุฅุฐุง ูุทุนูุง ูุฑุจุนูุง ุตุบูุฑูุง ูุญุชูู ุนูู ุนุฏุฉ ุนุจูุงุช.  ููุชุฑุญ ูุฐุง ููุฑุฉ ุงุณุชุฎุฏุงู ูุงูุฐุฉ ุนุงุฆูุฉ: ููุฑ ุนุจุฑ ูุณุชุทูู ุตุบูุฑ ูู ุตูุฑุฉ ููุชุฐูุฑ ูู ูุง ูุฌุฏูุงู. <br><br><img src="https://habrastorage.org/webt/zn/7s/dz/zn7sdzl4wcb9dwugzkxilg2d2hk.jpeg"><br><br>  :          ,     .         .   :          (detection score),  ,    ,        overlapTresh (       ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># function for non-maximum suppression def non_max_suppression(boxes, overlapThresh):   if len(boxes) == 0:       return np.array([]).astype("int")   if boxes.dtype.kind == "i":       boxes = boxes.astype("float")   pick = []   x1 = boxes[:,0]   y1 = boxes[:,1]   x2 = boxes[:,2]   y2 = boxes[:,3]   sc = boxes[:,4]   area = (x2 - x1 + 1) * (y2 - y1 + 1)   idxs = np.argsort(sc)   while len(idxs) &gt; 0:       last = len(idxs) - 1       i = idxs[last]       pick.append(i)       xx1 = np.maximum(x1[i], x1[idxs[:last]])       yy1 = np.maximum(y1[i], y1[idxs[:last]])       xx2 = np.minimum(x2[i], x2[idxs[:last]])       yy2 = np.minimum(y2[i], y2[idxs[:last]])       w = np.maximum(0, xx2 - xx1 + 1)       h = np.maximum(0, yy2 - yy1 + 1)       #todo fix overlap-contains...       overlap = (w * h) / area[idxs[:last]]              idxs = np.delete(idxs, np.concatenate(([last],           np.where(overlap &gt; overlapThresh)[0])))     return boxes[pick].astype("int")</span></span></code> </pre> <br>     : <br><br><img src="https://habrastorage.org/webt/go/hd/yz/gohdyzvwuyu8ja4w893big9c1yy.jpeg"><br><br>          : <br><br><img src="https://habrastorage.org/webt/jm/oi/da/jmoida7irvm4u3drey8nu6g00kw.jpeg"><br><br>   ,           ,    . <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h3><br>       ยซยป:         ,       . ,    ,         ..    . <br><br>       ,    ,    : <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  150  ,     ,   , </li><li style=";text-align:right;direction:rtl">        3-7  , </li><li style=";text-align:right;direction:rtl">   100    , </li><li style=";text-align:right;direction:rtl">        , </li><li style=";text-align:right;direction:rtl">        (), </li><li style=";text-align:right;direction:rtl">    (,  ), </li><li style=";text-align:right;direction:rtl">    ,        ยซยป, </li><li style=";text-align:right;direction:rtl">  ,   ,     (SSD  ), </li><li style=";text-align:right;direction:rtl">      ,  , </li><li style=";text-align:right;direction:rtl">  . </li></ol><br>         ,      ,    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar416123/">https://habr.com/ru/post/ar416123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar416111/index.html">ุชุญููู ุจูุงูุงุช GraphQL ููููู CustomTreeData ูู DevExtreme-Reactive</a></li>
<li><a href="../ar416113/index.html">ุณุชููู ูููุฑุงู: ุฐูุฑูุงุช ุณุชูู ุฌูุจุฒ</a></li>
<li><a href="../ar416115/index.html">10 ุฃุฎุทุงุก ุตุบูุฑุฉ ูู ุงูุชุตููู ูุง ุฒููุง ูุฑุชูุจูุง</a></li>
<li><a href="../ar416119/index.html">ูุดุงุฑูุฉ ููู ุงูุฌูุนุฉ ููู ุงูุฃุฑุจุนุงุก: ุฃุนูู ุญุฒู "ุงูุขููุฉ ุงูููุงุฆูุฉ" ุงูุฃูุซุฑ "ุฃูููุฉ"</a></li>
<li><a href="../ar416121/index.html">ูุญุณุจ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ููุฌูุชุณู ููุฏุณุฉ ุงูููุงุฏ ุงููุบูุงุทูุณูุฉ</a></li>
<li><a href="../ar416125/index.html">ุชุฑููุจ ูุฅุนุฏุงุฏ ูุธุงู ูุชุญูู ูููุงููุฑุงุช</a></li>
<li><a href="../ar416127/index.html">CUDA ู GPU ุนู ุจุนุฏ</a></li>
<li><a href="../ar416129/index.html">ููู ูุชุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุฅูุดุงุก ุตูุฑ ุงููุทุท</a></li>
<li><a href="../ar416131/index.html">ููููุฉ ุงูุชุนุงูู ูุน PD ูู ุงูุงุชุญุงุฏ ุงูุฑูุณู ูุนุฏู ุฎุฑู ุงููุงููู</a></li>
<li><a href="../ar416133/index.html">ูุฑูุฒ ุงูุจูุงูุงุช ูู ุงูุฎุงุฑุฌ: Equinix LD8</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>