<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧔🏾 🙎 🌀 Injection de dépendance avec DITranquillity 🧑🏿‍🤝‍🧑🏽 🤔 🔠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'injection de dépendances est un modèle assez populaire qui vous permet de configurer le système de manière flexible et de créer correctement les dép...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Injection de dépendance avec DITranquillity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450788/"><p> L'injection de dépendances est un modèle assez populaire qui vous permet de configurer le système de manière flexible et de créer correctement les dépendances des composants de ce système les uns sur les autres.  Grâce à la saisie, Swift vous permet d'utiliser des frameworks pratiques avec lesquels vous pouvez décrire très brièvement le graphe des dépendances.  Aujourd'hui, je veux parler un peu de l'un de ces cadres - <code>DITranquillity</code> . </p><a name="habracut"></a><br><p>  Ce didacticiel couvrira les fonctionnalités de bibliothèque suivantes: </p><br><ul><li>  Enregistrement de type </li><li>  Déploiement d'initialisation </li><li>  Incorporation dans une variable </li><li>  Dépendances cycliques des composants </li><li>  Utilisation de la bibliothèque avec <code>UIStoryboard</code> </li></ul><br><h3 id="opisanie-komponentov">  Description des composants </h3><br><p>  L'application se composera des principaux composants suivants: <code>ViewController</code> , <code>Router</code> , <code>Presenter</code> , <code>Networking</code> - ce sont des composants assez communs dans toute application iOS. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w-/pn/ro/w-pnroiey2c8xri9o3erqm9er_0.gif" alt="Structure des composants"></div><br><p>  <code>ViewController</code> et <code>Router</code> seront introduits l'un dans l'autre de manière cyclique. </p><br><h3 id="podgotovka">  La préparation </h3><br><p>  Tout d'abord, créez une application à vue unique dans Xcode, ajoutez DITranquillity à l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CocoaPods</a> .  Créez la hiérarchie de fichiers nécessaire, puis ajoutez un deuxième contrôleur à Main.storyboard et connectez-le à l'aide de <code>StoryboardSegue</code> .  Par conséquent, la structure de fichiers suivante doit être obtenue: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jw/li/s8/jwlis8txyhuzn1m5swacqvrixe4.png" alt="Structure des fichiers"></div><br><p>  Créez des dépendances dans les classes comme suit: </p><br><div class="spoiler">  <b class="spoiler_title">Déclaration des composants</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyPresenter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(networking: <span class="hljs-type"><span class="hljs-type">Networking</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.networking = networking } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCounter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Int)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyNetworking</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Networking</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completion: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(Result&lt;Int, Error&gt;)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyRouter</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Router</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">unowned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(viewController: <span class="hljs-type"><span class="hljs-type">ViewController</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewController = viewController } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentNewController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Implementation } }</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> presenter: <span class="hljs-type"><span class="hljs-type">Presenter!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> router: <span class="hljs-type"><span class="hljs-type">Router!</span></span> }</code> </pre> </div></div><br><h4 id="ogranicheniya">  Limitations </h4><br><p>  Contrairement à d'autres classes, le <code>ViewController</code> n'est pas créé par nous, mais par la bibliothèque UIKit à l'intérieur de l'implémentation <code>UIStoryboard.instantiateViewController</code> , par conséquent, en utilisant le storyboard, nous ne pouvons pas injecter de dépendances dans les héritiers de l' <code>UIViewController</code> à l'aide de l'initialiseur.  Il en va de même avec les héritiers de <code>UIView</code> et <code>UITableViewCell</code> . </p><br><p>  Notez que les objets cachés derrière les protocoles sont intégrés dans toutes les classes.  C'est l'une des tâches principales de l'implémentation des dépendances - faire des dépendances non pas sur les implémentations, mais sur les interfaces.  Cela aidera à l'avenir à fournir différentes implémentations de protocole pour réutiliser ou tester des composants. </p><br><h3 id="vnedrenie-zavisimostey">  Injection de dépendance </h3><br><p>  Une fois tous les composants du système créés, nous procédons à la connexion des objets entre eux.  Dans DITranquillity, le point de départ est <code>DIContainer</code> , qui ajoute l'enregistrement à l'aide de la méthode <code>container.register(...)</code> .  Pour séparer les dépendances en parties, <code>DIFramework</code> et <code>DIPart</code> , qui doivent être implémentés.  Pour plus de commodité, nous ne créerons qu'une seule classe <code>ApplicationDependency</code> , qui implémentera <code>DIFramework</code> et servira de lieu d'enregistrement pour toutes les dépendances.  L'interface <code>DIFramework</code> vous oblige à implémenter une seule méthode - <code>load(container:)</code> . </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationDependency</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DIFramework</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(container: DIContainer)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// registrations will be placed here } }</span></span></code> </pre> <br><p>  Commençons par l'inscription la plus simple qui n'a pas de dépendances - <code>MyNetworking</code> </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  Cet enregistrement utilise l'implémentation via l'initialiseur.  Malgré le fait que le composant lui-même n'a pas de dépendances, l'initialiseur doit être fourni pour indiquer clairement à la bibliothèque comment créer le composant. </p><br><p>  De même, enregistrez <code>MyPresenter</code> et <code>MyRouter</code> . </p><br><pre> <code class="swift hljs">container.register1(<span class="hljs-type"><span class="hljs-type">MyPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <strong>Remarque:</strong> Notez que ce n'est pas le <code>register</code> qui est utilisé, mais le <code>register1</code> .  Malheureusement, cela est nécessaire pour indiquer si l'objet a une et une seule dépendance dans l'initialiseur.  Autrement dit, s'il existe 0 ou deux dépendances ou plus, il vous suffit d'utiliser le <code>register</code> .  Cette restriction est un bogue de Swift version 4.0 et supérieure. </p><br><p>  Il est temps d'enregistrer notre <code>ViewController</code> .  Il injecte des objets non pas via l'initialiseur, mais directement dans la variable, de sorte que la description de l'enregistrement se révélera un peu plus. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter)</code> </pre> <br><p>  La syntaxe du formulaire <code>\.presenter</code> .presenter est SwiftKeyPath, grâce à laquelle il est possible d'implémenter de manière concise les dépendances.  Étant donné que <code>Router</code> et <code>ViewController</code> cycliquement dépendants l'un de l'autre, vous devez explicitement l'indiquer en utilisant <code>cycle: true</code> .  La bibliothèque elle-même peut résoudre ces dépendances sans indication explicite, mais cette exigence a été introduite afin que la personne lisant le graphique comprenne immédiatement qu'il existe des cycles dans la chaîne de dépendances.  Notez également que <strong>NOT</strong> <code>ViewController.init</code> , <strong>mais</strong> <code>ViewController.self</code> .  Cela a été décrit ci-dessus dans la section <em>Limitations</em> . </p><br><p>  Il est également nécessaire d'enregistrer l' <code>UIStoryboard</code> aide d'une méthode spéciale. </p><br><pre> <code class="swift hljs">container.registerStoryboard(name: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>)</code> </pre> <br><p>  Nous avons maintenant décrit le graphique de dépendance entier pour un écran.  Mais il n'y a pas encore accès à ce graphique.  Vous devez créer un <code>DIContainer</code> qui vous permet d'accéder aux objets qu'il <code>DIContainer</code> . </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container: <span class="hljs-type"><span class="hljs-type">DIContainer</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> container = <span class="hljs-type"><span class="hljs-type">DIContainer</span></span>() <span class="hljs-comment"><span class="hljs-comment">// 1 container.append(framework: ApplicationDependency.self) // 2 assert(container.validate(checkGraphCycles: true)) // 3 return container }()</span></span></code> </pre> <br><ol><li>  Initialiser le conteneur </li><li>  Ajoutez-y une description du graphique. </li><li>  Nous vérifions que nous avons tout fait correctement.  En cas d'erreur, l'application ne se bloquera pas lors de la résolution des dépendances, mais immédiatement lors de la création d'un graphique </li></ol><br><p>  Ensuite, vous devez faire du conteneur le point de départ de l'application.  Pour ce faire, <code>AppDelegate</code> implémentons la méthode <code>didFinishLaunchingWithOptions</code> dans <code>didFinishLaunchingWithOptions</code> au lieu de spécifier <code>Main.storyboard</code> comme point de lancement dans les paramètres du projet. </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { window = <span class="hljs-type"><span class="hljs-type">UIWindow</span></span>(frame: <span class="hljs-type"><span class="hljs-type">UIScreen</span></span>.main.bounds) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> storyboard: <span class="hljs-type"><span class="hljs-type">UIStoryboard</span></span> = <span class="hljs-type"><span class="hljs-type">ApplicationDependency</span></span>.container.resolve() window?.rootViewController = storyboard.instantiateInitialViewController() window?.makeKeyAndVisible() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br><h3 id="zapusk">  Lancement </h3><br><p>  Au premier démarrage, une baisse se produit et la validation échoue pour les raisons suivantes: </p><br><ul><li>  Le conteneur ne trouvera pas les types <code>Router</code> , <code>Presenter</code> , <code>Networking</code> , car nous n'avons enregistré que des objets.  Si nous voulons donner accès non pas aux implémentations, mais aux interfaces, nous devons explicitement spécifier les interfaces </li><li>  Le conteneur ne comprend pas comment résoudre la dépendance cyclique, car il est nécessaire d'indiquer explicitement quels objets ne doivent pas être recréés à chaque résolution du graphique. </li></ul><br><p>  Il est simple de corriger la première erreur - il existe une méthode spéciale qui vous permet de spécifier sous quels protocoles la méthode dans le conteneur est disponible. </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">MyNetworking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Networking</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre> <br><p>  Décrivant l'enregistrement comme suit, nous disons: l'objet <code>MyNetworking</code> est accessible via le protocole <code>Networking</code> .  Cela doit être fait pour tous les objets cachés sous les protocoles.  <code>{$0}</code> ajoutons pour la vérification correcte des types par le compilateur. </p><br><p>  La deuxième erreur est un peu plus compliquée.  Il est nécessaire d'utiliser la soi-disant <code>scope</code> , qui décrit à quelle fréquence l'objet est créé et combien il vit.  Pour chaque enregistrement participant à une dépendance circulaire, vous devez spécifier une <code>scope</code> égale à <code>objectGraph</code> .  Cela indiquera clairement au conteneur que lors de la résolution, il est nécessaire de réutiliser les mêmes objets créés, plutôt que de créer à chaque fois.  Ainsi, il s'avère: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">ViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(cycle: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, \.router) .injection(\.presenter) .lifetime(.objectGraph) container.register1(<span class="hljs-type"><span class="hljs-type">MyRouter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>(check: <span class="hljs-type"><span class="hljs-type">Router</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) {$<span class="hljs-number"><span class="hljs-number">0</span></span>} .lifetime(.objectGraph)</code> </pre> <br><p>  Après le redémarrage, le conteneur réussit la validation et notre ViewController s'ouvre avec les dépendances créées.  Vous pouvez mettre un point d'arrêt dans <code>viewDidLoad</code> et vous en assurer. </p><br><h3 id="perehod-mezhdu-ekranami">  Transition entre écrans </h3><br><p>  Ensuite, créez deux petites classes, <code>SecondViewController</code> et <code>SecondPresenter</code> , ajoutez <code>SecondViewController</code> au storyboard et créez un <code>Segue</code> entre elles avec l'identifiant <code>"RouteToSecond"</code> , qui vous permet d'ouvrir le deuxième contrôleur à partir du premier. </p><br><p>  Ajoutez deux enregistrements supplémentaires à notre <code>ApplicationDependency</code> pour chacune des nouvelles classes: </p><br><pre> <code class="swift hljs">container.register(<span class="hljs-type"><span class="hljs-type">SecondViewController</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) .injection(\.secondPresenter) container.register(<span class="hljs-type"><span class="hljs-type">SecondPresenter</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>)</code> </pre> <br><p>  <code>.as</code> pas nécessaire de spécifier <code>.as</code> , car nous n'avons pas caché <code>SecondPresenter</code> derrière le protocole, mais utilisons directement l'implémentation.  Ensuite, dans la méthode <code>viewDidAppear</code> du premier contrôleur, nous appelons <code>performSegue(withIdentifier: "RouteToSecond", sender: self)</code> , start, le deuxième contrôleur s'ouvre, dans lequel la dépendance <code>secondPresenter</code> doit être apposée.  Comme vous pouvez le voir, le conteneur a vu la création d'un deuxième contrôleur à partir d' <code>UIStoryboard</code> et a réussi à supprimer les dépendances. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  Cette bibliothèque vous permet de travailler facilement avec les dépendances cycliques, les storyboards et utilise pleinement l'inférence de type automatique dans Swift, qui donne une syntaxe très courte et flexible pour décrire le graphique des dépendances. </p><br><h4 id="ssylki">  Les références </h4><br><p>  Exemple de code complet dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bibliothèque github</a> </p><br><p>  DITranquillity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur github</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article en anglais</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450788/">https://habr.com/ru/post/fr450788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450776/index.html">Bonne journée radio et communication! Carte postale courte sur</a></li>
<li><a href="../fr450780/index.html">Simplicité aveugle</a></li>
<li><a href="../fr450782/index.html">Le pseudo-aléatoire nous aidera: une sélection d'outils pour générer des actifs pour le jeu</a></li>
<li><a href="../fr450784/index.html">Comment Netflix gère-t-il si bien ses téléspectateurs?</a></li>
<li><a href="../fr450786/index.html">Différences entre Fluent et gettext</a></li>
<li><a href="../fr450790/index.html">Hydrogel, myrtilles et une pincée de curcuma: système vasculaire artificiel</a></li>
<li><a href="../fr450794/index.html">Le choix est mauvais</a></li>
<li><a href="../fr450796/index.html">Comment Tesla enseigne le pilote automatique</a></li>
<li><a href="../fr450798/index.html">L'apprentissage automatique dans le développement mobile: perspectives et décentralisation</a></li>
<li><a href="../fr450800/index.html">Développement de microservices avec BDD et IOD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>