<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîé üì∞ üë®üèª‚Äçüè´ Desenvolva hexapod a partir do zero (parte 6) - transi√ß√£o para impress√£o 3D ü•ï üïí üë∏üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! O desenvolvimento do hexapod est√° ativamente em andamento e √© hora de mostrar as mudan√ßas fundamentais no design e nos planos do firmware...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolva hexapod a partir do zero (parte 6) - transi√ß√£o para impress√£o 3D</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478812/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/pl/pz/zb/plpzzbg1zxhcgfisx9j2c2bb1p0.png"></div><br>  Ol√° pessoal!  O desenvolvimento do hexapod est√° ativamente em andamento e √© hora de mostrar as mudan√ßas fundamentais no design e nos planos do firmware.  Houve uma grande pausa no lan√ßamento de novos artigos como resultado do longo projeto de novos eletr√¥nicos e caixas.  Em princ√≠pio, este ser√° o artigo, como sempre, muitas fotos. <br><br>  <b>Etapas do desenvolvimento:</b> <br>  <a href="https://habr.com/ru/post/424867/">Parte 1 - Design</a> <br>  <a href="https://habr.com/ru/post/424905/">Parte 2 - montagem</a> <br>  <a href="https://habr.com/ru/post/436748/">Parte 3 - Cinem√°tica</a> <br>  <a href="https://habr.com/ru/post/444070/">Parte 4 - trajet√≥rias e sequ√™ncias matem√°ticas</a> <br>  <a href="https://habr.com/ru/post/448058/">Parte 5 - Eletr√¥nica</a> <br>  <a href="https://habr.com/ru/post/478812/"><b>Parte 6 - transi√ß√£o para impress√£o 3D</b></a> <br><a name="habracut"></a><br><h3>  Alguns pontos gerais </h3><br>  Dei um novo nome ao projeto, j√° que nada de pr√°tico atual fala sobre ele.  De fato, o SKYNET √© uma rede celestial, bem, ou algo assim (c√©u-c√©u, rede-rede).  Nesse caso, n√£o h√° rede, e mais ainda o c√©u. <br><br>  O novo nome √© <b>AIWM (m√°quina de</b> andar com intelig√™ncia artificial <b>)</b> - uma m√°quina de andar com intelig√™ncia artificial.  √Ä custa da intelig√™ncia, √© muito cedo aqui, mas de repente eu posso viver at√© este ponto :) <br><br>  Fiz uma breve demonstra√ß√£o com uma descri√ß√£o dos recursos atuais (a visualiza√ß√£o de um novo design come√ßa a partir do segundo minuto). <br><iframe width="560" height="315" src="https://www.youtube.com/embed/xboa1LVdZsw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h3>  Mudan√ßas funcionais </h3><br>  Durante o redesenho, muitas id√©ias e complexidades surgiram.  V√°rias partes desnecess√°rias foram removidas e nova funcionalidade foi adicionada.  Aqui est√° uma lista de altera√ß√µes que est√£o planejadas para serem implementadas: <br><br><ol><li>  Arquitetura de multiprocessador.  Atualmente, tr√™s MCUs est√£o planejados: controlador de vis√£o de m√°quina (Broadcom BCM2835), controlador de energia (STM32F030), controlador de cabe√ßa (STM32F373); <br><ul><li>  O controlador de vis√£o de m√°quina √© um m√≥dulo Raspberry Pi Zero pronto e estar√° envolvido na coleta, processamento e reconhecimento de objetos da c√¢mera.  Todo o hardware necess√°rio para isso est√° conectado a ele.  A comunica√ß√£o √© realizada usando o protocolo ModBus no modo escravo; </li><li>  O controlador de energia √© um poderoso DC-DC (at√© 250 W) com a capacidade de ajustar a tens√£o de sa√≠da em tempo real atrav√©s da comunica√ß√£o.  Ele alimenta todos os componentes eletr√¥nicos do hexapod e √© o seu cora√ß√£o.  Talvez no futuro seja poss√≠vel mudar para a fonte de alimenta√ß√£o direta de unidades de 7,4V, mas essas unidades s√£o bastante caras, mesmo em Ali.  A comunica√ß√£o √© realizada usando o protocolo ModBus no modo escravo; </li><li>  O controlador principal √© o link nesta arquitetura.  Ele est√° envolvido no processamento de movimento e fornece uma interface para comunica√ß√£o com o mundo exterior.  A comunica√ß√£o √© realizada de acordo com o protocolo ModBus no modo escravo (mundo externo) e no mestre (comunica√ß√£o interprocessos); </li></ul></li><li>  Suporte a streaming de v√≠deo ou transfer√™ncia de imagem WIFI para controle fora da linha de vis√£o, se houver recursos livres suficientes do Raspberry Pi Zero; </li><li>  Decidiu-se transferir o controle para o Bluetooth (ser√° usada a ponte BLE-UART HM-10 j√° pronta), j√° que o WIFI j√° est√° teoricamente ocupado para transmitir v√≠deo para o painel de controle.  Al√©m disso, quero poder atualizar o firmware ou a configura√ß√£o em tempo real a partir de um servidor remoto e, se voc√™ usa WIFI para comunica√ß√£o, n√£o fica mais on-line; </li><li>  Gerenciamento de LEDs RGB na frente para iluminar no escuro e mostrar simultaneamente o status do FW; </li><li>  Os sensores de toque s√£o integrados √† estrutura das pernas, o que permitir√° um algoritmo de movimento mais inteligente; </li></ol><br><h3>  Controlador principal ou painel de controle </h3><br>  Eu estava cansado da atual placa sandu√≠che e foi decidido projetar uma nova placa de controle, levando em considera√ß√£o as inova√ß√µes no design.  No processo de design, a tela foi descartada (na verdade, para qu√™, ele √© necess√°rio l√°) e um medidor de alcance ultrass√¥nico (depois guano).  Ao longo do caminho, decidi mudar para o STM32F373 para finalmente me livrar do Arduino, e a presen√ßa de FPU neste processador, √© realmente necess√°rio instal√°-lo. <br><br>  Ap√≥s uma semana de elabora√ß√£o do circuito e rastreamento, apareceu um prot√≥tipo eletr√¥nico do painel.  No total, foram necess√°rias 20 horas para projetar.Para reduzir o n√∫mero de poss√≠veis fontes de erros, uma transi√ß√£o gradual para novos eletr√¥nicos √© planejada.  Nesse caso, o primeiro plano de controle ser√° lan√ßado em conjunto com o antigo painel de energia. <br><br>  Para compatibilidade do software Android atual, uma pegada √© fornecida sob a ponte WIFI-UART, que agora √© usada no prot√≥tipo.  As capturas de tela da placa s√£o mostradas abaixo (o WIFI-UART foi removido na visualiza√ß√£o 3D, porque o Altium, por algum motivo, exibe seu modelo completamente em uma cor).  De fato, n√£o faz diferen√ßa o que usar para comunica√ß√£o - o principal √© que a sa√≠da da interface tenha UART. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jq/zm/va/jqzmvahrjuse69kdkxkkcjolaay.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xs/kr/wj/xskrwjznuktifi27u5k3m0rtzqk.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g_/ow/my/g_owmy9obfc9l7vaos-dwns_z7m.png"></div><br>  Os seguintes conectores s√£o fornecidos na placa: <br>  - A fonte de alimenta√ß√£o principal s√£o contatos de 12V + do conector de balanceamento para a possibilidade de monitorar a tens√£o de cada c√©lula; com base nisso, voc√™ tamb√©m pode determinar o tipo de bateria conectada (n√∫mero de c√©lulas); <br>  - Um conector para transmitir sinais para a placa de energia dos servos; <br>  - Conectores para controlador de vis√£o de m√°quina e controlador de pot√™ncia; <br>  - Conector para controle de LEDs RGB frontais; <br>  - Conectores para sensores de toque nos membros; <br>  - Um conector para conectar um emissor piezo.  Sup√µe-se que o tweeter j√° tenha um circuito de controle, e apenas trocamos a pot√™ncia. <br><br>  Tudo √© bastante simples e a mudan√ßa para o STM deve ser indolor.  Eu projetei o c√≥digo com sucesso e √© suficiente substituir os drivers que trabalham com registros perif√©ricos. <br><br><h3>  Controlador de pot√™ncia </h3><br>  √Ä medida que minha experi√™ncia em eletr√¥nica aumentou, atrav√©s de v√°rias tentativas e erros, finalmente pude compreender o DC-DC.  De fato, n√£o h√° nada complicado l√°, o principal √© saber como a bobina funciona e por que ela √© realmente necess√°ria. <br><br>  Para controlar uma carga poderosa, que neste caso √© de 18 inversores com um consumo m√©dio de 12 a 15A, √© necess√°rio algo mais eficiente que um simples DC-DC.  Como regra, o gargalo neles √© o diodo, que em altas correntes come√ßa a aquecer a sala.  A tens√£o de alimenta√ß√£o dos inversores √© de 6V com uma tens√£o de entrada de at√© 12V; nesse caso, o diodo funcionar√° ~ 50% do ciclo (uma estimativa aproximada sem levar em conta a queda de tens√£o e outras alegrias).  Assim, mesmo ao usar um diodo Schottky, a energia alocada a ele ser√° grande o suficiente para come√ßar a pensar em dissipa√ß√£o de calor. <br><br>  DC-DCs s√≠ncronos v√™m ao resgate, no qual um transistor de efeito de campo √© usado em vez de um diodo.  Com bons transistores, a resist√™ncia do canal √© baixa o suficiente para acionar grandes correntes sem gera√ß√£o significativa de calor.  As principais diferen√ßas entre DC-DC ass√≠ncrono e s√≠ncrono s√£o mostradas abaixo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/hb/0m/8vhb0mhjztzkgi_cpya8h4ofhni.png"></div><br>  Em geral, depois de ler um monte de informa√ß√µes, finalmente decidi sobre os requisitos: <br><br><ul><li>  A capacidade de acionar correntes de at√© 20A no modo nominal; </li><li>  Transi√ß√£o para o modo de emerg√™ncia, violando a opera√ß√£o normal: superaquecimento ou satura√ß√£o da bobina, superaquecimento dos interruptores, baixa tens√£o de entrada, curto-circuito, tens√£o de sa√≠da inadequada e outras alegrias; </li><li>  Capacidade de se comunicar com o DC-DC para obter valores medidos: tens√µes de entrada e sa√≠da, consumo de corrente, temperaturas da bobina e interruptores de energia; </li><li>  Efici√™ncia adequada; </li></ul><br>  Decidi projetar o DC-DC usando o microcontrolador STM32F030, custa um centavo e possui todos os perif√©ricos necess√°rios para solucionar meus problemas.  A √∫nica desvantagem do uso deste MK √© um ajuste de tens√£o bastante bruto com um passo de 25mV a uma frequ√™ncia de 100kHz.  Para obter maior precis√£o, voc√™ precisa usar o MK com temporizadores de alta resolu√ß√£o a bordo ou reduzir a frequ√™ncia de comuta√ß√£o dos transistores.  Para os meus requisitos, esta etapa da regula√ß√£o de tens√£o √© suficiente. <br><br>  No momento, o primeiro prot√≥tipo foi projetado e montado, o que mostrou a efici√™ncia do circuito.  A efici√™ncia para medi√ß√µes aproximadas √© de 87% a uma corrente de 11A na configura√ß√£o de depura√ß√£o da placa usando resistores de prote√ß√£o de correntes passantes (necess√°rias para configurar o tempo morto entre a comuta√ß√£o do transistor). <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/md/dw/b7/mddwb7pqsxqj3gug7o9twgktpem.png"></div><br>  Mais detalhes sobre o DC-DC ser√£o um pouco mais tarde, quando eu me lembrar disso.  H√° muitos pontos interessantes, o cheiro de drivers de obturador frito e MK :) A prop√≥sito, os transistores se mostraram t√£o poderosos que, como resultado da falha, a corrente passante queimou a placa de circuito e, ao mesmo tempo, os transistores permaneceram intactos. <br><br><h3>  Um pouco sobre o novo pr√©dio </h3><br>  A eletr√¥nica √© muito interessante, mas voc√™ tamb√©m n√£o precisa esquecer a mec√¢nica.  Finalmente, o hexapod adquiriu uma caixa fechada adequada, de onde os fios e as pe√ßas das placas de circuito impresso n√£o se destacam.  Aqui est√° ele <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/bm/_a/qkbm_a4nw9tsyqnvkffqnaef3g4.png"></div><br>  Durante o design, tentei evitar o redimensionamento dos elementos dos membros e do pr√≥prio corpo, pois a vers√£o anterior se mostrava bem em termos de velocidade e carga nos acionamentos.  Em geral, apenas a ideia da localiza√ß√£o das pernas e tamanhos permaneceu no edif√≠cio anterior, o restante foi redesenhado. <br><br>  A parte mais dif√≠cil do projeto foi o desenvolvimento do projeto do casco.  No come√ßo, eu queria abandonar esse neg√≥cio v√°rias vezes por causa da discrep√¢ncia entre fantasia e realidade, mas dia ap√≥s dia os elementos decorativos come√ßaram a aparecer e esse sentimento se foi.  Afinal, o escultor tamb√©m n√£o m√≥i imediatamente sua cria√ß√£o, e esse momento s√≥ precisa ser experimentado. <br><br>  O gabinete √© um conjunto de pe√ßas para montagem subsequente com parafusos ‚Äúparafuso‚Äù M3 (em alguns lugares, voc√™ pode usar parafusos de pl√°stico, por exemplo, para as tampas superior e inferior) para reduzir o peso.  Nesse caso, os parafusos s√£o parafusados ‚Äã‚Äãdiretamente no pl√°stico nos orif√≠cios para isso com roscas pr√©-cortadas. <br><br>  A base √© montada a partir de tr√™s partes diferentes usando ranhuras, seguidas de parafusos.  N√£o h√° id√©ia de design para dividi-lo em partes, s√£o apenas os recursos f√≠sicos da impressora (220x220) e n√£o quero expandi-lo, ent√£o tenho que descobrir como sair dessa situa√ß√£o.  H√° uma vantagem nisso - em caso de qualquer dano, basta reimprimir apenas a pe√ßa danificada, o que economizar√° em pl√°stico e tempo de reparo (tudo pode acontecer durante os testes). <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wp/wp/fb/wpwpfb7hc8obeq6voecpq2sidxm.png"></div><br>  Depois de conectar todas as pe√ßas, instalar as unidades e os componentes eletr√¥nicos, tudo √© fechado com tampas de 6 mm, que s√£o presas com parafusos da mesma maneira.  Uma placa de controle √© instalada na tampa central, que √© ent√£o fechada com um painel decorativo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wq/5w/fb/wq5wfb4u3z3wshzpaabp7lx7y50.png"></div><br>  A for√ßa do corpo √© aplicada ao cair de 0,5 m de altura para uma superf√≠cie s√≥lida sem violar a integridade.  A prop√≥sito, a vers√£o em compensado do casco n√£o sobreviveu √†s duras condi√ß√µes de carga no avi√£o, enquanto o casco foi embalado em uma grande colis√£o e, como resultado, a perna foi quebrada. <br><br>  Os acionamentos de controle de membros foram movidos para a FEMUR, o que deve reduzir um pouco a carga, reduzindo o peso do TIBIA como resultado da transfer√™ncia do fixador e da mudan√ßa do servomotor mais perto do in√≠cio da alavanca.  E ser√° melhor no design se o TIBIA e o COXA estiverem instalados na parte FEMUR, e n√£o vice-versa como antes. <br><br><div class="spoiler">  <b class="spoiler_title">COXA, F√äMUROS E T√çBIA?</b>  <b class="spoiler_title">- o que √© isso?</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vn/er/iv/vneriv60k1dpousumyrgiodpggi.png"><br></div></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tx/ao/jj/txaojjxoip3y68bzfxh6thdgkd0.png"></div><br>  De acordo com c√°lculos preliminares, a impress√£o da caixa levar√° 670g de pl√°stico e 51 horas de impress√£o cont√≠nua com uma camada de 0,2 mm e uma espessura de bico de 0,4 mm.  Em geral, por dinheiro, sai um pouco mais barato que o compensado, mas o design √© in√∫til de comparar e vale a pena. <br><br><h3>  PS </h3><br>  Ficarei feliz em dar sugest√µes sobre o caso.  No momento da reda√ß√£o deste documento, o caso j√° havia sido impresso, mas ainda h√° tempo para fazer altera√ß√µes nos detalhes restantes.  Eu sou o √∫nico desenvolvedor de todo esse projeto e, √†s vezes, h√° per√≠odos em que novos pensamentos n√£o me v√™m √† mente estupidamente - agora esse per√≠odo come√ßa :) <br><br><div class="spoiler">  <b class="spoiler_title">Algumas fotos do processo de impress√£o</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/3e/sb/id/3esbidpw5dgjclju5rxolbsrhgo.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ix/2u/py/ix2upydfyhpidtitprfcllbgfdw.jpeg"></div><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt478812/">https://habr.com/ru/post/pt478812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt478796/index.html">Gradua√ß√£o nos EUA: caminho n√£o convencional para o ensino m√©dio</a></li>
<li><a href="../pt478798/index.html">Grafeno, que ainda n√£o podia</a></li>
<li><a href="../pt478802/index.html">Framework React-admin e django rest</a></li>
<li><a href="../pt478804/index.html">Antiguidades: quanto pior, melhor ou caracter√≠sticas do Sound Blaster Pro 2</a></li>
<li><a href="../pt478806/index.html">Adicionar automaticamente fontes JSON ao REFL.ME para gerar mensagens e alertas</a></li>
<li><a href="../pt478814/index.html">Como o marketing torna mais r√°pido o carregamento de seus smartphones</a></li>
<li><a href="../pt478816/index.html">Testando aplicativos Android usando selenoid. Pesquisar local em um aplicativo m√≥vel usando o Appium</a></li>
<li><a href="../pt478820/index.html">Vivaldi para Android: uma vers√£o beta √© boa e a segunda √© melhor</a></li>
<li><a href="../pt478822/index.html">Rob√≥tica de IA com a plataforma de dados IRIS da InterSystems</a></li>
<li><a href="../pt478824/index.html">Unidade, ECS, Atores: como aumentar o FPS em seu jogo dez vezes, quando n√£o h√° nada para otimizar [com edi√ß√µes]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>