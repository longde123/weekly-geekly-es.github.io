<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸš’ ğŸ‘¨ğŸ»â€ğŸ¨ ğŸ¤± Apa yang harus dilakukan pada akhir pekan: interkom remote control, Nextion remapping yang tanpa anggaran, pertikaian dengan Onlaym ğŸ¤ğŸ» â” ğŸ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terkadang pada hari Jumat fiksi dianggap dapat diterima di sini. Hari ini, tentu saja, bukan hari Jumat, tetapi ini bukan fiksi, melainkan tiga novel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apa yang harus dilakukan pada akhir pekan: interkom remote control, Nextion remapping yang tanpa anggaran, pertikaian dengan Onlaym</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/400367/"><img src="https://habrastorage.org/files/044/f5f/30d/044f5f30df86463087940fff4fc4ba92.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terkadang pada hari Jumat fiksi dianggap dapat diterima di sini. </font><font style="vertical-align: inherit;">Hari ini, tentu saja, bukan hari Jumat, tetapi ini bukan fiksi, melainkan tiga novel mini yang ada hubungannya dengan hidup saya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembaca yang tergesa-gesa mungkin juga bertanya-tanya hubungan apa yang sebenarnya dapat menghubungkan interkom dan penyedia Internet. </font><font style="vertical-align: inherit;">Dan itu akan benar, karena saya juga tidak segera sampai pada masalah ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi tentang segalanya (Arduino, hacks kehidupan dangkal, pertengkaran telepon) dalam rangka.</font></font><br>
<br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sim-sim, buka!</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejujurnya, remote control interkom menurut versi saya hampir tidak berguna, dan saya sepenuhnya menyadari ini bahkan sebelum saya mulai. Karena itu, untuk membenarkan upaya tersebut, saya harus menggunakan semua kekuatan imajinasi untuk menghasilkan beberapa kasus, seperti yang mereka katakan ,. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk mulai dengan, saya memutuskan bahwa dengan cara ini saya akan membiarkan para tamu menghangat di teras, jika saya belum berhasil berlari pulang. Atau saya tidak akan terlalu repot untuk mendapatkan kunci di muka - Anda hanya dapat mengatur telepon sehingga memberikan perintah untuk membuka pintu ketika saya sampai di rumah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagi orang awam itu terdengar sangat liar, tetapi seperti yang mereka katakan, per aspera ad astra.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan saya benar-benar ingin entah bagaimana menggunakan beberapa relay dalam kasus ini, yang telah menganggur di pengontrol pusat sejak awal operasinya. Faktanya, situasinya konyol: pada saat itu hanya ada satu blok untuk 4 relay yang hanya membutuhkan dua. Dan saya tidak ingin menunggu satu bulan lagi untuk blok dua-relay, jadi saya mengumpulkan dari apa yang ada di tangan dan segera mulai khawatir tentang redundansi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, untuk interkom. Secara umum, pembukaan otomatis sistem interkom bukanlah hal yang eksklusif. Sebagai contoh, di sini di Geektimes, kawan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kembali</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada tahun 2013 (ketika dolar adalah 30), </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;">Cluster</font></a><font style="vertical-align: inherit;"> membuat tidak hanya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remote control, tetapi juga mesin penjawab untuk para tamu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejauh ini ini adalah hal paling keren yang pernah saya lihat di kelas ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun jauh sebelumnya, pengunjung RadioKota dan banyak forum tematik lainnya</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bersenang-senang dengan perangkat seperti "pembuka"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - membuka interkom segera saat ada panggilan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak akan mengulangi salah satu atau yang lain. </font><font style="vertical-align: inherit;">Yang pertama - karena sulit, dan karena saya sudah memiliki pengontrol yang berfungsi, yang saya rencanakan untuk memberikan kekuatan baru. </font><font style="vertical-align: inherit;">Yang kedua karena alasan yang lebih jelas: terlalu banyak detail dan terlalu sedikit akal, saya minta maaf jika saya menyinggung penulis. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akal, tentu saja, untukku, dan tidak sama sekali. </font><font style="vertical-align: inherit;">Artinya, saya pasti tidak suka skema, yang dengan ramah membuka pintu bagi siapa saja yang memanggil nomor apartemen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu persyaratan dasar untuk pembuka saya: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Menggunakan pengontrol pusat untuk mengontrol melalui Internet dan radio </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Perlindungan minimal terhadap akses tidak sah</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Gangguan minimal pada interior</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai</font></font></h3><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mulai dengan membiasakan diri dengan prinsip pengoperasian interkom, yang saya pinjam di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabung bekerja sangat sederhana: ketika tabung diletakkan, ia memiliki resistansi 50 Ohm, ketika tabung dilepas, resistannya kira-kira. </font><font style="vertical-align: inherit;">400 Ohm, ketika tombol pelepas kunci ditekan, hambatan diukur dalam kilo-ohm ... Ketika tidak ada panggilan, tidak ada tegangan di saluran. </font><font style="vertical-align: inherit;">Ketika ada panggilan masuk dan handset mengalirkan arus besar dan voltase ternyata kecil 5-7V, ketika handset tidak ada dan resistansi dipanggil hingga tak terbatas dan tegangannya maks. </font><font style="vertical-align: inherit;">15V saat handset mati tegangan sekitar 10V. </font><font style="vertical-align: inherit;">Ketika tombol tegangan ditekan, maksimumnya sekitar. </font><font style="vertical-align: inherit;">15V - menekan tombol sama dengan jeda baris.</font></font></blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus Digital, ini sedikit berbeda, karena dokumentasi untuk handset, tetapi saya punya KM-2NO (omong-omong, saya mengucapkan terima kasih kepada Digital untuk menerbitkan skema) menunjukkan:</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Konsumsi arus dalam mode "Talk" 18-22 mA </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Tegangan sejalan dengan tabung yang dipasang pada rumahan 1.5â€“2.5 V </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3. Tegangan sejalan dengan tabung yang ditinggikan 5.8â€“6.5 V</font></font><br>
</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, saya berkenalan lebih detail dengan diagram sirkuit pipa saya: </font></font><br>
<br>
<img src="https://habrastorage.org/files/b76/591/c8f/b76591c8f87c4eaca7a8bfec1f652f39.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan saya menemukan bahwa semuanya persis sama dalam hal resistensi, dan kemungkinan besar, sisa logika Digital hampir tidak berbeda dari Kunjungan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya menarik perhatian pada kenyataan bahwa modifikasi saya tanpa LED. Tapi ini ternyata benar, karena fakta ini membuatnya sangat mudah untuk mengirimkan informasi panggilan ke pengontrol pusat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yaitu: panggilan berbunyi, LED "menyala", optocoupler menyala, pada pin pengontrol kami memiliki perubahan level dari tinggi ke rendah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi alih-alih LED, saya memasang optocoupler 4N35 saya, yang hasilnya saya kirim langsung ke Arduino. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menurut skema standar</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari Internet yang sama:</font></font><br>
<br>
<img src="https://habrastorage.org/files/a7f/c39/9f8/a7fc399f840e4931b225370b2f21c3cd.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan karena saya ingin bertahan dengan detail minimum dan sumber daya pengontrol yang tersedia, yang pin digitalnya ternyata paling berharga (Uno tidak punya cukup banyak), daripada resistor pull-up 10K, saya menggunakan resistor pull-up Arduino bawaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat terhubung ke pin digital, tampilannya seperti ini:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ringPin _</span></span><font></font>
<font></font>
pinMode(ringPin, INPUT_PULLUP);<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat terhubung ke pin analog:</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ringPin _</span></span><font></font>
<font></font>
pinMode(ringPin, INPUT);<font></font>
digitalWrite(ringPin, HIGH);<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memutuskan untuk menempatkan optron dari mikrokontroler. </font><font style="vertical-align: inherit;">Saya tidak bisa membenarkannya, tetapi saya pikir ada sedikit risiko positif palsu dari kemungkinan pengambilan. </font><font style="vertical-align: inherit;">Mungkin saja dia salah, tapi sejauh ini semuanya normal dengan tip </font><font style="vertical-align: inherit;">mereka tidak. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adapun bumi dalam contoh di atas, Anda perlu memahami: meskipun bumi tampaknya umum dalam diagram, ini tidak begitu - pada kenyataannya, sebenarnya ada isolasi optoelektronik. </font><font style="vertical-align: inherit;">Nah, untuk itu dia adalah contoh.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singkirkan aku!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Keputusan untuk sepenuhnya menghilangkan sirkuit interkom tidak datang dengan segera, tetapi mau tidak mau. Ngomong-ngomong, saya sangat ingat kasus enam tahun lalu, ketika saya menyaksikan bagaimana momen canggung dengan kunci elektromagnetik terbentuk selama pemasangan ACS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak tahu bagaimana itu terjadi, tetapi ternyata kastil itu entah bagaimana berfungsi. Itu "merangkak", maka tidak ada sama sekali, dan installer sendiri sudah mematahkan kepala mereka. Tetapi pada akhirnya disarankan bahwa mereka memiliki hubungan pendek yang tidak terduga di suatu tempat (atau sesuatu seperti) di sirkuit kontrol. Tentu saja, kami memeriksa semuanya, tentu saja, tanpa banyak keberhasilan, karena semuanya diatur dengan jelas sesuai instruksi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Minyak ditambahkan ke api oleh fakta bahwa kunci yang sama persis dalam konfigurasi yang persis sama, tetapi bekerja dengan baik di lantai lain.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berapa lama, secara singkat, mereka memutuskan bahwa masalahnya ada di pintu itu sendiri, di mana kunci terpasang. Menurut pendapat saya, mereka menyarankan bahwa ketika dipasang, mereka masuk ke armature, yang kemudian dibumikan, yang menyebabkan efek yang tak terduga pada kunci (yang, mungkin, memiliki kunci kontrol untuk kasus ini). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, mereka memilah cukup lama dan membosankan. Dan saya tidak ingin mengulangi hal yang sama di rumah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, saya tidak menyimpan kabel dan menghubungkan kontak relai dengan cara paling sederhana: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Biasanya menutup satu relai - secara seri dengan tombol naik SW1 (karena tombol ini ditutup dalam keadaan normal) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Biasanya membuka relai lain - secara paralel dengan tombol buka pintu SB1 ( karena tombol ini biasanya terbuka)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relay kontak kontrol, tentu saja, terhubung ke pin digital mikrokontroler yang bebas (hore, masih). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara total, mudah untuk membayangkan bahwa butuh enam kabel: dua untuk optocoupler dan empat lagi untuk relay. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya minta maaf atas primitivisme ilustrasi:</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari interkom</font></font></h4><br>
<img src="https://habrastorage.org/files/cfe/2f2/23c/cfe2f223cb2b4d49ad1b853482b3895a.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oleh Arduino</font></font></h4><br>
<img src="https://habrastorage.org/files/c99/84f/e4b/c9984fe4be554b13b2ec17915ca86474.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Relay di sini ditampilkan secara skematis secara eksklusif. </font><font style="vertical-align: inherit;">Karena, saya ulangi, saya menggunakan modul relay siap pakai dengan isian penuh - optocoupler, transistor, dioda, dan sebagainya. </font><font style="vertical-align: inherit;">Saya sangat menyarankan untuk tidak menghubungkan relay kosong ke Arduino.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... dan jangan panggil aku lagi!</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sudah pada tahap ini, saya dapat dengan mudah membuka doorphone melalui Internet atau jaringan area lokal dari komputer atau smartphone sesuai dengan prinsip berikut: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Pada saat doorphone berdering, controller masuk ke mode perizinan untuk membuka pintu selama 40 detik. Waktu dipilih berdasarkan dokumentasi untuk doorphone Digital, di mana ditunjukkan bahwa durasi sinyal panggilan tepat 40 detik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yaitu untuk waktu yang lebih lama, tidak ada gunanya tetap terbuka secara kondisional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Setelah menerima perintah terbuka melalui Internet (HTTP POST), pengontrol secara berurutan mengalihkan relai. Pertama, ia membuka relai tabung, yang mensimulasikan kenaikannya. Kemudian, setelah jeda singkat, relai tombol pembuka ditutup, dengan demikian mensimulasikan penekanannya. Setelah - "melepaskan" tombol dan "menutup" telepon. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bangku tes sangat primitif:</font></font><br>
<br>
<img src="https://habrastorage.org/files/3b5/44c/db1/3b544cdb17ab4f67953d7643d98e0156.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adalah mungkin untuk menghentikan ini jika saya, sebagai pemilik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KTsDV-12-2 yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bangga </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">,</font></a><font style="vertical-align: inherit;"> tidak menyadari betapa merepotkannya - untuk berjalan di sekitar kendali jarak jauh atau telepon setiap kali ketika Anda perlu menghidupkan / mematikan sesuatu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan, khususnya, jika saya baru saja menyelesaikan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">stasiun cuaca desktop dengan layar sentuh</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan, sepertinya, potensi belum sepenuhnya berkembang. </font></font><br>
<br>
<img src="https://habrastorage.org/files/90a/d36/f45/90ad36f45757421295f332c7425578fa.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Singkatnya, saya dengan cepat (sebenarnya tidak) menambahkan ke stasiun cuaca pemancar 433 MHz paling umum dan vulgar dengan modulasi amplitudo, yang banyak dijual di Aliexpress dengan harga yang tidak masuk akal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akibatnya, stasiun cuaca telah menjadi titik kontrol lain untuk interkom, dan oleh karena itu, jika bel berbunyi dan Anda duduk di sebelahnya, maka tidak ada gunanya memutus handset, karena langsung dari layar Anda dapat:</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Buka kunci </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Angkat handset dan perlahan-lahan (sesuai dengan dokumentasi, percakapan berlangsung 1,5 menit versus 40 detik panggilan), buka interkom, jawab dan putuskan apakah akan dibuka atau tidak </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Jawab panggilan (controller mengambil dan segera "Tutup telepon") </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk ini, tentu saja, saya harus sedikit memodifikasi kode dan antarmuka stasiun cuaca, tetapi di sepanjang jalan saya menemukan di mana ada kesalahan yang mengganggu dalam tampilan grafik (ternyata, saya punya DNA, tetapi ini adalah cerita yang berbeda). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Antarmuka baru, omong-omong, sekarang tidak terlihat seperti HAL sama sekali. Sekarang, semuanya sangat berwarna dan lucu sehingga Anda hanya perlu tertawa. Dan Anda tahu, paham: Saya tidak minum smoothies, hipsters tidak menggigit saya, tidak ada lamberseks dalam keluarga, dan materi menarik saya tidak seperti sebelumnya dalam hidup saya:</font></font><br>
<br>
<img src="https://habrastorage.org/files/71a/154/0d4/71a1540d420441d3aa62d3ca673f3a43.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layar ini menggantikan data iklim ketika interkom berdering: pada saat ini, pengontrol pusat mengeluarkan perintah radio, yang ditanggapi oleh tampilan cuaca. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini mungkin sedikit tidak masuk akal di sini, tetapi bel di pusat utamanya memberi tahu Anda tentang panggilan interkom. </font><font style="vertical-align: inherit;">Menekannya (tidak logis di sini) mematikan suara interkom dengan cara yang paling biadab - dengan meniru proses menaikkan dan menurunkan handset. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kastil di sebelah kiri adalah bukaan kastil. </font><font style="vertical-align: inherit;">Handset di sebelah kanan - mengambil handset untuk mensimulasikan awal percakapan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Layar berubah menjadi yang utama setelah 40 detik dari awal panggilan, dan tidak langsung dengan menekan tombol ikon. </font><font style="vertical-align: inherit;">Ini memungkinkan Anda untuk menekan beberapa kali jika controller tiba-tiba tidak "mendengar" perintah, yang tidak biasa diberikan jenis saluran radio yang digunakan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algoritma</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang saya sebutkan, pada awalnya saya sederhana dan hanya menginginkan satu hal: untuk membuka interkom sesuai perintah dari telepon, dan pada saat panggilan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi setelah bermain beberapa hari, saya menyadari bahwa berdiri di depan interkom dan menusuk layar adalah tugas yang agak membosankan, dan itu jauh lebih menarik untuk memungkinkan pembukaan "tertunda" ketika Anda baru saja mendekati pintu masuk. Kemudian tinggal memanggil nomor apartemen di panel doorphone dan voila, pintunya terbuka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, saya berpikir bahwa dalam situasi ini, mungkin masuk akal untuk membuat larangan pembukaan - secara umum. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tapi kemudian dia menyatukan dirinya, lalu melepaskan dirinya sendiri, mengambil alat yang lebih berguna, yang populer disebut pisau cukur Occam, dan dengan cepat menyingkirkan entitas tambahan. Yaitu: karena saya sedang melakukan remote control, itu bukan untuk mematikannya. Karena itu - shutdown tidak diperlukan sama sekali.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedua, menurut pemikiran sadar (dan tidak seperti biasanya), ternyata tidak ada perbedaan khusus antara pembukaan oleh perintah langsung pada saat panggilan atau dengan perintah yang diberikan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, kembali ke ergonomi kontrol, saya ingin mengatakan bahwa semakin banyak mode - semakin sedikit orang biasa akan menggunakannya. Ya di sana, saya bosan, tetapi ketika saya membayangkan bahwa saya memiliki tiga mode untuk kesempatan yang berbeda, saya menyadari bahwa saya masih akan menggunakan satu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oleh karena itu, mode adalah satu dan perintahnya adalah satu, dan ada dua prosesor: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Jika interkom berdering, pengontrol memungkinkan pembukaan dalam waktu 40 detik sejak dimulainya panggilan</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Jika perintah pembuka diterima terlebih dahulu, pengontrol memungkinkan pembukaan dan menunggu panggilan dalam N menit dari saat perintah diterima (ini adalah untuk mempersiapkan interkom untuk membuka dalam perjalanan ke rumah) Ada </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
dua sumber perintah pembukaan: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) HTTP POST- permintaan melalui jaringan lokal atau Internet (misalnya: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myserver.com/?sim-sim-openup</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), yaitu Anda dapat membuka setidaknya dari Kuala Lumpur </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Perintah radio dari panel atau tombol rumah (dalam implementasi saya, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melalui perpustakaan RC-Switch</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan karena seluruh struktur terhubung ke handset tanpa mempengaruhi fungsinya, interkom dapat terus digunakan dengan cara biasa (bell-handset-hi-hi-button), mis. </font><font style="vertical-align: inherit;">domestik, tidak mampu menghargai manfaat kemajuan teknologi, dan tidak diharuskan untuk mempelajari detailnya.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bonus mendadak</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bahkan jika Anda tidak menggunakan fungsi pembuka pintu, sekarang ternyata pengontrol secara teratur memberi tahu bahwa seseorang sedang menggaruk pintu masuk melalui interkom. </font><font style="vertical-align: inherit;">Bagi saya, sebagai orang yang ingin tahu, informasi ini bukan tanpa minat - dan sekarang saya menerimanya secara teratur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lebih penting lagi, fungsi ini terus berfungsi bahkan jika Anda mematikan handset doorphone dengan saklarnya. </font><font style="vertical-align: inherit;">Secara potensial, ini berarti bahwa sekarang ada lebih sedikit kesempatan untuk membiarkan interkom dinonaktifkan, jika Anda tiba-tiba perlu untuk sementara waktu mengecualikan kemungkinan panggilannya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sayangnya, sirkuit interkom sedemikian rupa sehingga ketika dimatikan, menjadi tidak mungkin untuk mengontrol kunci dari jarak jauh (tampaknya unit pusat menganggap bahwa dalam kasus ini handset "digantung", terlepas dari posisi aktualnya).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan lansekap</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena saya berusaha untuk gangguan minimal di interior, saya harus membuat keputusan bagaimana menghubungkan ke pengontrol pusat, dengan dasar bahwa pengontrol dan doorphone berada di sisi pintu yang berbeda, dan pengontrol memiliki listrik, tetapi doorphone tidak. </font></font><br>
<br>
<img src="https://habrastorage.org/files/7b6/8e8/6c3/7b68e86c3aab453e8fcbc579149f4e2a.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada akhirnya, saya memutuskan bahwa akan lebih baik untuk meregangkan kabel di belakang kusen pintu dan menutup fragmennya dengan panel dekoratif yang dicetak pada printer 3D daripada menempati outlet lain dengan catu daya, tidak jelas bagaimana cara menarik kawatnya ke handset doorphone dan memblokir saluran radio antara handset dan controller. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e65/a91/84a/e65a9184ab9d4cb29e84e515689e607e.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan saya pikir dalam kondisi saya ini adalah pilihan terbaik. </font><font style="vertical-align: inherit;">Ya, dan estafet masuk ke bisnis, tetapi dengan saluran radio - lagi akan tetap dalam cadangan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remapping Nextion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berbicara tentang tampilan cuaca desktop (stasiun cuaca, jika Anda mau), saya menyebutkan bahwa selama proses finishing saya berhasil merusak komponen utama - layar sentuh Nextion itu sendiri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerusakan tidak mempengaruhi pengoperasian mikrokontroler on-board dan tampilan data, tetapi panel sentuh hampir gagal. Namun, secara eksperimental, saya mengetahui bahwa meskipun Anda tidak terlalu menekan papan Nextion di tempat tertentu, dengan cara ini Anda dapat mengembalikan sensitivitas bagian kiri (sekitar) setengah layar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trik ini berfungsi tidak stabil dan tidak selalu, tetapi cukup sering sehingga saya bisa tahan dengan itu, berpikir tentang memesan layar baru.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, ini membuatku bahagia dan sedih. Di satu sisi, adalah mungkin untuk mencapai operabilitas parsial. Di sisi lain, saya ingin bermain sedikit lebih banyak dengan grafik. Dan kemudian saya tiba-tiba menyadari betapa jebakannya saya: untuk suatu alasan saya terobsesi menggunakan seluruh area layar, ketika saya bisa dengan bebas memindahkan tombol "tidak berfungsi" ke area kerja. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengerti bahwa bagi banyak orang ini benar-benar keputusan yang biasa. Tapi saya ingin berbagi kebahagiaan yang tidak bersalah dengan mereka yang, seperti saya, suka pergi ke ekstrem. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, saya mengetahuinya, sedikit mengubah ukuran tombol, menggambar sirkuit kontrol virtual baru di kepala saya dan voila! Kami memiliki fungsi yang hampir sepenuhnya pulih dari tampilan yang terbunuh sebagian. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu adalah </font></font><br>
<br>
<img src="https://habrastorage.org/files/8cb/774/fc0/8cb774fc06b444ce994ad1470e7319d8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
:</font></font><br>
<br>
<img src="https://habrastorage.org/files/202/2b8/82f/2022b882fd2245a79cc4fae8514ddde5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Namun, di sepanjang jalan, saya harus membunuh seorang perfeksionis dalam diri saya sendiri dan mengulangi layar kendali layar ponsel asli menjadi yang berfungsi minimal:</font></font><br>
<br>
<img src="https://habrastorage.org/files/bd2/bec/a58/bd2beca5810346c5a99099e1ac046288.png"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hidup</font></font></h4><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/P6Iqh6SYVRU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika dukungan teknis bukan bir</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tampaknya pada semua pasang surut ini akan mungkin untuk menyelesaikan, jika tidak untuk satu detail: Tiba-tiba saya menemukan bahwa interkom (dan di belakangnya sisa otomatisasi) berhenti dikontrol ketika mengakses dari jaringan eksternal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artinya, semua perintah bekerja dengan sempurna ketika terhubung ke Internet melalui jaringan rumah dan ke alamat eksternal (dan tidak sesuai dengan tipe internal 192.xxx.xxx.xxx), tetapi mereka sama-sama dengan sempurna menolak untuk dieksekusi dari jaringan operator lain (saya mencoba dua). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Anda harus segera memahami bahwa perintah dikirimkan melalui permintaan HTTP ke port eksternal khusus router, dan dari sana perintah tersebut sudah dialihkan ke IP dan port internal yang diperlukan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dan skema ini telah bekerja tanpa masalah sekecil apa pun sejak diluncurkan pada 2013 hingga sesuatu yang rusak pada saat ini. Dan saya masih yakin itu bukan salah saya. Tapi saya tidak tahu cara memeriksanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya, pada awalnya saya ingin bersumpah dengan Beeline, karena pada awalnya saya berpikir bahwa masalahnya ada di Internet seluler. Tetapi kemudian saya menyatukan diri, menemukan penyedia lain, mencobanya dan menemukan bahwa melalui masalah yang sama. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lalu aku menelepon Onlaym dan, sebisaku, menjelaskan inti dari klaim itu. Dan sebagai tanggapan, mereka menjelaskan kepada saya secara populer bahwa:</font></font><br>
<br>
<blockquote>               :<br>
TCP/25 â€“  -;<br>
TCP/135-139, TCP/445  UDP/135-139 â€“   ,    MS Windows;<br>
TCP/23, TCP/161, UDP/69  UDP/161â€“   .<br>
 <br>
  ,  ,  .</blockquote><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya, pada gilirannya, bersikeras bahwa port saya a) tidak termasuk dalam kisaran ini, b) tidak berfungsi, seperti yang diharapkan dan c) saya tidak mengubah apa pun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagaimana dengan dinding kacang polong. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nah, apa yang harus saya lakukan, maka saya dengan sopan menjelaskan bahwa walaupun saya mengerti bahwa 450 rubel saya yang malang sebulan tidak akan melakukan cuaca untuk mereka, saya akan pergi dari omong kosong seperti itu untuk mencari omong kosong yang sama, tetapi setidaknya itu berhasil. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai tanggapan, mereka bergumam lagi bahwa mereka memberi saya IP, dan kemudian semua masalah saya. Yah milikku, aku memutuskan, lalu milikku. Dan dengan keputusan yang berkemauan keras, saya pertama kali memeriksa operabilitas sistem pada port lain (bergeser ke unit) - itu berhasil. Dan kemudian dia membuat konfigurasi fleksibel nomor port di Tasker, di mana, pada kenyataannya, kemudi otomatis.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebenarnya, untuk apa yang saya jelaskan tentang penderitaan saya: Saya secara objektif benar-benar ingin memahami siapa yang salah dalam situasi seperti itu. </font><font style="vertical-align: inherit;">Karena saya merasa seperti orang tolol - saya me-reboot router dan memeriksa pengaturan (apalagi, atas inisiatif saya sendiri, dan bukan atas permintaan "spesialis"), dan mereka tetap mengirim saya ke neraka, mengisyaratkan tangan saya yang bengkok.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layar mati</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kesimpulannya, yang saya gunakan untuk pembangunan abad ini: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KTSDV-12-2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 1 pc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Handset doorphone Digital KM-2NO - 1 pc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3) Optocoupler 4N35 - 1 pc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4) Kabel flat 10 core (digunakan enam, tetapi meletakkan semuanya - untuk berjaga-jaga) - 3 m. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5) Konektor ke kabel - 2 pcs. </font><font style="vertical-align: inherit;">ayah dan ibu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampilan cuaca</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> buatan rumah </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">dengan layar sentuh Nextion</font></a><font style="vertical-align: inherit;"> - 1 pc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
7) 433 MHz pemancar ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari kit seperti ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) untuk memodifikasi tampilan cuaca - 1 pc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
8) 1 kÎ© resistor untuk optocoupler - 1 pc. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pilihan: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antarmuka yang diperbarui untuk Nextion</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode uji (sebelum diintegrasikan dengan KTSDV-12-2 dan buket lengkap fungsi layanan, hanya untuk memahami alur pemikiran)</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;RCSwitch.h&gt; //   http://code.google.com/p/rc-switch/</span></span></span></span><font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ringTimeOut 40000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//       2094</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> openTimeOut 300000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    allowOpen        </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> handsetPin A3 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    0</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> openPin A4 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    (1)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ringPin 7 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   (3)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ringCode 360500 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//        </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> doorBell 3395840 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//       </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> openCode 255899 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> openDelay 1500 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> handsetDelay 2500 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> txPin 8</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ringTime, openTime; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
boolean ring = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
boolean ringRepeat = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
boolean allowOpen = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     </span></span><font></font>
<font></font>
RCSwitch mySwitch = RCSwitch();<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openDoor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
    <font></font>
    digitalWrite(handsetPin, LOW);<font></font>
    delay(handsetDelay);<font></font>
    digitalWrite(openPin, LOW);<font></font>
    delay(openDelay);<font></font>
    digitalWrite(openPin, HIGH);<font></font>
    digitalWrite(handsetPin, HIGH);<font></font>
    ring = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
    allowOpen = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
    <span class="hljs-comment"><span class="hljs-comment">// sendMail(37); //           </span></span><font></font>
}<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  mySwitch.enableTransmit(txPin); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  pinMode(handsetPin, OUTPUT); <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
  pinMode(openPin, OUTPUT);<font></font>
  pinMode(ringPin, INPUT_PULLUP  );<font></font>
  digitalWrite(handsetPin, HIGH); <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
  digitalWrite(openPin, HIGH);<font></font>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"Ready"</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (digitalRead(ringPin) == LOW &amp;&amp; ring == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//            </span></span>
    ring = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
    ringTime = millis();<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// sendMail(36); //     </span></span>
    mySwitch.send(ringCode, <span class="hljs-number"><span class="hljs-number">24</span></span>);<font></font>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"Sent ringCode"</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ringRepeat == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
      mySwitch.send(doorBell, <span class="hljs-number"><span class="hljs-number">24</span></span>);<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"DoorBell repeat"</span></span>);<font></font>
    }<font></font>
    Serial.println(<span class="hljs-string"><span class="hljs-string">"Ring-ring!"</span></span>);<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - ringTime) &gt; ringTimeOut &amp;&amp; ring == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   40  (   )    </span></span>
  ring = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"Ring reset"</span></span>);
  <span class="hljs-comment"><span class="hljs-comment">// sendMail(38); //      </span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ring == <span class="hljs-literal"><span class="hljs-literal">true</span></span> &amp;&amp; allowOpen == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  openDoor(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"Door opened via net"</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ring == <span class="hljs-literal"><span class="hljs-literal">false</span></span> &amp;&amp; allowOpen == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  ""   </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - openTime) &gt; openTimeOut) { <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
   allowOpen = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; 
   <span class="hljs-comment"><span class="hljs-comment">// sendMail(39); //     </span></span><font></font>
  }<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.available()) { <span class="hljs-comment"><span class="hljs-comment">//</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value = mySwitch.getReceivedValue();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value != <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
      Serial.println(mySwitch.getReceivedValue());<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (mySwitch.getReceivedValue()) {<font></font>
        <font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> openCode: <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ring == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
            mySwitch.disableReceive();<font></font>
            openDoor(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
            Serial.println(<span class="hljs-string"><span class="hljs-string">"Door opened via radio"</span></span>);<font></font>
            mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
          }<font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;<font></font>
    }<font></font>
    mySwitch.resetAvailable();<font></font>
  }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
}<font></font>
<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mengambil gambar untuk antarmuka di situs web </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pixabay yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indah </font><font style="vertical-align: inherit;">.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id400367/">https://habr.com/ru/post/id400367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id400357/index.html">Google menunjukkan pola amal tiga manfaat</a></li>
<li><a href="../id400359/index.html">Propriosepsi untuk non-spesialis. Bagian 3. Dinamis duduk di kursi</a></li>
<li><a href="../id400361/index.html">Foreve Elon 2016/2017 (Malam Tahun Baru online)</a></li>
<li><a href="../id400363/index.html">Menyelam dalam: dari CSS ke transistor</a></li>
<li><a href="../id400365/index.html">Apa yang menjanjikan pengguna VKontakte pada tahun 2017</a></li>
<li><a href="../id400371/index.html">2017 bukan hanya ...</a></li>
<li><a href="../id400377/index.html">Ikhtisar materi 3D saat ini</a></li>
<li><a href="../id400379/index.html">Bagaimana kami mengatur pencarian di Telegram, dan apa yang terjadi. UPD: kami menyimpulkan hasil kompetisi</a></li>
<li><a href="../id400381/index.html">Merancang catu daya switching dengan KKM aktif. Episode I</a></li>
<li><a href="../id400383/index.html">Resampling. Dinding bata digital melawan teori konspirasi. Kisah Natal untuk pecinta suara jernih</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>