<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜ğŸ¿ ğŸ‚ğŸ¾ ğŸ¤ŸğŸ¿ å…·æœ‰I2Cæ€»çº¿çš„Arduinoæ“ä½œå‘˜é¢æ¿ï¼ˆHMIï¼‰ â›“ï¸ ğŸŒ… â›¹ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½œä¸ºä½¿ç”¨æŸäº›ä¸arduinoå…¼å®¹çš„è®¾å¤‡ï¼ˆæœ€åæ˜¯å…³äºå®ƒçš„éƒ¨åˆ†ï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªå¸¦æœ‰æŒ‰é’®çš„å±å¹•æ¥æ§åˆ¶å’Œæ˜¾ç¤ºå½“å‰ä¿¡æ¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦æ“ä½œå‘˜é¢æ¿ï¼Œå®ƒä¹Ÿæ˜¯HMIã€‚ 

 å†³å®šç‹¬ç«‹åˆ¶ä½œHMIï¼Œå¹¶ä½¿ç”¨â€œæ–¹å½¢â€ i2cæ€»çº¿ä½œä¸ºæ¥å£ã€‚ 



 å¦‚æœæ‚¨å¯¹æ­¤ç±»è®¾å¤‡çš„å¼€å‘å’Œç¼–ç¨‹è¿‡ç¨‹æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è”ç³»catã€‚ 

 ç‰¹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å…·æœ‰I2Cæ€»çº¿çš„Arduinoæ“ä½œå‘˜é¢æ¿ï¼ˆHMIï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401587/"> ä½œä¸ºä½¿ç”¨æŸäº›ä¸arduinoå…¼å®¹çš„è®¾å¤‡ï¼ˆæœ€åæ˜¯å…³äºå®ƒçš„éƒ¨åˆ†ï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªå¸¦æœ‰æŒ‰é’®çš„å±å¹•æ¥æ§åˆ¶å’Œæ˜¾ç¤ºå½“å‰ä¿¡æ¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦æ“ä½œå‘˜é¢æ¿ï¼Œå®ƒä¹Ÿæ˜¯HMIã€‚ <br><br> å†³å®šç‹¬ç«‹åˆ¶ä½œHMIï¼Œå¹¶ä½¿ç”¨â€œæ–¹å½¢â€ i2cæ€»çº¿ä½œä¸ºæ¥å£ã€‚ <br><br><img src="https://habrastorage.org/files/3e6/4e6/24e/3e64e624ed5741d9a37eea535359c671.jpg"><br><br> å¦‚æœæ‚¨å¯¹æ­¤ç±»è®¾å¤‡çš„å¼€å‘å’Œç¼–ç¨‹è¿‡ç¨‹æ„Ÿå…´è¶£ï¼Œæ¬¢è¿è”ç³»catã€‚ <br><a name="habracut"></a><br> ç‰¹ç‚¹ <br><br><ul><li> æ˜¾ç¤º1602ï¼Œå•è‰²16x2å­—ç¬¦ </li><li>  5ä¸ªæŒ‰é’®ï¼šå‘ä¸Šï¼Œå‘ä¸‹ï¼Œå–æ¶ˆï¼Œè¾“å…¥ï¼Œç¼–è¾‘ </li><li>  I2cæ¥å£ </li><li>  DB9Fè¿æ¥å™¨ </li><li> å°ºå¯¸155x90x44æ¯«ç±³ </li></ul><br> æœ‰æ˜æ˜¾çš„é—®é¢˜ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ä¸ºä»€ä¹ˆä¸ä¹°ç°æˆçš„ç›¾ç‰Œå‘¢ï¼Ÿ</b> <div class="spoiler_text"> å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ˜¾ç¤ºå±å’Œé”®ç›˜ä»åŒä¸€ä¸­æ–‡è´­ä¹°ç°æˆçš„ç›¾ç‰Œï¼Œä¾‹å¦‚ï¼š <br><img src="https://habrastorage.org/files/c7b/06a/03d/c7b06a03dff44d12bf25dddc779b2a82.jpg"><br> æ‚¨å¯ä»¥åœ¨æ­¤å±è”½å±‚ä¸Šç„Šæ¥2æ¡FC-113å›´å·¾ï¼Œå…¶åŠŸèƒ½ä¸æˆ‘çš„å±è”½å±‚ç›¸åŒï¼šå¸¦i2cé”®ç›˜çš„æ˜¾ç¤ºå™¨ã€‚ å¥—è£…çš„ä»·æ ¼ä»$ 4ã€‚ <br><br> ä½†æ˜¯åœ¨æ­¤æ¿ä¸Šï¼ŒæŒ‰é’®çš„å°ºå¯¸ä¸é€‚åˆæˆ‘ï¼Œä½†æˆ‘å¸Œæœ›å¤§å‹æŒ‰é’®èƒ½å¤Ÿå®‰è£…å¤šè‰²ç›–ã€‚ æˆ‘ä¸æƒ³ä½¿ç”¨æ™®é€šçš„DB9Fè¿æ¥å™¨å°†Arduinoè¿æ¥åˆ°HMIï¼Œä½†æ˜¯æœ‰å¿…è¦åˆ¶ä½œä¸€ä¸ªè¿æ¥æ¿ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ¶ä½œä¸€ä¸¤ä¸ªæ¿æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ æ­¤å¤–ï¼Œæˆ‘å·²ç»æœ‰å‡ å°1602æ˜¾ç¤ºå™¨åº“å­˜ï¼Œå› æ­¤æˆ‘åªéœ€è¦èŠ±è´¹1.02ç¾å…ƒå°±å¯ä»¥åœ¨Aliexpressä¸Šè´­ä¹°FC-113ï¼ˆ0.55ç¾å…ƒï¼‰å’ŒPCF8574Pç«¯å£æ‰©å±•å™¨ï¼ˆ0.47ç¾å…ƒï¼‰ã€‚ <br><br> å¥½å§ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œå¦‚æœæ‚¨è¦å¤„ç†çš„æ˜¯Arduinoï¼Œé‚£ä¹ˆä¸ºä»–ç‹¬ç«‹åˆ¶é€ å±è”½ç½©æ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œå¯¹å—ï¼Ÿ <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ä¸ºä»€ä¹ˆä½¿ç”¨i2cæ€»çº¿ï¼Œç›´æ¥è¿æ¥æŒ‰é’®æ˜¯å¦æ›´å®¹æ˜“ï¼Ÿ</b> <div class="spoiler_text"> åœ¨æˆ‘å·¥ä½œçš„å·¥ä¸šæ§åˆ¶ç³»ç»Ÿé¢†åŸŸï¼ŒHMIä½¿ç”¨æ•°å­—æ•°æ®ä¼ è¾“æ¥å£RS-232ï¼ŒRS-485ï¼ŒCANç­‰ä¸è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚ å› æ­¤ï¼Œå¯¹äºæˆ‘è€Œè¨€ï¼Œæˆ‘è‡ªå·±çš„HMI <i>éƒ½</i>å¯ä»¥åœ¨æ•°æ®æ¥å£ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºi2cï¼‰ä¸Šå·¥ä½œï¼Œè¿™æ˜¯åˆä¹é€»è¾‘çš„ã€‚ <br><br> å¦‚æœæˆ‘åˆ¶é€ äº†ä¸€ç§æ˜¾ç¤ºå™¨å¯ä»¥åœ¨æ–¹å½¢æ€»çº¿ä¸Šå·¥ä½œçš„è®¾å¤‡ï¼Œå¹¶ä¸”æŒ‰é’®ç›´æ¥è¿›å…¥äº†Arduinoçš„è¾“å…¥ï¼Œé‚£ä¼šè®©æˆ‘æ„Ÿåˆ°éå¸¸ä¸æ»¡æ„ã€‚ æ­£å¦‚æˆ‘å°†è¦å‘ˆç°çš„è¿™å¼ å›¾ç‰‡ï¼šä¸€æ¡å•ç‹¬çš„ç”µçº¿ä»é¢æ¿ä¼¸å‡ºåˆ°æ¥å£ï¼Œåˆ†å¼€çš„ç”µçº¿æ¥åˆ°è¾“å…¥ï¼Œbrrrr ... <br><br> æ­¤å¤–ï¼Œç›´æ¥è¿›å…¥Arduinoè¾“å…¥çš„æŒ‰é’®æ¿ä¸å…·æœ‰i2cæ¥å£çš„æŒ‰é’®æ¿ä¹‹é—´çš„åŒºåˆ«ä»…åœ¨äºPCF8574PèŠ¯ç‰‡ï¼ˆ0.47ç¾å…ƒï¼‰ï¼Œä¸€ä¸ªç”µå®¹å™¨å’Œä¸¤ä¸ªç”µé˜»å™¨ã€‚ <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ä¸ºä»€ä¹ˆæŒ‰é’®æ’åˆ—æˆè¿™æ ·è€Œä¸æ˜¯å…¶ä»–ï¼Ÿ</b> <div class="spoiler_text"> ä»å·¦åˆ°å³çš„æŒ‰é’®å…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼šä¸Šï¼Œä¸‹ï¼Œå–æ¶ˆï¼Œè¾“å…¥ï¼Œç¼–è¾‘ã€‚ <br> å°†â€œç¼–è¾‘â€æŒ‰é’®ä»å…¶ä»–æŒ‰é’®ç§»å¼€ä¸€ç‚¹ï¼Œä»¥å¼ºè°ƒå…¶åŠŸèƒ½-æ›´æ”¹é€»è¾‘å‚æ•°çš„å€¼ï¼ˆæ‰“å¼€/å…³é—­ï¼‰ï¼Œæˆ–åœ¨æ•°å­—å‚æ•°çš„æƒ…å†µä¸‹åˆ‡æ¢åˆ°ç¼–è¾‘æ¨¡å¼ã€‚ <br><br> å°½ç®¡é”®ç›˜ä¸Šçš„èŠ¯ç‰‡æœ€å¤šå¯ä»¥è¿æ¥8ä¸ªéƒ¨ä»¶ï¼Œä½†æ€»å…±æœ‰5ä¸ªæŒ‰é’®ã€‚ <br> ä½¿ç”¨å››ä¸ªæŒ‰é’®å°±è¶³å¤Ÿäº†ï¼Œå¹¶ä¸”åŠŸèƒ½ä¸ä¼šå—åˆ°å½±å“-â€œè¾“å…¥â€å’Œâ€œç¼–è¾‘â€å¯ä»¥ç»„åˆåœ¨ä¸€ä¸ªæŒ‰é’®ä¸­ã€‚ ä½†æ˜¯ï¼Œæˆ‘åªæ˜¯æ„Ÿåˆ°é—æ†¾ï¼Œç«¯å£æ‰©å±•å™¨å¾®ç”µè·¯çš„8æ¡æ”¯è·¯ä¸­æœ‰ä¸€åŠæ²¡æœ‰å‚ä¸ã€‚ <br> å¦‚æœæˆ‘å†³å®šåœ¨ä¸€è¡Œä¸­æ˜¾ç¤ºå¤šä¸ªå‚æ•°ï¼Œåˆ™å¦ä¸€ä¸ªå•ç‹¬çš„â€œç¼–è¾‘â€æŒ‰é’®å¯èƒ½å¾ˆæœ‰ç”¨ã€‚ ç„¶åï¼Œä½¿ç”¨æ­¤æŒ‰é’®å¯ä»¥åœ¨å‚æ•°ä¹‹é—´åˆ‡æ¢ï¼Œä»¥æŒ‡ç¤ºéœ€è¦æ›´æ”¹çš„å‚æ•°ã€‚ è¿™å°±æ˜¯æµè¡Œçš„ä¸­æ–‡HMI OP320ä¸­â€œ SETâ€æŒ‰é’®çš„å·¥ä½œæ–¹å¼ã€‚ <br><br> å¦‚æœå‰ä¸¤ä¸ªæŒ‰é’®æ˜¯å‘ä¸Šå’Œå‘ä¸‹çš„æ„æ€ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸å°†å®ƒä»¬å‚ç›´æ”¾ç½®ï¼Œä¾‹å¦‚åœ¨ä¸Šé¢çš„ä¸­å›½ç›¾ç‰Œä¸­é‚£æ ·å‘¢ï¼Ÿ <br><br> å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œå°†æ‰€æœ‰æŒ‰é’®éƒ½æ°´å¹³æ”¾ç½®ä¼šæ›´æ–¹ä¾¿ï¼Œç„¶ååœ¨æ“ä½œè¿‡ç¨‹ä¸­æ‰‹æŒ‡åªèƒ½åœ¨ä¸€ä¸ªå¹³é¢ä¸Šç§»åŠ¨ã€‚ <br></div></div><br><h4>  <b>é“</b> </h4><br><img src="https://habrastorage.org/files/fdf/110/dee/fdf110deea844523baaf7fed5e5d7f67.jpg"><br><br><img src="https://habrastorage.org/files/d2e/39d/084/d2e39d0848924a5b9d2d3e1e8952462c.jpg"><br><br>  1.å¸¦æœ‰DB9Fè¿æ¥å™¨çš„è‡ªåˆ¶åº•æ¿ã€‚ å› æ­¤ï¼Œå½“æˆ‘ä»¬ä¸ºArduinoçš„ç«¯å£å’Œæ˜¾ç¤ºæ‰©å±•å™¨ä½¿ç”¨+ 5Vç”µæºæ—¶ï¼Œæˆ‘åœ¨æ¿ä¸Šæ”¾ç½®äº†0.1 Aä¿é™©ä¸ <br><br>  2.ä¼—æ‰€å‘¨çŸ¥ï¼Œä¼—æ‰€å‘¨çŸ¥çš„1602æ˜¾ç¤ºå™¨å¸¦æœ‰FC-113ç„Šæ¥æ¿ï¼Œå¯å°†æ˜¾ç¤ºå™¨è¿æ¥åˆ°i2cæ€»çº¿ã€‚ <br><br>  3.å¸¦æœ‰PCF8574PèŠ¯ç‰‡çš„è‡ªåˆ¶é”®ç›˜æ¿ï¼Œå®ƒå°†è¯»å–æŒ‰é’®çš„çŠ¶æ€å¹¶é€šè¿‡i2cæ€»çº¿è¿›è¡Œä¼ è¾“ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼ŒFC-113â€œæ˜¾ç¤ºâ€æ¿ä¹ŸåŸºäºPCF8574èŠ¯ç‰‡ï¼Œä»…å…·æœ‰Tç´¢å¼•ï¼Œå³ å¹³é¢ï¼Œè€Œä¸æ˜¯DIPï¼Œä¾‹å¦‚PCF8574Pã€‚ <br><br> æˆ‘åœ¨æŒ‰é’®ä¸Šæ”¾äº†12h12mmçš„æ–¹å½¢æŒ‰é’®ï¼›å¯ä»¥åœ¨ä¸Šé¢æˆ´ä¸Šå½©è‰²çš„å¤§å·å¸½ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è‡ªåˆ¶ç”µè·¯æ¿çš„ç…§ç‰‡å’Œæ–¹æ¡ˆ</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d9a/41d/043/d9a41d0435244acc995795055522501c.jpg"><br><br><img src="https://habrastorage.org/files/a8a/faa/a15/a8afaaa15f16482a8eac22c8a99f5db2.jpg"><br><br><img src="https://habrastorage.org/files/693/76e/475/69376e475bc4455da8658553b0edbd1c.jpg"><br></div></div><br> å€¼å¾—ä¸€æçš„æ˜¯PCF8574PèŠ¯ç‰‡ï¼Œæˆ‘ä»¥æ­¤ä¸ºåŸºç¡€åˆ¶ä½œäº†é”®ç›˜æ¿ã€‚ <br>  PCF8574Pæ˜¯i2cç«¯å£æ‰©å±•å™¨ã€‚ å…±æœ‰8ä¸ªç«¯å£ï¼Œæ¯ä¸ªç«¯å£éƒ½å¯ä»¥é…ç½®ä¸ºè¾“å…¥æˆ–è¾“å‡ºã€‚ å¯¹äºè¯¥èŠ¯ç‰‡ï¼Œä¸éœ€è¦è¿™æ ·çš„æ†æ‰ï¼ˆä¾‹å¦‚ï¼Œè¯·è®°ä½max232ï¼‰ï¼Œä»¥é˜²ä¸‡ä¸€æˆ‘æ”¾äº†ä¸€ä¸ªç”µå®¹å™¨æ¥ä¾›ç”µã€‚ <br><br>  PCF8574PèŠ¯ç‰‡çš„åœ°å€ä½¿ç”¨åœ°å€å¼•è„šA0ï¼ŒA1ï¼ŒA2è¿›è¡Œè®¾ç½®ï¼Œè¿™äº›åœ°å€å¼•è„šé€šè¿‡10kÎ©ç”µé˜»æ‹‰è‡³åœ°é¢æˆ–ç”µæºã€‚ <br><br> åœ¨é”®ç›˜æ¿ä¸Šï¼Œæˆ‘å°†PCF8574Pçš„æ‰€æœ‰åœ°å€è…¿éƒ½æ”¾åœ¨äº†åœ°ä¸Šï¼Œå› æ­¤è¯¥åœ°å€è¢«ç¡¬ç¼–ç ä¸º0x20ï¼Œå¹¶ä¸”æ‚¨æ— æ³•æ›´æ”¹ã€‚ <br><br> æ­£å¦‚æˆ‘å·²ç»å†™è¿‡çš„ï¼Œæˆ‘é€‰æ‹©DB9Fä½œä¸ºHMIçš„è¿æ¥å™¨ã€‚  Arduinoä»+5 Vï¼ŒGNDï¼ŒSDAï¼ŒSCLæ¥æ”¶ä¿¡å·ã€‚ <br><br><img src="https://habrastorage.org/files/b9b/46d/b11/b9b46db117ea4418acc54be7f35db069.jpg"><br><br> é€šè¿‡Arduino i2cå’ŒHMIè¿›è¡Œé€šä¿¡çš„å¯¼çº¿é•¿1.4 mï¼Œå·¥ä½œæ—¶æ— æ¯›åˆºã€‚ <br><br> æˆ‘åœ¨Sprint Layout 6ä¸­ç»˜åˆ¶äº†æœ¨æ¿ï¼Œå¹¶ä½¿ç”¨LUTæ–¹æ³•å°†å…¶è½¬ç§»åˆ°äº†Textoliteä¸Šï¼Œå¹¶åœ¨è¿‡æ°§åŒ–ç‰©å’ŒæŸ æª¬é…¸æº¶æ¶²ä¸­å¯¹å…¶è¿›è¡Œèš€åˆ»ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å…³äºè…Œåˆ¶çš„ä¸€äº›çŸ¥è¯†</b> <div class="spoiler_text"> åœ¨é“ç®”ç»ç’ƒçº¤ç»´ä¸Šèš€åˆ»æŸ æª¬é…¸æ¿æœ‰å¾ˆå¤šæ–¹æ³•ã€‚ <br><br> æˆ‘é…åˆ¶äº†è¿™ç§æº¶æ¶²ï¼š100æ¯«å‡3ï¼…çš„è¿‡æ°§åŒ–æ°¢ï¼Œ50å…‹æŸ æª¬é…¸ï¼Œ3èŒ¶åŒ™ç›ã€‚ ä»–ç”¨æ°´å°†é”…ä¸­çš„è¿‡æ°§åŒ–ç‰©ç½åŠ çƒ­åˆ°çº¦70åº¦ã€‚ <br><br> æ ¹æ®è¿‡æ°§åŒ–ç‰©èš€åˆ»çš„å»ºè®®ï¼Œæˆ‘ä»¬å°†ç”µè·¯æ¿æµ¸å…¥æº¶æ¶²ä¸­ï¼Œä½¿å›¾æ¡ˆæœä¸‹ã€‚ <br> å‡ åç§’åï¼Œä¸€ä¸ªé£æš´å¼€å§‹ã€‚ é‡Šæ”¾å‡ºå¤§é‡è’¸æ±½ï¼Œä¸å»ºè®®å¸å…¥ã€‚ å¤§æ¦‚å§ <br><br><img src="https://habrastorage.org/files/54a/f92/248/54af9224862547c1a6e41f57d73c0794.jpg"><br><br> ç„¶åè¯¥è¿‡ç¨‹æ¶ˆé€€ã€‚ ç¿»è½¬æ¿ã€‚ <br><br><img src="https://habrastorage.org/files/e84/801/c1a/e84801c1a7bc43e998f586b8241b202a.jpg"><br><br> åšå®Œäº† <br><br><img src="https://habrastorage.org/files/101/9ec/44e/1019ec44edc945559d4f6b02514077c5.jpg"><br></div></div><br> è¯¥ç›’å­æ˜¯ç”±4æ¯«ç±³æœ‰æœºç»ç’ƒçš„æœ‹å‹ç”¨æ¿€å…‰åˆ‡å‰²æœºåˆ¶æˆçš„ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å…³äºå…µå›¢çš„æŠ’æƒ…ç¦»é¢˜</b> <div class="spoiler_text"> ä¹°å®Œç®±å­è¿˜æ˜¯è‡ªå·±åšï¼Ÿ ç»è¿‡ä¸€ç•ªæ€è€ƒï¼Œæˆ‘å†³å®šè‡ªå·±åšã€‚ æˆ‘åœ¨é”€å”®ä¸­çœ‹åˆ°çš„é‚£äº›ç”±äºä»·æ ¼æˆ–ç¾å­¦åŸå› è€Œä¸é€‚åˆæˆ‘ï¼Œæˆ–è€…åœ¨DINå¯¼è½¨ä¸Šä¹Ÿä¸é€‚åˆæˆ‘ã€‚ <br><br> æœ€åˆï¼Œå°¸ä½“æƒ³ä»èƒ¶åˆæ¿ä¸Šåˆ‡ä¸‹ã€‚ ä½†æ˜¯åæ¥æˆ‘æƒ³èµ·äº†æˆ‘æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æœ‹å‹ï¼Œå¹¶ä¸”ä»¤æˆ‘é«˜å…´çš„æ˜¯ä¸€å®¶ä½“è‚²é¢å¥–å…¬å¸çš„è‘£äº‹ã€‚ ä»–åœ¨é‚£é‡Œæ‹¥æœ‰å„ç§æœºå™¨ï¼ŒåŒ…æ‹¬æ¿€å…‰åˆ‡å‰²æœºã€‚ <br><br> ä»–å¯»æ±‚å¸®åŠ©ï¼Œä¸€ä¸ªæœ‹å‹æ²¡æœ‰æ‹’ç»ï¼Œç”¨æ¿€å…‰åˆ‡å‰²äº†å‡ åˆ†é’Ÿåï¼Œé›¶ä»¶è¢«æ‹’ç»äº†ã€‚ <br><br> å€Ÿæ­¤æœºä¼šï¼Œæˆ‘è¦è¯´è°¢è°¢ï¼Œç§‘é‡Œäºšï¼ å¦åˆ™ï¼Œæˆ‘å°†ä¸å¾—ä¸æ•´å¤©åˆ‡å‰²å’Œç ”ç£¨èƒ¶åˆæ¿ï¼Œå…¶ç»“æœå°†ä¸ä¼šå¦‚æ­¤å‡ºè‰²ã€‚ </div></div><br><h4>  <b>ç¨‹å¼è®¾è®¡</b> </h4><br> ä»Arduinoçš„è§’åº¦æ¥çœ‹ï¼Œæ­¤HMIç”±åœ¨i2cæ€»çº¿ä¸Šå·¥ä½œçš„2ä¸ªè®¾å¤‡ç»„æˆï¼šåœ°å€ä¸º0x27çš„æ˜¾ç¤ºå™¨ï¼ˆLCDï¼‰å’Œåœ°å€ä¸º0x20çš„é”®ç›˜ã€‚ å› æ­¤ï¼ŒArduinoå°†åˆ†åˆ«ä¸é”®ç›˜å’ŒLCDé…åˆä½¿ç”¨ã€‚ <br><br> é€šè¿‡ä¸“ç”¨åº“â€œ LiquidCrystal_I2C.hâ€è¿›è¡ŒLCDçš„æ“ä½œï¼Œå¿…é¡»å°†å…¶å®‰è£…åœ¨Aduino IDEä¸­ã€‚ <br><br> é”®ç›˜çš„æ“ä½œé€šè¿‡æ ‡å‡†çš„Wire.håº“å®Œæˆï¼Œè¯¥åº“æœ€åˆåœ¨Aduino IDEä¸­å¯ç”¨ã€‚ <br><br> æˆ‘ä»¬å°†HMIè¿æ¥åˆ°Ardiunoã€‚ <br><br><img src="https://habrastorage.org/files/cd7/c58/0c1/cd7c580c192e4cac95a2eda6d5cd8756.jpg"><br><br>  1.é¦–å…ˆï¼Œæ£€æŸ¥Arduinoæ˜¯å¦çœ‹åˆ°æˆ‘ä»¬çš„HMIã€‚ ä¸ºæ­¤ï¼Œå°†ç¨‹åºåŠ è½½åˆ°å…¶ä¸­ï¼Œè¯¥ç¨‹åºå°†æ‰«æi2cæ€»çº¿ä¸Šçš„è®¾å¤‡ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è‰å›¾1ï¼ŒI2Cæ€»çº¿æ‰«æ</b> <div class="spoiler_text"><pre><code class="hljs pgsql">//i2c_scaner #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;Wire.h&gt; String stringOne; <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { Wire.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(<span class="hljs-number"><span class="hljs-number">9600</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!<span class="hljs-type"><span class="hljs-type">Serial</span></span>); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { byte error, address; <span class="hljs-type"><span class="hljs-type">int</span></span> nDevices; <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("Scanning..."); nDevices = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(address = <span class="hljs-number"><span class="hljs-number">1</span></span>; address &lt; <span class="hljs-number"><span class="hljs-number">127</span></span>; address++ ) { Wire.beginTransmission(address); error = Wire.endTransmission(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error == <span class="hljs-number"><span class="hljs-number">0</span></span>) { String stringOne = String(address, HEX); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print("0x"); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print(stringOne); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print(" - "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="0A") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'Motor Driver'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="0F") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'Motor Driver'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="1D") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADXL345 Input 3-Axis Digital Accelerometer'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="1E") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'HMC5883 3-Axis Digital Compass'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="5A") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'Touch Sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="5B") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'Touch Sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="5C") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'BH1750FVI digital Light Sensor' OR 'Touch Sensor" ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="5D") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'Touch Sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="20") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander' OR 'LCM1602 LCD Adapter' "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="21") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="22") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="23") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander' OR 'BH1750FVI digital Light Sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="24") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="25") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="26") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="27") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'PCF8574 8-Bit I/O Expander' OR 'LCM1602 LCD Adapter '"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="39") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'TSL2561 Ambient Light Sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="40") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'BMP180 barometric pressure sensor'" ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="48") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADS1115 Module 16-Bit'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="49") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADS1115 Module 16-Bit' OR 'SPI-to-UART'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="4A") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADS1115 Module 16-Bit'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="4B") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADS1115 Module 16-Bit'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="50") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'AT24C32 EEPROM'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="53") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'ADXL345 Input 3-Axis Digital Accelerometer'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="68") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'DS3231 real-time clock' OR 'MPU-9250 Nine axis sensor module'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="7A") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'LCD OLED 128x64'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="76") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'BMP280 barometric pressure sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="77") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'BMP180 barometric pressure sensor' OR 'BMP280 barometric pressure sensor'"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(stringOne=="78") <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("'LCD OLED 128x64'" ); nDevices++; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error==<span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print("Unknow error at address 0x"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (address&lt;<span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-type"><span class="hljs-type">Serial</span></span>.print("0"); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println(address,HEX); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nDevices == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("No I2C devices found\n"); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("done\n"); delay(<span class="hljs-number"><span class="hljs-number">5000</span></span>); }</code> </pre> <br></div></div><br> åœ¨æ‰§è¡Œæ­¤ç¨‹åºæœŸé—´ï¼ŒArduinoå°†i2cæ€»çº¿çš„æ‰«æç»“æœå†™å…¥ä¸²è¡Œç«¯å£ã€‚ è¦æŸ¥çœ‹æ­¤æ•°æ®ï¼Œè¯·è½¬åˆ°Arduino IDEå·¥å…·-&gt;ç«¯å£ç›‘è§†å™¨ã€‚ <br><br><img src="https://habrastorage.org/files/cb1/fe9/19c/cb1fe919c65f484bb7d431cae64e87ec.jpg"><br><br> æˆ‘ä»¬çœ‹åˆ°i2cæ€»çº¿ä¸Šçš„Arduinoè¯†åˆ«äº†ä¸¤ä¸ªåœ°å€ä¸º0x20å’Œ0x27çš„è®¾å¤‡ï¼Œåˆ†åˆ«æ˜¯é”®ç›˜å’ŒLCDã€‚ <br><br>  2.ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é”®ç›˜çš„å·¥ä½œåŸç†ã€‚ åˆ›å»ºä¸€ä¸ªç¨‹åºï¼Œè¯¥ç¨‹åºå°†è½®è¯¢æŒ‰é’®çš„çŠ¶æ€å¹¶å°†å…¶æ˜¾ç¤ºåœ¨LCDä¸Šã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è‰å›¾2ï¼Œæ˜¾ç¤ºæŒ‰é’®çš„çŠ¶æ€</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">/*   LCD     i2c LCD    FC-113,  0x27      PCF8574P,  0x20 */</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;LiquidCrystal_I2C.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;Wire.h&gt; #define led <span class="hljs-number"><span class="hljs-number">13</span></span> #define ADDR_KBRD <span class="hljs-number"><span class="hljs-number">0x20</span></span> #define ADDR_LCD <span class="hljs-number"><span class="hljs-number">0x27</span></span> byte dio_in; <span class="hljs-type"><span class="hljs-type">bool</span></span> b; <span class="hljs-type"><span class="hljs-type">bool</span></span> key[<span class="hljs-number"><span class="hljs-number">5</span></span>]; LiquidCrystal_I2C lcd(ADDR_LCD,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>); //   <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { pinMode(led, OUTPUT); // lcd.init(); lcd.backlight();//    // Wire.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(); Wire.beginTransmission(ADDR_KBRD); Wire.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(B11111111); //   PCF8574P     Wire.endTransmission(); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { Wire.requestFrom(ADDR_KBRD,<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!Wire.available()); byte dio_in = Wire.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(); //   PCF8574P() //      byte mask=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>;i++) { key[i]=!(dio_in &amp; mask); mask=mask&lt;&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>; } b=!b; digitalWrite(led, b); //    //    LCD lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(String(key[<span class="hljs-number"><span class="hljs-number">0</span></span>])+" "+ String(key[<span class="hljs-number"><span class="hljs-number">1</span></span>])+" "+ String(key[<span class="hljs-number"><span class="hljs-number">2</span></span>])+" "+ String(key[<span class="hljs-number"><span class="hljs-number">3</span></span>])+" "+ String(key[<span class="hljs-number"><span class="hljs-number">4</span></span>])+" "); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); }</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/450/92f/cf3/45092fcf30ff4986bacf1bf3891ff58e.jpg"><br><br> é”®ç›˜æ­£åœ¨å·¥ä½œã€‚ <br><br>  3.æœ€åï¼Œæ‚¨å¯ä»¥ç»§ç»­è¿›è¡Œæ‰€æœ‰æ“ä½œï¼›åœ¨Arduinoä¸­åˆ›å»ºä¸€ä¸ªå¤šçº§èœå•ã€‚ é€šè¿‡èœå•ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥è§‚çœ‹ä¿¡æ¯ï¼Œè¿˜å¯ä»¥æ§åˆ¶Arduinoæœ¬äººçš„è¾“å‡ºã€‚ <br><br><img src="https://habrastorage.org/files/570/c95/a3b/570c95a3b830423e827c7ac3b68605bf.jpg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xBZAx9ewLq4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br> åœ¨neteä¸­ï¼Œæœ‰å¾ˆå¤šæœ‰å…³åœ¨C ++ä¸­åˆ›å»ºå¤šçº§èœå•çš„ä¿¡æ¯ï¼Œä½†æ˜¯å¯¹äºArduinoï¼Œæˆ‘ä»€è‡³çœ‹åˆ°äº†ä¸€äº›åº“ã€‚ ä½†æ˜¯æˆ‘å†³å®šåœ¨ç¨‹åºä¸­è‡ªå·±ç¼–å†™èœå•ã€‚ é¦–å…ˆï¼Œé¡¹ç›®ä¸­å‰©ä½™çš„å›¾ä¹¦é¦†è¶Šå°‘è¶Šå®‰é™ã€‚ å…¶æ¬¡ï¼Œè¿™å¾ˆç®€å•ã€‚ <br><br> æˆ‘å¾—åˆ°äº†æ ‘å½¢èœå•çš„å¦ä¸€ç§å˜åŒ–ã€‚ è¯¥èœå•å…è®¸æ‚¨åŒæ—¶åœ¨æ¯ä¸€è¡Œä¸­æ˜¾ç¤ºé™æ€æ–‡æœ¬å’Œå˜é‡å€¼ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æ˜¾ç¤ºå‚æ•°çš„åç§°åŠå…¶å€¼ã€‚ <br><br> ä¸ºäº†åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå˜é‡ï¼Œæˆ‘åº”ç”¨äº†æ ‡è®°çš„åŸç†-ä»¥æŸç§æ–¹å¼åœ¨æ–‡æœ¬ä¸­è®¾è®¡äº†æ–‡æœ¬æ ‡ç­¾ï¼Œè€Œä¸æ˜¯åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ–‡æœ¬æ—¶æ˜¾ç¤ºå€¼ã€‚ <br><br> å¯ä»¥é€šè¿‡æŒ‰â€œç¼–è¾‘â€æŒ‰é’®æ¥æ›´æ”¹å‚æ•°ã€‚ æ­¤å¤–ï¼Œæ¯ä¸ªå‚æ•°çš„æ ‡ç­¾æŒ‡ç¤ºå®ƒæ˜¯å¦å¯ç”¨äºç¼–è¾‘æˆ–åªè¯»ã€‚ å¦‚æœå½“å‰å‚æ•°æ˜¯åªè¯»çš„ï¼Œåˆ™åœ¨è¡Œçš„å¼€å¤´ï¼ŒæŒ‡é’ˆå°†ä¸ºâ€œ *â€ï¼›å¦‚æœå¯ç”¨äº†ç¼–è¾‘ï¼Œåˆ™æŒ‡é’ˆå°†å˜ä¸ºâ€œ +â€ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è‰å›¾3ï¼Œå¤šå±‚èœå•</b> <div class="spoiler_text"><pre> <code class="hljs markdown">/<span class="hljs-bullet"><span class="hljs-bullet">*  ,    LCD   i2c LCD    FC-113,  0x27      PCF8574P,  0x20 *</span></span>/ #include <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LiquidCrystal_I2C.h</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> #include <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Wire.h</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> #define led 13 //    ;  ,  ,     #define ADDR<span class="hljs-emphasis"><span class="hljs-emphasis">_KBRD 0x20 #define ADDR_</span></span>LCD 0x27 #define PORT<span class="hljs-emphasis"><span class="hljs-emphasis">_D2 2 #define PORT_</span></span>D3 3 #define PORT<span class="hljs-emphasis"><span class="hljs-emphasis">_D4 4 #define POINT_</span></span>ON<span class="hljs-emphasis"><span class="hljs-emphasis">_ROOT_</span></span>MENU<span class="hljs-emphasis"><span class="hljs-emphasis">_ITEM 0 // 0/1= /   (*  +)     byte dio_</span></span>in; bool b; byte i; //bool ,      bool BoolVal[<span class="hljs-string"><span class="hljs-string">9</span></span>]={0,0,0, 0,0,0, 0,0,0}; #define ValSvet1 BoolVal[<span class="hljs-string"><span class="hljs-string">0</span></span>] #define ValSvet2 BoolVal[<span class="hljs-string"><span class="hljs-string">1</span></span>] #define ValSvet3 BoolVal[<span class="hljs-string"><span class="hljs-string">2</span></span>] #define ValRozetka1 BoolVal[<span class="hljs-string"><span class="hljs-string">3</span></span>] #define ValRozetka2 BoolVal[<span class="hljs-string"><span class="hljs-string">4</span></span>] #define ValRozetka3 BoolVal[<span class="hljs-string"><span class="hljs-string">5</span></span>] #define ValClapan1 BoolVal[<span class="hljs-string"><span class="hljs-string">6</span></span>] #define ValClapan2 BoolVal[<span class="hljs-string"><span class="hljs-string">7</span></span>] #define ValClapan3 BoolVal[<span class="hljs-string"><span class="hljs-string">8</span></span>] // struct STRUCT<span class="hljs-emphasis"><span class="hljs-emphasis">_KEY{ bool StateCur; //   bool StateOld; //     bool Imp; //   (  0  1) }; // STRUCT_</span></span>KEY Key[<span class="hljs-string"><span class="hljs-string">5</span></span>]={0,0,0, 0,0,0, 0,0,0, 0,0,0, 0,0,0 }; //--- /<span class="hljs-emphasis"><span class="hljs-emphasis">*   *</span></span>  , : <span class="hljs-bullet"><span class="hljs-bullet">* '#A1' bool ,  *</span></span> '#'-   bool, <span class="hljs-bullet"><span class="hljs-bullet">* 'A'- (HEX)    BoolVal, *</span></span> '1'-    <span class="hljs-bullet"><span class="hljs-bullet">*   ,       *</span></span>/ String StrNull=" "; //  String StrRoot1="COMP-MAN.INFO"; String StrRoot2="PLC-BLOG.COM.UA"; String StrSvet= ""; // String StrSvet1=" 1 #01"; String StrSvet2=" 2 #10"; String StrSvet3=" 3 #21"; String StrRozetka=""; // String StrRozetka1=" 1 #30"; String StrRozetka2=" 2 #40"; String StrRozetka3=" 3 #50"; String StrClapan=""; // String StrClapan1=" 1 #60"; // String StrClapan2=" 2 #70"; String StrClapan3=" 3 #80"; struct MENU<span class="hljs-emphasis"><span class="hljs-emphasis">_ITEM // (),   2        { byte KeyUp; //â„–  ,     "" byte KeyDwn; //â„–  ,     "" byte KeyCancel; //â„–  ,     ""(cancel) byte KeyEnter; //â„–  ,     ""(enter) byte KeyEdit; // "edit",  String *pstr1; //    () String *pstr2; //    () }; // MENU_</span></span>ITEM Menu[<span class="hljs-string"></span><span class="hljs-string"></span>]={0,0,0,1,0, &amp;StrRoot1,&amp;StrRoot2, //0   1,8,0,2,0, &amp;StrSvet,&amp;StrRozetka, //1  2,3,1,2,0, &amp;StrSvet1,&amp;StrSvet2, //2 2,4,1,3,0, &amp;StrSvet2,&amp;StrSvet3, //3 3,4,1,4,0, &amp;StrSvet3,&amp;StrNull, //4 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //5  0,0,0,0,0, &amp;StrNull,&amp;StrNull, //6 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //7 1,15,0,9,0, &amp;StrRozetka,&amp;StrClapan, //8  9,10,8,9,0, &amp;StrRozetka1, &amp;StrRozetka2, //9 9,11,8,10,0, &amp;StrRozetka2, &amp;StrRozetka3, //10 10,11,8,11,0, &amp;StrRozetka3, &amp;StrNull, //11 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //12  0,0,0,0,0, &amp;StrNull,&amp;StrNull, //13 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //14 8,15,0,16,0, &amp;StrClapan, &amp;StrNull, //15  16,17,15,0,0, &amp;StrClapan1,&amp;StrClapan2, //16 16,18,15,0,0, &amp;StrClapan2,&amp;StrClapan3, //17 17,18,15,0,0, &amp;StrClapan3,&amp;StrNull, //18 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //19  0,0,0,0,0, &amp;StrNull,&amp;StrNull, //20 0,0,0,0,0, &amp;StrNull,&amp;StrNull, //21 }; byte PosMenu=0; //  LiquidCrystal<span class="hljs-emphasis"><span class="hljs-emphasis">_I2C lcd(ADDR_</span></span>LCD,16,2); //   //   void ReadKey(byte dio<span class="hljs-emphasis"><span class="hljs-emphasis">_in) { //      byte mask=1; for(i=0; i&lt;5; i++) { Key[i].StateCur=!(dio_</span></span>in &amp; mask); mask=mask<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Key</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.Imp</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">!Key[i].StateOld</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Key</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.StateCur</span></span></span></span><span class="xml"><span class="hljs-tag">; //   (  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Key</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.StateOld</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">Key[i].StateCur;</span></span></span></span><span class="xml"><span class="hljs-tag"> } } /* *  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">UTF-8</span></span></span></span><span class="xml"><span class="hljs-tag">   ( )   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">LCD</span></span></span></span><span class="xml"><span class="hljs-tag"> *       */ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">MasRus</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">33</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">]= </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">144</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x41</span></span></span></span><span class="xml"><span class="hljs-tag">, // </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">145</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa0</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">146</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x42</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">147</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa1</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">148</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xe0</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">149</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x45</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">129</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">150</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa3</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">151</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa4</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">152</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa5</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">153</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa6</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">154</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x4b</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">155</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa7</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">156</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x4d</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">157</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x48</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">158</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x4f</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">159</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa8</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">160</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x50</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">161</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x43</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">162</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x54</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">163</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xa9</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">164</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xaa</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">165</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x58</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">166</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xe1</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">167</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xab</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">168</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xac</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">169</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xe2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">170</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xad</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">171</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xae</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">172</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xc4</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">173</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xaf</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">174</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xb0</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">175</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0xb1</span></span></span></span><span class="xml"><span class="hljs-tag"> // }; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">String</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">RusStrLCD</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">String</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">StrIn</span></span></span></span><span class="xml"><span class="hljs-tag">) { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">String</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">StrOut</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b1</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">l</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">StrIn.length();</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">l</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">++) { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b1</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">StrIn.charAt(i);</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b1</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">128</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">StrOut</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">StrOut+char(b1);</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">else</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b1</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">208)</span></span></span></span><span class="xml"><span class="hljs-tag"> //==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">208,</span></span></span></span><span class="xml"><span class="hljs-tag">     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2-</span></span></span></span><span class="xml"><span class="hljs-tag">  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag">  { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b1</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">StrIn.charAt(i+1);</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">33</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">++) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">MasRus</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">]==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">b1)</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">StrOut</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">StrOut+char(MasRus[y][1]);</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">break</span></span></span></span><span class="xml"><span class="hljs-tag">; } } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">++; } } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">return</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">StrOut</span></span></span></span><span class="xml"><span class="hljs-tag">; } //</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">---------------------------</span></span></span></span><span class="xml"><span class="hljs-tag"> //</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ASCII</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">HEX</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">---</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> dec byte StrHexToByte(char val) { byte dec=0; switch (val) { case '0': dec=0; break; case '1': dec=1; break; case '2': dec=2; break; case '3': dec=3; break; case '4': dec=4; break; case '5': dec=5; break; case '6': dec=6; break; case '7': dec=7; break; case '8': dec=8; break; case '9': dec=9; break; case 'A': dec=10; break; case 'B': dec=11; break; case 'C': dec=12; break; case 'D': dec=13; break; case 'E': dec=14; break; case 'F': dec=15; break; default: dec=0; break; } return dec; } //     void WriteLCD(byte num) { String str[]={"<span class="hljs-emphasis"><span class="hljs-emphasis">*"+*</span></span>Menu[num].pstr1,<span class="hljs-emphasis"><span class="hljs-emphasis">*Menu[num].pstr2}; if (num==0 &amp;&amp; POINT_ON_ROOT_MENU_ITEM==0) //     ? str[0].setCharAt(0,' '); // ,   //     byte NumVal; byte l; for(byte y=0; y&lt;2; y++) { l=str[y].length(); for(i=0; i&lt;l; i++) { if (str[y].charAt(i)=='#') //# bool,  off/ON { if(StrHexToByte(str[y].charAt(i+2))==1 &amp;&amp; y==0) //  ? str[y].setCharAt(0,'+'); NumVal=StrHexToByte(str[y].charAt(i+1)); str[y]=str[y].substring(0,i)+String(NumVal) ; if(BoolVal[NumVal]==0) str[y]=str[y].substring(0,i)+"off" ; if(BoolVal[NumVal]==1) str[y]=str[y].substring(0,i)+"ON" ; } if (str[y].charAt(i)=='$') //$ int,     ,      { ; } if (str[y].charAt(i)=='~') //~ ,     ,      { ; } } } //--- lcd.clear(); lcd.setCursor(0, 0); lcd.print(str[0]); lcd.setCursor(1, 1); lcd.print(str[1]); } //,       byte GoMenu(byte key) { byte PosMenuNew=PosMenu; switch (key) { case 0: PosMenuNew=Menu[PosMenu].KeyUp; break; case 1: PosMenuNew=Menu[PosMenu].KeyDwn; break; case 2: PosMenuNew=Menu[PosMenu].KeyCancel; break; case 3: PosMenuNew=Menu[PosMenu].KeyEnter; break; case 4: ; break; default: break; } return PosMenuNew; } //    "Edit" void Edit(byte posmenu) { byte NumVal; bool *</span></span>pval; String str=<span class="hljs-emphasis"><span class="hljs-emphasis">*Menu[posmenu].pstr1; byte l=str.length(); for(i=0; i&lt;l; i++) if (str.charAt(i)=='#') //#- bool,  off/ON { if(StrHexToByte(str.charAt(i+2))==1) //  ? { pval= &amp;(BoolVal[StrHexToByte(str.charAt(i+1))]); // ,    .   *</span></span>pval=!(*pval); //     } } } //     void ValToPort() { digitalWrite(PORT<span class="hljs-emphasis"><span class="hljs-emphasis">_D2,ValSvet1); digitalWrite(PORT_</span></span>D3,ValSvet2); digitalWrite(PORT<span class="hljs-emphasis"><span class="hljs-emphasis">_D4,ValSvet3); } void setup() { pinMode(led, OUTPUT); //     pinMode(PORT_</span></span>D2, OUTPUT); pinMode(PORT<span class="hljs-emphasis"><span class="hljs-emphasis">_D3, OUTPUT); pinMode(PORT_</span></span>D4, OUTPUT); //    LCD StrSvet=RusStrLCD(StrSvet); StrSvet1=RusStrLCD(StrSvet1); StrSvet2=RusStrLCD(StrSvet2); StrSvet3=RusStrLCD(StrSvet3); StrRozetka=RusStrLCD(StrRozetka); StrRozetka1=RusStrLCD(StrRozetka1); StrRozetka2=RusStrLCD(StrRozetka2); StrRozetka3=RusStrLCD(StrRozetka3); StrClapan=RusStrLCD(StrClapan); StrClapan1=RusStrLCD(StrClapan1); StrClapan2=RusStrLCD(StrClapan2); StrClapan3=RusStrLCD(StrClapan3); // lcd.init(); lcd.backlight();//    WriteLCD(PosMenu); Wire.begin(); Wire.beginTransmission(ADDR<span class="hljs-emphasis"><span class="hljs-emphasis">_KBRD); Wire.write(B11111111); //   PCF8574P     Wire.endTransmission(); } void loop() { Wire.requestFrom(ADDR_</span></span>KBRD,1); while (!Wire.available()); byte dio<span class="hljs-emphasis"><span class="hljs-emphasis">_in = Wire.read(); //   PCF8574P() ReadKey(dio_</span></span>in); //   //,    ;  ,      int KeyImp=-1; for (i=0; i<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">5;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">++) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Key</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.Imp</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1)</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">KeyImp</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">i;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Key</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.Imp</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0;</span></span></span></span><span class="xml"><span class="hljs-tag"> } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">KeyImp</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>-1) //  ? { if (KeyImp==4) // "Edit" Edit(PosMenu); PosMenu=GoMenu((KeyImp)); WriteLCD(PosMenu); } b=!b; digitalWrite(led, b); //    ValToPort(); //  delay(50); }</code> </pre><br></div></div><br><h4>  <b>LCD 1602å’Œè¯­è¨€é—®é¢˜</b> </h4><br> å¦å¤–ï¼Œæœ‰å¿…è¦æå‡ºä¿„ç½—æ–¯åŒ–é—®é¢˜ã€‚ <br><br> åœ¨æŸäº›LCD 1602çš„å­—ç¬¦ç”Ÿæˆå™¨ä¸­ï¼Œæ²¡æœ‰ä¿„æ–‡å­—æ¯ï¼Œè€Œæ˜¯ç”¨æ—¥æ–‡krakozyabryä»£æ›¿äº†ã€‚ æ— æ³•åˆ·æ–°å­—ç¬¦å‘ç”Ÿå™¨ã€‚ å› æ­¤ï¼Œæ‚¨å°†ä¸å¾—ä¸åœ¨å±å¹•ä¸Šç”¨æ‹‰ä¸å­—æ¯å†™å•è¯ï¼Œæˆ–è€…åœ¨ç¨‹åºä¸­è‡ªå·±ç¼–å†™ä¿„è¯­å­—æ¯ï¼Œå› ä¸º  LCD 1602èƒ½å¤Ÿåœ¨RAM RAMä¸­åˆ›å»ºå¹¶å­˜å‚¨æ‚¨è‡ªå·±çš„å­—ç¬¦ã€‚ ä½†æ˜¯ï¼Œåœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œæ‚¨ä¸€æ¬¡åªèƒ½åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå…«ä¸ªâ€œè‡ªåˆ¶â€å­—ç¬¦ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å­—ç¬¦è¡¨LCD 1602</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/91b/eed/92f/91beed92f6f0487f922c3f9834ae9a8f.png"><br><br><img src="https://habrastorage.org/files/ecf/799/4a5/ecf7994a50584faba9805df1550d6157.png"><br></div></div><br> åŸåˆ™ä¸Šï¼Œå¯ä»¥åœ¨æ¶²æ™¶æ˜¾ç¤ºå±ä¸Šç”¨è‹±è¯­å†™ä¿„è¯­å•è¯ã€‚ åœ¨é‚£é‡Œï¼Œå³ä½¿æ˜¯ä¹…è´Ÿç››åçš„æ³•å›½å…¬å¸æ–½è€å¾·ç”µæ°”å…¬å¸ï¼ˆç”šè‡³åœ¨é©å‘½ä¹‹å‰å°±æ›¾å‘æ²™çš‡å‡ºå”®æ¦´å¼¹ç‚®çš„å…¬å¸ï¼‰éƒ½æ— æ³•å°†ä¿„å›½äººå¼•å…¥å…¶è‘—åçš„Zelioå¯ç¼–ç¨‹ç»§ç”µå™¨ã€‚ ä½†è¿™å¹¶ä¸èƒ½é˜»æ­¢ä»–ä»¬åœ¨ç‹¬è”ä½“çš„å¹¿é˜”åŒºåŸŸä¸­ç§¯æäº¤æ˜“ã€‚ æ­¤å¤–ï¼Œè¿˜å¼•å…¥äº†è¿æ²³ï¼Œè¥¿ç­ç‰™æ–‡å’Œè‘¡è„ç‰™æ–‡ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„è®¸å¤šå·¥å‚ä¸­ï¼Œè¿™äº›Zelioç”¨è¯¸å¦‚â€œ NASOS 1 VKLâ€ä¹‹ç±»çš„çŸ­è¯­ä¸å‘˜å·¥è¿›è¡Œæ²Ÿé€šã€‚ <br><br> å½“ä¸æ¸…æ¥šç‰¹å®šçš„LCDä¸­æ˜¯å¦æœ‰ä¿„è¯­å­—æ¯æ—¶ï¼Œæ‚¨éœ€è¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå…¶å­—ç¬¦å‘ç”Ÿå™¨çš„æ‰€æœ‰å­—ç¬¦ã€‚ å¦‚æœæœ‰è¥¿é‡Œå°”å­—æ¯ï¼Œåˆ™ä»ä½ç½®160å¼€å§‹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">è‰å›¾4ï¼Œæ˜¾ç¤ºLCD 1602å­—ç¬¦ç”Ÿæˆå™¨è¡¨ä¸­çš„æ‰€æœ‰å­—ç¬¦</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">/*   LCD     * LCD    i2c */</span></span> #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;LiquidCrystal_I2C.h&gt; LiquidCrystal_I2C lcd(<span class="hljs-number"><span class="hljs-number">0x27</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>); //   <span class="hljs-type"><span class="hljs-type">void</span></span> setup() { // put your setup code here, <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> run once: lcd.init(); lcd.clear(); } <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>() { <span class="hljs-type"><span class="hljs-type">int</span></span> i,y; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>; i++) { lcd.clear(); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); lcd.print(String(i*<span class="hljs-number"><span class="hljs-number">16</span></span>)+" - "+String(i*<span class="hljs-number"><span class="hljs-number">16</span></span>+<span class="hljs-number"><span class="hljs-number">15</span></span>)); lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(y=<span class="hljs-number"><span class="hljs-number">0</span></span>;y&lt;<span class="hljs-number"><span class="hljs-number">16</span></span>;y++) lcd.print(<span class="hljs-type"><span class="hljs-type">char</span></span>(i*<span class="hljs-number"><span class="hljs-number">16</span></span>+y)); delay(<span class="hljs-number"><span class="hljs-number">3000</span></span>); } } }</code> </pre><br></div></div><br> ä½†æ˜¯ï¼Œå³ä½¿æ‚¨çš„LCD 1602ç”Ÿé”ˆäº†ï¼Œæ˜¾ç¤ºä¿„è¯­å•è¯ä¹Ÿä¸æ˜¯é‚£ä¹ˆç®€å•ã€‚ è‡³å°‘åœ¨i2cæ€»çº¿ä¸Šä½¿ç”¨LCDæ—¶ï¼Œè¯·ä½¿ç”¨LiquidCrystal_I2C.håº“ã€‚ <br><br> ä¾‹å¦‚ï¼Œå¦‚æœä»…ä½¿ç”¨æŒ‡ä»¤lcd.printï¼ˆâ€œ Hello !!!â€ï¼‰è¾“å‡ºä¿„è¯­æ–‡æœ¬ï¼Œåˆ™ä»£æ›¿â€œ Hello !!!â€ å±å¹•ä¸Šä¼šå‡ºç°ä¸€äº›åƒåœ¾ã€‚ <br><br> è¿™æ˜¯å› ä¸ºArduino IDEå°†ä¿„è¯­å­—æ¯è½¬æ¢ä¸ºä¸¤å­—èŠ‚çš„UTF-8ä»£ç ï¼Œè€Œåœ¨LCDä¸­ï¼Œæ‰€æœ‰å­—ç¬¦å‡ä¸ºå•å­—èŠ‚ã€‚ <br><br> é¡ºä¾¿è¯´ä¸€å¥ï¼Œå½“å°†ä¿„è¯­æ–‡æœ¬ä»Arduinoä¼ è¾“åˆ°Arduino IDEç«¯å£ç›‘è§†å™¨æ—¶ï¼Œä¹Ÿä¼šè§‚å¯Ÿåˆ°ç›¸åŒçš„é—®é¢˜ã€‚  Arduinoå°†UTF-8åŒå­—èŠ‚ç¼–ç çš„ä¿„è¯­å­—æ¯å‘é€åˆ°ä¸²è¡Œç«¯å£ï¼Œè€ŒArduino IDEç«¯å£ç›‘è§†å™¨å°è¯•ä»¥å•å­—èŠ‚Windows-1251ç¼–ç ï¼ˆcp1251ï¼‰è¯»å–å®ƒä»¬ã€‚ å°½ç®¡cp1251ä¹Ÿæ˜¯8ä½çš„ï¼Œä½†ä¸LCD 1602ç¼–ç ä¸€æ ·ï¼Œå®ƒä¹Ÿä¸åŒ¹é…ã€‚ <br><br> æ‚¨å¯ä»¥é€šè¿‡å­—ç¬¦ä»£ç å½¢æˆä¿„è¯­æ–‡æœ¬ã€‚ ä¾‹å¦‚ï¼ŒRussified LCDä¸Šçš„â€œ LCD displayâ€è¡Œå°†æ˜¾ç¤ºä¸ºï¼š <br><br><pre> <code class="hljs swift">lcd.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"\243K \343\270c\276\273e\271"</span></span>);</code> </pre> <br> ä½†æ˜¯æˆ‘ä¸å–œæ¬¢è¿™ç§æ–¹æ³•ã€‚ <br><br> ä¸ºäº†åœ¨Russified LCD 1602ä¸Šæ­£ç¡®æ˜¾ç¤ºä¿„è¯­æ–‡æœ¬ï¼Œä¸ºArduinoå‘æ˜äº†å‡ ä¸ªåº“ã€‚ ä½†æ˜¯åœ¨é˜…è¯»è¯„è®ºåï¼Œæˆ‘å‘ç°è®¸å¤šäººæŠ±æ€¨ä½¿ç”¨å®ƒä»¬æ—¶å‡ºç°äº†æ•…éšœã€‚ <br><br> å› æ­¤ï¼Œæˆ‘è‡ªå·±åœ¨å¤šçº§èœå•ç¨‹åºä¸­ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œç”¨äºå°†UTF-8è½¬æ¢ä¸ºLCDä»£ç ã€‚ æ²¡é”™ï¼Œæˆ‘åªç”¨å¤§å†™çš„ä¿„è¯­å­—æ¯åšè¿‡ï¼Œéå¸¸é€‚åˆæˆ‘ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç”¨äºå°†UTF-8å¤§å†™ä¿„è¯­å­—æ¯è½¬æ¢ä¸ºå•å­—èŠ‚LCD 1602ä»£ç çš„åŠŸèƒ½</b> <div class="spoiler_text"><pre> <code class="hljs powershell">/* *  UTF<span class="hljs-literal"><span class="hljs-literal">-8</span></span>   ( )   LCD *       */ byte MasRus[<span class="hljs-number"><span class="hljs-number">33</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>]= { <span class="hljs-number"><span class="hljs-number">144</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x41, // <span class="hljs-number"><span class="hljs-number">145</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa0, <span class="hljs-number"><span class="hljs-number">146</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x42, <span class="hljs-number"><span class="hljs-number">147</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa1, <span class="hljs-number"><span class="hljs-number">148</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xe0, <span class="hljs-number"><span class="hljs-number">149</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x45, <span class="hljs-number"><span class="hljs-number">129</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa2, <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa3, <span class="hljs-number"><span class="hljs-number">151</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa4, <span class="hljs-number"><span class="hljs-number">152</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa5, <span class="hljs-number"><span class="hljs-number">153</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa6, <span class="hljs-number"><span class="hljs-number">154</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x4b, <span class="hljs-number"><span class="hljs-number">155</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa7, <span class="hljs-number"><span class="hljs-number">156</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x4d, <span class="hljs-number"><span class="hljs-number">157</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x48, <span class="hljs-number"><span class="hljs-number">158</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x4f, <span class="hljs-number"><span class="hljs-number">159</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa8, <span class="hljs-number"><span class="hljs-number">160</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x50, <span class="hljs-number"><span class="hljs-number">161</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x43, <span class="hljs-number"><span class="hljs-number">162</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x54, <span class="hljs-number"><span class="hljs-number">163</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xa9, <span class="hljs-number"><span class="hljs-number">164</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xaa, <span class="hljs-number"><span class="hljs-number">165</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>x58, <span class="hljs-number"><span class="hljs-number">166</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xe1, <span class="hljs-number"><span class="hljs-number">167</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xab, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xac, <span class="hljs-number"><span class="hljs-number">169</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xe2, <span class="hljs-number"><span class="hljs-number">170</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xad, <span class="hljs-number"><span class="hljs-number">171</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xae, <span class="hljs-number"><span class="hljs-number">172</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xc4, <span class="hljs-number"><span class="hljs-number">173</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xaf, <span class="hljs-number"><span class="hljs-number">174</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xb0, <span class="hljs-number"><span class="hljs-number">175</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>xb1 // }; String RusStrLCD(String StrIn) { String StrOut=<span class="hljs-string"><span class="hljs-string">""</span></span>; byte b1; byte y; byte l=StrIn.length(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(byte i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;l; i++) { b1=StrIn.charAt(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b1&lt;<span class="hljs-number"><span class="hljs-number">128</span></span>) StrOut=StrOut+char(b1); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b1==<span class="hljs-number"><span class="hljs-number">208</span></span>) //==<span class="hljs-number"><span class="hljs-number">208</span></span>,     <span class="hljs-number"><span class="hljs-number">2</span></span>-  .  { b1=StrIn.charAt(i+<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(y=<span class="hljs-number"><span class="hljs-number">0</span></span>; y&lt;<span class="hljs-number"><span class="hljs-number">33</span></span>; y++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(MasRus[<span class="hljs-type"><span class="hljs-type">y</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]==b1) { StrOut=StrOut+char(MasRus[<span class="hljs-type"><span class="hljs-type">y</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } i++; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> StrOut; }</code> </pre><br></div></div><br> å¸¦æœ‰i2cæ€»çº¿çš„è‡ªåˆ¶HMIå°±è¿™äº›äº†ã€‚ <br><br> å“¦ï¼Œæ˜¯çš„ï¼Œåœ¨æœ¬æ–‡çš„å¼€å¤´ï¼Œæˆ‘å†™é“æˆ‘ä¸æ˜¯åœ¨ä¸ºArduinoåšHMIï¼Œè€Œæ˜¯ä¸ºä¸Arduinoå…¼å®¹çš„è®¾å¤‡åšHMIã€‚ è¿™æ˜¯å…³äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CONTROLLINO MAXIçš„</a> ï¼Œè¿™æ˜¯ä»Arduino IDEï¼ˆä»¥åŠè®¸å¤šå…¶ä»–äº§å“ï¼‰ç¼–ç¨‹çš„ã€‚ <br><br><img src="https://habrastorage.org/files/e62/97f/16b/e6297f16bfa84a449fe1d34f629ed061.jpg"><br><br>  CONTROLLINO MAXIå®é™…ä¸Šæ˜¯Arduino +ä¸€å †å±è”½æ¿ï¼Œæ‰€æœ‰ç»„ä»¶å‡è®¾è®¡ä¸ºå·¥ä¸šPLCã€‚ ä½†æ˜¯ä¸‹æ¬¡å‘¢ã€‚ <br><br>  <b>å‚è€ƒæ–‡çŒ®</b> <br><br>  â†’ <a href="">å­˜æ¡£</a>åŒ…å«lay6æ ¼å¼çš„å›¾è¡¨ï¼Œè‰å›¾å’Œå°åˆ·ç”µè·¯æ¿ <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arduinoå…¼å®¹çš„PLC CONTROLLINO</a> ï¼Œè¿™é¡¹å·¥ä½œå¯å‘äº†HMI i2cçš„åˆ›å»º <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PCF8574ç«¯å£æ‰©å±•å™¨</a>å¹¶å°†å…¶è¿æ¥åˆ°Arduino <br>  â†’ç”¨äºé€šè¿‡i2cæ€»çº¿è¿›è¡ŒLCD 1602æ“ä½œçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">FC-113æ¿</a>åŠå…¶ä¸Arduinoçš„è¿æ¥ <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤šå±‚æ ‘èœå•</a> ï¼Œç”¨Cåˆ›å»ºçš„ä¸€èˆ¬åŸç† <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–ç UTF-8</a> <br>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–ç Windows-1251</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN401587/">https://habr.com/ru/post/zh-CN401587/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN401567/index.html">Chrome Sandboxä¾µçŠ¯äº†ä¸‰é¡¹ä¸“åˆ©ï¼ŒGoogleå°†æ”¯ä»˜ä¸“åˆ©è´¹</a></li>
<li><a href="../zh-CN401569/index.html">CES 2017åå¤§å°ç©æ„è®©æˆ‘ä»¬å°è±¡æ·±åˆ»</a></li>
<li><a href="../zh-CN401573/index.html">è‡ªç”±èŒä¸šè€…ã€‚ å››ä¸ªæˆåŠŸæ¡ˆä¾‹ï¼šç¦»å¼€åŠå…¬å®¤ï¼Œç”Ÿæ´»æ—‹è½¬</a></li>
<li><a href="../zh-CN401577/index.html">Ryzenå¤„ç†å™¨çš„éå®˜æ–¹åŸºå‡†å’Œä»·æ ¼</a></li>
<li><a href="../zh-CN401583/index.html">ä¸ºä»€ä¹ˆæˆ‘æœ‰å®³ï¼Ÿ å› ä¸ºæˆ‘æ²¡æœ‰SSDï¼ å°†å›ºæ€é©±åŠ¨å™¨æ”¾åœ¨æ—§è®¡ç®—æœºä¸Šæ˜¯å¦æœ‰æ„ä¹‰ï¼Ÿ</a></li>
<li><a href="../zh-CN401591/index.html">ä»€ä¹ˆæ˜¯è¡Œæ˜Ÿï¼Ÿ</a></li>
<li><a href="../zh-CN401593/index.html">æ±½è½¦æ–‡æ‘˜ï¼šç»´ä¿®ï¼Œä¿é™©å’Œæ–°æŠ€æœ¯</a></li>
<li><a href="../zh-CN401595/index.html">ç‰©ç†å­¦å®¶å­¦ä¼šäº†åœ¨ç£åœºä¸‹æ‹§ç´§èºä¸</a></li>
<li><a href="../zh-CN401597/index.html">å…¬å¸å®è¡Œå·¥ä½œåœºæ‰€ç›‘è§†æ–¹æ³•</a></li>
<li><a href="../zh-CN401599/index.html">å¦‚ä½•æ‰¾åˆ°è‡ªå·±å–œæ¬¢çš„ä¸“ä¸šå·¥ä½œ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>