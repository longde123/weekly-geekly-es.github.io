<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ© ğŸ›‘ ğŸ¤½ğŸ¼ IHM FLProg + Nextion. LeÃ§on 3 â›³ï¸ ğŸ‘†ğŸ» ğŸˆ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans les leÃ§ons prÃ©cÃ©dentes ( leÃ§on 1 , leÃ§on 2 ), j'ai expliquÃ© comment dessiner l'interface d'un panneau IHM Nextion et comment contrÃ´ler un panneau...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>IHM FLProg + Nextion. LeÃ§on 3</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flprog/blog/392865/"><img src="https://habrastorage.org/files/221/5cc/315/2215cc315ef044008bfbc77b0a9b6a9a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans les leÃ§ons prÃ©cÃ©dentes ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leÃ§on 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">leÃ§on 2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), j'ai expliquÃ© comment dessiner l'interface d'un panneau IHM Nextion et comment contrÃ´ler un panneau Ã  l'aide d'Arduino. Dans ce didacticiel, je vais vous montrer comment rÃ©soudre le problÃ¨me inverse du contrÃ´le de la carte Arduino Ã  l'aide du panneau IHM Nextion. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la leÃ§on, nous dÃ©velopperons le projet de la leÃ§on prÃ©cÃ©dente, ajouterons le contrÃ´le du ventilateur, qui s'activera lorsque la tempÃ©rature dÃ©passera la limite spÃ©cifiÃ©e et s'Ã©teindra lorsque la tempÃ©rature descendra en dessous de la deuxiÃ¨me limite. Les paramÃ¨tres seront dÃ©finis Ã  partir du panneau et stockÃ©s dans la mÃ©moire non volatile du contrÃ´leur Arduino. De plus, nous allons faire un interrupteur d'Ã©clairage (marche-arrÃªt) sur le panneau et un bouton avec lequel nous allumerons la lampe de poche (par exemple, pour donner un signal aux extraterrestres).</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
SchÃ©ma modifiÃ© de la derniÃ¨re leÃ§on. </font><font style="vertical-align: inherit;">La lampe de poche, la lumiÃ¨re et le ventilateur simuleront les LED. </font></font><br>
<img src="https://habrastorage.org/files/108/887/fc9/108887fc97124f3aa2597671e1fc523c.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La conception du panneau a Ã©galement Ã©tÃ© finalisÃ©e. </font><font style="vertical-align: inherit;">Deux pages ajoutÃ©es. </font><font style="vertical-align: inherit;">De plus, la police chargÃ©e dans le panneau a Ã©tÃ© remplacÃ©e. </font><font style="vertical-align: inherit;">Le projet du panel est dans les archives, dont un lien est donnÃ© Ã  la fin de l'article. </font><font style="vertical-align: inherit;">Dans les commentaires de la derniÃ¨re leÃ§on, ils m'ont critiquÃ© Ã  juste titre pour le manque de talent de designer. </font><font style="vertical-align: inherit;">Je suis entiÃ¨rement d'accord avec cela, donc les nouvelles pages n'ont pas de design, de pure fonctionnalitÃ©. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ConsidÃ©rez les nouvelles pages. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page de gestion (Â«page3Â», ID = 3). </font></font></b><br>
 <img src="https://habrastorage.org/files/f53/475/3e3/f534753e34d541b0a519e9d63ba3ca8a.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ConsidÃ©rez les Ã©lÃ©ments de la page.</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Juste des champs de texte. </font><font style="vertical-align: inherit;">Rien d'intÃ©ressant.</font></font></li>
<li>    .    ,       .    .       .  .<br>
<img src="https://habrastorage.org/files/413/8a4/81d/4138a481d6b34b849c9f1c3181800186.PNG"><br>
        ,    ( â€œvscopeâ€  â€œglobalâ€).           .    â€œTouch Press Eventâ€   .<br>
<img src="https://habrastorage.org/files/3d5/dec/ee6/3d5decee64374165a29854797e74f286.PNG"><br>
           4   .<br>
<pre><code class="hljs">page4.evtemp.txt=onV.txt</code></pre><br>
         4   ,   .<br>
<pre><code class="hljs scala">page4.varN.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span></code></pre><br>
      .<br>
<pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">page</span></span> page4</code></pre><br>
<br>
</li>
<li>    .    .  .<br>
<img src="https://habrastorage.org/files/b4a/e51/538/b4ae51538bef45bfb53ce2ae154a46ca.PNG"><br>
   â€œTouch Press Eventâ€.<br>
<img src="https://habrastorage.org/files/9ef/379/001/9ef379001eed40578b7c421a88f8993e.PNG"><br>
         .<br>
<pre><code class="hljs scala">page4.varN.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code></pre><br>
<br>
</li>
<li> .    .  .<br>
<img src="https://habrastorage.org/files/e89/e52/5af/e89e525af96248868f8506c259f05fec.PNG"><br>
   â€œTouch Press Eventâ€.<br>
<img src="https://habrastorage.org/files/72f/15a/e66/72f15ae66eac437e84eca112fc64e1b0.PNG"><br>
<br>
</li>
<li>    (â€œDual-state buttonâ€) â€“  . <br>
 .<br>
<img src="https://habrastorage.org/files/6c3/8a4/341/6c38a43413f4435a8292add512061f4f.PNG"><br>
       ,    ( â€œvscopeâ€  â€œglobalâ€).         ( â€œstaâ€  â€œimageâ€).     â€œpic0â€   0  â€œpic1â€   1.<br>
<br>
</li>
<li> (â€œButtonâ€) â€“  .  .<br>
<img src="https://habrastorage.org/files/8c5/5e3/e8b/8c55e3e8b7394171adb4436992cc2d2e.PNG"><br>
  .        ,   .  ,  Arduino        UART (  ,  ).              (7  8).      ,      ,    (     ).     (â€œTouch Press Eventâ€)   .<br>
<img src="https://habrastorage.org/files/68f/4e8/233/68f4e82332df4f54ab4a757174a78369.PNG"><br>
     (â€œTouch Release Eventâ€) .<br>
<img src="https://habrastorage.org/files/c04/25f/66d/c0425f66d38244288a707c3f47a0cd87.PNG"><br>
          FLProg.<br>
<br>
</li>
</ol><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FenÃªtre d'Ã©dition des valeurs (Â«page4Â», ID = 4). </font></font></b><br>
<img src="https://habrastorage.org/files/93e/87e/629/93e87e629fd44572a6116bfa7549578c.PNG"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ConsidÃ©rez ce qui y est inclus.</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Champ de valeur modifiable. </font><font style="vertical-align: inherit;">ParamÃ¨tres de l'Ã©lÃ©ment. </font></font><br>
<img src="https://habrastorage.org/files/cdc/34f/371/cdc34f3719d044ee9f4fc2e1bd69268d.PNG"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons lire la valeur de ce champ Ã  partir du contrÃ´leur, respectivement, le rendre global (l'attribut "vscope" est dÃ©fini sur "global").</font></font><br>
<br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boutons de saisie de valeur. </font><font style="vertical-align: inherit;">Tous ces boutons sont presque identiques et diffÃ¨rent par l'inscription et le code dans le gestionnaire d'Ã©vÃ©nements Â«Touch Press EventÂ». </font><font style="vertical-align: inherit;">Lorsque vous cliquez sur l'un de ces boutons, le symbole correspondant est ajoutÃ© Ã  la valeur actuelle du champ de la valeur Ã©ditÃ©e.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code dans le Â«Touch Press EventÂ» pour chacun des boutons.</font></font></b><div class="spoiler_text">â€œ0â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"0"</span></span></code></pre><br>
â€œ1â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"1"</span></span></code></pre><br>
â€œ2â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"2"</span></span></code></pre><br>
â€œ3â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"3"</span></span></code></pre><br>
â€œ4â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"4"</span></span></code></pre><br>
â€œ5â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"5"</span></span></code></pre><br>
â€œ6â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"6"</span></span></code></pre><br>
â€œ7â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"7"</span></span></code></pre><br>
â€œ8â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"8"</span></span></code></pre><br>
â€œ9â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"9"</span></span></code></pre><br>
â€œ.â€ <br>
<pre><code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"."</span></span></code></pre><br>
</div></div><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bouton pour effacer le champ. </font><font style="vertical-align: inherit;">Lorsque vous appuyez dessus, la valeur du champ est supprimÃ©e. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code dans le Â«Touch Press EventÂ»</font></font><br>
<pre><code class="hljs objectivec">evtemp.txt=<span class="hljs-string"><span class="hljs-string">""</span></span></code></pre><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bouton pour supprimer le dernier caractÃ¨re. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Code dans le Â«Touch Press EventÂ»</font></font><br>
<pre><code class="hljs powershell">evtemp.txt=evtemp.txt<span class="hljs-literal"><span class="hljs-literal">-1</span></span></code></pre><br>
   .      .          .             . <br>
<br>
</li>
<li>   .<br>
      ,        (â€œendPressâ€  â€œ endRelâ€)      .<br>
   â€œTouch Press Eventâ€ <br>
<pre><code class="hljs scala">page4.endPress.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code></pre><br>
   â€œTouch Release Eventâ€<br>
<pre><code class="hljs scala">page4.endRel.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code></pre><br>
<br>
</li>
<li>  .          .<br>
   â€œTouch Press Eventâ€ <br>
<pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">page</span></span> page3</code></pre><br>
<br>
</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une fois le panneau terminÃ©, accÃ©dez au programme FLProg. Il utilise Ã©galement le projet de la derniÃ¨re leÃ§on, lÃ©gÃ¨rement modifiÃ©. Le fichier du projet est dans l'archive, un lien vers lequel est donnÃ© Ã  la fin de l'article. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme dans la derniÃ¨re leÃ§on, je vais montrer les circuits imprimÃ©s prÃªts Ã  l'emploi et dire ce qui se passe sur eux. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 7 - Â«Gestion des lanternesÂ»</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/20c/561/619/20c561619b51414fbb0c0fdb36da2d1b.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Ici, tout est simple. Bloc B46 - Â«Click TrackingÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«Nextion HMI PanelÂ»). A sa sortie, il correspond Ã  l'Ã©tat du bouton surveillÃ© ou autre Ã©lÃ©ment des Ã©vÃ©nements Â«Touch Press EventÂ» et Â«Touch Release EventÂ» sur le panneau. Cette valeur est directement Ã©crite dans la sortie liÃ©e Ã  la lampe. Le bloc est paramÃ©trÃ© Ã  l'aide de l'Ã©diteur de blocs.</font></font><br>
 <br>
<img src="https://habrastorage.org/files/082/eab/5de/082eab5dedc34570a35e925aa8993a55.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'Ã©diteur de blocs, sÃ©lectionnez le panneau, puis crÃ©ez une nouvelle page et Ã©crivez-y les Ã©lÃ©ments nÃ©cessaires. J'ai expliquÃ© comment procÃ©der dans une leÃ§on prÃ©cÃ©dente. </font></font><br>
<br>
<img src="https://habrastorage.org/files/b3f/94f/ea2/b3f94fea2181418aa75de4462c9f4206.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une telle image devrait se rÃ©vÃ©ler. </font></font><br>
<br>
<img src="https://habrastorage.org/files/fbd/252/df3/fbd252df3fcb4f3c97317d06d8237a49.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En tant que variable de pression, nous sÃ©lectionnons la variable dans laquelle nous Ã©crivons l'unitÃ© dans le bouton Â«Touch Press EventÂ», et comme variable de libÃ©ration, la variable du bouton Â«Touch Release EventÂ». </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 8 - "Light Control".</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/884/fdb/e32/884fdbe3225b4449aca906a410ae234e.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
MÃªme planche trÃ¨s simple. Ici, nous lisons la position du commutateur Ã  l'aide du bloc B47 - Â«Get parameterÂ» (bibliothÃ¨que d'Ã©lÃ©ments -&gt; dossier Â«Nextion HMI PanelÂ» -&gt; dossier Â«ElementsÂ»). Cette valeur est ensuite envoyÃ©e directement Ã  l'unitÃ© de sortie, attachÃ©e Ã  l'Ã©clairage. Le bloc est paramÃ©trÃ© Ã  l'aide de l'Ã©diteur de blocs.</font></font><br>
<br>
<img src="https://habrastorage.org/files/210/53e/646/21053e6461ea4a86a2d518bfd0f8a3ba.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour rÃ©duire la charge sur le contrÃ´leur, nous demanderons une fois par seconde l'Ã©tat de l'interrupteur. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 9 - Â«Fin des paramÃ¨tres d'Ã©ditionÂ».</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Sur cette carte, nous traiterons le clic du bouton Â«TerminerÂ» sur la page d'Ã©dition des paramÃ¨tres. </font></font><br>
<br>
<img src="https://habrastorage.org/files/848/9d8/c85/8489d8c852da426aa4f88e0fca493e44.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A l'aide du bloc B48 - Â«Suivi des clicsÂ» (bibliothÃ¨que d'Ã©lÃ©ments, le dossier Â«Nextion HMI PanelÂ») nous dÃ©terminons le moment de pressage. Dans l'Ã©diteur de ce bloc, nous allons crÃ©er la page 4 et la remplir avec les Ã©lÃ©ments qui nous intÃ©ressent. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2f7/818/f29/2f7818f298d34f609971a64c09053c10.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et configurez le bloc. </font></font><br>
<br>
<img src="https://habrastorage.org/files/379/1d2/3c6/3791d23c667f416d82bff16ca6c4f37a.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A l'aide du bloc B49 - Â«RtrigÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«DÃ©clencheursÂ»), sÃ©lectionnez le bord d'attaque du signal lorsque vous appuyez sur le bouton Â«TerminerÂ» et Ã©crivez-le dans la variable Â«Fin d'Ã©ditionÂ».</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur ce front Ã©galement, nous lirons la valeur de la variable stockant l'identifiant du champ Ã©ditÃ© Ã  l'aide du bloc B54 - Â«Get ParameterÂ» (bibliothÃ¨que d'Ã©lÃ©ments -&gt; dossier Â«Nextion HMI PanelÂ» -&gt; dossier Â«ElementsÂ»). Bloquer les paramÃ¨tres. </font></font><br>
<br>
<img src="https://habrastorage.org/files/bd2/bc1/c66/bd2bc1c66daf4ba19e8424d74648463b.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous mettons la valeur obtenue dans la variable Â«NumÃ©ro du champ Ã©ditÃ©Â». </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et par la mÃªme impulsion, nous lirons directement la nouvelle valeur du champ de texte en utilisant le bloc B50 - Â«Get ParameterÂ» (bibliothÃ¨que d'Ã©lÃ©ments -&gt; dossier Â«Nextion HMI PanelÂ» -&gt; dossier Â«ElementsÂ»). Bloquer les paramÃ¨tres. </font></font><br>
<br>
<img src="https://habrastorage.org/files/b46/3a0/32b/b463a032bde0419da9d26ca913e8bc2c.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous transformons la nouvelle valeur de la chaÃ®ne en un nombre au format Float en utilisant le bloc B51 - "Conversion de chaÃ®ne" (bibliothÃ¨que d'Ã©lÃ©ments, dossier "Type Conversion"). Bloquer les paramÃ¨tres.</font></font><br>
 <br>
<img src="https://habrastorage.org/files/6a7/516/598/6a7516598acf4c6c83c8512b19841b5f.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous multiplions le nombre par 10 en utilisant le bloc B52 - "MUL (*)" (bibliothÃ¨que d'Ã©lÃ©ments, dossier "MathÃ©matiques"), changez le type en Entier en utilisant le bloc B53 - "Convertir Float en Entier" (bibliothÃ¨que d'Ã©lÃ©ments, dossier "Type Conversion") et insÃ©rez la variable "Nouvelle valeur". </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 10 - "Traitement des rÃ©sultats de la modification de la valeur"</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/1e9/970/39c/1e997039cc3c4537bbd4aefe2e5a8e87.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A l'aide du bloc B55 - Â«ComparateurÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«ComparaisonÂ») nous dÃ©terminons quel champ a Ã©tÃ© Ã©ditÃ©, et en fonction du rÃ©sultat, Ã©crivez la valeur de la variable Â«Nouvelle valeurÂ» par le momentum de la variable Â«Fin d'Ã©ditionÂ» dans l'une des deux variables, dans Â«Point de consigne pour l'arrÃªt du ventilateur x10Â» ou dans Â«Point de consigne pour l'allumage du ventilateur x10Â». Toujours par la mÃªme impulsion, nous donnons la commande du panneau pour aller Ã  la page de contrÃ´le en utilisant le bloc B58 - Â«Aller Ã  la pageÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«Nextion HMI PanelÂ» -&gt; dossier Â«PageÂ»). Bloquer les paramÃ¨tres. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f67/1e9/03c/f671e903cfc34abcb725e0e241b3c797.PNG"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 11 - Â«Ã‰criture des valeurs de rÃ©glage sur le panneau et EEPromÂ»</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/3f4/c77/146/3f4c77146fe9469bb9d6fdc7f7df14b6.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A l'aide du bloc B59 - Â«DÃ©tecteur de modification du nombreÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«ElÃ©ments de baseÂ»), nous dÃ©terminons le fait de modifier la valeur par la variable Â«Fan On Setpoint x10Â». Une impulsion courte se forme Ã  la sortie du bloc au moment de la modification de la valeur Ã  l'entrÃ©e Â«ValueÂ». Par cette impulsion, la valeur est Ã©crite dans la mÃ©moire non volatile du contrÃ´leur. Cela peut Ãªtre fait Ã  l'aide du bloc B65 - Â«Ecrire dans l'EEPROMÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«EEPROMÂ»). Le bloc est configurÃ© Ã  l'aide de l'Ã©diteur de blocs. </font></font><br>
 <br>
<img src="https://habrastorage.org/files/2da/162/bf6/2da162bf62144c4a864c8aabd1ad309f.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avant d'Ã©crire une variable dans l'EEPROM, vous devez la crÃ©er Ã  cet endroit. Pour ce faire, cliquez sur le bouton "CrÃ©er" dans l'Ã©diteur de blocs. La fenÃªtre de crÃ©ation d'une variable s'ouvre. </font></font><br>
<br>
<img src="https://habrastorage.org/files/755/94e/c4c/75594ec4cb8243b5a88a7eb857a4b1d6.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous y dÃ©finissons le nom de la variable et son type. AprÃ¨s avoir cliquÃ© sur le bouton prÃªt, le bloc sera attachÃ© Ã  cette variable.</font></font><br>
<br>
<img src="https://habrastorage.org/files/e80/76c/4bd/e8076c4bd256488290502c409775024b.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, par un signal de changement de variable, sa valeur est divisÃ©e par une constante de type Float Ã©gale Ã  10 en utilisant le bloc B61 - "DIV (/)" (bibliothÃ¨que d'Ã©lÃ©ments, dossier "MathÃ©matiques"), se transforme en chaÃ®ne en utilisant le bloc B62 - "Conversion de chaÃ®ne" (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«conversion de typeÂ»), et envoyÃ©e au panneau dans le champ correspondant Ã  l'aide du bloc B63 - Â«DÃ©finir paramÃ¨treÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«Nextion HMI PanelÂ» -&gt; dossier Â«Ã‰lÃ©mentsÂ»). ParamÃ¨tres de ce bloc. </font></font><br>
<br>
<img src="https://habrastorage.org/files/b4c/ee8/803/b4cee88034a54492a5441d394b2678d1.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La logique de contrÃ´le par la variable Â«Fan off setting x10Â» est la mÃªme, les rÃ©glages de bloc sont les suivants. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bloc B65. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c1d/543/faf/c1d543faf0a0479eb0dea94b12b9e30d.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bloc B68.</font></font><br>
<br>
<img src="https://habrastorage.org/files/77d/c88/6c5/77dc886c54cb4c9981dfed2416a2a397.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous allons maintenant nous assurer que les paramÃ¨tres sont lus Ã  partir de l'EEPROM au moment oÃ¹ le contrÃ´leur dÃ©marre. Pour ce faire, insÃ©rez une nouvelle carte tout en haut du projet afin que le circuit qui s'y trouve soit exÃ©cutÃ© en premier. Pour ce faire, sÃ©lectionnez le premier plan et cliquez sur le bouton Â«InsÃ©rer une carte devant celle sÃ©lectionnÃ©eÂ». </font></font><br>
<br>
<img src="https://habrastorage.org/files/981/31f/ca6/98131fca63f940659d73bd8adf398b80.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Appelons la nouvelle carte Â«Lecture des paramÃ¨tres de l'EEPROMÂ». </font><font style="vertical-align: inherit;">
Carte </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/141/f9d/23a/141f9d23ac12428397de261516f52fb2.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En utilisant le bloc Ã‚72 - Â«RtrigÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«DÃ©clencheursÂ»), nous crÃ©ons une impulsion courte lorsque le contrÃ´leur est allumÃ©. Selon cette impulsion, les valeurs lues dans la mÃ©moire non volatile sont enregistrÃ©es dans les variables Â«Consigne pour allumer le ventilateur x10Â» et Â«Consigne pour Ã©teindre le ventilateur x10Â». Cela se produit Ã  l'aide des blocs B71 et B73 - Â«Lecture depuis l'EEPROMÂ» (bibliothÃ¨que d'Ã©lÃ©ments, dossier Â«EEPROMÂ»). Les blocs sont paramÃ©trÃ©s Ã  l'aide de l'Ã©diteur de blocs.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2da/48a/e59/2da48ae5964a45768b2983e24b7faf63.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ParamÃ¨tres du bloc B71. </font></font><br>
<br>
<img src="https://habrastorage.org/files/377/ce7/122/377ce71220fd460982eea7fbbe704d7f.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La variable lue est sÃ©lectionnÃ©e dans l'EEPROM en appuyant sur le bouton "SÃ©lectionner". </font><font style="vertical-align: inherit;">La fenÃªtre de sÃ©lection des variables s'ouvre. </font></font><br>
<br>
<img src="https://habrastorage.org/files/5d5/b01/d35/5d5b01d35ef74968a8a18367cb27548a.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ParamÃ¨tres du bloc B73. </font></font><br>
<br>
<img src="https://habrastorage.org/files/518/a99/862/518a998626ad4583ba0f6587a3d4b309.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, le dernier conseil d'administration du projet. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carte 12. Â«ContrÃ´le du ventilateurÂ»</font></font></b><br>
<br>
<img src="https://habrastorage.org/files/336/979/a52/336979a526da49e7b457edfcb70c98a0.PNG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Si la tempÃ©rature actuelle a dÃ©passÃ© le paramÃ¨tre Â«Point de consigne du ventilateur x10Â», cela sera dÃ©tectÃ© par l'unitÃ© de comparaison B69 et mettre le dÃ©clencheur B70 Ã  l'Ã©tat 1, et lorsque la tempÃ©rature descendra en dessous du paramÃ¨tre Â«Point de consigne d'arrÃªt du ventilateur x10Â», elle sera dÃ©tectÃ©e par le bloc B71, qui met le dÃ©clencheur B70 Ã  l'Ã©tat 0. L'Ã©tat de dÃ©clenchement est fourni Ã  l'unitÃ© de sortie associÃ©e au ventilateur. </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archive avec les codes sources des projets. </font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
DÃ©mo vidÃ©o</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/j8ZimsAfq8k%3Ffeature%3Doembed&amp;usg=ALkJrhgXfln9STFyLjK3Jqye7erT8HIaKw" frameborder="0" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr392865/">https://habr.com/ru/post/fr392865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr392855/index.html">Ğ‘ÑƒĞ´ÑƒÑ‰ĞµĞµ ÑĞ¸ÑÑ‚ĞµĞ¼ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…</a></li>
<li><a href="../fr392857/index.html">Conversion d'un commutateur radio Ã  bouton-poussoir en une touche</a></li>
<li><a href="../fr392859/index.html">Des robots volent de l'argent des cartes bancaires russes</a></li>
<li><a href="../fr392861/index.html">Nous brassons de la biÃ¨re dans une cafetiÃ¨re goutte Ã  goutte</a></li>
<li><a href="../fr392863/index.html">Petit secret de l'artiste Alexei Leonov</a></li>
<li><a href="../fr392867/index.html">Les Chinois ont Ã©ditÃ© l'ADN d'un embryon humain une deuxiÃ¨me fois</a></li>
<li><a href="../fr392869/index.html">Airbus et Siemens crÃ©eront des moteurs d'avion Ã©lectriques et hybrides</a></li>
<li><a href="../fr392873/index.html">DÃ©tecteur de CO (monoxyde de carbone). Qu'est-ce que c'est et pourquoi est-ce nÃ©cessaire?</a></li>
<li><a href="../fr392875/index.html">Inventions automatiques pour le domaine public</a></li>
<li><a href="../fr392877/index.html">Adieu au blog FLProg (UPD - adieu annulÃ©, nous travaillons plus loin)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>