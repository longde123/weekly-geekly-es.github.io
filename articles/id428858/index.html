<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚§µÔ∏è ‚õπÔ∏è üòû DEFCON Conference 17. Tertawalah pada virus Anda! Bagian 1 üë®üèø‚Äçüî¨ üôçüèΩ üò§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Michael: Saya menyambut semua orang, saya Michael Lai, ini Matthew Richard, Anda bisa memanggilnya Matt atau Richard, karena ia memiliki dua nama, tet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON Conference 17. Tertawalah pada virus Anda! Bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428858/"> <b>Michael: Saya</b> menyambut semua orang, saya Michael Lai, ini Matthew Richard, Anda bisa memanggilnya Matt atau Richard, karena ia memiliki dua nama, tetapi itu tidak masalah. <br><br>  <b>Matt:</b> Topik pembicaraan kami hari ini adalah cemoohan terhadap malware, dan itulah tepatnya yang kami coba lakukan. <br><br><img src="https://habrastorage.org/webt/dg/yd/dw/dgyddwjbkvhvkngc1lug68ifhb8.jpeg"><br><br>  Jadi, tidak semua orang yang menulis kode melakukannya dengan baik, orang membuat banyak kesalahan.  Dan tidak semua orang yang menggunakan virus melakukannya dengan benar.  Ada juga orang yang gagal dalam kedua kasus ini.  Jadi duduklah dengan lebih nyaman, rileks dan dengarkan, mungkin informasi ini akan bermanfaat bagi Anda. <br><br>  Untuk jaga-jaga, kami menyertakan materi teknis faktual dalam presentasi sehingga Anda setidaknya belajar sesuatu jika percakapan itu tidak lucu bagi Anda.  Saya perhatikan bahwa ini hanya pendapat kami, yang mungkin tidak sesuai dengan pendapat majikan kami. <a name="habracut"></a><br><br>  <b>Michael:</b> Kisah pertama disebut "Sayang, aku mengurangi entropi!"  Dia berbicara tentang bagaimana penulis Silent Banker, sebuah algoritma enkripsi yang sangat kompleks, lupa membuat entropi menggunakan PRNG - generator angka acak semu.  Pada slide, Anda melihat cuplikan kode Zeus September 2007 di mana PRNG digunakan untuk mencegah deteksi berbasis hash.  Generasi terdiri dalam menginisiasi variabel global ini yang disebut ddTickCount: pertama, ia menempatkannya dalam register EAX, dari mana fungsi dipanggil untuk pertama kalinya.  Kemudian diperiksa apakah nilai fungsi sama dengan nol, dan jika tidak sama, maka TickCount dipanggil untuk menghasilkan SEED, yaitu, untuk memulai nomor pseudo-acak, menggunakan perintah GetTickCount. <br><br><img src="https://habrastorage.org/webt/eq/lo/pv/eqlopvhuevvaq3r9k1oqbkdygy0.jpeg"><br><br>  Kami tidak terkejut ketika kami melihat kesamaan dengan kode ini dalam file biner Silent Banker dari Februari 2008.  Ini menggunakan PRNG untuk menghasilkan nama file sementara.  Di sini, juga, ada variabel global yang sama ddTickCount, yang memeriksa apakah ada nol, dan jika ya, maka nomor pseudo-acak dimulai menggunakan GetTickCount.  Pertama, sebelum saya melihat msvsrt rand, generator angka pseudo-acak yang digunakan oleh fungsi rand () dari perpustakaan Microsoft C Runtime Windows, saya berpikir bahwa ada koneksi antara penulis Zeus dan penulis Silent Banker, hanya berdasarkan pada nomor HEX yang di-hard-coded ke dalam file biner .  Tetapi pada kenyataannya, mereka berdua hanya terhubung secara statis ke msvsrt. <br><br>  Sekarang kita sampai pada resep untuk bencana.  Ini adalah cuplikan kode dari versi Silent Banker Juli 2008, dirilis beberapa bulan setelah versi Februari. <br><br><img src="https://habrastorage.org/webt/z9/wh/fr/z9whfrngqr3rhppqfx1xdficwio.jpeg"><br><br>  Mereka memperbarui kode mereka dan memposting versi baru Silent Banker, yang sangat berbeda dari yang kami lihat sebelumnya.  Dalam program ini, PRNG digunakan untuk menghasilkan kunci enkripsi.  Di sini Anda tidak lagi melihat bahwa variabel global yang disebut CurrentSeed diperiksa untuk kesetaraan ke nol dan nomor pseudo-acak dihasilkan tergantung pada ini, itu hanya digunakan dalam kode ini. <br><br><img src="https://habrastorage.org/webt/tz/ig/ny/tzignymsyqo08w5wjth2zugzo38.jpeg"><br><br>  Ada kemungkinan bahwa di suatu tempat dalam file biner, bahkan sebelum tempat ini, nilai variabel global ini dihasilkan dalam bentuk beberapa jenis angka.  Jadi saya beralih ke pembongkaran kode ini dan melihat apakah nilai CurrentSeed digunakan di tempat lain dalam program sebelum digunakan dalam fungsi rand () ini.  Anda melihat bahwa awalnya dd dimulai dari awal, dan kami akan memeriksa referensi silang ke variabel ini. <br><br><img src="https://habrastorage.org/webt/xb/gw/uh/xbgwuhestru6xn4re261ayainnk.jpeg"><br><br>  Di kolom T, nilai w berarti bahwa hanya ada satu operasi yang valid untuk variabel global ini di seluruh file biner - ini adalah fungsi rand itu sendiri.  Saya akan membahas hal-hal ini dengan lancar karena mereka sudah disebutkan di DefCon tahun lalu.  Pada slide "Resep untuk Bencana", baris Seed the PRNG, atau "Initiation of a Random Number Generator", ditampilkan dalam warna abu-abu untuk menunjukkan bahwa penulis Silent Banker tidak melakukan inisiasi ini. <br><br><img src="https://habrastorage.org/webt/bp/aj/n9/bpajn9ym0w4nhtdxaboum9cm2oe.jpeg"><br><br>  Langkah selanjutnya adalah mereka menghasilkan kunci 16 byte, membuat 1.000 panggilan sistem ke fungsi MyRand ().  Kemudian, dari kunci 16-byte, mereka menghasilkan angka 8-byte - kunci, menggunakan rumus tertentu. <br><br>  Setelah itu, mereka menghasilkan nomor 8-byte lain untuk membuat kunci sekunder dari nomor 8-byte pertama, menambahkan nilai sewenang-wenang dari file konfigurasi INI dan mendapatkan kunci tersier, yang juga merupakan nomor 8-byte.  Akhirnya, mereka menggunakan fungsi matematika presisi arbitrer untuk mengubah kunci 8 byte menjadi 32 byte. <br><br>  Setelah itu, mereka mengenkripsi data yang dicuri seperti kata sandi pengguna menggunakan kunci 16-byte asli.  Tetapi mereka tidak memberikan nomor byte "16" ini kepada penyerang "mereka" dengan data yang dicuri, karena mengirim kunci bersama dengan pesan terenkripsi bukanlah ide yang baik.  Sebagai gantinya, penulis Silent Banker menempatkan nomor 32 byte di dalam data yang dicuri dan mengirimkannya ke penerima, yang seharusnya memiliki program yang mengubah nomor itu kembali ke kunci asli 16-byte.  Namun, kami tidak memiliki program ini! <br><br>  Slide berikutnya menunjukkan resep bagaimana menggunakan bencana ini dengan nomor 1 - kurangnya generator PRNG - untuk keuntungan Anda. <br><br><img src="https://habrastorage.org/webt/al/wp/lm/alwplmsbxy8ej3auux-aa0v6qbk.jpeg"><br><br>  Untuk mulai dengan, kami menyamakan nilai PRNG ke nol.  Kita dapat mengotomatiskan empat langkah berikutnya menggunakan skrip Python untuk debugger, karena kami memiliki rumus yang menghitung kunci 16 byte, kunci 8 byte, kunci 8 byte berikutnya, dan kunci 32 byte.  Rumus ini tidak dalam kode C, tetapi kami memilikinya karena kami memiliki salinan file biner Silent Banker di mana ia ada. <br><br>  Saya akan menunjukkan kepada Anda demo cara kerja skrip Python ini.  Kami memiliki skenario yang baik: di sini saya memiliki Silent Banker dan debugger independen yang saya lampirkan, serta Internet Explorer, di mana Silent Banker berjalan.  Saya mencatat empat fitur yang menghasilkan kunci enkripsi.  Saya menyertakan skrip Python ini yang ditampilkan di slide sebelumnya, yang saya panggil dengan perintah bang keygen.  Anda dapat melihat bahwa debugger hanya "kehilangan" beberapa fungsi yang ingin saya lakukan untuk demo ini 5 kali.  Namun dalam kehidupan nyata, kami melakukan tindakan ini 5.000 kali untuk mendapatkan satu set kunci yang lebih besar. <br><br>  Pada panel log, Anda dapat melihat bahwa untuk setiap iterasi loop, kunci 16-byte utama adalah output, yang kemudian dikaitkan dengan kunci 32-byte.  Pada saat yang sama dengan skrip mencetak informasi dalam log, file teks juga dibuat pada disk, yang mencakup pasangan kunci terkait 16 dan 32 byte.  Ini hanya file HEX heksadesimal, sehingga kita dapat menggunakan skrip Python untuk memproses file ini, kami juga memiliki direktori log yang kami pulihkan dari node perintah-dan-kontrol yang dicuri. <br><br><img src="https://habrastorage.org/webt/3l/s8/q5/3ls8q5neoqhw_1vzzbx9iadyvuy.jpeg"><br><br>  Di bagian atas Anda melihat beberapa sertifikat kunci pribadi terenkripsi, dan di bawahnya adalah beberapa file teks yang berisi data terenkripsi.  Kita cukup menjalankan program dan mencari di dalam file teks ini dengan mengekstrak kunci 32-byte dan kunci asli 16-byte yang terkait dengannya. <br><br>  Segera setelah program menemukan kunci 16-byte, program ini mendekripsi informasi yang terkandung di dalamnya dan menyajikannya dalam bentuk file teks.  Anda melihat file ini di layar, dan tidak mungkin membacanya. <br><br><img src="https://habrastorage.org/webt/_l/65/sk/_l65skt8szevodoual8wimixbhi.jpeg"><br><br>  Tetapi kemudian kita memiliki banyak file sementara .tmp yang dapat dibaca, dari mana kita dapat memperoleh informasi ini dan mengembalikannya ke pemilik yang "berhak".  Jadi semua kerja keras untuk melindungi informasi dilakukan oleh Silent Banker sia-sia karena mereka lupa untuk memulai generator nomor pseudo-acak. <br><br><img src="https://habrastorage.org/webt/bm/kj/qn/bmkjqnl8fuofa6yhjzjfhg2golq.jpeg"><br><br>  Sekarang saya akan menunjukkan bagian terbaik di atas - ini adalah fungsi Silent Banker, yang saya sebut Why_Not_Use_This (Mengapa tidak menggunakannya?). <br><br><img src="https://habrastorage.org/webt/nz/yi/-l/nzyi-lwhkvyqil67khx6wt6zeiy.jpeg"><br><br>  Bahkan, di dalam program mereka sendiri, mereka memiliki fungsi GetCursorPos (menentukan posisi kursor) untuk menghasilkan entropi, yang dapat digunakan untuk memulai PRNG, dan kami dapat memeriksa referensi silang ke fungsi ini di dalam program. <br><br><img src="https://habrastorage.org/webt/eb/7z/pu/eb7zpunaanojkiys5gc6wx8cgvi.jpeg"><br><br>  Kami melihat bahwa ini digunakan di 10-15 tempat lain dalam kode.  Dengan demikian, ternyata penulis Silent Banker tidak lupa untuk memasukkan generator nomor pseudo-acak ke dalam program, mereka hanya lupa untuk menjalankan fungsi ini dalam proses enkripsi menggunakan operator panggilan. <br><br><img src="https://habrastorage.org/webt/lp/_n/e-/lp_ne-pmgawe-72jw9_x0fvj6ym.jpeg"><br><br>  Slide berikutnya disebut "Itu menyelinap pergi ..." dan itu menunjukkan bagaimana program ini akan bekerja jika penulis tidak melupakan apa pun. <br><br><img src="https://habrastorage.org/webt/x0/wn/kb/x0wnkb_6crrojmz0r7twgomdav0.jpeg"><br><br>  Kisah selanjutnya, berjudul "DES atau bukan DES," adalah tentang pembuat malware yang bahkan tidak tahu cara menggunakan antarmuka pemrograman Windows dengan benar atau tidak tahu apa ukuran kunci DES maksimum.  Akibatnya, karena ukuran kunci ini tidak valid, Trojan-nya digunakan secara default dengan xor operator logis. <br><br>  Jadi, untuk fungsi antarmuka program CryptDeriveKey, dua byte rendah dari parameter dwFlags, tanda yang mengatur bagaimana URL yang dihasilkan akan terlihat, menentukan ukuran kunci enkripsi Anda. <br><br><img src="https://habrastorage.org/webt/2a/jt/-q/2ajt-qrub9dk2qkyhbea_panhly.jpeg"><br><br>  Jadi, jika byte rendah adalah 0080, maka kunci enkripsi yang kami minta akan menjadi kunci RC4 128-bit.  Itu sama dengan menembak diri sendiri di kaki, dan saya akan tunjukkan alasannya. <br><br><img src="https://habrastorage.org/webt/02/fm/ev/02fmevcyb9eos_-2a5qcpofweqq.jpeg"><br><br>  Pada slide, Anda melihat garis dengan ukuran yang salah dari kunci dwFlags 128-bit - 800000 dan garis dengan nilai MSCryptoAPI yang salah.  Saya akan menunjukkan kepada Anda pembongkaran hal ini.  Anda melihat fungsi yang disebut "menginisialisasi subsistem enkripsi": trojan memanggil konteks terenkripsi dan kemudian membuat wadah untuk hash MD5, kemudian membuat hash MD5 dari kata sandi hard-coded dalam file biner dan mencoba menggunakan output dari fungsi hash ini untuk membuat kunci DES 128-bit.  Namun, tidak ada kunci yang dibuat dalam kasus ini, karena tidak ada yang namanya kunci DES 128-bit. <br><br><img src="https://habrastorage.org/webt/cp/kv/os/cpkvosn5t2fsqsxbgd3kjdrb5-c.jpeg"><br><br>  Jika salah satu dari fungsi-fungsi API ini gagal, ia melompat ke tempat ini, yang saya tandai dengan warna kuning, dan menampilkan pesan bahwa kunci tidak dapat diterima.  Dan tempat ini ada di sini, di mana ia memindahkan nilai yang ada di ebp dan pada waktu itu adalah 0, yaitu, langsung ke nilai boolean ini, BseMCryptoAPI. <br><br>  Mari kita lihat apa akibatnya selama eksekusi program.  Kami akan mengikuti elemen struktur kode ini untuk melihat di mana lagi ia digunakan dalam program dan bagaimana perbedaan tampilan trojan ini ketika fungsinya benar dan ketika luka salah. <br><br><img src="https://habrastorage.org/webt/-4/0d/m1/-40dm1wrxg7y9pjzfdyv5wp_ov8.jpeg"><br><br>  Kita melihat bahwa nilai logis diperiksa dalam fungsi yang saya sebut data enkripsi, "enkripsi data", dan jika itu benar, ia datang ke blok ini, di mana enkripsi DES dan CryptEncrypt MSAPI digunakan. <br><br><img src="https://habrastorage.org/webt/bf/14/oz/bf14oz0sgb2bwpj9fkorcziwhhw.jpeg"><br><br>  Namun, jika nilai ini adalah 0, dan seperti yang kita tahu, itu akan selalu nol awal, fungsinya pergi ke blok ini, yang secara default adalah xor. <br><br><img src="https://habrastorage.org/webt/3i/y2/go/3iy2gollhuccdcjwuclgygehxsq.jpeg"><br><br>  Saya ingin tahu pada titik waktu mana penulis program jahat memutuskan untuk membuat cadangan semua ini.  Mungkin orang mendorongnya dari atas, jadi dia terpaksa menyingkirkan malware, tetapi pada menit terakhir dia menyadari bahwa DES-nya tidak berfungsi, jadi dia menggunakan xor untuk merekam cadangan.  Secara keseluruhan, itu sangat lucu, jadi moral dari cerita ini adalah untuk selalu membuat cadangan! <br><br>  Kisah berikut disebut "Apa yang telah Anda lakukan dengan apa?".  Saya mencoba untuk datang dengan istilah yang menggambarkan bagaimana enkripsi Trojan Coreflood bekerja, dan memutuskan untuk menyebutnya "enkripsi tergantung lokasi".  Singkatnya, penulis trojan ini menemukan metode enkripsi baru.  Saya pikir, mungkin seseorang sudah menulis artikel tentang ini dan seharusnya "google"?  Google memberi saya tautan ke situs paten AS tempat seseorang mengajukan paten untuk "enkripsi bergantung lokasi".  Skema ini cukup membingungkan, sehingga akan membutuhkan banyak waktu untuk mempelajarinya.  Begini cara kerjanya: Saya mengirimi Anda pesan terenkripsi, dan untuk mendekripsi dan membacanya, Anda perlu mengambil perangkat GPS dan menuju ke suatu titik dengan garis lintang dan bujur yang ditunjukkan oleh saya.  Biasanya, enkripsi adalah kompromi antara keamanan dan kegunaan, tetapi tidak ada satu atau yang lain dalam metode ini. <br><br><img src="https://habrastorage.org/webt/ff/s5/bk/ffs5bkfdwagmbngmoms8efnmcje.jpeg"><br><br>  Ini jelas tidak aman dan mengharuskan Anda pergi ke tempat pengirim menunjuk untuk membaca pesan.  Matt bergurau bahwa jika Anda berkelahi secara online melalui email dan benar-benar ingin menyingkirkan seseorang, kirimkan pesan terenkripsi yang dapat ia baca di suatu tempat di Irak, dan Anda tidak akan lagi memiliki masalah dengannya. <br><br>  Bagaimana metode ini digunakan dalam trojan Coreflood?  Slide ini memperlihatkan sebuah fragmen kode yang darinya setelah trojan mencuri informasi pengguna, ia mengenkripsi dan menulisnya ke disk sehingga trojan nanti dapat menerima informasi ini dan mengunggah perintah-dan-kontrol ke situs webnya. <br><br>  Fungsi ini disebut SetFilePointer (mengatur penunjuk file), dan nilai kembalinya adalah dWord, menunjukkan offset dalam file yang ditetapkan penunjuknya jika dilampaui.  Selanjutnya, fungsi ini mengambil jumlah byte untuk mengenkripsi nNumberOfBitesToWrite dan memindahkannya ke register ecx.  Dia kemudian mengambil pointer data untuk enkripsi dan memindahkannya ke register edx. <br><br><img src="https://habrastorage.org/webt/rg/lp/tu/rglptunvnn4tddlxgtivifxdg6w.jpeg"><br><br>  Setelah itu, operator xor digunakan, yang menempatkan setiap byte dalam buffer al dan ah, yang berarti byte level rendah dan tinggi dikembalikan dari SetFilePointer.  Dengan demikian, kunci enkripsi dalam skema ini adalah offset dalam file tempat data ada.  Ini luar biasa! <br><br>  Slide berikutnya disebut "Cara mengatur ulang dump inti."  Ini menggambarkan program dumpCore yang baru saja saya tulis, yang baru saja keluar.  Anda dapat mengunduhnya, ada semua kode sumbernya.  Program ini akan membantu Anda jika komputer terinfeksi dengan virus Coreflood, yang karena alasan tertentu tidak bisa sampai ke server perintah-dan-kontrol untuk mengunduh data yang dicuri.  Jadi Anda bisa mendapatkan file-file ini yang disimpannya di disk dan mendekripsi menggunakan program saya untuk mencari tahu apa yang dicuri dari Anda, misalnya, jika Anda perlu memberi tahu klien tentang hal itu. <br><br>  Log data yang dicuri dilingkari merah pada slide. <br><br><img src="https://habrastorage.org/webt/xb/ib/c6/xbibc6gjkihoami36sqhcopedky.jpeg"><br><br>  Apa yang masih menarik di Coreflood: walaupun memiliki algoritma enkripsi yang agak lemah, Coreflood masih mencoba untuk mentransfer semua informasi yang dicuri tentang konfigurasi komputer korban, semua informasi target dari bank dan serikat kredit, dan sebagainya.  Jadi cara lain untuk menghapus dump inti disebut "Bagaimana menghapus dump inti menggunakan Wireshark."  Wireshark adalah program yang menganalisis lalu lintas jaringan Ethernet, atau aliran data TCP. <br><br><img src="https://habrastorage.org/webt/ii/9h/4d/ii9h4d6emu0hiquq3xs1hxab78i.jpeg"><br><br>  Slide berikut menunjukkan cara kerja Coreflood.  Ini adalah dll yang dimasukkan ke dalam Explorer dan Internet Explorer.  Mereka memodifikasi registri, memerlukan restart aplikasi, tetapi tidak memerlukan reboot sistem.  Ada berbagai cara untuk menyuntikkan dll ini ke dalam suatu proses. <br><br><img src="https://habrastorage.org/webt/ak/gk/hb/akgkhblgwmnu5tq_l2fcg7wrags.jpeg"><br><br>  Penting bagi peretas yang ingin menyerang virus tanpa disadari adalah bagaimana virus masuk ke komputer pengguna: apakah itu memerlukan sistem reboot agar malware memiliki efek, atau cukup bagi pengguna untuk hanya me-restart aplikasi, dalam hal ini Explorer. <br><br>  Dan sekarang tenang sehingga tidak ada yang bisa mendengar! <br><br><img src="https://habrastorage.org/webt/yk/-q/97/yk-q97lw3wqjqp741oiik2yxudu.jpeg"><br><br>  Ini adalah kode yang kami merekonstruksi menggunakan teknik terbalik.  Ini menunjukkan bagaimana Coreflood secara manual mematikan Explorer sehingga perubahan segera berlaku.  Anda mungkin akrab dengan apa yang terjadi ketika Explorer gagal di komputer - bilah tugas menghilang, semua jendela aplikasi yang terbuka, semua ikon di desktop menghilang, dan kemudian satu per satu mereka mulai kembali ke tempatnya. <br><br>  Para penulis Coreflood jelas tahu tentang ini, jadi mereka menempatkan panggilan sistem di tempat ini untuk mengatur mode kesalahan "benar" dari konduktor tepat sebelum panggilan OpenProcess. <br><br>  Apa fungsi fungsi SetErrorMode?  Ini mencegah kegagalan spesifik dari pemberitahuan yang dikirim ke sistem yang membuat jendela sembul kecil dan mengirim pesan kesalahan yang menyebabkan aplikasi berhenti.  Yang mereka lakukan dengan pesan kesalahan ini adalah untuk mencegah jendela pop-up muncul kepada pengguna sebelum Explorer gagal.  Beri tahu saya apa yang tampak lebih mencurigakan bagi pengguna: jendela sembulan kecil yang disertai dengan lenyapnya segala sesuatu yang muncul di layar dan kemudian muncul kembali, atau hilangnya dan penampilan segala sesuatu tanpa pesan kesalahan?  Saya mendengar Anda berkata: "kedua acara." <br><br>  Slide berikutnya saya sebut "Dengan tangan dan kaki, tetapi tanpa kepala."  Coreflood, ketika dimuat sebagai dll, tidak muncul dalam daftar modul yang dimuat.  Dia mengalokasikan sedikit memori pada heap dan menyalin dirinya ke tempat heap ini - saya meletakkannya di bingkai merah. <br><br><img src="https://habrastorage.org/webt/ns/zf/em/nszfemfch9kulz_ualmhjd-5cf4.jpeg"><br><br>  Lalu dia menghapus header PE-nya, jadi jika Anda bertemu komputer yang terinfeksi trojan ini, maka katakan: "langkah saya selanjutnya adalah membuang file yang dapat dieksekusi ini dan mengunggahnya ke IDA untuk dianalisis", tetapi sangat sulit untuk membuang file yang dapat dieksekusi, jika tidak ada header PE-nya.  Jadi, ketika Coreflood memanggil alokasi virtual, ia menentukan flag mem dari atas ke bawah, yang menyebabkan sistem mengembalikan alamat tertinggi, bukan terendah, yang tersedia.  Hal ini memungkinkan trojan untuk menyembunyikan tanda kutip pembukaan / penutupan di area memori yang lebih tinggi dari mode pengguna di antara dll sistem lainnya.  Oleh karena itu, demo berikutnya saya panggil "Cara membuat semua yang tidak berguna menjadi tersembunyi." <br><br><img src="https://habrastorage.org/webt/wz/h8/1u/wzh81uifnp2xp6vl-xak505logk.jpeg"><br><br>  Ketika Anda menemukan sesuatu seperti Coreflood yang menggunakan stealth, dan tidak ada alat yang siap pakai untuk bekerja dengan virus semacam itu, Anda harus membuatnya sendiri. <br>  Jika Anda terbiasa membongkar, maka menggunakan debugger adalah hal yang umum untuk Anda.  Terutama jika tidak ada pembongkar otomatis, karena ini bukan algoritma yang umum.  Dalam hal ini, Anda bisa menggunakan debugger untuk pergi ke titik entri asli dan kemudian menghapus dump Trojan menggunakan ProcDump atau utilitas lain.       PE     Import Reconstructor,  ,          ,     . <br><br>      ,    .           .       Volatility,       Internet Explorer  .    ,   Coreflood,       ,    .  ,      7FF81000. <br><br><img src="https://habrastorage.org/webt/-d/zw/9b/-dzw9b_qihk8hpoouzgomi3hv2c.jpeg"><br><br>       ,    HEX    ,     Coreflood.    ,      ,          .               . <br><br> ,     ,  Coreflood,       Volatility  .     ,     ID  Internet Explorer.     ,   ,   PID  1732.     Malfind,      ,      ,         ,   .          VAD  ,  ,     .    ,    . <br><br><img src="https://habrastorage.org/webt/aq/mg/_m/aqmg_mfa2sy70g_y-pk77lw-hek.jpeg"><br><br>   ,      ,      7FF81000. ,          Fix IAT,     PID 1732 Internet Explorer      ,   Coreflood. <br><br>     dll,    Internet Explorer,             ,   RBA ,    ,   . <br><br>     ,       7FF81000,    ,        .  ,        PE .  ,        Import Reconstructor:   ,     ,   .     Fix IAT    ,        PE modify viewer   ,     . <br><br><img src="https://habrastorage.org/webt/yz/9w/no/yz9wno8uv0z5jpt5922gwrhvofw.jpeg"><br><br> 21:15 <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> DEFCON 17.    !</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Terima kasih telah tinggal bersama kami.  Apakah Anda suka artikel kami?  Ingin melihat materi yang lebih menarik?  Dukung kami dengan melakukan pemesanan atau merekomendasikannya kepada teman-teman Anda, <b>diskon 30% untuk pengguna Habr pada analog unik dari server entry-level yang kami temukan untuk Anda:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Seluruh kebenaran tentang VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps dari $ 20 atau bagaimana membagi server?</a>  (opsi tersedia dengan RAID1 dan RAID10, hingga 24 core dan hingga 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps hingga Desember secara gratis</b> ketika membayar untuk jangka waktu enam bulan, Anda dapat memesan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  <b>Dell R730xd 2 kali lebih murah?</b>  Hanya kami yang memiliki <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV dari $ 249</a> di Belanda dan Amerika Serikat!</b>  Baca tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cara Membangun Infrastruktur Bldg.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kelas menggunakan server Dell R730xd E5-2650 v4 seharga 9.000 euro untuk satu sen?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id428858/">https://habr.com/ru/post/id428858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id428848/index.html">Catatan dari penyedia IoT: bagaimana cara membuat jaringan LoRa di kota tanpa jaringan dalam satu hari?</a></li>
<li><a href="../id428850/index.html">Manajemen pengembangan dalam proyek besar</a></li>
<li><a href="../id428852/index.html">Buka siaran aula utama HighLoad ++ 2018</a></li>
<li><a href="../id428854/index.html">Cara memotong lampu di pusat data kecil: cara murah untuk menyebarkan darurat</a></li>
<li><a href="../id428856/index.html">Trik luar biasa untuk menjadikan pengelola proyek sumber terbuka sehari</a></li>
<li><a href="../id428860/index.html">DEFCON Conference 17. Tertawalah pada virus Anda! Bagian 2</a></li>
<li><a href="../id428864/index.html">Mari kita buat web menjadi luar biasa lagi</a></li>
<li><a href="../id428866/index.html">7 prinsip desain, sikap terhadap tren desain, portofolio desainer-UX, ...</a></li>
<li><a href="../id428868/index.html">JAR multi-rilis - Buruk atau Bagus?</a></li>
<li><a href="../id428870/index.html">Mrr: Total FRP untuk React</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>