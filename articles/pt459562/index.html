<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍛 🖖 👨🏻‍💼 Programação diferenciável 📨 🍑 🌘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Com quatro parâmetros, posso perguntar a um elefante, e com cinco posso fazê-lo mover a tromba. 
 - John Von Neumann 

 A idéia de " programação difer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programação diferenciável</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459562/"><p><img src="https://habrastorage.org/webt/fv/8k/s8/fv8ks8cvj64dyqlstu1vi9znbv8.jpeg"></p><br><blockquote>  Com quatro parâmetros, posso perguntar a um elefante, e com cinco posso fazê-lo mover a tromba. <br>  - John Von Neumann </blockquote><p>  A idéia de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">programação diferenciável</a> " é muito popular no mundo do aprendizado de máquina.  Para muitos, não está claro se esse termo reflete uma mudança real na maneira como os pesquisadores entendem o aprendizado de máquina, ou é apenas (outra) rebranding de "aprendizado profundo".  Este post explica as novidades da programação diferenciada (ou ∂P) na tabela de aprendizado de máquina. </p><br><p>  Mais importante ainda, a programação diferenciada é a mudança oposta à direção da aprendizagem profunda;  de modelos cada vez mais parametrizados a modelos mais simples que usam a estrutura do problema em maior extensão. </p><br><p>  Em seguida, folheamos uma tela de texto desinteressante, queremos descobrir o que é a diferenciação automática e até preenchê-la de uma catapulta! </p><a name="habracut"></a><br><h2 id="brute-force-with-benefits">  Força bruta com benefícios </h2><br><p>  Diferenciabilidade é uma idéia básica que torna o aprendizado profundo tão bem-sucedido.  Onde as pesquisas de força bruta, mesmo para centenas de parâmetros do modelo, seriam muito caras, os gradientes permitem a passagem pseudo-aleatória de partes interessantes do espaço de parâmetros e encontram um bom conjunto.  Ao executar um algoritmo aparentemente ingênuo, obtemos uma boa generalidade, mas está longe de ser óbvio que precisamos diferenciar, digamos, trabalhando com sequências na tradução de idiomas, mas tudo acaba sendo simples, mostramos um pouco de criatividade. </p><br><p>  E quanto aos neurônios biológicos e <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3C3;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.047ex" height="2.66ex" viewBox="0 -832 9062 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-3C3" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-28" x="2403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-57" x="2792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-76" x="4091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-65" x="4576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-7A" x="5043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-65" x="5511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-73" x="5978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-78" x="6447" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-2B" x="7242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-62" x="8243" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-29" x="8672" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>σ</mo></mrow><mo stretchy="false">(</mo><mi>W</mi><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> y = σ (W \ vezes x + b) </script>  ?  Não há nada de especial nessa fórmula;  Este é um exemplo simples e flexível de uma função não linear altamente paramétrica.  De fato, esse é provavelmente o pior recurso na maioria dos casos.  Uma camada da rede neural, em princípio, pode classificar imagens de gatos, mas apenas usando um truque relativamente desinteressante.  <strong>Funciona perfeitamente!</strong>  - mas as letras pequenas alertam que você pode precisar de mais parâmetros do que átomos no universo.  Para realmente fazer esse trabalho funcionar, você precisa codificar a estrutura problemática do modelo - é aqui que começa a parecer mais com a programação tradicional. </p><br><p>  Por exemplo, <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">ConvNets</a></em> têm uma enorme vantagem sobre o perceptron, porque trabalham com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">kernels de imagem</a> , conhecidos por usar invariância de conversão.  Face - é a face, independentemente de ser exibida no canto superior esquerdo da imagem ou no centro, mas onde o perceptron deve estudar esse caso em cada caso, o kernel pode responder imediatamente a qualquer parte da imagem.  É difícil analisar redes convolucionais em termos estatísticos, mas é muito mais fácil considerá-las como uma versão automática do que os especialistas em processamento de imagens escreveram manualmente.  O núcleo da imagem é o primeiro e mais fácil programa diferenciável. </p><br><h2 id="encoding-structure-redux">  Estrutura de codificação, Redux </h2><br><p>  Os kits de ferramentas de ML estão cada vez mais suportando diferenciação algorítmica (AD), o que nos permite diferenciar modelos usando loops, ramificações e recursão - ou qualquer programa construído em um conjunto de primitivas matemáticas diferenciáveis.  Isso levou a uma arquitetura mais complexa: os modelos de PNL são cada vez mais parsers de gramática clássicos com modelos com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">aumento de pilha</a> , e você pode até diferenciar um análogo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">de uma máquina de Turing</a> ou de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">intérprete de linguagem de programação</a> . </p><br><p>  O último passo dado pela programação diferenciada é não considerar mais a multiplicação, a convolução e a <em>RNN da</em> matriz como elementos fundamentais da aprendizagem profunda, mas apenas como casos especiais.  Podemos aplicar métodos de aprendizado profundo a qualquer função diferenciável parametrizada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.418ex" height="2.66ex" viewBox="0 -832 1902 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-29" x="1512" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> f (x) </script>  .  Funções tão complexas quanto simuladores físicos ou traçadores de raios também podem ser diferenciadas e otimizadas.  Até <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">a computação quântica</a> pode se encaixar nessa estrutura. </p><br><p><img src="https://habrastorage.org/webt/8i/pk/fa/8ipkfaovyvmrkrgev-dnc85atm8.png"></p><br><p>  Os cientistas há muito tempo usam modelos mecanicistas que ficam entre programação explícita e aprendizado de máquina.  Equações diferenciais com parâmetros livres usados ​​em física, epidemiologia ou farmacodinâmica são equivalentes a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">redes neurais</a> em tudo, exceto na terminologia.  Eles simplesmente visam fornecer uma funcionalidade muito mais restrita, porque é muito mais simples. </p><br><p>  Um progresso verdadeiramente poderoso é o seguinte: diferenciabilidade generalizada significa que todos esses métodos se conectam como tijolos de <em>lego</em> . <br>  Em vez de sempre escrever novos programas para ML, podemos reutilizar programas existentes usando mecanismos físicos em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">modelos robóticos com</a> base em aprendizado profundo.  Onde os algoritmos modernos de aprendizado por reforço precisam criar um modelo detalhado do mundo exterior com base apenas no que eles serão recompensados ​​(soa como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">força bruta</a> ), podemos simplesmente aplicar conhecimentos detalhados e precisos dos sistemas físicos antes que o aprendizado comece. </p><br><p>  Mesmo as áreas mais maduras da aprendizagem profunda não se destacam;  após o núcleo de convolução, o próximo passo natural para os modelos de imagem é um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">traçador de raios diferenciável</a> .  A renderização em 3D contém muito conhecimento estrutural sobre como as cenas são exibidas em pixels, que ainda desempenharão um papel em nossa cozinha.  Digamos que um modelo tome decisões em um ambiente simulado exibido como pixels, que o modelo usa como entrada.  Em princípio, agora podemos diferenciar todo o ciclo, o que nos permitirá ver diretamente a influência do ambiente nas decisões do modelo e vice-versa.  Isso pode aumentar significativamente o poder de um ambiente simulado realista para modelos de treinamento, como carros com direção automática. </p><br><p>  Como na ciência, os modelos híbridos podem ser mais eficientes e resolver algumas das compensações entre aprendizado profundo e programação explícita.  Por exemplo, um planejador de trajetória de voo de um drone pode ter um componente de rede neural que só pode fazer alterações ligeiramente corretivas em um programa explícito confiável, fazendo com que seu comportamento geral seja analisado enquanto se adapta aos dados empíricos.  Isso também é bom para a interpretabilidade: os parâmetros de modelos e simulações mecanicistas geralmente têm interpretações físicas claras; portanto, se o modelo avaliar os parâmetros internos, fará uma declaração clara sobre o que, na sua opinião, acontece fora. </p><br><p>  Se tudo isso é maravilhoso, por que todos não desistiram e correram para aprender a se diferenciar?  Infelizmente, as limitações das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">estruturas existentes</a> dificultam a construção de modelos dessa complexidade e é impossível reutilizar a riqueza de conhecimentos incorporados no código científico existente.  A necessidade de reimplementar mecanismos físicos do zero em uma linguagem de modelagem muito limitada transforma um script de dez linhas em um projeto de pesquisa de vários anos.  Mas os avanços na linguagem e na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">tecnologia de compilação</a> , especialmente na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">diferenciação automática</a> , nos aproximam do Santo Graal: "apenas diferencie meu mecanismo de jogo, por favor". </p><br><h2 id="itak-chto-takoe-differenciruemoe-programmirovanie">  Então, o que é programação diferenciada? </h2><br><p>  A programação diferenciada permite aplicar métodos de aprendizado profundo a programas existentes complexos, reutilizando com eles uma enorme quantidade de conhecimento incorporado neles.  Aprendizado profundo, estatística, programação e ciência - tudo o que tenta dizer sua palavra na modelagem do mundo à nossa volta - é hora de combiná-lo, juntando-o como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">partículas em um colisor de hádrons</a> .  Isso melhorará os modelos atuais e permitirá que o ML seja aplicado em áreas onde suas limitações atuais - interpretabilidade ou requisitos computacionais e de dados - os tornam não aplicáveis ​​individualmente. </p><br><h2 id="differenciruemye-problemy-upravleniya">  Problemas de gerenciamento diferenciáveis </h2><br><p>  A seguir, mostramos que a diferenciabilidade pode trazer algumas tarefas de gerenciamento simples, mas clássicas, nas quais geralmente usamos o Aprendizado por Reforço (RL) como uma caixa preta.  Modelos diferenciáveis ​​(modelos ∂P) não apenas revelam estratégias de controle muito mais eficazes, mas também aprendem várias ordens de magnitude mais rapidamente.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">O código está disponível</a> para estudo - na maioria dos casos, ele aprende em alguns segundos em qualquer laptop. </p><br><h2 id="sleduyte-za-gradientom">  Siga o gradiente </h2><br><p>  A diferenciação é a força motriz em quase todas as etapas do aprendizado profundo;  para esta função <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.672ex" height="2.66ex" viewBox="0 -832 3733.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-28" x="2382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-78" x="2771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-29" x="3344" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> y = f (x) </script>  usamos o gradiente <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.061ex" height="2.419ex" viewBox="0 -780.1 4332 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-79" x="523" y="0"></use></g><g transform="translate(3236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-78" x="523" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ frac {dy} {dx} </script> para descobrir como uma mudança em <code>x</code> afetará <code>y</code> .  Apesar da natureza matemática, os gradientes são na verdade um conceito muito geral e intuitivo.  Esqueça as fórmulas que você teve que procurar na escola;  vamos fazer algo mais divertido, como jogar algo ao longo de um caminho parabólico. </p><br><p><img src="https://habrastorage.org/webt/hy/uu/qr/hyuuqrkomuhvvl8h_wxnqlzkfas.gif"></p><br><p>  Quando lançamos projéteis com a ajuda de três tiros, nosso <code>x</code> (entrada) representa a configuração (digamos, o tamanho do contrapeso ou o ângulo de ejeção), e <code>y</code> é a distância que o projétil percorre antes do pouso.  Se você está tentando mirar, o gradiente diz algo muito útil - aumente ou diminua um determinado parâmetro.  Para maximizar a distância, basta seguir o gradiente. </p><br><p>  OK, mas como obtemos o parâmetro certo?  Mas com a ajuda de uma coisa complicada chamada <a href="" rel="nofollow">diferenciação algorítmica</a> , que permite diferenciar não apenas fórmulas simples que você aprendeu na escola, mas também programas de qualquer complexidade - por exemplo, nosso <a href="" rel="nofollow">simulador Trebuchet</a> .  Como resultado, podemos pegar um simulador simples escrito em Julia e o pacote diff <a href="" rel="nofollow">diff DiffEq</a> sem um estudo aprofundado, e obter gradientes para isso em uma chamada de função. </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># what you did in school gradient(x -&gt; 3x^2 + 2x + 1, 5) # (32,) # something a little more advanced gradient((wind, angle, weight) -&gt; Trebuchet.shoot(wind, angle, weight), -2, 45, 200) # (4.02, -0.99, 0.051)</span></span></code> </pre> <br><h2 id="throwing-stuff">  Jogando coisas </h2><br><p>  Precisamos alvejar o trabuco no alvo, usando gradientes para ajustar o ângulo de ejeção;  Isso é chamado de estimativa de parâmetros e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">já vimos exemplos semelhantes</a> .  Podemos tornar a tarefa mais interessante, migrando para o meta-método: em vez de apontar o trebuchet para um alvo, otimizamos a rede neural, que pode direcioná-la para qualquer alvo.  Eis como funciona: uma rede neural aceita duas entradas, uma distância alvo em metros e a velocidade atual do vento.  Na rede, são definidas as configurações do trabuco (a massa do contrapeso e o ângulo de disparo), que são alimentados a um simulador que calcula a distância percorrida.  Em seguida, comparamos com nosso objetivo e percorremos toda a cadeia para ajustar o peso da rede.  Nosso "conjunto de dados" é um conjunto de alvos e velocidades do vento selecionados aleatoriamente. </p><br><p><img src="https://habrastorage.org/webt/nc/gz/7w/ncgz7wwykokoutzvfgyrm4xbspm.png"></p><br><p>  Uma boa característica desse modelo simples é que o aprendizado é rápido, porque expressamos exatamente o que queremos do modelo de uma maneira completamente diferenciada.  Inicialmente, fica assim: </p><br><p><img src="https://habrastorage.org/webt/au/8a/-d/au8a-dfq1ud9_fhdcrbvzapfedi.gif"></p><br><p>  Após cerca de cinco minutos de treinamento (no mesmo núcleo do processador do meu laptop), fica assim: </p><br><p><img src="https://habrastorage.org/webt/ta/wu/lr/tawulrzggnp09s7qwcyykbhqeqs.gif"></p><br><p>  Se você quiser influenciar a trajetória, aumente a velocidade do vento: </p><br><p><img src="https://habrastorage.org/webt/qq/9m/dg/qq9mdgrns5hqcpzedeoh1-htrua.gif"></p><br><p>  Desvio de 16 cm, ou cerca de 0,3%.  Que tal apontar diretamente para o trabuco?  Isso é fácil com a descida do gradiente, pois temos gradientes.  No entanto, esse é um processo iterativo lento que leva cerca de 100 ms por vez.  Pelo contrário, a operação de uma rede neural leva 5 μs (vinte mil vezes mais rápido) com uma leve perda de precisão.  Esse truque, chamado “inversão aproximada da função através de gradientes”, é muito comum e pode ser usado não apenas em sistemas dinâmicos, mas também em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">um algoritmo de transferência de estilo rápido</a> . </p><br><p>  Esse é o problema de gerenciamento mais simples possível que usamos principalmente para fins ilustrativos.  Mas podemos aplicar os mesmos métodos de maneiras mais avançadas aos problemas clássicos de RL. </p><br><h2 id="cart-meet-pole">  Carrinho, conheça o poste </h2><br><p>  Um desafio de gerenciamento mais reconhecível é o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">CartPole</a> , o "Olá mundo" para o aprendizado por reforço.  O desafio é aprender a equilibrar o pilar vertical empurrando sua base para a esquerda ou direita.  Nossa configuração é geralmente semelhante ao caso do Trebuchet: a <a href="" rel="nofollow">implementação de Julia</a> nos permite considerar diretamente as recompensas recebidas pelo ambiente como perdas.  ∂P nos permite alternar perfeitamente de um modelo simples para um modelo RL. </p><br><p><img src="https://habrastorage.org/webt/ik/wp/0y/ikwp0y4qhogsybm3rakwiyxwfuc.png"></p><br><p>  Um leitor astuto pode perceber um problema.  A área de ação para a tábua do piso - um deslocamento para a esquerda ou direita - é discreta e, portanto, não diferenciável.  Resolvemos esse problema introduzindo discretização diferenciável, definida da <a href="" rel="nofollow">seguinte maneira</a> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>f&amp;#xA0;(x)&amp;#xA0;=&amp;#xA0;\&amp;#xA0;esquerda&amp;#xA0;\&amp;#xA0;{\&amp;#xA0;begin&amp;#xA0;{matrix}&amp;#xA0;\,&amp;#xA0;1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;\&amp;#xA0;geqslant0&amp;#xA0;\\&amp;#xA0;-1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;&amp;lt;0&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{matrix}&amp;#xA0;\&amp;#xA0;right.</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;esquerda&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;esquerda&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> f (x) = \ esquerda \ {\ begin {matrix} \, 1, \, x \ geqslant0 \\ -1, \, x <0 \ end {matrix} \ right. </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>f</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.445ex" height="2.419ex" viewBox="0 -780.1 6219.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="523" y="0"></use></g><g transform="translate(3289,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-78" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-3D" x="4662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMAIN-31" x="5719" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ frac {df} {dx} = 1 </script></p><br><p>  Em outras palavras, fazemos o gradiente se comportar como se <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhjG0WGni-HpLfCY8eUb1FFl9By9Zg#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> f </script>  era uma função idêntica.  Dado o quanto a idéia matemática de diferenciabilidade já é usada no ML, talvez não seja surpreendente que possamos simplesmente enganar aqui;  para o treinamento, tudo o que precisamos é de um sinal para informar nossa caminhada pseudo-aleatória pelo espaço de parâmetros, e o resto são os detalhes.  Os resultados falam por si.  Nos casos em que os métodos de RL precisam ser treinados em centenas de episódios antes de resolver o problema, os modelos ∂P precisam de apenas 5 episódios para finalmente vencer. </p><br><p><img src="https://habrastorage.org/webt/7t/eq/hj/7teqhjn1f4rdicydv4iiqjasirm.gif"></p><br><h2 id="the-pendulum--backprop-through-time">  O Pêndulo e Backprop através do Tempo </h2><br><p>  Um objetivo importante da RL <em>(aprendizagem por reforço)</em> é lidar com a remuneração diferida quando uma ação não nos ajuda a melhorar os resultados de várias etapas seguidas.  Quando o ambiente é diferenciável, o ∂P permite treinar o agente na propagação reversa no tempo, como em uma rede recursiva!  Nesse caso, o estado do ambiente se torna um "estado oculto" que muda entre as etapas do tempo. </p><br><p><img src="https://habrastorage.org/webt/uy/od/mb/uyodmbo3grxrwkyawrgfol0nujo.png"></p><br><p>  Para demonstrar essa técnica, consideramos um modelo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">pêndulo</a> , no qual a tarefa é girar o pêndulo até que fique em pé e mantê-lo em equilíbrio instável.  Isso é difícil para os modelos RL;  Após cerca de 20 episódios de treinamento, o problema está resolvido, mas muitas vezes o caminho para a solução claramente não é o ideal.  Por outro lado, o BPTT pode superar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">ranking dos líderes de</a> RL em um episódio de treinamento.  É instrutivo observar como esse episódio se desenrola;  no início da gravação, a estratégia é aleatória e o modelo melhora com o tempo.  O ritmo do aprendizado é quase alarmante. </p><br><p><img src="https://habrastorage.org/webt/jm/wm/nh/jmwmnhr9nts4ki257ywtittvgck.gif"></p><br><p>  O modelo é adequado para usinar qualquer ângulo inicial e possui algo próximo à estratégia ideal.  Ao reiniciar, o modelo se parece com isso. </p><br><p><img src="https://habrastorage.org/webt/bu/7f/t3/bu7ft3bzofjrdumbfqvvwqr0nz8.gif"></p><br><p>  Este é apenas o começo;  obteremos sucesso real aplicando <em>DP</em> em ambientes com os quais geralmente é difícil trabalhar com RL, onde já existem simulações e modelos ricos (como na maioria das ciências naturais e de engenharia) e onde a interpretabilidade é um fator importante (como na medicina). </p><br><h2 id="the-map-is-not-the-territory">  O mapa não é o território </h2><br><p>  Uma limitação desses modelos de brinquedos é que eles equiparam o ambiente de aprendizado simulado ao ambiente de teste;  Obviamente, o mundo real não é diferenciável.  Em um modelo mais realista, a simulação nos fornece um padrão aproximado de comportamento, que é refinado pelos dados.  Esses dados informam, digamos, os efeitos simulados do vento, o que, por sua vez, melhora a qualidade dos gradientes que o simulador passa para o controlador.  Os modelos podem até fazer parte do passe direto do controlador, permitindo refinar suas previsões sem ter que estudar a dinâmica do sistema do zero.  Aprender essas novas arquiteturas fará um trabalho emocionante no futuro. </p><br><h2 id="coda">  Coda </h2><br><p>  A idéia básica é que a programação diferenciável, na qual simplesmente escrevemos um programa numérico arbitrário e o otimizamos usando gradientes, é uma maneira poderosa de criar melhores modelos e arquiteturas semelhantes ao aprendizado profundo, especialmente quando temos uma grande biblioteca de programas diferenciáveis ​​à mão .  Os modelos descritos são apenas visualizações, mas esperamos que eles tenham uma idéia de como essas idéias podem ser implementadas de uma maneira mais realista. </p><br><p>  Assim como a programação funcional envolve raciocinar e expressar algoritmos usando padrões funcionais, a programação diferenciável envolve a expressão de algoritmos usando padrões diferenciáveis.  A comunidade de aprendizado profundo já desenvolveu muitos desses padrões de design, por exemplo, para lidar com problemas de gerenciamento ou com uma estrutura de dados consistente e semelhante a uma árvore.  À medida que a área cresce, muito mais será inventado e, como resultado desses programas, provavelmente até as arquiteturas mais avançadas de aprendizado profundo parecerão rudes e atrasadas. </p><br><h3 id="ssylki">  Referências </h3><br><ul><li>  Fontes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Primeiro</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Segundo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Wikipedia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Auto diferenciação;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo sobre habr</a> </li><li>  <a href="" rel="nofollow">Auto diferenciação;</a>  <a href="" rel="nofollow">pacote terminado</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Auto diferenciação;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">faça você mesmo</a> </li></ul><br><p><img src="https://habrastorage.org/webt/f2/4o/pr/f24oprfnnrnguwwb03xcyo__xx4.gif"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt459562/">https://habr.com/ru/post/pt459562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt459550/index.html">Backup, Parte 5: Testando o Bacula e o Veeam Backup para Linux</a></li>
<li><a href="../pt459552/index.html">Como perder o acesso ao sistema ativo, simplesmente atrapalhando o código-fonte</a></li>
<li><a href="../pt459554/index.html">Acompanhe as alterações nos arquivos usando o Alerting OpenDistro for Elasticsearch</a></li>
<li><a href="../pt459558/index.html">Como começar a usar o Modo de Usuário no Linux</a></li>
<li><a href="../pt459560/index.html">Capacidades dos data centers de contêineres: centro de comutação pronto em Mianmar em 50 dias</a></li>
<li><a href="../pt459564/index.html">O que os desenvolvedores precisam saber sobre negócios</a></li>
<li><a href="../pt459568/index.html">Letra vertical na TI moderna</a></li>
<li><a href="../pt459570/index.html">Beeline mostra anúncios para o bot do Google. Bot infeliz</a></li>
<li><a href="../pt459574/index.html">Mergulhe profundamente nos namespaces do Linux, parte 2</a></li>
<li><a href="../pt459576/index.html">Extensões úteis do Google Chrome para o programador</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>