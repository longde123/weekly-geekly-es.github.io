<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥üèø üôáüèø üöµ Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 15 ‚Üí Zusammengesetzte Linien basierend auf Absatz üêΩ ü•© üïäÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In Lektion 12 haben wir die zusammengesetzten Linien vorgestellt und einen undokumentierten Weg untersucht, um sie zu erstellen. In Lektion 13 wurden ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arbeiten Sie mit der KOMPAS-3D-API ‚Üí Lektion 15 ‚Üí Zusammengesetzte Linien basierend auf Absatz</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/449706/">  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 12 haben</a> wir die zusammengesetzten Linien vorgestellt und einen undokumentierten Weg untersucht, um sie zu erstellen.  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 13</a> wurden Abs√§tze vorgestellt.  Heute werden wir uns ansehen, wie man sie verwendet, um zusammengesetzte Zeichenfolgen zu erstellen.  Nehmen wir zun√§chst Zeilen, die Abweichungen und Br√ºche enthalten, und machen Sie sich mit Komponenten zusammengesetzter Zeilen wie hochgestellten Zeichenfolgen, Teilzeichenfolgen und Sonderzeichen vertraut. <br><br><img src="https://habrastorage.org/webt/tv/bw/5s/tvbw5suar2wsso_c8xs4wgtlg5u.png"><br><a name="habracut"></a><br><blockquote><h4>  Der Inhalt der Unterrichtsreihe ‚ÄûArbeiten mit der KOMPAS-3D-API‚Äú </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Grundlagen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeichnungsentwurf</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Richtige Verbindung zu KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptinschrift</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grafische Grundelemente</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Speichern eines Dokuments in verschiedenen Formaten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einstellungen kennenlernen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anspruchsvollere Schreibmethoden im Schriftfeld</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschriftungszellen lesen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sonderzeichen einschlie√ülich einer Zeichenfolge</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einfache Textbeschriftungen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusammengesetzte Zeichenfolgen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abs√§tze</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mehrzeiliger Text</a> </li><li>  <b>Absatzbasierte zusammengesetzte Linien</b> </li></ol></blockquote><br><h2>  <font color="#00B2FF">Obere und untere Abweichungen</font> </h2><br>  Das Folgende ist ein Fragment eines Programms, das die Ausgabe einer Zeile mit oberen und unteren Abweichungen anhand von Abs√§tzen demonstriert.  Zu diesem <i>Zweck</i> werden die in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 12</a> erw√§hnten Flags <i>END_DEVIAT</i> , <i>LOWER_DEVIAT</i> und <i>UPPER_DEVIAT</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verwendet</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Programmcode-Snippet</b> <div class="spoiler_text"><pre><code class="plaintext hljs">//     DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont; itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(UPPER_DEVIAT); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(LOWER_DEVIAT); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(END_DEVIAT); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); // ,     itemFont.Unbind(); itemParam.Unbind(); //  ksTextLineParam TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); lineParam-&gt;SetTextItemArr(items); //  ksParagraphParam ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(30.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); Document2D-&gt;ksTextLine(lineParam); Document2D-&gt;ksEndObj(); //  items-&gt;ksDeleteArray(); items.Unbind(); lineParam.Unbind(); paragraphParam.Unbind();</code> </pre> <br></div></div><br>  Gegen√ºber dem Beispiel der Geb√§udeabweichung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 12 hat das</a> aktuelle Programm zwei wichtige Vorteile: <br><br><ol><li>  Es nutzt die dokumentierten Funktionen des COMPASS-Systems. </li><li>  Die Position der Zeilen muss nicht neu berechnet werden.  KOMPAS selbst ermittelt alle notwendigen Offsets. </li></ol><br>  Beachten Sie die Verwendung des <i>Flags END_DEVIAT</i> .  Es vervollst√§ndigt die Abweichungserzeugung und <i>l√∂scht die Flags</i> <i>LOWER_DEVIAT</i> und <i>UPPER_DEVIAT</i> .  Wenn wir es nicht verwendet h√§tten, w√ºrde die Zeile ‚ÄûText nach Abweichungen‚Äú als geringere Abweichung angezeigt. <br><br>  Die Flags <i>LOWER_DEVIAT</i> und <i>UPPER_DEVIAT</i> heben sich gegenseitig auf.  Bei gleichzeitiger Verwendung wird die Zeichenfolge so ausgegeben, wie sie ohne Angabe dieser Flags angezeigt w√ºrde. <br><br>  Da in unserem Beispiel das Flag <i>NEW_LINE</i> nicht verwendet wird, k√∂nnen alle Zeilen mit einem Aufruf der Methode <b>ksTextLine angezeigt</b> werden.  Dazu werden sie in Form der <b>ksTextLineParam-</b> Schnittstelle vorgeformt. <br><br>  Das Ergebnis des Programms ist in der folgenden Abbildung dargestellt. <br><br><img src="https://habrastorage.org/webt/zm/ji/qh/zmjiqh0dn3nnsld8ehwr44kmcbu.png"><br><br><h2>  <font color="#00B2FF">Bruchteil</font> </h2><br>  Das folgende Beispiel zeigt ein Programm, das die Ausgabe einer Zeichenfolge demonstriert, die einen Bruch enth√§lt. <br><br><div class="spoiler">  <b class="spoiler_title">Programmbeispiel</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//     DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont; itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(NUMERATOR); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(DENOMINATOR); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(END_FRACTION); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); // ,     itemFont.Unbind(); itemParam.Unbind(); //  ksTextLineParam TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); lineParam-&gt;SetTextItemArr(items); //  ksParagraphParam ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(30.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); Document2D-&gt;ksTextLine(lineParam); Document2D-&gt;ksEndObj(); //  items-&gt;ksDeleteArray(); items.Unbind(); lineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br>  Geb√§udefraktionen unterscheiden sich nicht wesentlich von Geb√§udeabweichungen.  Der einzige Unterschied sind die verwendeten Flags.  Das Flag <i>END_FRACTION</i> <i>l√∂scht die Flags</i> <i>NUMERATOR</i> und <i>DENOMINATOR</i> und <i>verh√§lt sich</i> f√ºr Abweichungen genauso wie das Flag <i>END_DEVIAT</i> . <br><a name="01"></a>  Die folgende Abbildung zeigt das Ergebnis dieses Programms. <br><br><img src="https://habrastorage.org/webt/6m/n6/f_/6mn6f_1juzjrcgxhcsdlh9uwsta.png"><br><br>  Diese Zeile sieht im Vergleich zum gleichen Text in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 12</a> ordentlicher aus. <br><br><h2>  <font color="#00B2FF">Kontrolle der Fraktionsgr√∂√üe</font> </h2><br>  Der angezeigte Bruch kann eine andere Gr√∂√üe haben, die √ºber die Schnittstelle <b>ksTextItemParam</b> gesteuert wird.  Wenn die <b>type-</b> Eigenschaft <i>FRACTION_TYPE</i> lautet, legt diese Schnittstelle unter anderem die Gr√∂√üe des Bruchs fest.  Die Gr√∂√üe selbst wird in der Eigenschaft <b>iSNumb</b> angegeben.  Die g√ºltigen Werte sind in der folgenden Tabelle aufgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/qy/nq/s3/qynqs38-69hjnl-dtnh2gxakcss.png"><br><br>  Wenn die <b>iSNumb-</b> Eigenschaft einen ung√ºltigen Wert angibt, verwendet KOMPAS die Standardh√∂he. <br><br>  Das Folgende ist ein Beispiel f√ºr die Verwendung des <i>FRACTION_TYPE-</i> Flags. <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel f√ºr die Verwendung von Flags</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//   DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont; itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(NUMERATOR); itemParam-&gt;set_type(FRACTION_TYPE); itemParam-&gt;set_iSNumb(3); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(DENOMINATOR); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(END_FRACTION); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); // ,     itemFont.Unbind(); itemParam.Unbind(); //  ksTextLineParam TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); lineParam-&gt;SetTextItemArr(items); //  ksParagraphParam ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(30.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); Document2D-&gt;ksTextLine(lineParam); Document2D-&gt;ksEndObj(); //  items-&gt;ksDeleteArray(); items.Unbind(); lineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br>  Dieses Beispiel unterscheidet sich vom vorherigen nur dadurch, dass der Typ <i>FRACTION_TYPE</i> in der <b>type-</b> Eigenschaft der <b>ksTextItemParam-</b> Schnittstelle bei der Ausgabe des Z√§hlers festgelegt wird.  Dies reicht jedoch aus, um die Gr√∂√üe der Fraktion zu √§ndern.  Die folgende Abbildung zeigt das Ergebnis dieses Programms (vergleichen Sie es mit dem Ergebnis des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorherigen Beispiels</a> ). <br><br><img src="https://habrastorage.org/webt/d5/le/i2/d5lei2irf17fse7tbnh5t-utt9o.png"><br><br>  Hinweis: Die Bruchgr√∂√üe wird festgelegt, wenn der Z√§hler angezeigt wird.  Wie meine Experimente zeigen, wird die bei der Anzeige des Nenners angegebene Bruchgr√∂√üe ignoriert. <br><br><h2>  <font color="#00B2FF">Hochgestellt und Teilzeichenfolge</font> </h2><br><br>  Der Aufbau eines Teilstrings und eines Teilstrings wird durch die in der folgenden Tabelle aufgef√ºhrten Flags gesteuert. <br><br><img src="https://habrastorage.org/webt/cl/lc/ea/cllceafou-1v2ua1ccnbbtkebhe.png"><br><br>  Das folgende Beispielprogramm demonstriert die Ausgabe eines Strings mit einem Teilstring und einem Teilstring. <br><br><div class="spoiler">  <b class="spoiler_title">Programmbeispiel</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//   DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont; itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_BASE); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_UPPER_INDEX); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_LOWER_INDEX); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_END); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); // ,     itemFont.Unbind(); itemParam.Unbind(); //  ksTextLineParam TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); lineParam-&gt;SetTextItemArr(items); //  ksParagraphParam ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(30.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); Document2D-&gt;ksTextLine(lineParam); Document2D-&gt;ksEndObj(); //  items-&gt;ksDeleteArray(); items.Unbind(); lineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br>  Die folgende Abbildung zeigt das Ergebnis dieses Programms. <br><br><img src="https://habrastorage.org/webt/li/us/wp/liuswpww_dwzf0nvk37j2ldmqso.png"><br><br>  <b>Sie</b> k√∂nnen keine <b>Teilzeichenfolge und Teilzeichenfolge mit der</b> Methode <b>ksDocument2D :: ksText erstellen</b> . <br><br><h2>  <font color="#00B2FF">Steuerung der Hauptzeilengr√∂√üe</font> </h2><br>  Die Hauptzeile kann eine andere Gr√∂√üe haben, die √ºber die Schnittstelle <b>ksTextItemParam</b> ge√§ndert werden kann.  Dazu wird die Konstante <i>SUM_TYPE</i> in ihrer <i>Eigenschaft</i> <b>type</b> und die erforderliche Gr√∂√üe der Hauptzeile in der Eigenschaft <b>iSNumb angegeben</b> .  G√ºltige Werte sind in der folgenden Tabelle aufgef√ºhrt: <br><br><img src="https://habrastorage.org/webt/vv/gs/ns/vvgsnsndff7gbgu0nd7tpa5bh6e.png"><br><br>  Wenn die <b>iSNumb-</b> Eigenschaft <b>einen</b> ung√ºltigen Wert <b>enth√§lt</b> , verwendet KOMPAS den Standardwert. <br><br>  Das Folgende ist ein Ausschnitt aus einem Programm, das die Verwendung der Konstante <b>SUM_TYPE</b> demonstriert. <br><br><div class="spoiler">  <b class="spoiler_title">Programm-Snippet</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//   DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont; itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_BASE); itemParam-&gt;set_type(SUM_TYPE); itemParam-&gt;set_iSNumb(2); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_UPPER_INDEX); itemParam-&gt;set_type(0); itemParam-&gt;set_iSNumb(0); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_LOWER_INDEX); str = SysAllocString(OLESTR("")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); itemFont-&gt;set_bitVector(S_END); str = SysAllocString(OLESTR("  ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); // ,     itemFont.Unbind(); itemParam.Unbind(); //  ksTextLineParam TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); lineParam-&gt;SetTextItemArr(items); //  ksParagraphParam ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(30.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); Document2D-&gt;ksTextLine(lineParam); Document2D-&gt;ksEndObj(); //  items-&gt;ksDeleteArray(); items.Unbind(); lineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br><br>  Die <b>Konstante SUM_TYPE wird</b> in die <b>type-</b> Eigenschaft der Schnittstelle <b>ksTextItemParam eingegeben</b> , wenn die Hauptzeile <b>angezeigt wird</b> .  Vor der Ausgabe des <b>Add-Ins</b> wird die <b>ksTextItemParam-</b> Schnittstelle auf ihren Ausgangszustand zur√ºckgesetzt.  Dies ist der einzige Unterschied zwischen diesem und dem vorherigen Beispiel. <br><br>  Die folgende Abbildung zeigt das Ergebnis des Programms (vergleichen Sie es mit dem Ergebnis des vorherigen Beispiels). <br><br><img src="https://habrastorage.org/webt/zt/or/tc/ztortccoo-aqlwtfu9agi9jn41u.png"><br><br>  Mit der <b>Konstante SUM_TYPE</b> k√∂nnen Sie die Gr√∂√üe der Hauptzeichenfolge √§ndern, nicht jedoch Teilzeichenfolgen und Teilzeichenfolgen.  Das √Ñndern der Gr√∂√üe in KOMPAS ist nicht vorgesehen. <br><br><h2>  <font color="#00B2FF">Sonderzeichen einschlie√ülich Teilzeichenfolge</font> </h2><br>  Ein Absatz kann Sonderzeichen verarbeiten, die eine Zeichenfolge enthalten (diese wurden in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lektion 10 des</a> Zyklus erl√§utert).  Das Folgende ist ein Fragment eines Programms, das ihre Verwendung in einem Absatz demonstriert. <br><br><div class="spoiler">  <b class="spoiler_title">Programm-Snippet</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  DynamicArrayPtr items; items = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); items-&gt;ksClearArray(); DynamicArrayPtr lines; lines = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_LINE_ARR)); lines-&gt;ksClearArray(); //   TextLineParamPtr lineParam; lineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); lineParam-&gt;Init(); TextItemParamPtr itemParam; itemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); itemParam-&gt;Init(); TextItemFontPtr itemFont = static_cast&lt;TextItemFontPtr&gt;(itemParam-&gt;GetItemFont()); //   BSTR str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; //     itemFont-&gt;set_bitVector(NEW_LINE | SPECIAL_SYMBOL); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); itemParam-&gt;set_type(SPECIAL_SYMBOL); itemParam-&gt;set_iSNumb(169); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); str = NULL; //   itemFont-&gt;set_bitVector(SPECIAL_SYMBOL_END); itemParam-&gt;set_s(NULL); itemParam-&gt;set_type(0); itemParam-&gt;set_iSNumb(0); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); //     itemFont-&gt;set_bitVector(NEW_LINE | SPECIAL_SYMBOL); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); itemParam-&gt;set_type(SPECIAL_SYMBOL); itemParam-&gt;set_iSNumb(96); items-&gt;ksAddArrayItem(-1, itemParam); SysFreeString(str); str = NULL; //   itemFont-&gt;set_bitVector(SPECIAL_SYMBOL_END); itemParam-&gt;set_s(NULL); itemParam-&gt;set_type(0); itemParam-&gt;set_iSNumb(0); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); //   itemFont-&gt;set_bitVector(NEW_LINE); str = SysAllocString(OLESTR(" ")); itemParam-&gt;set_s(str); itemParam-&gt;set_type(0); itemParam-&gt;set_iSNumb(0); items-&gt;ksAddArrayItem(-1, itemParam); lineParam-&gt;SetTextItemArr(items); lines-&gt;ksAddArrayItem(-1, lineParam); lineParam-&gt;Init(); SysFreeString(str); str = NULL; itemParam.Unbind(); lineParam.Unbind(); itemFont.Unbind(); items.Unbind(); //    ParagraphParamPtr paragraphParam; paragraphParam= static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); paragraphParam-&gt;set_width(60.0); paragraphParam-&gt;set_hFormat(2); //    TextParamPtr textParam = static_cast&lt;TextParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextParam)); textParam-&gt;SetParagraphParam(paragraphParam); textParam-&gt;SetTextLineArr(lines); //  Document2D-&gt;ksTextEx(textParam, 1); lines-&gt;ksDeleteArray(); lines.Unbind(); paragraphParam.Unbind(); textParam.Unbind();</code> </pre><br></div></div><br>  Das Beispiel sieht sehr kompliziert aus, aber wenn Sie es sich genau ansehen, k√∂nnen Sie sehen, dass es aus sich wiederholenden Teilen besteht.  Darin werden mit Hilfe von Sonderzeichen durchgestrichene und unterstrichene Texte angezeigt.  Nach jedem solchen Block wird eine leere Zeile mit dem Flag <i>SPECIAL_SYMBOL_END angezeigt</i> .  Seine Aufgabe ist es, die Aktion des Sonderzeichens abzubrechen.  Wenn es nicht angezeigt wird, ist der Absatz m√∂glicherweise nicht richtig aufgebaut.  Die Aktion des Sonderzeichens erstreckt sich auf den gesamten <b>ksTextLineParam-</b> Block, auf seine gesamte L√§nge, unabh√§ngig von seinem tats√§chlichen Inhalt (diese These ist in der folgenden Abbildung dargestellt). <br><br><img src="https://habrastorage.org/webt/1o/nl/8v/1onl8vnxvztwhnlvakl7kz1tbwa.png"><br><br>  Die <b>Abbruchzeile</b> muss Teil des Blocks <b>ksTextLineParam sein</b> .  Andernfalls ist der Absatz m√∂glicherweise nicht korrekt aufgebaut.  Der Block <b>ksTextLineParam</b> kann mehrere Steuerzeichen enthalten.  Jeder von ihnen sollte eine eigene Abbruchzeile haben. <br><br>  Das Flag <i>SPECIAL_SYMBOL_END wird</i> nur f√ºr Sonderzeichen mit einer <i>Teilzeichenfolge</i> verwendet.  F√ºr gew√∂hnliche Sonderzeichen wird es nicht ben√∂tigt. <br><br>  Die folgende Abbildung zeigt das Ergebnis unseres Beispiels. <br><br><img src="https://habrastorage.org/webt/yg/et/0v/yget0vbb9ghxe4h5zsi3srcuh5g.png"><br><br>  <b>Fazit</b> <br><br>  In dieser Lektion haben wir gelernt, wie man mit Abs√§tzen zusammengesetzte Linien erstellt, einschlie√ülich Abweichungen und Br√ºche, und dokumentierte M√∂glichkeiten untersucht, um zusammengesetzte Linien basierend auf einem Absatz zu erstellen.  Dies ist nicht der einzige und bei weitem nicht einfachste Weg, sie zu erstellen.  Eine andere, viel einfachere M√∂glichkeit werden wir in der n√§chsten Lektion betrachten. <br><br>  <b>Um fortzufahren, folgen Sie den Nachrichten des Blogs.</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., Autor des Buches "Anwendungsentwicklung f√ºr COMPAS in Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de449706/">https://habr.com/ru/post/de449706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de449690/index.html">Im geheimen Labor von Ledger</a></li>
<li><a href="../de449696/index.html">Nehmen Sie am Wettbewerb zum √úbertakten von RAM - HyperX Memory OC Competition 2019 teil</a></li>
<li><a href="../de449700/index.html">Warum der Verkehr pl√∂tzlich zum Stau wird</a></li>
<li><a href="../de449702/index.html">Auf der B√ºhne wieder Gewinner der internationalen Wettbewerbe SSH und sudo. Unter der Anleitung von Honoured Conductor Active Directory</a></li>
<li><a href="../de449704/index.html">MVCC-5. In-Page-Reinigung und HEISS</a></li>
<li><a href="../de449708/index.html">Citymobil - ein Handbuch zur Verbesserung der Verf√ºgbarkeit bei Unternehmenswachstum f√ºr Startups. Teil 3</a></li>
<li><a href="../de449712/index.html">W√∂chentliche Nachrichten: HDD-Nachfrage sinkt, staatliches Internetgesetz genehmigt, 5G-Ger√§teproduktion in Russland</a></li>
<li><a href="../de449714/index.html">Null ist nicht immer Null</a></li>
<li><a href="../de449716/index.html">Acronis er√∂ffnet Entwicklern zum ersten Mal den Zugriff auf die API</a></li>
<li><a href="../de449718/index.html">KI lehrte, das posttraumatische Syndrom durch menschliche Stimme zu bestimmen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>