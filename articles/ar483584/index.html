<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ง๐พ ๐คฅ ููู ุฎูููุฉ PHP ุฅูู ุญุงููุฉ ุชุฏููุงุช Redis ูุงุฎุชูุงุฑ ููุชุจุฉ ูุณุชููุฉ ุนู ุงูุฃุทุฑ ๐ ๐ ๐๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏูุฉ 
 ุชู ุชุตููู ูููุนู ุ ุงูุฐู ุฃููู ุจู ูููุงูุฉ ุ ูุชุฎุฒูู ุงูุตูุญุงุช ุงูุฑุฆูุณูุฉ ุงููุซูุฑุฉ ููุงูุชูุงู ูุงูููุงูุน ุงูุดุฎุตูุฉ. ุจุฏุฃ ูุฐุง ุงูููุถูุน ูุซูุฑ ุงูุชูุงูู ูู ุจุฏุงูุฉ ูุณุงุฑู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููู ุฎูููุฉ PHP ุฅูู ุญุงููุฉ ุชุฏููุงุช Redis ูุงุฎุชูุงุฑ ููุชุจุฉ ูุณุชููุฉ ุนู ุงูุฃุทุฑ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483584/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wk/hw/mm/wkhwmmingyzwy7-r1esz_9vna54.png"><br><br><h2 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br>  ุชู ุชุตููู ูููุนู ุ ุงูุฐู ุฃููู ุจู ูููุงูุฉ ุ ูุชุฎุฒูู ุงูุตูุญุงุช ุงูุฑุฆูุณูุฉ ุงููุซูุฑุฉ ููุงูุชูุงู ูุงูููุงูุน ุงูุดุฎุตูุฉ.  ุจุฏุฃ ูุฐุง ุงูููุถูุน ูุซูุฑ ุงูุชูุงูู ูู ุจุฏุงูุฉ ูุณุงุฑู ูู ุงูุจุฑูุฌุฉ ุ ููู ุชูู ุงููุญุธุฉ ููุช ุณุนูุฏูุง ููุนุซูุฑ ุนูู ูููููู ุฑุงุฆุนูู ููุชุจูู ุนู ุฃููุณูู ูููุงูุงุชูู ููุดุงุฑูุนูู.  ุธูุช ุนุงุฏุฉ ุงูุชุดุงููุง ูู ุงูููุช ุงูุญุงูู: ูู ูู ูููุน ุชุฌุงุฑู ุชูุฑูุจูุง ูููุณ ูููุนูุง ุนูู ุงูููุจ ุ ูุง ุฒูุช ุฃุชุทูุน ุฅูู ุชุฐููู ุงูุตูุญุฉ ุจุญุซูุง ุนู ุฑูุงุจุท ูููุคูููู. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุชูููุฐ ุงูููุฑุฉ </h2><br>  ุงูุฅุตุฏุงุฑ ุงูุฃูู ูุงู ูุฌุฑุฏ ุตูุญุฉ html ุนูู ูููุนู ุงูุดุฎุตู ุ ุญูุซ ูุถุนุช ุฑูุงุจุท ูุน ุงูุชูุงููุน ูู ูุงุฆูุฉ ul.  ุจุนุฏ ุฃู ูุชุจุช 20 ุตูุญุฉ ูุจุนุถ ุงูููุช ุ ุจุฏุฃุช ุฃุนุชูุฏ ุฃููุง ูู ุชูู ูุนุงูุฉ ููุบุงูุฉ ููุฑุฑุช ูุญุงููุฉ ุฃุชูุชุฉ ุงูุนูููุฉ.  ูู stackoverflow ุ ูุงุญุธุช ุฃู ุงูุนุฏูุฏ ูู ุงูููุงูุน ุชุดูุฑ ุฅูู ููุงูุนูุง ูู ูููุงุช ุงูุชุนุฑูู ุงูุฎุงุตุฉ ุจูุง ุ ูุฐูู ูุชุจุช ูุญูู php ุงูุฐู ูุฑ ููุชู ุนูู ุงููููุงุช ุงูุดุฎุตูุฉ ุ ุจุฏุกูุง ูู ุงูุฃูู (ุงูุนููุงู ูู SO ูุญุชู ูุฐุง ุงูููู ูู ูุฐุง ุงูููุน: `/ users / 1`) ุ ุงูุฑูุงุจุท ุงููุณุชุฎุฑุฌุฉ ูู ุงูุนูุงูุฉ ุงููุทููุจุฉ ูููุฏุณุฉ ูู ุณูููุชู. <br><br>  ูููู ุฃู ูุณูู ูุฐุง ุงูุฅุตุฏุงุฑ ุงูุซุงูู: ูุฌููุนุฉ ูู ุนุดุฑุงุช ุงูุขูุงู ูู ุนูุงููู URL ูู ููุญุฉ SQLite ุงูุชู ุญูุช ูุญู ุงููุงุฆูุฉ ุงูุซุงุจุชุฉ ูู html.  ููุฏ ุฃุฌุฑูุช ุจุญุซ ุจุณูุท ูู ูุฐู ุงููุงุฆูุฉ.  ูุฃู  ูุงู ููุงู ุนูุงููู url ููุท ุ ุซู ูุงู ุงูุจุญุซ ูุฎุตุตูุง ููู ููุท. <br><br>  ูู ูุฐู ุงููุฑุญูุฉ ุ ุชุฎูุช ุนู ุงููุดุฑูุน ูุนุฏุช ุฅููู ุจุนุฏ ูุชุฑุฉ ุทูููุฉ.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุงูุช ุฎุจุฑุฉ ุนููู ุจุงููุนู ุฃูุซุฑ ูู ุซูุงุซ ุณููุงุช ูุดุนุฑุช ุฃูู ูููููู ุงูููุงู ุจุดูุก ุฃูุซุฑ ุฌุฏูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุงูุช ููุงู ุฑุบุจุฉ ูุจูุฑุฉ ูู ุฅุชูุงู ุงูุชูููุงุช ุงูุฌุฏูุฏุฉ ูุณุจูุงู ูุฃููุณูู. <br><br><h2 style=";text-align:right;direction:rtl">  ูุณุฎุฉ ุญุฏูุซุฉ </h2><br>  <a href="https://hpdb.ru/">ุชู</a> ูุดุฑ <a href="https://hpdb.ru/">ุงููุดุฑูุน</a> ูู ุนุงูู ูููุงุก ุ ูุชู ููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅูู mongoDb ุ ููุคุฎุฑุง ูุณุจูุง ุ ุฃุถููุช ุงููุฌู ุ ูุงูุฐู ูุงู ูู ุงูุจุฏุงูุฉ ููุท ููุชุฎุฒูู ุงููุคูุช.  ูุฃุณุงุณ ุ ูุชู ุงุณุชุฎุฏุงู ูุงุญุฏุฉ ูู PHP microframes. <br><br><h4 style=";text-align:right;direction:rtl">  ุงููุดููุฉ </h4><br>  ุชุชู ุฅุถุงูุฉ ุงูููุงูุน ุงูุฌุฏูุฏุฉ ุจูุงุณุทุฉ ุฃูุฑ ูุญุฏุฉ ุงูุชุญูู ุจุดูู ูุชุฒุงูู ูููู ุจูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุงููุญุชูู ุนู ุทุฑูู URL <br></li><li style=";text-align:right;direction:rtl">  ุฅุดุงุฑุงุช ุณูุงุก HTTPS ูุงูุช ูุชุงุญุฉ <br></li><li style=";text-align:right;direction:rtl">  ูุญุงูุธ ุนูู ุฌููุฑ ุงููููุน <br></li><li style=";text-align:right;direction:rtl">  HTML ุงููุตุฏุฑ ูุงูุฑุคูุณ ูุญูุธ ูู ุชุงุฑูุฎ ุงูููุฑุณุฉ <br></li><li style=";text-align:right;direction:rtl">  ููุฒุน ุงููุญุชูู ุ ููุณุชุฑุฌุน ุงูุนููุงู ูุงููุตู <br></li><li style=";text-align:right;direction:rtl">  ูุญูุธ ุงูุจูุงูุงุช ุฅูู ูุฌููุนุฉ ูููุตูุฉ. <br></li></ul><br>  ูุงู ูุฐุง ูููู ูุชุฎุฒูู ุงูููุงูุน ูุนุฑุถูุง ูู ูุงุฆูุฉ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a4/914/0f8/5a49140f8a7a27eac0e22c21b24ada69.png"><br><br>  ููู ููุฑุฉ ููุฑุณุฉ ูุชุตููู ูุชุตููู ูู ุดูุก ุชููุงุฆููุง ุ ูุงูุญูุงุธ ุนูู ุชุญุฏูุซ ูู ุดูุก ุ ุชูุงุณุจ ูุฐุง ุงููููุฐุฌ ุจุดูู ุถุนูู.  ุญุชู ูุฌุฑุฏ ุฅุถุงูุฉ ุทุฑููุฉ ููุจ ูุฅุถุงูุฉ ุงูุตูุญุงุช ุงููุทููุจุฉ ููุฏ ุงูุงุฒุฏูุงุฌูุฉ ูุงูุญุธุฑ ูุชุฌูุจ DDoS ุงููุญุชููุฉ. <br><br>  ุจุดูู ุนุงู ุ ุจุงูุทุจุน ุ ูููู ุงูููุงู ุจูู ุดูุก ุจุดูู ูุชุฒุงูู ุ ููู ุทุฑููุฉ ุงูููุจ ุ ูุง ุนููู ุณูู ุญูุธ ุนููุงู URL ููุชุฃูุฏ ูู ุฃู ุงูุจุฑูุงูุฌ ุงูุฎูู ุงููุญุดู ูุคุฏู ุฌููุน ุงูููุงู ูุนูุงููู URL ูู ุงููุงุฆูุฉ.  ูููู ูู ููุณ ุ ุญุชู ููุง ูููุฉ "ุจุฏูุฑู" ูุทุฑุญ.  ูุฅุฐุง ุชู ุชูููุฐ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูููู ุชูุณูู ุฌููุน ุงูููุงู ูุชูููุฐูุง ุจุดูู ุบูุฑ ูุชุฒุงูู ุนูู ุงูุฃูู. <br><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ุชูุฏูู ููุงุฆู ุงูุงูุชุธุงุฑ ูุฌุนู ูุธุงู ุงููุนุงูุฌุฉ ูุญุฑููุง ุงูุญุฏุซ ูุฌููุน ุงูููุงู.  ูููุชุฑุฉ ุทูููุฉ ุฃุฑุฏุช ุชุฌุฑุจุฉ Redis Streams. <br><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ุชุฏููุงุช Redis ูู PHP </h2><br>  ูุฃู  ููุณ ูุฏู ุฅุทุงุฑ ุนูู ููุนูุงููุฉ ุงูุซูุงุซุฉ Symfony ู Laravel ู Yii ุ ูุฃูุฏ ุฃู ุฃุฌุฏ ููุชุจุฉ ูุณุชููุฉ.  ูููู ุ ููุง ุงุชุถุญ (ุนูุฏ ุงูุงุฎุชุจุงุฑ ุงูุฃูู) ุ ูู ุงููุณุชุญูู ุงูุนุซูุฑ ุนูู ููุชุจุงุช ุฌุงุฏุฉ ูุฑุฏูุฉ.  ูู ูุง ูุฑุชุจุท ุจููุงุฆู ุงูุงูุชุธุงุฑ ูู ุฅูุง ุฅุณูุงุท 3 ุนูููุงุช ุงุฑุชูุงุจูุง ูุจู ุฎูุณ ุณููุงุช ุ ุฃู ูุฑุชุจุท ุจุฅุทุงุฑ ุนูู. <br><br>  ููุฏ ุณูุนุช ุนู Symfony ูููุฏู ูุจุนุถ ุงูููููุงุช ุงููููุฏุฉ ุ ูุฃูุง ุจุงููุนู ุงุณุชุฎุฏู ุจุนุถูุง.  ูุฃูุถูุง ูู Laravel ุ ูููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุดูุก ูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ORM ุงูุฎุงุต ุจูู ุ ุฏูู ูุฌูุฏ ุงูุฅุทุงุฑ ููุณู. <br><br><h4 style=";text-align:right;direction:rtl">  ุณูููููู / ุฑุณูู </h4><br>  ุจุฏุง ุงููุฑุดุญ ุงูุฃูู ูุซุงูููุง ุนูู ุงูููุฑ ุ ูุจุฏูู ุฃู ุดู ููุช ุจุชุซุจูุชู.  ูููู ูุงู ูู ุงูุตุนุจ ุนูู ุฌูุฌู ุงุณุชุฎุฏุงู ุฃูุซูุฉ ุฎุงุฑุฌ Symfony.  ููู ุชุฌูุน ูู ูุฌููุนุฉ ูู ุงูุทุจูุงุช ุฐุงุช ุฃุณูุงุก ุนุงูููุฉ ุ ููุง ุชุชุญุฏุซ ุนู ุฃู ุดูุก ุ ุฃู ุญุงููุฉ ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุ ุฃู ุญุชู ุนูู Redisุ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f2b/1bf/ac0/f2b1bfac07a1e307d7b5826a1b191e3d.png"><br><br>  ูุงูุช ุงููุซุงุฆู ุงูููุฌูุฏุฉ ุนูู ุงููููุน ุงูุฑุณูู ููุตููุฉ ุชูุงููุง ุ ููู ุงูุชูุตูู ุชู ูุตูู ููุท ูู ุฃุฌู Symfony ุจุงุณุชุฎุฏุงู YML ุงูููุถูุฉ ูุบูุฑู ูู ุงูุทุฑู ุงูุณุญุฑูุฉ ูุบูุฑ ุงููุตูู ููุณูููููุฉ.  ูู ููู ูุฏู ุฃู ูุตูุญุฉ ูู ุนูููุฉ ุงูุชุซุจูุช ุ ุฎุงุตุฉ ุฎูุงู ุนุทูุฉ ุฑุฃุณ ุงูุณูุฉ ุงูุฌุฏูุฏุฉ.  ูููู ูุงู ุนูู ุงูููุงู ุจุฐูู ููุชุฑุฉ ุทูููุฉ ุจุดูู ุบูุฑ ูุชููุน. <br><br>  ุฅู ูุญุงููุฉ ูุนุฑูุฉ ููููุฉ ุฅูุดุงุก ูุซูู ููุธุงู ุจุงุณุชุฎุฏุงู ูุตุงุฏุฑ Symfony ููุณุช ุฃูุถูุง ุงููููุฉ ุงูุฃูุซุฑ ุชุงููุฉ ุจุงููุณุจุฉ ููููุงุนูุฏ ุงูููุงุฆูุฉ ุงูุถููุฉ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc7/de8/991/bc7de89919463a8e7e4bfc5adec9df27.png"><br><br>  ููุฏ ุชุฌูุนุช ูู ุฐูู ูุญุงููุช ุฃู ุฃูุนู ุดูุฆูุง ุจูุฏู ุ ูุฎูุตุช ุฅูู ุฃููู ููุช ุฃููู ุจููุน ูู ุงูุนูุงุฒุงุช ููุฑุฑุช ุชุฌุฑุจุฉ ุดูุก ุขุฎุฑ. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุถูุก / ูุงุฆูุฉ ุงูุงูุชุธุงุฑ </h4><br>  ุงุชุถุญ ุฃู ูุฐู ุงูููุชุจุฉ ูุงูุช ูุฑุชุจุทุฉ ุจุฅุญูุงู ุจุงูุจููุฉ ุงูุชุญุชูุฉ ูุงุฑุงููู ููุฌููุนุฉ ูู ุงูุชุจุนูุงุช ุงูุฃุฎุฑู ุ ูุฐูู ูู ุฃูุถู ุงููุซูุฑ ูู ุงูููุช ุนูููุง: ุชุซุจูุชูุง ููุธุฑุชูุง ูุดุงูุฏ ุงูุชุจุนูุงุช ูุญุฐููุง. <br><br><h4 style=";text-align:right;direction:rtl">  yiisoft / yii2- ูุงุฆูุฉ ุงูุงูุชุธุงุฑ </h4><br>  ุญุณููุง ุ ููุง ุชู ุงูุชุฑุงุถู ุนูู ุงูููุฑ ูู ุงูุงุณู ุ ูุฑุฉ ุฃุฎุฑู ุงุฑุชุจุงุท ูุดุฏูุฏ ูู Yii2.  ุงุถุทุฑุฑุช ุฅูู ุงุณุชุฎุฏุงู ูุฐู ุงูููุชุจุฉ ููู ุชูู ุณูุฆุฉ ุ ููููู ูู ุฃุนุชูุฏ ุฃู ุฐูู ูุนุชูุฏ ุชูุงููุง ุนูู Yii2. <br><br><h4 style=";text-align:right;direction:rtl">  ุงูุจุงูู </h4><br>  ูุงู ูู ุดูุก ุขุฎุฑ ูุฌุฏุชู ุนูู ุฌูุซุจ ูุง ูููู ุงูุงุนุชูุงุฏ ุนููู ูุชููุนุงุช ููุฌูุฑุฉ ุจุฏูู ูุฌูู ูุดูู ูุนุฏุฏ ูุจูุฑ ูู ุงูุฅูุชุฒุงูุงุช. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุนูุฏุฉ ุฅูู symfony / messenger ุ ุงูุชูุงุตูู ุงููููุฉ </h2><br>  ูุงู ุนููู ุงูุชุนุงูู ูุน ูุฐู ุงูููุชุจุฉ ูุจุนุฏ ูุถุงุก ุจุนุถ ุงูููุช ุ ุชูููุช ูู ุฐูู.  ุงุชุถุญ ุฃู ูู ุดูุก ููุฌุฒ ูุจุณูุท ููุบุงูุฉ.  ูู ุฃุฌู ุฅูุดุงุก ูุซูู ููุญุงููุฉ ุ ููุฏ ุตูุนุช ูุตูุนูุง ุตุบูุฑูุง ุ ูุฃูู  ูุงู ูุฏู ุงูุนุฏูุฏ ูู ุงูุฅุทุงุฑุงุช ูุน ูุฎุชูู ูุนุงูุฌุงุช. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/970/723/ab2/970723ab2c86a6b4adfb35f32208fa76.png"><br><br>  ููุท ุจุถุน ุฎุทูุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุนุงูุฌุงุช ุงูุฑุณุงุฆู ุงูุชู ูุฌุจ ุฃู ุชููู ููุท ููุงุชุตุงู <br></li><li style=";text-align:right;direction:rtl">  ูููุง ูู HandlerDescriptor (ูุฆุฉ ูู ุงูููุชุจุฉ) <br></li><li style=";text-align:right;direction:rtl">  ูููู ุจูู ูุฐู "ุงููุงุตูุงุช" ูู ูุซูู HandlersLocator. <br></li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ HandlersLocator ุฅูู ูุซูู MessageBus <br></li><li style=";text-align:right;direction:rtl">  ููุฑุฑ ุฅูู SendersLocator ูุฌููุนุฉ ูู "SenderInterface" ุ ูู ุญุงูุชู ูู ูุฆุงุช `RedisTransport` ุ ุงูุชู ุชู ุชูููููุง ุจุทุฑููุฉ ูุงุถุญุฉ <br></li><li style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ SendersLocator ุฅูู ูุซูู MessageBus <br></li></ul><br>  ูุฏู MessageBus ุทุฑููุฉ `-&gt; ุฅุฑุณุงู ()` ุ ูุงูุชู ุชุจุญุซ ุนู ุงููุนุงูุฌุงุช ุงูููุงุณุจุฉ ูู HandlersLocator ูุชูุฑูุฑ ุงูุฑุณุงูุฉ ุฅูููู ุ ุจุงุณุชุฎุฏุงู `SenderInterface` ุงููุทุงุจู ููุฅุฑุณุงู ุนุจุฑ ุงูุญุงููุฉ (ุชุฏููุงุช Redis). <br><br>  ูู ุชูููู ุงูุญุงููุฉ (ูู ูุฐู ุงูุญุงูุฉ php-di) ุ ูููู ุชูููู ูุฐู ุงููุฌููุนุฉ ุจุฃููููุง ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="php hljs">CONTAINER_REDIS_TRANSPORT_SECRET =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisTransport( $c-&gt;get(CONTAINER_REDIS_STREAM_CONNECTION_SECRET), $c-&gt;get(CONTAINER_SERIALIZER)) ; }, CONTAINER_REDIS_TRANSPORT_LOG =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisTransport( $c-&gt;get(CONTAINER_REDIS_STREAM_CONNECTION_LOG), $c-&gt;get(CONTAINER_SERIALIZER)) ; }, CONTAINER_REDIS_STREAM_RECEIVER_SECRET =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisReceiver( $c-&gt;get(CONTAINER_REDIS_STREAM_CONNECTION_SECRET), $c-&gt;get(CONTAINER_SERIALIZER) ); }, CONTAINER_REDIS_STREAM_RECEIVER_LOG =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisReceiver( $c-&gt;get(CONTAINER_REDIS_STREAM_CONNECTION_LOG), $c-&gt;get(CONTAINER_SERIALIZER) ); }, CONTAINER_REDIS_STREAM_BUS =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ $sendersLocator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendersLocator([ \App\Messages\SecretJsonMessages::class =&gt; [CONTAINER_REDIS_TRANSPORT_SECRET], \App\Messages\DaemonLogMessage::class =&gt; [CONTAINER_REDIS_TRANSPORT_LOG], ], $c); $middleware[] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendMessageMiddleware($sendersLocator); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageBus($middleware); }, CONTAINER_REDIS_STREAM_CONNECTION_SECRET =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ $host = <span class="hljs-string"><span class="hljs-string">'bu-02-redis'</span></span>; $port = <span class="hljs-number"><span class="hljs-number">6379</span></span>; $dsn = <span class="hljs-string"><span class="hljs-string">"redis://$host:$port"</span></span>; $options = [ <span class="hljs-string"><span class="hljs-string">'stream'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'secret'</span></span>, <span class="hljs-string"><span class="hljs-string">'group'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'consumer'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'default'</span></span>, ]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Connection::fromDsn($dsn, $options); }, CONTAINER_REDIS_STREAM_CONNECTION_LOG =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContainerInterface $c)</span></span></span><span class="hljs-function"> </span></span>{ $host = <span class="hljs-string"><span class="hljs-string">'bu-02-redis'</span></span>; $port = <span class="hljs-number"><span class="hljs-number">6379</span></span>; $dsn = <span class="hljs-string"><span class="hljs-string">"redis://$host:$port"</span></span>; $options = [ <span class="hljs-string"><span class="hljs-string">'stream'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'log'</span></span>, <span class="hljs-string"><span class="hljs-string">'group'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'consumer'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'default'</span></span>, ]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Connection::fromDsn($dsn, $options); },</code> </pre> <br>  ูููู ููุงุญุธุฉ ุฃูู ูู SendersLocator ูููุง ุจุชุฎุตูุต "ููู" ูุฎุชูู ูุฑุณุงูุชูู ูุฎุชููุชูู ุ ูููู ููููุง ุงุชุตุงูู ุงูุฎุงุต ุจุงูุชูุงุฑุงุช ุงูููุงุจูุฉ. <br><br>  ููุฏ ุชูุฏูุช ุจูุดุฑูุน ุชุฌุฑูุจู ูููุตู ููุถุญ ุชุทุจูู ุซูุงุซุฉ ุดูุงุทูู ูุชูุงุตููู ูุน ุจุนุถูู ุงูุจุนุถ ุจุงุณุชุฎุฏุงู ูุซู ูุฐู ุงูุญุงููุฉ: <a href="https://github.com/backend-university/products/tree/master/products/02-redis-streams-bus">https://github.com/backend-university/products/tree/master/products/02-redis-streams-bus</a> . <br><br>  ูููู ุณุฃุฑููู ููู ูููู ุชุฑุชูุจ ุงููุณุชููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">DaemonLogMessage</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>\<span class="hljs-title"><span class="hljs-title">HandlerDescriptor</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">Handler</span></span>\<span class="hljs-title"><span class="hljs-title">HandlersLocator</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">MessageBus</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">Middleware</span></span>\<span class="hljs-title"><span class="hljs-title">HandleMessageMiddleware</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">Middleware</span></span>\<span class="hljs-title"><span class="hljs-title">SendMessageMiddleware</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Messenger</span></span>\<span class="hljs-title"><span class="hljs-title">Transport</span></span>\<span class="hljs-title"><span class="hljs-title">Sender</span></span>\<span class="hljs-title"><span class="hljs-title">SendersLocator</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span> . <span class="hljs-string"><span class="hljs-string">'/../vendor/autoload.php'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Psr\Container\ContainerInterface $container */</span></span> $container = <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(<span class="hljs-string"><span class="hljs-string">'config/container.php'</span></span>); $handlers = [ DaemonLogMessage::class =&gt; [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandlerDescriptor( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DaemonLogMessage $m)</span></span></span><span class="hljs-function"> </span></span>{ \error_log(<span class="hljs-string"><span class="hljs-string">'DaemonLogHandler: message handled: / '</span></span> . $m-&gt;getMessage()); }, [<span class="hljs-string"><span class="hljs-string">'from_transport'</span></span> =&gt; CONTAINER_REDIS_TRANSPORT_LOG] ) ], ]; $middleware = []; $middleware[] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandleMessageMiddleware(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandlersLocator($handlers)); $sendersLocator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendersLocator([<span class="hljs-string"><span class="hljs-string">'*'</span></span> =&gt; [CONTAINER_REDIS_TRANSPORT_LOG]], $container); $middleware[] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendMessageMiddleware($sendersLocator); $bus = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageBus($middleware); $receivers = [ CONTAINER_REDIS_TRANSPORT_LOG =&gt; $container-&gt;get(CONTAINER_REDIS_STREAM_RECEIVER_LOG), ]; $w = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Symfony\Component\Messenger\Worker($receivers, $bus, $container-&gt;get(CONTAINER_EVENT_DISPATCHER)); $w-&gt;run();</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ูุฐู ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ุงูุชุทุจูู </h2><br>  ุจุนุฏ ุฃู ููุช ุจุชูููุฐ ุงูุญุงููุฉ ูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุงูุฎุงุตุฉ ุจู ุ ุงุฎุชุฑุช ุฎุทูุงุช ูุฑุฏูุฉ ูู ุงููุฑูู ุงููุฏูู ุงููุชุฒุงูู ูุฃุนุฏุช ูุนุงูุฌุงุช ูููุตูุฉ ุ ูู ูููุง ูุนูู ูู ุฃุนูุงูู ุงูุฎุงุตุฉ. <br><br>  ุฎุท ุฃูุงุจูุจ ูุฅุถุงูุฉ ูููุน ุฌุฏูุฏ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุง ููู: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1a/ccf/202/f1accf2020c51b0ae5e5c39033d7d375.png"><br><br>  ูุจุนุฏ ุฐูู ุฃุตุจุญ ุงูุฃูุฑ ุฃุณูู ุจุงููุณุจุฉ ูู ูุฅุถุงูุฉ ูุธุงุฆู ุฌุฏูุฏุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุฎุฑุงุฌ ูุชุญููู Rss.  ูุฃู  ูุธุฑูุง ูุฃู ูุฐู ุงูุนูููุฉ ุชุชุทูุจ ุฃูุถูุง ูุญุชูู ุงููุตุฏุฑ ุ ูุฅู ูุนุงูุฌ ุงุณุชุฎุฑุงุฌ ุฑุงุจุท rss ุ ููุฐูู WebsiteIndexHistoryPersistor ุ ูุดุชุฑู ูู ุงูุฑุณุงูุฉ "Content / HtmlContent" ุ ููููู ุจูุนุงูุฌุชูุง ุ ูููุฑุฑ ุงูุฑุณุงูุฉ ุงููุทููุจุฉ ุนูู ุฎุท ุฃูุงุจูุจูุง ุจุดูู ุฃูุจุฑ. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cc/641/d52/8cc641d52b4a394c5381967360187ab0.png"><br><br>  ูู ุงูููุงูุฉ ุ ุงุชุถุญ ุฃู ููุงู ุงูุนุฏูุฏ ูู ุงูุดูุงุทูู ุ ูู ูููุง ูุฑุจุท ููุท ุจุงูููุงุฑุฏ ุงููุงุฒูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู ุงูุจุฑูุงูุฌ ุงูุฎูู ูุจุฑูุงูุฌ <i>ุงูุฒูุงุญู</i> ุนูู ุฌููุน ูุนุงูุฌุงุช ุงูุจุฑุงูุฌ ุงูุชู ุชุชุทูุจ ุงูุงูุชูุงู ุฅูู ุงูุฅูุชุฑูุช ูููุญุชูู ุ ุจูููุง ูุญุชูุธ ุงูุจุฑูุงูุฌ ุงูุฎูู ุจุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช. <br><br>  ุงูุขู ุ ุจุฏูุงู ูู ุงูุชุญุฏูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุชู ุจุจุณุงุทุฉ ุชูุฑูุฑ ุงููุนุฑู ุงููุทููุจ ุจุนุฏ ุฃู ูุชู ุฅุฏุฑุงุฌู ุจูุงุณุทุฉ ุฃุฏุงุฉ ุงูููู ุฅูู ุงููุงูู ูุฌููุน ุงูููุชููู ุงูููุชููู. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar483584/">https://habr.com/ru/post/ar483584/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar483568/index.html">ุฅูุดุงุก ุฌูุงุฒ ููุจููุชุฑ ุจุฏุงุฆู ูู ุงูุตูุฑ</a></li>
<li><a href="../ar483570/index.html">ูููู ูุงุฐุง ูู ูุงูุช ุงูุฃุฑุถ ูุณุทุญุฉุ</a></li>
<li><a href="../ar483574/index.html">ุชุญููู ุงูููุซูููุฉ ูููุนุฏุงุช ุงูุฅููุชุฑูููุฉ ุงูุฎุงุตุฉ ุจุงูุตุฏูุงุช ูุงูุงูุชุฒุงุฒุงุช - ูุธุฑุฉ ุนุงูุฉ</a></li>
<li><a href="../ar483578/index.html">ุฃุฎุจุงุฑ ูู ุฎุฑูุทุฉ ุงูุดุงุฑุน ุงูููุชูุญ ุฑูู 493 (12.24.2019 - 12.30.2019)</a></li>
<li><a href="../ar483580/index.html">VIM - ูุฐุง ููุณ ูุญุฑุฑูุง ูุญุณุจ ุ ุจู ูู ุชูุงูู ูุน ุฌููุน ุจูุฆุฉ ุงูุนูู ุงูุฎุงุตุฉ ุจู</a></li>
<li><a href="../ar483586/index.html">ุฃุณุงุณูุงุช ุงูุนูู ูุน zmq ูู ุจูุซูู ุ ูุฅูุดุงุก ูุชุฌุฑ ููุชุงุญ / ูููุฉ ุจุณูุท</a></li>
<li><a href="../ar483588/index.html">ููููุฉ ูุญุงููุฉ ุญุธุฑ ุฃู ูููุน ุจุงุณุชุฎุฏุงู ILV</a></li>
<li><a href="../ar483590/index.html">ุงูุจุญุซ ุนู ุฎุทุฃ FDCAN ููุณุช ูุฐูู</a></li>
<li><a href="../ar483594/index.html">ุงูุชุตุงุฏูุงุช ุงููุณุชูุจู ููููุฒูุงุฆููู</a></li>
<li><a href="../ar483598/index.html">ุงููุฒูุฏ ูู ุจูุถ ุนูุฏ ุงููุตุญ ุงูููุณููู: ููุงุตู ุงูุญุฏูุซ ุนู ุงููุฏุงูุง ูููุณุชูุนูู ุงูููุธูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>