<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛥️ 👨🏻‍🏫 👊🏽 Testez-vous: pouvez-vous protéger l'entreprise contre les cyberattaques? 👨‍👨‍👧‍👦 💅🏾 🎠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Récemment, Samara a accueilli le concours ouvert international VolgaCTF pour la sécurité de l'information. Vladimir Dryukov, directeur du Solar JSOC C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testez-vous: pouvez-vous protéger l'entreprise contre les cyberattaques?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/425861/">  Récemment, Samara a accueilli le concours ouvert international <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VolgaCTF</a> pour la sécurité de l'information.  Vladimir Dryukov, directeur du Solar JSOC Cyber ​​Attack Monitoring and Response Center, a informé les participants de trois attaques réelles et a demandé comment les identifier.  Vérifiez si vous pouvez répondre correctement. <br><a name="habracut"></a><br>  Ci-dessous, une transcription du discours de Vladimir, mais pour ceux qui veulent voir la version non censurée et non coupée (y compris les réponses du public) - voici la vidéo: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GD4XtcGc5zA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Donc, le mot à Vladimir: <br><br><img src="https://habrastorage.org/webt/cg/96/xz/cg96xz4oz_vipsa2ddddygmwgxu.jpeg"><br><br>  Je veux raconter plusieurs histoires de nos vies.  Je vais raconter la plupart d'entre eux dès la fin, c'est-à-dire en commençant par ce qu'était l'incident.  Et vous essayez de comprendre comment cette attaque pourrait être vue au début, afin que vous, en tant que défenseur de la société, fassiez en sorte que les actions des attaquants soient affichées sur votre radar. <br><br>  J'espère que cela vous aidera à l'avenir lorsque vous devenez des pentesters professionnels et travaillez chez Positive Technologies, Digital Security ou avec nous.  Vous saurez comment le centre de surveillance voit ces attaques, comment il y réagit et - qui sait - cela vous aidera peut-être à contourner la défense, à atteindre votre objectif et à montrer au client qu'il n'est pas aussi invulnérable qu'il le pensait.  Eh bien, allons-y? <br><br><h3>  Numéro de tâche 1.  Ce service est à la fois dangereux et difficile, et à première vue il ne semble pas être visible ... </h3><br>  L'histoire a commencé avec le fait que le chef du service de sécurité de l'information d'une entreprise est venu nous voir et a déclaré: <br><br>  "Les gars, je fais des bêtises étranges.  Il y a quatre voitures qui commencent à redémarrer spontanément, tombent sur un écran bleu - en général, il y a une sorte de non-sens.  Disons-le. " <br><br>  Lorsque les gars du groupe de criminalistique sont arrivés sur le site, il s'est avéré que les journaux de sécurité sur toutes les machines avaient été nettoyés - il y avait tellement d'activités que le magazine de sécurité a été rapidement tourné (réécrit).  Rien d'intéressant n'a été trouvé non plus dans la table de fichiers maîtres - la fragmentation est forte, les données sont rapidement écrasées.  Néanmoins, nous avons réussi à trouver quelque chose dans le journal système: environ une fois par jour sur ces quatre machines, le service it_helpdesk apparaît, fait quelque chose d'inconnu (il n'y a pas de journaux de sécurité, comme nous nous en souvenons) et disparaît. <br><br>  Notre chapitre de médecine légale a abordé cette expression faciale: <br><br><img src="https://habrastorage.org/webt/xj/sn/kn/xjsnkn-0rd57c2t65aajfzvyluy.jpeg"><br><br>  Ils ont commencé à mieux comprendre et il s'est avéré que le service it_helpdesk était en fait renommé PSExec. <br><blockquote>  Les utilitaires, tels que Telnet, et les programmes de gestion à distance, comme PC Anywhere de Symantec, vous permettent d'exécuter des programmes sur des systèmes distants, mais ils ne sont pas si faciles à installer, car vous devez également installer le logiciel client sur les systèmes distants que vous devez recevoir. accès. <br><br>  PsExec est une version allégée de Telnet.  Il vous permet d'effectuer des processus dans des systèmes distants, en utilisant toutes les fonctionnalités de l'interface interactive des applications de console, et il n'est pas nécessaire d'installer manuellement le logiciel client.  Le principal avantage de PsExec est la possibilité d'invoquer l'interface de ligne de commande de manière interactive sur des systèmes distants et d'exécuter à distance des outils tels que IpConfig.  C'est le seul moyen d'afficher des informations sur le système distant sur l'écran de l'ordinateur local. <br><br>  technet.microsoft.com </blockquote><br>  Après avoir vérifié les journaux du système sur d'autres machines, nous avons vu que non 4 postes de travail étaient impliqués, mais 20, plus 19 serveurs supplémentaires, dont un serveur critique.  Nous avons discuté avec des informaticiens et avons découvert qu'ils n'avaient aucun lien avec cela, ils n'ont pas un tel sous-système.  Ils ont commencé à creuser plus loin, puis une chose assez curieuse et rare a été découverte - le tunnel DNS, qui utilisait le module malware, qui était responsable de la communication avec le centre de contrôle du botnet. <br><blockquote>  Tunneling DNS - une technique qui vous permet de transférer du trafic arbitraire (en fait, augmenter le tunnel) sur le protocole DNS.  Il peut être utilisé, par exemple, pour obtenir un accès complet à Internet à partir du moment où la résolution de noms DNS est autorisée. <br><br>  La tunnellisation DNS ne peut pas être refusée par de simples règles de pare-feu, tout en autorisant le reste du trafic DNS.  En effet, le trafic du tunnel DNS et les requêtes DNS légitimes sont indiscernables.  La tunnelisation DNS peut être détectée par l'intensité des requêtes (si le trafic à travers le tunnel est important), ainsi que par des méthodes plus sophistiquées utilisant des systèmes de détection d'intrusion. <br><br>  xgu.ru <br></blockquote><br>  Un code malveillant est entré dans l'organisation par courrier, s'est propagé dans l'infrastructure et a interagi avec le serveur C&amp;C via le tunnel DNS.  Par conséquent, les interdictions d'interagir avec Internet qui se trouvaient dans le segment de serveur n'ont pas fonctionné. <br><br>  Sur l'un des serveurs critiques, il y avait un enregistreur de frappe qui lisait automatiquement les mots de passe, et le logiciel malveillant a tenté d'explorer davantage, recevant de nouvelles informations d'identification d'utilisateur, y compris la suppression de machines dans le BSOD et la lecture des mots de passe des administrateurs qui l'ont créé. <br><br>  À quoi cela a-t-il conduit?  Pendant la durée de vie du logiciel malveillant dans l'infrastructure, de nombreux comptes ont été compromis et, en outre, une grande quantité d'autres données potentiellement sensibles.  Au cours de l'enquête, nous avons localisé la portée des assaillants et les avons «expulsés» du réseau.  Le client a reçu encore quatre mois de farine - il a fallu remplir à nouveau la moitié des machines et réémettre tous les mots de passe - des bases de données, des comptes, etc.  Les personnes ayant une expérience informatique n'ont pas besoin d'expliquer ce qu'est une histoire difficile.  Mais, néanmoins, tout s'est bien terminé. <br><br>  La question est donc: comment détecter cette attaque et attraper un cybercriminel dans le bras? <br><br><div class="spoiler">  <b class="spoiler_title">La réponse à la première tâche</b> <div class="spoiler_text">  Tout d'abord, comme vous vous en souvenez, l'infection a affecté un serveur critique.  Si un nouveau service auparavant inconnu est lancé sur un tel hôte, il s'agit d'un incident très critique.  Cela ne devrait pas arriver.  Si vous surveillez au moins les services qui s'exécutent sur des serveurs critiques, cela seul aidera à identifier une telle attaque à un stade précoce et à l'empêcher de se développer. <br><br>  Deuxièmement, ne négligez pas les informations des moyens de protection les plus élémentaires.  PSExec est bien détecté par les antivirus, mais il n'est pas marqué comme malware, mais comme outil d'administration à distance ou outil de piratage.  Si vous examinez attentivement les journaux antivirus, vous pouvez voir la réponse à temps et prendre les mesures appropriées. <br></div></div><br><br><h3>  Numéro de tâche 2.  Contes effrayants <br></h3><br>  Grande banque, une femme travaille dans le service financier et a accès à AWS du CBD. <br><blockquote>  AWP KBR - un lieu de travail automatisé d'un client de la Banque de Russie.  Il s'agit d'une solution logicielle d'échange sécurisé d'informations avec la Banque de Russie, y compris l'envoi d'ordres de paiement, de vols bancaires, etc. </blockquote><br>  Cet agent financier a apporté une clé USB contenant un fichier appelé Skazki_dlya_bolshih_i_malenkih.pdf.exe pour fonctionner.  Elle avait une petite fille et la femme voulait imprimer au travail un livre pour enfants, qu'elle avait téléchargé sur Internet.  L'extension de fichier .pdf.exe ne lui a pas paru suspecte, puis, lorsqu'elle a lancé le fichier, le pdf habituel s'est ouvert. <br><br><img src="https://habrastorage.org/webt/wm/dl/-4/wmdl-4ix7ki9r5pdry7o6evkjqg.jpeg"><br><br>  La femme a ouvert le livre et est rentrée chez elle.  Mais l'extension .exe, bien sûr, n'était pas accidentelle.  Derrière lui se trouvait Remo Admin Tool, qui était assis sur un poste de travail et y creusait les processus système pendant plus d'un an. <br><br>  Comment fonctionnent ces logiciels malveillants?  Tout d'abord, ils font des captures d'écran environ 15 fois par minute.  Dans un fichier séparé, ils ajoutent les données reçues de l'enregistreur de frappe - identifiants et mots de passe, correspondance dans le courrier, messageries instantanées et bien plus encore.  Après avoir connecté le client, nous avons rapidement remarqué un hôte infecté et nettoyé le virus du réseau. <br><br>  Question: comment pourrait-il être possible de détecter le malware "invisible" qui n'a pas été détecté par l'antivirus? <br><br><div class="spoiler">  <b class="spoiler_title">La réponse à la deuxième tâche</b> <div class="spoiler_text">  Premièrement, les logiciels malveillants, en règle générale, font quelque chose dans le système de fichiers, modifient les entrées de registre - en un mot, ils se chargent en quelque sorte dans le système.  Cela peut être suivi si vous surveillez l'hôte au niveau des journaux que le système d'exploitation lui-même écrit - journaux de sécurité, démarrages de processus, modifications du registre. <br><br>  Deuxièmement, il est important de se rappeler que de tels logiciels malveillants ne vivent pas de manière autonome, ils frappent toujours quelque part.  Souvent, les postes de travail sur un réseau n'ont accès à Internet que via un proxy, donc si une machine essaie de frapper quelque part directement, c'est un incident grave qui doit être traité. <br></div></div><br><br><h3>  Numéro de tâche 3.  "Bloody warez" <br></h3><br>  L'administrateur système devait comparer et «coller» ensemble 2 fichiers .xml.  Il est allé de la manière simple - tapé dans un moteur de recherche "télécharger la fusion xml sans inscription et sms".  Le site officiel du développeur de cet utilitaire était à la 3ème place dans le problème, et dans le premier partage de deux fichiers.  Là, l'administrateur a téléchargé le programme. <br><br>  Comme vous l'avez probablement déjà deviné, un bon module d'escalade de privilèges de haute qualité a été intégré à l'utilitaire «gratuit».  Il a démoli l'agent antivirus sur la machine et a créé un fichier du même nom à la place.  Le malware s'est donc également accroché à la machine, communiquant périodiquement avec le centre de contrôle. <br><br><img src="https://habrastorage.org/webt/vr/g-/mr/vrg-mrq9nozu9x1hpgh68r6olp0.png"><br><br>  Le pire, c'est que l'administrateur informatique est le roi du château, il a accès partout.  Depuis sa machine, le virus peut atteindre n'importe quel hôte ou serveur.  Le malware a rampé sur le réseau via le point de partage de domaine, essayant de se rendre à la voiture du chef financier.  À ce moment, elle a été attrapée par la queue et l'histoire s'est éteinte. <br><br>  Question: comment détecter une telle attaque sur la machine d'un utilisateur privilégié? <br><br><div class="spoiler">  <b class="spoiler_title">La réponse au troisième problème</b> <div class="spoiler_text">  Encore une fois, vous pouvez écouter le trafic, en essayant d'attraper le malware "en flagrant délit" - au moment de la demande au serveur C &amp; C.  Cependant, si l'entreprise ne dispose pas de NGFW, d'IDS, d'un système d'analyse de trafic réseau ou de SIEM qui capte au moins quelque chose de précieux du trafic, vous pouvez l'écouter à l'infini. <br><br>  Il est plus efficace de consulter les journaux du système d'exploitation en les envoyant à un système externe.  Bien que le logiciel malveillant ait supprimé l'agent antivirus, il n'a pas pu effacer le fichier d'audit.Par conséquent, les journaux envoyés au système externe contiendront certainement des informations sur la suppression de l'agent antivirus, ou au moins sur le nettoyage de l'audit lui-même.  Après cela, les journaux sur la machine elle-même seront vides et aucune trace ne pourra être trouvée. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425861/">https://habr.com/ru/post/fr425861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425849/index.html">Amazon a renoncé et a augmenté les salaires des employés</a></li>
<li><a href="../fr425851/index.html">Infer.NET: un puissant système d'apprentissage automatique désormais OpenSource</a></li>
<li><a href="../fr425853/index.html">Toute l'IA conversationnelle lors de la première conférence Conversations</a></li>
<li><a href="../fr425855/index.html">Twitch m'a amélioré et m'a aidé à survivre aux trois mois les plus sombres de ma vie.</a></li>
<li><a href="../fr425859/index.html">Les opérateurs régionaux s'opposent à l'annulation de l'itinérance</a></li>
<li><a href="../fr425867/index.html">Tests de performances des services Web dans le cadre de l'intégration continue. Expérience Yandex</a></li>
<li><a href="../fr425869/index.html">iFixit: Apple n'a pas encore activé le blocage des MacBooks remis à neuf</a></li>
<li><a href="../fr425871/index.html">Ekaterinbourg, 11 octobre - Atlassian rencontre le docker</a></li>
<li><a href="../fr425873/index.html">[CppCon 2018] Herb Sutter: vers un C ++ plus simple et plus puissant</a></li>
<li><a href="../fr425875/index.html">Mise à niveau de la matrice des ordinateurs portables TN-> IPS ou comment obtenir un ordinateur portable plus avancé à partir d'un ordinateur portable économique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>