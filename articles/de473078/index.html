<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö≤ üïé üõåüèª Verwalten Sie einfach Mikroservice-Konfigurationen mit microconfig.io üí¨ üß§ üßó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eines der Hauptprobleme bei der Entwicklung und dem anschlie√üenden Betrieb von Mikrodiensten ist die kompetente und genaue Abstimmung ihrer Instanzen....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verwalten Sie einfach Mikroservice-Konfigurationen mit microconfig.io</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473078/">  Eines der Hauptprobleme bei der Entwicklung und dem anschlie√üenden Betrieb von Mikrodiensten ist die kompetente und genaue Abstimmung ihrer Instanzen.  Meiner Meinung nach kann das neue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">microconfig.io-</a> Framework helfen.  Damit k√∂nnen Sie einige der Routineaufgaben beim Einrichten von Anwendungen ganz elegant l√∂sen. <br><a name="habracut"></a><br>  Wenn Sie viele Microservices haben und jeder von ihnen seine eigenen Datei- / Einstellungsdateien enth√§lt, ist es wahrscheinlich, dass in einem von ihnen ein Fehler auftritt, der ohne angemessene Geschicklichkeit und ein Protokollierungssystem sehr schwer zu erfassen sein kann.  Die Hauptaufgabe, die das Framework selbst festlegt, besteht darin, doppelte Instanzeinstellungen zu minimieren und dadurch die Wahrscheinlichkeit zu verringern, dass ein Fehler hinzugef√ºgt wird. <br><br>  Schauen wir uns ein Beispiel an.  Angenommen, es gibt eine einfache Anwendung mit einer <b>Yaml-</b> Konfigurationsdatei.  Es kann jeder Microservice in jeder Sprache sein.  Mal sehen, wie das Framework auf diesen Service angewendet werden kann. <br><br>  Zur Vereinfachung erstellen wir zun√§chst ein leeres Projekt in der Ideen-IDE, indem wir zuerst das Plugin microconfig.io darin installieren: <br><br><img src="https://habrastorage.org/webt/zp/db/uc/zpdbuckv5ezy0gbc5mcikpywfdm.png" alt="Bild"><br><br>  Wir konfigurieren die Plugin-Startkonfiguration. Sie k√∂nnen die Standardkonfiguration wie im obigen Screenshot verwenden. <br><br>  Unser Service hei√üt Bestellung, dann werden wir in einem neuen Projekt eine √§hnliche Struktur erstellen: <br><br><img src="https://habrastorage.org/webt/jl/an/x5/jlanx519xbvcfj7gje6jdy8emfa.png"><br><br>  In den Ordner mit dem Namen des Dienstes legen wir die Konfigurationsdatei - <b>application.yaml</b> .  Alle Microservices werden in einer Umgebung gestartet. Neben der Erstellung der Konfiguration des Dienstes selbst muss auch die Umgebung selbst beschrieben werden. Erstellen Sie dazu den Ordner <b>envs</b> und f√ºgen Sie eine Datei mit dem Namen unserer Arbeitsumgebung hinzu.  Daher erstellt das Framework Konfigurationsdateien f√ºr Dienste in der <b>Entwicklungsumgebung</b> , da dieser Parameter in den Einstellungen im Plugin festgelegt ist. <br><br>  Die Struktur der Datei <b>dev.yaml</b> ist recht einfach: <br><br><pre><code class="plaintext hljs">mainorder: components: - order</code> </pre> <br>  Das Framework arbeitet mit Konfigurationen, die zusammen gruppiert sind.  <b>W√§hlen Sie</b> f√ºr unseren Service einen Namen f√ºr die <b>Hauptbestellgruppe</b> .  Das Framework findet jede solche Gruppe von Anwendungen in der Umgebungsdatei und erstellt Konfigurationen f√ºr alle Anwendungen, die es in den entsprechenden Ordnern findet. <br><br>  In der <b>Bestelldienst</b> -Einstellungsdatei selbst geben wir bisher nur einen Parameter an: <br><br><pre> <code class="plaintext hljs">spring.application.name: order</code> </pre> <br>  F√ºhren Sie nun das Plugin aus und es generiert die gew√ºnschte Konfiguration unseres Dienstes f√ºr uns gem√§√ü dem in den Eigenschaften angegebenen Pfad: <br><br><img src="https://habrastorage.org/webt/ba/2s/uq/ba2suqlkzmxnzxisilo5wdu8ebs.png"><br><br>  Sie k√∂nnen auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die</a> Installation des Plugins verzichten, indem Sie einfach das Distributionskit des Frameworks herunterladen und √ºber die Befehlszeile ausf√ºhren. <br>  Diese L√∂sung ist f√ºr die Verwendung auf dem Build-Server geeignet. <br><br>  Es ist anzumerken, dass das Framework die <b>Eigenschaftssyntax</b> perfekt versteht, <b>dh</b> gew√∂hnliche Eigenschaftendateien, die zusammen in <b>Yaml-</b> Konfigurationen verwendet werden k√∂nnen. <br><br>  F√ºgen Sie einen weiteren <b>Zahlungsdienst hinzu</b> und komplizieren Sie gleichzeitig den vorhandenen. <br>  In der <b>Reihenfolge</b> : <br><br><pre> <code class="plaintext hljs">eureka: instance.preferIpAddress: true client: serviceUrl: defaultZone: http://192.89.89.111:6782/eureka/ server.port: 9999 spring.application.name: order db.url: 192.168.0.100</code> </pre> <br>  In <b>Zahlung</b> : <br><br><pre> <code class="plaintext hljs">eureka: instance.preferIpAddress: true client: serviceUrl: defaultZone: http://192.89.89.111:6782/eureka/ server.port: 9998 spring.application.name: payments db.url: 192.168.0.100</code> </pre> <br>  Das Hauptproblem bei diesen Konfigurationen ist das Vorhandensein einer gro√üen Menge an Copy Paste in den Serviceeinstellungen.  Mal sehen, wie das Framework dabei hilft, es loszuwerden.  Beginnen wir mit dem offensichtlichsten - dem Vorhandensein einer <b>Eureka-</b> Konfiguration in der Beschreibung jedes Mikrodienstes.  Erstellen Sie ein neues Verzeichnis mit der Einstellungsdatei und f√ºgen Sie eine neue Konfiguration hinzu: <br><br><img src="https://habrastorage.org/webt/bv/41/qz/bv41qzovbxaeodybgaxlpy7em4k.png"><br><br>  Und in jedem unserer Projekte werden wir jetzt die Zeile <i>#include eureka hinzuf√ºgen</i> . <br><br>  Das Framework findet die eureka-Konfiguration automatisch und kopiert sie in die Dienstkonfigurationsdateien, w√§hrend keine separate eureka-Konfiguration erstellt wird, da wir sie nicht in der <b>dev.yaml-</b> Umgebungsdatei angeben.  Serviceauftrag: <br><br><pre> <code class="1c hljs"><span class="hljs-meta"><span class="hljs-meta">#include eureka server.port: 9999 spring.application.name: order db.url: 192.168.0.100</span></span></code> </pre> <br>  Wir k√∂nnen die Datenbankeinstellungen auch in einer separaten Konfiguration <i>vornehmen,</i> indem wir die Importzeile in <i>#include eureka, oracle √§ndern</i> . <br><br>  Es ist anzumerken, dass jede √Ñnderung w√§hrend der Neuerstellung von Konfigurationsdateien das Framework √ºberwacht und in einer speziellen Datei neben der Hauptkonfigurationsdatei ablegt.  Der Eintrag in seinem Protokoll sieht folgenderma√üen aus: "Gespeicherte 1 Eigenschaft √§ndert sich in <b>order / diff-application.yaml</b> ".  Auf diese Weise k√∂nnen Sie √Ñnderungen in gro√üen Konfigurationsdateien schnell erkennen. <br><br>  Durch das Entfernen der allgemeinen Teile der Konfiguration k√∂nnen Sie viele unn√∂tige Kopier- und Einf√ºgevorg√§nge vermeiden, aber Sie k√∂nnen nicht flexibel eine Konfiguration f√ºr verschiedene Umgebungen erstellen. Die Endpunkte unserer Dienste sind eindeutig und fest codiert. Dies ist schlecht.  Versuchen wir es zu entfernen. <br><br>  Eine gute L√∂sung w√§re, alle Endpunkte in einer Konfiguration zu belassen, auf die andere verweisen k√∂nnten.  Zu diesem Zweck wurde die Unterst√ºtzung f√ºr Platzhalter in das Framework aufgenommen.  So √§ndert sich die <b>eureka-</b> Konfigurationsdatei: <br><br><pre> <code class="plaintext hljs"> client: serviceUrl: defaultZone: http://${endpoints@eurekaip}:6782/eureka/</code> </pre> <br>  Nun wollen wir sehen, wie dieser Platzhalter funktioniert.  Das System findet eine Komponente mit dem Namen <b>Endpunkte,</b> sucht darin nach <b>Eurekaip</b> und ersetzt sie dann in unserer Konfiguration.  Aber was ist mit verschiedenen Umgebungen?  Erstellen Sie dazu die Einstellungsdatei in <b>Endpunkten des</b> folgenden Typs <b>application.dev.yaml</b> .  Das Framework entscheidet unabh√§ngig √ºber die Dateierweiterung, zu welcher Umgebung diese Konfiguration geh√∂rt, und l√§dt sie: <br><br><img src="https://habrastorage.org/webt/-l/pv/ru/-lpvruiphufubb2m-bihizph78m.png"><br><br>  Der Inhalt der Entwicklungsdatei: <br><br><pre> <code class="plaintext hljs">eurekaip: 192.89.89.111 dbip: 192.168.0.100</code> </pre> <br>  Wir k√∂nnen dieselbe Konfiguration f√ºr die Ports unserer Dienste erstellen: <br><br><pre> <code class="plaintext hljs">server.port: ${ports@order}.</code> </pre> <br>  Alle wichtigen Einstellungen befinden sich an einem Ort, wodurch die Wahrscheinlichkeit eines Fehlers aufgrund der verstreuten Parameter in den Konfigurationsdateien verringert wird. <br><br>  Das Framework bietet viele vorgefertigte Platzhalter. Sie k√∂nnen beispielsweise den Namen des Verzeichnisses abrufen, in dem sich die Konfigurationsdatei befindet, und ihn zuweisen: <br><br><pre> <code class="1c hljs"><span class="hljs-meta"><span class="hljs-meta">#include eureka, oracle server.port: ${ports@order} spring.application.name: ${this@name}</span></span></code> </pre> <br>  Aus diesem Grund muss der Name der Anwendung in der Konfiguration nicht zus√§tzlich angegeben werden, und sie kann auch in ein gemeinsames Modul verschoben werden, z. B. in dieselbe Eureka: <br><br><pre> <code class="plaintext hljs">client: serviceUrl: defaultZone: http://${endpoints@eurekaip}:6782/eureka/ spring.application.name: ${this@name}</code> </pre> <br>  Die <b>Auftragskonfigurationsdatei</b> wird auf eine Zeile reduziert: <br><br><pre> <code class="1c hljs"><span class="hljs-meta"><span class="hljs-meta">#include eureka, oracle server.port: ${ports@order}</span></span></code> </pre> <br>  Falls wir keine Einstellung aus der √ºbergeordneten Konfiguration ben√∂tigen, k√∂nnen wir diese in unserer Konfiguration angeben und sie wird w√§hrend der Generierung angewendet.  Wenn wir aus irgendeinem Grund einen eindeutigen Namen f√ºr den Bestellservice ben√∂tigen, lassen Sie einfach den Parameter <b>spring.application.name</b> . <br><br>  Angenommen, Sie m√ºssen dem Dienst benutzerdefinierte Protokollierungseinstellungen hinzuf√ºgen, die in einer separaten Datei gespeichert sind, z. B. <b>logback.xml</b> .  Erstellen Sie eine separate Gruppe von Einstellungen daf√ºr: <br><br><img src="https://habrastorage.org/webt/fs/gg/x7/fsggx7dxwx1hako1mysofzssgy0.png"><br><br>  In der Grundkonfiguration geben wir das Framework an, in dem die ben√∂tigte Protokollierungseinstellungsdatei mithilfe des <b>Platzhalters</b> @ConfigDir abgelegt werden soll: <br><br><pre> <code class="plaintext hljs">microconfig.template.logback.fromFile: ${logback@configDir}/logback.xml</code> </pre> <br>  In der Datei <b>logback.xml</b> konfigurieren <b>wir</b> Standard-Appender, die wiederum Platzhalter enthalten k√∂nnen, die das Framework w√§hrend der Generierung von Konfigurationen √§ndert, zum Beispiel: <br><br><pre> <code class="1c hljs">&lt;file&gt;logs/${this@name}.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>&lt;/file&gt;</code> </pre> <br>  Durch Hinzuf√ºgen des <b>Logback-</b> Imports in der Dienstkonfiguration erhalten wir automatisch die konfigurierte Protokollierung f√ºr jeden Dienst: <br><br><pre> <code class="1c hljs"><span class="hljs-meta"><span class="hljs-meta">#include eureka, oracle, logback server.port: ${ports@order}</span></span></code> </pre> <br>  Es ist Zeit, sich mit allen verf√ºgbaren Framework-Platzhaltern genauer vertraut zu machen: <br><br>  <b>$ {this @ env}</b> - gibt den Namen der aktuellen Umgebung zur√ºck. <br>  <b>$ {... @ name}</b> - gibt den Namen der Komponente zur√ºck. <br>  <b>$ {... @ configDir}</b> - <b>Gibt</b> den vollst√§ndigen Pfad zum Konfigurationsverzeichnis der Komponente zur√ºck. <br>  <b>$ {... @ resultDir}</b> - <b>Gibt</b> den vollst√§ndigen Pfad zum <b>Zielverzeichnis</b> der Komponente zur√ºck (empfangene Dateien werden in diesem Verzeichnis abgelegt). <br>  <b>$ {this @ configRoot}</b> - Gibt den vollst√§ndigen Pfad zum Stammverzeichnis des Konfigurationsspeichers zur√ºck. <br><br>  Das System erm√∂glicht es Ihnen auch, Umgebungsvariablen abzurufen, z. B. den Pfad zu Java: <br>  <b>$ {env @ JAVA_HOME}</b> <br>  Da das Framework in <b>JAVA geschrieben ist</b> , k√∂nnen wir Systemvariablen √§hnlich dem Aufruf von <b>System :: getProperty</b> mit einem Konstrukt wie dem folgenden <b>abrufen</b> : <br>  <b>${system@os.name}</b> <br>  Erw√§hnenswert ist die Unterst√ºtzung f√ºr die <b>Spring EL-</b> Erweiterungssprache.  In der Konfiguration gelten √§hnliche Ausdr√ºcke: <br><br><pre> <code class="1c hljs">connection.timeoutInMs: <span class="hljs-meta"><span class="hljs-meta">#{5 * 60 * 1000} datasource.maximum-pool-size: #{${this@datasource.minimum-pool-size} + 10}</span></span></code> </pre> <br>  und Sie k√∂nnen lokale Variablen in Konfigurationsdateien mit dem Ausdruck <b>#var</b> verwenden: <br><br><pre> <code class="1c hljs"><span class="hljs-meta"><span class="hljs-meta">#var feedRoot: ${system@user.home}/feed folder: root: ${this@feedRoot} success: ${this@feedRoot}/archive error: ${this@feedRoot}/error</span></span></code> </pre> <br>  Somit ist das Framework ein ziemlich leistungsf√§higes Werkzeug f√ºr die feine und flexible Konfiguration von Microservices.  Das Framework erf√ºllt seine Hauptaufgabe perfekt - das Eliminieren von Copy-Paste in Einstellungen, das Konsolidieren von Einstellungen und das Minimieren m√∂glicher Fehler, w√§hrend es einfach ist, Konfigurationen und √Ñnderungen f√ºr verschiedene Umgebungen zu kombinieren. <br><br>  Wenn Sie an diesem Framework interessiert sind, empfehle ich Ihnen, die offizielle Seite zu besuchen und die vollst√§ndige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation zu</a> lesen oder hier in die Quelle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einzutauchen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473078/">https://habr.com/ru/post/de473078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473064/index.html">Batavianische Tr√§nen, Autos und Gorilla-Glas: √ºber einige Arten von verst√§rktem Glas</a></li>
<li><a href="../de473066/index.html">Quadrantenb√§ume und Kollisionserkennung</a></li>
<li><a href="../de473070/index.html">Redux - Nicht ben√∂tigt! Ersetzen durch useContext und useReducer in React?</a></li>
<li><a href="../de473072/index.html">Wie Gazpromneft einen digitalen Weg f√ºr einen Firmenkunden schafft</a></li>
<li><a href="../de473074/index.html">Was ist APS und warum wird ein Produktionsplan nicht so erstellt, wie wir es wollen ...</a></li>
<li><a href="../de473082/index.html">Wie wir Microservices schreiben und warum wir das nicht schnell machen</a></li>
<li><a href="../de473084/index.html">"Ivan" ist ein Chat-Bot-Beruf. Oder kreative Experimente mit virtuellen Assistenten</a></li>
<li><a href="../de473086/index.html">Wie Malware mit Visual Basic Sandboxen ausweicht</a></li>
<li><a href="../de473090/index.html">PocketBook 632 und 632 Aqua Test - kleines Flaggschiff 6-Zoll-Leseger√§te mit E-Ink</a></li>
<li><a href="../de473092/index.html">AMA mit Habr, # 13: wichtige Neuigkeiten f√ºr Benutzer und Unternehmen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>