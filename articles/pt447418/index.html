<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÑ üìº üë©üèº‚ÄçüöÄ N√≥s processamos bitcoin. Como √© organizada a p√°gina de pagamento B2BinPay? ‚§µÔ∏è üåó ‚≠êÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O B2BinPay √© um sistema de pagamento de criptomoedas com muitos back-end relacionados a aplicativos, an√°lises, n√≥s, filas, mas apenas uma p√°gina da in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>N√≥s processamos bitcoin. Como √© organizada a p√°gina de pagamento B2BinPay?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/b2broker/blog/447418/">  O B2BinPay √© um sistema de pagamento de criptomoedas com muitos back-end relacionados a aplicativos, an√°lises, n√≥s, filas, mas apenas uma p√°gina da interface do usu√°rio que o usu√°rio final v√™.  Possui altos requisitos em rela√ß√£o √† facilidade de uso.  Apesar da aparente simplicidade da p√°gina, a equipe de desenvolvimento estaria interessada em compartilhar como ela √© organizada por dentro. <br><br>  Para entender os processos de neg√≥cios, voc√™ precisar√° mergulhar na √°rea de assunto.  Para os leitores que ainda n√£o sabem o que s√£o criptomoedas, blockchain e endere√ßo, fizemos defini√ß√µes breves e compreens√≠veis. <br><br><img src="https://habrastorage.org/webt/9l/st/fh/9lstfhjhpe676a3t3e8mj3fdu-q.jpeg"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Para entender os termos, aqui est√£o algumas analogias com o mundo fiduci√°rio dos pagamentos:</b> <div class="spoiler_text">  <b>O Blockchain</b> √© um banco de dados descentralizado (no caso ideal) que armazena informa√ß√µes sobre endere√ßos, transa√ß√µes e saldos.  Consiste em blocos, cada um deles cont√©m uma quantidade limitada de informa√ß√µes.  Os blocos s√£o gerados gra√ßas aos mineradores por meio de c√°lculos intensivos em energia (PoW) ou prova de participa√ß√£o (PoS).  Cada pr√≥ximo bloco cont√©m uma lista de novas transa√ß√µes e um link para a anterior.  Cada criptomoeda tem seu pr√≥prio blockchain. <br><br>  <b>Comerciante</b> - o mesmo que o propriet√°rio da loja, alugando um sistema de pagamento para receber pagamentos dos usu√°rios finais. <br><br>  <b>Uma carteira</b> √© igual a uma conta no mundo financeiro tradicional. <br><br>  <b>Transa√ß√£o</b> - um registro no blockchain em que os fundos foram enviados de uma carteira para outra.  O saldo da carteira √© formado a partir do valor das transa√ß√µes. <br><br>  <b>O endere√ßo</b> √© o mesmo que os detalhes da conta.  A diferen√ßa √© que a maioria das blockchains permite gerar um n√∫mero infinito de endere√ßos para uma carteira. <br><br>  <b>Uma transa√ß√£o confirmada</b> √© uma transa√ß√£o ap√≥s a qual um n√∫mero seguro de blocos foi gerado.  Um bloco √© igual a uma confirma√ß√£o.  Se a transa√ß√£o n√£o tiver recebido 4-8 confirma√ß√µes, ela n√£o ser√° considerada conclu√≠da. <br><br>  <b>Sistema de pagamento</b> - software que fornece a aceita√ß√£o e o processamento de pagamentos em criptomoeda.  Vincula e agrega pedidos, pagamentos, transa√ß√µes, devolu√ß√µes, reabastecimentos, retiradas e outras informa√ß√µes.  Ele tamb√©m informa o sistema do comerciante sobre mudan√ßas no contexto de pedidos e pagamentos, e n√£o sobre cadeias e transa√ß√µes. <br><br>  <b>Explorer</b> - um servi√ßo ou um site de navegador para dados que entram no blockchain.  Usando este servi√ßo, voc√™ pode obter informa√ß√µes sobre endere√ßos, transa√ß√µes e blocos de forma conveniente. <br><br>  <b>Um n√≥</b> √© um computador no qual uma c√≥pia de todo o banco de dados (blockchain) √© armazenada. <br></div></div><br><h3>  Esquema geral de trabalho e requisitos para o conte√∫do da p√°gina de pagamento </h3><br>  O ciclo de pagamento ocorre da seguinte forma: no site da loja, o comprador seleciona o produto e a moeda de pagamento.  O sistema redireciona o usu√°rio para a p√°gina de pagamento.  Ele cont√©m as seguintes informa√ß√µes: moeda, endere√ßo, coment√°rios informativos.  O usu√°rio envia a quantidade necess√°ria para o endere√ßo especificado e espera um n√∫mero suficiente de confirma√ß√µes de rede para reconhecer o pagamento como bem-sucedido.  Enquanto aguarda, o comprador pode monitorar o status do pagamento sem sair da p√°gina no site do explorer.  Depois que o pagamento √© aceito, o usu√°rio √© redirecionado para a p√°gina de pagamento com √™xito no site do vendedor. <br><br><img src="https://habrastorage.org/webt/gz/mu/p8/gzmup8pqrvynkwr7plvc_a3uyqu.png"><br><br>  O processo de pagamento √© dividido em v√°rias etapas.  Cada um deles n√£o requer a√ß√£o do usu√°rio, exceto a transfer√™ncia direta de dinheiro.  Script padr√£o de sucesso: <br><br><ol><li>  No site do vendedor, o usu√°rio seleciona o m√©todo de pagamento B2BinPay e a moeda </li><li>  O IP do vendedor envia uma solicita√ß√£o para criar uma nova ordem de pagamento, recebendo um link para a p√°gina de pagamento em resposta </li><li>  O usu√°rio redireciona para a p√°gina de pagamento, que cont√©m informa√ß√µes: moeda, valor, endere√ßo e campos adicionais, se necess√°rio </li><li>  Usu√°rio paga pela compra </li><li>  O sistema detecta que uma nova transa√ß√£o chegou ao endere√ßo e a p√°gina entra no estado de rastreamento </li><li>  O status da transa√ß√£o √© monitorado e as informa√ß√µes s√£o atualizadas na p√°gina at√© que um n√∫mero seguro de confirma√ß√µes seja alcan√ßado. </li><li>  O usu√°rio √© redirecionado para a p√°gina de pagamento bem-sucedida no site do vendedor </li></ol><br>  Consequentemente, a p√°gina de pagamento pode estar em dois estados: exibindo detalhes e aguardando confirma√ß√£o.  Ao visualizar os detalhes, voc√™ pode inserir o endere√ßo de duas maneiras: digitalize o c√≥digo QR ou copie o endere√ßo em formato de texto.  Al√©m das informa√ß√µes b√°sicas, adicionaremos uma mini-instru√ß√£o em forma de texto, que lhe dir√° como pagar, onde baixar o aplicativo da carteira e como comprar moeda.  Al√©m desses campos, h√° mais um, cuja presen√ßa depende da moeda escolhida.  √Äs vezes, para correlacionar corretamente uma transa√ß√£o, uma ordem de pagamento e um comprador, √© necess√°rio conhecer n√£o apenas o endere√ßo, mas tamb√©m informa√ß√µes adicionais.  Por exemplo, para a moeda Ripple, ao enviar, voc√™ deve especificar a etiqueta de destino (comentar sobre a transa√ß√£o). <br><br>  Para aqueles que copiam o endere√ßo em forma de texto e n√£o digitalizam o c√≥digo QR, um bot√£o de c√≥pia foi adicionado.  Al√©m disso, o logotipo da moeda deve estar presente na p√°gina, pois muitas pessoas identificam a moeda visualmente, pelo formato e esquema de cores do logotipo, e n√£o pela designa√ß√£o da letra. <br><br>  A mudan√ßa de estado ocorre no momento em que uma transa√ß√£o recebida no endere√ßo de cobran√ßa √© detectada.  Nesse momento, os detalhes desaparecem, pois n√£o s√£o mais necess√°rios;  o usu√°rio entra no modo de espera e a p√°gina precisa de um fluxo constante de informa√ß√µes sobre o status da transa√ß√£o.  Agora, na p√°gina, voc√™ pode encontrar: o tempo limite at√© a transa√ß√£o ser conclu√≠da, o n√∫mero atual de confirma√ß√µes, um breve coment√°rio que explica outras a√ß√µes. <br><br>  A p√°gina deve ser f√°cil de entender, intuitiva e ao mesmo tempo suficientemente informativa.  Para compradores experientes, a √™nfase deve ser colocada no endere√ßo e no valor. <br><br>  A partir dos requisitos acima, foi obtido um layout para a p√°gina futura. <br><br><img src="https://habrastorage.org/webt/zb/v3/nv/zbv3nvvp1jnpyu1h1udaydk1vg8.gif"><br><br><h3>  Backend </h3><br>  <b>A primeira op√ß√£o para</b> implementar o back-end √© ficar sem ele!  Ao gerar a p√°gina de pagamento, √© sabido antecipadamente para qual endere√ßo o dinheiro ser√° enviado.  Voc√™ pode receber novas transa√ß√µes neste endere√ßo do explorer usando ferramentas JS.  Assim, a tarefa √© escrever conectores para o explorador e interrogar periodicamente o necess√°rio.  Um diagrama de classe est√°tico pode ser assim: <br><br><img src="https://habrastorage.org/webt/eu/h9/k2/euh9k2ahzvxmqe4wyeco836lary.png"><br><br>  <i>Pr√≥s:</i> n√£o h√° carga sobre nossas capacidades, √© f√°cil de implementar, n√£o h√° amea√ßas potenciais √† seguran√ßa. <br><br>  <i>Contras:</i> fontes n√£o confi√°veis ‚Äã‚Äãe recebimento prematuro de novas informa√ß√µes, dificuldades em fornecer atualiza√ß√µes da base de c√≥digo aos clientes finais (cache n√£o controlado).  Menos decisivo - muitas moedas n√£o possuem um explorador est√°vel com uma API desenvolvida. <br><br>  <b>A segunda op√ß√£o</b> (em funcionamento) √© o seu pr√≥prio microsservi√ßo, que recebe informa√ß√µes diretamente do pool de n√≥s, filtra e as distribui pelas p√°ginas de pagamento.  O uso de Eventos do lado do servidor no cliente reduzir√° a redund√¢ncia e economizar√° tr√°fego.  SSEs se encaixam no caso de uso, uma vez que a p√°gina √© passiva em seu comportamento - ela aceita apenas novas informa√ß√µes. <br><br>  <i>Contras:</i> muitos custos de implementa√ß√£o, carga adicional no equipamento. <br><br>  <i>Pr√≥s:</i> alto n√≠vel de confiabilidade e independ√™ncia em rela√ß√£o a servi√ßos de terceiros;  O contexto do pedido, n√£o a transa√ß√£o. <br>  Diagrama do circuito: <br><br><img src="https://habrastorage.org/webt/fm/cx/p2/fmcxp2z1jvfwu0ugtqviirg1ply.png"><br><br>  Quando a p√°gina de pagamento √© aberta no navegador do cliente, uma solicita√ß√£o para criar uma conex√£o SSE √© enviada para o back-end ass√≠ncrono do microsservi√ßo.  A solicita√ß√£o indica o endere√ßo a ser rastreado, o valor do pagamento, a vida √∫til e outros par√¢metros menores.  No back-end, isso √© armazenado no armazenamento noSQL na mem√≥ria.  Cada vez que um novo bloco aparece em qualquer n√≥ da blockchain, o aplicativo recebe e extrai dele informa√ß√µes √∫teis nos endere√ßos e transa√ß√µes armazenados no banco de dados.  Se o pr√≥ximo bloco for √∫til, as atualiza√ß√µes ser√£o enviadas aos clientes.  As conex√µes s√£o fechadas por iniciativa do servidor quando s√£o recebidas confirma√ß√µes suficientes ou o TTL expirou. <br><br>  Portanto, o back-end realiza opera√ß√µes com muitos recursos e direciona o tr√°fego somente quando novas informa√ß√µes chegam ao n√≥, e n√£o h√° "interrogat√≥rio" peri√≥dico para novas informa√ß√µes.  Gra√ßas √† assincronia, obtemos alta velocidade com milhares de conex√µes simult√¢neas. <br><br>  Sabendo que para moedas com PoW, o atraso no recebimento de novas informa√ß√µes em um segundo √© insignificante, a escala horizontal m√≠nima de um sistema desse tipo proporcionar√° um grande aumento na taxa de transfer√™ncia.  Em dias especialmente ativos, como Black Friday, a carga aumenta.  Caso o sistema falhe ou esteja tecnicamente com mau funcionamento, o cliente ter√° um estado de fallback no qual a p√°gina permanecer√° no modo de visualiza√ß√£o de detalhes para sempre.  Para moedas PoS, a etapa de monitoramento do n√∫mero de confirma√ß√µes pode ser ignorada, pois a velocidade da transa√ß√£o geralmente √© de 2 a 5 segundos. <br><br>  <b>A terceira op√ß√£o para a</b> implementa√ß√£o do back-end √© h√≠brida, quando, dependendo da velocidade da transa√ß√£o blockchain e informa√ß√µes sobre a disponibilidade atual de servi√ßos de terceiros, √© usada a intera√ß√£o SSE ou HTTP com os exploradores.  √â o mais eficaz e demorado ao mesmo tempo. <br><br>  A tecnologia front-end adequada para a tarefa √© vue.js com renderiza√ß√£o declarativa e a capacidade de criar v√°rios estados de componentes.  √â uma biblioteca leve, com uma estrutura elegante e modifica√ß√£o reativa do DOM.  A fonte de dados √© a conex√£o SSE que √© aberta quando o componente √© inicializado. <br><br><h3>  Desenho </h3><br><img src="https://habrastorage.org/webt/xm/c3/vs/xmc3vsycxf9ocy26iwqne_qofqq.gif"><br><br>  Desenvolvemos o produto e o tornamos de alta qualidade e confi√°vel, a fim de tornar os pagamentos em blockchain convenientes, massivos e acess√≠veis.  Adoramos n√£o apenas dinheiro, mas tamb√©m as tecnologias mais avan√ßadas, tarefas complexas e solu√ß√µes elegantes. <br><br>  Ao desenvolver o sistema de pagamento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">B2BinPay,</a> resolvemos regularmente problemas que, apesar de sua aparente simplicidade, exigem uma abordagem fora do padr√£o ou uma nova apar√™ncia.  Ficar√≠amos gratos por coment√°rios, coment√°rios e sugest√µes.  Se voc√™ deseja trazer id√©ias novas e ousadas para o servi√ßo de pagamento usado em todo o mundo, consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as vagas atuais</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt447418/">https://habr.com/ru/post/pt447418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt447408/index.html">Aprenda ingl√™s do elementar ao intermedi√°rio: recursos e motiva√ß√£o √∫teis</a></li>
<li><a href="../pt447410/index.html">Fogueira provincial ou nascimento de uma na√ß√£o</a></li>
<li><a href="../pt447412/index.html">Monitorando mensagens no RabbitMQ</a></li>
<li><a href="../pt447414/index.html">Lan√ßamento do ML.NET 1.0 RC. Novidades</a></li>
<li><a href="../pt447416/index.html">PHP Encantando pontos sobre aspas</a></li>
<li><a href="../pt447420/index.html">Salto da estratosfera</a></li>
<li><a href="../pt447422/index.html">Experi√™ncia de v√≠deo divertida: em vez de VR - √≥culos com espelhos Ximmerse Visor-X</a></li>
<li><a href="../pt447424/index.html">Reaktive - biblioteca multiplataforma para Kotlin reativo</a></li>
<li><a href="../pt447426/index.html">Como, para quem e por que ir √† consultoria? Experi√™ncia pessoal com Big Data</a></li>
<li><a href="../pt447430/index.html">IntelliJ IDEA 2019.1: personaliza√ß√£o de temas de interface, express√µes de switch do Java 12, depura√ß√£o dentro de cont√™ineres do Docker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>