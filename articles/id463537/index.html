<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍁 🙏🏻 💞 Verifikasi kode sumber pustaka .NET Core oleh penganalisa statis PVS-Studio 🆎 🏚️ 🐠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pustaka .NET Core adalah salah satu proyek C # paling populer di GitHub. Tidak mengherankan, mengingat popularitas dan kegunaannya yang luas. Jauh leb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verifikasi kode sumber pustaka .NET Core oleh penganalisa statis PVS-Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/463537/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/-a/bm/pb/-abmpb2yelga7y1zu59bejm6vgo.png" alt="Gambar 19"></div><br>  Pustaka .NET Core adalah salah satu proyek C # paling populer di GitHub.  Tidak mengherankan, mengingat popularitas dan kegunaannya yang luas.  Jauh lebih menarik untuk mencoba mencari tahu sudut-sudut gelap apa yang dapat ditemukan dalam kode sumber perpustakaan ini, yang akan kami coba lakukan menggunakan penganalisa statis PVS-Studio.  Apakah Anda pikir Anda berhasil menemukan sesuatu yang menarik pada akhirnya? <br><a name="habracut"></a><br>  Saya pergi ke artikel ini selama lebih dari satu setengah tahun.  Pada titik tertentu, ada pikiran di benak saya bahwa perpustakaan .NET Core adalah berita menarik, dan memeriksanya akan menarik.  Beberapa kali saya memeriksa proyek, analis menemukan semakin banyak tempat yang menarik, tetapi itu tidak melampaui bergulir cepat melalui daftar peringatan.  Dan ini dia - selesai!  Proyek diperiksa, artikelnya ada di depan Anda. <br><br><h2>  Lebih lanjut tentang proyek dan analisis </h2><br>  Jika Anda ingin terjun ke dalam analisis kode - Anda dapat melewati bagian ini, tetapi saya sangat ingin Anda membacanya - di sini saya berbicara sedikit lebih banyak tentang proyek dan penganalisa, serta sedikit tentang bagaimana saya menganalisis dan mereproduksi kesalahan. <br><br><h3>  Proyek yang Diaudit </h3><br>  Mungkin, akan mungkin untuk tidak memberi tahu apa itu CoreFX (.NET Core libraries), tetapi, jika Anda tidak mendengarnya, uraiannya ada di bawah ini.  Saya tidak mengulanginya dan mengambilnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari halaman proyek di GitHub</a> , di mana Anda juga dapat mengunduh sumbernya. <br><br>  Deskripsi: <i>Repo ini berisi implementasi perpustakaan (disebut "CoreFX") untuk .NET Core.</i>  <i>Ini termasuk System.Collections, System.IO, System.Xml, dan banyak komponen lainnya.</i>  <i>Repo .NET Core Runtime yang sesuai (disebut "CoreCLR") berisi implementasi runtime untuk .NET Core.</i>  <i>Ini termasuk RyuJIT, .NET GC, dan banyak komponen lainnya.</i>  <i>Kode perpustakaan khusus-runtime (System.Private.CoreLib) hidup di repo CoreCLR.</i>  <i>Itu perlu dibangun dan versi bersama-sama dengan runtime.</i>  <i>Sisa CoreFX adalah agnostik implementasi runtime dan dapat dijalankan pada runtime .NET yang kompatibel (misalnya CoreRT)</i> . <br><br><h3>  Alat analisis dan analisis yang digunakan </h3><br>  Saya memeriksa kode sumber menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penganalisa statis PVS-Studio</a> .  Secara umum, PVS-Studio dapat menganalisis tidak hanya kode C #, tetapi juga C, C ++, Java.  Analisis kode C # sejauh ini hanya berfungsi di bawah Windows, sedangkan kode di C, C ++, Java dapat Anda analisis di bawah Windows, Linux, macOS. <br><br>  Saya biasanya menggunakan plugin PVS-Studio untuk Visual Studio untuk menguji proyek C # (versi 2010-2019 didukung), karena ini mungkin cara termudah dan paling mudah untuk menganalisis: membuka solusi, memulai analisis, bekerja dengan daftar peringatan.  Namun, dengan CoreFX, segalanya menjadi sedikit lebih rumit. <br><br>  Faktanya adalah bahwa proyek tidak memiliki file .sln tunggal, oleh karena itu, membukanya di Visual Studio dan melakukan analisis penuh menggunakan plug-in PVS-Studio akan gagal.  Mungkin, itu bagus - saya tidak benar-benar tahu bagaimana Visual Studio akan berurusan dengan solusi sebesar ini. <br><br>  Namun, tidak ada masalah dengan analisis, karena kit distribusi PVS-Studio menyertakan versi baris perintah dari penganalisa untuk proyek MSBuild (dan, pada kenyataannya, .sln).  Semua yang diminta dari saya adalah menulis skrip kecil yang akan menjalankan "PVS-Studio_Cmd.exe" untuk masing-masing .sln di direktori CoreFX dan menempatkan hasil analisis dalam direktori terpisah (ditunjukkan oleh bendera peluncuran penganalisis). <br><br>  Voila!  - di pintu keluar saya memiliki satu set log, yang memiliki banyak hal menarik.  Jika diinginkan, log dapat dikombinasikan menggunakan utilitas PlogConverter, yang dilengkapi dengan kit distribusi.  Tetapi lebih nyaman bagi saya untuk bekerja dengan log individual, jadi saya tidak mulai menggabungkannya. <br><br>  Ketika menjelaskan beberapa kesalahan, saya merujuk pada dokumentasi dari docs.microsoft.com dan paket NuGet yang tersedia untuk diunduh dari nuget.org.  Saya akui bahwa kode yang dijelaskan dalam dokumentasi / ditemukan dalam paket mungkin sedikit berbeda dari yang dianalisis.  Namun demikian, akan sangat aneh jika, misalnya, dalam dokumentasi tidak ada deskripsi pengecualian yang dihasilkan untuk sejumlah data input, dan dalam versi baru paket mereka akan muncul - setuju, ini akan menjadi kejutan yang meragukan.  Reproduksi kesalahan dalam paket dari NuGet pada data input yang sama yang digunakan untuk debugging perpustakaan menunjukkan bahwa masalahnya bukan hal baru, dan, yang lebih penting, bahwa hal itu dapat "disentuh" ​​tanpa membangun proyek dari sumber. <br><br>  Jadi, dengan asumsi kemungkinan beberapa kode teoritis salah-sinkronisasi, saya merasa diizinkan untuk merujuk pada deskripsi metode yang sesuai di docs.microsoft.com dan untuk mereproduksi masalah pada paket dari nuget.org. <br><br>  Saya juga mencatat bahwa uraian tautan yang disediakan, serta informasi (komentar) dalam paket (dalam versi lain) dapat berubah selama penulisan artikel. <br><br><h3>  Proyek terbukti lainnya </h3><br>  Omong-omong, ini bukan artikel unik, kami menulis artikel lain tentang memeriksa proyek, daftar yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dapat ditemukan di sini</a> .  Selain itu, di situs kami telah mengumpulkan tidak hanya artikel tentang analisis proyek, tetapi juga berbagai artikel teknis tentang C, C ++, C #, Java, serta hanya catatan menarik.  Anda dapat menemukan semua ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">blog</a> . <br><br>  Rekan saya sebelumnya menguji pustaka .NET Core pada tahun 2015.  Hasil analisis sebelumnya dapat ditemukan di artikel terkait: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tahun Baru memeriksa .NET Core Libraries (CoreFX)</a> ." <br><br><h2>  Kesalahan ditemukan, tempat mencurigakan dan menarik </h2><br>  Seperti biasa, untuk minat yang lebih besar, saya sarankan Anda terlebih dahulu mencari kesalahan pada fragmen Anda sendiri, dan hanya kemudian membaca peringatan penganalisa dan deskripsi masalah. <br><br>  Untuk kenyamanan, saya secara eksplisit membagi fragmen yang sedang dipertimbangkan satu sama lain menggunakan label formulir <b>Issue N</b> - lebih mudah untuk memahami di mana deskripsi satu kesalahan berakhir dan analisis yang lain dimulai.  Ya, dan merujuk pada fragmen tertentu juga lebih mudah. <br><br>  <b>Edisi 1</b> <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Principal</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PrincipalContext context</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( context.ContextType == ContextType.Machine || _ctx.ContextType == ContextType.Machine) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException( SR.SaveToNotSupportedAgainstMachineStore); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Debug.Assert(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.unpersisted == <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidOperationException(SR.NullArguments); } .... } .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3095 Objek</a> 'konteks' digunakan sebelum diverifikasi terhadap nol.  Periksa baris: 340, 346. Principal.cs 340 <br><br>  Pengembang secara eksplisit menunjukkan bahwa nilai <i>nol</i> untuk parameter <i>konteks</i> tidak valid dan ingin menekankan ini dengan pengecualian tipe <i>InvalidOperationException</i> .  Namun, sedikit lebih tinggi, dalam kondisi sebelumnya, ada dereference tanpa syarat dari tautan <i>konteks</i> - <i>context.ContextType</i> .  Akibatnya, jika nilai <i>konteksnya</i> <i>nol</i> , pengecualian tipe <i>NullReferenceException</i> akan <i>dilempar</i> alih-alih <i>InvalidOperationExcetion yang</i> diharapkan. <br><br>  Mari kita coba mereproduksi masalahnya.  Hubungkan pustaka yang sesuai ( <i>System.DirectoryServices.AccountManagement</i> ) ke proyek dan jalankan kode berikut: <br><br><pre> <code class="cs hljs">GroupPrincipal groupPrincipal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GroupPrincipal(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrincipalContext(ContextType.Machine)); groupPrincipal.Save(<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br>  <i>GroupPrincipal</i> adalah penerus <i>Principal</i> kelas abstrak, yang berisi implementasi metode <i>Simpan</i> yang kita butuhkan.  Kami menjalankan kode untuk dieksekusi dan melihat apa yang harus dibuktikan. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/290/09a/2cc/29009a2cc3a5408808b9814d48bb0dea.png" alt="Gambar 1"></div><br><br>  Untuk bersenang-senang, Anda dapat mencoba mengunduh paket yang sesuai dari NuGet dan mencoba mengulangi masalahnya dengan cara yang sama.  Saya menginstal paket versi 4.5.0 dan mendapatkan hasil yang diharapkan. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3de/891/b4a/3de891b4a4ba8100bb63af19e4455842.png" alt="Gambar 2"></div><br><br>  <b>Edisi 2</b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> SearchResultCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindAll</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> findMoreThanOne</span></span></span><span class="hljs-function">)</span></span> { searchResult = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; DirectoryEntry clonedRoot = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_assertDefaultNamingContext == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { clonedRoot = SearchRoot.CloneBrowsable(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { clonedRoot = SearchRoot.CloneBrowsable(); } .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3004</a> Pernyataan 'then' setara dengan pernyataan 'else'.  DirectorySearcher.cs 629 <br><br>  Terlepas dari kebenaran kondisi <i>_assertDefaultNamingContext == null</i> , tindakan yang sama akan dilakukan, sejak <i>saat itu</i> dan cabang <i>-</i> cabang <i>pernyataan if</i> memiliki badan yang sama.  Entah harus ada tindakan lain di beberapa cabang, atau Anda dapat menghilangkan <i>pernyataan if</i> agar tidak membingungkan para programmer dan penganalisa. <br><br>  <b>Edisi 3</b> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DirectoryEntry</span></span> : <span class="hljs-title"><span class="hljs-title">Component</span></span> { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] propertyNames</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] names = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[propertyNames.Length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; propertyNames.Length; i++) names[i] = propertyNames[i]; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_propertyCollection != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; propertyNames != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) .... .... } .... }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3095 Objek</a> 'propertyNames' digunakan sebelum diverifikasi dengan null.  Periksa baris: 990, 1004. DirectoryEntry.cs 990 <br><br>  Sekali lagi kita melihat prosedur aneh.  Metode ini memiliki <i>propertyNames! =</i> Cek <i>kosong</i> , mis.  pengembang memastikan sendiri bahwa metode mengembalikan <i>nol</i> .  Berikut ini tepat di atas Anda dapat mengamati beberapa akses ke referensi yang berpotensi nol ini - <i>propertyNames. Panjang</i> dan <i>propertyNames [i]</i> .  Hasilnya cukup dapat diprediksi - pengecualian tipe <i>NullReferenceExcepption akan</i> terjadi jika referensi nol dilewatkan ke metode. <br><br>  Kebetulan <i>RefreshCache</i> adalah metode publik di kelas publik.  Coba ulangi masalahnya?  Untuk melakukan ini, sambungkan ke proyek perpustakaan yang diinginkan - <i>System.DirectoryServices</i> - dan tulis kode seperti ini: <br><br><pre> <code class="cs hljs">DirectoryEntry de = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DirectoryEntry(); de.RefreshCache(<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br>  Jalankan kode untuk dieksekusi dan lihat gambar yang diharapkan. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d9/040/d0a/2d9040d0ae8d91394c476d6788aa7275.png" alt="Gambar 3"></div><br><br>  Untuk bersenang-senang, Anda dapat mencoba mereproduksi masalah pada versi rilis paket NuGet.  Kami menghubungkan paket <i>System.DirectoryServices</i> ke proyek NuGet (saya menggunakan versi 4.5.0) dan menjalankan kode yang sudah dikenal untuk eksekusi.  Hasilnya lebih rendah. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0d6/31e/309/0d631e3096fa8ba00b41fe10ad1001db.png" alt="Gambar 4"></div><br><br>  <b>Masalah 4</b> <br><br>  Sekarang kita akan pergi dari kebalikannya - pertama coba tulis kode yang menggunakan instance kelas, lalu lihat ke dalam.  Mari kita lihat struktur <i>System.Drawing.CharacterRange</i> dari perpustakaan <i>System.Drawing.Common</i> dan paket NuGet dengan nama yang sama. <br><br>  Kode yang digunakan adalah sebagai berikut: <br><br><pre> <code class="cs hljs">CharacterRange range = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CharacterRange(); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> eq = range.Equals(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); Console.WriteLine(eq);</code> </pre> <br>  Untuk berjaga-jaga, untuk menyegarkan memori, kita akan beralih ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">docs.microsoft.com</a> untuk mengingat kembali nilai pengembalian yang diharapkan dari objek ekspresi. <i>Sama dengan (nol)</i> : <br><br>  <i>Pernyataan berikut harus benar untuk semua implementasi metode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><i>Persamaan (Objek)</i></a> .</i>  <i>Dalam daftar, x, y, dan z mewakili referensi objek yang bukan nol.</i> <br><br>  <i>....</i> <br><br>  <b><i>x.Equals (null) mengembalikan false.</i></b> <br><br>  Apakah Anda pikir teks "Salah" akan ditampilkan di konsol?  Tentu saja tidak, itu terlalu mudah.  :) Kami mengeksekusi kode dan melihat hasilnya. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e87/159/8f6/e871598f6ca5dacdb4a4fae7b5776520.png" alt="Gambar 5"></div><br>  Ini adalah kesimpulan ketika mengeksekusi kode di atas menggunakan paket NuGet <i>System.Drawing.Common</i> versi 4.5.1.  Kami menjalankan kode yang sama dengan versi debug pustaka dan melihat yang berikut: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6e9/f27/f1a/6e9f27f1a78768078fdd940e0a4be0ad.png" alt="Gambar 6"></div><br><br>  Sekarang mari kita lihat kode sumber - implementasi metode <i>Persamaan</i> dalam struktur <i>CharacterRange</i> dan peringatan penganalisa: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (obj.GetType() != <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(CharacterRange)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; CharacterRange cr = (CharacterRange)obj; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((_first == cr.First) &amp;&amp; (_length == cr.Length)); }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Peringatan</a> <b>PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3115</a> Melewati <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">metode</a> 'null' ke 'Equals' tidak boleh menghasilkan 'NullReferenceException'.  CharacterRange.cs 56 <br><br>  Kami melihat apa yang perlu kami buktikan - parameter <i>obj</i> diproses secara tidak akurat, karena itu pengecualian tipe <i>NullReferenceException</i> terjadi ketika memanggil metode instance <i>GetType</i> dalam ekspresi kondisional. <br><br>  <b>Edisi 5</b> <br><br>  Saat menjelajahi perpustakaan ini, pertimbangkan tempat lain yang menarik - metode <i>Icon.Save</i> .  Sebelum belajar, lihat deskripsi metodenya. <br><br>  Tidak ada deskripsi metode ini: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ffd/fef/402/ffdfef402f77c462c94b9ff284f42e0c.png" alt="Gambar 7"></div><br>  Kami beralih ke docs.microsoft.com - " <a href="">Icon.Save (Stream) Method</a> ".  Namun, tidak ada batasan pada nilai input dan tidak ada informasi tentang pengecualian yang dihasilkan. <br><br>  Sekarang mari kita beralih ke penelitian kode. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Icon</span></span> : <span class="hljs-title"><span class="hljs-title">MarshalByRefObject</span></span>, <span class="hljs-title"><span class="hljs-title">ICloneable</span></span>, <span class="hljs-title"><span class="hljs-title">IDisposable</span></span>, <span class="hljs-title"><span class="hljs-title">ISerializable</span></span> { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Stream outputStream</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_iconData != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { outputStream.Write(_iconData, <span class="hljs-number"><span class="hljs-number">0</span></span>, _iconData.Length); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outputStream == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"dataStream"</span></span>); .... } } .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3095 Objek</a> 'outputStream' digunakan sebelum diverifikasi dengan null.  Periksa baris: 654, 672. Icon.Windows.cs 654 <br><br>  Lagi-lagi, cerita yang sudah kita ketahui adalah kemungkinan referensi referensi nol, karena parameter metode didereferensi tanpa memeriksa <i>nol</i> .  Sekali lagi, kombinasi keadaan yang baik - baik kelas dan metodenya - bersifat publik, yang berarti Anda dapat mencoba mereproduksi masalah. <br><br>  Tugasnya sederhana - untuk membawa eksekusi kode ke ekspresi <i>outputStream.Write (_iconData, 0, _iconData.Length);</i>  sambil mempertahankan nilai variabel <i>outputStream</i> - <i>null</i> .  Untuk melakukan ini, cukup bahwa kondisi <i>_iconData! = Null</i> puas. <br><br>  Mari kita lihat konstruktor publik paling sederhana: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Icon</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fileName, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">)</span></span> { }</code> </pre> <br>  Dia hanya mendelegasikan pekerjaan ke konstruktor lain.  Nah, lihat lebih jauh - konstruktor yang digunakan di sini. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Icon</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (FileStream f = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.Read)) { Debug.Assert(f != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"File.OpenRead returned null instead of throwing an exception"</span></span>); _iconData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)f.Length]; f.Read(_iconData, <span class="hljs-number"><span class="hljs-number">0</span></span>, _iconData.Length); } Initialize(width, height); }</code> </pre> <br>  Ini dia, apa yang kamu butuhkan.  Setelah memanggil konstruktor ini, jika kita berhasil membaca data dari file dan jika tidak ada crash terjadi dalam metode <i>Inisialisasi</i> , bidang <i>_iconData</i> akan berisi tautan ke beberapa objek, yang merupakan apa yang kita butuhkan. <br><br>  Ternyata untuk mereproduksi masalah, Anda perlu membuat turunan dari kelas <i>Ikon</i> dengan ikon yang sebenarnya dan kemudian memanggil metode <i>Simpan</i> , melewati <i>nol</i> sebagai argumen, yang akan kami lakukan.  Kode tersebut dapat terlihat, misalnya, sebagai berikut: <br><br><pre> <code class="cs hljs">Icon icon = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Icon(<span class="hljs-string"><span class="hljs-string">@"D:\document.ico"</span></span>); icon.Save(<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br>  Hasil eksekusi diharapkan. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b37/fdb/dd1/b37fdbdd1288c054fdaaa0add0ffcfcf.png" alt="Gambar 8"></div><br>  <b>Edisi 6</b> <br><br>  Kami melanjutkan ulasan dan pergi ke perpustakaan <i>System.Management</i> .  Cobalah untuk menemukan 3 perbedaan antara tindakan yang dilakukan dalam <i>kasus</i> <i>CimType.UInt32</i> dan yang lainnya. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertToNumericValueAndAddToArray</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> retFunctionName = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; enumType = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(cimType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt8: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt8: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt16: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt16: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.SInt32: arrayToAdd.Add(System.Convert.ToInt32( numericValue, (IFormatProvider)CultureInfo.InvariantCulture .GetFormat(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)))); retFunctionName = <span class="hljs-string"><span class="hljs-string">"ToInt32"</span></span>; enumType = <span class="hljs-string"><span class="hljs-string">"System.Int32"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CimType.UInt32: arrayToAdd.Add(System.Convert.ToInt32( numericValue, (IFormatProvider)CultureInfo.InvariantCulture .GetFormat(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)))); retFunctionName = <span class="hljs-string"><span class="hljs-string">"ToInt32"</span></span>; enumType = <span class="hljs-string"><span class="hljs-string">"System.Int32"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retFunctionName; }</code> </pre> <br>  Tentu saja, tidak ada perbedaan, yang diperingatkan oleh penganalisa. <br><br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3139</a> Dua atau lebih cabang kasus melakukan tindakan yang sama.  WMIGenerator.cs 5220 <br><br>  Gaya kode ini tidak terlalu jelas bagi saya secara pribadi.  Jika tidak ada kesalahan di sini, saya pikir tidak ada gunanya menyebarkan logika yang sama ke berbagai kasus. <br><br>  <b>Edisi 7</b> <br><br>  Perpustakaan <i>Microsoft.CSharp</i> . <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IList&lt;KeyValuePair&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;&gt; QueryDynamicObject(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> obj) { .... List&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; names = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(mo.GetDynamicMemberNames()); names.Sort(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (names != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } .... }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Peringatan</a> <b>PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3022</a> Ekspresi 'nama! = Null' selalu benar.  DynamicDebuggerProxy.cs 426 <br><br>  Saya mungkin bisa mengabaikan peringatan ini bersama dengan banyak peringatan serupa yang dikeluarkan oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diagnostik V3022</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3063</a> .  Ada banyak (sangat banyak) cek aneh, tetapi ini entah bagaimana tenggelam ke dalam jiwaku.  Ada kemungkinan bahwa sebelum membandingkan <i>nama</i> variabel lokal dengan <i>nol</i> ke variabel ini, tidak hanya referensi ke objek yang baru dibuat ditulis, itu juga memanggil metode instance <i>Sort</i> .  Ini bukan kesalahan, tentu saja, tetapi tempat ini menarik, seperti bagi saya. <br><br>  <b>Edisi 8</b> <br><br>  Ini potongan kode lain yang menarik. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InsertChildNoGrow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Symbol child</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sym?.nextSameName != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { sym = sym.nextSameName; } Debug.Assert(sym != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; sym.nextSameName == <span class="hljs-literal"><span class="hljs-literal">null</span></span>); sym.nextSameName = child; .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3042</a> Kemungkinan NullReferenceException.  '?.'  dan '.'  operator digunakan untuk mengakses anggota objek 'sym' SymbolStore.cs 56 <br><br>  Lihat apa yang ada di sini.  Siklus berakhir ketika salah satu dari dua kondisi terpenuhi: <br><br><ul><li>  <i>sym == null</i> ; </li><li>  <i>sym.nextSameName == null</i> . </li></ul><br>  Tidak ada masalah dengan kondisi kedua, yang tidak dapat dikatakan tentang yang pertama, karena di bawah ini adalah panggilan tanpa syarat ke bidang instance <i>nextSameName</i> dan, jika <i>sym</i> adalah <i>nol</i> , pengecualian dari tipe <i>NullReferenceException</i> akan dilemparkan <i>selama panggilan</i> . <br><br>  "Apakah kamu buta?  Ada juga panggilan ke <i>Debug.Assert</i> , di mana dicentang bahwa <i>sym! = Null</i> "- seseorang mungkin keberatan.  Tapi itu semua garam!  Saat bekerja di versi Rilis <i>Debug.Assert,</i> tidak ada yang akan membantu, dan dengan keadaan yang dijelaskan di atas, semua yang kita dapatkan adalah <i>NullReferenceException</i> .  Selain itu, saya sudah melihat kesalahan serupa di proyek lain dari Microsoft - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Roslyn</a> , di mana ada situasi yang sangat mirip dengan <i>Debug.Assert</i> .  Sedikit terganggu oleh Roslyn dengan izin Anda. <br><br>  Masalahnya dapat direproduksi baik menggunakan perpustakaan <i>Microsoft.CodeAnalysis</i> , atau langsung di Visual Studio menggunakan Syntax Visualizer.  Pada Visual Studio versi 16.1.6 + Sintaks Visualizer 1.0, masalah ini masih mereproduksi. <br><br>  Untuk mereproduksi, kode tersebut cukup: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">C1</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T1</span></span>, <span class="hljs-title"><span class="hljs-title">T2</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { T1 val = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (val <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { } } }</code> </pre> <br>  Selanjutnya, dalam Sintaks Visualizer, Anda perlu menemukan simpul pohon sintaks tipe <i>ConstantPatternSyntax</i> , yang sesuai dengan <i>nol</i> dalam kode, dan meminta <i>TypeSymbol</i> untuk itu. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/855/b9c/baa/855b9cbaa67c9a5909117d513e154293.png" alt="Gambar 9"></div><br>  Setelah itu, Visual Studio akan reboot.  Jika kita masuk ke Peraga Peristiwa, kita akan menemukan informasi tentang masalah di perpustakaan: <br><br><pre> <code class="cs hljs">Application: devenv.exe Framework Version: v4<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.30319</span></span> Description: The process was terminated due to an unhandled exception. Exception Info: System.Resources.MissingManifestResourceException at System.Resources.ManifestBasedResourceGroveler .HandleResourceStreamMissing(System.String) at System.Resources.ManifestBasedResourceGroveler.GrovelForResourceSet( System.Globalization.CultureInfo, System.Collections.Generic.Dictionary<span class="hljs-string"><span class="hljs-string">'2 &lt;System.String,System.Resources.ResourceSet&gt;, Boolean, Boolean, System.Threading.StackCrawlMark ByRef) at System.Resources.ResourceManager.InternalGetResourceSet( System.Globalization.CultureInfo, Boolean, Boolean, System.Threading.StackCrawlMark ByRef) at System.Resources.ResourceManager.InternalGetResourceSet( System.Globalization.CultureInfo, Boolean, Boolean) at System.Resources.ResourceManager.GetString(System.String, System.Globalization.CultureInfo) at Roslyn.SyntaxVisualizer.DgmlHelper.My. Resources.Resources.get_SyntaxNodeLabel() ....</span></span></code> </pre> <br>  Dan tentang masalah dengan devenv.exe: <br><br><pre> <code class="cs hljs">Faulting application name: devenv.exe, version: <span class="hljs-number"><span class="hljs-number">16.1</span></span><span class="hljs-number"><span class="hljs-number">.29102</span></span><span class="hljs-number"><span class="hljs-number">.190</span></span>, time stamp: <span class="hljs-number"><span class="hljs-number">0x5d1c133b</span></span> Faulting module name: KERNELBASE.dll, version: <span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.18362</span></span><span class="hljs-number"><span class="hljs-number">.145</span></span>, time stamp: <span class="hljs-number"><span class="hljs-number">0xf5733ace</span></span> Exception code: <span class="hljs-number"><span class="hljs-number">0xe0434352</span></span> Fault offset: <span class="hljs-number"><span class="hljs-number">0x001133d2</span></span> ....</code> </pre> <br>  Memiliki versi debug pustaka Roslyn, Anda dapat menemukan tempat di mana pengecualian terjadi: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Conversion </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ClassifyImplicitBuiltInConversionSlow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> TypeSymbol source, TypeSymbol destination, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> HashSet&lt;DiagnosticInfo&gt; useSiteDiagnostics</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert((<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>)source != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); Debug.Assert((<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>)destination != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( source.SpecialType == SpecialType.System_Void || destination.SpecialType == SpecialType.System_Void) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Conversion.NoConversion; } .... }</code> </pre> <br>  Di sini, seperti dalam kode di atas dari perpustakaan .NET Core, ada juga pemeriksaan melalui <i>Debug.Assert</i> , yang, bagaimanapun, tidak membantu dengan cara apa pun ketika menggunakan versi rilis dari perpustakaan. <br><br>  <b>Edisi 9</b> <br><br>  Sedikit terganggu - dan itu sudah cukup, kembali ke perpustakaan .NET Core.  Paket <i>System.IO.IsolatedStorage</i> berisi kode menarik berikut. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContainsUnknownFiles</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> directory</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (files.Length &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> || ( (!IsIdFile(files[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &amp;&amp; !IsInfoFile(files[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) || (files.Length == <span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; !IsIdFile(files[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &amp;&amp; !IsInfoFile(files[<span class="hljs-number"><span class="hljs-number">1</span></span>])) ); }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3088</a> Ekspresi tertutup oleh tanda kurung dua kali: ((ekspresi)).  Sepasang tanda kurung tidak perlu atau salah cetak ada.  IsolatedStorageFile.cs 839 <br><br>  Mengatakan bahwa pemformatan kode membingungkan adalah tidak mengatakan apa-apa.  Melirik sekilas kode ini, saya akan mengatakan bahwa operan kiri dari operator pertama ||  - <i>file. Panjang&gt; 2</i> , yang benar adalah bahwa dalam tanda kurung.  Setidaknya kodenya diformat seperti ini.  Melihat sedikit lebih dekat, Anda dapat memahami bahwa ini tidak benar.  Bahkan, operan yang tepat adalah <i>((! IsIdFile (file [0]) &amp;&amp;! IsInfoFile (file [0]))))</i> .  Menurut pendapat saya, kode ini cukup membingungkan. <br><br>  <b>Edisi 10</b> <br><br>  Dalam rilis PVS-Studio 7.03, aturan diagnostik V3138 ditambahkan, yang mencari kesalahan dalam baris interpolasi.  Lebih tepatnya, di baris yang paling mungkin diinterpolasi, tetapi karena karakter <i>$ yang</i> hilang, mereka tidak.  Pustaka <i>System.Net</i> menemukan beberapa respons menarik terhadap aturan diagnostik ini. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CacheCredential</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SafeFreeCredentials newHandle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ExceptionCheck.IsFatal(e)) { NetEventSource.Fail(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Attempted to throw: {e}"</span></span>); } } }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3138</a> String literal berisi ekspresi potensial yang diinterpolasi.  Pertimbangkan untuk memeriksa: e.  SSPIHandleCache.cs 42 <br><br>  Sangat mungkin bahwa argumen kedua ke metode <i>Gagal</i> harus berupa string yang diinterpolasi, di mana representasi string dari pengecualian <i>e</i> akan diganti.  Namun, karena karakter <i>$ yang</i> hilang, tidak ada representasi string dari pengecualian dilemparkan. <br><br>  <b>Edisi 11</b> <br><br>  Saya bertemu kasus serupa lainnya. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDigestTokenForCredential</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) NetEventSource.Error(digestResponse, <span class="hljs-string"><span class="hljs-string">"Algorithm not supported: {algorithm}"</span></span>); .... }</code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3138</a> String literal berisi ekspresi potensial yang diinterpolasi.  Pertimbangkan untuk memeriksa: algoritma.  AuthenticationHelper.Digest.cs 58 <br><br>  Situasinya mirip dengan yang dijelaskan di atas, simbol <i>$</i> dilewati lagi - baris yang salah menuju ke metode <i>Kesalahan</i> . <br><br>  <b>Edisi 12</b> <br><br>  Paket <i>System.Net.Mail</i> .  Metode ini kecil, saya akan membawanya secara keseluruhan sehingga kesalahannya sedikit lebih menarik. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetContent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Stream stream</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stream == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(stream)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_streamSet) { _stream.Close(); _stream = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; _streamSet = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } _stream = stream; _streamSet = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; _streamUsedOnce = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; TransferEncoding = TransferEncoding.Base64; }</code> </pre> <br>  <b>PVS-Studio Warning</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3008 Variabel</a> '_streamSet' diberi nilai dua kali berturut-turut.  Mungkin ini sebuah kesalahan.  Periksa baris: 123, 119. MimePart.cs 123 <br><br>  Penugasan ganda dari nilai variabel <i>_streamSet</i> terlihat aneh (pertama, di bawah kondisi; lalu di luar).  Kisah yang sama dengan <i>mem</i> -zeroing variabel <i>_stream</i> .  Akibatnya, <i>_stream</i> akan tetap disetel ke <i>streaming</i> , dan <i>_streamSet</i> ke <i>true</i> . <br><br>  <b>Masalah 13</b> <br><br>  Tempat yang menarik dari pustaka <i>System.Linq.Expressions</i> , yang mana penganalisa segera mengeluarkan 2 peringatan.  Dalam hal ini, ini lebih merupakan fitur daripada bug, tetapi metode ini sangat menarik ... <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// throws NRE when o is null protected static void NullCheck(object o) { if (o == null) { o.GetType(); } }</span></span></code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3010</a> Nilai balik fungsi 'GetType' harus digunakan.  Instruction.cs 36 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3080</a> Kemungkinan null dereference.  Pertimbangkan untuk memeriksa 'o'.  Instruction.cs 36 </li></ul><br>  Mungkin tidak ada komentar. <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c9/a88/a22/5c9a88a221d4cd5ba5f4f1d9f74a346b.png" alt="Gambar 20"></div><br>  <b>Edisi 14</b> <br><br>  Mari kita lihat kasus lain yang dengannya kita akan bekerja "dari luar."  Pertama, kami akan menulis kode, mengidentifikasi masalah, dan kemudian mencari ke dalam.  Untuk belajar, ambil perpustakaan <i>System.Configuration.ConfigurationManager</i> dan paket NuGet dengan nama yang sama.  Saya menggunakan paket versi 4.5.0.  Kami akan bekerja dengan kelas <i>System.Configuration.CommaDelimitedStringCollection</i> . <br><br>  Mari kita lakukan sesuatu yang tidak terlalu rumit.  Misalnya, buat objek, ekstrak representasi stringnya, dapatkan panjang string ini dan cetaklah.  Kode yang relevan: <br><br><pre> <code class="cs hljs">CommaDelimitedStringCollection collection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CommaDelimitedStringCollection(); Console.WriteLine(collection.ToString().Length);</code> </pre> <br>  Untuk berjaga-jaga, lihat deskripsi metode <i>ToString</i> : <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8dc/544/56d/8dc54456dd1296d89fbe447fac71ac17.png" alt="Gambar 11"></div><br>  Tidak ada yang aneh - representasi string dari objek hanya dikembalikan.  Untuk berjaga-jaga, saya juga melihat docs.microsoft.com - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CommaDelimitedStringCollection.ToString Method</a> ".  Sepertinya tidak ada yang istimewa juga. <br><br>  Oke, jalankan kode untuk dieksekusi, ii ... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa5/89f/1af/fa589f1afc8ceb9415694e1261e59ab7.png" alt="Gambar 12"></div><br>  Hmm, tanpa diduga.  Baiklah, mari kita coba menambahkan elemen ke koleksi, dan kemudian dapatkan representasi string-nya.  "Benar-benar tidak sengaja" kami akan menambahkan string kosong :).  Kode akan berubah dan terlihat seperti ini: <br><br><pre> <code class="cs hljs">CommaDelimitedStringCollection collection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CommaDelimitedStringCollection(); collection.Add(String.Empty); Console.WriteLine(collection.ToString().Length);</code> </pre> <br>  Kami meluncurkannya dan melihat ... <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d37/4bc/d2e/d374bcd2ed23bd048276493ed19d30fe.png" alt="Gambar 13"></div><br>  Apa lagi?  Baiklah, mari kita lihat implementasi metode <i>ToString</i> dari kelas <i>CommaDelimitedStringCollection</i> .  Kode disajikan di bawah ini: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Count &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { ThrowIfContainsDelimiter(str); <span class="hljs-comment"><span class="hljs-comment">// .... sb.Append(str.Trim()); sb.Append(','); } if (sb.Length &gt; 0) sb.Length = sb.Length - 1; return sb.Length == 0 ? null : sb.ToString(); }</span></span></code> </pre> <br>  <b>Peringatan PVS-Studio</b> : <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3108</a> Tidak disarankan untuk mengembalikan 'null' dari metode 'ToSting ()'.  StringAttributeCollection.cs 57 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3108</a> Tidak disarankan untuk mengembalikan 'null' dari metode 'ToSting ()'.  StringAttributeCollection.cs 71 </li></ul><br>  Di sini kita melihat 2 tempat di mana implementasi <i>ToString</i> saat ini dapat mengembalikan <i>nol</i> .  Ingat apa yang disarankan Microsoft ketika menerapkan metode <i>ToString</i> , dan kami kembali ke docs.microsoft.com - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Object.ToString Method</a> ": <br><br>  <i>Notes to Inheritors .... Overrides dari metode ToString () harus mengikuti panduan ini:</i> <ul><li>  <i>....</i> </li><li>  <i>Penggantian ToString () Anda tidak boleh mengembalikan</i> <i>string</i> <i>Kosong atau</i> <b><i>null</i></b> <i>.</i> </li><li>  <i>....</i> </li></ul><br>  Sebenarnya, inilah yang diperingatkan PVS-Studio.  Dua cuplikan kode di atas yang kami tulis untuk mereproduksi masalah mencapai titik keluar yang berbeda - tempat pertama dan kedua tempat <i>null</i> kembali, masing-masing.  Menggali lebih dalam. <br><br>  Kasus pertama.  <i>Hitung</i> - properti <i>StringCollection</i> kelas dasar.  Karena tidak ada elemen yang ditambahkan, <i>Hitung == 0</i> , kondisi <i>Hitung &lt;= 0</i> terpenuhi, <i>null</i> dikembalikan. <br><br>  Dalam kasus kedua, kami menambahkan elemen menggunakan metode instance <i>CommaDelimitedStringCollection.Add</i> untuk ini. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> new </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { ThrowIfReadOnly(); ThrowIfContainsDelimiter(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); _modified = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Add(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Trim()); }</code> </pre> <br>  Cek dalam metode <i>ThrowIf ...</i> berhasil dilakukan dan item ditambahkan ke koleksi dasar.  Dengan demikian, nilai <i>Hitung</i> menjadi sama dengan 1. Sekarang kita kembali ke metode <i>ToString</i> .  Nilai dari ekspresi <i>Count &lt;= 0</i> adalah <i>false</i> , oleh karena itu, tidak ada jalan keluar dari metode dan kode terus dieksekusi.  Traversal koleksi internal dimulai, dan 2 elemen ditambahkan ke <i>StringBuilder</i> - string kosong dan koma.  Akibatnya, ternyata <i>sb</i> hanya berisi koma, nilai properti <i>Panjang</i> , masing-masing, sama dengan satu.  Nilai dari ekspresi <i>sb.Length&gt; 0</i> adalah <i>true</i> , kurangi dan tuliskan ke <i>sb.Length dilakukan</i> , sekarang nilai <i>sb.Length</i> adalah 0. Ini mengarah pada fakta bahwa metode mengembalikan <i>nol</i> lagi. <br><br>  <b>Edisi 15</b> <br><br>  Secara tak terduga, saya ingin menggunakan kelas <i>System.Configuration.ConfigurationProperty</i> .  Ambil konstruktor dengan parameter terbanyak: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigurationProperty</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, Type type, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> defaultValue, TypeConverter typeConverter, ConfigurationValidatorBase validator, ConfigurationPropertyOptions options, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> description</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br>  Mari kita lihat deskripsi parameter terakhir: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// description: // The description of the configuration entity.</span></span></code> </pre> <br>  Deskripsi konstruktor di docs.microsoft.com mengatakan hal yang sama.  Baiklah, mari kita lihat bagaimana parameter ini digunakan dalam tubuh konstruktor: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigurationProperty</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...., </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> description</span></span></span><span class="hljs-function">)</span></span> { ConstructorInit(name, type, options, validator, typeConverter); SetDefaultValue(defaultValue); }</code> </pre> <br>  Dan parameternya tidak digunakan. <br><br>  <b>Peringatan PVS-Studio</b> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3117</a> 'Deskripsi' parameter konstruktor tidak digunakan.  ConfigurationProperty.cs 62 <br><br>  Mereka mungkin tidak menggunakannya dengan sengaja, tetapi deskripsi parameter yang sesuai membingungkan. <br><br>  <b>Edisi 16</b> <br><br>  Saya bertemu tempat serupa lainnya.  Coba cari kesalahan sendiri, kode konstruktornya ada di bawah. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SectionXmlInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configKey, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> definitionConfigPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> targetConfigPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> subPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lineNumber, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> streamVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawXml, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configSource, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configSourceStreamName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configSourceStreamVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> protectionProviderName, OverrideModeSetting overrideMode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> skipInChildApps</span></span></span><span class="hljs-function">)</span></span> { ConfigKey = configKey; DefinitionConfigPath = definitionConfigPath; TargetConfigPath = targetConfigPath; SubPath = subPath; Filename = filename; LineNumber = lineNumber; StreamVersion = streamVersion; RawXml = rawXml; ConfigSource = configSource; ConfigSourceStreamName = configSourceStreamName; ProtectionProviderName = protectionProviderName; OverrideModeSetting = overrideMode; SkipInChildApps = skipInChildApps; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konstruktor V3117 'configSourceStreamVersion' tidak digunakan. </font><font style="vertical-align: inherit;">SectionXmlInfo.cs 16 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada properti yang sesuai, meskipun terlihat agak aneh:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> ConfigSourceStreamVersion { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secara umum, kode tersebut terlihat mencurigakan. </font><font style="vertical-align: inherit;">Mungkin parameter / properti dibiarkan untuk kompatibilitas, tetapi ini hanya dugaan saya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 17</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat apa yang menarik ditemukan dalam kode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.WindowsRuntime.UI.Xaml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> library </font><font style="vertical-align: inherit;">dan paket NuGet dengan nama yang sama.</font></font><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> RepeatBehavior : IFormattable { .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InternalToString(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3108</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak disarankan untuk mengembalikan 'null' dari metode 'ToSting ()'. RepeatBehavior.cs 113 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kisah yang sudah dikenal yang telah berlalu - metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Karena itu, penulis kode panggilan, dengan asumsi bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RepeatBehavior.ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> selalu mengembalikan referensi yang tidak nol, mungkin akan terkejut pada beberapa titik. Dan lagi, ini adalah penyimpangan dari pedoman Microsoft. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tentu saja, hanya dari metode ini tidak jelas bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Anda perlu menggali lebih dalam dan melihat ke metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InternalToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InternalToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> format, IFormatProvider formatProvider</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (_Type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Forever: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Forever"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Count: StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); sb.AppendFormat( formatProvider, <span class="hljs-string"><span class="hljs-string">"{0:"</span></span> + format + <span class="hljs-string"><span class="hljs-string">"}x"</span></span>, _Count); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RepeatBehaviorType.Duration: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Duration.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisa menemukan bahwa jika </font><font style="vertical-align: inherit;">cabang </font><i><font style="vertical-align: inherit;">default</font></i><font style="vertical-align: inherit;"> dieksekusi </font><font style="vertical-align: inherit;">di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">switch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">InternalToString</font></i><font style="vertical-align: inherit;"> akan mengembalikan </font><i><font style="vertical-align: inherit;">nol</font></i><font style="vertical-align: inherit;"> , oleh karena itu, </font><i><font style="vertical-align: inherit;">null</font></i><font style="vertical-align: inherit;"> akan mengembalikan </font><i><font style="vertical-align: inherit;">ToString</font></i><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">RepeatBehavior</font></i><font style="vertical-align: inherit;"> adalah struktur publik, dan </font><i><font style="vertical-align: inherit;">ToString</font></i><font style="vertical-align: inherit;"> adalah metode publik, sehingga Anda dapat mencoba mereproduksi masalah dalam praktik. Untuk melakukan ini, buat instance </font><i><font style="vertical-align: inherit;">RepeatBehavior</font></i><font style="vertical-align: inherit;"> , panggil metode </font><i><font style="vertical-align: inherit;">ToString</font></i><font style="vertical-align: inherit;"> di atasnya </font><font style="vertical-align: inherit;">, tetapi ingat bahwa </font><i><font style="vertical-align: inherit;">_Type</font></i><font style="vertical-align: inherit;"> tidak boleh sama dengan </font><i><font style="vertical-align: inherit;">RepeatBehaviorType.Forever</font></i><font style="vertical-align: inherit;"> , </font><i><font style="vertical-align: inherit;">RepeatBehaviorType.Count</font></i><font style="vertical-align: inherit;"> atau</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br> <i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UlangiBehaviorTipe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Durasi</font></i><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Type</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah bidang pribadi yang dapat ditetapkan melalui properti publik:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> RepeatBehavior : IFormattable { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RepeatBehaviorType _Type; .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> RepeatBehaviorType Type { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Type; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _Type = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sejauh ini, semuanya terlihat bagus. </font><font style="vertical-align: inherit;">Silakan dan lihat apa tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RepeatBehaviorType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> RepeatBehaviorType { Count, Duration, Forever }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang Anda lihat, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RepeatBehaviorType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah enumerasi yang berisi ketiga elemen. </font><font style="vertical-align: inherit;">Selain itu, ketiga elemen ini tercakup dalam ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">switch yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperlukan </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Namun, ini tidak berarti bahwa </font><font style="vertical-align: inherit;">cabang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak dapat dijangkau. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mereproduksi masalah, hubungkan paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.WindowsRuntime.UI.Xaml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (saya menggunakan versi 4.3.0) </font><font style="vertical-align: inherit;">ke proyek </font><font style="vertical-align: inherit;">dan jalankan kode berikut.</font></font><br><br><pre> <code class="cs hljs">RepeatBehavior behavior = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RepeatBehavior() { Type = (RepeatBehaviorType)<span class="hljs-number"><span class="hljs-number">666</span></span> }; Console.WriteLine(behavior.ToString() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diharapkan menjadi output ke konsol </font><font style="vertical-align: inherit;">, yang berarti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dikembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_Type</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak sama dengan nilai apa pun di </font><font style="vertical-align: inherit;">cabang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">case</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan kontrol diteruskan ke cabang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Apa yang sebenarnya kita cari. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya juga ingin mencatat bahwa baik dalam komentar pada metode ini, maupun pada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.microsoft.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , diindikasikan bahwa metode tersebut dapat mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 18</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selanjutnya, kami akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memeriksa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beberapa peringatan dari </font><i><font style="vertical-align: inherit;">System.Private.DataContractSerialization</font></i><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CharType</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> None = <span class="hljs-number"><span class="hljs-number">0x00</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> FirstName = <span class="hljs-number"><span class="hljs-number">0x01</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> Name = <span class="hljs-number"><span class="hljs-number">0x02</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> Whitespace = <span class="hljs-number"><span class="hljs-number">0x04</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> Text = <span class="hljs-number"><span class="hljs-number">0x08</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> AttributeText = <span class="hljs-number"><span class="hljs-number">0x10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> SpecialWhitespace = <span class="hljs-number"><span class="hljs-number">0x20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> Comment = <span class="hljs-number"><span class="hljs-number">0x40</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] s_charType = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">256</span></span>] { .... CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* 9 (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace| CharType.Text| CharType.SpecialWhitespace, <span class="hljs-comment"><span class="hljs-comment">/* A (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace| CharType.Text| CharType.SpecialWhitespace, <span class="hljs-comment"><span class="hljs-comment">/* B (.) */</span></span> CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* C (.) */</span></span> CharType.None, <span class="hljs-comment"><span class="hljs-comment">/* D (.) */</span></span> CharType.None| CharType.Comment| CharType.Comment| CharType.Whitespace, <span class="hljs-comment"><span class="hljs-comment">/* E (.) */</span></span> CharType.None, .... };</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3001</a> There are identical sub-expressions 'CharType.Comment' to the left and to the right of the '|'  operator. XmlUTF8TextReader.cs 56 </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3001</a> There are identical sub-expressions 'CharType.Comment' to the left and to the right of the '|'  operator. XmlUTF8TextReader.cs 58 </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">V3001</a> There are identical sub-expressions 'CharType.Comment' to the left and to the right of the '|'  operator. XmlUTF8TextReader.cs 64 </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisa menemukan penggunaan ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CharType.Comment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menjadi curiga </font><i><font style="vertical-align: inherit;">| CharType.Comment</font></i><font style="vertical-align: inherit;"> . Terlihat agak aneh sejak </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(CharType.Comment | CharType.Comment) == CharType.Comment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saat menginisialisasi elemen lain dari array yang menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CharType.Comment</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tidak ada duplikasi seperti itu. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 19</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lanjutan. Mari kita lihat informasi tentang nilai yang dikembalikan dari metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XmlBinaryWriterSession.TryAdd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam deskripsi metode dan pada docs.microsoft.com - " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XmlBinaryWriterSession.TryAdd (XmlDictionaryString, Int32) Metode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ": </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengembalian: true jika string dapat ditambahkan; jika tidak, salah.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang mari kita melihat isi dari metode ini:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TryAdd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">XmlDictionaryString </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key</span></span></span><span class="hljs-function">)</span></span> { IntArray keys; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> System.Runtime .Serialization .DiagnosticUtility .ExceptionUtility .ThrowHelperArgumentNull(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_maps.TryGetValue(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Dictionary, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> keys)) { key = (keys[<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.Key] - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key != <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// If the key is already set, then something is wrong throw System.Runtime .Serialization .DiagnosticUtility .ExceptionUtility .ThrowHelperError( new InvalidOperationException( SR.XmlKeyAlreadyExists)); } key = Add(value.Value); keys[value.Key] = (key + 1); return true; } key = Add(value.Value); keys = AddKeys(value.Dictionary, value.Key + 1); keys[value.Key] = (key + 1); return true; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aneh bahwa metode ini selalu mengembalikan nilai yang sama dan 'benar'. XmlBinaryWriterSession.cs 29 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampaknya aneh bahwa metode ini mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau melempar pengecualian, tetapi </font><font style="vertical-align: inherit;">tidak pernah mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 20 saya</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bertemu kode dengan masalah yang sama, tapi sekarang sebaliknya - selalu mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnHandleReference</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (xmlWriter.depth &lt; depthToCheckCyclicReference) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (canContainCyclicReference) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_byValObjectsInScope.Contains(obj)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> ....; _byValObjectsInScope.Push(obj); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aneh bahwa metode ini selalu mengembalikan satu dan nilai 'false' yang sama. </font><font style="vertical-align: inherit;">XmlObjectSerializerWriteContext.cs 415 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi, kita telah menempuh perjalanan panjang! </font><font style="vertical-align: inherit;">Karena itu, sebelum melanjutkan, saya mengusulkan untuk istirahat sejenak - untuk meregangkan otot Anda, berjalan sedikit, istirahatkan mata Anda, lihat ke luar jendela ...</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/008/d6a/92d/008d6a92d6f4cf4066e744e4c857b47d.png" alt="Gambar 21"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya berharap bahwa pada titik ini Anda lagi penuh energi, jadi mari kita lanjutkan. </font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 21</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat tempat-tempat menarik dalam proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Security.Cryptography.Algorithms</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateMask</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] rgbSeed, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cbReturn</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (HashAlgorithm hasher = (HashAlgorithm)CryptoConfig.CreateFromName(_hashNameValue)) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] rgbCounter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] rgbT = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[cbReturn]; <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ib = <span class="hljs-number"><span class="hljs-number">0</span></span>; ib &lt; rgbT.Length;) { <span class="hljs-comment"><span class="hljs-comment">// Increment counter -- up to 2^32 * sizeof(Hash) Helpers.ConvertIntToByteArray(counter++, rgbCounter); hasher.TransformBlock(rgbSeed, 0, rgbSeed.Length, rgbSeed, 0); hasher.TransformFinalBlock(rgbCounter, 0, 4); byte[] hash = hasher.Hash; hasher.Initialize(); Buffer.BlockCopy(hash, 0, rgbT, ib, Math.Min(rgbT.Length - ib, hash.Length)); ib += hasher.Hash.Length; } return rgbT; } }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan null dereference. Pertimbangkan untuk memeriksa 'hasher'. PKCS1MaskGenerationMethod.cs 37 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisis memperingatkan bahwa ketika mengevaluasi ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasher.TransformBlock,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nilai variabel </font><i><font style="vertical-align: inherit;">hasher</font></i><font style="vertical-align: inherit;"> bisa </font><i><font style="vertical-align: inherit;">nol</font></i><font style="vertical-align: inherit;"> , dalam hal ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dilempar</font></i><font style="vertical-align: inherit;"> . Kemunculan peringatan ini dimungkinkan berkat analisis antar-prosedur. </font><font style="vertical-align: inherit;">Jadi, untuk memahami jika </font><i><font style="vertical-align: inherit;">hasher</font></i><font style="vertical-align: inherit;"> dalam kasus ini bisa </font><i><font style="vertical-align: inherit;">nol</font></i><font style="vertical-align: inherit;"> , Anda harus turun ke metode </font><i><font style="vertical-align: inherit;">CreateFromName</font></i><font style="vertical-align: inherit;"> .</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFromName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CreateFromName(name, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sejauh ini, tidak ada - kita melangkah lebih dalam. </font><font style="vertical-align: inherit;">Tubuh dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> versi overload </font><font style="vertical-align: inherit;">dengan dua parameter cukup besar, jadi saya membawa versi singkat.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateFromName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">params</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (retvalType == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cons == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candidates.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rci == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Delegate).IsAssignableFrom(rci.DeclaringType)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> retval; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang Anda lihat, ada beberapa titik keluar dalam metode di mana </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dikembalikan secara eksplisit </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Oleh karena itu, setidaknya secara teoritis, dalam metode yang disebutkan sebelumnya, di mana peringatan itu dikeluarkan, pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat terjadi </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teori itu baik, tetapi mari kita coba mereproduksi masalah dalam praktik. </font><font style="vertical-align: inherit;">Untuk melakukan ini, lihat lagi metode asli dan catat poin-poin penting. </font><font style="vertical-align: inherit;">Kode yang tidak relevan dari metode ini dapat direduksi.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PKCS1MaskGenerationMethod</span></span> : .... <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 { .... public PKCS1MaskGenerationMethod() // &lt;= 2 { _hashNameValue = DefaultHash; } .... public override byte[] GenerateMask(byte[] rgbSeed, int cbReturn) // &lt;= 3 { using (HashAlgorithm hasher = (HashAlgorithm)CryptoConfig.CreateFromName(_hashNameValue)) // &lt;= 4 { byte[] rgbCounter = new byte[4]; byte[] rgbT = new byte[cbReturn]; // &lt;= 5 uint counter = 0; for (int ib = 0; ib &lt; rgbT.Length;) // &lt;= 6 { .... Helpers.ConvertIntToByteArray(counter++, rgbCounter); // &lt;= 7 hasher.TransformBlock(rgbSeed, 0, rgbSeed.Length, rgbSeed, 0); .... } .... } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita bahas poin-poin penting lebih terinci: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1, 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kelas dan metode memiliki </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengubah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akses </font><i><font style="vertical-align: inherit;">publik</font></i><font style="vertical-align: inherit;"> . Oleh karena itu, antarmuka ini tersedia saat menghubungkan perpustakaan - Anda dapat mencoba mengulangi masalahnya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kelas - contoh non-abstrak, memiliki konstruktor publik - harus mudah untuk membuat contoh yang dengannya kita akan bekerja. Dalam beberapa kasus yang saya teliti, kelasnya abstrak, jadi untuk mengulangi masalah saya masih harus mencari ahli waris dan cara mendapatkannya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak boleh membuang pengecualian dan harus mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - poin terpenting, kami akan kembali lagi nanti. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5, 6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus&gt; 0 (dan, tentu saja, dalam batas yang memadai untuk pembuatan array yang berhasil). </font><font style="vertical-align: inherit;">Pemenuhan kondisi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn&gt; 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperlukan untuk memenuhi kondisi lebih lanjut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ib &lt;rgbT.Panjang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan masukkan loop body. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Helpres.ConvertIntToByteArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus berfungsi tanpa kecuali. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk memenuhi kondisi yang bergantung pada parameter metode, cukup dengan memberikan argumen yang memadai, misalnya:</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbCeed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - byte baru [] {0, 1, 2, 3};</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - 42.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk “berkompromi” dengan metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptoConfig.CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anda harus dapat mengubah nilai bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_hashNameValue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Untungnya bagi kami, itu ada, karena properti wrapper didefinisikan di kelas di atas bidang ini:</font></font><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> HashName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _hashNameValue; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _hashNameValue = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> ?? DefaultHash; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan menetapkan nilai 'sintetis' untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HashName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (lebih tepatnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_hashNameValue</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), Anda bisa mendapatkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di titik pengembalian pertama yang kami tandai. </font><font style="vertical-align: inherit;">Saya tidak akan masuk ke rincian parsing metode ini (saya harap Anda akan memaafkan saya untuk ini), karena ini cukup lama. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akibatnya, kode yang akan membuang pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin terlihat seperti ini:</font></font><br><br><pre> <code class="cs hljs">PKCS1MaskGenerationMethod tempObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PKCS1MaskGenerationMethod(); tempObj.HashName = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span>; tempObj.GenerateMask(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] { <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> }, <span class="hljs-number"><span class="hljs-number">42</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami menghubungkan perpustakaan debug ke proyek, menjalankannya dan mendapatkan hasil yang diharapkan: </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ab/384/8e5/2ab3848e542172cd92a7e03f55bba9fe.png" alt="Gambar 10"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Demi kepentingan, saya mencoba untuk mengeksekusi kode yang sama pada paket NuGet versi 4.3.1. </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b4/a94/766/7b4a947666444496ca077e7530415c76.png" alt="Gambar 14"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informasi tentang pengecualian yang dihasilkan, batasan pada parameter output dalam deskripsi metode, tidak dijelaskan pada docs.microsoft.com - " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PKCS1MaskGenerationMethod.GenerateMask (Byte [], Int32) Method</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ngomong-ngomong, sudah selama penulisan artikel dan deskripsi dari urutan pemutaran masalah, saya menemukan 2 cara lagi untuk "memecah" metode ini:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berikan </font><font style="vertical-align: inherit;">nilai terlalu besar </font><font style="vertical-align: inherit;">sebagai argumen ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cbReturn</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lulus sebagai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbSeed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kasus pertama, kami mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OutOfMemoryException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c50/474/7f9/c504747f9a771843da10a128866811dd.png" alt="Gambar 15"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kasus kedua, kita mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ketika ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbSeed.Length dieksekusi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dalam hal ini, penting bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasher memiliki</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nilai bukan nol, jika tidak, utas eksekusi tidak akan mencapai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rgbSeed</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><i><font style="vertical-align: inherit;">Panjang</font></i><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 22</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bertemu pasangan lebih banyak tempat yang serupa.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SignatureDescription</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FormatterAlgorithm { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> DeformatterAlgorithm { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SignatureDescription</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> AsymmetricSignatureDeformatter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDeformatter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> AsymmetricAlgorithm key</span></span></span><span class="hljs-function">)</span></span> { AsymmetricSignatureDeformatter item = (AsymmetricSignatureDeformatter) CryptoConfig.CreateFromName(DeformatterAlgorithm); item.SetKey(key); <span class="hljs-comment"><span class="hljs-comment">// &lt;= return item; } public virtual AsymmetricSignatureFormatter CreateFormatter( AsymmetricAlgorithm key) { AsymmetricSignatureFormatter item = (AsymmetricSignatureFormatter) CryptoConfig.CreateFromName(FormatterAlgorithm); item.SetKey(key); // &lt;= return item; } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan null dereference. </font><font style="vertical-align: inherit;">Pertimbangkan untuk memeriksa 'item'. </font><font style="vertical-align: inherit;">SignatureDescription.cs 31</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan null dereference. </font><font style="vertical-align: inherit;">Pertimbangkan untuk memeriksa 'item'. </font><font style="vertical-align: inherit;">SignatureDescription.cs 38</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekali lagi, kita bisa menulis </font><font style="vertical-align: inherit;">nilai ke properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FormatterAlgorithm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DeformatterAlgorithm</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang mana metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CryptoConfig.CreateFromName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateDeformatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFormatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Selanjutnya, saat memanggil metode instance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SetKey, NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dibuang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Masalahnya, sekali lagi, mudah direproduksi dalam praktik:</font></font><br><br><pre> <code class="cs hljs">SignatureDescription signature = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SignatureDescription() { DeformatterAlgorithm = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span>, FormatterAlgorithm = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span> }; signature.CreateDeformatter(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-comment"><span class="hljs-comment">// NRE signature.CreateFormatter(null); // NRE</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam hal ini, saat memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateDeformatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan saat memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateFormatter,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException dilemparkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 23</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat tempat-tempat menarik dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Private.Xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteBase64</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] buffer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_inAttr &amp;&amp; (_inCDataSection || StartCDataSection())) _wrapped.WriteBase64(buffer, index, count); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> _wrapped.WriteBase64(buffer, index, count); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3004</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pernyataan 'then' setara dengan pernyataan 'else'. </font><font style="vertical-align: inherit;">QueryOutputWriterV1.cs 242 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terlihat aneh bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kemudian</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lain</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Operator cabang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengandung kode yang sama. </font><font style="vertical-align: inherit;">Entah ada kesalahan dan tindakan lain seharusnya di salah satu cabang, atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bisa dihilangkan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 24</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Depends</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">XmlSchemaObject item, ArrayList refs</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> XmlSchemaSimpleTypeRestriction) { baseType = ((XmlSchemaSimpleTypeRestriction)content).BaseType; baseName = ((XmlSchemaSimpleTypeRestriction)content).BaseTypeName; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> XmlSchemaSimpleTypeList) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> XmlSchemaSimpleTypeRestriction) { baseName = ((XmlSchemaSimpleTypeRestriction)content).BaseTypeName; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(XmlSchemaSimpleTypeUnion)) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3003</font></a><font style="vertical-align: inherit;"> Penggunaan </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">pola</font></a><font style="vertical-align: inherit;"> 'if (A) {...} else if (A) {...}' terdeteksi. </font><font style="vertical-align: inherit;">Ada kemungkinan kehadiran kesalahan logis. </font><font style="vertical-align: inherit;">Periksa baris: 381, 396. ImportContext.cs 381 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Urutan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if-else-if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memiliki dua ekspresi kondisional yang identik - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konten adalah XmlSchemaSimpleTypeRestriction</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Yang lebih menarik - tubuh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maka</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -branches dari operator yang sesuai mengandung yang berbeda ekspresi. </font><font style="vertical-align: inherit;">Dengan satu atau lain cara, tubuh </font><font style="vertical-align: inherit;">cabang </font><font style="vertical-align: inherit;">pertama yang bersesuaian </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kemudian</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dieksekusi </font><font style="vertical-align: inherit;">(jika ekspresi kondisional benar), atau tidak satu atau yang lain jika ekspresi yang sesuai salah. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 25</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Untuk membuatnya lebih menarik untuk mencari kesalahan dalam metode berikut, saya membawa seluruh tubuhnya. </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchesXmlType</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IList&lt;XPathItem&gt; seq, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> indexType</span></span></span><span class="hljs-function">)</span></span> { XmlQueryType typBase = GetXmlType(indexType); XmlQueryCardinality card; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (seq.Count) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: card = XmlQueryCardinality.Zero; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: card = XmlQueryCardinality.One; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: card = XmlQueryCardinality.More; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(card &lt;= typBase.Cardinality)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; typBase = typBase.Prime; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; seq.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!CreateXmlType(seq[<span class="hljs-number"><span class="hljs-number">0</span></span>]).IsSubtypeOf(typBase)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda berhasil, selamat! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika tidak, peringatan PVS-Studio akan membantu: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3102</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Akses mencurigakan ke elemen objek 'seq' dengan indeks konstan di dalam sebuah loop. XmlQueryRuntime.cs 738 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> loop dijalankan </font><font style="vertical-align: inherit;">, menggunakan ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i &lt;seq.Count</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sebagai kondisi keluar </font><font style="vertical-align: inherit;">. Menyarankan bahwa mereka ingin memotong urutan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tetapi hanya dalam loop mereka mengakses elemen-elemen dari urutan tidak menggunakan penghitung ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq [i]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), tetapi menggunakan literal numerik - nol ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq [0]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 26</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kesalahan berikut cocok dalam sepotong kecil kode, tetapi karena itu tidak kalah menarik.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { WriteValue(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3110</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan rekursi tak terbatas di dalam metode 'WriteValue'. XmlAttributeCache.cs 166 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode ini memanggil dirinya sendiri, sehingga membentuk rekursi tanpa syarat untuk keluar. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 27</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IList&lt;XPathNavigator&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DocOrderDistinct</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IList&lt;XPathNavigator&gt; seq</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (seq.Count &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> seq; XmlQueryNodeSequence nodeSeq = (XmlQueryNodeSequence)seq; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nodeSeq == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) nodeSeq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XmlQueryNodeSequence(seq); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nodeSeq.DocOrderDistinct(_docOrderCmp); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'seq' digunakan sebelum diverifikasi dengan null. Periksa baris: 880, 884. XmlQueryRuntime.cs 880 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagai argumen, metode ini dapat </font><font style="vertical-align: inherit;">menerima </font><font style="vertical-align: inherit;">nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itulah sebabnya ketika memanggil properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Count</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dibuang</font></i><font style="vertical-align: inherit;"> . Di bawah ini kami memeriksa variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodeSeq yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diperoleh sebagai hasil dari pengecoran </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secara eksplisit </font><font style="vertical-align: inherit;">, tetapi mengapa ada tidak begitu jelas. Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , utas tidak akan mencapai pemeriksaan ini karena pengecualian. Jika nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bukan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidCastException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dilemparkan</font></i><font style="vertical-align: inherit;"> jika para pemain gagal;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika pemeran berhasil, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nodeSeq</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pasti memiliki nilai selain </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 28</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Met 4 desainer di mana ada parameter yang tidak digunakan. </font><font style="vertical-align: inherit;">Mereka mungkin dibiarkan kompatibilitas, tetapi saya belum menemukan komentar mengenai parameter yang tidak digunakan ini. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Constructor </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3117</font></a><font style="vertical-align: inherit;"> 'securityUrl' tidak digunakan. </font><font style="vertical-align: inherit;">XmlSecureResolver.cs 15</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konstruktor 'strdata' V3117 tidak digunakan. </font><font style="vertical-align: inherit;">XmlEntity.cs 18</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Lokasi' parameter konstruktor </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3117</font></a><font style="vertical-align: inherit;"> tidak digunakan. </font><font style="vertical-align: inherit;">Compilation.cs 58</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'Akses' parameter konstruktor </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3117</font></a><font style="vertical-align: inherit;"> tidak digunakan. </font><font style="vertical-align: inherit;">XmlSerializationILGen.cs 38</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Yang pertama paling menarik minat saya (setidaknya dia yang saya tulis di daftar peringatan untuk artikel). </font></font> Apa?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak yakin </font><font style="vertical-align: inherit;">Mungkin namanya.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">XmlSecureResolver</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">XmlResolver resolver, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> securityUrl</span></span></span><span class="hljs-function">)</span></span> { _resolver = resolver; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demi menarik, saya pergi untuk melihat apa yang mereka tulis di docs.microsoft.com - " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XmlSecureResolver Constructors</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " tentang parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">securityUrl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL yang digunakan untuk membuat PermissionSet yang akan diterapkan pada XmlResolver yang mendasarinya. XmlSecureResolver memanggil PermitOnly () pada PermissionSet yang dibuat sebelum memanggil GetEntity (Uri, String, Type) pada XmlResolver yang mendasarinya. </font></font></i> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 29</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dalam paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Private.Uri,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saya menemukan metode yang menimbulkan sedikit konflik dengan pedoman Microsoft untuk mengganti metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ingat kembali salah satu tips dari halaman </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object.ToString Method</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">Override </font></a></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString Anda () seharusnya tidak memberikan pengecualian</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Metode yang diganti sendiri terlihat seperti ini: </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_username.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; _password.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UriFormatException(SR.net_uri_BadUserPassword); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3108</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak disarankan untuk melempar pengecualian dari metode 'ToSting ()'. </font><font style="vertical-align: inherit;">UriBuilder.cs 406 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode yang </font><font style="vertical-align: inherit;">menetapkan </font><font style="vertical-align: inherit;">string kosong untuk bidang </font><i><font style="vertical-align: inherit;">_username</font></i><font style="vertical-align: inherit;"> dan </font><font style="vertical-align: inherit;">baris </font><font style="vertical-align: inherit;">tidak </font><font style="vertical-align: inherit;">kosong untuk </font><font style="vertical-align: inherit;">bidang </font><i><font style="vertical-align: inherit;">_password </font></i><i><font style="vertical-align: inherit;">,</font></i><font style="vertical-align: inherit;"> masing-masing, </font><font style="vertical-align: inherit;">melalui properti publik </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kata Sandi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan kemudian </font><i><font style="vertical-align: inherit;">memanggil</font></i><font style="vertical-align: inherit;"> metode </font><i><font style="vertical-align: inherit;">ToString</font></i><font style="vertical-align: inherit;"> , akan mendapatkan pengecualian. </font><font style="vertical-align: inherit;">Contoh kode seperti itu:</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs">UriBuilder uriBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UriBuilder() { UserName = String.Empty, Password = <span class="hljs-string"><span class="hljs-string">"Dummy"</span></span> }; String stringRepresentation = uriBuilder.ToString(); Console.WriteLine(stringRepresentation);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi dalam kasus ini, para pengembang dengan jujur ​​memperingatkan bahwa pengecualian dapat dilemparkan ketika dipanggil - ini dijelaskan baik dalam komentar pada metode dan pada docs.microsoft.com - " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UriBuilder.ToString Method</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 30</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lihatlah peringatan yang dikeluarkan pada kode proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Data.Common</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ArrayList _tables; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ns</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_tables.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (DataTable)_tables[<span class="hljs-number"><span class="hljs-number">0</span></span>]; .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3106</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan indeks di luar batas. </font><font style="vertical-align: inherit;">Indeks '0' menunjuk di luar batas '_tables'. </font><font style="vertical-align: inherit;">XMLDiffLoader.cs 277 Apakah </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode ini terlihat tidak biasa? </font><font style="vertical-align: inherit;">Menurutmu ini apa? </font><font style="vertical-align: inherit;">Cara yang bagus untuk melempar pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentOutOfRangeException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">Saya mungkin tidak akan terkejut dengan pendekatan ini. </font><font style="vertical-align: inherit;">Secara umum, kode ini aneh dan mencurigakan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 31</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> XmlNodeOrder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComparePosition</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">XPathNodePointer other</span></span></span><span class="hljs-function">)</span></span> { RealFoliate(); other.RealFoliate(); Debug.Assert(other != <span class="hljs-literal"><span class="hljs-literal">null</span></span>); .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'lain' digunakan sebelum diverifikasi terhadap nol. Periksa baris: 1095, 1096. XPathNodePointer.cs 1095 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expression </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lain = null!</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sebagai argumen untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug.Assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jelas petunjuk bahwa sebagai argumen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ComparePosition</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bisa mendapatkan nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setidaknya, mereka ingin menangkap kasus seperti itu. Tetapi pada saat yang sama, baris di atas yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lain</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memanggil metode instance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RealFoliate</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Akibatnya, jika yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lain</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pengecualian tipe </font><i><font style="vertical-align: inherit;">NullReferenceException</font></i><font style="vertical-align: inherit;"> akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dibuang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebelum memeriksa melalui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 32</font></font></b> <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> PropertyDescriptorCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetProperties</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Attribute[] attributes</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (Attribute attribute <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> attributes) { Attribute attr = property.Attributes[attribute.GetType()]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (attr == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !attribute.IsDefaultAttribute()) || !attr.Match(attribute)) { match = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3080</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan null dereference. </font><font style="vertical-align: inherit;">Pertimbangkan untuk memeriksa 'attr'. </font><font style="vertical-align: inherit;">DbConnectionStringBuilder.cs 534 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ekspresi bersyarat pernyataan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terlihat agak mencurigakan. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Match</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah metode instan. </font><font style="vertical-align: inherit;">Menilai dengan memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attr == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah nilai yang valid (diharapkan) untuk variabel ini. </font><font style="vertical-align: inherit;">Oleh karena itu, jika utas eksekusi mencapai operan yang tepat dari operator || </font><font style="vertical-align: inherit;">asalkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attr</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kita mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan demikian, ketentuan pengecualian adalah sebagai berikut:</font></font><br><br><ol><li>  <i>attr</i> — <i>null</i> .     &amp;&amp;. </li><li>  <i>!attribute.IsDefaultAttribute()</i> — <i>false</i> .      &amp;&amp; — <i>false</i> . </li><li>      ||   <i>false</i> ,   . </li><li>   <i>attr</i> — <i>null</i> ,    <i>Match</i>  . </li></ol><br> <b>Issue 33</b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadOldRowData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> DataSet ds, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> DataTable table, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pos, XmlReader row</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (table == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { row.Skip(); <span class="hljs-comment"><span class="hljs-comment">// need to skip this element if we dont know about it, // before returning -1 return -1; } .... if (table == null) throw ExceptionBuilder.DiffgramMissingTable( XmlConvert.DecodeName(row.LocalName)); .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3021</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ada dua pernyataan 'jika' dengan ekspresi kondisional yang identik. Pernyataan 'jika' pertama berisi pengembalian metode. Ini berarti bahwa pernyataan 'jika' yang kedua adalah XMLDiffLoader.cs 301 yang tidak masuk akal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada dua </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang berisi ekspresi kondisional yang sama - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tabel == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Selain itu, kemudian cabang dari operator ini berisi tindakan yang berbeda - dalam satu kasus, metode ini keluar dengan nilai -1, di kedua, pengecualian dilemparkan. Di antara pemeriksaan, variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tabel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak berubah. Karenanya, pengecualian yang dimaksud tidak akan dibuang. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 34</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lihatlah metode yang menarik dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.ComponentModel.TypeConverter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Lebih tepatnya, pertama lihat komentar yang menggambarkannya: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menghapus karakter terakhir dari string yang diformat. (Hapus karakter terakhir dalam string virtual). Saat keluar, param keluar berisi posisi di mana operasi sebenarnya dilakukan. Posisi ini relatif terhadap string uji. Parameter MaskedTextResultHint out memberikan informasi lebih lanjut tentang hasil operasi. Mengembalikan nilai </font></font></i> <b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada kesuksesan, </font></font></i> <b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></i></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sebaliknya.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Poin kunci tentang nilai kembali: jika operasi berhasil, metode mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jika tidak </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">palsu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Mari kita lihat apa yang sebenarnya terjadi.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Remove</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> testPosition, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> MaskedTextResultHint resultHint</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (lastAssignedPos == INVALID_INDEX) { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// nothing to remove. } .... return true; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aneh bahwa metode ini selalu mengembalikan nilai yang sama dan 'benar'. MaskedTextProvider.cs 1529 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, ternyata satu-satunya nilai pengembalian metode ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 35</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_table != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_table.fInitInProgress &amp;&amp; _delayLoadingConstraints != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '_table' digunakan setelah diverifikasi dengan null. Periksa baris: 437, 423. ConstraintCollection.cs 437 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table! = Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berbicara sendiri - variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bisa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setidaknya dalam kasus ini, direasuransikan. Namun, di bawah ini mereka mengakses bidang instance melalui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tanpa memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_table .fInitInProgress</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 36</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang, mari kita lihat beberapa peringatan yang dikeluarkan pada kode proyek untuk proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.Serialization.Formatters</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (memberNameInfo != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... _serWriter.WriteObjectEnd(memberNameInfo, typeNameInfo); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((objectInfo._objectId == _topId) &amp;&amp; (_topName != <span class="hljs-literal"><span class="hljs-literal">null</span></span>)) { _serWriter.WriteObjectEnd(topNameInfo, typeNameInfo); .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ReferenceEquals(objectInfo._objectType, Converter.s_typeofString)) { _serWriter.WriteObjectEnd(typeNameInfo, typeNameInfo); } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3038</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Argumen dilewatkan ke metode beberapa kali. </font><font style="vertical-align: inherit;">Ada kemungkinan bahwa argumen lain harus disahkan. </font><font style="vertical-align: inherit;">BinaryObjectWriter.cs 262 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisis bingung panggilan terakhir ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_serWriter.WriteObjectEnd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan dua argumen yang identik - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typeNameInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tampaknya seperti kesalahan ketik, tetapi tentu saja tidak bisa dikatakan. </font><font style="vertical-align: inherit;">Saya memutuskan untuk melihat apa yang disebut metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WriteObjectEnd</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteObjectEnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">NameInfo memberNameInfo, NameInfo typeNameInfo</span></span></span><span class="hljs-function">)</span></span> { }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Baiklah ... lanjutkan. </font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 37</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteSerializationHeader</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> headerId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> minorVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> majorVersion</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> record = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerializationHeaderRecord( BinaryHeaderEnum.SerializedStreamHeader, topId, headerId, minorVersion, majorVersion); record.Write(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Melihat kode ini, Anda tidak akan langsung mengatakan bahwa itu salah di sini atau terlihat mencurigakan. Tetapi penganalisa itu mungkin mengatakan bahwa itu mengingatkannya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3066</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan urutan argumen yang salah diteruskan ke konstruktor 'SerializationHeaderRecord': 'minorVersion' dan 'majorVersion'. BinaryFormatterWriter.cs 111 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita lihat konstruktor dari kelas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerializationHeaderRecord</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> yang dipanggil </font><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SerializationHeaderRecord</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> BinaryHeaderEnum binaryHeaderEnum, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> topId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> headerId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> majorVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> minorVersion</span></span></span><span class="hljs-function">)</span></span> { _binaryHeaderEnum = binaryHeaderEnum; _topId = topId; _headerId = headerId; _majorVersion = majorVersion; _minorVersion = minorVersion; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang Anda lihat, parameter konstruktor mengikuti urutan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">majorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; ketika memanggil konstruktor, mereka ditransfer dalam urutan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">majorVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kedengarannya seperti kesalahan ketik. Jika ini direncanakan (dan tiba-tiba?) - Saya pikir komentar penjelasan harus dibiarkan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 38</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ObjectManager</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> ISurrogateSelector selector, StreamingContext context, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> checkSecurity, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isCrossAppDomain</span></span></span><span class="hljs-function">)</span></span> { _objects = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectHolder[DefaultInitialSize]; _selector = selector; _context = context; _isCrossAppDomain = isCrossAppDomain; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konstruktor 'checkSecurity' V3117 tidak digunakan. </font><font style="vertical-align: inherit;">ObjectManager.cs 33 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter konstruktor </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">checkSecurity</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak digunakan dengan cara apa pun. </font><font style="vertical-align: inherit;">Tidak ada komentar tentang itu. </font><font style="vertical-align: inherit;">Saya akan berasumsi bahwa itu dibiarkan untuk kompatibilitas, tetapi satu atau lain cara, dalam konteks diskusi tentang keamanan dalam beberapa tahun terakhir, ini terlihat menarik. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 39</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode lain muncul yang sepertinya tidak biasa bagi saya. </font><font style="vertical-align: inherit;">Pola terlihat 1 dalam 1 dalam ketiga kasus yang terdeteksi dan ditemukan dalam metode dengan nama dan nama variabel yang sama. </font><font style="vertical-align: inherit;">Oleh karena itu:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entah saya tidak cukup tercerahkan dan tidak mengerti arti duplikasi seperti itu; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> baik kesalahan disebarkan melalui kode menggunakan metode salin-tempel. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode itu sendiri: </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnlargeArray</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newLength = _values.Length * <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newLength &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newLength == <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerializationException(SR.Serialization_TooManyElements); } newLength = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue; } FixupHolder[] temp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FixupHolder[newLength]; Array.Copy(_values, <span class="hljs-number"><span class="hljs-number">0</span></span>, temp, <span class="hljs-number"><span class="hljs-number">0</span></span>, _count); _values = temp; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ekspresi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'newLength == int.MaxValue' selalu salah. </font><font style="vertical-align: inherit;">ObjectManager.cs 1423</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ekspresi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'newLength == int.MaxValue' selalu salah. </font><font style="vertical-align: inherit;">ObjectManager.cs 1511</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ekspresi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'newLength == int.MaxValue' selalu salah. </font><font style="vertical-align: inherit;">ObjectManager.cs 1558</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua yang berbeda dalam metode lain adalah tipe elemen dari array </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">temp</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (bukan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FixupHolder</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panjang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">objek</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Jadi saya masih memiliki kecurigaan tentang copy-paste ... </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 40</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Data.Odbc</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnquoteIdentifier</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(quotePrefix) || quotePrefix != <span class="hljs-string"><span class="hljs-string">" "</span></span>) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">Ekspresi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> '! String.IsNullOrEmpty (quotePrefix) || quotePrefix! = "" 'selalu benar. OdbcCommandBuilder.cs 338 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer menganggap bahwa ungkapan di atas selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dan memang benar. Dan tidak masalah nilai apa yang terkandung </font><font style="vertical-align: inherit;">dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - kondisi itu sendiri tidak ditulis dengan benar. Mari kita perbaiki. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memiliki operator ||, oleh karena itu, nilai ekspresi akan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika operan kiri atau kanan (atau keduanya) </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Semuanya jelas dengan kiri. Operan kanan hanya akan dievaluasi jika operan kiri </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Oleh karena itu, jika ekspresi dikomposisikan sehingga nilai operan kanan selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ketika nilai kiri </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hasil dari seluruh ekspresi akan selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari kode di atas, kita tahu bahwa jika operan yang tepat dihitung, maka nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string.IsNullOrEmpty (quotePrefix)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oleh karena itu, salah satu pernyataan </font><font style="vertical-align: inherit;">itu </font><i><font style="vertical-align: inherit;">benar</font></i><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix.Length == 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika salah satu dari pernyataan ini benar, ungkapan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix! = ""</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Akan juga benar </font><font style="vertical-align: inherit;">, yang ingin kami buktikan. Oleh karena itu, nilai seluruh ekspresi selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , terlepas dari konten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quotePrefix</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 41</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kembali ke percakapan tentang konstruktor dengan parameter yang tidak digunakan:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PendingGetConnection</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PendingGetConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dueTime, DbConnection owner, TaskCompletionSource&lt;DbConnectionInternal&gt; completion, DbConnectionOptions userOptions</span></span></span><span class="hljs-function">)</span></span> { DueTime = dueTime; Owner = owner; Completion = completion; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> DueTime { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbConnection Owner { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TaskCompletionSource&lt;DbConnectionInternal&gt; Completion { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbConnectionOptions UserOptions { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3117</font></a><font style="vertical-align: inherit;"> Parameter konstruktor 'userOptions' tidak digunakan. </font><font style="vertical-align: inherit;">DbConnectionPool.cs 26 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari kode analisa dan peringatan, jelas bahwa hanya satu parameter konstruktor yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><i><font style="vertical-align: inherit;">userOptions</font></i><font style="vertical-align: inherit;"> , sementara yang lain digunakan untuk menginisialisasi properti dengan nama yang sama. </font><font style="vertical-align: inherit;">Sepertinya mereka lupa menginisialisasi salah satu properti. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 42</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ada kode mencurigakan yang bertemu dalam proyek ini 2 kali. </font><font style="vertical-align: inherit;">Polanya sama.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExecuteCommand</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (DataRow row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> schemaTable.Rows) { resultTable.Columns .Add(row[<span class="hljs-string"><span class="hljs-string">"ColumnName"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, (Type)row[<span class="hljs-string"><span class="hljs-string">"DataType"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Type); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemain tipe berlebihan. </font><font style="vertical-align: inherit;">Objek sudah dari tipe 'Type'. </font><font style="vertical-align: inherit;">DbMetaDataFactory.cs 176</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemain tipe berlebihan. </font><font style="vertical-align: inherit;">Objek sudah dari tipe 'Type'. </font><font style="vertical-align: inherit;">OdbcMetaDataFactory.cs 1109</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Tipe) baris ["Tipe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Data </font><i><font style="vertical-align: inherit;">"] sebagai Tipe</font></i><font style="vertical-align: inherit;"> tampak mencurigakan </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pemain yang eksplisit akan dilakukan terlebih dahulu, kemudian pemain melalui operator </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baris ["DataType"]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu akan berhasil melewati kedua gips dan pergi sebagai argumen ke metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambahkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">baris ["DataType"]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan nilai yang tidak dapat dilemparkan ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pemain eksplisit akan melempar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidCastException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pada akhirnya, mengapa ada dua hantu?</font></font> Pertanyaannya terbuka. <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 43</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat potongan yang mencurigakan dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.InteropServices.RuntimeInformation</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FrameworkDescription { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s_frameworkDescription == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> versionString = (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)AppContext.GetData(<span class="hljs-string"><span class="hljs-string">"FX_PRODUCT_VERSION"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (versionString == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... versionString = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>).Assembly .GetCustomAttribute&lt; AssemblyInformationalVersionAttribute&gt;() ?.InformationalVersion; .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> plusIndex = versionString.IndexOf(<span class="hljs-string"><span class="hljs-string">'+'</span></span>); .... } .... } .... } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3105 Variabel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'versiString' digunakan setelah ditugaskan melalui operator kondisional nol. NullReferenceException dimungkinkan. RuntimeInformation.cs 29 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisis memperingatkan tentang kemungkinan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ketika metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dipanggil </font><font style="vertical-align: inherit;">untuk variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versiString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saat mengambil nilai untuk variabel, pembuat kode menggunakan Operator '?' Untuk tidak mendapatkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ketika mengakses properti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InfromationalVersion</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Leluconnya adalah jika panggilan ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetCustomAttribute &lt;...&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pengecualian masih akan dilempar, tetapi lebih rendah - saat memanggil metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexOf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versiString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan menjadi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 44</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami beralih ke proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.ComponentModel.Composition</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan melihat beberapa peringatan. </font><font style="vertical-align: inherit;">Segera 2 peringatan dikeluarkan untuk kode berikut:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CanSpecialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] genericParameterConstraints = ....; GenericParameterAttributes[] genericParameterAttributes = ....; <span class="hljs-comment"><span class="hljs-comment">// if no constraints and attributes been specifed, anything can be created if ((genericParameterConstraints == null) &amp;&amp; (genericParameterAttributes == null)) { return true; } if ((genericParameterConstraints != null) &amp;&amp; (genericParameterConstraints.Length != partArity)) { return false; } if ((genericParameterAttributes != null) &amp;&amp; (genericParameterAttributes.Length != partArity)) { return false; } for (int i = 0; i &lt; partArity; i++) { if (!GenericServices.CanSpecialize( specialization[i], (genericParameterConstraints[i] as Type[]). CreateTypeSpecializations(specialization), genericParameterAttributes[i])) { return false; } } return true; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'genericParameterConstraints' digunakan setelah diverifikasi terhadap nol. </font><font style="vertical-align: inherit;">Periksa baris: 603, 589. GenericSpecializationPartCreationInfo.cs 603</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'genericParameterAttributes' digunakan setelah diverifikasi terhadap null. </font><font style="vertical-align: inherit;">Periksa baris: 604, 594. GenericSpecializationPartCreationInfo.cs 604</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genericParameterAttributes! = Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">genericParameterConstraints! = Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memeriksa kode </font><font style="vertical-align: inherit;">. Oleh karena itu, nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -valid untuk variabel-variabel ini, kami memperhitungkan. Jika kedua variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , keluar dari metode - tidak ada pertanyaan. Tetapi bagaimana jika ada variabel yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi metode ini tidak keluar? Jika keadaan seperti itu dimungkinkan, dan eksekusi mencapai loop, kami mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 45</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita lihat peringatan menarik lainnya dari proyek yang sama. </font><font style="vertical-align: inherit;">Dan meskipun, mari kita lakukan secara berbeda - pertama kita menggunakan kelas lagi, dan kemudian melihat kodenya. </font><font style="vertical-align: inherit;">Kami akan menghubungkan paket NuGet dari versi pra-rilis terakhir yang tersedia ke proyek (saya menginstal versi paket 4.6.0-preview6.19303.8). </font><font style="vertical-align: inherit;">Mari kita menulis kode sederhana, misalnya, ini:</font></font><br><br><pre> <code class="cs hljs">LazyMemberInfo lazyMemberInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LazyMemberInfo(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eq = lazyMemberInfo.Equals(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); Console.WriteLine(eq);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak dikomentari, di docs.microsoft.com Saya tidak menemukan deskripsi metode ini untuk .NET Core, hanya untuk .NET Framework. </font><font style="vertical-align: inherit;">Jika Anda melihatnya (" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LazyMemberInfo.Equals (Object) Method</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ") - tidak ada yang tidak terlihat - mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tidak ada informasi tentang pengecualian yang dihasilkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menjalankan kode untuk eksekusi dan melihat:</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e5/8f7/aa4/8e58f7aa4e5a274751cde57da4d9497f.png" alt="Gambar 16"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kita bisa memutarbalikkan sedikit, menulis kode berikut dan juga mendapatkan kesimpulan yang menarik: </font></font><br><br><pre> <code class="cs hljs">LazyMemberInfo lazyMemberInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LazyMemberInfo(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eq = lazyMemberInfo.Equals(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(String)); Console.WriteLine(eq);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hasil eksekusi kode. </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e74/199/292/e74199292d39b2df8a7b205218c9c1fe.png" alt="Gambar 17"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menariknya, kedua pengecualian ini dihasilkan dalam ekspresi yang sama. </font><font style="vertical-align: inherit;">Mari kita lihat ke dalam metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { LazyMemberInfo that = (LazyMemberInfo)obj; <span class="hljs-comment"><span class="hljs-comment">// Difefrent member types mean different members if (_memberType != that._memberType) { return false; } // if any of the lazy memebers create accessors in a delay-loaded fashion, // we simply compare the creators if ((_accessorsCreator != null) || (that._accessorsCreator != null)) { return object.Equals(_accessorsCreator, that._accessorsCreator); } // we are dealing with explicitly passed accessors in both cases if(_accessors == null || that._accessors == null) { throw new Exception(SR.Diagnostic_InternalExceptionMessage); } return _accessors.SequenceEqual(that._accessors); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3115</font></a><font style="vertical-align: inherit;"> Melewati </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">metode</font></a><font style="vertical-align: inherit;"> 'null' ke 'Equals' tidak boleh menghasilkan 'NullReferenceException'. LazyMemberInfo.cs 116 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, di sini analis memberikan sedikit ayunan, karena mengeluarkan peringatan pada ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that._memberType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pengecualian, bagaimanapun, terjadi di atas - ketika menjalankan ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(LazyMemberInfo) obj</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Sudah diperhatikan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidCastException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , saya pikir semuanya jelas. Mengapa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException dimunculkan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? Faktanya adalah bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LazyMemberInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah struktur, oleh karena itu, pembongkaran dilakukan. Dan membongkar nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hanya mengarah ke pengecualian tipe</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nah, inilah beberapa kesalahan ketik dalam komentar juga, yang juga dapat diperbaiki pada saat yang sama. </font><font style="vertical-align: inherit;">Yah, pelontaran eksplisit pengecualian juga tetap pada hati nurani penulis. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 46</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sesuatu yang serupa, by the way, ditemukan di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Drawing.Common</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dalam struktur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TriState</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Equals</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> o</span></span></span><span class="hljs-function">)</span></span> { TriState state = (TriState)o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _value == state._value; }</code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3115</font></a><font style="vertical-align: inherit;"> Melewati </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">metode</font></a><font style="vertical-align: inherit;"> 'null' ke 'Equals' tidak boleh menghasilkan 'NullReferenceException'. </font><font style="vertical-align: inherit;">TriState.cs 53 Masalahnya </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sama seperti dalam kasus yang dijelaskan di atas. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 47</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pertimbangkan beberapa cuplikan dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Text.Json</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingat, kami mengatakan bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak boleh mengembalikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font><font style="vertical-align: inherit;">Kencangkan.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (TokenType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.None: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.Null: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.True: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>.TrueString; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.False: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>.FalseString; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.Number: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.StartArray: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> JsonTokenType.StartObject: { <span class="hljs-comment"><span class="hljs-comment">// null parent should have hit the None case Debug.Assert(_parent != null); return _parent.GetRawValueAsString(_idx); } case JsonTokenType.String: return GetString(); case JsonTokenType.Comment: case JsonTokenType.EndArray: case JsonTokenType.EndObject: default: Debug.Fail($"No handler for {nameof(JsonTokenType)}.{TokenType}"); return string.Empty; } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada pandangan pertama, metode ini adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan tidak kembali, tetapi penganalisa mengklaim sebaliknya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3108</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak disarankan untuk mengembalikan 'null' dari metode 'ToSting ()'. </font><font style="vertical-align: inherit;">JsonElement.cs 1460 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer menunjuk ke garis dengan panggilan ke metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetString ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Mari kita melihatnya:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { CheckValidInstance(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _parent.GetString(_idx, JsonTokenType.String); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyelam lebih dalam - ke versi metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetString yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kelebihan beban </font><font style="vertical-align: inherit;">:</font></font><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, JsonTokenType expectedType</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tokenType == JsonTokenType.Null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan di sini kita sudah melihat kondisi di mana </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dikembalikan </font><font style="vertical-align: inherit;">- baik dari metode ini dan dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToString yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> awalnya dianggap </font><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 48</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tempat menarik lainnya:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> JsonPropertyInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreatePolymorphicProperty</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { JsonPropertyInfo runtimeProperty = CreateProperty(property.DeclaredPropertyType, runtimePropertyType, property.ImplementedPropertyType, property?.PropertyInfo, Type, options); property.CopyRuntimeSettingsTo(runtimeProperty); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> runtimeProperty; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3042</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemungkinan NullReferenceException. '?.' dan '.' operator digunakan untuk mengakses anggota objek 'properti' JsonClassInfo.AddProperty.cs 179 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat memanggil metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CreateProperty</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">mereka mengakses properti beberapa kali melalui </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properti</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variabel </font><font style="vertical-align: inherit;">: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property.DeclaredPropertyType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">property.ImplementedPropertyType</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properti? .PropertyInfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Seperti yang Anda lihat, dalam satu kasus mereka menggunakan Operator '?.' Jika tidak berlebihan di sini dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">properti</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bisa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , operator ini tidak akan membantu dengan cara apa pun, karena dengan akses langsung pengecualian dari jenis akan dihasilkan</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 49</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lokasi mencurigakan berikut ditemukan dalam proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Security.Cryptography.Xml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan mereka berpasangan, seperti yang terjadi beberapa kali dengan peringatan lainnya. </font><font style="vertical-align: inherit;">Kode ini terlihat seperti salin-tempel lagi, bandingkan sendiri. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fragmen pertama:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">StringBuilder strBuilder, DocPosition docPos, AncestralNamespaceContextManager anc</span></span></span><span class="hljs-function">)</span></span> { docPos = DocPosition.BeforeRootElement; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (XmlNode childNode <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ChildNodes) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (childNode.NodeType == XmlNodeType.Element) { CanonicalizationDispatcher.Write( childNode, strBuilder, DocPosition.InRootElement, anc); docPos = DocPosition.AfterRootElement; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CanonicalizationDispatcher.Write(childNode, strBuilder, docPos, anc); } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cuplikan kedua: </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteHash</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">HashAlgorithm hash, DocPosition docPos, AncestralNamespaceContextManager anc</span></span></span><span class="hljs-function">)</span></span> { docPos = DocPosition.BeforeRootElement; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (XmlNode childNode <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ChildNodes) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (childNode.NodeType == XmlNodeType.Element) { CanonicalizationDispatcher.WriteHash( childNode, hash, DocPosition.InRootElement, anc); docPos = DocPosition.AfterRootElement; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CanonicalizationDispatcher.WriteHash(childNode, hash, docPos, anc); } } }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3061</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parameter 'docPos' selalu ditulis ulang dalam tubuh metode sebelum digunakan. </font><font style="vertical-align: inherit;">CanonicalXmlDocument.cs 37</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3061</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parameter 'docPos' selalu ditulis ulang dalam tubuh metode sebelum digunakan. </font><font style="vertical-align: inherit;">CanonicalXmlDocument.cs 54</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kedua metode ini, parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docPos</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ditimpa sebelum nilainya digunakan, oleh karena itu, nilai yang digunakan sebagai argumen untuk metode diabaikan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 50</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pertimbangkan beberapa peringatan tentang kode proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Data.SqlClient</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsBOMNeeded</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MetaType type, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type.NullableType == TdsEnums.SQLXMLTYPE) { Type currentType = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(SqlString)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((SqlString)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).IsNull &amp;&amp; ((((SqlString)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).Value).Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((((SqlString)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).Value[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) != <span class="hljs-number"><span class="hljs-number">0xff</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((currentType == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)) &amp;&amp; (((String)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) &amp;&amp; (((<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) != <span class="hljs-number"><span class="hljs-number">0xff</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(SqlXml)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!((SqlXml)<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).IsNull) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentType == <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(XmlDataFeed)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Values will eventually converted to unicode string here } } return false; }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'value' digunakan sebelum diverifikasi dengan null. Periksa baris: 8696, 8708. TdsParser.cs 8696 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisis bingung dengan memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai! = Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di salah satu kondisi. Tampaknya dia tersesat di sana selama refactoring, karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai di</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atas </font><i><font style="vertical-align: inherit;">mengalami</font></i><font style="vertical-align: inherit;"> penurunan </font><i><font style="vertical-align: inherit;">nilai</font></i><font style="vertical-align: inherit;"> berkali-kali. Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nilai</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bisa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , semuanya buruk. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 51</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kesalahan berikutnya dari tes, tetapi tampaknya menarik bagi saya, jadi saya memutuskan untuk membawanya.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> TDSMessageCollection </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateQueryResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"name"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"state"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"databases"</span></span>) &amp;&amp; lowerBatchText.Contains(<span class="hljs-string"><span class="hljs-string">"db_name"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// SELECT [name], [state] FROM [sys].[databases] WHERE [name] = db_name() { // Delegate to current database response responseMessage = _PrepareDatabaseResponse(session); } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3053</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ekspresi yang berlebihan. Periksa substring 'nama' dan 'db_name'. QueryEngine.cs 151 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faktanya adalah bahwa dalam kasus ini, kombinasi dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Contains ("name")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Contains ("db_name") redup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bahkan, jika string yang diperiksa berisi substring </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"db_name"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka itu juga akan berisi substring </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"nama"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika string tidak mengandung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"nama"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka </font><font style="vertical-align: inherit;">string itu tidak </font><font style="vertical-align: inherit;">akan mengandung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"db_name"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ternyata memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lowerBatchText.Contains ("nama")</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berlebihan. Kecuali itu dapat mengurangi jumlah ekspresi yang dievaluasi jika string yang diperiksa tidak mengandung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"nama"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 52</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cuplikan kode yang mencurigakan dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Net.Requests</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> PipelineInstruction </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PipelineCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> PipelineEntry entry, ResponseDescription response, ....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) NetEventSource.Info(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">$"Command:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{entry?.Command}</span></span></span><span class="hljs-string"> Description:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response?.StatusDescription}</span></span></span><span class="hljs-string">"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// null response is not expected if (response == null) return PipelineInstruction.Abort; .... if (entry.Command == "OPTS utf8 on\r\n") .... .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'entri' digunakan setelah diverifikasi terhadap nol. Periksa baris: 270, 227. FtpControlStream.cs 270 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika mengkompilasi baris interpolasi, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ekspresi </font><i><font style="vertical-align: inherit;">? Perintah</font></i><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanggapan? Deskripsi digunakan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Alih-alih Operator '.' gunakan '?.' untuk tidak mendapatkan pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika salah satu parameter yang sesuai adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dalam hal ini, teknik ini berfungsi. Selanjutnya, seperti yang Anda lihat dari kode, nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mungkin </font><font style="vertical-align: inherit;">untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">respons</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terpotong (keluar dari metode jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">respons == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), tetapi untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak seperti itu. </font><font style="vertical-align: inherit;">Akibatnya, jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">pengecualian akan dilemparkan </font><font style="vertical-align: inherit;">saat memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entri.Komand</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (sudah menggunakan '.' </font><i><font style="vertical-align: inherit;">Daripada</font></i><font style="vertical-align: inherit;"> '?.'). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selanjutnya, kita akan kembali mempelajari kode secara cukup rinci, jadi saya sarankan istirahat lagi - sedikit gangguan, menyeduh teh atau membuat kopi, setelah itu saya akan senang melihat Anda di sini lagi.</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56a/3fc/f07/56a3fcf075284f021a56249627e518bb.png" alt="Gambar 23"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah kamu kembali? </font><font style="vertical-align: inherit;">Kalau begitu mari kita lanjutkan.</font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 53</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang mari kita lihat sesuatu yang menarik dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Collections.Immutable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kali ini, mari kita bereksperimen sedikit dengan struktur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Collections.Immutable.ImmutableArray &lt;T&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kami tertarik dengan metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralEquatable.Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralComparable.CompareTo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita mulai dengan metode </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IStructuralEquatable.Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kode diberikan di bawah ini, saya mengusulkan untuk mencoba memahami sendiri apa yang salah dengannya:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> other, IEqualityComparer comparer) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; Array otherArray = other <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> theirs = other <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IImmutableArray; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (theirs != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { otherArray = theirs.Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } } IStructuralEquatable ours = self.array; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.Equals(otherArray, comparer); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah kamu berhasil? </font><font style="vertical-align: inherit;">Jika demikian, sekali lagi, selamat.</font></font> :) <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'ours' digunakan setelah diverifikasi dengan null. Periksa baris: 1212, 1204. ImmutableArray_1.cs 1212 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Analyzer mengacaukan panggilan metode instance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equals</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> melalui variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kita yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terletak di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan pengembalian</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terakhir </font><font style="vertical-align: inherit;">, karena mengasumsikan bahwa pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimungkinkan di sini </font><font style="vertical-align: inherit;">. Bagaimana dia sampai pada kesimpulan ini? Untuk membuatnya lebih mudah dijelaskan, berikut adalah kode yang disederhanakan dari metode yang sama.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> other, IEqualityComparer comparer) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... } } } IStructuralEquatable ours = self.array; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.Equals(otherArray, comparer); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari ekspresi terakhir, kita melihat bahwa nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kita</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berasal dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Di atas, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> check dilakukan beberapa kali </font><font style="vertical-align: inherit;">. Oleh karena itu, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan karena itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">milik kita</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bisa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Setidaknya secara teori. Apakah kondisi seperti itu dapat dicapai dalam praktik? Mari kita coba mencari tahu. Untuk melakukan ini, sekali lagi saya membawa tubuh metode dengan poin-poin kunci terpisah.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IStructuralEquatable.Equals(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> other, IEqualityComparer comparer) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 Array otherArray = other as Array; if (otherArray == null) // &lt;= 2 { var theirs = other as IImmutableArray; if (theirs != null) // &lt;= 3 { otherArray = theirs.Array; if (self.array == null &amp;&amp; otherArray == null) { return true; } else if (self.array == null) // &lt;= 4 { return false; } } IStructuralEquatable ours = self.array; // &lt;= 5 return ours.Equals(otherArray, comparer); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poin kunci 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == this.array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self = ini</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Oleh karena itu, sebelum memanggil metode, perlu untuk mencapai keadaan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poin kunci 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kita dapat mengabaikan ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang akan menjadi pilihan termudah untuk mencapai tujuan, atau masuk ke dalam. Untuk mengabaikan ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cukup bahwa jenis variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menjadi tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau turunan dari itu dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Kemudian setelah menggunakan operator </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OtherArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">referensi non-nol akan ditulis, dan kami akan mengabaikan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pertama </font><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poin kunci 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Titik ini menyiratkan jalan yang lebih rumit. </font><font style="vertical-align: inherit;">Kita pasti perlu keluar pada </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kedua </font><font style="vertical-align: inherit;">(yang dengan ekspresi kondisional </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">milik mereka! = Null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Jika ini tidak terjadi dan pelaksanaan </font><font style="vertical-align: inherit;">cabang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kemudian</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dimulai </font><font style="vertical-align: inherit;">, kami dijamin tidak mencapai titik 5 yang kami butuhkan, asalkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> karena titik kunci 4. Agar tidak masuk ke </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if dari</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> poin kunci 3, Anda harus melakukan salah satu dari ketentuan:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sehingga tipe aktual </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak mengimplementasikan antarmuka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IImmutableArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Poin kunci 5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika kita mencapai titik ini dengan nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.array == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka kita telah mencapai tujuan kita, dan pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan dilemparkan ke dalam metode </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami mendapatkan set data berikut yang akan menuntun kami ke tujuan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this.array adalah null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yang kedua adalah salah satu dari yang berikut:</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau turunannya;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak memiliki tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atau turunannya, juga tidak mengimplementasikan antarmuka </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IImmutableArray</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah bidang yang dideklarasikan sebagai berikut:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> T[] array;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImmutableArray &lt;T&gt;</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah struktur, ia memiliki konstruktor default (tanpa argumen), sebagai akibatnya bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">array</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan default, yaitu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dan inilah yang kami butuhkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yah, kita tidak akan lupa bahwa kita menyelidiki implementasi eksplisit dari metode antarmuka, oleh karena itu, sebelum panggilan, kita perlu melakukan pemeran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang kami memiliki semua kartu untuk mencapai pengecualian dalam tiga cara. </font><font style="vertical-align: inherit;">Kami menghubungkan versi debug perpustakaan, menulis kode, mengeksekusi, mengamati. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuplikan kode 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, comparer);</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuplikan kode 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { }, comparer);</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuplikan kode 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> comparer = EqualityComparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); ((IStructuralEquatable)immutableArray).Equals(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Object), comparer);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hasil dari eksekusi ketiga fragmen kode akan sama, hanya saja akan tercapai karena data input yang berbeda dan jalur eksekusi yang berbeda. </font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13a/a3b/e8a/13aa3be8a0b68a646aee130773f2c862.png" alt="Gambar 18"></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 54</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jika Anda belum lupa, kami memiliki metode lain yang harus Anda coba kompromi. </font><font style="vertical-align: inherit;">:) Hanya saja kali ini kami tidak akan membongkar secara detail. </font><font style="vertical-align: inherit;">Selain itu, kami sudah mengetahui beberapa informasi dari contoh sebelumnya.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> IStructuralComparable.CompareTo(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> other, IComparer comparer) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; Array otherArray = other <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> theirs = other <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IImmutableArray; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (theirs != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { otherArray = theirs.Array; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.array == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ^ otherArray == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentException( SR.ArrayInitializedStateNotEqual, <span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(other)); } } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (otherArray != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { IStructuralComparable ours = self.array; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ours.CompareTo(otherArray, comparer); <span class="hljs-comment"><span class="hljs-comment">// &lt;= } throw new ArgumentException(SR.ArrayLengthsNotEqual, nameof(other)); }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'ours' digunakan setelah diverifikasi dengan null. </font><font style="vertical-align: inherit;">Periksa baris: 1265, 1251. ImmutableArray_1.cs 1265 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang Anda lihat, situasinya sangat mirip dengan contoh yang dipertimbangkan sebelumnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan menulis kode berikut:</font></font><br><br><pre> <code class="cs hljs">Object other = ....; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> comparer = Comparer&lt;String&gt;.Default; ImmutableArray&lt;String&gt; immutableArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImmutableArray&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(); ((IStructuralComparable)immutableArray).CompareTo(other, comparer);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita coba untuk memilih nilai input sehingga mencapai titik di mana pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException terjadi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lainnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">String baru [] {}</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hasil:</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eef/d77/08a/eefd7708a187f5060f2074e642f18434.png" alt="Gambar 22"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan demikian, kami kembali berhasil memilih satu set data input yang pengecualiannya terjadi dalam metode. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 55</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ada </font><font style="vertical-align: inherit;">beberapa tempat </font><font style="vertical-align: inherit;">di proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Net.HttpListener</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tidak hanya mencurigakan, tetapi sangat mirip satu sama lain. </font><font style="vertical-align: inherit;">Dan lagi, keraguan samar tentang creep-paste masuk. </font><font style="vertical-align: inherit;">Karena polanya sama, pertimbangkan satu contoh kode, untuk kasus lain, saya akan memberikan peringatan penganalisa:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> IAsyncResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginRead</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] buffer, ....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NetEventSource.IsEnabled) { NetEventSource.Enter(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); NetEventSource.Info(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"buffer.Length:"</span></span> + buffer.Length + <span class="hljs-string"><span class="hljs-string">" size:"</span></span> + size + <span class="hljs-string"><span class="hljs-string">" offset:"</span></span> + offset); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(buffer)); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'buffer' digunakan sebelum diverifikasi dengan null. Periksa baris: 51, 53. HttpRequestStream.cs 51 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meningkatkan pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ArgumentNullException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secara eksplisit mengisyaratkan bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah nilai yang tidak valid untuk variabel ini. Namun, jika nilai ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NetEventSource.IsEnabled</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan pada saat yang sama </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penyangga '</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , akan melemparkan pengecualian jenis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saat menghitung ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer.length</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Oleh karena itu, sebelum memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffer == null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam hal ini, masalahnya bahkan tidak mencapai. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio dikeluarkan pada metode lain dengan pola yang persis sama:</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'buffer' digunakan sebelum diverifikasi terhadap null. </font><font style="vertical-align: inherit;">Periksa baris: 49, 51. HttpResponseStream.cs 49</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'buffer' digunakan sebelum diverifikasi terhadap null. </font><font style="vertical-align: inherit;">Periksa baris: 74, 75. HttpResponseStream.cs 74</font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 56</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode serupa ditemukan di proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Transactions.Local</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnterState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">InternalTransaction tx</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tx._outcomeSource._isoLevel == IsolationLevel.Snapshot) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> TransactionException.CreateInvalidOperationException( TraceSourceType.TraceSourceLtm, SR.CannotPromoteSnapshot, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, tx == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? Guid.Empty : tx.DistributedTxId); } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3095 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'tx' digunakan sebelum diverifikasi dengan null. Periksa baris: 3282, 3285. TransactionState.cs 3282 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kondisi tertentu, mereka ingin melempar pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">InvalidOperationException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ketika metode ini dipanggil, parameter </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> digunakan untuk membuat objek pengecualian </font><font style="vertical-align: inherit;">, dan diperiksa untuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> agar tidak membuang pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saat mengevaluasi ekspresi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx.DistributedTxId</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ironisnya adalah bahwa jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cek ini tidak akan membantu, karena ketika menghitung kondisi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bidang contoh diakses melalui variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tx._outcomeSource._isoLevel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 57</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kode dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Runtime.Caching</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetLimit</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> cacheMemoryLimitMegabytes</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> cacheMemoryLimit = cacheMemoryLimitMegabytes; cacheMemoryLimit = cacheMemoryLimit &lt;&lt; MEGABYTE_SHIFT; _memoryLimit = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// never override what the user specifies as the limit; // only call AutoPrivateBytesLimit when the user does not specify one. if (cacheMemoryLimit == 0 &amp;&amp; _memoryLimit == 0) { // Zero means we impose a limit _memoryLimit = EffectiveProcessMemoryLimit; } else if (cacheMemoryLimit != 0 &amp;&amp; _memoryLimit != 0) { // Take the min of "cache memory limit" and // the host's "process memory limit". _memoryLimit = Math.Min(_memoryLimit, cacheMemoryLimit); } else if (cacheMemoryLimit != 0) { // _memoryLimit is 0, but "cache memory limit" // is non-zero, so use it as the limit _memoryLimit = cacheMemoryLimit; } .... }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">Ekspresi </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3022</font></a><font style="vertical-align: inherit;"> 'cacheMemoryLimit! = 0 &amp;&amp; _memoryLimit! = 0' selalu salah. CacheMemoryMonitor.cs 250 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda memperhatikan kode ini, Anda akan melihat bahwa salah satu ekspresi - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cacheMemoryLimit! = 0 &amp;&amp; _memoryLimit! = 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - akan selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Karena </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_memoryLimit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memiliki nilai 0 ( </font><i><font style="vertical-align: inherit;">ditempatkan</font></i><font style="vertical-align: inherit;"> sebelum </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan if</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), operan kanan operator &amp;&amp; </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , oleh karena itu, hasil keseluruhan ekspresi juga </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salah</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 58</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Berikut ini adalah potongan kode yang mencurigakan dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Diagnostics.TraceSource</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Pop</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { StackNode n = _stack.Value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Pop(); } _stack.Value = n.Prev; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n.Value; }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3125 Objek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'n' digunakan setelah diverifikasi terhadap null. Periksa baris: 115, 111. CorrelationManager.cs 115 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kode yang menarik. Karena memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n == null, saya akan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menganggap bahwa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">null</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah nilai yang mungkin untuk variabel lokal ini. Jika demikian, pengecualian dari tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dilemparkan</font></i><font style="vertical-align: inherit;"> ketika mengakses properti instance - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n.Prev</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam hal ini tidak pernah bisa menjadi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , maka memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">base.Pop ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dalam konteks ini tidak akan pernah dieksekusi. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 59</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tempat menarik ditemukan di proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Drawing.Primitive</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dan lagi, saya mengusulkan untuk mencari masalah sendiri. </font><font style="vertical-align: inherit;">Ini kodenya:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToHtml</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Color c</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> colorString = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c.IsEmpty) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> colorString; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ColorUtil.IsSystemColor(c)) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (c.ToKnownColor()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveBorder: colorString = <span class="hljs-string"><span class="hljs-string">"activeborder"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GradientActiveCaption: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveCaption: colorString = <span class="hljs-string"><span class="hljs-string">"activecaption"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.AppWorkspace: colorString = <span class="hljs-string"><span class="hljs-string">"appworkspace"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Desktop: colorString = <span class="hljs-string"><span class="hljs-string">"background"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Control: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlDark: colorString = <span class="hljs-string"><span class="hljs-string">"buttonshadow"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlText: colorString = <span class="hljs-string"><span class="hljs-string">"buttontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ActiveCaptionText: colorString = <span class="hljs-string"><span class="hljs-string">"captiontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GrayText: colorString = <span class="hljs-string"><span class="hljs-string">"graytext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.HotTrack: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Highlight: colorString = <span class="hljs-string"><span class="hljs-string">"highlight"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuHighlight: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.HighlightText: colorString = <span class="hljs-string"><span class="hljs-string">"highlighttext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveBorder: colorString = <span class="hljs-string"><span class="hljs-string">"inactiveborder"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.GradientInactiveCaption: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveCaption: colorString = <span class="hljs-string"><span class="hljs-string">"inactivecaption"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InactiveCaptionText: colorString = <span class="hljs-string"><span class="hljs-string">"inactivecaptiontext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Info: colorString = <span class="hljs-string"><span class="hljs-string">"infobackground"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.InfoText: colorString = <span class="hljs-string"><span class="hljs-string">"infotext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuBar: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Menu: colorString = <span class="hljs-string"><span class="hljs-string">"menu"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.MenuText: colorString = <span class="hljs-string"><span class="hljs-string">"menutext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ScrollBar: colorString = <span class="hljs-string"><span class="hljs-string">"scrollbar"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlDarkDark: colorString = <span class="hljs-string"><span class="hljs-string">"threeddarkshadow"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLightLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonhighlight"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Window: colorString = <span class="hljs-string"><span class="hljs-string">"window"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.WindowFrame: colorString = <span class="hljs-string"><span class="hljs-string">"windowframe"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.WindowText: colorString = <span class="hljs-string"><span class="hljs-string">"windowtext"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c.IsNamedColor) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == Color.LightGray) { <span class="hljs-comment"><span class="hljs-comment">// special case due to mismatch between Html and enum spelling colorString = "LightGrey"; } else { colorString = c.Name; } } else { colorString = "#" + cRToString("X2", null) + cGToString("X2", null) + cBToString("X2", null); } return colorString; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oke, oke, lagi ini lelucon saya ... Atau bisakah Anda? </font><font style="vertical-align: inherit;">Bagaimanapun, kami akan mempersingkat kode untuk lebih jelas menunjukkan masalah. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah versi singkat dari kode:</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (c.ToKnownColor()) { .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.Control: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> KnownColor.ControlLight: colorString = <span class="hljs-string"><span class="hljs-string">"buttonface"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3139</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dua atau lebih cabang kasus melakukan tindakan yang sama. </font><font style="vertical-align: inherit;">ColorTranslator.cs 302 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak bisa mengatakan dengan pasti, tapi saya pikir ini masih sebuah kesalahan. </font><font style="vertical-align: inherit;">Dalam kasus lain, ketika mereka ingin mengembalikan nilai yang sama untuk beberapa elemen enumerasi, mereka menggunakan beberapa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kasus untuk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> saling mengikuti. </font><font style="vertical-align: inherit;">Dan untuk membuat kesalahan dengan copy-paste cukup mudah, seperti yang menurut saya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggali lebih dalam. </font><font style="vertical-align: inherit;">Untuk mendapatkan metode output analit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ToHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">«buttonface»</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , input dapat ditularkan dari berikut ini (diharapkan)</font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.Control</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.ControlLight</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jika Anda melihat nilai ARGB untuk masing-masing warna ini, Anda dapat melihat yang berikut: </font></font><br><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.Control</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(255, 240, 240, 240)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SystemColors.ControlLight - (255, 227, 227, 227)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda memanggil nilai yang diterima ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"tombol"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) metode konversi terbalik - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FromHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kami mendapatkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontrol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> warna </font><i><font style="vertical-align: inherit;">(255, 240, 240, 240)</font></i><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Bisakah saya mendapatkan </font><font style="vertical-align: inherit;">warna </font><i><font style="vertical-align: inherit;">ControlLight</font></i><font style="vertical-align: inherit;"> dari </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FromHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font> Ya<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam metode ini, ada tabel warna berdasarkan yang (dalam kasus tertentu) warna diperoleh. </font><font style="vertical-align: inherit;">Inisialisasi tabel memiliki baris berikut:</font></font><br><br><pre> <code class="cs hljs">s_htmlSysColorTable[<span class="hljs-string"><span class="hljs-string">"threedhighlight"</span></span>] = ColorUtil.FromKnownColor(KnownColor.ControlLight);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan demikian, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FromHtml</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengembalikan warna </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ControlLight (255, 227, 227, 227)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk nilai </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"threedhighlight"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saya pikir itu adalah nilai ini yang seharusnya digunakan dalam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kasus KnowedColor.ControlLight</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 60</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat beberapa peringatan menarik dari proyek </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Text.RegularExpressions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TextposDescription</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> remaining; sb.Append(runtextpos); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sb.Length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) sb.Append(<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span> - sb.Length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (runtextpos &gt; runtextbeg) sb.Append(RegexCharClass.CharDescription(runtext[runtextpos - <span class="hljs-number"><span class="hljs-number">1</span></span>])); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sb.Append(<span class="hljs-string"><span class="hljs-string">'^'</span></span>); sb.Append(<span class="hljs-string"><span class="hljs-string">'&gt;'</span></span>); remaining = runtextend - runtextpos; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = runtextpos; i &lt; runtextend; i++) { sb.Append(RegexCharClass.CharDescription(runtext[i])); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sb.Length &gt;= <span class="hljs-number"><span class="hljs-number">64</span></span>) { sb.Length = <span class="hljs-number"><span class="hljs-number">61</span></span>; sb.Append(<span class="hljs-string"><span class="hljs-string">"..."</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { sb.Append(<span class="hljs-string"><span class="hljs-string">'$'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.ToString(); }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio Warning</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3137 Variabel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 'tersisa' ditugaskan tetapi tidak digunakan pada akhir fungsi. RegexRunner.cs 612 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai </font><font style="vertical-align: inherit;">ditulis untuk </font><font style="vertical-align: inherit;">variabel lokal yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tersisa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi tidak lagi digunakan sampai akhir metode. Mungkin beberapa kode yang menggunakannya dihapus, tetapi mereka lupa tentang variabel itu sendiri. Atau di sini ada kesalahan yang lebih serius dan variabel ini harus digunakan entah bagaimana. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 61</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddRange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> first, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> last</span></span></span><span class="hljs-function">)</span></span> { _rangelist.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SingleRange(first, last)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_canonical &amp;&amp; _rangelist.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; first &lt;= _rangelist[_rangelist.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>].Last) { _canonical = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre> <br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">PVS-Studio</font></b><font style="vertical-align: inherit;"> : </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">V3063</font></a><font style="vertical-align: inherit;"> Bagian dari ekspresi kondisional selalu benar jika dievaluasi: _rangelist.Count&gt; 0. RegexCharClass.cs 523 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penganalisa dengan tepat mencatat bahwa bagian dari ekspresi - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist.Count&gt; 0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - akan selalu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika kode ini akan dieksekusi. Bahkan jika daftar yang ditunjuk oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kosong, setelah menambahkan elemen </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_rangelist.Add (....)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu tidak akan menjadi seperti itu lagi. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Masalah 62</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat pemicu aturan diagnostik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> di </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Drawing.Common</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.Transactions.Local</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proyek </font><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ArrayEnumerator</span></span> : <span class="hljs-title"><span class="hljs-title">IEnumerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[] _array; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> _item; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _index; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _startIndex; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _endIndex; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ArrayEnumerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] array, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> startIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count</span></span></span><span class="hljs-function">)</span></span> { _array = array; _startIndex = startIndex; _endIndex = _index + count; _index = _startIndex; } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kolom '_index' digunakan sebelum diinisialisasi dalam konstruktor. PrinterSettings.Windows.cs 1679 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat menginisialisasi bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_endIndex</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">bidang </font><font style="vertical-align: inherit;">lain digunakan - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang pada saat digunakan memiliki nilai standar - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default (int)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Di bawah bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sudah diinisialisasi. Jika tiba-tiba ini bukan kesalahan - variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_index</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> harus dihilangkan dalam ekspresi ini agar tidak membingungkan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 63</font></font></b> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TransactionTable</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _timerInterval; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TransactionTable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Create a timer that is initially disabled by specifing // an Infinite time to the first interval _timer = new Timer(new TimerCallback(ThreadTimer), null, Timeout.Infinite, _timerInterval); .... // Store the timer interval _timerInterval = 1 &lt;&lt; TransactionTable.timerInternalExponent; .... } }</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peringatan PVS-Studio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3128</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kolom '_timerInterval' digunakan sebelum diinisialisasi dalam konstruktor. </font><font style="vertical-align: inherit;">TransactionTable.cs 151 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situasinya mirip dengan yang dijelaskan di atas. </font><font style="vertical-align: inherit;">Pertama, gunakan nilai bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timerInterval</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (saat ini masih sama dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">default (int)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) untuk menginisialisasi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan baru kemudian menginisialisasi bidang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_timerInterval itu sendiri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edisi 64</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Peringatan berikut diterima oleh aturan diagnostik yang masih dalam pengembangan. </font><font style="vertical-align: inherit;">Dia belum memiliki dokumentasi dan laporan akhir, tetapi dengan bantuannya dia sudah berhasil menemukan beberapa tempat menarik. </font><font style="vertical-align: inherit;">Lagi-lagi tempat-tempat ini terlihat seperti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">salin-tempel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi kami hanya akan mempertimbangkan satu kode. </font></font><br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessNotifyConnection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... WeakReference reference = (WeakReference)( LdapConnection.s_handleTable[referralFromConnection]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( reference != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; reference.IsAlive &amp;&amp; <span class="hljs-literal"><span class="hljs-literal">null</span></span> != ((LdapConnection)reference.Target)._ldapHandle) { .... } .... }</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio warning (stub)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : VXXXX TODO_MESSAGE. LdapSessionOptions.cs 974 </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahaya di sini adalah jika setelah memeriksa </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">referensi.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hidup </font><font style="vertical-align: inherit;">pengumpulan sampah dilakukan dan objek yang dirujuk oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WeakReference</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> berada di bawahnya </font><font style="vertical-align: inherit;">, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">referensi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Target</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan mengembalikan </font><i><font style="vertical-align: inherit;">nol</font></i><font style="vertical-align: inherit;"> . Akibatnya, saat mengakses bidang instance </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_ldapHandle,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengecualian tipe </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NullReferenceException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan </font><i><font style="vertical-align: inherit;">dilempar</font></i><font style="vertical-align: inherit;"> . Sebenarnya, Microsoft sendiri juga memperingatkan tentang jebakan ini dengan verifikasi IsAlive. Kutipan dari docs.microsoft.com - " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WeakReference.IsAlive Property</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ":</font></font><i>Because an object could potentially be reclaimed for garbage collection immediately after the IsAlive property returns true, using this property is not recommended unless you are testing only for a false return value.</i> <br><br><h2>     </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah semua kesalahan dan tempat menarik ini ditemukan sebagai hasil analisis? Tentu tidak! Mulai melihat hasil analisis, saya hati-hati melihat peringatan. Ketika jumlah mereka bertambah dan menjadi jelas bahwa akan ada peringatan pada artikel tersebut, saya membolak-balik hasilnya, mencoba untuk memilih hanya apa yang tampaknya paling menarik bagi saya. Ketika saya sampai pada yang terakhir (log terbesar), yang tersisa bagi saya adalah membalik-balik semua peringatan sampai mata saya menangkap sesuatu yang tidak biasa. Jadi, jika Anda menyelidiki hal itu, saya yakin Anda dapat menemukan lebih banyak tempat menarik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagai contoh, saya mengabaikan hampir semua peringatan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3063</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Secara relatif, jika ada kode bentuk:</font></font><br><br><pre> <code class="cs hljs">String str = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) ....</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya melewatkannya, karena ada tempat-tempat menarik yang ingin saya gambarkan. Ada pemicu pada kunci tidak aman menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pernyataan kunci</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan kunci </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ini</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dll. - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3090</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; panggilan acara tidak aman - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3083</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; objek yang tipenya menerapkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IDisposable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tutup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak disebut </font><font style="vertical-align: inherit;">- </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V3072</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan diagnostik serupa; dan masih banyak lagi.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak menulis (setidaknya saya mencoba, saya tidak sengaja bisa menulis sesuatu). Saya menemukan masalah yang ditemukan dalam tes. Selain beberapa tempat yang tampaknya cukup menarik bagi saya untuk menarik perhatian mereka. Tetapi kode pengujian juga bisa mengandung kesalahan, itulah sebabnya tes tidak akan berfungsi dengan benar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secara umum, masih ada sesuatu yang harus dipelajari - tetapi </font><font style="vertical-align: inherit;">saya tidak menetapkan tujuan untuk </font><font style="vertical-align: inherit;">menuliskan secara </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mutlak semua masalah yang ditemukan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kualitas kodenya tampak tidak merata. Beberapa proyek benar-benar bersih, sementara yang lain berisi tempat yang mencurigakan. Mungkin kemurnian proyek diharapkan, terutama dalam kasus kelas perpustakaan yang paling umum digunakan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika untuk menggeneralisasi - mungkin, kita dapat mengatakan bahwa kode tersebut cukup berkualitas mengingat fakta bahwa jumlah kode telah dianalisis. </font><font style="vertical-align: inherit;">Tetapi, sebagai berikut dari artikel ini, ada beberapa sudut gelap. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ngomong-ngomong, proyek sebesar ini juga merupakan tes yang bagus untuk penganalisa. </font><font style="vertical-align: inherit;">Saya berhasil menemukan serangkaian peringatan palsu / aneh yang saya pilih untuk diperiksa dan diperbaiki. </font><font style="vertical-align: inherit;">Jadi, sebagai hasil dari analisis, kami berhasil menemukan titik-titik di mana ada baiknya bekerja pada PVS-Studio itu sendiri.</font></font><br><br><h2>  Kesimpulan </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda sampai di tempat ini setelah membaca artikel lengkap - biarkan saya berjabat tangan! </font><font style="vertical-align: inherit;">Saya harap saya bisa menunjukkan kesalahan yang menarik dan menunjukkan manfaat analisis statis. </font><font style="vertical-align: inherit;">Jika Anda juga belajar sesuatu yang baru untuk diri sendiri yang akan memungkinkan Anda untuk menulis kode yang lebih baik - saya akan sangat senang.</font></font><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ef/dbc/f2d/6efdbcf2d984bef000cf44face04c6a4.png" alt="Gambar 24"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan satu atau lain cara, bantuan analisis statis tidak akan berlebihan, jadi saya sarankan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mencoba PVS-Studio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada proyek Anda dan melihat tempat menarik apa yang dapat Anda temukan dengannya. </font><font style="vertical-align: inherit;">Jika Anda memiliki pertanyaan atau hanya ingin berbagi tempat menarik yang ditemukan - jangan ragu untuk menulis ke </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">support@viva64.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> :) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Semua yang terbaik! </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PS Menghubungi .NET Core Library Developers </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima kasih banyak atas apa yang Anda lakukan! </font><font style="vertical-align: inherit;">Anda adalah orang-orang hebat. </font><font style="vertical-align: inherit;">Saya harap artikel ini membantu membuat kode sedikit lebih baik. </font><font style="vertical-align: inherit;">Ingatlah bahwa saya tidak menuliskan semua tempat yang mencurigakan dalam artikel, dan lebih baik untuk memeriksa proyek secara mandiri menggunakan penganalisa - dengan cara ini Anda dapat mempelajari semua peringatan secara lebih rinci, dan akan lebih mudah untuk bekerja daripada dengan log teks sederhana / daftar kesalahan ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saya menulis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sedikit lebih banyak </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">tentang ini di sini</font></a><font style="vertical-align: inherit;"> ).</font></font><br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a> </p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Sergey Vasiliev. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memeriksa .NET Core Libraries Source Code oleh PVS-Studio Static Analyzer</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id463537/">https://habr.com/ru/post/id463537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id463515/index.html">Menggunakan HTMS API untuk bekerja dengan database jaringan relasional</a></li>
<li><a href="../id463525/index.html">Selenium, Selenoid, Selenide, Selendroid ... Apa artinya semua ini?</a></li>
<li><a href="../id463527/index.html">Muncul! Ditranskripsikan di iOS</a></li>
<li><a href="../id463533/index.html">Apa yang harus diketahui setiap pengembang sejak awal</a></li>
<li><a href="../id463535/index.html">Memeriksa .NET Core Libraries Source Code oleh PVS-Studio Static Analyzer</a></li>
<li><a href="../id463541/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 17. Ringkasan dan peta jalan kursus CCNA</a></li>
<li><a href="../id463551/index.html">Bagaimana berhubungan dengan karyawan dan mengatur alur kerja di perusahaan IT besar</a></li>
<li><a href="../id463553/index.html">"Apakah kamu orang google?" atau 5 hal yang kami lakukan saat merekrut (tetapi tidak lagi)</a></li>
<li><a href="../id463559/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 18. Dasar-dasar Routing</a></li>
<li><a href="../id463563/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 19. Memulai dengan router</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>