<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍⚖️ ☸️ 🦆 Comment transférer une variable d'un fragment à une activité dans Android? 🤘🏿 🦂 🤲🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une histoire sur la façon dont dans Android pour transférer des informations d'un fragment (Fragment) à une activité (Activity). Les informations sero...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment transférer une variable d'un fragment à une activité dans Android?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448744/">  Une histoire sur la façon dont dans Android pour transférer des informations d'un fragment (Fragment) à une activité (Activity).  Les informations seront utiles pour les débutants (juniors), maîtrisant la programmation pour Android, et ne devraient pas être intéressantes pour les intermédiaires et les seniors. <br><br>  Lancez l'IDE (environnement de développement intégré) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Android Studio</a> .  Créez un nouveau projet: Fichier -&gt; Nouveau -&gt; Nouveau projet.  Sélectionnez "Activité vide", cliquez sur "Suivant". <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/cg/ke/e2/cgkee2qhgl99tnppykdclbuqm-m.gif"><br><br>  Remplissez les champs «Nom», «Nom du package», «Enregistrer l'emplacement». <br><br><img src="https://habrastorage.org/webt/lm/fs/bk/lmfsbkgnztagfar9zebozvr0388.gif"><br><br>  L'EDI créera automatiquement deux fichiers: «MainActivity.java» dans le répertoire «java / [nom du package]», «activity_main.xml» dans le répertoire «res / layout». <br><br><img src="https://habrastorage.org/webt/b3/ku/tg/b3kutgfol159_bc6u5wikjyfvg8.jpeg"><br><br><img src="https://habrastorage.org/webt/nq/a5/iq/nqa5iqsksg74xzkkiyo2yhbchzo.jpeg"><br><br>  Le fichier Java détermine ce que fait l'application, xml - à quoi elle <i><b>ressemble</b></i> .  Il fait jusqu'à présent très peu, seulement "setContentView (R.layout.activity_main);".  Cette ligne indique à l'application d'utiliser la disposition activity_main.xml au démarrage.  Et, comme la mise en page ne contient qu'un seul widget de type "TextView" avec le texte "Hello World!", Notre application a également l'air très modeste. <br><br><img src="https://habrastorage.org/webt/ne/vk/dp/nevkdph0t9qydcj1jnn8kqsxdzu.gif"><br><br>  Dans le dossier du projet, créez un fragment avec le nom "Fragment1". <br><br><img src="https://habrastorage.org/webt/4f/jj/ws/4fjjwsspunm4e3up2bzd-sycpwc.jpeg"><br><br><img src="https://habrastorage.org/webt/bd/xt/to/bdxttophoj-6r7_vu5faxiyrnxo.gif"><br><br>  L'IDE va ​​créer deux fichiers: "Fragment1" et "fragment_fragment1.xml". <br><br><img src="https://habrastorage.org/webt/gk/z9/vl/gkz9vluu61zdz7kja9od3dtsomk.jpeg"><br><br><img src="https://habrastorage.org/webt/bc/cy/8l/bccy8ljhhmlponiixf522a5z7lm.jpeg"><br><br>  Ouvrez le fichier de disposition des fragments et supprimez le widget "TextView" dont nous n'avons pas besoin avec une ligne de bienvenue. <br><br><img src="https://habrastorage.org/webt/y0/-k/kk/y0-kkkfjxdhvccgc2yflvcnl8pi.jpeg"><br><br>  Passez en mode conception et faites glisser le bouton (Bouton) sur la mise en page. <br><br><img src="https://habrastorage.org/webt/gs/8g/yn/gs8gynbw8fylpdugjpqwzzktb4c.jpeg"><br><br>  L'IDE va ​​créer un bouton avec l'identifiant "bouton1". <br><br><img src="https://habrastorage.org/webt/a_/ng/fb/a_ngfbvqvgv52zful83hsuxpwmo.jpeg"><br><br>  Modifiez maintenant la disposition de l'activité principale, c'est-à-dire  fichier "activity_main.xml" <br><br><img src="https://habrastorage.org/webt/wa/-z/vr/wa-zvrhls1y0cy22xaa4oqcsyls.jpeg"><br><br>  Déplacez le widget texte plus haut et ajoutez le fragment que nous avons créé à la mise en page (pour ce faire, faites glisser l'élément "&lt;&gt;" sur la mise en page, sélectionnez "Fragment1" et cliquez sur "OK"). <br><br><img src="https://habrastorage.org/webt/pm/fj/wg/pmfjwgcfvfvfbnimdhl78bjh08u.jpeg"><br><br>  Dans la disposition des activités dans les paramètres du fragment, définissez layout_height = "wrap_content" et modifiez son emplacement à votre goût.  Nous changerons également l'identifiant du champ de texte en «textReport» et le fragment en «fragmentWithButton». <br><br><img src="https://habrastorage.org/webt/dk/au/mg/dkaumgt8t_rpixwewkiyd_ozcdc.jpeg"><br><br>  Exécutez l'émulateur (Shift + F10) et voyez ce qui s'est passé. <br><br><img src="https://habrastorage.org/webt/c2/yc/ax/c2ycaxbgia70bz0xe0tzs1veai4.gif"><br><br>  L'application affiche l'inscription "Hello World!"  et le bouton BOUTON.  L'inscription est déduite de l' <i><b>activité</b></i> , le bouton appartient à un <i><b>fragment</b></i> .  Le bouton est enfoncé, mais jusqu'à présent, il n'a aucun effet.  Essayons de programmer l'inscription pour afficher le nombre d'appuis sur les boutons.  Pour ce faire, nous devrons <i><b>envoyer un message sur le clic du bouton du fragment à l'activité</b></i> . <br><br>  Tout d'abord, nous allons apprendre au fragment à compter le nombre de clics sur les boutons.  Ouvrez le fichier «Fragment1.java». <br><br><img src="https://habrastorage.org/webt/6f/ti/eo/6ftieohuhycuf_tpcwnu6s1bm0y.jpeg"><br><br>  Ajoutez la variable "compteur".  Dans la méthode «onCreateView», qui est appelée immédiatement après la création du fragment, créez le bouton «écouteur».  L'IDE nécessitera l'implémentation de View.OnClickListener - d'accord (Alt + Entrée).  Créons (redéfinissons) la méthode onClick, qui augmentera la valeur de la variable «compteur» à chaque clic du bouton et affichera un message pop-up. <br><br><img src="https://habrastorage.org/webt/is/lw/bg/islwbg0ijjtbojfcvsis1i2gacq.jpeg"><br><br>  Vérifions dans l'émulateur (encore une fois Shift + F10) comment cela fonctionne.  En appuyant sur le bouton, le message contextuel "Nombre de clics sur le bouton: ..." apparaîtra en bas de l'écran de l'application. <br><br><img src="https://habrastorage.org/webt/vo/j5/ul/voj5uljhsxmwgzg_m1ycafmg5p0.gif"><br><br>  Super, continue.  Notre objectif principal est de transférer des informations (dans ce cas, le nombre de clics sur les boutons) de l'instance de fragment vers l'instance d'activité.  Hélas, les cycles de vie des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">activités</a> et des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fragments sont</a> organisés de manière à ce qu'Android (presque) ne permette pas à l'activité et à un fragment de communiquer directement, nous avons donc besoin d'une interface intermédiaire.  Appelons-le «facteur» (facteur).  L'interface peut être créée soit dans un fichier séparé, soit dans un fichier avec un code de fragment;  nous choisirons la première option.  Notre interface Postman contiendra une seule méthode abstraite (sans "corps") de "fragmentMail". <br><br><img src="https://habrastorage.org/webt/m4/7y/ze/m47yzelbzced44wwarahc5incwe.jpeg"><br><br>  Nous utiliserons la variable "numberOfClicks" comme "enveloppe" pour transférer les messages du fragment vers l'activité. <br><br>  Ouvrez le fichier avec le code d'activité "MainActivity.java".  Comme nous nous en souvenons, cela ressemble à ceci: <br><br><img src="https://habrastorage.org/webt/tl/h3/s9/tlh3s9pb3alrn_busz9f2pmq9t0.jpeg"><br><br>  Nous implémentons l'interface Postman et ajoutons la méthode d'interface fragmentMail à l'activité, en la redéfinissant ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Override</a> ). <br><br><img src="https://habrastorage.org/webt/fw/1u/vq/fw1uvq544wgtximbhjtslbszmrs.jpeg"><br><br>  Maintenant, dès que l'activité "voit" une nouvelle valeur dans la variable "numberOfClicks", elle affichera un message mis à jour dans le champ de texte textReport. <br><br>  Mais nous devons encore «mettre la lettre dans l'enveloppe», c'est-à-dire  passez à la variable le nombre de clics sur le bouton.  Et nous le faisons dans le code de fragment.  Ouvrez le fichier "Fragment1.java". <br><br>  D̶o̶b̶a̶v̶l̶ya̶e̶m̶ ¯V Podpis Klassa ̶i̶m̶p̶l̶e̶m̶e̶n̶t̶a̶ts̶i̶yu̶ ̶i̶n̶t̶e̶r̶f̶e̶y̶s̶a̶ ̶ «Postman». Ide ̶p̶o̶t̶r̶e̶b̶u̶e̶t̶ ̶p̶e̶r̶e̶o̶p̶r̶e̶d̶e̶l̶i̶t̶̶ Metod ̶i̶n̶t̶e̶r̶f̶e̶y̶s̶a̶ ̶ «̶f̶r̶a̶g̶m̶e̶n̶t̶M̶a̶i̶l̶» ̶, ̶ Nô delat ¯V Nominal nichego Mỹ nè budem, ̶ ̶p̶o̶e̶t̶o̶m̶u̶ ̶o̶s̶t̶a̶v̶i̶m̶ EGO Telo ̶p̶u̶s̶t̶y̶m̶.  <i>[Supprimé, voir «Note 1 du 20/04/2019»]</i> <br><br>  Nous aurons besoin d'un lien vers une instance d'activité.  Nous l'obtiendrons lorsqu'un fragment est attaché à une activité comme celle-ci: <br><img src="https://habrastorage.org/webt/yl/jh/fr/yljhfr9cyl1pzhptlzzi6h0ejhy.jpeg"><br><br>  Dans la méthode «onClick» (la même que celle qui est appelée lorsque le bouton de notre fragment est cliqué), nous ajoutons un appel à l'interface à partir d'une instance d'activité. <br><br><img src="https://habrastorage.org/webt/je/o2/k8/jeo2k8ssprrdoyrzi9ab3v3e4kc.jpeg"><br><br>  Le code final du fragment après la suppression (pour des raisons de compacité) des commentaires ressemble à ceci: <br><img src="https://habrastorage.org/webt/wb/7r/3d/wb7r3digdzwfbscmtcpwy7qzqj4.jpeg"><br><br>  Maintenant, notre <i>fragment compte le nombre de clics sur les boutons</i> , les affiche dans un message contextuel, puis utilise l'interface Postman pour <i>transférer la valeur de la variable de compteur à la variable numberOfClicks</i> , qui sert de conteneur d'enveloppe pour envoyer des messages du fragment à l'activité.  L'activité, recevant un nouveau message, l'affiche immédiatement dans son champ de texte de widget avec l'identifiant "textReport".  Le but est atteint! <br><img src="https://habrastorage.org/webt/ur/vh/mc/urvhmcy7fbx4rmt7sgkdnb_t2v0.gif"><br><br>  PS: Changer le langage de programmation de Java à Kotlin peut réduire considérablement le fragment de code: <br><br><img src="https://habrastorage.org/webt/3g/zu/dr/3gzudr28v2o8c3xvmbewzpzqusg.jpeg"><br><br>  PPS: Téléchargez les fichiers du projet ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Java</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kotlin</a> . <br><br><h4>  Note 1 du 20/04/2019: </h4><br>  L'implémentation de l'interface Postman a été supprimée du code de fragment. <br>  Un fragment fonctionne avec une interface via une activité dans laquelle cette interface est déjà implémentée. <br>  Merci à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">mikaakim</a> pour ses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">commentaires</a> . <br>  Les fichiers mis à jour peuvent être téléchargés depuis github sur les liens ci-dessus. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448744/">https://habr.com/ru/post/fr448744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448732/index.html">Hernie intervertébrale? Travailler sur elle</a></li>
<li><a href="../fr448734/index.html">Des drones et des robots aident à sauver la cathédrale Notre-Dame de Paris</a></li>
<li><a href="../fr448738/index.html">Qui chasse les startups?</a></li>
<li><a href="../fr448740/index.html">Nous écoutons de la musique SID (Commodore 64) via OPL3 sur des PC modernes</a></li>
<li><a href="../fr448742/index.html">Pandora's Box: nous analysons l'exploitation de la vulnérabilité WinRAR à l'aide de l'exemple du job NeoQUEST-2019</a></li>
<li><a href="../fr448746/index.html">Index dans PostgreSQL - 7 (GIN)</a></li>
<li><a href="../fr448750/index.html">À propos d'une vulnérabilité qui n'est pas</a></li>
<li><a href="../fr448754/index.html">Qui est qui en open source: biographies de geek</a></li>
<li><a href="../fr448756/index.html">Contexte: pourquoi Apple et Qualcomm se sont disputés, puis se sont réconciliés</a></li>
<li><a href="../fr448758/index.html">Montre intelligente avec BASIC sur 6502 physique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>