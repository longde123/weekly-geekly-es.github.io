<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜó üòò üè¨ Algunas palabras sobre el rendimiento real del hipervisor üéÇ ‚ôÄÔ∏è ‚è¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los usuarios de sistemas virtualizados, y especialmente los proveedores de servicios, a menudo se preguntan: "¬øc√≥mo aprovechar al m√°ximo el hardware d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Algunas palabras sobre el rendimiento real del hipervisor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/virtuozzo/blog/413127/">  Los usuarios de sistemas virtualizados, y especialmente los proveedores de servicios, a menudo se preguntan: "¬øc√≥mo aprovechar al m√°ximo el hardware disponible?"  Y en este contexto, a menudo tenemos que discutir el hipervisor KVM y las diferencias entre las diferentes versiones de Virtuozzo.  En esta publicaci√≥n hablaremos de una serie de pruebas del √∫ltimo sistema de virtualizaci√≥n junto con estimaciones del rendimiento real bajo cargas t√≠picas, as√≠ como teniendo en cuenta los parches Meltdown y Spectre. <br><a name="habracut"></a><br>  ¬øQu√© es lo m√°s importante para una empresa de hosting o para un departamento de TI que necesita organizar el soporte para la cantidad m√°xima de tareas en el equipo existente?  Si una empresa trabaja de acuerdo con un modelo orientado a servicios o vende servicios, la pr√°ctica muestra que lo principal es el indicador de ganancias por servidor.  Qu√© tecnolog√≠as se utilizan al mismo tiempo y debido a que se logra la densidad de distribuci√≥n, los representantes comerciales no est√°n tan preocupados. <br><br>  Sin embargo, la pregunta de por qu√© usamos KVM como hipervisor en Virtuozzo 7, y c√≥mo diferimos de un simple sistema de virtualizaci√≥n OpenSource en este caso, se hace con mucha frecuencia.  Y hoy quiero darle una respuesta. <br><br>  En el pasado, Virtuozzo trabajaba con su propio hipervisor propietario, pero hace varios a√±os nos dimos cuenta de que desarrollarlo es m√°s costoso y m√°s dif√≠cil que optimizar un KVM razonablemente exitoso y eficiente.  Sin embargo, KVM no es un punto de referencia para el rendimiento y, como cualquier plataforma OpenSource, debe actualizarse con un archivo.  Esto es parte de nuestro departamento de desarrollo.  Optimizamos el c√≥digo, lo integramos con la plataforma de almacenamiento de datos y otros componentes, aumentando as√≠ la productividad y la densidad. <br><br><h2>  Comparaci√≥n con otros hipervisores. </h2><br>  Una de las pruebas que utilizamos para medir el rendimiento es la tienda de DVD.  Utiliza un conjunto cl√°sico de software de servidor: Linux, Apache, MySQL, PHP (LAMP).  Dentro de cada m√°quina virtual, la prueba emula el funcionamiento de una tienda de DVD en l√≠nea.  El resultado de la prueba es el n√∫mero de transacciones comprometidas en total en todas las m√°quinas virtuales (eje de ordenadas).  El n√∫mero de m√°quinas virtuales involucradas en la prueba aumenta secuencialmente de 1 a 100 (eje de abscisas). <br><br>  <b><i>L√ÅMPARA: OpenSource QEMU KVM vs Virtuozzo @ CentOS 7.4 (m√°quinas virtuales)</i></b> <br><br><img src="https://habrastorage.org/webt/qi/4e/fl/qi4eflq23yuguz9ok6cmzg8raz8.jpeg">  Como puede ver en los gr√°ficos anteriores, el rendimiento de las m√°quinas virtuales con CentOS Linux 7.4 ejecut√°ndose en el hipervisor Virtuozzo 7 es hasta un 30% m√°s alto que cuando se inicia una carga similar en el KVM est√°ndar.  La mayor diferencia se observa en el punto del sobre-compromiso de la CPU, donde el n√∫mero total de n√∫cleos de procesador asignados a todas las m√°quinas virtuales alcanza el n√∫mero de n√∫cleos f√≠sicos del servidor de la CPU.  Para este servidor, este punto corresponde a 20 m√°quinas virtuales.  Adem√°s, el n√∫cleo de Virtuozzo 7 y la pol√≠tica de gesti√≥n de memoria adaptativa aseguran un funcionamiento estable de las m√°quinas virtuales despu√©s del punto de sobrecompromiso de RAM, donde la cantidad total de RAM asignada a todas las m√°quinas virtuales excede el tama√±o de la memoria f√≠sica del servidor.  Con tal carga, el KVM est√°ndar no puede crear las condiciones para el funcionamiento normal. <br><br>  Se realiz√≥ otra comparaci√≥n entre el hipervisor Virtuozzo 7 y Microsoft Hyper-V 3.0.  Aqu√≠, el rendimiento se evalu√≥ mediante la prueba vConsolidate, y Windows Server 2012 R2 se utiliz√≥ como sistema operativo invitado para m√°quinas virtuales. <br><br>  <i><b>vConsolidate: Hyper-V vs Virtuozzo @ Windows 2012 R2 (m√°quinas virtuales)</b></i> <br><br><img src="https://habrastorage.org/webt/oa/wr/2d/oawr2dcp8-_4yeyql9-nmze9gbs.jpeg" alt="imagen">  A diferencia de la tienda de DVD, en vConsolidate la carga no es la misma para todas las m√°quinas virtuales.  En esta prueba, se dividen en las llamadas CSU (Unidades de acumulaci√≥n de consolidaci√≥n).  Cada CSU es un grupo de cuatro m√°quinas virtuales que cargan SPECjbb, WebBench y SysBench (OLTP).  La cuarta VM en cada CSU est√° inactiva, es decir, sin carga.  El resultado cuantitativo es la media geom√©trica de los resultados de las tres pruebas mencionadas anteriormente obtenidas en total de todas las m√°quinas virtuales (eje de ordenadas).  El n√∫mero de CSU involucradas en la prueba aumenta secuencialmente de 1 a 24 (abscisa). <br><br>  Para ambos hipervisores, la prueba se realiz√≥ dos veces: con parches para las vulnerabilidades Meltdown y Spectre instalados, as√≠ como sin ellos.  La aproximaci√≥n de los resultados muestra que Virtuozzo 7 en promedio muestra un rendimiento 15% mayor que el hipervisor "nativo" de Microsoft. <br><br><h2>  Derretimiento y espectro </h2><br>  Como saben, el 4 de enero de 2018, toda la comunidad de TI estaba entusiasmada por el descubrimiento de vulnerabilidades conceptuales a gran escala en todos los procesadores Intel, con la excepci√≥n de Itanium y Atom anteriores (hasta 2013).  El uso de estas vulnerabilidades permite que cualquier proceso no privilegiado en el sistema acceda a los datos del n√∫cleo (Meltdown) o los datos de otro proceso (Spectre).  Los desarrolladores de software se centraron en lanzar actualizaciones de software para abordar estas vulnerabilidades.  Sin embargo, los usuarios naturalmente ten√≠an preguntas sobre c√≥mo estas actualizaciones afectaban el rendimiento del sistema. <br><br>  Verificamos c√≥mo los parches para Meltdown y Spectre afectan el rendimiento de los contenedores con CentOS Linux 7.4 usando la prueba vConsolidate como ejemplo.  Luego realizamos otra medici√≥n: con el n√∫cleo, un compilador modificado compilado con la opci√≥n "Retpoline" (por ejemplo, GCC y Clang / LLVM ofrecen esta opci√≥n). <br><br>  <i><b>Rendimiento con Retpoline: vConsolidate @ CentOS 7.4 (contenedores)</b></i> <br><br><img src="https://habrastorage.org/webt/5j/yq/ay/5jyqayk6xtygax1r5gdjx9gxuqw.jpeg">  Como puede ver en los gr√°ficos anteriores, la aplicaci√≥n de parches contra Meltdown y Spectre reduce significativamente el rendimiento del contenedor.  Adem√°s, el parche m√°s "dif√≠cil" fue para Spectre-V2.  Sin embargo, el uso del compilador con la nueva opci√≥n Retpoline le permite abandonar con seguridad este parche en sistemas con procesadores m√°s antiguos que Skylake y recuperar hasta un 25% del rendimiento.  Sin embargo, todav√≠a perdimos alrededor del 5% debido a parches para Meltdown y Spectre-V1. <br><br>  <b>Rendimiento con Retpoline: vConsolidate @ CentOS 7.4 (m√°quinas virtuales)</b> <br><br><img src="https://habrastorage.org/webt/wj/ck/u0/wjcku09a37cwgbzhr8jh7jv51py.jpeg"><br>  En el caso de CentOS Linux 7.4, la situaci√≥n dentro de las m√°quinas virtuales es un poco m√°s optimista: los parches para Meltdown y Spectre degradan el rendimiento en solo un 15%, y la diferencia de rendimiento entre el n√∫cleo no parcheado y el n√∫cleo compilado con Retpoline es solo del 1-2%.  Por lo tanto, el uso del nuevo compilador hizo posible compensar casi por completo la ca√≠da en el rendimiento.  Sin embargo, vale la pena considerar que las tres mediciones se realizaron en las mismas m√°quinas virtuales, con n√∫cleos de SO invitados sin parchear.  La actualizaci√≥n de los sistemas operativos invitados generar√° una degradaci√≥n adicional del rendimiento para las aplicaciones del usuario. <br><br>  <i><b>Rendimiento con Retpoline: vConsolidate @ Windows 2012 R2 (m√°quinas virtuales)</b></i> <br><br><img src="https://habrastorage.org/webt/fe/nd/ca/fendcaya-er8f-4cjjafwe_mewq.jpeg"><br><br>  El √∫ltimo gr√°fico de hoy es una comparaci√≥n similar, pero con las m√°quinas virtuales de Windows Server 2012 R2.  Aqu√≠ la desaceleraci√≥n de los parches no fue tan grande y ascendi√≥ a aproximadamente el 10%, y el uso del n√∫cleo con Retpoline permiti√≥ reducir la diferencia al 2-3% en relaci√≥n con el n√∫cleo sin parchear. <br><br><h2>  Conclusi√≥n </h2><br>  Por supuesto, KVM no modificado tiene sus ventajas, y la principal ventaja es que es gratis.  Pero las pruebas realizadas demuestran que las mejoras privadas y la modernizaci√≥n pueden mejorar el rendimiento de la infraestructura utilizada.  Es decir, si necesita colocar un m√°ximo de contenedores y m√°quinas virtuales, garantizar un almacenamiento permanente para ellos, todo en la misma plataforma y con un m√≠nimo de bailes cham√°nicos, el KVM mejorado es mucho m√°s efectivo, especialmente si los servicios que se ejecutan en la plataforma muestran buenos m√°rgenes y brindan real el dinero  En este caso, el costo de las licencias y el soporte m√°s que vale la pena en el menor tiempo posible. <br><br>  La fuerza de VZ7 sigue siendo el soporte de diferentes tipos de m√°quinas virtuales y contenedores en la misma plataforma, y ‚Äã‚Äãcon un mayor rendimiento para cada categor√≠a de objetos virtuales.  Sin embargo, tampoco se puede hablar de una panacea aqu√≠.  Por ejemplo, si un aumento en la densidad no aporta financiaci√≥n adicional a la organizaci√≥n, y su propio personal puede administrar y finalizar las soluciones OpenSource, entonces la l√≥gica tiende a utilizar herramientas abiertas, incluidos CentOS y el KVM original. <br><br>  Por cierto, en la pr√≥xima publicaci√≥n hablaremos sobre la evoluci√≥n de nuestro almacenamiento distribuido y sus capacidades reales para trabajar con m√°quinas virtuales y contenedores. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413127/">https://habr.com/ru/post/es413127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413117/index.html">C√≥mo programar de forma segura en bash</a></li>
<li><a href="../es413119/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 317 (28 de mayo - 3 de junio de 2018)</a></li>
<li><a href="../es413121/index.html">Recorrido fotogr√°fico por el coworking de Mosc√∫ #tceh</a></li>
<li><a href="../es413123/index.html">√öNETE en bases de datos NoSQL</a></li>
<li><a href="../es413125/index.html">La terapia g√©nica brinda a los pacientes peque√±os con atrofia muscular la oportunidad de sobrevivir</a></li>
<li><a href="../es413129/index.html">25 errores de un programador novato</a></li>
<li><a href="../es413133/index.html">Antipatrones populares: paginaci√≥n</a></li>
<li><a href="../es413135/index.html">Asignaci√≥n de prueba de revisi√≥n de c√≥digo de desarrolladores junior react</a></li>
<li><a href="../es413137/index.html">Clasifique grandes cantidades de datos en Apache Spark utilizando modelos arbitrarios de aprendizaje autom√°tico</a></li>
<li><a href="../es413139/index.html">Coches el√©ctricos: se acerca la revoluci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>