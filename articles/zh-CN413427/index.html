<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚏 👩🏽‍🔬 🖼️ 网络工程师编程：使用配置 💅🏿 📷 🆕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="即使在一个良好的网络中，从设计的角度来看，也有必要不时地进行某些实体的配置更新工作。 在进行此类活动的最引人注目的和最预期的原因中，可以注意到迁移是为了协调物理和逻辑平面，作为技术演进过程的一部分的网络发展，所连接网段的体系结构的协调以及增长问题的解决方案。 实际上，网络的生命周期几乎总是由具有一个...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>网络工程师编程：使用配置</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413427/"> 即使在一个良好的网络中，从设计的角度来看，也有必要不时地进行某些实体的配置更新工作。 在进行此类活动的最引人注目的和最预期的原因中，可以注意到迁移是为了协调物理和逻辑平面，作为技术演进过程的一部分的网络发展，所连接网段的体系结构的协调以及增长问题的解决方案。 实际上，网络的生命周期几乎总是由具有一个或另一个风险级别的变化以及对服务的广泛影响组成，在评估中，人为因素不可忽略。 尽管将这种描述概括为人类活动的大多数领域是非常适当的，但是通信网络的功能具有一些功能，值得理解或至少应注意：-通信网络的各个要素处于紧密的通信中，紧密地相互作用并且不仅直接而且间接地呈现。互相影响。 因此，只有在尽可能减少人为错误可能性的机制的支持下，一项正在进行的工作的有效策略才会变得更有成效。 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“网络工程师为什么要编程”</a>系列的下一篇文章中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，</a>我将讨论在这样一项任务中使用自动化的选项。 <br><a name="habracut"></a><br> 在有关网络体系结构的许多“入门”中，就IGP域的设计而言，术语“大规模网络”和“分层网络”几乎是同义词，表示一种简单且乍一看可以理解的设计-将一个域划分为多个域。 同时，饱和阈值只是一个单独的问题，在某些情况下，一台IGP区域中通常可以共存一千个现代路由器，否则三百个就足以显着降低运行特性。 多数情况下，此阈值由施加在IGP上的协议确定，因此，在未来网络的边界和规模存在某些可变性和不确定性的情况下，行业的``野牛''找到了一种更灵活的方法来构建平坦域，随后将其成形零件迁移到单独的区域中。 换句话说，如果您不能“明天看明天”，请建立一个扁平的网络，并根据收敛时间降低或过度利用复杂性的最初迹象将其拆分，因为没有层次结构仍然比不确定情况下选择错误的层次结构更好结构[1、2、3]。 <br><br> 相当笼统的描述和抽象示例，假设我们正在处理OSPFv2域的一个区域，该区域的物理纤维/通道拓扑已经可以识别非晶结构中未来区域的边界。 我不支持以“全有或全无”的原则来改变某件事，可能会由于不可预见的情况而使机会的空间变得太狭窄，预期的风险也太大了。 更改OSPFv2区域是一项破坏性的操作，因此，迁移过程中最直接的方案是在所有拓扑结构中方便使用，该方案包括沿从未来边界向下的顺序将路由器顺序转移到新区域。 幸运的是，不久前，在有关开发OSPF的建议中，概述了在几个领域建立连接的可能性[4]。 利用这个机会，我们可以将迁移分为三个阶段： <br><br><ol><li> 在新区域中建立其他（辅助）连接 </li><li> 将新区域转移到主模式，将旧区域转移到其他模式 </li><li> 删除旧范围内的连接 </li></ol><br> 在第一阶段，新区域的拓扑结构逐渐扩大；在第二阶段，旧区域的拓扑结构变窄。 取决于新旧拓扑的一致性，我们在翻译后的节点和非翻译后的节点之间获得了一致的路由，这又使将阶段划分为独立的子阶段成为可能，在每个阶段都可以使用节点的某些部分来完成。 从特定网络中信道的实际利用的角度出发，建议在子阶段的框架中选择工作节点，以防止在新旧区域的边界重新加载。 尽管该文章专门讨论了编程，但我认为在域变更的情况下对强加给IGP的协议的行为只说几句话并不是多余的。  LDP的行为非常可预测；通过在目标传输地址和接口会话之间提供IP连接，可以实现平滑转换。 由于BGP是一种非常灵活的协议，因此您应该密切注意此平面。 如果BGP不会以“本地首选项”的更改或其他确定节点之间不一致的本地路由决策的标准的形式在转换后的节点上引入特殊的自由，那是很好的。 换句话说，如果区域内的路由选择与遵循的IGP路径规则不冲突，则BGP的行为也是可以预测的。 在两个区域共存的时期，RSVP的工作有一个微妙的地方。 从具有不同可见性的两个来源填充TED表的事实引发了一些思考，例如，您很可能会失去FRR机制，直到工作完成。 如果在两个区域中具有较高可见性的路由器通过具有较低可见性的路由器来计算ERO，即发生ERO，则会发生这种情况。 通过翻译后的网段，而没有有关另一区域的拓扑信息。 这不能称为灾难，因为最终会建立路径，但是您不应忘记它。 特殊技术要求将引入IGP层次结构的工作与在BGP平面中进行的同类工作相结合，例如，通过将全网格迁移到路由反射器中来进行。 在不同平面中引入层次结构最好按顺序进行，在我看来，这同样适用于所有隐藏路由信息的事物，摘要比层次结构IGP的稳定基础更容易建立。 <br><br> 因此，我们有一个总体计划，如果您还没有改变主意，让我们考虑一下Pyez上的软件实现，如图中所示。 <br><br><img src="https://habrastorage.org/webt/xm/0v/4s/xm0v4shfndzjxnvn1rirhmajgdq.png" alt="图片"><br><br> 每个美丽的椭圆形可以是一个单独的软件实体，即 完成工作并为下一步准备数据的事物。 初始数据意味着来自网络的信息，例如，为了准备新的OSPF区域的配置，您需要获取属于旧区域的活动接口的名称及其权重，这意味着我们将需要使用操作表和视图的技能。 这些概念可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“网络工程师编程：第一种情况”</a>系列的上一篇文章中找到。 在第一阶段，生成器将激活新区域所需的命令保存在文件中，在第二阶段-删除旧区域并将新模式转移到主模式，在第三阶段-删除旧区域的命令。 展望未来，我会说，在本文中，我故意不使用Jinja2之类的模板可视化工具。 为了不分散目标主题的影响，编写了尽可能简单的代码。 如果有人对链接<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Jinja2文档”</a>上的文档感兴趣。 <br><br><div class="spoiler">  <b class="spoiler_title">步骤配置生成代码</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) yml = <span class="hljs-string"><span class="hljs-string">''' --- OSPFInterface: rpc: get-ospf-interface-information args: area: '0.0.0.200' detail: True item: ospf-interface view: OSPFInterfaceView OSPFInterfaceView: fields: name: interface-name type: interface-type cost: interface-cost '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) ospf_interfaces = OSPFInterface(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st1-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-string"><span class="hljs-string">'ge'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interface.name ): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st2-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.250'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ospf_interface.cost != <span class="hljs-string"><span class="hljs-string">'0'</span></span>): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st3-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre> <br></div></div><br> 为了清楚起见，我将这样的网络放在vMX上。 <br><br><img src="https://habrastorage.org/webt/mk/hr/6i/mkhr6ig4wjo3n4hxkswba2xej4q.png" alt="图片"><br><br>  vMX是瞻博网络（Juniper Networks）的功能齐全的软件路由器，在很大程度上重复了其较老的兄弟MX的行为。 并不是说它是一种必须引入的产品，它对于将这些东西方便地用于编程练习或实验室测试非常有用。 可以在此处<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">下载试用版“ vMX试用版下载”</a> ，并在此链接<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“准备系统以安装vMX”</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">下载</a>安装说明。 <br><br> 路由器bb，abr1和abr2形成零区域，路由器r1，r2，r3和r4-应从第200个区域移至第250个区域。 <br><br><div class="spoiler">  <b class="spoiler_title">lab @ bb&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { passive; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ abr1&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ abr2&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ r1&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r2&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r3&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r4&gt;显示配置协议</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre> <br></div></div><br> 对于r2路由器，将生成以下命令集。 <br><br><div class="spoiler">  <b class="spoiler_title">对于第一阶段</b> <div class="spoiler_text">  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 1.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 1.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 1.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 2.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 2.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 2.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 3.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 3.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 3.0公制1</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">第二阶段</b> <div class="spoiler_text">  <i>删除协议ospf区域0.0.0.200</i> <i><br></i>  <i>删除协议ospf区域0.0.0.250</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 1.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 1.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 1.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 1.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 1.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 2.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 2.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 2.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 2.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 2.0度量标准1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 3.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 3.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 3.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口ge-0 / 0 / 3.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口ge-0 / 0 / 3.0公制1</i> <i><br></i>  <i>设置协议ospf区域0.0.0.250接口lo0.0接口类型p2p</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口lo0.0辅助</i> <i><br></i>  <i>设置协议ospf区域0.0.0.200接口lo0.0接口类型p2p</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">第三阶段</b> <div class="spoiler_text">  <i>删除协议ospf区域0.0.0.200</i> <i><br></i> <br></div></div><br> 正如我已经写过的，网络的元素具有内部状态，无论它们是否需要，它们周围和内部都会不断发生某些事情。 在工作期间，必须考虑并考虑发生收发器故障，节点断电或光通道中断等事件。 我建议在选择验证迁移阶段是否成功的背景下注意这一事实。 不管这听起来有多矛盾，在这种情况下，我们都不必检查OSPF邻居是否出现在该接口上，因为缺少OSPF的原因可能在完全不同的平面上。 除上述内容外，错误或不准确性总是会进入源数据中，例如，以必须删除的已遗忘接口的形式出现，但当前正在寻找“空”。 在生成检查的过程中，从提供的服务和所施加的协议的角度上一层来看网络是很有用的，因为最终只有这些事情的状态才能使您对特定阶段的成功做出明智的决定。 很少有客户同意基于他们工作成果的公开文章，这就是为什么我将虚拟环境放在一起进行演示的原因。 在这种环境下，我将仅限于检查BGP会话的状态，这些会话是在路由器之间一对一的基础上构建的，这将是我们强加的服务和服务。 如果在工作后以IP连接的形式满足了各自的性能条件，则有理由相信该工作已成功完成。 在实际项目中，检查通常限于所施加的服务和协议的数量，这在给定网络中被指定为关键业务。 但是，这不适用于编程，我只能关注这个问题，因为选择成功标准是完成工作后保持良好睡眠的关键。 <br><br><div class="spoiler">  <b class="spoiler_title">BGP会话验证码</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> yml = <span class="hljs-string"><span class="hljs-string">''' --- BGPGroup: rpc: get-bgp-group-information args: group-name: 'int' item: bgp-group view: BGPGroupView BGPGroupView: fields: count: peer-count established: established-count '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) bgp_group = BGPGroup(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bgp_group: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (group.count != group.established): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'bgp connection lost'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'dont panic!'</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">他的工作成果</b> <div class="spoiler_text"> 调试-SSH连接到10.83.20.68 <br> 调试-SSH连接建立到主机10.83.20.68 <br> 调试-建立名为r1的连接10.83.20.68 <br> 不要惊慌！ <br> 调试-SSH连接到10.83.20.69 <br> 调试-SSH连接建立到主机10.83.20.69 <br> 调试-建立名为r2的连接10.83.20.69 <br> 不要惊慌！ <br> 调试-SSH连接到10.83.20.70 <br> 调试-SSH连接建立到主机10.83.20.70 <br> 调试-建立名为r3的连接10.83.20.70 <br> 不要惊慌！ <br> 调试-SSH连接到10.83.20.71 <br> 调试-SSH连接建立到主机10.83.20.71 <br> 调试-建立名为r4的连接10.83.20.71 <br> 不要惊慌！ <br> 调试-SSH连接到10.83.20.66 <br> 调试-SSH连接建立到主机10.83.20.66 <br> 调试-建立名为abr1的连接10.83.20.66 <br> 不要惊慌！ <br> 调试-SSH连接到10.83.20.67 <br> 调试-SSH连接建立到主机10.83.20.67 <br> 调试-建立名为abr2的连接10.83.20.67 <br> 不要惊慌！ <br></div></div><br> 到目前为止，我们主要讨论的是某些网络方面的内容，但是我仍然没有提及有关程序代码的字样，在该名称的文章中，它似乎是关注的焦点。 首先，在我看来，思想比代码重要得多，因为头脑中有了形式化的实体，工程师才能将其变成工具并以代码的形式陈述。 其次，我不想重复我自己，在这些示例中似乎并不明显的所有内容，以及开始使用Python和Pyez所需的最低知识，都包含在本系列的上一篇文章中。 第三，配置准备代码执行其工作，该工作称为脱机并且对网络没有立即影响，因此不太可能引起任何关注。 与实现阶段的实现代码有所不同；这些过程的开发提出了以下问题： <br><br><ul><li> 如何检查口译员是否充分理解了命令的全部内容 </li><li> 如何验证对配置所做的更改已应用？ </li><li> 如何实现事务配置方案？ </li><li> 在失去控制的情况下如何回滚配置？ </li><li> 如果解释器在命令传输期间报告错误，该如何清理？ </li></ul><br> 对这些问题的关注越多，执行阶段的惊喜就越少。 想象一下，当解释器仅部分批准该策略的分类器时，语法错误会描述路由策略。 如果不逐行控制此策略与当前配置的合并过程，则可以通过单击按钮将设备堆置于不足的状态。 因此，我大致遵守执行阶段图的这样一个方框。 <br><br><img src="https://habrastorage.org/webt/ou/kz/8q/oukz8qzqdaq9oqp6weqsg9-xpu4.png" alt="图片"><br><br> 有了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pyez</a>文档，便编译了以下通用配置加载程序代码，您可以在日常工作中使用它们，就像我在我的使用过程中一样。 <br><br><div class="spoiler">  <b class="spoiler_title">conf_change.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.utils.config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> copy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> traceback <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.exception <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path yml = <span class="hljs-string"><span class="hljs-string">''' --- VersionInfo: rpc: get-software-information item: software-information view: VersionInfoView VersionInfoView: fields: name: host-name '''</span></span> Device.auto_probe = <span class="hljs-number"><span class="hljs-number">3</span></span> ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> cur_stage=<span class="hljs-string"><span class="hljs-string">'2'</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTestOSPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF : at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d_conf = p_dev.cli(<span class="hljs-string"><span class="hljs-string">"show configuration | display set"</span></span>).split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) ret_val = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> set_found = <span class="hljs-number"><span class="hljs-number">0</span></span> c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(c_path, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f: c_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'delete '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c_line): set_found = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (c_line <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> d_conf) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (c_line != <span class="hljs-string"><span class="hljs-string">''</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF found missing line '</span></span> + c_line ret_val = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> f.close() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (set_found == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (f_do == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret_val <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> doTestOSPF(p_dev, p_node, f_do) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> v = VersionInfo(l_dev).get() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) traceback.print_exc() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCompare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCompare at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.diff() == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCompare : conf.diff at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doLoad at '</span></span> + p_node c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (os.path.isfile(c_path)): p_conf.load(path=c_path, format=<span class="hljs-string"><span class="hljs-string">'set'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doLoad : cant load config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_r)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doRollback at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.rollback(rb_id=p_r) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doRollback : cant rollback config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommitCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommitCheck at '</span></span> + p_node p_conf.commit_check() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommitCheck : cant config commit check config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_confirm_m=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommit at '</span></span> + p_node commit_res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p_confirm_m == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): commit_res = p_conf.commit(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: commit_res = p_conf.commit(confirm=p_confirm_m, timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (commit_res == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> CommitError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> c_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : cant config commit at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(c_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> RpcTimeoutError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> t_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : config was commited at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' with the following ex:'</span></span> + str(t_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> Config(p_dev) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> conf: is_compare = doCompare(conf, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : at config compare '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : configuration locked at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- starting to do config changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doLoad(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.load '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commit check at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommitCheck(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.doCommitCheck failed at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> commit_m = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commiting changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(conf, node, commit_m) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.commit '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after commit at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : cant do job '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> node_list = [] result_list = {} <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(ip_f_name, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_ip: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f_ip: c_ip_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c_ip_line != <span class="hljs-string"><span class="hljs-string">''</span></span>): node_list.append(c_ip_line) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ************************************ '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking '</span></span> + node result_list.setdefault(node, {}) cur_dev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) is_test = doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- error'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf exist'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'nn'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf not exist, doing change'</span></span> is_job = doJob(cur_dev, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- done job at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- going sleep at '</span></span> + node time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking job status '</span></span> + node cur_dev_confirm = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( cur_dev_confirm != <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- commiting the configuration at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(Config(cur_dev_confirm), node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant commit the configuration at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- configuration commited at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant find conf after job '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev_confirm) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant access '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' for commiting'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> result_list</code> </pre><br></div></div><br> 而他的工作成果分三个阶段 <br><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"> <code>Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:19:30) [MSC v.1500 32 bit (Intel)] on win32 <br> Type "copyright", "credits" or "license()" for more information. <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br></code> <br></div></div><br><ol><li> 完整的IS-IS路由协议-Hannes Gredler，Walter Goralski </li><li>  OSPF协议  Internet路由协议剖析-John T. Moy </li><li> 网络合并和迁移：Junos的设计和实现-Gonzalo Gomez Herrero，Jan Anton Bernal Van Der Ven </li><li>  OSPF多区域邻接<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-tools.ietf.org/html/rfc5185</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN413427/">https://habr.com/ru/post/zh-CN413427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN413415/index.html">Netflix中的自适应并发限制</a></li>
<li><a href="../zh-CN413417/index.html">能源效率：我们在俄罗斯测试的方法</a></li>
<li><a href="../zh-CN413419/index.html">PostgreSQL新闻摘要。 第七期</a></li>
<li><a href="../zh-CN413421/index.html">程序员生涯中可能存在的不确定性</a></li>
<li><a href="../zh-CN413423/index.html">火星IS中的远程访问解决方案</a></li>
<li><a href="../zh-CN413429/index.html">我们正在编写一个插件来接收“让我们加密”通配符证书</a></li>
<li><a href="../zh-CN413431/index.html">关于开发Solidity智能合约的研讨会</a></li>
<li><a href="../zh-CN413433/index.html">65％的俄罗斯IT专业人员想在国外工作</a></li>
<li><a href="../zh-CN413435/index.html">遗传学之外的遗传</a></li>
<li><a href="../zh-CN413437/index.html">一切的使者</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>