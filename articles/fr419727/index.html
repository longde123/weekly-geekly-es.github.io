<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤞🏾 👩🏻‍💼 👨🏼‍⚖️ Harbor - un registre pour les conteneurs Docker prêts à l'emploi 🌟 🎲 🐊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le 31 juillet, la CNCF a annoncé l'adoption d'un nouveau projet Open Source, décrit comme un «registre natif du cloud», dans son bac à sable (c'est-à-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Harbor - un registre pour les conteneurs Docker prêts à l'emploi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/419727/">  Le 31 juillet, la CNCF a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">annoncé</a> l'adoption d'un nouveau projet Open Source, décrit comme un «registre natif du cloud», dans son bac à sable (c'est-à-dire au stade de support le plus précoce), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Harbor</a> .  Sur son site Internet, ils nous expliquent que le produit a été créé pour gérer des images de conteneurs Docker dans un environnement sûr. <br><br><img src="https://habrastorage.org/webt/to/ed/6i/toed6ijlvl_n0r90t6rgvmzbixa.png"><br><br>  Il semblerait qu'il existe déjà un Docker Registry (ou, disons, Quay de CoreOS), mais il est évident que de nouvelles solutions n'apparaissent pas et ne mûrissent pas aux applications de production comme ça - en particulier les solutions Open Source ... et plus encore, tombant dans CNCF.  Cet article de revue vise à faire la lumière sur les raisons de l'apparition de Harbour, ses principales caractéristiques et fonctionnalités. <a name="habracut"></a><br><br><h2>  Priorité de Harbour: réseau et entreprise </h2><br>  L'histoire du projet commence en 2016, en mars dont la première version publique a eu lieu - 0.1.0.  Derrière sa création se trouvaient des ingénieurs <b>VMware</b> qui ont décrit le projet comme un «serveur de registre de classe entreprise», qui, sur la base du développement de Docker, «étend les capacités du Docker Registry en y ajoutant plus de fonctionnalités qui sont généralement requises par l'entreprise». <br><br>  À cette époque, l'accent était davantage mis sur la possibilité d'utiliser ce registre au sein de l'entreprise, notamment en améliorant potentiellement la productivité en stockant des images sur le réseau de l'entreprise: «[Harbour] est très utile pour les utilisateurs de conteneurs qui n'ont pas une bonne connexion Internet.  Par exemple, Harbor augmente la productivité des développeurs chinois en éliminant la difficulté de télécharger des images à partir d'Internet public » <i>(de <a href="">README à Harbor 0.1.0</a> )</i> . <br><br>  <i><b>Remarque</b> : l'orientation de Harbour vers la Chine, confirmée par la présence d'une localisation appropriée dès les premières versions, n'était pas fortuite: la création du projet en tant que tel a été <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">initiée par</a> la division chinoise de l'entreprise (VMware China R&amp;D).</i> <br><br>  Ce qui est devenu un événement quotidien pour l'écosystème natif du cloud, Harbor a été <b>écrit dans la langue Go</b> dès le début et sous licence selon les termes de la licence Apache 2.0.  Si nous parlons des capacités fonctionnelles du projet, alors dans la première version, les auteurs ont présenté à ce jour certaines caractéristiques pertinentes, telles que: <br><br><ul><li>  contrôle d'accès basé sur les <b>rôles</b> ( <b>RBAC</b> , qui vous permet d'organiser les utilisateurs et les référentiels en tant que «projets» et d'accorder différents droits aux images dans ces projets), ainsi que la prise en charge LDAP et AD pour l'authentification des utilisateurs; </li><li>  personnalisée <b>interface Web</b> pour la navigation dépôts, recherche à travers eux, la gestion de projet; </li><li>  <b>audit de</b> toutes les opérations; </li><li>  <b>API REST</b> pour la gestion. </li></ul><br><img src="https://habrastorage.org/webt/jj/jw/gx/jjjwgxrboqn0rq3tpcut7_ydbqc.png"><br>  <i>Gestion de projet dans Harbor Web UI</i> <br><br><h2>  Harbor Evolution: Sécurité </h2><br>  En 2017, VMware a trouvé une application logique pour son nouveau projet - l'intégration avec d'autres solutions d'entreprise pour les conteneurs.  En particulier, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>vSphere Integrated Containers</b></a> (VIC), qui, n'étant pas un PaaS (Platform as a Service) à part entière ou un CaaS (Containers as a Service), se développait activement, offrait une sorte de base pour travailler avec des conteneurs.  Aujourd'hui, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vSphere Integrated Containers Engine</a> , qui est le runtime de conteneur pour vSphere, en est issu.  Et voici comment l'ingénieur de solution VMware (Nate Reid) décrivait VIC à l'époque: <br><br><blockquote>  <i>«VIC prend le cadre d'un seul hôte Docker et l'adapte à plusieurs hôtes ESXi.</i>  <i>Son architecture proposée pour l'orchestration est similaire à Swarm, Kubernetes (K8s) et Mesos.</i>  <i>Cependant, il y a quelques nuances et il n'y a aucune tâche pour remplacer tous ces produits.</i>  <i>VIC fournit un réseau pour les conteneurs, vous permet d'obtenir leurs noms, offre RBAC, un panneau de contrôle HTML5 (Admiral; en savoir plus à ce sujet dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre revue GUI pour Docker</a> - <b>environ Transl.</b> ), Un registre au niveau de l'entreprise (Harbour), de nombreuses commandes Docker similaires, Intégration avec les outils vSphere.</i>  <i>[..]</i> <i><br><br></i>  <i>Si vous avez besoin de la prise en charge de l'orchestration Kubernetes et / ou des capacités CI / CD basées sur VMware IaaS de VMware, vous devriez jeter un œil à VMware PKS et / ou Pivotal Cloud Foundry.</i>  <i>Ce sont déjà des solutions CaaS et PaaS. »</i> </blockquote><br>  Dans le même temps, la question de la <b>sécurité des images Docker</b> devient de plus en plus pertinente.  Début 2018, les ingénieurs de la «fraternelle» de la société VMware Pivotal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">citent</a> une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">étude</a> selon laquelle même les dernières versions d'images publiées sur le Docker Hub (à la fois de la communauté et officielles) contiennent de nombreuses vulnérabilités (en moyenne 70 par image). <br><br>  C'est alors que Harbour est apparu avec sa nouvelle mission axée sur la sécurité, et déjà sur le «terrain» susmentionné de CaaS - dans le <b>Pivotal Container Service (PKS)</b> : <br><br><blockquote>  <i>«Ces [vulnérabilités et autres problèmes de sécurité dans les images Docker] sont la raison pour laquelle nous avons inclus tant de modules complémentaires utiles qui rendent PKS fiable et sécurisé!»</i>  <i>[..]</i> <i><br><br></i>  <i>Étant donné que Kubernetes ne traite pas à lui seul de tels problèmes [gestion sécurisée des images], nous avons travaillé avec des amis VMware pour inclure Harbor dans PKS. »</i> </blockquote><br>  Qu'est-ce qui est si sûr ajouté à Harbour (en plus du RBAC et de l'audit déjà mis en œuvre dans le projet)?  Deux directions principales sont indiquées: <br><br><ol><li>  <b>Analyse de vulnérabilité</b>  Pour ce faire, Harbour implémente CVE à partir de bases de données bien connues (NIST NVD, Ubuntu CVE Tracker, Red Hat Security Data, etc.) et scanne automatiquement chaque image de conteneur pour leur présence lors de l'exécution d'opérations push et pull.  Si une vulnérabilité est trouvée, les opérations sont annulées en fonction des paramètres de sécurité et l'image elle-même est marquée, qui sera visible par l'administrateur du registre.  Pour saisir cette opportunité, Harbor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s'intègre</a> à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>Clair</b></a> de CoreOS. </li><li>  <b>La signature des images</b> .  Il utilise également les réalisations d'un autre projet - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>Notaire</b></a> <i>(nous l'avons mentionné dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> )</i> , qui crée une signature lors de la transmission d'images, puis valide ces signatures à chaque traction. </li></ol><br>  L'application générale de Harbour dans PKS est la suivante: <br><br><img src="https://habrastorage.org/webt/va/2s/cz/va2sczdfs6gzhomzofl4gb3mioi.png"><br><br><h2>  Port aujourd'hui </h2><br>  Ainsi, en proposant un registre d'images de conteneurs à utiliser sur place et en assurant la sécurité dans divers aspects de leur utilisation, Harbor a aujourd'hui évolué vers l'architecture suivante, qui combine apparemment des fonctions d'autres projets Open Source: <br><br><img src="https://habrastorage.org/webt/5w/5i/lx/5w5ilxohbp2zf-6l5suz8fdieec.png"><br><br>  En plus du Docker Registry déjà mentionné, Clair et Notary, qui implémentent les fonctionnalités clés de Harbor, vous pouvez également voir deux SGBD dans ce schéma: <br><br><ol><li>  PostgreSQL ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">auparavant</a> MySQL / MariaDB était ici), qui est utilisé pour stocker des métadonnées sur les projets, les utilisateurs et leurs rôles, les images; </li><li>  Redis - pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">stocker des sessions</a> . </li></ol><br><img src="https://habrastorage.org/webt/gt/zm/lx/gtzmlxpeuwevt1bugxmhqa4s2h4.jpeg"><br>  <i>Bases de données en architecture portuaire</i> <br><br>  Vous pouvez également <i>trouver des détails</i> sur le périphérique interne général de Harbour sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette page wiki</a> , qui est liée à la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle du</a> projet <i>(cependant, on soupçonne que certains détails sur l'architecture pourraient être obsolètes à certains endroits)</i> .  Vous y trouverez également des liens vers <a href="">les</a> instructions d' <a href="">installation de Harbour</a> et son <a href="">déploiement sur Kubernetes</a> .  Ce dernier, cependant, est déclaré obsolète (basé sur des versions plus anciennes, ne prend pas en charge Clair et Notary), et il est plutôt proposé d'utiliser le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Helm-chart</a> . <br><br>  La version actuelle de Harbor est la <a href="">v1.5.2</a> , sortie fin juillet.  La configuration requise pour la machine Linux sur laquelle la dernière version du registre est installée est Docker version 17.03.0-ce (ou supérieure) et Docker Compose 1.10.0+, ainsi que Python et OpenSSL. <br><br>  <b>La prise en charge des graphiques Helm</b> semble être une innovation très intéressante pour la future version de Harbor ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v1.6.0-rc1</a> a déjà été publiée): «Harbor, à partir de la version 1.6.0, deviendra un registre natif du cloud composite qui prendra en charge à la fois la gestion des images et la gestion des graphiques» .  D'autres <a href="">plans de développement</a> incluent la prise en charge d'OAuth 2.0 pour l'authentification des utilisateurs, la possibilité de déployer sur plusieurs sites pour la tolérance aux pannes et l'équilibrage de charge, la collecte de statistiques sur les référentiels et un utilitaire pour la migration vers Harbour. <br><br><h2>  Au lieu d'une conclusion </h2><br>  Harbor est un exemple de projet réussi du monde du cloud moderne, qui a réussi à trouver sa niche et à s'imposer, tout en intégrant les capacités d'autres outils Open Source.  La preuve de son succès n'est pas seulement l'inclusion de CNCF dans la liste des projets, mais aussi plus de 5000 étoiles sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> , et une communauté de développeurs assez active. <br><br><h2>  PS </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Guide CNCF des solutions Open Source (et plus) pour le cloud natif</a> "; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OPA et SPIFFE - Deux nouveaux projets au CNCF pour la sécurité des applications cloud</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quatre CNCF publient 1.0 et des annonces majeures sur Kubernetes avec KubeCon 2017</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gestionnaire de packages pour Kubernetes - Helm: Past, Present, Future</a> »; </li><li>  "La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CNCF a offert un cloud gratuit aux projets Open Source pour DevOps / microservices</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Statistiques sur les systèmes d'exploitation de base en images sur le Docker Hub</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419727/">https://habr.com/ru/post/fr419727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419715/index.html">Vous ne savez pas comment travailler avec les transactions</a></li>
<li><a href="../fr419717/index.html">Conception d'une architecture d'application embarquée</a></li>
<li><a href="../fr419719/index.html">[signet] 23 recommandations pour protéger les applications Node.js</a></li>
<li><a href="../fr419721/index.html">Biomarqueurs du vieillissement. Panel de fragilité. Partie 1</a></li>
<li><a href="../fr419725/index.html">Fléchettes, dés et pièces: algorithmes de distribution discrets</a></li>
<li><a href="../fr419729/index.html">Événement caritatif «Donner des ailes aux enfants»</a></li>
<li><a href="../fr419731/index.html">Mini-revue de l'imprimante 3D photopolymère dentaire MoonRay S</a></li>
<li><a href="../fr419733/index.html">Git arrive! 6 Erreurs Git courantes et comment les corriger</a></li>
<li><a href="../fr419735/index.html">Examen du signal I / Q avec SDR à l'aide d'Adobe Audition</a></li>
<li><a href="../fr419743/index.html">Quel est le problème avec les articles populaires qui disent que foo est plus rapide que bar?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>