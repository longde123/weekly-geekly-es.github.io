<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëø üëµüèø üíø √Ä propos du fonctionnement d'un PC en utilisant l'exemple de Windows 10 et du clavier, partie 1 üë∂üèæ üß° üó°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'appelle Andrey Artemyev, je travaille chez Microsoft sur le noyau de Windows 10, j'ai pr√©c√©demment travaill√© sur Windows 10x (WCOS), XBox, Window...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä propos du fonctionnement d'un PC en utilisant l'exemple de Windows 10 et du clavier, partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483330/"><img src="https://habrastorage.org/getpro/habr/post_images/168/a19/873/168a198732c9cf76e19132b28ceaf04d.png" alt="image"><br><br>  Je m'appelle Andrey Artemyev, je travaille chez Microsoft sur le noyau de Windows 10, j'ai pr√©c√©demment travaill√© sur Windows 10x (WCOS), XBox, Windows Phone et Microsoft Edge.  Je veux populairement √† des fins √©ducatives raconter comment l'ordinateur fonctionne sur l'exemple de la saisie au clavier et de Windows 10. Cette s√©rie d'articles est con√ßue principalement pour les √©tudiants de sp√©cialit√©s techniques.  Nous allons consid√©rer quel chemin les informations sur la touche enfonc√©e du clavier vont afficher dans Notepad.exe.  En raison de l'immensit√© et de l'interdisciplinarit√© du sujet, il peut y avoir des inexactitudes dans les articles, qui sont rapport√©es dans les commentaires.  Certaines informations peuvent √™tre obsol√®tes en raison de la vitesse √† laquelle Windows se d√©veloppe. <br><a name="habracut"></a><br><h3>  √Ä quelle profondeur plongons-nous dans le sujet? </h3><br>  Parlons d'abord des niveaux auxquels un ordinateur peut √™tre consid√©r√©.  Chaque niveau est bas√© sur le pr√©c√©dent.  Commen√ßons par le haut. <br><br>  <i>Niveau d'application</i> .  Toutes les applications utilisateur se trouvent ici, c'est un navigateur, Microsoft Office, un bloc-notes, ainsi que le serveur Web IIS, SQL Server, divers middleware comme Java et .Net et tous les langages de script, qu'il s'agisse de fichiers Ruby, PHP ou Bat. <br><br>  <i>Niveau du syst√®me d'exploitation</i> .  Le syst√®me d'exploitation peut √™tre consid√©r√© comme: <br><br><ul><li>  Gestionnaire de ressources - m√©moire, disques durs, imprimantes, √©cran, clavier, ressources limit√©es partag√©es par les programmes ex√©cut√©s sur l'ordinateur. </li><li>  Machine virtuelle - un fichier est un bon exemple d'un objet virtuel.  Il repr√©sente une abstraction des donn√©es sur disque, une API pour travailler avec, et ajoute √©galement le concept de droits d'acc√®s.  Au lieu d'un fichier, il pourrait y avoir le concept d'un conteneur de donn√©es et d'une API compl√®tement diff√©rente.  Il existe de nombreux objets virtuels de ce type dans le syst√®me d'exploitation. </li><li>  Platform - OS fournit des mod√®les logiciels et des primitives pour la cr√©ation de programmes.  Par exemple, Windows Drivers Framework vous permet de d√©velopper rapidement des pilotes, les fen√™tres de Windows sont utilis√©es pour cr√©er des interfaces utilisateur complexes.  Dll - fournit un mod√®le pour √©tendre les fonctionnalit√©s du programme via des plugins, ainsi qu'un m√©canisme pour impl√©menter un lecteur d'√©cran via des pi√®ges √† clavier (voir le crochet LowLevelKeyboard). </li></ul>  Le syst√®me d'exploitation est divis√© en couches et composants.  En g√©n√©ral, l'architecture de Windows 10 ressemble √† ceci.  Nous en parlerons en d√©tail un peu plus tard. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a8/b8d/4c8/5a8b8d4c8c9538c8dc7e8ed97882ff90.png" alt="image"></div><br>  <i>Niveau d'architecture informatique</i> .  Il est repr√©sent√© par une carte m√®re, qui a un facteur de forme sp√©cifique, des fonctions int√©gr√©es cod√©es dans des microcircuits appel√©s un jeu de puces et des ports √† travers lesquels il est possible d'√©tendre les fonctionnalit√©s d'un ordinateur en connectant une carte graphique, une carte r√©seau, une m√©moire vive (RAM) suppl√©mentaire, des disques durs, un clavier, etc. Les ports affectent la vitesse et les capacit√©s de l'ordinateur, qui d√©terminera son objectif, qu'il s'agisse d'un serveur pour traiter des milliers de requ√™tes par seconde, d'une tablette pour utiliser Internet ou d'un PC de jeu avec plusieurs vid√©os  arty.  OS r√©sume les fonctionnalit√©s de la carte m√®re. <br><br>  Les microcircuits ressemblent √† l'image ci-dessous et sont un mini-ordinateur qui ex√©cute des programmes simples pour des t√¢ches de bas niveau, par exemple, lit les donn√©es du clavier et les transf√®re plus loin pour qu'elles atteignent le processeur en fin de compte.  En r√®gle g√©n√©rale, ils sont mis en ≈ìuvre comme un microcircuit analogique non programmable ou un microcontr√¥leur programmable en C. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/352/c4e/d2f/352c4ed2f9d9a581dd63afc6561f2b84.png" alt="image"></div><br><br>  La carte m√®re peut √™tre consid√©r√©e comme une colonie de microcircuits qui communiquent entre eux via des bus et √† travers eux les donn√©es des appareils connect√©s au processeur et vice versa circulent.  Le jeu de puces est une sorte de syst√®me nerveux informatique.  Toutes les puces de la carte m√®re ont √©t√© cr√©√©es √† l'origine pour fonctionner ensemble.  Certains d'entre eux peuvent avoir des fonctions sp√©ciales, par exemple, un minuteur ou un stockage des param√®tres du BIOS.  Le plus important d'entre eux est peut-√™tre celui qui a un programme int√©gr√© (firmware, BIOS, UEFI) qui commence √† fonctionner d√®s que l'√©lectricit√© appara√Æt.  Elle trouve le disque dur avec le chargeur de d√©marrage Windows et lui transf√®re le contr√¥le, qui √† son tour lance le fichier ex√©cutable du syst√®me d'exploitation, qui peut √™tre appel√© Windows10.exe, en fait NtOsKrnl.exe.  Le BIOS sait quoi rechercher gr√¢ce √† un accord entre les fabricants de mat√©riel et les syst√®mes d'exploitation. <br><br>  Autour de la carte m√®re, vous pouvez assembler un t√©l√©phone mobile, une console de jeu, une station serveur ou un appareil intelligent.  Dans l'image ci-dessous, les facteurs de forme courants des cartes m√®res. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/970/4b1/225/9704b1225b1a0a9308b395a918c9490c.png" alt="image"></div><br>  <i>Le niveau de microarchitecture</i> est repr√©sent√© par le processeur (CPU), c'est le c≈ìur de la carte m√®re et l'ensemble du jeu de puces est n√©cessaire pour entretenir le CPU.  Un processeur est un ordinateur dans un ordinateur, un microcontr√¥leur plus puissant et avanc√© qui n'a pas besoin de micrologiciel, car le flux de commandes arrive √† la vol√©e lorsque le planificateur de threads a chang√© le contexte du processeur.  La fonction du processeur est divis√©e en sous-syst√®mes, par exemple, un composant impliqu√© dans les op√©rations math√©matiques et logiques, un coprocesseur math√©matique et un cache.  Certains d'entre eux √©taient autrefois une puce s√©par√©e sur la carte m√®re, mais ils font maintenant partie du CPU, par exemple, un contr√¥leur d'interruption et une puce appel√©e North Bridge, ce qui a augment√© la vitesse de travail. <br><br>  La microarchitecture n'est pas la m√™me chose que l' <i>architecture</i> .  Toutes les fonctionnalit√©s du CPU sont divis√©es en composants qui fonctionnent ensemble.  Ces composants et leur interaction sont la microarchitecture.  Dans l'organigramme ci-dessous, ils sont repr√©sent√©s par des rectangles et des carr√©s color√©s. <br><br><div class="scrollable-table"><table><tbody><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/e7e/755/180/e7e755180f7556d131c52d5bae9e4bbb.png" alt="image" width="130"></td><td><img src="https://habrastorage.org/getpro/habr/post_images/879/214/4bf/8792144bf447a9af66f11fb803d4f082.png" alt="image" align="right"></td></tr></tbody></table></div><br>  <i>L'architecture du processeur</i> est essentiellement un document qui d√©crit les fonctionnalit√©s qu'il doit avoir pour correspondre, par exemple, √† l'architecture x86, x64 ou ARM utilis√©e sur les appareils mobiles.  Ce document d√©crit les commandes, les affectations de registre et la logique d'op√©ration √† prendre en charge.  Les cr√©ateurs de processeurs Intel, AMD, Elbrus peuvent impl√©menter cette fonctionnalit√© √† leur guise et y ajouter de nouvelles fonctionnalit√©s sous forme de commandes, registres, drapeaux, interruptions et si le syst√®me d'exploitation les conna√Æt, il peut les utiliser.  En termes de POO, l'architecture CPU est l'interface, et la microarchitecture est sa mise en ≈ìuvre. <br><br>  <i>Circuits logiques</i> .  Les rectangles color√©s du diagramme de bloc CPU sont constitu√©s de circuits logiques qui effectuent leurs op√©rations sur des s√©quences de z√©ros et de uns.  Le processeur voit toutes les donn√©es et instructions sous forme de bits (0 et 1), selon la formule, tout nombre d√©cimal peut √™tre repr√©sent√© comme une s√©quence de 0 et 1, mais ce qu'un nombre particulier signifie d√©pend du contexte.  Il peut s'agir d'un code, d'un nombre, d'une lettre.  L'unit√© arithm√©tique et logique (ALU) peut ajouter deux nombres par le biais d'op√©rations au niveau du bit.  Les algorithmes au niveau du bit d'addition, de soustraction, de multiplication et de division sont connus depuis longtemps; les d√©veloppeurs du circuit logique n'ont qu'√† les impl√©menter efficacement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/295/ec3/90e/295ec390e94e6f5a747108c18a90718d.png" alt="image"></div><br>  Les circuits num√©riques fonctionnent avec des donn√©es au niveau des z√©ros et des uns, tandis que les circuits analogiques reposent sur l'exploitation des lois de la physique.  Ils effectuent de simples manipulations de bits, telles que des d√©calages, AND, OR, XOR.  Gr√¢ce √† ces primitives, des op√©rations plus complexes sont mises en ≈ìuvre.  L'image ci-dessous montre l'op√©rateur ET analogique impl√©ment√© via des transistors.  En sortie du circuit, une tension non nulle n'existera que si elle est sur les deux contacts d'entr√©e (Bx1 et Bx2), sinon z√©ro volt.  L'op√©rateur &amp;&amp; en C # fonctionne de la m√™me mani√®re.  Les circuits num√©riques sont finalement bas√©s sur l'analogique.  Les √©l√©ments physiquement logiques dans les circuits logiques peuvent √™tre mis en ≈ìuvre non seulement de mani√®re √©lectronique mais √©galement m√©canique, hydraulique, optique et autres. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/861/bc3/9db/861bc39db7794a592e6e58896a363e0b.png" alt="image"></div><br>  <i>Le niveau des radio√©l√©ments</i> .  Les circuits physiquement analogiques reposent sur des √©l√©ments radio qui exploitent r√©ellement les lois de la physique.  Ce sont principalement des semi-conducteurs, c'est-√†-dire  sous certaines conditions, ils peuvent conduire l'√©lectricit√©, mais pas.  La diode conduit le courant dans une seule direction, si elle n'est pas soud√©e, tourn√©e √† 180 ¬∞ et soud√©e en retour, le courant ne la traversera pas.  Le transistor ne fait passer le courant que s'il y a de la tension sur la branche de commande.  L'humanit√© a appris √† rendre les transistors microscopiques et, par cons√©quent, ils peuvent √™tre plac√©s sur une petite planche par millions.  Dans les images ci-dessous, des √©l√©ments radio semi-conducteurs et un transistor conventionnel √† c√¥t√© d'un nano transistor sous un microscope √©lectronique. <br><div class="scrollable-table"><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/n-/ux/k5/n-uxk5c1ocjoowqllgwa6rcpt8a.png" alt="image"></div><br></td><td><img src="https://habrastorage.org/getpro/habr/post_images/c55/e83/c82/c55e83c825722050e5e461a8a6521c52.png" alt="image"><br></td></tr></tbody></table></div>  <i>Le niveau des lois de la physique</i> .  Et enfin, le niveau le plus bas est le niveau des lois de la physique qui sont enferm√©es dans les radio√©l√©ments semi-conducteurs. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/78b/e31/48d/78be3148d40c073b92a9b33b744cb3a3.png" alt="image"></div><br>  Nous parlerons beaucoup du niveau OS et un peu moins de l'architecture informatique, de la microarchitecture, des circuits analogiques et des √©l√©ments radio.  Pour la derni√®re partie, vous devez comprendre comment tout cela fonctionne ensemble. <br><br><h3>  Bases du syst√®me d'exploitation </h3><br>  Lorsque nous sommes all√©s au langage d'assemblage √† l'universit√©, de nombreux √©tudiants ont eu la stupeur de mots aussi intelligents que ¬´modes noyau et utilisateur¬ª, sous lesquels un syst√®me d'authentification de r√¥le vraiment bien connu est cach√© sous tous, sur tous les sites, il y a au moins un ¬´Admin¬ª avec acc√®s √† toutes les pages et l '¬´Utilisateur¬ª ayant un acc√®s limit√©.  De la m√™me mani√®re, le r√¥le "Core" a acc√®s √† toutes les capacit√©s du CPU, et le r√¥le "User" peut ne pas provoquer toutes les commandes du processeur et pas avec tous les arguments.  En plus de ce mod√®le de r√¥le, le syst√®me d'exploitation est construit sur le principe de l'architecture client-serveur, o√π le serveur est le noyau qui impl√©mente la fonctionnalit√© du syst√®me d'exploitation et le client est des programmes utilisateur.  Dans le monde du Web, le client et le serveur sont physiquement s√©par√©s - ce sont deux ordinateurs diff√©rents communiquant via le r√©seau.  Dans le syst√®me d'exploitation, le client et le serveur vivent sur la m√™me machine et sur le m√™me mat√©riel.  Le serveur dispose d'une certaine API qui permet aux clients de changer son √©tat, par exemple, l'API Twitter vous permet de cr√©er des publications, de vous connecter et de t√©l√©charger un flux de tweet sur un client mobile.  Windows a une API Win, qui n'est que plus encombrante en raison d'un √©ventail de t√¢ches plus large; aujourd'hui, Windows a environ 330 000 API plus une API pour les applications UWP.  Si les concepts de Twitter sont plus ou moins clairs pour tout le monde - publication, utilisateur, flux - alors les concepts de l'OS peuvent n√©cessiter un approfondissement int√©rieur.  Par cons√©quent, les API Windows peuvent √™tre difficiles √† comprendre sans comprendre la structure interne du syst√®me d'exploitation. <br><br>  <i>En fait, le noyau signifie trois choses diff√©rentes.</i>  <i>Le noyau est comme tout le code OS.</i>  <i>Le noyau en tant que sous-syst√®me responsable des m√©canismes de syst√®me d'exploitation, tels que le planificateur de threads, le changement de contexte, la gestion des interruptions, l'√©change de m√©moire virtuelle en physique (noyau) et le sous-syst√®me de noyau pour prendre en charge d'autres syst√®mes d'exploitation - CSRSS.exe (Windows), PSXSS.exe (POSIX), OS2SS.exe (OS / 2) ou WSL (sous-syst√®me Windows pour Linux).</i>  <i>Dans ce contexte, la premi√®re signification est comprise - tout le code OS.</i> <br><br>  Lorsqu'une fen√™tre appara√Æt √† l'√©cran, une structure de donn√©es appara√Æt dans la partie serveur du syst√®me d'exploitation (mode noyau) qui d√©crit cette fen√™tre - sa position sur l'√©cran, sa taille, le texte du titre, la fonction de la fen√™tre √† travers laquelle le syst√®me d'exploitation permet √† l'application de r√©pondre aux √©v√©nements.  Comme il existe de nombreux sous-syst√®mes dans le syst√®me d'exploitation, il peut y avoir plusieurs structures de donn√©es d√©crivant un objet, par exemple, des informations sur le processus utilisateur se trouvent dans les composants: <br><br><ul><li>  <i>Ex√©cutif</i> - voici la logique de l'OS.  Cette couche v√©rifie ce que les processus peuvent et ne peuvent pas faire.  Ce fichier contient des informations sur le processus parent, les param√®tres de d√©marrage du processus (Process Environment Block), le compte utilisateur associ√©, le nom du fichier exe du processus. </li><li>  <i>Les</i> m√©canismes du <i>noyau</i> - OS tels qu'un planificateur de threads sont impl√©ment√©s ici.  Il stocke combien de temps le processus passe en mode utilisateur et noyau, √† quels processeurs ses threads sont attach√©s, la priorit√© de base des threads de processus. </li><li>  <i>Sous</i> - <i>syst√®me de fen√™trage</i> - informations sur les objets GDI qui sont utilis√©s pour dessiner dans la fen√™tre.  Ce sont des primitives telles que des pinceaux, un stylo, etc. </li><li>  <i>DirectX</i> - tout ce qui concerne DirectX: shaders, surfaces, objets DX, compteurs de performances GPU, param√®tres de m√©moire pour la m√©moire graphique. </li><li>  <i>Le sous-syst√®me Windows</i> repr√©sent√© par le processus CSRSS.exe ( <i>sous</i> - <i>syst√®me d'</i> ex√©cution client-serveur).  Windows supportait auparavant OS POSIX (processus PSXSS.exe) et OS / 2 (OS2SS.exe).  √Ä cette √©poque, l'id√©e est venue de faire de Windows le m√™me sous-syst√®me, mais cela a √©t√© lent et une partie de CSRSS.exe a donc √©t√© transf√©r√©e vers win32k.sys, qui est maintenant divis√© en plusieurs fichiers - win32k.sys, win32kbase.sys et win32kfull.sys.  Les informations sur les donn√©es de groupe de processus, le niveau d'arr√™t, les donn√©es de session, etc. sont stock√©es ici. </li></ul><br>  La prise en charge de POSIX et OS / 2 √©tait plus probablement formelle, car pour transf√©rer le programme √† partir de ces syst√®mes d'exploitation, vous deviez trouver le code source et le recompiler de mani√®re sp√©ciale pour obtenir un fichier exe dans lequel tous les appels √† l'API OS √©taient redirig√©s vers PSXdll.dll (NETAPI.DLL et DOSCALLS.DLL pour OS / 2 et User32.dll pour les applications Windows), qui √©tait un wrapper fin sur l'API Windows.  L'√©tat de certaines API a √©t√© stock√© dans le processus du sous-syst√®me PSXSS.exe (OS2SS.exe).  √âtant donn√© que toutes les API ne peuvent pas √™tre mapp√©es sur 1 √† 1, un tel programme a fonctionn√© de mani√®re instable.  Le support Linux a √©t√© ajout√© dans Windows 10 et cela fonctionne d'une mani√®re compl√®tement diff√©rente.  Le sous-syst√®me Linux est h√©berg√© en mode noyau et la diff√©rence entre le sous-syst√®me Windows pour Linux et Linux est approximativement la m√™me qu'entre diff√©rentes versions.  Surtout pour WSL, un nouveau type de processus a √©t√© introduit - le processus PICO. <br><br>  <i>Qu'est-ce qu'un composant?</i>  <i>Il s'agit d'une fonctionnalit√© regroup√©e logiquement.</i>  <i>Un composant peut √™tre appel√© une classe OOP, dll, dossier, ensemble de fonctions avec un pr√©fixe commun, un espace de noms, une couche dans l'architecture.</i> <br><br><h3>  Plus d'informations sur le partitionnement client-serveur </h3><br>  La s√©paration du client et du serveur est mise en ≈ìuvre √† l'aide de la fonctionnalit√© int√©gr√©e du processeur, du partage de m√©moire et des v√©rifications logicielles. <br><br>  Les fabricants d'√©quipements collaborent avec les d√©veloppeurs du syst√®me d'exploitation, par cons√©quent, le processeur dispose de m√©canismes cr√©√©s en tenant compte des besoins des cr√©ateurs de syst√®mes d'exploitation.  Dans tous les processeurs modernes, le m√©canisme de r√¥le d'utilisateur est impl√©ment√©, o√π l'utilisateur est compris comme le code actuellement ex√©cutable.  Dans les applications Web, le r√¥le de l'utilisateur connect√© est stock√© dans une variable et, en plus du nom clair Admin ou User, a un ID de ce r√¥le, qui est souvent utilis√© lors de l'autorisation, car la comparaison des nombres est plus rapide et plus facile que les cha√Ænes.  Dans le processeur, le r√¥le de l'utilisateur actuel est stock√© dans un champ appel√© ¬´anneau de s√©curit√©¬ª, et non ¬´CurrentUser.Role.Id¬ª.  Dans la plupart des processeurs, ce champ prend quatre valeurs de 0 √† 3. Windows utilise 0 pour le r√¥le appel√© ¬´Mode noyau¬ª, car il s'agit du mode le plus privil√©gi√© et la plus grande valeur pour le r√¥le est ¬´Mode utilisateur¬ª, car il s'agit du r√¥le le plus limit√©.  Les r√¥les restants ne sont pas utilis√©s car la diff√©rence entre 0 et 1, 2 et 3 est n√©gligeable.  Ces r√¥les limitent les pages de m√©moire qui peuvent √™tre adress√©es, vous ne pouvez pas appeler certaines instructions ou vous ne pouvez pas les appeler avec certains arguments.  Il existe √©galement des restrictions sur l'utilisation de la technologie des ports d'E / S pour l'√©change de donn√©es avec des p√©riph√©riques tels qu'un clavier, mais elle n'a pas √©t√© utilis√©e depuis 10 ans.  Le passage en mode noyau s'effectue via la commande syscall, qui, par index, trouve la fonction √† appeler dans le tableau de pointeurs vers les API Windows.  Un pointeur vers ce tableau est stock√© dans un registre de processeur sp√©cial lors du d√©marrage du syst√®me d'exploitation. <br><br>  J'ai sp√©cifiquement appel√© le registre CPU un champ.  Lorsque vous √©crivez un programme en C #, vous pouvez ajouter autant de champs √† votre classe que vous le souhaitez et leur donner des noms conviviaux.  Pour les processeurs et les microcontr√¥leurs, les champs sont appel√©s registres.  Lorsque vous concevez un morceau de fer, vous devez d√©j√† comprendre √† ce stade le nombre de registres (champs) dont vous avez besoin, leur taille et la fonctionnalit√© √† leur attribuer, afin que cela soit suffisant pour toutes les occasions pour toutes les situations imaginables et inconcevables.  Imaginez que vous avez besoin d'√©crire un programme dans un langage de programmation de type C # qui a 16 champs pr√©d√©finis dans la classe et que vous ne pouvez pas utiliser de variables locales.  C'est-√†-dire  le m√™me champ peut √™tre utilis√© pour stocker l'utilisateur connect√©, le tableau tri√©, les donn√©es temporaires ou le r√©sultat de la m√©thode.  Les noms de ces champs doivent √™tre aussi communs que possible, au lieu de tempData, funcResult, il y aura des noms √©tranges EAX, AH, AL, DX, etc. Si vous avez √©crit un √©mulateur du processeur sur l'architecture x86 en C #, le code pourrait ressembler √† ceci (DIV - diviser, commande division enti√®re): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/714/e34/338/714e34338ea1330cc82b04d548fb25b0.png" alt="image"></div><br>  Pour illustrer, j'ai ajout√© une v√©rification du mode noyau.  En cas d'erreur de division par z√©ro, le processeur avertit le syst√®me d'exploitation via une interruption (d√©clenche un √©v√©nement).  Au d√©marrage, le syst√®me d'exploitation fournit au processeur un tableau unidimensionnel de pointeurs vers une fonction appel√©e vecteur d'interruption, o√π chaque index correspond √† une sorte d'√©v√©nement, par exemple, une division par z√©ro.  Le syst√®me d'exploitation conna√Æt l'architecture du processeur sur lequel il s'ex√©cute et peut donc organiser les pointeurs de fonction dans un tableau.  Le CPU appelle cette fonction et l'OS a son propre code.  Par exemple, Windows recherche dans le Registre si un d√©bogueur est install√© et affiche un message indiquant qu'une erreur s'est produite et qu'il est possible d'ex√©cuter un d√©bogueur pour rechercher l'emplacement o√π il s'est produit.  Une interruption est appel√©e interruption car elle intervient dans le cours normal de l'ex√©cution du programme et permet au gestionnaire d'interruption de s'ex√©cuter et ce n'est qu'apr√®s son ach√®vement que le processeur peut retourner √† l'ex√©cution du programme. <br><br>  Les interruptions peuvent √™tre g√©n√©r√©es non seulement par le processeur mais √©galement par des p√©riph√©riques externes (clavier, souris) ou un code de programme.  Le planificateur de threads d√©finit un temporisateur qui, √† des intervalles d'un quantum (par d√©faut, environ 15 ms, dans Windows Server plus) g√©n√®re une interruption afin d'attribuer un autre thread pour l'ex√©cution selon l'algorithme interne.  L'ex√©cution pas √† pas du programme dans Visual Studio repose √©galement sur le m√©canisme d'interruption - un indicateur est d√©fini sur le processeur, ce qui, apr√®s chaque commande, provoque une interruption qui est trait√©e par le moteur de d√©bogage Windows et notifi√©e via l'API Visual Studio. <br><br>  Le partage de m√©moire est impl√©ment√© gr√¢ce √† la m√©moire virtuelle.  J'ai dit plus t√¥t que le syst√®me d'exploitation est un gestionnaire de ressources et une machine virtuelle.     1 RAM 32  Windows          4 , ..    1,   4.              (  ).              .         4096  (4),  : <br><br><ul><li>  . . CPU      ,         .         ,    ,      ,    ,     .          . </li><li>    ,        .   RAM        4.      RAM ,        . </li><li>        ,         ( new  ++)       / . Exe-     ,                 c .    . </li><li>    RAM  .                           / -     .       RAM  ,         ,     .  Windows 10   ,   . </li></ul><br> Windows 10       ,    ‚Äî    (  ),        . <br><div class="scrollable-table"><table><tbody><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/960/f15/ba2/960f15ba232ef507dc327a742ec9b63b.png" alt="image"></td><td><img src="https://habrastorage.org/getpro/habr/post_images/d81/9c5/c68/d819c5c68f4a10b9bc924ef54dbc84f8.png" alt="image"></td></tr></tbody></table></div> 64     16 ,  18,446,744,073,709,551,616  .         RAM      48  ,  16   .  Win x64     ,      .    ,  64  Windows ‚Äú‚Äù 256 Tb .  8TB     IA64  7TB  x64.     Windows 10 ‚Äî 2TB,        .   RAM  Windows 10     ,    . <br><br> <i>     (HEX) ,     ?       ,              .           ,    ‚Äî    . CPU       ‚Äî       CPU         .  HEX         .     , 32  ( 64)   .   ‚Äî    ,   HEX       ,    . <br></i> <br>     - ( - )     .                 /     .        -,       . <br><br><h3>    Windows? </h3><br>                Windows    - .    -   ‚Äî  , , dll, .         *.sys, *.dll ,     API        ,      C,     .      C++.      : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a8/b8d/4c8/5a8b8d4c8c9538c8dc7e8ed97882ff90.png" alt="image"></div><br>        : <br><br><ul><li> <i>Hyper-V Hypervisor</i> ‚Äî      Windows    .  ,  Hyper-V     ,              ,           . </li><li> <i>HAL.dll</i> ‚Äî Hardware Abtraction Layer ‚Äî       ‚Äî ,  ,  ‚Äî       Windows      HAL.dll,        .        ,   ,  .    ,       -   ACPI.sys. <br><br> <i>  Advanced Configuration and Power Interface?  1996       UI,                . <br></i> <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/425/8b8/115/4258b811515337cc25af8634a22f5e03.png" alt="image"></div><br>  1996    ACPI,            , ..          . ACPI       ,   CD drive, ..      . <br></li><li> <i>Device Drivers</i> ‚Äî    .         *.sys,          ,            . Process Explorer  SysInternals          . </li><li> <i>Kernel</i> ‚Äî <i>Kernel Mode Execution Environment</i> ,   ,   ,  ,    .     . </li><li> <i>Executive</i> ‚Äî    ,      - . </li><li> <i>Windowing &amp; Graphics</i> ‚Äî    DirectX       . </li><li> <i>NtDll.dll</i> ‚Äî                      .   dll   ,       ( ..  dll)    . Nt   Native,       Native American.  C'est-√†-dire  API  ,     .      dll   Nt (NtDestroyMenu).  Win API         User32.dll.          NtDll.dll,    Nt*       (level of indirection) ‚Äî subsystem dll   User32.dll  PSXdll.dll  DOSCALLS.DLL      Windows. NtDll.dll        ( <b>S</b> ession <b>M</b> anagement <b>S</b> ub <b>S</b> ystem <b>.exe</b> , <b>Win</b> dows <b>Init</b> itialize <b>.exe</b>  .),       . </li><li> <i>SubSystem dlls</i> ‚Äî        .  Windows      User32.dll. - API            ,    Nt*   NtDll.dll,   CreateFile     NtCreateFile). </li><li> <i>Environment Subsystems</i> ‚Äî CSRSS.exe,  Windows.     POSIX ( PSXSS.exe)  OS/2 (OS2SS.exe). Windows Subsystem for Linux   -. </li><li> <i>System Processes</i> ‚Äî       ,   LSASS.exe (Local Security Authority SubSystem)       . </li><li> <i>Service Processes</i> ‚Äî   Windows ( Plug and Play Manager)       *.exe .     SvcHost.exe      ,    *.dll-.         SvcHost'. </li><li> <i>User Processes</i> ‚Äî  .        ‚Äî , ,    .        . </li></ul><br>     .       . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483330/">https://habr.com/ru/post/fr483330/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483318/index.html">Bot pour surveiller les services Web en une demi-heure: t√©l√©gramme + bash + cron</a></li>
<li><a href="../fr483320/index.html">Cr√©ation d'un mus√©e m√©di√©val VR</a></li>
<li><a href="../fr483322/index.html">D√©veloppement d'API REST - quelle est l'approche Code First?</a></li>
<li><a href="../fr483324/index.html">Processus flexibles dans l'√©quipe informatique</a></li>
<li><a href="../fr483328/index.html">API REST - Qu'est-ce que HATEOAS?</a></li>
<li><a href="../fr483332/index.html">CES 2020, IBM et la premi√®re v√©ritable utilisation commerciale du nouvel ordinateur quantique</a></li>
<li><a href="../fr483336/index.html">Am√©liorations de C ++ Inliner: The Zipliner</a></li>
<li><a href="../fr483340/index.html">ICD a lanc√© une qu√™te de r√©alit√© augment√©e</a></li>
<li><a href="../fr483342/index.html">Python dans Visual Studio Code - Version de janvier 2020</a></li>
<li><a href="../fr483344/index.html">Documents .NET Nouveaut√©s (d√©cembre 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>