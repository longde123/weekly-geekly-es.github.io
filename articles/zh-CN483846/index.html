<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕴🏼 🏠 ◽️ Linux上的替代窗口管理 👋🏿 ⛵️ 👼🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我是采用Caps Lock切换布局的人之一，因为我懒于在可以按2个键时按2个键。 我什至想要2个不必要的键：我会用一个打开英语版式，第二个用俄语。 但是第二个不必要的键是调用上下文菜单，这是不必要的，以至于许多笔记本电脑制造商都将其删除。 因此，您必须对自己拥有的东西感到满意。 


 而且，当我切...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux上的替代窗口管理</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483846/"><p> 我是采用Caps Lock切换布局的人之一，因为我懒于在可以按2个键时按2个键。 我什至想要2个不必要的键：我会用一个打开英语版式，第二个用俄语。 但是第二个不必要的键是调用上下文菜单，这是不必要的，以至于许多笔记本电脑制造商都将其删除。 因此，您必须对自己拥有的东西感到满意。 </p><br><p> 而且，当我切换窗口时，我不想在任务栏上查找它们的图标，也不需要在滚动<em>Alt + Tab</em>时浏览名称，在桌面中滚动等。我想按一个组合键（理想情况下，是一个，但是没有免费的不必要的键） ），然后立即进入我需要的窗口。 例如，像这样： </p><br><ul><li>  Alt + F：Firefox </li><li>  Alt + D：Firefox（私人浏览） </li><li>  Alt + T：终端 </li><li>  Alt + M：计算器 </li><li>  Alt + E：IntelliJ创意 </li><li> 等 </li></ul><br><p> 此外，通过按例如<em>Alt + M，</em>无论该程序当前是否正在运行<em>，</em>我都希望看到计算器。 如果正在运行，则需要为其窗口指定焦点，否则，请启动所需程序并在加载时转移焦点。 </p><br><p> 对于以前方案未涵盖的情况，我想拥有通用的键盘快捷键，您可以轻松地为它们分配任何打开的窗口。 例如，我有10个从<em>Alt +1</em>分配到<em>Alt + 0的</em>组合，这些组合没有与任何程序绑定。 我可以按<em>Alt + 1，</em>而当按下<em>Alt + 1时</em> ，当前处于焦点的窗口将获得焦点。 </p><br><p> 在剪切下，描述了几个其他功能以及如何执行此操作的答案。 但是，我会立即警告您，“为您自己”进行这样的自定义设置可能会导致沉迷，甚至在必要时中断使用Windows，Mac OS或什至是其他人的Linux计算机。 </p><a name="habracut"></a><br><p> 实际上，如果您考虑一下，那么我们每天不会使用很多程序。 浏览器，终端，IDE，某种通讯工具，文件管理器，计算器，也许几乎就是这些。 不需要很多按键组合即可覆盖95％的日常任务。 </p><br><p> 对于具有多个打开的窗口的程序，可以将其中之一指定为主窗口。 例如，打开了几个IntelliJ Idea窗口，并将它们分配给<em>Alt +E。</em> 在正常情况下，按<em>Alt + E</em>将打开该程序的某些窗口，很可能是最先打开的窗口。 但是，如果在此程序的一个窗口已处于焦点状态时按<em>Alt + E</em> ，则此窗口将被指定为主窗口，并且在随后按下组合键时会将焦点转移到该窗口。 </p><br><p> 可以重新分配主窗口。 为此，您首先需要重置组合，然后为其分配另一个窗口作为主窗口。 要重置组合，您需要先按组合本身，然后按特殊的重置组合，我已将其分配给<em>Alt + Backspace</em> 。 这将调用一个脚本，该脚本将取消为先前的组合分配主窗口。 然后，您可以按照上一段所述分配一个新的主窗口。 将绑定的窗口重置为通用组合是相似的。 </p><br><p> 简介很长，但我想先说一下我们将要做什么，然后再解释如何做。 </p><br><h2 id="dlya-teh-komu-nadoelo-chitat"> 对于那些厌倦阅读的人 </h2><br><p> 简而言之，本文结尾处的脚本链接。 </p><br><p> 但都是一样，它将无法正常工作并立即安装和使用。 首先，您必须弄清楚脚本如何找到正确的窗口。 没有这个，就无法告诉脚本确切的焦点。 而且，您需要了解如果突然找不到合适的窗口该怎么办。 </p><br><p> 而且，我不会重点介绍如何通过按组合键来配置脚本执行。 例如，在KDE中，它位于系统设置→快捷方式→自定义快捷方式中。 在其他窗口管理器中，也应该如此。 </p><br><h2 id="znakomstvo-s-wmctrl"> 介绍wmctrl </h2><br><p>  <em>Wmctrl</em>是用于与X Window Manager进行交互的控制台实用程序。 这是一个关键脚本程序。 让我们快速看一下如何使用它。 </p><br><p> 首先，列出打开的窗口： </p><br><pre><code class="plaintext hljs">$ wmctrl -lx 0x01e0000e -1 plasmashell.plasmashell N/A Desktop — Plasma 0x01e0001e -1 plasmashell.plasmashell N/A Plasma 0x03a00001 0 skype.Skype N/A Skype 0x04400003 0 Navigator.Firefox N/A Google  - Mozilla Firefox 0x04400218 0 Navigator.Firefox N/A     /  - Mozilla Firefox (Private Browsing) ...</code> </pre> <br><p>  <em>-l</em>选项显示所有打开的窗口的列表， <em>-x</em>将类名称（ <em>skype.Skype</em> ， <em>Navigator.Firefox</em>等）添加到输出中。 我们将需要窗口ID（第1列），类名（第3列）和窗口名（最后一列）。 </p><br><p> 您可以尝试使用<em>-a</em>选项激活某些窗口： </p><br><pre> <code class="plaintext hljs">$ wmctrl -a skype.Skype -x</code> </pre> <br><p> 如果一切按计划进行，则Skype窗口应出现在屏幕上。 如果使用<em>-i</em>选项而不是<em>-x</em>选项，则可以指定窗口ID而不是类名。 使用id的问题是，每次应用程序启动时，窗口id都会更改，而我们无法提前知道它。 另一方面，此属性唯一地指示一个窗口，当应用程序打开多个窗口时，这可能很重要。 关于此进一步。 </p><br><p> 在这一阶段，我们需要记住，我们将根据<em>wmctrl -lx</em>的输出使用regex搜索所需的窗口。 但这并不意味着我们必须使用复杂的东西。 通常，一个类名或窗口名就足够了。 </p><br><p> 原则上，基本思想应该已经明确。 在窗口管理器的全局热键/快捷方式设置中，我们配置所需的组合以执行脚本。 </p><br><h2 id="kak-polzovatsya-skriptami"> 如何使用脚本 </h2><br><p> 首先，您需要安装控制台实用程序<em>wmctrl</em>和<em>xdotool</em> ： </p><br><pre> <code class="plaintext hljs">$ sudo apt-get install wmctrl xdotool</code> </pre> <br><p> 接下来，您需要下载脚本并将其添加到<em>$ PATH中</em> 。 我通常把它们放在<em>〜/ bin中</em> ： </p><br><pre> <code class="plaintext hljs">$ cd ~/bin $ git clone https://github.com/masyamandev/Showwin-script.git $ ln -s ./Showwin-script/showwin showwin $ ln -s ./Showwin-script/showwinDetach showwinDetach</code> </pre> <br><p> 如果没有<em>〜/ bin目录</em> ，则必须创建该<em>目录</em>并重新启动（或登录），否则<em>〜/ bin</em>将不会进入<em>$ PATH</em> 。 如果一切都正确完成，则应该可以从控制台访问脚本，并且Tab键完成应该可以工作。 </p><br><p> 主要的<strong>showwin</strong>脚本有2个参数：第一个是regex，通过它我们将搜索所需的窗口，第二个参数是如果找不到所需的窗口必须执行的命令。 </p><br><p> 您可以尝试执行脚本，例如： </p><br><pre> <code class="plaintext hljs">$ showwin "Mozilla Firefox$" firefox</code> </pre> <br><p> 如果安装了Firefox，则应将焦点放在其窗口上。 即使Firefox没有运行，它也应该已经启动。 </p><br><p> 如果结果是这样，那么您可以尝试将命令的执行配置为组合。 在全局热键/快捷方式设置中，添加： </p><br><ul><li>  Alt + F：showwin“ Mozilla Firefox $” firefox </li><li>  Alt + D：showwin“ Mozilla Firefox（私有浏览）$”“ firefox -private-window” </li><li>  Alt + C：showwin“铬浏览器。铬浏览器N *”铬浏览器 </li><li>  Alt + X：showwin“铬浏览器。铬浏览器I *”“铬浏览器-隐身” </li><li>  Alt + S：showwin“ skype.Skype” skypeforlinux </li><li>  Alt + E：showwin“ jetbrains-idea” idea.sh </li></ul><br><p> 等等，每个人都可以根据自己的需要配置密钥和软件的组合。 <br> 如果一切正常，则根据上述组合，我们可以通过简单的按键在窗口之间切换。 </p><br><p> 我会让Chrome爱好者感到失望：将普通窗口与<em>wmctrl输出</em>区分开来是隐身的，它们具有相同的类名和窗口标题。 在建议的正则表达式中，仅需要字符N *和I *，以便这些正则彼此不同，并且可以为它们指定不同的窗口作为主要窗口。 </p><br><p> 要重置先前组合的主窗口（实际上是正则表达式，它是最后一次调用<strong>showwin</strong>的主窗口），您需要调用<strong>showwinDetach</strong>脚本。 我已将此脚本分配给<em>Alt + Backspace</em>组合键。 </p><br><p>  <strong>showwin</strong>脚本还有另一个功能。 当用一个参数调用它时（在这种情况下，该参数只是一个标识符），它根本不检查正则表达式，并认为所有窗口都适用。 就其本身而言，这似乎毫无用处，但是通过这种方式，我们可以将任何窗口指定为主窗口，然后快速切换到该特定窗口。 </p><br><p> 我已经配置了这样的组合： </p><br><ul><li>  Alt + 1：showwin“ CustomKey1” </li><li>  Alt + 2：showwin“ CustomKey2” </li><li>  ... </li><li>  Alt + 0：showwin“ CustomKey0” </li><li>  Alt +退格键：showwinDetach </li></ul><br><p> 这样，我可以将任何窗口绑定到<em>Alt + 1</em> ... <em>Alt + 0</em>组合。 只需按<em>Alt + 1</em> ，即可将当前窗口绑定到此组合。 我可以先按<em>Alt + 1</em> ，再按<em>Alt + Backspace</em>解除绑定。 或关闭窗口，这也可以。 </p><br><p> 此外，我将讲一些技术细节。 您无法阅读它们，而只是尝试进行配置和查看。 但是我仍然建议您先了解其他人的脚本，然后再在您的计算机上运行它们：)。 </p><br><h2 id="kak-razlichat-raznye-okna-odnogo-prilozheniya"> 如何区分一个应用程序的不同窗口 </h2><br><p> 原则上，“ wmctrl -a skype.Skype -x”的第一个示例正在运行并且可以使用。 但是，让我们再次看一下Firefox的示例，其中打开了2个窗口： </p><br><pre> <code class="plaintext hljs">0x04400003 0 Navigator.Firefox N/A Google  - Mozilla Firefox 0x04400218 0 Navigator.Firefox N/A     /  - Mozilla Firefox (Private Browsing)</code> </pre> <br><p> 第一个窗口是普通模式，第二个窗口是“私人浏览”。 我想将这些窗口视为不同的应用程序，并使用不同的组合键切换到它们。 </p><br><p> 您需要使切换窗口的脚本复杂化。 我使用了这个解决方案：显示所有窗口的列表，使用正则表达式制作<em>grep</em> ，使用<em>head</em>提取第一行，使用<em>cut</em>获取第一列（这将是窗口ID），然后通过ID切换到窗口。 </p><br><p> 关于正则表达式和两个问题应该开个玩笑，但实际上我不使用任何复杂的东西。 我需要常规字符，以便可以指示行尾（“ $”字符），并区分“ Mozilla Firefox $”和“ Mozilla Firefox（私人浏览）$”。 </p><br><p> 该命令如下所示： </p><br><pre> <code class="plaintext hljs">$ wmctrl -i -a `wmctrl -lx | grep -i "Mozilla Firefox$" | head -1 | cut -d" " -f1`</code> </pre> <br><p> 在这里，您已经可以猜测脚本的第二个功能：如果grep没有返回任何内容，则所需的应用程序未打开，您需要通过从第二个参数执行命令来运行它。 然后定期检查右窗口是否已打开以使其聚焦。 我不会专注于此，需要它的人将查看源代码。 </p><br><h2 id="kogda-okna-prilozheniya-ne-razlichimy"> 当无法区分应用程序窗口时 </h2><br><p> 因此，我们已经学会了将焦点转移到所需应用程序的窗口。 但是，如果打开一个应用程序的多个窗口怎么办？ 我应该关注哪一个？ 上面的脚本很可能会传递到第一个打开的窗口。 但是，我们希望有更多的灵活性。 我希望能够记住我们需要哪个窗口并切换到该窗口。 </p><br><p> 想法是这样的：如果我们想记住某个按键组合的窗口，那么当所需的窗口聚焦时，我们需要按此组合。 随后，当按下此组合键时，将把焦点放在该特定窗口上。 直到窗口关闭或我们对此<strong>showwinDetach</strong>脚本<strong>组合</strong>进行重置。 </p><br><p>  <strong>showwin</strong>脚本<strong>算法</strong>如下所示： </p><br><ul><li> 检查以查看我们之前是否记得焦点应该传递给的窗口的ID。 <br> 如果您还记得这样的窗口仍然存在，那么我们将焦点转移到该窗口并退出。 </li><li> 我们查看当前处于哪个窗口中，如果它适合我​​们的请求，那么我们将记住它的ID，以便日后转到该窗口并退出。 </li><li> 如果存在的话，我们至少转到一些合适的窗口，或者打开所需的应用程序。 </li></ul><br><p> 您可以使用控制台实用程序xdotool找出当前聚焦于哪个窗口，将其输出转换为十六进制格式： </p><br><pre> <code class="plaintext hljs">$ printf "0x%08x" `xdotool getwindowfocus`</code> </pre> <br><p> 记住bash中的某些内容是在内存中的虚拟文件系统中创建文件的最简单方法。 在Ubuntu上，默认情况下在<em>/ dev / shm /</em>中将其连接。 关于其他发行版本，我无话可说，希望这一点也存在。 您可以看到以下命令： </p><br><pre> <code class="plaintext hljs">$ mount -l | grep tmpfs</code> </pre> <br><p> 该脚本将在此文件夹中创建空目录，如下所示： <em>/ dev / shm / $ USER / showwin / $ SEARCH_REGEX / $ WINDOW_ID</em> 。 此外，每次调用时，它将在<em>/ dev / shm / $ USER / showwin / $ SEARCH_REGEX</em>上创建符号链接<em>/ dev / shm / $ USER / showwin /</em> <em>showwin_last</em> 。 如果需要，可以使用<strong>showwinDetach</strong>脚本删除特定组合的窗口ID。 </p><br><h2 id="chto-mozhno-uluchshit"> 有什么可以改善的 </h2><br><p> 首先，必须手动配置脚本。 当然，由于需要深入研究并进行大量操作，因此许多人甚至都不会尝试配置系统。 如果有可能只是简单地放置软件包和配置所有内容，那么也许它将获得一定的普及。 在那儿，看看标准分布，它们会使应用程序更加强大。 </p><br><p> 也许更容易做到。 如果窗口的ID允许您找到创建窗口的进程的ID，并找出哪个团队创建了该进程的ID，则可以使配置自动化。 实际上，我不明白我在本段中写的内容是否可行。 事实是，对我个人而言，它适合现在的工作方式。 但是，如果对于我以外的人来说，整个方法似乎很方便并且有人对其进行了改进，那么我将很乐意使用最佳解决方案。 </p><br><p> 正如我已经写过的，另一个问题是在某些情况下无法将窗口区分开。 到目前为止，我只在铬/铬隐身状态下看到过这种情况，但也许在其他地方也有类似情况。 在极端情况下，总会有通用组合<em>Alt + 1</em> ... <em>Alt + 0</em>的变体。 同样，我使用Firefox，就我个人而言，此问题并不严重。 </p><br><p> 但是对我来说，一个重要的问题是我使用Mac OS进行工作，却无法在其中进行任何配置。  <em>它</em>似乎能够提供<em>wmctrl</em>实用程序，但在Mac OS上却无法真正使用。 可以使用<em>Automator</em>应用程序完成某些操作，但是它太慢了，以至于即使工作正常也无法使用。 我也无法配置组合键，以便它们可以在所有程序中使用。 如果突然有人提出解决方案-我将很高兴使用它。 </p><br><h2 id="vmesto-zaklyucheniya"> 而不是结论 </h2><br><p> 出乎意料的是，对于这种看似简单的功能而言，有很多单词。 我想传达这个想法，而不是使文字过多，但是我还没有弄清楚如何更容易地讲出来。 也许以视频格式会更好，但是他们不喜欢那样。 </p><br><p> 我谈到了脚本的底层内容以及如何对其进行配置。 我没有详细介绍脚本本身，但是只有50行，这并不难理解。 </p><br><p> 我希望其他人可以尝试这个想法，甚至可以欣赏它。 我可以为自己说脚本是大约3年前编写的，对我来说非常方便。 它非常方便，以致在与他人的计算机一起工作时会引起严重的不适。 并搭配可正常使用的Macbook。 </p><br><p>  <a href="https://github.com/masyamandev/Showwin-script">脚本链接</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483846/">https://habr.com/ru/post/zh-CN483846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483830/index.html">iOS路由：通用导航，无需重写应用程序</a></li>
<li><a href="../zh-CN483832/index.html">RxJava到协程：端到端功能迁移</a></li>
<li><a href="../zh-CN483834/index.html">Debian：只需将i386转换为amd64</a></li>
<li><a href="../zh-CN483842/index.html">创建家庭云的历史。 第5部分。更新2019-PHP 7.2，MariaDB 10.4和Nextcloud 17</a></li>
<li><a href="../zh-CN483844/index.html">分析俄罗斯信贷和金融部门信息保护的监管文件</a></li>
<li><a href="../zh-CN483850/index.html">没有神烧锅</a></li>
<li><a href="../zh-CN483860/index.html">WHD Global 2012：廉价域名的真正价值</a></li>
<li><a href="../zh-CN483862/index.html">微控制器中的虚拟功能-阴暗面</a></li>
<li><a href="../zh-CN483864/index.html">比C ++更快； 比PHP慢</a></li>
<li><a href="../zh-CN483872/index.html">窗户上的图案或驾车者的祸害：二维冰块如何生长</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>