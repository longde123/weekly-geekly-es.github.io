<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏻 👨🏿‍🚀 👩‍💼 Perintah tak terduga untuk menginisialisasi kelas bawaan dalam JavaScript 🍊 🚯 🚏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari ini saya memiliki tugas kecil untuk refactoring kode JS, dan saya menemukan fitur bahasa yang tidak terduga, yang selama lebih dari 7 tahun penga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Perintah tak terduga untuk menginisialisasi kelas bawaan dalam JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461399/"><p>  Hari ini saya memiliki tugas kecil untuk refactoring kode JS, dan saya menemukan fitur bahasa yang tidak terduga, yang selama lebih dari 7 tahun pengalaman pemrograman saya dalam hal ini <del>  dibenci oleh banyak orang </del>  Bahasa tidak berpikir dan tidak menemukan. </p><br><p>  Selain itu, saya tidak dapat menemukan apa pun di Internet Rusia atau Inggris, dan karena itu memutuskan untuk menerbitkan ini tidak terlalu lama, bukan yang paling menarik, tetapi catatan yang berguna. </p><br><blockquote> Agar tidak menggunakan konstanta <code>foo/bar</code> tradisional dan tidak berarti, saya akan menunjukkan secara langsung pada contoh yang kita miliki dalam proyek, tetapi masih tanpa banyak logika internal dan dengan nilai-nilai palsu.  Ingat bahwa semua sama, contoh-contohnya ternyata sangat sintetis. </blockquote><br><h3 id="nastupaem-na-grabli">  Kami melangkah menyapu </h3><br><p>  Jadi kita punya kelas: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTooltip</span></span></span><span class="hljs-class"> </span></span>{ template = <span class="hljs-string"><span class="hljs-string">'baseTemplate'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(content) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(content) } render(content) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'render:'</span></span>, content, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.template) } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tooltip = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseTooltip(<span class="hljs-string"><span class="hljs-string">'content'</span></span>) <span class="hljs-comment"><span class="hljs-comment">// render: content baseTemplate</span></span></code> </pre> <br><p>  Semuanya logis </p><br><p>  Dan kemudian kita perlu membuat jenis tooltip lain di mana bidang <code>template</code> berubah </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecialTooltip</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTooltip</span></span></span><span class="hljs-class"> </span></span>{ template = <span class="hljs-string"><span class="hljs-string">'otherTemplate'</span></span> }</code> </pre> <br><p>  Dan di sini kejutan menunggu saya, karena ketika membuat objek tipe baru, berikut ini terjadi </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> specialTooltip = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpecialTooltip(<span class="hljs-string"><span class="hljs-string">'otherContent'</span></span>) <span class="hljs-comment"><span class="hljs-comment">// render: otherContent baseTemplate // ^ </span></span></code> </pre> <br><p><a name="habracut"></a>  Metode render <code>BaseTooltip.prototype.template</code> dengan nilai <code>BaseTooltip.prototype.template</code> , bukan <code>SpecialTooltip.prototype.template</code> , seperti yang saya harapkan. </p><br><h3 id="nastupaem-na-grabli-vnimatelnee-snimaya-na-video">  Kami melangkah menyapu dengan hati-hati, <del>  merekam video </del></h3><br><p>  Karena chrome DevTools tidak tahu cara menetapkan bidang kelas, Anda harus menggunakan trik untuk memahami apa yang terjadi.  Menggunakan pembantu kecil, kami mencatat momen penugasan ke variabel </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logAndReturn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`set property=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${value}</span></span></span><span class="hljs-string">`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTooltip</span></span></span><span class="hljs-class"> </span></span>{ template = logAndReturn(<span class="hljs-string"><span class="hljs-string">'baseTemplate'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(content) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`call constructor with property=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.template}</span></span></span><span class="hljs-string">`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(content) } render(content) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(content, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.template) } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tooltip = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BaseTooltip(<span class="hljs-string"><span class="hljs-string">'content'</span></span>) <span class="hljs-comment"><span class="hljs-comment">// set property=baseTemplate // called constructor BaseTooltip with property=baseTemplate // render: content baseTemplate</span></span></code> </pre> <br><p>  Dan ketika kita menerapkan pendekatan ini ke kelas yang diwarisi, kita mendapatkan yang aneh berikut: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecialTooltip</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTooltip</span></span></span><span class="hljs-class"> </span></span>{ template = logAndReturn(<span class="hljs-string"><span class="hljs-string">'otherTemplate'</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tooltip = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpecialTooltip(<span class="hljs-string"><span class="hljs-string">'content'</span></span>) <span class="hljs-comment"><span class="hljs-comment">// set property=baseTemplate // called constructor SpecialTooltip with property=baseTemplate // render: content baseTemplate // set property=otherTemplate</span></span></code> </pre> <br><p>  Saya yakin bahwa bidang objek diinisialisasi pertama, dan kemudian sisa konstruktor dipanggil.  Ternyata semuanya rumit. </p><br><h3 id="nastupaem-na-grabli-pokrasiv-cherenok">  Kami menginjak menyapu, mengecat tangkainya </h3><br><p>  Kami menyulitkan situasi dengan menambahkan parameter lain ke konstruktor, yang kami tetapkan untuk objek kami </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseTooltip</span></span></span><span class="hljs-class"> </span></span>{ template = logAndReturn(<span class="hljs-string"><span class="hljs-string">'baseTemplate'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(content, options) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.options = logAndReturn(options) <span class="hljs-comment"><span class="hljs-comment">// &lt;---   console.log(`called constructor ${this.constructor.name} with property=${this.template}`) this.render(content) } render(content) { console.log(content, this.template, this.options) // &lt;---   } } class SpecialTooltip extends BaseTooltip { template = logAndReturn('otherTemplate') } const tooltip = new SpecialTooltip('content', 'someOptions') //    : // set property=baseTemplate // set property=someOptions // called constructor SpecialTooltip with property=baseTemplate // render: content baseTemplate someOptions // set property=otherTemplate</span></span></code> </pre> <br><p>  Dan hanya cara debug ini (yah, bukan peringatan) yang diklarifikasi sedikit </p><br><div class="spoiler">  <b class="spoiler_title">Dari mana masalah ini berasal:</b> <div class="spoiler_text"><p>  Sebelumnya, kode ini ditulis pada kerangka Marionette dan tampak (kondisional) seperti ini </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BaseTooltip = Marionette.Object.extend({ <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">'baseTemplate'</span></span>, initialize(content) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(content) }, render(content) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(content, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.template) }, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SpecialTooltip = BaseTooltip.extend({ <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">'otherTemplate'</span></span> })</code> </pre> <br><p>  Saat menggunakan Marionette, semuanya berfungsi seperti yang saya harapkan, yaitu, metode <code>render</code> dipanggil dengan nilai <code>template</code> ditentukan di kelas, tetapi ketika menyalin logika modul ke ES6, masalah yang dijelaskan dalam artikel keluar </p></div></div><br><h3 id="schitaem-shishki">  Hitung benjolan </h3><br><p>  Hasilnya: </p><br><p>  Saat membuat objek dari kelas yang diwarisi, urutan apa yang terjadi adalah sebagai berikut: </p><br><ul><li>  Menginisialisasi bidang objek dari deklarasi kelas yang diwarisi </li><li>  Eksekusi konstruktor dari kelas yang diwarisi (termasuk inisialisasi bidang di dalam konstruktor) </li><li>  Hanya setelah inisialisasi bidang bidang dari kelas saat ini </li><li>  Melaksanakan konstruktor dari kelas saat ini </li></ul><br><h3 id="vozvraschaem-grabli-v-saray">  Kami mengembalikan menyapu ke gudang </h3><br><p>  Secara khusus, dalam situasi saya, masalah dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diselesaikan baik melalui mixin</a> atau meneruskan templat ke konstruktor, tetapi ketika logika aplikasi mengharuskan mengesampingkan sejumlah besar bidang, ini menjadi cara yang agak kotor. </p><br><p>  Akan menyenangkan untuk membaca di komentar saran Anda tentang cara menyelesaikan masalah dengan elegan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id461399/">https://habr.com/ru/post/id461399/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id461381/index.html">Anonimitas adalah ilusi. Menurut data dari kumpulan data anonim, Anda dapat mengidentifikasi orang sungguhan</a></li>
<li><a href="../id461385/index.html">Anggur dan tikus: penggunaan resveratrol untuk mengembalikan otot di bawah gravitasi Mars</a></li>
<li><a href="../id461387/index.html">Dari klasik dan modernisme ke fantasi dan steampunk - apa yang dibaca oleh administrator sistem</a></li>
<li><a href="../id461389/index.html">Buat ekstensi Azure DevOps</a></li>
<li><a href="../id461395/index.html">Elemen Fraktal</a></li>
<li><a href="../id461401/index.html">Apa yang kamu, Event Loop? Atau cara kerja loop acara di browser Chrome</a></li>
<li><a href="../id461403/index.html">Cara menulis musik menggunakan OOP</a></li>
<li><a href="../id461405/index.html">Bagaimana saya mengambil CFA Level 1</a></li>
<li><a href="../id461407/index.html">Dari sejarah liburan - AdminFest 2011 di Rostov-on-Don</a></li>
<li><a href="../id461413/index.html">Tidak hanya Wi-Fi 6: bagaimana Huawei akan mengembangkan teknologi jaringan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>