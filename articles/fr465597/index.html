<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ö üåÄ ‚ÅâÔ∏è Apprentissage du d√©marrage lent de STM8S. Partie 0 üöº üì∏ ‚ùì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La famille MK STM8S par rapport au STM8L / 32 poss√®de un arsenal de p√©riph√©riques plus petit, mais vous permet de comprendre facilement les bases et d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprentissage du d√©marrage lent de STM8S. Partie 0</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465597/"> <abbr title="Microcontr√¥leur">La</abbr> famille <abbr title="Microcontr√¥leur">MK</abbr> STM8S par rapport au STM8L / 32 poss√®de un arsenal de p√©riph√©riques plus petit, mais vous permet de comprendre facilement les bases et d'acqu√©rir les comp√©tences n√©cessaires pour travailler avec ses fr√®res a√Æn√©s. <br><br><h2>  0. √Ä qui le mat√©riel est-il destin√©, pourquoi et pourquoi </h2><br>  En √©crivant cet article, je suppose que le lecteur peut: <br><br><ul><li>  Lisez attentivement (ce qui est rare) </li><li>  Un peu de travail avec la litt√©rature technique en anglais (enfin, ou la motivation pour apprendre, car la premi√®re langue du programmeur est l'anglais) </li><li>  Soudure (au moins comp√©tences minimales) </li><li>  Programmation en C (encore une fois, tout n'est pas si compliqu√©) </li><li>  Google (sans lui n'importe o√π) </li><li>  Utilisez un multim√®tre et a d'autres comp√©tences de base (comme ¬´ne mettez pas vos doigts dans la prise¬ª) </li></ul><br>  Je consid√®re les objectifs de l'article: <br><br><ul><li>  Pr√©sentation pour parcourir toutes les √©tapes du d√©veloppement d'un syst√®me bas√© sur un microcontr√¥leur </li><li>  Donner les notes introductives n√©cessaires √† une personne qui n'est pratiquement pas d√©vou√©e </li><li>  Si possible, le lecteur comprendra o√π, quoi et comment trouver </li></ul><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">(Pas significatif)</b> <div class="spoiler_text">  Pourquoi et pourquoi? <br><br>  Je pense qu'il est logique de faire un cours de programmation MK d√©taill√©. <br><br>  Je serai l'occasion d'√©tudier la p√©riph√©rie enti√®re plus en d√©tail et en cours de route, j'aiderai les autres. <br>  Je sais qu'il y a d√©j√† un tr√®s grand nombre d'articles et m√™me des formations, mais j'ai une approche l√©g√®rement diff√©rente.  (Peut-√™tre que j'obtiendrai des critiques ad√©quates, changer d'avis et rejoindre les gars de MX Cube). <br><br>  Il est triste de voir comment les contr√¥leurs stm se transforment en arduino. <br><br>  Concernant l'arduino: <br><br>  Il existe 3 approches (connues de moi, MB, je n'ai tout simplement pas grandi) de d√©veloppement de <abbr title="Logiciels">logiciels</abbr> sur MK: <br><br><ol><li>  D√©veloppement assembleur </li><li>  D√©veloppement pour un mod√®le MK sp√©cifique </li><li>  D√©veloppement √† l'aide de HAL et de biblioth√®ques similaires </li></ol><br>  1) Je suis partisan de l'opinion selon laquelle si vous construisez une maison, vous ne devez pas br√ªler chaque brique d'argile de vos propres mains, car l'assembleur dispara√Æt (bien qu'il ait commenc√© par cela).  Vitesse de d√©veloppement trop faible. <br><br>  2) Biblioth√®ques HAL, etc.  pour un d√©butant, trop de moments ¬´il suffit d'√©crire comme √ßa¬ª sont opaques.  Parce que - aussi √† la poubelle. <br><br>  3) Je consid√®re le processus de cr√©ation de logiciel pour un MK sp√©cifique comme l'option la plus saine pour un d√©butant, les comp√©tences acquises permettront de faire face aux s√©ries 8L et 32 ‚Äã‚Äã(m√™me si cela fait mal de le faire seul selon la documentation). <br><br>  Vous avez probablement remarqu√© que l'arduino n'appara√Æt pas dans cette liste, car il s'agit d'une plate-forme <u>√©ducative</u> et n'est pas destin√© au d√©veloppement d'appareils compacts sur sa base.  Mais l'approche de la programmation pour une raison quelconque (je ne sais pas) est transf√©r√©e et se propage sur Internet.  Et m√™me utilis√© dans de vrais projets commerciaux.  (repr√©sente, "J'ai t√©l√©charg√© la biblioth√®que sur le forum, connect√©e, √ßa a march√©, je ne sais pas comment √ßa marche"). <br><br>  Je sugg√®re, de mon point de vue, une approche acad√©mique et m√©thodiquement plus significative. <br></div></div><br><h2>  1. Le choix du microcontr√¥leur </h2><br>  J'ai plusieurs STM8S105K6 dans le paquet LQFP32, c'est de cette famille, donc je le choisis. <br><br>  Vous pouvez choisir n'importe quel MK de la s√©rie. <br><br>  Il existe des cartes Discovery pr√™tes √† l'emploi de ST, que vous pouvez acheter aupr√®s des Chinois ou commander aupr√®s d'autres ressources.  Il existe des cartes pr√™tes √† l'emploi pour le STM8S103F3P6 et similaires des Chinois. <br><br>  Mais, il convient de noter que les planches pr√™tes √† l'emploi sont con√ßues pour la formation. <br><br>  Sur le site Web du fabricant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">st.com</a> , nous trouvons notre MK et y t√©l√©chargeons des documents: <br><br>  Manuel de r√©f√©rence: RM0016 - un document commun √† toutes les familles MK STM8S et STM8AF.  Vient ensuite RM. <br>  Fiche technique: J'ai un document DS5855 pour les STM8S105C4 / 6, STM8S105K4 / 6 et STM8S105S4 / 6.  Vient ensuite DS. <br><br>  Des choses d√©licieuses qu'il a (superficiellement): <br><br><ul><li>  Prise en charge de 16 MHz </li><li>  32 Ko Flash, 1 Ko EEPROM et 2 Ko RAM </li><li>  Puissance 2,95-5,5 V </li><li>  Minuteries 8 bits et 16 bits </li><li>  UART, SPI, I2C </li><li>  <abbr title="Convertisseur analogique-num√©rique">ADC</abbr> 10 bits </li><li>  jusqu'√† 38 entr√©es / sorties discr√®tes </li></ul><br><h2>  2. √âquipement requis </h2><br>  Je vois deux options pour travailler avec MK: <br><br><ol><li><div class="spoiler">  <b class="spoiler_title">Assemblage d'une pr√©sentation √† partir de composants individuels</b> <div class="spoiler_text">  Super, cool, j'aime √ßa.  Tant de gens le font. <br><br>  Dans ce cas, le MK aura besoin du soi-disant cerclage.  Le plan est simple: <br><br><ol><li>  Nous prenons une planche √† pain, dans mon cas TQFP (32-64PIN) 0.8MM, soudons MK dessus </li><li>  Nous prenons un peigne √† double rang√©e de soudure PLS-2x40 dans les trous qui m√®nent aux conclusions de MK </li><li>  Nous prenons une planche √† pain imprim√©e (j'ai 9x15 cm) et soudons le dernier sandwich dessus </li><li>  Nous regardons RM point 7. Alimentation, <u>nous lisons</u> .  Il est √©crit que vous avez besoin d'un condensateur reliant la broche VCAP et notre alimentation 0V.  Il est √©galement √©crit que vous devez examiner plus en d√©tail dans DS un MK sp√©cifique dans la section des caract√©ristiques √©lectriques.  Pour moi, il s'agit de la clause 10.3.1 du condensateur externe VCAP en r√©f√©rence au tableau 18 o√π la valeur nominale est de 470 √† 3300 nF.  J'ai pris 1 mF (dans le circuit C3).  (pourquoi vous en avez besoin, j'esp√®re que vous l'avez lu vous-m√™me en RM) </li><li>  Ibid. Dans DS √† la clause 10.3.8.  R√©initialiser les caract√©ristiques des broches, nous trouvons le condensateur de 0,1 mF (sur le circuit C4).  La r√©sistance R4 d'une valeur nominale de 10 kOhm est utilis√©e dans les cartes de d√©bogage et diverses notes d'application, bien qu'√† l'int√©rieur du MK il y ait d√©j√† une r√©sistance de pull-up avec une valeur nominale de 30 √† 80 kOhm (si vous croyez la m√™me DS).  Parall√®lement au condensateur C4, nous avons mis notre bouton de r√©initialisation.  Un tel mod√®le de r√©initialisation peut √™tre vu, par exemple, dans la note Desighn DN0005. </li><li>  De plus, ST aime ajouter des condensateurs de puissance de 100 nF aux cartes de d√©bogage, dans le nombre de broches N connect√©es √† +1 puissance.  Le diagramme ne montre que des pi√®ces C1, C2 et C5 3, et je ne les ai pas soud√©es sur la carte, mais vous en avez compris le sens.  Il fonctionnera sur la table sans eux, mais dans un v√©ritable d√©veloppement commercial, il est pr√©f√©rable de prendre soin de cette question lors de la s√©lection de la carte de l'appareil. </li><li>  Connecteur de programmation SWIM non r√©solu (je fais du PLS-1x40) </li></ol><br>  J'ai un tel miracle: <br><br><img src="https://habrastorage.org/webt/oh/ll/d5/ohlld5z9iiuxmlnc6djwgbqe_-w.png"><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Acheter une planche finie (ce qui ne vous √©vite pas de travailler avec un fer √† souder)</b> <div class="spoiler_text">  Super, cool, j'aime √ßa.  Tant de gens le font. <br><br>  Il vaut la peine de se familiariser avec la configuration de la carte, s'il s'agit d'une carte de ST, elle est imm√©diatement avec le programmateur et est connect√©e avec un c√¢ble USB de type B.  Le site ST aura un sch√©ma sur la page produit.  Sur le plateau, il y aura des boutons, des LED, des tweeters, des boutons capacitifs et d'autres charmes avec lesquels vous pourrez jouer. <br><br>  Si la carte est chinoise, alors souvent des cartes sans programmeur, vous aurez besoin d'un programmeur. <br><br>  Il est pr√©f√©rable de ne pas croire les s√©rigraphies des noms des conclusions et de v√©rifier par rapport √† DS. <br></div></div></li></ol><br>  Je ne pense pas travailler avec des platines contact car je ne les utilise pas. <br><br>  De plus, j'ai besoin d'un programmeur, j'ai un ST-Link V2 chinois.  Capable de programmer et STM8 et STM32. <br><br><h2>  3. Choisir un IDE </h2><br>  Pour moi, la question du choix n'est pas encore d'actualit√©, je travaille dans l'IAR pour STM8, car il a fait un projet sur lequel je travaille actuellement, pour la m√™me raison l'ancienne version. <br><br>  Nous allons sur le site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">iar.com</a> , dans la recherche nous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tapons</a> le mod√®le de notre MK. <br>  T√©l√©chargez IAR Embedded Workbench pour STM8, s√©lectionnez l'√©valuation √† taille limit√©e lors de l'installation et installez une limite de 8 Ko de code.  Ou acheter.  Il existe des versions pirat√©es sur les ressources interdites sur le territoire de la F√©d√©ration de Russie, mais elles ne conviennent pas aux projets commerciaux. <br><br>  Les instructions d'installation se trouvent dans le programme d'installation ou dans Google. <br>  J'utilise la version 6.5.3.2581. <br>  Installez l'environnement, ainsi que le pilote du programmeur. <br><br><h2>  4. Cr√©ation d'un projet </h2><br>  Allez dans l'IDE, allez dans Projet -&gt; Cr√©er un nouveau projet -&gt; C ++ <br><br>  Cliquez sur OK, s√©lectionnez le r√©pertoire (de pr√©f√©rence sans cyrillique et sans espaces), s√©lectionnez le nom (sans espaces et cyrillique). <br><br>  Nous allons dans le dossier racine de notre IDE et trouvons le dossier inc, pour moi le chemin: <br><br><pre><code class="plaintext hljs">C:\Program Files (x86)\IAR Systems\Embedded Workbench 6.5\stm8\inc</code> </pre> <br><br>  Parmi les fichiers d'en-t√™te iostm8, nous trouvons notre mod√®le MK, pour moi: <br><br><pre> <code class="plaintext hljs">iostm8s105k6.h</code> </pre> <br>  Nous le connectons au tout d√©but et ajoutons une boucle infinie. <br><br><div class="spoiler">  <b class="spoiler_title">R√©sultat:</b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#include&lt;iostm8s105k6.h&gt; //  int main() { while(1){ //  } return 0; }</span></span></code> </pre><br></div></div><br>  Dans le menu Projet -&gt; Options -&gt; Options g√©n√©rales dans la colonne Appareil s√©lectionnez votre MK. <br><br>  Dans Projet -&gt; Options -&gt; D√©bogueur dans la colonne Pilote, s√©lectionnez ST-LINK. <br><br>  Recherchez le bouton T√©l√©charger et d√©boguer dans la barre d'outils. <br>  Lors de la premi√®re compilation, l'environnement vous demandera de s√©lectionner le nom du fichier .eww.  (Je nomme le m√™me que le projet.) <br><br>  Au bas de la fen√™tre du journal de d√©bogage doivent se trouver des messages qui: <br><br><ul><li>  Pr√©processeur pour STM8 - pr√©processeur d√©marr√© </li><li>  D√©bogueur pour STM8 - d√©bogage d√©marr√© </li><li>  Connect√© au syst√®me de d√©bogage SWIM STM8 - connect√© √† MK </li><li>  D√©bogu√© charg√© - le t√©l√©chargement du micrologiciel a eu lieu </li><li>  R√©initialisation de la cible - une r√©initialisation s'est produite </li></ul><br>  Nous sommes en mode d√©bogage, mais le programme est suspendu. <br>  Au m√™me endroit sur la barre d'outils, nous trouvons et appuyez sur le bouton Go. <br>  Nous avons lanc√© MK en mode d√©bogage. <br><br>  Cliquez sur Arr√™ter le d√©bogage, le d√©bogage s'arr√™te, mais le MK est aliment√© par le programmeur puis ex√©cute le programme, √† savoir, il fait tourner une boucle sans fin et ne fait rien. <br><br><h2>  R√©sum√© </h2><br>  Le r√©sultat a √©t√© un bref aper√ßu et une introduction √† la programmation de la s√©rie STM8S de MKs sans programmation elle-m√™me.  Il s'est av√©r√© que la base du travail, √† partir de cela, g√©n√©ralement tout commence - avec l'assemblage de la mise en page. <br><br>  Je ne vois pas le point plus en d√©tail. <br><br>  Dans de nombreux articles, apr√®s l'introduction, litt√©ralement apr√®s quelques lignes, les LED clignotent, ce que je ne comprends pas. <br><br>  On peut juger de la mani√®re dont les objectifs ont √©t√© atteints si le d√©butant a r√©ussi √† faire quelque chose par lui-m√™me, en utilisant les informations que j'ai propos√©es.  (fen√™tre d'indicateur Journal de d√©bogage) <br><br>  Merci de votre attention. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465597/">https://habr.com/ru/post/fr465597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465585/index.html">Comment g√©rer React Data Grid via Redux</a></li>
<li><a href="../fr465587/index.html">Analyse: qu'est-ce que le march√© OTC et quelles transactions y sont effectu√©es</a></li>
<li><a href="../fr465589/index.html">Guide de d√©marrage rapide du pilote et du PoC</a></li>
<li><a href="../fr465591/index.html">La conf√©rence PHP Europe centrale annul√©e car il n'y avait pas de femmes parmi les intervenants</a></li>
<li><a href="../fr465595/index.html">La 5G vient √† nous?</a></li>
<li><a href="../fr465599/index.html">IPFS sans douleur (mais ce n'est pas pr√©cis)</a></li>
<li><a href="../fr465601/index.html">Pourquoi avez-vous besoin de DevOps et qui sont des sp√©cialistes DevOps</a></li>
<li><a href="../fr465603/index.html">Cours vs stage. Comment enseignons-nous les midbells chez SimbirSoft</a></li>
<li><a href="../fr465605/index.html">Le livre "Deep reinforcement learning in Python. OpenAI Gym et TensorFlow pour les pros ¬ª</a></li>
<li><a href="../fr465607/index.html">Comprendre le Lean et l'Agile dans le d√©veloppement de logiciels</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>