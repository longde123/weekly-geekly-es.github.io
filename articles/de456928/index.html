<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐯 🤐 👨🏽‍💻 JMeter - Schweizer Prüfmesser (Teil 1) 🥘 ▫️ 👩🏽‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Über JMeter sprechen? Wenn Sie sich mit dem Thema befassen, haben Sie höchstwahrscheinlich bereits alles über dieses Tool für Stresstests gelesen. Abe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JMeter - Schweizer Prüfmesser (Teil 1)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456928/">  Über JMeter sprechen?  Wenn Sie sich mit dem Thema befassen, haben Sie höchstwahrscheinlich bereits alles über dieses Tool für Stresstests gelesen.  Aber ich muss dich überraschen.  Drei Jahre lang bei QA wurde mir klar, dass JMeter sehr vielseitig ist und für eine Vielzahl von Zwecken verwendet werden kann.  Zum Beispiel für: <br><br><ul><li>  Suche nach einem schwer fassbaren Fehler mit dem Fall der Website für einige Benutzer; </li><li>  Schnelle Erwärmung des Caches auf Tausenden von Produktseiten; </li><li>  Testen des Backends einer mobilen Anwendung; </li><li>  Erstellen von 2000 Datensätzen mit Benutzerdaten in der Anwendungsdatenbank in kurzer Zeit. </li></ul><br>  Wenn Sie interessiert sind, willkommen bei Katze.  Es stellte sich voluminös heraus, also werde ich den Artikel in zwei Teile teilen. <br><a name="habracut"></a><br><blockquote> <i><b>Haftungsausschluss:</b> Aus offensichtlichen Gründen <b>füge</b> ich keine Screenshots von realen Projekten in den Artikel ein (oder extrahiere alle wichtigen Informationen daraus).</i>  <i>Abbildungen werden nur zu Forschungs- und Bildungszwecken bereitgestellt.</i> </blockquote><br><h2>  Klassische JMeter-Anwendung </h2><br>  JMeter - Java-Applet mit GUI.  Zum Testen startet es ohne grafische Oberfläche.  Und zum Schreiben von Testskripten hat er ein Panel, in dem Sie alles tun können. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d8/ac5/d62/8d8ac5d625f266f640fe6d65dce8e994.png" alt="Erstellen eines Skripts in JMeter"></div>  <font color="#999999"><i>So sieht der Prozess der Erstellung des Skripts aus (hier passt sogar das Wort "Schreiben" nicht)</i></font> <br><br>  Es wird ein gemeinsamer Testplan erstellt, in den sich die Thread-Gruppe mit den Hauptelementen des Tests einfügt: Prozesscontroller und Anforderungen (HTTP, FTP usw.). <br><br>  Darüber hinaus gibt es zusätzliche Elemente zum Einstellen von Parametern.  Mit den Standardeinstellungen für HTTP-Anforderungen können Sie beispielsweise den Hauptserver und die Header angeben und den Download zusätzlicher Elemente (Bilder, Stile, Schriftarten usw.) aktivieren / deaktivieren.  Es ist einfach, es herauszufinden.  Über diese Benutzeroberfläche können Sie sofort einen Test ausführen und die Ergebnisse anzeigen. <br><br>  JMeter kann solche Testfälle aufzeichnen.  Es wird als Proxy auf dem lokalen Computer ausgeführt. Wenn Sie einen Browser (oder eine Anwendung) konfigurieren und den Datenverkehr über diesen Proxy steuern, zeichnet JMeter alle Anforderungen und Antworten auf.  Und aus diesem Satz können Sie ein Testskript erstellen, das die Aktionen des Benutzers wiederholt und es ausführt, wo und wann immer Sie möchten: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qy/z7/lq/qyz7lqjkh8y-e9ul3mqi76qceam.png" alt="Schreiben eines Skripts in JMeter basierend auf Benutzeraktionen"></div><br><br>  Das Hauptproblem ist der Heap des Java-Speichers.  Es ruht an der Decke und kann mit 50 Fäden gleichzeitig getestet werden, selbst auf Spitzenmaschinen. <br>  Wenn die Maschine nicht über genügend Strom für einen Volllasttest verfügt, wenden Sie sich an eine Drittanbieterorganisation.  Sie stellten eine Infrastruktur bereit, die aus mehreren Servern besteht.  Sie haben den gleichen JMeter.  Gegen eine Gebühr führen diese Leute Ihr Skript bei jeder Belastung aus.  Wir haben solche Dienstleistungen bei Octoperf und Blazemeter beantragt. <br><br><h2>  Das ist Fußball, Baby: Wie wir einen Fehler mit einem teilweisen Serverabsturz entdeckt haben </h2><br>  Wir beschäftigen uns seit 18 Jahren mit Webentwicklung (Prost - jetzt können Sie rauchen, heiraten und John Wick beobachten).  Es gab viele Kunden in ihrem Leben, aber die größten sind kürzlich erschienen.  Zum Beispiel haben wir auf <b>Sitecore</b> eine Website für einen der englischen Premier League-Fußballvereine mit dem SPW-Paradigma erstellt (einseitige Website: Alle Seiten werden geöffnet, ohne dass die Browserseite selbst neu geladen wird).  Unter der Haube befindet sich das Admin-Panel zum Verwalten einer Live-Match-Seite.  Dies ist eine textuelle Online-Übertragung des Spiels: Die wichtigsten Ereignisse (Tore, Löschungen, Freistöße) werden automatisch aus dem Opta-System geladen, und Fotos, Kommentare und Reposts von Fans von Twitter und Instagram werden von Live-Leuten veröffentlicht - Content-Managern von Fußballclubs. <br><br>  Nicht ohne Stolz stelle ich fest: Nach der Veröffentlichung veröffentlichten die britischen Medien Artikel unter den Überschriften "Endlich ist die Hegemonie der alten Standorte von Fußballclubs vorbei."  Zu dieser Zeit hatten die meisten Clubs bereits Standorte.  Aber sie sahen aus, als wären sie zu Beginn der 2000er Jahre entwickelt worden und haben sich seitdem nicht verändert - mit dem entsprechenden Design und UX. <br><br>  Vor dem Start haben wir einen Volllasttest durchgeführt und sichergestellt, dass alles so funktioniert, wie es sollte.  Die Serverstruktur sah folgendermaßen aus: <br><br><ol><li>  Die Anforderung vom Client geht an den Lastausgleichsserver → </li><li>  Der Lastausgleichsserver überprüft den Status von acht <abbr title="Content Delivery, Content Delivery Server">CD-</abbr> Servern → </li><li>  Der Lastausgleichsserver sendet eine Anfrage an den am wenigsten belasteten CD-Server → </li><li>  Der CD-Server antwortet dem Client. </li></ol><br>  Ein Jahr nach dem Start rief der Kunde während eines großen Zustroms von Benutzern auf die Site an und sagte, dass die Site nicht erreichbar sei: <br><br>  - Unsere Seite funktioniert nicht!  Funktioniert überhaupt nicht!  Nur ein weißer Bildschirm und eine Inschrift aus dem Browser, dass die Website nicht verfügbar ist!  - Der Kunde sagt. <br>  Wir sind in Panik, als wir die Seite öffnen, und damit ist alles in Ordnung: <br>  "Es funktioniert immer noch", antworten wir. <br>  Der Client öffnet die Site über Telefon und Computer und ... alles ist auch in Ordnung! <br>  - Wirklich, tut mir leid.  Anscheinend haben Benutzer Probleme. <br><br>  Solche Meldungen werden nicht von Grund auf neu angezeigt. Daher haben wir eine Studie durchgeführt: Wir haben ein Dienstprogramm zur Überwachung des Status von Servern mit Serverdichte gestartet und untersucht, was mit ihnen während eines Zustroms von Benutzern auf der Site passiert: <br><br><img src="https://habrastorage.org/webt/o8/m9/rd/o8m9rd9amg7mcl_vlf8ky2ce1wu.png" alt="Anzeigen des Serverlastverlaufs in Serverdichte"><br>  <font color="#999999"><i>Es gibt eine Last, aber alle CD-Server sehen ungefähr gleich und gleichmäßig aus</i></font> <br><br>  Bald wiederholte sich die Geschichte - einige Benutzer meldeten eine völlig kaputte Site.  Es wurde kein Fehler oder keine Seite gefunden - der Server hat einfach nicht auf die Anfrage geantwortet.  Mit Hilfe von JMeter konnte die Situation erfasst werden. <br><br>  Das Ziel war einfach: Laden Sie alle acht Server und sehen Sie, was passiert.  Ein Stresstest wurde durchgeführt, als die Morgendämmerung in Tscheljabinsk stattfand, und in London war es eine tiefe Nacht.  Wir haben mehrere Computer im Nicht-Schnittstellenmodus verwendet (damit können Sie viel mehr Threads gleichzeitig ausführen).  Das Skript öffnete endlos die Homepage, und dies war unser Hauptfehler. <br><br><img src="https://habrastorage.org/webt/g_/fu/c-/g_fuc-c3uungpae4vrrhn2q-c94.png" alt="Das einfachste Lasttest-Skript in JMeter, um eine Seite in einer Schleife anzufordern"><br><br>  Wir haben dieselben Assets heruntergeladen, die bereits hundert Mal zwischengespeichert wurden.  Daher kam die Last unbedeutend heraus.  Dann kam die Idee: auf der Website - ein Wagen und ein kleiner Wagen mit Seiten mit Nachrichten für bestimmte Daten.  Wenn Sie einige Variablen vorrücken und in der URL ersetzen, erhalten wir immer eine zufällige Seite (zum Beispiel - ... url / news / 2016/08/23 /? Page = 4). <br><br>  Plötzlich stellten wir fest, dass die Serverdichte in den Diagrammen der Serverlast in den letzten Zeiträumen eine integrierte „Glättung“ aufweist.  Wenn in fünf Minuten die Auslastung des Servers 100% erreicht hat, dann auf 0% gesunken ist und nach 20 bis 30 Sekunden auf 90% gestiegen ist, wird der Durchschnittswert für diesen Zeitraum angezeigt - etwa 80 bis 90%.  Daher haben wir keinen echten Serverabsturz gesehen. <br><br>  Nachdem wir die Protokolle während Stresstests eingehend untersucht hatten, stellten wir fest, dass einer der CD-Server bei 100% Auslastung neu gestartet wurde und niemandem davon erzählte (dies ist so introvertiert). <br><br><img src="https://habrastorage.org/webt/i5/ie/n6/i5ien6w5zjrwwm1lk23crcj9vn8.png"><br><br>  Der Load Balancer untersuchte nur die CPU-Auslastung aller Server.  Er sah, dass einer von ihnen zu 20% und der Rest zu 90% geladen war, und schickte den Benutzer zum ersten.  Und er war im Neustart und gab einen weißen Bildschirm aus.  Darüber hinaus hat der Verteilungsserver den Benutzer einem Cookie ausgesetzt und es fest an den inaktiven Server gebunden.  Daher war die Site auch nach dem Update nicht verfügbar.  Die restlichen 7 von 8 Benutzern genossen gleichzeitig das Leben und sagten, dass alles funktioniert. <br><br><h4>  <font color="#cc0000">Fazit:</font> </h4><br>  Wir haben festgestellt, dass JMeter für Stresstests verwendet werden kann und gleichzeitig den Status von Servern während des Testens mit anderen Tools analysiert.  Wir haben es geschafft, das Problem mit dem Fall der Site bei einigen Benutzern zu „fangen“ und es zu lösen, indem wir die Lastverteilungslogik korrigiert und die Statussteuerung hinzugefügt haben. <br><br>  Im nächsten Teil werde ich Ihnen erklären, wie wir mit Hilfe von JMeter den Caching-Prozess für Produktseiten eingerichtet, den Betrieb einer mobilen Anwendung ohne die Anwendung selbst getestet und 2000 Benutzer im System ohne Zugriff auf die Datenbank erstellt haben. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456928/">https://habr.com/ru/post/de456928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456912/index.html">So erstellen Sie Websites im Jahr 2019</a></li>
<li><a href="../de456916/index.html">Cross Compilation im Docker. Warum nicht?</a></li>
<li><a href="../de456920/index.html">Sony Xperia 1 in Russland - Preis- und Vorbestellungsboni</a></li>
<li><a href="../de456922/index.html">Wie Prozessoren entworfen und hergestellt werden: die Grundlagen der Computerarchitektur</a></li>
<li><a href="../de456926/index.html">Wie wir Sportmaster machen</a></li>
<li><a href="../de456930/index.html">IoT in die Massen bringen: Ergebnisse des ersten IoT-Hackathons von GeekBrains und Rostelecom</a></li>
<li><a href="../de456932/index.html">Ultramodernes OpenGL. Teil 1</a></li>
<li><a href="../de456936/index.html">Animierte Karten auf SwiftUI</a></li>
<li><a href="../de456938/index.html">Start einer Taxi-App in Tokio: Wie macht Sony das mit S. Ride?</a></li>
<li><a href="../de456942/index.html">Der vielarmige Gott der Frist oder der weit verbreitete Einsatz von Analytik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>