<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëáüèø üöí üßóüèª Vivado: Picasso-Modus üí™üèæ üßì üë°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anmerkung 


 Madness All Ages Devot 


 Beim Entwerfen von Modulen auf FPGAs f√§llt manchmal die Idee ein, dass die Entwurfsumgebung selbst und die da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vivado: Picasso-Modus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477974/"><h2 id="annotaciya">  Anmerkung </h2><br><p>  <em>Madness All Ages Devot</em> </p><br><p>  Beim Entwerfen von Modulen auf FPGAs f√§llt manchmal die Idee ein, dass die Entwurfsumgebung selbst und die darin enthaltenen Tools nicht ganz normal verwendet werden.  In diesem kurzen Artikel werden wir uns ansehen, wie wir mit Hilfe des in Tcl implementierten Umweltmanagement-Tools buchst√§blich Fotos, Gem√§lde, Portr√§ts und Memesics auf dem FPGA zeichnen k√∂nnen. </p><br><p>  Eine solche ungew√∂hnliche ‚ÄûDesignroute‚Äú wurde vor eineinhalb Jahren implementiert, aber erst jetzt kam die Idee, sie in Form einer Notiz anzuordnen, in der es wenig √úbung gibt, Tcl-Skripte zum Verwalten der Designumgebung zu verwenden, in diesem Fall Vivado.  Mit geringf√ºgigen √Ñnderungen kann jedoch alles problemlos an andere Entwicklungsumgebungen angepasst werden, z. B. Quartus II. </p><br><p><img src="https://habrastorage.org/webt/32/h7/xr/32h7xruuubk_cai37jn18jgf8ca.png"></p><a name="habracut"></a><br><h2 id="vvedenie">  Einleitung </h2><br><p>  Die Idee kam nat√ºrlich nicht von ungef√§hr.  Sein Auftreten wurde durch meine damalige Besch√§ftigung in Projekten zur Bildverarbeitung und zum Videostream-Management auf FPGA gef√∂rdert.  Es passiert jedem, dass beim √úberdenken einer Probleml√∂sung jede H√§resie in den Sinn kommt, warum es nicht funktioniert oder genau so funktioniert, wie es sollte, aber nicht so, wie wir es erwarten. </p><br><p>  Bei der L√∂sung des Problems musste ich auf eines der Tools der Vivado-Umgebung zur√ºckgreifen, n√§mlich die entsprechenden Komponenten und Module im Projekt nach der Platzierung einzuf√§rben, aufzusp√ºren und in endlose Zeitdiagramme zu blicken. </p><br><p>  Als Ergebnis habe ich mehrere konfigurierbare logische Bl√∂cke von CLB in verschiedenen Farben gezeichnet, und es d√§mmerte mir - dies sind die Pixel des Bildes, damit ich versuchen kann, den Faden des Bildes zu zeichnen, wobei jedes Pixel mit seinem eigenen farbigen CLB √ºbereinstimmt </p><br><h2 id="chem-nam-pomozhet-tcl">  Wie hilft uns Tcl? </h2><br><p>  Angenommen, wir haben ein kleines Bild mit einer Gr√∂√üe von 100 x 100 Pixel.  Angenommen, um die CLB einzuf√§rben, m√ºssen wir zwei Dinge tun: W√§hlen Sie die CLB aus und w√§hlen Sie die Farbe aus.  Im 100x100-Bild haben wir 10.000 Pixel und es ist ziemlich m√ºhsam, eine solche F√§rbung manuell vorzunehmen, zumal die Aktionen die gleichen und sich wiederholenden sind.  Manuelles Zeichnen jeder CLB ist daher keine Option und Sie m√ºssen Tcl und Skripte verwenden.  Aber wo soll ich anfangen? </p><br><p>  Das erste, was mir in den Sinn kam, war, das richtige Team zu finden, das dem ausgew√§hlten Element Farbe verleiht.  Gl√ºcklicherweise zeigt Vivado beim manuellen Ausf√ºhren von Aktionen die entsprechenden Tcl-Befehle an der Konsole an, und es scheint, dass das Suchproblem so schnell wie m√∂glich behoben werden sollte.  Es war jedoch nicht da.  Vivado ignoriert einfach die Ausgabe des Befehls, um die ausgew√§hlten Elemente hervorzuheben, und die einzige Option, um den Befehl zu finden, und ich war mir absolut sicher, dass es so sein sollte, ist, kopf√ºber in die in Vivado verf√ºgbare Tcl-Anleitung einzutauchen, und das sind fast 2000 Seiten [1]. </p><br><p>  Verzweifle nicht, das Schl√ºsselwort "highlight" fand schnell den entsprechenden Befehl, der highlight_objects hei√üt.  Dieser Befehl hebt die angegebenen oder ausgew√§hlten Objekte in einer bestimmten Farbe hervor, die mithilfe von Optionen festgelegt wurde.  Die Optionen f√ºr den Befehl highlight_objects lauten wie folgt: </p><br><p>  - <em>color_index</em> - (optional) Der g√ºltige Wert des Optionsarguments muss eine Zahl von 1 bis 20 sein. Die Farbe, in der das ausgew√§hlte Objekt <em>gezeichnet</em> wird, wird durch die Seriennummer aus der vordefinierten Farbpalette bestimmt, die Sie unter Farben ‚Üí Hervorheben im Men√ºbereich Extras ‚Üí Einstellungen finden . <br>  - <em>rgb</em> - (optional) legt die Farbe des ausgew√§hlten Objekts im RGB-Format fest <br>  - <em>Farbe</em> - (optional) hebt das ausgew√§hlte Objekt in einer der folgenden Farben hervor: Rot, Gr√ºn, Blau, Magenta, Gelb, Cyan und Orange </p><br><p>  Die √ºbrigen Optionen des Befehls beziehen sich auf die Systemeinstellungen des Befehls selbst und sind f√ºr uns nicht n√ºtzlich.  Beachten Sie jedoch, dass bei Verwendung des Befehls highlight_objects nicht zwei oder mehr Farboptionen gleichzeitig angewendet werden k√∂nnen. <br>  Nat√ºrlich ist eine Option, die eine beliebige Farbe im RGB-Format festlegt, f√ºr unsere Aufgabe geeignet - die Option <em>rgb</em> </p><br><p>  Jetzt w√§re es nicht schlecht, die Pixelwerte des Bildes zu erhalten, aber ich konnte das Bild nicht finden, das im Bitmap-Format dargestellt werden w√ºrde.  Beim √ñffnen jeder Datei mit einem Texteditor konnten keine Zeilen mit einem Pixelwert gefunden werden.  Nat√ºrlich habe ich kein Programm zum Konvertieren von Bildern in das Bitmap-Format geschrieben, sondern einfach im Internet nach einer schl√ºsselfertigen L√∂sung gesucht.  Die Suche dauerte nicht lange.  Wie sich herausstellte, ist die Aufgabe, ein Bild in ein Bitmap-Format zu konvertieren (d. H. Wenn wir die Pixelwerte eines unkomprimierten Bildes sehen), ziemlich relevant (wahrscheinlich wird eine solche Aufgabe Studenten-Programmierern als Hausaufgabe f√ºr die Laborarbeit √ºbertragen).  Es ergab sich eine kurze Suche nach github, von wo das Programm Image2Bitmap heruntergeladen wurde [2]. </p><br><p>  Das Programm ben√∂tigt eine Bildeingabe und gibt Pixelwerte in Form eines s-Arrays mit hexadezimalen Pixelwerten im RGB565-Format aus.  Dieses Format besagt, dass die Farbcodierung f√ºr die rote Komponente 5 Bit, gr√ºne 6 Bit und blaue 5 Bit verwendet.  Dies erwies sich als ausreichend f√ºr die Arbeit.  Jetzt m√ºssen nur noch die erhaltenen Werte direkt auf die lackierten Schnitte (Slice) abgebildet werden. </p><br><h2 id="vybor-plis">  FPGA-Auswahl </h2><br><p>  Je gr√∂√üer das FPGA ist, desto logischer sind die Ressourcen, und daher ist das ‚ÄûFeld f√ºr Kreativit√§t‚Äú selbst gr√∂√üer und das Bild wird klarer.  Es sollte sofort angemerkt werden, dass das ‚ÄûDekorieren‚Äú ein ziemlich langer Prozess ist und abh√§ngig von der Gr√∂√üe des Bildes eine angemessene Zeitdauer in Anspruch nehmen kann.  Zum Testen lohnt es sich, ein FPGA mit geringem Ressourceneinsatz zu w√§hlen.  Zum Beispiel die Spartan-7-Familie.  Nach dem Testen k√∂nnen Sie das FPGA beispielsweise aus der Ultrascale + -Familie auf "fett" umstellen. </p><br><ol><li><p>  Wir starten Vivado und erstellen das Projekt </p><br></li><li><p>  Wir w√§hlen den Kristall xc7s6cpga196-2 aus, auf den wir das Testbild zeichnen werden <br><br><img src="https://habrastorage.org/webt/vk/zj/do/vkzjdo6hklo098bevkxuz7qvjhu.png"></p><br></li><li><p>  Um die Zeichnung anzuzeigen, m√ºssen wir das Bild des Kristalls selbst √∂ffnen, dies kann jedoch nach der Synthesestufe erfolgen oder aufw√§ndig sein.  In Vivado m√ºssen wir dazu ein Dummy-Modul in einer beliebigen Sprache erstellen. <br><br><img src="https://habrastorage.org/webt/nb/ss/7k/nbss7kzptxr8ify9ot4ctpijx8u.png"></p><br></li><li><p>  F√ºgen Sie dem Tcl-Projekt ein Skript hinzu. <br>  a.  Erstellen Sie dazu eine Datei mit der Erweiterung ‚Äû.tcl‚Äú in dem Ordner mit dem Projekt, z. B. ‚Äûfpga_painter.tcl‚Äú. <br><br><img src="https://habrastorage.org/webt/x9/k8/is/x9k8ismf9abat7cjtkl6kqto-lg.png"></p><br><p>  b.  Gehen Sie zu Vivado und f√ºgen Sie diese Datei dem Projekt hinzu. <br><br><img src="https://habrastorage.org/webt/zs/we/gd/zswegdciaq_qyj-8x56ar2wfzom.png"></p><br><p>  c.  Deaktivieren Sie die Datei nach dem Aktualisieren der Projekthierarchie. <br><br><img src="https://habrastorage.org/webt/ut/h6/-p/uth6-puy3u6amils-egmrxs8cqo.png"></p><br></li><li><p>  Nach dem Erstellen des Moduls wird es im Projekthierarchie-Fenster angezeigt und die Schaltfl√§che Open Elaborate Design steht uns zur Verf√ºgung.  Schieben Sie es. <br><br><img src="https://habrastorage.org/webt/g8/cy/mk/g8cymkxi_hdpdwm32k7mld50t_s.png"></p><br></li><li><p>  Gehen Sie nach dem √ñffnen von Elaborate Design zu Fenster ‚Üí Ger√§t.  Es erscheint eine Anzeige des Feldes unseres FPGA. <br><br><img src="https://habrastorage.org/webt/sz/_n/cd/sz_ncdlckd-5rqbvicyshqmulxu.png"></p><br></li><li><p>  Die Vorbereitung ist beendet, wir schreiben ein Skript. </p><br></li></ol><br><h2 id="opredelenie-parametrov-i-procedur">  Definition von Parametern und Prozeduren </h2><br><h3 id="testovoe-izobrazhenie">  Testbild </h3><br><p>  Debuggen wir zun√§chst den Algorithmus / Code als solchen auf einem kleinen Bild, beispielsweise 5x3, und f√ºhren Sie ihn dann "vollst√§ndig" aus. </p><br><ol><li><p>  √ñffnen Sie Paint, beschr√§nken Sie das Bildfeld auf 5 x 3 Pixel (Sie k√∂nnen beliebige Farben verwenden).  Speichern Sie die Datei als "5x3.png" <br><br><img src="https://habrastorage.org/webt/nh/vg/l6/nhvgl6sub5ywa74hvrn-p5xq8hm.png"></p><br></li><li><p>  √ñffnen Sie das Programm Image2Bitmap und konvertieren Sie unser Bild in ein RGB565-Array. <br><br><img src="https://habrastorage.org/webt/aq/vb/u9/aqvbu9m6zhzrjakwux_1clytapk.png"></p><br></li><li><p>  Nach der Konvertierung gibt uns das Programm ein Array von 15 Pixeln </p><br></li></ol><br><pre><code class="plaintext hljs">*uint16_t image = { 0xf800, 0x07e0, 0x001f, 0x8410, 0x8010, 0xfbe4, 0xff80, 0x2589, 0x051d, 0x3a59, 0xa254, 0xbbca, 0xfd79, 0xef36, 0x9edd, };*</code> </pre> <br><h3 id="podgotovka-dannyh">  Datenaufbereitung </h3><br><p>  Bevor wir mit der Verarbeitung von Pixeln fortfahren, transformieren wir die von Image2Bitmap generierten Daten in eine einfache Liste, in die hexadezimale Pixelwerte geschrieben werden.  Wir kopieren die Programmdaten und speichern sie in der Datei pic_array.dat, die sich im Projektordner befinden sollte. </p><br><p><img src="https://habrastorage.org/webt/1b/xm/dj/1bxmdjjzyzhrqxqchlngx8qmpiu.png"></p><br><p>  Beim Start des erstellten Skripts m√ºssen wir die Datei "pic_array.dat" verarbeiten.  Es ist zu beachten, dass die Anzahl der Elemente in der von Image2Bitmap zur√ºckgegebenen Zeile nicht mit der Anzahl der Pixel in der Zeile des konvertierten Bildes √ºbereinstimmt. Aus diesem Grund erstellen wir eine separate Liste von "Pixeln". </p><br><p><img src="https://habrastorage.org/webt/rj/xl/pc/rjxlpcpleobp3ekmfwp4z_sofe0.png"></p><br><p>  Beim Lesen einer Datei m√ºssen Sie die erste Zeile "uint16_t image = {" und die letzte "};" ignorieren.  Um die erste Zeile beim Lesen einer Datei zu √ºberspringen, platzieren wir einfach die Zeile vor dem Zyklus des Lesens der gesamten Datei. </p><br><p><img src="https://habrastorage.org/webt/p0/j0/cl/p0j0clka4-dt-ggaskumsj5zkd8.png"></p><br><p>  Nach dem Lesen der gesamten Datei sehen wir, dass die letzte Zeile der Datei ‚Äû};‚Äú zu einem Element der Liste geworden ist, das einfach gel√∂scht wird. </p><br><p><img src="https://habrastorage.org/webt/zm/sc/ao/zmscaotma7373mbpnknpxh4xn5m.png"></p><br><p>  Dies vervollst√§ndigt die Bildung der Liste mit hexadezimalen Pixelwerten.  Jetzt fangen wir an, sie zu verarbeiten. </p><br><h3 id="opredelenie-razmera-izobrazheniya">  Bildgr√∂√üe </h3><br><p>  Schauen Sie sich noch einmal das FPGA-Feld und das Bild an.  Das FPGA-Feld ist in Abschnitte (SLICE) unterteilt, die die entsprechenden horizontalen Koordinaten "X" und vertikalen "Y" haben.  Zum Beispiel SLICE_X6Y36. </p><br><p><img src="https://habrastorage.org/webt/hm/iz/du/hmizdutpp0x-mieimj5ma07rgnk.png"></p><br><p>  Das Bild hat wiederum Pixel, auch mit horizontalen und vertikalen Koordinaten.  Wenn Sie das Bild auf dem FPGA √ºberlagern, sollten Sie das obere linke Pixel mit dem oberen linken Abschnitt des FPGA kombinieren.  In diesem Fall hat der ausgew√§hlte Kristall einen oberen Bereich mit der Koordinate X0Y49. </p><br><p><img src="https://habrastorage.org/webt/0h/ip/b-/0hipb-wldjghc-p2xs5-uafdtxe.png"></p><br><p>  Die Bildgr√∂√üe wird durch die Anzahl der Abschnitte im FPGA horizontal und vertikal bestimmt.  F√ºr den ausgew√§hlten Kristall variiert die horizontale Koordinate der Schnitte von X0 bis X131 und die vertikale Koordinate von Y49 bis Y0.  Daraus folgt, dass wir theoretisch ein Bild der Gr√∂√üe 132x50 auf dem ausgew√§hlten Kristall zeichnen k√∂nnen. </p><br><h3 id="nachalnye-parametry">  Anfangsparameter </h3><br><p>  Zusammenfassend: Die Anfangsparameter unseres Skripts sind: </p><br><ol><li><p>  X Startposition des Abschnitts: Variablenname start_x <br><br><img src="https://habrastorage.org/webt/l8/qr/gh/l8qrghklltffibctylxjcczbwqk.png"></p><br></li><li><p>  Startposition des Abschnitts auf der y-Achse: Variablenname start_y <br><br><img src="https://habrastorage.org/webt/yf/23/kf/yf23kfl9uxrt5zekli3n16zpzew.png"></p><br></li><li><p>  Bildbreite (f√ºr Testbild ist 5): Variable w <br><br><img src="https://habrastorage.org/webt/cs/oi/un/csoiunryjazlcstfmab_g3ee9r0.png"></p><br></li><li><p>  Bildh√∂he (f√ºr Testbild ist 3): Variable h <br><br><img src="https://habrastorage.org/webt/oz/d2/09/ozd209wjyznbgt2uvcb7fvrhd2c.png"></p><br></li></ol><br><h3 id="korrektirovka-cveta-piksela">  Anpassung der Pixelfarbe </h3><br><p>  Image2Bitmap bietet eine Reihe von Pixeln im RGB565-Format als 16-Bit-Zahl im Hexadezimalformat.  Wir sollten: </p><br><ol><li><p>  Konvertiert den Pixelwert in das Bin√§rformat.  Dies kann mit dem hex2bin-Verfahren durchgef√ºhrt werden, das in [3] zu finden ist. <br><br><img src="https://habrastorage.org/webt/fv/su/mt/fvsumtam5vrnkkm0uucn5vx4brc.png"></p><br></li><li><p>  Ordnen Sie die Bits den entsprechenden Farbkomponenten zu: <br>  ‚Ä¢ Die rote Komponente von R [15:11] <br><br><img src="https://habrastorage.org/webt/tj/mh/2k/tjmh2k-ihvuroxwduqm6_ugqmxi.png"></p><br><p>  ‚Ä¢ Gr√ºnkomponente G [10: 5] <br><br><img src="https://habrastorage.org/webt/y6/g0/yd/y6g0ydaosk3gkzzlylaenkh_oxm.png"></p><br><p>  ‚Ä¢ Blaue Komponente B [4: 0] <br><br><img src="https://habrastorage.org/webt/3i/97/vh/3i97vhrm4ivfevdr-xqwjzi9bzg.png"></p><br></li></ol><br><p>  <em>Erl√§uterung: Die Reihenfolge wird ge√§ndert, weil die hex2bin-Prozedur eine Zeichenfolge zur√ºckgibt, in der die Nummerierung der Elemente mit 0 beginnt, dh das 15. Bit entspricht dem 0. Element der Zeichenfolge und das 0. Bit dem 15. Element der Zeichenfolge</em> </p><br><ol><li><p>  Konvertieren Sie den Wert der Farbkomponente von bin√§r in dezimal.  Dies kann mit der bin2dec-Prozedur durchgef√ºhrt werden, die zu finden ist [3]: <br><br><img src="https://habrastorage.org/webt/hc/1n/em/hc1nemkiw4byzq2yc-vka0gckmq.png"><br><br><img src="https://habrastorage.org/webt/hi/td/uy/hitduy-sypn4d7bv7kidwic2g2m.png"></p><br></li><li><p>  Konvertieren Sie die Pixelwerte von RGB565 in das RGB888-Format, um eine fl√ºssigere Bildanzeige zu erzielen.  Dies geschieht mit zwei Listen, die in [4] zu finden sind.  Wie es funktioniert: <br>  ‚Ä¢ Die Aufl√∂sung der Farbkomponenten R und B betr√§gt 5 Bit.  Der Dezimalwert der Komponente wird mit der Position der in die Liste t5 geschriebenen Zahl verglichen, und der Wert der Komponente √§ndert sich in den Wert in der Tabelle <br><br><img src="https://habrastorage.org/webt/lk/vw/_a/lkvw_abrbpyeylfdoggm5pbpxns.png"><br><br><img src="https://habrastorage.org/webt/ao/mw/tv/aomwtv2q6hz9bg-_lmszmig7euq.png"><br><br><img src="https://habrastorage.org/webt/uy/qh/16/uyqh16vi-qkh9vpfrzcovq-zugs.png"></p><br><p>  ‚Ä¢ √Ñhnlich f√ºr Komponente G und Tabelle t6 <br><br><img src="https://habrastorage.org/webt/ti/is/lh/tiislhhogy2om7xxhvj_676dm5s.png"><br><br><img src="https://habrastorage.org/webt/pa/bh/3d/pabh3dqnk_3sk3sn6zt5big0t0e.png"></p><br></li></ol><br><h3 id="opredelenie-nalichiya-sekcii">  Abschnitt Verf√ºgbarkeit </h3><br><p>  In einigen FPGAs gibt es spezielle Ressourcen oder L√ºcken, die die fortlaufende Nummerierung der Schnittkoordinaten st√∂ren k√∂nnen.  In der folgenden Abbildung sehen Sie beispielsweise, dass die Abschnittsnummerierung unterbrochen ist (xc7s50-Kristall). <br><br><img src="https://habrastorage.org/webt/uq/er/yq/uqeryqyfckyqezufafrp-vrxbgi.png"></p><br><p>  Aus diesem Grund pr√ºfen wir vor dem Anf√§rben zun√§chst das Vorhandensein des Schnitts.  Wenn es existiert, dann male, wenn es nicht existiert, dann gehe zum n√§chsten Pixel <br><br><img src="https://habrastorage.org/webt/zx/a8/lt/zxa8lt_n0pb6o7s3ztrfozkuu2k.png"></p><br><h3 id="okrashivanie-sekcii">  Schnittf√§rbung </h3><br><p>  Abschnittsfarbe definiert, Abschnitt gepr√ºft.  Jetzt muss die Farbe mit dem Befehl highlight_objects den Abschnitten zugewiesen werden: <br><br><img src="https://habrastorage.org/webt/5i/fv/lp/5ifvlpcm5e70ur9sg7mufhmh4e0.png"></p><br><h3 id="vektor-dvuhmernyy-massiv">  Vektor ‚Üí Zweidimensionales Array </h3><br><p>  Zu Beginn haben wir die Bilddaten in eine Liste von Pixeln konvertiert, in denen ein progressiver Scan des Bildes gespeichert ist.  Um das Bild zu organisieren, f√ºhren wir zwei Variablen ein, x und y, die der Position der Pixel im Bild entsprechen.  Durch sequentielles Lesen der Elemente der Pixelliste wird ein Bild mit zwei for-Schleifen erzeugt: eine durch die Anzahl der Zeilen, die zweite durch die Position des Pixels in der Zeile <br><br><img src="https://habrastorage.org/webt/fk/pu/wa/fkpuwau81hpppxfxkgvvzuvdtr0.png"><br><br><img src="https://habrastorage.org/webt/hf/bj/jh/hfbjjhugkpxwqd2zdtrn0seyzse.png"></p><br><h3 id="polnyy-listing-skripta">  Vollst√§ndige Skriptliste </h3><br><div class="spoiler">  <b class="spoiler_title">Fpga_painter.tcl Auflistung</b> <div class="spoiler_text"><pre> <code class="vhdl hljs">#https://tcl.tk/ #http://www.tune-it.ru/web/il/home/-/blogs/-rgb888-&lt;-&gt;-rgb565----- #https://github.com/FoxExe/Image2Bitmap/releases/tag/<span class="hljs-number"><span class="hljs-number">0.5</span></span> #        set start_x <span class="hljs-number"><span class="hljs-number">0</span></span>; # set start_y <span class="hljs-number"><span class="hljs-number">49</span></span>; # set w <span class="hljs-number"><span class="hljs-number">5</span></span>; #  (   ) set h <span class="hljs-number"><span class="hljs-number">3</span></span>; #  ( ) proc hex2bin hex { set t [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0001</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0010</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0011</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0100</span></span> \ <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0101</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0110</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0111</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">1001</span></span> \ a <span class="hljs-number"><span class="hljs-number">1010</span></span> b <span class="hljs-number"><span class="hljs-number">1011</span></span> c <span class="hljs-number"><span class="hljs-number">1100</span></span> d <span class="hljs-number"><span class="hljs-number">1101</span></span> e <span class="hljs-number"><span class="hljs-number">1110</span></span> f <span class="hljs-number"><span class="hljs-number">1111</span></span> \ A <span class="hljs-number"><span class="hljs-number">1010</span></span> B <span class="hljs-number"><span class="hljs-number">1011</span></span> C <span class="hljs-number"><span class="hljs-number">1100</span></span> D <span class="hljs-number"><span class="hljs-number">1101</span></span> E <span class="hljs-number"><span class="hljs-number">1110</span></span> F <span class="hljs-number"><span class="hljs-number">1111</span></span>] regsub {^<span class="hljs-number"><span class="hljs-number">0</span></span>[xX]} $hex {} hex <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">map</span></span> -nocase $t $hex] } proc bin2dec bin { #returns <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> equivalent <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> $bin set res <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$bin == <span class="hljs-number"><span class="hljs-number">0</span></span>} { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } elseif {[<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> match -* $bin]} { set sign - set bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $bin[set bin {}] <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set sign {} } foreach i [split $bin {}] { set res [expr {$res*<span class="hljs-number"><span class="hljs-number">2</span></span>+$i}] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $sign$res } ############### #RGB565 -&gt; RGB888 using tables set t5 [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-number"><span class="hljs-number">58</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-number"><span class="hljs-number">74</span></span> <span class="hljs-number"><span class="hljs-number">82</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span> <span class="hljs-number"><span class="hljs-number">99</span></span> <span class="hljs-number"><span class="hljs-number">107</span></span> <span class="hljs-number"><span class="hljs-number">115</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span> <span class="hljs-number"><span class="hljs-number">132</span></span>\ <span class="hljs-number"><span class="hljs-number">140</span></span> <span class="hljs-number"><span class="hljs-number">148</span></span> <span class="hljs-number"><span class="hljs-number">156</span></span> <span class="hljs-number"><span class="hljs-number">165</span></span> <span class="hljs-number"><span class="hljs-number">173</span></span> <span class="hljs-number"><span class="hljs-number">181</span></span> <span class="hljs-number"><span class="hljs-number">189</span></span> <span class="hljs-number"><span class="hljs-number">197</span></span> <span class="hljs-number"><span class="hljs-number">206</span></span> <span class="hljs-number"><span class="hljs-number">214</span></span> <span class="hljs-number"><span class="hljs-number">222</span></span> <span class="hljs-number"><span class="hljs-number">230</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> <span class="hljs-number"><span class="hljs-number">247</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span>] set t6 [list <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-number"><span class="hljs-number">45</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-number"><span class="hljs-number">57</span></span> <span class="hljs-number"><span class="hljs-number">61</span></span> <span class="hljs-number"><span class="hljs-number">65</span></span> <span class="hljs-number"><span class="hljs-number">69</span></span>\ <span class="hljs-number"><span class="hljs-number">73</span></span> <span class="hljs-number"><span class="hljs-number">77</span></span> <span class="hljs-number"><span class="hljs-number">81</span></span> <span class="hljs-number"><span class="hljs-number">85</span></span> <span class="hljs-number"><span class="hljs-number">89</span></span> <span class="hljs-number"><span class="hljs-number">93</span></span> <span class="hljs-number"><span class="hljs-number">97</span></span> <span class="hljs-number"><span class="hljs-number">101</span></span> <span class="hljs-number"><span class="hljs-number">105</span></span> <span class="hljs-number"><span class="hljs-number">109</span></span> <span class="hljs-number"><span class="hljs-number">113</span></span> <span class="hljs-number"><span class="hljs-number">117</span></span> <span class="hljs-number"><span class="hljs-number">121</span></span> <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-number"><span class="hljs-number">130</span></span> <span class="hljs-number"><span class="hljs-number">134</span></span> <span class="hljs-number"><span class="hljs-number">138</span></span>\ <span class="hljs-number"><span class="hljs-number">142</span></span> <span class="hljs-number"><span class="hljs-number">146</span></span> <span class="hljs-number"><span class="hljs-number">150</span></span> <span class="hljs-number"><span class="hljs-number">154</span></span> <span class="hljs-number"><span class="hljs-number">158</span></span> <span class="hljs-number"><span class="hljs-number">162</span></span> <span class="hljs-number"><span class="hljs-number">166</span></span> <span class="hljs-number"><span class="hljs-number">170</span></span> <span class="hljs-number"><span class="hljs-number">174</span></span> <span class="hljs-number"><span class="hljs-number">178</span></span> <span class="hljs-number"><span class="hljs-number">182</span></span> <span class="hljs-number"><span class="hljs-number">186</span></span> <span class="hljs-number"><span class="hljs-number">190</span></span> <span class="hljs-number"><span class="hljs-number">194</span></span> <span class="hljs-number"><span class="hljs-number">198</span></span>\ <span class="hljs-number"><span class="hljs-number">202</span></span> <span class="hljs-number"><span class="hljs-number">206</span></span> <span class="hljs-number"><span class="hljs-number">210</span></span> <span class="hljs-number"><span class="hljs-number">215</span></span> <span class="hljs-number"><span class="hljs-number">219</span></span> <span class="hljs-number"><span class="hljs-number">223</span></span> <span class="hljs-number"><span class="hljs-number">227</span></span> <span class="hljs-number"><span class="hljs-number">231</span></span> <span class="hljs-number"><span class="hljs-number">235</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> <span class="hljs-number"><span class="hljs-number">247</span></span> <span class="hljs-number"><span class="hljs-number">251</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span>] ############### #  .         set script_path [get_property DIRECTORY [get_projects *]] cd $script_path #       set fId [<span class="hljs-keyword"><span class="hljs-keyword">open</span></span> {pic_array.dat} r] # ,       set pixels [list ] #    .    gets $fId <span class="hljs-literal"><span class="hljs-literal">line</span></span> #  .     . <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> {[gets $fId <span class="hljs-literal"><span class="hljs-literal">line</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>} { set pixels [concat $pixels $<span class="hljs-literal"><span class="hljs-literal">line</span></span>] } #   pixels   <span class="hljs-string"><span class="hljs-string">"};"</span></span>,    Image2Bitmap set pixels [lrange $pixels <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>] #    pixels set pix_num <span class="hljs-number"><span class="hljs-number">0</span></span>; #      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> {set y <span class="hljs-number"><span class="hljs-number">0</span></span>} { $y &lt; $h } {incr y} { #    ( ) set Y [expr {$start_y - $y}] #    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> {set x <span class="hljs-number"><span class="hljs-number">0</span></span>} { $x &lt; $w } {incr x } { set pix_val [lindex $pixels $pix_num]; incr pix_num #   binary  set pix_bin [hex2bin $pix_val] ; #     set R_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>] #    set R_dec [ bin2dec $R_bin ] #       t5 set R [lindex $t5 $R_dec] #       set G_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>] set G [lindex $t6 [ bin2dec $G_bin ]] set B_bin [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> $pix_bin <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>] set B [lindex $t5 [ bin2dec $B_bin ] ] #    set X [expr {$start_x + $x}] #,      set cond [get_sites <span class="hljs-string"><span class="hljs-string">"SLICE_X${X}Y${Y}"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$cond ne <span class="hljs-string"><span class="hljs-string">""</span></span>} { #  highlight_objects [get_sites <span class="hljs-string"><span class="hljs-string">"SLICE_X${X}Y${Y}"</span></span>] -rgb <span class="hljs-string"><span class="hljs-string">"$R $G $B"</span></span> } puts <span class="hljs-string"><span class="hljs-string">"X = $XY = $Y; $R $G $B"</span></span> } } close $fId puts <span class="hljs-string"><span class="hljs-string">"Complete::Check FPGA field::Window-&gt;Device"</span></span></code> </pre> </div></div><br><h2 id="testirovanie">  Testen </h2><br><ol><li><p>  Stellen Sie vor dem Testen sicher, dass das FPGA-Feld f√ºr Sie verf√ºgbar ist, d. H.  Eine der Entwurfsphasen ist offen: ausgearbeitet, synthetisiert oder implementiert.  Um das FPGA-Feld anzuzeigen, w√§hlen Sie Fenster ‚Üí Ger√§t <br><br><img src="https://habrastorage.org/webt/sz/_n/cd/sz_ncdlckd-5rqbvicyshqmulxu.png"></p><br></li><li><p>  √ñffnen Sie die Datei pic_array.dat und kopieren Sie die Daten von Image2Bitmap in die Datei.  Datei speichern <br><br><img src="https://habrastorage.org/webt/gf/bo/qk/gfboqkmege_xbatauuqznugutls.png"></p><br></li><li><p>  Lassen Sie uns das Skript √∂ffnen.  Stellen Sie die Koordinaten der oberen linken Pixel 0 und 49 ein, die Gr√∂√üe des Testbilds betr√§gt 5 x 3, und f√ºhren Sie das Skript aus.  Klicken Sie dazu mit der rechten Maustaste in das Skriptfeld und w√§hlen Sie Ausf√ºhren. <br><br><img src="https://habrastorage.org/webt/z6/ku/xk/z6kuxks3efxqgcg6w-ml18pwaic.png"></p><br></li><li><p>  Gehen Sie zur Tcl-Konsole und stellen Sie sicher, dass das Skript ausgef√ºhrt wurde. <br><br><img src="https://habrastorage.org/webt/km/of/qr/kmofqrtlejamixfiwexviemy4ay.png"></p><br></li><li><p>  Gehen Sie zur Registerkarte Ger√§t und stellen Sie sicher, dass die Zellen in der entsprechenden Farbe gef√§rbt sind. <br><br><img src="https://habrastorage.org/webt/xv/ba/nf/xvbanfmjcmx9lqxxofnq04wxwf0.png"></p><br></li><li><p>  Jetzt k√∂nnen wir ein beliebiges Bild aufnehmen, es in die gew√ºnschte Gr√∂√üe konvertieren und das FPGA-Feld ausf√ºllen.  Nachfolgend einige Beispiele. </p><br></li></ol><br><p>  <em>PS: Die benutzerdefinierte Farbzuweisung ersetzt die Standardfarbeinstellung von Vivado</em> <br><br><img src="https://habrastorage.org/webt/oz/hx/f4/ozhxf4slhbnycmhqmpfxbsb7fby.png"></p><br><h2 id="spisok-literatury">  Referenzliste </h2><br><ol><li>  UG835.  Vivado Design Suite TclCommand Referenzhandbuch </li><li>  <a href="">https://github.com/FoxExe/Image2Bitmap/releases/tag/0.5</a> </li><li>  <a href="https://tcl.tk/">https://tcl.tk</a> </li><li>  <a href="http://www.tune-it.ru/web/il/home/-/blogs/%25D0%25BF%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5-rgb888">http://www.tune-it.ru/web/il/home/-/blogs/conversion-rgb888</a> - &lt;-&gt; -rgb565-und-schutz-pilze-vor-verblassen </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de477974/">https://habr.com/ru/post/de477974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de477956/index.html">JavaScript in 3D: eine Einf√ºhrung in Three.js</a></li>
<li><a href="../de477958/index.html">Top 10 Trends aus dem neuen High-Tech-Tech Crime Trends Report 2019/2020 Group-IB</a></li>
<li><a href="../de477964/index.html">Zwei Monate von der Idee bis zum ersten Verkauf: Erfahrung im Genesis-Team</a></li>
<li><a href="../de477966/index.html">HolyJS 2019 Moskau aus der Sicht des Teilnehmers</a></li>
<li><a href="../de477968/index.html">Fallen in einen Kaninchenbau: Eine Geschichte √ºber einen Fehler beim Neustart eines Lackes - Teil 1</a></li>
<li><a href="../de477976/index.html">Visualisierung und Analyse der Community-Struktur anhand von Grafiken</a></li>
<li><a href="../de477978/index.html">Hier finden Sie die besten Preise des Jahres f√ºr Gadgets</a></li>
<li><a href="../de478474/index.html">Bruder Pablo Escobar hat auch ein flexibles Smartphone herausgebracht</a></li>
<li><a href="../de478480/index.html">K√ºnstliche Intelligenz, ITSM und allgemein, woher kommt LEAN?</a></li>
<li><a href="../de478482/index.html">Der Entwickler √∂ffnete eine Bar f√ºr Entwickler und veranstaltete dort Meetings zu den Themen Angular, Layout und PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>