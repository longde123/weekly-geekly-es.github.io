<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖüèº üì∑ ‚åõÔ∏è 1. Check Point Log Analysis: l'application officielle Check Point pour Splunk ‚ôçÔ∏è ü•ö ü••</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lorsque vous travaillez avec des passerelles de s√©curit√© Check Point, la t√¢che d'analyser les journaux pour d√©tecter et analyser les incidents de s√©cu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1. Check Point Log Analysis: l'application officielle Check Point pour Splunk</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/431146/"><img src="https://habrastorage.org/webt/bq/gl/8f/bqgl8fhc3r4o-hr5aox1vkwq-ou.png"><br><br>  Lorsque vous travaillez avec des passerelles de s√©curit√© Check Point, la t√¢che d'analyser les journaux pour d√©tecter et analyser les incidents de s√©curit√© des informations se pose tr√®s souvent.  En r√®gle g√©n√©rale, les organisations disposent d√©j√† d'une sorte de syst√®me de journalisation, et la t√¢che consiste √† transporter les journaux √† partir du serveur de gestion Check Point, puis √† configurer des filtres pour les journaux, √† √©tablir des tableaux de bord, des planifications, etc.  Dans ce cours, nous examinerons diverses options pour analyser les journaux Check Point √† l'aide de fonctionnalit√©s internes et d'applications tierces, examiner les informations utiles que nous pouvons extraire et comment elles aideront √† configurer le pare-feu. <br><a name="habracut"></a><br>  Dans le cadre des produits Check Point, la fonctionnalit√© SmartEvent en est responsable, ce qui g√©n√®re des rapports sur les mod√®les. Vous pouvez √©galement configurer un ensemble limit√© d'actions automatiques, mais ce n'est pas le cas maintenant, nous reviendrons sur ce probl√®me plus tard.  Il existe √©galement d'autres solutions √† ce probl√®me, qui ont √©t√© discut√©es dans nos autres articles: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Splunk + Check Point, un exemple d'analyse des journaux de votre pare-feu</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√âv√©nement intelligent Check Point.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mini guide</a> </li></ul><br>  La mise en place de toutes les solutions ci-dessus n√©cessite une certaine qualification et beaucoup de temps pour la mise en ≈ìuvre.  Et si vous avez besoin d'une solution ici et maintenant?  Check Point a r√©cemment publi√© une application qui convient parfaitement √† ce cas - l'application Check Point pour Splunk, pour laquelle les donn√©es sont envoy√©es via syslog √† l'aide de l'outil d'exportation de journaux en temps r√©el au syst√®me de journalisation Splunk.  Dans cet article, nous examinerons en d√©tail cette solution, l'installation et les informations que nous obtenons sur la sortie. <br><br><h3>  <b>Exigences d'installation</b> </h3><br>  Le serveur de gestion Check Point n√©cessite l'outil d'exportation de journaux install√© pour envoyer des journaux √† l'aide du protocole syslog.  Dans la version GAIA R80.20, Log Exporter est install√© par d√©faut, mais pour prendre en charge le format de journal Splunk, vous devez installer Jumbo Hotfix, dans d'autres versions, avant d'installer Log Exporter, vous devez d'abord l'installer pour prendre en charge Jumbo Hotfix. <br>  Toutes les exigences pour la version du correctif sont indiqu√©es ci-dessous: <br><br><ol><li>  R80.20 - Jumbo Hotfix Take 5 ou sup√©rieur; </li><li>  R80.10 - Jumbo Hotfix Take 56 ou sup√©rieur; </li><li>  R77.30 - Jumbo Hotfix Prenez 292 ou plus. </li></ol><br>  Pour que l'application fonctionne, la version minimale du syst√®me doit √™tre au moins Splunk 6.5, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">package Splunk Common Information Model (CIM)</a> doit √©galement √™tre install√©. <br><br><h3>  <b>Installation et lancement</b> </h3><br>  Le processus d'installation est assez trivial, nous installons d'abord Log Exporter, puis l'application sur Splunk, nous configurons le processus d'envoi des journaux au serveur de gestion et le processus d'acceptation dans le syst√®me de journalisation, et au point final, nous commen√ßons le transport des journaux, nous v√©rifions que tout fonctionne comme pr√©vu.  Examinez tous les points plus en d√©tail. <br><br>  <b>1.Installation de Jumbo Hotfix selon les besoins.</b> <br>  Nous allons dans le portail GAIA dans un navigateur Web, dans le menu de gauche Mises √† niveau (CPUSE), √âtat et actions, s√©lectionnez le package de correctifs Jumbo recommand√©, qui sera √©videmment plus √©lev√© en version que le seuil inf√©rieur dans les exigences, ou recherchez la version souhait√©e dans Ajouter des correctifs √† partir du cloud, installez , le processus n√©cessite un red√©marrage du serveur de gestion. <br><br>  <b>2. Installez Log Exporter si votre version de Check Point est inf√©rieure √† R80.20.</b> <br>  Pour installer Log Exporter sur la gestion, t√©l√©chargez d'abord l'archive √† partir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du portail Check Point</a> . <br><br><img src="https://habrastorage.org/webt/14/xo/xv/14xoxvdmuob7dmrpeyh-g6ro7om.png"><br><br>  Ensuite, allez dans le menu CPUSE-&gt; Statut et actions, s√©lectionnez Importer le package, sp√©cifiez le chemin vers l'archive, importez.  Apr√®s cela, modifiez l'affichage des packages de Afficher les packages recommand√©s √† Afficher tous les packages, s√©lectionnez l'archive import√©e, installez. <br><br>  <b>3. Installez CIM s'il n'est pas install√© auparavant.</b> <br>  Acc√©dez √† Splunk WebUI, recherchez le package CIM dans G√©rer les applications -&gt; Parcourir plus d'applications, installez. <br><br><img src="https://habrastorage.org/webt/rq/qm/kf/rqqmkfbyxpzo2mwjjajbsohngre.png"><br><br>  <b>4. installez l'application Check Point pour Splunk</b> <br>  T√©l√©chargez l'archive √† partir du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">portail</a> , puis acc√©dez √† Splunk WebUI, G√©rer les applications, Installer l'application √† partir du fichier, s√©lectionnez l'archive souhait√©e, cliquez sur t√©l√©charger.  Nous attendons la notification de la r√©ussite de l'op√©ration, assurez-vous que l'application est d√©sormais visible dans la liste des applications. <br><br><img src="https://habrastorage.org/webt/t7/dd/vo/t7ddvo5g4c5dqzuunqyyxwm0w8a.png"><br><br>  Cela devrait ressembler √† l'application install√©e, bien s√ªr, entre autres applications: <br><br><img src="https://habrastorage.org/webt/hs/iy/y0/hsiyy0qqcvjxqhqss9pg96pi7a4.png"><br><br>  Pour envoyer des journaux via syslog, vous devez d'abord cr√©er un processus d'exportateur de journaux, puis configurer l'entr√©e de donn√©es sur Splunk et d√©marrer le processus cr√©√© sur le serveur de gestion Check Point. <br><br>  <b>5. Configurer l'exportateur de journaux</b> <br>  Sur le serveur de gestion Check Point dans la CLI, en mode expert, ex√©cutez la commande: <br>  cp_log_export add name [serveur-domaine &lt;serveur-domaine&gt;] serveur-cible &lt;serveur-cible&gt; port-cible &lt;port-cible&gt; protocole &lt;tcp |  udp&gt; format splunk read-mode &lt;raw |  semi-unifi√©&gt; <br>  o√π est le nom de la configuration, &lt;target-server&gt; est l'adresse IP du syst√®me Splunk auquel nous envoyons des donn√©es, &lt;target-port&gt; est le port vers lequel nous envoyons des donn√©es. <br>  Exemple: cp_log_export add name check_point_syslog target-server 10.10.1.159 target-port 9000 protocol tcp format splunk read-mode semi-unified <br><br>  <b>6. Configurer l'entr√©e de donn√©es sur Splunk</b> <br>  Acc√©dez √† Splunk WebUI, s√©lectionnez Param√®tres dans le menu, s√©lectionnez Entr√©es de donn√©es dans la section Donn√©es. <br><img src="https://habrastorage.org/webt/9j/-g/do/9j-gdoyfjdfes3plbidjrupnzmw.png"><br>  Nous s√©lectionnons le protocole par lequel les donn√©es iront √† Splunk, dans cet exemple tcp, s√©lectionnez + Ajouter nouveau. <br><br><img src="https://habrastorage.org/webt/je/99/gt/je99gt6ztojek43mp95-soczzx4.png"><br><br>  Ensuite, entrez le port &lt;target-port&gt;, qui a √©t√© sp√©cifi√© dans Log Exporter, dans ce cas 9000, vous pouvez √©galement sp√©cifier l'adresse IP pour laquelle accepter les connexions, puis attendez le bouton Suivant. <br><br><img src="https://habrastorage.org/webt/ah/5r/vq/ah5rvqiqseck0vnig3k0qgq2u_u.png"><br><br>  Dans le type de source, sp√©cifiez cp_log, m√©thode - IP, l'index peut √™tre laiss√© par d√©faut, toutes les donn√©es iront √† index = Main et si vous avez d'autres donn√©es pour cet index, le temps de recherche peut augmenter de mani√®re significative, vous pouvez sp√©cifier un index diff√©rent ou en cr√©er un nouveau, puis dans l'application elle-m√™me, vous devez sp√©cifier directement dans quel index effectuer les op√©rations de recherche. <br><img src="https://habrastorage.org/webt/vk/50/9b/vk509b8nlj3bzibmhei3ypbe1g8.png"><br>  Apr√®s avoir cliqu√© sur Revoir, nous verrons que tous les param√®tres sont vrais, s√©lectionnez Soumettre, la configuration des entr√©es de donn√©es est termin√©e, il vous suffit d'envoyer les journaux √† partir du serveur de gestion Check Point. <br><br>  <b>7. Nous commen√ßons le processus de t√©l√©chargement des journaux sur Splunk</b> <br>  En mode expert, entrez la commande: <br>  cp_log_export red√©marrer le nom, o√π est le nom de configuration cr√©√© √† la premi√®re √©tape <br>  Exemple: cp_log_export restart check_point_syslog <br>  La configuration est termin√©e, apr√®s cela, il ne reste plus qu'√† s'assurer que les journaux sont envoy√©s √† Splunk, en utilisant les m√©canismes de requ√™te de recherche standard pour Splunk. <br><br><img src="https://habrastorage.org/webt/ma/jo/sb/majosbg53muvbjt5m3hskshscaa.png"><br><br>  Vous pouvez maintenant passer √† l'analyse du fonctionnement de l'application elle-m√™me, des tableaux de bord et des rapports qu'elle contient, des informations importantes qui peuvent √™tre obtenues et des conclusions √† tirer. <br><br><h3>  Analyse des journaux </h3><br>  L'application est divis√©e en 2 sections - Pr√©sentation g√©n√©rale et Protection contre la menace, qui √† son tour est divis√©e en Pr√©sentation de la cyberattaque, Protection contre les sablages et √âv√©nements suppl√©mentaires de pr√©vention des menaces.  Nous consid√©rons chaque section s√©par√©ment. <br><br>  <b>Pr√©sentation g√©n√©rale</b> <br><br><img src="https://habrastorage.org/webt/lh/qx/dt/lhqxdtflctlgbgvjr__psy5lj7c.png"><br><br>  La page principale de l'application pr√©sente plusieurs tableaux, statistiques et graphiques.  Dans ce cas, certaines informations sont de base, telles que le nombre de passerelles et de serveurs de gestion, ou le nombre de journaux sur les lames, tr√®s probablement vous n'apprendrez rien de nouveau, et sur la base de ces informations, des conclusions peuvent √™tre tir√©es qui auront un effet positif. <br>  De mon point de vue, les √©l√©ments les plus int√©ressants ici sont les types d'attaques critiques, les attaques critiques autoris√©es par la strat√©gie, les h√¥tes infect√©s, les applications √† haut risque autoris√©es, je vais vous expliquer pourquoi. <br>  Selon les types d'attaques critiques, les attaques critiques autoris√©es par la strat√©gie peuvent am√©liorer la strat√©gie de s√©curit√© de la pr√©vention des menaces (en d√©pla√ßant les actions de d√©tection √† pr√©vention par des signatures sp√©cifiques ou en augmentant le niveau de r√©ponse), augmentant ainsi le niveau de s√©curit√© pour se prot√©ger contre les menaces virales, les tentatives d'introduction et de piratage de votre ordinateur. infrastructure.  Les h√¥tes infect√©s indiquent les utilisateurs qui peuvent √™tre infect√©s. Par cons√©quent, ils doivent √™tre v√©rifi√©s s√©par√©ment par un antivirus ou isol√©s du r√©seau, emp√™chant le virus de traverser le r√©seau de l'organisation.  Sur la base du diagramme des applications √† haut risque autoris√©es, vous pouvez bloquer les applications potentiellement dangereuses les plus visit√©es qui sont actuellement autoris√©es √† √™tre bloqu√©es par les utilisateurs. <br>  Les diagrammes Applications et filtrage d'URL par risque, incidents de s√©curit√© par gravit√© et actions d'attaque par strat√©gie sont de nature syst√©matique et indiquent si l'√©tat de s√©curit√© de votre organisation s'am√©liore au fil du temps, c'est-√†-dire si les modifications apport√©es √† la strat√©gie de s√©curit√© ont contribu√© √† mieux prot√©ger l'infrastructure. <br><br>  <b>Pr√©sentation de Cyber ‚Äã‚ÄãAttack</b> <br><br><img src="https://habrastorage.org/webt/al/qz/kj/alqzkjrz65gjhfsekfnrfew0pde.png"><br><br><img src="https://habrastorage.org/webt/34/vd/ae/34vdae6rpbgtnp6sg6vmjh5tzuk.png"><br><br><img src="https://habrastorage.org/webt/mi/-d/rt/mi-drtnm-zab4dofjx240gyaaua.png"><br><br>  Ce tableau de bord affiche des informations plus d√©taill√©es sur les h√¥tes infect√©s et sur les utilisateurs qui t√©l√©chargent des virus.  Il est tr√®s pratique de s√©parer par fichiers infect√©s t√©l√©charg√©s et par messages infect√©s, vous pouvez identifier les menaces et cr√©er une strat√©gie de s√©curit√© de pr√©vention des menaces pour les services individuels, un profil de s√©curit√© pour le trafic smtp et un autre profil pour http et https.  SandBlast Protection fournit des informations plus d√©taill√©es sur les fichiers infect√©s, vous pouvez consulter la gravit√© et identifier les lacunes de votre profil de s√©curit√© dans la pr√©vention des menaces. <br><br><h3>  Conclusion </h3><br>  Gr√¢ce √† cette application, il est tr√®s rapide et pratique d'obtenir des informations sur les points faibles de votre politique de s√©curit√©, la mise en place de l'application prend un peu de temps et ne n√©cessite pas beaucoup de comp√©tences dans ces solutions.  Autrement dit, si vous doutez de vos param√®tres de s√©curit√© et que vous avez besoin d'une analyse sans beaucoup de temps, alors c'est une solution tr√®s pratique.  Cependant, il est clair que l'application a encore s√©rieusement besoin d'√™tre am√©lior√©e, il n'y a pas de statistiques sur les utilisateurs, il est tr√®s int√©ressant de voir une liste des applications les plus utilis√©es et la quantit√© de trafic qui y va, etc.  Comme il ne s'agit que de la premi√®re version, l'application sera mise √† jour et, tr√®s probablement, ce sera une tr√®s bonne solution d'analyse au fil du temps, mais maintenant, si nous consid√©rons cette application uniquement comme une analyse de journal, elle est bien inf√©rieure aux autres solutions.  Dans les articles suivants, nous examinerons et comparerons les capacit√©s de SmartEvent et d'autres applications Splunk pour analyser les journaux Check Point, y compris l'application cr√©√©e par nos ing√©nieurs. <br><br>  Si vous n'avez pas essay√© Splunk pour analyser les journaux de Check Point, il est temps de commencer.  Si vous avez des questions ou des probl√®mes avec Splunk ou Check Point, vous pouvez nous les poser et nous vous aiderons. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr431146/">https://habr.com/ru/post/fr431146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr431136/index.html">Des t√©raoctets en apesanteur dans votre poche - est l'avenir ici? Exploration des fonctionnalit√©s d'HyperX SAVAGE EXO</a></li>
<li><a href="../fr431138/index.html">Biom√©trie avec la cl√© Rostelecom: comment le FSB a lanc√© pour la premi√®re fois la cryptographie russe dans les magasins d'applications</a></li>
<li><a href="../fr431140/index.html">Reportage de la m√©tapa Go in Production: vid√©o, photos, pr√©sentations</a></li>
<li><a href="../fr431142/index.html">Comment ex√©cuter SQL Profiler Trace la nuit, √† une heure pr√©cise?</a></li>
<li><a href="../fr431144/index.html">Far Fields mic (Mic array) - h√©ros discret dans une colonne intelligente</a></li>
<li><a href="../fr431148/index.html">La nouvelle entreprise mobile iOS. Partie # 1: G√©n√©ration de code pour les ressources</a></li>
<li><a href="../fr431152/index.html">Metro 4 est un voyage de 6 ans. Une br√®ve histoire de Metro UI CSS</a></li>
<li><a href="../fr431154/index.html">Les lacunes dans les qu√™tes de Fallout 76 ont permis aux joueurs de faire de l'enfer nucl√©aire</a></li>
<li><a href="../fr431156/index.html">CHOC! Un nouveau logiciel de phishing remporte le deuxi√®me facteur</a></li>
<li><a href="../fr431158/index.html">Plus de caf√©, moins de caf√©ine: Intel 9e g√©n√©ration (partie 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>