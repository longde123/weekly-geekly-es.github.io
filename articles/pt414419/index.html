<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüç≥ ‚è≤Ô∏è üå† A ESET prepara o spyware InvisiMole desde 2013 üßëüèΩ‚Äçü§ù‚Äçüßëüèª üõÄ ‚ù£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Acompanhe as v√≠timas de alto escal√£o, permanecendo na sombra. Este √© o princ√≠pio de opera√ß√£o de dois componentes maliciosos do InvisiMole. Eles transf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A ESET prepara o spyware InvisiMole desde 2013</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/414419/">  Acompanhe as v√≠timas de alto escal√£o, permanecendo na sombra.  Este √© o princ√≠pio de opera√ß√£o de dois componentes maliciosos do InvisiMole.  Eles transformam o computador infectado em uma c√¢mera de v√≠deo dos atacantes, que permite ver e ouvir tudo o que acontece no escrit√≥rio ou em qualquer outro local onde o dispositivo est√° localizado.  Os operadores do InvisiMole se conectam facilmente ao sistema, monitoram as a√ß√µes da v√≠tima e roubam seus segredos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qz/z_/0f/qzz_0fx62wvi_detfemzuckk0zs.jpeg"></div><br>  De acordo com a telemetria da ESET, os invasores por tr√°s desse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">spyware</a> est√£o ativos desde pelo menos 2013.  No entanto, essa ferramenta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">espionagem cibern√©tica</a> n√£o foi apenas estudada, mas n√£o foi detectada at√© ser detectada pelos produtos ESET em computadores infectados na R√∫ssia e na Ucr√¢nia. <br><br>  A campanha √© altamente direcionada, o que explica o baixo n√≠vel de infec√ß√£o - apenas algumas dezenas de computadores. <br><a name="habracut"></a><br>  O InvisiMole possui uma arquitetura modular, inicia sua jornada com uma DLL de wrapper (DLL de wrapper) e, em seguida, existem dois m√≥dulos incorporados a seus recursos.  Ambos os m√≥dulos s√£o backdoors multifuncionais, permitindo que o Malvari colete informa√ß√µes m√°ximas sobre o alvo. <br><br>  Para desviar a aten√ß√£o do usu√°rio da m√°quina infectada, medidas adicionais s√£o aplicadas.  Isso permite que o programa malicioso permane√ßa no sistema por um longo per√≠odo de tempo.  Ainda n√£o estabelecemos o vetor de infec√ß√£o - atualmente todas as op√ß√µes s√£o poss√≠veis, incluindo a instala√ß√£o manual com acesso f√≠sico √† m√°quina. <br><br><h3>  Instala√ß√£o e Persist√™ncia </h3><br>  A primeira parte do malvari sob investiga√ß√£o √© um wrapper DLL compilado usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Free Pascal</a> Compiler.  De acordo com nossos dados de telemetria, a DLL √© colocada na pasta Windows e disfar√ßada como um <code>mpr.dll</code> biblioteca <code>mpr.dll</code> leg√≠timo com informa√ß√µes de vers√£o falsas. <br><br><img src="https://habrastorage.org/webt/63/po/le/63polemyrko5n7gdyrzmenhgeva.png"><br>  <i>Figura 1. Wrapper DLL disfar√ßado como um arquivo de biblioteca leg√≠timo mpr.dll, copiando as informa√ß√µes de nome e vers√£o</i> <br><br>  N√£o vimos exemplos com outros nomes de inv√≥lucros, embora haja indica√ß√µes no c√≥digo DLL de que o arquivo tamb√©m pode ser chamado de <code>fxsst.dll</code> ou <code>winmm.dll</code> . <br><br>  A primeira maneira de iniciar o malvari √© a t√©cnica de substituir DLLs (seq√ºestro de DLL).  O wrapper DLL √© colocado na mesma pasta que o <code>explorer.exe</code> e carregado na inicializa√ß√£o do Windows, juntamente com o processo do Windows Explorer, em vez da biblioteca leg√≠tima localizada na <code>%windir%\system32</code> . <br><br>  Encontramos as vers√µes de 32 e 64 bits do Malvari, que fornecem persist√™ncia nas duas arquiteturas. <br><br>  Como alternativa √†s DLLs falsificadas, outros m√©todos de carregamento e persist√™ncia s√£o poss√≠veis.  A DLL do wrapper exporta a fun√ß√£o <code>GetDataLength</code> .  Ao chamar essa fun√ß√£o, a DLL verifica se foi carregada pelo processo <code>rundll32.exe</code> usando <code>explorer.exe</code> ou <code>svchost.exe</code> como processo pai e, em seguida, inicia a carga √∫til.  Isso sugere outros m√©todos poss√≠veis para garantir persist√™ncia - adicionar tarefas ao agendador (o processo pai √© <code>svchost.exe</code> ) ou gravar na chave de execu√ß√£o autom√°tica no registro (o processo pai √© <code>explorer.exe</code> ). <br><br>  Independentemente de como a persist√™ncia √© mantida, o comportamento do malware e a pr√≥pria carga √∫til s√£o os mesmos em todos os casos.  O wrapper DLL carrega o m√≥dulo armazenado nos recursos com os nomes <code>RC2FM</code> e <code>RC2CL</code> e (se a substitui√ß√£o da DLL for usada) uma biblioteca leg√≠tima no processo <code>explorer.exe</code> para n√£o interromper a opera√ß√£o normal do aplicativo e passar despercebida. <br><br><img src="https://habrastorage.org/webt/tf/-0/eh/tf-0ehnfccoxblcwcetgc7zcgq8.png"><br>  <i>Figura 2. Fun√ß√µes de wrapper exportadas</i> <br><br><h2>  An√°lise t√©cnica </h2><br>  A data exata da compila√ß√£o do malware √© desconhecida - as amostras mais recentes do wrapper DLL foram alteradas pelos autores, os carimbos de data / hora do PE foram redefinidos para zero manualmente.  No entanto, no decorrer do estudo, encontramos uma vers√£o anterior, datada de 13 de outubro de 2013, para que as novas vers√µes sejam claramente compiladas posteriormente. <br><br><img src="https://habrastorage.org/webt/rg/ke/pn/rgkepn1sgdnddzbzmrfdij84cbu.png"><br>  <i>Figura 3. Em todas as amostras posteriores, os carimbos de data / hora s√£o definidos como zero</i> <br><br><h3>  Criptografia e descriptografia </h3><br>  Para se disfar√ßar de analistas de v√≠rus e administradores de sistema, os autores do programa malicioso usam criptografia de seq√º√™ncias de caracteres, arquivos internos, dados de configura√ß√£o e comunica√ß√µes de rede.  Enquanto o m√≥dulo <code>RC2FM</code> usa cifras personalizadas, o wrapper DLL e o m√≥dulo <code>RC2CL</code> usam um procedimento espec√≠fico para todos os fins, incluindo descriptografar outros m√≥dulos maliciosos criados no wrapper DLL. <br><br>  O script com o qual voc√™ pode extrair os <code>RC2CL</code> e <code>RC2CL</code> do wrapper DLL est√° dispon√≠vel no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio ESET no GitHub</a> . <br><br><img src="https://habrastorage.org/webt/wx/qz/dm/wxqzdmpwpxazkzgym0u3n-zghmw.png"><br>  <i>Figura 4. Procedimento de descriptografia em v√°rias amostras (descompilado e desmontado)</i> <br><br><h3>  M√≥dulo RC2FM </h3><br>  O primeiro m√≥dulo <code>RC2FM</code> menor cont√©m um backdoor que suporta 15 comandos.  Eles s√£o executados no computador infectado, conforme indicado pelo invasor.  O m√≥dulo pode fazer v√°rias altera√ß√µes no sistema e tamb√©m inclui ferramentas para espionagem cibern√©tica. <br><br>  Os arquivos t√™m a op√ß√£o de registrar, mas o nome do log do sistema n√£o est√° especificado na amostra.  Isso sugere que a fun√ß√£o foi usada apenas no est√°gio de desenvolvimento. <br><br><h4>  Comunica√ß√£o em rede </h4><br>  Este m√≥dulo se comunica com os servidores C&amp;C, que s√£o codificados na amostra ou posteriormente adicionados pelos atacantes. <br><br>  Al√©m disso, o m√≥dulo pode acessar o servidor C&amp;C mesmo com o proxy configurado na m√°quina infectada.  Se n√£o foi poss√≠vel estabelecer uma conex√£o direta, o m√≥dulo tenta se conectar a qualquer um dos seus servidores C&amp;C usando proxies configurados localmente ou proxies configurados para diferentes navegadores (Firefox, Pale Moon e Opera). <br>  O RC2FM pode at√© verificar a lista de aplicativos usados ‚Äã‚Äãrecentemente e tentar encontrar os execut√°veis ‚Äã‚Äãdo navegador port√°til: <br><br>  FirefoxPortable.exe <br>  OperaPortable.exe <br>  Execute waterfox.exe <br>  OperaAC.exe <br>  Palemoon-Portable.exe <br><br>  Se a v√≠tima usar um desses navegadores port√°teis <i>com o servidor proxy configurado</i> , o malware poder√° detect√°-lo nas configura√ß√µes do usu√°rio e us√°-lo para se comunicar com seus servidores C&amp;C. <br><br>  A comunica√ß√£o com o servidor C &amp; C √© uma s√©rie de solicita√ß√µes HTTP GET e POST, conforme mostrado na Figura 5. A solicita√ß√£o criptografada cont√©m o ID do PC e o registro de data e hora, al√©m de outras informa√ß√µes (opcional).  √â importante observar que o m√≥dulo <code>RC2FM</code> usa v√°rios m√©todos de criptografia (variantes da criptografia XOR simples), ao contr√°rio de outros componentes do InvisiMole. <br><br><img src="https://habrastorage.org/webt/ml/ev/kx/mlevkxds5qah0qvlkocfgxsfplk.png"><br>  <i>Figura 5. Um exemplo de uma solicita√ß√£o enviada para um servidor C&amp;C pelo m√≥dulo RC2FM</i> <br><br>  Ap√≥s o registro bem-sucedido da v√≠tima no servidor C&amp;C, informa√ß√µes adicionais s√£o carregadas no sistema, que ser√£o interpretadas pelo comando backdoor. <br><br><h4>  Funcionalidade </h4><br>  <code>RC2FM</code> suporta comandos para listar informa√ß√µes b√°sicas do sistema e fazer altera√ß√µes simples no sistema, al√©m de v√°rios recursos de spyware.  A pedido dos atacantes, o m√≥dulo pode ligar remotamente o microfone em um computador comprometido e gravar √°udio.  O registro √© codificado no formato MP3 usando a biblioteca leg√≠tima <code>lame.dll</code> , que √© baixada e usada por malware. <br><br>  Outra ferramenta para roubar dados s√£o as capturas de tela.  Um dos comandos do backdoor foi projetado para fazer capturas de tela. <br><br>  Um programa malicioso monitora todos os discos internos e externos exibidos no sistema local.  Quando uma nova unidade √© conectada, ela cria uma lista com todos os arquivos e a armazena em forma criptografada. <br><br>  As informa√ß√µes coletadas ser√£o transmitidas ao atacante ap√≥s o envio do comando apropriado. <br><br><h4>  Equipes de backdoor </h4><br>  A seguir est√£o os IDs e descri√ß√µes dos comandos suportados.  A visualiza√ß√£o da fun√ß√£o backdoor no int√©rprete √© mostrada na Figura 6. <br><br>  0 - Fa√ßa listas de discos exibidos, arquivos em uma pasta, compartilhamentos de rede <br>  2 - Crie, mova, renomeie, execute ou exclua um arquivo, exclua um diret√≥rio usando o caminho especificado <br>  4 - Abra o arquivo, defina o ponteiro para o in√≠cio do arquivo <br>  5 - Feche um arquivo aberto anteriormente <br>  6 - Grave dados em um arquivo aberto anteriormente <br>  7 - Alterar atributos do arquivo de hora / excluir arquivo <br>  8 - Abra o arquivo, coloque o ponteiro no final do arquivo <br>  10 - Alterar atributos do arquivo de hora / excluir arquivo <br>  12 - Encontre arquivos pela m√°scara de arquivo especificada no diret√≥rio especificado <br>  13 - Tire uma captura de tela <br>  14 - Carregar ou modificar arquivos usando dados internos <br>  15 - Grave som usando dispositivos de √°udio conectados, fa√ßa uma lista de dispositivos dispon√≠veis, envie grava√ß√£o, mude a configura√ß√£o <br>  16 - Verifique se h√° arquivos abertos no m√≥dulo <br>  17 - Atualize a lista de servidores C &amp; C <br>  19 - Criar, instalar, copiar, listar ou excluir chaves ou valores de registro especificados <br><br><img src="https://habrastorage.org/webt/41/kf/7v/41kf7vzsczihmuttbyyjrbtcybe.png"><br>  <i>Figura 6. A fun√ß√£o backdoor no int√©rprete (original e ap√≥s nossa an√°lise, modificada usando a fun√ß√£o Group Nodes no IDA Pro para facilitar a leitura)</i> <br><br><h3>  M√≥dulo RC2CL </h3><br>  O m√≥dulo <code>RC2CL</code> tamb√©m √© um backdoor com uma ampla gama de ferramentas de espionagem.  √â iniciado por um wrapper DLL ao mesmo tempo que o m√≥dulo <code>RC2FM</code> .  Este √© um m√≥dulo mais complexo, √© mais prov√°vel que suas fun√ß√µes visem a coleta m√°xima de informa√ß√µes do que a altera√ß√£o do sistema. <br><br>  Curiosamente, o m√≥dulo <code>RC2CL</code> tem a op√ß√£o de desativar a funcionalidade de backdoor e funcionar como proxy.  Nesse caso, o malware desliga o firewall do Windows e cria um servidor que suporta a comunica√ß√£o entre o cliente e o servidor C&amp;C ou dois clientes. <br><br><h4>  Comunica√ß√£o em rede </h4><br>  O malware se comunica com os servidores C&amp;C atrav√©s de um soquete TCP.  As mensagens enviadas pelo cliente s√£o mascaradas sob o protocolo HTTP, mas voc√™ deve prestar aten√ß√£o ao m√©todo HTTP inv√°lido "HIDE" no exemplo na Figura 7. <br><br>  As solicita√ß√µes cont√™m o identificador do software comprometido, o tipo de solicita√ß√£o e as informa√ß√µes criptografadas que devem ser enviadas pelos atacantes, ou seja, o resultado da execu√ß√£o de comandos de backdoor ou uma solicita√ß√£o de novas instru√ß√µes. <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Figura 7. Um exemplo de uma solicita√ß√£o enviada ao servidor de comandos pelo m√≥dulo RC2CL</i> <br><br><h4>  Funcionalidade </h4><br>  Dependendo do comando recebido, o backdoor pode executar v√°rias opera√ß√µes no sistema infectado.  Backdoors regulares executam manipula√ß√µes com o sistema de arquivos e as chaves do registro, suportam a execu√ß√£o de arquivos e a ativa√ß√£o remota do shell.  Esse spivar suporta todas essas equipes e ainda mais - 84 equipes permitem que os atacantes coletem informa√ß√µes abrangentes sobre a v√≠tima. <br><br>  Um programa malicioso verifica um computador infectado e transfere v√°rios dados para os atacantes: informa√ß√µes do sistema (lista de processos ativos, servi√ßos em execu√ß√£o, drivers carregados ou discos dispon√≠veis), informa√ß√µes da rede (tabela de endere√ßos IP, velocidade da conex√£o com a Internet). <br><br>  O InvisiMole pode verificar as redes sem fio dispon√≠veis em um sistema comprometido.  O Spivar registra informa√ß√µes como endere√ßos SSID e MAC dos pontos de acesso Wi-Fi detectados.  Esses dados podem ser verificados em bancos de dados p√∫blicos, o que permite que os atacantes rastreiem a localiza√ß√£o geogr√°fica da v√≠tima. <br><br>  Outros comandos fornecem informa√ß√µes sobre os usu√°rios da m√°quina comprometida, suas contas e sess√µes anteriores. <br><br>  De particular interesse √© o software instalado em uma m√°quina comprometida.  Quais programas est√£o instalados no sistema?  Quais deles iniciam automaticamente na inicializa√ß√£o do sistema ou no login do usu√°rio?  Quais programas um usu√°rio espec√≠fico usa?  Se os invasores estiverem interessados ‚Äã‚Äãem algo, basta digitar um comando para obter os dados necess√°rios. <br><br>  O malware pode obter um comando para procurar documentos abertos recentemente e outros arquivos interessantes.  Ele pode exibir diret√≥rios e dispositivos externos espec√≠ficos, relatar altera√ß√µes e extrair arquivos selecionados pelos atacantes. <br><br>  O malware pode ativar ou desativar o UAC (sistema de gerenciamento de contas) ou ignor√°-lo e trabalhar com arquivos em diret√≥rios protegidos sem direitos de administrador (mais no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link</a> ).  Se o malware estiver em execu√ß√£o no processo <code>explorer.exe</code> , que obt√©m automaticamente direitos elevados, ele pode criar um objeto COM e us√°-lo para excluir e mover arquivos em √°reas que exigem direitos de administrador. <br><br>  Al√©m disso, o InvisiMole pode ligar remotamente a webcam e o microfone da v√≠tima, espionar tirando fotos ou gravando som.  Os invasores podem monitorar a atividade no dispositivo fazendo capturas de tela.  O que √© especialmente interessante, o InvisiMole permite tirar capturas de tela n√£o apenas da tela inteira, mas tamb√©m de todas as janelas abertas.  Isso permite que os invasores coletem informa√ß√µes mesmo quando as janelas se fecham. <br><br>  Um dos comandos backdoor permite substituir o conte√∫do dos drivers pelos seguintes nomes: <br><br> <code>blbdrive.sys <br> compbatt.sys <br> secdrv.sys</code> <br> <br>  N√£o observamos o uso desse comando por atacantes, mas podemos assumir que ele √© usado para fornecer persist√™ncia adicional em sistemas de 32 bits. <br><br>  O backdoor √© capaz de interferir no sistema (por exemplo, fa√ßa login como usu√°rio, conclua o processo ou desligue o sistema), mas principalmente fornece opera√ß√µes passivas.  O programa tenta ocultar sua atividade sempre que poss√≠vel. <br><br>  Assim, o spivar explora lugares interessantes no sistema, estuda documentos recentemente abertos ou altera alguns arquivos.  Essas a√ß√µes deixam rastros e podem suspeitar da v√≠tima, pois ap√≥s cada opera√ß√£o o tempo da √∫ltima modifica√ß√£o do arquivo e / ou o acesso a ele muda.  Para impedir a detec√ß√£o, o malware recupera a data da altera√ß√£o ou abertura anterior do arquivo para ocultar suas manipula√ß√µes do usu√°rio. <br><br>  Outro exemplo de como os autores do spayvari tentam evitar a detec√ß√£o est√° trabalhando com rastreamentos deixados no disco.  Um programa malicioso coleta uma grande quantidade de dados confidenciais que s√£o armazenados em arquivos por algum tempo e exclu√≠dos ap√≥s um upload bem-sucedido nos servidores C&amp;C.  O problema √© que um administrador de sistema experiente pode recuperar arquivos exclu√≠dos, o que ajudar√° a investigar o ataque depois que a v√≠tima descobrir o comprometimento.  Isso √© poss√≠vel porque algumas informa√ß√µes permanecem no disco mesmo ap√≥s a exclus√£o do arquivo.  Para evitar isso, o InvisiMole tem a op√ß√£o de excluir com seguran√ßa todos os arquivos.  Isso significa que primeiro os dados s√£o substitu√≠dos por zero ou bytes aleat√≥rios e somente depois disso o arquivo √© exclu√≠do. <br><br><h4>  Mem√≥ria incorporada </h4><br>  A configura√ß√£o do backdoor e os dados coletados s√£o armazenados em dois endere√ßos - este √© o diret√≥rio de trabalho e as chaves do registro.  Uma parte significativa dos comandos do backdoor √© projetada para manipular esses locais de armazenamento de dados e seu conte√∫do. <br><br>  A localiza√ß√£o do diret√≥rio de trabalho √© determinada usando comandos de um servidor remoto.  O diret√≥rio √© usado como armazenamento tempor√°rio de arquivos que cont√™m informa√ß√µes coletadas de um computador comprometido.  Esses arquivos t√™m um m√©todo de nomea√ß√£o comum, algoritmo de criptografia e estrutura.  Eles s√£o criptografados com uma vers√£o simples da cifra XOR, usada nos componentes do malvari.  O tipo de arquivo pode ser obtido a partir da sequ√™ncia de controle de 4 bytes, localizada no in√≠cio do arquivo. <br><br>  Al√©m de armazenar os dados coletados, o diret√≥rio √© usado como diret√≥rio inicial para uma c√≥pia do aplicativo WinRAR.exe leg√≠timo.  Malvar copia e usa para arquivar dados roubados. <br><br>  O registro armazena dados de configura√ß√£o, bem como uma lista de arquivos no diret√≥rio ativo.  Os dados s√£o compactados usando o procedimento Zlib implementado no arquivo bin√°rio malvari e criptografados usando a mesma cifra dos arquivos internos. <br><br><img src="https://habrastorage.org/webt/ih/al/gw/ihalgw7xzb35fahkfx9rcmr3_l0.png"><br><br><h4>  Equipes de backdoor </h4><br>  Mais de oitenta comandos de backdoor usam o diret√≥rio de trabalho e as chaves do registro para armazenar resultados intermedi√°rios e dados de configura√ß√£o.  O gr√°fico com a porta traseira no int√©rprete √© mostrado na Figura 8. <br><br>  Cerca de um ter√ßo de todos os comandos est√£o relacionados √† leitura e atualiza√ß√£o de dados de configura√ß√£o armazenados no registro.  Os IDs e descri√ß√µes dos comandos restantes est√£o listados abaixo. <br><br>  4 - Fa√ßa uma lista de informa√ß√µes do arquivo no diret√≥rio <br>  6 - Baixar arquivo <br>  20 - Listar processos ativos <br>  22 - Finalize o processo por ID <br>  24 - Executar arquivo <br>  26 - Excluir arquivo <br>  28 - Obter tabela de encaminhamento de IP <br>  30 - Gravar dados em um arquivo <br>  31 - Ina√ß√£o <br>  38 - Fa√ßa uma lista de contas <br>  40 - Fa√ßa uma lista de servi√ßos no sistema <br>  42 - Fa√ßa uma lista de drivers carregados <br>  43 - Coletar informa√ß√µes b√°sicas do sistema (nome do computador, vers√£o do SO, status da mem√≥ria, hora local, informa√ß√µes do disco, informa√ß√µes sobre proxies configurados, pol√≠tica atual de preven√ß√£o de execu√ß√£o de dados para o sistema e processos, etc.) <br>  44 - Fa√ßa uma lista do software instalado <br>  46 - Listar usu√°rios locais e informa√ß√µes da sess√£o <br>  48 - Fa√ßa uma lista dos aplicativos usados ‚Äã‚Äãpelos usu√°rios <br>  52 - Criar estrutura de diret√≥rios <br>  78 - Criar shell remoto <br>  81 - Execute o comando atrav√©s do shell remoto <br>  91 - Ativar / desativar o controle de conta de usu√°rio <br>  93 - Sess√£o do usu√°rio final / desligar / reiniciar o sistema <br>  101 - Rastrear e registrar altera√ß√µes em diret√≥rios especificados <br>  103 - Excluir diret√≥rio <br>  109 - Ligar / desligar o monitor / ativar o modo de espera <br>  120 - Tire uma captura de tela da tela / janelas ativas <br>  126 - Tire uma captura de tela das janelas de exibi√ß√£o / ativas e atualize os dados de configura√ß√£o <br>  130 - Lista de informa√ß√µes de recursos em discos n√£o alocados <br>  132 - Renomeie / mova o arquivo, altere o tempo de cria√ß√£o / abertura / grava√ß√£o do arquivo para o especificado <br>  134 - Listar arquivos abertos recentemente <br>  152 - Desconectar unidades remov√≠veis (conectadas anteriormente) <br>  155 - Criar / excluir chave do registro, definir / excluir valores da chave do registro ou listar valores / chaves / dados do registro <br>  159, 161 - Desative o roteamento / firewall, crie um servidor proxy em uma porta espec√≠fica <br>  172 - Repita a caixa de di√°logo pedindo para reiniciar o computador <br>  175 - Ignorar controle de conta de usu√°rio para manipula√ß√£o de arquivo <br>  177 - Crie e escreva um arquivo, defina dados no momento da cria√ß√£o / abertura / altera√ß√£o <br>  181 - Remova todos os pontos de restaura√ß√£o do sistema <br>  183 - Redefinir o componente (leg√≠timo) de um aplicativo WinRAR <br>  185 - Adicionar arquivos ao arquivo protegido por senha (password = "12KsNh92Dwd") <br>  187 - Descriptografar, descompactar e carregar a DLL, carregar arquivos exe dos recursos RC2CL, RC2FM <br>  189 - Criar um ponto de restaura√ß√£o do sistema <br>  191 - Extrair arquivo protegido por senha (12KsNh92Dwd) <br>  193 - Alterar o arquivo criptografado <br>  195 - Reiniciar ap√≥s a conclus√£o do processo principal <br>  197 - Envie 198 bytes de dados codificados em um padr√£o <br>  199 - Renomear / mover arquivo <br>  206 - Descriptografar, descompactar e baixar a DLL, carregar arquivos exe dos recursos RC2CL, RC2FM <br>  211 - Fa√ßa o download das informa√ß√µes coletadas (capturas de tela, grava√ß√µes de √°udio etc.) <br>  213 - Fa√ßa uma lista de janelas ativas <br>  218 - API para grava√ß√£o de √°udio de dispositivos de entrada <br>  220 - API para tirar fotos de uma webcam <br>  224 - Fa√ßa uma lista dos arquivos executados em cada inicializa√ß√£o do sistema <br>  226 - Fa√ßa uma lista de redes sem fio ativadas (endere√ßo MAC, SSID, intervalo de sinaliza√ß√£o) <br>  228 - Redefinir pacote Zlib compactado <br><br><img src="https://habrastorage.org/webt/jf/og/gu/jfoggu3qvtsjumjvxt6etxex9mw.png"><br>  <i>Figura 8. A fun√ß√£o backdoor no int√©rprete (original e modificada usando a fun√ß√£o Group Nodes no IDA Pro para facilitar a leitura)</i> <br><br><h2>  Conclus√£o </h2><br>  O InvisiMole √© um software spyware completo que oferece recursos abrangentes que podem competir com outras ferramentas conhecidas de espionagem cibern√©tica. <br><br>  S√≥ se pode adivinhar por que os autores usam dois m√≥dulos com fun√ß√µes duplicadas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode-se supor que o m√≥dulo menor seja </font></font><code>RC2FM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usado no primeiro est√°gio do reconhecimento, e o maior </font></font><code>RC2CL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">funcione apenas em m√°quinas que interessam aos operadores. </font><font style="vertical-align: inherit;">Mas n√£o √© assim - dois m√≥dulos s√£o lan√ßados simultaneamente. </font><font style="vertical-align: inherit;">A segunda explica√ß√£o poss√≠vel: os m√≥dulos s√£o montados por diferentes autores e depois combinados para fornecer aos operadores o m√°ximo de ferramentas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O InvisiMole usa apenas algumas t√©cnicas para evitar a detec√ß√£o e an√°lise. </font><font style="vertical-align: inherit;">No entanto, como o spyware foi usado em ataques a um pequeno n√∫mero de alvos de alto escal√£o, ela conseguiu evitar a detec√ß√£o por pelo menos cinco anos.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indicadores de compromisso (IoCs) </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detec√ß√£o ESET </font></font></h3><br> <code>Win32/InvisiMole.A trojan <br> Win32/InvisiMole.B trojan <br> Win32/InvisiMole.C trojan <br> Win32/InvisiMole.D trojan <br> Win64/InvisiMole.B trojan <br> Win64/InvisiMole.C trojan <br> Win64/InvisiMole.D trojan</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hashes SHA-1 </font></font></h3><br> <code>5EE6E0410052029EAFA10D1669AE3AA04B508BF9 <br> 2FCC87AB226F4A1CC713B13A12421468C82CD586 <br> B6BA65A48FFEB800C29822265190B8EAEA3935B1 <br> C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F <br> A5A20BC333F22FD89C34A532680173CBCD287FF8</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nomes de dom√≠nio do servidor C &amp; C </font></font></h3><br> <code>activationstate.sytes[.]net <br> advstatecheck.sytes[.]net <br> akamai.sytes[.]net <br> statbfnl.sytes[.]net <br> updchecking.sytes[.]net</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Endere√ßos IP de servidores C e C e per√≠odo de atividade </font></font></h3><br> <code>2013-2014 - 46.165.231.85 <br> 2013-2014 - 213.239.220.41 <br> 2014-2017 - 46.165.241.129 <br> 2014-2016 - 46.165.241.153 <br> 2014-2018 - 78.46.35.74 <br> 2016-2016 - 95.215.111.109 <br> 2016-2018 - 185.118.66.163 <br> 2017-2017 - 185.118.67.233 <br> 2017-2018 - 185.156.173.92 <br> 2018-2018 - 46.165.230.241 <br> 2018-2018 - 194.187.249.157</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chaves e valores do registro </font></font></h3><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2FM </font></font></h4><br> <code>[HKEY_CURRENT_USER\Software\Microsoft\IE\Cache] <br> "Index"</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2CL </font></font></h4><br> <code>[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Console] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Settings" <br> "Type" <br> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\OLE] <br> or [HKEY_CURRENT_USER\Software\Microsoft\Direct3D] <br> "Common" <br> "Current" <br> "ENC" <br> "FFLT" <br> "Flag1" <br> "FlagLF" <br> "FlagLF2" <br> "IfData" <br> "INFO" <br> "InstallA" <br> "InstallB" <br> "LegacyImpersonationNumber" <br> "LM" <br> "MachineAccessStateData" <br> "MachineState 0" <br> "RPT" <br> "SP2" <br> "SP3" <br> "SettingsMC" <br> "SettingsSR1" <br> "SettingsSR2"</code> <br> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arquivos e pastas </font></font></h3><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2FM </font></font></h4><br> <code>%APPDATA%\Microsoft\Internet Explorer\Cache\AMB6HER8\ <br> %volumeSerialNumber%.dat <br> content.dat <br> cache.dat <br> index.dat <br> %APPDATA%\Microsoft\Internet Explorer\Cache\MX0ROSB1\ <br> content.dat <br> index.dat <br> %random%.%ext% <br> %APPDATA%\Microsoft\Internet Explorer\Cache\index0.dat</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RC2CL </font></font></h4><br> <code>Winrar\ <br> comment.txt <br> descript.ion <br> Default.SFX <br> WinRAR.exe <br> main.ico <br> fl_%timestamp%\strcn%num%\ <br> fdata.dat <br> index.dat <br> ~mrc_%random%.tmp <br> ~src_%random%.tmp <br> ~wbc_%random%.tmp <br> sc\~sc%random%.tmp <br> ~zlp\zdf_%random%.data <br> ~lcf\tfl_%random%</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414419/">https://habr.com/ru/post/pt414419/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414405/index.html">Instalar certificado no servidor HTTP Apache</a></li>
<li><a href="../pt414411/index.html">Wiren Board 6: novamente em Habr√© com a nova vers√£o do controlador para automa√ß√£o</a></li>
<li><a href="../pt414413/index.html">Sinopse e v√≠deo da hist√≥ria sobre redes na ind√∫stria de jogos com o gamedev do festival</a></li>
<li><a href="../pt414415/index.html">Confer√™ncia Tarantool 21 de junho - n√£o apenas sobre Tarantool, mas em geral sobre computa√ß√£o em mem√≥ria</a></li>
<li><a href="../pt414417/index.html">Eventos digitais em Moscou de 18 a 24 de junho</a></li>
<li><a href="../pt414423/index.html">Este dia chegamos o mais perto poss√≠vel ... Foi lan√ßada uma nova vers√£o do SBM 11.4</a></li>
<li><a href="../pt414425/index.html">Algoritmo de reconhecimento de padr√µes de aprendizado</a></li>
<li><a href="../pt414427/index.html">O que uma impressora 3D pode fazer? Relat√≥rio da exposi√ß√£o Maker Faire Bay Area 2018</a></li>
<li><a href="../pt414429/index.html">Como aprender uma l√≠ngua estrangeira sem professor. Parte 1. "Minha experi√™ncia"</a></li>
<li><a href="../pt414431/index.html">Mitap JavaJam. Debate Javista, rafting, experimentos e microsservi√ßos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>