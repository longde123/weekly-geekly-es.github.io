<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüç≥ ‚õ∏Ô∏è ‚ô£Ô∏è Reenv√≠o de solicitudes de Apache a Payara Server 5 en Ubuntu üå∫ üîØ üëßüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En esta serie de art√≠culos, intentaremos dar una visi√≥n general de los conceptos b√°sicos del uso de Payara Server en producci√≥n usando Apache Web Serv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reenv√≠o de solicitudes de Apache a Payara Server 5 en Ubuntu</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438442/"><p>  En esta serie de art√≠culos, intentaremos dar una visi√≥n general de los conceptos b√°sicos del uso de Payara Server en producci√≥n usando Apache Web Server (httpd) y Ubuntu. <a name="habracut"></a>  Muchos de los conceptos no dependen de las herramientas que usamos aqu√≠ y pueden aplicarse a otros escenarios. <br></p><br>  Nuestro objetivo es configurar lo siguiente: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cbf/2c9/449/cbf2c9449f2d4a04fd2e682f53837fcc.jpg" alt="imagen"><br><p> Aqu√≠ tenemos un servidor web Apache que estar√° disponible para nuestros usuarios.  Sus solicitudes se enviar√°n a una de las dos instancias del servidor Payara.  Aqu√≠ observamos el uso de "pegado" de sesiones basado en cookies de JSESSIONID para garantizar que cada usuario interact√∫e con el mismo servidor Payara, as√≠ como la replicaci√≥n de sesi√≥n, para garantizar que si un servidor Payara falla, el otro puede manejar las sesiones existentes no hay problema <br></p><br><p>  Suponemos que el servidor web Apache ya est√° instalado y configurado.  Nuestro siguiente paso es configurar el reenv√≠o de solicitudes para enviar tr√°fico al servidor de Payara. <br></p><br><h2>  ¬øQu√© es el reenv√≠o de solicitudes? </h2><br><p>  El reenv√≠o de solicitudes (o proxy) es cuando un servidor que recibe tr√°fico web lo env√≠a a otro destino.  Se pueden usar para ocultar la ubicaci√≥n real del usuario, no para ver los sistemas internos o para controlar el rendimiento.  Como la mayor√≠a de los servidores web, el servidor web Apache puede complementarse con m√≥dulos que le permiten reenviar solicitudes al servidor y enviar respuestas a trav√©s de un proxy.  Esto significa que puede usar Apache como intermediario, lo que elimina la necesidad de especificar n√∫meros de puerto o direcciones IP exactas y permite al usuario recibir respuestas del mismo servidor (en lugar de hacer clic en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> y tener una barra de direcciones etiquetada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8080 ) <br></p><br><h2>  Configure el reenv√≠o de solicitudes entre el servidor web Apache y el servidor Payara <br></h2><br><p>  En esta publicaci√≥n, veremos un paquete disponible en el repositorio de Ubuntu.  El paquete de Ubuntu contiene binarios de Apache, pero tambi√©n tiene "herramientas auxiliares" adicionales para administrar archivos de configuraci√≥n.  En Ubuntu 18, los dos m√≥dulos que necesitamos agregar a Apache son parte del paquete apache2 que instalamos anteriormente.  Se puede instalar desde el repositorio utilizando: <br><br></p><pre><code class="plaintext hljs">sudo apt install apache2</code> </pre> <br>  <u>Tenga en cuenta que antes de Ubuntu 16.04 necesitar√° usar "apt-get" en lugar de "apt".</u> <br><br>  Instalaremos dos m√≥dulos para habilitar el reenv√≠o b√°sico de solicitudes http: mod_proxy y mod_proxy_http.  En Ubuntu, las herramientas auxiliares controlan la instalaci√≥n de estos m√≥dulos; para hacerlo a√∫n m√°s f√°cil, las herramientas buscar√°n sus dependencias y las incluir√°n.  Es √∫til que mod_proxy_http requiera mod_proxy para funcionar, lo que significa que nuestro equipo se ve as√≠: <br><br><pre> <code class="plaintext hljs">sudo a2enmod proxy_http</code> </pre><br><h3>  Tenga en cuenta que en estos comandos podemos omitir el prefijo "mod_" </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/db1/fb3/9d0/db1fb39d075e035381a244e3fa1bb333.png" alt="imagen"><br><p><br>  Si desea deshabilitar el m√≥dulo, hay una herramienta auxiliar para a2enmod llamada a2dismod, que se usa de la misma manera.  La herramienta detect√≥ una dependencia y tambi√©n incluy√≥ mod_proxy.  Si ten√≠a varios m√≥dulos que deseaba activar, puede agregarlos despu√©s de proxy_http, separ√°ndolos con espacios ... <br></p><br><p>  Reiniciaremos el servidor m√°s tarde, ya que tambi√©n necesitamos cambiar la configuraci√≥n. <br></p><br><p>  El paquete apache2 en Ubuntu tiene una configuraci√≥n de sitio de ejemplo llamada "000-default".  El archivo de configuraci√≥n para este sitio se encuentra en la carpeta / etc / apache2 / sites-available y contiene un enlace simb√≥lico a la carpeta habilitada para sitios. <br></p><br><h2>  Estructura del archivo de configuraci√≥n de Apache <br></h2><br><p>  Como regla general, ver√° que los manuales de Internet se refieren a httpd.conf como un archivo de configuraci√≥n para editar.  Este es solo el archivo de configuraci√≥n predeterminado "padre".  En los sistemas Debian / Ubuntu (y sus derivados, como Linux Mint), el archivo de b√∫squeda es apache2.conf. <br></p><br><p>  Este archivo se lee y sus directivas se aplican de arriba a abajo, por lo que si se establecen dos valores diferentes para la misma propiedad, se aplicar√° el segundo.  (M√°s precisamente, el primero se aplicar√° solo hasta que se lea el segundo par√°metro). <br></p><br><p>  Este archivo tambi√©n puede espec√≠ficamente "incluir" archivos y carpetas (tenga en cuenta que los comodines tambi√©n funcionan).  Se leer√°n y combinar√°n con la configuraci√≥n principal en el lugar donde se escribe "incluir".  Por lo tanto, la √∫ltima l√≠nea del archivo de configuraci√≥n principal (si no especifica otro archivo) ser√° la √∫ltima l√≠nea de la configuraci√≥n que se instalar√°, pase lo que pase. <br></p><br><p>  La p√°gina predeterminada en la nueva instalaci√≥n de Apache en Ubuntu est√° en /var/www/index.html y ofrece una buena descripci√≥n de c√≥mo funciona esto en detalle. <br></p><br><h2>  Crear una nueva configuraci√≥n de sitio <br></h2><br><p>  No utilizaremos la configuraci√≥n predeterminada porque necesitamos agregar un comportamiento espec√≠fico.  Copie la configuraci√≥n anterior de los sitios disponibles y c√°mbiele el nombre a algo memorable. <br></p><br><pre> <code class="plaintext hljs">sudo cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/payara-site.conf</code> </pre><br><p>  Abra un nuevo archivo en su editor de texto preferido como root.  Deber√≠as ver algo como esto: <br></p><br><img src="https://habrastorage.org/getpro/habr/post_images/235/554/90a/23555490ac12826fba5c877acab7cbb2.png" alt="imagen"><br><br>  El elemento contiene una serie de directivas que le indican al servidor c√≥mo responder a las solicitudes entrantes enumeradas.  En este ejemplo, &lt;VirtualHost *: 80&gt; procesa todas las respuestas recibidas en el servidor a trav√©s del puerto 80. Para obtener una descripci√≥n m√°s detallada de las etiquetas de VirtualHost, consulte la documentaci√≥n de Apache. <br><br><p>  Necesitamos agregar dos l√≠neas en las etiquetas para decirle a Apache c√≥mo manejar el tr√°fico entrante y saliente: una para decirle a Apache d√≥nde enviar las solicitudes y la otra para decirle a Apache de d√≥nde deben venir las respuestas.  De esta manera, un usuario que visita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> puede ser redirigido a nuestro servidor de aplicaciones en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8080 /, y las respuestas dirigidas a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8080 / se redirigen en su lugar, para que el usuario las vea venir de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> . <br><br></p><p>  Para controlar el tr√°fico entrante, agregue la l√≠nea: <br></p><br><pre> <code class="plaintext hljs">ProxyPass / http://localhost:8080/</code> </pre> <br>  Esta directiva le dice a Apache que env√≠e todo despu√©s del nombre de dominio del servidor a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8080 /, como si el usuario fuera directamente a esta URL. <br><br><pre> <code class="plaintext hljs"> ProxyPassReverse / http://localhost:8080/</code> </pre> <p>  Esta directiva le dice a Apache la URL de retorno del proxy para que, aunque la respuesta se devuelva desde la instancia del servidor Payara al puerto 8080, la URL parezca recibida de Apache.  Estas dos directivas, cuando se usan juntas, significan que podemos evitar expresiones regulares complejas con mod_rewrite. <br></p><br><p>  Suponiendo que el nombre de dominio que queremos usar, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.example.com</a> , nuestra configuraci√≥n significa que la solicitud a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.example.com/myapp se</a> enviar√° realmente al servidor de Payara, como si el usuario se hubiera conectado directamente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> : 8080 // MyApp. <br></p><br><p>  Su archivo deber√≠a verse as√≠ (elimin√© la mayor√≠a de los comentarios para aclarar qu√© se necesita exactamente): <br></p><br><img src="https://habrastorage.org/getpro/habr/post_images/bbb/674/657/bbb674657e8fe8263cceca168af27427.png" alt="imagen"><br>  Guarda tu archivo. <br><br><p>  Para deshabilitar el sitio predeterminado y activar nuestra nueva configuraci√≥n, ejecute los comandos: <br></p><br><pre> <code class="plaintext hljs"> sudo a2dissite 000-default.conf sudo a2ensite payaraSite.conf</code> </pre> <br>  Reinicie el servicio Apache HTTP Server (el reinicio que omitimos anteriormente): <br><br><pre> <code class="plaintext hljs">sudo service apache2 restart</code> </pre> <br>  Para detener e iniciar Apache HTTP Server, es: <br><br>  parada de servicio <br><br><pre> <code class="plaintext hljs"> sudo service apache2 stop sudo service apache2 start</code> </pre> <br>  No olvide iniciar Payara Server: <br><br><pre> <code class="plaintext hljs">/opt/payara5/bin/asadmin start-domain domain1</code> </pre> <br><p>  Antes de realizar cambios de configuraci√≥n yendo a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">localhost</a> , se lo dirigir√° a la pantalla de bienvenida de Apache: <br></p><br><img src="https://habrastorage.org/getpro/habr/post_images/29e/11e/055/29e11e05529e5232f9c678a75607ce42.png" alt="imagen"><br><br>  Pero ahora agregamos a nuestro servidor proxy e incluimos nuevas directivas para nuestra configuraci√≥n de usuario de Apache cuando ingresamos localhost / index.html, que ahora enviamos a la pantalla de bienvenida del servidor Payara: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce0/a1a/36f/ce0a1a36fba25b94ba1c4865b4f7375e.png" alt="imagen"><br><br><h2>  Ahora puede agregar aplicaciones al servidor Payara </h2><br><p>  Por lo tanto, ahora tenemos un servidor HTTP Apache activo, que act√∫a como nuestro proxy (con la capacidad de agregar m√≥dulos adicionales) y un servidor Payara en funcionamiento, listo para agregarle aplicaciones. <br><br>  Realizamos la instalaci√≥n de ambos servidores, configuramos Apache, exploramos el sistema de archivos y observamos brevemente los comandos del servidor Payad Server asadmin. <br></p><br><p>  La pr√≥xima vez, veremos c√≥mo extender la funcionalidad de Apache y Payara Server, y c√≥mo podemos hacer que Payara Server proporcione escalabilidad y mejoras adicionales que agregaremos a Apache para manejar varios servidores internos. <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/438442/">https://habr.com/ru/post/438442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../438428/index.html">Las agencias gubernamentales encontraron una manera de sabotear el software dom√©stico</a></li>
<li><a href="../438430/index.html">Estoy atascado! O c√≥mo superar el efecto de meseta en el aprendizaje del ingl√©s</a></li>
<li><a href="../438434/index.html">Hacker Lab: P1. Bypass de autenticaci√≥n Libssh</a></li>
<li><a href="../438436/index.html">La idea de c√≥mo proporcionar a los empleados acceso temporal a los recursos del cliente sin volver a usar contrase√±as.</a></li>
<li><a href="../438438/index.html">Alimento para loros Bitrix. Probamos el rendimiento, seleccionamos hierro</a></li>
<li><a href="../438446/index.html">Punto de referencia como base para decidir sobre un cambio de c√≥digo</a></li>
<li><a href="../438448/index.html">¬øQu√© PC Speaker es capaz de hacer?</a></li>
<li><a href="../438450/index.html">¬øPor qu√© la plantilla de pol√≠tica de privacidad no es adecuada para usted?</a></li>
<li><a href="../438454/index.html">OpenSceneGraph: Niveles de detalle (LOD) y carga de fondo de objetos</a></li>
<li><a href="../438456/index.html">Configuraci√≥n de inicio de sesi√≥n √∫nico en Zimbra Collaboration Suite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>