<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛰️ 👨🏾 👌 用类似Lisp语言编写的现代NES游戏 ↙️ 🗣️ 👍🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What Remains是一款针对8位NES视频游戏机的叙事冒险游戏，于2019年3月发布，作为在模拟器中运行的免费ROM发行。 它是由一个由Iodine Dynamics组成的小型小组间歇地创建的，历时两年。 目前，该游戏正处于硬件的实施阶段：我们正在使用回收零件制造一套有限的墨盒。 


 该游...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>用类似Lisp语言编写的现代NES游戏</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467125/">  What Remains是一款针对8位NES视频游戏机的叙事冒险游戏，于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2019年3月</a>发布，作为在模拟器中运行的免费ROM发行。 它是由一个由Iodine Dynamics组成的小型小组间歇地创建的，历时两年。 目前，该游戏正处于硬件的实施阶段：我们正在使用回收零件制造一套有限的墨盒。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db4/d1a/663/db4d1a6633208845a7e7ce5d670d82ac.jpg"></div><br> 该游戏分为6个等级，玩家可以使用四向滚动卡​​在多个场景中漫步，与NPC进行交流，收集线索，了解他们的世界，玩迷你游戏并解决简单的难题。 我是该项目的首席工程师，因此在实现团队愿景时遇到了许多困难。 鉴于NES设备的严重局限性，要为其创建任何游戏都是非常困难的，更不用说项目的内容与《剩余》中的内容一样多。 仅由于创建了有用的子系统，该子系统使我们能够隐藏并管理这种复杂性，我们才能够团队合作并完成游戏。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/956/a4d/921/956a4d9217a209643bb35b68e25694b5.png"></div><br> 在本文中，我将讨论游戏引擎各个部分的一些技术细节。 我希望其他开发人员会发现它们有用或至少感到好奇。 <br><a name="habracut"></a><br><h2>  NES设备 </h2><br> 在开始编写代码之前，我将向您简要介绍我们使用的设备的规格。  NES是1983年（日本，1985年-美国）发布的游戏机。 它的内部有一个8位CPU 6502 [1]，其频率为1.79 MHz。 由于控制台每秒产生60帧，因此每帧大约有3万个CPU周期，对于计算主要游戏周期中发生的所有事件而言，这是很小的。 <br><br> 此外，控制台总共具有2048字节的RAM（可以使用其他RAM扩展到10,240字节，而我们没有这样做）。 它也可以一次寻址32 KB的ROM，可以通过切换存储区来扩展（剩余容量使用512 KB的ROM）。 切换存储库是现代程序员无法处理的复杂主题[2]。 简而言之，CPU可用的地址空间小于ROM中包含的数据，也就是说，当手动切换时，整个存储块仍然无法访问。 您要调用某些功能吗？ 直到您通过调用库切换命令来更换库。 如果不这样做，则在调用函数时，程序将崩溃。 <br><br> 实际上，为NES开发游戏时，最困难的事情是同时考虑所有这些。 优化代码的一个方面（例如内存使用情况）通常会影响其他方面，例如CPU性能。 该代码应该有效，同时支持起来也很方便。 通常，游戏是用汇编语言编写的。 <br><br><h2> 二氧化碳 </h2><br> 但就我们而言，并非如此。 相反，与游戏串联将发展其自己的语言。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Co2</a>是一种类似Rasp的语言，它是基于球拍方案构建的，并被编译为汇编器6502。最初，该语言是由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dave Griffiths</a>创建的，用于构建What Remains演示，我决定在整个项目中使用它。 <br><br>  Co2允许您在必要时编写内置的汇编代码，但它也具有简化某些任务的高级功能。 它实现了对RAM消耗和访问速度均有效的局部变量[2]。 它有一个非常简单的宏系统，使您可以编写可读且高效的代码[3]。 最重要的是，由于Lisp的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">同质性</a> ，它极大地简化了直接在源中显示数据的过程。 <br><br> 编写自己的工具在游戏开发中非常普遍，但是创建完整的编程语言要少得多。 但是，我们做到了。 尚不清楚开发和支持CO2的复杂性是否得到了证明，但它无疑具有帮助我们的优势。 在帖子中，我不会详细讨论Co2的工作（这值得单独撰写），但是我会不断提及它，因为它的使用与开发过程紧密相关。 <br><br> 以下是示例Co2代码，该代码在调暗场景之前为刚刚加载的场景绘制背景： <br><br><pre><code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Render the nametable for the scene at the camera position (defsub (create-initial-world) (camera-assign-cursor) (set! camera-cursor (+ camera-cursor 60)) (let ((preserve-camera-v)) (set! preserve-camera-v camera-v) (set! camera-v 0) (loop i 0 60 (set! delta-v #xff) (update-world-graphics) (when render-nt-span-has (set! render-nt-span-has #f) (apply-render-nt-span-buffer)) (when render-attr-span-has (set! render-attr-span-has #f) (apply-render-attr-span-buffer))) (set! camera-v preserve-camera-v)) (camera-assign-cursor))</span></span></code> </pre> <br><h2> 实体系统 </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee6/d87/ad4/ee6d87ad406879dbc9433c61fa4e3a5b.png"></div><br> 任何比《俄罗斯方块》更复杂的实时游戏，本质上都是一个“实体系统”。 此功能允许各种独立的参与者同时行动并负责自己的状况。 尽管《余生》绝不是一款活跃的游戏，但它仍然拥有许多行为复杂的独立演员：他们为自己设置动画并进行渲染，检查碰撞并引发对话。 <br><br> 该实现非常典型：大型数组包含场景中的实体列表，每个记录均包含与实体相关的数据以及类型标签。 主要游戏玩法周期中的更新功能会绕过所有实体，并根据其类型实现相应的行为。 <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Called once per frame, to update each entity (defsub (update-entities) (when (not entity-npc-num) (return)) (loop k 0 entity-npc-num (let ((type)) (set! type (peek entity-npc-data (+ k entity-field-type))) (when (not (eq? type #xff)) (update-single-entity k type)))))</span></span></code> </pre> <br> 存储实体数据的方式更加有趣。 通常，游戏具有如此众多的独特实体，以至于使用大量ROM可能会成为问题。 这里的CO2展示了其强大功能，使我们能够以简洁但易读的形式呈现场景的每个要素-作为键值对流。 除了诸如初始位置之类的数据外，几乎每个键都是可选的，这使它们仅在必要时才可以向实体声明。 <br><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">bytes</span></span> npc-diner-a <span class="hljs-number"><span class="hljs-number">172</span></span> <span class="hljs-number"><span class="hljs-number">108</span></span> prop-palette <span class="hljs-number"><span class="hljs-number">1</span></span> prop-hflip prop-picture picture-smoker-c prop-animation simple-cycle-animation prop-anim-limit <span class="hljs-number"><span class="hljs-number">6</span></span> prop-head hair-flip-head-tile <span class="hljs-number"><span class="hljs-number">2</span></span> prop-dont-turn-around prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-4 on-my-third my-dietician) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-3 have-you-tried-the-pasta the-real-deal) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-diner-is-clean omg-this-cherry-pie its-like-a-party) prop-dialog-a (<span class="hljs-number"><span class="hljs-number">2</span></span> progress-stage-1 cant-taste-food puff-poof) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-4 tea-party-is-not) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-3 newspaper-owned-by-dnycorp) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-2 they-paid-a-pr-guy) prop-dialog-b (<span class="hljs-number"><span class="hljs-number">1</span></span> progress-stage-1 it-seems-difficult) prop-customize (<span class="hljs-name"><span class="hljs-name">progress-stage-2</span></span> stop-smoking) <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br> 在此代码中， <code>prop-palette</code>设置用于实体的调色板， <code>prop-anim-limit</code>设置动画帧的数量，并且<code>prop-dont-turn-around</code>可以防止NPC在玩家尝试从另一侧与他交谈时转向。 它还设置了几个条件标志，这些条件标志会在玩家通过游戏的过程中更改实体的行为。 <br><br> 这种表示形式对于将内容存储在ROM中非常有效，但是在运行时访问它的速度非常慢，并且对于游戏而言效率太低。 因此，当玩家进入新场景时，该场景中的所有实体都将加载到RAM中并处理可能影响其初始状态的所有条件。 但是您不能为每个实体下载任何详细信息，因为它会占用更多的RAM。 引擎仅加载每个实体最需要的内容，以及指向ROM中其完整结构的指针，该指针在诸如处理对话框之类的情况下被取消引用。 这组特定的折衷方案使我们能够提供足够的性能。 <br><br><h2> 门户网站 </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c41/9dd/b90/c419ddb90349fbfb890c935e15bdfb95.png"></div><br> 游戏《遗留物》有许多不同的位置，街道上有滚动地图的多个场景，而房间中的许多场景保持静态。 要从一个移动到另一个，您需要确定播放器已经到达出口，加载新场景，然后将播放器放置在所需的位置。 在开发的早期阶段，这种转换以独特的方式描述为两个相互连接的场景，例如“第一城市”和“咖啡馆”，以及if语句中有关每个场景中门位置的数据。 为了确定更改场景后玩家的位置，您只需检查他要去的地方和位置，然后将其放置在相应的出口旁边。 <br><br> 但是，当我们开始填充在两个不同位置连接到第一座城市的“第二座城市”场景时，这样的系统开始崩溃。 突然，该对<code>(_, _)</code>不再适合。 在考虑了这一点之后，我们意识到连接本身确实很重要，在游戏代码内部将其称为“门户”。 为了解决这些更改，引擎已被重写。 导致我们陷入类似实体的情况。 门户网站可以存储键值对列表并在场景开始时加载。 进入门户网站时，您可以使用与离开时相同的位置信息。 此外，与实体所具有的条件类似，简化了附加条件：在游戏中的某些点，我们可以修改门户，例如打开或关闭门。 <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; City A (bytes city-a-scene #x50 #x68 look-up portal-customize (progress-stage-5 remove-self) ; to Diner diner-scene #xc0 #xa0 look-down portal-width #x20 0)</span></span></code> </pre> <br> 这也简化了添加“传送点”的过程，这通常用于电影插入中，根据情节的发生，玩家不得不将其移动到场景中的另一个位置。 <br><br> 这是第3级开始时的隐形传态： <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Jenny's home (bytes jenny-home-scene #x60 #xc0 look-up portal-teleport-only jenny-back-at-home-teleport 0)</span></span></code> </pre> <br> 请注意<code>look-up</code>值，该值指示“进入”此门户的方向。 离开门户时，玩家将朝另一个方向看； 在这种情况下，珍妮（游戏的主要角色）在家里，而低头。 <br><br><h2> 文字区块 </h2><br> 事实证明，渲染文本块是整个项目中最复杂的代码之一。  NES的图形限制被迫欺骗。 首先，NES仅具有一层图形数据，即要释放文本块的空间，您需要在背景下擦除部分地图，然后在关闭文本块后将其还原。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b8/7a5/d6f/6b87a5d6f4f44f8eb4fa9cf3b3242392.png"></div><br> 另外，每个单独场景的调色板必须包含用于渲染文本的黑白颜色，这对艺术家施加了其他限制。 为了避免与背景的其余部分发生颜色冲突，文本块应与16×16网格对齐[5]。 在有房间的场景中绘制文本块比在摄像机可以移动的街道上绘制文本块容易得多，因为在这种情况下，您必须考虑到垂直和水平滚动的图形缓冲区。 最后，暂停屏幕消息是一个经过稍微修改的标准对话框，因为它显示了不同的信息，但是使用了几乎相同的代码。 <br><br> 经过无数次错误的代码版本之后，我终于设法找到了一种解决方案，其中的工作分为两个阶段。 首先，执行所有计算以确定在何处以及如何绘制文本块，包括所有边界情况的处理代码。 因此，所有这些困难都集中在一个地方。 <br><br> 然后，逐行绘制具有状态保留的文本块，并使用第一阶段的计算，以免使代码复杂化。 <br><br><pre> <code class="lisp hljs"><span class="hljs-comment"><span class="hljs-comment">; Called once per frame as the text box is being rendered (defsub (text-box-update) (when (or (eq? tb-text-mode 0) (eq? tb-text-mode #xff)) (return #f)) (cond [(in-range tb-text-mode 1 4) (if (not is-paused) ; Draw text box for dialog. (text-box-draw-opening (- tb-text-mode 1)) ; Draw text box for pause. (text-box-draw-pausing (- tb-text-mode 1))) (inc tb-text-mode)] [(eq? tb-text-mode 4) ; Remove sprites in the way. (remove-sprites-in-the-way) (inc tb-text-mode)] [(eq? tb-text-mode 5) (if (not is-paused) ; Display dialog text. (when (not (crawl-text-update)) (inc tb-text-mode) (inc tb-text-mode)) ; Display paused text. (do (create-pause-message) (inc tb-text-mode)))] [(eq? tb-text-mode 6) ; This state is only used when paused. Nothing happens, and the caller ; has to invoke `text-box-try-exiting-pause` to continue. #t] [(and (&gt;= tb-text-mode 7) (&lt; tb-text-mode 10)) ; Erase text box. (if (is-scene-outside scene-id) (text-box-draw-closing (- tb-text-mode 7)) (text-box-draw-restoring (- tb-text-mode 7))) (inc tb-text-mode)] [(eq? tb-text-mode 10) ; Reset state to return to game. (set! text-displaying #f) (set! tb-text-mode 0)]) (return #t))</span></span></code> </pre> <br> 如果您习惯了Lisp风格，则可以很方便地阅读代码。 <br><br><h2> 精灵Z层 </h2><br> 最后，我将讨论一个不会特别影响游戏玩法的小细节，但会增加我引以为傲的良好触感。  NES只有两个图形组件：一个名称表（nametable），用于静态和网格对齐的背景；以及一个精灵（sprite）-大小为8x8像素的对象，可以放置在任意位置。 如果将诸如玩家角色和NPC之类的元素放置在名称表图形的顶部，它们通常会被创建为精灵。 <br><br> 但是，NES设备还可以指定可以完全放置在名称表下的部分精灵。 这毫不费力地使您实现炫酷的3D效果。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/4e0/c48/1c64e0c481f82d2b6569aa6326ea00a1.png"></div><br> 它的工作方式如下：用于当前场景的调色板以特殊方式处理位置0处的颜色：这是全局背景色。 在其顶部绘制一个名称表，并在其他两层之间绘制具有z层的精灵。 <br><br> 这是此场景的调色板： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/23c/2c6/391/23c2c6391ae6301f9b527259250ee0e5.png"></div><br> 因此，将最左上角的深灰色用作全局背景色。 <br><br> 图层的效果如下： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d30/0ae/f89/d300aef890a928421a48d94968a263f9.png"></div><br> 在大多数其他游戏中，这一切都结束了，但是，《余生》又向前迈了一步。 游戏不会将Jenny完全放在名称表的图形之前或下方-她的角色以正确的方式在它们之间划分。 如您所见，精灵的大小为8x8，整个角色的图形由几个精灵组成（从3到6，具体取决于动画帧）。 每个子画面都可以设置自己的z层，也就是说，某些子画面将位于名称表的前面，而其他子画面将在其后面。 <br><br> 这是此作用的示例： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/86b/3a3/ae5/86b3a3ae58931ef34d44640d7ff4c449.png"></div><br> 实现这种效果的算法非常棘手。 首先，检查玩家周围的碰撞数据，尤其是图块，这可能需要整个角色来绘制。 在此图中，实心图块以红色正方形显示，而黄色图块表示具有z层的部分。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/10d/162/38c/10d16238cc137b14b8719479624f7245.png"></div><br> 使用各种试探法，将它们组合在一起以创建“参考点”和四位的位掩码。 相对于参考点的四个象限对应于四个位：0表示玩家必须在名称表的前面，1-在其后面。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccb/3a4/ff9/ccb3a4ff911243e0e771c3bd64e10134.png"></div><br> 当放置单个精灵以渲染播放器时，将其位置与参考点进行比较，以确定此特定精灵的z层。 其中一些位于顶层，其他位于背面。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ee/f36/273/0eef362737679bb6483465264ada9ba4.png"></div><br><h2> 结论 </h2><br> 我简要地谈到了我们新的现代复古游戏的内部运作的不同方面。 代码库中还有很多有趣的事情，但是我概述了使游戏正常工作的重要部分。 <br><br> 我从该项目中学到的最重要的教训是数据驱动引擎可以带来的好处。 几次我设法用表和迷你解释器替换了一些独特的逻辑，并且由于这个原因，代码变得更简单易读。 <br><br> 希望您喜欢这篇文章！ <br><br><hr><br><h3> 注意事项 </h3><br>  [1]严格来说，NES中安装了一种称为Ricoh 2A03的CPU 6502。 <br><br>  [2]实际上，这个项目使我确信，对于任何超过一定大小的NES项目，切换存储体/管理ROM是主要限制。 <br><br>  [3]为此，尽管我很难找到有关它的文献，但应该感谢“编译堆栈”-一种用于嵌入式系统编程的概念。 简而言之，您需要构建一个完整的项目调用图，将其从叶节点到根进行排序，然后为每个节点分配等于其需求+最大子节点数的内存。 <br><br>  [4]宏是在开发的较晚阶段添加的，坦率地说，我们无法利用它们的特殊优势。 <br><br>  [5]您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我的系列文章中</a>阅读有关NES图形的更多信息。 颜色冲突是由第一部分中描述的属性引起的。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN467125/">https://habr.com/ru/post/zh-CN467125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN467111/index.html">关于如何在手机上少挂的根本提示</a></li>
<li><a href="../zh-CN467113/index.html">如何使用户留在网站上？ 可用性秘密</a></li>
<li><a href="../zh-CN467115/index.html">非典型“ ls”-哈伯版</a></li>
<li><a href="../zh-CN467117/index.html">手稿不燃烧：死海长寿之谜的历史可以追溯到公元前250年</a></li>
<li><a href="../zh-CN467119/index.html">与Badoo工程师一起玩IT别名</a></li>
<li><a href="../zh-CN467127/index.html">使用Postman和Excel测试API</a></li>
<li><a href="../zh-CN467129/index.html">认知矫正2：学习错觉和失真</a></li>
<li><a href="../zh-CN467131/index.html">CLRium＃6：关于无锁的报告，很多理论和实践知识</a></li>
<li><a href="../zh-CN467135/index.html">USB踏板可在电脑之间切换</a></li>
<li><a href="../zh-CN467137/index.html">确保Zextras Team在复杂的公司网络中的可靠运行</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>