<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏼 🌜 🙅 Trik jaringan saraf untuk pemula 👿 👨‍🍳 ☝🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagai bagian dari kontes ZeroNights HackQuest 2018 tahunan, para peserta diundang untuk mencoba berbagai tugas dan kompetisi yang tidak sepele. Bagi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trik jaringan saraf untuk pemula</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/443164/"><p><img src="https://habrastorage.org/webt/us/ri/cv/usricvbthwh4i_pyy50suyvx5mq.jpeg" alt="gambar"></p><br><p>  Sebagai bagian dari kontes ZeroNights HackQuest 2018 tahunan, para peserta diundang untuk mencoba berbagai tugas dan kompetisi yang tidak sepele.  Bagian dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">salah</a> satunya terkait dengan generasi contoh permusuhan untuk jaringan saraf.  Dalam artikel kami, kami telah memperhatikan metode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">serangan</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pertahanan</a> algoritma pembelajaran mesin.  Dalam kerangka publikasi ini, kami akan menganalisis contoh bagaimana mungkin untuk menyelesaikan tugas dengan ZeroNights Hackquest menggunakan perpustakaan bodoh. </p><a name="habracut"></a><br><p>  Dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tugas</a> ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">,</a> penyerang seharusnya mendapatkan akses ke server.  Setelah ia berhasil, ia melihat struktur file berikut di direktori rumahnya: </p><br><pre><code class="plaintext hljs">| Home --| KerasModel.h5 --| Task.txt --| ZeroSource.bmp</code> </pre> <br><p>  Informasi berikut ada di file Task.txt: </p><br><pre> <code class="plaintext hljs">Now it is time for a final boss! http://51.15.100.188:36491/predict You have a mode and an image. To get a ticket, you need to change an image so that it is identified as "1". curl -X POST -F image=@ZeroSource.bmp 'http://51.15.100.188:36491/predict'. (don't forget about normalization (/255) ^_^)</code> </pre> <br><p>  Untuk mendapatkan tiket yang didambakan, penyerang diminta untuk mengonversi ZeroSource.bmp: </p><br><p><img src="https://habrastorage.org/webt/f7/ef/tr/f7eftrhw6zevi-f_usxvu6ldce8.png" alt="gambar"></p><br><p>  sehingga setelah mengirim ke server jaringan saraf menginterpretasikan gambar ini sebagai 1. Jika Anda mencoba mengirim gambar ini tanpa diproses, hasil dari jaringan saraf adalah 0. </p><br><p>  Dan, tentu saja, petunjuk utama untuk tugas ini adalah file model KerasModel.h5 (file ini membantu penyerang mentransfer serangan ke pesawat WhiteBox, karena jaringan saraf dan semua data yang terkait dengannya dapat diakses olehnya).  Nama file segera berisi petunjuk - nama kerangka kerja di mana jaringan saraf diimplementasikan. </p><br><p>  Dengan catatan pengantar inilah peserta mulai menyelesaikan tugas: </p><br><ul><li>  Model jaringan saraf ditulis dalam Keras. </li><li>  Kemampuan untuk mengirim gambar ke server menggunakan curl. </li><li>  Gambar asli yang perlu diubah. </li></ul><br><p>  Di sisi server, cek sesederhana mungkin: </p><br><ol><li>  Gambar harus berukuran tepat - 28x28 piksel. </li><li>  Pada gambar ini, model harus mengembalikan 1. </li><li>  Perbedaan antara gambar awal ZeroSource.bmp dan yang dikirim ke server harus kurang dari ambang k oleh metrik MSE (kesalahan standar). </li></ol><br><p>  Jadi mari kita mulai. </p><br><p>  Pertama, peserta perlu menemukan informasi tentang cara menipu jaringan saraf.  Setelah beberapa saat di Google, ia mendapatkan kata kunci "Contoh permusuhan" dan "Serangan permusuhan."  Selanjutnya, dia perlu mencari alat untuk menerapkan serangan permusuhan.  Jika Anda mengarahkan ke Google kueri "Serangan permusuhan pada Keras Neural Net", tautan pertama adalah ke GitHub dari proyek FoolBox - pustaka python untuk menghasilkan contoh-contoh permusuhan.  Tentu saja, ada perpustakaan lain (kami membicarakannya di beberapa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel sebelumnya</a> ).  Selain itu, serangan dapat ditulis, seperti yang mereka katakan, dari awal.  Namun kami masih fokus pada perpustakaan paling populer, yang dapat ditemukan oleh seseorang yang sebelumnya tidak menemukan topik serangan permusuhan pada tautan pertama di Google. </p><br><p>  Sekarang Anda perlu menulis skrip Python yang akan menghasilkan contoh permusuhan. <br>  Kami akan mulai, tentu saja, dengan impor. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> foolbox</code> </pre> <br><p>  Apa yang kita lihat di sini? </p><br><ol><li>  Keras adalah kerangka kerja di mana Jaringan Saraf Tiruan ditulis, yang akan kita tipu. </li><li>  NumPy adalah perpustakaan yang memungkinkan kita untuk bekerja dengan vektor secara efisien. </li><li>  PIL adalah alat untuk bekerja dengan gambar. </li><li>  FoolBox adalah pustaka untuk menghasilkan contoh-contoh permusuhan. </li></ol><br><p>  Hal pertama yang harus dilakukan adalah, tentu saja, memuat model jaringan saraf ke dalam memori program kami dan melihat informasi model. </p><br><pre> <code class="python hljs">model = keras.models.load_model(<span class="hljs-string"><span class="hljs-string">"KerasModel.h5"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   model.summary() #     model.input #    ,       </span></span></code> </pre> <br><p>  Pada output, kami mendapatkan yang berikut: </p><br><pre> <code class="plaintext hljs">Layer (type) Output Shape Param # ================================================================= conv2d_1 (Conv2D) (None, 26, 26, 32) 320 _________________________________________________________________ conv2d_2 (Conv2D) (None, 26, 26, 64) 18496 _________________________________________________________________ max_pooling2d_1 (MaxPooling2 (None, 13, 13, 64) 0 _________________________________________________________________ dropout_1 (Dropout) (None, 13, 13, 64) 0 _________________________________________________________________ conv2d_3 (Conv2D) (None, 13, 13, 64) 36928 _________________________________________________________________ conv2d_4 (Conv2D) (None, 13, 13, 128) 73856 _________________________________________________________________ max_pooling2d_2 (MaxPooling2 (None, 6, 6, 128) 0 _________________________________________________________________ flatten_1 (Flatten) (None, 4608) 0 _________________________________________________________________ dense_1 (Dense) (None, 256) 1179904 _________________________________________________________________ dense_2 (Dense) (None, 10) 2570 ================================================================= Total params: 1,312,074 Trainable params: 1,312,074 Non-trainable params: 0 _________________________________________________________________ &lt;tf.Tensor 'conv2d_1_input_1:0' shape=(?, 28, 28, 1) dtype=float32&gt;</code> </pre> <br><p>  Informasi apa yang bisa saya dapatkan dari sini? </p><br><ol><li>  Model input (lapisan conv2d_1) menerima objek dimensi? X28x28x1, di mana "?"  - jumlah objek;  jika gambar adalah satu, maka dimensinya adalah 1x28x28x1.  Dan gambar adalah array tiga dimensi, di mana satu dimensi adalah 1. Artinya, gambar disajikan sebagai tabel nilai dari 0 hingga 255. </li><li>  Pada output model (lapisan dense_2), vektor dimensi 10 diperoleh. </li></ol><br><p>  Kami memuat gambar dan jangan lupa untuk mengubahnya menjadi tipe float (lebih jauh jaringan saraf akan bekerja dengan bilangan real) dan menormalkannya (bagi semua nilai dengan 255).  Di sini perlu diperjelas bahwa normalisasi adalah salah satu trik "wajib" ketika bekerja dengan jaringan saraf, tetapi penyerang mungkin tidak mengetahui hal ini, jadi kami secara khusus menambahkan sedikit petunjuk dalam deskripsi tugas): </p><br><pre> <code class="python hljs">img = Image.open(<span class="hljs-string"><span class="hljs-string">"ZeroSource.bmp"</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   img = np.array(img) #     numpy.array img = img.astype('float32') #      float img /= 255 # </span></span></code> </pre> <br><p>  Sekarang kita dapat mengirim gambar ke model yang dimuat dan melihat apa yang dihasilkannya: </p><br><pre> <code class="python hljs">model.predict(img.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#   predict           </span></span></code> </pre> <br><p>  Pada output kami mendapatkan informasi berikut </p><br><pre> <code class="plaintext hljs">array([[1.0000000e+00, 4.2309660e-19, 3.1170484e-15, 6.2545637e-18, 1.4199094e-16, 6.3990816e-13, 6.9493417e-10, 2.8936278e-12, 8.9440377e-14, 1.6340098e-12]], dtype=float32)</code> </pre> <br><p>  Perlu dijelaskan apa vektor ini: pada kenyataannya, ini adalah distribusi probabilitas, yaitu, setiap angka mewakili probabilitas kelas 0,1,2 ..., 9.  Jumlah semua angka dalam vektor adalah 1. Dalam hal ini, dapat dilihat bahwa model yakin bahwa gambar input mewakili kelas 0 dengan probabilitas 100%. </p><br><p>  Jika kami menggambarkan ini pada histogram, kami mendapatkan yang berikut: </p><br><p><img src="https://habrastorage.org/webt/_o/av/w9/_oavw9kqksofyiyjlg4z2jmf6_k.png" alt="gambar"></p><br><p>  Keyakinan Mutlak. </p><br><p>  Jika model tidak dapat menentukan kelas, vektor probabilitas akan cenderung ke distribusi yang seragam, yang, pada gilirannya, akan berarti bahwa model menetapkan objek ke semua kelas secara bersamaan dengan probabilitas yang sama.  Dan histogram akan terlihat seperti ini: </p><br><p><img src="https://habrastorage.org/webt/v1/qs/ek/v1qsek8agqisjs8geiy0bvdfq2y.png" alt="gambar"></p><br><p>  Secara umum diterima bahwa kelas model ditentukan oleh indeks angka maksimum dalam vektor yang diberikan.  Artinya, model tersebut secara teoritis dapat memilih kelas dengan probabilitas lebih dari 10%.  Tetapi logika ini dapat bervariasi tergantung pada logika keputusan yang dijelaskan oleh pengembang. </p><br><p>  Sekarang mari kita beralih ke bagian yang paling menarik - serangan permusuhan. </p><br><p>  Pertama, untuk bekerja dengan model di perpustakaan FoolBox, Anda harus menerjemahkan model ke dalam notasi Foolbox.  Anda dapat melakukannya dengan cara ini: </p><br><pre> <code class="python hljs">fmodel = foolbox.models.KerasModel(model,bounds=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#  bounds ,       ,        255,        0-1.</span></span></code> </pre> <br><p>  Setelah itu, Anda dapat menguji berbagai serangan.  Mari kita mulai dengan yang paling populer - FGSM: </p><br><h5 id="fgsm">  Fgsm </h5><br><pre> <code class="python hljs">attack = foolbox.attacks.FGSM(fmodel) <span class="hljs-comment"><span class="hljs-comment">#    FGSM     adversarial = attack(img.reshape(28,28,1),0) #  ,  adversarial  probs = model.predict(adversarial.reshape(1,28,28,1)) #     print(probs) #    print(np.argmax(probs)) #     </span></span></code> </pre> <br><p>  Output dari jaringan saraf adalah sebagai berikut </p><br><pre> <code class="plaintext hljs">[4.8592144e-01 2.5432981e-14 5.7048566e-13 1.6787202e-14 1.6875961e-11 1.2974949e-07 5.1407838e-01 3.9819957e-12 1.9827724e-09 5.7383300e-12] 6</code> </pre> <br><p>  Dan gambar yang dihasilkan: </p><br><p><img src="https://habrastorage.org/webt/m4/yc/yd/m4ycydwa2zhqfck-kelb3qlk2a8.png" alt="gambar"></p><br><p>  Jadi, sekarang dengan probabilitas lebih dari 50% 0 diakui sebagai 6. Sudah bagus.  Namun, kami masih ingin mendapatkan 1, dan tingkat kebisingannya tidak terlalu mengesankan.  Gambar benar-benar terlihat tidak masuk akal.  Lebih lanjut tentang ini nanti.  Sementara itu, mari kita coba mengabaikan serangan.  Tiba-tiba, kita masih mendapatkan 1. </p><br><h5 id="l-bfgs-ataka">  Serangan L-BFGS </h5><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel) adversarial = attack(img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>) probs = model.predict(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) print(probs) print(np.argmax(probs))</code> </pre> <br><p>  Kesimpulan: </p><br><pre> <code class="plaintext hljs">[4.7782943e-01, 1.9682934e-10, 1.0285517e-06, 3.2558936e-10, 6.5797998e-05, 4.0495447e-06, 2.5545436e-04, 3.4730587e-02, 5.5223148e-07, 4.8711312e-01] 9</code> </pre> <br><p>  Gambar: </p><br><p><img src="https://habrastorage.org/webt/ax/oj/td/axojtdhkbk1ad1zlc7j-uv006i8.png" alt="gambar"></p><br><p>  Lagi oleh.  Sekarang kita memiliki 0 yang dikenali sebagai 9 dengan probabilitas ~ 49%.  Namun, kebisingannya jauh lebih sedikit. </p><br><p>  Mari kita akhiri dengan beat acak.  Contoh dipilih sedemikian rupa sehingga akan sangat sulit untuk mendapatkan hasilnya secara acak.  Sekarang kami belum mengindikasikan di mana pun kami ingin mendapatkan 1. Oleh karena itu, kami melakukan serangan non-target dan percaya bahwa kami masih akan mendapatkan kelas 1, tetapi ini tidak terjadi.  Karenanya, ada baiknya beralih ke serangan yang ditargetkan.  Mari kita gunakan dokumentasi idibox dan temukan modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kriteria di</a> sana </p><br><p>  Dalam modul ini, Anda dapat memilih kriteria untuk serangan, jika mendukungnya.  Secara khusus, kami tertarik pada dua kriteria: </p><br><ol><li>  TargetClass - membuat sehingga dalam vektor distribusi probabilitas, elemen dengan angka k memiliki probabilitas maksimum. </li><li>  TargetClassProbability - membuatnya sehingga dalam vektor distribusi probabilitas, elemen dengan angka k memiliki probabilitas setidaknya p. </li></ol><br><p>  Mari kita coba keduanya: </p><br><h5 id="l-bfgs--targetclass">  L-BFGS + TargetClass </h5><br><p>  Hal utama dalam kriteria TargetClass adalah untuk mendapatkan probabilitas kelas k, lebih tinggi dari probabilitas kelas lainnya.  Maka jaringan yang membuat keputusan hanya dengan melihat probabilitas maksimum akan keliru. </p><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel,foolbox.criteria.TargetClass(<span class="hljs-number"><span class="hljs-number">1</span></span>))<span class="hljs-comment"><span class="hljs-comment">#    ,     ,    TargetClass,  ,      ,      adversarial = attack(img.reshape(28,28,1),0) probs = model.predict(adversarial.reshape(1,28,28,1)) print(probs) print(np.argmax(probs))</span></span></code> </pre> <br><p>  Kesimpulan: </p><br><pre> <code class="plaintext hljs">[3.2620126e-01 3.2813528e-01 8.5446298e-02 8.1292394e-04 1.1273423e-03 2.4886258e-02 3.3904776e-02 1.9947644e-01 8.2347924e-07 8.5878673e-06] 1</code> </pre> <br><p>  Gambar: </p><br><p><img src="https://habrastorage.org/webt/ym/rp/pq/ymrppqvdtt7e_yfyinubsev03pm.png" alt="gambar"></p><br><p>  Seperti yang dapat dilihat dari kesimpulan, sekarang jaringan saraf kita mengklaim bahwa itu adalah 1 dengan probabilitas 32,8%, sedangkan probabilitas 0 sedekat mungkin dengan nilai ini dan 32,6%.  Kami berhasil!  Pada prinsipnya, ini sudah cukup untuk menyelesaikan tugas.  Tetapi kita akan melangkah lebih jauh dan mencoba untuk mendapatkan probabilitas 1 di atas 0,5. </p><br><h5 id="l-bfgs--targetclassprobability">  L-BFGS + TargetClassProbability </h5><br><p>  Sekarang kita menggunakan kriteria TargetClassProbability, yang memungkinkan Anda untuk mendapatkan probabilitas suatu kelas dalam objek yang tidak lebih rendah dari p.  Hanya memiliki dua parameter: <br>  1) Jumlah kelas objek. <br>  2) Probabilitas kelas ini dalam contoh permusuhan. <br>  Selain itu, jika tidak mungkin untuk mencapai probabilitas seperti itu, atau waktu untuk menemukan objek seperti itu membutuhkan terlalu banyak waktu, maka objek permusuhan akan sama dengan tidak ada.  Anda dapat memverifikasi ini sendiri dengan mencoba membuat probabilitas, katakanlah, 0,99.  Maka metode ini mungkin tidak konvergen. </p><br><pre> <code class="python hljs">attack = foolbox.attacks.LBFGSAttack(fmodel,foolbox.criteria.TargetClassProbability(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0.5</span></span>)) adversarial = attack(img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>) probs = model.predict(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) print(probs) print(np.argmax(probs))</code> </pre> <br><p>  Kesimpulan: </p><br><pre> <code class="plaintext hljs">[4.2620126e-01 5.0013528e-01 9.5413298e-02 8.1292394e-04 1.1273423e-03 2.4886258e-02 3.3904776e-02 1.9947644e-01 8.2347924e-07 8.5878673e-06]</code> </pre> <br><p>  Hore!  Kami berhasil mendapatkan contoh permusuhan, di mana probabilitas 1 untuk jaringan saraf kami di atas 50%!  Hebat!  Sekarang mari kita lakukan denormalisasi (mengembalikan gambar ke format 0-255) dan menyimpannya. </p><br><p>  Script terakhir adalah sebagai berikut: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> foolbox <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> foolbox.criteria <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TargetClassProbability <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scipy.misc model = keras.models.load_model(<span class="hljs-string"><span class="hljs-string">"KerasModel.h5"</span></span>) img = Image.open(<span class="hljs-string"><span class="hljs-string">"ZeroSource.bmp"</span></span>) img = np.array(img.getdata()) img = img.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) img = img /<span class="hljs-number"><span class="hljs-number">255.</span></span> img = img.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) fmodel = foolbox.models.KerasModel(model,bounds=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) attack = foolbox.attacks.LBFGSAttack(fmodel,criterion=TargetClassProbability(<span class="hljs-number"><span class="hljs-number">1</span></span> ,p=<span class="hljs-number"><span class="hljs-number">.5</span></span>)) adversarial = attack(img[:,:,::<span class="hljs-number"><span class="hljs-number">-1</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>) adversarial = adversarial * <span class="hljs-number"><span class="hljs-number">255</span></span> adversarial = adversarial.astype(<span class="hljs-string"><span class="hljs-string">'int'</span></span>) scipy.misc.toimage(adversarial.reshape(<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>)).save(<span class="hljs-string"><span class="hljs-string">'AdversarialExampleZero.bmp'</span></span>)</code> </pre> <br><p>  Dan gambar terakhir adalah sebagai berikut: </p><br><p><img src="https://habrastorage.org/webt/1c/8i/ty/1c8ityrtcv46swzuc8yc545rw-4.png" alt="gambar">  . </p><br><h5 id="vyvody">  Kesimpulan </h5><br><p>  Jadi, seperti yang kita lihat dari contoh di atas, menipu jaringan saraf cukup sederhana.  Ada juga sejumlah besar metode yang mampu melakukan ini.  Cukup buka daftar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">serangan yang</a> tersedia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di kotak bodoh</a> dan coba terapkan.  Kami menyarankan Anda untuk mencoba engkol yang sama sendiri, dengan mengambil dasar jaringan saraf yang sama dan gambar yang sama, tersedia dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">referensi</a> .  Anda dapat meninggalkan pertanyaan Anda di komentar.  Kami akan menjawabnya! </p><br><p>  Selalu ingat bahwa, betapa pun bermanfaatnya algoritma dan modelnya, mereka bisa sangat tidak stabil terhadap perubahan kecil yang dapat menyebabkan kesalahan serius.  Karena itu, kami menyarankan Anda menguji model Anda, di mana python dan alat-alat seperti foolbox dapat membantu. </p><br><p>  Terima kasih atas perhatian anda! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443164/">https://habr.com/ru/post/id443164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443152/index.html">Cara memblokir Microsoft Edge di latar belakang di bawah Windows 10</a></li>
<li><a href="../id443154/index.html">Lampu latar keyboard DasKeyboard berdasarkan glukosa darah menggunakan REST API</a></li>
<li><a href="../id443158/index.html">Nostalgia for Half Life - menciptakan kotak dekoder untuk stasiun radio untuk menerima suara dan mengakhiri suara dalam gaya menggabungkan</a></li>
<li><a href="../id443160/index.html">Intisari materi menarik untuk pengembang seluler # 289 (4 Maret - 10 Maret)</a></li>
<li><a href="../id443162/index.html">Penerapan diagram matriks dan kompetensi</a></li>
<li><a href="../id443166/index.html">Buat dan perbarui milis di Zimbra Collaboration OSE berdasarkan pada kelompok dan pengguna Direktori Aktif</a></li>
<li><a href="../id443174/index.html">hellOGL: Halo dunia OpenGL</a></li>
<li><a href="../id443176/index.html">7 ekstensi Chrome untuk belajar bahasa Inggris</a></li>
<li><a href="../id443178/index.html">Crystal Blockchain Analytics: Investigasi Kasus Hacks dan Pencurian</a></li>
<li><a href="../id443180/index.html">Kru pendaratan Naga dan tangkapan video asteroid</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>