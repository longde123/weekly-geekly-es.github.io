<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👋🏾 💳 👩🏻‍🎨 Identifikasi klien di situs tanpa kata sandi dan cookie: aplikasi untuk standar 👉🏻 💋 📻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habrozhitel yang terhormat! Para ahli yang terhormat! Saya mempersembahkan bagi penilaian Anda konsep baru identifikasi pengguna di situs web, yang, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Identifikasi klien di situs tanpa kata sandi dan cookie: aplikasi untuk standar</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472310/"><img src="https://habrastorage.org/webt/zx/gv/lz/zxgvlzpzrabaux0m9y-brjkhhpi.jpeg" alt="gambar"><br><br>  Habrozhitel yang terhormat!  Para ahli yang terhormat!  Saya mempersembahkan bagi penilaian Anda konsep baru identifikasi pengguna di situs web, yang, saya harap, dengan bantuan Anda akan menjadi standar Internet terbuka, membuat dunia internet ini sedikit lebih baik.  Ini adalah versi konsep protokol otentikasi tanpa kata sandi, yang dirancang sebagai artikel gratis.  Dan jika ide yang mendasarinya menerima penilaian positif dari Anda, pembaca yang budiman, saya akan terus menerbitkannya di reddit.com dan rfc-editor.org.  Dan saya berharap bahwa saya akan dapat menarik minat pengembang browser terkemuka dalam implementasinya.  Karena itu, saya mengharapkan kritik yang membangun dari Anda. <br><br>  Perhatian: banyak teks. <br><br><a name="habracut"></a><br>  Jadi pertanyaannya adalah.  Apakah mungkin mengidentifikasi pengunjung situs secara jelas tanpa mengungkapkan data pribadi mereka dan melacak antara situs yang berbeda?  Apakah mungkin, menyelesaikan masalah seperti itu, untuk menolak bentuk otorisasi yang paling primitif dengan login / kata sandi dan menggunakan cookie / localStorage? <br><br>  Di satu sisi, situs harus mengenali klien secara berurutan, misalnya, untuk "mengembalikan" pengaturan, keranjang produk, iklan, artikel, dll.  Di sisi lain, pengunjung ingin tetap anonim mungkin, tanpa mengungkapkan data pribadi mereka, dan mencegah situs pihak ketiga melacaknya.  Dan yang terakhir dapat melakukan ini dengan bertukar di antara mereka sendiri data yang dikumpulkan. <br><br>  Kedengarannya seperti tugas untuk memastikan bahwa serigala penuh, dan domba-domba aman.  Apakah ini nyata? <br><br>  Saya, sampai batas tertentu, saya pikir - sungguh. <br><br><h1>  Daftar isi </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1 Konsep otentikasi tanpa kata sandi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.1 Kunci dan token alih-alih login dan kata sandi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.2 Struktur Token</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/472310/&amp;usg=ALkJrhja015BHwpS4IxzrWN3pKGTvcphUw#">1.3 header protokol HTTP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.4 Bagaimana cara pelanggan mengidentifikasi situs?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.4.2 Bagaimana saya tahu jika suatu situs mendukung protokol ini?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.5 Bagaimana cara klien mengotorisasi situs?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.6 Bagaimana menerapkan identifikasi pelanggan yang andal?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.7 Otorisasi di situs melalui mata pengguna</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.8 Bagaimana perubahan kunci situs?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.9 Bagaimana penerapan otorisasi lintas-domain?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.10 Bagaimana cara menerapkan otentikasi lintas-domain?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.11 Mobilitas Akun</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2 Deskripsi teknis protokol</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.0 Algoritma Pembangkitan Kunci Domain</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.1 algoritma untuk menghitung token sumber</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.2 Algoritma perlindungan token selama transfer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.3 Prosedur pertukaran garam antara browser dan server</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.4 Aturan untuk pembentukan bidang Konteks</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.5 Aturan untuk mendefinisikan bidang Pengirim dan Penerima</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.6 Rincian tentang Tabel Definisi Konteks</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.7 Skenario Protokol</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.8 Memproses token di server</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.9 Otentikasi lintas-domain</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3 Rekomendasi Keselamatan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3.1 Perlindungan informasi utama dari akses tidak sah</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3.2 Tentang kata sandi sebagai kunci domain</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3.3 Risiko kehilangan / kompromi kunci dan meminimalkannya</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4 Serangan pada skema otorisasi</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.1 Pelacakan Pengguna</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.2 serangan XSS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.3 Serangan CSRF</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.4 Pelacakan menggunakan SSO</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.5 Kompromi Kunci untuk SSO</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.6 Token kompromi selama transfer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.7 Meretas situs web dan token yang membahayakan</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kesimpulan</a> <br><br><br><div class="spoiler">  <b class="spoiler_title">Apa yang salah dengan kata sandi?</b> <div class="spoiler_text">  Ya tidak.  Mereka bisa tersesat.  Mereka bisa dicuri.  Mereka harus diingat.  Ngomong-ngomong, mengapa saya wajib mengisi beberapa formulir pendaftaran dan membuat kata sandi lain untuk melihat cuaca atau mengunduh file ini?  Akhirnya, kata sandi sedikit kurang dari banyak.  Berapa banyak situs yang Anda suka, begitu banyak kata sandi.  Dan oleh karena itu, banyak yang benar-benar menggunakan satu kata sandi di semua situs.  Seseorang menggunakan algoritma yang rumit untuk mengingatnya.  Atau pengelola kata sandi.  Atau, bodohnya, sebuah buku catatan.  Atau lebih suka otentikasi lintas-domain: Anda login sekali di satu situs, dan itu saja!  Ya tidak semua  Ini jika situs mendukungnya. <br>  Semua pendekatan ini memiliki kelemahan. <br>  Gunakan satu kata sandi di situs yang berbeda - Moveton.  Apa yang diketahui dua orang, babi juga tahu.  Tidak semua situs (bahkan besar dan terkemuka) dengan jujur ​​mematuhi aturan keamanan untuk menyimpan kata sandi Anda.  Beberapa situs menyimpan kata sandi dalam bentuk terbuka, sementara yang lain berpikir bahwa menyimpan hash kata sandi sudah cukup melindunginya.  Akibatnya, kebocoran kata sandi dan data pribadi klien lainnya terjadi secara teratur. <br>  Dengan password manager sudah lebih baik.  Benar, tidak ada yang menjamin Anda bahwa itu tidak menggabungkan kata sandi Anda di suatu tempat.  Dan cari manajer yang dapat menyinkronkan akun Anda di semua perangkat (netbook rumah, telepon, komputer kantor).  Saya tidak mengecualikan bahwa itu ada. <br>  Tetapi bagaimanapun juga, idenya sendiri: pertama mendaftar di situs web kami (pada saat yang sama, mengirim email, ponsel, menyumbangkan darah untuk analisis), kemudian menemukan / mengingat nama pengguna dan kata sandi Anda dan berbaik hati untuk mengingatnya, tetapi tetap rahasiakan - pendekatan, saya katakan, begitu-begitu.  Dan tidak ada satu pun pengelola kata sandi yang akan menyelesaikannya.  Tapi itu memecahkan <abbr title="Teknologi Single Sign-On diimplementasikan oleh berbagai proctocols seperti SAML, OAuth, Kerberos">SSO</abbr> . <br>  Itu hanya nasib buruk: jika Anda kehilangan kata sandi dari situs SSO dan melupakannya, atau dicuri dari Anda ... Anda kehilangan akses dari semua situs Anda sekaligus atau Anda secara sukarela memberikannya kepada siapa pun dan tidak jelas dengan niat apa.  <b>Jangan menyimpan semua telur dalam satu keranjang!</b> <br>  Dan itu bukan fakta bahwa situs SSO dapat diandalkan.  Atau tidak menyimpan kata sandi Anda dalam teks yang jelas.  Atau sama sekali tidak menggabungkannya secara sukarela, plus itu memberikan kesempatan bagi orang lain untuk melacak Anda di antara situs.  Nah, Anda mengerti intinya. <br>  Karenanya: login + kata sandi = jahat.  Dan semua kejahatan di dunia harus diminum dengan serius dan untuk waktu yang lama.  Dan kue juga.  Bersama dengan buaya sesi PHPSESSIONID, JSESSIONID, dan analognya. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Dan apa yang harus dilakukan?</b> <div class="spoiler_text">  Pertama, Anda perlu mempertimbangkan situasi khusus, yang akan menjadi jelas: mengapa situs ingin mengingat pelanggan mereka dan apakah itu benar-benar diperlukan bagi mereka? <br><ol><li>  Blog pribadi "Vasya Pupkina", di mana, misalnya, komentar diperbolehkan.  Pendaftaran hanya diperlukan untuk melindungi diri dari bot, melakukan pemungutan suara gratis, menghitung "suka" dan "meow-meow" lainnya, dan memberikan peringkat kepada komentator.  Yaitu  Di sini <b>, fungsionalitas pelacakan diperlukan secara eksklusif oleh situs</b> , dan hanya sebagian kecil - oleh pengguna (jika ia menilai peringkat "komentator" -nya di situs ini). </li><li>  Situs jaringan sosial dan pembicara internet lainnya (ICQ, skype - ada juga).  Diperlukan pendaftaran untuk mengimplementasikan konten bernama (penulis), untuk mengidentifikasi pengunjung satu sama lain.  Yaitu  Di sini <b>, fungsi identifikasi diperlukan untuk tingkat yang lebih besar oleh pengguna itu sendiri</b> .  Meskipun situs jejaring sosial adalah yang pertama dalam daftar "orang berdosa", mengumpulkan informasi paling lengkap tentang pengunjung dan mengingat Anda dengan serius dan untuk waktu yang lama.  Jadi belum diketahui siapa yang butuh identifikasi lebih lanjut. </li><li>  Situs korporat dengan konten tertutup.  Registrasi atau otorisasi di sini diperlukan terutama untuk membatasi akses ke konten.  Segala macam: sekolah online, perpustakaan, situs pribadi non-publik, dan sebagainya.  Di sini <b>, fungsionalitas otorisasi sangat dibutuhkan oleh situs</b> .  Sebagai aturan, tidak ada formulir pendaftaran terbuka.  Kredensial dibagikan melalui saluran lain. </li><li>  Toko online dan platform serupa lainnya yang menjual barang, layanan, atau konten.  Saya juga akan menyertakan situs iklan baris berbayar / gratis.  Registrasi terutama diperlukan untuk menyimpan sejarah pesanan pelanggan, dan agar ia dapat melacak status mereka saat ini, menyimpan preferensi mereka (favorit);  untuk merumuskan penawaran pribadi kepada klien berdasarkan riwayat pembelian dan preferensi.  Di sini <b>, fungsi identifikasi sama-sama diperlukan untuk pelanggan dan toko</b> .  Tapi lebih banyak, tentu saja, ke toko.  Untuk mengukus, mengukus dan mengukus. </li><li>  Setiap akun pribadi pengguna layanan Internet: e-mail, layanan publik, Sberbank-online, megaphone-online, kantor penyedia, CMS dari hosters, dll.  Di sini <b>, pengguna itu sendiri terutama tertarik pada identifikasi yang benar dan dapat diandalkan</b> .  Bagaimanapun, ia mengelola informasi yang penting bagi dirinya sendiri, yang dalam beberapa situasi memiliki konsekuensi hukum dan finansial.  Baunya tidak seperti anonimitas.  Dia berbahaya di sini. </li><li>  Router, konsol manajemen, versi web mengelola sesuatu di rumah atau jaringan perusahaan Anda. </li></ol><br><br>  Jelas bahwa dalam situasi yang berbeda, mungkin ada risiko yang berbeda.  Dalam beberapa kasus, identifikasi yang salah, kehilangan data autentikasi, atau bahkan pencurian / pemalsuannya, tidak akan mengakibatkan konsekuensi signifikan bagi situs atau bagi pengguna.  Di tempat lain, itu hanya akan menjadi tidak menyenangkan (saya kehilangan karma di Habré - "itu adalah bencana ...") atau akan menyebabkan ketidaknyamanan (saya tidak bisa pergi sendiri di Yula, melihat iklan saya; saya telah membuat profil akses ke proyek saya di github, - oke akun baru, proyek garpu).  Ketiga, dapat menimbulkan konsekuensi hukum dan keuangan.  Oleh karena itu, harus diasumsikan bahwa skema otorisasi yang diusulkan bukan "peluru perak" untuk semua kasus, terutama "telanjang".  <b>Di mana informasi sensitif dikelola, ada baiknya menggunakan metode identifikasi dan otentikasi lain</b> atau kombinasinya (otentikasi dua faktor, kriptografi kunci asimetris, aman 3D, eToken, OTP-Token, dll.). <br><br>  Oh baiklah  Apa TK Anda? <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Apa yang ditawarkan protokol baru?</b> <div class="spoiler_text">  Dari perspektif pengguna akhir: <br><ol><li>  Situs harus mengingat dan mengenali pengunjung tanpa masukan dari pengguna;  situs harus mengenali Anda berdua di dalam sesi dan di antara sesi yang berbeda.  Tidak ada cookie, kata sandi, atau pendaftaran.  Pada saat yang sama, situs yang berbeda tidak boleh mampu mengidentifikasi pengunjung yang sama secara unik, dapat melacak aktivitas mereka di situs ini dan situs lainnya.  Yaitu  situs seharusnya tidak dapat mengumpulkan informasi untuk pengunjung mereka. </li><li>  Pengguna harus dapat " <b>melupakan situs apa saja</b> " kapan saja;  dan situs akan melupakan pengguna.  Seharusnya ada kemungkinan pemberian hak ke situs untuk mengingat klien atas inisiatif klien (tanpa popup obsesif).  Pengguna harus dapat memigrasikan identitas virtualnya dengan aman di antara berbagai perangkat dan browser (jika ia membutuhkannya) agar memiliki satu otorisasi di situs favoritnya. </li></ol><br><br>  Saya melihat.  Dan bonus apa yang harus diperoleh pengembang situs dari ini? <br><ol><li>  Prosedur identifikasi yang lebih sederhana: tidak perlu membuat untuk seribu kali bentuk login, logout, registrasi, perubahan dan pemulihan kata sandi berikutnya.  Cukup mengaktifkan modul dukungan protokol untuk kerangka kerja favorit Anda, yang diterapkan berdasarkan standar. </li><li>  Tidak perlu bagi seorang desainer untuk menggambar formulir login dan berpikir tentang di mana menyembunyikannya di layar ponsel kecil.  Protokol membuat formulir tidak perlu sama sekali.  Nah, kecuali itu formulir pendaftaran.  Di mana tanpa mereka saat itu.  Sayang </li></ol><br><br>  Akhirnya: <br><ol><li>  Protokol otentikasi harus disatukan dan distandarisasi;  Diverifikasi oleh pakar keamanan  Disetujui dan direkomendasikan oleh komite standardisasi web.  Akibatnya, kemungkinan membuat kesalahan klasik oleh webmaster saat mengembangkan formulir login / logout standar, mengubah / memulihkan kata sandi (mentransmisikan kata sandi dalam bentuk yang jelas, menggunakan hashing yang salah, menyimpan kata sandi atau hash "non-salted" dalam database, membajak kata sandi pengguna saat situs peretasan). </li><li>  Otorisasi harus dapat diandalkan sampai batas tertentu (dilindungi dari pemalsuan, akses tidak sah, dengan otentikasi yang dijamin);  Jangan membuat kerentanan baru di halaman web dan browser;  jika memungkinkan, kurangi risiko serangan jaringan yang diketahui di luar kotak.  Ya, atau setidaknya pengurangan yang signifikan dalam risiko keberhasilan implementasi mereka. </li></ol><br><br>  Berdasarkan persyaratan ini, kami beralih ke yang paling menarik: merancang protokol baru. <br></div></div><br><br><a name="part1"></a><h1>  1 Konsep otentikasi tanpa kata sandi </h1><br><br><a name="tokens_vs_passwords"></a><h2>  1.1 Kunci dan token alih-alih login dan kata sandi </h2><br>  Untuk setiap domain, termasuk yang anak-anak, browser klien secara acak menghasilkan kunci 256-bit yang unik <math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline">  .  <b>Kunci ini tidak pernah dikirimkan.</b>  Tetap konstan dalam sesi pengguna.  Setiap sesi baru menciptakan kunci baru. <br>  Berbasis kunci <math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline">  browser menghasilkan token 256-bit <sup>*</sup> menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">algoritma khusus</a> <math></math><img src="https://habrastorage.org/getpro/habr/formulas/175/f98/839/175f98839ab732db76d5f20cd6ce2ce9.svg" alt="$ T $" data-tex="inline">  untuk mengidentifikasi pengguna dengan domain tertentu.  Token identifikasi <math></math><img src="https://habrastorage.org/getpro/habr/formulas/175/f98/839/175f98839ab732db76d5f20cd6ce2ce9.svg" alt="$ T $" data-tex="inline">  pengguna (selanjutnya hanya disebut sebagai token) berfungsi sebagai pengganti cookie sesi seperti PHPSESSIONID dan JSESSIONID. <br>  Kunci <math></math><img src="https://habrastorage.org/getpro/habr/formulas/8b1/9d8/49a/8b19d849a66473b36d68c78d06462129.svg" alt="$ K $" data-tex="inline">  dapat " <b>diperbaiki</b> " oleh pengguna.  Memperbaiki kunci akan memungkinkan pengguna untuk tetap berwenang di situs untuk waktu yang tidak terbatas dalam sesi browser yang berbeda dan mengembalikan otorisasi yang sudah ada sebelumnya.  Ini adalah <b>analog dari fungsi "ingat saya"</b> . <br>  Ketika komit dibatalkan, browser akan "lupa" kunci ini dan akan mulai lagi menghasilkan kunci acak untuk domain ini untuk setiap sesi baru (mulai dari yang sekarang), yang <b>analog dengan "keluar" pengguna</b> dari situs.  Outputnya instan, tidak perlu memuat ulang halaman. <br>  Pengguna dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membuat kunci permanen untuk domain</a> .  Kunci permanen, serta yang tetap, akan memungkinkan pengguna untuk mengembalikan otorisasi sebelumnya.  Bahkan, <b>kunci</b> ini <b>menjadi pengganti koneksi login-kata sandi.</b> <br>  Pengguna mendapat kesempatan untuk mengontrol kapan browser untuk domain akan menggunakan kunci konstan, dan kapan - acak.  Ini adalah <b>analog dari fungsi masuk / keluar</b> .  Konsepnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">disajikan dalam screenshot di bawah ini</a> . <br>  Metode untuk menghasilkan kunci domain persisten menyediakan mobilitas akun pengguna antara perangkat yang berbeda.  Protokol mendefinisikan berikut ini: <br><ul><li>  pembuatan kunci domain berdasarkan kunci master pengguna </li><li>  secara individual membentuk kunci domain berdasarkan pada sensor angka acak biologis </li><li>  mengimpor kunci yang ada dari file kunci dari perangkat lain </li></ul><br><br><a name="token_structure"></a><h2>  1.2 Struktur Token </h2><br>  Token adalah struktur 256-bit, direpresentasikan sebagai string heksadesimal: <br><div class="scrollable-table"><table><tbody><tr><td>  84bc3da1b3e33a18e8d5e1bdd7a18d7a </td><td>  166d77ac1b46a1ec38aa35ab7e628ab5 </td></tr><tr><td>  bagian identifikasi </td><td>  bagian otentikasi </td></tr></tbody></table></div><br>  Bagian identifikasi token (128 bit tertinggi) mirip dengan login.  Dengan urutan bit ini, server dapat secara unik mengidentifikasi pengguna. <br>  Bagian otentikasi token (128 bit yang lebih rendah) mirip dengan kata sandi.  Urutan bit ini membantu server memvalidasi token. <br>  Aturan validasi token <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dijelaskan di bawah ini</a> . <br><br><a name="http_headers"></a><h2>  1.3 header protokol HTTP </h2><br>  <b>Tajuk yang digunakan oleh klien:</b> <br><br>  <b>CSI-Token</b> : &lt;Token&gt; digunakan untuk mengirim token ke server <br>  <b>CSI-Token</b> : &lt;Token1&gt;;  <b>Changed-To</b> &lt;Token2&gt; digunakan untuk mengubah token saat ini: <br><ul><li>  saat mengotorisasi pada kunci permanen, </li><li>  saat mendaftarkan kunci permanen, </li><li>  saat mengubah kunci permanen. </li></ul><br>  <b>CSI-Token</b> : &lt;Token&gt; <b>Permanen</b> digunakan ketika memperbaiki kunci acak saat ini oleh pengguna. <br>  <b>CSI-Token</b> : &lt;Token&gt; <b>Logout</b> digunakan untuk mengakhiri sesi saat ini secara prematur. <br><br>  <b>Header yang digunakan oleh server:</b> <br>  <b>Dukungan CSI: yes</b> memberi tahu klien bahwa server mendukung protokol otorisasi CSI. <br>  <b>CSI-Token-Action: sukses</b> digunakan untuk memberi tahu browser tentang penerimaan token pengguna baru (tombol Change-To). <br>  <b>CSI-Token-Action: batalkan</b> membatalkan prosedur untuk mengubah token (kembalikan ke token sebelumnya). <br>  <b>CSI-Token-Action: pendaftaran</b> memberi tahu browser bahwa token pengguna baru masih dalam proses pendaftaran. <br>  <b>CSI-Token-Action:</b> kesalahan verifikasi token sisi server <b>tidak valid</b> . <br><br>  Akhirnya <br>  <b>CSI-Salt</b> dikirim oleh browser dan server saat bertukar "garam" yang digunakan untuk melindungi token (bagian otentikasi).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lihat di bawah untuk</a> detail lebih lanjut. <br><br><a name="how_site_identify_us"></a><h2>  1.4 Bagaimana cara pelanggan mengidentifikasi situs? </h2><br>  Situs dapat menggunakan token untuk mengidentifikasi pengunjung situs.  Pada saat yang sama, skema pembuatan token dan kapasitas 256-bit mereka <b>menjamin token unik untuk setiap pasangan:</b> domain pengguna.  Domain lain akan melihat token pengguna lain.  Bahkan jika dieksekusi dalam konteks situs target (via IFRAME, IMG, LINK, SCRIPT).  Selain itu, algoritma pembuatan token khusus melindungi pengguna dari XSS, serangan SRF dan membuatnya mustahil untuk melacak pengguna tanpa sepengetahuannya.  Tetapi pada saat yang sama, teknologi <abbr title="Teknologi Single Sign-On diimplementasikan oleh berbagai proctocols seperti SAML, OAuth, Kerberos">SSO tetap</abbr> dimungkinkan dengan izin dan identifikasi lintas-domainnya. <br>  Token <b>ditransmisikan dalam header HTTP CSI-Token</b> <u>dengan setiap permintaan</u> ke sumber daya domain apa pun (halaman, dokumen, gambar, skrip, gaya, font, file, permintaan ajax, ...): <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ki/mv/0k/kimv0kx4wvesmftizvvlgpfe088.png"></div><br>  Token <b>dihitung ulang <i>pada setiap</i> permintaan HTTP (S)</b> : halaman, gambar, permintaan ajax. <br>  Untuk mengoptimalkan perhitungan, cache token oleh browser diizinkan, tetapi hanya selama durasi sesi dan hanya jika kondisi untuk memenuhi permintaan tetap tidak berubah. <br>  Seperti disebutkan di atas, token dapat berfungsi sebagai pengganti cookie sesi seperti PHPSESSIONID dan JSESSIONID.  Satu-satunya perbedaan adalah bahwa jika situs yang sebelumnya menghasilkan pengidentifikasi bagi pengunjung untuk melacak pengguna tertentu antara permintaan yang berbeda (setelah semua, ribuan permintaan dari pengguna yang berbeda datang ke situs pada saat yang sama), sekarang klien itu sendiri melakukan fungsi ini. <br>  Identifikasi semacam itu cukup memadai untuk memungkinkan Anda melakukan pembelian di toko online, beriklan di situs yang sesuai, menulis di forum, di jejaring sosial, Wikipedia, atau artikel Habré. <br>  Ya, pengguna tetap anonim untuk situs tersebut.  Tapi itu bisa menjadi "akrab" anonim ke situs.  Dan server dapat menyimpan token pengguna semacam itu di sisinya, bersama dengan datanya (akun pribadi dengan pembelian, preferensi, karma, roti, suka, dan bonus lainnya).  Tetapi hanya untuk tetap dalam kondisi selesainya proses bisnis apa pun: pembelian, penyerahan pengumuman, dll.  Ketentuannya ditentukan oleh situs itu sendiri. <br>  Seperti yang Anda lihat, protokolnya sesederhana mungkin untuk situs yang tidak perlu mendaftarkan Anda sebelum memberi Anda kesempatan untuk mengambil tindakan apa pun.  Tetapi mereka yang membutuhkannya akan sedikit lebih sulit.  Tetapi lebih lanjut tentang itu di bawah ini. <br><br><a name="how_we_know_what_sci_supported"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.4.2 Bagaimana saya tahu jika suatu situs mendukung protokol ini? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs harus lulus </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dukungan CSI: ya</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> http-header </font><font style="vertical-align: inherit;">di bagian Header Respons dari responsnya:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ly/gs/zu/lygszusqavjk8yjnljig4pgojdm.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah melihat judul seperti itu, peramban akan memberi tahu pengguna bahwa ia dapat menyelamatkan dirinya di situs. </font><font style="vertical-align: inherit;">Misalnya, simbol kunci di bilah alamat:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ar/ff/bt/arffbt4ibbg__wlp7eyvaei_gvq.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengklik pada kunci, misalnya, akan membuat kunci untuk domain </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.youtube.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fq/7c/4p/fq7c4piubz15qir9xtxchg9639o.jpeg"></div><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pembentukan kunci baru tidak mengarah pada penggunaan otomatisnya. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kunci permanen mulai digunakan hanya ketika diaktifkan oleh pengguna. </font></font><br><br><a name="how_make_authorization"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.5 Bagaimana cara klien mengotorisasi situs? </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting untuk dipahami bahwa token belum membuat pengguna diotorisasi di situs tertentu - hanya dikenali. </font><font style="vertical-align: inherit;">Tetapi, seperti yang telah dikatakan, untuk saat ini Anda hanyalah "orang anonim" yang dikenali. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika situs perlu mengaitkan token Anda dengan Anda secara pribadi, pendaftaran di situs tersebut, sayangnya, tidak dapat dihindari. </font><font style="vertical-align: inherit;">Tetapi dalam protokol yang diusulkan, ini dibuat sedikit lebih mudah.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting bagi pengembang untuk memahami: sebagian besar situs tidak memerlukan kuesioner. </font><font style="vertical-align: inherit;">Hindari memaksa pengunjung untuk mendaftar. </font><font style="vertical-align: inherit;">Dalam situasi paling umum, Anda dapat melakukan proses bisnis tanpa mengumpulkan pengunjung PD.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengisi formulir pendaftaran yang membosankan "dengan atau tanpa" tidak menyenangkan. </font><font style="vertical-align: inherit;">Tetapi dengan protokol baru, membuat login dan kata sandi lain tidak lagi diperlukan. </font><font style="vertical-align: inherit;">Hanya tombol Konfirmasi dan Simpan Saya:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/__/0i/1x/__0i1xkyu82-ne_cnghuongzrfy.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda, tentu saja, harus terlebih dahulu membuat kunci permanen untuk situs tersebut. </font><font style="vertical-align: inherit;">Tapi ini masalah beberapa klik mouse. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan, pasti, Anda akan diminta untuk mengkonfirmasi telepon atau alamat surat Anda. </font><font style="vertical-align: inherit;">Tapi itu sudah tergantung situsnya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah otorisasi berhasil, server, melalui tajuk HTTP khusus, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan memberi tahu browser bahwa ia telah menerima kunci baru. </font><font style="vertical-align: inherit;">Lebih detail di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bab II</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="how_implement_reliable_identification"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.6 Bagaimana menerapkan identifikasi pelanggan yang andal? </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam situasi yang lebih serius (akun pribadi penyedia, hosting, bank) otentikasi dua faktor harus dan dapat dilakukan, dan bukti kepemilikan token dapat dilakukan melalui pra-pendaftaran dan konfirmasi identitas dengan cara lain: melalui email, SMS, atau bahkan dengan kertas yang memperbaiki token pengguna. </font><font style="vertical-align: inherit;">(Ya, ya. Sertifikat dicatat di atas kertas, mengapa tidak token).</font></font><br><br><a name="user_view_concept"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.7 Otorisasi di situs melalui mata pengguna </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser memberi tahu pengguna bahwa situs tersebut mendukung otorisasi CSI melalui ikon kunci di bilah alamat. </font><font style="vertical-align: inherit;">Jika Anda melakukan beberapa tindakan di situs, Anda dapat meminta situs untuk mengingat Anda. </font><font style="vertical-align: inherit;">Mulai saat ini, server akan mengenali pengguna bahkan di antara sesi yang berbeda:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/up/et/3q/upet3q-qbs8ikn4ba9t0ycn8voy.gif"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ilustrasi</font></font></b> <div class="spoiler_text">     ,  .       ,   ,  ,   .    ,   .    .    .   ,   , ,      .   .  . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alih-alih memperbaiki kunci, pengguna dapat membuat kunci permanen untuk situs dan mendaftar di sana. </font><font style="vertical-align: inherit;">Ilustrasi animasi:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/32/82/tm/3282tmri0zwdfx1jqi_zgd76zu0.gif"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ilustrasi</font></font></b> <div class="spoiler_text">   .   .  .      . <br>     ,  « ».      . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dan ketika pengguna memiliki kunci permanen untuk situs dan kunci ini terdaftar di sana, proses masuknya sangat disederhanakan: </font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u4/cm/_g/u4cm_gdewg2j7ree3gq3phuz6x4.gif"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ilustrasi</font></font></b> <div class="spoiler_text">   . ,    .  ,  «».   ,  . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kekuatan terbesar dari protokol dimanifestasikan ketika pengguna membuat kunci untuk situs berdasarkan kunci utama. </font><font style="vertical-align: inherit;">Dalam hal ini, </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">masalah identifikasi Anda di situs di perangkat lain</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mudah </font><u><font style="vertical-align: inherit;">diselesaikan</font></u><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Animasi berikut menunjukkan ini. </font><font style="vertical-align: inherit;">Diasumsikan bahwa Anda sebelumnya membagikan kunci utama Anda satu kali antara perangkat / browser Anda:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xs/ye/tx/xsyetxguxoesirmridywcy-2rts.gif"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ilustrasi</font></font></b> <div class="spoiler_text">      .       -.  .    (  ). <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Untuk situs dengan otorisasi dua faktor, "pengenalan" mungkin terlihat seperti ini: </font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/du/ab/cl/duabclss3t9nkxpnjygrqfxjdha.gif"></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ilustrasi</font></font></b> <div class="spoiler_text">   .   .       .   ;    .   . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keluar lebih mudah. </font><font style="vertical-align: inherit;">Klik "Logout" di browser dan hanya itu:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/do/2r/fe/do2rfebsd3orgwphl0ujrt_o52q.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser mengirim permintaan ke situs (pada halaman mana saja) dengan metode HEAD, di mana ia mengirimkan header CSI-Token &lt;&gt;; </font><font style="vertical-align: inherit;">Logout.</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mt/gj/s1/mtgjs1i1jmtbehjyus_hfukqsq4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server, melihat tajuk seperti itu, membuat Logout. </font><font style="vertical-align: inherit;">Jika itu adalah kunci tetap, maka situs menghapus semua informasi tentang pengguna (lebih dari kunci seperti itu tidak akan pernah muncul). </font><font style="vertical-align: inherit;">Jika itu adalah kunci permanen, cukup istirahat sesi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap aktivitas lebih lanjut dari situs mengubah pengguna menjadi anonim yang tidak dikenal ke situs: memuat ulang halaman, mencoba membuat permintaan ajax, mengunduh file, dll. </font><font style="vertical-align: inherit;">- Browser akan mengirim token yang dihasilkan berdasarkan kunci acak.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat mengelola kunci di manajer kunci: mengubah kunci permanen, mengekspor kunci permanen ke file, mengimpor dari file dari perangkat lain. </font><font style="vertical-align: inherit;">Atur "keluar otomatis" setelah menutup tab atau peramban. </font><font style="vertical-align: inherit;">Atur durasi kunci tetap.</font></font></blockquote><br><br><a name="how_user_can_change_key"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.8 Bagaimana perubahan kunci situs? </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengganti kunci permanen situs secara teknis sama dengan mengubah dari kunci acak ke kunci permanen. </font><font style="vertical-align: inherit;">Ini dijelaskan secara lebih rinci dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bab II</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika mengubah kunci permanen situs, browser memberi tahu situs tentang perubahan yang sesuai dalam token, mengirimkan </font><font style="vertical-align: inherit;">header </font><b><font style="vertical-align: inherit;">CSI-Token</font></b><font style="vertical-align: inherit;"> dengan kunci </font><b><font style="vertical-align: inherit;">Changed-To </font></b></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di setiap permintaan berikutnya</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xk/rp/75/xkrp75ivdr3kjj1_i2sh9iwfqaa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs harus memproses permintaan semacam itu dengan benar. </font><font style="vertical-align: inherit;">Dan, jika token pengguna tertentu disimpan dalam database-nya, itu harus melakukan penggantian yang sesuai. </font><font style="vertical-align: inherit;">Pada saat yang sama, situs harus menanggapi browser tentang perubahan token yang berhasil di pihaknya. </font><font style="vertical-align: inherit;">Dia melakukan ini di header Header Respons dengan parameter: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action: sukses</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , menunjukkan token yang diterapkan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs memiliki hak untuk menolak upaya untuk mengubah token (misalnya, jika tidak ada token seperti itu dalam database-nya atau tidak menyimpannya sama sekali) dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSI-Token-Action: parameter yang dibatalkan. </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sampai browser menerima header CSI-Token-Action, itu akan menambahkan kunci Changed-To ke setiap permintaan CSI-Token ke situs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analog dari "perubahan kata sandi" pengguna.</font></font></b> <br><br><a name="how_make_cross_domain_auth"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1.9 Bagaimana penerapan otorisasi lintas-domain? </font></font></h2><br>  Otorisasi lintas domain klasik menggunakan teknologi <abbr title="Teknologi Single Sign-On diimplementasikan oleh berbagai proctocols seperti SAML, OAuth, Kerberos">SSO</abbr> memiliki banyak keuntungan bagi pengguna.  Anda tidak perlu mengingat banyak kata sandi dari banyak situs.  Tidak perlu mendaftar dan mengisi formulir suram.  Beberapa server otorisasi menanyakan hak apa untuk memberikan situs yang meminta SSO. <br>  Namun ada juga kekurangannya.  <b>Anda bergantung pada penyedia SSO.</b>  Jika server SSO tidak berfungsi, Anda tidak akan sampai ke situs target.  Jika Anda kehilangan kata sandi atau akun Anda dicuri - Anda kehilangan akses dari semua situs sekaligus. <br>  Untuk pengembang web, masalahnya sedikit lebih rumit.  Dari awal, Anda perlu mendaftarkan situs Anda di server otorisasi, mendapatkan kunci, mempelajari cara bekerja dengan protokol ( <abbr title="Standar terbuka untuk pertukaran data autentikasi dan otorisasi antara penyedia akun dan penyedia layanan">SAML</abbr> , <abbr title="Protokol otorisasi terbuka yang memungkinkan menyediakan akses terbatas kepada pihak ketiga ke sumber daya yang dilindungi pengguna tanpa harus mentransfer login dan kata sandi ke pihak ketiga">OAuth</abbr> , dll.) Dan pustaka yang sesuai, pastikan bahwa kunci tidak kedaluwarsa, bahwa server otorisasi tidak memblokir situs Anda karena alasan dan dll.  Ini adalah biaya untuk fakta bahwa Anda tidak perlu menyimpan akun pengguna, melakukan formulir pendaftaran, login, dll.  Kebenaran meningkatkan biaya pemeliharaan (dalam bentuk perbaikan kegagalan mendadak).  Sekali lagi, jika server tiba-tiba tidak tersedia di situs, maka sayang sekali. <br>  Skema otorisasi ini membuat SSO sedikit lebih aman, dan otorisasi untuk semua peserta lebih mudah.  Tentang keamanan akan dibahas di bawah di bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Kompromi Kunci untuk SSO".</a> <br><br>  Lihat situs S, yang mendukung SSO Google.  Misalkan Anda memiliki akun Google.  Untuk masuk, Anda mengklik tautan "Masuk dengan Google", yang akan membuka tab otorisasi Google.  Peramban akan memberi tahu Anda bahwa Anda memiliki kunci untuk Google.  Dan Google akan memberi tahu Anda apa hak S. permintaan. <br>  Jika Anda setuju, klik "Masuk" di manajer kunci.  Halaman akan dimuat ulang.  Google sudah akan menerima token yang valid, mengenali dan mengotorisasi Anda.  Dan dengan permintaan antar-server, ia akan memberi tahu Situs S tentang informasi akun Anda sesuai dengan bidang yang diminta. <br>  Halaman yang dimuat ulang akan berisi tombol "Next" yang mengembalikan Anda ke situs target. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w5/u1/aa/w5u1aahv-_os9k2d81c819d5zhg.gif"></div><br><div class="spoiler">  <b class="spoiler_title">Dalam ilustrasi</b> <div class="spoiler_text">  Dia akan memberikan contoh algoritma ini saat mendaftar di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.youtube.com</a> menggunakan otorisasi lintas-domain melalui accounts.google.com. <br></div></div><br>  Situs S dapat memutuskan untuk menyimpan data tentang Anda di basis datanya atau tidak.  Masalah ini berada di luar cakupan skema otorisasi yang diusulkan.  Namun lebih lanjut, di mana kami akan mempertimbangkan risiko kehilangan kunci untuk SSO, situs ini direkomendasikan untuk menjaga token pengguna dan pengidentifikasi dari SSO di sisinya, dan pengguna disarankan untuk membuat kunci permanen untuk S. <br><blockquote>  <b>Kerentanan:</b> Setelah otorisasi tersebut, situs S1, S2, S3, ... (tempat Anda masuk melalui Google) akan dapat mengenali Anda (oleh pengenal yang ditugaskan kepada Anda oleh Google) dan, sebagai hasilnya, melacak aktivitas Anda. </blockquote><br><blockquote>  <b>Opsi perlindungan:</b> jangan bekerja secara bersamaan di situs jika Anda mendaftar melalui SSO dari penyedia yang sama.  Jika memungkinkan, logout dari server otorisasi segera setelah otorisasi selesai ("keluar otomatis" untuk domain). </blockquote><br><br><a name="how_make_sub_domain_identify"></a><h2>  1.10 Bagaimana cara menerapkan otentikasi lintas-domain? </h2><br>  Semua ini tentu saja bagus.  Sementara pekerjaan dilakukan pada satu browser - semuanya baik-baik saja.  Tetapi bagaimana dengan realitas modern ketika seseorang memiliki dua ponsel, satu komputer yang berfungsi dan beberapa browser di atasnya, komputer di rumah, dan laptop lain?  Ditambah tablet biasa untuk istri / anak-anak. <br>  Kita harus entah bagaimana menyelesaikan masalah mentransfer kunci domain antara browser, perangkat.  Dan juga menyelesaikan masalah sinkronisasi yang benar. <br>  Salah satu mekanisme untuk menyelesaikan masalah ini adalah menghitung berbagai kunci domain berdasarkan kunci master umum tanpa kemungkinan pemulihan kunci master dari kunci domain yang dikenal. <br>  Dengan membuat kunci pribadi K untuk domain D menggunakan kunci master M pada satu perangkat, pengguna akan dapat membuat kunci K yang sama untuk domain D dan pada kunci lainnya menggunakan kunci master M yang sama dan algoritma tunggal.  Lebih tepatnya, ini akan dilakukan bukan oleh pengguna, tetapi oleh browsernya.  Dengan pendekatan ini, cukup bagi pengguna untuk mendistribusikan kunci masternya di antara semua browser yang digunakan olehnya dan dia "mentransfer semua kunci" dari domain sekaligus.  Pada saat yang sama membuat cadangan dengan cara ini. <br>  Kenyamanan pengguna maksimal.  <b>Tetapi juga risiko maksimum</b> dalam kasus kompromi dari kunci utama.  Karena itu, yang terakhir harus dilindungi.  Risiko kehilangan atau kompromi dari kunci utama, dan cara untuk meminimalkan risiko tersebut dijelaskan dalam bab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"3 Rekomendasi Keselamatan"</a> . <br>  Menggunakan hanya satu kunci utama untuk menghasilkan semua kunci untuk semua domain tidak selalu merupakan pilihan yang nyaman.  Pertama, apa yang harus dilakukan jika tiba-tiba kunci domain dikompromikan dan perlu diubah?  Kedua, bagaimana jika Anda perlu membagikan kunci domain dengan orang lain?  Misalnya antar anggota keluarga.  Atau apakah itu akun akses surat publik perusahaan.  Lalu bagaimana cara "mengambil" kunci Anda (karena sebenarnya telah dikompromikan)? <br>  Oleh karena itu, pembuatan kunci domain individual menggunakan sensor angka acak biologis harus didukung oleh browser.  Tetapi kemudian kami kembali ke pertanyaan tentang mobilitas kami dan masalah sinkronisasi, fungsi mengekspor dan mengimpor kunci di browser, dan membuat salinan cadangan. <br><br><h3>  Transfer melalui perangkat yang dapat diasingkan secara fisik </h3><br>  Kartu pintar dan token usb bisa sangat cocok sebagai penyimpanan informasi kunci yang aman (karena dibuat untuk ini).  Otentikasi dua faktor melindungi kunci dari akses tidak sah dengan akses langsung ke perangkat. <br>  Benar, kartu pintar memerlukan pembaca khusus (belum lagi driver), yang membatasi penggunaannya hanya untuk workstation yang dilengkapi dengan pembaca tersebut. <br>  Dengan token USB sedikit lebih mudah.  Hanya driver yang diperlukan.  Tetapi Anda tidak dapat menempel token seperti itu di telepon.  Dan meskipun untuk ponsel ada token yang dibuat dalam bentuk kartu SD, tidak untuk mengatakan bahwa solusi ini menambah mobilitas.  Cobalah untuk menggambar kartu dari ponsel, tetapi masukkan ke kartu lain.  Dan bukannya ini tidak mungkin.  Masalahnya adalah itu tidak nyaman. <br>  Dan jika tokennya rusak?  Maka semua kunci Anda akan pergi ke Cthulhu Besar. <br>  Jadi akan ada godaan dengan skema seperti itu untuk menggunakan beberapa perangkat duplikat.  Tetapi kemudian Anda masih perlu menyelesaikan masalah sinkronisasi kunci jika Anda memiliki beberapa kartu pintar. <br>  Dan, sejujurnya, perangkat tersebut tidak dilindungi dari keyloggers.  Sekarang, jika kode pin akan dimasukkan dari kartu / token itu sendiri.  Lalu satu hal lagi.  Tetapi saya belum melihat sifat seperti itu. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/1g/js/gq1gjsgtxvfjjvs79syif5_u8_w.png"></div><br><blockquote>  <b>Pro:</b> kunci 256-bit acak dapat digunakan;  keamanan tinggi melalui penggunaan otentikasi dua faktor;  tingkat perlindungan tertinggi terhadap kerusakan langsung. <br>  <b>Cons:</b> ketergantungan perangkat;  membutuhkan biaya finansial;  mobilitas rendah;  kebutuhan untuk memesan kartu dan, sebagai hasilnya, menyinkronkan data di antara mereka;  kerentanan terhadap keylogger tetap ada. <br></blockquote><br><h3>  Sinkronkan melalui layanan online </h3><br>  "Teknologi cloud" sekarang didorong sedapat mungkin.  Tampaknya mereka, bersama dengan blockchain, telah menjadi pengganti "teknologi pisang."  Secara alami, ada keinginan untuk menggunakan platform Internet tertentu untuk pertukaran informasi utama.  Semacam kartu pintar "online". <br>  Apa?  Anda masuk menggunakan skema kami secara anonim di situs tersebut;  kirim kunci Anda yang dienkripsi dengan kata sandi di sana;  Anda pergi dari perangkat lain ke situs yang sama dengan kunci / kata sandi yang sama;  Anda mendapatkan kunci dari sana;  Anda menyinkronkan perubahan pada tanggal pengeditan.  Mirip dengan pengelola kata sandi, hanya ini yang online. <br>  Hanya saja, tidak ada yang menjamin bahwa layanan online tidak akan diretas atau tidak akan menggabungkan kunci Anda, meskipun dienkripsi, "jika perlu".  Siapa yang akan menerapkan layanan seperti itu secara gratis.  Itu dia. <br>  Meskipun, tentu saja, kata sandi melindungi kunci dari penggunaan langsung.  Tetapi apakah kata sandi Anda tahan terhadap kekerasan "offline"?  Itu pertanyaan lain. <br><blockquote>  <b>Kelebihan:</b> mobilitas kredensial tinggi;  independensi perangkat dan browser;  Anda hanya perlu satu kata sandi tunggal (walaupun mereka tidak meninggalkan kata sandi, itu sudah lebih baik). <br>  <b>Kekurangan:</b> kurang aman daripada menyimpan kunci pada media yang bisa diasingkan.  Bahkan, keamanan kunci didasarkan pada kekuatan kata sandi untuk pemilihan. <br></blockquote><br>  Anda tentu saja dapat menggunakan kunci utama untuk mengenkripsi kunci lain.  Yang dengannya kunci domain lainnya dihitung.  Sebagai pilihan. <br><br><a name="part2"></a><h1>  2 Deskripsi teknis protokol </h1><br><br><a name="perm_key_algo"></a><h2>  2.0 Algoritma Pembangkitan Kunci Domain </h2><br>  Protokol ini hanya mendefinisikan 2 metode untuk menghasilkan kunci domain. <br><br><ul><li>  berdasarkan generator angka acak (lebih disukai biologis) </li><li>  berdasarkan kunci master 256-bit </li></ul><br>  Dalam kasus terakhir, kunci domain dihitung sebagai: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/3aa/d39/ac7/3aad39ac79fc322d157a9f4c58a793f2.svg" alt="$ K = HMAC_ {M_ {key}} (Domain) $" data-tex="display"></p>  dimana <math></math><img src="https://habrastorage.org/getpro/habr/formulas/0b7/f4d/5a6/0b7f4d5a6dcc0d36804bd9dfc0ff9403.svg" alt="$ M_ {key} $" data-tex="inline">  - Kunci utama 256-bit, Domain - nama domain tempat kunci dibuat. <br>  Selanjutnya, <i>HMAC</i> adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">algoritma kriptografi hash</a> berdasarkan implementasi 256-bit dari fungsi hash <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SHA-2</a> . <br><blockquote>  Kompromi atau pengungkapan sukarela atas kunci domain tidak membahayakan kunci master asli. </blockquote><br>  Kunci master menyediakan mekanisme untuk mobilitas kredensial pengguna. <br><div class="spoiler">  <b class="spoiler_title">Catatan</b> <div class="spoiler_text">  Dalam versi awal protokol, opsi menghasilkan kunci domain berdasarkan kata sandi pengguna dianggap memastikan mobilitas pengguna dan melindungi terhadap kompromi kata sandi saat meretas situs.  Tetapi dalam bab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"3 Rekomendasi Keselamatan",</a> penjelasan akan diberikan mengapa diputuskan untuk menolak skema semacam itu. </div></div><br>  Jika kunci yang dibuat atas dasar "master" dikompromikan, atau token yang dihitung dari kunci tersebut (sebagai hasil peretasan situs) dikompromikan, maka kunci tersebut harus diubah.  Anda bisa mengubahnya menjadi kunci 256-bit acak, atau menghasilkannya dari "wizard" yang sama, dengan tambahan versi: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/eae/301/46b/eae30146bac887a402418464641e617e.svg" alt="$ K = HMAC_ {Mkey} (Versi Domain \ cup) $" data-tex="display"></p>  Selanjutnya, simbol <math></math><img src="https://habrastorage.org/getpro/habr/formulas/a47/285/a28/a47285a2828b9a69edf64fea3e240a0d.svg" alt="$ \ cup $" data-tex="inline">  akan digunakan untuk operasi penggabungan string (byte array). <br><br><a name="token_algo"></a><h2>  2.1 algoritma untuk menghitung token sumber </h2><br>  Token otentikasi pengguna dihitung dengan setiap permintaan sumber daya domain apa pun.  Untuk menghitung token permintaan, data berikut diambil: <br><br><ul><li>  <i>Pengirim</i> - nama domain pemrakarsa permintaan (bisa berupa halaman dengan iframe atau skrip dari domain orang lain yang melakukan pengambilan), </li><li>  <i>Penerima</i> - nama domain penerima (tempat permintaan dikirim), </li><li>  <i>Konteks</i> - permintaan konteks eksekusi, </li><li>  <i>Perlindungan</i> - urutan acak 32 byte (256-bit), jika Konteks kosong;  jika tidak, kosong </li></ul><br>  Data ini digabungkan dan di-hash dengan 256-bit SHA-2 <b>pada kunci K dari domain yang memulai permintaan</b> : <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8d1/bd1/cbc/8d1bd1cbc81815e0121976c9bb5e4ccc.svg" alt="$ K = HMAC_M (Pengirim \ piala Penerima \ piala \ piala Perlindungan) $" data-tex="display"></p><blockquote>  Token yang valid diperoleh saat Konteks tidak kosong.  Untuk identifikasi yang tepat di situs target, syarat Pengirim = Penerima = Konteks harus dipenuhi. </blockquote><br>  Bidang Konteks, bersama dengan Perlindungan, digunakan untuk melindungi terhadap serangan <abbr title="Skrip Lintas Situs - &quot;skrip lintas situs&quot;">XSS</abbr> dan <abbr title="Pemalsuan Permintaan Situs Lintas - &quot;pemalsuan permintaan lintas situs&quot;">CSRF</abbr> , serta dari pelacakan pengguna. <br>  Penjelasan lebih rinci tentang aturan untuk menentukan Pengirim / Penerima / Konteks akan diberikan di bawah ini. <br><br><a name="token_validation_algo"></a><h2>  2.2 Algoritma perlindungan token selama transfer </h2><br>  Token klien asli ditransmisikan sangat jarang.  Hanya ketika mentransfer token yang tidak terdaftar pada saat sesi dibuat. <br>  <b>Token dianggap tidak terdaftar</b> jika: dibuat berdasarkan kunci acak (tidak tetap);  tidak diterima oleh server setelah mengirim kunci Ubah Ke atau Permanen.  Untuk detail lebih lanjut lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">“Memproses token di server”</a> . <br>  Browser dan server bersama-sama menghasilkan sepasang angka acak, yang disebut  salt (Salt), dengan mana 128 bit lebih rendah dari token di-hash.  Keduanya bertukar angka-angka ini sesuai dengan protokol.  Untuk perinciannya, lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">“Browser Garap Prosedur Browser-Server”</a> . <br>  Dengan demikian, server situs melihat token berikut: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8ea/b59/cc3/8eab59cc3e5060cfec9956f984807b5f.svg" alt="$ T = Hai (T_s) \ cup HMAC_ {salt} (Lo (T_s)) $" data-tex="display"></p>  dimana <math></math><img src="https://habrastorage.org/getpro/habr/formulas/69c/826/a5b/69c826a5bc2d0953c3db1dbcc842a035.svg" alt="$ Hai (T_s) $" data-tex="inline">  - tinggi 128 bit, <math></math><img src="https://habrastorage.org/getpro/habr/formulas/73a/cbf/6b4/73acbf6b426b5d3dff599b4cba44ebfd.svg" alt="$ Lo (T_s) $" data-tex="inline">  - 128 bit lebih rendah dari token asli, <math></math><img src="https://habrastorage.org/getpro/habr/formulas/a47/285/a28/a47285a2828b9a69edf64fea3e240a0d.svg" alt="$ \ cup $" data-tex="inline">  - Rangkaian senar.  Dalam hal ini, token awal <math></math><img src="https://habrastorage.org/getpro/habr/formulas/c39/070/036/c39070036bed1c9b371606081981a5fb.svg" alt="$ T_s $" data-tex="inline">  seharusnya sudah diketahui ke server. <br><br>  Idealnya, CSI-Salt harus berubah setiap kali browser meminta server.  Namun, ini bisa menjadi persyaratan mahal dalam hal sumber daya komputasi.  Selain itu, dapat "membunuh" kemampuan untuk mengirim permintaan paralel ke server. <br>  Oleh karena itu, untuk mengoptimalkan perhitungan, diperbolehkan untuk menjaga nilai CSI-Salt tidak berubah dalam permintaan yang berbeda, <u>tetapi tidak lebih dari satu sesi</u> .  Ini bisa berupa batas waktu (perubahan CSI-Salt setiap 5 menit), atau reaksi terhadap intensitas permintaan (perubahan CSI-Salt setiap 100 permintaan), atau setelah setiap rangkaian permintaan (pada saat jeda, client-server), atau versi campuran.  Di sini keputusan diserahkan kepada pengembang browser. <br>  Menjaga agar CSI-Salt tidak berubah terlalu lama melemahkan perlindungan token yang ditransmisikan, memungkinkan penyerang untuk mencegat token sementara pengguna yang sah telah menyelesaikan Logout dan menjalankan permintaan tidak sah atas nama korban. <br><br><a name="salt_exchange_algo"></a><h2>  2.3 Prosedur pertukaran garam antara browser dan server </h2><br>  2.3.1 Token berdasarkan kunci server <sup>[1]</sup> acak atau tidak terdaftar. <br><div class="scrollable-table"><table><tbody><tr><th>  <b>Browser</b> </th><th>  <b>Server</b> </th></tr><tr><td colspan="2">  <b>Permintaan awal (inisialisasi sesi pengguna)</b> </td></tr><tr><td>  Browser mengirim token apa adanya. <br>  <b>Permintaan Anda tidak memiliki CSI-Salt.</b> <br></td><td>  Server pertama kali melihat token semacam itu. <br><div class="spoiler">  <b class="spoiler_title">omong-omong</b> <div class="spoiler_text">  Server mungkin bukan yang pertama melihat token seperti itu.  Dan browser dianggap tidak terdaftar.  Ini bisa terjadi <u>ketika Anda membuat ulang kunci berdasarkan kunci utama pada perangkat lain</u> .  Karena itu, situasi ini juga harus diperhitungkan. </div></div><br>  Anggap itu apa adanya (menganggapnya tidak terlindungi).  Menggunakan token ini sebagai pengidentifikasi sesi. <br>  Menghasilkan <i><sub>garam</sub> S</i> -nya. <br>  <b>Mengembalikannya dalam respons di tajuk CSI-Salt.</b> <br></td></tr><tr><td colspan="2">  <b>Permintaan kedua</b> </td></tr><tr><td>  Menghasilkan garam <i>dengan <sub>garam</sub></i> . <br>  Peramban menghubungkan <sup>[3]</sup> garam dan garam server. <br>  Browser mengirim permintaan, melewati token garam bersama. <br>  <b>Mengirim CSI-Salt.</b> <br></td><td>  Server menerima permintaan dan <b>mengambil klien CSI-Salt</b> . <br>  Server menghubungkan garam peramban dengan miliknya dan menggunakannya untuk memverifikasi token. <br><br>  Jika validasi token berhasil, itu menyediakan pengguna dengan konten sesuai dengan hak-haknya. <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br></td></tr><tr><td colspan="2">  <b>Permintaan Selanjutnya</b> </td></tr><tr><td>  Browser mengirim permintaan, melewati token garam bersama. <br>  <b>Permintaan Anda tidak memiliki CSI-Salt.</b> <br></td><td>  Server menerima permintaan dan memeriksa tokennya. <br><br>  Jika validasi token berhasil, itu menyediakan pengguna dengan konten sesuai dengan hak-haknya. <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br></td></tr><tr><td colspan="2">  <b>Setelah beberapa waktu <sup>[2]</sup></b> </td></tr><tr><td>  Menghasilkan garam <i>C</i> baru. <br>  Hubungkan garam baru ke garam server. <br>  Mengirim permintaan, melewati token yang dilindungi oleh garam sendi baru. <br>  <b>Mengirim CSI-Salt.</b> <br></td><td>  Server menerima permintaan dan <b>mengambil klien CSI-Salt yang baru</b> . <br>  Server menghubungkan garam peramban dengan miliknya dan menggunakannya untuk memverifikasi token. <br><br>  Jika validasi token berhasil, itu menyediakan pengguna dengan konten sesuai dengan hak-haknya. <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br></td></tr></tbody></table></div><br>  2.3.2 Token berdasarkan kunci yang didaftarkan oleh server <sup>[1]</sup> . <br><div class="scrollable-table"><table><tbody><tr><th>  <b>Browser</b> </th><th>  <b>Server</b> </th></tr><tr><td colspan="2">  <b>Permintaan awal (inisialisasi sesi pengguna)</b> </td></tr><tr><td>  Menghasilkan garam <i>dengan <sub>garam</sub></i> . <br>  <b>Mengirim CSI-Salt.</b> <br>  Mentransfer token dalam bentuk yang dilindungi. <br></td><td>  Server menerima permintaan dan <b>mengambil klien CSI-Salt</b> . <br>  Membaca token yang dilindungi. <br>  Menemukan token klien lengkap dalam database-nya (menggunakan token 128-bit pertama yang diterima dalam permintaan untuk mencari). <br>  Karena  ini adalah permintaan awal, server tidak mengirim garam ke klien, kemudian <b>validasi token pada tahap ini hanya dilakukan oleh garam klien</b> . <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br><br>  Jika validasi token berhasil, itu menyediakan pengguna dengan konten sesuai dengan hak-haknya. <br><br>  Menghasilkan <i><sub>garam</sub> S</i> -nya. <br>  <b>Mengembalikannya dalam respons di tajuk CSI-Salt</b> . <br></td></tr><tr><td colspan="2">  <b>Permintaan Selanjutnya</b> </td></tr><tr><td>  Browser menggabungkan garam dan garam server. <br>  Browser mengirim permintaan, melewati token garam bersama. <br>  <b>Permintaan Anda tidak memiliki CSI-Salt</b> . <br></td><td>  Server menerima permintaan dan memeriksa tokennya. <br><br>  Jika validasi token berhasil, itu menyediakan pengguna dengan konten sesuai dengan hak-haknya. <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br></td></tr><tr><td colspan="2">  <b>Setelah beberapa waktu <sup>[2]</sup></b> </td></tr><tr><td>  Menghasilkan garam <i>C</i> baru. <br>  Peramban menghubungkan garam baru ke garam server. <br>  Browser mengirimkan permintaan, melewati token yang dilindungi oleh garam bersama yang baru. <br>  <b>Mengirim CSI-Salt</b> . <br></td><td>  Server menerima permintaan dan <b>mengambil klien CSI-Salt yang baru</b> . <br>  Server menghubungkan garam peramban dengan miliknya dan menggunakannya untuk memverifikasi token. <br><br>  Jika validasi token berhasil, ia menyediakan konten kepada pengguna sesuai dengan haknya. <br><br>  Pada kesalahan verifikasi, kembalikan header <b>CSI-Token-Action: tidak valid</b> ke klien.  Kembalikan konten atau kembalikan respons kosong: bergantung pada server. <br></td></tr></tbody></table></div><hr>  <sup>[1] Token dianggap tidak terdaftar jika: dibuat berdasarkan kunci acak;</sup>  <sup>tidak diterima oleh server setelah mengirim kunci Ubah-Ke atau Permanen dengan CSI-Token-Action: respons sukses.</sup> <sup><br></sup>  <sup>[2] Waktu melalui perubahan CSI-Salt ditentukan oleh peramban itu sendiri.</sup>  <sup>Ini dapat terjadi setelah serangkaian permintaan, setelah batas waktu, setelah sejumlah permintaan.</sup> <sup>  – <b>     CSI-Salt    </b> . <br> [3]     16-  128- .     ,   : <i> <sub>salt</sub></i> || <i>S <sub>salt</sub></i> .       –     ,    .      ,    ,    .</sup> <br><br><a name="context_rules"></a><h2> 2.4    Context </h2><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text">      .   ,  -  .            . <br>       ,   .      ,     . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan memanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> satu domain, yang kita memuat halaman (ditampilkan di address bar browser Anda). Domain yang tersisa akan disebut </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eksternal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bahkan jika ini adalah domain anak yang diberikan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menyebut sumber daya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eksternal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika itu diunduh dari domain eksternal. Kami akan memanggil sumber daya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">internal</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika itu diunduh dari domain kami. Sumber daya dapat berupa skrip, gambar, permintaan ajax dan file lainnya.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebuah skrip dianggap eksternal jika diunduh dari domain eksternal. Script yang ditempatkan di tag &lt;script&gt; yang dibuat, dibuat oleh skrip eksternal, juga akan dianggap eksternal. Skrip yang terletak di tag &lt;script&gt; yang dimodifikasi dinyatakan eksternal jika dimodifikasi oleh skrip eksternal, atau skrip eksternal ada di rantai panggilan saat isinya berubah. Bahkan jika pada saat yang sama &lt;script&gt; ini pada awalnya di halaman atau dibuat oleh skrip internal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan memberi nama LINK, SCRIPT, IMG, tag IFAME, dan lainnya, yang mengharuskan browser memuat beberapa sumber daya segera setelah dipenuhi oleh </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tag</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parser - </font><i><font style="vertical-align: inherit;">sumber daya</font></i><font style="vertical-align: inherit;"> DOM </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan memberi nama tag FORMULIR, A, META, dan lainnya, yang dapat memulai pemuatan halaman dalam kondisi tertentu (kirim, klik,batas waktu) - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memulai tag</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan memanggil tag </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">statis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika awalnya ada pada halaman ketika pertama kali dikeluarkan oleh server. Kami akan memanggil tag </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dinamis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika </font><font style="vertical-align: inherit;">tag </font><font style="vertical-align: inherit;">itu dibuat dalam proses menjalankan skrip. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tag FORMULIR dinyatakan dinamis, meskipun bukan hanya tag itu sendiri yang telah berubah, tetapi juga nilai-nilai semua bidang INPUT yang terkait dengan formulir ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami akan memanggil tag dinamis </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami sendiri</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> jika skrip yang membuatnya milik domain kami, dan rantai panggilan dari instruksi yang menghasilkan tag ini tidak memiliki fungsi milik skrip eksternal. Kalau tidak, kami menganggap tag dinamis seperti itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak tepat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemuatan halaman dipicu dengan memulai tag.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tag awal dapat diaktifkan secara langsung oleh pengguna, atau diaktifkan oleh skrip, dengan menjalankan perintah klik (untuk tautan), dan mengirimkan (untuk formulir), atau dengan skrip yang menghasilkan acara onclick / onsubmit yang sesuai. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, tag pengaktifan dapat diaktifkan oleh browser. </font><font style="vertical-align: inherit;">Contoh dari tag tersebut adalah META dengan parameter http-equiv = "refresh" content = "0". </font></font><br><br> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel P. Nilai konteks dalam berbagai kondisi pembukaan halaman</font></font></sup> <br><a name="context_table_P"></a><div class="scrollable-table"><table><tbody><tr><th colspan="3" rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Metode pembukaan </font></font></th><th colspan="4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siapa yang memicu pemuatan halaman? </font></font></th></tr><tr><th>  Pengguna </th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendiri. </font><font style="vertical-align: inherit;">Js</font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ext. </font><font style="vertical-align: inherit;">Js</font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> browser </font></font></th></tr><tr><td rowspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tag </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup> </td><td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Statis </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1. </font><font style="vertical-align: inherit;">Perujuk</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2. </font><font style="vertical-align: inherit;">Varian </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P3. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4. </font><font style="vertical-align: inherit;">Mewarisi</font></font></td></tr><tr><td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dinamis </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Milik sendiri </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5. </font><font style="vertical-align: inherit;">Mewarisi</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6. </font><font style="vertical-align: inherit;">Varian </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P7 </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8. </font><font style="vertical-align: inherit;">Mewarisi</font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak benar </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P9. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PB. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PC. </font><font style="vertical-align: inherit;">Kosong</font></font></td></tr><tr><td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Secara langsung </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD </font><font style="vertical-align: inherit;">Domain</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE. </font><font style="vertical-align: inherit;">Varian </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup> </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pf. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG. </font><font style="vertical-align: inherit;">Varian </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup> </td></tr></tbody></table></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tabel yang sama, hanya gambar</font></font></b> <div class="spoiler_text">  <img src="https://habrastorage.org/webt/cq/l-/6e/cql-6eob6gouvsqsrdy5ltykhfg.gif" align="right"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika tag sumber daya diubah oleh skrip (misalnya, atribut SRC dari IMG), dan kemudian sumber daya dimuat secara otomatis oleh browser, maka kami percaya bahwa konten / sumber daya dipicu oleh parser, metode pemuatan adalah tag, tetapi status tag ini menjadi "dinamis". </font></font><br><br> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tabel R. Nilai konteks dalam kondisi berbeda untuk </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memuat konten / sumber daya</font></font></b></sup> <br><a name="context_table_R"></a><div class="scrollable-table"><table><tbody><tr><th colspan="3" rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Metode Pengunduhan </font></font></th><th colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Siapa yang menyebabkan unduhan konten? </font></font></th></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pengurai Dom </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendiri. </font><font style="vertical-align: inherit;">Js</font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ext. </font><font style="vertical-align: inherit;">Js</font></font></th></tr><tr><td rowspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tag </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup> </td><td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Statis </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1. </font><font style="vertical-align: inherit;">Halaman</font></font></td><td></td><td></td></tr><tr><td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dinamis </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Milik sendiri </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4. </font><font style="vertical-align: inherit;">Halaman</font></font></td><td></td><td></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak benar </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R7. </font><font style="vertical-align: inherit;">Kosong</font></font></td><td></td><td></td></tr><tr><td colspan="3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Secara langsung </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RA. </font><font style="vertical-align: inherit;">Perujuk</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BPR. </font><font style="vertical-align: inherit;">Halaman</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC </font><font style="vertical-align: inherit;">Perujuk</font></font></td></tr></tbody></table></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tabel yang sama, hanya gambar</font></font></b> <div class="spoiler_text">  <img src="https://habrastorage.org/webt/dl/zi/mn/dlzimnup-7etmrsysxzlxjw1zd8.gif" align="right"></div></div><br><hr> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1] Tag awal </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2] Tag sumber daya </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3] Mewarisi halaman sendiri, Kosong saat membuka halaman domain asing </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[4] Mewarisi saat mengarahkan server ke halaman mereka, Kosong saat mengarahkan ulang ke domain lain atau membuka halaman dari sumber eksternal (lihat ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">klarifikasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></sup> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Singkatan</font></font></b> <div class="spoiler_text"> <b>Referrer</b> –     Referrer. <br> <b>Page</b> –   (Tab)      . <br> <b>Empty</b> –  . <br> <b>Domain</b> –  Context     <br> <b>Inherit</b> –  Context     <br> <b>Variant</b> –  Context    «-»   <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tanda bentuk P1..PF, R1..RC akan digunakan untuk merujuk ke sel yang sesuai dalam tabel saat menganalisis situasi tertentu. </font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perhatikan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Referer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Domain yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disorot </font><font style="vertical-align: inherit;">di tabel pertama. </font><font style="vertical-align: inherit;">Anda hanya dapat diotorisasi di situs ketika Anda sendiri membuka situs di alamat langsung, atau dengan tautan dari situs lain, dengan memuat ulang halaman berikutnya atas inisiatif Anda sendiri.</font></font></blockquote><br><br><a name="sender_recipient_rules"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.5 Aturan untuk mendefinisikan bidang Pengirim dan Penerima </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengirim adalah domain dari halaman / skrip / gaya dari mana permintaan itu berasal. </font><font style="vertical-align: inherit;">Halaman ini meminta gaya, gambar, skrip. </font><font style="vertical-align: inherit;">Script meminta konten melalui ajax. </font><font style="vertical-align: inherit;">Gaya dapat memuat gaya lain. </font><font style="vertical-align: inherit;">Ini adalah pemrakarsa permintaan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penerima adalah domain yang benar-benar dituju. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agar tidak ada pertanyaan yang tersisa, mari kita perhatikan contoh-contoh spesifik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biarkan ada situs site.net. </font><font style="vertical-align: inherit;">Di halaman utama situs adalah:</font></font><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> style site.net/css/common.css </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gaya common.css mengimpor fonts.google.com/fonts/Roboto.css gaya </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gaya Roboto.css mengimpor font fonts.google.com/fonts/Roboto.ttf </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gambar mengarah ke img.site.net/picture1.jpg </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bingkai dimuat dari adriver.ru/frame </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> skrip dari adm.site.net/admin.js </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Biarkan dalam bingkai (dengan adriver.ru) terhubung: </font></font><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gaya dari adriver.ru/style.css </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gambar dari img.adriver.ru/img/01.png </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> skrip dari adriver.ru/libs.js </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> skrip dari api.adriver.ru/v1/ad.js </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nilai pengirim / penerima saat memuat sumber daya dengan parser DOM </font></font><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sumber Daya yang Dapat Diunduh </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nilai Pengirim </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nilai Penerima </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site.net/css/common.css </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonts.google.com/fonts/Roboto.css </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonts.google.com </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonts.google.com/fonts/Roboto.ttf </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonts.google.com </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fonts.google.com </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> img.site.net/picture1.jpg </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> img.site.net </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru/frame </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adm.site.net/admin.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adm.site.net </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru/style.css </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> img.adriver.ru/img/01.png </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> img.adriver.ru </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru/libs.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.adriver.ru/v1/ad.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.adriver.ru </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang, mari kita lihat nilai Pengirim / Penerima ketika memuat konten dengan skrip selama eksekusi permintaan ajax. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai pengirim / penerima saat memuat konten dengan skrip</font></font><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Skrip yang dapat dieksekusi </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kemana perginya permintaan? </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pengirim </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Penerima </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adm.site.net/admin.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site.net/api/ </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adm.site.net </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> situs.net </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru/libs.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru/api/ </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adriver.ru </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.adriver.ru/v1/ad.js </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.2gis.ru / ... </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.adriver.ru </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> api.2gis.ru </font></font></td></tr></tbody></table></div><br><br><a name="context_tables_comments"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.6 Rincian tentang Tabel Definisi Konteks </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita pertimbangkan secara lebih rinci opsi apa untuk membuka halaman (tab di browser) yang kita miliki, dan nilai Konteks apa yang akan diperoleh. </font></font><br><br><a name="P1"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pengguna di halaman sebelumnya mengklik tautan atau klik tombol kirim pada formulir. Handler browser peristiwa standar untuk tautan / formulir mengarahkan pengguna ke halaman ini. Situasi normal Transisi aman antara halaman domain atau domain berbeda. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat beralih ke site.net dari domain google.com lain, Konteks akan sama dengan domain sebelumnya (google.com). Dan pengguna di domain site.net baru akan tidak sah (bahkan jika tab tetangga situs ini di mana pengguna diotorisasi terbuka). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Transisi independen berulang dari pengguna (tanpa bantuan skrip) melalui tautan ke situs yang sama akan mengarah lagi ke situasi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tetapi Konteks sudah akan sama dengan domain site.net, karena menurut aturan Konteks = Pengarah. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itu dibuat untuk melindungi</font></font><abbr title="Pemalsuan Permintaan Situs Lintas - &quot;pemalsuan permintaan lintas situs&quot;"><font style="vertical-align: inherit;"></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serangan </font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;">CSRF</font></abbr><font style="vertical-align: inherit;"> .</font></font><br><br><a name="P5"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pengguna pada halaman sebelumnya mengklik tautan yang dibuat / dimodifikasi oleh skrip yang diunduh dari domain halaman sebelumnya; </font><font style="vertical-align: inherit;">atau pengguna pada halaman sebelumnya mengklik tombol kirim dari formulir yang dibuat / dimodifikasi oleh skrip (mengubah tag FORMULIR, termasuk bidang INPUT-nya). </font><font style="vertical-align: inherit;">Handler browser peristiwa standar untuk tautan / formulir mengarahkan pengguna ke halaman ini.</font></font><br><br><a name="P9"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P5</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya skrip yang eksternal, atau ada fungsi dari skrip eksternal di rantai panggilan (perlindungan dari pengeditan fungsi skrip skrip situs oleh skrip pihak ketiga).</font></font><br><br><a name="PD"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pengguna membuka halaman di alamat langsung. </font><font style="vertical-align: inherit;">Pembukaan yang aman.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengguna harus membuka halaman dengan memasukkan URL di bilah alamat. </font><font style="vertical-align: inherit;">Atau buka situs dari bookmark browser.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membuka tautan dari pintasan desktop dari program lain, situasi lain di mana OS mengirimkan perintah ke browser untuk membuka tautan harus dianggap sebagai kasus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (membuka tautan atas prakarsa browser). Bahkan jika pengguna menekan F5 untuk memuat ulang halaman, ini harus dianggap sebagai kasus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hanya jika pengguna masuk ke bilah alamat dan menekan Enter akan dianggap oleh browser sebagai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini dilakukan untuk melindungi serangan CSRF dari program lain.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengikuti tautan dari program lain akan mengarahkan pengguna ke situs yang diserang dengan token yang tidak valid dan Konteks kosong, yang akan disimpan bahkan jika pengguna menekan F5 (menyegarkan halaman). Anda tidak dapat login hingga pengguna membuka tautan apa pun ke halaman situs (situasi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan demikian, jika seorang penyerang dari program lain memutuskan untuk memberikan tautan ke halaman situs site.net yang menjalankan perintah kepada pengguna yang berwenang, ia tidak akan dapat melakukannya dengan mudah. Penting untuk memaksa pengguna mengklik tautan lain pada halaman ini, lalu memaksa pengguna untuk mengautentikasi di sana, dan hanya setelah itu ... Kemudian, pengguna kemungkinan besar akan berada di halaman lain dari site.net.</font></font><br><br><a name="P2"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pada halaman sebelumnya untuk tautan atau formulir yang semula ditempatkan pada halaman tersebut, naskah asli halaman sebelumnya menghasilkan klik / ajukan acara. </font><font style="vertical-align: inherit;">Tidak ada fungsi dalam rantai panggilan milik skrip eksternal. </font><font style="vertical-align: inherit;">Browser mengarahkan pengguna ke halaman ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika halaman baru milik domain yang sama, Konteks diwarisi dari halaman sebelumnya. </font><font style="vertical-align: inherit;">Jika halaman baru milik domain asing, Konteks akan kosong.</font></font><br><br><a name="P6"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya tautan / formulir yang dibuat / dimodifikasi oleh skripnya sendiri.</font></font><br><br><a name="PA"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya tautan / formulir yang dibuat / dimodifikasi oleh skrip eksternal.</font></font><br><br><a name="PE"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - skrip pada halaman sebelumnya memicu pembukaan halaman ini dengan command window.location.href atau window.open (...). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika skrip halaman site.net mengarahkan pengguna ke halaman domain yang sama, bidang Konteks akan diwarisi dari halaman pembuatan. Dalam hal ini, Konteks = site.net. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika halaman ya.ru dibuka, dan skrip memindahkan kami ke maps.ya.ru, maka Konteks halaman baru akan kosong. Dalam tindakan selanjutnya dari pengguna, Konteks akan hampir selalu tetap kosong, yang akan menyulitkan otorisasi pengguna di situs. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokol menyiratkan bahwa membuka satu situs dari yang lain adalah operasi yang tidak aman. Ini melindungi pengguna dari pelacakan tidak sah oleh situs-situs ini dan dari serangan CSRF.</font></font><br><br><a name="P3"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mirip dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya acara klik / kirim yang dipicu oleh skrip eksternal. </font><font style="vertical-align: inherit;">Konteks menjadi kosong (urutan byte acak dikirim sebagai gantinya), yang melindungi situs pihak ketiga dari pelacakan situs (jaringan spanduk).</font></font><br><br><a name="P7"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mirip dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya tautan / formulir yang dibuat / dimodifikasi oleh skrip eksternal.</font></font><br><br><a name="PB"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mirip dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya tautan / formulir yang dibuat / dimodifikasi oleh skrip eksternal.</font></font><br><br><a name="PF"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mirip dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya skrip provokatif yang eksternal.</font></font><br><br><a name="P4"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - browser memuat ulang halaman sebagai hasil dari pemrosesan tag &lt;META&gt;. </font><font style="vertical-align: inherit;">Tag awalnya pada halaman. </font><font style="vertical-align: inherit;">Arahan ulang hukum. </font><font style="vertical-align: inherit;">Konteks akan bertahan dari halaman asli. </font><font style="vertical-align: inherit;">Seperti halnya dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="P8"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - browser memuat ulang halaman sebagai hasil dari pemrosesan tag &lt;META&gt;. </font><font style="vertical-align: inherit;">Tetapi tag itu dibuat / dimodifikasi oleh skripnya sendiri. </font><font style="vertical-align: inherit;">Ini valid, tetapi Konteks akan tetap ada dari halaman asli. </font><font style="vertical-align: inherit;">Seperti halnya dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Tidak mungkin untuk memikat token hukum pengguna dengan cara ini.</font></font><br><br><a name="PC"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - mirip dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hanya skrip eksternal. </font><font style="vertical-align: inherit;">Situs yang dibuka akan menerima nomor acak sebagai Konteks.</font></font><br><br><a name="PG"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - browser membuka tautan saat perintah dari OS. </font><font style="vertical-align: inherit;">Bisa jadi, Anda mengklik tautan dari program lain, membuka pintasan di desktop. </font><font style="vertical-align: inherit;">Ini mungkin perintah dari program lain, tanpa sepengetahuan Anda. </font><font style="vertical-align: inherit;">Dalam kasus ini, sumber tidak dipercaya, dan bidang konteks akan tetap kosong selama manipulasi pengguna apa pun. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini dilakukan untuk melindungi serangan CSRF dari program lain.</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jika browser itu sendiri membuka tab yang disimpan sebelumnya, maka Konteks halaman diatur sama dengan nilai halaman ini pada saat menutup browser. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, kategori ini mencakup semua situasi di mana browser diarahkan oleh server ke halaman lain (dari domainnya atau milik orang lain) sebagai hasil dari pemrosesan header HTTP Header. </font><font style="vertical-align: inherit;">Jika pengalihan pergi ke halaman Anda sendiri, maka nilai Konteks diwarisi. </font><font style="vertical-align: inherit;">Jika pengalihan pergi ke orang lain, itu diatur ulang. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini dilakukan untuk melindungi dari serangan pelacakan server web.</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omong-omong, aturan seperti itu dapat menyebabkan masalah dengan implementasi otorisasi lintas domain saat ini. </font><font style="vertical-align: inherit;">Jika setelah otorisasi, server SSO mengarahkan pengguna kembali ke situs target, yang terakhir akan anonim di sana.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mencegah pengguna dari "kehilangan" otorisasi asli di situs target, perlu untuk mengirimkan informasi otentikasi antara permintaan server. </font><font style="vertical-align: inherit;">Algoritme dapat sebagai berikut:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengguna membuat dan mengaktifkan kunci permanen untuk situs target; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pergi dari situs target ke server SSO sendiri dengan mengklik tautan yang sesuai; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengaktifkan kunci permanen yang ada dari server SSO; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Setelah menerima kunci Changed-To, server SSO mengirimkan permintaan antar-server ke situs target; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengguna mengklik tombol "Lanjutkan" pada halaman otorisasi, yang mengembalikannya kembali ke situs target; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk memenuhi aturan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , situs target menawarkan pengguna untuk mengklik tombol tautan lagi, mengarah ke sana (misalnya, ke halaman awal peserta yang diotorisasi).</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengguna mengklik tombol tautan, halaman memuat ulang, dan pengguna sudah diotorisasi di situs target. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi algoritma sebenarnya terlihat lebih rumit daripada implementasinya. </font><font style="vertical-align: inherit;">Implementasi UI mungkin terlihat seperti ini:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/w5/u1/aa/w5u1aahv-_os9k2d81c819d5zhg.gif"></div><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memasukkan kembali situs target tidak lagi memerlukan otorisasi SSO dari pengguna. </font><font style="vertical-align: inherit;">Cukup mengaktifkan kunci permanen.</font></font></blockquote><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang mari kita melihat lebih dekat pada opsi untuk memuat konten pada halaman, dan apa nilai Konteks akan diperoleh berdasarkan permintaan. </font></font><br><br><a name="R1"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - sumber daya dimuat oleh browser sebagai hasil penguraian halaman (browser bertemu dengan tag sumber daya). </font><font style="vertical-align: inherit;">Nilai Konteks saat membuat permintaan untuk sumber daya diambil dari halaman Konteks yang berisi tag sumber daya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalnya, jika site.net memiliki bingkai adriver.ru di mana gambar dari img.disk.com dimuat, maka ketika membuat permintaan HTTP ke img.disk.com, browser mengambil nilai yang dihitung sebagai Konteks untuk halaman situs.net</font></font><br><br><a name="R4"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hanya tag sumber daya yang dibuat / dimodifikasi oleh skripnya sendiri, sebagai hasilnya browser DOM Parser berfungsi. Misalnya, pada halaman site.net/index.html, skrip site.net/require.js kami sendiri memasukkan skrip khusus (&lt;script src = ...&gt; tag) site.net/min.js, yang memaksa browser untuk membuat permintaan pengunduhan file. main.js. Bidang konteks dalam permintaan ini akan ditetapkan ke nilai yang dihitung untuk halaman site.net.</font></font><br><br><a name="R7"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R7</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sama dengan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tetapi karena tag sumber daya dibuat / dimodifikasi oleh skrip eksternal, ketika sumber daya diminta, browser akan menghasilkan token berdasarkan Konteks kosong dan urutan 256-bit acak. Akibatnya, skrip eksternal penyerang evil.com/drop.js, disematkan pada halaman domain site.net yang diserang, mencoba memenuhi permintaan ke target site.net atas nama korban akan gagal, karena server akan menerima permintaan dengan token acak dan tidak akan dapat mengidentifikasi pengirim permintaan.</font></font><br><br><a name="RA"></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RA</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - parser mengunduh konten sebagai hasil analisis konten lainnya. Misalnya, stylesheet site.net/css/common.css, yang diunduh untuk halaman site.net/index.html, mengimpor stylesheet fonts.google.com/fonts/Roboto.css, yang memaksa browser untuk meminta fonts.google .com atas nama Referrer = site.net/css/common.css. Nilai konteks dalam hal ini akan sama dengan Pengarah. Selanjutnya, file gaya Roboto.css mengimpor font Roboto.ttf, yang memaksa browser untuk meminta fonts.google.com/fonts/Roboto.ttf atas nama Referrer = fonts.google.com/fonts/Roboto.css. Nilai Konteks akan sama dengan Referrer dalam hal ini, tetapi berbeda. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalkan, secara hipotesis, file Roboto.css (sumber daya eksternal) tidak mengimpor font / gaya, tetapi mencoba melakukan serangan CSRF dengan instruksi ini:</font></font><pre><code class="css">@import "https://site.net/api/payment?victim_params"</code> </pre>  berharap untuk memenuhi permintaan di site.net atas nama pengguna yang berwenang.  Tetapi masalah bagi penyerang adalah bahwa site.net mengharapkan untuk menerima token dari pengguna: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/18c/ba0/6d3/18cba06d3ab48142219dbf3e3f4e2330.svg" alt="$ T_s ^ 1 = HMAC_k (site.net \ cup site.net \ cup site.net) $" data-tex="display"></p><br>  Kemudian, seperti halnya permintaan CSRF, browser akan membuat token: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/466/929/b86/466929b86ade0b848996042a3ac12f25.svg" alt="$ T_s ^ 2 = HMAC_k (fonts.google.com \ cup site.net \ cup fonts.google.com) $" data-tex="display"></p><br>  Dan permintaan ke situs akan datang atas nama situs anonim yang tidak memiliki hak akses untuk melakukan operasi ini. <br><br><a name="RB"></a>  <b>RB</b> - konten diunggah oleh skrip situs itu sendiri.  Dalam hal ini, Konteks digunakan untuk menghitung token permintaan, yang sama dengan halaman yang berisi skrip.  Untuk skrip site.net/1.js dari halaman Konteks site.net, itu akan sama dengan Konteks halaman itu sendiri. <br><blockquote>  Perhatikan bahwa Konteks halaman itu sendiri tidak selalu sama dengan nama domain halaman dan tergantung pada bagaimana awalnya dibuka. </blockquote>  Misalkan situs penyerang evil.com membuka halaman situs diserang site.net, di mana script site.net/util.js mengeksekusi permintaan dengan parameter yang melewati URL halaman.  Penyerang berharap, dengan menyelipkan "parameternya" melalui URL, untuk memaksa skrip site.net/util.js sendiri untuk mengeksekusi permintaan ajax untuk melakukan tindakan penting atas nama korban. <br><br>  Misalkan pengguna sendiri pergi ke evil.com melalui tautan langsung.  Maka Konteks untuk evil.com akan menjadi evil.com.  Lebih lanjut evil.com membuka skrip site.net/api/payment?victim_params dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">skrip</a> , berharap melakukan serangan, tetapi bidang Konteks untuk site.net akan kosong (kasus PE / PF).  Skrip site.net/utils.js, yang mengeksekusi permintaan ajax, akan memaksa browser untuk mengambil Context dari halaman site.net.  Dan itu kosong bersama kita.  Tetapi kemudian site.net akan menerima permintaan ajax dengan token ini: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/866/a41/990/866a41990a710d17dbe34a04ecb2e28c.svg" alt="$ T = HMAC_ {site.ru-key} (site.net \ cup site.net \ cup random) $" data-tex="display"></p><br>  sedangkan untuk pengguna yang berwenang diharapkan: <br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/025/1b3/fad/0251b3fadaf0e4f1535b6aa8a67df332.svg" alt="$ T_s = HMAC_ {site.ru-key} (site.net \ cup site.net \ cup site.net) $" data-tex="display"></p><br>  site.net akan melihat token yang tidak dikenal dan tidak akan dapat mengidentifikasi pengguna.  Perlindungan berhasil. <br><blockquote>  Omong-omong, karena skema semacam itu, melakukan otorisasi lintas-domain melalui pop-up akan menjadi tidak realistis. </blockquote>  Untuk menerapkan SSO di bawah protokol, Anda harus membuka tab baru untuk halaman server otorisasi.  Dan pada saat yang sama, pengguna harus membuka tab semacam itu.  Opsi terbaik adalah membuka tautan yang sesuai kepada pengguna dari situs target. <br><br><a name="RC"></a>  Konten <b>RC</b> dimuat dengan skrip situs web eksternal.  Dalam hal ini, Konteks digunakan untuk menghitung token permintaan, yang sama dengan bidang Perujuk Permintaan. <br><br>  Terlepas dari kenyataan bahwa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RA</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RB</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RC</a> melindungi terhadap serangan CSRF, mereka tetap mengarah pada generasi token konstan.  Dan <b>ini memungkinkan Anda untuk menerapkan otentikasi lintas-domain</b> dan <b>otentikasi</b> pengguna <b>lintas-domain</b> (ketika Anda perlu menentukan bahwa beberapa permintaan ke server berbeda berasal dari pengguna ini).  Apa yang bisa diimplementasikan untuk memberinya otoritas yang setara pada sekelompok domain terkait. <br><br>  Jika <b>halaman situs dibuka secara otomatis</b> dari situs lain, Anda tidak akan dapat masuk ke sana, bahkan jika Anda memuat ulang situs ini sendiri.  Karena Sumber akan mewarisi dari nilai nol.  Peramban harus memberi sinyal kepada pengguna tentang fakta ini (Sumber = Acak): <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1h/pr/ew/1hprewdwumpuwpzmzkqfmbds104.jpeg"></div><br>  Hal ini dilakukan untuk melindungi situs yang memaksa jendela sembul lainnya dibuka (sendiri atau skrip eksternal mereka), dan di situs yang terbuka, mereka akan mem-boot ulang atau membuat tombol "tutup" palsu di seluruh layar yang mengarah ke situs yang sama.  Yaitu  ini mencegah upaya melacak Anda, berharap mendapatkan token yang valid. <br><br>  <b>Setiap upaya oleh situs untuk meniru tindakan Anda dengan skrip eksternal</b> , atau upaya oleh skrip eksternal untuk secara langsung atau tidak langsung membuat tag awal dan menyelipkannya kepada Anda, akan mengarah ke Sumber kosong dan penambahan byte acak pada saat menghitung hash token. <br><br>  Trik dengan membuat atau memodifikasi tag &lt;script&gt; di halaman yang diserang di DOM tidak akan membantu.  Bidang Sumber akan tetap kosong. <br><br>  Tetapi dalam kondisi yang sama, skrip internal akan mengarah ke kueri dengan Sumber sama dengan nilai sebelumnya.  Dan jika halaman asli memiliki Source = Domain, semuanya akan baik-baik saja.  Pengguna akan tetap diizinkan untuk permintaan tersebut. <br><br>  Tetapi dengan skrip yang diunduh dari sumber pihak ketiga (CDN), masalah mungkin muncul dalam beberapa kasus.  Dan itu benar, karena  Integritas kode CDN tidak dijamin.  Jika Anda ingin tidak kehilangan otorisasi pengguna, simpan skrip di situs Anda dan unduh dari domain Anda.  Ini seperti larangan menggunakan tautan http di laman https. <br><br>  Kami menggambarkan situasi yang mungkin menyebabkan pengembang jatuh.  Sebagai hasil dari tindakan pengguna, skrip Anda mengarahkan pengguna yang sah ke salah satu halaman situs (misalnya, ini dilakukan dengan formulir), yang mengharuskan pengguna tetap berwenang.  Skrip Anda memanggil, misalnya, $ (form) .submit () menggunakan skrip jQuery yang diambil dari CDN.  Dalam hal ini, browser melihat bahwa di tumpukan panggilan yang memicu acara kirim formulir, ada fungsi dari skrip eksternal.  Untuk mencegah serangan <abbr title="Skrip Lintas Situs - &quot;skrip lintas situs&quot;">XSS</abbr> / <abbr title="Pemalsuan Permintaan Situs Lintas - &quot;pemalsuan permintaan lintas situs&quot;">CSRF</abbr> , browser membuat bidang Sumber kosong, dan menambahkan byte acak ke generasi token (kasus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">P9</a> ).  Akibatnya, pengguna pada halaman baru tiba-tiba menjadi tidak sah dan tidak dapat menyelesaikan operasi.  Ini bisa membingungkan bagi pengembang yang terbiasa menggunakan CDN. <br><br><a name="protocol_scenario"></a><h2>  2.7 Skenario Protokol </h2><br>  Berikut ini adalah skenario kemungkinan utama dari pengguna yang bekerja dengan situs ini, yang memengaruhi semua situasi yang mungkin terjadi dan tahapan implementasinya (login anonim, "ingat saya", "lupakan saya", beralih menggunakan kunci permanen, otorisasi dan keluar, registrasi dan otentikasi dua faktor, ekspor / impor kunci, penggantian kunci, dll.) <br><div class="scrollable-table"><table><tbody><tr><th colspan="3">  1 Forum, Blog, Wikipedia </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>  Server situs </th></tr><tr><td>  1.1 Akses pertama ke situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna. </td></tr><tr><td>  1.2 Lihat halaman. </td><td>  Mengirim token yang aman terhadap kunci acak. </td><td>  Menyediakan konten publik.  Periksa bit token 128-bit yang lebih rendah. </td></tr><tr><td>  1.3 Mencoba melakukan tindakan (tambahkan komentar, dll.) </td><td>  Mengirim token yang aman terhadap kunci acak. </td><td>  Memberitahu pengguna bahwa mereka perlu memperkenalkan diri ke sistem.  Pada tahap ini, situs yakin bahwa kuncinya adalah acak. </td></tr><tr><td>  1.4 Memberitahu browser untuk membuat situs mengingatnya. </td><td>  Memperbaiki kunci saat ini.  Mengirim kunci Permanen.  Token, seperti sebelumnya, ditransmisikan dalam bentuk yang dilindungi.  Mengirim kunci ini hingga menerima kesuksesan dari server. </td><td>  Sekarang situs tahu bahwa kuncinya sudah diperbaiki.  Mengirim CSI-Token-Action: sukses.  Itu dapat menerapkan teknik mengingat pengguna untuk waktu yang lama: baik itu menyimpan token dalam database untuk pemulihan sesi berikutnya dengan pengguna.  Atau tahan sesi untuk waktu yang lebih lama (simpan ke file). </td></tr><tr><td>  1.5 Melakukan tindakan (menambahkan posting, memberikan suara, dll.) </td><td>  Mengirim CSI-Token aman dari kunci tetap. </td><td>  Tindakan log dari pengguna ini. </td></tr><tr><td>  1.6 Menutup tab browser. </td><td>  Tidak ada </td><td>  Menunggu permintaan pengguna berikut. </td></tr><tr><td>  1.7 Kembali ke situs. </td><td>  Mengirim kunci tetap aman. </td><td>  Terus bekerja dengan pengguna.  Data sesi diambil dari database atau file sementara dengan token. </td></tr><tr><td>  1.8 Membatalkan perbaikan kunci (lupakan saya di situs ini) </td><td>  Mengirim Kunci Keluar </td><td>  Menghapus data pengguna dalam database, sebagai  itu adalah kunci tetap, dan pengguna tidak akan pernah dapat memulihkannya lagi.  Mengakhiri sesi.  Browser tidak akan pernah mengirim token seperti itu lagi. </td></tr><tr><td>  1.9 Ketika Anda pertama kali mengakses situs setelah Logout. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Situs ini sudah menjadi pengguna baru.  Kami menganggap pengguna anonim.  Kami menggunakan token sebagai pengidentifikasi sesi pengguna. </td></tr><tr><td>  1.10 Jelajahi halaman. </td><td>  Mengirim token yang aman terhadap kunci acak. </td><td>  Menyediakan konten publik.  Periksa bit token 128-bit yang lebih rendah. </td></tr><tr><td>  1.11 Menutup tab browser. </td><td>  Tidak ada </td><td>  Istirahat sesi setelah batas waktu. </td></tr><tr><td>  1.12 Kembali ke situs. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna. </td></tr><tr><td>  1.13 Membuat kunci situs permanen. </td><td>  Tidak ada </td></tr><tr><td>  1.14 Aktivasi kunci permanen. </td><td>  <b>Tanya pengguna: apakah Anda benar-benar ingin situs mengingat kunci Anda?</b>  <b>Pastikan situs ini adalah yang diklaimnya.</b> <br>  Mengirim Change-To.  Hanya pada saat ini browser memberikan token kepada yang tidak dilindungi.  Dalam semua waktu berikut, browser akan selalu mengirimkan token yang dilindungi saat login.  Tetapi untuk ini, situs harus mengkonfirmasi perubahan token melalui CSI-Token-Action: sukses. </td><td>  Ingat token pengguna baru dalam database.  Mengubah ID sesi.  Terus menunggu permintaan dari token baru.  Mengirim CSI-Token-Action: sukses. </td></tr><tr><td>  1.15 Melakukan tindakan (menambahkan posting, memberikan suara, dll.) </td><td>  Mengirim token aman dari kunci permanen </td><td>  Tindakan log dari pengguna ini.  Memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  1.16 Membuat "Keluar". </td><td>  Mengirim Kunci Keluar </td><td>  Hentikan sesi </td></tr><tr><td>  1.17 Kembali ke situs. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token sebagai pengidentifikasi sesi pengguna. </td></tr><tr><td>  1.18 Aktivasi kunci permanen. </td><td>  Mengirim Change-To.  Token sudah dilindungi, karena  terakhir kali situs menjawab kami CSI-Token-Action: sukses. </td><td>  Kami memuat data pengguna yang disimpan dari database.  Mengubah ID sesi.  Kami bekerja dengan token yang disimpan.  Kita tahu bahwa token didasarkan pada kunci permanen. </td></tr><tr><td>  1.19 Menutup tab browser. </td><td>  Tidak ada  Atau tombol Logout, jika "keluar otomatis" dikonfigurasikan ketika tab ditutup. </td><td>  Istirahat sesi setelah batas waktu, atau setelah menerima kunci Keluar. </td></tr><tr><th colspan="3">  2 Toko Online atau Situs Iklan </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>  Server situs </th></tr><tr><td>  2.1 Pertama kali dimasukkan di situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna. </td></tr><tr><td>  2.2 Lihat halaman. </td><td>  Mengirim token yang aman terhadap kunci acak. </td><td>  Menyediakan konten publik.  Periksa bit token 128-bit yang lebih rendah. </td></tr><tr><td>  2.3 Mencoba melakukan tindakan (menambahkan iklan, membeli, dll.) </td><td>  Mengirim token yang aman terhadap kunci acak. </td><td>  Memberitahu pengguna bahwa mereka perlu memperkenalkan diri ke sistem.  Pada tahap ini, situs yakin bahwa kuncinya adalah acak. </td></tr><tr><td>  2.4 Memberitahu browser untuk membuat situs mengingatnya. </td><td>  Memperbaiki kunci saat ini.  Sebelum permintaan pertama, ia mengirimkan CSI-Token aman dengan kunci Permanen.  Setelah menerima kesuksesan, itu berhenti mengirim kunci ini. </td><td>  Sekarang situs tahu bahwa kuncinya sudah diperbaiki.  Itu dapat menerapkan teknik mengingat pengguna untuk waktu yang lama: baik itu menyimpan token dalam database untuk pemulihan sesi berikutnya dengan pengguna.  Atau mengadakan sesi untuk waktu yang lebih lama (beberapa hari). </td></tr><tr><td>  2.5 Melakukan tindakan (menambahkan pengumuman, pembelian, dll.) </td><td>  Mengirim CSI-Token aman dari kunci tetap. </td><td>  Tindakan log dari pengguna ini.  Memeriksa token. </td></tr><tr><td>  2.6 Menutup tab browser. </td><td>  Tidak ada </td><td>  Tahan sesi.  Dengan ketidakaktifan yang berkepanjangan, ia menyimpan data sesi dari RAM ke file atau database. </td></tr><tr><td>  2.7 Masuk lagi ke situs. </td><td>  Mengirim kunci tetap aman. </td><td>  Sesi berlanjut.  Kami bekerja dengan pengguna, seolah-olah tidak ada yang terjadi. </td></tr><tr><td>  2.8 <b>Membuat atau mengimpor</b> kunci situs yang persisten. </td><td>  Tidak ada </td></tr><tr><td>  2.9 Aktivasi kunci permanen.  Di sini, pada kenyataannya, ada transisi dari menggunakan kunci tetap ke yang permanen. </td><td>  Mengirim kunci Change-To.  Token dikirimkan <b>tanpa perlindungan</b> untuk kunci yang baru dibuat dan token yang tidak terdaftar di server.  Token yang ditransfer <b>dilindungi</b> untuk kunci yang diimpor. </td><td>  2.9.A.  Token berdasarkan kunci baru. <br>  Jika token lama disimpan dalam database - cukup ubah token dalam database. <br><br>  2.9.V.  Token berdasarkan kunci yang diimpor. <br>  Jika token lama disimpan dalam database - hapus.  Ketika menggabungkan dua profil dari satu pengguna (apa yang dapat Anda tanyakan padanya) - karena  pada kenyataannya, pengguna memiliki dua token yang disimpan dalam database: dari kunci tetap dan dari yang diimpor.  Mengubah ID sesi.  Mengirim CSI-Token-Action: sukses.  Dia terus menunggu permintaan dari token baru. </td></tr><tr><td>  2.10 Melakukan tindakan (pembelian, posting iklan, keranjang belanja, favorit, ulasan, perbandingan) </td><td>  Mengirim token aman dari kunci permanen </td><td>  Tindakan log dari pengguna ini.  Memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  2.11 Menutup tab browser. </td><td>  Tidak ada  Atau tombol Logout, jika "keluar otomatis" dikonfigurasikan ketika tab ditutup. </td><td>  Istirahat sesi setelah batas waktu, atau setelah menerima kunci Keluar. </td></tr><tr><th colspan="3">  3 Situs dengan pra-registrasi wajib (jejaring sosial) </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>  Server situs </th></tr><tr><td>  3.1 Termasuk di situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna.  Kami hanya membiarkan di bagian publik.  Ketika Anda mencoba mengakses konten yang ditutup, kami menerjemahkannya ke dalam formulir otorisasi. </td></tr><tr><td>  3.2 Membuat kunci situs permanen </td><td>  Tidak ada </td></tr><tr><td>  3.3 Aktivasi kunci permanen. </td><td>  <b>Tanya pengguna: apakah Anda benar-benar ingin situs mengingat kunci Anda?</b>  <b>Pastikan situs ini adalah yang diklaimnya.</b> <br><br>  Mengirim Change-To. <br>  <b>Token ditransmisikan dalam clear</b> . </td><td>  Ingat token baru.  Kami tidak terburu-buru untuk menyimpan ke database sampai pendaftaran telah selesai.  Kami menyimpan pengguna di formulir "Pendaftaran" sampai konfirmasi kepemilikan (melalui telepon, surat) dibuat.  Mengirim CSI-Token-Action: pendaftaran </td></tr><tr><td>  3.4 Masukkan detail kontak Anda. </td><td>  Mengirim permintaan ajax.  Mengirim Change-To.  Token lama pada kunci acak yang sama. <br>  <b>Token baru sudah ditransfer dalam bentuk yang dilindungi</b> . <br><br>  Segera setelah ia menerima kesuksesan, ia mulai menggunakan token baru (kunci permanen). </td><td>  Periksa detail kontak.  Jika semuanya berhasil, ia mengirimkan CSI-Token-Action: sukses.  Kalau tidak: CSI-Token-Action: pendaftaran.  Jika CSI-Token-Action: batalkan dikirim, maka pendaftaran tidak berhasil.  Browser harus kembali menggunakan nomor acak (membatalkan input).  Dan laporkan ini ke pengguna. </td></tr><tr><td>  3.5 Pergi ke bagian situs yang tertutup </td><td>  Mengirim Token aman dari kunci permanen. </td><td>  Memberikan akses dengan memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  3.6 Melakukan tindakan (pembelian, posting iklan, keranjang belanja, favorit, ulasan, perbandingan) </td><td>  Mengirim Token aman dari kunci permanen. </td><td>  Tindakan log dari pengguna ini.  Memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  3.7 Menutup tab browser. </td><td>  Tidak ada  Atau tombol Logout, jika "keluar otomatis" dikonfigurasikan ketika tab ditutup. </td><td>  Istirahat sesi setelah batas waktu, atau setelah menerima kunci Keluar. </td></tr><tr><td>  3.8 Termasuk dalam situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna.  Kami hanya membiarkan di bagian publik.  Ketika kami mencoba mengakses konten tertutup, kami memberi tahu pengguna bahwa ia adalah pengguna anonim. </td></tr><tr><td>  3.9 Aktivasi kunci permanen. </td><td>  Mengirim Change-To.  Kedua token ditransmisikan dengan cara yang aman. </td><td>  Kami memuat data pengguna dari database dengan token (128-bit tertinggi).  Sekarang situs tahu siapa pengguna ini. </td></tr><tr><td>  3.10 Mengubah kunci permanen domain (menjadi permanen lainnya) </td><td>  <b>Tanya pengguna: apakah Anda benar-benar ingin situs mengingat kunci baru Anda?</b>  <b>Pastikan situs ini adalah yang diklaimnya.</b> <br><br>  Mengirim Change-To. <br>  <b>Token baru ditransfer secara jelas;</b>  <b>lama - dalam dilindungi</b> <br></td><td>  Mengubah token di database menjadi yang baru.  Memuat data profil.  Menggunakan token baru dari permintaan berikut.  Mengirim CSI-Token-Action: sukses </td></tr><tr><td>  3.11 Melakukan tindakan (menambahkan posting, memberikan suara, dll.) </td><td>  Mengirim token aman dari kunci baru </td><td>  Tindakan log dari pengguna ini.  Memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  3.12 Membuat "Keluar". </td><td>  Mengirim Kunci Keluar </td><td>  Hentikan sesi </td></tr><tr><td>  3.13 Termasuk di situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna.  Kami menerjemahkan ke formulir otorisasi. </td></tr><tr><td>  3.14 Mengaktifkan Kunci Permanen </td><td>  Mengirim Change-To.  Kedua token ditransmisikan dengan cara yang aman. </td><td>  Kami memuat data pengguna dari database dengan token (128-bit tertinggi). </td></tr><tr><td>  3.15 Mengimpor kunci yang berbeda untuk domain ini. <br>  <b>Penting: kunci yang diimpor harus terdaftar di server.</b> <br></td><td>  Mengirim kunci. Logout Beralih ke menggunakan kunci acak. </td><td>  Hentikan sesi </td></tr><tr><td>  3.16 Mengaktifkan kunci baru </td><td>  Mengirim Change-To. <br>  <b>Kedua token ditransmisikan dengan cara yang aman.</b> <br><br>  Harap dicatat bahwa kunci "sebelumnya" sudah merupakan kunci acak (lihat 3.15). </td><td>  Kunci ini harus diketahui oleh basis data.  <b>Ekspor utama</b> dari browser hanya diperbolehkan untuk token terdaftar.  Dengan demikian, browser yakin bahwa <b>kunci yang diimpor dikenal ke server</b> dan mengirimkannya dengan aman.  Kalau tidak, server tidak bisa mengenali token pengguna dan tidak bisa mengotorisasi itu. </td></tr><tr><td>  3.17 Melakukan tindakan (menambahkan posting, memberikan suara, dll.) </td><td>  Mengirim token aman dari kunci baru </td><td>  Tindakan log dari pengguna ini.  Memeriksa token 128-bit yang lebih rendah. </td></tr><tr><td>  3.18 keluar </td><td>  Mengirim Kunci Keluar </td><td>  Hentikan sesi </td></tr><tr><th colspan="3">  4 Situs dengan otorisasi dua faktor (Sberbank Online) </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>  Server situs </th></tr><tr><td>  4.1 Termasuk di situs ini. </td><td>  Menghasilkan kunci acak.  Mengirim token yang tidak aman dari kunci acak. </td><td>  Kami menganggap pengguna anonim.  Kami menggunakan token ini sebagai pengidentifikasi sesi pengguna.  Kami menerjemahkan ke formulir otorisasi. </td></tr><tr><td>  4.2 Membuat kunci situs permanen </td><td>  Tidak ada </td></tr><tr><td>  4.3 Aktivasi kunci permanen. </td><td>  <b>Tanya pengguna: apakah Anda benar-benar ingin situs mengingat kunci Anda?</b>  <b>Pastikan situs ini adalah yang diklaimnya.</b> <br><br>  Mengirim Change-To. <br>  <b>Token ditransmisikan dalam clear</b> . </td><td>  Token tidak dikenal ke situs.  Ingat token baru.     .  CSI-Token-Action: registration. </td></tr><tr><td> 4.4     .  «» </td><td>  Change-To      success.       . <br> <b>      .</b> <br></td><td>   .    . </td></tr><tr><td> 4.5      . </td><td>  ajax-.      Change-To. <br><br>    success,      ( ). </td><td>   .      ( ).  CSI-Token-Action: success <br>       . <br>    ,  CSI-Token-Action: registration. <br><br>      CSI-Token-Action: abort.    ,      . </td></tr><tr><td> 4.6    . </td><td>   Token    </td><td>        . </td></tr><tr><td> 4.7  «»   </td><td>   Logout </td><td>   </td></tr><tr><td> 4.8    . </td><td>   .      . </td><td>   .        .          «». </td></tr><tr><td> 4.9   . </td><td>  Change-To. <br> <b>    </b> (..   ;    ). </td><td>        ( 128-).  ,        .      ,   .    .   CSI-Token-Action: success </td></tr><tr><td> 4.10      . </td><td>  ajax-.         . </td><td>  .  .  .       . </td></tr><tr><td> 4.11    . </td><td>   Token   . </td><td>        . </td></tr><tr><td> 4.12  «»   </td><td>   Logout </td><td>   </td></tr><tr><td> 4.12     (). </td><td>    Logout,   «»   .  . </td><td>  ,     Logout.   . </td></tr><tr><th colspan="3"> 5  :   ESXi </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>   </th></tr><tr><td> 5.1    . </td><td>   .      . </td><td>   .        .   . </td></tr><tr><td> 5.2    . </td><td></td><td></td></tr><tr><td> 5.3     ( ,   ).  ,   <i></i> . </td><td></td><td></td></tr><tr><td> 5.4     (SSH, RDP).      (  .htaccess – .  ) </td><td></td><td></td></tr><tr><td> 5.5   </td><td>  </td><td>     </td></tr><tr><td> 5.6    . </td><td>   .      . </td><td>   .        .   . </td></tr><tr><td> 5.7   . </td><td>  Change-To. <br> <b>    </b> (..  ,         ;     <i></i> ). </td><td>        (. ). <br><br>     ( 128-). <br>    128-.     . <br>   CSI-Token-Action: success. <br>   CSI-Token-Action: abort (    ),   403 – Forbidden. <br>     . </td></tr><tr><td> 5.8    </td><td>      . </td><td>        . </td></tr><tr><td> 5.9   </td><td>    Logout,   «»   .  . </td><td>  ,     Logout.   . </td></tr><tr><th colspan="3"> 6  :   </th></tr><tr><th>  Pengguna </th><th>  Browser </th><th>   </th></tr><tr><td> 6.1    . </td><td>   .      . </td><td>   .        . <b>   .</b>   CSI-Support: yes; </td></tr><tr><td> 6.2   . </td><td></td><td></td></tr><tr><td> 6.3   . </td><td> <b> :   ,     ? ,     ,    .</b> <br><br>  Change-To. <br> <b>    </b> . </td><td>  ,   CSI-Token-Action: registration, ..   . </td></tr><tr><td> 6.4  /  « » </td><td>  / POST-  .      Change-To,    . </td><td>  /.    .    .  CSI-Token-Action: success </td></tr><tr><td> 6.5           «» </td><td>     Token    </td><td>    /.  . </td></tr><tr><td> 6.6  </td><td>   Logout </td><td>   </td></tr><tr><td> 6.7    . </td><td>   .      . </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mempertimbangkan pengguna anonim. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menampilkan pesan "Akses Ditolak"</font></font></b> <br></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.8 Aktivasi kunci permanen. </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengirim Change-To. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token ditransmisikan dalam bentuk yang dilindungi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (karena sudah diketahui perangkat; kami telah melewati pendaftaran sebelumnya).</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengidentifikasi pengguna dengan token 128-bit tertinggi. </font><font style="vertical-align: inherit;">Memeriksa bit rendah.</font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.9 Melakukan tindakan istimewa </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengirim token aman dari kunci permanen </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Melakukan tindakan sesuai dengan hak istimewa pengguna. </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6.10 Keluar </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengirim Kunci Keluar </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hentikan sesi </font></font></td></tr></tbody></table></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contoh konfigurasi akses token berdasarkan file .htaccess. </font></font><br><pre> <code class="apache">&lt;Directory "/var/www/html"&gt; AuthType CSI AuthName "Restricted Content" AuthTokensFile /etc/apache2/.csi_keys Require valid-user &lt;/Directory&gt;</code> </pre><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cat /etc/apache2/.csi_keys </font></font></pre><pre> <code class="bash"># # Client Self Identification tokens file # # CSI-Domain-Key UserName Role 84bc3da1b3e33a18e8d5e1bdd7a18d7a166d77ac1b46a1ec38aa35ab7e628ab5 MelnikovIN admin 6d7fce9fee471194aa8b5b6e47267f0348a24b70a0b376535542b996af517398 BoshirovAM user</code> </pre> <br><br><a name="token_algo_for_server"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.7.1 Algoritma untuk menghitung token pengguna situs yang mungkin menggunakan kunci yang dikenal </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika kita tahu kunci domain K, kita dapat dengan mudah menghitung token T yang “valid” dari pengguna yang akan datang dengan permintaannya. </font><font style="vertical-align: inherit;">Untuk ini, diperlukan bahwa kondisi terpenuhi: pemrakarsa permintaan, penerima permintaan, dan konteks eksekusi harus cocok dan sama dengan domain. </font><font style="vertical-align: inherit;">Dengan kata lain, jika kita memiliki nama domain vsphere.local, maka:</font></font><br><pre> <code class="plaintext">Sender = Recipient = Context = vsphere.local</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dari sini, token (mentah) asli dihitung sebagai: </font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/af8/1c2/5b0/af81c25b054111db5d526fcfb8c4fb8c.svg" alt="$T_s = HMAC_{K}(Sender \cup Recipient \cup Context)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah pengiriman, token asli akan lebih dilindungi. </font><font style="vertical-align: inherit;">128 bit yang lebih rendah dari token akan di-hash dengan garam yang dilewatkan di header permintaan CSI-Salt </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dengan demikian, situs akan melihat token berikut:</font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/8ea/b59/cc3/8eab59cc3e5060cfec9956f984807b5f.svg" alt="$T = Hi(T_s) \cup HMAC_{salt}( Lo(T_s) )$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di mana </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah 128 bit tinggi, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah 128 bit rendah dari token asli. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biasanya, untuk konsol manajemen tertutup pada jaringan perusahaan, konsol web tidak memuat skrip eksternal, bingkai, dll. </font><font style="vertical-align: inherit;">Oleh karena itu, kondisi ini akan dipenuhi dalam banyak kasus.</font></font><br><hr> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Untuk metode pembentukan garam, lihat bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Prosedur pertukaran garam antara browser dan server”.</font></font></a></sup> <br><br><a name="server_token_processing"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.8 Memproses token di server </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengirim token ke server (tanpa kunci) </font></font></h3><br><div class="scrollable-table"><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Status Token T dalam sesi situs </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tindakan Server Situs </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tidak dikenal </font></font></td><td>         ,              . <br><br>   .   . <br>   128       . <br>     .      CSI-Salt. <br><br></td></tr><tr><td>  ( 128 ) </td><td>   . <br>      CSI-Salt –   . <br>    .       CSI-Token. <br><br>   ,  CSI-Token-Action: invalid.    400. <br><br>    –  200. <br><br></td></tr></tbody></table></div><br><br><h3>     Permanent </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Browser mengunci kunci klien. </font><font style="vertical-align: inherit;">Pengguna ingin situs mengingat pelanggan selama lebih dari satu sesi. </font><font style="vertical-align: inherit;">Apakah akan menyimpan token pengguna dalam databasenya adalah keputusan server. </font><font style="vertical-align: inherit;">Kami mengembalikan CSI-Token-Action: sukses atau CSI-Token-Action: batalkan ke klien.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengirim token dengan kunci Logout </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menunjukkan bahwa token saat ini tidak akan lagi digunakan oleh browser. </font><font style="vertical-align: inherit;">Itu dikirim ketika pengguna mengklik "Keluar" di browser, atau menutup tab dan opsi ini dikonfigurasi (keluar otomatis saat menutup tab), atau menolak untuk menggunakan kunci tetap ("lupakan saya di situs ini").</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Omong-omong, Autologin seharusnya tidak. </font><font style="vertical-align: inherit;">Demi alasan keamanan.</font></font></blockquote><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengirim token dengan tombol Ubah-Ke </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita sebut token T lama, yang baru - T '. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PENTING:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sebagai token baru T ', nilai sebenarnya token dikirim (untuk pertama kali, untuk yang tidak terdaftar), sedangkan token lama dikirim hash (lebih rendah 128 bit).</font></font><br><div class="scrollable-table"><table><tbody><tr><td colspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status token dalam database server </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup> </td><td rowspan="2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tindakan Server Situs </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini </font></font></td></tr><tr><td>  tidak </td><td>  tidak </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alasan: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pendaftaran</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengguna yang </font><b><font style="vertical-align: inherit;">sah</font></b><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ubah pengidentifikasi sesi pengguna ke T ' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kirim klien CSI-Token-Action: sukses. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengguna membuat kunci permanen untuk situs dan melakukan "Login". </font><font style="vertical-align: inherit;">Server dapat menyimpan token semacam itu di sisinya. </font><font style="vertical-align: inherit;">Dan sebelum itu, tawarkan untuk mengisi formulir pendaftaran (jika perlu).</font></font><br><br>    CSI-Token-Action: registration,   ,     (        ).        Change-To (   )   ,     success  abort.   ,  ,     .   –      (  ). <br></td></tr><tr><td>  tidak </td><td>  </td><td> : <b> Login</b> . <br><br>    T'  .   .   .   CSI-Token-Action: success. <br><br> <b></b> .         Change-To   ,    CSI-Token-Action: success, <b>  </b>    Change-To   <b>  </b> . <br>    ,       .          . <br>  <b>     </b> ,       «» .    <b>      </b> ,       -.  Karena    «  »,    . <br></td></tr><tr><td>  </td><td>  tidak </td><td> : <b>  </b>   . <br><br>    T     T'.   . <br>   CSI-Token-Action: success. <br></td></tr><tr><td> , <br>  <br>  <br></td><td>  </td><td> : <b>     </b> <br><br>  ,         ,      -.                  -     . <br><br>            (  ).      – . <br><br>   .   CSI-Token-Action: success <br></td></tr><tr><td> , <br>  <br>  <br> . <br></td><td>  </td><td>  .            .   .  CSI-Token-Action: abort.   . <br><br>  256-       SHA-2.      ( )         . <br><br>          : <ul><li>      ; </li><li>         ; </li><li>    </li></ul>      .   , –  -    . <br>     ,      .        Logout   .   Login  .  . <br></td></tr></tbody></table></div><hr> <sup>*        ,    .</sup> <br><br><a name="sub_domain_identify"></a><h2> 2.9 -  </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang disebutkan sebelumnya, situs dapat berinteraksi dengan situs mitra lain atau sub-domain mereka untuk menyediakan pengguna dengan beberapa fungsi. Contoh paling umum adalah ketika di situs site.ru beberapa sumber daya diambil dari subdomain img.site.ru, bagian dari download.site.ru, dan bagian lain dari yang lain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam hal ini, situs site.ru harus dapat memberi tahu domain mitranya tentang siapa sebenarnya permintaan yang datang kepada mereka. Memang, jika Anda diotorisasi di site.ru, ini tidak secara otomatis membuat Anda diotorisasi di situs lain, termasuk sub-domain situs. Mereka akan melihat token lain dari Anda. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita lihat bagaimana token dihitung dan bagaimana ini bisa membantu kita. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biarkan pengguna masuk ke site.ru dengan kunci permanen dan berikan token di sana:</font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/a5a/e9b/500/a5ae9b500f4fd8f2600eafdb3a315d32.svg" alt="$T_1 = HMAC_{site.ru-key}(site.ru \cup site.ru \cup site.ru)$" data-tex="display"></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Semua permintaan datang dari halaman situs site.ru ke domain site.ru dan disebabkan oleh: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tag sumber daya halaman (statis atau dinamis asli) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> skrip sendiri </font></font></li></ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan memiliki token T </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (lihat aturan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ini adalah permintaan yang sah untuk site.ru. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang biarkan klien mengunduh file yang dibatasi dari halaman site.ru, tetapi tautannya mengarah ke download.site.ru. </font><font style="vertical-align: inherit;">Dalam hal ini, subdomain akan menerima token berikut (aturan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/445/897/361/445897361e99df033e11f354f37071af.svg" alt="$T_2 = HMAC_{site.ru-key}(site.ru \cup download.site.ru \cup site.ru)$" data-tex="display"></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token download.site.ru yang sama persis akan menerima jika permintaan ajax dari halaman situs site.ru dieksekusi di atasnya ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RB</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">aturan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Domain domain lain akan menerima token:</font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/231/d05/899/231d058996ea04e27a4a67dbdadf68ee.svg" alt="$T_3 = HMAC_{site.ru-key}(site.ru \cup domain \cup site.ru)$" data-tex="display"></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi, perhatikan bahwa jika kondisi untuk memenuhi permintaan tidak berubah, maka untuk bundel domain A, B, C yang diberikan, browser akan selalu menghasilkan token konstan. </font><font style="vertical-align: inherit;">Jadi kita bisa melakukan identifikasi lintas domain. </font><font style="vertical-align: inherit;">Contohnya seperti itu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari site.ru kami membuat permintaan ajax untuk subdomain. </font><font style="vertical-align: inherit;">Kami melewati ID pengidentifikasi! = T </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 dari</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pengguna, yang dikeluarkan kepadanya oleh site.ru. </font><font style="vertical-align: inherit;">Subdomain untuk mendapatkan user ID ini sama token T </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Setiap subdomain akan membuat banyak tokennya dengan ID pengguna. </font><font style="vertical-align: inherit;">Subdomain akan berbagi informasi tentang ID pengguna dan hak-haknya dengan permintaan server-ke-server. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Banyak yang dilakukan sekali. </font><font style="vertical-align: inherit;">Selanjutnya, subdomain akan dipandu oleh token mereka sendiri, seperti </font><font style="vertical-align: inherit;">mereka juga akan permanen untuk kunci permanen site.ru.</font></font><br><br><a name="part3"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3 Rekomendasi Keselamatan </font></font></h1><br><div class="spoiler">  <b class="spoiler_title">Catatan</b> <div class="spoiler_text">      .          . </div></div><br><br><a name="keys_NAA_protection"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.1 Perlindungan informasi utama dari akses tidak sah </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokol otorisasi yang diusulkan melindungi pengguna dari keyloggers yang mencuri kata sandi Anda, karena skema yang diusulkan sama sekali tidak menggunakan kata sandi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi cara untuk melindungi kunci dari kompromi harus dipertimbangkan secara lebih rinci. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kunci dapat dikompromikan oleh:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menyalin informasi kunci oleh malware (akses jarak jauh) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akses langsung ke file dengan informasi utama "offline" (akses langsung) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pada saat distribusi antar perangkat </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan asumsi bahwa informasi utama disimpan pada kartu pintar (kami mempertimbangkan opsi ini di bagian </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Mobilitas Akun"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), tugas melindungi informasi utama ditransfer ke chip. Benar, ada kerentanan terhadap keylogger yang dapat mencegat kode PIN yang dimasukkan; Yah, ketidaknyamanan untuk digunakan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain kartu pintar, enkripsi simetris dapat digunakan untuk melindungi terhadap akses langsung ke informasi utama. Tetapi pertanyaannya adalah: kunci apa yang harus diambil untuk enkripsi? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika kunci ini dibuat berdasarkan kata sandi pengguna, maka, pertama, kami mendapatkan kerentanan terhadap pemilihan kata sandi "offline", dan kedua, pada kenyataannya, dari apa yang mereka tinggalkan, mereka sampai pada itu: "lagi beberapa kata sandi". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilihan yang lebih tepat adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjahit dengan cara khusus </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kunci semacam itu ke rakitan browser</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (atau salah satu perpustakaan khususnya). Setiap pembaruan browser mengubah kunci dan lokasinya di file yang dikompilasi. Pendekatan ini tidak akan memberikan jaminan perlindungan 100%, tetapi akan sangat mempersulit tugas dekripsi. Pertama, penyerang perlu mencari tahu versi perakitan yang tepat, kemudian menemukannya, membongkar, dan mencari tahu bagaimana kuncinya dirakit.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, kunci domain itu sendiri harus langsung disimpan dalam file terpisah, dan tidak bersama dengan konfigurasi untuk penggunaannya (mis. Hanya kunci dan tidak lebih). Maka dekripsi mereka dengan pemilihan tombol (dari rakitan yang diketahui) tidak akan mungkin, karena tidak mungkin untuk membedakan kunci yang didekripsi dengan benar dari urutan byte acak. Kemudian mencoba mengambil kunci master tanpa mengetahui versi yang tepat dari rakitan browser dan secara langsung membongkar kodenya akan menjadi mustahil sama sekali. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat menggunakan opsi gabungan: enkripsi dengan kunci dari browser + enkripsi dengan kata sandi pengguna dari akun OS (jika OS API memungkinkan). Apalagi kuncinya selalu dihasilkan dengan cepat. Maka brute force offline akan menjadi lebih mahal.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, setelah mengubah kata sandi pengguna di OS, kuncinya juga akan berubah. </font><font style="vertical-align: inherit;">Dan jika Anda tidak melakukan pra-dekripsi pada kunci lama, maka ini akan melindungi terhadap situasi ketika administrator komputer mengubah kata sandi Anda untuk mengakses akun Anda dan melakukan tindakan atas nama Anda. </font><font style="vertical-align: inherit;">Jenis situasi: berhenti dari pekerjaannya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama-tama Anda akan membuat salinan cadangan kunci (ekspor kunci ke file). </font><font style="vertical-align: inherit;">Kecuali, tentu saja, Anda sudah melakukan ini sebelumnya ketika mendistribusikan kunci ke perangkat lain.</font></font><br><hr> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* Sebagai contoh, kunci 32 byte didistribusikan secara acak di bagian 64K dari file yang dapat dieksekusi. </font><font style="vertical-align: inherit;">Dan hanya kode sumber yang tahu cara mengumpulkan kunci berharga dari byte ini.</font></font></sup> <br><br><a name="why_password_for_keys_not_good"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 3.2 Tentang kata sandi sebagai kunci domain </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di salah satu versi awal protokol, kunci domain dapat dibuat berdasarkan kata sandi pengguna. Algoritma itu rumit, tidak termasuk kunci duplikat untuk domain yang berbeda untuk kata sandi yang sama. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini diposisikan sebagai cara yang nyaman untuk akun mobilitas. Masukkan satu kata sandi dan jangan khawatir tentang apa pun. Tapi kemudian ternyata yang berikut:</font></font><br><br><ol><li>     ,     «» ,        ,   .   ,       -,          . <br><br>  (),     8-  ,       ,    .: ~!@#$%^&amp;.   : 26 + 26 + 10 + 8 = 70 . 8-       70 <sup>8</sup> . <br><br> ,     ,         10 <sup>12</sup>   .      70 <sup>8</sup> / 10 <sup>12</sup> = ~576 .  Yaitu       ~10 .          5       . 10-      15 .      10 ,      1-2 . <br><br>           ,        . </li><li>       ,     . </li><li>                ,     .  Yaitu      (       SHA-2). </li><li>  , ,  ,      .        . </li></ol><br><br><a name="risks_loss_keys"></a><h2> 3.3  /     </h2><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana jika saya kehilangan kunci master?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini dapat terjadi jika Anda mengubah kata sandi atau menginstal ulang OS. Apa risikonya? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yah, Anda tidak akan sampai ke situs di mana Anda sebelumnya. Kehilangan riwayat belanja Anda di toko online, iklan di situs online, karma di forum. Itu tidak masalah. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meskipun, siapa yang mencegah untuk melakukan prosedur registrasi ulang dengan token baru dan mengkonfirmasinya melalui nomor telepon yang ditunjukkan dalam pengumuman yang sama? Ternyata situs tersebut perlu melakukan pendaftaran ulang token (analog "pemulihan kata sandi")? Di mana tidak adanya bentuk "segala macam" yang dijanjikan? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, sebuah situs yang perlu tidak hanya mengidentifikasi pengunjung, tetapi juga tahu siapa itu sebenarnya, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membuat formulir pendaftaran. </font><font style="vertical-align: inherit;">Sebenarnya, formulir ini dapat digunakan untuk registrasi ulang. </font><font style="vertical-align: inherit;">Anda menentukan data yang sama persis seperti sebelumnya (email, seluler). </font><font style="vertical-align: inherit;">Konfirmasikan bahwa Anda memiliki data ini (surat, SMS). </font><font style="vertical-align: inherit;">Sistem melihat bahwa akun semacam itu sudah ada, datanya 100% milik Anda, tetapi tokennya berbeda - ia menulis ulang token. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tapi tetap saja, lebih baik tidak kehilangan kunci master.</font></font><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana cara mencegah kerugian? </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buat salinan cadangan, lindungi dengan kata sandi dan simpan di media sekali pakai. </font><font style="vertical-align: inherit;">Juga, sebenarnya, seperti yang dilakukan dengan kunci untuk bitcoin. </font><font style="vertical-align: inherit;">Pada prinsipnya, Anda dapat menerjemahkan kunci utama ke dalam bentuk cetakan dan menyimpannya di selembar kertas. </font><font style="vertical-align: inherit;">Untuk itu. </font><font style="vertical-align: inherit;">Dan kemudian kembalikan dengan input manual. </font><font style="vertical-align: inherit;">Tapi ini untuk orang yang cukup "paranoid" seperti saya.</font></font><br></blockquote><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi bagaimana jika kunci master dicuri dari saya?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini sudah serius. Meskipun rekomendasi yang dijelaskan di sini untuk menyimpan kunci master (tidak termasuk dalam protokol) melindungi mereka dari gangguan langsung, keylogger dan trojan, namun, risiko kompromi kunci master tetap ada. Sayangnya, perlindungan sempurna tidak ada. Kuncinya dapat dibajak langsung dari memori browser melalui kerentanan mesin javascript. Sebagai contoh. Atau apakah Anda kehilangan ponsel Anda ... </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi apa risiko mencuri kunci utama?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Penting untuk menerima informasi tentang Anda dan bahkan untuk mengambil tindakan atas nama Anda. Memperoleh kemampuan bagi penyerang untuk masuk di bawah Anda dan dalam mode baca untuk mendapatkan akses ke informasi sensitif.</font></font> Tenang dan tenang.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atau unduh semua video pribadi Anda dari teman sekelas sekaligus. Tidak menyenangkan bagi Anda. Penggemar anjing laut bersukacita. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di sini Anda perlu mendaftar ulang dengan cepat dengan kunci baru di situs-situs penting. Dan, jika sesuatu yang buruk terjadi, mendaftarkan token baru Anda di basis data penyedia layanan dengan cara resmi adalah satu-satunya pilihan yang tepat. Anda dapat memikirkan banyak metode pendaftaran: dari pemasangan kertas dalam surat resmi, hingga aplikasi melalui layanan dukungan teknis situs dengan konfirmasi identitas Anda dengan cara yang dapat diterima. Tapi ini hanya untuk situs serius, seperti perbankan online.</font></font><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara meminimalkan risiko. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penggunaan kunci individual untuk domain (tetapi ini mengurangi mobilitas akun). </font><font style="vertical-align: inherit;">Otentikasi dua faktor melalui saluran independen. </font><font style="vertical-align: inherit;">Situs ini menunjukkan alamat IP dan perangkat di mana koneksi berasal dari terakhir kali, sehingga Anda setidaknya melihat kompromi.</font></font><br></blockquote><br><br><a name="part4"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4 Serangan pada skema otorisasi </font></font></h1><br><br><a name="attack_user_tracking"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.1 Pelacakan Pengguna </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs yang Anda percayai dapat menggabungkan informasi tentang Anda dengan situs lain tanpa malu-malu. </font><font style="vertical-align: inherit;">Di Internet ada situs pengumpul yang mengumpulkan informasi tersebut dan menjualnya kepada semua orang. </font><font style="vertical-align: inherit;">Metrik Yandex, analitik google - situs langka tidak memilikinya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agar dua situs berbeda dapat menentukan bahwa mereka bekerja dengan klien yang sama, dua teknik digunakan:</font></font><br><br><ol><li>              (     ,     ). </li><li>       (    )       . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada sedikit kelemahan dalam Skema 2: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bukan pengguna yang diidentifikasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , melainkan browser. Namun seringkali browser == client. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampaknya token paling cocok untuk digunakan dalam skema No. 2. Lagipula, jika pengguna mengizinkan dua situs (bertindak sebagai pasangan) untuk "mengingat" diri mereka sendiri, token permanen kami dapat bertindak seperti "sidik jari", bukan hanya browser, tetapi pengguna. Masalah untuk situs di sini adalah mereka </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan menerima token yang berbeda</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi situs juga dapat mencoba menerapkan skema No. 1. Kemudian hal berikut akan muncul. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs 1 akan menerima kode H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari browser </font><font style="vertical-align: inherit;">, dan situs 2, dieksekusi dalam konteks situs 1, </font><font style="vertical-align: inherit;">akan menerima </font><font style="vertical-align: inherit;">kode H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tampaknya sekarang situs dapat membentuk pasangan (H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , H</font></font><sub>2</sub> )      -. <br>      3,       2,   .  3     H <sub>3</sub> ,   2,     3 –  H <sub>2'</sub> != H <sub>2</sub> (.   ).  ,    , ..     . <br><br>  <b>  ,        fingerprint </b> .    ,             . <br><br> <b> :</b>   ,     .        . <br><br><a name="attack_XSS"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.2 serangan XSS </font></font></h2><br><br> <abbr title="Cross-Site Scripting — « »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">XSS</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah jenis serangan yang melibatkan pengenalan kode berbahaya ke halaman situs web korban.com. </font><font style="vertical-align: inherit;">Misalnya, melalui skrip afiliasi atau CDN yang diretas dari kerangka kerja populer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode berbahaya dapat menggunakan otorisasi pengguna di situs untuk mendapatkan akses yang diizinkan atau mencuri data otentikasi pengguna. </font><font style="vertical-align: inherit;">Kode berbahaya dapat dimasukkan ke dalam halaman melalui kerentanan di server web (trivial hacking), melalui jaringan afiliasi (sumber tidak dapat diandalkan), melalui kerentanan pada komputer pengguna (perayapan Trojan). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perlindungan utama terhadap serangan semacam itu untuk skema otorisasi kami adalah aturan khusus untuk menghasilkan bidang Sumber saat menghitung token. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kerentanan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: untuk XSS yang disimpan (ketika skrip dimasukkan langsung ke situs yang diserang dan diambil darinya sebagai hasil peretasan server), perlindungan tidak akan berfungsi. </font><font style="vertical-align: inherit;">Karena browser tidak akan dapat mengidentifikasi skrip seperti "eksternal". </font><font style="vertical-align: inherit;">Masalah yang sama akan terjadi ketika seorang penyerang proksi lalu lintas klien-server.</font></font><br><br><a name="attack_CSRF"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.3 Serangan CSRF </font></font></h2><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Korban mengunjungi situs evil.com, yang dibuat oleh penyerang. Atas namanya, permintaan (GET / POST / HEAD / PUT / DELETE) dieksekusi ke situs di mana pengguna sudah diotorisasi (misalnya, ke server sistem pembayaran). Permintaan itu sendiri melakukan semacam operasi jahat (misalnya, mentransfer uang ke akun penyerang). Menurut pengawasan pengembang, situs tidak memeriksa bidang Perujuk dan tidak meminta informasi verifikasi tambahan dari pengguna. Alhasil, serangan itu berhasil. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skema otorisasi lokasi yang diusulkan menekan sebagian besar skenario serangan </font></font><abbr title="ross Site Request Forgery — «  »"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CSRF</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, karena algoritma pembuatan token. </font><font style="vertical-align: inherit;">Setiap permintaan lintas situs akan menghasilkan situs yang diserang menerima token yang tidak valid dari pengguna. </font><font style="vertical-align: inherit;">Akibatnya, dalam situasi ini, pengguna untuk situs yang diserang akan anonim anonim. </font><font style="vertical-align: inherit;">Bahkan upaya untuk mengeksekusi permintaan GET yang tidak berbahaya dari situs penyerang ke situs yang diserang (mengunggah gambar) akan menghasilkan yang terakhir menerima token yang tidak valid. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini harus sangat menyederhanakan kehidupan pengembang situs.</font></font><br><br><a name="attack_SSO"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.4 Pelacakan menggunakan SSO </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dua situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang dipercayai pengguna dan memiliki kunci untuknya, memutuskan untuk menerapkan teknologi yang mirip dengan SSO untuk pelacakan pengguna. Tapi sejak itu Anda tidak dapat menyematkan satu situs ke situs lain (salah satu dari mereka akan menerima token yang tidak valid), Anda tidak dapat membuka situs mitra dengan skrip (untuk alasan yang sama), kemudian situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memutuskan untuk menggunakan teknik yang rumit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada salah satu halaman ia menempatkan tag A transparan, menutupi seluruh jendela. Tautan mengarah ke situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan pengidentifikasi pengguna (dari S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dan token H </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ditransmisikan dalam alamat </font><font style="vertical-align: inherit;">. Pengguna tidak melihat tautannya. Dengan mengklik pada area mana saja dari situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , itu memulai pembukaan tab baru di situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat ini, S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak akan menerima token yang valid. </font><font style="vertical-align: inherit;">Reload otomatis dengan tag juga tidak akan membantunya</font></font><br><pre> <code class="xml">&lt;meta http-equiv="refresh" content="0"&gt;</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau skrip. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tapi S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dapat membuat tag A di seluruh halamannya dalam bentuk tombol Tutup palsu:</font></font><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/is/n5/jh/isn5jhlcnubhl580cvv6lgdloye.jpeg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tautan ini pertama-tama akan memuat ulang situs, lalu menutupnya. </font><font style="vertical-align: inherit;">Pada saat reboot, browser akan mengirimkan </font><font style="vertical-align: inherit;">token H </font><sub><font style="vertical-align: inherit;">2 yang</font></sub><font style="vertical-align: inherit;"> sudah valid </font><font style="vertical-align: inherit;">ke situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (karena aturan 2.4 P1 telah diikuti: pengguna secara pribadi membuka kedua tautan). </font><font style="vertical-align: inherit;">Akibatnya, S </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;"> akan menerima informasi tentang tindakan penggunanya di situs S </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;"> , mengaitkan token H </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;"> dengan H </font><sub><font style="vertical-align: inherit;">2-nya</font></sub><font style="vertical-align: inherit;"> , dan mengirimkan H </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;"> permintaan interserver ke S </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Di masa depan, situs S </font><sub><font style="vertical-align: inherit;">1</font></sub><font style="vertical-align: inherit;"> dan S </font><sub><font style="vertical-align: inherit;">2</font></sub><font style="vertical-align: inherit;"> akan dapat bertukar informasi tentang pengguna dengan pertukaran server, seperti </font><font style="vertical-align: inherit;">sekarang mereka dapat secara unik mengidentifikasi </font><b><font style="vertical-align: inherit;">satu sama lain secara terpisah satu sama lain</font></b></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengguna ponsel sangat rentan terhadap serangan ini, karena </font><font style="vertical-align: inherit;">mencoba menutup halaman yang tidak perlu bisa secara tidak sengaja mengklik tautan palsu yang menempati seluruh layar ponsel.</font></font></blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode perlindungan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secara otomatis memutuskan sesi ketika tab ditutup. </font><font style="vertical-align: inherit;">Kemudian situs S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tidak dapat menerima token yang valid sampai pengguna sendiri login ke sana. </font><font style="vertical-align: inherit;">Benar, ini tidak akan melindungi terhadap situasi ketika pengguna membuka tab dan masuk ke S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan S </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dan baru kemudian situs melakukan serangan seperti itu.</font></font><br><br><a name="attack_sso_key_discredit"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.5 Kompromi Kunci untuk SSO </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biarkan akun pengguna di server otentikasi yang mendukung SSO dikompromikan. </font><font style="vertical-align: inherit;">Kami akan mengevaluasi kemungkinan risiko dengan skema otentikasi kami. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token untuk setiap situs dihitung secara individual berdasarkan kunci domain.</font></font><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengompromikan satu kunci domain tidak secara otomatis membahayakan semua yang lain.</font></font></b> </blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagian besar situs di mana Anda sebelumnya masuk menggunakan SSO mungkin akan menyimpan token Anda dengan profil Anda dari server SSO di database mereka. </font><font style="vertical-align: inherit;">Dalam skema kami, situs hanya akan menarik token dari database dan mengenali Anda.</font></font> Yaitu<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Server SSO tidak lagi diperlukan di situs tersebut - ia menjalankan fungsinya pada tahap pendaftaran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan kata lain, Anda tidak secara otomatis kehilangan semua akses Anda sekaligus. Seorang penyerang akan diidentifikasi di situs yang sama dengan orang lain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upaya untuk melakukan kembali otentikasi lintas-domain tidak akan membantu penyerang juga: situs harus memblokir upaya untuk membuat akun baru dengan SSO Id-user lama dan token situs baru. Atau, upaya untuk menulis ulang token pengguna untuk ID yang ada dalam proses SSO harus diblokir. Fakta ini, harus menimbulkan kecurigaan yang wajar di sisi situs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Token pengguna dapat diubah secara legal hanya dalam satu cara (lihat. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Skenario operasi protokol”</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Resiko.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika situs tidak menyimpan token dan profil Anda dalam basis datanya, tetapi sepenuhnya bergantung pada mekanisme SSO, maka penyerang hanya perlu melakukan otentikasi lintas-domain untuk masuk menggunakan nama Anda. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meminimalkan risiko jika terjadi kompromi.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anehnya, tapi ini adalah pelestarian oleh situs token dan profil pengguna di pihak mereka. Upaya penyerang untuk melakukan otentikasi lintas-domain dapat menyebabkan konflik antara pengguna lama dan token barunya. Situasi itu sendiri, ketika pengguna telah mengubah token dengan cara apa pun selain yang ditentukan dalam protokol, harus dianggap mencurigakan atau ditolak sama sekali. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Risiko maksimum:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otorisasi atas nama Anda di situs lain (di mana Anda belum pernah). Akses ke data profil Anda. Melakukan tindakan melanggar hukum atas nama Anda. Dan agar pemilik yang sah tidak dapat mengembalikan apa pun, penyerang dapat mengubah tokennya di server otorisasi dengan cara yang legal. Risiko ini, bagaimanapun, bertepatan dengan risiko saat menggunakan skema otorisasi tradisional. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cara perlindungan.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Penolakan untuk menggunakan SSO (terutama karena skema yang diusulkan disusun sebagai cara untuk menjauh dari skema otentikasi terpusat). Gunakan beberapa SSO (jangan menyimpan semua telur dalam satu keranjang!). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika SSO mendukung otentikasi dua faktor dengan otentikasi oleh atribut lain (mail, telepon), maka ada kemungkinan mendapatkan kembali kendali atas akun server otorisasi.</font></font><br><br><a name="attack_token_compromise_due_transmit"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.6 Token kompromi selama transfer </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jelas bahwa mekanisme yang diusulkan untuk hashing token selama transfer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak memberikan jaminan 100% untuk</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perlindungan mereka. </font><font style="vertical-align: inherit;">Seorang penyerang dapat mencegat lalu lintas korban pada saat transfer token yang tidak aman (pada saat pendaftaran utama kunci permanen), sebagai contoh. </font><font style="vertical-align: inherit;">Dan kemudian menggunakannya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oleh karena itu, penggunaan SSL dianjurkan. </font><font style="vertical-align: inherit;">Tapi jangan menggunakan HTTPS sebagai obat mujarab. </font><font style="vertical-align: inherit;">Protokol ini juga terbuka, serta HTTP. </font><font style="vertical-align: inherit;">Hanya sedikit lebih sulit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benar, transfer token terbuka yang jarang terjadi, serta penggunaan token individu untuk setiap domain, mengurangi risiko mengeksploitasi kerentanan. </font><font style="vertical-align: inherit;">Meskipun demikian.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahaya lain adalah intersepsi dan penggunaan kembali token di sesi pengguna saat ini. </font><font style="vertical-align: inherit;">Seperti yang saya katakan sebelumnya, idealnya, token harus diiris dengan garam baru di setiap permintaan klien. </font><font style="vertical-align: inherit;">Namun, ini akan mematikan kemungkinan pemrosesan paralel permintaan di server dan membuatnya tidak mungkin untuk mengirim permintaan paralel dari klien. </font><font style="vertical-align: inherit;">Menghitung dan memeriksa hash pada umumnya merupakan operasi mahal yang mengurangi kinerja.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, token yang diteruskan di header tidak boleh tersedia dari Javascript. </font><font style="vertical-align: inherit;">Mirip dengan Cookie dengan bendera HttpOnly. </font><font style="vertical-align: inherit;">Bahkan ketika menerima permintaan ajax oleh skrip.</font></font></blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode operasi:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memotong permintaan pengguna, mengekstraksi nilai token saat ini, mengirim operasi lain dengan token yang sama (seperti atas nama pengguna yang sama). </font><font style="vertical-align: inherit;">Benar, sistem klasik berdasarkan cookie sesi juga rentan terhadap jenis serangan ini. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode perlindungan:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> konfirmasi operasi signifikan melalui saluran komunikasi lain, misalnya, melalui SMS atau surat; </font><font style="vertical-align: inherit;">pra-registrasi token melalui saluran komunikasi lain (sertifikat kertas, sebagai contoh).</font></font><br><br><a name="attack_token_compromise_due_site_hacking"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.7 Meretas situs web dan token yang membahayakan </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs peretasan terjadi terus-menerus. </font><font style="vertical-align: inherit;">Bahkan situs besar dan terlindungi pun rusak. </font><font style="vertical-align: inherit;">Ada banyak cara peretasan: dari suntikan sepele ke "tiriskan" orang dalam. </font><font style="vertical-align: inherit;">Karenanya, kompromi token Anda di situs mana pun adalah peristiwa yang sangat mungkin terjadi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi protokol yang diusulkan, sama saja, membuat acara peretasan situs menjadi hal yang paling tidak menyakitkan bagi Anda.</font></font><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompromi token tidak mengarah pada kompromi kunci domain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> atas dasar yang dihitung. </font><font style="vertical-align: inherit;">Selain itu, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acara ini tidak mengarah pada kompromi token Anda yang lain</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dan jika demikian, maka akses ke situs lain tetap tidak dapat diakses.</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini sangat menyenangkan ketika kunci dibuat untuk sebagian besar situs menggunakan kunci master: tidak mungkin untuk mengembalikannya dengan rekayasa terbalik. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi pada saat yang sama, tidak mungkin untuk menggunakan kunci domain yang tokennya dikompromikan, karena alasan yang jelas. </font><font style="vertical-align: inherit;">Harus ganti kunci. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kunci untuk domain tempat kebocoran resmi terjadi dapat dilakukan berdasarkan nomor acak atau berdasarkan kunci master, dengan penambahan nomor versi:</font></font><br><p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/b1c/9ee/9ac/b1c9ee9ac9a8f065c9a394045a24edb9.svg" alt="$DomainKey = HMAC_{M_{key}}( DomainName \cup VersionNumber )$" data-tex="display"></p><br><br><a name="epilog"></a><h1>  Kesimpulan </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beberapa teman saya yang saya tunjukkan artikel pada dasarnya bertanya kepada saya pertanyaan yang sama: "Apa hal utama di sini?" </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terlihat dari tinggi</font></font></b> <div class="spoiler_text">  ,        (     ),     (?)  ,   . <br><br> ,     ,  -  .  ,    ,       ,           .       (   ,   ).    ,        « »      «-». <br><br>  -    « ». <s>  </s>    ,  <s></s> «».     ,    .     (   Google ,  Facebook –       ).     (  DDOS-    . – <abbr title="            "><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a></abbr>  )   - .   ,     SSO       ,        .   ? <br><br>   , , ,       .  ,     -     -.  ,     .,     .     email,  .      .  ,             .    ? <br><br> <b>  -.  ?</b> SSO –    . <br><br> ,        « ».         .      .       .             .   , . <br><br>      -      «»  .    ,    « ».          ,    . <br><br>  -,         ? <br></div></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oh, tidak ada chip utama!</font></font></b>  Sayang<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi ada sejumlah detail yang membuat protokol lebih menguntungkan daripada skema login / kata sandi tradisional. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. Anda mungkin memperhatikan popup yang mengganggu ini di banyak situs.</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Situs kami menyimpan cookie! </font><font style="vertical-align: inherit;">Kenakan helmmu dan waspada, karena kakak laki-laki itu memperhatikanmu! </font><font style="vertical-align: inherit;">Klik "Ya", karena Anda masih tidak punya pilihan. "</font></font></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah popup lain untuk sekelompok yang sama-sama mengganggu dan sangat diperlukan. </font><font style="vertical-align: inherit;">Dan semua ini berkat GDPR Eropa (analog dari hukum PD kami). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi disini. </font><font style="vertical-align: inherit;">Dalam skema kami, cookie tidak lagi diperlukan untuk tujuan identifikasi! </font><font style="vertical-align: inherit;">Dari kata "sepenuhnya." </font><font style="vertical-align: inherit;">Pengguna memutuskan apakah akan mengizinkan situs untuk mengidentifikasi itu, dan kapan dan berapa lama. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minus satu popup yang mengganggu, +1 ke protokol karma.</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. Pengembang tidak perlu lagi melakukan otorisasi dan formulir pemulihan kata sandi. </font><font style="vertical-align: inherit;">Tidak perlu menerapkan algoritme SSO kompleks dan menguasai pustaka kompleks: OAuth, SAML, Kerberos, dll., Ikuti prosedur pendaftaran situs Anda, ubah kunci otorisasi, pantau keamanannya; </font><font style="vertical-align: inherit;">dan jika ada yang salah dengan SSO, segera pahami: "apa yang salah, dan mengapa." </font><font style="vertical-align: inherit;">Selain itu, server otorisasi dapat memblokir situs Anda karena alasan yang tidak diketahui. </font><font style="vertical-align: inherit;">Cari tahu itu. </font><font style="vertical-align: inherit;">Kemarin semuanya bekerja, tetapi hari ini ... Dan ini cukup untuk membaca token dari header dan memeriksa untuk melihat apakah ada satu di database kami. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sederhana = andal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya mengatakan ...</font></font></b> <div class="spoiler_text">      .     .       ,   -  -  .       . .  . <br><br>    -, -,  « »   . <br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Pengguna tidak perlu memasukkan dan mengingat banyak kata sandi. Gunakan layanan situs pihak ketiga atau tidak diketahui oleh siapa dan bagaimana program tertulis. Anda tidak perlu takut akses ke komputer oleh pihak ketiga, keyloggers dan trojan. Cukup membuat salinan cadangan dari kunci master, melindunginya dengan kata sandi dan menyimpannya di suatu tempat di USB flash drive. Seperti dompet bitcoin. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang bukan fitur?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4. Jika situs diretas, Anda tidak mengambil risiko apa pun. Nah, buat ulang kuncinya lagi. Sementara kata sandi bocor ke cracker situs dapat menyebabkan banyak masalah. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Protokol dibuat dengan mempertimbangkan pengalaman serangan jaringan yang diketahui. Arsitekturnya sudah termasuk perlindungan dasar terhadap XSS, CSRF. Sekali lagi, webmaster akan merasa lebih mudah untuk mengembangkan situs. Dan penggunanya - lebih tenang.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6. Independensi protokol dari penyedia layanan tertentu dan keinginannya. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokol membuat Anda bebas.</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. Akhirnya, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protokol yang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diusulkan </font><b><font style="vertical-align: inherit;">mengklaim standar terbuka masa depan</font></b><font style="vertical-align: inherit;"> . Dan standar, jika diadopsi oleh peserta, </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membebankan kewajiban untuk mengimplementasikan fungsi sesuai dengan spesifikasi</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan tidak untuk pagar pertanian kolektif dari keputusan otorisasi sendiri, sekali lagi menciptakan bentuk login, pendaftaran, pemulihan kata sandi, logout. Dan jangan main-main dengan hashing kata sandi atau injeksi SQL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan yang paling penting, seperti standar terbuka, itu </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat dan harus diverifikasi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ahli independen. </font><font style="vertical-align: inherit;">Sekalipun pembuat protokol versi asli "mengacaukan" secara terperinci, komunitas online dapat mengidentifikasi perbaikan ini tepat waktu. </font><font style="vertical-align: inherit;">Nah, atau kirim protokol saya ke memo. </font><font style="vertical-align: inherit;">Sial bagi saya, dan "dibawa-bawa" untuk semua orang.</font></font><br><br><blockquote> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Saya pikir saya harus berhenti pada</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E. Wiles ini</font></font><br></blockquote><br><br><hr>  <b>PS</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat membiasakan diri dengan pilihan artikel panjang penuh dalam format offline. </font><font style="vertical-align: inherit;">Saat mengetik huruf di Habr, saya bisa membuat kesalahan ketik. </font><font style="vertical-align: inherit;">Jika Anda memiliki komentar serius, lebih baik untuk memeriksa yang asli dan meninggalkan komentar artikel (ulasan) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dalam file ini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Kirimkan perubahan Anda kepada saya ke mail sergey201991 [] gmail. </font><font style="vertical-align: inherit;">Saya bukan gurita, tetapi saya akan mencoba menjawab. </font><font style="vertical-align: inherit;">Saya akan menambahkan beberapa komentar yang cocok / menarik ke artikel ini. </font><font style="vertical-align: inherit;">Bersama dengan jawaban mereka. </font><font style="vertical-align: inherit;">Varian dari artikel komentar terpisah tidak dikesampingkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ya, saya tahu bahwa protokolnya mungkin mengalami masalah:</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak ada cara untuk masuk di bawah akun Anda di perangkat orang lain jika Anda tidak memiliki kunci, tetapi Anda sangat membutuhkannya; </font><font style="vertical-align: inherit;">kata sandi lebih nyaman di sini</font></font></li><li>      ;           ,  SSO </li><li>       «», -  : -      (   ) </li><li>    -  </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengenai hal. 1 - Saya benar-benar berpikir untuk kembali ke ide membuat kunci domain berdasarkan kata sandi, membuat perlindungan terhadap kekerasan dengan mempersulit proses pembuatan kunci: katakanlah, meningkatkan jumlah putaran hash menjadi 1000. Tetapi masalah dengan kemungkinan benturan kata sandi untuk pengguna yang berbeda pada satu Situs itu menghantuiku. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengenai hal. 2 - ini diperlakukan berdasarkan waktu. </font><font style="vertical-align: inherit;">Anda harus terbiasa dengan antarmuka baru. </font><font style="vertical-align: inherit;">Pada awalnya itu tidak akan jelas, maka itu akan menjadi sederhana. </font><font style="vertical-align: inherit;">Memberi seorang pria tahun 80-an sebuah smartphone modern, ia juga tidak akan bisa menebak bagaimana cara mengelolanya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima kasih banyak jika Anda membacanya sampai akhir!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id472310/">https://habr.com/ru/post/id472310/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id472296/index.html">Sistem perlindungan kebocoran untuk mesin cuci</a></li>
<li><a href="../id472298/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 385 (14-20 Oktober 2019)</a></li>
<li><a href="../id472300/index.html">Stochastic gradient descent (SGD) untuk fungsi kehilangan logaritmik (LogLoss) dalam masalah klasifikasi biner</a></li>
<li><a href="../id472304/index.html">NASA merekrut insinyur untuk mengembangkan robot humanoid generasi berikutnya</a></li>
<li><a href="../id472306/index.html">PHP Digest No. 166 (7-21 Oktober, 2019)</a></li>
<li><a href="../id472312/index.html">Pengalaman mentransfer proyek Maven ke Jar Multi-Rilis: sudah mungkin, tetapi masih sulit</a></li>
<li><a href="../id472314/index.html">Saya suka orang kardus</a></li>
<li><a href="../id472318/index.html">Pelacakan Terdistribusi di Istio</a></li>
<li><a href="../id472320/index.html">Wawancara dengan Zabbix: 12 jawaban jujur</a></li>
<li><a href="../id472326/index.html">Industri luar angkasa kami ... Dan jika Anda melihat masalah industri dari sudut pandang seorang geek?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>