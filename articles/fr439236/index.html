<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∑ üïé üë®‚Äçüè´ xenvman: environnements de test de microservices flexibles (et plus) üàπ üìª üë¶üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! 


 Je voudrais parler un peu du projet sur lequel je travaille depuis six mois. Je fais le projet pendant mon temps libre, mais la mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>xenvman: environnements de test de microservices flexibles (et plus)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439236/"><p>  Bonjour √† tous! </p><br><p>  Je voudrais parler un peu du projet sur lequel je travaille depuis six mois.  Je fais le projet pendant mon temps libre, mais la motivation pour sa cr√©ation est venue des observations faites au travail principal. </p><br><p>  Sur un projet de travail, nous utilisons l'architecture des microservices, et l'un des principaux probl√®mes qui s'est manifest√© au fil du temps et le nombre accru de ces services est en train de tester.  Lorsqu'un certain service d√©pend de cinq √† sept autres services, plus une autre base de donn√©es (ou m√™me plusieurs) pour d√©marrer, le tester sous une forme ¬´en direct¬ª, pour ainsi dire, est tr√®s g√™nant.  Vous devez mettre des mokas de tous les c√¥t√©s si fermement que vous ne pouvez m√™me pas distinguer la p√¢te elle-m√™me.  Eh bien, ou en quelque sorte organiser un environnement de test o√π toutes les d√©pendances pourraient vraiment √™tre lanc√©es. </p><a name="habracut"></a><br><p> En fait, pour faciliter la deuxi√®me option, je me suis juste assis pour √©crire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">xenvman</a> .  En un mot, c'est quelque chose comme un hybride de docker-compose et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">test de conteneurs</a> , uniquement sans liaison √† Java (ou tout autre langage) et avec la possibilit√© de cr√©er et de configurer dynamiquement des environnements via l'API HTTP. </p><br><p> <code>xenvman</code> √©crit en Go et impl√©ment√© comme un simple serveur HTTP, ce qui vous permet d'utiliser toutes les fonctionnalit√©s disponibles √† partir de n'importe quelle langue pouvant parler ce protocole. </p><br><p>  La principale chose que xenvman peut faire est: </p><br><ul><li>  D√©crire de mani√®re flexible le contenu de l'environnement avec de simples scripts JavaScript </li><li>  Cr√©ez des images √† la vol√©e </li><li>  Cr√©ez le bon nombre de conteneurs et combinez-les en un seul r√©seau isol√© </li><li>  Transf√©rer les ports internes de l'environnement √† l'ext√©rieur, afin que les tests puissent atteindre les services n√©cessaires m√™me √† partir d'autres h√¥tes </li><li>  Modifiez dynamiquement la composition de l'environnement (arr√™tez, d√©marrez et ajoutez de nouveaux conteneurs) en d√©placement, sans arr√™ter l'environnement de travail. </li></ul><br><h2 id="okruzheniya">  L'environnement </h2><br><p>  Le personnage principal de xenvman est l'environnement.  Il s'agit d'une telle bulle isol√©e, dans laquelle toutes les d√©pendances n√©cessaires (emball√©es dans des conteneurs Docker) de votre service sont lanc√©es. </p><br><p><img src="https://habrastorage.org/webt/z5/ot/ju/z5otjuqar0vsscxnoqpawyf6vxe.png"></p><br><p>  La figure ci-dessus montre le serveur xenvman et les environnements actifs dans lesquels diff√©rents services et bases de donn√©es s'ex√©cutent.  Chaque environnement a √©t√© cr√©√© directement √† partir du code de test d'int√©gration et sera supprim√© une fois termin√©. </p><br><h2 id="shablony">  Patterns </h2><br><p>  Ce qui fait directement partie de l'environnement est d√©termin√© par les mod√®les, qui sont de petits scripts dans JS.  xenvman poss√®de un interpr√©teur int√©gr√© de ce langage et lorsqu'il re√ßoit une demande de cr√©ation d'un nouvel environnement, il ex√©cute simplement les mod√®les sp√©cifi√©s, chacun ajoutant un ou plusieurs conteneurs √† la liste pour ex√©cution. </p><br><p>  JavaScript a √©t√© choisi pour permettre la modification / l'ajout dynamique de mod√®les sans avoir √† reconstruire le serveur.  De plus, les mod√®les n'utilisent g√©n√©ralement que les fonctionnalit√©s de base et les types de donn√©es du langage (le bon vieux ES5, pas de DOM, React et autre magie), donc travailler avec des mod√®les ne devrait pas poser de difficult√©s particuli√®res, m√™me pour ceux qui connaissent JS. </p><br><p>  Les mod√®les sont param√©trables, c'est-√†-dire que nous pouvons contr√¥ler compl√®tement la logique du mod√®le en passant certains param√®tres dans notre requ√™te HTTP. </p><br><h2 id="sozdanie-obrazov-na-letu">  Cr√©ez des images √† la vol√©e </h2><br><p>  √Ä mon avis, l'une des fonctionnalit√©s les plus pratiques de xenvman est la cr√©ation d'images Docker en cours de configuration de l'environnement.  Pourquoi cela pourrait-il √™tre n√©cessaire? <br>  Eh bien, par exemple, sur notre projet, pour obtenir une image d'un service, vous devez valider les modifications dans une branche distincte, d√©marrer et attendre que Gitlab CI collecte et remplisse l'image. <br>  Si un seul service a chang√©, cela peut prendre de 3 √† 5 minutes. </p><br><p>  Et si nous voyons activement de nouvelles fonctionnalit√©s dans notre service, ou essayons de comprendre pourquoi cela ne fonctionne pas, en ajoutant le bon vieux <code>fmt.Printf</code> dans les deux sens, ou en changeant souvent le code d'une mani√®re ou d'une autre, m√™me un d√©lai de 5 minutes sera id√©al pour √©teindre les performances ( les n√¥tres en tant que r√©dacteurs de code).  Au lieu de cela, nous pouvons simplement ajouter tout le d√©bogage n√©cessaire au code, le compiler localement, puis simplement attacher le binaire termin√© √† la demande HTTP. </p><br><p>  Apr√®s avoir re√ßu une telle approbation, le mod√®le prendra ce binaire et cr√©era une image temporaire sur la route, √† partir de laquelle nous pouvons d√©j√† lancer le conteneur comme si rien ne s'√©tait pass√©. </p><br><p>  Sur notre projet, dans le mod√®le principal pour les services, par exemple, nous v√©rifions si le binaire est pr√©sent dans les param√®tres, et si oui, nous collectons l'image en d√©placement, sinon nous t√©l√©chargeons simplement la <code>latest</code> version de la branche <code>dev</code> .  Le code suppl√©mentaire pour la cr√©ation de conteneurs est identique pour les deux options. </p><br><h2 id="nebolshoy-primer">  Un petit exemple </h2><br><p>  Pour plus de clart√©, regardons le micro-exemple. </p><br><p>  Disons que nous √©crivons une sorte de serveur miracle (appelons-le <code>wut</code> ), qui a besoin d'une base de donn√©es pour tout y stocker.  Eh bien, comme base, nous avons choisi MongoDB.  Par cons√©quent, pour des tests complets, nous avons besoin d'un serveur Mongo fonctionnel.  Vous pouvez, bien s√ªr, l'installer et l'ex√©cuter localement, mais pour la simplicit√© et la visibilit√© de l'exemple, nous supposons que pour une raison quelconque, cela est difficile √† faire (avec d'autres configurations plus complexes dans des syst√®mes r√©els, ce sera plus comme la v√©rit√©). </p><br><p>  Nous allons donc essayer d'utiliser xenvman afin de cr√©er un environnement avec Mongo en cours d'ex√©cution et notre serveur <code>wut</code> . </p><br><p>  Tout d'abord, nous devons cr√©er un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©pertoire de base</a> dans lequel tous les mod√®les seront stock√©s: </p><br><p> <code>$ mkdir xenv-templates &amp;&amp; cd xenv-templates</code> </p> <br><p>  Ensuite, cr√©ez deux mod√®les, l'un pour Mongo, l'autre pour notre serveur: </p><br><p> <code>$ touch mongo.tpl.js wut.tpl.js</code> </p> <br><h3 id="mongotpljs">  mongo.tpl.js </h3><br><p>  Ouvrez <code>mongo.tpl.js</code> et √©crivez ce qui suit: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">tpl, params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> img = tpl.FetchImage(fmt(<span class="hljs-string"><span class="hljs-string">"mongo:%s"</span></span>, params.tag)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cont = img.NewContainer(<span class="hljs-string"><span class="hljs-string">"mongo"</span></span>); cont.SetLabel(<span class="hljs-string"><span class="hljs-string">"mongo"</span></span>, <span class="hljs-string"><span class="hljs-string">"true"</span></span>); cont.SetPorts(<span class="hljs-number"><span class="hljs-number">27017</span></span>); cont.AddReadinessCheck(<span class="hljs-string"><span class="hljs-string">"net"</span></span>, { <span class="hljs-string"><span class="hljs-string">"protocol"</span></span>: <span class="hljs-string"><span class="hljs-string">"tcp"</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">'{{.ExternalAddress}}:{{.Self.ExposedPort 27017}}'</span></span> }); }</code> </pre> <br><p>  Le mod√®le doit avoir une fonction <em>execute ()</em> avec deux param√®tres. <br>  Le premier est une instance de l'objet tpl √† travers lequel l'environnement est configur√©.  Le deuxi√®me argument (params) est juste un objet JSON avec lequel nous allons param√©trer notre mod√®le. </p><br><p>  En ligne </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> img = tpl.FetchImage(fmt(<span class="hljs-string"><span class="hljs-string">"mongo:%s"</span></span>, params.tag));</code> </pre> <br><p>  nous demandons √† xenvman de t√©l√©charger l'image du docker <code>mongo:&lt;tag&gt;</code> , o√π <code>&lt;tag&gt;</code> est la version de l'image que nous voulons utiliser.  En principe, cette ligne est √©quivalente √† la commande <code>docker pull mongo:&lt;tag&gt;</code> , √† la seule diff√©rence que toutes les fonctions de l'objet <code>tpl</code> sont essentiellement d√©claratives, c'est-√†-dire que l'image ne sera r√©ellement t√©l√©charg√©e qu'apr√®s que xenvman aura ex√©cut√© tous les mod√®les sp√©cifi√©s dans la configuration de l'environnement. </p><br><p>  Apr√®s avoir l'image, nous pouvons cr√©er un conteneur: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cont = img.NewContainer(<span class="hljs-string"><span class="hljs-string">"mongo"</span></span>);</code> </pre> <br><p>  Encore une fois, le conteneur ne sera pas cr√©√© instantan√©ment √† cet endroit, nous d√©clarons simplement l'intention de le cr√©er, pour ainsi dire. </p><br><p>  Ensuite, nous mettons une √©tiquette sur notre conteneur: </p><br><pre> <code class="javascript hljs">cont.SetLabel(<span class="hljs-string"><span class="hljs-string">"mongo"</span></span>, <span class="hljs-string"><span class="hljs-string">"true"</span></span>);</code> </pre> <br><p>  Des raccourcis sont utilis√©s pour que les conteneurs puissent se retrouver dans un environnement, par exemple, pour entrer l'adresse IP ou le nom d'h√¥te dans le fichier de configuration. </p><br><p>  Maintenant, nous devons bloquer le port Mongo interne (27017).  Cela se fait facilement comme ceci: </p><br><pre> <code class="javascript hljs"> cont.SetPorts(<span class="hljs-number"><span class="hljs-number">27017</span></span>);</code> </pre> <br><p>  Avant que xenvman ne signale la cr√©ation r√©ussie de l'environnement, il serait bon de s'assurer que tous les services ne sont pas seulement en cours d'ex√©cution, mais sont pr√™ts √† accepter les demandes.  Xenvman a des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v√©rifications de pr√©paration</a> pour cela. <br>  Ajoutez-en un pour notre conteneur mongo: </p><br><pre> <code class="javascript hljs"> cont.AddReadinessCheck(<span class="hljs-string"><span class="hljs-string">"net"</span></span>, { <span class="hljs-string"><span class="hljs-string">"protocol"</span></span>: <span class="hljs-string"><span class="hljs-string">"tcp"</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">'{{.ExternalAddress}}:{{.Self.ExposedPort 27017}}'</span></span> });</code> </pre> <br><p>  Comme nous pouvons le voir, ici dans la barre d'adresse il y a des stubs dans lesquels les valeurs n√©cessaires seront dynamiquement substitu√©es juste avant le lancement des conteneurs. </p><br><p>  Au lieu de <code>{{.ExternalAddress}}</code> adresse externe de l'h√¥te ex√©cutant xenvman sera substitu√©e, et au lieu de <code>{{.Self.ExposedPort 27017}}</code> port externe qui a √©t√© transmis au 27017 interne sera substitu√©. </p><br><p>  En savoir plus sur l'interpolation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  √Ä la suite de tout cela, nous pouvons nous connecter au Mongo fonctionnant dans l'environnement, juste √† l'ext√©rieur, par exemple, de l'h√¥te sur lequel nous ex√©cutons notre test. </p><br><h3 id="wuttpljs">  wut.tpl.js </h3><br><p>  Donc, c, apr√®s avoir trait√© de la monga, nous allons √©crire un autre mod√®le pour notre serveur <code>wut</code> . <br>  Puisque nous voulons collecter l'image en d√©placement, le mod√®le sera l√©g√®rement diff√©rent: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">tpl, params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> img = tpl.BuildImage(<span class="hljs-string"><span class="hljs-string">"wut-image"</span></span>); img.CopyDataToWorkspace(<span class="hljs-string"><span class="hljs-string">"Dockerfile"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Extract server binary var bin = type.FromBase64("binary", params.binary); img.AddFileToWorkspace("wut", bin, 0755); // Create container var cont = img.NewContainer("wut"); cont.MountData("config.toml", "/config.toml", {"interpolate": true}); cont.SetPorts(params.port); cont.AddReadinessCheck("http", { "url": fmt('http://{{.ExternalAddress}}:{{.Self.ExposedPort %v}}/', params.port), "codes": [200] }); }</span></span></code> </pre> <br><p>  Puisque nous <code>BuildImage()</code> image ici, nous utilisons <code>BuildImage()</code> au lieu de <code>FetchImage()</code> : </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> img = tpl.BuildImage(<span class="hljs-string"><span class="hljs-string">"wut-image"</span></span>);</code> </pre> <br><p>  Pour assembler l'image, nous aurons besoin de plusieurs fichiers: <br>  Dockerfile - en fait des instructions sur la fa√ßon d'assembler une image <br>  config.toml - fichier de configuration pour notre serveur <code>wut</code> </p><br><p>  Utilisation de la <code>img.CopyDataToWorkspace("Dockerfile");</code>  nous copions le Dockerfile du r√©pertoire de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">donn√©es du mod√®le</a> dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©pertoire de travail temporaire</a> . </p><br><p>  Le r√©pertoire de donn√©es est un r√©pertoire dans lequel nous pouvons stocker tous les fichiers n√©cessaires au fonctionnement de notre mod√®le. </p><br><p>  Dans le r√©pertoire de travail temporaire, nous copions les fichiers (en utilisant img.CopyDataToWorkspace ()) qui p√©n√®trent dans l'image. </p><br><p>  Ce qui suit suit: </p><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">// Extract server binary var bin = type.FromBase64("binary", params.binary); img.AddFileToWorkspace("wut", bin, 0755);</span></span></code> </pre> <br><p>  Nous passons le binaire de notre serveur directement dans les param√®tres, sous forme encod√©e (base64).  Et dans le mod√®le, nous le d√©codons simplement et enregistrons la cha√Æne r√©sultante dans le r√©pertoire de travail sous forme de fichier sous le nom <code>wut</code> . </p><br><p>  Cr√©ez ensuite un conteneur et montez-y le fichier de configuration: </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cont = img.NewContainer(<span class="hljs-string"><span class="hljs-string">"wut"</span></span>); cont.MountData(<span class="hljs-string"><span class="hljs-string">"config.toml"</span></span>, <span class="hljs-string"><span class="hljs-string">"/config.toml"</span></span>, {<span class="hljs-string"><span class="hljs-string">"interpolate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>});</code> </pre> <br><p>  Un appel √† <code>MountData()</code> signifie que le fichier <code>config.toml</code> r√©pertoire de donn√©es sera mont√© √† l'int√©rieur du conteneur sous le nom <code>/config.toml</code> .  L'indicateur d' <code>interpolate</code> indique au serveur xenvman que tous les stubs doivent √™tre remplac√©s avant le montage dans le fichier. </p><br><p>  Voici √† quoi pourrait ressembler la configuration: </p><br><pre> <code class="plaintext hljs">{{with .ContainerWithLabel "mongo" "" -}} mongo = "{{.Hostname}}/wut" {{- end}}</code> </pre> <br><p>  Ici, nous recherchons le conteneur avec le label <code>mongo</code> et substituons son nom d'h√¥te, quel qu'il soit dans cet environnement. </p><br><p>  Apr√®s substitution, le fichier peut ressembler √†: </p><br><pre> <code class="plaintext hljs">mongo = ‚Äúmongo.0.mongo.xenv/wut‚Äù</code> </pre> <br><p>  Ensuite, nous affichons √† nouveau le port et commen√ßons une v√©rification de pr√©paration, cette fois HTTP: </p><br><pre> <code class="javascript hljs">cont.SetPorts(params.port); cont.AddReadinessCheck(<span class="hljs-string"><span class="hljs-string">"http"</span></span>, { <span class="hljs-string"><span class="hljs-string">"url"</span></span>: fmt(<span class="hljs-string"><span class="hljs-string">'http://{{.ExternalAddress}}:{{.Self.ExposedPort %v}}/'</span></span>, params.port), <span class="hljs-string"><span class="hljs-string">"codes"</span></span>: [<span class="hljs-number"><span class="hljs-number">200</span></span>] });</code> </pre> <br><p>  Nos mod√®les sont pr√™ts pour cela, et nous pouvons les utiliser dans le code de test d'int√©gration: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/syhpoon/xenvman/pkg/client"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/syhpoon/xenvman/pkg/def"</span></span> <span class="hljs-comment"><span class="hljs-comment">//  xenvman  cl := client.New(client.Params{}) //      env := cl.MustCreateEnv(&amp;def.InputEnv{ Name: "wut-test", Description: "Testing Wut", // ,      Templates: []*def.Tpl{ { Tpl: "wut", Parameters: def.TplParams{ "binary": client.FileToBase64("wut"), "port": 5555, }, }, { Tpl: "mongo", Parameters: def.TplParams{"tag": ‚Äúlatest‚Äù}, }, }, }) //      defer env.Terminate() //     wut  wutCont, err := env.GetContainer("wut", 0, "wut") require.Nil(t, err) //      mongoCont, err := env.GetContainer("mongo", 0, "mongo") require.Nil(t, err) //    wutUrl := fmt.Sprintf("http://%s:%d/v1/wut/", env.ExternalAddress, wutCont.Ports[‚Äú5555‚Äù]) mongoUrl := fmt.Sprintf("%s:%d/wut", env.ExternalAddress, mongoCont.Ports["27017"]) // !      ,            ,  </span></span></code> </pre> <br><p>  Il peut sembler que l'√©criture de mod√®les prendra trop de temps. <br>  Cependant, avec la bonne conception, il s'agit d'une t√¢che unique, puis les m√™mes mod√®les peuvent √™tre r√©utilis√©s de plus en plus (et m√™me pour diff√©rentes langues!) En les affinant simplement en passant certains param√®tres.  Comme vous pouvez le voir dans l'exemple ci-dessus, le code de test lui-m√™me est tr√®s simple, car nous mettons toutes les enveloppes sur la configuration de l'environnement dans des mod√®les. </p><br><p>  Dans ce petit exemple, loin de toutes les fonctionnalit√©s de xenvman, un guide √©tape par √©tape plus d√©taill√© est disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici.</a> </p><br><h2 id="klienty">  Les clients </h2><br><p>  Il existe actuellement des clients pour deux langues: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Allez</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python</a> </p><br><p>  Mais en ajouter de nouveaux n'est pas difficile, car l'API fournie est tr√®s, tr√®s simple. </p><br><h2 id="veb-interfeys">  Interface Web </h2><br><p>  Dans la version 2.0.0, une interface Web simple a √©t√© ajout√©e avec laquelle vous pouvez g√©rer vos environnements et afficher les mod√®les disponibles. </p><br><p><img src="https://habrastorage.org/webt/mh/cp/bw/mhcpbw3wxz9rlsyk0nsonsid8_8.png"><br><img src="https://habrastorage.org/webt/7w/_w/wv/7w_wwvi6bq_tsr81bxafvb9vzo4.png"><br><img src="https://habrastorage.org/webt/cw/yr/wi/cwyrwiotyxbnrewwvp0gujta0j0.png"></p><br><h2 id="chem-xenvman-otlichaetsya-ot-docker-compose">  En quoi xenvman est-il diff√©rent de docker-compose? </h2><br><p>  Bien s√ªr, il y a beaucoup de similitudes, mais xenvman me semble une approche l√©g√®rement plus flexible et dynamique, par rapport √† la configuration statique du fichier. <br>  Voici les principales caract√©ristiques distinctives, √† mon avis: </p><br><ul><li>  Absolument tout le contr√¥le est effectu√© via l'API HTTP, donc nous pouvons cr√©er des environnements √† partir du code de n'importe quel langage qui comprend HTTP </li><li>  √âtant donn√© que xenvman peut √™tre ex√©cut√© sur un h√¥te diff√©rent, nous pouvons utiliser toutes ses fonctionnalit√©s m√™me √† partir d'un h√¥te sur lequel Docker n'est pas install√©. </li><li>  La possibilit√© de cr√©er dynamiquement des images √† la vol√©e </li><li>  La possibilit√© de modifier la composition de l'environnement (ajout / arr√™t de conteneurs) pendant son fonctionnement </li><li>  Code passe-partout r√©duit, composition am√©lior√©e et possibilit√© de r√©utiliser le code de configuration gr√¢ce √† l'utilisation de mod√®les param√©trables </li></ul><br><h2 id="ssylki">  Les r√©f√©rences </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Page du projet Github</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple d√©taill√© √©tape par √©tape, en anglais.</a> </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  C'est tout.  Dans un avenir proche, je pr√©vois d'ajouter l'opportunit√© <br>  appeler des mod√®les √† partir de mod√®les et ainsi vous permettre de les combiner avec une plus grande efficacit√©. </p><br><p>  J'essaierai de r√©pondre √† toutes vos questions et je serai heureux si quelqu'un d'autre trouve ce projet utile. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439236/">https://habr.com/ru/post/fr439236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439222/index.html">Qu'est-ce que la gestion des API?</a></li>
<li><a href="../fr439224/index.html">Encore une fois sur les diagrammes de Voronoi</a></li>
<li><a href="../fr439226/index.html">Scala + MXNet = Microservice avec neurone en prod</a></li>
<li><a href="../fr439232/index.html">JAMstack: Comment cr√©er votre propre blog en utilisant Gatsby + Contentful + Netlify</a></li>
<li><a href="../fr439234/index.html">La vie du d√©veloppeur Open Source dans les GIF</a></li>
<li><a href="../fr439238/index.html">Play Store accepte d√©sormais les applications Web progressives (PWA)</a></li>
<li><a href="../fr439240/index.html">Joomla Digest pour janvier 2019</a></li>
<li><a href="../fr439242/index.html">Autour de la b√™ta en 260 jours: comment nous avons appris √† √©couter les utilisateurs</a></li>
<li><a href="../fr439244/index.html">FAS recommande fortement de pr√©installer les logiciels russes sur les smartphones et ordinateurs portables vendus en F√©d√©ration de Russie</a></li>
<li><a href="../fr439248/index.html">Alan Kay: "Les anciens Romains pourraient-ils construire un ordinateur?"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>