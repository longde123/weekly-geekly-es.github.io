<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßîüèø üíÜüèª üèæ Integration in SAP ERP am Beispiel von Django-Python am Beispiel des oData (Rest) -Protokolls üòª üë∑ ‚ò†Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, Habr! 

 Das Thema der Integration gro√üer Systeme wie SAP in kleine, aber flexiblere Systeme bestand sozusagen darin, das Beste aus beiden ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integration in SAP ERP am Beispiel von Django-Python am Beispiel des oData (Rest) -Protokolls</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426611/"> Guten Tag, Habr! <br><br>  Das Thema der Integration gro√üer Systeme wie SAP in kleine, aber flexiblere Systeme bestand sozusagen darin, das Beste aus beiden herauszuholen. <br><br>  In meinem Beispiel wird insbesondere die Integration von SAP ERP in Django beschrieben. <br><br><h4>  Herausforderung </h4><br>  Aufgrund der vielen verschiedenen Steuerungssysteme, die unser geliebter Staat eingef√ºhrt hat: Egais, Mercury und vieles mehr, haben viele Unternehmen begonnen, ihre schweren und leicht ungeschickten Systeme (f√ºr gro√üe Unternehmen) an neue Bedingungen anzupassen.  Ich werde nicht sagen, welche ich speziell angepasst habe, aber der Gedanke drehte sich immer in meinem Kopf - ein einheitliches Tracking-System f√ºr alles auf der Basis einer separaten Plattform zu schaffen. <br><br><h4>  Mittel </h4><br>  Ich habe mich nicht f√ºr die Auswahl der Tools entschieden und mich f√ºr Folgendes entschieden: Python-Programmiersprache - Angesichts der F√ºlle an Bibliotheken mit allem und jedem, der Django-Plattform, fragen Sie nicht, warum Django, nicht Flask oder Odoo.  Ich habe Odoo bereits f√ºr die Plattform genommen und wollte eines davon studieren. Ich habe das erste genommen. Nun, ich wei√ü nicht warum, wahrscheinlich wegen seiner gr√∂√üeren Einfachheit.  ERP-System f√ºr die Entwicklung von SAP - hier hatte ich eigentlich keine Wahl, weil  Ich arbeite f√ºr ein SAP-Integrator-Unternehmen, habe also sowohl Wissen als auch Zugriff auf die Sandboxen dieses Systems, sodass ich alle Voraussetzungen habe, um meine Arbeit ungehindert und ruhig zu erledigen. <br><a name="habracut"></a><br><h4>  Frontend Django </h4><br>  Das erste, mit dem ich angefangen habe, war, eine bestimmte Aufgabe zu formulieren und auf ein Blatt Papier zu schreiben. Im Allgemeinen rate ich jedem, bevor er etwas codiert und den Prozess beschreibt. Es ist SEHR wichtig, wenn Sie es unterwegs √§ndern, √§ndern Sie es auch in der Beschreibung. <br><br>  Hier ist die erste <b>SEHR</b> grobe Version der Programmbeschreibung. <br><blockquote>  <b>Ausgehender Prozess</b> <br><br>  1) Auslieferung wird erstellt. <br><br>  2) Beim Durchf√ºhren von Paletten durch das Tor - Automatikbetrieb und halbautomatischer Betrieb <br><br>  a.  Automatischer Betrieb / Wenn eine Palette das Tor passiert, fordert das Programm von RFC im WMS-System Informationen √ºber die Art der Lieferung und deren Nummer an und sendet eine Identifikationsantwort auf die Lieferung an das WMS-System zur√ºck (best√§tigt m√∂glicherweise Lageraufgaben (Kommissionieraufgaben) daf√ºr Palette und alle Investitionen).  √úberpr√ºft auch alle Verbrauchsteuerstempel mit Informationen im WMS-System <br><br>  b.  Halbautomatischer Betrieb / Der Bediener gibt die Liefer- / Maschinennummer in das Torsystem ein und treibt die Paletten durch das Tor. Das Torsystem sendet eine Anforderung f√ºr jede Palette an das WMS-System zur √úberpr√ºfung der verbrauchsteuerpflichtigen Stempel im Inneren. <br><br>  3) Die Zusammensetzung der Lieferung wird an das Buchhaltungssystem gesendet <br><br>  <b>Eingehender Prozess</b> <br><br>  1) Anlieferung wird erstellt. <br><br>  2) Palettendurchgang durch das Tor <br><br>  3) An das Buchhaltungssystem wird eine Anfrage bez√ºglich der Zusammensetzung der Forderung im aktuellen Lager gesendet <br><br>  4) Die interne Zusammensetzung der Palette der Verbrauchsteuerstempel wird anhand dieses Abrechnungssystems √ºberpr√ºft <br><br>  5) Zum Entladen von Paletten wird ein Signal an das WMS-System gesendet. <br><br>  <b>Erforderliche Tabellen</b> : <br><br>  Tor: <br>  Kennung <br>  Lager: <br>  Beschreibung <br>  <b>Passage Nachricht</b> : <br><br>  Titel: <br>  Zeit, System, Lagernummer, Gate-ID. <br>  Position: <br>  Verbrauchsteuerstempel, Anmeldezeit, Titelbindung <br>  <b>ERP-Kompositionsnachricht (Anlieferung)</b> <br><br>  Titel: <br>  Zeit, System, Lieferungsnummer, <br>  Position: <br>  Material, Verbrauchsteuerstempel, Palettennummer (falls vorhanden) <br><br>  <b>Aggregierte Nachricht (basierend auf ERP-Daten)</b> : <br><br>  Titel: <br><br>  Zeit, System, Lagernummer, Gate-ID, Lieferungsnummer aus dem Buchhaltungssystem, Wegweiser (eingehend ausgehend), Verifizierungsskriptzeichen, Maschinennummer, Warehouse-Gate-Nummer, <br><br>  Position: Verbrauchsteuerstempel, Palettennummer (optional), Material (optional), Lieferungsnummer, Maschinennummer, Artikelnummer im Dokument, Charge (optional), Verpackung (optional) <br></blockquote>  Als n√§chstes lernte ich Django und zeichnete einen Prozess und ein Datenbankschema. <br>  Wie sich in Django herausstellte, ist das Erstellen von Tischmodellen sehr einfach und bequem. Es sieht ungef√§hr so ‚Äã‚Äãaus: <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SapOptions</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(models.Model)</span></span></span><span class="hljs-class">:</span></span> name = models.CharField(verbose_name=<span class="hljs-string"><span class="hljs-string">' '</span></span>, max_length=<span class="hljs-number"><span class="hljs-number">50</span></span>) baseurl = models.CharField(max_length=<span class="hljs-number"><span class="hljs-number">500</span></span>, verbose_name=<span class="hljs-string"><span class="hljs-string">'Url  '</span></span>, help_text = <span class="hljs-string"><span class="hljs-string">'URL  ,  ,  :"https://moses1005:44300/sap/opu/odata/sap/ZLS_SUPPLYCHAIN_SRV/"'</span></span>)<span class="hljs-comment"><span class="hljs-comment">#  URL sapset = models.CharField(default='Enter Sapset', max_length=100, verbose_name=' ()') mandt = models.CharField(max_length=3, verbose_name='') user = models.CharField(max_length=15, verbose_name='       ') passwd = models.CharField(max_length=15, verbose_name='') verify = models.BooleanField(default=False, help_text = '   ') def __str__(self): return ': '+self.name + ',  : '+self.mandt class Gates(models.Model): from mainAPP.sap_connector import get_lgorts_fromsap ident = models.CharField(verbose_name='', max_length=10, help_text='',unique=True) wh = models.CharField(verbose_name='  ', default='',max_length=10, help_text='   WMS') help = models.CharField(verbose_name='', default='',max_length= 500,help_text=' , ,  ,   ') try: lgorts = get_lgorts_fromsap() except: lgorts = [('No Connect', 'No Connect'),] lgort = models.CharField(verbose_name='',default='0000', max_length=20, choices=lgorts) def __str__(self): return self.ident +' : '+self.wh+' : '+self.help</span></span></code> </pre> <br>  Danach habe ich bereits verstanden, wie man Verzeichnisse aus SAP abruft, so dass die Integration v√∂llig "nahtlos" schien, das Schl√ºsselwort "schien", aber dazu sp√§ter mehr. <br><br>  Nachdem ich Django gelernt hatte (heute Abend einige get√∂tet), schrieb ich eine Schnittstelle zum Eingeben von Informationen und zum Senden an SAP ERP. <br><br>  Der erste Bildschirm zur Eingabe von Akzeptanzinformationen sieht folgenderma√üen aus: <br><br><img src="https://habrastorage.org/webt/cx/3v/ci/cx3vci4bzz4zh72c4ivloz4biny.jpeg"><br><br><ul><li>  Warehouse - direkte Integration in SAP ERP mit einer kurzen Beschreibung, </li><li>  ERP-Lieferung - Eine Lieferung aus SAP ERP wird eingegeben und bei der Eingabe √ºberpr√ºft (eine Anfrage an SAP wird gestellt, ob eine solche Lieferung vorliegt oder nicht). </li><li>  TTN - hier ist alles klar (Frachtbrief), </li><li>  Partnernummer - Dies ist die Partnernummer von SAP ERP. Das Feld ist optional und wird f√ºr die Zukunft erstellt, um eine Lieferung zu finden. </li><li>  Paketkennung - Dies ist eines der wichtigsten Felder, dies ist die Nummer der Palette oder des Pakets. </li></ul><br>  Die Schnittstelle ist auch f√ºr ein mobiles Endger√§t (TSD) angepasst. <br><br><img src="https://habrastorage.org/webt/b6/hs/ob/b6hsobjjorhs7vydoygkbz3bmu8.jpeg"><br><br>  Die Felder werden so erstellt, dass der Cursor nach jedem Dr√ºcken von ENTER zum n√§chsten Eingabefeld springt, so dass es bequem w√§re, alle Informationen von TTN, Gate, Pallet zu scannen. <br><br>  Nach dem Scannen des letzten Felds oder dem Klicken auf "Speichern" wechselt der Bildschirm zum Dialogfeld zur Eingabe der Kennungen der einzelnen Produkte: <br><br><img src="https://habrastorage.org/webt/kk/hu/0l/kkhu0l-iw8c2z95gk9ui-pcv3na.jpeg"><br><br>  Felder: <br><br><ol><li>  Dies ist ein Bildschirm der Liste der vom EGAIS-System selbst gesendeten Kennungen, wobei die Rott√∂ne die noch nicht gescannten Kennungen sind, Gelb die gescannten Kennungen, die jedoch nicht in der EGAIS-Nachricht enthalten waren, und die gr√ºnen die vom EGAIS gesendeten und gescannten Kennungen </li><li>  Wenn Sie Bezeichner eingeben, finden Sie hier auch die Schaltfl√§che ‚Äû+‚Äú, die f√ºr die Anzeige eines anderen Felds usw. erforderlich ist. </li><li>  Zeigen Sie ggf. Fehlermeldungen an. </li></ol><br><h4>  Implementierung der Integration: </h4><br>  F√ºr die Integration von Django ist alles klar. ‚ÄûRest‚Äú ist einfach zu implementieren, aber von SAP ERP musste ich ein wenig lesen. <br><br>  Wie wird das gemacht, wie ist es nicht sehr schwierig? <br><br>  1) Es ist erforderlich, eine Integrationsklasse f√ºr die Implementierung bzw. ein Entwicklungspaket daf√ºr zu erstellen.  Dies erfolgt in der Transaktion SEGW <br><br><img src="https://habrastorage.org/webt/kk/oa/uu/kkoauu4havyfpbmyprqnhie4ncg.jpeg"><br><br>  2) Nach dem Anlegen der Klasse m√ºssen Sie das Datenmodell definieren, es gibt verschiedene M√∂glichkeiten, eigene Felder anlegen oder in der Tabelle auf SAP klicken.  Dies bedeutet, dass Sie vor dem Erstellen eines Datenmodells f√ºr die Integration eine Tabelle f√ºr die Daten erstellen m√ºssen. Dies erfolgt in der Transaktion SE11. Informationen dazu finden Sie im Internet.  Also, wie die Struktur, <br><br><img src="https://habrastorage.org/webt/sw/xe/5_/swxe5_rjpvpxehvwuseuhumuty4.jpeg"><br><br>  Ich mag die Tabellenstruktur, die ich bereits erstellt habe <br><br><img src="https://habrastorage.org/webt/nr/np/1r/nrnp1rrodp_uoyh6m5ivjujymeo.jpeg"><br><br>  3) Hier ist die Arbeit, die wir geleistet haben: <br><br><img src="https://habrastorage.org/webt/qn/_d/9x/qn_d9xptayqbqnlb6xxk4voygfu.jpeg"><br><br>  Klicken Sie auf "Generieren". Die Klasse hat die f√ºr die Integration erforderliche Struktur generiert, und wir werden damit arbeiten. <br><br>  4) Als N√§chstes wird auf unserer Registerkarte "Service-Implementierung" unsere Struktur mit allen ihr zur Verf√ºgung stehenden Methoden angezeigt, insbesondere: <br><br>  a.  Erstellen - Methode zum Erstellen eines Datensatzes in unserer Tabelle anhand der von au√üen gesendeten Daten <br>  b.  L√∂schen - Methode zum L√∂schen von Datens√§tzen nach Kennung <br>  c.  GetEntity - Single Record Request-Methode <br>  d.  GetEntitySet - Methode zum Abrufen mehrerer Datens√§tze nach Kriterien <br>  e.  Update - Datensatz√§nderungsmethode <br>  Tats√§chlich sind alle diese Methoden ziemlich abstrakt, aber nat√ºrlich gibt es Unterschiede <br><br>  5) Nach dem Generieren der Klasse erstellen wir eine Liste der Klassen im Zweig Runtime Artifacts. W√§hlen Sie am Ende die Klasse mit DPC_EXT aus <br><br><img src="https://habrastorage.org/webt/hj/tk/wb/hjtkwb3idr9vx-ixoxwt4sxvxok.jpeg"><br>  Doppelklicken Sie, um in die Klasse selbst zu gelangen <br><br>  6) Nachdem Sie in die Liste der Klassenmethoden aufgenommen wurden, sehen Sie am Ende eine Liste aller Methoden. Definieren Sie sie neu. Andernfalls wird nach der n√§chsten √Ñnderung des Datenmodells alles gel√∂scht. Ich bin darauf gesto√üen, es war beleidigend ... <br><br><img src="https://habrastorage.org/webt/sd/er/cy/sdercy8c6na4bc_ocvleabuabok.jpeg"><br>  Zum Beispiel werde ich die Implementierung der Create-Methode zeigen <br><br><img src="https://habrastorage.org/webt/hc/7k/tq/hc7ktqnmwk-dw2gcefxour8rl6m.jpeg"><br><br>  Alles ist sehr einfach, IT_KEY_TAB wird in die Eingabe eingespeist und basierend auf diesen Daten implementieren wir einige Aktionen, in diesem Code einen regul√§ren Datensatz in der Tabelle oder eine Fehlerausgabe, die dann an Django √ºbertragen werden.  Die Ausgabe der erfolgreichen Erstellung wird in die Struktur ER_ENTITY geschrieben. <br><br>  7) Testen unserer Schnittstelle in Transaktion / IWFND / MAINT_SERVICE, lange.  Wir gehen hinein, finden unsere Klasse erstellt und klicken auf "SAP Gateway Client". <br><br><img src="https://habrastorage.org/webt/t1/_5/ek/t1_5ekysdkj8qya8byuclvvfk9i.jpeg"><br><br>  Wir werden im Wesentlichen mit den Webanforderungen EMULATOR GET \ POST \ PUT \ DELETE nur von SAP ge√∂ffnet. <br><br>  PS. Sie k√∂nnen den erstellten Dienst in allem testen. Ich teste im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Postbotenprogramm</a> <br><br><img src="https://habrastorage.org/webt/ds/-5/2h/ds-52hhqphdejb_2s8rujel19z0.jpeg"><br><br>  So sieht die Get-Anfrage aus: "GetEntitySet" <br>  <i>/ sap / opu / odata / sap / ZLS_SUPPLYCHAIN_SRV / ZLS_INBOUND_HEADSet? $ format = json</i> <br>  Wo: <br>  <b><i>/ ZLS_SUPPLYCHAIN_SRV /</i></b> - Dies ist unsere erstellte Klasse <br>  <b><i>/ ZLS_INBOUND_HEADSet</i></b> ist unser Datenmodell, <br>  <b><i>format = json</i></b> ist das Datenformat, das wir erhalten, die Wahl von xml oder json, ich w√§hle json, weil es deshalb f√ºr mich bequemer ist. <br><br>  8) Ebenso schreiben wir Methoden <br><br>  Was wir haben, eine Front auf Django erstellt, hat eine Schnittstelle auf der SAP-Seite erstellt <br>  Jetzt m√ºssen wir alles wiederbeleben, und auf der Django-Seite schreiben wir die Methoden: <br><br>  1) Die Methode zum Erstellen einer Sitzung, um sich anzumelden, scrf-Token zu erhalten und schon weiter <br>  Ziehen Sie die erforderlichen Informationen √ºber unsere konfigurierte Schnittstelle aus der Datenbank oder erstellen Sie eine neue <br>  aufnehmen.  Erstellen Sie dazu eine separate Datei in Django, die ich Sap_connector.py nannte und beschrieben habe <br>  Darin sind die Hauptmethoden. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sap_createSession</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     oDATA from scanner.models import SapOptions #   SAP sap_opt = SapOptions.objects.all()[0] #       s = requests.Session() s.headers.update({'Connection': 'keep-alive', 'X-CSRF-TOKEN': 'Fetch'}) auth = (sap_opt.user, sap_opt.passwd) try: r = s.get(sap_opt.baseurl, auth=auth,verify=sap_opt.verify) except: message = "    %s %s"%(sap_opt.mandt, sap_opt.name) return ('NO TOKEN', 'NoSession', message) token = r.headers['x-csrf-token'] session = s sess = (token, session, None) return sess</span></span></code> </pre><br>  2) Liefer√ºberpr√ºfungsmethode in SAP ERP <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sap_delivery_verify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token, session, delivery)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      ERP from scanner.models import SapOptions, Gates sap_opt = SapOptions.objects.all()[0] s = session format = '?$format=json' set = 'likpSet' url = sap_opt.baseurl + set + "('"+delivery+"')"+format headers = {'Content-type': 'application/json;charset=utf-8', 'X-CSRF-TOKEN': token} #      auth = (sap_opt.user, sap_opt.passwd) # auth get = s.get(url, headers=headers, auth=auth,verify=sap_opt.verify)#   if get.status_code ==200: delivery_out = json.loads(get.text).get('d').get('Vbeln') return (True, 'OK') else: error_text = json.loads(get.text).get('error').get('message').get('value') return (False, error_text)</span></span></code> </pre> <br>  3) Die Methode zur Integration von SAP-Lagern in Django <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_lgorts_fromsap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scanner.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SapOptions session = sap_createSession() <span class="hljs-comment"><span class="hljs-comment">#   token = session[0] session = session[1] sap_opt = SapOptions.objects.all()[0] #   s = session format = '?$format=json' set = 't001lSet' url = sap_opt.baseurl + set +format headers = {'Content-type': 'application/json;charset=utf-8', 'X-CSRF-TOKEN': token} #      auth = (sap_opt.user, sap_opt.passwd) # auth get = s.get(url, headers=headers, auth=auth,verify=sap_opt.verify)#   jdata = json.loads(get.text) lgorts = [] for l in jdata.get('d').get('results'): l.get('lgort') lgorts.append((l.get('Lgort'),l.get('Lgort'))) return lgorts</span></span></code> </pre><br>  <b>Und sein zweiter Teil im Modellteil:</b> <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gates</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(models.Model)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mainAPP.sap_connector <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_lgorts_fromsap ident = models.CharField(verbose_name=<span class="hljs-string"><span class="hljs-string">''</span></span>, max_length=<span class="hljs-number"><span class="hljs-number">10</span></span>, help_text=<span class="hljs-string"><span class="hljs-string">''</span></span>,unique=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) wh = models.CharField(verbose_name=<span class="hljs-string"><span class="hljs-string">'  '</span></span>, default=<span class="hljs-string"><span class="hljs-string">''</span></span>,max_length=<span class="hljs-number"><span class="hljs-number">10</span></span>, help_text=<span class="hljs-string"><span class="hljs-string">'   WMS'</span></span>) help = models.CharField(verbose_name=<span class="hljs-string"><span class="hljs-string">''</span></span>, default=<span class="hljs-string"><span class="hljs-string">''</span></span>,max_length= <span class="hljs-number"><span class="hljs-number">500</span></span>,help_text=<span class="hljs-string"><span class="hljs-string">' , ,  ,   '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   SAP lgorts = get_lgorts_fromsap() except: lgorts = [('No Connect', 'No Connect'),] lgort = models.CharField(verbose_name='',default='0000', max_length=20, choices=lgorts) def __str__(self): return self.ident +' : '+self.wh+' : '+self.help</span></span></code> </pre><br>  Die Integration sieht folgenderma√üen aus: Wenn ich in den Django-Einstellungen ein neues Lager anlege, zeigt das System die Lager aus dem SAP-ERP an, die derzeit dort im Lagerfeld angelegt sind. <br><br><img src="https://habrastorage.org/webt/bh/yn/9n/bhyn9noryaek8d8p1kxvnlsofe0.jpeg"><br><br>  4) Methode zum Anlegen eines neuen Datensatzes in SAP ERP <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sap_connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token, session, data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scanner.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SapOptions, Gates <span class="hljs-comment"><span class="hljs-comment">#      SAP ERP sap_opt = SapOptions.objects.all()[0] s = session delivery = data.get('delivery') url = sap_opt.baseurl + sap_opt.sapset #  URL +    headers = {'Content-type': 'application/json;charset=utf-8', 'X-CSRF-TOKEN': token} #      auth = (sap_opt.user, sap_opt.passwd) # auth data =json.dumps({"d":{ "Mandt": sap_opt.mandt, "Lgort": Gates.objects.get(id=data.get('gates')).wh, "Vbeln":data.get('delivery'), "Mark": data.get('mark'), "Matnr": "", "Posnr": "", "Mbl": "", "InbDicid":"AAAAAAAAAAAAAAAAAAAAAA==", "DocExt": data.get('ttn'), "Exidv": data.get('pack') }}) try: r2 = s.post(url, data=data, headers=headers, auth=auth) except: return (False, '   ') if r2.status_code ==201: print(' %s   '%(delivery)) return (True, '  %s : '%delivery) else: print('  %s   '%(delivery)) text = r2.text SO = soup(text) s = SO.find_all("message")[0].text return (False, s)</span></span></code> </pre> <br>  Tats√§chlich stellen wir einfach eine POST-Anfrage und schreiben dort die Daten im JSON-Format <br><br><h4>  Fazit </h4><br>  Wir haben ein in SAP ERP integriertes Programm mit einem einfachen Szenario erstellt. <br>  Das Auto kommt an, wir geben Informationen zu jeder Palette in die Schnittstelle ein, das Programm pr√ºft f√ºr uns, ob alle Daten korrekt eingegeben wurden, und gibt Auskunft dar√ºber, was sein soll und was bereits eingegeben wurde.  Nach Eingabe der Daten wird berichtet, was getan wurde, und die Daten werden an SAP ERP √ºbertragen.  Diese Schnittstelle ist auch an mobile Dateneingabeschnittstellen angepasst, was f√ºr Lager mit Datenerfassungsterminals (TSD) wichtig ist.  Nach der √úbertragung der Daten an ERP speichert das System auch alle Daten, in welches Lager, welche Kennung, welche Art von Kennung, wer sie akzeptiert hat usw. <br><br>  Aus diesem Grund verf√ºgen wir √ºber ein Programm zur Verarbeitung eingehender und ausgehender Produktkennungen im Unternehmen, w√§hrend 90% aller Arbeiten in einem externen System ausgef√ºhrt werden, das in das Hauptsystem integriert ist. <br><br>  In Zukunft muss es f√ºr die Pflege eingehender Chargen, Seriennummern und anderer Dinge fertiggestellt werden und noch enger in SAP integriert werden, um beispielsweise eine Quittungstransaktion √ºber diese Schnittstelle zu erstellen. Nun, dies ist ein Gedanke f√ºr die Entwicklung :) <br><br>  <i>PS Ich habe den ABAP- oder Python-Django-Code dieser Arbeitsl√∂sung nicht gezeichnet, ich habe die Django- oder HTML-Vorlageneinstellungen nicht gezeichnet, sondern mich auf die Integration mit SAP ERP konzentriert, um zu zeigen, dass das Erstellen eines Moduls f√ºr die Verbindung mit einem so gro√üen System wie SAP nicht schwierig ist Ich ging zu einem solchen System, wenn wir das Studium von Django f√ºr ungef√§hr 4 Abende mit einbeziehen.</i> <br><br>  <b>Vielen Dank f√ºr Ihre Aufmerksamkeit, ich bin dankbar f√ºr konstruktive Kritik!</b> <b><br></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426611/">https://habr.com/ru/post/de426611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426595/index.html">Richard Hamming "Nicht existierendes Kapitel": Wie wir wissen, was wir wissen (1-10 Minuten von 40)</a></li>
<li><a href="../de426597/index.html">Madrobots auf der IFA 2018. Teil 2 - Intelligente Projektoren: Von XGIMI zu Anker</a></li>
<li><a href="../de426603/index.html">Spinnspirale: Mathematik und Halluzinationen</a></li>
<li><a href="../de426605/index.html">Statische Analyse von PHP-Code am Beispiel von PHPStan, Phan und Psalm</a></li>
<li><a href="../de426609/index.html">Office 365 und andere MS-Produkte f√ºgen Sprach-E / A f√ºr Legastheniker hinzu</a></li>
<li><a href="../de426613/index.html">Lassen Sie den 3D-Drucker nicht faul sein</a></li>
<li><a href="../de426615/index.html">Schreiben einer CLI auf NodeJS</a></li>
<li><a href="../de426617/index.html">F√ºhrerschein zum Autofahren oder warum Anwendungen Single-Activity sein sollten</a></li>
<li><a href="../de426621/index.html">Kompakte Zeichenfolgen in Java 9</a></li>
<li><a href="../de426623/index.html">Dies ist ein elektrischer Bus: Was wissen wir √ºber den Transport mit einer Batterie?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>