<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯдж ЁЯХз ЁЯФК Microsoft Excel рдкрдВрдХреНрддрд┐ рд╣рд╛рдЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ ЁЯТв ЁЯФд ЁЯзЬЁЯП╗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдХрднреА-рдХрднреА рдореИрдВ рдКрдм рдЬрд╛рддрд╛ рд╣реВрдВ рдФрд░ рдПрдХ рдбрд┐рдмрдЧрд░ рд╕реЗ рд▓реИрд╕ рд╣реЛрдХрд░, рдореИрдВ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдореЗрдВ рдЦреБрджрд╛рдИ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реВрдВред рдЗрд╕ рдмрд╛рд░, рдореЗрд░реА рдкрд╕рдВрдж рдПрдХреНрд╕реЗрд▓ рдкрд░ рдЧрд┐рд░ рдЧрдИ рдФрд░ рдореИрдВ рдпрд╣...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Microsoft Excel рдкрдВрдХреНрддрд┐ рд╣рд╛рдЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435426/"><p> рдХрднреА-рдХрднреА рдореИрдВ рдКрдм рдЬрд╛рддрд╛ рд╣реВрдВ рдФрд░ рдПрдХ рдбрд┐рдмрдЧрд░ рд╕реЗ рд▓реИрд╕ рд╣реЛрдХрд░, рдореИрдВ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдореЗрдВ рдЦреБрджрд╛рдИ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реВрдВред  рдЗрд╕ рдмрд╛рд░, рдореЗрд░реА рдкрд╕рдВрдж рдПрдХреНрд╕реЗрд▓ рдкрд░ рдЧрд┐рд░ рдЧрдИ рдФрд░ рдореИрдВ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдЗрдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ, рдпрд╣ рдХреНрдпрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╕реАрдорд╛ рдХреА рдКрдВрдЪрд╛рдИ рдХреИрд╕реЗ рдорд╛рдирддрд╛ рд╣реИ, рдЖрджрд┐ред  рдореИрдВрдиреЗ Excel 2010 (excel.exe, 32bit, рд╕рдВрд╕реНрдХрд░рдг 14.0.4756.1000, SHA1 a805cf60a5542f21001b0ea5d142d1cd0ee00b28) рдХреЛ рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ред </p><a name="habracut"></a><br><h2 id="nachnyom-s-teorii">  рд╕рд┐рджреНрдзрд╛рдВрдд рд╕реЗ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ </h2><br><p>  рдпрджрд┐ рдЖрдк Microsoft Office рдХреЗ рд▓рд┐рдП VBA рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдХреА рдУрд░ рдореБрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкрдВрдХреНрддрд┐ рдХреА рдКрдБрдЪрд╛рдИ рдХреЛ рджреЛ рдЧреБрдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдпрд╛ рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" title="RowHeight">рд░реЛрд╣рд╛рдЗрдЯ</a> - рд░рд┐рдЯрд░реНрди рдпрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реАрдорд╛ рдореЗрдВ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЕрдВрдХ рдореЗрдВ рдорд╛рдкрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдбрдмрд▓ рдкрдврд╝реЗрдВ / рд▓рд┐рдЦреЗрдВ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" title="рдКрдВрдЪрд╛рдИ">рдКрдБрдЪрд╛рдИ</a> - рдПрдХ рджреЛрд╣рд░рд╛ рдорд╛рди рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдЬреЛ рдКрдВрдЪрд╛рдИ рдХрд╛, рдЕрдВрдХреЛрдВ рдореЗрдВ, рд╕реАрдорд╛ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред  рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдПред </li></ul><br><p>  рдФрд░ рдЕрдЧрд░ рдЖрдк рдпрд╣рд╛рдВ рднреА рджреЗрдЦрддреЗ рд╣реИрдВ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" title="рдПрдХреНрд╕реЗрд▓ рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдФрд░ рд╕реАрдорд╛рдПрдБ">рдПрдХреНрд╕реЗрд▓ рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдФрд░ рд╕реАрдорд╛рдПрдВ</a> ред  рдЖрдк рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдзрд┐рдХрддрдо рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ 409 рдЕрдВрдХ рд╣реИред  рдпрд╣, рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдПрдХрдорд╛рддреНрд░ рдорд╛рдорд▓реЗ рд╕реЗ рдмрд╣реБрдд рджреВрд░ рд╣реИ рдЬрдм рдЖрдзрд┐рдХрд╛рд░рд┐рдХ Microsoft рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдереЛрдбрд╝реЗ рднреНрд░рд╛рдордХ рд╣реИрдВред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрдХреНрд╕реЗрд▓ рдХреЛрдб рдореЗрдВ, рдЕрдзрд┐рдХрддрдо рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ 2047 рдкрд┐рдХреНрд╕реЗрд▓ рдкрд░ рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдЕрдВрдХреЛрдВ рдореЗрдВ 1535.25 рд╣реЛрдЧреАред  рдФрд░ рдЕрдзрд┐рдХрддрдо рдлрд╝реЙрдиреНрдЯ рдЖрдХрд╛рд░ 409.55 рдЕрдВрдХ рд╣реИред  рдХреЗрд╡рд▓ VBA / Interop рдореЗрдВ рдЗрд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдЗрддрдиреА рдмрдбрд╝реА рдКрдВрдЪрд╛рдИ рдХреА рдПрдХ рдкрдВрдХреНрддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдПрдХ рдкрдВрдХреНрддрд┐ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдкрдиреА рдкрд╣рд▓реА рд╕реЗрд▓ рдореЗрдВ рдХрдореНрдмреНрд░рд┐рдпрд╛ рдорда рдлрд╝реЙрдиреНрдЯ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд╝реЙрдиреНрдЯ рдЖрдХрд╛рд░ 409.55 рдЕрдВрдХ рдкрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдлрд┐рд░ рдЕрдкрдиреЗ рдЪрд╛рд▓рд╛рдХ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЗ рд╕рд╛рде рдПрдХреНрд╕реЗрд▓ рд╕реЗрд▓ рдкреНрд░рд╛рд░реВрдк рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдЧрд╛, 2047 рдкрд┐рдХреНрд╕рд▓ (рд╢рдмреНрдж рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕) рд╕реЗ рдЕрдзрд┐рдХ рдореЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛, рдФрд░ рдкрдВрдХреНрддрд┐ рдХреЛ рдЕрдзрд┐рдХрддрдо рд╕рдВрднрд╡ рдКрдВрдЪрд╛рдИ рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ред  рдпрджрд┐ рдЖрдк UI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рдКрдВрдЪрд╛рдИ рдкреВрдЫрддреЗ рд╣реИрдВ, рддреЛ рдПрдХреНрд╕реЗрд▓ рдЭреВрда рдмреЛрд▓реЗрдЧрд╛ рдХрд┐ рдКрдВрдЪрд╛рдИ 409.5 рдЕрдВрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк VBA рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреА рдКрдВрдЪрд╛рдИ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдИрдорд╛рдирджрд╛рд░ 1535.25 рдЕрдВрдХ рдорд┐рд▓рддреЗ рд╣реИрдВ, рдЬреЛ 2047 рдкрд┐рдХреНрд╕реЗрд▓ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИред  рд╕рдЪ рд╣реИ, рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдмрдЪрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдКрдВрдЪрд╛рдИ рдЕрднреА рднреА 409.5 рдЕрдВрдХ рддрдХ рдЧрд┐рд░ рдЬрд╛рдПрдЧреАред  рдЗрд╕ рд╣реЗрд░рдлреЗрд░ рдХреЛ рдЗрд╕ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рдпрд╣рд╛рдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http://recordit.co/ivnFEsELLI</a> </p><br><p>  рдореИрдВрдиреЗ рдПрдХ рдХрд╛рд░рдг рд╕реЗ рдкрд┐рдЫрд▓реЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рдкрд┐рдХреНрд╕рд▓ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рд╣реИред  рдПрдХреНрд╕реЗрд▓ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдореЗрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ (рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдореЗрдВ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рд╕рдм рдХреБрдЫ рдХрд░рддрд╛ рд╣реИ)ред  рдЬреНрдпрд╛рджрд╛рддрд░ рдЕрдХреНрд╕рд░ рдпреЗ рдХрд┐рд╕реА рди рдХрд┐рд╕реА рдХрд╛рд░рдХ рд╕реЗ рдЧреБрдгрд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ, рдПрдХреНрд╕реЗрд▓ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЕрдВрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдкреИрдорд╛рдиреЗ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 75% рдХреЗ рдкреИрдорд╛рдиреЗ рдХреЛ рджреЛ рдирдВрдмрд░ 3 рдФрд░ 4 рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдФрд░ рдЬрдм рдкрдВрдХреНрддрд┐ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛, рддреЛ рдПрдХреНрд╕реЗрд▓ рдкрдВрдХреНрддрд┐ рдХреЛ рдкрд┐рдХреНрд╕реЗрд▓ рдХреЗ рдкреВрд░реНрдгрд╛рдВрдХ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗ рдЬрд╛рдПрдЧрд╛, 3 рд╕реЗ рдЧреБрдгрд╛ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВ 4. 4. рд▓реЗрдХрд┐рди рд╡рд╣ рдЗрд╕ рдСрдкрд░реЗрд╢рди рдХреЛ рдкрд╣рд▓реЗ рд╣реА рдЕрдВрдЬрд╛рдо рдкрд░ рдкрд╣реБрдВрдЪрд╛ рджреЗрдЧрд╛ред рдЗрд╕рд╕реЗ рдпрд╣ рдкреНрд░рднрд╛рд╡ рдкреИрджрд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╕рдм рдХреБрдЫ рднрд┐рдиреНрдирд╛рддреНрдордХ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, VBA рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рд▓рд┐рдЦреЗрдВ: </p><br><pre><code class="vbscript hljs">w.Rows(<span class="hljs-number"><span class="hljs-number">1</span></span>).RowHeight = <span class="hljs-number"><span class="hljs-number">75.375</span></span> Debug.Print w.Rows(<span class="hljs-number"><span class="hljs-number">1</span></span>).Height</code> </pre> <br><p>  VBA 75 рджреЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐  75.375 рдкрд┐рдХреНрд╕реЗрд▓ 100.5 рдкрд┐рдХреНрд╕реЗрд▓ рд╣реЛрдВрдЧреЗ, рдФрд░ рдПрдХреНрд╕реЗрд▓ рдЗрд╕реЗ рдмрд░реНрджрд╛рд╢реНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ 100 рдкрд┐рдХреНрд╕реЗрд▓ рддрдХ рдХрд╛ рдЖрдВрд╢рд┐рдХ рднрд╛рдЧ рдЧрд┐рд░рд╛ рджреЗрдЧрд╛ред  рдЬрдм рд╡реАрдмреАрдП рдЕрдВрдХреЛрдВ рдореЗрдВ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдкреВрдЫрддрд╛ рд╣реИ, рддреЛ рдПрдХреНрд╕реЗрд▓ рдИрдорд╛рдирджрд╛рд░реА рд╕реЗ рдЕрдВрдХреЛрдВ рдореЗрдВ 100 рдкрд┐рдХреНрд╕рд▓ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИ рдФрд░ 75 рд░рд┐рдЯрд░реНрди рдХрд░рддрд╛ рд╣реИред </p><br><p>  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╣рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА C # рдореЗрдВ рдПрдХ рд╡рд░реНрдЧ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛ рдЧрдП рд╣реИрдВ рдЬреЛ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╡рд░реНрдгрди рдХрд░реЗрдЧрд╛: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RowHeightInfo</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> Value { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//    ,   4. public ushort Flags { get; set; } //  }</span></span></code> </pre> <br><p>  рдЖрдкрдХреЛ рдореЗрд░рд╛ рд╢рдмреНрдж рдЕрднреА рд▓реЗрдирд╛ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдПрдХреНрд╕реЗрд▓ рдореЗрдВ, рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣реА рд╣реИ, рдЕрдЧрд░ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдкрдВрдХреНрддрд┐ рдХреА рдКрдБрдЪрд╛рдИ 75 рдЕрдВрдХ рд╣реИ, рддреЛ рдпрд╣ рдкрд┐рдХреНрд╕реЗрд▓ рдореЗрдВ 100 рд╣реЛрдЧреА, рдлрд┐рд░ 400 рдХреЛ рдореВрд▓реНрдп рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдореБрдЭреЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЭрдВрдбреЗ рдореЗрдВ рд╕рднреА рдмрд┐рдЯреНрд╕ рдХрд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИ (рдЭрдВрдбреЗ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдФрд░ рд▓рдВрдмрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдпрдХреАрди рд╣реИ рдХрд┐ рдкрддрд╛ рд╣реИред рд╡рд╣ 0x4000 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рд╣реИ рдЬрд┐рд╕рдХреА рдКрдБрдЪрд╛рдИ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИ, рдФрд░ 0x2000 - рдЫрд┐рдкреА рд╣реБрдИ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рд╣реИред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХреА рдЧрдИ рдКрдБрдЪрд╛рдИ рд╡рд╛рд▓реА рджреГрд╢реНрдпрдорд╛рди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рдлрд╝реНрд▓реИрдЧрд╕ рдЕрдХреНрд╕рд░ 0x4005 рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЙрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕рдореЗрдВ рдлрд╝реНрд▓реИрдЧ рд╕реНрд╡рд░реВрдкрдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдКрдБрдЪрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдпрд╣ рдпрд╛ рддреЛ 0xA рдпрд╛ 0x800E рд╣реИред </p><br><h2 id="sprashivaem-vysotu-ryada">  рд╣рдо рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдкреВрдЫрддреЗ рд╣реИрдВ </h2><br><p>  рдЕрдм, рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЖрдк excel.exe рд╕реЗ рд╡рд┐рдзрд┐ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдкрдиреЗ рд╕реВрдЪрдХрд╛рдВрдХ рджреНрд╡рд╛рд░рд╛ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рд╕реБрдВрджрд░ рдХреЛрдб рдХреЗ рд▓рд┐рдП HexRays рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж): </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __userpurge GetRowHeight@&lt;eax&gt;(<span class="hljs-keyword"><span class="hljs-keyword">signed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowIndex@&lt;edx&gt;, SheetLayoutInfo *sheetLayoutInfo@&lt;esi&gt;, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> flag) { RowHeightInfo *rowHeightInfo; <span class="hljs-comment"><span class="hljs-comment">// eax int result; // ecx if ( sheetLayoutInfo-&gt;dword1A0 ) return sheetLayoutInfo-&gt;defaultFullRowHeightMul4 | (~(sheetLayoutInfo-&gt;defaultRowDelta2 &gt;&gt; 14 &lt;&lt; 15) &amp; 0x8000); if ( rowIndex &lt; sheetLayoutInfo-&gt;MinRowIndexNonDefault ) return sheetLayoutInfo-&gt;defaultFullRowHeightMul4 | (~(sheetLayoutInfo-&gt;defaultRowDelta2 &gt;&gt; 14 &lt;&lt; 15) &amp; 0x8000); if ( rowIndex &gt;= sheetLayoutInfo-&gt;MaxRowIndexNonDefault ) return sheetLayoutInfo-&gt;defaultFullRowHeightMul4 | (~(sheetLayoutInfo-&gt;defaultRowDelta2 &gt;&gt; 14 &lt;&lt; 15) &amp; 0x8000); rowHeightInfo = GetRowHeightCore(sheetLayoutInfo, rowIndex); if ( !rowHeightInfo ) return sheetLayoutInfo-&gt;defaultFullRowHeightMul4 | (~(sheetLayoutInfo-&gt;defaultRowDelta2 &gt;&gt; 14 &lt;&lt; 15) &amp; 0x8000); result = 0; if ( flag || !(rowHeightInfo-&gt;Flags &amp; 0x2000) ) result = rowHeightInfo-&gt;Value; if ( !(rowHeightInfo-&gt;Flags &amp; 0x4000) ) result |= 0x8000u; return result; }</span></span></code> </pre> <br><p>  Dword1A0 рдХреНрдпрд╛ рд╣реИ, рдореИрдВ рдЕрднреА рднреА рд╕рдордЭ рдирд╣реАрдВ рдкрд╛рдпрд╛ рд╣реВрдВред  рдПрдХ рдЬрдЧрд╣ рдирд╣реАрдВ рдорд┐рд▓реА рдЬрд╣рд╛рдБ рдпрд╣ рдЭрдВрдбрд╛ рд▓рдЧрд╛ рд╣реЛ :( <br>  рдореЗрд░реЗ рд▓рд┐рдП defaultRowDelta2 рдХреНрдпрд╛ рд╣реИ, рдЕрднреА рднреА рдПрдХ рд░рд╣рд╕реНрдп рдмрдирд╛ рд╣реБрдЖ рд╣реИред  рдЬрдм рдПрдХреНрд╕реЗрд▓ рдкреНрд░рд╛рд░реВрдк рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЗрд╕реЗ рджреЛ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рдпреЛрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред  defaultRowDelta2 рдорд╛рдирдХ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд░рд╛рд╢рд┐ рд╕реЗ рджреВрд╕рд░рд╛ рдирдВрдмрд░ рд╣реИред  рдзреНрд╡рдЬ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдорд╛рди рднреА рд░рд╣рд╕реНрдпрдордп рд╣реИ, рдХреНрдпреЛрдВрдХрд┐  рдЬрд╣рд╛рдБ рднреА рдореИрдВрдиреЗ рдЭрдВрдбреЗ рдореЗрдВ рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХреЛ рджреЗрдЦрд╛ рд╡рд╣ рдЧрд▓рдд рдерд╛ред <br>  рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ SheetLayoutInfo рд╡рд░реНрдЧ рднреА рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред  рдореИрдВрдиреЗ рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╢реАрдЯ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  SheetLayoutInfo рдореЗрдВ рдРрд╕реЗ рдХреНрд╖реЗрддреНрд░ рд╣реИрдВ: </p><br><ul><li>  DefaultFullRowHeightMul4 - рдорд╛рдирдХ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ; </li><li>  MinRowIndexNonDefault - рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ, рдЬрд┐рд╕ рдкрд░ рдКрдВрдЪрд╛рдИ рдорд╛рдирдХ рд╕реЗ рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИ; </li><li>  MaxRowIndexNonDefault - рдкрд┐рдЫрд▓реЗ рдПрдХ рдХреЗ рдмрд╛рдж рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ, рдЬрд┐рд╕ рдкрд░ рдКрдВрдЪрд╛рдИ рдорд╛рдирдХ рд╕реЗ рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИ; </li><li>  DefaultRowDelta2 рдорд╛рдирдХ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдХреЗ рдпреЛрдЧ рдХрд╛ рдПрдХ рд╣реА рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред </li><li>  GroupIndexDelta - рдЗрд╕ рдкрд░ рдмрд╛рдж рдореЗрдВ </li></ul><br><p>  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рддрд░реНрдХ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ: </p><br><ol><li>  рдпрджрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рдЧреИрд░-рдорд╛рдирдХ рдКрдВрдЪрд╛рдИ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд╕реЗ рдХрдо рд╣реИ, рддреЛ рдорд╛рдирдХ рд╡рд╛рдкрд╕ рдХрд░реЗрдВ; </li><li>  рдпрджрд┐ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рдЧреИрд░-рдорд╛рдирдХ рдКрдВрдЪрд╛рдИ рдХреЗ рд╕рд╛рде рдкрд┐рдЫрд▓реЗ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рдорд╛рдирдХ рд╡рд╛рдкрд╕ рдХрд░реЗрдВ; </li><li>  рдЕрдиреНрдпрдерд╛, рд╣рдо GetRowHeightCore рд╡рд┐рдзрд┐ рд╕реЗ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд▓рд┐рдП rowHeightInfo рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ; </li><li>  рдпрджрд┐ rowHeightInfo == рдЕрд╢рдХреНрдд рдорд╛рдирдХ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рд╡рд╛рдкрд╕ рдЖрддреА рд╣реИ; </li><li>  рдЭрдВрдбреЗ рдХреЗ рд╕рд╛рде рдЬрд╛рджреВ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдо рдкрдВрдХреНрддрд┐рд╣рд╛рдЗрдЯрдЗрдиреНрдлреЛрдЗрдиреНрдлреЛ.рд╡реИрд▓реНрдпреВ рдореЗрдВ рдЬреЛ рд╣реИ рдЙрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ 16 рд╡реАрдВ рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдпрджрд┐ рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдирд╣реАрдВ рдХреА рдЧрдИ рдереАред </li></ol><br><p>  рдпрджрд┐ рдЖрдк C # рдореЗрдВ рдЗрд╕ рдХреЛрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдирд┐рдореНрди рдЬреИрд╕рд╛ рдХреБрдЫ рдорд┐рд▓реЗрдЧрд╛: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> HiddenRowMask = <span class="hljs-number"><span class="hljs-number">0x2000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ulong</span></span> CustomHeightMask = <span class="hljs-number"><span class="hljs-number">0x4000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> DefaultHeightMask = <span class="hljs-number"><span class="hljs-number">0x8000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ushort</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRowHeight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex, SheetLayoutInfo sheetLayoutInfo</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> defaultHeight = (<span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span>) (sheetLayoutInfo.DefaultFullRowHeightMul4 | (~(sheetLayoutInfo.DefaultRowDelta2 &gt;&gt; <span class="hljs-number"><span class="hljs-number">14</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) &amp; DefaultHeightMask)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowIndex &lt; sheetLayoutInfo.MinRowIndexNonDefault) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defaultHeight; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowIndex &gt;= sheetLayoutInfo.MaxRowIndexNonDefault) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defaultHeight; RowHeightInfo rowHeightInfo = GetRowHeightCore(sheetLayoutInfo, rowIndex); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowHeightInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defaultHeight; <span class="hljs-keyword"><span class="hljs-keyword">ushort</span></span> result = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((rowHeightInfo.Flags &amp; HiddenRowMask) == <span class="hljs-number"><span class="hljs-number">0</span></span>) result = rowHeightInfo.Value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((rowHeightInfo.Flags &amp; CustomHeightMask) == <span class="hljs-number"><span class="hljs-number">0</span></span>) result |= DefaultHeightMask; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><p>  рдЕрдм рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ GetRowHeightCore рдХреЗ рдЕрдВрджрд░ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ: </p><br><pre> <code class="cpp hljs">RowHeightInfo *__<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRowHeightCore</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SheetLayoutInfo *sheetLayoutInfo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">signed</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex)</span></span></span><span class="hljs-function"> </span></span>{ RowHeightInfo *result; <span class="hljs-comment"><span class="hljs-comment">// eax RowsGroupInfo *rowsGroupInfo; // ecx int rowInfoIndex; // edx result = 0; if ( rowIndex &lt; sheetLayoutInfo-&gt;MinRowIndexNonDefault || rowIndex &gt;= sheetLayoutInfo-&gt;MaxRowIndexNonDefault ) return result; rowsGroupInfo = sheetLayoutInfo-&gt;RowsGroups[sheetLayoutInfo-GroupIndexDelta + (rowIndex &gt;&gt; 4)]; result = 0; if ( !rowsGroupInfo ) return result; rowInfoIndex = rowsGroupInfo-&gt;Indices[rowIndex &amp; 0xF]; if ( rowInfoIndex ) result = (rowsGroupInfo + 8 * (rowInfoIndex + rowsGroupInfo-&gt;wordBA + rowsGroupInfo-&gt;wordBC - rowsGroupInfo-&gt;wordB8)); return result; }</span></span></code> </pre> <br><ol><li>  рдлрд┐рд░ рд╕реЗ, рд╢реБрд░реБрдЖрдд рдореЗрдВ, рдПрдХреНрд╕реЗрд▓ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рдПрдХ рдмрджрд▓реА рд╣реБрдИ рдКрдБрдЪрд╛рдИ рд╡рд╛рд▓реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рд╣реИ, рдФрд░ рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдпрд╣ рд╕реБрд╕реНрдд рд╣реЛ рдЬрд╛рддреА рд╣реИред </li><li>  рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╡рд╛рдВрдЫрд┐рдд рд╕рдореВрд╣ рдХреЛ рдвреВрдБрдврддрд╛ рд╣реИ; рдпрджрд┐ рдРрд╕рд╛ рдХреЛрдИ рд╕рдореВрд╣ рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ рдЕрд╢рдХреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рд╕рдореВрд╣ рдореЗрдВ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред </li><li>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рд░реЛрд╣рд╛рдЗрдЯрдЗрдиреНрдлреЛ рд╡рд░реНрдЧ рдХреА рд╡рд╛рдВрдЫрд┐рдд рд╡рд╕реНрддреБ рдкрд╛рддрд╛ рд╣реИред  wordBA, wordBC, wordB8 - рдХреБрдЫ рд╕реНрдерд┐рд░рд╛рдВрдХред  рд╡реЗ рдЗрддрд┐рд╣рд╛рд╕ рдХреЗ рд╕рд╛рде рд╣реА рдмрджрд▓рддреЗ рд╣реИрдВред  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рд╡реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреА рд╕рдордЭ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред </li></ol><br><p>  рдпрд╣рд╛рдБ рдпрд╣ рд╡рд┐рд╖рдп рд╕реЗ рднрдЯрдХрдиреЗ рдФрд░ RowsGroupInfo рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд╛рдпрдХ рд╣реИред  Excel 16 рдЯреБрдХрдбрд╝реЛрдВ рдХреЗ рд╕рдореВрд╣ рдореЗрдВ рд░реЛрд╣рд╛рдЗрдЯрдЗрдирдЗрдиреНрдлреЛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЬрд╣рд╛рдБ I-th рд╕рдореВрд╣, рдЬреЛ RowsGroupInfo рд╡рд░реНрдЧ рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, i ├Ч 16 рд╕реЗ i ├Ч 16 + 15 рд╕рдорд╛рд╡реЗрд╢реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛ред </p><br><p>  рд▓реЗрдХрд┐рди RowsGroupInfo рдореЗрдВ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреБрдЫ рд╣рдж рддрдХ рдЕрд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИред  рдПрдХреНрд╕реЗрд▓ рдореЗрдВ рдЗрддрд┐рд╣рд╛рд╕ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдХрд╛рд░рдг рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред </p><br><p>  RowsGroupInfo рдореЗрдВ рддреАрди рдорд╣рддреНрд╡рдкреВрд░реНрдг рдлрд╝реАрд▓реНрдб рд╣реИрдВ: Indices, HeightInfos, рдФрд░ RowsCount, рджреВрд╕рд░рд╛ рдКрдкрд░ рджрд┐рдП рдЧрдП рдХреЛрдб рдореЗрдВ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ (рдпрд╣ рдЗрд╕ рдкрдВрдХреНрддрд┐ рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП: (rowGroupInfo + 8 ├Ч (...)), рдХреНрдпреЛрдВрдХрд┐ rowInfoIndex рдмрд╣реБрдд рднрд┐рдиреНрди рдорд╛рди рд▓реЗ рд╕рдХрддрд╛ рд╣реИ , рдореИрдВрдиреЗ 1000 рд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рднреА рджреЗрдЦрд╛ рд╣реИ рдФрд░ рдореБрдЭреЗ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЖрдИрдбреАрдП рдореЗрдВ рдРрд╕реА рд╕рдВрд░рдЪрдирд╛ рдХреИрд╕реЗ рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИред RowsCount рдлрд╝реАрд▓реНрдб рдЙрдкрд░реЛрдХреНрдд рдХреЛрдб рдореЗрдВ рдирд╣реАрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣реИ рдХрд┐ рд╕рдореВрд╣ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЧреИрд░-рдорд╛рдирдХ рдкрдВрдХреНрддрд┐рдпрд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, SheetLayoutInfo рдореЗрдВ GroupIndexDelta рд╣реИ - рд╕рдореВрд╣ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реВрдЪрдХрд╛рдВрдХ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ред </p><br><p>  рдЗрдВрдбрд┐рд╕реЗрд╕ рдлрд╝реАрд▓реНрдб рд╕рдореВрд╣ рдХреЗ рднреАрддрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реВрдЪрдХрд╛рдВрдХ рдХреЗ рд▓рд┐рдП RowHeightInfo рдСрдлрд╝рд╕реЗрдЯ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рд╡реЗ рдХреНрд░рдо рдореЗрдВ рд╡рд╣рд╛рдБ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВ, рд▓реЗрдХрд┐рди HeightInfos RowHeightInfo рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдХреНрд░рдо рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред </p><br><p>  рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдирдИ рдЦрд╛рд▓реА рд╢реАрдЯ рд╣реИ рдФрд░ рдХрд┐рд╕реА рддрд░рд╣ рд╣рдордиреЗ рдкрдВрдХреНрддрд┐ рд╕рдВрдЦреНрдпрд╛ 23 рдХреА рдКрдВрдЪрд╛рдИ рдмрджрд▓ рджреАред рдпрд╣ рдкрдВрдХреНрддрд┐ 16 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ, рдлрд┐рд░: </p><br><ol><li>  рдПрдХреНрд╕реЗрд▓ рдЗрд╕ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд▓рд┐рдП рд╕рдореВрд╣ рд╕реВрдЪрдХрд╛рдВрдХ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдЧрд╛ред  рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЗрдВрдбреЗрдХреНрд╕ 1 рд╣реЛрдЧрд╛ рдФрд░ GroupIndexDelta = -1 рдХреЛ рдмрджрд▓ рджреЗрдЧрд╛ред </li><li>  рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд▓рд┐рдП RowsGroupInfo рд╡рд░реНрдЧ рдХреА рдПрдХ рд╡рд╕реНрддреБ рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ sheetLayoutInfo-&gt; RowsGroups рдореЗрдВ 0 рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рддрд╣рдд рдмрдирд╛рддрд╛ рд╣реИ (sheetLayoutInfo-&gt; GroupIndexDelta + 1); </li><li>  RowsGroupInfo рдореЗрдВ рдПрдХреНрд╕реЗрд▓ 16 4-рдмрд╛рдЗрдЯ рдЗрдВрдбрд┐рд╕реЗрд╕ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдЧрд╛, RowsCount, wordBA, wordBC рдФрд░ wordB8, рдЖрджрд┐ рдХреЗ рд▓рд┐рдП; </li><li>  рддрдм рдПрдХреНрд╕реЗрд▓ рдмрд┐рдЯрд╡рд╛рдЗрдВрдб рдФрд░ рдСрдкрд░реЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдореВрд╣ рдореЗрдВ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕реВрдЪрдХрд╛рдВрдХ рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИ (рдпрд╣ рд╡рд┐рднрд╛рдЬрди рдХреЗ рд╢реЗрд╖ рднрд╛рдЧ рд▓реЗрдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рддреЗрдЬ рд╣реИ): rowIndex &amp; 0xFред  рд╕рдореВрд╣ рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рд╕реВрдЪрдХрд╛рдВрдХ рд╣реЛрдЧрд╛: 23 &amp; 0xF = 7; </li><li>  рдЙрд╕рдХреЗ рдмрд╛рдж, рдПрдХреНрд╕реЗрд▓ рдХреЛ рдЗрдВрдбреЗрдХреНрд╕ 7: рдСрдлрд╕реЗрдЯ = рдЗрдВрдбрд┐рд╕ [7] рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рдорд┐рд▓рддрд╛ рд╣реИред  рдпрджрд┐ рдСрдлрд╕реЗрдЯ = 0, рддреЛ RowsGroupInto рдХреЗ рдЕрдВрдд рдореЗрдВ Excel 8 рдмрд╛рдЗрдЯреНрд╕ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдПрдХ рдПрдХ рдХрд░рдХреЗ RowsCount рдмрдврд╝рд╛рддрд╛ рд╣реИ, рдФрд░ Indices [7] рдкрд░ рдирдИ рдСрдлрд╕реЗрдЯ рд▓рд┐рдЦрддрд╛ рд╣реИред  рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рдЕрдВрдд рдореЗрдВ, рдПрдХреНрд╕реЗрд▓ RowsGroupInfo рдореЗрдВ рдСрдлрд╕реЗрдЯ рдкрд░ рдирдИ рдкрдВрдХреНрддрд┐ рдКрдВрдЪрд╛рдИ рдФрд░ рдЭрдВрдбреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд▓рд┐рдЦрддрд╛ рд╣реИред </li></ol><br><p>  C # рдореЗрдВ RowsGroupInfo рд╡рд░реНрдЧ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RowsGroupInfo</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] Indices { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;RowHeightInfo&gt; HeightInfos { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RowsGroupInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Indices = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[SheetLayoutInfo.MaxRowsCountInGroup]; HeightInfos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;RowHeightInfo&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; SheetLayoutInfo.MaxRowsCountInGroup; i++) { Indices[i] = <span class="hljs-number"><span class="hljs-number">-1</span></span>; } } }</code> </pre> <br><p>  GetRowHeightCore рд╡рд┐рдзрд┐ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧреА: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> RowHeightInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRowHeightCore</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SheetLayoutInfo sheetLayoutInfo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowIndex &lt; sheetLayoutInfo.MinRowIndexNonDefault || rowIndex &gt;= sheetLayoutInfo.MaxRowIndexNonDefault) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; RowsGroupInfo rowsGroupInfo = sheetLayoutInfo.RowsGroups[sheetLayoutInfo.GroupIndexDelta + (rowIndex &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowsGroupInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowInfoIndex = rowsGroupInfo.Indices[rowIndex &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rowInfoIndex != <span class="hljs-number"><span class="hljs-number">-1</span></span> ? rowsGroupInfo.HeightInfos[rowInfoIndex] : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><p>  рдФрд░ рдпрд╣ рд╡рд╣реА рд╣реИ рдЬреЛ SetRowHeight рдХреА рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛ (рдореИрдВрдиреЗ excel.exe рд╕реЗ рдЗрд╕рдХреЗ рдХреЛрдб рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ): </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRowHeight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ushort</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newRowHeight, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ushort</span></span></span></span><span class="hljs-function"><span class="hljs-params"> flags, SheetLayoutInfo sheetLayoutInfo</span></span></span><span class="hljs-function">)</span></span> { sheetLayoutInfo.MaxRowIndexNonDefault = Math.Max(sheetLayoutInfo.MaxRowIndexNonDefault, rowIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>); sheetLayoutInfo.MinRowIndexNonDefault = Math.Min(sheetLayoutInfo.MinRowIndexNonDefault, rowIndex); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> realGroupIndex = rowIndex &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sheetLayoutInfo.RowsGroups.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { sheetLayoutInfo.RowsGroups.Add(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); sheetLayoutInfo.GroupIndexDelta = -realGroupIndex; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sheetLayoutInfo.GroupIndexDelta + realGroupIndex &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bucketSize = -(sheetLayoutInfo.GroupIndexDelta + realGroupIndex); sheetLayoutInfo.RowsGroups.InsertRange(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowsGroupInfo[bucketSize]); sheetLayoutInfo.GroupIndexDelta = -realGroupIndex; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sheetLayoutInfo.GroupIndexDelta + realGroupIndex &gt;= sheetLayoutInfo.RowsGroups.Count) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bucketSize = sheetLayoutInfo.GroupIndexDelta + realGroupIndex - sheetLayoutInfo.RowsGroups.Count + <span class="hljs-number"><span class="hljs-number">1</span></span>; sheetLayoutInfo.RowsGroups.AddRange(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowsGroupInfo[bucketSize]); } RowsGroupInfo rowsGroupInfo = sheetLayoutInfo.RowsGroups[sheetLayoutInfo.GroupIndexDelta + realGroupIndex]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowsGroupInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { rowsGroupInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowsGroupInfo(); sheetLayoutInfo.RowsGroups[sheetLayoutInfo.GroupIndexDelta + realGroupIndex] = rowsGroupInfo; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowInfoIndex = rowsGroupInfo.Indices[rowIndex &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>]; RowHeightInfo rowHeightInfo; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowInfoIndex == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { rowHeightInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowHeightInfo(); rowsGroupInfo.HeightInfos.Add(rowHeightInfo); rowsGroupInfo.Indices[rowIndex &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>] = rowsGroupInfo.HeightInfos.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { rowHeightInfo = rowsGroupInfo.HeightInfos[rowInfoIndex]; } rowHeightInfo.Value = newRowHeight; rowHeightInfo.Flags = flags; }</code> </pre> <br><h2 id="nemnogo-praktiki">  рдереЛрдбрд╝рд╛ рд╕рд╛ рдЕрднреНрдпрд╛рд╕ </h2><br><p>  рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдХреЗ рдмрд╛рдж, рдкрдВрдХреНрддрд┐ 23 рдХреА рдКрдВрдЪрд╛рдИ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд╕рд╛рде, рдПрдХреНрд╕реЗрд▓ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ (рдореИрдВрдиреЗ рдкрдВрдХреНрддрд┐ 23 рдХреЛ 75 рдЕрдВрдХ рдХреА рдКрдВрдЪрд╛рдИ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИ): </p><br><div class="spoiler">  <b class="spoiler_title">sheetLayoutInfo</b> <div class="spoiler_text"><ul><li>  DefaultFullRowHeightMul4 = 80 </li><li>  DefaultRowDelta2 = 5 </li><li>  MaxRowIndexNonDefault = 24 </li><li>  MinRowIndexNonDefault = 23 </li><li>  GroupIndexDelta = -1 </li><li>  RowsGroups рдЧрдгрдирд╛ = 1 <br><ul><li>  [реж] RowsGroupInfo </li><li>  HeightInfos Count = 1 <br><ul><li>  [реж] рд░реЛрд╡рд╛рдЗрдЯрдЗрдиреНрдлреЛ </li><li>  рдЭрдВрдбреЗ = 0x4005 </li><li>  рдорд╛рди = резрежреж </li></ul></li><li>  рд╕реВрдЪрдХрд╛рдВрдХреЛрдВ <br><ul><li>  [реж] = рез </li><li>  [рез] = -1 </li><li>  [реи] = рез </li><li>  [рей] = рез </li><li>  [рек] = рез </li><li>  [рел] = рез </li><li>  [рем] = рез </li><li>  [[] = реж </li><li>  [[] = рез </li><li>  [реп] = -1 </li><li>  [резреж] = рез </li><li>  [резрез] = рез </li><li>  [резреи] = рез </li><li>  [резрей] = рез </li><li>  [резрек] = рез </li><li>  [резрел] = рез </li></ul></li></ul></li></ul></div></div><br>  рдпрд╣рд╛рдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдореИрдВ рдПрдХ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░реВрдБрдЧрд╛ рдХрд┐ рдПрдХреНрд╕реЗрд▓ рдореЗрдореЛрд░реА рдореЗрдВ рдбреЗрдЯрд╛ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рдЬреЛ рд╕реНрд╡-рд▓рд┐рдЦрд┐рдд рдХрдХреНрд╖рд╛рдУрдВ рд╕реЗ рд╡рд┐рдЬрд╝реБрдЕрд▓ рд╕реНрдЯреВрдбрд┐рдпреЛ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдореЗрдореЛрд░реА рд╕реЗ рдПрдХ рд╕реАрдзрд╛ рдбрдВрдк рдмрд╣реБрдд рдЬрд╛рдирдХрд╛рд░реАрдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИред <br>  рдЕрдм рдкрдВрдХреНрддрд┐ 23 рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, 0x2000 рдмрд┐рдЯреНрд╕ рдлрд╝реНрд▓реИрдЧ рд╕реЗрдЯ рдХрд░реЗрдВред  рд╣рдо рдЬреАрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдореГрддрд┐ рдХреЛ рдмрджрд▓ рджреЗрдВрдЧреЗред  рдкрд░рд┐рдгрд╛рдо рдЗрд╕ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http://recordit.co/79vYIbwbzB</a> <br>  рдЬрдм рднреА рдЖрдк рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛рддреЗ рд╣реИрдВ, рддреЛ рдПрдХреНрд╕реЗрд▓ рд╡рд╣реА рдХрд░рддрд╛ рд╣реИред <br>  рдЕрдм рдкрдВрдХреНрддрд┐ рдХреА рдКрдВрдЪрд╛рдИ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рд╕реЗрд▓ рдкреНрд░рд╛рд░реВрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рд╕реЗрд▓ A20 рдореЗрдВ рдлрд╝реЙрдиреНрдЯ 40 рдЕрдВрдХ рдХреА рдКрдВрдЪрд╛рдИ рдмрди рдЬрд╛рдиреЗ рджреЗрдВ, рдлрд┐рд░ рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ рд╕реЗрд▓ рдХреА рдКрдВрдЪрд╛рдИ 45.75 рд╣реЛрдЧреА рдФрд░ рдПрдХреНрд╕реЗрд▓ рдореЗрдореЛрд░реА рдореЗрдВ рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╣реЛрдЧрд╛: <br><div class="spoiler">  <b class="spoiler_title">sheetLayoutInfo</b> <div class="spoiler_text"><ul><li>  DefaultFullRowHeightMul4 = 80 </li><li>  DefaultRowDelta2 = 5 </li><li>  MaxRowIndexNonDefault = 24 </li><li>  MinRowIndexNonDefault = 20 </li><li>  GroupIndexDelta = -1 </li><li>  RowsGroups рдЧрдгрдирд╛ = 1 <br><ul><li>  [реж] RowsGroupInfo </li><li>  HeightInfos Count = 2 <br><ul><li>  [реж] рд░реЛрд╡рд╛рдЗрдЯрдЗрдиреНрдлреЛ </li><li>  рдЭрдВрдбреЗ = 0x4005 </li><li>  рдорд╛рди = резрежреж </li><li>  [рез] рд░реЛрд╣рд┐рддреЗрдЗрдиреНрдлреЛ </li><li>  рдЭрдВрдбреЗ = 0x800E </li><li>  рдорд╛рди = 244 </li></ul></li><li>  рд╕реВрдЪрдХрд╛рдВрдХреЛрдВ <br><ul><li>  [реж] = рез </li><li>  [рез] = -1 </li><li>  [реи] = рез </li><li>  [рей] = рез </li><li>  [рек] = рез </li><li>  [рел] = рез </li><li>  [рем] = рез </li><li>  [[] = реж </li><li>  [[] = рез </li><li>  [реп] = -1 </li><li>  [резреж] = рез </li><li>  [резрез] = рез </li><li>  [резреи] = рез </li><li>  [резрей] = рез </li><li>  [резрек] = рез </li><li>  [резрел] = рез </li></ul></li></ul></li></ul></div></div><br><p>  рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрджрд┐ рдорд╛рдирдХ рдирд╣реАрдВ рд╣реИ рддреЛ Excel рд╣рдореЗрд╢рд╛ рдкрдВрдХреНрддрд┐ рдХреА рдКрдБрдЪрд╛рдИ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рднрд▓реЗ рд╣реА рдКрдВрдЪрд╛рдИ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдпрд╛ рдкреНрд░рд╛рд░реВрдк рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдПрдХреНрд╕реЗрд▓ рдЕрднреА рднреА рдПрдХ рдмрд╛рд░ рдЗрд╕рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдЧрд╛ рдФрд░ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЙрдЪрд┐рдд рд╕рдореВрд╣ рдореЗрдВ рдбрд╛рд▓ рджреЗрдЧрд╛ред </p><br><h2 id="razbiraemsya-so-vstavkoyudaleniem-ryadov">  рд╣рдо рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рдореНрдорд┐рд▓рди / рд╡рд┐рд▓реЛрдкрди рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ </h2><br><p>  рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд / рд╣рдЯрд╛рддреЗ рд╕рдордп рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ, рдпрд╣ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрдЧрд╛ред  Excel.exe рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдХреЛрдб рдХреЛ рдвреВрдВрдврдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рдХреЛрдИ рдЗрдЪреНрдЫрд╛ рдирд╣реАрдВ рдереА, рдЖрдк рдЗрд╕рдХреЗ рдПрдХ рд╣рд┐рд╕реНрд╕реЗ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">sub_305EC930</b> <div class="spoiler_text"><p>  рдлреНрд▓реИрдЧ a5 рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХреМрди рд╕рд╛ рдСрдкрд░реЗрд╢рди рд╣реЛ рд░рд╣рд╛ рд╣реИред </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __userpurge sub_305EC930@&lt;eax&gt;(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a1@&lt;eax&gt;, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a2@&lt;edx&gt;, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a3@&lt;ecx&gt;, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a4, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a5, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a6) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6; <span class="hljs-comment"><span class="hljs-comment">// esi int v7; // ebx int v8; // edi int v9; // edx int v10; // ecx size_t v11; // eax _WORD *v12; // ebp size_t v13; // eax size_t v14; // eax int v15; // eax unsigned __int16 *v16; // ecx _WORD *v17; // eax _WORD *v18; // ecx int v19; // edx __int16 v20; // bx int v21; // eax _WORD *v22; // ecx int v24; // edx int v25; // eax int v26; // esi int v27; // ebx size_t v28; // eax int v29; // ebp size_t v30; // eax int v31; // esi size_t v32; // eax int v33; // eax unsigned __int16 *v34; // ecx int v35; // eax _WORD *v36; // edx _WORD *v37; // ecx int v38; // eax __int16 v39; // bx int v40; // eax _WORD *v41; // ecx int v42; // [esp+10h] [ebp-48h] int v43; // [esp+10h] [ebp-48h] int v44; // [esp+14h] [ebp-44h] char v45; // [esp+14h] [ebp-44h] int Dst[16]; // [esp+18h] [ebp-40h] int v47; // [esp+5Ch] [ebp+4h] int v48; // [esp+60h] [ebp+8h] v6 = a1; v7 = a1 &amp; 0xF; v8 = a2; if ( !a5 ) { v24 = a4 - a1; v25 = a1 - a3; v43 = a4 - v6; if ( v7 &gt;= v25 ) v7 = v25; v47 = a4 - v7; v26 = v6 - v7; v27 = v7 + 1; v48 = v27; if ( !v8 ) return v27; v28 = 4 * v24; if ( (4 * v24) &gt; 0x40 ) v28 = 64; v45 = v27 + v26; v29 = (v27 + v26) &amp; 0xF; memmove(Dst, (v8 + 4 * v29), v28); v30 = 4 * v27; if ( (4 * v27) &gt; 0x40 ) v30 = 64; v31 = v26 &amp; 0xF; memmove((v8 + 4 * (v47 &amp; 0xF)), (v8 + 4 * v31), v30); v32 = 4 * v43; if ( (4 * v43) &gt; 0x40 ) v32 = 64; memmove((v8 + 4 * v31), Dst, v32); if ( !a6 ) return v48; v33 = v29; if ( v29 &lt; v29 + v43 ) { v34 = (v8 + 4 * v29 + 214); do { Dst[v33++] = *v34 &gt;&gt; 15; v34 += 2; } while ( v33 &lt; v29 + v43 ); } v35 = (v45 - 1) &amp; 0xF; if ( v35 &gt;= v31 ) { v36 = (v8 + 4 * ((v27 + v47 - 1) &amp; 0xF) + 214); v37 = (v8 + 4 * ((v45 - 1) &amp; 0xF) + 214); v38 = v35 - v31 + 1; do { v39 = *v37 ^ (*v37 ^ *v36) &amp; 0x7FFF; v37 -= 2; *v36 = v39; v36 -= 2; --v38; } while ( v38 ); v27 = v48; } v40 = v31; if ( v31 &gt;= v31 + v43 ) return v27; v41 = (v8 + 4 * v31 + 214); do { *v41 = *v41 &amp; 0x7FFF | (LOWORD(Dst[v40++]) &lt;&lt; 15); v41 += 2; } while ( v40 &lt; v31 + v43 ); return v27; } v9 = a1 - a4; v10 = a3 - a1; v42 = a1 - a4; v48 = 16 - v7; if ( 16 - v7 &gt;= v10 ) v48 = v10; if ( !v8 ) return v48; v11 = 4 * v9; if ( (4 * v9) &gt; 0x40 ) v11 = 64; v12 = (v8 + 4 * (a4 &amp; 0xF)); v44 = a4 &amp; 0xF; memmove(Dst, v12, v11); v13 = 4 * v48; if ( (4 * v48) &gt; 0x40 ) v13 = 64; memmove(v12, (v8 + 4 * v7), v13); v14 = 4 * v42; if ( (4 * v42) &gt; 0x40 ) v14 = 64; memmove((v8 + 4 * ((a4 + v48) &amp; 0xF)), Dst, v14); if ( !a6 ) return v48; v15 = a4 &amp; 0xF; if ( v44 &lt; v44 + v42 ) { v16 = (v8 + 4 * v44 + 214); do { Dst[v15++] = *v16 &gt;&gt; 15; v16 += 2; } while ( v15 &lt; v44 + v42 ); } if ( v7 &lt; v48 + v7 ) { v17 = (v8 + 4 * v7 + 214); v18 = v12 + 107; v19 = v48; do { v20 = *v17 ^ (*v17 ^ *v18) &amp; 0x7FFF; v17 += 2; *v18 = v20; v18 += 2; --v19; } while ( v19 ); } v21 = a4 &amp; 0xF; if ( v44 &gt;= v44 + v42 ) return v48; v22 = (v8 + 4 * (v44 + v48) + 214); do { *v22 = *v22 &amp; 0x7FFF | (LOWORD(Dst[v21++]) &lt;&lt; 15); v22 += 2; } while ( v21 &lt; v44 + v42 ); return v48; }</span></span></code> </pre> </div></div><br><p>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЖрдк рдореЛрдЯреЗ рддреМрд░ рдкрд░ рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣рд╛рдВ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдмрд╛рдХреА рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд╕рдВрдХреЗрддреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рд╣реИред <br>  рд╣рдо рдЗрди рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдХреНрд░рдо рдореЗрдВ 16 рд╕реЗ 64 рд╕рдорд╛рд╡реЗрд╢реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдКрдВрдЪрд╛рдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВред  рдлрд┐рд░, рд╕реВрдЪрдХрд╛рдВрдХ 39 рдХреЗ рддрд╣рдд рдкрдВрдХреНрддрд┐ рдХреЗ рд╕рд╛рдордиреЗ, рдПрдХ рдирдИ рдкрдВрдХреНрддрд┐ рдбрд╛рд▓реЗрдВред  рдирдИ рдкрдВрдХреНрддрд┐ рдкрдВрдХреНрддрд┐ 38 рдХреА рдКрдВрдЪрд╛рдИ рдХреА рдирдХрд▓ рдХрд░реЗрдЧреАред <br>  рдЖрдЗрдП рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрдЦреЗрдВ, рдореИрдВрдиреЗ рдмреЛрд▓реНрдб рдЕрдВрддрд░ рдкрд░ рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рд╛: </p><br><table><thead><tr><th>  рдПрдХ рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ </th><th>  рдПрдХ рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж </th></tr></thead><tbody><tr><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  0 рдИ, 04, 07, 00, 05, 0 рдП, 09, 0 рдПрдл, 03, 06, 08, 0 рдбреА, 01, 0 рдмреА, 0 рд╕реА, 02 </td><td>  0 рдИ, 04, 07, 00, 05, 0 рдП, 09, 0 рдПрдл, 03, 06, 08, 0 рдбреА, 01, 0 рдмреА, 0 рд╕реА, 02 </td></tr><tr><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  05, 2B, 35, 45, 4B, 50, 5B, 6B, 7B, 8B, A5, AB, B0, B5, E0, 100 </td><td>  05, 2B, 35, 45, 4B, 50, 5B, 6B, 7B, 8B, A5, AB, B0, B5, E0, 100 </td></tr><tr><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  06, 02, 0E, 09, 01, 07, <strong>0F, 0C</strong> , 00, 0A, 04, 0B, 03, 08, <strong>0D, 05</strong> </td><td>  06, 02, 0E, 09, 01, 07, <strong>0F, 05, 0C</strong> , 00, 0A, 04, 0B, 03, 08, <strong>0D</strong> </td></tr><tr><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  10, 15, 20, 25, 30, <strong>75</strong> , 85, 90, 9B, A0, C5, CB, D0, D5, E5, F0 </td><td>  10, 15, 20, 25, 30, <strong>F0</strong> , 85, 90, 9B, A0, C5, CB, D0, D5, E5, F0 </td></tr><tr><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  0 рд╕реА, 08, 0 рдИ, 07, 0 рдП, 01, 06, 0 рдПрдл, 09, 0 рдбреА, 00, 05, 0 рдмреА, 02, 04, <strong>03</strong> </td><td>  <strong>03</strong> , 0 рд╕реА, 08, 0 рдИ, 07, 0 рдП, 01, 06, 0 рдПрдл, 09, 0 рдбреА, 00, 05, 0 рдмреА, 02, 04 </td></tr><tr><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  0B, 1B, 3B, <strong>40</strong> , 55, 60, 65, 70, 80, 95, BB, C0, DB, EB, F5, FB </td><td>  0B, 1B, 3B, <strong>75</strong> , 55, 60, 65, 70, 80, 95, BB, C0, DB, EB, F5, FB </td></tr><tr><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдСрдлрд╕реЗрдЯ: </td><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдСрдлрд╕реЗрдЯ: </td></tr><tr><td>  _ </td><td>  <strong>00</strong> </td></tr><tr><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  _ </td><td>  <strong>40</strong> </td></tr></tbody></table><br><p>  рдпрд╣ рд╡рд╣реА рдерд╛ рдЬреЛ рдЕрдкреЗрдХреНрд╖рд┐рдд рдерд╛: рдПрдХреНрд╕реЗрд▓ рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛ 7 (39 рдФрд░ 0xF) рдХреЗ рд╕рд╛рде рдПрдХ рдирдИ рдкрдВрдХреНрддрд┐ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдСрдлрд╕реЗрдЯ 0x05 рд╣реИ, рдкрдВрдХреНрддрд┐ рдХреА рдКрдБрдЪрд╛рдИ рдХреЛ рд╕реВрдЪрдХрд╛рдВрдХ 6 рдкрд░ рдХреЙрдкреА рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐, рдЬреЛ рдСрдлрд╕реЗрдЯ 05 рдереА, рдХреЛ рдЕрдЧрд▓реЗ рдкрд░ рдзрдХреЗрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд╕рдореВрд╣, рдФрд░ рд╡рд╣рд╛рдБ рд╕реЗ рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐ рдХреЛ рдЪреМрдереЗ рдореЗрдВ рдзрдХреЗрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЖрджрд┐ред </p><br><p>  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ 29 рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдХреЛ рд╣рдЯрд╛рдиреЗ рдкрд░ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИред </p><br><table><thead><tr><th>  рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ </th><th>  рдкрдВрдХреНрддрд┐ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж </th></tr></thead><tbody><tr><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  0 рдИ, 04, 07, 00, 05, 0 рдП, 09, 0 рдПрдл, 03, 06, 08, 0 рдбреА, 01, <strong>0 рдмреА, 0 рд╕реА, 02</strong> </td><td>  0 рдИ, 04, 07, 00, 05, 0 рдП, 09, 0 рдПрдл, 03, 06, 08, 0 рдбреА, 01, <strong>0 рд╕реА, 02, 0 рдмреА</strong> </td></tr><tr><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рдкрд╣рд▓реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  05, 2B, 35, 45, 4B, 50, 5B, 6B, 7B, 8B, A5, <strong>AB</strong> , B0, B5, E0, 100 </td><td>  05, 2B, 35, 45, 4B, 50, 5B, 6B, 7B, 8B, A5, <strong>85</strong> , B0, B5, E0, 100 </td></tr><tr><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  <strong>06</strong> , 02, 0E, 09, 01, 07, 0F, 05, 0C, 00, 0A, 04, 0B, 03, 08, 0D </td><td>  02, 0 рдИ, 09, 01, 07, 0 рдПрдл, 05, 0 рд╕реА, 00, 0 рдП, 04, 0 рдмреА, 03, 08, 0 рдбреА, <strong>06</strong> </td></tr><tr><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рджреВрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  10, 15, 20, 25, 30, F0, <strong>85</strong> , 90, 9B, A0, C5, CB, D0, D5, E5, F0 </td><td>  10, 15, 20, 25, 30, F0, <strong>75</strong> , 90, 9B, A0, C5, CB, D0, D5, E5, F0 </td></tr><tr><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рд╡рд┐рд╕реНрдерд╛рдкрди: </td></tr><tr><td>  <strong>03</strong> , 0 рд╕реА, 08, 0 рдИ, 07, 0 рдП, 01, 06, 0 рдПрдл, 09, 0 рдбреА, 00, 05, 0 рдмреА, 02, 04 </td><td>  0 рд╕реА, 08, 0 рдИ, 07, 0 рдП, 01, 06, 0 рдПрдл, 09, 0 рдбреА, 00, 05, 0 рдмреА, 02, 04, <strong>03</strong> </td></tr><tr><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рддреАрд╕рд░реЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  0B, 1B, 3B, <strong>75</strong> , 55, 60, 65, 70, 80, 95, BB, C0, DB, EB, F5, FB </td><td>  0B, 1B, 3B, <strong>40</strong> , 55, 60, 65, 70, 80, 95, BB, C0, DB, EB, F5, FB </td></tr><tr><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдСрдлрд╕реЗрдЯ: </td><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдСрдлрд╕реЗрдЯ: </td></tr><tr><td>  00 </td><td>  00 </td></tr><tr><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td><td>  рдЪреМрдереЗ рд╕рдореВрд╣ рдореЗрдВ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдИ рдХреЗ рдорд╛рди: </td></tr><tr><td>  <strong>40</strong> </td><td>  <strong>50</strong> </td></tr></tbody></table><br><p>  рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдЬрдм рдХреЛрдИ рдкрдВрдХреНрддрд┐ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИ, рддреЛ рд░рд┐рд╡рд░реНрд╕ рдСрдкрд░реЗрд╢рди рд╣реЛрддреЗ рд╣реИрдВред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЪреМрдереЗ рд╕рдореВрд╣ рдХрд╛ рдЕрд╕реНрддрд┐рддреНрд╡ рдмрдирд╛ рд░рд╣рддрд╛ рд╣реИ рдФрд░ рдкрдВрдХреНрддрд┐ рдХреА рдКрдБрдЪрд╛рдИ рдХреЗ рдорд╛рди рдХреЛ рдЗрд╕реА рдЭрдВрдбреЗ рдХреЗ рд╕рд╛рде рдорд╛рдирдХ рдКрдБрдЪрд╛рдИ рд╕реЗ рднрд░рд╛ рдЬрд╛рддрд╛ рд╣реИ - 0208005ред </p><br><p>  рдпрд╣ рдбреЗрдЯрд╛ рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ C # рдореЗрдВ рдкреБрди: рдкреЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ: </p><br><div class="spoiler">  <b class="spoiler_title">InsertRow</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InsertRow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SheetLayoutInfo sheetLayoutInfo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowIndex &gt;= sheetLayoutInfo.MaxRowIndexNonDefault) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; RowHeightInfo etalonRowHeightInfo = GetRowHeightCore(sheetLayoutInfo, rowIndex); RowHeightInfo newRowHeightInfo = etalonRowHeightInfo != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? etalonRowHeightInfo.Clone() : CreateDefaultRowHeight(sheetLayoutInfo); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> realGroupIndex = (rowIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newRowInGroupIndex = (rowIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> groupIndex; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (groupIndex = realGroupIndex + sheetLayoutInfo.GroupIndexDelta; groupIndex &lt; sheetLayoutInfo.RowsGroups.Count; groupIndex++, newRowInGroupIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (groupIndex &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (groupIndex == SheetLayoutInfo.MaxGroupsCount) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; RowsGroupInfo rowsGroupInfo = sheetLayoutInfo.RowsGroups[groupIndex]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowsGroupInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((newRowHeightInfo.Flags &amp; CustomHeightMask) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; rowsGroupInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowsGroupInfo(); sheetLayoutInfo.RowsGroups[groupIndex] = rowsGroupInfo; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowInfoIndex = rowsGroupInfo.Indices[newRowInGroupIndex]; RowHeightInfo lastRowHeightInGroup; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowInfoIndex == <span class="hljs-number"><span class="hljs-number">-1</span></span> || rowsGroupInfo.HeightInfos.Count &lt; SheetLayoutInfo.MaxRowsCountInGroup) { lastRowHeightInGroup = GetRowHeightCore(sheetLayoutInfo, ((groupIndex - sheetLayoutInfo.GroupIndexDelta) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span>); Array.Copy(rowsGroupInfo.Indices, newRowInGroupIndex, rowsGroupInfo.Indices, newRowInGroupIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>, SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span> - newRowInGroupIndex); rowsGroupInfo.HeightInfos.Add(newRowHeightInfo); rowsGroupInfo.Indices[newRowInGroupIndex] = rowsGroupInfo.HeightInfos.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lastIndex = rowsGroupInfo.Indices[SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span>]; lastRowHeightInGroup = rowsGroupInfo.HeightInfos[lastIndex]; Array.Copy(rowsGroupInfo.Indices, newRowInGroupIndex, rowsGroupInfo.Indices, newRowInGroupIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>, SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span> - newRowInGroupIndex); rowsGroupInfo.HeightInfos[lastIndex] = newRowHeightInfo; rowsGroupInfo.Indices[newRowInGroupIndex] = lastIndex; } newRowHeightInfo = lastRowHeightInGroup ?? CreateDefaultRowHeight(sheetLayoutInfo); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((newRowHeightInfo.Flags &amp; CustomHeightMask) != <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; groupIndex != SheetLayoutInfo.MaxGroupsCount) { SetRowHeight(((groupIndex - sheetLayoutInfo.GroupIndexDelta) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + newRowInGroupIndex, newRowHeightInfo.Value, newRowHeightInfo.Flags, sheetLayoutInfo); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { sheetLayoutInfo.MaxRowIndexNonDefault = Math.Min(sheetLayoutInfo.MaxRowIndexNonDefault + <span class="hljs-number"><span class="hljs-number">1</span></span>, SheetLayoutInfo.MaxRowsCount); } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">RemoveRow</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveRow</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SheetLayoutInfo sheetLayoutInfo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rowIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowIndex &gt;= sheetLayoutInfo.MaxRowIndexNonDefault) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> realGroupIndex = rowIndex &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newRowInGroupIndex = rowIndex &amp; <span class="hljs-number"><span class="hljs-number">0xF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> groupIndex; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (groupIndex = realGroupIndex + sheetLayoutInfo.GroupIndexDelta; groupIndex &lt; sheetLayoutInfo.RowsGroups.Count; groupIndex++, newRowInGroupIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (groupIndex &lt; <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (groupIndex == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { sheetLayoutInfo.RowsGroups.Insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); sheetLayoutInfo.GroupIndexDelta++; groupIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (groupIndex == SheetLayoutInfo.MaxGroupsCount) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newRowHeightInfo = groupIndex == SheetLayoutInfo.MaxGroupsCount - <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : GetRowHeightCore(sheetLayoutInfo, (groupIndex - sheetLayoutInfo.GroupIndexDelta + <span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>); RowsGroupInfo rowsGroupInfo = sheetLayoutInfo.RowsGroups[groupIndex]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowsGroupInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newRowHeightInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || (newRowHeightInfo.Flags &amp; CustomHeightMask) == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; rowsGroupInfo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RowsGroupInfo(); sheetLayoutInfo.RowsGroups[groupIndex] = rowsGroupInfo; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newRowHeightInfo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { newRowHeightInfo = CreateDefaultRowHeight(sheetLayoutInfo); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rowInfoIndex = rowsGroupInfo.Indices[newRowInGroupIndex]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rowInfoIndex == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = newRowInGroupIndex; i &lt; SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { rowsGroupInfo.Indices[i] = rowsGroupInfo.Indices[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]; } rowsGroupInfo.HeightInfos.Add(newRowHeightInfo); rowsGroupInfo.Indices[SheetLayoutInfo.MaxRowsCountInGroup - <span class="hljs-number"><span class="hljs-number">1</span></span>] = rowsGroupInfo.HeightInfos.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = newRowInGroupIndex; i &lt; rowsGroupInfo.HeightInfos.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { rowsGroupInfo.Indices[i] = rowsGroupInfo.Indices[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]; } rowsGroupInfo.Indices[rowsGroupInfo.HeightInfos.Count - <span class="hljs-number"><span class="hljs-number">1</span></span>] = rowInfoIndex; rowsGroupInfo.HeightInfos[rowInfoIndex] = newRowHeightInfo; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rowIndex &lt;= sheetLayoutInfo.MinRowIndexNonDefault) { sheetLayoutInfo.MinRowIndexNonDefault = Math.Max(sheetLayoutInfo.MinRowIndexNonDefault - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } }</code> </pre> </div></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><strong>рдЖрдк рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рдХреЛрдб GitHub рдкрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ</strong></a> </p><br><h2 id="vyvody">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рдирд╣реАрдВ рд╣реИ рдЬрдм рдПрдХреНрд╕реЗрд▓ рдХреЛрдб рджрд┐рд▓рдЪрд╕реНрдк рдЯреНрд░рд┐рдХреНрд╕ рд╕реЗ рд╣реИрд░рд╛рди рд╣реЛ рдЧрдпрд╛ рд╣реИред  рдЗрд╕ рдмрд╛рд░ рдореБрдЭреЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рд╡рд╣ рдХреИрд╕реЗ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреА рдКрдВрдЪрд╛рдЗрдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рд╕рдореБрджрд╛рдп рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдкреА рд╣реИ, рддреЛ рдЕрдЧрд▓реЗ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рджрд┐рдЦрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ рдПрдХреНрд╕реЗрд▓ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреА рд╕реАрдорд╛ рдХреА рдКрдВрдЪрд╛рдИ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддрд╛ рд╣реИ (рд╕реНрдкреЙрдЗрд▓рд░: рдПрд╕рдХреНрдпреВрдЖрд░рдЯреА рдЕрдкрдШрдЯрди рдХреЗ рд╕рдорд╛рди рдХреБрдЫ рд╣реИ, рд▓реЗрдХрд┐рди рдХреБрдЫ рдХрд╛рд░рдгреЛрдВ рдХреЗ рдмрд┐рдирд╛ рд░рдХрдо рдХреЛ рд░реЛрдХрдирд╛), рдЖрдк рд╡рд╣рд╛рдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдкреВрд░реНрдгрд╛рдВрдХреЛрдВ рдореЗрдВ рд╕реНрдХреЗрд▓рд┐рдВрдЧ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi435426/">https://habr.com/ru/post/hi435426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi435416/index.html">DIY рдкрд░рд┐рдпреЛрдЬрдирд╛ рддрдХрдиреАрдХред рдкрд░рд┐рдЪрдпрд╛рддреНрдордХ рднрд╛рдЧ</a></li>
<li><a href="../hi435418/index.html">рдлрд╝реНрд▓рдЯрд░ рдореЗрдВ SQLite рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a></li>
<li><a href="../hi435420/index.html">рдЕрдкрд░рд╛рдз рдХреЗ рдЦрд┐рд▓рд╛рдл рд▓рдбрд╝рд╛рдИ рдХрд╛ рднрд╡рд┐рд╖реНрдп рдкрд╛рд░рд┐рд╡рд╛рд░рд┐рдХ рдкреЗрдбрд╝реЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рд╣реИ</a></li>
<li><a href="../hi435422/index.html">рд╕рд┐рд▓рд┐рдХреЙрди рд╡реИрд▓реА рдореЗрдВ рд▓реЛрдЧреЛрдВ рдХреЛ рдХреИрд╕рд╛ рдЕрдиреБрднрд╡ рд╣реБрдЖ</a></li>
<li><a href="../hi435424/index.html">рдкрд╛рд░реНрд╕ рдПрдВрдб рдПрдВрдбреНрд░реЙрдЗрдб: рдиреМрд╕рд┐рдЦрд┐рдП рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ</a></li>
<li><a href="../hi435428/index.html">рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдлрд╝реЗрдХреНрд╕ рдПрдореБрд▓реЗрдЯрд░ рдХрд╛ рд░рд┐рдореЛрдЯ рдХрдВрдЯреНрд░реЛрд▓</a></li>
<li><a href="../hi435430/index.html">рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреА рдЦрдмрд░ рд╕реАрдИрдПрд╕ 2019</a></li>
<li><a href="../hi435432/index.html">рдирдпрд╛ рд╕рд╛рд▓, рдирдпрд╛ GitHub: рдЕрдирд▓рд┐рдорд┐рдЯреЗрдб рдлреНрд░реА рдкреНрд░рд╛рдЗрд╡реЗрдЯ рд░рд┐рдкреЛрдЬрд┐рдЯрд░реАрдЬ</a></li>
<li><a href="../hi435436/index.html">рдЖрдИрдЯреА рдЕрд╡рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ 5 рд░реБрдЭрд╛рди: 2019 рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди</a></li>
<li><a href="../hi435438/index.html">PHP: рдЯреАрдо рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдмрджрд▓рдирд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>