<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§Æ üë∂üèº üåº ¬øQu√© es GitOps? üõåüèø üõÄüèæ üõ°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : Despu√©s de la publicaci√≥n reciente de material sobre m√©todos pull y push en GitOps, vimos inter√©s en este modelo en su conjunto, sin emb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øQu√© es GitOps?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/458878/"> <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: Despu√©s de la publicaci√≥n reciente de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">material</a> sobre m√©todos pull y push en GitOps, vimos inter√©s en este modelo en su conjunto, sin embargo, hab√≠a muy pocas publicaciones en ruso sobre este tema (simplemente no est√°n en el centro).</i>  <i>Por lo tanto, nos complace presentarle una traducci√≥n de otro art√≠culo, ¬°aunque hace casi un a√±o!</i>  <i>- de la empresa Weaveworks, cuyo jefe acu√±√≥ el t√©rmino "GitOps".</i>  <i>El texto explica la esencia del enfoque y las diferencias clave de los existentes.</i> <br><br><img src="https://habrastorage.org/webt/i0/8b/fc/i08bfcph3kkhapzkitpwhylzdhc.png"><br><br>  Hace un a√±o, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicamos</a> una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">introducci√≥n a GitOps</a> .  Luego hablamos sobre c√≥mo el equipo de Weaveworks lanz√≥ SaaS basado en Kubernetes y desarroll√≥ un conjunto de mejores pr√°cticas prescriptivas para implementar, administrar y monitorear en un entorno nativo en la nube. <a name="habracut"></a><br><br>  El art√≠culo result√≥ ser popular.  Otras personas comenzaron a hablar sobre GitOps, comenzaron a publicar nuevas herramientas para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">git push</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrollo</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">secretos</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciones</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">integraci√≥n continua</a> , etc.  Una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gran cantidad de</a> publicaciones y casos de uso de GitOps han aparecido en nuestro sitio.  Pero algunas personas todav√≠a tienen preguntas.  ¬øEn qu√© se diferencia el modelo de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">infraestructura</a> tradicional <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">como c√≥digo</a> y entrega continua?  ¬øEs obligatorio usar Kubernetes? <br><br>  Pronto, nos dimos cuenta de que se necesitaba una nueva descripci√≥n, que ofreciera: <br><br><ol><li>  Una gran cantidad de ejemplos e historias; </li><li>  La definici√≥n espec√≠fica de GitOps; </li><li>  Comparaci√≥n con la entrega continua tradicional. </li></ol><br>  En este art√≠culo, tratamos de cubrir todos estos temas.  En √©l encontrar√° una introducci√≥n actualizada a GitOps y una mirada desde el lado de los desarrolladores y CI / CD.  Nos centramos principalmente en Kubernetes, aunque el modelo puede generalizarse. <br><br><h2>  Conoce a GitOps </h2><br>  Imagina a Alice.  Dirige Family Insurance, una compa√±√≠a que ofrece p√≥lizas de seguro de salud, autom√≥vil, bienes ra√≠ces y viajes para personas que est√°n demasiado ocupadas para comprender los matices de sus contratos por su cuenta.  Su negocio comenz√≥ como un proyecto paralelo cuando Alice trabaj√≥ en el banco como cient√≠fica de datos.  Una vez que se dio cuenta de que pod√≠a usar algoritmos inform√°ticos avanzados para analizar de manera m√°s eficiente los datos y formar paquetes de seguros.  Los inversores financiaron el proyecto, y ahora su compa√±√≠a aporta m√°s de $ 20 millones al a√±o y est√° creciendo r√°pidamente.  Actualmente, 180 personas trabajan en varios puestos en el mismo.  Entre ellos, un equipo de tecnolog√≠a que desarrolla, mantiene un sitio, una base de datos y analiza la base de clientes.  Bob, el director t√©cnico de la compa√±√≠a, dirige un equipo de 60 personas. <br><br>  El equipo de Bob est√° implementando sistemas de producci√≥n en la nube.  Sus principales aplicaciones se ejecutan en GKE, aprovechando Kubernetes en Google Cloud.  Adem√°s, utilizan varias herramientas para trabajar con datos y an√°lisis en su trabajo. <br><br>  Family Insurance no iba a usar contenedores, pero estaba infectado con entusiasmo por Docker.  Pronto, los expertos de la compa√±√≠a descubrieron que GKE facilita y facilita la implementaci√≥n de cl√∫steres para probar nuevas caracter√≠sticas.  Se agregaron Jenkins para CI y Quay para organizar el registro de contenedores, se escribieron scripts para Jenkins que empujan o nuevos contenedores y configuraciones en GKE. <br><br>  Ha pasado un tiempo  Alice y Bob estaban decepcionados con el desempe√±o del enfoque elegido y su impacto en el negocio.  La introducci√≥n de contenedores no aument√≥ la productividad tanto como el equipo esperaba.  A veces, los despliegues se rompieron, y no estaba claro si los cambios en el c√≥digo eran los culpables.  Tambi√©n result√≥ ser dif√≠cil rastrear los cambios en las configuraciones.  A menudo era necesario crear un nuevo cl√∫ster y mover aplicaciones a √©l, ya que era la forma m√°s f√°cil de eliminar el desorden en el que se convirti√≥ el sistema.  Alice tem√≠a que la situaci√≥n empeorara a medida que se desarrollaba la aplicaci√≥n (adem√°s, se estaba gestando un nuevo proyecto basado en el aprendizaje autom√°tico).  Bob automatiz√≥ la mayor parte del trabajo y no entendi√≥ por qu√© la tuber√≠a a√∫n es inestable, no se escala bien y requiere intervenci√≥n manual de vez en cuando. <br><br>  <b>Luego se enteraron de GitOps.</b>  <b>Esta decisi√≥n result√≥ ser exactamente lo que necesitaban para avanzar con confianza.</b> <br><br>  Alice y Bob han escuchado sobre los flujos de trabajo basados ‚Äã‚Äãen Git, DevOps e infraestructura como c√≥digo durante a√±os.  La singularidad de GitOps es que aporta una serie de mejores pr√°cticas, categ√≥ricas y normativas, para implementar estas ideas en el contexto de Kubernetes.  Este tema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se ha planteado repetidamente</a> , incluso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el blog de Weaveworks</a> . <br><br>  Family Insurance decide implementar GitOps.  La compa√±√≠a ahora tiene un modelo operativo automatizado compatible con Kubernetes que combina <i>velocidad</i> con <i>estabilidad</i> , ya que: <br><br><ul><li>  descubri√≥ que el equipo ha duplicado la productividad y nadie se est√° volviendo loco; </li><li>  dej√≥ de dar servicio a los guiones.  En cambio, ahora pueden concentrarse en nuevas caracter√≠sticas y mejorar los m√©todos de ingenier√≠a, por ejemplo, introducir despliegues de canarios y mejorar las pruebas; </li><li>  proceso de implementaci√≥n mejorado: ahora rara vez se rompe; </li><li>  tuvo la oportunidad de recuperar implementaciones despu√©s de fallas parciales sin intervenci√≥n manual; </li><li>  gan√≥ mayor confianza en los sistemas de suministro.  Alice y Bob descubrieron que el equipo puede dividirse en grupos que trabajan en microservicios y trabajan en paralelo; </li><li>  puede hacer 30-50 cambios en el proyecto todos los d√≠as gracias a los esfuerzos de cada grupo y probar nuevas t√©cnicas; </li><li>  son f√°cilmente atra√≠dos por el proyecto por nuevos desarrolladores que tienen la capacidad de lanzar actualizaciones en producci√≥n mediante solicitudes de extracci√≥n en unas pocas horas; </li><li>  f√°cilmente auditado dentro de SOC2 <i>(para el cumplimiento de los proveedores de servicios con los requisitos para la gesti√≥n segura de datos; lea m√°s, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> - aprox. traducci√≥n)</i> . </li></ul><br><h3>  Que paso </h3><br>  GitOps son dos cosas: <br><br><ol><li>  Modelo de operaci√≥n para Kubernetes y cloud native.  Proporciona un conjunto de mejores pr√°cticas para implementar, administrar y monitorear cl√∫steres y aplicaciones en contenedores.  Definici√≥n elegante en una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sola diapositiva</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Luis Faceira</a> : <br><br><img src="https://habrastorage.org/webt/or/fl/uu/orfluutk_hcqu6dnclf6pu1ewes.jpeg"></li><li>  El camino para crear un entorno orientado al desarrollador para administrar aplicaciones.  Aplicamos el flujo de trabajo de Git tanto a la explotaci√≥n como al desarrollo.  Tenga en cuenta que esto no se trata solo de Git push, sino de organizar todo el conjunto de herramientas CI / CD y UI / UX. </li></ol><br><h3>  Algunas palabras sobre Git </h3><br>  Si no est√° familiarizado con los sistemas de control de versiones y el flujo de trabajo basado en Git, le recomendamos que los estudie.  Al principio, trabajar con ramas y solicitudes de extracci√≥n puede parecer magia negra, pero los profesionales merecen la pena.  Aqu√≠ hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">buen art√≠culo</a> para comenzar. <br><br><h2>  C√≥mo funciona Kubernetes </h2><br>  En nuestra historia, Alice y Bob recurrieron a GitOps despu√©s de trabajar con Kubernetes por un tiempo.  De hecho, GitOps est√° estrechamente relacionado con Kubernetes: es un modelo operativo para la infraestructura y las aplicaciones basadas en Kubernetes. <br><br><h3>  ¬øQu√© les da Kubernetes a los usuarios? </h3><br>  Aqu√≠ hay algunas caracter√≠sticas clave: <br><br><ol><li>  En el modelo de Kubernetes, todo se puede describir en forma declarativa. </li><li>  El servidor API de Kubernetes acepta dicha declaraci√≥n como entrada, y luego intenta constantemente llevar el cl√∫ster al estado descrito en la declaraci√≥n. </li><li>  Las declaraciones son suficientes para describir y administrar una amplia variedad de cargas de trabajo: "aplicaciones". </li><li>  Como resultado, los cambios en la aplicaci√≥n y el cl√∫ster se deben a: <br><ul><li>  cambios a las im√°genes del contenedor; </li><li>  cambios a la especificaci√≥n declarativa; </li><li>  errores en el entorno, por ejemplo, bloqueos de contenedores. </li></ul></li></ol><br><h3>  Las grandes habilidades de convergencia de Kubernetes </h3><br>  Cuando un administrador realiza cambios de configuraci√≥n, el orquestador de Kubernetes los aplicar√° al cl√∫ster hasta que su estado se <i>acerque a la nueva configuraci√≥n</i> .  Este modelo funciona para cualquier recurso de Kubernetes y se extiende con las Definiciones de recursos personalizadas (CRD).  Por lo tanto, las implementaciones de Kubernetes tienen las siguientes propiedades maravillosas: <br><br><ul><li>  <b>Automatizaci√≥n</b> : las actualizaciones de Kubernetes proporcionan un mecanismo para automatizar el proceso de aplicaci√≥n de cambios de manera correcta y oportuna. </li><li>  <b>Convergencia</b> : Kubernetes continuar√° intentando actualizaciones hasta el √©xito. </li><li>  <b>Idempotencia</b> : las aplicaciones repetidas de convergencia producen el mismo resultado. </li><li>  <b>Determinismo</b> : con suficientes recursos, el estado del cl√∫ster actualizado depende solo del estado deseado. </li></ul><br><h2>  C√≥mo funciona GitOps </h2><br>  Hemos aprendido lo suficiente sobre Kubernetes para explicar c√≥mo funciona GitOps. <br><br>  Volvamos a los equipos de Family Insurance relacionados con microservicios.  ¬øQu√© suelen hacer?  Mire la lista a continuaci√≥n (si alg√∫n punto parece extra√±o o desconocido, posponga las cr√≠ticas y qu√©dese con nosotros).  Estos son solo ejemplos de flujos de trabajo basados ‚Äã‚Äãen Jenkins.  Existen muchos otros procesos cuando se trabaja con otras herramientas. <br><br>  Lo principal es que vemos que cada actualizaci√≥n termina con cambios en los archivos de configuraci√≥n y repositorios de Git.  Estos cambios en Git provocan que la "instrucci√≥n GitOps" actualice el cl√∫ster: <br><br>  1. Flujo de trabajo: " <i>Jenkins Build - rama maestra</i> ". <br>  La lista de tareas: <br><br><ul><li>  Jenkins empuja im√°genes etiquetadas en Quay; </li><li>  Jenkins push'it config y Helm charts al cubo de almacenamiento maestro; </li><li>  La funci√≥n de nube copia la configuraci√≥n y los gr√°ficos del dep√≥sito de almacenamiento maestro al repositorio git maestro; </li><li>  La instrucci√≥n GitOps actualiza el cl√∫ster. </li></ul><br>  2. <i>Jenkins build - lanzamiento o ramificaci√≥n de revisi√≥n</i> : <br><br><ul><li>  Jenkins empuja im√°genes sin etiquetar en Quay; </li><li>  Jenkins empuja los gr√°ficos de configuraci√≥n y Helm al dep√≥sito de almacenamiento provisional; </li><li>  La funci√≥n en la nube copia la configuraci√≥n y los gr√°ficos del dep√≥sito del almacenamiento provisional en la disposici√≥n del repositorio Git; </li><li>  La instrucci√≥n GitOps actualiza el cl√∫ster. </li></ul><br>  3. <i>Jenkins build - desarrollar o presentar una rama</i> : <br><br><ul><li>  Jenkins empuja im√°genes sin etiquetar en Quay; </li><li>  Jenkins empuja los gr√°ficos de configuraci√≥n y Helm al cubo de almacenamiento de desarrollo; </li><li>  La funci√≥n en la nube copia la configuraci√≥n y los gr√°ficos desde el dep√≥sito de almacenamiento de desarrollo al repositorio de desarrollo de git; </li><li>  La instrucci√≥n GitOps actualiza el cl√∫ster. </li></ul><br>  4. <i>Agregar un nuevo cliente</i> : <br><br><ul><li>  Un gerente o administrador (LCM / ops) llama a Gradle para implementar y configurar inicialmente los equilibradores de carga de red (NLB); </li><li>  LCM / ops confirma una nueva configuraci√≥n para preparar la implementaci√≥n de actualizaciones; </li><li>  La instrucci√≥n GitOps actualiza el cl√∫ster. </li></ul><br><h3>  Breve descripci√≥n de GitOps </h3><br><ol><li>  Describa el estado deseado de todo el sistema utilizando especificaciones declarativas para cada entorno (en nuestra historia, el equipo de Bob define la configuraci√≥n completa del sistema en Git). <br><br><ul><li>  El repositorio de git es la √∫nica fuente de verdad sobre el estado deseado de todo el sistema. </li><li>  Todos los cambios en el estado deseado se realizan a trav√©s de confirmaciones en Git. </li><li>  Todos los par√°metros deseados del cl√∫ster tambi√©n son observables en el propio cl√∫ster.  Por lo tanto, podemos determinar si los estados deseados y observados coinciden (convergen, <i>convergen</i> ) o difieren ( <i>divergen</i> , <i>divergen</i> ). </li></ul></li><li>  Si los estados deseados y observados son diferentes, entonces: <br><br><ul><li>  Existe un mecanismo de convergencia que tarde o temprano sincroniza autom√°ticamente los estados objetivo y observado.  Dentro del grupo, Kubernetes hace esto. </li><li>  El proceso comienza inmediatamente con una notificaci√≥n de "cambio comprometido". </li><li>  Despu√©s de un per√≠odo de tiempo configurable, se puede enviar una alerta de diferencia si los estados son diferentes. </li></ul></li><li>  Por lo tanto, todas las confirmaciones en Git desencadenan actualizaciones verificables e idempotentes en el cl√∫ster. <br><br><ul><li>  La reversi√≥n es una convergencia a un estado previamente deseado. </li></ul></li><li>  La convergencia es final.  Sobre su inicio testificar: <br><br><ul><li>  Falta de alertas "diff" por un cierto per√≠odo de tiempo. </li><li>  Una alerta convergente (por ejemplo, webhook, evento de reescritura de Git). </li></ul></li></ol><br><h3>  ¬øQu√© es la divergencia? </h3><br>  Repetimos nuevamente: <i>todas las propiedades deseadas del cl√∫ster deben ser observables en el mismo cl√∫ster</i> . <br><br>  Algunos ejemplos de divergencia: <br><br><ul><li>  Cambio en el archivo de configuraci√≥n debido a la fusi√≥n de ramas en Git. </li><li>  Un cambio en el archivo de configuraci√≥n debido a una confirmaci√≥n en Git realizada por el cliente GUI. </li><li>  M√∫ltiples cambios en el estado deseado debido a PR en Git con el posterior ensamblaje de la imagen del contenedor y cambios en la configuraci√≥n. </li><li>  Cambio de estado del cl√∫ster debido a un error, conflicto de recursos que conduce a un "mal comportamiento", o simplemente una desviaci√≥n accidental del estado original. </li></ul><br><h3>  ¬øQu√© es un mecanismo de convergencia? </h3><br>  Algunos ejemplos <br><br><ul><li>  Para contenedores y clusters, el mecanismo de convergencia proporciona Kubernetes. </li><li>  Se puede usar el mismo mecanismo para administrar aplicaciones y dise√±os basados ‚Äã‚Äãen Kubernetes (por ejemplo, Istio y Kubeflow). </li><li>  El mecanismo para gestionar la interacci√≥n de trabajo entre Kubernetes, repositorios de im√°genes y Git lo proporciona <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el operador Weave Flux GitOps</a> , que forma parte de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Weave Cloud</a> . </li><li>  Para las m√°quinas base, el mecanismo de convergencia debe ser declarativo y aut√≥nomo.  Desde nuestra propia experiencia, podemos decir que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Terraform est√°</a> m√°s cerca de esta definici√≥n, pero a√∫n requiere control humano.  En este sentido, GitOps extiende la tradici√≥n de Infraestructura como C√≥digo. </li></ul><br>  GitOps combina Git con el excelente motor de convergencia de Kubernetes, ofreciendo un modelo para la operaci√≥n. <br><br>  GitOps nos permite declarar que <i>solo aquellos sistemas que pueden describirse y observarse pueden automatizarse y controlarse</i> . <br><br><h3>  GitOps es para toda la pila nativa de la nube (por ejemplo, Terraform, etc.) </h3><br>  GitOps no es solo Kubernetes.  Queremos que todo el sistema se gestione de forma declarativa y que utilice la convergencia.  Por todo un sistema nos referimos a un conjunto de entornos que trabajan con Kubernetes, por ejemplo, "dev cluster 1", "production", etc. Cada entorno incluye m√°quinas, clusters, aplicaciones, as√≠ como interfaces para servicios externos que proporcionan datos, monitoreo y etc. <br><br>  Observe c√≥mo Terraform es importante en este caso para el problema de arranque.  Kubernetes necesita implementarse en alg√∫n lugar, y el uso de Terraform significa que podemos usar los mismos flujos de trabajo de GitOps para crear la capa de control que subyace a Kubernetes y las aplicaciones.  Esta es una buena pr√°ctica recomendada. <br><br>  Se presta mucha atenci√≥n a la aplicaci√≥n de conceptos de GitOps a capas sobre Kubernetes.  Actualmente existen soluciones de tipo GitOps para Istio, Helm, Ksonnet, OpenFaaS y Kubeflow, as√≠ como, por ejemplo, Pulumi, que crean una capa para desarrollar aplicaciones para la nube nativa. <br><br><h2>  Kubernetes CI / CD: comparaci√≥n de GitOps con otros enfoques </h2><br>  Como se dijo, GitOps son dos cosas: <br><br><ol><li>  El modelo operativo para Kubernetes y la nube nativa descritos anteriormente. </li><li>  El camino para organizar un entorno de gesti√≥n de aplicaciones centrado en el desarrollador. </li></ol><br>  Para muchos, GitOps es principalmente un flujo de trabajo basado en Git push.  A nosotros tambi√©n nos gusta.  Pero esto no es todo: veamos ahora las canalizaciones de CI / CD. <br><br><h3>  GitOps proporciona implementaci√≥n continua (CD) para Kubernetes </h3><br>  GitOps ofrece un mecanismo de implementaci√≥n continua que elimina la necesidad de "sistemas de administraci√≥n de implementaci√≥n" separados.  Kubernetes hace todo el trabajo por ti. <br><br><ul><li>  La actualizaci√≥n de la aplicaci√≥n requiere una actualizaci√≥n en Git.  Esta es una actualizaci√≥n transaccional al estado deseado.  El "despliegue" se lleva a cabo dentro del cl√∫ster por Kubernetes basado en una descripci√≥n actualizada. </li><li>  Debido a los detalles de Kubernetes, estas actualizaciones son convergentes.  Esto proporciona un mecanismo para la implementaci√≥n continua en la que todas las actualizaciones son at√≥micas. </li><li>  Nota: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Weave Cloud</a> ofrece un operador GitOps que integra Git y Kubernetes y le permite ejecutar un CD haciendo coincidir el estado deseado y actual del cl√∫ster. </li></ul><br><h3>  Sin kubectl y scripts </h3><br>  Evite usar Kubectl para actualizar el cl√∫ster, y especialmente los scripts para agrupar comandos de kubectl.  En cambio, con una canalizaci√≥n de GitOps, un usuario puede actualizar su cl√∫ster de Kubernetes a trav√©s de Git. <br><br>  Los beneficios incluyen: <br><br><ol><li>  <b>Correcci√≥n</b>  Se puede aplicar, converger y finalmente validar un grupo de actualizaciones, lo que nos acerca al objetivo del despliegue at√≥mico.  Por el contrario, el uso de scripts no ofrece ninguna garant√≠a de convergencia (m√°s sobre esto a continuaci√≥n). </li><li>  <b>Seguridad</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Citando a</a> Kelsey Hightower: "Limite el acceso al cl√∫ster de Kubernetes a las herramientas de automatizaci√≥n y a los administradores responsables de la depuraci√≥n o el mantenimiento".  Consulte tambi√©n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mi publicaci√≥n</a> sobre seguridad y cumplimiento, as√≠ como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un art√≠culo sobre la pirater√≠a de Homebrew</a> robando credenciales de un script Jenkins escrito descuidadamente. </li><li>  <b>Experiencia del usuario</b>  Kubectl expone la mec√°nica del modelo de objetos de Kubernetes, que es bastante complejo.  Idealmente, los usuarios deber√≠an interactuar con el sistema a un nivel m√°s alto de abstracci√≥n.  Aqu√≠ nuevamente me referir√© a Kelsey y recomendar√© mirar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tal curr√≠culum</a> . </li></ol><br><h3>  La diferencia entre CI y CD </h3><br>  GitOps mejora los modelos existentes de CI / CD. <br><br>  El servidor CI moderno es un instrumento para la orquestaci√≥n.  En particular, es un instrumento para orquestar tuber√≠as de CI.  Incluyen compilaci√≥n, prueba, fusi√≥n a troncal, etc. Los servidores CI automatizan la gesti√≥n de tuber√≠as complejas de varios pasos.  Una tentaci√≥n com√∫n es crear un script para el conjunto de actualizaciones de Kubernetes y ejecutarlo como un elemento de canalizaci√≥n para impulsar los cambios en el cl√∫ster.  De hecho, esto es lo que hacen muchos expertos.  Sin embargo, esto no es √≥ptimo, y he aqu√≠ por qu√©. <br><br>  CI debe usarse para realizar actualizaciones en el enlace troncal, y el cl√∫ster de Kubernetes debe cambiarse en funci√≥n de estas actualizaciones para poder administrar el CD "internamente".  Llamamos a esto el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modelo pull para el CD</a> , a diferencia del modelo push de CI.  El CD es parte de una <i>orquestaci√≥n de tiempo</i> de <i>ejecuci√≥n</i> . <br><br><h3>  Por qu√© los servidores CI no deber√≠an hacer CD a trav√©s de actualizaciones directas en Kubernetes </h3><br>  <i>No utilice el servidor de CI para organizar actualizaciones directas en Kubernetes como un conjunto de tareas de CI.</i>  <i>Este es el antipatr√≥n del que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ya hablamos</a> en nuestro blog.</i> <br><br>  Volvamos a Alice y Bob. <br><br>  ¬øQu√© problemas encontraron?  El servidor CI de Bob aplica los cambios al cl√∫ster, pero si cae en el proceso, Bob no sabr√° en qu√© estado est√° (o deber√≠a estar) el cl√∫ster y c√≥mo solucionarlo.  Lo mismo es cierto si tiene √©xito. <br><br>  Supongamos que el equipo de Bob cre√≥ una nueva imagen y luego parche√≥ sus implementaciones para implementar la imagen (todo desde el canal de CI). <br><br>  Si la imagen se construye normalmente, pero la tuber√≠a se cae, el equipo tendr√° que averiguar: <br><br><ul><li>  ¬øSe ha implementado la actualizaci√≥n? </li><li>  ¬øEstamos comenzando una nueva construcci√≥n?        ‚Äî           ? </li><li>      ,    ? </li><li>     ?     (     )? </li></ul><br> <i>   Git'    ,        .  -    push' ,    -  ;          --.</i> <br><br> ,   CI-    CD: <br><br><ul><li>     ;     . </li><li> CI-      . </li><li>   .       . </li><li>      . </li></ul><br> <i>  Helm'e:     Helm,      GitOps-,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Flux-Helm</a> .    .    Helm    ,  .</i> <br><br><h2> GitOps     Continuous Delivery  Kubernetes </h2><br>      GitOps  ,        ,     .     , ,     . ,         ,  GitOps      . <br><br><h3>    Kubernetes </h3><br>    .   Git            : <br><br><ul><li>   ,       Git      . </li><li>  Runtime GitOps,      .       Git     . </li></ul><br><img src="https://habrastorage.org/webt/0h/mo/vs/0hmovs2jg182thgg_hxll6jabwk.png"><br><br><h3>   ? </h3><br><ol><li> <b> </b> :  ,      ,   Git   .  ,     CI  runtime-.    ¬´ ¬ª <i>(immutability firewall)</i> ,       .          72-87 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> . </li><li> <b>   CI-  Git-</b> : GitOps    .       CI-  Git-,     .      Continuous Delivery     CI-/Git-   .        cloud native.   GitOps     . </li><li> <b>   </b> :     Git , Weave Flux (  Weave Cloud)    runtime.  ,  Kubernetes   , Git .           GitOps,   . </li></ol><br><img src="https://habrastorage.org/webt/xh/wn/83/xhwn83itzgegzohc4vyp2sprpe8.png"><br><br><h2>  Conclusi√≥n </h2><br> GitOps    ,     CI/CD: <br><br><ul><li> ; </li><li> ; </li><li> ; </li><li> . </li></ul><br>  ,          cloud native. <br><br><ul><li>           ,    runbook' <i>(     ‚Äî . .)</i> ,    deployment'. </li><li>   cloud native-         ,        . </li></ul><br>   ,              . GitOps  -      . <br><br><h2>  PD del traductor </h2><br>  Lea tambi√©n en nuestro blog: <br><br><ul><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> werf 1.0 stable:    GitOps,   </a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitOps:   Pull  Push</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  kubedog     Kubernetes</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   Kubernetes (   )</a> ¬ª. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/458878/">https://habr.com/ru/post/458878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458866/index.html">C√≥mo funciona el equipo equilibrador en World of Tanks Blitz</a></li>
<li><a href="../458868/index.html">Ruido en big data. An√°lisis de entrop√≠a</a></li>
<li><a href="../458870/index.html">Problemas inform√°ticos m√°s populares a los que nos enfrentamos todos los d√≠as</a></li>
<li><a href="../458874/index.html">Lista de verificaci√≥n de ASO: optimizaci√≥n de texto</a></li>
<li><a href="../458876/index.html">Viernes Mini CTF</a></li>
<li><a href="../458880/index.html">Desarrollo de Linux en Windows con WSL y Visual Studio Code Remote</a></li>
<li><a href="../458882/index.html">Hablar en p√∫blico Brevemente sobre lo principal</a></li>
<li><a href="../458884/index.html">Un poco sobre los est√°ndares de comunicaciones espaciales</a></li>
<li><a href="../458886/index.html">Los documentos m√°s √∫tiles de Mail.ru Design Conf √ó Dribbble Meetup 2019 de True Engineering</a></li>
<li><a href="../458888/index.html">Meetup de Summer Droid</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>