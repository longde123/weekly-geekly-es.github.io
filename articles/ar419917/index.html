<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏽 📡 🚆 الشبكات العصبية: تنفيذ مهمة الفطر على Tensor Flow و Python 👩‍🚒 🔽 🧚🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensor Flow هو إطار عمل لبناء الشبكات العصبية والعمل عليها من Google. يتيح لك التجريد من التفاصيل الداخلية للتعلم الآلي والتركيز مباشرة على حل مشكلتك....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>الشبكات العصبية: تنفيذ مهمة الفطر على Tensor Flow و Python</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419917/" style=";text-align:right;direction:rtl">  Tensor Flow هو إطار عمل لبناء الشبكات العصبية والعمل عليها من Google.  يتيح لك التجريد من التفاصيل الداخلية للتعلم الآلي والتركيز مباشرة على حل مشكلتك.  شيء قوي للغاية ، يسمح لك بإنشاء وتدريب واستخدام الشبكات العصبية من أي نوع معروف.  لم أجد نصاً واحداً معقولاً على حبري حول هذا الموضوع ، لذا أكتب نصي الخاص.  سنصف أدناه تنفيذ حل مشكلة الفطر باستخدام مكتبة Tensor Flow.  بالمناسبة ، الخوارزمية الموضحة أدناه مناسبة للتنبؤات في أي مجال تقريبًا.  على سبيل المثال ، احتمالية الإصابة بالسرطان في الشخص في المستقبل أو البطاقات في الخصم في لعبة البوكر. <a name="habracut"></a><br><br><h3 style=";text-align:right;direction:rtl">  التحدي </h3><br>  جوهر المشكلة: على أساس معلمات المدخلات من الفطريات لتحديد قابليتها للأكل.  إن الدقة هي أن هذه المعلمات هي تصنيفية وليست رقمية.  على سبيل المثال ، يمكن تعيين معلمة "شكل القبعة" على "مسطح" أو "محدب" أو "على شكل مخروطي".  مجموعة بيانات الفطر للتعلم الشبكي المأخوذة من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع التعلم الآلي</a> .  وبالتالي ، يمكن أن يسمى حل المشكلة نوعًا من Hello World في مجال التعلم الآلي ، إلى جانب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مشكلة القزحية</a> ، حيث يتم التعبير عن معلمات الزهرة في القيم الرقمية. <br><br><h3 style=";text-align:right;direction:rtl">  كود المصدر </h3><br>  يمكنك تنزيل جميع المصادر من مستودعي على Github: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">link</a> .  افعل ذلك لترى الكود وهو يعمل.  استخدم رموز المصدر فقط ، لأنه تتم ملاحظة جميع المسافات البادئة والتشفير اللازمة هناك.  أدناه سيتم مناقشة العملية برمتها بالتفصيل. <br><br><h3 style=";text-align:right;direction:rtl">  تحضير </h3><br>  من المفترض أن لديك تثبيت Tensor Flow مثبت مسبقًا.  إذا لم يكن كذلك ، يمكنك تثبيت <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الرابط</a> . <br><br><h3 style=";text-align:right;direction:rtl">  كود المصدر </h3><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-comment"><span class="hljs-comment">#       . #     CSV-    Tensor Flow       .  ,       (0  1) def prepare_data(data_file_name): header = ['class', 'cap_shape', 'cap_surface', #  CSV-   ,     'agaricus-lepiota.name'   'cap_color', 'bruises', 'odor', 'gill_attachment', 'gill_spacing', 'gill_size', 'gill_color', 'stalk_shape', 'stalk_root', 'stalk_surface_above_ring', 'stalk_surface_below_ring', 'stalk_color_above_ring', 'stalk_color_below_ring', 'veil_type', 'veil_color', 'ring_number', 'ring_type', 'spore_print_color', 'population', 'habitat'] df = pd.read_csv(data_file_name, sep=',', names=header) #   "?"      #        df.replace('?', np.nan, inplace=True) df.dropna(inplace=True) #         #  'e'  'p' .       # ,   0  , 1 -    df['class'].replace('p', 0, inplace=True) df['class'].replace('e', 1, inplace=True) #       , #     . Tensor Flow      # .  Pandas    "get_dummies" #      cols_to_transform = header[1:] df = pd.get_dummies(df, columns=cols_to_transform) #      #    -    () #      () df_train, df_test = train_test_split(df, test_size=0.1) #           num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #      csv-, .. #          #  csv,    Tensor Flow df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #     ,    open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read()) #   ,     os.remove("train_temp.csv") os.remove("test_temp.csv") #        Tensor Flow def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y #        Tensor Flow def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y #        #    ( : , ) #  ,         def new_samples(): return np.array([[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1]], dtype=np.int) if __name__ == "__main__": MUSHROOM_DATA_FILE = "agaricus-lepiota.data" #     Tensor Flow, #   CSV- (  ) prepare_data(MUSHROOM_DATA_FILE) #    training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_train.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_test.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) # ,        ( ) feature_columns = [tf.contrib.layers.real_valued_column("", dimension=98)] #   DNN-  10, 20  10    classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=2, model_dir="/tmp/mushroom_model") #   classifier.fit(input_fn=get_train_inputs, steps=2000) #        accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)["accuracy"] print("\n : {0:f}\n".format(accuracy_score)) #         predictions = list(classifier.predict_classes(input_fn=new_samples)) print("   : {}\n" .format(predictions))</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  قم بتنزيل وإعداد البيانات من المستودع </h3><br>  سنقوم بتنزيل بيانات التدريب واختبار الشبكة العصبية من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مستودع التعلم الآلي الذي</a> تم إنشاؤه خصيصًا لهذا الغرض.  يتم تقديم جميع البيانات في ملفين: agaricus-lepiota.data و agaricus-lepiota.names.  أول 8124 صفًا و 22 عمودًا.  يوفر سطر واحد فطر واحد ، كل عمود هو واحد من 22 معلمة للفطر في شكل حرف اختزال من كلمة المعلمة بأكملها.  أسطورة جميع الشخصيات موجودة في ملف agarius-lepiota.names. <br><br>  يجب معالجة البيانات من المستودع من أجل إحضاره إلى شكل مقبول لـ Tensor Flow.  أولا نستورد بعض المكتبات للعمل <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os</code> </pre> <br>  ثم سنشكل رأسًا من معلمات الفطر لـ Tensor Flow ، بحيث تعرف المكتبة أي عمود في ملف البيانات يتوافق مع أي معلمة.  يتم لصق القبعة على ملف البيانات.  نشكل في شكل صفيف ، يتم أخذ عناصرها من ملف agaricus-lepiota.names. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">header = [<span class="hljs-string"><span class="hljs-string">'class'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_surface'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'bruises'</span></span>, <span class="hljs-string"><span class="hljs-string">'odor'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_attachment'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_spacing'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_size'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_root'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_number'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'spore_print_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'population'</span></span>, <span class="hljs-string"><span class="hljs-string">'habitat'</span></span>] df = pd.read_csv(data_file_name, sep=<span class="hljs-string"><span class="hljs-string">','</span></span>, names=header)</code> </pre> <br>  الآن أنت بحاجة للتعامل مع البيانات المفقودة.  في هذه الحالة ، يتم تعيين الرمز "؟" في ملف agaricus-lepiota.data بدلاً من المعلمة.  هناك العديد من الطرق للتعامل مع مثل هذه الحالات ، ولكننا ببساطة سنحذف السطر بأكمله بمعلمة واحدة مفقودة على الأقل. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df.replace(<span class="hljs-string"><span class="hljs-string">'?'</span></span>, np.nan, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  بعد ذلك ، يجب عليك استبدال معلمة قابلية الأكل الرمزية يدويًا بمعامل رقمي.  بمعنى ، استبدل "p" و "e" بـ 0 و 1. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  وبعد ذلك ، يمكنك تحويل بقية البيانات إلى رقم.  هذا ما تقوم به وظيفة get_dummies في مكتبة الباندا. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">cols_to_transform = header[<span class="hljs-number"><span class="hljs-number">1</span></span>:] df = pd.get_dummies(df, columns=cols_to_transform)</code> </pre> <br>  يجب تدريب أي شبكة عصبية.  ولكن بالإضافة إلى ذلك ، فإنه يحتاج أيضًا إلى المعايرة من أجل زيادة دقة العمل في الظروف الحقيقية.  للقيام بذلك ، سوف نقسم مجموعة البيانات الخاصة بنا إلى قسمين - التدريب والمعايرة.  الأول سيكون أكبر من الثاني ، كما يجب أن يكون. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">df_train, df_test = train_test_split(df, test_size=<span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  والأخير.  يتطلب Tensor Flow عدد صفوف وأعمدة الملف ليتم الإشارة إليه في بداية ملفات البيانات.  سنقوم باستخراج هذه المعلومات يدويًا من مجموعات بيانات التدريب والمعايرة الخاصة بنا ومن ثم الكتابة إلى ملفات CSV الناتجة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #     CSV df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #       CSV,      open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read())</span></span></code> </pre> <br>  في النهاية ، يجب أن تحصل على هذه الملفات: <a href="">التدريب</a> <a href="">والمعايرة</a> . <br><br><h3 style=";text-align:right;direction:rtl">  رمي البيانات التي تم إنشاؤها في Tensor Flow </h3><br>  الآن بعد أن قمنا بتنزيله من المستودع ومعالجة ملفات CSV باستخدام بيانات الفطر ، يمكنك إرسالها إلى Tensor Flow للتدريب.  يتم ذلك باستخدام دالة load_csv_with_header () التي يوفرها الإطار نفسه: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_train.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_test.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  تعمل دالة load_csv_with_header () في تكوين مجموعة بيانات تدريب من الملفات التي قمنا بجمعها أعلاه.  بالإضافة إلى ملف البيانات ، تأخذ الدالة target_dtype كوسيطة ، وهي نوع من البيانات المتوقعة في النهاية.  في حالتنا ، من الضروري تعليم الشبكة العصبية للتنبؤ بأكل أو سمية الفطريات ، والتي يمكن التعبير عنها بالقيم 1 أو 0. وبالتالي ، في حالتنا ، target_dtype هي قيمة صحيحة.  features_dtype - معلمة يتم فيها تعيين نوع المعلمات المقبولة للتدريب.  في حالتنا ، هو أيضًا عدد صحيح (في البداية كانوا سلسلة ، ولكن ، كما تتذكر ، تجاوزناهم في رقم).  في النهاية ، يتم تعيين معلمة target_column ، وهو فهرس العمود مع المعلمة التي تتوقعها الشبكة العصبية.  أي مع معلمة قابلية الطعام. <br><br><h3 style=";text-align:right;direction:rtl">  إنشاء كائن مصنف تدفق الموتر </h3><br>  أي كائن من فئة تشارك مباشرة في توقع النتيجة.  وبعبارة أخرى ، فئة الشبكة العصبية نفسها. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">feature_columns = [tf.contrib.layers.real_valued_column(<span class="hljs-string"><span class="hljs-string">""</span></span>, dimension=<span class="hljs-number"><span class="hljs-number">98</span></span>)] classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], n_classes=<span class="hljs-number"><span class="hljs-number">2</span></span>, model_dir=<span class="hljs-string"><span class="hljs-string">"/tmp/mushroom_model"</span></span>)</code> </pre> <br>  المعلمة الأولى هي feature_columns.  هذه هي معلمات الفطر.  يرجى ملاحظة أنه يتم إنشاء قيمة المعلمة هناك ، وهي أعلى قليلاً.  هناك ، عند الإدخال ، يتم أخذ القيمة 98 من معلمة البعد ، مما يعني 98 معلمة مختلفة للفطر ، باستثناء الطعام. <br><br>  hidden_units - عدد الخلايا العصبية في كل طبقة من الشبكة العصبية.  الاختيار الصحيح لعدد الطبقات والخلايا العصبية فيها شيء على مستوى الفن في مجال التعلم الآلي.  من الممكن تحديد هذه القيم بشكل صحيح فقط بعد الخبرة.  لقد أخذنا هذه الأرقام لمجرد أنها مدرجة في أحد دروس Tensor Flow التعليمية.  ويعملون. <br><br>  n_classes - عدد الفصول المتوقعة.  لدينا اثنان منهم - صالح للأكل وليس. <br><br>  model_dir - المسار الذي سيتم فيه حفظ النموذج المدرّب للشبكة العصبية.  وفي المستقبل سيتم استخدامه للتنبؤ بالنتائج ، حتى لا يتم تدريب الشبكة في كل مرة. <br><br><h3 style=";text-align:right;direction:rtl">  تدريب </h3><br>  لسهولة العمل في المستقبل ، سنقوم بإنشاء وظيفتين: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_test_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(test_set.data) y = tf.constant(test_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_train_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(training_set.data) y = tf.constant(training_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y</code> </pre> <br>  توفر كل وظيفة مجموعتها الخاصة من بيانات الإدخال - للتدريب والمعايرة.  x و y هما ثوابت Tensor Flow التي يحتاجها الإطار للعمل.  لا تدخل في التفاصيل ، فقط اقبل أن هذه الوظائف يجب أن تكون وسيطًا بين البيانات والشبكة العصبية. <br><br>  ندرب شبكة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">classifier.fit(input_fn=get_train_inputs, steps=<span class="hljs-number"><span class="hljs-number">2000</span></span>)</code> </pre> <br>  تأخذ المعلمة الأولى بيانات الإدخال التي تم تكوينها أعلاه ، والثانية - عدد خطوات التدريب.  مرة أخرى ، تم استخدام الرقم في أحد أدلة Tensor Flow ، وسيأتيك فهم هذا الإعداد مع الخبرة. <br><br>  بعد ذلك ، قم بمعايرة الشبكة المدربة.  يتم ذلك باستخدام مجموعة بيانات المعايرة التي تم إنشاؤها أعلاه.  وستكون نتيجة العمل دقة التنبؤات المستقبلية للشبكة (الدقة _النقاط). <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=<span class="hljs-number"><span class="hljs-number">1</span></span>)[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>] print(<span class="hljs-string"><span class="hljs-string">"\n : {0:f}\n"</span></span>.format(accuracy_score))</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  سنختبر في </h3><br>  الآن الشبكة العصبية جاهزة ، ويمكنك محاولة التنبؤ بمساعدة فطرياتها. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], dtype=np.int)</code> </pre> <br>  تقدم الوظيفة أعلاه بيانات فطرين جديدين تمامًا لم يكونا موجودين في التدريب أو في مجموعات المعايرة (في الواقع ، تم سحبهما ببساطة من الأخير).  تخيل ، على سبيل المثال ، أنك اشتريتها في السوق ، وتحاول فهم ما إذا كان يمكن تناولها.  سيحدد الرمز أدناه هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">predictions = list(classifier.predict(input_fn=new_samples)) print(<span class="hljs-string"><span class="hljs-string">"   : {}\n"</span></span> .format(predictions))</code> </pre> <br>  يجب أن تكون نتيجة العمل على النحو التالي: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">   : [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br>  وهذا يعني أن الفطر الأول سام ، والثاني صالح للأكل.  وبالتالي ، يمكنك إجراء تنبؤات استنادًا إلى أي بيانات ، سواء كانت فطرًا أو أشخاصًا أو حيوانات أو أي شيء.  يكفي لتشكيل بيانات الإدخال بشكل صحيح.  والتنبؤ ، على سبيل المثال ، باحتمالية عدم انتظام ضربات القلب لدى المريض في المستقبل أو حركة أسعار الأسهم في البورصة. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar419917/">https://habr.com/ru/post/ar419917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar419905/index.html">تستيقظ صناعة الإطلاق في المملكة المتحدة وتحدد الأهداف - بعد نصف قرن من Black Arrow</a></li>
<li><a href="../ar419907/index.html">نصائح لإطلاق ألعاب الجوال: الجزء 2 ، الإطلاق العالمي</a></li>
<li><a href="../ar419911/index.html">بناء مدارات الأجرام السماوية باستخدام Python</a></li>
<li><a href="../ar419913/index.html">ايكيا والمنزل الذكي. الجزء 2</a></li>
<li><a href="../ar419915/index.html">الترابط وخادم SSH في initramfs</a></li>
<li><a href="../ar419919/index.html">التحكم في الإصدار داخل SQL Server</a></li>
<li><a href="../ar419921/index.html">كيفية إسقاط 10 مليون علبة في الثانية</a></li>
<li><a href="../ar419923/index.html">عملي المؤقت ، ساعات اللوحة الأم</a></li>
<li><a href="../ar419925/index.html">التحكم في إصدار الملفات الفردية باستخدام GitHub Gist</a></li>
<li><a href="../ar419927/index.html">[DotNetBook] الاستثناءات: اكتب بنية النظام</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>