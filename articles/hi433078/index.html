<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯС╖ тЬНЁЯП╗ ЁЯеВ рд╣рдо рд╕реНрдЯреЙрдХрд╢рд╛рд░реНрдк рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд░реЛрдмреЛрдЯ рд▓рд┐рдЦрддреЗ рд╣реИрдВред рднрд╛рдЧ реи ЁЯМЬ ЁЯТЕЁЯП╛ ЁЯМ╜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣рдо рд╕реНрдЯреЙрдХрд╢рд░реНрдк рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд░реЛрдмреЛрдЯ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВред рдкрд╣рд▓рд╛ рд▓реЗрдЦ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдореБрдЦ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╣рдо рд╕реНрдЯреЙрдХрд╢рд╛рд░реНрдк рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд░реЛрдмреЛрдЯ рд▓рд┐рдЦрддреЗ рд╣реИрдВред рднрд╛рдЧ реи</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/iticapital/blog/433078/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><img src="https://habrastorage.org/webt/bv/ll/xa/bvllxaiaoeshjg0_71xwfocozqa.png"></a> <br><br>  рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрдЯреЙрдХрд╢рд░реНрдк</a> рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд░реЛрдмреЛрдЯ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд╣рд▓рд╛ рд▓реЗрдЦ</a> рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдореБрдЦреНрдп рддрддреНрд╡реЛрдВ рдХреЗ рдбреНрд░рд╛рдЗрдВрдЧ рд╕реЗ рдирд┐рдкрдЯрд╛ред  рдЪрдХреНрд░ рдХреА рдЕрдВрддрд┐рдо рд╕рд╛рдордЧреНрд░реА рдореЗрдВ, рд╣рдо рд╕реАрдзреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рд░рдгрдиреАрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗред <a name="habracut"></a><br><br><h2>  рдПрдХ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдкреИрдирд▓ рдмрдирд╛рдирд╛ </h2><br>  рдЯреВрд▓рдмрд╛рд░ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдирддрд╛ рд╕реЗ, рдПрдХ рд▓реЙрдЧ рдкреИрдирд▓ рдмрдирд╛рдПрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, XAML рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдФрд░ UserControl рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ PortfolioGridControl рдирд╛рдо рджреЗрдВред  рдЗрд╕рдореЗрдВ рдПрдХ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛрдЧреНрд░рд┐рдб рдПрд▓рд┐рдореЗрдВрдЯ рдЬреЛрдбрд╝реЗрдВред <br><br><pre><code class="cs hljs">&lt;UserControl x:Class=<span class="hljs-string"><span class="hljs-string">"ShellNew.XAML.PortfolioGridControl"</span></span> xmlns=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span> xmlns:x=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span> xmlns:mc=<span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span> xmlns:d=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span> xmlns:xaml=<span class="hljs-string"><span class="hljs-string">"http://schemas.stocksharp.com/xaml"</span></span> mc:Ignorable=<span class="hljs-string"><span class="hljs-string">"d"</span></span> d:DesignHeight=<span class="hljs-string"><span class="hljs-string">"450"</span></span> d:DesignWidth=<span class="hljs-string"><span class="hljs-string">"800"</span></span>&gt; &lt;xaml:PortfolioGrid x:Name=<span class="hljs-string"><span class="hljs-string">"PortfolioGrid"</span></span> /&gt; &lt;/UserControl&gt;</code> </pre> <br>  PortfolioGridControl рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ, рд╣рдореЗрдВ рдПрдХ рдирдП рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдФрд░ рдХрдиреЗрдХреНрдЯрд░ рдореЗрдВ рдПрдХ рдирдИ рд╕реНрдерд┐рддрд┐ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PortfolioGridControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); MainWindow.Instance.Connector.NewPortfolio += PortfolioGrid.Portfolios.Add; MainWindow.Instance.Connector.NewPosition += PortfolioGrid.Positions.Add; }</code> </pre> <br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдПрдХ рдирдпрд╛ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдмрдирд╛рддреЗ рд╕рдордп, рдпрд╣ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдкреИрдирд▓ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛, рдФрд░ рдЬрдм рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдкреИрдирд▓ рдореЗрдВ рдПрдХ рдирдпрд╛ рд╕реНрдерд╛рди рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛, рддреЛ рдЗрд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдореЗрдирд╡рд┐рдВрдбреЛ рдХреЗ рдордзреНрдп рднрд╛рдЧ рдореЗрдВ, рдирд┐рд░реНрдорд┐рдд рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛрдЧреНрд░рд┐рдбрдЧреНрд░реЛрдВрдЯреЛрд▓ рдкреИрдирд▓ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="cs hljs">&lt;dxlc:LayoutGroup HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> View=<span class="hljs-string"><span class="hljs-string">"Tabs"</span></span>&gt; &lt;!--  --&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Securities"</span></span>&gt; &lt;myxaml:SecurityGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"SecurityPanel"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Portfolios"</span></span>&gt; &lt;myxaml:PortfolioGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"PortfolioGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt;</code> </pre> <br>  рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/bz/vs/tl/bzvstlk5xgb54mycansuoqjozhu.png"><br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкреЛрд░реНрдЯрдлреЛрд▓рд┐рдпреЛ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреИрдм рд╣реИред <br><br><h2>  рдСрд░реНрдбрд░ рдХрд╛ рдкреИрдирд▓ рдмрдирд╛рдирд╛ </h2><br>  S # .API рдореЗрдВ рдСрд░реНрдбрд░ рдмрд╛рд░ рдореЗрдВ рдСрд░реНрдбрд░ рдкреНрд▓реЗрд╕ рдХрд░рдиреЗ, рдСрд░реНрдбрд░ рд╡рд╛рдкрд╕ рд▓реЗрдиреЗ рдФрд░ рдлрд┐рд░ рд╕реЗ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред  рдЯреВрд▓рдмрд╛рд░ рдХреЗ рд╕рд╛рде рд╕рд╛рдордВрдЬрд╕реНрдп рдХрд░рдХреЗ, рдПрдХ рдСрд░реНрдбрд░ рдкреИрдирд▓ рдмрдирд╛рдПрдВ, XAML рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдФрд░ UserControl рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ рдСрд░реНрдбрд░рдЧреНрд░рд┐рдбрдХрдВрдЯреНрд░реЛрд▓ рдирд╛рдо рджреЗрдВред  рдЗрд╕рдореЗрдВ рдСрд░реНрдбрд░рдЧреНрд░рд┐рдб рддрддреНрд╡ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="cs hljs">&lt;UserControl x:Class=<span class="hljs-string"><span class="hljs-string">"ShellNew.XAML.OrderGridControl"</span></span> xmlns=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span> xmlns:x=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span> xmlns:mc=<span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span> xmlns:d=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span> xmlns:xaml=<span class="hljs-string"><span class="hljs-string">"http://schemas.stocksharp.com/xaml"</span></span> mc:Ignorable=<span class="hljs-string"><span class="hljs-string">"d"</span></span> d:DesignHeight=<span class="hljs-string"><span class="hljs-string">"450"</span></span> d:DesignWidth=<span class="hljs-string"><span class="hljs-string">"800"</span></span>&gt; &lt;xaml:OrderGrid x:Name=<span class="hljs-string"><span class="hljs-string">"OrderGrid"</span></span> /&gt; &lt;/UserControl&gt;</code> </pre> <br>  рдСрд░реНрдбрд░рдЧреНрд░рд┐рдб рдореЗрдВ рдПрдХ рдСрд░реНрдбрд░рд░рд╛рдЗрдЬрд┐рд╕реНрдЯрд░рд┐рдВрдЧ рдкрдВрдЬреАрдХрд░рдг рдХрд╛рд░реНрдпрдХреНрд░рдо, рдСрд░реНрдбрд░рд░реЗрдЬрд┐рд╕реНрдЯрд░рд┐рд╕реНрдЯрд░ рд░реА-рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди рдЗрд╡реЗрдВрдЯ рдФрд░ рдСрд░реНрдбрд░рдХреИрдВрд╕рд▓рд┐рдВрдЧ рд░рджреНрдж рдХрд░рдиреЗ рдХреА рдШрдЯрдирд╛ рд╣реИред <br><br>  рдЖрдЗрдП рдЙрдирдХреЗ рд╣реИрдВрдбрд▓рд░ рдмрдирд╛рдПрдВ: <br><br><pre> <code class="cs hljs">&lt;UserControl x:Class=<span class="hljs-string"><span class="hljs-string">"ShellNew.XAML.OrderGridControl"</span></span> xmlns=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span> xmlns:x=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span> xmlns:mc=<span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span> xmlns:d=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span> xmlns:xaml=<span class="hljs-string"><span class="hljs-string">"http://schemas.stocksharp.com/xaml"</span></span> mc:Ignorable=<span class="hljs-string"><span class="hljs-string">"d"</span></span> d:DesignHeight=<span class="hljs-string"><span class="hljs-string">"450"</span></span> d:DesignWidth=<span class="hljs-string"><span class="hljs-string">"800"</span></span>&gt; &lt;xaml:OrderGrid x:Name=<span class="hljs-string"><span class="hljs-string">"OrderGrid"</span></span> OrderRegistering=<span class="hljs-string"><span class="hljs-string">"OrderGrid_OnOrderRegistering"</span></span> OrderReRegistering=<span class="hljs-string"><span class="hljs-string">"OrderGrid_OnOrderReRegistering"</span></span> OrderCanceling=<span class="hljs-string"><span class="hljs-string">"OrderGrid_OnOrderCanceling"</span></span> /&gt; &lt;/UserControl&gt;</code> </pre> <br>  рдЕрдиреБрд░реЛрдз рдкрдВрдЬреАрдХрд░рдг рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рд╣рдо рдПрдХ рдСрд░реНрдбрд░рд╡рд┐рдВрдбреЛ рд╡рд┐рдВрдбреЛ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЛ рдЗрдВрд╕реНрдЯреНрд░реВрдореЗрдВрдЯреНрд╕, рдкреЛрд░реНрдЯрдлрд╝реЛрд▓рд┐рдпреЛ рдФрд░ рдорд╛рд░реНрдХреЗрдЯ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╕реНрд░реЛрдд рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рд╕рдм рдХрдиреЗрдХреНрдЯрд░ рд╣реЛрдЧрд╛ред <br><br>  рддрдм рд╣рдо ShowModal рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдСрд░реНрдбрд░рд╡рд┐рдиреНрдбреЛ рдХрд╣рддреЗ рд╣реИрдВред  рдпрджрд┐ рдЗрд╕ рд╡рд┐рдВрдбреЛ рдореЗрдВ OK рдмрдЯрди рджрдмрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдХрдиреЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдо RegisterOrder рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрдВрдЬреАрдХрд░рдг рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrderGrid_OnOrderRegistering</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newOrder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderWindow { Title = <span class="hljs-string"><span class="hljs-string">"Order registering"</span></span>, Order = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Order(), SecurityProvider = MainWindow.Instance.Connector, MarketDataProvider = MainWindow.Instance.Connector, Portfolios = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PortfolioDataSource(MainWindow.Instance.Connector), }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newOrder.ShowModal(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) MainWindow.Instance.Connector.RegisterOrder(newOrder.Order); }</code> </pre> <br>  рдЗрд╡реЗрдВрдЯ рд░реА-рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рд╣рдо рд╕рдм рдХреБрдЫ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХрд░рддреЗ рд╣реИрдВред  рдХреЗрд╡рд▓ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдСрд░реНрдбрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдИрд╡реЗрдВрдЯ рдореЗрдВ рдЖрддрд╛ рд╣реИ - рдпрд╣ рдПрдХ рдСрд░реНрдбрд░ рд╣реИ рдЬрд┐рд╕реЗ рдлрд┐рд░ рд╕реЗ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, OrderWindow рдореЗрдВ, рд╣рдо <code>Order = order.ReRegisterClone(newVolume: order.Balance)</code> рдХреЛ рдСрд░реНрдбрд░рд╡рд┐рдВрдбреЛ рд╡рд┐рдВрдбреЛ рдХреЗ рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рднрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рддрдм рд╣рдо ShowModal рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдСрд░реНрдбрд░рд╡рд┐рдиреНрдбреЛ рдХрд╣рддреЗ рд╣реИрдВред  рдпрджрд┐ рдЗрд╕ рд╡рд┐рдВрдбреЛ рдореЗрдВ OK рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдо ReRegisterClone рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдиреЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рдХрд░реЗрдВрдЧреЗред  рд╣рдо рдЗрд╕реЗ рдкреБрд░рд╛рдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рд░рджреНрдж рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдирдпрд╛, рдЬрд┐рд╕реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrderGrid_OnOrderReRegistering</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Order order)</span></span></span><span class="hljs-function"> </span></span>{ var window = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderWindow { Title = <span class="hljs-string"><span class="hljs-string">"Order re-registering"</span></span>, SecurityProvider = MainWindow.Instance.Connector, MarketDataProvider = MainWindow.Instance.Connector, Portfolios = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PortfolioDataSource(MainWindow.Instance.Connector), Order = order.ReRegisterClone(newVolume: order.Balance) }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (window.ShowModal(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)) MainWindow.Instance.Connector.ReRegisterOrder(order, window.Order); }</code> </pre> <br>  рдЕрдиреБрд░реЛрдз рд░рджреНрдж рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рдХреЗрд╡рд▓ CancelOrder рдкрджреНрдзрддрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рдФрд░ рдЙрд╕ рдЖрджреЗрд╢ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВ, рдЬрд┐рд╕реЗ рд░рджреНрдж рдХрд░рдирд╛ рд╣реЛрдЧрд╛: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrderGrid_OnOrderCanceling</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Order order</span></span></span><span class="hljs-function">)</span></span> { MainWindow.Instance.Connector.CancelOrder(order); }</code> </pre> <br>  рдСрд░реНрдбрд░рдЧреНрд░рд┐рдб рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЖрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ рдирдП рдСрд░реНрдбрд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдФрд░ рдСрд░реНрдбрд░рдЧреНрд░реЗрдбрдХрдВрдЯреНрд░реЛрд▓ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ рдкрдВрдЬреАрдХрд░рдг рддреНрд░реБрдЯрд┐ рдШрдЯрдирд╛ рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрди рдШрдЯрдирд╛рдУрдВ рдХреЛ рдСрд░реНрдбрд░рдЧреНрд░рд┐рдб рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░реЗрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrderGridControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); MainWindow.Instance.Connector.NewOrder += OrderGrid.Orders.Add; MainWindow.Instance.Connector.OrderRegisterFailed += OrderGrid.AddRegistrationFail; }</code> </pre> <br>  рдореЗрдирд╡рд┐рдВрдбреЛ рдХреЗ рдордзреНрдп рднрд╛рдЧ рдореЗрдВ, рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдСрд░реНрдбрд░рдЧреНрд░рд┐рдбрдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="cs hljs">&lt;dxlc:LayoutGroup HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> View=<span class="hljs-string"><span class="hljs-string">"Tabs"</span></span>&gt; &lt;!--  --&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Securities"</span></span>&gt; &lt;myxaml:SecurityGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"SecurityPanel"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Portfolios"</span></span>&gt; &lt;myxaml:PortfolioGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"PortfolioGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Orders"</span></span>&gt; &lt;myxaml:OrderGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"OrderGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt;</code> </pre> <br>  рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/hp/hu/m7/hphum7vg9x0p-ym0vwdg5_bhdv4.png"><br><br><h2>  рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рд▓реЗрди-рджреЗрди рдкреИрдирд▓ рдмрдирд╛рдирд╛ </h2><br>  рдЯреВрд▓рдмрд╛рд░ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдирддрд╛ рдХрд░рдХреЗ, рд╣рдорд╛рд░реЗ рд╕реНрд╡рдпрдВ рдХреЗ рд▓реЗрдирджреЗрди рдХрд╛ рдПрдХ рдкреИрдирд▓ рдмрдирд╛рдПрдВред  XAML рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рдПрдХ рдФрд░ UserControl рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ MyTradeGridControl рдирд╛рдо рджреЗрдВред  рдЗрд╕рдореЗрдВ MyTradeGrid рддрддреНрд╡ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="cs hljs">&lt;UserControl x:Class=<span class="hljs-string"><span class="hljs-string">"ShellNew.XAML.MyTradeGridControl"</span></span> xmlns=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span> xmlns:x=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span> xmlns:mc=<span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span> xmlns:d=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span> xmlns:xaml=<span class="hljs-string"><span class="hljs-string">"http://schemas.stocksharp.com/xaml"</span></span> mc:Ignorable=<span class="hljs-string"><span class="hljs-string">"d"</span></span> d:DesignHeight=<span class="hljs-string"><span class="hljs-string">"450"</span></span> d:DesignWidth=<span class="hljs-string"><span class="hljs-string">"800"</span></span>&gt; &lt;xaml:MyTradeGrid x:Name=<span class="hljs-string"><span class="hljs-string">"MyTradeGrid"</span></span> /&gt; &lt;/UserControl&gt;</code> </pre> <br>  MyTradeGridControl рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ, рд╣рдореЗрдВ рдПрдХ рдирдП рд╕реНрд╡рдпрдВ рдХреЗ рд▓реЗрдирджреЗрди рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдиреЗ рдФрд░ рдЗрд╕реЗ MyTradeGrid рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyTradeGridControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); MainWindow.Instance.Connector.NewMyTrade += MyTradeGrid.Trades.Add; }</code> </pre> <br>  рдореЗрдирд╡рд┐рдВрдбреЛ рдХреЗ рдордзреНрдп рднрд╛рдЧ рдореЗрдВ, рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдСрд░реНрдбрд░рдЧреНрд░рд┐рдбрдХрдВрдЯреНрд░реЛрд▓ рдкреИрдирд▓ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="css hljs">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">HorizontalAlignment</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">Stretch</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">View</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">Tabs</span></span>"&gt; &lt;!<span class="hljs-selector-tag"><span class="hljs-selector-tag">--</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">--</span></span>&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Header</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">Securities</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">myxaml</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:SecurityGridControl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">x</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Name</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">SecurityPanel</span></span>" /&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span>&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Header</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">Portfolios</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">myxaml</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:PortfolioGridControl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">x</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Name</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">PortfolioGridControl</span></span>" /&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span>&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Header</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">Orders</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">myxaml</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:OrderGridControl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">x</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Name</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">OrderGridControl</span></span>" /&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span>&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Header</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">MyTrades</span></span>"&gt; &lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">myxaml</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:MyTradeGridControl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">x</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:Name</span></span>="<span class="hljs-selector-tag"><span class="hljs-selector-tag">MyTradeGridControl</span></span>" /&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span>&gt; &lt;/<span class="hljs-selector-tag"><span class="hljs-selector-tag">dxlc</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:LayoutGroup</span></span>&gt;</code> </pre> <br>  рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/-4/dr/x1/-4drx1smuyevvg-e5esktgw4ey4.png"><br><br><h2>  рдПрдХ рд░рдгрдиреАрддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдкреИрдирд▓ рдмрдирд╛рдирд╛ </h2><br>  рд╣рдо рд╕рднреА рдкрд┐рдЫрд▓реЗ рдкреИрдирд▓реЛрдВ рдХреА рддрд░рд╣ рд╣реА рдПрдХ рд░рдгрдиреАрддрд┐ рдкреИрдирд▓ рдмрдирд╛рдПрдВрдЧреЗред  XAML рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рдПрдХ рдФрд░ UserControl рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ StrategyControl рдирд╛рдо рджреЗрдВред  LayoutControl рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рд╕реНрдХреНрд░реАрди рдХреЛ рджреЛ рднрд╛рдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдмрд╛рдИрдВ рдУрд░ рдПрдХ рдХреИрдВрдбрд▓рд╕реНрдЯрд┐рдХ рдЪрд╛рд░реНрдЯ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреИрдм рд╣реЛрдЧрд╛ рдФрд░ рд░рдгрдиреАрддрд┐ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреИрдм рд╣реЛрдЧрд╛: <br><br><pre> <code class="cs hljs">&lt;dxlc:LayoutGroup Orientation=<span class="hljs-string"><span class="hljs-string">"Vertical"</span></span>&gt; &lt;dxlc:LayoutGroup View=<span class="hljs-string"><span class="hljs-string">"Tabs"</span></span> Name=<span class="hljs-string"><span class="hljs-string">"StatistisAndChartLayoutGroup"</span></span>&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Chart"</span></span>&gt; &lt;xaml:Chart x:Name=<span class="hljs-string"><span class="hljs-string">"Chart"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Statistic"</span></span>&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> dxlc:LayoutControl.AllowHorizontalSizing=<span class="hljs-string"><span class="hljs-string">"True"</span></span> &gt; &lt;xaml:StatisticParameterGrid x:Name=<span class="hljs-string"><span class="hljs-string">"StatisticParameterGrid"</span></span> MaxHeight=<span class="hljs-string"><span class="hljs-string">"2000"</span></span>/&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> &gt; &lt;xaml:EquityCurveChart x:Name=<span class="hljs-string"><span class="hljs-string">"EquityCurveChart"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt;</code> </pre> <br>  рдпрд╣рд╛рдБ, StatisticParameterGrid рдХрд╛ рдЙрдкрдпреЛрдЧ рд░рдгрдиреАрддрд┐ рдЖрдБрдХрдбрд╝реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ EquityCurveChart рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓рд╛рдн рдФрд░ рд╣рд╛рдирд┐ рдЪрд╛рд░реНрдЯ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  StatisticParameterGrid рдХреЛ рдХреБрдЫ MaxHeight рдорд╛рди рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЕрдиреНрдпрдерд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br><br>  рд░рд╛рдЗрдЯ-рд╣реИрдВрдб рд╕рд╛рдЗрдб рдкреНрд░реЙрдкрд░реНрдЯреАрдЧреНрд░реЗрдбреЗрдХреНрд╕ рдореЗрдВ рд░рдгрдиреАрддрд┐ рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред  рд░рдгрдиреАрддрд┐ рд╢реБрд░реВ рдХрд░рдиреЗ рдФрд░ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдЯрди рднреА рд╕реНрдерд┐рдд рд╣реЛрдВрдЧреЗ: <br><br><pre> <code class="cs hljs">&lt;dxlc:LayoutGroup View=<span class="hljs-string"><span class="hljs-string">"Group"</span></span> dxlc:LayoutControl.AllowHorizontalSizing=<span class="hljs-string"><span class="hljs-string">"True"</span></span> dxlc:DockLayoutControl.Dock=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Orientation=<span class="hljs-string"><span class="hljs-string">"Vertical"</span></span>&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span>&gt; &lt;xaml:PropertyGridEx x:Name=<span class="hljs-string"><span class="hljs-string">"PropertyGridEx"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Height=<span class="hljs-string"><span class="hljs-string">"20"</span></span>&gt; &lt;dx:SimpleButton x:Name=<span class="hljs-string"><span class="hljs-string">"StartStrategyButton"</span></span> Content=<span class="hljs-string"><span class="hljs-string">"Start strategy"</span></span> ToolTip=<span class="hljs-string"><span class="hljs-string">"Start strategy"</span></span> Click=<span class="hljs-string"><span class="hljs-string">"StartStrategyButton_Click"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Height=<span class="hljs-string"><span class="hljs-string">"20"</span></span>&gt; &lt;dx:SimpleButton x:Name=<span class="hljs-string"><span class="hljs-string">"StopStrategyButton"</span></span> Content=<span class="hljs-string"><span class="hljs-string">"Stop strategy"</span></span> ToolTip=<span class="hljs-string"><span class="hljs-string">"Stop strategy"</span></span> Click=<span class="hljs-string"><span class="hljs-string">"StopStrategyButton_Click"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;/dxlc:LayoutGroup&gt;</code> </pre> <br>  рдкреВрд░реНрдг рдХреЛрдб: <br><br><pre> <code class="cs hljs">&lt;UserControl x:Class=<span class="hljs-string"><span class="hljs-string">"ShellNew.XAML.StrategyControl"</span></span> xmlns=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span></span> xmlns:x=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span> xmlns:mc=<span class="hljs-string"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span> xmlns:d=<span class="hljs-string"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span> xmlns:dxlc=<span class="hljs-string"><span class="hljs-string">"http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"</span></span> xmlns:xaml=<span class="hljs-string"><span class="hljs-string">"http://schemas.stocksharp.com/xaml"</span></span> xmlns:dx=<span class="hljs-string"><span class="hljs-string">"http://schemas.devexpress.com/winfx/2008/xaml/core"</span></span> mc:Ignorable=<span class="hljs-string"><span class="hljs-string">"d"</span></span>&gt; &lt;dxlc:LayoutControl&gt; &lt;dxlc:LayoutGroup Orientation=<span class="hljs-string"><span class="hljs-string">"Vertical"</span></span>&gt; &lt;dxlc:LayoutGroup View=<span class="hljs-string"><span class="hljs-string">"Tabs"</span></span> Name=<span class="hljs-string"><span class="hljs-string">"StatistisAndChartLayoutGroup"</span></span>&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Chart"</span></span>&gt; &lt;xaml:Chart x:Name=<span class="hljs-string"><span class="hljs-string">"Chart"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Statistic"</span></span>&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> dxlc:LayoutControl.AllowHorizontalSizing=<span class="hljs-string"><span class="hljs-string">"True"</span></span> &gt; &lt;xaml:StatisticParameterGrid x:Name=<span class="hljs-string"><span class="hljs-string">"StatisticParameterGrid"</span></span> MaxHeight=<span class="hljs-string"><span class="hljs-string">"2000"</span></span>/&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> &gt; &lt;xaml:EquityCurveChart x:Name=<span class="hljs-string"><span class="hljs-string">"EquityCurveChart"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup View=<span class="hljs-string"><span class="hljs-string">"Group"</span></span> dxlc:LayoutControl.AllowHorizontalSizing=<span class="hljs-string"><span class="hljs-string">"True"</span></span> dxlc:DockLayoutControl.Dock=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Orientation=<span class="hljs-string"><span class="hljs-string">"Vertical"</span></span>&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span>&gt; &lt;xaml:PropertyGridEx x:Name=<span class="hljs-string"><span class="hljs-string">"PropertyGridEx"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Height=<span class="hljs-string"><span class="hljs-string">"20"</span></span>&gt; &lt;dx:SimpleButton x:Name=<span class="hljs-string"><span class="hljs-string">"StartStrategyButton"</span></span> Content=<span class="hljs-string"><span class="hljs-string">"Start strategy"</span></span> ToolTip=<span class="hljs-string"><span class="hljs-string">"Start strategy"</span></span> Click=<span class="hljs-string"><span class="hljs-string">"StartStrategyButton_Click"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;dxlc:LayoutItem VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Height=<span class="hljs-string"><span class="hljs-string">"20"</span></span>&gt; &lt;dx:SimpleButton x:Name=<span class="hljs-string"><span class="hljs-string">"StopStrategyButton"</span></span> Content=<span class="hljs-string"><span class="hljs-string">"Stop strategy"</span></span> ToolTip=<span class="hljs-string"><span class="hljs-string">"Stop strategy"</span></span> Click=<span class="hljs-string"><span class="hljs-string">"StopStrategyButton_Click"</span></span> /&gt; &lt;/dxlc:LayoutItem&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutControl&gt; &lt;/UserControl&gt;</code> </pre> <br>  StrategyControl рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ, рдХрдиреЗрдХреНрдЯрд░ рдХреЛ PropertyGridEx рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ, рд▓рдЧрднрдЧ рд╣рд░ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд╣рдо рд╕рдорд╛рди рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StrategyControl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { InitializeComponent(); PropertyGridEx.SecurityProvider = MainWindow.Instance.Connector; PropertyGridEx.Portfolios = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PortfolioDataSource(MainWindow.Instance.Connector); }</code> </pre> <br>  рд╣рдореЗрдВ рдХрд┐рд╕реА рддрд░рд╣ рд░рдгрдиреАрддрд┐ рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, StrategyControl рдореЗрдВ рдПрдХ BindStraregy рд╡рд┐рдзрд┐ рдмрдирд╛рдПрдВ, рдЬреЛ рд░рдгрдиреАрддрд┐ рд▓реЗрдЧрд╛, рд▓рд┐рдВрдХ рдХреЛ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдореЗрдВ рд╕рд╣реЗрдЬреЗрдВ, рдФрд░ рд╕рд╛рде рд╣реА PropertyGridEx рдФрд░ StatisticParameterGrid рдореЗрдВ рд░рдгрдиреАрддрд┐ рд╕реЗрдЯ рдХрд░реЗрдВред <br><br>  SetChart рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдЪрд╛рд░реНрдЯ рдореЛрдордмрддреНрддрд┐рдпреЛрдВ рдХреЗ рдЪрд╛рд░реНрдЯ рдХреЛ рд░рдгрдиреАрддрд┐ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ; рдЙрд╕рдХреЗ рдмрд╛рдж, рдЖрдк GetChart рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪрд╛рд░реНрдЯ рд░рдгрдиреАрддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рд░рдгрдиреАрддрд┐ рдХреЗ рд▓рд┐рдП рдХрдиреЗрдХреНрдЯрд░ рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Strategy _strategy; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BindStraregy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Strategy strategy</span></span></span><span class="hljs-function">)</span></span> { _strategy = strategy; PropertyGridEx.SelectedObject = strategy; StatisticParameterGrid.Parameters. AddRange(_strategy.StatisticManager.Parameters); _strategy.SetChart(Chart); _strategy.Connector = MainWindow.Instance.Connector; }</code> </pre> <br>  рд▓рд╛рдн рдФрд░ рд╣рд╛рдирд┐ рдЕрдиреБрд╕реВрдЪреА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп, рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рд░рдгрдиреАрддрд┐ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рдПрдЧреА рдФрд░ рдмрдВрдж рд╣реЛ рдЬрд╛рдПрдЧреА, рд╢рд╛рдпрдж рдХрдИ рдмрд╛рд░, рд░рдгрдиреАрддрд┐ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд▓реЙрдиреНрдЪ рдХреЗ рд╕рд╛рде рдХрд╡рд┐рддрд╛ рдХреЛ рд╕рд╛рдл рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо ResetEquityCurveChart рдореЗрдердб рдмрдирд╛рдПрдВрдЧреЗ, рдЬрд┐рд╕рдореЗрдВ рд╣рдо рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ EquityCurveChart рдХреЛ рдХреНрд▓рд┐рдпрд░ рдХрд░реЗрдВрдЧреЗред  рдЙрд╕рдХреЗ рдмрд╛рдж рд╣рдореЗрдВ EquityCurveChart рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рдлрд┐рдХ рддрддреНрд╡реЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╡реЗ рдирд╛рдо, рд░рдВрдЧ рдФрд░ рд░реЗрдЦрд╛ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рд░рдгрдиреАрддрд┐ рдХреЗ PnL рдкрд░рд┐рд╡рд░реНрддрди рдШрдЯрдирд╛ рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рдШрдЯрдирд╛ рдХреЗ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ EquityCurveChart рд▓рд╛рдн / рд╣рд╛рдирд┐ рдЪрд╛рд░реНрдЯ рдкрд░ рдПрдХ рдирдпрд╛ рдореВрд▓реНрдп рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResetEquityCurveChart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { EquityCurveChart.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pnl = EquityCurveChart. CreateCurve(<span class="hljs-string"><span class="hljs-string">"PNL"</span></span>, Colors.Green, ChartIndicatorDrawStyles.Area); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> unrealizedPnL = EquityCurveChart. CreateCurve(<span class="hljs-string"><span class="hljs-string">"unrealizedPnL"</span></span>, Colors.Black, ChartIndicatorDrawStyles.Line); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> commissionCurve = EquityCurveChart .CreateCurve(<span class="hljs-string"><span class="hljs-string">"commissionCurve"</span></span>, Colors.Red, ChartIndicatorDrawStyles.Line); _strategy.PnLChanged += () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartDrawData(); data.Group(_strategy.CurrentTime) .Add(pnl, _strategy.PnL) .Add(unrealizedPnL, _strategy.PnLManager.UnrealizedPnL ?? <span class="hljs-number"><span class="hljs-number">0</span></span>) .Add(commissionCurve, _strategy.Commission ?? <span class="hljs-number"><span class="hljs-number">0</span></span>); EquityCurveChart.Draw(data); }; }</code> </pre> <br>  рд╕реНрдЯрд╛рд░реНрдЯ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗред  рдФрд░ рд╣рдо рд░рдгрдиреАрддрд┐ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рднреА рд░реАрд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕реЗ рдЪрд▓рд╛рдПрдВрдЧреЗ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StartStrategyButton_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { ResetEquityCurveChart(); _strategy.Reset(); _strategy.Start(); }</code> </pre> <br>  рд╕реНрдЯреЙрдк рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдИрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ, рд╣рдо рд░рдгрдиреАрддрд┐ рдХреЛ рд░реЛрдХ рджреЗрдВрдЧреЗред <br>  рдирд┐рдЬреА рд╢реВрдиреНрдп StopStrategyButton_Click (рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░реЗрд╖рдХ, RoutedEventArgs e) <br><br><pre> <code class="cs hljs">{ _strategy.Stop(); }</code> </pre> <br>  рдореЗрдирд╡рд┐рдВрдбреЛ рдХреЗ рдордзреНрдп рднрд╛рдЧ рдореЗрдВ, рдмрдирд╛рдпрд╛ рдЧрдпрд╛ StrategyControl рдкреИрдирд▓ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="cs hljs">&lt;dxlc:LayoutGroup HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> View=<span class="hljs-string"><span class="hljs-string">"Tabs"</span></span>&gt; &lt;!--  --&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Securities"</span></span>&gt; &lt;myxaml:SecurityGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"SecurityPanel"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Portfolios"</span></span>&gt; &lt;myxaml:PortfolioGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"PortfolioGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"Orders"</span></span>&gt; &lt;myxaml:OrderGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"OrderGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"MyTrades"</span></span>&gt; &lt;myxaml:MyTradeGridControl x:Name=<span class="hljs-string"><span class="hljs-string">"MyTradeGridControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"MarketDepth"</span></span>&gt; &lt;myxaml:MarketDepthControl x:Name=<span class="hljs-string"><span class="hljs-string">"MarketDepthControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;dxlc:LayoutGroup Header=<span class="hljs-string"><span class="hljs-string">"SimpleStrategyControl"</span></span>&gt; &lt;myxaml:StrategyControl x:Name=<span class="hljs-string"><span class="hljs-string">"SimpleStrategyControl"</span></span> /&gt; &lt;/dxlc:LayoutGroup&gt; &lt;/dxlc:LayoutGroup&gt;</code> </pre> <br><h2>  рд░рдгрдиреАрддрд┐ рдирд┐рд░реНрдорд╛рдг </h2><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рд░рд▓ рдХреИрдВрдбрд▓рд╕реНрдЯрд┐рдХ рд░рдгрдиреАрддрд┐ рдмрдирд╛рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  рд╡рд╣ рдЦрд░реАрджреЗрдЧреА рдЕрдЧрд░ рдореЛрдордмрддреНрддреА рдмрдврд╝ рд░рд╣реА рд╣реИ (рд╣рд░рд╛) рдФрд░ рдЕрдЧрд░ рдореЛрдордмрддреНрддреА рдХрдо рд╣реЛ рд░рд╣реА рд╣реИ (рд▓рд╛рд▓)ред <br><br>  рдЖрдЗрдП рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдПрдХ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдПрдВ - рд╣рдо рдЕрдкрдиреА рд╕рднреА рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЗрд╕рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВрдЧреЗред  рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ, рдПрдХ рдирдпрд╛ рд╡рд░реНрдЧ рдмрдирд╛рдПрдВ, рдЗрд╕реЗ SimpleStrategy рдХрд╣реЗрдВред  рд╕рднреА рдПрд╕ # рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреЛ рд░рдгрдиреАрддрд┐ рд░рдгрдиреАрддрд┐ рдХреЗ рдЖрдзрд╛рд░ рд╡рд░реНрдЧ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SimpleStrategy</span></span> : <span class="hljs-title"><span class="hljs-title">Strategy</span></span> {}</code> </pre> <br>  рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реА рд░рдгрдиреАрддрд┐ рдореЛрдордмрддреНрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рд╣рдо рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕рдВрдкрддреНрддрд┐ рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдмрдирд╛рдПрдВрдЧреЗ рдФрд░ рдЕрдкрдиреА рд░рдгрдиреАрддрд┐ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдореЗрдВ рд╣рдо рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореВрд▓реНрдп рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SimpleStrategy</span></span> : <span class="hljs-title"><span class="hljs-title">Strategy</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> CandleSeries Series { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SimpleStrategy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Series = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CandleSeries(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TimeFrameCandle), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Security(), TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">15</span></span>)) { BuildCandlesMode = MarketDataBuildModes.Build }; } }</code> </pre> <br>  рдпрд╣рд╛рдБ рд╣рдордиреЗ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдХрд┐ рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдореЗрдВ рдореЛрдордмрддреНрддрд┐рдпрд╛рдБ TimeFrameCandle рд╣реЛрдВрдЧреА, 15 рд╕реЗрдХрдВрдб (TimeSpan.FromSeconds (15)) рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдХреЗ рд╕рд╛рдеред  CandleSeries рдХреЗ рд▓рд┐рдП, рдЖрдк BuildCandlesMode рдореЛрдордмрддреНрддреА рдирд┐рд░реНрдорд╛рдг рдореЛрдб рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдХрд┐ рдореЛрдордмрддреНрддрд┐рдпрд╛рдБ рдмрдирд╛рдИ рдЬрд╛рдПрдВрдЧреА (MarketDataBuildModes.Build)ред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЙрдиреНрд╣реЗрдВ рдЯрд┐рдХреНрд╕ рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдЖрдк рдЕрдиреНрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЪреВрдВрдХрд┐ рд╣рдордиреЗ рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдХреЛ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕рдВрдкрддреНрддрд┐ рдмрдирд╛ рджрд┐рдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдХреЛ рдкрд┐рдЫрд▓реЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдкреНрд░реЙрдкрд░реНрдЯреАрдЧреНрд░реЗрдбреЗрдХреНрд╕ рд╕реЗ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╕рднреА рд░рдгрдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рдРрд╕реА рд╡рд┐рдзрд┐рдпрд╛рдВ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рдореЗрдВ рдСрдирд╕реНрдЯрд╛рд░реНрдЯ рдХреА рдЧрдИ рд╡рд┐рдзрд┐ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдпрд╣ рд░рдгрдиреАрддрд┐ рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдерд┐рддрд┐ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStarted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _connector = (Connector)Connector; Series.Security = Security; _connector .WhenCandlesFinished(Series) .Do(ProcessCandle) .Apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); _connector.SubscribeCandles(Series); <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnStarted(); }</code> </pre> <br>  рдпрд╣рд╛рдВ, рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЙрд╕ рдЯреВрд▓ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдкреНрд░реЙрдкрд░реНрдЯреАрдЧреНрд░рд┐рдбреЗрдХреНрд╕ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИред  рдлрд┐рд░ рддреИрдпрд╛рд░ рдореЛрдордмрддреНрддреА рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рдпрдо рдмрдирд╛рдПрдВред  рдирд┐рдпрдо рдореЗрдВ, рдЙрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдорд╛рдкреНрдд рдореЛрдордмрддреНрддреА рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░реЗрдЧреА - рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╡рд┐рдзрд┐ рд╣реИред  рдЗрд╕рдХрд╛ рд╡рд░реНрдгрди рдмрд╛рдж рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╕рдм рдХреБрдЫ рд╕реЗрдЯ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо SubscribeCandles рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдиреЗрдХреНрдЯрд░ рдореЗрдВ рдХреИрдВрдбрд▓рд╕рд░реАрдЬ рдкрд░ рдореЛрдордмрддреНрддрд┐рдпреЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, ProcessCandle рдкрджреНрдзрддрд┐ рдореЗрдВ рд░рдгрдиреАрддрд┐ рдХрд╛ рдореБрдЦреНрдп рддрд░реНрдХ рд╣реИ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ProcessCandle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Candle candle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!IsRealTime(candle)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candle.OpenPrice &lt; candle.ClosePrice &amp;&amp; Position &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { RegisterOrder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.BuyAtMarket(Volume + Math.Abs(Position))); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candle.OpenPrice &gt; candle.ClosePrice &amp;&amp; Position &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { RegisterOrder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SellAtMarket(Volume + Math.Abs(Position))); } }</code> </pre> <br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдореЛрдордмрддреНрддреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдмрдирд╛рдИ рдЬрд╛ рд░рд╣реА рд╣реИ рдпрд╛ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╣реИред  рдпрджрд┐ рдореЛрдордмрддреНрддреА рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╣реИ, рддреЛ рд╣рдо рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░рддреЗ рд╣реИрдВред  рд╕рднреА рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЪрд╢реНрдореЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЪрд╢реНрдорд╛ рд╣рдореЗрд╢рд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВред  рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдПрдХ рдореЛрдордмрддреНрддреА "рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп" рд╣реИ рдпрд╛ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд░рдгрдиреАрддрд┐ рдореЗрдВ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рд╣рд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдмрд╕ рдХрдиреЗрдХреНрдЯрд░ рдореЗрдВ рд╕рдордп рдХреЗ рд╕рд╛рде рдореЛрдордмрддреНрддреА рдмрдВрдж рд╣реЛрдиреЗ рдХреЗ рд╕рдордп рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдпрджрд┐ рдпрд╣ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЕрдВрддрд░рд╛рд▓ рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдореЛрдордмрддреНрддреА рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рд╕реНрдерд┐рддрд┐ рд╣реЛрдЧреАред <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsRealTime</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Candle candle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (Connector.CurrentTime - candle.CloseTime).TotalSeconds &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; }</code> </pre> <br>  рдЕрдЧрд▓рд╛, рд╣рдо рдпрд╣ рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдореЛрдордмрддреНрддреА рд╣реИ, рдФрд░ рд░рдгрдиреАрддрд┐ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреНрдпрд╛ рд╣реИред  рдпрджрд┐ рдореЛрдордмрддреНрддреА рдмрдврд╝ рд░рд╣реА рд╣реИ, рддреЛ 0 рдХреЗ рдмрд░рд╛рдмрд░ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде, рд╣рдо рдкреНрд░реЙрдкрд░реНрдЯреАрдЧреНрд░рд┐рдбреЗрдХреНрд╕ рдореЗрдВ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдорд╛рддреНрд░рд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╛рдЬрд╛рд░ рдЖрджреЗрд╢ рдХреЗ рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдЦреЛрд▓реЗрдВрдЧреЗред  рдпрджрд┐ рдореЛрдордмрддреНрддреА рдмрдврд╝ рд░рд╣реА рд╣реИ рдФрд░ рд╕реНрдерд┐рддрд┐ 0 рд╕реЗ рдХрдо рд╣реИ, рддреЛ рд╣рдо рд╕реНрдерд┐рддрд┐ рдХреЛ "рдЙрд▓реНрдЯрд╛" рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candle.OpenPrice &lt; candle.ClosePrice &amp;&amp; Position &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { RegisterOrder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.BuyAtMarket(Volume + Math.Abs(Position))); }</code> </pre> <br><br>  рд╣рдо рдПрдХ waning рдореЛрдордмрддреНрддреА рдХреЗ рд▓рд┐рдП рд╡рд┐рдкрд░реАрдд рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (candle.OpenPrice &gt; candle.ClosePrice &amp;&amp; Position &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { RegisterOrder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SellAtMarket(Volume + Math.Abs(Position))); }</code> </pre> <br>  рдлрд┐рд▓рд╣рд╛рд▓, рд╣рдорд╛рд░реА рд░рдгрдиреАрддрд┐ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИред  рдЗрд╕реЗ SimpleStrategyControl рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд┐рдЫрд▓реЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ BindStraregy рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рдерд╛ред  рд╣рдо рдореЗрдирд╡рд┐рдВрдбреЛ рдШрдЯрдХреЛрдВ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдореЗрдирд╡рд┐рдВрдбреЛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдореЗрдВ рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs">SimpleStrategyControl.BindStraregy(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleStrategy());</code> </pre> <br><br>  рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/b1/-p/t6/b1-pt6ohswyhv5ylanblhvjhsf4.png"><br><br><img src="https://habrastorage.org/webt/ig/qx/kd/igqxkdcsehmsbeeayj-wnhgmhuk.png"><br><br>  рд░рдгрдиреАрддрд┐ рдХрд╛рдо рдХрд░рддреА рд╣реИ, рд╕реМрджреЗ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рдЪрд╛рд░реНрдЯ рдореЗрдВ рдореЛрдордмрддреНрддрд┐рдпрд╛рдБ рдФрд░ рд╕реМрджреЗ рдирд╣реАрдВ рд╣реИрдВред <br><br><h2>  рд░рдгрдиреАрддрд┐ рд╕реЗ рдЪрд╛рд░реНрдЯ рдореЗрдВ рдореЛрдордмрддреНрддрд┐рдпрд╛рдБ рдФрд░ рд╕реМрджреЗ рдЬреЛрдбрд╝рдирд╛ </h2><br>  SetChart рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рд░рдгрдиреАрддрд┐ рдкреИрдирд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рд╣рдордиреЗ рдЪрд╛рд░реНрдЯ рдореЛрдордмрддреНрддрд┐рдпреЛрдВ рдХреЗ рдЪрд╛рд░реНрдЯ рдХреЛ рд░рдгрдиреАрддрд┐ рдореЗрдВ рдзреЛрдЦрд╛ рджрд┐рдпрд╛ред  рд░рдгрдиреАрддрд┐ рдХреА OnStarted рд╡рд┐рдзрд┐ рдореЗрдВ, рд╣рдо рдпрд╣ рдЬрд╛рдВрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЪрд╛рд░реНрдЯ рд░рдгрдиреАрддрд┐ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реИ рдФрд░ рдпрджрд┐ рдпрд╣ рд╕реЗрдЯ рд╣реИ, рддреЛ рд╣рдо рдЪрд╛рд░реНрдЯ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдПрдХ рдирдП рд╕реНрд╡рдпрдВ рдХреЗ рд▓реЗрди-рджреЗрди рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдФрд░ рдПрдХ рдореЛрдордмрддреНрддреА рдкрд░рд┐рд╡рд░реНрддрди рдХреА рдШрдЯрдирд╛рдУрдВ рдХреА рднреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnStarted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _connector = (Connector)Connector; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetChart() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Chart chart) { InitChart(chart); NewMyTrade += DrawMyTrade; _connector.CandleSeriesProcessing += CandleSeriesProcessing; } Series.Security = Security; _connector .WhenCandlesFinished(Series) .Do(ProcessCandle) .Apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); _connector.SubscribeCandles(Series); <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnStarted(); }</code> </pre> <br>  InitChart рдЪрд╛рд░реНрдЯ рдЖрд░рдВрднреАрдХрд░рдг рд╡рд┐рдзрд┐: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ChartCandleElement _chartCandleElement; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ChartTradeElement _tradesElem; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Chart _chart; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitChart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Chart chart</span></span></span><span class="hljs-function">)</span></span> { _chart = chart; _chart.GuiSync(() =&gt; { _chart.ClearAreas(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> candlesArea = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartArea(); _chart.AddArea(candlesArea); _chartCandleElement = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartCandleElement(); _chart.AddElement(candlesArea, _chartCandleElement); _tradesElem = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartTradeElement { FullTitle = <span class="hljs-string"><span class="hljs-string">"Trade"</span></span> }; _chart.AddElement(candlesArea, _tradesElem); }); }</code> </pre> <br>  рдпрд╣рд╛рдВ рд╣рдо рдЪрд╛рд░реНрдЯ рдХреЛ рд▓рд┐рдВрдХ рдХреЛ рдПрдХ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдореЗрдВ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рд╢реЗрдбреНрдпреВрд▓ рдХреНрд▓рд┐рдпрд░ рдХрд┐рдпрд╛ред  рд╣рдо рдореЛрдордмрддреНрддрд┐рдпреЛрдВ рдФрд░ рд╕реМрджреЛрдВ рдХреЗ рд▓рд┐рдП рдЪрд╛рд░реНрдЯ рдЪрд╛рд░реНрдЯ рддрддреНрд╡реЛрдВ рдХреЛ рднреА рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдирд┐рд░реНрдорд╛рдг _chart.GuiSync (() =&gt; {...});  рдореБрдЦреНрдп рд╕реВрддреНрд░ рдореЗрдВ рдЕрдиреБрд╕реВрдЪреА рдХреЛ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br><br>  рдПрдХ рдЪрд╛рд░реНрдЯ рдкрд░ рдореЛрдордмрддреНрддрд┐рдпрд╛рдБ рдЦреАрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП CandleSeriesProcessing рдЪрд╛рд░реНрдЯ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CandleSeriesProcessing</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CandleSeries candleSeries, Candle candle</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartDrawData(); data.Group(candle.OpenTime) .Add(_chartCandleElement, candle); _chart.Draw(data); }</code> </pre> <br>  рдпрд╣рд╛рдВ рд╣рдореЗрдВ рдХрдиреЗрдХреНрдЯрд░ рдХреЗ рдХреИрдВрдбрд▓рд╕рд░реАрдЬрдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдЗрд╡реЗрдВрдЯ рд╕реЗ рдПрдХ рдореЛрдордмрддреНрддреА рдорд┐рд▓рддреА рд╣реИ, рдЗрд╕реЗ рдЪрд╛рд░реНрдЯ рдкрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЪрд╛рд░реНрдЯрдбреНрд░рд╛рд╡рдбрд╛рдЯ рдмрдирд╛рдПрдВред  рд╣рдо рд╕рдордп рдбреЗрдЯрд╛ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд╕рдореВрд╣ (рдореЛрдордмрддреНрддреАред рдкреАрдбреАрдПрдл рдЯрд╛рдЗрдо), рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдореЛрдордмрддреНрддреА рдХреЛ рдЪрд╛рд░реНрдЯ рдХреЗ рдореЛрдордмрддреНрддреА рддрддреНрд╡ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЬреЛрдбрд╝реЗрдВ (_chartCandleElement, рдореЛрдордмрддреНрддреА);  рдФрд░ рд╣рдо рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдХреЛ рдирдпрд╛ рдбреЗрдЯрд╛ рдЦреАрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рд╣рдо рд▓реЗрдирджреЗрди рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DrawMyTrade</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MyTrade myTrade</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ChartDrawData(); data.Group(myTrade.Trade.Time) .Add(_tradesElem, myTrade); _chart.Draw(data); }</code> </pre> <br>  рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><img src="https://habrastorage.org/webt/bv/ll/xa/bvllxaiaoeshjg0_71xwfocozqa.png"><br><br><h2>  рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рдПрдХ рдЬрдЯрд┐рд▓ рдФрд░ рдкреЗрд╢реЗрд╡рд░ рджрд┐рдЦрдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдмрд╣реБрдд рд╕рдордп рдмрд┐рддрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред  рдХрдИ рдШрдВрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рд╣рдордиреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдкреВрд░реНрдг рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдмрдирд╛рдпрд╛ рд╣реИ, рдкреНрд░рддреНрдпрдХреНрд╖ рд╡реНрдпрд╛рдкрд╛рд░ рдФрд░ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдЯреНрд░реЗрдбрд┐рдВрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВред <br>  рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдЯреНрд░реЗрдбрд┐рдВрдЧ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдмрдирд╛рдиреЗ рд╕реЗ рди рдбрд░реЗрдВред  рд╣рдореЗрдВ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рд▓реЗрдЦ рдЖрдкрдХреЛ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рд╣рдЬ рд╣реЛрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред <br><br>  <b>рд▓реЗрдЦрдХ</b> : рдЗрд╡рд╛рди рдЬрд╝рд╛рд▓реБрддрд╕реНрдХреА </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi433078/">https://habr.com/ru/post/hi433078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi433066/index.html">рд╣рд╛рдИрд▓рд╛рдб рдХрдк # 2ред рдмреИрдХрдПрдВрдб рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЪреИрдореНрдкрд┐рдпрдирд╢рд┐рдк рд╕реЗрд╡рд╛ рдореЗрдВ рд╡рд╛рдкрд╕</a></li>
<li><a href="../hi433070/index.html">рд╢реИрдореНрдкреЗрди рд╕реЗ рд╢реИрдореНрдкреВ, рдФрд░ рд╢реИрдореНрдкреЗрди рд╕реЗ рдХрдЯрд╛рд░ рдХреЛ рдХреИрд╕реЗ рднреЗрджрдирд╛ рд╣реИ ... рдПрд▓рд┐рдЯрд┐рдХреНрд╕рд░реНрдЪ - рд╕реНрдЯреЛрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЙрддреНрдкрд╛рджреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ</a></li>
<li><a href="../hi433072/index.html">рд╕реЗрдЧрд╛ рдбреНрд░реАрдордХрд╛рд╕реНрдЯ рдХрдВрд╕реЛрд▓ рдХреЙрдкреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдХреИрд╕реЗ рд╣реИрдХ рдХрд░реЗрдВ</a></li>
<li><a href="../hi433074/index.html">рдПрдВрдбреНрд░реЙрдЗрдб рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдХреЛрдЯрд▓рд┐рди рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛: рдЯрд┐рдкреНрд╕ рдФрд░ рдЯреНрд░рд┐рдХреНрд╕</a></li>
<li><a href="../hi433076/index.html">рдореАрдбрд┐рдпрд╛ рд╕рд╛рдордЧреНрд░реА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдордиреЗ рдЕрдкрдиреА рдПрдВрдбреНрд░реЙрдЗрдб рдЧреИрд▓рд░реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреИрд╕реЗ рдмрдирд╛рдИ</a></li>
<li><a href="../hi433082/index.html">рдЕрдиреНрдп рд▓реЛрдЧреЛрдВ рдХреЗ рдЦрд╛рддреЛрдВ рдХреЛ рдкрдВрдк рдХрд░рдирд╛ рджрдХреНрд╖рд┐рдг рдХреЛрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ рдЖрдкрд░рд╛рдзрд┐рдХ рдЕрдкрд░рд╛рдз рдмрди рдЧрдпрд╛ рд╣реИ</a></li>
<li><a href="../hi433084/index.html">╨Ю╤В╨║╤А╤Л╤В╤Л╨╣ ╤Г╤А╨╛╨║ ┬лFeature Engineering ╨╜╨░ ╨┐╤А╨╕╨╝╨╡╤А╨╡ ╨║╨╗╨░╤Б╤Б╨╕╤З╨╡╤Б╨║╨╛╨│╨╛ ╨┤╨░╤В╨░╤Б╨╡╤В╨░ ╨в╨╕╤В╨░╨╜╨╕╨║╨░┬╗</a></li>
<li><a href="../hi433086/index.html">Tinkoff рдФрд░ рд╕рдм рдХреБрдЫ, рд╕рдм рдХреБрдЫ, рд╕рдм рдХреБрдЫ: IoT, рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдХреА рдФрд░ рдмреИрдВрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдЧрд░рд╛рдиреА</a></li>
<li><a href="../hi433088/index.html">рдЖрдк рдЗрд╕реЗ рдХреИрд╕реЗ рдкрд╕рдВрдж рдХрд░рддреЗ рд╣реИрдВ, рдПрд▓реЛрди рдорд╕реНрдХ: рдмреАрдПрдордбрдмреНрд▓реНрдпреВ рдФрд░ рдкреЛрд░реНрд╢ рдиреЗ рдПрдХ рдЪрд╛рд░реНрдЬрд┐рдВрдЧ рд╡рд┐рдХрд╕рд┐рдд рдХреА рд╣реИ рдЬреЛ 3 рдорд┐рдирдЯ рдореЗрдВ 100 рдХрд┐рдореА рдХреА рдпрд╛рддреНрд░рд╛ рдЬреЛрдбрд╝рддреА рд╣реИ</a></li>
<li><a href="../hi433090/index.html">рдУрд░реЗрдХрд▓ рдмрд┐рдЯрдореИрдк рдЗрдВрдбреЗрдХреНрд╕ рддрдХрдиреАрдХ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>