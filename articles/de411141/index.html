<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíõ üßòüèΩ üöô "Smart Home" auf Arduino zur Abwechslung üõ∂ üå¨Ô∏è üç§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nichts Au√üergew√∂hnliches, nur ein weiterer Arduino-Controller. Mit Sensoren, Rollen und einer Webseite. Aber mit seinen eigenen Eigenschaften und sein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Smart Home" auf Arduino zur Abwechslung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/411141/"><img src="https://habrastorage.org/webt/7o/3k/or/7o3kora9koagtgemf_xxr71mlkk.jpeg"><br><br>  Nichts Au√üergew√∂hnliches, nur ein weiterer Arduino-Controller.  Mit Sensoren, Rollen und einer Webseite.  Aber mit seinen eigenen Eigenschaften und seiner sehr spezifischen praktischen Anwendung, wenn auch recht banal - die Ferneinbeziehung der elektrischen Heizung in das Land.  Die Anf√ºhrungszeichen in der Kopfzeile sind nicht zuf√§llig, der Controller ist in der aktuellen Version kein Smart Home, dient aber als gute Basis daf√ºr.  <i>(Hinweis - Dieser Satz wurde am 12.04.18 aufgrund der Kommentare hinzugef√ºgt.)</i> <br><br>  Hauptmerkmale: <br><br><ul><li>  Sensor f√ºr elektrische Netzwerkparameter - Stromz√§hler ‚ÄûNeva‚Äú gem√§√ü RS-485; </li><li>  Fern√§nderung der auf der SD-Karte liegenden Steuerungswebseite; </li><li>  Zuverl√§ssige Aufnahme einer Gruppe von Dallas-Temperatursensoren in lange Leitungen; </li><li>  Diagramme von Parameter√§nderungen ohne Einbeziehung von Cloud-Diensten; </li><li>  Ausfallsichere L√∂sungen (externer Watchdog, USV, automatischer Neustart des Routers); </li><li>  Schutz des Internetschildes vor Einfrieren bei St√∂rungen durch Leistungsrelais; </li><li>  Komplettes Design in einem DIN-Schienengeh√§use. </li></ul><a name="habracut"></a><br>  Ich habe dieses System langsam gemacht, als Unterhaltung, von Zeit zu Zeit das Projekt monatelang geworfen ... Es dauerte ungef√§hr anderthalb Jahre von der Idee bis zur Implementierung :) <br><br>  Da ich vorher nichts mit Mikrocontrollern zu tun hatte, begann ich mit dem Starter-Kit mit Aliexpress, spielte mit LEDs, Tasten und Sensoren, verstand etwas und begann, eine Steuerung f√ºr die Fernsteuerung und √úberwachung zu bauen.  Nun, das ‚ÄûSmart Home‚Äú ist nat√ºrlich nicht direkt, aber so √§hnlich. <br><br>  Das praktische Ziel war zun√§chst eines: die Fernschaltung der Heizung im Land.  Ich habe es noch nicht geschafft, ein Haus zu bauen (meine H√§nde haben es nicht erreicht), aber ich habe ein wunderbares, komfortables <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sommerhaus</a> aus Hackfleisch, das von elektrischen Konvektoren erhitzt wird.  W√§rmen Sie ein Umkleidehaus auf, das sich w√§hrend der Woche bis Freitagabend abgek√ºhlt hat - eine sehr verlockende Gelegenheit in der kalten Jahreszeit. <br><br>  Die Aufgabe der Fernsteuerung von Lasten erwies sich jedoch als recht trivial.  Arduino plus das Internetschild, eine fertige Skizze aus dem Internet, und die Rollen klicken bereits auf die H√§kchen auf der Webseite.  Das praktische Ziel wurde irgendwie sehr schnell und einfach erreicht.  Und es war langweilig.  Ich wollte etwas interessanteres. <br><br>  Ich habe mir ein zweites praktisches Ziel gesetzt - die √úberwachung des Stromverbrauchs im Sommerhausnetz.  Ich habe unpr√§tenti√∂se Stromsensoren f√ºr Tests herumgespielt.  Alles hat gut funktioniert, aber diese Option war nicht f√ºr Kampfarbeiten geeignet.  Ich konnte keine leistungsst√§rkeren Sensoren als bei 5A finden, aber ich brauchte mindestens 25A. <br><br>  Und ich hatte die Idee, einen Stromz√§hler als Leistungssensor zu verwenden.  Und es war ein gro√üartiger Gedanke!  Und ich habe ein solches Ger√§t geschaffen und gesehen, dass es gut ist!  Nicht ohne Schwierigkeiten, aber ich habe diese Aufgabe perfekt abgeschlossen, mit einem Gef√ºhl tiefer Befriedigung, und ich werde es weiter unten erz√§hlen :). <br><br>  <b>Funktionell</b> <br><br>  Die erste (und bislang letzte) Kampfversion des "Smart Home" -Controllers verf√ºgt √ºber folgende Funktionen: <br><br><ul><li>  Manuelle Fernsteuerung der Aktivierung des Leistungsrelais √ºber einen Browser und √úberwachung des aktuellen Status; </li><li>  Fern√ºberwachung der Parameter eines dreiphasigen Stromversorgungsnetzes (Spannung, Strom, Frequenz und viel mehr unn√∂tiger M√ºll, den ich sp√§ter abschaltete); </li><li>  Fern√ºberwachung der Messwerte eines Zwei-Tarif-Stromz√§hlers; </li><li>  Fern√ºberwachung einer Gruppe von Temperatursensoren; </li><li>  Protokollieren von Daten und Aufzeichnen von Ereignissen auf einer Speicherkarte; </li><li>  Anzeige der Daten aller Sensoren f√ºr den ausgew√§hlten Tag im Browser in Form von Grafiken. </li></ul><br>  <b>Ideologie</b> <br><br>  Das Prinzip des Aufbaus des gesamten Systems - ohne Cloud-Dienste von Drittanbietern sowie Datenerfassungs- und Anzeigeserver.  Das ist weder gut noch schlecht.  In der Anfangsphase des "intelligenten Bauens" ist ein solches Schema ausreichend und einfach.  Obwohl es bestimmte Einschr√§nkungen f√ºr die Verwendung auferlegt. <br><br>  Arduino mit einem Internetschild ist der einzige Webserver im System.  Die Webseite mit der Verwaltungsoberfl√§che wird auf der Internet-Speicherkarte gespeichert und an den Browser √ºbertragen, wenn √ºber die angegebene IP-Adresse auf sie zugegriffen wird.  Die weitere Interaktion der Benutzeroberfl√§che mit Arduino erfolgt √ºber Java-Skripte, deren K√∂rper nicht in die Webseite eingebettet sind, sondern in meinem Home-Dateispeicher mit Internetzugang gespeichert sind.  Dieser Ansatz reduziert das Gewicht der Webseite, wodurch das Lesen von der SD-Karte beschleunigt wird, und erm√∂glicht es Ihnen, den Skriptcode schneller und einfacher zu √§ndern. <br><br>  Das Lesen des Datenprotokolls zum Anzeigen von Grafiken erfolgt auf Anfrage von der Speicherkarte (Dr√ºcken einer Taste in einem Browser).  Daten werden nur in der aktuellen Sitzung der Browserseite angezeigt, sie werden nirgendwo gespeichert, und wenn Sie die Seite neu laden, m√ºssen Sie sie erneut lesen.  Dies ist ein Minus der Ideologie, da das Lesen von einer Speicherkarte ziemlich langsam ist und das Abrufen einer t√§glichen Datenmenge ein oder zwei Minuten dauern kann (es gab die Idee, das Datenspeicherformat zu √ºberarbeiten, um seine Gr√∂√üe zu verringern und das Lesen zu beschleunigen). <br><br>  Die aktuellen Werte der Sensoren werden auf der Seite angezeigt und in Echtzeit mit der Schleifenzyklusfrequenz aktualisiert, die ich habe und die ungef√§hr 1 Hz betr√§gt. <br><br>  Der Algorithmus enth√§lt derzeit keine ‚ÄûSchlauheit‚Äú.  Ob ich den Algorithmus in Zukunft ermahnen werde - ich wei√ü nicht, f√ºr den Moment ist die aktuelle Version f√ºr mich v√∂llig zufriedenstellend. <br><br>  <b>Netzwerktopologie</b> <br><br>  In der H√ºtte mobiles Internet Yota (USB-Modem + WLAN-Router).  Es gibt keine feste IP-Adresse und es gibt auch keine M√∂glichkeit, sie zu erhalten, selbst f√ºr Geld.  Und selbst wenn es keine dynamische wei√üe IP-Adresse gibt, ist DynDNS nicht anwendbar.  Nur graue IP-Adresse des internen Yota-Netzwerks.  IPota Yota unterst√ºtzt nicht (zumindest f√ºr 2017 ist dies der Fall).  Daher habe ich nur einen Weg gefunden, um von au√üen zum L√§nderrouter zu gelangen - VPN. <br><br>  Zu Hause (in der Stadt) kabelgebundenes Internet mit einer wei√üen festen IP-Adresse.  Router, gefolgt von Netzwerkspeicher.  Auf diesem Heimrouter wurde ein VPN-Server eingerichtet.  Der L√§nderrouter ist so konfiguriert, dass der PPTP-VPN-Tunnel zum Heimrouter angehoben wird. <br><br>  Der Controller auf Arduino ist mit dem LAN-Port des Country-Routers verbunden und befindet sich hinter NAT. Der 80. Port wird an diesen weitergeleitet.  Daher kann ich nur √ºber mein VPN auf Arduino zugreifen.  Dementsprechend sind das Heim-LAN und das VPN, die ich habe, zwei Segmente desselben Subnetzes. Der Zugriff erfolgt direkt dort.  Auf seinem B√ºrocomputer und auf einem Smartphone stellte er eine VPN-Verbindung her und erhielt Zugriff auf Arduino.  Nicht sehr bequem zu bedienen, aber es funktioniert.  Ja, und relative Sicherheit wird bereitgestellt - ohne Autorisierung in meinem VPN kann niemand anderes zur Controller-Verwaltungsseite gelangen. <br><br>  Der Engpass ist der VPN-Tunnel zum L√§nderrouter.  F√§llt regelm√§√üig.  Dar√ºber hinaus wird die PPTP-Verbindung abgebrochen, der Internetzugang bleibt bestehen.  Und das Schlimmste ist, dass die PPTP-Verbindung nicht mehr von selbst aufsteigt, wenn sie unterbrochen wird.  Selbst ein Neustart des Routers wird nicht gespeichert.  Nur ein vollst√§ndiger Neustart der Stromversorgung mit einem USB-Modem und dann nicht sofort.  Sie m√ºssen es ausschalten, 10 Minuten warten und wieder einschalten.  Gl√ºck - gut, nein - die n√§chste Iteration.  Laut dem technischen Support von Zyxel ist der Grund, dass der Mobilfunkbetreiber PPTP-Pakete blockiert, da eine Seite korrekt sendet, die andere korrekt zuh√∂rt, die Daten jedoch nicht erreichen (ich habe Zyxel-Router an beiden Enden des VPN-Tunnels).  Yota scheint schuld zu sein, aber etwas zu erreichen, das von ihnen verst√§ndlich ist, ist unm√∂glich.  Oder vielleicht auch nicht Yota. <br><br>  <b>Wachhund</b> <br><br>  Um einen relativ reibungslosen Betrieb des VPN zu gew√§hrleisten, verwende ich einen <strike>Kr√ºckenprogramm-</strike> Watchdog. Der L√§nderrouter wird √ºber ein von Arduina gesteuertes Leistungsrelais mit Strom versorgt. Sobald der VPN-Server aufh√∂rt zu pingen (auch Arduina pingt), wird der Router nach 10 Minuten f√ºr 10 Minuten vom Stromnetz getrennt und dann wieder vom Router Es wird eingeschaltet und es wird erwartet, dass innerhalb von 5 Minuten eine PPTP-Verbindung hergestellt wird.  Wenn keine Verbindung besteht, die n√§chste Iteration.  Manchmal wirkt diese Verbindung wochen- und sogar monatelang stabil und manchmal beginnt sie fast t√§glich zu brechen.  Es wurde noch kein anderer Weg gefunden, um das Problem zu l√∂sen.  Wie ich bereits sagte, unterst√ºtzt Yota IPv6 nicht, es gibt oder verkauft kein wei√ües IP an Physiker, es gibt keinen anderen Anbieter mit normalen Tarifen und sicherlich keinen unbegrenzten Datenverkehr.  Diese Entscheidung ist zwar eine Kr√ºcke, erf√ºllt aber ihre Aufgabe sehr gut.  Jetzt habe ich bis auf wenige Ausnahmen immer eine Verbindung, wenn ich zum Zeitpunkt des Neustarts komme. <br><br>  Neben Software habe ich auch einen Hardware-Watchdog implementiert.  Nur f√ºr den Fall.  Der Controller sollte in Abwesenheit von mir wochen- und manchmal sogar monatelang arbeiten und nicht h√§ngen bleiben.  Wie sich diese ganze Wirtschaft in gro√üen Minuspunkten verhalten wird, war mir nicht bekannt, also war ich in Sicherheit.  Der in Atmega eingebaute Watchdog hat bei mir nicht funktioniert, weil ich bei Arduino Mega √ºberhaupt nicht "out of the box" gearbeitet habe, und um ihn zum Laufen zu bringen, musste ich viel Spa√ü haben.  Dieses Problem wird hier gut beschrieben.  Au√üerdem hat er ein maximales Intervall von 8 Sekunden, was mir unzureichend erschien.  Daher habe ich einen speziellen Watchdog-Timer-Chip TPL5000DGST verwendet, dessen Intervall durch eine Kombination von drei Pins festgelegt wird und 64 Sekunden erreichen kann, was perfekt zu mir passt.  F√ºr diesen Chip habe ich ein kleines Steckbrett gekauft, es verl√∂tet und am Anschluss mit den E / A-Anschl√ºssen von Arduina befestigt (das Foto ist im Montageabschnitt unten zu sehen).  Tests haben den zuverl√§ssigen Betrieb dieses Watchdogs gezeigt, und ich habe mich gefragt, wie oft er in der Realit√§t funktionieren wird.  Zu diesem Zweck habe ich dem Programmcode eine Variable hinzugef√ºgt, in der Uhrzeit und Datum des Programmstarts gespeichert sind. Diese Informationen werden auf der Steuerungswebseite angezeigt.  Die Praxis hat gezeigt, dass der Controller im Gegensatz zu einem VPN lange Zeit reibungslos funktioniert und der Watchdog-Timer nie n√ºtzlich war (beim Schreiben des Artikels hat er zum ersten Mal funktioniert, er war nicht umsonst).  Die Dauer des Dauerbetriebs betrug mehr als 3 Monate und h√§tte l√§nger dauern k√∂nnen, wenn ich nicht von Zeit zu Zeit etwas im Code korrigieren und den Controller neu starten musste. <br><br>  <b>Der Parametersensor des Stromversorgungsnetzes - der Newva-Stromz√§hler</b> <br> <a href=""><img height="200" src="https://habrastorage.org/getpro/habr/post_images/845/f35/bd5/845f35bd5d12bc60384f1aa0bb1506aa.jpg" width="200"></a> <br><br>  Wie oben erw√§hnt, kann meiner Meinung nach nichts Besseres und Genaueres als ein moderner digitaler Stromz√§hler mit einer externen Datenzugriffsschnittstelle als Sensor f√ºr Stromversorgungsparameter gefunden werden.  Ich entschied mich f√ºr den Newa-Schalter der St. Petersburger Firma Taypit mit der RS-485-Schnittstelle. <br><br>  Ich betone, dass ein Stromz√§hler mit fest angeschlossenen Kabeln der 485. Schnittstelle offiziell nicht als Z√§hler verwendet werden darf ( <b>Update</b> : In den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kommentaren wurde</a> vorgeschlagen, dass dies zul√§ssig ist).  Deshalb habe ich im Stromnetz der H√ºtte zwei Z√§hler in Reihe geschaltet.  Der erste ist ein offizieller Stromz√§hler, versiegelt und registriert, der sich im Stra√üeneingang befindet.  Der zweite ist mein nicht versiegelter und nicht erfasster Stromversorgungssensor, den die Energievertriebsgesellschaft nicht interessiert, weil sie sich nicht um alles k√ºmmert, was nach dem Messger√§t installiert wird.  Dieser Stromz√§hler befindet sich bereits in der Schalttafel im Umkleidekabine, und in derselben Schalttafel befindet sich auch ein Controller auf Arduino, aber dazu sp√§ter mehr. <br><br>  In der H√ºtte habe ich ein dreiphasiges Stromversorgungsnetz.  In der Stadt kann ich nur einphasig debuggen.  Deshalb habe ich zwei Meter erworben, einen dreiphasigen Neva MT-324 und einen einphasigen Neva MT-124.  Das anf√§ngliche Debuggen des Controllers wurde auf dem Tisch auf einem Dreiphasenz√§hler mit einer einphasigen Verbindung durchgef√ºhrt und dann im Kampfbetriebsmodus regelm√§√üig im Datscha-Schild installiert.  Das Debuggen nachfolgender Softwaremodifikationen wurde bereits an einem g√ºnstigeren einphasigen Z√§hler auf dem Tisch durchgef√ºhrt: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/a5a/5cb/6fb/a5a5cb6fb932dea11badc7f06376e22d.jpg" width="640"></a> <br><br>  Um das Messger√§t an Arduino anzuschlie√üen, ist ein RS-485-TTL-Pegelwandler erforderlich: <br> <a href=""><img height="200" src="https://habrastorage.org/getpro/habr/post_images/258/07f/e5a/25807fe5acb55ec27d079d024a24b1f0.jpg" width="200"></a> <br><br>  Um mit dem Z√§hler arbeiten zu k√∂nnen, ben√∂tigen Sie eine kostenlose serielle Schnittstelle auf Arduino.  Leider hat Arduino Uno nur eine serielle Schnittstelle. Wenn Sie diese unter den Ladentisch nehmen w√ºrden, m√ºssten Sie die Debug-Ausgabe von Textinformationen (Port-Monitor) verlieren, und ohne diese w√§re es unm√∂glich, eine Skizze zu schreiben.  Daher verwende ich Arduino Mega, das mehrere serielle Schnittstellen hat.  Es w√§re m√∂glich, die zweite serielle Schnittstelle softovo √ºber die digitalen Anschl√ºsse von Arduino zu implementieren, aber ich habe keine geeignete Bibliothek gefunden, mit der andere Anschlusseinstellungen au√üer der Geschwindigkeit ge√§ndert werden k√∂nnen.  Die Einstellungen des Z√§hlerports unterscheiden sich von den Standardeinstellungen: 9600 Bitrate, 7 Datenbits, 1 Stoppbit, Parit√§tskontrolle - gerade.  Gl√ºcklicherweise k√∂nnen Sie diese Einstellungen mit dem seriellen Standardobjekt in Arduino vornehmen. <br><br>  Es war relativ einfach, das Austauschprotokoll mit dem Z√§hler abzurufen - der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√∂ffentlich zug√§ngliche Z√§hlerhersteller</a> verf√ºgt √ºber ein Programm zum Lesen von Parametern unter Windows, das auch √ºber einen Portmonitor verf√ºgt.  Um das Messger√§t an einen Computer anzuschlie√üen, habe ich den Schnittstellenkonverter MOXA 232/432 / 485USB verwendet.  Einige Zeit f√ºr die visuelle Analyse der Pakete - und ich habe die Hauptbefehle herausgegriffen. <br><br>  Dies schien mir jedoch nicht genug zu sein, und ich kontaktierte den Hersteller per E-Mail.  Nach einem Monat Korrespondenz mit Typit gelang es mir schlie√ülich, eine vollst√§ndige Liste der Befehle mit Interpretation zu erhalten: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Parametercodierung MT3XX E4S</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Parametercodierung NEVA MT124 AS OP (E4P)</a> <br><br>  <b>Update 28.10.2019</b> : Erl√§uterungen zu den Befehlen.  Die Befehle in der Tabelle werden als Textzeichen dargestellt.  Das hei√üt, wo es 0 (Null) kostet, m√ºssen Sie 0x30 senden.  Punkte und Sternchen sind Trennzeichen f√ºr Sch√∂nheit, sie bedeuten nichts und Sie m√ºssen sie nicht senden.  Am Ende des Befehls wird ein Pr√ºfsummenbyte hinzugef√ºgt, das unter Ber√ºcksichtigung des Befehlspr√§fixes und des Postfixes berechnet wird, die in der Tabelle nicht angegeben sind.  Das Pr√§fix f√ºr alle Lesebefehle lautet 0x01 0x52 0x31 0x02.  Dieser Postfix ist 0x28 0x29 0x03.  Das Senden eines Pr√§fixes ist jedoch nicht erforderlich, und ein Postfix scheint obligatorisch zu sein.  Beispiel: Befehl zum Lesen des Datums 09.09.02 * FF.  Eigentlich m√ºssen Sie die Textzeichencodes 000902FF √ºbergeben.  Das hei√üt, 0x30 0x30 0x30 0x39 0x30 0x32 0x46 0x46.  F√ºgen Sie das Pr√§fix und das Postfix hinzu, wir erhalten die Menge 0x01 0x52 0x31 0x02 0x30 0x30 0x30 0x39 0x30 0x32 0x46 0x46 0x28 0x29 0x03.  Wir lesen die Pr√ºfsumme als xoder aller Bytes minus 1 und addieren das empfangene Byte am Ende.  Das Pr√§fix wird als optional verworfen.  Als Ergebnis senden wir dies an den Z√§hler - 0x30 0x30 0x30 0x39 0x30 0x32 0x46 0x46 0x28 0x29 0x03 0x68.  Vor dem Beginn des Austauschzyklus m√ºssen die Befehle f√ºr die Austauschinitialisierung stehen. In der folgenden Skizze sind diese Befehle als // Start 1, 2, 3 gekennzeichnet. Sobald der Austausch initialisiert ist, k√∂nnen Sie die Daten vom Z√§hler im Zyklus f√ºr eine beliebig lange Zeit lesen, jedoch nach Verlust der Kommunikation und M√∂glicherweise ist nach l√§ngerem Mangel an Austausch aus anderen Gr√ºnden eine Neuinitialisierung erforderlich. <br><br>  Dar√ºber hinaus besteht die technische Angelegenheit darin, einen Zyklus der Parameterabfrage unter Arduino zu schreiben und diese zun√§chst im Port-Monitor anzuzeigen.  Die Zeit eines Zyklus betrug ungef√§hr eine Sekunde.  In der endg√ºltigen Version des Projekts mit Datenprotokollierung auf einem Flash-Laufwerk und Abfragetemperatursensoren wurde diese Zeit jedoch auf 4 Sekunden erh√∂ht.  Das passte mir √ºberhaupt nicht und musste in die Optimierung eintauchen.  Infolgedessen habe ich wieder ein zweites Intervall erreicht, ohne die Funktionalit√§t zu verlieren.  √úbrigens habe ich die Skizze zwei- oder dreimal von Grund auf neu geschrieben, bis ich die richtige Architektur und die richtigen wirtschaftlichen Algorithmen gefunden habe. <br><br>  <b>Software-Implementierung des Austauschs mit einem Z√§hler</b> <br><br>  Der Code wird aus dem Kontext meiner gro√üen Arbeitsskizze herausgerissen.  Kompiliert, aber in dieser Form habe ich es nie ausgef√ºhrt.  Ich gebe es nur als Beispiel und nicht als fertiges Arbeitsprogramm.  Obwohl theoretisch alles in dieser Form funktionieren sollte. <br><br>  Der Code wird f√ºr zwei Arten von Z√§hlern gleichzeitig geschrieben, einphasiges MT-124 und dreiphasiges MT-324.  Der Z√§hlertyp wird im Programm automatisch durch das Antwortwort des Initialisierungsbefehls ausgew√§hlt. <br><br>  Ich zitiere den Code so wie er ist, ohne H√ºbschheit und ohne zus√§tzliche Kommentare au√üer denen, die ich f√ºr mich selbst geschrieben habe.  Und ja, ich bin kein Programmierer und lerne nicht einmal daf√ºr. Sie sollten mich also nicht wegen der Qualit√§t des Codes treten, aber Sie k√∂nnen lernen, wie man <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">codiert</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EnergyMeterNeva.ino</a> <br><br>  Ein gro√ües Plus des Stromz√§hlers ist eine zuverl√§ssige und genaue Echtzeituhr.  Ich musste dem System kein zus√§tzliches Modul zur Verf√ºgung stellen, das nicht nur irgendwie, sondern auch qualitativ hochwertig zu finden ist.  Die auf die Sekunde genau aktuelle Zeit erhalte ich unter anderem vom Z√§hler.  Ja, in Bezug auf die Atomzeit ist die Z√§hlerzeit leicht verschoben (einige Sekunden). Ich wei√ü nicht, womit sie verbunden ist, eine Werkseinstellung von schlechter Qualit√§t oder etwas anderes, aber die Genauigkeit ist ausgezeichnet, nur mit einer leichten Abweichung. <br><br>  In seltenen Momenten, wenn der Strom in der H√ºtte ausgeschaltet ist und der Z√§hler nicht mehr verf√ºgbar ist, erhalte ich die aktuelle Zeit vom internen Timer von Arduina.  Wenn der Stromz√§hler funktioniert und seine Daten verf√ºgbar sind, schreibe ich den internen Timer von Arduina mit dem Wert des Z√§hlers in jeder Schleifenschleife neu.  Wenn der Z√§hler abf√§llt, tickt die aktuelle Zeit weiterhin auf dem Arduina-Timer. <br><br>  Neben dem Lesen der Parameter kann nat√ºrlich auch der Z√§hler programmiert werden.  Das hei√üt, die Schnittstelle funktioniert sowohl zum Lesen als auch zum Schreiben.  Mit solchen Schwierigkeiten versuchte ich jedoch, ein Protokoll zum Lesen von Befehlen zu erhalten, das ich dem Hersteller nicht einmal √ºber die Anforderung eines Aufzeichnungsprotokolls anzeigte.  Erstens brauchte ich es nicht, au√üer vielleicht nur ein wenig Zeit, um es zu bewegen.  Zweitens vermute ich, dass diese Daten nicht mehr √∂ffentlich sind, da sie f√ºr betr√ºgerische Zwecke verwendet werden k√∂nnen. <br><br>  <b>Temperatursensoren</b> <br><br>  Ich habe bereits zuvor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen</a> Test von Temperatursensoren mit einem Skizzenbeispiel separat durchgef√ºhrt.  Jetzt blieb es nur noch, ihre Umfrage in das Hauptprojekt einzubetten.  Es war nicht schwer.  Alle neun Sensoren, die ich hatte, arbeiteten problemlos, als ich 1-Wire parallel einschaltete.  Der Messbereich zwischen ihnen betrug etwa 0,5 Grad, was zeigt, dass es sinnlos ist, sie mit einer maximalen Genauigkeit von 0,0625 Grad zu verwenden.  Ich sammelte die Sensoren f√ºr den Test in einer Packung und wickelte sie in mehrere Schichten Polyethylenkleber ein.  F√ºr eine gr√∂√üere Genauigkeit platzierte ich die Packung vertikal und wartete einen Tag, um die Temperatur vollst√§ndig auszugleichen.  Die Messwerte aller Sensoren waren nicht gleich. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe jedoch nicht begonnen, die Genauigkeit der Umrechnung der Temperatur der Sensoren selbst zu beeintr√§chtigen. Es ist einfacher, die Messwerte programmgesteuert abzurunden, und ich w√ºrde den Nutzen aus dem Zeitpunkt der Umfrage nicht ziehen, da ich einen Algorithmus entwickelt habe, bei dem das Zeitlimit f√ºr die Konvertierung keine leere, nutzlose Verz√∂gerung ist (750). Die √ºbliche Logik f√ºr die Arbeit mit Sensoren besteht darin, zuerst einen Befehl zum Starten der Temperaturumwandlung auszugeben, dann auf den Abschluss der Umwandlung zu warten (mindestens 750 ms) und dann die Daten zu lesen. Ich habe das Gegenteil getan, wodurch ich ein leeres Warteintervall ausschlie√üen konnte - zuerst habe ich die Daten von den Sensoren gelesen und dann sofort mit der Konvertierung begonnen. Und w√§hrend der gesamte Rest des Codes im LOOP-Zyklus funktioniert, haben die Daten nur Zeit, sich auf das Lesen in der n√§chsten Runde vorzubereiten. Mit der Zeit erhalte ich die Daten in diesem Fall etwas sp√§ter von den Sensoren - der LOOP-Zyklus dauert ungef√§hr 1-1.5 Sekunden, aber das ist absolut nicht kritisch.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manchmal erhielt ich von allen Sensoren die Daten ‚Äû85‚Äú oder ‚Äû0‚Äú. Ich verstehe nicht, um welche Art von Pfosten es sich handelt, daher habe ich den Code √ºberpr√ºft und ausgeschlossen, dass solche Daten in das Ergebnis gelangen. Ein weiterer Pfosten wurde an einem der Sensoren entdeckt - er hielt die Einstellungen nicht, als die Stromversorgung ausgeschaltet wurde. Entweder ist sein internes Flash-Laufwerk tot oder etwas anderes. Daher habe ich im Setup die Einstellungen f√ºr die Sensoren registriert, und jetzt, wenn die Stromversorgung eingeschaltet wird (falls sie immer noch verschwindet), sind garantiert alle Sensoren konfiguriert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe die Adressen bestimmter Sensoren anhand eines Skizzenbeispiels erhalten, das irgendwo von mir ausgegraben und ein wenig ge√§ndert wurde: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18x20_Temperature.ino</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Danach habe ich die Adressen mit Konstanten in einem Array </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">bewertet</font></a><font style="vertical-align: inherit;"> und mich </font><font style="vertical-align: inherit;">im Hauptprogramm sofort an die Sensoren gewandt, deren Adressen: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TempSensors_DS18B20.ino</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√ºr den korrekten Betrieb der Sensoren am 1-Draht-Bus muss ein 4,7-kŒ©-Pull-up-Widerstand zwischen der Datenleitung und der Stromversorgung installiert werden. Es war praktisch f√ºr mich, einen SMD-Widerstand zwischen die Stifte des Klemmenblocks zu l√∂ten, aber ich fand in einem geeigneten Geh√§use nur 5,1 kOhm und legte ihn ein (er ist auf dem Foto im Montageabschnitt auf der Unterseite der Platine sichtbar). Alles funktioniert gut.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meine Temperatursensoren sind elektrisch parallel an einer langen Leitung (+5, gnd und Daten) angeschlossen, alle 9 Teile, aber schwierig. Twisted Pair-Kabel sind physikalisch durch einen Stern verbunden, um Sensoren bequem um das Objekt herum zu verdrahten. Ich benutze zwei Paare in jedem Kabelarm. Ein Paar ist die Sensorleistung. Das zweite Paar ist eine Datenleitung, die durch eine Leitung zum Sensor f√ºhrt und von dieser √ºber die zweite Leitung zur√ºckkehrt. Somit ist es m√∂glich, die Kabel mit einem Stern von der Abschirmung zu trennen, aber elektrisch ist es ein Stern nur in der Leistung, und nach den Daten ist es eine Leitung. Diese Verbindungsoption erwies sich bei der Arbeit an langen Leitungen als zuverl√§ssiger. Bei einer einfachen Parallelverbindung traten beim Lesen von Daten viele Fehler auf. Hier ist eine Skizze eines solchen Schemas:</font></font><br><br> <a href=""><img height="300" src="https://habrastorage.org/getpro/habr/post_images/84e/1a3/b3d/84e1a3b3d64983af4236a6dad5458a52.jpg" width="640"></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe die halben Meter langen Enden der dreiadrigen Kabel der Sensoren selbst nicht gek√ºrzt, sondern sie so angeschlossen, wie sie waren. Es stellte sich heraus, dass dies nicht kritisch war. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Insgesamt gibt es drei Kabel f√ºr die Kabinen, zwei f√ºr externe Sensoren, jeweils eines f√ºr jede und eines f√ºr alle verbleibenden sieben internen. Diese sieben internen Sensoren werden auf die gleiche Weise angeschlossen, jedoch innerhalb eines langen Kabels und mit kurzen Abzweigungen davon (siehe die untere T-Form in der Skizze). Irgendwo gab es genug einen Standard-halben Meter Schwanz des Sensors zum Verzweigen, irgendwo wurde er mit Hilfe des gleichen verdrillten Paares verzweigt.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zweidraht-Sensorschaltkreis mit sogenannter Ich habe keine parasit√§re Energie verwendet (wenn die Sensoren √ºber die Datenleitung mit Strom versorgt werden), weil ... warum? Auf jeden Fall w√ºrde ich vier Paar Kabel nehmen, einfach weil ich sie hatte. Es gibt keine Probleme beim Verlegen des Kabels in den Kabinen. Und die parasit√§re Stromversorgungsschaltung ist entscheidend f√ºr die in einigen Betriebsarten verbrauchte Strommenge. Es k√∂nnen unn√∂tige Probleme auftreten.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Gesamtl√§nge des verdrillten Paares in den Kabinen betrug ungef√§hr 25 Meter. Teile f√ºr externe Sensoren - 5 und 10 Meter, und ein zehn Meter langes internes Teil mit Abzweigungen f√ºr sieben Sensoren. Alles funktioniert fast perfekt. Anstelle von Temperaturwerten kreuzen sich nur gelegentlich Striche. Dies bedeutet, dass Daten von einem bestimmten Sensor nicht korrekt gelesen wurden. Aber das passiert so selten (ich merke es vielleicht einmal im Monat), dass es keine Probleme verursacht. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remote - </font><font style="vertical-align: inherit;">Zugriff</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> f√ºr Remote - </font><font style="vertical-align: inherit;">Zugriff auf das Arduino wurde Ethernet Schild gekauft. Mit einer eingebauten Bibliothek erwies sich die Arbeit damit, wie alles andere in Arduino, als recht einfach.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionell ist mein Arbeitsschema wie folgt. Auf Arduino wurde ein Webserver eingerichtet, der beim Zugriff eines Clients (Browsers) eine Webseite mit verschiedenen Informationen generiert. Die automatische Aktualisierung der Daten auf der Seite wird mithilfe von Javascript implementiert, das den Server nach Timer abfragt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Seite enth√§lt auch eine Reihe von Steuerelementen zur Steuerung von Aktuatoren, die an Arduino-Leistungsrelais angeschlossen sind, die die lastelektrischen Heizungen und die Beleuchtung schalten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe mit dem Design der Webseite kein Dampfbad genommen, zumal eine minimale Menge an Textdaten erforderlich war, um sie schneller zu laden, daher das primitivste HTML und das ist alles:</font></font><br><br> <a href=""><img height="640" src="https://habrastorage.org/getpro/habr/post_images/1e0/2fa/c9e/1e02fac9e6e1e8c5a16d0a7c07667f94.png" width="475"></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anstelle von Daten habe ich Tags in den HTML-Code eingebettet, die im laufenden Betrieb durch echte Daten ersetzt werden, wenn die Seite vom Server generiert wird. Wenn Daten auf Anforderung von Javascript automatisch aktualisiert werden, werden sie direkt vom Mikrocontroller im JSON-Format an den Browser √ºbertragen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Seitencode befindet sich in einer Datei auf der Speicherkarte und wird beim Zugriff auf den Server von dieser geladen. F√ºr eine schnellere und bequemere √Ñnderung des Seitencodes habe ich den Mechanismus zum Aktualisieren selbst eingebaut. Unten unter dem Block der grundlegenden Steuerelemente befinden sich ein Textfeld und eine Schaltfl√§che zum Senden. Ich kopiere den neuen HTML-Code in das Textfeld und dr√ºcke die Taste. Danach sendet das Java-Skript Daten an den Webserver des Controllers, der sie zuerst in der Spooldatei speichert. Wenn die √úbertragung erfolgreich war, wird die Hauptdatei durch einen Puffer ersetzt, die Seite wird automatisch aktualisiert.</font></font> Das ist alles.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñnderungen akzeptiert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich zitiere die Codefragmente meiner Implementierung dieses Mechanismus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In die HTML-Seite binden wir das Formular ein:</font></font><br><br><pre><code class="plaintext hljs">&lt;script type="text/javascript" src="http://domain/send_HTM.js"&gt;&lt;/script&gt;&lt;/pre&gt; &lt;pre style="font-size: 14px;"&gt;&lt;form&gt; &lt;br&gt;&lt;br&gt; CONTROL.HTM:&lt;br&gt; &lt;textarea cols="100" rows="20" wrap="off" id="htm"&gt;&lt;/textarea&gt;&lt;br&gt; &lt;input type="button" value="" onclick="send_HTM();"&gt;&lt;br&gt; &lt;div id="progress" style="display:none"&gt; &lt;div id="label"&gt;  :&lt;/div&gt; &lt;div style="width:800px;border:1px solid #000"&gt; &lt;div id="bar" style="background:#00f;height:10px;width:0px"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/form&gt;</code> </pre> <br>  Die Schaltfl√§che "Senden" startet das folgende <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java-</a> Skript: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">send_HTM.js</a> <br><br>  In der Skizze in der Funktion zum Verarbeiten von Webserveranforderungen nach Pr√§fixen in den Anforderungen 'CONTROL.HTM' (Senden der Datei starten), 'htmlineN' (Senden der Zeilennummer) und 'END_CONTROL.HTM' (Ende des Sendens der Datei) bestimmen wir die folgenden Aktionen: <br><br><pre> <code class="plaintext hljs">File acceptHtmFile; ................ if (fl_accept_htm) //  'CONTROL.HTM' { SD.remove(CTRL_HTM); acceptHtmFile = SD.open(CTRL_HTM, FILE_WRITE); //     if (!acceptHtmFile) //      -    { #ifdef DEBUG_SD Serial.println("SD-card not found"); #endif client.print("FAIL"); client.stop(); } else client.print("OK_OPEN_FILE"); acceptHtmMode = true; break; } if (fl_htmline) //  'htmlineN' { int b = acceptHtmFile.println(tag); if (b == 0) { client.print("FAIL"); acceptHtmMode = false; cntHtmModeIteration = 0; } else { client.print("OK"); } cntHtmModeIteration = 0; break; } if (fl_endhtm) //  'END_CONTROL.HTM' { SD.remove(CONTROL_HTM); acceptHtmFile.close(); File htmlFile = SD.open(CONTROL_HTM, FILE_WRITE); //    acceptHtmFile = SD.open(CTRL_HTM); //    for (int i = 0; i &lt; acceptHtmFile.size(); i++) { digitalWrite(PIN_WATCHDOG_DONE, 1); htmlFile.write(acceptHtmFile.read()); digitalWrite(PIN_WATCHDOG_DONE, 0); } acceptHtmFile.close(); htmlFile.close(); client.print("OK_CLOSE_FILE"); acceptHtmMode = false; cntHtmModeIteration = 0; break; }</code> </pre> <br>  Die hier definierten CONTROL_HTM- und CTRL_HTM-Namen sind die Namen der HTML-Dateien.  Die erste ist die Hauptdatei, die zweite ist die Pufferdatei.  In dem Array von Tag char liegt der Text der empfangenen Zeichenfolge, der aus der Anforderung ausgew√§hlt wurde.  Die Logik lautet wie folgt: Wenn Daten empfangen werden, werden sie in die Spooldatei geschrieben. Am Ende des Empfangs wird die Spooldatei in der Hauptdatei √ºberschrieben.  Ich konnte immer noch nicht verstehen, wie man die Dateien einfach umbenennt, die SD-Standardbibliothek hat keine solche Funktion, also dummes zeichenweises Kopieren, was viel Zeit in Anspruch nimmt. <br><br>  Es ist praktisch, den Code der Steuerungswebseite nicht auf der Speicherkarte des Controllers, sondern auf dem Clientcomputer zu speichern oder von einer externen Ressource herunterzuladen.  Das Verbot dom√§nen√ºbergreifender Anfragen erlaubt dies jedoch nicht.  Javascripts k√∂nnen ihre Anfragen nur in den Norden senden, aus dem sie geladen wurden.  In diesem Fall k√∂nnen die Javascripts von √ºberall geladen werden. Es ist nur wichtig, woher die Seite mit ihrem Aufruf geladen wurde. <br><br>  <b>Datenprotokollierung</b> <br><br>  Das Ethernet-Shield verf√ºgt √ºber einen integrierten Micro-SD-Kartensteckplatz.  Aufgrund seiner Anwesenheit habe ich beschlossen, Daten in Protokolldateien zu schreiben.  Um mit einer Speicherkarte arbeiten zu k√∂nnen, ist auch eine Bibliothek integriert, und das Schreiben und Lesen von Dateien damit zu verwalten, ist im Allgemeinen elementar. <br><br>  Um die Datenmenge zu speichern, habe ich den Protokollierungsalgorithmus so erstellt, dass der Datensatz nur dann erstellt wird, wenn sich die Daten um mehr als einen vorgegebenen Schwellenwert √§ndern.  F√ºr die Temperatur betr√§gt sie 0,1 ¬∞, f√ºr die Spannung 0,2 V.  Daten f√ºr einen Tag werden in eine Datei geschrieben.  Nach null Stunden wird eine neue Datei erstellt.  Ich habe das Nur-Text-Format mit Trennzeichen gew√§hlt, damit Sie den Inhalt von Dateien w√§hrend des Debuggens schnell steuern k√∂nnen und es eine einfache M√∂glichkeit gibt, in Excel zu laden. <br><br>  Aufgrund von Designbeschr√§nkungen k√∂nnen Sie eine Speicherkarte nicht bequem einsetzen / entfernen, daher habe ich eine gro√üe Karte verwendet.  Nach meinen Berechnungen wird es einige Jahre lang ausgef√ºllt. Danach muss das Geh√§use zerlegt, die Speicherkarte entfernt und gereinigt werden. <br><br>  Ich sehe keinen Sinn darin, den Code zu protokollieren, da ist dort alles v√∂llig trivial - eine banale Aufzeichnung von Text in einer Datei.  Und dieser Code ist √ºber die gesamte Skizze verteilt (nicht nur die Parameter der Sensoren werden protokolliert, sondern auch eine Vielzahl von einmaligen Ereignissen). Es ist schwierig, ihn zu isolieren. <br><br>  <b>Grafiken</b> <br><br>  Als Charting-Engine verwende ich die hochflexible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Amavart-</a> Javascript-Visualisierungsbibliothek.  Die Bibliothek ist kostenlos und steht zum Download und zur Offline-Nutzung zur Verf√ºgung.  Ich habe diese Bibliothek auch auf meinem NAS mit permanentem Internetzugang gefunden.  Das Verbinden und Verwenden mit den Standardeinstellungen ist nicht schwierig. Um jedoch die Ansicht zu erhalten, die ich brauchte, musste ich viel basteln.  Eine Vielzahl von Beispielen auf der Website und die Verf√ºgbarkeit detaillierter Dokumentation haben geholfen. <br><br>  Als Beispiel werde ich das Javascript zum Zeichnen von Zeitpl√§nen geben.  An sich ist es nutzlos, da es nur in Verbindung mit einem Webserver und einer HTML-Seite funktioniert und m√∂glicherweise mit anderen Skripten verkn√ºpft ist (es ist lange her, ich erinnere mich nicht an alle Details).  Aber die Darstellungseinstellungen meiner Diagramme sind darin enthalten und k√∂nnen von dort <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">abgerufen werden</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">get_log.js</a> <br><br>  Der gro√üe Vorteil der Amchart-Bibliothek besteht darin, dass sie aus zerrissenen Daten die richtigen Grafiken zeichnen kann.  Wie oben erw√§hnt, speichere ich im Protokoll Daten nur, wenn sie sich √§ndern.  Das hei√üt, dies geschieht asynchron und zuf√§llig.  M√∂glicherweise sind einige Minuten lang keine neuen Daten vorhanden, die sich dann in wenigen Sekunden mehrmals √§ndern.  Dementsprechend gehen Eintr√§ge im Protokoll mit beliebigen Zeitintervallen.  Amchart ber√ºcksichtigt dies beim Rendern selbstst√§ndig. Ich muss die Daten vor dem Rendern nicht interpolieren.  Ich sende das Datenarray einfach so wie es ist und sehe ein sch√∂nes Diagramm, das zeitlich einheitlich ist. <br><br>  Ich habe nur einen Nachteil dieser Bibliothek entdeckt - sie wei√ü nicht, wie (na ja, oder ich verstehe immer noch nicht, wie) Echtzeitdiagramme menschlich aktualisiert werden k√∂nnen.  Sie k√∂nnen vorhandenen Daten neue hinzuf√ºgen, aber das gesamte Datenarray wird jedes Mal neu gezeichnet, was den Browser erheblich verlangsamt.  Die Ideologie, Daten von Arduina zu lesen, um sie bei Bedarf vom Browser zu rendern, ist jedoch durch ihre Nichtoptimalit√§t fehlerhaft, sodass es keinen Sinn machte, in Echtzeit um ein schnelles Update zu k√§mpfen. <br><br>  Die richtige L√∂sung w√§re, einen separaten Server zum Speichern und Visualisieren von Daten zu organisieren, auf dem die Daten von Arduina in Echtzeit ein wenig abfallen und in der Datenbank gespeichert werden und von wo aus sie schnell in einem Browser zur Visualisierung an den Benutzer gesendet werden k√∂nnten. <br><br>  Jetzt sehen die Diagramme so aus (am Beispiel des Tages, an dem sich niemand in der Wechselstube befindet und dementsprechend kein Energieverbrauch besteht).  Wenn aktuelle Daten auftreten, wird die Skalierung automatisch so eingestellt, dass alles gut passt und die Werte der aktuellen Pegel auf der vertikalen Achse angezeigt werden: <br><br> <a href=""><img height="246" src="https://habrastorage.org/getpro/habr/post_images/12e/6d5/7e5/12e6d57e563012ba95a5407a1f96a88e.png" width="640"></a> <br><br>  Diagramme werden auf derselben Seite angezeigt, auf der die Steuerung direkt unter dem Hauptsteuerblock stattfindet. <br><br>  Ich stelle aus mehreren Gr√ºnden nicht absichtlich einen vollst√§ndigen Satz von Projektquellen zur Verf√ºgung: <br><br><ol><li>  Es kann nicht wie in einem anderen Netzwerk als meinem gestartet werden, da ich nicht versucht habe, das Projekt portabel zu machen, und es ist fest an meine Adressen und meine Netzwerktopologie gebunden. </li><li>  Ich bin sicher, dass die allgemeine Ideologie des Projekts viele verschiedene Probleme hat, da dies mein erster Versuch in dem Bereich ist, in dem ich nicht gut verstehe.  Daher schlage ich niemandem das gesamte Projekt zur Wiederholung in dieser Form vor.  Ich habe nur die Momente geteilt, in denen ich weniger zuversichtlich bin. </li><li>  Das Projekt wurde f√ºr eine lange Zeit und f√ºr eine lange Zeit durchgef√ºhrt, und ich werde mich nie an alle Details erinnern und nicht in der Lage sein, eine Reihe von L√∂sungen zu erkl√§ren.  Das Volumen der Skizze ist sehr gro√ü (nach meinen Ma√üst√§ben etwa zweitausend Zeilen), es gibt mehr als ein Dutzend verschiedene Java-Skripte, ich habe kein schematisches Diagramm des Eisens erstellt.  Das hei√üt, ich kann nicht helfen, in den meisten Fragen zu beraten. </li></ol><br>  <b>Montage</b> <br><br>  Von Anfang an habe ich mir das Ziel gesetzt, ein fertiges Ger√§t zu erstellen und nicht nur ein Layout mit einem Haufen Postings auf dem Tisch: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/721/a45/ba3/721a45ba3d536cfbf0d3b302c32cdd3b.jpg" width="640"></a> <br><br>  Und sofort entschieden, dass ich das Ger√§t in der Schalttafel platzieren m√∂chte.  Es gibt Essen und eine Theke, und im Allgemeinen ist es bequem. <br><br>  Hierf√ºr war ein Dinrek-Fall erforderlich.  Zuerst dachte ich daran, es zu entwickeln und auf einem 3D-Drucker zu drucken.  Aber ich habe keinen eigenen 3D-Drucker, und was meine Kollegen an ihren selbst zusammengestellten Druckerdrucken arbeiteten, passte mir in der Qualit√§t ihres Aussehens √ºberhaupt nicht.  Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fertige Koffer</a> auf einer DIN-Schiene (in verschiedenen Gr√∂√üen) zum Verkauf gefunden, sie sehen gut aus, sind bequem zu verwenden (zusammenklappbar) und es gibt auch eine fertige <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Blindkarte</a> f√ºr sie. <br><br>  Ich habe das gr√∂√üte Geh√§use gekauft, damit nicht nur Arduino mit dem Internetschild hineinpassen kann, sondern auch ein Relais zum Lastschalten: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/674/493/325/6744933251f7abeed45267d51d2c2e59.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/aed/1dc/c27/aed1dcc279af58de00af5e68f30b8aac.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/fe1/cbb/ab7/fe1cbbab760347fda7df0edf2b0a9c09.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/0f9/13b/250/0f913b2504dcef41d4156e23015f5fef.jpg" width="640"></a> <br><br>  Als n√§chstes folgte ein langer und faszinierender Prozess, bei dem der gesamte Kutteln in den Koffer eingebaut wurde.  Im Rahmen dieses Gesch√§fts erwarb ich sogar einen wunderbaren L√∂tkolben mit Schlaffunktion (die L√∂tkolben, die ich hatte, stammten noch aus sowjetischer Zeit): <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/8f7/cff/613/8f7cff613a071eb2ee93cd09c3286622.jpg" width="640"></a> <br><br>  F√ºr die Installation kaufte ich ein paar Racks, Schrauben, Unterlegscheiben und Muttern aller Art.  Erstmontage: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/c28/ff1/ac7/c28ff1ac7b46d25bf58714949091c7d6.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/fd9/c60/001/fd9c6000193beeb0a82cf14d7ca56cda.jpg" width="640"></a> <br><br>  Um die Dr√§hte mit den oberen Kontakten zu verbinden, mussten verbogene Stifte verwendet werden, da sie sonst nicht in das Geh√§use passten: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/47a/8eb/107/47a8eb107e5b12253386f61745103774.jpg" width="640"></a> <br><br>  Die Isolierscheiben mussten stellenweise geschnitten werden: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/4da/e6f/55f/4dae6f55f161153a1d544c8aae3c883e.jpg" width="640"></a> <br><br>  Und stellenweise biegt es sich perverser, hebt die Schraube an der H√ºlse an und schneidet die H√ºlse aufwendig ab: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/6ec/226/736/6ec226736d2576706170487958208959.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/f98/c43/fb9/f98c43fb9ddb0da9149193dd92ef465d.jpg" width="640"></a> <br><br>  F√ºr ein einzelnes Reloch gab es nicht gen√ºgend Drehpunkte, so dass es nur an zwei Punkten hing: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/398/f46/4b6/398f464b6f08b4372bf8792edb0018b9.jpg" width="640"></a> <br><br>  Zusammengebaute Baugruppe mit Klemmenbl√∂cken: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/bd8/17d/1cb/bd817d1cbc854ac47c7427c26dc0f0c8.jpg" width="640"></a> <br><br>  Dann begann das Handwerk allm√§hlich zu Dr√§hten zu wachsen.  Die Platine wurde nur zur Stromverdrahtung und zum Anschluss an Klemmenbl√∂cke verwendet.  F√ºr Signalverbindungen habe ich das MS-16-Kabel verwendet (ich mag es mehr), f√ºr die Stromversorgung ging es nicht durch die Spannung (bis zu 100 V), also MGTF: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/cc3/5ae/01d/cc35ae01d9728523e1edbe1e3d0ae79d.jpg" width="640"></a> <br><br>  Ich habe LEDs an der Vorderseite angebracht, die Strombegrenzungswiderst√§nde direkt an die Beine der LEDs gel√∂tet und sie mit Schrumpfschlauch geschlossen: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/4a3/299/840/4a3299840a442a416396a30c81a25e2e.jpg" width="640"></a> <br><br>  Als Ergebnis haben wir eine solche b√§rtige F√ºllung bekommen: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/5c7/042/3e7/5c70423e7c3acdbe8f892054ffe010c5.jpg" width="640"></a> <br><br>  Und hier ist ein Schal mit einem Watchdog-Mikrokreislauf, der im Darm meiner Kreation direkt √ºber dem RS-485-TTL-Pegelwandler gesch√ºtzt ist: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/73d/e5b/318/73de5b318ba3e6299168d634cdbaefe2.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/798/c40/61f/798c4061fa2167591312ff1d40adf5a4.jpg" width="640"></a> <br><br>  Die gesamte Struktur ist zusammenklappbar, alles kann ohne L√∂ten entfernt, getrennt und ersetzt werden, mit Ausnahme eines Schals mit Hundeh√ºtte, der an die Stifte des Steckverbinders gel√∂tet ist und mit einer Reihe von E / A-Anschl√ºssen von Arduina versehen ist. <br><br>  In der Box: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/c0b/918/cd8/c0b918cd83cbf30b11bc6b47e150b60f.jpg" width="640"></a> <br><br>  Ich habe √ñffnungen f√ºr Arduinas Stecker in die Plastikwand des Geh√§uses geschnitten.  Zuerst habe ich die L√∂cher genau entsprechend der Gr√∂√üe der Steckverbinder gemacht, aber die Montage in das Geh√§use muss diagonal gestartet werden (sonst funktioniert es einfach nicht) und die Steckverbinder gingen nicht durch, ich musste ein wenig verschwenden: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/7a1/5bd/21c/7a15bd21c6767e24b78a867b95952606.jpg" width="640"></a> <br><br>  Beim Einschalten des fertigen Produkts auf dem Tisch funktionierte alles sofort: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/262/a25/4f6/262a254f611519e81f429b00b2440758.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/4ff/cb6/10c/4ffcb610c648d20fe7c386f821178ad9.jpg" width="640"></a> <br><br>  Auf der Frontplatte gebracht: <br><br><ul><li>  Vier rote LEDs - Lastanzeige; </li><li>  Zwei gr√ºne - Kommunikation mit dem Z√§hler und mit dem VPN-Server; </li><li>  Zwei gelbe sind frei; </li><li>  Ein Gelb - Anzeige eines Neustarts des Routers; </li><li>  Ein Rot ist Ern√§hrung; </li><li>  Und eine Reset-Taste. </li></ul><br>  Um 5 Volt aus 220 herauszuholen, habe ich ein Dinerey-Netzteil mit Ausgangspegeleinstellung verwendet. Der Strom wurde direkt an den Mikrocontroller geliefert, wobei der Eingangswandler von 7-12 auf 5 Volt umgangen wurde.  Dies war aus mehreren Gr√ºnden praktisch.  Erstens war die Leistung des eingebauten Wandlers irgendwann nicht mehr ausreichend, der Strom dort ist begrenzt.  Zweitens war es weiterhin notwendig, das Relais mit 5 Volt zu versorgen.  Drittens ist der Armaturenbrett ein praktischer Dinrek-Formfaktor in Bezug auf die Installation.  Deshalb hier: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/801/0f7/aad/8010f7aad941e5f4619553fe7433c58e.jpg" width="640"></a> <br><br><br>  <b>Test</b> <b><br></b> <br>  Alles wurde auf den Tisch gedreht, alles funktionierte wie es sollte, es war Zeit, den Controller im Schild zu installieren und ihn im Kampfmodus zu √ºberpr√ºfen. <br><br>  Aber zuerst habe ich alles ‚Äûam Rotz‚Äú angeschlossen und buchst√§blich den ganzen Kutteln in eine andere Abschirmung mit geringem Strom geschoben, um die Temperatursensoren unter realen Bedingungen auf langen Leitungen zu testen, die in einem Kabelkanal mit ~ 220-V-Stromkabeln verlegt sind: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/d3c/3a8/b45/d3c3a8b45a90075449e23e24f4ae37e7.jpg" width="640"></a> <br><br>  Wie Sie auf dem Foto oben sehen k√∂nnen, habe ich bisher versucht, den Neustart des Routers √ºber die ‚Äûintelligente‚Äú Senseit-Buchse mit Strom zu steuern.  Dieses Ger√§t mit wahnsinnigen Kosten von 5.000 (f√ºr 2016) erwies sich jedoch als extrem fehlerhaft und launisch.  W√§hrend des Nutzungsjahres war ich wiederholt gezwungen, zu ung√ºnstigen Zeiten ungeplant in der H√ºtte anzukommen, um dieses Wunder des technischen und Marketing-Denkens manuell von einem tiefen Nachteil in Bezug auf die GSM-Kommunikation zu entfernen.  Mit dem √úbergang zu meinem Arduino-Controller, der sich als zuverl√§ssiger als ein Beispiel herausstellte, war ich erleichtert, diesen ‚Äûprofessionellen‚Äú M√ºll in eine sch√∂ne Schachtel in einer Schachtel zu werfen und ihn zu vergessen. <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/efa/f91/91b/efaf9191b1dffa362e86e302d4858d34.jpg" width="640"></a> <br><br>  Der Test war erfolgreich, es gab keine Fehler und es war m√∂glich, an einem regul√§ren Ort mit der endg√ºltigen Installation fortzufahren: <br><br> <a href=""><img height="640" src="https://habrastorage.org/getpro/habr/post_images/887/ac8/320/887ac8320dca67597c4f979806e22b93.jpg" width="472"></a> <br><br>  Ja, dies ist der Schild ABB TwinLine 800x300x225 IP55 im Wert von 25 Tausend Rubel.  ohne zu f√ºllen (und f√ºr weitere 15 Tausend ungef√§hr f√ºllen).  Und ja, es ist in einem 6x2 Wechselhaus installiert.  Jeder hat seine eigenen Kakerlaken.  Ja, ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die gesamte Elektrik selbst gesammelt</a> .  Und er hat auch eine Umkleidekabine gebaut, ja.  Nein, ich bin kein Elektriker.  Und kein Baumeister. <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/4d4/c1b/3e5/4d4c1b3e5710dfb4a87299bb1f55fbfd.jpg" width="640"></a> <br><br>  In den Tiefen des Schildes habe ich eine kleine unterbrechungsfreie Stromversorgung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Powercom WOW 300 gefunden</a> , dort leuchtet die gr√ºne LED und links und dar√ºber - der Eingangsstecker: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/b6a/991/299/b6a991299668084c3ae8265d064e1910.jpg" width="640"></a> <br><br>  Die Akkulaufzeit des Arduino-Ger√§ts, eines Routers mit USB-Modem und WLAN sowie Full-HD-IP-√úberwachungskameras betr√§gt ca. 40 Minuten. <br><br>  Und hier sehen Sie die wei√üen Netzstecker von zwei unterbrechungsfreien Verbrauchern - dem Arduino-Netzteil und dem Niedrigstromschild, auf dem sich der Router und das Netzteil f√ºr die Au√üen√ºberwachungskamera befinden.  Diese Leitung f√ºhrt zu einer Unterbrechung des von Arduino gesteuerten Sch√ºtzes, nur f√ºr denselben Software-Watchdog, der den Router im Falle eines VPN-Ausfalls mit Strom neu startet (die Kamera wird gleichzeitig neu gestartet, obwohl sie ihn nicht ben√∂tigt).  Die oberen Linien der verdrillten Paare von Temperatursensoren sind mit der Steuerung verbunden: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/0b8/fd7/50b/0b8fd750b2a17afd69eb55b6d56bf709.jpg" width="640"></a> <br><br>  Ich muss sagen, dass ich dem Umschalten einer starken Last auf kleine blaue chinesische Relais trotz der Parameter dieser Relais, die dies zu erm√∂glichen scheinen, niemals vertrauen w√ºrde.  Daher wurde sofort die Verwendung normaler modularer Sch√ºtze <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Legrand Kat. Nr. 4 125 01</a> mit der M√∂glichkeit der manuellen Steuerung festgelegt.  Das hei√üt, die Relais im Steuerk√∂rper steuern die Sch√ºtze, und die Sch√ºtze steuern bereits die Last.  Es ist zuverl√§ssig.  Die Stromversorgung des Routers und der Kamera erfolgt jedoch nur √ºber dieses kleine blaue chinesische Relais, der Strom dort ist gering, so dass es m√∂glich ist. <br><br>  Beim ersten Kampfstart war ich sehr entt√§uscht.  Auf dem Tisch habe ich alles au√üer der Last erlebt.  Warum?  Sch√ºtze klicken und es ist klar, dass sie die Last wechseln werden.  Aber nein, es war notwendig zu erleben.  Leistungsstarke Elektrokonvektoren f√ºhrten zum Zeitpunkt des √ñffnens der Kontakte zu St√∂rungen im System, was zu einem garantierten Einfrieren der Internetabschirmung f√ºhrte.  Und um ihn aus dem Abstieg herauszuholen, war nur durch Entfernen der Stromversorgung m√∂glich, ein einfaches Zur√ºcksetzen half nicht.  Googelte - ja, dieser Chinese hat so ein Problem.  Und die Bibliothek geht mit dieser Situation nicht um.  Das hei√üt, das St√ºck Eisen ist schlecht und die Software ist nicht sehr gut. <br><br>  Ich dachte schon, dass alles weg ist.  Ich habe sogar Halbleiterrelais bestellt, aber sie sind gr√∂√üer und passen nicht in mein Design.  Aber dann dachte ich, dass es immer noch m√∂glich sein k√∂nnte, die St√∂rung zu unterdr√ºcken.  Wieder gegoogelt, fanden spezielle Rauschunterdr√ºckungskondensatoren (die sogenannten Kondensatoren vom Typ X).  Schlie√üen Sie sie einfach parallel zur Steuerwicklung der Sch√ºtze an, und siehe da!  Aufh√§ngevorg√§nge verschwanden vollst√§ndig.  Im vergangenen Betriebsjahr wurde kein einziger Fall registriert: <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/7ae/198/80c/7ae19880c09be755c8421266a4ba29df.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/c25/e89/cb2/c25e89cb2e1f8ed607f736bfdfc0cd20.jpg" width="640"></a> <br><br> <a href=""><img height="640" src="https://habrastorage.org/getpro/habr/post_images/6b8/a25/f65/6b8a25f65c6f9de23a3b1ad57a91f97d.jpg" width="472"></a> <br><br>  Aber auf diese Weise k√∂nnen Sie in die Box schauen: <br><br> <a href=""><img height="480" src="https://habrastorage.org/getpro/habr/post_images/776/7c3/7c9/7767c37c908537a36b5bd763a39fc7bc.jpg" width="640"></a> <br><br> <a href=""><img height="640" src="https://habrastorage.org/getpro/habr/post_images/827/6fa/818/8276fa8186818314c5b4ce8516ef6f04.jpg" width="480"></a> <br><br>  Nun, die fertige Ansicht des Visiers mit dem Plastron (im Kit waren keine Stopfen enthalten): <br><br> <a href=""><img height="640" src="https://habrastorage.org/getpro/habr/post_images/e4c/231/5ac/e4c2315ac67af993ed83151f58896e85.jpg" width="472"></a> <br><br>  Zum Debuggen und Blinken wird das USB-Kabel an den Controller angeschlossen und im Schild hinter einer geschlossenen T√ºr aufbewahrt (es wird vor√ºbergehend nicht mit diesem Foto verbunden): <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/e51/1ce/92d/e511ce92de3e8e090aa842ff540034d6.jpg" width="640"></a> <br><br> <a href=""><img height="472" src="https://habrastorage.org/getpro/habr/post_images/8fa/202/f5a/8fa202f5abf1eeb6bbca9192dc82c719.jpg" width="640"></a> <br><br>  Das System arbeitet seit fast einem Jahr und hat Fr√∂ste bis zu 20 Grad problemlos √ºberstanden. <br><br>  Generell bin ich mit dem Ergebnis zufrieden.  F√ºr mehr oder weniger funktionale Aufgaben ist Arduino jedoch eindeutig schwach.  Mehr als einmal ging mir der Speicher aus und ich musste schneiden und optimieren.  Und die Arbeitsgeschwindigkeit, insbesondere mit einer Speicherkarte, passt mir √ºberhaupt nicht.  Daher m√∂chte ich bei den zuk√ºnftigen Implementierungen solcher Handwerke, wenn √ºberhaupt, auf etwas St√§rkerem aufbauen.  Kollegen geben mir einen Raspberry Pi, eine gute Option, denke ich. <br><br>  Jemand k√∂nnte sagen: ‚ÄûWie viele Schwierigkeiten gibt es f√ºr eine solch primitive Aufgabe?‚Äú Und wird wahrscheinlich richtig sein.  F√ºr mich ist dieses ganze Unternehmen ein Hobby mit wenig Rechtfertigung f√ºr die Bedeutung.  Deshalb suchte ich Unterhaltung in allem, wo ich konnte :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de411141/">https://habr.com/ru/post/de411141/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de411131/index.html">Der erste Wettbewerb in Unterwasserrobotik f√ºr Sch√ºler der Klassen 1-4</a></li>
<li><a href="../de411133/index.html">Roboterspielzeug f√ºr Kinder: zum Lernen und zur Unterhaltung</a></li>
<li><a href="../de411135/index.html">Parameter</a></li>
<li><a href="../de411137/index.html">VTC - Satellitenkommunikationszentrum (Wladiwostok)</a></li>
<li><a href="../de411139/index.html">Das R√§tsel um die Neutronenlebensdauer wird komplizierter und dunkle Materie ist immer noch nicht sichtbar</a></li>
<li><a href="../de411143/index.html">Programmierung moderner Mikrocontroller: Vorlesung 1</a></li>
<li><a href="../de411145/index.html">Meine kleinen Relais: Brainfuck Computer ist Realit√§t</a></li>
<li><a href="../de411147/index.html">Riesige Flecken von Riesenplaneten</a></li>
<li><a href="../de411149/index.html">TRIZ-Prognose dezentraler Systeme und der cyber-physischen Gesellschaft von 2035</a></li>
<li><a href="../de411151/index.html">iMX6ULL. √úbergang zu Prozessormodulen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>