<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП╗тАНЁЯдЭтАНЁЯСиЁЯП╛ ЁЯСйЁЯП╗тАНЁЯОд ЁЯЪм 2 рдбреА рдЯрдХрд░рд╛рд╡ рдХреА рдЧрдгрдирд╛: рдЧрд┐рд▓реНрдмрд░реНрдЯ-рдЬреЙрдирд╕рди-рдХреАрд░реНрддрд┐ рдПрд▓реНрдЧреЛрд░рд┐рджрдо ЁЯТЩ ЁЯЩЛЁЯП╝ ЁЯМея╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдореИрдВрдиреЗ рдЯрдХреНрдХрд░ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛, рдФрд░ рдЗрд╕рдиреЗ рдореБрдЭреЗ рдЧрд┐рд▓реНрдмрд░реНрдЯ-рдЬреЙрдирд╕рди-рдХреАрд░реНрдереА (GJK) рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рддрдХ рдкрд╣реБрдБрдЪрд╛рдпрд╛ред 

 рдкреЛрд╕реНрдЯ рдХреЗ рд╕рднреА рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдЯрд╛рдЗрдкрд╕реНрдХреНрд░рд┐...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>2 рдбреА рдЯрдХрд░рд╛рд╡ рдХреА рдЧрдгрдирд╛: рдЧрд┐рд▓реНрдмрд░реНрдЯ-рдЬреЙрдирд╕рди-рдХреАрд░реНрддрд┐ рдПрд▓реНрдЧреЛрд░рд┐рджрдо</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472404/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d92/837/791/d92837791f7e383147effd9265b24f91.png" alt="рдЫрд╡рд┐"></div><br>  рдореИрдВрдиреЗ рдЯрдХреНрдХрд░ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛, рдФрд░ рдЗрд╕рдиреЗ рдореБрдЭреЗ рдЧрд┐рд▓реНрдмрд░реНрдЯ-рдЬреЙрдирд╕рди-рдХреАрд░реНрдереА (GJK) рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рддрдХ рдкрд╣реБрдБрдЪрд╛рдпрд╛ред <br><br>  рдкреЛрд╕реНрдЯ рдХреЗ рд╕рднреА рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдЯрд╛рдЗрдкрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдореИрдВ рдмрдирд╛рдИ рдЧрдИ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИрдВред  рд╡реЗ рд╕рд░рд▓ рд╣реИрдВ рдФрд░ GitHub рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рджреЗрдЦреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><ul><li><code>Vector</code> </li> <li> <code>IShape</code> </li> <li> <code>Collision</code> </li> </ul><br>  рдкреЛрд╕реНрдЯ рд╕реЗ рд╕рднреА рдХреЛрдб GitHub рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВ: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/jthomperoo/gjk-ts-implementation</a> <br><br>  рдкреЛрд╕реНрдЯ рдХреЛ рдЗрд╕ рд▓реЗрдЦ рдФрд░ рдЙрд╕рдореЗрдВ рд╕реБрдЭрд╛рдП рдЧрдП рд╡реАрдбрд┐рдпреЛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http://www.dyn4j.org/2010/04/gjk-gilbert-johnson-keerthi/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">http://mollyrocket.com/849</a> </li></ul><br><h2>  рдкрд░рд┐рдЪрдп </h2><br>  рдЬреАрдЬреЗрдХреЗ рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣реИ рдЬрд┐рд╕реЗ рджреЛ рдЙрддреНрддрд▓ рдЖрдХреГрддрд┐рдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐рдЪреНрдЫреЗрджрди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд "рд╕рд╣рд╛рдпрдХ рдлрд╝рдВрдХреНрд╢рди" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд░рд▓ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ - рдЙрд╕реА рддрд░рд╣, рдЖрдк рдмрд╣реБрднреБрдЬ рдФрд░ рдЖрдХреГрддрд┐рдпреЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджреАрд░реНрдШрд╡реГрддреНрддред <br><a name="habracut"></a><br><h2>  рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдирдХрд╛рд░реА </h2><br><h3>  рдорд┐рдиреНрдХреЛрд╡рд╕реНрдХреА рдпреЛрдЧ </h3><br>  рдЬреАрдЬреЗрдХреЗ рдПрдХ рдЕрд╡рдзрд╛рд░рдгрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдорд┐рдВрдХреЛрд╡рд╕реНрдХреА рдпреЛрдЧ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдПрд╕рдПрдо рдХреА рдЧрдгрдирд╛ рджреЛ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рд╕рднреА рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдХреА рдЬрд╛рддреА рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рджреЛ рдЖрдВрдХрдбрд╝реЗ рд▓реЗрдВ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/714/175/459/714175459fab7824d38f46a68b1b736d.png"></div><br>  <strong>рдЪрд┐рддреНрд░ A (рд╣рд░рд╛):</strong> <br><br><div class="scrollable-table"><table><thead><tr><th>  рдПрдХ </th><th>  рдмреА </th><th>  рд╕реА </th></tr></thead><tbody><tr><td>  (0.1) </td><td>  (1, -1) </td><td>  (-1, -1) </td></tr></tbody></table></div><br>  <strong>рдЪрд┐рддреНрд░рд╛ рдмреА (рдмреИрдВрдЧрдиреА):</strong> <br><br><div class="scrollable-table"><table><thead><tr><th>  рдбреА </th><th>  рдП </th><th>  рдПрдл </th></tr></thead><tbody><tr><td>  (0, -1) </td><td>  (1,1) </td><td>  (-1.1) </td></tr></tbody></table></div><br>  рдЖрдХреГрддрд┐ A рдФрд░ рдЖрдХреГрддрд┐ B рдХреЗ рдорд╛рди рд▓реЗрддреЗ рд╣реБрдП, рд╣рдо Minkowski рд░рд╛рд╢рд┐ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br> <code>A + D = (0,1) + (0,-1) = (0,0) <br> <br> A + E = (0,1) + (1,1) = (1,2) <br> <br> A + F = (0,1) + (-1,1) = (-1,2) <br> <br> B + D = (1,-1) + (0,-1) = (1,-2) <br> <br> B + E = (1,-1) + (1,1) = (2,0) <br> <br> B + F = (1,-1) + (-1,1) = (0,0) <br> <br> C + D = (-1,-1) + (0,-1) = (-1,-2) <br> <br> C + E = (-1,-1) + (1,1) = (0,0) <br> <br> C + F = (-1,-1) + (-1,1) = (-2,0)</code> <br> <br>  рдпрджрд┐ рд╣рдо рдЗрди рдореВрд▓реНрдпреЛрдВ рдХреЛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирд╕реЗ рдПрдХ рдЧреНрд░рд╛рдл рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреМрди рд╕рд╛ рдЖрдВрдХрдбрд╝рд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛ред <br><br>  <strong>рдЖрдВрдХрдбрд╝реЗ рдП рдФрд░ рдмреА рдХреЗ рд▓рд┐рдП рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдпреЛрдЧ:</strong> <br><br>  <em>рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рддрд╛рд▓рд┐рдХрд╛ рдФрд░ рдЧреНрд░рд╛рдлрд╝ рдореЗрдВ AD A + D рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e40/64c/260/e4064c260487a98fb29c87fa43682ec5.png" alt="рдЖрдХреГрддрд┐ рдП рдФрд░ рдмреА рдХреЗ рдорд┐рдВрдХреЛрд╡рд╕реНрдХреА рдпреЛрдЧ рдХрд╛ рдЪрд╛рд░реНрдЯ"></div><br><div class="scrollable-table"><table><thead><tr><th>  рдИ </th><th>  рдПрдИ </th><th>  рд╡рд╛рдпреБрд╕реЗрдирд╛ </th><th>  BD </th><th>  BE </th><th>  рдмреАрдПрдл </th><th>  рд╕реАрдбреА </th><th>  рд╕реАрдИ </th><th>  рд╕реАрдПрдл </th></tr></thead><tbody><tr><td>  (0,0) </td><td>  (1.2) </td><td>  (-1.2) </td><td>  (1, -2) </td><td>  (2.0) </td><td>  (0,0) </td><td>  (-1, -2) </td><td>  (0,0) </td><td>  (-2.0) </td></tr></tbody></table></div><br>  рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рд░рд╛рд╢рд┐ рдХреЛ рдмреЗрд╣рддрд░ рдврдВрдЧ рд╕реЗ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдПрдХ рдЖрдХреГрддрд┐ рдП рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдмреА рдХреА рд░реВрдкрд░реЗрдЦрд╛ рдХреЗ рд╕рд╛рде рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдкрд░рд┐рдгрд╛рдореА рдЖрдХреГрддрд┐ рдорд┐рдиреНрдХреЛрд╡рд╕реНрдХреА рдпреЛрдЧ рд╣реЛрдЧреАред <br><br><h3>  рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдЕрдВрддрд░ </h3><br>  GJK Minkowski рд░рд╛рд╢рд┐ рдХрд╛ рднрд┐рдиреНрдирддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ A + B рдирд╣реАрдВ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди A - B. рдореЗрд░реЗ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝реЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ, рдЗрд╕реЗ "Minkowski рдЕрдВрддрд░" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдорд┐рдиреНрдХреЛрд╡рд╕реНрдХреА рдЕрдВрддрд░ рдореЗрдВ рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╕рдВрдкрддреНрддрд┐ рд╣реИ: рдпрджрд┐ рджреЛ рдЖрдВрдХрдбрд╝реЗ рдУрд╡рд░рд▓реИрдк / рдЗрдВрдЯрд░рд╕реЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдорд┐рдиреНрдХреЛрд╡рд╕реНрдХреА рдЕрдВрддрд░ рдореЗрдВ рдореВрд▓ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ред  рдФрд░ рдпрд╣ GJK рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЖрдзрд╛рд░ рд╣реИред <br><br>  рдЖрдВрдХрдбрд╝реЗ рдП рдФрд░ рдмреА рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рд▓реЗрддреЗ рд╣реБрдП, рд╣рдо рдорд┐рдВрдХреЛрд╡рд╕реНрдХреА рдЕрдВрддрд░ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br> <code>A - D = (0,1) - (0,-1) = (0,2) <br> <br> A - E = (0,1) - (1,1) = (-1,0) <br> <br> A - F = (0,1) - (-1,1) = (1,0) <br> <br> B - D = (1,-1) - (0,-1) = (-1,0) <br> <br> B - E = (1,-1) - (1,1) = (0,-2) <br> <br> B - F = (1,-1) - (-1,1) = (2,-2) <br> <br> C - D = (-1,-1) - (0,-1) = (-1,0) <br> <br> C - E = (-1,-1) - (1,1) = (-2,-2) <br> <br> C - F = (-1,-1) - (-1,1) = (0,-2)</code> <br> <br>  рдпрджрд┐ рд╣рдо рдЗрди рдореВрд▓реНрдпреЛрдВ рдХреЛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЧреНрд░рд╛рдл рдкрд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкрд░рд┐рдгрд╛рдореА рдЖрдХреГрддрд┐ рджреЗрдЦреЗрдВрдЧреЗред <br><br>  <strong>рдЖрдВрдХрдбрд╝реЗ рдП рдФрд░ рдмреА рдХреЗ рд▓рд┐рдП рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдЕрдВрддрд░:</strong> <br><br>  <em>рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ AD рдФрд░ рдЧреНрд░рд╛рдл A - D рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b0f/141/a87/b0f141a87c0f42c4c1f64956a8458082.png" alt="рдЖрдХреГрддрд┐ рдП рдФрд░ рдмреА рдХреЗ рдорд┐рдВрдХреЛрд╡рд╕реНрдХреА рдпреЛрдЧ рдХрд╛ рдЪрд╛рд░реНрдЯ"></div><br><div class="scrollable-table"><table><thead><tr><th>  рдИ </th><th>  рдПрдИ </th><th>  рд╡рд╛рдпреБрд╕реЗрдирд╛ </th><th>  BD </th><th>  BE </th><th>  рдмреАрдПрдл </th><th>  рд╕реАрдбреА </th><th>  рд╕реАрдИ </th><th>  рд╕реАрдПрдл </th></tr></thead><tbody><tr><td>  (0.2) </td><td>  (-1.0) </td><td>  (1.0) </td><td>  (-1.0) </td><td>  (0, -2) </td><td>  (2, -2) </td><td>  (-1.0) </td><td>  (-2, -2) </td><td>  (0, -2) </td></tr></tbody></table></div><br><h2>  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо </h2><br>  рдЗрди рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, GJK рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЙрдирдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рддрд╛ рд╣реИред  Minkowski рд░рд╛рд╢рд┐ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдЖрдк рдХрдИ рдмрд┐рдВрджреБрдУрдВ рд╕реЗ рдпреБрдХреНрдд рджреЛ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рдкреНрд░рддрд┐рдЪреНрдЫреЗрджрди рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, GJK рджреЛ рдкреНрд░рдореБрдЦ рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рдФрд░ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ред <br><br><h3>  рд╣реЗрд▓реНрдкрд░ рдХрд╛рд░реНрдп </h3><br>  рд╕рд╣рд╛рдпрдХ рдХрд╛рд░реНрдп рдкреВрд░реЗ рдЖрдВрдХрдбрд╝реЗ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд┐рдП рдмрд┐рдирд╛ рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдЕрдВрддрд░ рдХреЗ рдХрд┐рдирд╛рд░реЗ рдкрд░ рдПрдХ рдмрд┐рдВрджреБ рдХрд╛ рдирдореВрдирд╛ рд▓реЗрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред  рд╣реЗрд▓реНрдкрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рджреЛ рддреБрд▓рдирд╛рддреНрдордХ рдЖрдВрдХрдбрд╝реЗ рдорд┐рд▓рддреЗ рд╣реИрдВ, рдФрд░ рдЬрд┐рд╕ рджрд┐рд╢рд╛ рдХреЛ рдЬрд╛рдВрдЪрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рддрдм рд╕рд╣рд╛рдпрдХ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рддреНрдпреЗрдХ рдЖрдХреГрддрд┐ рд╕реЗ рджреЛ рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛рдУрдВ рд╕реЗ рдПрдХ рдмрд┐рдВрджреБ рджреВрд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рдЗрди рджреЛ рд╕рдмрд╕реЗ рджреВрд░ рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдЕрдВрддрд░ рдХреЗ рдЖрдВрдХрдбрд╝реЗ рдкрд░ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдо рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛рдУрдВ рд╕реЗ рдЕрдВрдХ рд▓реЗрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдорд┐рдВрдХреЛрд╡рд╕реНрдХреА рдЕрдВрддрд░ рдкрд░ рдПрдХ рдмрд┐рдВрджреБ рдорд┐рд▓рддрд╛ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рдХреНрд╖реЗрддреНрд░ рджреЗрдЧрд╛, рдЕрд░реНрдерд╛рддреН, рдПрдХ рдЙрдЪреНрдЪ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрдЧреА рдХрд┐ рд╣рдо рдЖрдВрдХрдбрд╝реЗ рдореЗрдВ рдореВрд▓ рдХреЛ рдШреЗрд░ рд▓реЗрдВрдЧреЗред  рдЪреВрдБрдХрд┐ Minkowski рдЕрдВрддрд░ <code>    a -     b</code> , рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛ рд╕реЗ рдкреНрд░рддрд┐рд░реВрдкрд┐рдд b рдХрд╛ рдмрд┐рдВрджреБ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рд╣рдореЗрдВ рдПрдХ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рджреЗрдЧрд╛ рдЬреЛ рдЗрд╕ рджрд┐рд╢рд╛ рдореЗрдВ рдпрдерд╛рд╕рдВрднрд╡ рджреВрд░ рд╣реИред <br><br>  рд╣реЗрд▓реНрдкрд░ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> support(a: IShape, b: IShape, direction: Vector): Vector { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> aFar = a.FarthestPointInDirection(direction); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bFar = b.FarthestPointInDirection(direction.Invert()); return aFar.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(bFar); }</code> </pre> <br>  GJK рдХреЗ рдлрд╛рдпрджреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдпрд╣ рд╣реИ рдХрд┐ <code>FarthestPointInDirection</code> рдХреЛ рдПрдмреНрд╕реНрдЯреНрд░реИрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдкреЙрд▓реАрдЧреЙрди рдФрд░ рдХрд░реНрд╡реНрд╕ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣рд╛рдБ рдмрд╣реБрднреБрдЬ рдХреЗ рд▓рд┐рдП <code>FarthestPointInDirection</code> рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╣реИред <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Polygon implements IShape { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> points: Vector[]; ... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> FarthestPointInDirection(direction: Vector): Vector { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> farthestDistance = -Infinity; // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> there are no points, just return point <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> farthestPoint: Vector = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> point of this.points) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> distanceInDirection = point.Dot(direction); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distanceInDirection &gt; farthestDistance) { farthestPoint = point; farthestDistance = distanceInDirection; } } return farthestPoint; } }</code> </pre> <br>  рдпрджрд┐ рдЖрдк рдпрд╣ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЕрдиреНрдп рдЖрдХреГрддрд┐рдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рддреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЗ Git рднрдВрдбрд╛рд░ рдХреЛ рджреЗрдЦреЗрдВ</a> , рдЬреЛ <code>Circle</code> рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗрддрд╛ рд╣реИред <br><br>  рдпрд╣рд╛рдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдП (рдмреА <strong>)</strong> рджрд┐рд╢рд╛ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ <strong>(</strong> рдП) рдФрд░ рдмреА рдХреЗ рдЖрдВрдХрдбрд╝реЛрдВ рдХреА рдЧрдгрдирд╛ рдХреИрд╕реЗ рдХреА рдЬрд╛рдПрдЧреА: <br><br><ol><li>  рдЖрдХреГрддрд┐ рдП рд╕реЗ рд╕рдмрд╕реЗ рджреВрд░ рдмрд┐рдВрджреБ рд▓реЗ рд▓реЛ;  рдпрд╣ рдмрд┐рдВрджреБ <strong>рдмреА (1, -1)</strong> рдирд┐рдХрд▓рд╛ред  (рдЖрдк рдЗрд╕рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд░рддрд╛ рд╣реИ, рдпрд╛ рдмрд╕ рдЗрд╕реЗ рдЧреНрд░рд╛рдл рдХреЛ рджреЗрдЦрдХрд░ рджреЗрдЦреЗрдВ)ред </li><li>  рдЖрдХреГрддрд┐ рдмреА рд╕реЗ рд╕рдмрд╕реЗ рджреВрд░ рдмрд┐рдВрджреБ рд▓реЗ рд▓реЛ;  рдпрд╣ рдмрд┐рдВрджреБ <strong>F (-1, 1)</strong> рдирд┐рдХрд▓рд╛ред </li><li>  <strong>рдмреА - рдПрдл рдХреА</strong> рдЧрдгрдирд╛ рдХрд░реЗрдВ;  рдпрд╣ рдмрд┐рдВрджреБ <strong>рдмреАрдПрдл (2, -2)</strong> рдирд┐рдХрд▓рд╛ - рдпрд╣ <strong>рд╕рд╣рд╛рдпрдХ</strong> рд╣реЛрдЧрд╛ред </li></ol><br><h3>  simplices </h3><br>  рдПрдХ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕, рдорд┐рдВрдХреЛрд╡реНрд╕реНрдХреА рдЕрдВрддрд░ рдЖрдХреГрддрд┐ рдХреЗ рд╕рд╛рде рдЕрдВрдХреЛрдВ рдХрд╛ рдПрдХ рдирдореВрдирд╛ рд╣реИред  рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рддреАрди рдмрд┐рдВрджреБ рддрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред  GJK рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдПрдХ рдЯрдХреНрдХрд░ рдХреА рдШрдЯрдирд╛ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореВрд▓ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдПрдХ рддреНрд░рд┐рдХреЛрдг рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИред <br><br><h4>  рд╕рд┐рдВрдкреНрд▓реЗрдХреНрд╕ рдирд┐рд░реНрдорд╛рдг </h4><br>  рд╕рд┐рдореНрдкрд▓реЗрдХреНрд╕ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╡рд┐рднрд┐рдиреНрди рджрд┐рд╢рд╛рдУрдВ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдкреБрдирд░рд╛рд╡реГрддрд┐ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреЛ рдПрдХ рдирдИ рджрд┐рд╢рд╛ рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рддрд╛рдХрд┐ рд╣рдо рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рдПрдХ рдореВрд▓ рдмрд┐рдВрджреБ рд╡рд╛рд▓реЗ рдПрдХ рд╕рд┐рдВрдкреНрд▓реЗрдХреНрд╕ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд╕рдХреЗрдВред  рдХрдард┐рдирд╛рдИ рдЙрд╕ рджрд┐рд╢рд╛ рдХреЛ рдЪреБрдирдиреЗ рдореЗрдВ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдЧрд▓рд╛ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реИред <br><br><h3>  рдЯрдХрд░рд╛рд╡ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рджрд┐рд╢рд╛ рдЪрдпрди </h3><br>  рдореВрд▓ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдмрд╕ рдПрдХ рд╕рд╣рд╛рдпрдХ рдлрд╝рдВрдХреНрд╢рди рдХреА рд╕рд╣рд╛рдпрддрд╛ рд╕реЗ рдПрдХ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдмрдирд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрдВрдХрдбрд╝реЗ рдореЗрдВ рдореВрд▓ рдХреЗ рдмрд┐рдВрджреБ рдХреЛ рдШреЗрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдпрд╣ рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧрдгрдирд╛ рдХрд┐рдП рдЧрдП рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдореВрд▓ рддрдХ рдкрд╣реБрдБрдЪрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рдЬрд╛рдБрдЪрдиреЗ рд╕реЗ рдХреЛрдИ рдЯрдХрд░рд╛рд╡ / рдЪреМрд░рд╛рд╣рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдореВрд▓ Minkowski рдЕрдВрддрд░ рдХреЗ рдмрд╛рд╣рд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП;  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреЛрдИ рдЯрдХреНрдХрд░ / рдЪреМрд░рд╛рд╣рд╛ рдирд╣реАрдВ рд╣реИред <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Calculate(a: IShape, b: IShape): Collision | undefined { // Build a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Simplex <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> determining <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a collision has occurred <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> simplex = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Simplex(); // Choose an arbitrary starting direction <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> direction: Vector | undefined = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the first support point <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> add it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initSupportPoint = support(a, b, direction); simplex.Add(initSupportPoint); // Flip the direction <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> support point direction = direction.Invert(); // Keep iterating until the direction <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> undefined, this will occur when // <span class="hljs-comment"><span class="hljs-comment">'CalculateDirection' doesn't return a direction, indicating that an // intersection has been detected while(direction) { const supportPoint = support(a, b, direction); // If the support point did not reach as far as the origin, // the simplex must not contain the origin and therefore there is no // intersection if (supportPoint.Dot(direction!) &lt;= 0) { // No intersection return; } // Add the simplex and determine a new direction simplex.Add(supportPoint); direction = simplex.CalculateDirection(); } // No direction calculated, intersection detected return new Collision(a, b); }</span></span></code> </pre> <br>  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреА рд╕рднреА рдЬрдЯрд┐рд▓рддрд╛ рдФрд░ рдЖрдВрддрд░рд┐рдХ рдСрдкрд░реЗрд╢рди <code>simplex.CalculateDirection</code> ред <code>simplex.CalculateDirection</code> ред  рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдореВрд▓ рд╡рд░реНрддрдорд╛рди рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рд╣реИ - рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдпрд╣ <code>undefined</code> рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛;  рдЕрдиреНрдпрдерд╛, рдпрд╣ рдПрдХ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдИ рджрд┐рд╢рд╛ рд▓реМрдЯрд╛рдПрдЧрд╛, рдЬрд┐рд╕реЗ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Simplex { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> points: Vector[]; ... CalculateDirection(): Vector | undefined { // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> a, the last point added <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = this.points[this.points.length - <span class="hljs-number"><span class="hljs-number">1</span></span>]; // Since a was just added, we know that the inverse of a points // towards the origin <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ao = a.Invert(); // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a triangle <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (this.points.length == <span class="hljs-number"><span class="hljs-number">3</span></span>) { // B <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the penultimate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex // C <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the oldest point <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = this.points[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c = this.points[<span class="hljs-number"><span class="hljs-number">0</span></span>]; // Determine a-&gt;b <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a-&gt;c lines <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ab = b.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ac = c.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a); // Determine perpendicular of the a-&gt;b line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> abPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ab.y, -ab.x); // Check the handedness of the perpendicular, it should // face AWAY from the simplex <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(c) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { abPerp = abPerp.Invert(); } // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the origin lies outside of the simplex remove the // point <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> determine a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> direction <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the direction // of the perpendicular; aiming <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> try <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> encapsulate // the origin that lies outside <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(ao) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { this.points.splice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); return abPerp; } // Determine perpendicular of the a-&gt;c line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> acPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ac.y, -ac.x); // Check the handedness of the perpendicular, it should // face AWAY from the simplex <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (acPerp.Dot(b) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { acPerp = acPerp.Invert(); } // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the origin lies outside of the simplex remove the // point <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> determine a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> direction <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the direction // of the perpendicular; aiming <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> try <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> encapsulate // the origin that lies outside <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (acPerp.Dot(ao) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { this.points.splice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); return acPerp; } return undefined; } // Otherwise the simplex <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> just a line // B <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the penultimate point <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex, // <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> the other <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> of the line <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = this.points[<span class="hljs-number"><span class="hljs-number">0</span></span>]; // Determine a -&gt; b line <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ab = b.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a); // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the perpendicular of the a-&gt;b line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> abPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ab.y, -ab.x); // Check the handedness of the perpendicular, it should // face TOWARDS the origin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(ao) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { abPerp = abPerp.Invert(); } return abPerp; } }</code> </pre> <br>  рдЖрдк рдЖрд╢реНрдЪрд░реНрдпрдЪрдХрд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ: рд╣рдо рдмреАрд╕реА рдЦрдВрдб рдХреА рдЬрд╛рдВрдЪ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ?  рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдмрд┐рдирд╛ рд╢рд░реНрдд рдмрд╛рд╣рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдореВрд▓ рдЗрд╕рдХреЗ рд▓рдВрдмрд╡рдд рдХреЗ рд╕рд╛рде рд╣реИред  рдЪреВрдВрдХрд┐ рдЕрдВрдХ рдмреА рдФрд░ рд╕реА рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд░рд▓ рд╣реИрдВ, рдФрд░ рдЙрдиреНрд╣реЗрдВ рди рдХреЗрд╡рд▓ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдкрд┐рдЫрд▓реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рдЬрд╛рдВрдЪрд╛ рдЧрдпрд╛ рдерд╛ред  рдЙрдиреНрд╣реЗрдВ рдпрд╛ рддреЛ рдПрдХ рддреНрд░рд┐рдХреЛрдг рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ рдПрдХ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рдкрд╣рд▓реЗ рджреЛ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рдПрдХ рдЦрдВрдб рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ - рдЗрд╕рд╕реЗ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдмреАрд╕реА рд╕реЗрдЧрдореЗрдВрдЯ рдХреА рдЬрд╛рдВрдЪ рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h4>  рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг </h4><br>  рд╣рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдХреЛрдб рдорд┐рд▓реЗ, рдФрд░ рдпрд╣ рднреНрд░рд╛рдордХ рд▓рдЧрддрд╛ рд╣реИред  рдиреАрдЪреЗ рдореИрдВ рдКрдкрд░ рджрд┐рдЦрд╛рдП рдЧрдП рдЖрдВрдХрдбрд╝реЛрдВ рдП рдФрд░ рдмреА рдХреЗ рд▓рд┐рдП рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдЪрд░рдгреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реВрдВрдЧрд╛ред <br><br>  <strong>рдЕрдВрдХ рдП рдФрд░ рдмреА рдХреЗ рдЕрдВрдХ:</strong> <br><br><div class="scrollable-table"><table><thead><tr><th>  рдПрдХ </th><th>  рдмреА </th><th>  рд╕реА </th><th>  рдбреА </th><th>  рдП </th><th>  рдПрдл </th></tr></thead><tbody><tr><td>  (0.1) </td><td>  (1, -1) </td><td>  (-1, -1) </td><td>  (0, -1) </td><td>  (1,1) </td><td>  (-1.1) </td></tr></tbody></table></div><br><ol><li>  рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рддреИрдпрд╛рд░реА;  рд╣рдо рдкреНрд░рд╛рд░рдВрднрд┐рдХ рджрд┐рд╢рд╛ рдХреЗ рд░реВрдк рдореЗрдВ <code>(0,1)</code> рд▓реЗрддреЗ рд╣реИрдВред <br><br><pre> <code class="vbscript hljs">// Build a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Simplex <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> determining <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a collision has occurred <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> simplex = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Simplex(); // Choose an arbitrary starting direction <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> direction: Vector | undefined = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br></li><li>  рд╣рдореЗрдВ рдкрд╣рд▓рд╛ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдорд┐рд▓рддрд╛ рд╣реИред <br><br><pre> <code class="vbscript hljs"> // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the first support point <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> add it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initSupportPoint = support(a, b, direction); simplex.Add(initSupportPoint); // Flip the direction <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> support point direction = direction.Invert();</code> </pre> <br>  рд╣рдо рдмрд┐рдВрджреБ A рд╕реЗ рджрд┐рд╢рд╛ <code>(0,1)</code> рдФрд░ рдмрд┐рдВрджреБ B рд╕реЗ рджрд┐рд╢рд╛ <code>(0,-1)</code> рдореЗрдВ рд╕рдмрд╕реЗ рджреВрд░ рдХрд╛ рдмрд┐рдВрджреБ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред <br><br>  <strong>aFar:</strong> <code>(0,1)</code> рдФрд░ <strong>bFar:</strong> <code>(0,-1)</code> <br><br>  рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрди рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br>  <strong>рд╕рдорд░реНрдерди:</strong> <em>aFar-bFar</em> = <code>(0,2)</code> <br><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> support(a: IShape, b: IShape, direction: Vector): Vector { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> aFar = a.FarthestPointInDirection(direction); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bFar = b.FarthestPointInDirection(direction.Invert()); return aFar.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(bFar); }</code> </pre> <br></li><li>  рд╣рдо рдЕрдЧрд▓реЗ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рджрд┐рд╢рд╛ рдлреНрд▓рд┐рдк рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдирдП рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реБрдП рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред <br><br>  <strong>рд╕рдорд░реНрдерди:</strong> <code>(0,-3)</code> <br><br><pre> <code class="vbscript hljs"> // Flip the direction <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> support point direction = direction.Invert(); // Keep iterating until the direction <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> undefined, this will occur when // <span class="hljs-comment"><span class="hljs-comment">'CalculateDirection' doesn't return a direction, indicating that an // intersection has been detected while(direction) { const supportPoint = support(a, b, direction);</span></span></code> </pre> </li><li>  рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдореВрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдЧрдпрд╛ рд╣реИ;  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдХреЛрдИ рдЪреМрд░рд╛рд╣рд╛ рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрджрд┐ рд╡рд╣ рдореВрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдЧрдИ, рддреЛ рдмрд┐рдВрджреБ рдХреЛ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред <br><br>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдореВрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдЧрдпрд╛ рд╣реИред <br><br>  <strong>рджрд┐рд╢рд╛:</strong> <code>(0,-1)</code> <br><br>  <strong>рд╕рдорд░реНрдерди:</strong> <code>(0,-3)</code> <br><br>  <strong>supportPoint.Dot (рджрд┐рд╢рд╛):</strong> <code>3</code> <br><br><pre> <code class="vbscript hljs"> // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the support point did <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> reach as far as the origin, // the simplex must <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> contain the origin <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> therefore there <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> no // intersection <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (supportPoint.Dot(direction!) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { // No intersection return; } // Add the simplex <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> determine a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> direction simplex.Add(supportPoint);</code> </pre> <br></li><li>  рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдПрдХ рд╕реЗрдЧрдореЗрдВрдЯ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдореЗрдВ рдЕрдВрджрд░ рдХрд╛ рдореВрд▓ рдмрд┐рдВрджреБ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ;  рдПрдХ рдирдИ рджрд┐рд╢рд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреЛ рджреЗрдЦрдирд╛ рд╣реИред <br><br><pre> <code class="vbscript hljs"> direction = simplex.CalculateDirection();</code> </pre> <br><ol><li>  рд╣рдо рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рдЬреЛрдбрд╝реЗ рдЧрдП рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рдХреЛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдореВрд▓ рдХреА рджрд┐рд╢рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рдЗрд╕ рдмрд┐рдВрджреБ рдХрд╛ рдкрд╛рд░рд╕реНрдкрд░рд┐рдХ рд╣реЛрдЧрд╛ред <br><br>  <strong>a:</strong> <code>(0,-3)</code> <strong>ao:</strong> <code>(0,3)</code> <br><br><pre> <code class="vbscript hljs"> CalculateDirection(): Vector | undefined { // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> a, the last point added <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = this.points[this.points.length - <span class="hljs-number"><span class="hljs-number">1</span></span>]; // Since a was just added, we know that the inverse of a points // towards the origin <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ao = a.Invert(); // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a triangle <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (this.points.length == <span class="hljs-number"><span class="hljs-number">3</span></span>) {</code> </pre> </li><li>  рдЪреВрдВрдХрд┐ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдПрдХ рдЦрдВрдб рд╣реИ, рдПрдХ рддреНрд░рд┐рдХреЛрдг рдирд╣реАрдВ рд╣реИ, рд╣рдо рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ рджреВрд╕рд░реЗ рдмрд┐рдВрджреБ рдХреЛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рд╕реЗрдЧрдореЗрдВрдЯ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред <br><br>  <strong>b:</strong> <code>(0,2)</code> <strong>ab:</strong> <code>(0,5)</code> <br><br><pre> <code class="vbscript hljs"> // Otherwise the simplex <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> just a line // B <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the penultimate point <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex, // <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> the other <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> of the line <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = this.points[<span class="hljs-number"><span class="hljs-number">0</span></span>]; // Determine a -&gt; b line <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ab = b.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a);</code> </pre> </li><li>  рд╣рдо рдЗрд╕ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд▓рдВрдмрд╡рдд рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдореВрд▓ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реИред  рдпрд╣ рдЕрдЧрд▓реЗ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреЗ рд▓рд┐рдП рдирдИ рджрд┐рд╢рд╛ рд╣реЛрдЧреАред <br><br>  <strong>abPerp:</strong> <code>(5, 0)</code> <br><br>  <strong>abPerp.Dot (ao)</strong> <code>0</code> <br><br>  <strong>abPerp:</strong> <code>(-5, 0)</code> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ef6/e2d/38d/ef6e2d38de9923b0788d6fb4c21491f3.png" alt="рд▓рд╛рдЗрди рдЕрдм рдФрд░ рдЙрд╕рдХреЗ рд▓рдВрдмрд╡рдд рдЪрд╛рд░реНрдЯ"></div><br><pre> <code class="vbscript hljs"> // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the perpendicular of the a-&gt;b line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> abPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ab.y, -ab.x); // Check the handedness of the perpendicular, it should // face TOWARDS the origin <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(ao) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { abPerp = abPerp.Invert(); } return abPerp;</code> </pre> </li></ol></li><li>  рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрдЧрд▓реЗ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рджрд┐рд╢рд╛ рд╣реИред  рд╣рдо рдЪрдХреНрд░ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд▓реМрдЯрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдмрд╛рд╣рд░ рдирд╣реАрдВ рдирд┐рдХрд▓рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рджрд┐рд╢рд╛ рд╣реИ, рдФрд░ рдЪреМрд░рд╛рд╣рд╛ рдЕрднреА рддрдХ рдирд╣реАрдВ рдорд┐рд▓рд╛ рд╣реИред <br><br>  <strong>рджрд┐рд╢рд╛:</strong> <code>(-5, 0)</code> <br><br>  <strong>рд╕рдорд░реНрдерди:</strong> <code>(-2,-2)</code> <br><br>  <strong>supportPoint.Dot (рджрд┐рд╢рд╛):</strong> <code>10</code> <br><br>  рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдореВрд▓ рддрдХ рдкрд╣реБрдВрдЪ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдпрд╣ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗ рдХрд┐ рдХреЛрдИ рдЪреМрд░рд╛рд╣рд╛ рдирд╣реАрдВ рд╣реИред <br><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(direction) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> supportPoint = support(a, b, direction); // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the support point did <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> reach as far as the origin, // the simplex must <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> contain the origin <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> therefore there <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> no // intersection <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (supportPoint.Dot(direction!) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { // No intersection return; }</code> </pre> </li><li>  рдПрдХ рддреНрд░рд┐рднреБрдЬ рдмрдирд╛рддреЗ рд╣реБрдП, рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдореЗрдВ рдПрдХ рдирдпрд╛ рд╕рд╣рд╛рдпрдХ рдмрд┐рдВрджреБ рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕ рддреНрд░рд┐рдХреЛрдг рдореЗрдВ рдореВрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ <code>undefined</code> рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдирдИ рджрд┐рд╢рд╛ рдирд╣реАрдВред <br><br><pre> <code class="vbscript hljs"> // Add the simplex <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> determine a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> direction simplex.Add(supportPoint); direction = simplex.CalculateDirection();</code> </pre> <br><ol><li>  рддреНрд░рд┐рдХреЛрдг рдХреЗ рд╕рд┐рдВрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдмрд┐рдВрджреБрдУрдВ рдХреЛ рд▓реЗрдВред <br>  <strong>a:</strong> <code>(-2,-2)</code> <strong>b:</strong> <code>(0,-3)</code> <strong>c:</strong> <code>(0,2)</code> <strong>ao:</strong> <code>(2,2)</code> <br><br><pre> <code class="vbscript hljs"> // <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> a, the last point added <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = this.points[this.points.length - <span class="hljs-number"><span class="hljs-number">1</span></span>]; // Since a was just added, we know that the inverse of a points // towards the origin <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ao = a.Invert(); // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a triangle <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (this.points.length == <span class="hljs-number"><span class="hljs-number">3</span></span>) { // B <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the penultimate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex // C <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the oldest point <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the simplex <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = this.points[<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c = this.points[<span class="hljs-number"><span class="hljs-number">0</span></span>];</code> </pre> </li><li>  рд╕реЗрдЧрдореЗрдВрдЯ ab рдФрд░ ac рд▓реЗрдВред <br><br>  <strong>ab:</strong> <code>(2,-1)</code> <strong>рдПрд╕реА:</strong> <code>(2,4)</code> <br><br><pre> <code class="vbscript hljs"> // Determine a-&gt;b <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> a-&gt;c lines <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ab = b.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ac = c.<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>(a);</code> </pre> </li><li>  рд╣рдо рд╕рд┐рдореНрдкрд▓реЗрдХреНрд╕ рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдд рд╕реЗрдЧрдореЗрдВрдЯ рдПрдм рдХреЗ рд▓рд┐рдП рд▓рдВрдмрд╡рдд рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред <br><br>  <strong>abperp:</strong> <code>(-1,-2)</code> <br><br><pre> <code class="vbscript hljs"> // Determine perpendicular of the a-&gt;b line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> abPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ab.y, -ab.x); // Check the handedness of the perpendicular, it should // face AWAY from the simplex <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(c) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { abPerp = abPerp.Invert(); }</code> </pre> </li><li>  рд╣рдо рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдореВрд▓ рдПрдмреАрд╕реА рд╕реЗ рдкрд░реЗ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рд╣реИред <br><br>  <strong>abPerp.Dot (ao):</strong> <code>-6</code> <br><br>  рдЙрддреНрдкрддреНрддрд┐ рдПрдм рд╕реЗ рдкрд░реЗ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/845/12b/63d/84512b63d57ecf2e9e9a0b833f03d395.png" alt="рд▓рд╛рдЗрди рдЕрдм рдФрд░ рдЙрд╕рдХреЗ рд▓рдВрдмрд╡рдд рдЪрд╛рд░реНрдЯ"></div><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abPerp.Dot(ao) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { this.points.splice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); return abPerp; }</code> </pre> </li><li>  рд╣рдо рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдд рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд▓рдВрдмрд╡рдд рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред <br><br>  <strong>acPerp:</strong> <code>(-4,2)</code> <br><br><pre> <code class="vbscript hljs"> // Determine perpendicular of the a-&gt;c line <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> acPerp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector(ac.y, -ac.x); // Check the handedness of the perpendicular, it should // face AWAY from the simplex <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (acPerp.Dot(b) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { acPerp = acPerp.Invert(); }</code> </pre> </li><li>  рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдореВрд▓ рдПрд╕реА рд╕реЗ рдкрд░реЗ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред <br><br>  <strong>acPerp.Dot (ao):</strong> <code>-4</code> <br><br>  рдореВрд▓ ab рдХреЗ рдкрд░реЗ рд╕рд┐рдВрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ рдирд╣реАрдВ рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d6/f52/962/2d6f52962deaea1aca8a87288d6f1dc6.png" alt="рд▓рд╛рдЗрди рдПрд╕реА рдФрд░ рдЙрд╕рдХреЗ рд▓рдВрдмрд╡рдд рдХрд╛ рдЪрд╛рд░реНрдЯ"></div><br><pre> <code class="vbscript hljs"> // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> the origin lies outside of the simplex remove the // point <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> determine a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> direction <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the direction // of the perpendicular; aiming <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> try <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> encapsulate // the origin that lies outside <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (acPerp.Dot(ao) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { this.points.splice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); return acPerp; }</code> </pre> </li><li>  рдЪреВрдБрдХрд┐ рдЗрд╕ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ AB рдФрд░ AC рдХреА рдЬрд╛рдБрдЪ рдХреА рдЧрдИ рдереА, рдФрд░ рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ BC рдХреА рдкрд┐рдЫрд▓реА рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдореЗрдВ рдЬрд╛рдБрдЪ рдХреА рдЧрдИ рдереА, рдореВрд▓ рдХреЛ рд╕рд┐рдореНрдкреНрд▓реЗрдХреНрд╕ рдХреЗ рдЕрдВрджрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдПрдХ рдЯрдХреНрдХрд░ / рдЪреМрд░рд╛рд╣реЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ - рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП, рдлрд╝рдВрдХреНрд╢рди <code>undefined</code> рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bab/0de/57f/bab0de57f6848dc95e8cea565a549cc4.png" alt="рдПрдмреА, рдПрд╕реА рдФрд░ рдмреАрд╕реА рдФрд░ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд▓рдВрдмрд╡рдд рд░реЗрдЦрд╛рдПрдВ"></div></li></ol></li><li>  рдЪреВрдВрдХрд┐ рдПрдХ рдЯрдХрд░рд╛рд╡ рдХрд╛ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ, рд▓реВрдк рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рдЧрдпрд╛ рд╣реИ рдФрд░ рджреЛ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рдмреАрдЪ рдЯрдХрд░рд╛рд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ <code>Collision</code> рдЬрд╛рдирдХрд╛рд░реА рд╡рд╛рдкрд╕ рдЖ рдЧрдИ рд╣реИред <br><br><pre> <code class="vbscript hljs"> direction = simplex.CalculateDirection(); } // No direction calculated, intersection detected return <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Collision(a, b);</code> </pre> </li></ol><br><h1>  рдирд┐рд╖реНрдХрд░реНрд╖ </h1><br>  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рд▓реЗрдЦ рдЖрдкрдХреЛ GJK рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреЛ рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдШрд░реНрд╖ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣рд╛рдВ / рдирд╣реАрдВ рдореЗрдВ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИред  рдмрд╣реБрднреБрдЬ рдФрд░ рд╕рд░реНрдХрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЙрджрд╛рд╣рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рдкрдж рдХреЗ рд▓рд┐рдП рднрдВрдбрд╛рд░</a> рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЖрдк рджреЛ рдЖрдВрдХрдбрд╝реЗ, рдЯрдХрд░рд╛рд╡ рд╕рд╛рдорд╛рдиреНрдп, рдФрд░ рд╕рдВрдкрд░реНрдХ рдмрд┐рдВрджреБ рдХреЗ рдмреАрдЪ рдкреНрд░рд╡реЗрд╢ рджреВрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рде рдЗрд╕ рдХреЛрдб рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Dyn4j рдкреЛрд╕реНрдЯ рдХреЗ</a> рд╡рд┐рднрд┐рдиреНрди рдЯрдХрд░рд╛рд╡ / рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд╛рдиреНрдпрддрд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдкрд░ рдЕрдЪреНрдЫреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдВрдХ рд╣реИрдВ;  рдпрджрд┐ рдЖрдк рдЬреАрдЬреЗрдХреЗ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрдирдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi472404/">https://habr.com/ru/post/hi472404/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi472388/index.html">рд╡реЙрд▓рдорд╛рд░реНрдЯ рдиреЗ рдЕрдореЗрдЬрд╝рди рдкреНрд░рд╛рдЗрд╕ рд╡реЙрд░ рдХреА рдШреЛрд╖рдгрд╛ рдХреА</a></li>
<li><a href="../hi472392/index.html">рдСрдбрд┐рдпреЛ рдХреИрд╕реЗрдЯреНрд╕ рдХрд╛ рдЙрджрдп, рдкрддрди рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд╡рд╛рдкрд╕реА - рд╣рдо рдорд┐рдердХреЛрдВ рд╕реЗ рдирд┐рдкрдЯрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi472394/index.html">рдЕрдкрддрдЯреАрдп рддреЗрд▓ рдФрд░ рдЧреИрд╕ рдкрд░ рдХреГрддреНрд░рд┐рдо рдмреБрджреНрдзрд┐ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХрд╛ рдЖрдХрд▓рди рдХрд░рдирд╛</a></li>
<li><a href="../hi472396/index.html">4 рдХреЙрд▓рдо рдореЗрдВ рджреБрдирд┐рдпрд╛ рднрд░ рдореЗрдВ рдХреЙрд▓рдо рднрд╛рдЧ (1 рднрд╛рдЧ)</a></li>
<li><a href="../hi472402/index.html">RTMP рд╡реАрдбрд┐рдпреЛ рдХреЙрд▓ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ</a></li>
<li><a href="../hi472406/index.html">рдкрд┐рдЬреНрдЬрд╛ рдбрд┐рд▓реАрд╡рд░реА рдХреЗ рджреМрд░рд╛рди рдбреЗрдЯрд╛ рд╕реЗрдВрдЯрд░ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░реЗрдВ</a></li>
<li><a href="../hi472410/index.html">рдЙрдкрд▓рдмреНрдз рд░рдВрдЧ рдкреНрд░рдгрд╛рд▓реА рдбрд┐рдЬрд╛рдЗрдирд┐рдВрдЧ</a></li>
<li><a href="../hi472412/index.html">рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдФрд░ рдЙрддреНрдкрд╛рдж рдореИрдЯреНрд░рд┐рдХреНрд╕ - рд╣рд┐рд▓рд╛рдПрдВ рд▓реЗрдХрд┐рди рдорд┐рд╢реНрд░рдг рдирд╣реАрдВ?</a></li>
<li><a href="../hi472414/index.html">рдлрд╛рд╕реНрдЯ рдиреНрдпреВрдЯреНрд░реЙрди рд░рд┐рдПрдХреНрдЯрд░реЛрдВ рдХрд╛ рд▓рдВрдмрд╛ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдПрдХ рдмрдВрдж рдИрдВрдзрди рдЪрдХреНрд░ рдХрд╛ рд╡рд╛рджрд╛</a></li>
<li><a href="../hi472416/index.html">рдЬреАрд░реЛрдирд╛рдЗрдЯреНрд╕ рд╣реИрдХрдХреНрд╡реЗрд╕реНрдЯ 2019ред рдкрд░рд┐рдгрд╛рдо рдФрд░ рд▓рд┐рдЦрдирд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>