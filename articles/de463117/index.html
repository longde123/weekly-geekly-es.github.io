<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüåæ ü§± üåû Vorladen in PHP 7.4 üë®üèø‚Äç‚úàÔ∏è üòÑ üë©üèª‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die √úbersetzung dieses Artikels wurde speziell f√ºr Studenten des Backend PHP Developer- Kurses erstellt. 



 PHP 7.4 f√ºgt das Preloading hinzu, eine ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vorladen in PHP 7.4</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/463117/">  <i>Die √úbersetzung dieses Artikels wurde speziell f√ºr Studenten des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Backend PHP Developer-</a> Kurses erstellt.</i> <br><br><img src="https://habrastorage.org/webt/xa/ye/vs/xayevs76f7sr7gyuummrtetx4ym.png"><br><br>  PHP 7.4 f√ºgt das Preloading hinzu, eine Funktion, die die Codeleistung erheblich verbessern kann. <br><br>  Bei Vorspannung auf den Punkt gebracht. <br><br><ul><li>  Um die Dateien vorab zu laden, m√ºssen Sie ein separates PHP-Skript schreiben. </li><li>  Dieses Skript wird beim Serverstart einmal ausgef√ºhrt. </li><li>  Alle vorinstallierten Dateien stehen f√ºr alle Anforderungen im Speicher zur Verf√ºgung. </li><li>  √Ñnderungen an der Quelldatei funktionieren erst, wenn Sie den Server neu starten. </li></ul><br><h4>  Lassen Sie uns n√§her auf die neue Funktion eingehen. </h4><a name="habracut"></a><br><h3>  Mehr als Opcache </h3><br>  Ja, das Vorladen basiert auf Opcache, aber es ist nicht genau dasselbe.  Opcache nimmt die PHP-Quelldateien, kompiliert sie in Opcodes und speichert die kompilierten Dateien auf der Festplatte. <br><br>  Opcodes k√∂nnen als einfache Darstellung Ihres Codes betrachtet werden, die zur Laufzeit leicht interpretiert werden kann.  Mit opcache k√∂nnen Sie also die Phase der √úbersetzung der Quelldateien in das √ºberspringen, was der PHP-Interpreter zur Laufzeit tats√§chlich ben√∂tigt.  Deutliche Einsparungen! <br><br>  Sie k√∂nnen jedoch noch mehr sparen.  Mit <code>opcash</code> Dateien <code>opcash</code> wissen nichts √ºber andere Dateien.  Wenn Sie Klasse A haben, eine Erweiterung von Klasse B, m√ºssen diese zur Laufzeit noch verkn√ºpft werden.  Dar√ºber hinaus pr√ºft der Opcache, ob sich die Quelldateien ge√§ndert haben, und macht beim Erkennen der √Ñnderungen ihre Caches ung√ºltig. <br><br>  Und hier hilft das Preload: Es kompiliert nicht nur die Quelldateien zu Opcodes, sondern verbindet auch abh√§ngige Klassen, Merkmale und Schnittstellen.  Es speichert ein solches "kompiliertes" Fragment von ausf√ºhrbarem Code (dh Code, den der PHP-Interpreter verwenden kann) im Speicher. <br><br>  Wenn eine Anforderung beim Server eintrifft, kann sie Teile der Codebasis, die bereits in den Speicher geladen wurden, ohne zus√§tzliche Zeit verwenden. <br><br><h4>  √úber welche ‚ÄûTeile der Codebasis‚Äú sprechen wir? </h4><br><h3>  √úbe das Vorladen </h3><br>  Zum korrekten Vorladen muss der Entwickler dem Server mitteilen, welche Dateien heruntergeladen werden sollen.  Dies geschieht mit einem einfachen PHP-Skript, sodass nichts zu bef√ºrchten ist. <br><br>  Nichts kompliziertes. <br><br><ul><li>  Sie stellen ein Preload-Skript bereit und verkn√ºpfen es mit <code>opcache.preload</code> in Ihrer php.ini-Datei. </li><li>  Jede PHP-Datei, die Sie <code>opcache_compile_file()</code> m√∂chten, muss vom Preload-Skript an <code>opcache_compile_file()</code> . </li></ul><br>  Angenommen, Sie m√∂chten eine Art Framework vorab laden.  Lass es Laravel sein.  In diesem Fall sollte Ihr Skript alle PHP-Dateien im <code>vendor/laravel</code> und <code>vendor/laravel</code> hinzuf√ºgen. <br><br>  So k√∂nnen Sie dieses Skript in die php.ini aufnehmen: <br><br><pre> <code class="php hljs">opcache.preload=/path/to/project/preload.php</code> </pre> <br><br>  Und hier ist ein Beispiel f√ºr eine Implementierung: <br><br><pre> <code class="php hljs">$files = <span class="hljs-comment"><span class="hljs-comment">/*  ,      */</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($files <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $file) { opcache_compile_file($file); }</code> </pre> <br>  Anstelle von <code>opcache_compile_file</code> Sie <code>include</code> .  Es scheint jedoch, dass hier ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehler aufgetreten ist</a> , da zum Zeitpunkt des Schreibens die zweite Option nicht funktioniert hat. <br><br><h4>  Warnung, dass Sie eine nicht verwandte Klasse nicht vorladen k√∂nnen </h4><br>  Es gibt eine Warnung <i>Kann nicht verkn√ºpfte Klasse nicht vorladen</i> ?  Tatsache ist, dass Sie vor dem Vorladen von Dateien auch deren abh√§ngige Objekte vorladen m√ºssen - Schnittstellen, Merkmale und √ºbergeordnete Klassen. <br><br>  Wenn Sie Probleme mit Klassenabh√§ngigkeiten haben, werden Sie beim Starten des Servers dar√ºber gewarnt: <br><br><pre> <code class="php hljs">Can<span class="hljs-string"><span class="hljs-string">'t preload unlinked class Illuminate\Database\Query\JoinClause: Unknown parent Illuminate\Database\Query\Builder</span></span></code> </pre> <br>  Beachten Sie, dass <code>opcache_compile_file()</code> die Datei nur <code>opcache_compile_file()</code> , aber nicht ausf√ºhrt.  Dies bedeutet, dass wenn eine Klasse Abh√§ngigkeiten hat, die nicht vorinstalliert wurden, die Klasse selbst nicht vorinstalliert werden kann. <br><br>  Dies ist nicht kritisch: Der Server funktioniert wie gewohnt, aber Sie verf√ºgen nicht √ºber alle Dateien, die Sie vorab laden m√∂chten. <br><br>  Aus diesem Grund m√ºssen Sie die Dateien zum Vorladen sorgf√§ltig ausw√§hlen, um Abh√§ngigkeitsprobleme zu vermeiden.  Das manuelle Ausf√ºhren ist eine undankbare und zeitaufw√§ndige Aufgabe, daher arbeiten Entwickler bereits an automatisierten L√∂sungen. <br><br><h3>  Komponistenunterst√ºtzung </h3><br>  Die vielversprechendste automatisierte L√∂sung wird von Komponistenentwicklern vorbereitet, die bereits in den meisten modernen PHP-Projekten verwendet wird. <br><br>  Jetzt arbeiten die Jungs an der M√∂glichkeit, das Preload in <code>composer.json</code> zu konfigurieren, wodurch wiederum eine Preload-Datei anstelle von Ihnen generiert wird.  Wie das Vorladen selbst befindet sich diese Funktion noch in der Entwicklung.  Hier k√∂nnen Sie die Entwicklung der Ereignisse verfolgen. <br>  Gl√ºcklicherweise m√ºssen Sie die Preload-Dateien nicht manuell konfigurieren, wenn Sie dies nicht m√∂chten - Composer kann dies f√ºr Sie tun. <br><br><h3>  Serveranforderungen </h3><br>  Es gibt zwei weitere wichtige Punkte, die ein Entwickler bei der Verwendung von Preload ber√ºcksichtigen sollte. <br><br>  Sie wissen bereits, dass Sie einen Eintrag in der <code>php.ini</code> erstellen <code>php.ini</code> damit das Preload funktioniert.  Dies bedeutet, dass Sie PHP nicht wie gew√ºnscht konfigurieren k√∂nnen, wenn Sie Shared Hosting verwenden. <br><br>  In der Praxis ben√∂tigen Sie einen dedizierten (virtuellen) Server, um vorinstallierte Dateien f√ºr ein einzelnes Projekt zu optimieren.  Denken Sie daran. <br><br>  Denken Sie auch daran, dass Sie den Server jedes Mal neu starten m√ºssen (wenn Sie <code>php-fpm</code> , reicht dies aus), wenn Sie Dateien im Speicher neu laden m√∂chten.  F√ºr die meisten ist dies offensichtlich, aber es wird nicht √ºberfl√ºssig sein, sich daran zu erinnern. <br><br><h3>  Leistung </h3><br>  Nun zur wichtigsten Frage: Verbessert das Vorladen wirklich die Leistung? <br><br>  Nat√ºrlich!  Ben Morel teilte die Ergebnisse von Vergleichstests mit, die im selben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Thema zum Komponisten zu finden sind</a> , auf das wir oben Bezug genommen haben. <br><br>  Und das ist auch interessant.  Wenn Sie m√∂chten, k√∂nnen Sie nur die sogenannten <code>hot classes</code> - Klassen, die h√§ufig in Ihrer Codebasis verwendet werden.  Die Tests von Ben Morel zeigen, dass das Laden von nur etwa 100 dieser Klassen eine h√∂here Leistungssteigerung bietet als das gleichzeitige Vorladen.  Im ersten Fall steigt die Produktivit√§t um 17%, im zweiten um 13%. <br><br>  Nat√ºrlich h√§ngt die Auswahl der Klassen f√ºr das Vorladen vom jeweiligen Projekt ab.  Der vern√ºnftigste Weg, um zu beginnen, besteht darin, einfach so viel wie m√∂glich vorzuladen.  Wenn diese wenigen Prozent Leistungsunterschiede f√ºr Sie so wichtig sind, m√ºssen Sie den Code zur Laufzeit steuern. <br><br>  All diese Vorg√§nge k√∂nnen nat√ºrlich automatisiert werden, und dies wird wahrscheinlich in Zukunft geschehen. <br><br>  Jetzt ist es wichtig, dass dem <code>composer</code> die Unterst√ºtzung vor dem Laden hinzugef√ºgt wird, sodass Sie keine Dateien mehr selbst erstellen m√ºssen.  Diese Funktion ist auf dem Server sehr einfach zu konfigurieren, vorausgesetzt, sie steht Ihnen vollst√§ndig zur Verf√ºgung. <br><br><hr><br>  Verwenden Sie das Preloading in der neuen Version von PHP 7.4?  Irgendwelche Gedanken oder Kommentare?  Mailen Sie mir auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitter</a> oder <a href="">E-Mail</a> . <br><br>  Traditionell warten wir auf Ihre Kommentare und Vorteile, wenn Sie den Artikel interessant finden :-) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463117/">https://habr.com/ru/post/de463117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463101/index.html">Verwalten von Hunderten von Servern f√ºr Lasttests: automatische Skalierung, benutzerdefinierte √úberwachung, DevOps-Kultur</a></li>
<li><a href="../de463105/index.html">Mein vierter Tag mit Haiku: Installations- und Bootprobleme</a></li>
<li><a href="../de463107/index.html">ShIoTiny: kleine Automatisierung, das Internet der Dinge oder ‚Äûsechs Monate vor den Ferien‚Äú</a></li>
<li><a href="../de463113/index.html">Daten und Modelle Versionskontrolle im Computer Vision-Meetup</a></li>
<li><a href="../de463115/index.html">Das T√ºrproblem im Shooter-Design</a></li>
<li><a href="../de463121/index.html">Wir essen den Elefanten in Teilen. Beispiel f√ºr eine Strategie zur √úberwachung des Anwendungszustands</a></li>
<li><a href="../de463123/index.html">Assembler-Codegenerator-Bibliothek f√ºr AVR-Mikrocontroller. Teil 3</a></li>
<li><a href="../de463125/index.html">OOP in Bildern</a></li>
<li><a href="../de463127/index.html">USV-√úberwachung. Teil Zwei - Analytics automatisieren</a></li>
<li><a href="../de463135/index.html">In welchen L√§ndern ist es rentabel, 2019 IT-Unternehmen zu registrieren?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>