<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïü üë®üèø‚Äçüè≠ üö© Arquivos antigos da esteganografia: ocultamos dados diretamente em setores üóûÔ∏è üíÖ üïã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Breve introdu√ß√£o 
 A esteganografia, se algu√©m n√£o se lembra, √© a oculta√ß√£o de informa√ß√µes em qualquer container. Por exemplo, nas imagens (discutidas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Arquivos antigos da esteganografia: ocultamos dados diretamente em setores</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447028/"><h3>  Breve introdu√ß√£o </h3><br>  A esteganografia, se algu√©m n√£o se lembra, √© a oculta√ß√£o de informa√ß√µes em qualquer container.  Por exemplo, nas imagens (discutidas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ).  Voc√™ tamb√©m pode ocultar dados nas tabelas de servi√ßo do sistema de arquivos (isso foi escrito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ) e at√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nos pacotes de servi√ßo TCP</a> .  Infelizmente, todos esses m√©todos t√™m uma desvantagem: para "intercalar" silenciosamente as informa√ß√µes em um cont√™iner, voc√™ precisa de algoritmos complicados que levem em conta os recursos da estrutura interna do cont√™iner.  Sim, e com a resist√™ncia do cont√™iner √† manipula√ß√£o, surgem problemas: por exemplo, se voc√™ editar ligeiramente a imagem, as informa√ß√µes ocultas ser√£o perdidas. <br><br>  √â poss√≠vel, de alguma maneira, dispensar algoritmos astutos e manipula√ß√µes sutis de dados, enquanto ainda garante o desempenho do cont√™iner e um n√≠vel aceit√°vel de seguran√ßa para dados ocultos?  Olhando para o futuro, eu direi - sim, voc√™ pode!  E at√© eu vou oferecer um utilit√°rio. <br><a name="habracut"></a><br><h3>  Detalhes do M√©todo Sangrento </h3><br>  A id√©ia b√°sica √© t√£o simples quanto um taco na testa: h√° √°reas no disco nas quais o sistema operacional nunca grava (ou grava em casos raros).  Para n√£o precisar procurar essas √°reas com algoritmos astutos, usaremos redund√¢ncia - isto √©, duplicaremos nossas informa√ß√µes ocultas em todos os setores do disco muitas e muitas vezes.  Ent√£o, al√©m de toda essa grandeza, voc√™ pode criar as parti√ß√µes necess√°rias, formatar sistemas de arquivos, gravar arquivos e instalar o sistema operacional - de qualquer maneira, parte dos dados secretos ser√° salva e pode ser extra√≠da, e a duplica√ß√£o repetida nos ajudar√° a compor o todo original a partir de peda√ßos. <br><br>  A vantagem desse m√©todo √© √≥bvia: n√£o dependemos do formato do arquivo ou mesmo do tipo de sistema de arquivos usado. <br><br>  As desvantagens tamb√©m s√£o, penso, √≥bvias: <br><br><ul><li>  Os dados secretos s√≥ podem ser alterados reescrevendo completamente o disco inteiro, com a reconstru√ß√£o subsequente do conte√∫do vis√≠vel para o usu√°rio.  Ao mesmo tempo, voc√™ n√£o pode usar um software que recria um disco de uma imagem: ele recriar√° os dados secretos anteriores. </li><li>  Quanto maior a quantidade de dados classificados, maior a probabilidade de perda de algumas informa√ß√µes. </li><li>  A recupera√ß√£o de dados do disco pode levar muito tempo.  De alguns minutos a v√°rios dias (os discos modernos s√£o grandes). </li></ul><br>  Agora vamos aos detalhes. <br><br>  √â claro que, se voc√™ simplesmente espalhar dados secretos por todo o disco, eles ser√£o ocultados apenas a olho nu.  Se voc√™ equipar seus olhos com, digamos, um editor de disco, os dados aparecer√£o em toda a sua gl√≥ria.  Portanto, seria bom criptografar os dados para que n√£o pisquem.  Criptografaremos de maneira simples, mas com bom gosto: de acordo com o algoritmo aes256-cbc.  Pedimos ao usu√°rio a chave de criptografia, deixe-o pensar em uma boa senha. <br><br>  A pr√≥xima pergunta √© como podemos distinguir dados "corretos" de dados corrompidos.  Aqui a soma de verifica√ß√£o nos ajudar√°, mas n√£o √© simples, mas √© SHA1.  O que?  Para o git, √© bom o suficiente, o que significa que nos conv√©m.  Foi decidido: fornecemos a cada fragmento de informa√ß√£o salvo uma soma de verifica√ß√£o e, se ap√≥s a descriptografia coincidir, a descriptografia foi bem-sucedida. <br><br>  Voc√™ tamb√©m precisa do n√∫mero do fragmento e do comprimento total dos dados secretos.  N√∫mero do fragmento - para rastrear quais pe√ßas j√° foram decifradas e quais permaneceram.  O comprimento total √© √∫til para n√≥s ao processar o √∫ltimo fragmento, para n√£o gravar dados extras (em outras palavras, preenchimento).  Bem, como ainda temos um t√≠tulo, adicionaremos o nome do arquivo secreto l√°.  Ser√° √∫til ap√≥s a descriptografia, para n√£o adivinhar como abri-lo. <br><br><h3>  Verifique o m√©todo na pr√°tica </h3><br>  Para verifica√ß√£o, usamos a m√≠dia mais comum - uma unidade flash.  Encontrei um antigo com 1 GB, o que √© bastante adequado para experimentos.  Se voc√™, como eu, teve a id√©ia de n√£o tomar banho de vapor com m√≠dia f√≠sica, mas testar em um arquivo - uma imagem de disco, direi imediatamente: n√£o vai dar certo.  Ao formatar esse "disco", o Linux cria o arquivo novamente e todos os setores n√£o utilizados ser√£o preenchidos com zeros. <br><br>  Como uma m√°quina Linux, infelizmente, eu tive que usar a esta√ß√£o meteorol√≥gica no Raspberry Pi 3. na varanda.N√£o h√° muita mem√≥ria l√°, portanto n√£o esconderemos arquivos grandes.  N√≥s nos limitamos a um tamanho m√°ximo de 10 megabytes.  Tamb√©m n√£o faz sentido ocultar arquivos muito pequenos: o utilit√°rio grava dados no disco em clusters de 4 Kb.  Portanto, a partir de baixo nos restringimos a um arquivo de 3 kb - ele se encaixa em um desses clusters. <br><br>  Iremos zombar da unidade flash em etapas, verificando ap√≥s cada etapa se as informa√ß√µes ocultas s√£o lidas: <br><br><ol><li>  Formata√ß√£o r√°pida no formato FAT16 com um tamanho de cluster de 16 kb.  √â isso que o Windows 7 prop√µe fazer com uma unidade flash que n√£o possui um sistema de arquivos. </li><li>  Preenchendo uma unidade flash com todos os tipos de lixo em 50%. </li><li>  Preencher a unidade flash com todos os tipos de lixo √© 100%. </li><li>  Formata√ß√£o "Long" no formato FAT16 (substituindo tudo). </li></ol><br>  Espera-se que os dois primeiros testes tenham terminado em vit√≥ria completa: o utilit√°rio conseguiu extrair com √™xito 10 megabytes de dados confidenciais de uma unidade flash.  Mas depois que a unidade flash foi preenchida com arquivos para os olhos, ocorreu uma falha: <br><br> <code>Total clusters read: 250752, decrypted: 158 <br> ERROR: cannot write incomplete secretFile</code> <br> <br>  Como voc√™ pode ver, apenas 158 clusters foram descriptografados com √™xito (632 kilobytes de dados brutos, o que gera 636424 bytes de carga √∫til).  √â claro que n√£o h√° como obter 10 megabytes e, obviamente, existem duplicatas entre esses clusters.  Mesmo 1 megabyte n√£o pode ser restaurado dessa maneira.  Mas pode-se garantir que recuperaremos 3 kilobytes de dados confidenciais de uma unidade flash, mesmo depois de formatada e gravada nos olhos.  No entanto, experimentos mostram que √© bem poss√≠vel extrair um arquivo de 120 kilobytes de uma unidade flash. <br><br>  O √∫ltimo teste, infelizmente, mostrou que a unidade flash foi substitu√≠da por tudo: <br><br> <code>$ sudo ./steganodisk -p password /dev/sda <br> Device size: 250752 clusters <br> 250700 99% <br> Total clusters read: 250752, decrypted: 0 <br> ERROR: cannot write incomplete secretFile <br></code> <br><br>  Nem um √∫nico cluster sobreviveu ... Infelizmente, mas n√£o tragicamente!  Vamos tentar criar uma parti√ß√£o na unidade flash antes de formatar, e j√° nela - o sistema de arquivos.  A prop√≥sito, ela veio da f√°brica com essa formata√ß√£o, ent√£o n√£o estamos fazendo nada de suspeito. <br>  Espera-se que o espa√ßo dispon√≠vel na unidade flash seja ligeiramente reduzido. <br><br>  Tamb√©m √© esperado que 10 megabytes ainda n√£o possam ser ocultados em uma unidade completamente entupida.  Mas agora o n√∫mero de clusters descriptografados com sucesso mais que dobrou! <br><br> <code>Total clusters read: 250752, decrypted: 405</code> <br> <br>  Infelizmente, um megabyte n√£o pode ser montado a partir de pe√ßas, mas duzentos kilobytes s√£o f√°ceis. <br><br>  Bem, as not√≠cias do √∫ltimo, quarto cheque, desta vez s√£o alegres: a formata√ß√£o completa de um pen drive n√£o levou √† destrui√ß√£o de todas as informa√ß√µes!  120 kilobytes de dados secretos se encaixam perfeitamente no espa√ßo n√£o utilizado. <br><br>  Tabela de resumo para teste: <br><br><img src="https://habrastorage.org/webt/lc/1r/ii/lc1riil0s_qjcrnenxtkbcboi4m.png"><br><br><h3>  Um pouco de teoriza√ß√£o: sobre espa√ßo livre e setores n√£o utilizados </h3><br>  Se voc√™ particionou um disco r√≠gido uma vez, poder√° notar que nem sempre √© poss√≠vel alocar todo o espa√ßo livre no disco.  A primeira se√ß√£o sempre come√ßa com algum recuo (geralmente 1 megabyte ou 2048 setores).  Por tr√°s da √∫ltima se√ß√£o, tamb√©m acontece, ainda existe uma pequena ‚Äúcauda‚Äù de setores n√£o utilizados.  E, √†s vezes, existem lacunas entre as se√ß√µes, embora raramente. <br><br>  Em outras palavras, existem setores no disco que n√£o podem ser acessados ‚Äã‚Äãdurante o trabalho normal com o disco, mas voc√™ pode gravar dados nesses setores!  O que significa ler tamb√©m.  Ajustado para o fato de que tamb√©m h√° uma tabela de parti√ß√£o e um c√≥digo do carregador de inicializa√ß√£o, que est√£o localizados apenas em uma √°rea vazia no in√≠cio do disco. <br><br>  Vamos nos distrair das parti√ß√µes por um tempo e olhar para o disco da altura, por assim dizer, do voo de um p√°ssaro.  Aqui temos uma parti√ß√£o vazia no disco.  Crie um sistema de arquivos nele.  √â poss√≠vel dizer que alguns setores do disco permaneceram desbloqueados? <br><br>  And-and-and - rolo de tambor!  A resposta quase sempre ser√° - sim!  De fato, na maioria dos casos, a cria√ß√£o de um sistema de arquivos se resume ao fato de que apenas alguns blocos de informa√ß√µes de servi√ßo s√£o gravados no disco, mas, caso contr√°rio, o conte√∫do da se√ß√£o n√£o muda. <br><br>  E, no entanto - puramente empiricamente - podemos assumir que o sistema de arquivos nem sempre pode ocupar todo o espa√ßo alocado para ele no √∫ltimo setor.  Por exemplo, um sistema de arquivos FAT16 com um tamanho de cluster de 64 kilobytes obviamente n√£o poder√° ocupar totalmente uma parti√ß√£o com um tamanho n√£o m√∫ltiplo de 64 kilobytes.  No final dessa se√ß√£o, uma cauda deve permanecer em v√°rios setores, inacess√≠veis para armazenar dados do usu√°rio.  No entanto, experimentalmente, essa suposi√ß√£o n√£o p√¥de ser confirmada. <br><br>  Portanto, para maximizar o espa√ßo dispon√≠vel para o esteganograma, voc√™ precisa usar um sistema de arquivos maior com um tamanho de cluster.  Voc√™ ainda pode criar uma parti√ß√£o, mesmo que seja opcional (em uma unidade flash, por exemplo).  N√£o √© necess√°rio criar se√ß√µes vazias ou deixar √°reas n√£o alocadas - isso atrair√° a aten√ß√£o dos cidad√£os interessados. <br><br><h3>  Utilit√°rio para experimentos </h3><br>  Fontes de utilidade podem ser encontradas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui.</a> <br><br>  Para construir, voc√™ precisar√° do Qt vers√£o 5.0 e superior e do OpenSSL.  Se algo n√£o acontecer, pode ser necess√°rio corrigir o arquivo steganodisk.pro. <br><br>  Voc√™ pode alterar o tamanho do cluster de 4 KB para, digamos, 512 bytes (em secretfile.h).  Ao mesmo tempo, as despesas com informa√ß√µes oficiais aumentar√£o: o cabe√ßalho e a soma de verifica√ß√£o ocupam 68 bytes fixos. <br><br>  Voc√™ deve executar o utilit√°rio, √© claro, com direitos de usu√°rio root e com cuidado.  N√£o haver√° perguntas antes de substituir o arquivo ou dispositivo especificado! <br><br>  Aproveite. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt447028/">https://habr.com/ru/post/pt447028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt447018/index.html">Enriquecimento qu√¢ntico em uma interpreta√ß√£o multi-mundo</a></li>
<li><a href="../pt447020/index.html">Produtividade n√£o √© sobre gerenciamento de tempo, mas sobre gerenciamento de aten√ß√£o</a></li>
<li><a href="../pt447022/index.html">N√£o force os ouvintes a refletir</a></li>
<li><a href="../pt447024/index.html">Como combinar as vantagens de um laptop e um computador desktop? An√°lise do problema e solu√ß√µes</a></li>
<li><a href="../pt447026/index.html">Escrevemos o carregador OTA para ATmega128RFA1 (como parte do dispositivo Smart Response XE)</a></li>
<li><a href="../pt447034/index.html">Novo bug no Telegram Desktop permite que voc√™ leia a √∫ltima mensagem</a></li>
<li><a href="../pt447036/index.html">Um coquetel para uma dieta saud√°vel - √© feito por uma startup do acelerador da ITMO University</a></li>
<li><a href="../pt447038/index.html">Na lista de amea√ßas: "Game of Thrones" - uma das capas mais populares para cibercriminosos</a></li>
<li><a href="../pt447040/index.html">Pesquisa: o custo m√©dio dos switches √© reduzido - entendemos por que</a></li>
<li><a href="../pt447042/index.html">Melhor experi√™ncia na cria√ß√£o de aplicativos angulares limpos e r√°pidos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>