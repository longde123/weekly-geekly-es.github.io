<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🉑 💇🏿 🤹🏽 Wie man keine Passwörter in Python-Skripten verwendet 🆎 🚹 🎩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Speichern von Passwörtern war schon immer ein Problem. In der klassischen Version haben Sie einen Benutzer, der sich bemüht, das schrecklich gehei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie man keine Passwörter in Python-Skripten verwendet</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435652/"><img src="https://habrastorage.org/webt/qr/eu/1p/qreu1pvpdtkrat69rsru9jv6mga.png"><br><br>  Das Speichern von Passwörtern war schon immer ein Problem.  In der klassischen Version haben Sie einen Benutzer, der sich bemüht, das schrecklich geheime „qwerty123“ und das Informationssystem, das den Hash aus diesem Passwort speichert, nicht zu vergessen.  Ein gutes System löst auch Hashes sorgfältig, um das Leben von schlechten Menschen zu vergiften, die eine Datenbank mit gehashten Passwörtern stehlen können.  Hier ist alles klar.  Einige Passwörter werden im Kopf gespeichert, andere in keepass verschlüsselt. <br><br>  Alles ändert sich, wenn wir eine Person aus dem Schema entfernen, die den Schlüssel vorsichtig von einem Stück Papier eingibt.  In der Interaktion zweier Informationssysteme sollte das Passwort in jedem Fall auf der Client-Seite in offener Form für das System gespeichert werden, damit es übertragen und mit dem Referenz-Hash verglichen werden kann.  In diesem Stadium öffnen Administratoren normalerweise die lokale Filiale der Fahrradfabrik und beginnen, den geheimen Schlüssel im Skriptcode sorgfältig zu verstecken, zu verschleiern und zu begraben.  Viele dieser Optionen sind nicht nur nutzlos, sondern auch gefährlich.  Ich werde versuchen, eine bequeme und sichere Lösung für dieses Problem für Python anzubieten.  Und ein kleiner Hauch von Powershell. <br><a name="habracut"></a><br><h2>  Wie man es nicht macht </h2><br>  Jeder kennt das Konzept des "temporären Scripting".  Hier können buchstäblich nur Daten schnell aus der Datenbank analysiert und gelöscht werden.  Und dann stellt sich plötzlich heraus, dass das Skript bereits irgendwo in der Produktion aus der Entwicklungszone migriert ist.  Und dann tauchen unangenehme Überraschungen aus der anfänglichen „Verfügbarkeit“ auf. <br><br>  Die häufigste Option ist im Stil von: <br><br><pre><code class="python hljs">db_login = <span class="hljs-string"><span class="hljs-string">'john.doe'</span></span> password = <span class="hljs-string"><span class="hljs-string">'password!'</span></span></code> </pre> <br>  Das Problem ist, dass hier das Passwort klar leuchtet und durch die automatische Suche leicht unter den Einlagen alter Skripte erkannt werden kann.  Eine etwas kompliziertere Version folgt dem Weg der Sicherheit durch Dunkelheit, wobei das Passwort in verschlüsselter Form direkt im Code gespeichert wird.  In diesem Fall sollte die Rückentschlüsselung sofort durchgeführt werden, da der Client dieses Kennwort sonst nicht auf der Serverseite anzeigen kann.  Diese Methode spart das Maximum eines ungezwungenen Aussehens, aber bei jeder ernsthaften manuellen Analyse des Codes können Sie den geheimen Schlüssel einfach extrahieren.  Der folgende Code speichert nur von solchen "Schulter-Surfern": <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> base64 &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> base64.b64encode(<span class="hljs-string"><span class="hljs-string">"password"</span></span>) cGFzc3dvcmQ= &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> base64.b64decode(<span class="hljs-string"><span class="hljs-string">"cGFzc3dvcmQ="</span></span>) password</code> </pre><br>  Das unangenehmste Szenario ist die Verwendung von Versionskontrollsystemen wie git für solche Dateien mit vertraulichen Informationen.  Selbst wenn der Autor beschließt, alle Passwörter zu löschen, bleiben sie im Verlauf des Repositorys.  Wenn Sie eine Datei mit geheimen Daten in git ausführen, können Sie diese automatisch als gefährdet betrachten und sofort mit dem Verfahren zum Ersetzen aller betroffenen Anmeldeinformationen beginnen. <br><br><h2>  Verwenden des Systemspeichers </h2><br>  Es gibt eine coole <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schlüsselbundbibliothek</a> .  Das Grundprinzip des Betriebs basiert auf der Tatsache, dass jeder Benutzer des Betriebssystems über einen eigenen verschlüsselten Speicher verfügt, auf den erst zugegriffen werden kann, nachdem sich der Benutzer beim System angemeldet hat.  Es ist plattformübergreifend und verwendet das vom Betriebssystem bereitgestellte Backend zum Speichern von Kennwörtern: <br><br><ul><li>  KDE4 &amp; KDE5 KWallet (dbus erforderlich) </li><li>  Freedesktop Secret Service - viele DEs, einschließlich GNOME (erfordert Secretstorage) </li><li>  Windows-Anmeldeinformationsschließfach </li><li>  macOS Schlüsselbund </li></ul><br>  Sie können auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">alternative Backends verwenden</a> oder eigene schreiben, wenn absolut etwas Seltsames erforderlich ist. <br><br><h3>  Vergleichen Sie die Angriffsschwierigkeiten </h3><br>  <b>Wenn Sie das Passwort direkt im Skript speichern, benötigen Sie</b> : <br><br><ol><li>  Stehlen Sie den Code selbst (einfach) </li><li>  Bei Bedarf deobfuscieren (einfach) </li></ol><br>  <b>Bei Verwendung eines lokalen Schlüsselbunds muss ein Angreifer:</b> <br><br><ol><li>  Stehlen Sie den Code selbst (einfach) </li><li>  Bei Bedarf deobfuscieren (einfach) </li><li>  So gefährden Sie den lokalen Computer, indem Sie sich als angegriffener Benutzer anmelden (schwierig) </li></ol><br>  Theoretisch kann jedes lokale Programm, das im Auftrag des aktuellen Benutzers ausgeführt wird, auf den lokalen Speicher zugreifen, wenn er die Zugriffseinstellungen für das geheime Kennwort kennt.  Dies ist jedoch kein Problem, da ein Angreifer im Falle eines kompromittierten Kontos alle vertraulichen Daten abfangen kann.  Andere Benutzer und ihre Software haben keinen Zugriff auf den lokalen Keystore. <br><br><h2>  Anwendungsbeispiel </h2><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> argparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> getpass <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keyring <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse_arguments</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> parser = argparse.ArgumentParser() parser.add_argument(<span class="hljs-string"><span class="hljs-string">"-n"</span></span>, <span class="hljs-string"><span class="hljs-string">"--newpass"</span></span>, required=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, help=<span class="hljs-string"><span class="hljs-string">"Set new password"</span></span>, action=<span class="hljs-string"><span class="hljs-string">"store_true"</span></span>) arguments = parser.parse_args() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arguments <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fake_db_connection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># ,       -  db_name = 'very_important_db' db_host = '147.237.0.71' passwd = keyring.get_password(systemname, username) print('Connecting to db: {}'.format(db_name)) print('Using very secret password from vault: {}'.format(passwd)) print('Doing something important...') print('Erasing the database...') print('Task completed') #    systemname = 'important_database' username = 'meklon' args = parse_arguments() #    ,    --newpass if args.newpass: #      CLI password = getpass.getpass(prompt="Enter secret password:") #       try: keyring.set_password(systemname, username, password) except Exception as error: print('Error: {}'.format(error)) #          fake_db_connection()</span></span></code> </pre><br><h2>  Passwortsicherheit </h2><br>  Ein weiteres häufiges geheimes Kennwortleck ist der Befehlszeilenverlauf.  Die Verwendung von Standardeingaben ist hier nicht zulässig: <br><br><pre> <code class="python hljs">age = input(<span class="hljs-string"><span class="hljs-string">"What is your age? "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Your age is: "</span></span>, age type(age) &gt;&gt;output What <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> your age? <span class="hljs-number"><span class="hljs-number">100</span></span> Your age <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> type <span class="hljs-string"><span class="hljs-string">'int'</span></span>&gt;</code> </pre><br>  Im obigen Beispiel habe ich bereits die <b>getpass-</b> Bibliothek erwähnt: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      CLI password = getpass.getpass(prompt="Enter secret password:")</span></span></code> </pre><br>  Die Eingabe von Daten bei deren Verwendung ähnelt dem klassischen * nix-Ansatz bei der Anmeldung.  Daten werden in keinem System in Systemprotokollen geschrieben oder auf einem Bildschirm angezeigt. <br><br><h2>  Ein bisschen über Powershell </h2><br>  Für Powershell ist die richtige Option die Verwendung des standardmäßigen Windows Credential Locker. <br>  Dies wird vom <a href="">CredentialManager-</a> Modul implementiert. <br><br>  Anwendungsbeispiel: <br><br><pre> <code class="plaintext hljs">Install-Module CredentialManager -force New-StoredCredential -Target $url -Username $ENV:Username -Pass .... Get-StoredCredential -Target ....</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435652/">https://habr.com/ru/post/de435652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435642/index.html">Pentax Auto 110: "In welcher Faust befindet sich die Kamera?"</a></li>
<li><a href="../de435644/index.html">Zoo AFL Phaser</a></li>
<li><a href="../de435646/index.html">NB-IoT, Schmalband-Internet der Dinge. Allgemeine Informationen, technologische Merkmale</a></li>
<li><a href="../de435648/index.html">Bot generiert Tutorials aus Wikipedia-Artikeln</a></li>
<li><a href="../de435650/index.html">So binden Sie eine C-Bibliothek in ein Swift-Framework ein</a></li>
<li><a href="../de435654/index.html">Fallstricke von benutzerdefinierten CSS-Eigenschaften</a></li>
<li><a href="../de435656/index.html">Roller Rolls Royce - Ninebot KickScooter ES4 von Segway</a></li>
<li><a href="../de435662/index.html">"Zuverlässigkeit und Zuverlässigkeit wie bei Google" - und nicht nur: Übersetzung des Artikels "Berechnung der Servicezuverlässigkeit"</a></li>
<li><a href="../de435664/index.html">Google-Suchmaschinen-Spoofing</a></li>
<li><a href="../de435666/index.html">Asynchrone Desynchronisation: Antimuster bei der Arbeit mit async / await in .NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>