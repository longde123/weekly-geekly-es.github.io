<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüåæ üìÖ üë©üèΩ‚Äçü§ù‚Äçüë©üèª Tindakan di Google: menulis aplikasi sederhana untuk Google Assistant di Dialogflow dan Cloud Functions for Firebase ‚öæÔ∏è üèáüèª üì∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada akhir bulan lalu, Asisten Google secara resmi dirilis dalam bahasa Rusia, jadi inilah saatnya untuk mencari tahu bagaimana membuat aplikasi Anda ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tindakan di Google: menulis aplikasi sederhana untuk Google Assistant di Dialogflow dan Cloud Functions for Firebase</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/419261/">  Pada akhir bulan lalu, Asisten Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara resmi dirilis</a> dalam bahasa Rusia, jadi inilah saatnya untuk mencari tahu bagaimana membuat aplikasi Anda sendiri ( <i>tindakan</i> ) untuk Asisten pada tumpukan teknologi Google standar.  Dalam artikel ini, kami akan mempertimbangkan untuk membuat tindakan dalam <b>Tindakan di Google</b> , menganalisis proses penggalian entitas dan niat dari frasa di <b>Dialogflow</b> , mempelajari cara menulis penangan untuk informasi yang diekstraksi dan bekerja dengan jaringan di <b>Cloud Functions for Firebase</b> . <br><br><img src="https://habrastorage.org/webt/a0/fj/yq/a0fjyq-er-evhhgkrr8hgbjxqhi.png"><br>  <i>Fig.</i>  <i>1. Arsitektur aplikasi untuk Asisten.</i> <br><a name="habracut"></a><br>  Pengembangan untuk Asisten telah mulai berkembang relatif baru-baru ini, sehingga jaringan memiliki beberapa bahan, dan jumlah alat dan teknologi yang digunakan secara signifikan meningkatkan ambang masuk.  Artikel ini, meskipun tidak menyelesaikan, tetapi setidaknya berkontribusi pada solusi dari masalah ini.  Mari kita mulai dengan arsitektur aplikasi untuk Asisten (Gbr. 1), diimplementasikan pada tumpukan teknologi Google standar: <br><br><ul><li>  <b>Tindakan di Google</b> adalah platform untuk membuat aplikasi untuk Google Assistant. </li><li>  <b>Dialogflow</b> - Mesin NLU (Pengertian Bahasa Alami), bertanggung jawab untuk memproses bahasa alami dan dialog desain. </li><li>  <b>Cloud Functions for Firebase</b> (untuk kenyamanan, kami akan menggunakan singkatan Firebase Functions) - fungsi cloud untuk memproses logika kompleks interaksi pengguna dan untuk bekerja dengan layanan pihak ketiga.  Fungsi Firebase dan Dialogflow berinteraksi melalui webhook, jadi secara teknis solusi server lain dapat digunakan.  Namun, Fungsi Firebase adalah alternatif yang baik, dan kadang-kadang pengganti backend sendiri.  Ini memungkinkan Anda untuk membuat dan menjalankan layanan pada infrastruktur Google, tanpa khawatir tentang alokasi, penskalaan, atau manajemen server.  Di satu sisi, ini memungkinkan Anda untuk fokus pada komponen produk pengembangan dan fungsionalitas layanan, tanpa membuang waktu untuk tugas dan administrasi infrastruktur.  Tetapi di sisi lain, sebagai suatu peraturan, delegasi memerlukan melemahnya kendali atas situasi. </li></ul><br>  Artikel ini berfokus pada aspek teknis pengembangan, biaya menggunakan layanan yang terdaftar tidak akan dianalisis. <br><br><img src="https://habrastorage.org/webt/mb/xq/lu/mbxqlufyd-0svj25q81mlwbzkmk.png"><br>  <i>Fig.</i>  <i>2. Interaksi komponen-komponen dari Asisten Google (Berdasarkan bahan: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Beranda Google dan Lokakarya Asisten Google</a> ).</i> <br><br>  Di dalam tumpukan yang dijelaskan, logika tindakan terlihat seperti ini (Gbr. 2): <br><br><ul><li>  Pengguna mengakses aplikasi Google Assistant dan memulai percakapan dengan tindakan tertentu. </li><li>  Google Assistant melalui Actions on Google proksi setiap frasa pengguna dalam format teks di Dialogflow, selain itu memberikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">informasi tentang pengguna</a> (dengan permintaan awal dan dengan persetujuan pengguna) dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">percakapan saat ini</a> . </li><li>  Dialogflow memproses frasa yang diterima, mengekstrak informasi yang diperlukan darinya, dan berdasarkan ML, membuat keputusan tentang jawaban mana yang akan dihasilkan. </li><li>  Dalam beberapa kasus, Dialogflow dapat mendelegasikan pembentukan respons ke server pada Fungsi Firebase, yang, pada gilirannya, dapat menggunakan layanan pihak ketiga untuk mendapatkan informasi yang diperlukan untuk respons tersebut. </li><li>  Setelah jawaban terbentuk, Dialogflow mengembalikannya ke Tindakan di Google, dari tempat masuknya aplikasi Google Assistant. </li></ul><br><h2>  Ide </h2><br>  Tindakan kami akan menentukan dengan frasa jenis gif apa yang ingin dilihat pengguna, dan kemudian ia akan mencarinya melalui API GIPHY dan mengembalikannya ke pengguna dalam bentuk kartu.  Saat menerapkan tindakan, kami akan menganalisis solusi dari tugas-tugas berikut: <br><br><ol><li>  Siapkan dan tautkan Tindakan di Google, Fungsi Dialogflow dan Firebase. </li><li>  Ekstrak kata kunci dari frasa pengguna (Dialogflow). </li><li>  Scripting Dialog (Dialogflow). </li><li>  Bekerja dengan konteks dialog (Dialogflow). </li><li>  Membuat dan menghubungkan webhook untuk menghasilkan respons terhadap frasa pengguna (Dialogflow, Firebase Function). </li><li>  Tampilkan korsel kartu di antarmuka (Fungsi Firebase). </li><li>  Mengunduh informasi dari layanan pihak ketiga (Firebase Functions). </li></ol><br><h2>  Pengaturan awal </h2><br><img src="https://habrastorage.org/webt/qz/ib/k6/qzibk6lsuxemwmfzt2bmkpitzoa.png"><br>  <i>Fig.</i>  <i>3. Membuat agen Dialogflow.</i> <br><br>  Pertama-tama, kita membutuhkan akun Google.  Mari kita mulai dengan membuat proyek di Dialogflow, untuk ini, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">konsol,</a> klik tombol Buat Agen dan isi bidang yang diperlukan (Gbr. 3): <br><br><ul><li>  Bahasa default adalah "Rusia - ru". </li><li>  Zona waktu: "(GMT + 3: 00) Eropa / Moskow". </li><li>  Google Cloud Project: GCP baru untuk agen Dialogflow Anda akan dibuat secara otomatis, atau Anda dapat memilih salah satu proyek GCP yang ada, jika ada. </li></ul><br>  Kemudian klik tombol Buat di sudut kanan atas dan tunggu konsol untuk mengkonfigurasi proyek baru. <br><br><img src="https://habrastorage.org/webt/il/wd/gd/ilwdgd0j4u6f9ghzfd6k9dmwtfq.png"><br>  <i>Fig.</i>  <i>4. Maksud standar.</i> <br><br>  Secara default, saat membuat agen Dialogflow, dua maksud dibuat (Gbr. 4): <br><br><ul><li>  ‚ÄúDefault Welcome Intent‚Äù - bertanggung jawab untuk menyapa pengguna; </li><li>  ‚ÄúDefault Fallback Intent‚Äù - memproses frasa yang tidak diketahui yang tidak dapat dialihkan oleh Dialogflow ke maksud lain. </li></ul><br>  Membuat dialog dalam Dialogflow telah dijelaskan secara rinci dalam artikel di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> dan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , jadi saya tidak akan fokus pada prinsip operasinya. <br><br><img src="https://habrastorage.org/webt/jj/if/sp/jjifspt3awd3uoyao-nxlhdnaco.png"><br>  <i>Fig.</i>  <i>5. Jawaban untuk ‚ÄúDefault Welcome Intent‚Äù.</i> <br><br>  Kami akan menambahkan beberapa jawaban selamat datang ke "Intensi Sambutan Default" yang akan membantu pengguna memahami untuk apa tindakan itu dan fungsi apa yang dapat ia lakukan.  Di bagian "Responses", pilih tab "Google Assistant" dan di "Saran Kapal" kami akan menulis contoh frasa untuk memberi tahu pengguna bagaimana berkomunikasi dengan tindakan (Gbr. 5). <br><br>  Tindakan dapat di-debug di Google Assistant baik di ponsel maupun di emulator resmi.  Untuk membuka emulator, Anda harus pergi ke bagian "Integrasi", di kartu "Google Asisten", klik tombol "Pengaturan Integrasi" dan klik "Kelola Aplikasi Asisten".  Baik di ponsel dan emulator, tindakan dapat dipicu dengan frasa kode "Oke Google, saya ingin berbicara dengan aplikasi pengujian saya". <br><br><h2>  Skenario dasar: pencarian GIF </h2><br>  Buat Maksud Pencarian baru, yang akan mengekstrak kata kunci dari frasa pengguna dan mengirimkannya melalui server webhook ke Fungsi Firebase.  Server, pada gilirannya, menggunakan GIPHY API akan menemukan gif yang sesuai dan mengembalikan hasilnya kepada pengguna dalam bentuk kartu. <br><br><img src="https://habrastorage.org/webt/dc/ig/68/dcig68-xcdbzx8ygmuy83-4xibk.png"><br>  <i>Fig.</i>  <i>6. Menambahkan frasa pelatihan.</i> <br><br>  Untuk mulai dengan, kami akan menambahkan frasa khas untuk pelatihan di bagian Frase Pelatihan (Gbr. 6): <br><br><ul><li>  "Aku ingin melihat jerapah menari." </li><li>  "Temukan animashki." </li><li>  "Tunjukkan segelnya." </li><li>  Tunjukkan padaku gif. </li><li>  "Temukan aku gajah animasi." </li><li>  "Tampilkan panda gifs." </li><li>  "Gif dengan garis-garis rakun." </li><li>  "Kamu memiliki segel." </li><li>  "Temukan air terjun yang lucu." </li></ul><br><img src="https://habrastorage.org/webt/az/_s/e0/az_se0faydig_odzqvgvh4c0twu.png"><br>  <i>Fig.</i>  <i>7. Mengekstrak parameter dari teks.</i> <br><br>  Untuk frasa tambahan, perhatikan parameter pencarian, yang harus dipilih Dialogflow dari teks.  Dalam hal ini, jenis parameter yang paling tepat adalah <code>@sys.any</code> , karena hampir semua konstruk bahasa dapat digunakan sebagai parameter permintaan pencarian.  Kami memanggil <code>query</code> parameter ini dan menandainya sesuai kebutuhan (Gbr. 7). <br><br><img src="https://habrastorage.org/webt/xt/c_/cy/xtc_cyzai21tbnfysovpupedakg.png"><br>  <i>Fig.</i>  <i>8. Daftar pertanyaan utama.</i> <br><br>  Dalam subbagian ‚ÄúPrompt‚Äù kami akan menuliskan pertanyaan klarifikasi yang akan ditanyakan Dialogflow jika Dialogflow tidak dapat mengekstrak kata kunci dari frasa (Gbr. 8). <br><br>  Selanjutnya, pergi ke bagian "Pemenuhan" di bagian paling bawah halaman (jangan bingung dengan bagian dengan nama yang sama di menu sebelah kiri).  klik tombol ‚ÄúEnable Fullfilment‚Äù, dan kemudian aktifkan pengaturan ‚ÄúEnable webhook call for this intent‚Äù.  Ini akan memungkinkan Dialogflow untuk mendelegasikan pembentukan respons Fungsi Firebase ketika mencapai maksudnya. <br><br>  Sekarang pergi ke tab "Pemenuhan" di menu sebelah kiri dan nyalakan "Inline Editor", di mana kita akan menulis logika untuk "Search Intent" yang baru dibuat.  Untuk mencari GIF dengan kata kunci, kami akan menggunakan permintaan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://api.giphy.com/v1/gifs/search</a> , yang mengembalikan daftar objek yang ditemukan dalam format JSON sesuai dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spesifikasi</a> .  Respons yang diterima dari GIPHY akan ditampilkan dalam bentuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Browsing Carousel</a> - sebuah korsel kartu dengan gambar, ketika diklik, sebuah halaman web terbuka.  Dalam kasus kami, ketika Anda mengklik kartu, pengguna akan pergi ke halaman layanan GIPHY dengan animasi ini dan daftar yang serupa. <br><br>  Kode yang mengimplementasikan fungsi yang dijelaskan di atas disajikan di bawah ini. <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GIPHY_API_KEY = <span class="hljs-string"><span class="hljs-string">'API_KEY'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SEARCH_RESULTS = [ <span class="hljs-string"><span class="hljs-string">'-,    .'</span></span>, <span class="hljs-string"><span class="hljs-string">',   .'</span></span>, <span class="hljs-string"><span class="hljs-string">',   !'</span></span> ]; <span class="hljs-comment"><span class="hljs-comment">// Import the Dialogflow module from the Actions on Google client library. const { dialogflow, BrowseCarouselItem, BrowseCarousel, Suggestions, Image } = require('actions-on-google'); // Import the firebase-functions package for deployment. const functions = require('firebase-functions'); // Import the request-promise package for network requests. const request = require('request-promise'); // Instantiate the Dialogflow client. const app = dialogflow({ debug: true }); function getCarouselItems(data) { var carouselItems = []; data.slice(0, 10).forEach(function (gif) { carouselItems.push(new BrowseCarouselItem({ title: gif.title || gif.id, url: gif.url, image: new Image({ url: gif.images.downsized_medium.url, alt: gif.title || gif.id }), })); }); return carouselItems; } function search(conv, query) { // Send the GET request to GIPHY API. return request({ method: 'GET', uri: 'https://api.giphy.com/v1/gifs/search', qs: { 'api_key': GIPHY_API_KEY, 'q': query, 'limit': 10, 'offset': 0, 'lang': 'ru' }, json: true, resolveWithFullResponse: true, }).then(function (responce) { // Handle the API call success. console.log(responce.statusCode + ': ' + responce.statusMessage); console.log(JSON.stringify(responce.body)); // Obtain carousel items from the API call response. var carouselItems = getCarouselItems(responce.body.data); // Validate items count. if (carouselItems.length &lt;= 10 &amp;&amp; carouselItems.length &gt;= 2) { conv.data.query = query; conv.data.searchCount = conv.data.searchCount || 0; conv.ask(SEARCH_RESULTS[conv.data.searchCount % SEARCH_RESULTS.length]); conv.data.searchCount++; conv.ask(new BrowseCarousel({ items: carouselItems })); } else { // Show alternative response. conv.ask('      ,   - ?)'); } }).catch(function (error) { // Handle the API call failure. console.log(error); conv.ask(',     .'); }); } // Handle the Dialogflow intent named 'Search Intent'. // The intent collects a parameter named 'query'. app.intent('Search Intent', (conv, { query }) =&gt; { return search(conv, query); }); // Set the DialogflowApp object to handle the HTTPS POST request. exports.dialogflowFirebaseFulfillment = functions.https.onRequest(app);</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Ketergantungan</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"dialogflowFirebaseFulfillment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"This is the default fulfillment for a Dialogflow agents using Cloud Functions for Firebase"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"Apache Version 2.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Google Inc."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"engines"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: <span class="hljs-string"><span class="hljs-string">"~6.0"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"start"</span></span>: <span class="hljs-string"><span class="hljs-string">"firebase serve --only functions:dialogflowFirebaseFulfillment"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"deploy"</span></span>: <span class="hljs-string"><span class="hljs-string">"firebase deploy --only functions:dialogflowFirebaseFulfillment"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"dependencies"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"actions-on-google"</span></span>: <span class="hljs-string"><span class="hljs-string">"2.0.0-alpha.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"firebase-admin"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.2.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"firebase-functions"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.5.7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dialogflow"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dialogflow-fulfillment"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.3.0-beta.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.81.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request-promise"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.2.1"</span></span> } }</code> </pre> </div></div><br>  Karena pengguna dapat mengakses maksud yang sama beberapa kali, disarankan untuk mengembalikan berbagai jawaban.  Untuk melakukan ini, kami menggunakan objek JSON <code>Conversation.data</code> , yang mempertahankan nilainya saat mengakses maksud lagi, dan ketika merujuk ke skrip percakapan lainnya. <br><br><img src="https://habrastorage.org/webt/0m/lo/tp/0mlotpjfiboyxj_qgs5yselugxa.jpeg"><br>  <i>Fig.</i>  <i>9. Inisialisasi percakapan (di sebelah kiri), penyempurnaan parameter pencarian dan tampilan lebih lanjut dari hasil (di tengah), tampilan hasil pencarian untuk permintaan baru (di sebelah kanan)</i> <br><br>  <i>Catatan: untuk bekerja dengan API layanan pihak ketiga melalui Fungsi Firebase, Anda harus mengaktifkan penagihan, jika tidak, ketika mencoba bekerja dengan jaringan, kesalahan akan terjadi:</i> <blockquote>  <i>"Akun penagihan tidak dikonfigurasi.</i>  <i>Jaringan eksternal tidak dapat diakses dan kuota sangat terbatas.</i>  <i>Konfigurasikan akun penagihan untuk menghapus pembatasan ini. "</i> </blockquote>  <i>Untuk melakukan ini, klik "Akun berbayar" di menu sebelah kiri dan pilih Nyala Api ($ 25 per bulan) atau Nyala Api (bayar sesuai penggunaan) di antara rencana tarif yang diusulkan.</i>  <i>Saya memilih opsi terakhir, karena sebagai bagian dari pengembangan aplikasi pengujian, bagi saya sepertinya lebih menguntungkan.</i> <br><br><h2>  Skenario Lanjut: Pagination </h2><br>  Dalam kebanyakan kasus, untuk permintaan pencarian, GIPHY akan menemukan lebih dari sepuluh GIF secara signifikan, sehingga akan benar untuk memungkinkan pengguna untuk melihat seluruh hasil pencarian, mis.  tambahkan pagination. <br><br>  Di konsol Dialogflow, arahkan kursor ke sel Search Intent.  Beberapa tombol akan muncul di sebelah kanan, klik "Tambahkan niat tindak lanjut".  Ini akan memungkinkan kami untuk membuat cabang percakapan mengikuti Maksud Pencarian.  Di antara elemen daftar drop-down, kami memilih "lebih" - standar pengabaian untuk memulai tampilan informasi tambahan. <br><br><img src="https://habrastorage.org/webt/zb/26/0_/zb260_tehdtnrqgup4np6aqmjva.png"><br>  <i>Fig.</i>  <i>10. Konteks maksudnya adalah "Maksud Pencarian - lebih."</i> <br><br>  Mari kita pergi ke maksud yang baru dibuat dan membuat perubahan pada bagian "Konteks".  Karena pengguna dapat meminta untuk menampilkan lebih banyak GIF beberapa kali berturut-turut, maksud ini harus dapat disebut secara rekursif.  Untuk ini, dalam konteks keluar, perlu untuk mendaftarkan baris yang sama yang ditunjukkan dalam yang masuk (Gbr. 10).  Di bagian "Pemenuhan", Anda juga harus mengaktifkan pengaturan "Aktifkan panggilan webhook untuk maksud ini". <br><br>  Sekarang mari kita kembali ke "Fillfulment" dari menu samping, di mana kita menginisialisasi pawang untuk "Search Intent - more".  Kami juga menambahkan parameter <code>offset</code> ke fungsi <code>search</code> , yang akan digunakan untuk paginasi di API GIPHY. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SEARCH_RESULTS_MORE = [ <span class="hljs-string"><span class="hljs-string">'   !'</span></span>, <span class="hljs-string"><span class="hljs-string">',    .'</span></span>, <span class="hljs-string"><span class="hljs-string">',   .  ,    .'</span></span> ]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">search</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">conv, query, offset</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Send the GET request to GIPHY API. return request({ method: 'GET', uri: 'https://api.giphy.com/v1/gifs/search', qs: { 'api_key': GIPHY_API_KEY, 'q': query, 'limit': 10, 'offset': offset, 'lang': 'ru' }, json: true, resolveWithFullResponse: true, }).then(function (responce) { // Handle the API call success. console.log(responce.statusCode + ': ' + responce.statusMessage); console.log(JSON.stringify(responce.body)); // Obtain carousel items from the API call response. var carouselItems = getCarouselItems(responce.body.data); // Validate items count. if (carouselItems.length &lt;= 10 &amp;&amp; carouselItems.length &gt;= 2) { conv.data.query = query; conv.data.offset = responce.body.pagination.count + responce.body.pagination.offset; conv.data.paginationCount = conv.data.paginationCount || 0; conv.data.searchCount = conv.data.searchCount || 0; // Show successful response. if (offset == 0) { conv.ask(SEARCH_RESULTS[conv.data.searchCount % SEARCH_RESULTS.length]); conv.data.searchCount++; } else { conv.ask(SEARCH_RESULTS_MORE[conv.data.paginationCount % SEARCH_RESULTS_MORE.length]); conv.data.paginationCount++; } conv.ask(new BrowseCarousel({ items: carouselItems })); conv.ask(new Suggestions('')); } else { // Show alternative response. conv.ask('      ,   - ?)'); } }).catch(function (error) { // Handle the API call failure. console.log(error); conv.ask(',     .'); }); } // Handle the Dialogflow intent named 'Search Intent - more'. app.intent('Search Intent - more', (conv) =&gt; { // Load more gifs from the privious search query return search(conv, conv.data.query, conv.data.offset); });</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/rm/t1/fq/rmt1fqdvnbvywl1bsgmmjegxceu.jpeg"><br>  <i>Fig.</i>  <i>11. Pagination saat mencari gifs.</i> <br><br><h2>  Hasil </h2><br>  Video aksi disajikan di bawah ini. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FsJu8CQODu8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Kode proyek dan dump asisten tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Petunjuk untuk menginstal proyek dan mengimpor dump</b> <div class="spoiler_text"><ol><li>  Pergi ke konsol Dialogflow dan buat agen baru atau pilih yang sudah ada. </li><li>  Klik pada ikon pengaturan, pergi ke bagian "Ekspor dan Impor" dan klik pada tombol "Kembalikan dari ZIP".  Pilih file ZIP dari direktori root repositori. </li><li>  Pilih ‚ÄúPemenuhan‚Äù dari menu navigasi kiri. </li><li>  Aktifkan pengaturan "Editor Inline". </li><li>  Salin konten file dari direktori <code>functions</code> ke tab yang sesuai di "Pemenuhan". </li><li>  Masukkan kunci akses API GIPHY Anda di tab <i>index.js</i> . </li><li>  Buka konsol Firebase dan ubah paket Anda menjadi Flame atau Blaze.  Bekerja dengan layanan pihak ketiga melalui jaringan tidak tersedia dengan paket tarif gratis. </li></ol><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id419261/">https://habr.com/ru/post/id419261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id419251/index.html">Siaran hari ketiga Slurm: intens di Kubernetes</a></li>
<li><a href="../id419253/index.html">Laporan Club of Rome 2018, Bab 3.6: Urbanisme Regeneratif: Ecopolis</a></li>
<li><a href="../id419255/index.html">Dasar-dasar Keamanan IoT</a></li>
<li><a href="../id419257/index.html">India Memperkenalkan RUU Perlindungan PD Baru - Analog ke GDPR lainnya?</a></li>
<li><a href="../id419259/index.html">Rust 1.28 Rilis</a></li>
<li><a href="../id419265/index.html">Menggunakan jaringan saraf multi-layer untuk menghindari rintangan dalam game</a></li>
<li><a href="../id419267/index.html">SOK Coworking Tour</a></li>
<li><a href="../id419269/index.html">Rebus dalam kode, dan cara mendekripsi mereka. Kekuatan Rahasia Pengidentifikasi</a></li>
<li><a href="../id419271/index.html">Analog dengan Python dan JavaScript. Bagian empat</a></li>
<li><a href="../id419273/index.html">Menulis modul kernel Linux: GPIO dengan dukungan IRQ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>