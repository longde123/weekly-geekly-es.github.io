<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèΩ üö£üèΩ ü§≤ Plug-in Java sem problemas üßû üí¢ üçû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, gostaria de dizer como criar r√°pida e facilmente uma estrutura de aplicativo Java com suporte para carregamento din√¢mico de plug-ins. O ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Plug-in Java sem problemas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479478/">  Neste artigo, gostaria de dizer como criar r√°pida e facilmente uma estrutura de aplicativo Java com suporte para carregamento din√¢mico de plug-ins.  O leitor provavelmente pensar√° imediatamente que essa tarefa foi resolvida por um longo tempo, e voc√™ pode simplesmente usar estruturas prontas ou escrever seu carregador de classes, mas nada disso ser√° necess√°rio na solu√ß√£o que proponho: <br><br><ul><li>  N√£o precisamos de bibliotecas ou estruturas especiais ( <a href="https://www.youtube.com/watch%3Fv%3DE3A6Z02TIjg">OSGi</a> , Guice, etc.) </li><li>  N√£o usaremos a an√°lise de bytecode com ASM e bibliotecas semelhantes. </li><li>  N√£o escreveremos nosso carregador de classes. </li><li>  N√£o usaremos reflex√£o e anota√ß√µes. </li><li>  N√£o h√° necessidade de mexer com o caminho de classe para encontrar plugins.  N√£o vamos tocar no caminho da classe. </li><li> Al√©m disso, n√£o usaremos XML, YAML ou qualquer outra linguagem declarativa para descrever pontos de extens√£o (pontos de extens√£o em plugins). </li></ul><br>  No entanto, ainda existe um requisito - essa solu√ß√£o funcionar√° apenas no Java 9 ou superior.  Porque ser√° baseado em <a href="https://www.youtube.com/watch%3Fv%3DJ1fHBhFvmco">m√≥dulos e servi√ßos</a> . <br><a name="habracut"></a><br>  Ent√£o, vamos come√ßar.  Formulamos o problema mais especificamente: <br><blockquote> Voc√™ precisa implementar uma estrutura m√≠nima de aplicativo, que na inicializa√ß√£o carregar√° plugins de usu√°rio da pasta <code>plugins</code> . </blockquote><br>  Ou seja, o aplicativo montado deve se parecer com isso: <br><br><pre> <code class="bash hljs">plugin-app/ plugins/ plugin1.jar plugin2.jar ... core.jar ‚Ä¶</code> </pre> <br>  Vamos come√ßar com o m√≥dulo <code>core</code> .  Este m√≥dulo √© o n√∫cleo da nossa aplica√ß√£o, ou seja, √© a nossa estrutura. <br><br><div class="spoiler">  <b class="spoiler_title">Para quem valoriza o tempo, o projeto finalizado est√° dispon√≠vel no GitHub.</b>  <b class="spoiler_title">Instru√ß√µes de montagem.</b> <div class="spoiler_text">  <a href="https://github.com/orionll/plugin-app">Link</a> <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/orionll/plugin-app <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> plugin-app mvn verify <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> core/target java --module-path core-1.0-SNAPSHOT.jar --module core</code> </pre> </div></div><br>  Crie os 4 arquivos Java a seguir no m√≥dulo: <br><br><pre> <code class="bash hljs">core/ src/main/java/ org/example/pluginapp/core/ IService.java BasicService.java Main.java module-info.java</code> </pre> <br>  O primeiro arquivo, <code>IService.java</code> , √© o arquivo que descreve nosso ponto de extens√£o.  Outros plugins poder√£o contribuir para esse ponto de expans√£o ("contribuir").  Esse √© o princ√≠pio padr√£o para a cria√ß√£o de aplicativos de plug-in, chamado de <a href="https://en.wikipedia.org/wiki/Dependency_inversion_principle">princ√≠pio de invers√£o de depend√™ncia</a> (Invers√£o de Depend√™ncia).  Este princ√≠pio √© baseado no fato de que o kernel n√£o depende de classes espec√≠ficas, mas de interfaces. <br><br>  Dei ao ponto de extens√£o o nome abstrato <code>IService</code> , pois agora estou demonstrando um conceito exclusivamente.  Na realidade, pode ser qualquer ponto de extens√£o espec√≠fico, por exemplo, se voc√™ estiver escrevendo um editor gr√°fico, pode ser o efeito do processamento de imagens, por exemplo, <code>IEffectProvider</code> , <code>IEffectContribution</code> ou qualquer outra coisa, dependendo de como voc√™ prefere nomear os pontos de extens√£o.  Ao mesmo tempo, o pr√≥prio aplicativo conter√° um conjunto b√°sico de efeitos, e os desenvolvedores de terceiros poder√£o criar efeitos adicionais mais sofisticados e entreg√°-los na forma de plug-ins.  O usu√°rio s√≥ precisa colocar esses efeitos na pasta de <code>plugins</code> - <code>plugins</code> e reiniciar o aplicativo. <br><br>  O arquivo <code>IService.java</code> √© o seguinte: <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;IService&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getServices</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ModuleLayer layer)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ServiceLoader .load(layer, IService.class) .stream() .map(Provider::get) .collect(Collectors.toList()); } }</code> </pre> <br>  Assim, o <code>IService</code> √© apenas uma interface que faz algum trabalho abstrato <code>doJob()</code> (repito, os detalhes n√£o s√£o importantes, na realidade, ser√° algo concreto). <br><br>  Preste aten√ß√£o tamb√©m ao segundo m√©todo <code>getServices()</code> .  Este m√©todo retorna todas as implementa√ß√µes da interface <code>IService</code> encontradas nesta camada de m√≥dulo e seus pais.  Falaremos sobre isso com mais detalhes posteriormente. <br><br>  O segundo arquivo, <code>BasicService.java</code> , √© a implementa√ß√£o b√°sica da interface <code>IService</code> .  Ele sempre estar√° presente, mesmo se n√£o houver plugins no aplicativo.  Em outras palavras, o <code>core</code> n√£o √© apenas o n√∫cleo, mas tamb√©m ao mesmo tempo um plugin para si mesmo, que sempre ser√° carregado.  O arquivo <code>BasicService.java</code> fica assim: <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BasicService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"Basic service"</span></span>); } }</code> </pre> <br>  Para simplificar, <code>doJob()</code> apenas imprime a string <code>"Basic service"</code> e √© isso. <br><br>  Assim, no momento, temos a seguinte imagem: <br><br><img src="https://habrastorage.org/webt/du/0f/fd/du0ffdkzy6bqmyc6rvqj6p-jw7w.png"><br><br>  O terceiro arquivo, <code>Main.java</code> , √© onde o m√©todo <code>main()</code> √© implementado.  H√° um pouco de m√°gica nele, para entender o que voc√™ precisa saber o que √© uma camada de m√≥dulo. <br><br><h2>  Sobre as camadas do m√≥dulo </h2><br>  Quando o Java inicia o aplicativo, todos os m√≥dulos da plataforma + m√≥dulos listados no argumento <code>--module-path</code> (e tamb√©m <code>classpath</code> , se houver) se enquadram na camada de <code>Boot</code> .  No nosso caso, se compilarmos o m√≥dulo core.jar e executarmos o <code>java --module-path core.jar --module core</code> na linha de comando, pelo menos os m√≥dulos <code>java.base</code> e <code>core</code> estar√£o na camada de <code>Boot</code> : <br><br><img src="https://habrastorage.org/webt/z5/ar/n-/z5arn-jtfurxwqjja-fxrbdfjbu.png"><br><br>  A camada de <code>Boot</code> est√° sempre presente em qualquer aplicativo Java e essa √© a menor configura√ß√£o poss√≠vel.  A maioria dos aplicativos existe em uma √∫nica camada de m√≥dulos.  No entanto, no nosso caso, queremos fazer o carregamento din√¢mico de plug- <code>plugins</code> pasta de <code>plugins</code> - <code>plugins</code> .  Poder√≠amos for√ßar o usu√°rio a corrigir a linha de inicializa√ß√£o do aplicativo, para que ele pr√≥prio adicione os plugins necess√°rios ao <code>--module-path</code> , mas essa n√£o ser√° a melhor solu√ß√£o.  Especialmente aquelas pessoas que n√£o s√£o programadores e n√£o entendem por que precisam subir em algum lugar e consertar algo para uma coisa t√£o simples. <br><br>  Felizmente, existe uma solu√ß√£o: Java permite que voc√™ crie suas pr√≥prias camadas de m√≥dulo em tempo de execu√ß√£o, que carregar√£o os m√≥dulos do local que precisamos.  Para nossos prop√≥sitos, uma nova camada de plug-ins ser√° suficiente, que ter√° uma camada de <code>Boot</code> como pai (qualquer camada deve ter um pai): <br><br><img src="https://habrastorage.org/webt/1-/yd/5i/1-yd5ikax42qfadybbu1uqbnkgo.png"><br><br>  O fato de a camada de plug-in ter a camada de <code>Boot</code> como pai significa que os m√≥dulos da camada de plug-in podem fazer refer√™ncia aos m√≥dulos da camada de <code>Boot</code> , mas n√£o vice-versa. <br><br>  Portanto, sabendo agora o que √© uma camada de m√≥dulo, voc√™ pode finalmente examinar o conte√∫do do arquivo <code>Main.java</code> : <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Path pluginsDir = Paths.get(<span class="hljs-string"><span class="hljs-string">"plugins"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      plugins ModuleFinder pluginsFinder = ModuleFinder.of(pluginsDir); //  ModuleFinder      plugins       List&lt;String&gt; plugins = pluginsFinder .findAll() .stream() .map(ModuleReference::descriptor) .map(ModuleDescriptor::name) .collect(Collectors.toList()); //  ,      (   ) Configuration pluginsConfiguration = ModuleLayer .boot() .configuration() .resolve(pluginsFinder, ModuleFinder.of(), plugins); //      ModuleLayer layer = ModuleLayer .boot() .defineModulesWithOneLoader(pluginsConfiguration, ClassLoader.getSystemClassLoader()); //     IService       Boot List&lt;IService&gt; services = IService.getServices(layer); for (IService service : services) { service.doJob(); } } }</span></span></code> </pre> <br>  Se esta √© a primeira vez que voc√™ est√° vendo esse c√≥digo, pode parecer muito complicado, mas essa √© uma sensa√ß√£o falsa devido ao grande n√∫mero de novas classes desconhecidas.  Se voc√™ entender um pouco sobre o significado das <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/module/ModuleFinder.html">classes ModuleFinder</a> , <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/module/Configuration.html">Configuration</a> e <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/ModuleLayer.html">ModuleLayer</a> , tudo se encaixar√°.  Al√©m disso, existem apenas algumas dezenas de linhas!  Essa √© toda a l√≥gica que √© escrita uma vez. <br><br><h2>  Descritor de m√≥dulo </h2><br>  H√° mais um (quarto) arquivo que n√£o consideramos: <code>module-info.java</code> .  Este √© o arquivo mais curto que cont√©m a declara√ß√£o do nosso m√≥dulo e uma descri√ß√£o dos servi√ßos (pontos de extens√£o): <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> core { <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> org.example.pluginapp.core; uses IService; provides IService with BasicService; }</code> </pre> <br>  O significado das linhas deste arquivo deve ser √≥bvio: <br><br><ul><li>  Primeiro, o m√≥dulo exporta o pacote <code>org.example.pluginapp.core</code> que os plugins possam herdar da interface <code>IService</code> (caso contr√°rio, o <code>IService</code> n√£o estaria acess√≠vel fora do m√≥dulo <code>core</code> ). </li><li>  Em segundo lugar, ele anuncia que est√° usando o <code>IService</code> . </li><li>  Terceiro, ele diz que fornece uma implementa√ß√£o do servi√ßo <code>IService</code> por meio da classe <code>BasicService</code> . </li></ul><br>  Como a declara√ß√£o do m√≥dulo √© escrita em Java, obtemos vantagens muito importantes: <i>verifica√ß√µes do compilador e garantias est√°ticas</i> .  Por exemplo, se comet√™ssemos um erro no nome dos tipos ou indic√°ssemos um pacote inexistente, ter√≠amos percebido imediatamente.  No caso de alguns OSGi, n√£o ter√≠amos nenhuma verifica√ß√£o no tempo de compila√ß√£o, pois a declara√ß√£o dos pontos de extens√£o seria gravada em XML. <br><br>  Ent√£o, o quadro est√° pronto.  Vamos tentar execut√°-lo: <br><br><pre> <code class="bash hljs">&gt; java --module-path core.jar --module core Basic service</code> </pre> <br>  O que aconteceu <br><br><ol><li>  Java tentou encontrar os m√≥dulos na pasta <code>plugins</code> e n√£o encontrou nenhum. </li><li>  Uma camada vazia foi criada. </li><li>  <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">O ServiceLoader</a> come√ßou a procurar todas as implementa√ß√µes do <code>IService</code> . </li><li>  Na camada vazia, ele n√£o encontrou nenhuma implementa√ß√£o de servi√ßo, pois n√£o h√° m√≥dulos l√°. </li><li>  Ap√≥s essa camada, ele continuou pesquisando na camada pai (ou seja, a camada <code>Boot</code> ) e encontrou uma implementa√ß√£o do <code>BasicService</code> no m√≥dulo <code>core</code> . </li><li>  Todas as implementa√ß√µes encontradas tiveram o m√©todo <code>doJob()</code> chamado.  Como apenas uma implementa√ß√£o foi encontrada, apenas o <code>"Basic service"</code> foi impresso. </li></ol><br><h2>  Escrevendo um plugin </h2><br>  Tendo escrito o n√∫cleo do nosso aplicativo, agora √© a hora de tentar escrever plugins para ele.  Vamos escrever dois plugins <code>plugin1</code> e <code>plugin2</code> : deixe a primeira impress√£o <code>"Service 1"</code> , a segunda - <code>"Service 2"</code> .  Para fazer isso, voc√™ precisa fornecer mais duas implementa√ß√µes <code>IService</code> no <code>plugin1</code> e <code>plugin2</code> respectivamente: <br><br><img src="https://habrastorage.org/webt/-o/3n/4v/-o3n4vlwhx-vwqxn7jpkunlamjq.png"><br><br>  Crie o primeiro plugin com dois arquivos: <br><br><pre> <code class="bash hljs">plugin1/ src/main/java/ org/example/pluginapp/plugin1/ Service1.java module-info.java</code> </pre> <br>  Arquivo <code>Service1.java</code> : <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Service1</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"Service 1"</span></span>); } }</code> </pre> <br>  Arquivo <code>module-info.java</code> : <br><br><pre> <code class="java hljs">‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> plugin1 { <span class="hljs-keyword"><span class="hljs-keyword">requires</span></span> core; provides IService with Service1; }</code> </pre> <br>  Observe que o <code>plugin1</code> √© dependente do <code>core</code> .  Este √© o princ√≠pio de invers√£o de depend√™ncia que mencionei anteriormente: o kernel n√£o depende de plugins, mas vice-versa. <br><br>  O segundo plugin √© completamente semelhante ao primeiro, ent√£o n√£o o darei aqui. <br><br>  Agora vamos coletar os plugins, coloc√°-los na pasta <code>plugins</code> e executar o aplicativo: <br><br><pre> <code class="bash hljs">&gt; java --module-path core.jar --module core Service 1 Service 2 Basic service</code> </pre> <br>  Hooray, os plugins foram apanhados!  Como isso aconteceu: <br><br><ol><li>  Java encontrou dois m√≥dulos na pasta <code>plugins</code> . </li><li>  Uma camada foi criada com dois m√≥dulos <code>plugins1</code> e <code>plugins2</code> . </li><li>  O ServiceLoader come√ßou a procurar todas as implementa√ß√µes do <code>IService</code> . </li><li>  Na camada de plug-in, ele encontrou duas implementa√ß√µes do servi√ßo <code>IService</code> . </li><li>  Depois disso, ele continuou pesquisando na camada pai (ou seja, na camada <code>Boot</code> ) e encontrou uma implementa√ß√£o do <code>BasicService</code> no m√≥dulo <code>core</code> . </li><li>  Todas as implementa√ß√µes encontradas tiveram o m√©todo <code>doJob()</code> chamado. </li></ol><br>  Observe que √© precisamente porque a pesquisa por provedores de servi√ßos come√ßa com as camadas filho e, em seguida, vai para as camadas pai, ent√£o <code>"Service 1"</code> e <code>"Service 2"</code> impressos primeiro e, em seguida, <code>"Basic Service"</code> .  Se voc√™ deseja que os servi√ßos sejam classificados para que os servi√ßos b√°sicos sejam os primeiros e depois os plug-ins, voc√™ pode ajustar o m√©todo <code>IService.getServices()</code> adicionando a classifica√ß√£o l√° (pode ser necess√°rio adicionar o m√©todo <code>int getOrdering()</code> √† interface <code>IService</code> ). <br><br><h2>  Sum√°rio </h2><br>  Ent√£o, mostrei como voc√™ pode organizar r√°pida e eficientemente um aplicativo Java de plug-in que possui as seguintes propriedades: <br><br><ul><li>  <b>Simplicidade:</b> para pontos de extens√£o e suas liga√ß√µes, apenas os recursos Java b√°sicos (interfaces, classes e <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/ServiceLoader.html">ServiceLoader</a> ) s√£o usados, sem estruturas, reflex√£o, anota√ß√µes e carregadores de classe. </li><li>  <b>Declarabilidade: os</b> pontos de extens√£o s√£o descritos nos descritores dos m√≥dulos.  Basta olhar para <code>module-info.java</code> e entender quais pontos de extens√£o existem e quais plugins contribuem para esses pontos. </li><li>  <b>Garantias est√°ticas:</b> em caso de erros nos descritores do m√≥dulo, o programa n√£o ser√° compilado.  Al√©m disso, como b√¥nus, se voc√™ usar o IntelliJ IDEA, receber√° avisos adicionais (por exemplo, se voc√™ esqueceu de usar <code>uses</code> e usar <code>ServiceLoader.load()</code> ) </li><li>  <b>Seguran√ßa: o</b> sistema Java modular verifica na inicializa√ß√£o se a configura√ß√£o dos m√≥dulos est√° correta e se recusa a executar o programa em caso de erros. </li></ul><br>  Repito, mostrei apenas a ideia.  Em um aplicativo de plug-in real, haveria dezenas a centenas de m√≥dulos e centenas a milhares de pontos de extens√£o. <br><br>  Decidi abordar esse t√≥pico porque, nos √∫ltimos 7 anos, tenho escrito um aplicativo modular usando o Eclipse RCP, no qual o not√≥rio OSGi √© usado como um sistema de plug-in e os descritores de plug-in s√£o escritos em XML.  Temos mais de uma centena de plugins e ainda estamos no Java 8. Mas mesmo se atualizarmos para uma nova vers√£o do Java, √© improv√°vel que usemos m√≥dulos Java, pois eles est√£o fortemente vinculados ao OSGi. <br><br>  Mas se voc√™ estiver escrevendo um aplicativo de plug-in do zero, os m√≥dulos Java s√£o uma das op√ß√µes poss√≠veis para sua implementa√ß√£o.  Lembre-se de que os m√≥dulos s√£o apenas uma ferramenta, n√£o uma meta. <br><br><h2>  Brevemente sobre mim </h2><br>  Fa√ßo programa√ß√£o h√° mais de 10 anos (8 deles em Java), respondo ao <a href="https://stackoverflow.com/users/706317/zhekakozlov">StackOverflow</a> e <a href="https://stackoverflow.com/users/706317/zhekakozlov">gerencio</a> meu pr√≥prio <a href="https://t.me/miniJUG">canal no Telegram</a> dedicado a Java. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479478/">https://habr.com/ru/post/pt479478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479462/index.html">Serializa√ß√£o em C ++</a></li>
<li><a href="../pt479464/index.html">Tubos e filtros. Exemplo de aplica√ß√£o e implementa√ß√£o usando Spring</a></li>
<li><a href="../pt479466/index.html">Habraiting 2019: estat√≠sticas e ranking dos melhores artigos de 2019</a></li>
<li><a href="../pt479468/index.html">Edge of Honesty e John Doe</a></li>
<li><a href="../pt479474/index.html">Por que a auto-organiza√ß√£o de equipes √© t√£o importante no Scrum e por que n√£o pode haver gerentes nele</a></li>
<li><a href="../pt479480/index.html">SARIF SDK e seus erros</a></li>
<li><a href="../pt479482/index.html">SARIF SDK e seus erros</a></li>
<li><a href="../pt479486/index.html">Programa√ß√£o heterog√™nea e oneAPI Toolkit. Palestra improvisada de especialistas da Intel responde √†s suas perguntas</a></li>
<li><a href="../pt479488/index.html">De um laptop - um servidor dom√©stico com energia redundante ao roteador Mikrotik</a></li>
<li><a href="../pt479492/index.html">Computa√ß√£o sem servidor baseada no OpenWhisk, parte 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>