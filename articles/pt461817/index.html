<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêß üòÆ üç™ CMake e C ++ - irm√£os para sempre üßëüèº‚Äçü§ù‚Äçüßëüèº ü§ë üòï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante o processo de desenvolvimento, gosto de alterar compiladores, modos de compila√ß√£o, vers√µes de depend√™ncia, executar an√°lises est√°ticas, medir ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CMake e C ++ - irm√£os para sempre</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461817/"><p><img src="https://habrastorage.org/webt/ac/a0/8-/aca08-xhl_t033obcrcqgxpmksk.png" alt="Amizade para sempre"></p><br><p>  Durante o processo de desenvolvimento, gosto de alterar compiladores, modos de compila√ß√£o, vers√µes de depend√™ncia, executar an√°lises est√°ticas, medir desempenho, coletar cobertura, gerar documenta√ß√£o etc.  E eu realmente amo o CMake, porque me permite fazer tudo o que quero. </p><br><p>  Muitos repreendem o CMake, e geralmente com justi√ßa, mas se voc√™ olhar, nem tudo √© t√£o ruim, e ultimamente √© <strong>muito bom</strong> , e a dire√ß√£o do desenvolvimento √© bastante positiva. </p><br><p>  Neste artigo, quero dizer como √© simples organizar uma biblioteca de cabe√ßalho C ++ no sistema CMake para obter a seguinte funcionalidade: </p><br><ol><li>  Montagem; </li><li>  Testes de inicializa√ß√£o autom√°tica; </li><li>  Medi√ß√£o da cobertura do c√≥digo; </li><li>  Instala√ß√£o; </li><li>  Documenta√ß√£o autom√°tica </li><li>  Gera√ß√£o de sandbox online; </li><li>  An√°lise est√°tica </li></ol><br><blockquote>  Quem j√° entende os pr√≥s e os fabricantes pode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fazer o download do modelo do projeto</a> e come√ßar a us√°-lo. </blockquote><a name="habracut"></a><br><a name="contents"></a><br><h2>  Conte√∫do </h2><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto de dentro para fora</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura do projeto</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arquivo principal do CMake (./CMakeLists.txt)</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Informa√ß√µes do Projeto</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes do Projeto</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes de compila√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Objetivo principal</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instala√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Testes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A documenta√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sandbox online</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para testes (test / CMakeLists.txt)</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Teste</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cobertura</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para documenta√ß√£o (doc / CMakeLists.txt)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para uma sandbox online (online / CMakeLists.txt)</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto fora</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assembl√©ia</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gera√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assembl√©ia</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_COVERAGE</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_TESTING</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_DOXYGEN_LANGUAGE</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Objetivos da assembl√©ia</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Por padr√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mylib-unit-tests</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verificar</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cobertura</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">doc</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">caixa de varinha</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exemplos</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As ferramentas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">An√°lise est√°tica</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Posf√°cio</a> </li></ol><br><a name="project-from-the-inside"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto de dentro para fora</a> </h2><br><a name="project-structure"></a><br><h3 id="struktura-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura do projeto</a> </h3><br><pre><code class="plaintext hljs">. ‚îú‚îÄ‚îÄ CMakeLists.txt ‚îú‚îÄ‚îÄ README.en.md ‚îú‚îÄ‚îÄ README.md ‚îú‚îÄ‚îÄ doc ‚îÇ  ‚îú‚îÄ‚îÄ CMakeLists.txt ‚îÇ  ‚îî‚îÄ‚îÄ Doxyfile.in ‚îú‚îÄ‚îÄ include ‚îÇ  ‚îî‚îÄ‚îÄ mylib ‚îÇ  ‚îî‚îÄ‚îÄ myfeature.hpp ‚îú‚îÄ‚îÄ online ‚îÇ  ‚îú‚îÄ‚îÄ CMakeLists.txt ‚îÇ  ‚îú‚îÄ‚îÄ mylib-example.cpp ‚îÇ  ‚îî‚îÄ‚îÄ wandbox.py ‚îî‚îÄ‚îÄ test ‚îú‚îÄ‚îÄ CMakeLists.txt ‚îú‚îÄ‚îÄ mylib ‚îÇ  ‚îî‚îÄ‚îÄ myfeature.cpp ‚îî‚îÄ‚îÄ test_main.cpp</code> </pre> <br><p>  Falaremos principalmente sobre como organizar os scripts do CMake, para que sejam analisados ‚Äã‚Äãem detalhes.  Todos podem ver o restante dos arquivos diretamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">na p√°gina do modelo do projeto</a> . </p><br><a name="cmakeliststxt"></a><br><h3 id="glavnyy-cmake-fayl-cmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arquivo principal do CMake (./CMakeLists.txt)</a> </h3><br><a name="project-information"></a><br><h4 id="informaciya-o-proektecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Informa√ß√µes do Projeto</a> </h4><br><p>  Primeiro de tudo, voc√™ precisa solicitar a vers√£o correta do sistema CMake.  O CMake est√° evoluindo, as assinaturas da equipe, o comportamento em diferentes condi√ß√µes est√£o mudando.  Para que o CMake entenda imediatamente o que queremos dele, precisamos corrigir imediatamente nossos requisitos para ele. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">cmake_minimum_required</span></span>(VERSION <span class="hljs-number"><span class="hljs-number">3.13</span></span>)</code> </pre> <br><p>  Em seguida, designamos nosso projeto, seu nome, vers√£o, idiomas usados ‚Äã‚Äãetc. (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code> project</code></a> ). </p><br><p>  Nesse caso, especificamos a linguagem <code>CXX</code> (que significa C ++) para que o CMake n√£o force e n√£o procure o compilador da linguagem C (por padr√£o, dois idiomas est√£o inclu√≠dos no CMake: C e C ++). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">project</span></span>(Mylib VERSION <span class="hljs-number"><span class="hljs-number">1.0</span></span> LANGUAGES CXX)</code> </pre> <br><p>  Aqui voc√™ pode verificar imediatamente se nosso projeto est√° inclu√≠do em outro projeto como um subprojeto.  Isso ajudar√° muito no futuro. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">get_directory_property</span></span>(IS_SUBPROJECT PARENT_DIRECTORY)</code> </pre> <br><a name="project-options"></a><br><h4 id="opcii-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes do Projeto</a> </h4><br><p>  N√≥s fornecemos duas op√ß√µes. </p><br><p>  A primeira op√ß√£o - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_TESTING</code></a> - para desativar os testes de unidade.  Isso pode ser necess√°rio se tivermos certeza de que tudo est√° em ordem com os testes e queremos, por exemplo, apenas instalar ou empacotar nosso projeto.  Ou nosso projeto √© inclu√≠do como um subprojeto - nesse caso, o usu√°rio do nosso projeto n√£o est√° interessado em executar nossos testes.  Voc√™ n√£o testa as depend√™ncias que voc√™ usa? </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">option</span></span>(MYLIB_TESTING <span class="hljs-string"><span class="hljs-string">"  "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  Al√©m disso, faremos uma op√ß√£o separada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_COVERAGE</code></a> para medir a cobertura do c√≥digo com testes, mas ser√£o necess√°rias ferramentas adicionais, portanto voc√™ precisar√° ativ√°-lo explicitamente. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">option</span></span>(MYLIB_COVERAGE <span class="hljs-string"><span class="hljs-string">"    "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>)</code> </pre> <br><a name="compile-options"></a><br><h4 id="opcii-kompilyaciicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes de compila√ß√£o</a> </h4><br><p>  √â claro que somos programadores legais e esperamos o n√≠vel m√°ximo de diagn√≥stico de tempo de compila√ß√£o do compilador.  Nem um √∫nico mouse passar√°. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_compile_options</span></span>( -Werror -Wall -Wextra -Wpedantic -Wcast-align -Wcast-qual -Wconversion -Wctor-dtor-privacy -Wenum-compare -Wfloat-<span class="hljs-keyword"><span class="hljs-keyword">equal</span></span> -Wnon-virtual-dtor -Wold-style-cast -Woverloaded-virtual -Wredundant-decls -Wsign-conversion -Wsign-promo )</code> </pre> <br><p>  Desabilitaremos tamb√©m as extens√µes para cumprir totalmente com o padr√£o da linguagem C ++.  Por padr√£o, eles est√£o inclu√≠dos no CMake. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> CMAKE_CXX_EXTENSIONS) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(CMAKE_CXX_EXTENSIONS <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="main-target"></a><br><h4 id="osnovnaya-celcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Objetivo principal</a> </h4><br><p>  Nossa biblioteca consiste apenas em arquivos de cabe√ßalho, o que significa que n√£o temos exaust√£o na forma de bibliotecas est√°ticas ou din√¢micas.  Por outro lado, para usar nossa biblioteca de fora, √© necess√°rio instal√°-la, ser capaz de encontr√°-la no sistema e conect√°-la ao seu projeto e, ao mesmo tempo, esses mesmos cabe√ßalhos, bem como, possivelmente, alguns adicionais propriedades. </p><br><p>  Para esse fim, criamos uma biblioteca de interfaces. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_library</span></span>(mylib INTERFACE)</code> </pre> <br><p>  Vincule os cabe√ßalhos √† nossa biblioteca front-end. </p><br><p>  O uso moderno, elegante e jovem do CMake implica que cabe√ßalhos, propriedades etc.  transmitido atrav√©s de uma √∫nica finalidade.  Portanto, basta dizer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>target_link_libraries(target PRIVATE dependency)</code></a> e todos os cabe√ßalhos associados ao destino de <code>dependency</code> estar√£o dispon√≠veis para fontes pertencentes ao <code>target</code> .  E nenhum <code>[target_]include_directories</code> √© necess√°rio.  Isso ser√° demonstrado abaixo ao analisar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">script CMake para testes de unidade</a> . </p><br><p>  Tamb√©m vale a pena prestar aten√ß√£o aos chamados  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>-: $&lt;...&gt;</code></a> . </p><br><p>  Este comando associa os cabe√ßalhos necess√°rios √† nossa biblioteca front-end e, se a nossa biblioteca estiver conectada a um destino na mesma hierarquia do CMake, os cabe√ßalhos do diret√≥rio <code>${CMAKE_CURRENT_SOURCE_DIR}/include</code> ser√£o associados a ele e, se o nosso Como a biblioteca est√° instalada no sistema e conectada a outro projeto usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>find_package</code></a> , os cabe√ßalhos do diret√≥rio de <code>include</code> relativos ao diret√≥rio de instala√ß√£o ser√£o associados a ele. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_include_directories</span></span>(mylib INTERFACE $&lt;BUILD_INTERFACE:<span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_SOURCE_DIR}</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>&gt; $&lt;INSTALL_INTERFACE:<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>&gt; )</code> </pre> <br><p>  Defina o padr√£o do idioma.  Claro, o √∫ltimo.  Ao mesmo tempo, n√£o apenas inclu√≠mos o padr√£o, mas tamb√©m o distribu√≠mos para aqueles que usar√£o nossa biblioteca.  Isso √© alcan√ßado devido ao fato de a propriedade set ter a categoria <code>INTERFACE</code> (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o comando target_compile_features</a> ). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_compile_features</span></span>(mylib INTERFACE cxx_std_17)</code> </pre> <br><p>  Criamos um alias para nossa biblioteca.  Al√©m disso, para a beleza, ele estar√° em um "espa√ßo para nome" especial.  Isso ser√° √∫til quando diferentes m√≥dulos aparecerem em nossa biblioteca e vamos conect√°-los independentemente um do outro.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como no Boost, por exemplo</a> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_library</span></span>(Mylib::mylib ALIAS mylib)</code> </pre> <br><a name="installation"></a><br><h4 id="ustanovkacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instala√ß√£o</a> </h4><br><p>  Instalando nossos cabe√ßalhos no sistema.  Tudo √© simples aqui.  Dizemos que a pasta com todos os cabe√ßalhos deve estar no diret√≥rio de <code>include</code> relativo ao local da instala√ß√£o. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(DIRECTORY <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/mylib DESTINATION <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>)</code> </pre> <br><p>  Em seguida, informamos o sistema de compila√ß√£o que queremos chamar <code>find_package(Mylib)</code> em projetos de terceiros e obtemos o <code>Mylib::mylib</code> destino. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(TARGETS mylib <span class="hljs-keyword"><span class="hljs-keyword">EXPORT</span></span> MylibConfig) <span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">EXPORT</span></span> MylibConfig NAMESPACE Mylib:: DESTINATION share/Mylib/cmake)</code> </pre> <br><p>  O pr√≥ximo feiti√ßo deve ser entendido da seguinte forma.  Quando chamamos <code>find_package(Mylib 1.2.3 REQUIRED)</code> em um projeto de terceiros e, nesse caso, a vers√£o real da biblioteca instalada ser√° incompat√≠vel com a vers√£o <code>1.2.3</code> , o CMake gerar√° automaticamente um erro.  Ou seja, voc√™ n√£o precisar√° seguir as vers√µes manualmente. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(CMakePackageConfigHelpers) write_basic_package_version_file(<span class="hljs-string"><span class="hljs-string">"${PROJECT_BINARY_DIR}/MylibConfigVersion.cmake"</span></span> VERSION <span class="hljs-variable"><span class="hljs-variable">${PROJECT_VERSION}</span></span> COMPATIBILITY AnyNewerVersion ) <span class="hljs-keyword"><span class="hljs-keyword">install</span></span>(FILES <span class="hljs-string"><span class="hljs-string">"${PROJECT_BINARY_DIR}/MylibConfigVersion.cmake"</span></span> DESTINATION share/Mylib/cmake)</code> </pre> <br><a name="tests"></a><br><h4 id="testycontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Testes</a> </h4><br><p>  Se os testes forem desativados explicitamente usando a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">op√ß√£o apropriada</a> ou se o nosso projeto for um subprojeto, ou seja, conectado a outro projeto do CMake usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>add_subdirectory</code></a> , n√£o iremos mais al√©m na hierarquia, e o script que descreve os comandos para gerar e executar os testes simplesmente n√£o ser√° iniciado . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> MYLIB_TESTING) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"  Mylib "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"Mylib     "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="documentation"></a><br><h4 id="dokumentaciyacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A documenta√ß√£o</a> </h4><br><p>  A documenta√ß√£o tamb√©m n√£o ser√° gerada no caso de um subprojeto. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(doc) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="online-sandbox"></a><br><h4 id="onlayn-pesochnicacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sandbox online</a> </h4><br><p>  Da mesma forma, o subprojeto tamb√©m n√£o ter√° caixas de prote√ß√£o online. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> IS_SUBPROJECT) <span class="hljs-keyword"><span class="hljs-keyword">add_subdirectory</span></span>(online) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="testcmakeliststxt"></a><br><h3 id="skript-dlya-testov-testcmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para testes (test / CMakeLists.txt)</a> </h3><br><a name="testing"></a><br><h4 id="testirovaniecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Teste</a> </h4><br><p>  Primeiro de tudo, encontramos o pacote com a estrutura de teste desejada (substitua-a pela sua favorita). </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_package</span></span>(doctest <span class="hljs-number"><span class="hljs-number">2.3</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> REQUIRED)</code> </pre> <br><p>  Criamos nosso arquivo execut√°vel com testes.  Normalmente, adiciono apenas o arquivo no qual a fun√ß√£o <code>main</code> estar√° diretamente no bin√°rio execut√°vel. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_executable</span></span>(mylib-unit-tests test_main.cpp)</code> </pre> <br><p>  E os arquivos que descrevem os pr√≥prios testes s√£o adicionados mais tarde.  Mas isso n√£o √© necess√°rio. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_sources</span></span>(mylib-unit-tests PRIVATE mylib/myfeature.cpp)</code> </pre> <br><p>  Conectamos depend√™ncias.  Observe que <code>target_include_directories</code> apenas <code>target_include_directories</code> destinos <code>target_include_directories</code> CMake que precis√°vamos ao nosso bin√°rio e n√£o chamamos o comando <code>target_include_directories</code> .  Os cabe√ßalhos da estrutura de teste e do nosso <code>Mylib::mylib</code> , bem como os par√¢metros de constru√ß√£o (no nosso caso, esse √© o padr√£o da linguagem C ++) rastrearam junto com esses objetivos. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">target_link_libraries</span></span>(mylib-unit-tests PRIVATE Mylib::mylib doctest::doctest )</code> </pre> <br><p>  Por fim, crie um destino fict√≠cio, cujo "assembly" seja equivalente √† execu√ß√£o de testes e inclua esse destino no assembly padr√£o (o atributo <code>ALL</code> √© respons√°vel por isso).  Isso significa que a montagem, por padr√£o, inicia o lan√ßamento dos testes, ou seja, nunca esqueceremos de execut√°-los. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(check ALL <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> mylib-unit-tests)</code> </pre> <br><a name="code-coverage"></a><br><h4 id="pokrytiecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cobertura</a> </h4><br><p>  Em seguida, habilitamos a medi√ß√£o da cobertura do c√≥digo, se a op√ß√£o correspondente for especificada.  N√£o vou entrar em detalhes, porque eles se relacionam mais com a ferramenta para medir a cobertura do que com o CMake.  √â importante observar que, com base nos resultados, ser√° criada uma meta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>coverage</code></a> , com a qual √© conveniente come√ßar a medir a cobertura. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_program</span></span>(GCOVR_EXECUTABLE gcovr) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> GCOVR_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"    "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">target_compile_options</span></span>(mylib-unit-tests PRIVATE --coverage) <span class="hljs-keyword"><span class="hljs-keyword">target_link_libraries</span></span>(mylib-unit-tests PRIVATE gcov) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(coverage <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${GCOVR_EXECUTABLE}</span></span> --root=<span class="hljs-variable"><span class="hljs-variable">${PROJECT_SOURCE_DIR}</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>/ --object-directory=<span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_BINARY_DIR}</span></span> DEPENDS check ) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> GCOVR_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(MYLIB_COVERAGE <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(WARNING <span class="hljs-string"><span class="hljs-string">"       gcovr"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="doccmakeliststxt"></a><br><h3 id="skript-dlya-dokumentacii-doccmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para documenta√ß√£o (doc / CMakeLists.txt)</a> </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Doxig√™nio encontrado</a> . </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_package</span></span>(Doxygen)</code> </pre> <br><p>  Em seguida, verificamos se o usu√°rio definiu a vari√°vel de idioma.  Se sim, ent√£o n√£o toque, se n√£o, ent√£o pegue russo.  Em seguida, configure os arquivos do sistema Doxygen.  Todas as vari√°veis ‚Äã‚Äãnecess√°rias, incluindo o idioma, chegam l√° durante o processo de configura√ß√£o (consulte o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code> configure_file</code></a> ). </p><br><p>  Em seguida, criamos o destino do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>doc</code></a> , que iniciar√° a gera√ß√£o da documenta√ß√£o.  Como a gera√ß√£o de documenta√ß√£o n√£o √© a maior necessidade no processo de desenvolvimento, por padr√£o o objetivo n√£o ser√° habilitado, ele dever√° ser iniciado explicitamente. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Doxygen_FOUND) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> MYLIB_DOXYGEN_LANGUAGE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(MYLIB_DOXYGEN_LANGUAGE Russian) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(STATUS <span class="hljs-string"><span class="hljs-string">"Doxygen documentation will be generated in ${MYLIB_DOXYGEN_LANGUAGE}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">configure_file</span></span>(Doxyfile.in Doxyfile) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(doc <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${DOXYGEN_EXECUTABLE}</span></span> <span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_BINARY_DIR}</span></span>/Doxyfile) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span> ()</code> </pre> <br><a name="onlinecmakeliststxt"></a><br><h3 id="skript-dlya-onlayn-pesochnicy-onlinecmakeliststxtcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Script para uma sandbox online (online / CMakeLists.txt)</a> </h3><br><p>  Aqui encontramos o terceiro Python e criamos um destino <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>wandbox</code></a> que gera uma solicita√ß√£o que corresponde √† API do servi√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wandbox</a> e a envia.  Em resposta, √© fornecido um link para a sandbox conclu√≠da. </p><br><pre> <code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">find_program</span></span>(PYTHON3_EXECUTABLE python3) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(PYTHON3_EXECUTABLE) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(WANDBOX_URL <span class="hljs-string"><span class="hljs-string">"https://wandbox.org/api/compile.json"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">add_custom_target</span></span>(wandbox <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> <span class="hljs-variable"><span class="hljs-variable">${PYTHON3_EXECUTABLE}</span></span> wandbox.py mylib-example.cpp <span class="hljs-string"><span class="hljs-string">"${PROJECT_SOURCE_DIR}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> | curl -H <span class="hljs-string"><span class="hljs-string">"Content-type: application/json"</span></span> -d @- <span class="hljs-variable"><span class="hljs-variable">${WANDBOX_URL}</span></span> WORKING_DIRECTORY <span class="hljs-variable"><span class="hljs-variable">${CMAKE_CURRENT_SOURCE_DIR}</span></span> DEPENDS mylib-unit-tests ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">message</span></span>(WARNING <span class="hljs-string"><span class="hljs-string">"  -    python 3- "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br><a name="project-from-the-outside"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto fora</a> </h2><br><p>  Agora considere como usar tudo. </p><br><a name="build"></a><br><h3 id="sborkacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assembl√©ia</a> </h3><br><p>  A montagem deste projeto, como qualquer outro projeto no sistema de montagem do CMake, consiste em dois est√°gios: </p><br><a name="generate"></a><br><h4 id="generaciyacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gera√ß√£o</a> </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// [ ...]</code> </pre> <br><blockquote>  Se o comando acima n√£o funcionou devido √† vers√£o antiga do CMake, tente omitir <code>-S</code> : <br><pre> <code class="plaintext hljs">cmake // -B /// [ ...]</code> </pre> <br></blockquote><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mais sobre op√ß√µes</a> . </p><br><a name="project-build"></a><br><h4 id="sborka-proektacontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Montagem do projeto</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// [--target target]</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Leia mais sobre metas de montagem</a> . </p><br><a name="options"></a><br><h3 id="opciicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Op√ß√µes</a> </h3><br><a name="MYLIB_COVERAGE"></a><br><h4 id="mylib_coveragecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_COVERAGE</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_COVERAGE=ON [  ...]</code> </pre> <br><p>  Inclui uma meta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>coverage</code></a> , com a qual voc√™ pode come√ßar a medir a cobertura do c√≥digo com testes. </p><br><a name="MYLIB_TESTING"></a><br><h4 id="mylib_testingcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_TESTING</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_TESTING=OFF [  ...]</code> </pre> <br><p>  Fornece a capacidade de desligar o conjunto de teste da unidade e o alvo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>check</code></a> .  Como resultado, a medi√ß√£o da cobertura do c√≥digo por testes √© desativada (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_COVERAGE</code></a> ). </p><br><p>  Al√©m disso, o teste √© desativado automaticamente se o projeto estiver conectado a outro projeto como um subprojeto usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>add_subdirectory</code></a> . </p><br><a name="MYLIB_DOXYGEN_LANGUAGE"></a><br><h4 id="mylib_doxygen_languagecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MYLIB_DOXYGEN_LANGUAGE</a> </h4><br><pre> <code class="plaintext hljs">cmake -S ... -B ... -DMYLIB_DOXYGEN_LANGUAGE=English [  ...]</code> </pre> <br><p>  Alterna o idioma da documenta√ß√£o que o destino do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>doc</code></a> gera para o especificado.  Para obter uma lista dos idiomas dispon√≠veis, consulte o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Doxygen</a> . </p><br><p>  Por padr√£o, o russo est√° ativado. </p><br><a name="build-targets"></a><br><h3 id="sborochnye-celicontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Objetivos da assembl√©ia</a> </h3><br><a name="default-target"></a><br><h4 id="po-umolchaniyucontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Por padr√£o</a> </h4><br><pre> <code class="plaintext hljs">cmake --build path/to/build/directory cmake --build path/to/build/directory --target all</code> </pre> <br><p>  Se o alvo n√£o for especificado (o que equivale ao objetivo de <code>all</code> ), coleciona tudo o que √© poss√≠vel e tamb√©m chama o alvo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>check</code></a> . </p><br><a name="mylib-unit-tests"></a><br><h4 id="mylib-unit-testscontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">mylib-unit-tests</a> </h4><br><pre> <code class="plaintext hljs">cmake --build path/to/build/directory --target mylib-unit-tests</code> </pre> <br><p>  Compila testes de unidade.  Ativado por padr√£o. </p><br><a name="check"></a><br><h4 id="checkcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verificar</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target check</code> </pre> <br><p>  Executa testes de unidade coletados (coleta, se ainda n√£o).  Ativado por padr√£o. </p><br><p>  Veja tamb√©m <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>mylib-unit-tests</code></a> . </p><br><a name="coverage"></a><br><h4 id="coveragecontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cobertura</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target coverage</code> </pre> <br><p>  Analisa a execu√ß√£o (executa, se ainda n√£o) de testes de unidade para cobrir o c√≥digo com testes usando o programa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gcovr</a> . </p><br><p>  A exaust√£o do revestimento ser√° mais ou menos assim: </p><br><pre> <code class="plaintext hljs">------------------------------------------------------------------------------ GCC Code Coverage Report Directory: /path/to/cmakecpptemplate/include/ ------------------------------------------------------------------------------ File Lines Exec Cover Missing ------------------------------------------------------------------------------ mylib/myfeature.hpp 2 2 100% ------------------------------------------------------------------------------ TOTAL 2 2 100% ------------------------------------------------------------------------------</code> </pre> <br><p>  O destino est√° dispon√≠vel apenas quando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_COVERAGE</code></a> . </p><br><p>  Veja tamb√©m <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>check</code></a> . </p><br><a name="doc"></a><br><h4 id="doccontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">doc</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target doc</code> </pre> <br><p>  Inicia a gera√ß√£o da documenta√ß√£o do c√≥digo usando o sistema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Doxygen</a> . </p><br><a name="wandbox"></a><br><h4 id="wandboxcontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">caixa de varinha</a> </h4><br><pre> <code class="plaintext hljs">cmake --build /// --target wandbox</code> </pre> <br><p>  A resposta do servi√ßo √© mais ou menos assim: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"permlink"</span></span> : <span class="hljs-string"><span class="hljs-string">"QElvxuMzHgL9fqci"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span> : <span class="hljs-string"><span class="hljs-string">"https://wandbox.org/permlink/QElvxuMzHgL9fqci"</span></span> }</code> </pre> <br><p>  Para fazer isso, use o servi√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wandbox</a> .  N√£o sei como eles t√™m servidores de borracha, mas acho que essa oportunidade n√£o deve ser abusada. </p><br><a name="examples"></a><br><h3 id="primerycontents">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exemplos</a> </h3><br><h4 id="sborka-proekta-v-otladochnom-rezhime-s-zamerom-pokrytiya">  Montagem do projeto no modo de depura√ß√£o com medi√ß√£o de cobertura </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug -DMYLIB_COVERAGE=ON cmake --build /// --target coverage --parallel 16</code> </pre> <br><h4 id="ustanovka-proekta-bez-predvaritelnoy-sborki-i-testirovaniya">  Instala√ß√£o do projeto sem montagem e teste preliminares </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DMYLIB_TESTING=OFF -DCMAKE_INSTALL_PREFIX=/// cmake --build /// --target install</code> </pre> <br><h4 id="sborka-v-vypusknom-rezhime-zadannym-kompilyatorom">  Construir no modo de libera√ß√£o pelo compilador especificado </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_COMPILER=g++-8 -DCMAKE_PREFIX_PATH=///// cmake --build /// --parallel 4</code> </pre> <br><h4 id="generirovanie-dokumentacii-na-angliyskom">  Gera√ß√£o de documenta√ß√£o em ingl√™s </h4><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Release -DMYLIB_DOXYGEN_LANGUAGE=English cmake --build /// --target doc</code> </pre> <br><a name="tools"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As ferramentas</a> </h2><br><ol><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CMake</a> 3.13 </p><br><p>  De fato, o CMake 3.13 √© necess√°rio apenas para executar alguns dos comandos do console descritos nesta ajuda.  Do ponto de vista da sintaxe dos scripts do CMake, a vers√£o 3.8 √© suficiente se a gera√ß√£o for chamada de outras maneiras. </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Biblioteca de</a> testes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Doctest</a> </p><br><p>  O teste pode ser desativado (consulte a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code> MYLIB_TESTING</code></a> ). </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Doxygen</a> </p><br><p>  Para alternar o idioma em que a documenta√ß√£o ser√° gerada, a op√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_DOXYGEN_LANGUAGE</code></a> √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>MYLIB_DOXYGEN_LANGUAGE</code></a> . </p><br></li><li><p>  Int√©rprete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Python 3</a> </p><br><p>  Para gerar automaticamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">caixas de prote√ß√£o online</a> . </p><br></li></ol><br><a name="static-analysis"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">An√°lise est√°tica</a> </h2><br><p>  Com o CMake e algumas boas ferramentas, voc√™ pode fornecer an√°lises est√°ticas com movimentos m√≠nimos do corpo. </p><br><h4 id="cppcheck">  Cppcheck </h4><br><p>  O CMake possui suporte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">interno</a> para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ferramenta de</a> an√°lise est√°tica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cppcheck</a> . </p><br><p>  Para fazer isso, use a op√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>CMAKE_CXX_CPPCHECK</code></a> : </p><br><pre> <code class="plaintext hljs">cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug -DCMAKE_CXX_CPPCHECK="cppcheck;--enable=all;-I///include"</code> </pre> <br><p>  Depois disso, a an√°lise est√°tica ser√° iniciada automaticamente todas as vezes durante a compila√ß√£o e recompila√ß√£o das fontes.  Voc√™ n√£o precisa fazer nada extra. </p><br><h4 id="clang">  Clang </h4><br><p>  Usando a maravilhosa ferramenta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>scan-build</code></a> , voc√™ tamb√©m pode executar a an√°lise est√°tica em duas contagens: </p><br><pre> <code class="plaintext hljs">scan-build cmake -S // -B /// -DCMAKE_BUILD_TYPE=Debug scan-build cmake --build ///</code> </pre> <br><p>  Aqui, diferentemente do caso do Cppcheck, voc√™ precisa executar a montagem todas as vezes atrav√©s do <code>scan-build</code> . </p><br><a name="afterword"></a><br><h2>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Posf√°cio</a> </h2><br><p>  O CMake √© um sistema muito poderoso e flex√≠vel que permite implementar funcionalidades para todos os gostos e cores.  E, embora a sintaxe √†s vezes deixe muito a desejar, o diabo ainda n√£o √© t√£o terr√≠vel quanto √© pintado.  Use o sistema de cria√ß√£o do CMake para o benef√≠cio da sociedade e da sa√∫de. </p><br><hr><br><p>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Baixar modelo de projeto</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt461817/">https://habr.com/ru/post/pt461817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt461803/index.html">Data Version Control (DVC): controle de vers√£o de dados e reprodutibilidade do experimento</a></li>
<li><a href="../pt461805/index.html">Aplicativo de Integra√ß√£o Monte Carlo em Renderiza√ß√£o</a></li>
<li><a href="../pt461807/index.html">Como as prioridades do pod em Kubernetes causaram o tempo de inatividade no Grafana Labs</a></li>
<li><a href="../pt461813/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 470 (16.07.2019 - 22/07/2014)</a></li>
<li><a href="../pt461815/index.html">Uma revolu√ß√£o no design de fontes de alimenta√ß√£o para computadores meio s√©culo atr√°s</a></li>
<li><a href="../pt461819/index.html">Por que o design simples de sites √© melhor cientificamente</a></li>
<li><a href="../pt461821/index.html">Nova imunoterapia removeu todos os tumores de uma mulher com c√¢ncer de mama metast√°tico</a></li>
<li><a href="../pt461823/index.html">Quatro regras aprimoradas para design de software</a></li>
<li><a href="../pt461827/index.html">Desenvolvimento de aplicativos h√≠bridos PHP / Go usando RoadRunner</a></li>
<li><a href="../pt461829/index.html">TCP vs UDP ou o futuro dos protocolos de rede</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>