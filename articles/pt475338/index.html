<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥ üò® üçõ Se voc√™ n√£o possui Python, mas existe um modelo Keras e Java üéñÔ∏è üëÜüèº üîÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! Atualmente, na constru√ß√£o de modelos ML, o Python ocupa uma posi√ß√£o de lideran√ßa e √© amplamente popular entre a comunidade de especialist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Se voc√™ n√£o possui Python, mas existe um modelo Keras e Java</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/naumen/blog/475338/">  Ol√° pessoal!  Atualmente, na constru√ß√£o de modelos ML, o Python ocupa uma posi√ß√£o de lideran√ßa e √© amplamente popular entre a comunidade de especialistas em Ci√™ncia de Dados [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1</a> ]. <br><br>  Como a maioria dos desenvolvedores, o Python nos atrai com sua simplicidade e sintaxe concisa.  N√≥s o usamos para resolver problemas de aprendizado de m√°quina usando redes neurais artificiais.  No entanto, na pr√°tica, a linguagem de desenvolvimento de produto nem sempre √© Python, e isso exige que resolvamos problemas de integra√ß√£o adicionais. <br><br>  Neste artigo, falarei sobre as solu√ß√µes que encontramos quando precisamos associar o modelo Keras do Python ao Java. <br><br>  Em que prestamos aten√ß√£o: <br><br><ul><li>  Pacote de recursos do modelo Keras e Java; </li><li>  Preparando-se para trabalhar com a estrutura do DeepLearning4j (abrevia√ß√£o do DL4J); </li><li>  Importando um modelo Keras para DL4J (com cuidado, a se√ß√£o cont√©m v√°rios insights) - como registrar camadas, quais limita√ß√µes o m√≥dulo de importa√ß√£o possui, como verificar os resultados de seu trabalho. </li></ul><br>  Por que ler? <br><br><ul><li>  Para economizar tempo no in√≠cio, se voc√™ enfrentar a tarefa de integra√ß√£o semelhante; </li><li>  Para descobrir se nossa solu√ß√£o √© adequada para voc√™ e se voc√™ pode reutilizar nossa experi√™ncia. </li></ul><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2m/2k/xj/2m2kxjbwgahv1gx0wejstn2qpjw.png" alt="imagem alt"></div><br>  Caracter√≠stica integral sobre a import√¢ncia dos quadros de aprendizagem profunda [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2</a> ]. <br><br>  Um resumo das estruturas de aprendizagem profunda mais populares pode ser encontrado aqui [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3</a> ] e aqui [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4</a> ]. <br><br>  Como voc√™ pode ver, a maioria dessas estruturas √© baseada em Python e C ++: eles usam C ++ como o kernel para acelerar opera√ß√µes b√°sicas e altamente carregadas, e Python como a interface de intera√ß√£o para acelerar o desenvolvimento. <br><br>  De fato, muitas linguagens de desenvolvimento s√£o muito mais extensas.  Java √© l√≠der em desenvolvimento de produtos para grandes empresas e organiza√ß√µes.  Algumas estruturas populares para redes neurais t√™m portas para Java na forma de ligadores JNI / JNA, mas nesse caso, √© necess√°rio criar um projeto para cada arquitetura e a vantagem do Java na quest√£o do desfoque entre plataformas.  Essa nuance pode ser extremamente importante em solu√ß√µes replicadas. <br><br>  Outra abordagem alternativa √© usar o Jython para compilar no bytecode Java;  mas h√° uma desvantagem aqui: suporte apenas √† segunda vers√£o do Python, al√©m da capacidade limitada de usar bibliotecas Python de terceiros. <br><br>  Para simplificar o desenvolvimento de solu√ß√µes de redes neurais em Java, a estrutura DeepLearning4j (DL4J para abreviar) est√° sendo desenvolvida.  O DL4, al√©m da API Java, oferece um conjunto de modelos pr√©-treinados [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5</a> ].  Em geral, essa ferramenta de desenvolvimento √© dif√≠cil de competir com o TensorFlow.  O TensorFlow supera o DL4J com documenta√ß√£o mais detalhada e v√°rios exemplos, recursos t√©cnicos, tamanhos de comunidade e desenvolvimento acelerado.  No entanto, a tend√™ncia que Skymind adere √© bastante promissora.  Concorrentes significativos em Java para esta ferramenta ainda n√£o est√£o vis√≠veis. <br><br>  A biblioteca DL4J √© uma das poucas (se n√£o a √∫nica) que possibilita a importa√ß√£o de modelos Keras; ela expande sua funcionalidade com camadas familiares a Keras [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6</a> ].  A biblioteca DL4J cont√©m um diret√≥rio com exemplos da implementa√ß√£o de modelos ML de rede neural (exemplo dl4j).  No nosso caso, as sutilezas da implementa√ß√£o desses modelos em Java n√£o s√£o t√£o interessantes.  Aten√ß√£o mais detalhada ser√° dada √† importa√ß√£o do modelo treinado Keras / TF para Java usando m√©todos DL4J. <br><br><h1>  Introdu√ß√£o </h1><br>  Antes de come√ßar, voc√™ precisa instalar os programas necess√°rios: <br><br><ol><li>  Java vers√£o 1.7 (vers√£o de 64 bits) e superior. </li><li>  Sistema de cria√ß√£o de projetos do Apache Maven. </li><li>  IDE para escolher: Intellij IDEA, Eclipse, Netbeans.  Os desenvolvedores recomendam a primeira op√ß√£o e, al√©m disso, os exemplos de treinamento dispon√≠veis s√£o discutidos. </li><li>  Git (para clonar um projeto no seu PC). </li></ol><br>  Uma descri√ß√£o detalhada com um exemplo de lan√ßamento pode ser encontrada aqui [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7</a> ] ou no v√≠deo [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">8</a> ]. <br><br>  Para importar o modelo, os desenvolvedores do DL4J sugerem o uso do <em>m√≥dulo de</em> importa√ß√£o <em>KerasModelImport</em> (publicado em outubro de 2016).  O funcional do m√≥dulo suporta ambas as arquiteturas de modelos da Keras - √© Sequencial (anal√≥gico na classe Java MultiLayerNetwork) e Funcional (anal√≥gico na classe Java ComputationGraph).  O modelo √© importado como um todo no formato HDF5 ou 2 arquivos separados - o peso do modelo com a extens√£o h5 e o arquivo json que cont√©m a arquitetura de rede neural. <br><br>  Para um in√≠cio r√°pido, os desenvolvedores do DL4J prepararam uma an√°lise passo a passo de um exemplo simples no conjunto de dados da √≠ris Fisher para um modelo do tipo Sequential [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">9</a> ].  Outro exemplo de treinamento foi considerado da perspectiva de importa√ß√£o de modelos de duas maneiras (1: no formato HDF5 completo; 2: em arquivos separados - pesos do modelo (extens√£o h5) e arquitetura (extens√£o json)), seguidos de uma compara√ß√£o dos resultados dos modelos Python e Java [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">10</a> ].  Isso conclui a discuss√£o dos recursos pr√°ticos do m√≥dulo de importa√ß√£o. <br><br>  Tamb√©m existe TF em Java, mas est√° em um estado experimental e os desenvolvedores n√£o d√£o nenhuma garantia de sua opera√ß√£o est√°vel [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">11</a> ].  H√° problemas com o controle de vers√£o e o TF em Java possui uma API incompleta - e √© por isso que essa op√ß√£o n√£o ser√° considerada aqui. <br><br><h1>  Caracter√≠sticas do modelo Keras / TF original: </h1><br>  A importa√ß√£o de uma rede neural √© simples.  Mais detalhadamente no c√≥digo, analisaremos um exemplo de integra√ß√£o de uma rede neural com arquitetura mais complicada. <br><br>  Voc√™ n√£o deve entrar nos aspectos pr√°ticos deste modelo, pois √© indicativo do ponto de vista da contabiliza√ß√£o de camadas (em particular, registro de camadas Lambda), algumas sutilezas e limita√ß√µes do m√≥dulo de importa√ß√£o, bem como o DL4J como um todo.  Na pr√°tica, as nuances observadas podem exigir ajustes na arquitetura da rede ou abandonar completamente a abordagem de iniciar o modelo atrav√©s do DL4J. <br><br>  Caracter√≠sticas do modelo: <br><br>  <b>1.</b> Tipo de modelo - Funcional (rede com ramifica√ß√£o); <br><br>  <b>2.</b> Os par√¢metros de treinamento (o tamanho do lote, o n√∫mero de eras) s√£o selecionados pequenos: o tamanho do lote - 100, o n√∫mero de eras - 10, etapas por √©poca - 10; <br><br>  <b>3.</b> 13 camadas, um resumo das camadas √© mostrado na figura: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/85/of/hn/85ofhnioy_usez2msaeqpt2whja.png" alt="imagem alt"></div><br><div class="spoiler">  <b class="spoiler_title">Descri√ß√£o curta da camada</b> <div class="spoiler_text"><ol><li>  input_1 - camada de entrada, aceita um tensor bidimensional (representado por uma matriz); </li><li>  lambda_1 - a camada do usu√°rio, no nosso caso, torna o preenchimento no TF do tensor os mesmos valores num√©ricos; </li><li>  embedding_1 - cria Embedding (representa√ß√£o vetorial) para a sequ√™ncia de entrada de dados de texto (converte o tensor 2D em 3D); </li><li>  conv1d_1 - camada convolucional 1-D; </li><li>  lstm_2 - camada LSTM (ap√≥s a incorpora√ß√£o da camada_1 (n ¬∞ 3)); </li><li>  lstm_1 - camada LSTM (segue a camada conv1d (n ¬∞ 4)); </li><li>  lambda_2 √© a camada do usu√°rio em que o tensor √© truncado ap√≥s a camada lstm_2 (n¬∫ 5) (a opera√ß√£o oposta ao preenchimento na camada lambda_1 (n¬∫ 2)); </li><li>  lambda_3 √© a camada do usu√°rio em que o tensor √© truncado ap√≥s as camadas lstm_1 (n¬∫ 6) e conv1d_1 (n¬∫ 4) (a opera√ß√£o oposta ao preenchimento na camada lambda_1 (n¬∫ 2)); </li><li>  concatenate_1 - liga√ß√£o de camadas truncadas (n¬∫ 7) e (n¬∫ 8); </li><li>  dense_1 - uma camada totalmente conectada de 8 neur√¥nios e uma fun√ß√£o de ativa√ß√£o linear exponencial "elu"; </li><li>  batch_normalization_1 - camada de normaliza√ß√£o; </li><li>  dense_2 - camada totalmente conectada de 1 neur√¥nio e fun√ß√£o de ativa√ß√£o sigm√≥ide "sigm√≥ide"; </li><li>  lambda_4 - uma camada de usu√°rio em que a compress√£o da camada anterior (compress√£o no TF) √© realizada. </li></ol></div></div><br>  <b>4.</b> Fun√ß√£o de perda - binary_crossentropy <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>d</mi><mi>o</mi><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>d</mi><mi>o</mi><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="80.155ex" height="2.901ex" viewBox="0 -883.9 34510.9 1249" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-2212" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-66" x="4085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="4636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="5087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="5617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-31" x="6050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-4E" x="6551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="7689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-75" x="8159" y="0"></use><g transform="translate(8731,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-4E" x="1242" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-31" x="1242" y="-435"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-28" x="10338" y="0"></use><g transform="translate(10727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-75" x="812" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="1385" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6C" x="12877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="13176" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-67" x="13661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="14142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="14665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="15151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="15584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="16108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-74" x="16593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-28" x="16955" y="0"></use><g transform="translate(17344,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="1421" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-29" x="19310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-2B" x="19922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-28" x="20923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-31" x="21312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-2212" x="22035" y="0"></use><g transform="translate(23036,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-75" x="812" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="1385" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-29" x="24936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6C" x="25575" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="25874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-67" x="26359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="26840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="27363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="27849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="28282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="28806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-74" x="29291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-28" x="29653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-31" x="30042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-2212" x="30765" y="0"></use><g transform="translate(31766,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="1421" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-29" x="33731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-29" x="34121" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>d</mi><mi>o</mi><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow></msub><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>d</mi><mi>o</mi><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> loss = - \ frac {1} {N} \ sum_ {1} ^ {N} (y_ {true} \ log do cdot (y_ {pred}) + (1-y_ {true}) \ log do cdot (1- y_ {pred})) </script></p><br><br>  <b>5.</b> M√©trica de qualidade do modelo - m√©dia harm√¥nica (medida F) <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mo>=</mo><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE3;</mo></mrow><mi>o</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>e</mi><mi>p</mi><mi>e</mi><mi>t</mi><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE7;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE3;</mo></mrow><mi>o</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>h</mi><mi>a</mi><mi>m</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>s</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE3;</mo></mrow><mi>o</mi><mo>+</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE7;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xE3;</mo></mrow><mi>o</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="65.909ex" height="2.419ex" viewBox="0 -780.1 28377.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-46" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-3D" x="1027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-32" x="2083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-66" x="2834" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="3384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="3836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="4365" y="0"></use><g transform="translate(4799,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="1203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="1669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-69" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="2448" y="0"></use><g transform="translate(2918,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√£</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="3332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="4068" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="4519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-70" x="4986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="5489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-74" x="5956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-69" x="6317" y="0"></use><g transform="translate(6663,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√ß</text></g><g transform="translate(7032,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√£</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="7447" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="7932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="8456" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="8922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-68" x="9356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="9932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6D" x="10462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="11340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-64" x="11870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="12393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="12923" y="0"></use></g><g transform="translate(18191,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="1203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="1669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-69" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-73" x="2448" y="0"></use><g transform="translate(2918,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√£</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="3332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMAIN-2B" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="5041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="5492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-63" x="5959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-75" x="6392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-70" x="6965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-65" x="7468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-72" x="7935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-61" x="8386" y="0"></use><g transform="translate(8916,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√ß</text></g><g transform="translate(9285,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√£</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/naumen/blog/475338/&amp;usg=ALkJrhgkSOXsVLMIMipMYxoW2Wekyj2isQ#MJMATHI-6F" x="9700" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>F</mi><mo>=</mo><mn>2</mn><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>√£</mo></mrow><mi>o</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>e</mi><mi>p</mi><mi>e</mi><mi>t</mi><mi>i</mi><mrow class="MJX-TeXAtom-ORD"><mo>√ß</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>√£</mo></mrow><mi>o</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>h</mi><mi>a</mi><mi>m</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>s</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo>√£</mo></mrow><mi>o</mi><mo>+</mo><mi>r</mi><mi>e</mi><mi>c</mi><mi>u</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>√ß</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>√£</mo></mrow><mi>o</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> F = 2 \ frac {Precis√£o \ repeti√ß√£o de chamadas} {Precis√£o + recupera√ß√£o} </script></p><br>  No nosso caso, a quest√£o das m√©tricas de qualidade n√£o √© t√£o importante quanto a corre√ß√£o da importa√ß√£o.  A corre√ß√£o da importa√ß√£o √© determinada pela coincid√™ncia dos resultados nos modelos NN Python e Java trabalhando no modo Infer√™ncia. <br><br><h1>  Importe modelos Keras no DL4J: </h1><br>  Vers√µes usadas: Tensorflow 1.5.0 e Keras 2.2.5.  No nosso caso, o modelo do Python foi carregado como um todo pelo arquivo HDF5. <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># saving model model1.save('model1_functional.h5')</span></span></code> </pre> <br>  Ao importar um modelo para o DL4J, o m√≥dulo de importa√ß√£o n√£o fornece m√©todos de API para passar par√¢metros adicionais: o nome do m√≥dulo tensorflow (de onde as fun√ß√µes foram importadas ao criar o modelo). <br><br>  De um modo geral, o DL4J funciona apenas com as fun√ß√µes do Keras, uma lista exaustiva √© fornecida na se√ß√£o Keras Import [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6</a> ]; portanto, se o modelo foi criado no Keras usando m√©todos do TF (como no nosso caso), o m√≥dulo de importa√ß√£o n√£o poder√° identific√°-los. <br><br><h3>  Diretrizes gerais para importar um modelo </h3><br>  Obviamente, trabalhar com o modelo Keras implica em seu treinamento repetido.  Para esse fim, para economizar tempo, os par√¢metros de treinamento foram definidos (1 √©poca) e 1 etapa por √©poca (steps_per_epoch). <br><br>  Quando voc√™ importa um modelo pela primeira vez, especialmente com camadas personalizadas exclusivas e combina√ß√µes raras de camadas, o sucesso √© improv√°vel.  Portanto, √© recomend√°vel executar o processo de importa√ß√£o iterativamente: reduza o n√∫mero de camadas do modelo Keras at√© que voc√™ possa importar e executar o modelo em Java sem erros.  Em seguida, adicione uma camada de cada vez ao modelo Keras e importe o modelo resultante para Java, resolvendo os erros que ocorrem. <br><br><h3>  Usando a fun√ß√£o de perda de TF </h3><br>  Para provar que, ao importar para Java, a fun√ß√£o de perda do modelo treinado deve ser do Keras, usamos log_loss do tensorflow (como o mais semelhante √† fun√ß√£o custom_loss).  Temos o seguinte erro no console: <br><br><pre> <code class="java hljs">Exception in thread <span class="hljs-string"><span class="hljs-string">"main"</span></span> org.deeplearning4j.nn.modelimport.keras.exceptions.UnsupportedKerasConfigurationException: Unknown Keras loss function log_loss.</code> </pre> <br><h3>  Substituindo m√©todos TF por Keras </h3><br>  No nosso caso, as fun√ß√µes do m√≥dulo TF s√£o usadas 2 vezes e em todos os casos s√£o encontradas apenas nas camadas lambda. <br><br>  Camadas Lambda s√£o camadas personalizadas usadas para adicionar uma fun√ß√£o arbitr√°ria. <br><br>  Nosso modelo possui apenas 4 camadas lambda.  O fato √© que em Java √© necess√°rio registrar essas camadas lambda manualmente atrav√©s do KerasLayer.registerLambdaLayer (caso contr√°rio, obtemos um erro [ <a href="">12</a> ]).  Nesse caso, a fun√ß√£o definida dentro da camada lambda deve ser uma fun√ß√£o das bibliotecas Java correspondentes.  Em Java, n√£o h√° exemplos de registro dessas camadas, al√©m de documenta√ß√£o abrangente para isso;  um exemplo est√° aqui [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">13</a> ].  Considera√ß√µes gerais foram emprestadas de exemplos [ <a href="">14</a> , <a href="">15</a> ]. <br><br>  Considere sequencialmente registrar todas as camadas lambda do modelo em Java: <br><br>  1) Camada Lambda para adicionar constantes ao tensor (matriz) um n√∫mero finito de vezes ao longo de determinadas dire√ß√µes (no nosso caso, esquerda e direita): <br><br>  A entrada desta camada est√° conectada √† entrada do modelo. <br><br>  1.1) Camada Python: <br><br><pre> <code class="python hljs">padding = keras.layers.Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: tf.pad(x, paddings=[[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]], constant_values=<span class="hljs-number"><span class="hljs-number">1</span></span>))(embedding)</code> </pre> <br>  Para maior clareza, as fun√ß√µes dessa camada funcionam, substitu√≠mos explicitamente valores num√©ricos nas camadas python. <br><br><div class="spoiler">  <b class="spoiler_title">Tabela com um exemplo de um tensor arbitr√°rio 2x2</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  Era 2x2 </td><td>  Tornou-se 2x22 </td></tr><tr><td>  [[ <strong>1</strong> , <strong>2</strong> ], <br>  [ <strong>3</strong> , <strong>4</strong> ] </td><td>  [[37, 37, 37, 37, 37, 37, 37, 37, 37, 37, <strong>1</strong> , <strong>2</strong> , 37, 37, 37, 37, 37, 37, 37, 37, 37, 37], <br>  [37, 37, 37, 37, 37, 37, 37, 37, 37, 37, <strong>3</strong> , <strong>4</strong> , 37, 37, 37, 37, 37, 37, 37, 37, 37, 37]] </td></tr></tbody></table></div><br></div></div><br>  1.2) Camada Java: <br><br><pre> <code class="java hljs">KerasLayer.registerLambdaLayer(<span class="hljs-string"><span class="hljs-string">"lambda_1"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SameDiffLambdaLayer() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SDVariable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defineLayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SameDiff sameDiff, SDVariable sdVariable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sameDiff.nn().pad(sdVariable, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[][]{ { <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }, { <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span> }}, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> InputType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOutputType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> layerIndex, InputType inputType)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InputType.feedForward(<span class="hljs-number"><span class="hljs-number">20</span></span>); } });</code> </pre> <br>  Em todas as camadas lambda registradas em Java, 2 fun√ß√µes s√£o redefinidas: <br>  A primeira fun√ß√£o "definelayer" √© respons√°vel pelo m√©todo usado (n√£o √© um fato √≥bvio: esse m√©todo s√≥ pode ser usado sob o nn () backend);  getOutputType √© respons√°vel pela sa√≠da da camada registrada, o argumento √© um par√¢metro num√©rico (aqui 20, mas em geral qualquer valor inteiro √© permitido).  Parece inconsistente, mas funciona assim. <br><br>  2) Camada Lambda para aparar o tensor (matriz) ao longo de determinadas dire√ß√µes (no nosso caso, esquerda e direita): <br><br>  Nesse caso, a camada LSTM entra na entrada da camada lambda. <br><br>  2.1) Camada Python: <br><br><pre> <code class="python hljs">slicing_lstm = keras.layers.Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:, <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">-10</span></span>])(lstm)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Tabela com um exemplo de um tensor arbitr√°rio 2x22x5</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  Era 2x22x5 </td><td>  Tornou-se 2x2x5 </td></tr><tr><td>  [[[1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1 , 2,3,4,5], [1,2,3,4,5], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [1,2 , 3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3 , 4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4 , 5], [1,2,3,4,5]], <br><br>  [[1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [ 1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1, 2,3,4,5], [1,2,3,4,5], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [1,2, 3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3, 4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4,5], [1,2,3,4, 5], [1,2,3,4,5]]] </td><td>  [[[ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ]], <br>  [[ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ], [ <strong>1</strong> , <strong>2</strong> , <strong>3</strong> , <strong>4</strong> , <strong>5</strong> ]]] </td></tr></tbody></table></div><br></div></div><br>  2.2) Camada Java: <br><br><pre> <code class="java hljs">KerasLayer.registerLambdaLayer(<span class="hljs-string"><span class="hljs-string">"lambda_2"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SameDiffLambdaLayer() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SDVariable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defineLayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SameDiff sameDiff, SDVariable sdVariable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sameDiff.stridedSlice(sdVariable, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">0</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">1</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">2</span></span>]-<span class="hljs-number"><span class="hljs-number">10</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> InputType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOutputType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> layerIndex, InputType inputType)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InputType.recurrent(<span class="hljs-number"><span class="hljs-number">60</span></span>); } });</code> </pre> <br>  No caso dessa camada, o par√¢metro InputType mudou de feedforward (20) para recorrente (60).  No argumento recorrente, o n√∫mero pode ser qualquer n√∫mero inteiro (diferente de zero), mas sua soma com o argumento recorrente da pr√≥xima camada lambda deve fornecer 160 (ou seja, na pr√≥xima camada, o argumento deve ser 100).  O n√∫mero 160 √© devido ao fato de que o tensor com a dimens√£o (Nenhum, Nenhum, 160) deve ser recebido na entrada concatenate_1 da camada. <br><br>  Os 2 primeiros argumentos s√£o vari√°veis, dependendo do tamanho da string de entrada. <br><br>  3) Camada Lambda para aparar o tensor (matriz) ao longo de determinadas dire√ß√µes (no nosso caso, esquerda e direita): <br><br>  A entrada dessa camada √© a camada LSTM, na frente da qual est√° a camada conv1_d <br><br>  3.1) Camada Python: <br><br><pre> <code class="python hljs">slicing_convolution = keras.layers.Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:,<span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">-10</span></span>])(lstm_conv)</code> </pre> <br>  Esta opera√ß√£o √© completamente id√™ntica √† opera√ß√£o no par√°grafo 2.1. <br><br>  3.2) Camada Java: <br><br><pre> <code class="java hljs">KerasLayer.registerLambdaLayer(<span class="hljs-string"><span class="hljs-string">"lambda_3"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SameDiffLambdaLayer() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SDVariable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defineLayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SameDiff sameDiff, SDVariable sdVariable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sameDiff.stridedSlice(sdVariable, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">0</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">1</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)sdVariable.getShape()[<span class="hljs-number"><span class="hljs-number">2</span></span>]-<span class="hljs-number"><span class="hljs-number">10</span></span>}, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[]{ <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> InputType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOutputType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> layerIndex, InputType inputType)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InputType.recurrent(<span class="hljs-number"><span class="hljs-number">100</span></span>); } });</code> </pre> <br>  Essa camada lambda repete a camada lambda anterior, com exce√ß√£o do par√¢metro recorrente (100).  Por que "100" √© tirado √© mencionado na descri√ß√£o da camada anterior. <br><br>  Nos pontos 2 e 3, as camadas lambda est√£o localizadas ap√≥s as camadas LSTM, portanto, o tipo recorrente √© usado.  Mas se antes da camada lambda n√£o havia LSTM, mas conv1d_1, ainda √© necess√°rio definir recorrente (parece inconsistente, mas funciona assim). <br><br>  4) Camada Lambda para compactar a camada anterior: <br><br>  A entrada dessa camada √© uma camada totalmente conectada. <br><br>  4.1) Camada Python: <br><br><pre> <code class="python hljs"> squeeze = keras.layers.Lambda(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: tf.squeeze( x, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>))(dense)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Tabela com um exemplo de um tensor arbitr√°rio 2x4x1</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  Era 2x4x1 </td><td>  Tornou-se 2x4 </td></tr><tr><td>  [[[ <strong>1], [2], [3], [4]]</strong> , <br><br>  [ <strong>[1], [2], [3], [4]</strong> ]] </td><td>  [[ <strong>1, 2, 3, 4</strong> ], <br>  [ <strong>1, 2, 3, 4</strong> ]] </td></tr></tbody></table></div><br></div></div><br>  4.2) Camada Java: <br><br><pre> <code class="java hljs">KerasLayer.registerLambdaLayer(<span class="hljs-string"><span class="hljs-string">"lambda_4"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SameDiffLambdaLayer() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SDVariable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defineLayer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SameDiff sameDiff, SDVariable sdVariable)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sameDiff.squeeze(sdVariable, -<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> InputType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOutputType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> layerIndex, InputType inputType)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> InputType.feedForward(<span class="hljs-number"><span class="hljs-number">15</span></span>); } });</code> </pre> <br>  A entrada desta camada recebe uma camada totalmente conectada, InputType para esta camada feedForward (15), o par√¢metro 15 n√£o afeta o modelo (qualquer valor inteiro √© permitido). <br><br><h3>  Baixar modelo importado </h3><br>  O modelo √© carregado atrav√©s do m√≥dulo ComputationGraph: <br><br><pre> <code class="java hljs">ComputationGraph model = org.deeplearning4j.nn.modelimport.keras.KerasModelImport.importKerasModelAndWeights(<span class="hljs-string"><span class="hljs-string">"/home/user/Models/model1_functional.h5"</span></span>);</code> </pre> <br><h3>  Sa√≠da de dados para o console Java </h3><br>  Em Java, em particular no DL4J, os tensores s√£o gravados como matrizes da biblioteca Nd4j de alto desempenho, que pode ser considerada um an√°logo da biblioteca Numpy no Python. <br><br>  Digamos que nossa string de entrada consista em 4 caracteres.  Os s√≠mbolos s√£o representados como n√∫meros inteiros (como √≠ndices), por exemplo, de acordo com alguma numera√ß√£o.  Uma matriz da dimens√£o correspondente (4) √© criada para eles. <br><br>  Por exemplo, temos 4 caracteres codificados em √≠ndice: 1, 3, 4, 8. <br><br>  C√≥digo em Java: <br><br><pre> <code class="java hljs">INDArray myArray = Nd4j.zeros(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-comment"><span class="hljs-comment">// one row 4 column array myArray.putScalar(0,0,1); myArray.putScalar(0,1,3); myArray.putScalar(0,2,4); myArray.putScalar(0,3,8); INDArray output = model.outputSingle(myArray); System.out.println(output);</span></span></code> </pre> <br>  O console exibir√° as probabilidades para cada elemento de entrada. <br><br><h3>  Modelos importados </h3><br>  A arquitetura da rede neural original e os pesos s√£o importados sem erros.  Os modelos de rede neural Keras e Java no modo Infer√™ncia concordam com os resultados. <br><br>  Modelo Python: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/om/sk/oe/omskoecug43s_gop5osadysm21m.png" alt="imagem alt"></div><br>  Modelo Java: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/es/qc/px/esqcpxwnhjdgrhqapedjukmvfec.png" alt="imagem alt"></div><br>  Na realidade, importar modelos n√£o √© t√£o simples.  Abaixo, destacaremos brevemente alguns pontos que, em alguns casos, podem ser cr√≠ticos. <br><br>  1) A camada de normaliza√ß√£o do patch n√£o funciona ap√≥s as camadas recursivas.  A quest√£o est√° aberta no GitHub h√° quase um ano [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">16</a> ].  Por exemplo, se voc√™ adicionar essa camada ao modelo (ap√≥s a camada de contato), obteremos o seguinte erro: <br><br><pre> <code class="java hljs">Exception in thread <span class="hljs-string"><span class="hljs-string">"main"</span></span> java.lang.IllegalStateException: Invalid input type: Batch norm layer expected input of type CNN, CNN Flat or FF, <span class="hljs-function"><span class="hljs-function">got </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InputTypeRecurrent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">160</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span><span class="hljs-function"> layer index -1, layer name </span></span>= batch_normalization_1</code> </pre> <br>  Na pr√°tica, o modelo se recusou a funcionar, citando um erro semelhante quando a camada de normaliza√ß√£o foi adicionada ap√≥s a conv1d.  Ap√≥s uma camada totalmente conectada, a adi√ß√£o funciona na perfei√ß√£o. <br><br>  2) Ap√≥s uma camada totalmente conectada, a configura√ß√£o da camada Achatar resulta em um erro.  Um erro semelhante √© mencionado no Stackoverflow [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://stackoverflow.com/questions/55753493/problem-opening-a-keras-model-in-java-with-deeplearning4j-">17</a> ].  Por seis meses, sem feedback. <br><br>  Definitivamente, essas n√£o s√£o todas as restri√ß√µes que voc√™ pode encontrar ao trabalhar com o DL4J. <br>  O tempo final de opera√ß√£o para o modelo √© aqui [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">18</a> ]. <br><br><h1>  Conclus√£o </h1><br>  Concluindo, pode-se notar que os modelos Keras treinados importados sem dor para o DL4J s√£o poss√≠veis apenas em casos simples (√© claro, se voc√™ n√£o tiver essa experi√™ncia e, de fato, um bom conhecimento de Java). <br><br>  Quanto menos camadas de usu√°rio, mais indolor o modelo ser√° importado, mas se a arquitetura de rede for complexa, voc√™ precisar√° gastar muito tempo transferindo-o para o DL4J. <br><br>  O suporte documental do m√≥dulo de importa√ß√£o desenvolvido, o n√∫mero de exemplos relacionados, parecia bastante √∫mido.  Em cada est√°gio, novas quest√µes surgem - como registrar camadas Lambda, significado dos par√¢metros, etc. <br><br>  Dada a velocidade da complexidade das arquiteturas de redes neurais e a intera√ß√£o entre as camadas, a complexidade das camadas, o DL4J ainda precisa se desenvolver ativamente para atingir o n√≠vel de estruturas de ponta para trabalhar com redes neurais artificiais. <br><br>  De qualquer forma, os rapazes s√£o dignos de respeito pelo seu trabalho e gostariam de ver a continua√ß√£o do desenvolvimento dessa dire√ß√£o. <br><br>  <strong>Refer√™ncias</strong> <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entre os 5 melhores idiomas de programa√ß√£o para intelig√™ncia artificial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pontua√ß√£o do Power Framework do Deep Learning 2018</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Compara√ß√£o de software de aprendizado profundo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As 9 principais estruturas do mundo da intelig√™ncia artificial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepLearning4j.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modelos dispon√≠veis</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepLearning4j.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Importa√ß√£o de modelo Keras.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Recursos suportados.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Deeplearning4j.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">In√≠cio r√°pido</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aula 0: Introdu√ß√£o ao DeepLearning4j</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Deeplearing4j: importa√ß√£o do modelo Keras</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Palestra 7 |</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Importa√ß√£o do modelo Keras</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instale o TensorFlow para Java</a> </li><li>  <a href="">Usando Camadas Keras</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepLearning4j: Class KerasLayer</a> </li><li>  <a href="">DeepLearning4j: SameDiffLambdaLayer.java</a> </li><li>  <a href="">DeepLearning4j: KerasLambdaTest.java</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepLearning4j: BatchNorm com RecurrentInputType</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://stackoverflow.com/questions/55753493/problem-opening-a-keras-model-in-java-with-deeplearning4j-">StackOverFlow: Problema ao abrir um modelo keras em java com deeplearning4j (https://deeplearning4j.org/)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub: c√≥digo completo para o modelo em quest√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Skymind: Compara√ß√£o de estruturas de IA</a> </li></ol><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt475338/">https://habr.com/ru/post/pt475338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt475324/index.html">Programa√ß√£o funcional do ponto de vista do EcmaScript. Composi√ß√£o, Caril, Aplica√ß√£o Parcial</a></li>
<li><a href="../pt475326/index.html">Como os golpistas fazem isso. Ferramentas de trapa√ßa</a></li>
<li><a href="../pt475328/index.html">Opera√ß√£o TA505, parte quatro. G√™meos</a></li>
<li><a href="../pt475330/index.html">Concurso de plug-ins da plataforma Miro com pr√™mio de US $ 21.000</a></li>
<li><a href="../pt475332/index.html">3. Projeto de rede corporativa em switches extremos</a></li>
<li><a href="../pt475340/index.html">A AMD apresentou os processadores Threadripper - as CPUs de desktop mais r√°pidas</a></li>
<li><a href="../pt475342/index.html">Andrey Sebrant (Yandex): Neg√≥cios na era da intelig√™ncia artificial</a></li>
<li><a href="../pt475346/index.html">Enquanto o ex√©rcito dos EUA tenta ler mentes</a></li>
<li><a href="../pt475354/index.html">Feliz dia do especialista em seguran√ßa</a></li>
<li><a href="../pt475358/index.html">An√°lise salarial no setor de TI da Arm√™nia e vagas abertas nas empresas TOP10 de TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>