<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ£ ğŸ¨ â™£ï¸ æœ±è‰å¨… ç½‘ç»œæœåŠ¡ ğŸ˜ ğŸš ğŸ§”ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬ç»§ç»­è€ƒè™‘ä½¿ç”¨æŠ€æœ¯Juliaã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸ºæ„å»ºWebæœåŠ¡è€Œè®¾è®¡çš„è½¯ä»¶åŒ…ã€‚ æœ±è‰å¨…è¯­è¨€çš„ä¸»è¦å¸‚åœºæ˜¯é«˜æ€§èƒ½è®¡ç®—ï¼Œè¿™å·²ç»ä¸æ˜¯ä»€ä¹ˆç§˜å¯†äº†ã€‚ å› æ­¤ï¼Œä¸€ä¸ªåˆç†çš„æ­¥éª¤æ˜¯ç›´æ¥åˆ›å»ºèƒ½å¤ŸæŒ‰éœ€æ‰§è¡Œè¿™äº›è®¡ç®—çš„WebæœåŠ¡ã€‚ å½“ç„¶ï¼ŒWebæœåŠ¡å¹¶ä¸æ˜¯åœ¨ç½‘ç»œç¯å¢ƒä¸­è¿›è¡Œé€šä¿¡çš„å”¯ä¸€æ–¹æ³•ã€‚ ä½†æ˜¯ï¼Œç”±äºå®ƒä»¬ç°åœ¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æœ±è‰å¨… ç½‘ç»œæœåŠ¡</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449338/"><p><img src="https://habrastorage.org/webt/ez/8k/mw/ez8kmwwtsavwdve31oj9__-kj6e.png"></p><br><p> æˆ‘ä»¬ç»§ç»­è€ƒè™‘ä½¿ç”¨æŠ€æœ¯Juliaã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸ºæ„å»ºWebæœåŠ¡è€Œè®¾è®¡çš„è½¯ä»¶åŒ…ã€‚ æœ±è‰å¨…è¯­è¨€çš„ä¸»è¦å¸‚åœºæ˜¯é«˜æ€§èƒ½è®¡ç®—ï¼Œè¿™å·²ç»ä¸æ˜¯ä»€ä¹ˆç§˜å¯†äº†ã€‚ å› æ­¤ï¼Œä¸€ä¸ªåˆç†çš„æ­¥éª¤æ˜¯ç›´æ¥åˆ›å»ºèƒ½å¤ŸæŒ‰éœ€æ‰§è¡Œè¿™äº›è®¡ç®—çš„WebæœåŠ¡ã€‚ å½“ç„¶ï¼ŒWebæœåŠ¡å¹¶ä¸æ˜¯åœ¨ç½‘ç»œç¯å¢ƒä¸­è¿›è¡Œé€šä¿¡çš„å”¯ä¸€æ–¹æ³•ã€‚ ä½†æ˜¯ï¼Œç”±äºå®ƒä»¬ç°åœ¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„ï¼Œå› æ­¤æˆ‘ä»¬å°†è€ƒè™‘åˆ›å»ºæœåŠ¡äºHTTPè¯·æ±‚çš„æœåŠ¡ã€‚ </p><br><p> è¯·æ³¨æ„ï¼Œç”±äºæœ±è‰å¨…ï¼ˆJuliaï¼‰çš„å¹´è½»ï¼Œå› æ­¤æœ‰ä¸€ç»„ç«äº‰æ€§è½¯ä»¶åŒ…ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†å°è¯•å¼„æ¸…æ¥šå¦‚ä½•ä»¥åŠä¸ºä»€ä¹ˆä½¿ç”¨å®ƒä»¬ã€‚ åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†åŒä¸€ä¸ªJSON WebæœåŠ¡çš„å®ç°ä¸ä»–ä»¬çš„å¸®åŠ©è¿›è¡Œäº†æ¯”è¾ƒã€‚ </p><a name="habracut"></a><br><p>  Juliaçš„åŸºç¡€æ¶æ„åœ¨æœ€è¿‘ä¸€ä¸¤å¹´ä¸­ä¸€ç›´åœ¨ç§¯æå‘å±•ã€‚ è€Œä¸”ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ä»…æ˜¯åˆ»åœ¨æ–‡æœ¬ä¸Šæ¼‚äº®çš„å¼€å§‹çš„åœ¨çº¿çŸ­è¯­ï¼Œè€Œä¸”è¿˜å¼ºè°ƒäº†ä¸€åˆ‡éƒ½åœ¨å‰§çƒˆå˜åŒ–çš„äº‹å®ï¼Œè€Œå‡ å¹´å‰ç›¸å…³çš„ä¸œè¥¿ç°åœ¨å·²ç»è¿‡æ—¶äº†ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†å°è¯•çªå‡ºæ˜¾ç¤ºç¨³å®šçš„ç¨‹åºåŒ…ï¼Œå¹¶åœ¨å…¶å¸®åŠ©ä¸‹æä¾›æœ‰å…³å¦‚ä½•å®æ–½WebæœåŠ¡çš„å»ºè®®ã€‚ ä¸ºäº†ç¡®å®šèµ·è§ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªWebæœåŠ¡ï¼Œè¯¥æœåŠ¡æ¥å—å…·æœ‰ä»¥ä¸‹æ ¼å¼çš„JSONæ•°æ®çš„POSTè¯·æ±‚ï¼š </p><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"something"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"something"</span></span> }</code> </pre> <br><p> æˆ‘ä»¬å‡è®¾æˆ‘ä»¬åˆ›å»ºçš„æœåŠ¡ä¸æ˜¯RESTfulçš„ã€‚ æˆ‘ä»¬çš„ä¸»è¦ä»»åŠ¡æ˜¯ç²¾ç¡®è€ƒè™‘æè¿°è·¯ç”±å’Œè¯·æ±‚å¤„ç†ç¨‹åºçš„æ–¹æ³•ã€‚ </p><br><h2 id="paket-httpjl">  HTTP.jlåŒ… </h2><br><p> è¯¥è½¯ä»¶åŒ…æ˜¯Juliaä¸­HTTPåè®®çš„ä¸»è¦å®ç°ï¼Œå¹¶ä¸”é€æ¸è¢«æ–°åŠŸèƒ½æ‰€æ·¹æ²¡ã€‚ é™¤äº†å®ç°ç”¨äºæ‰§è¡ŒHTTPå®¢æˆ·ç«¯è¯·æ±‚çš„å…¸å‹ç»“æ„å’ŒåŠŸèƒ½ä¹‹å¤–ï¼Œæ­¤ç¨‹åºåŒ…è¿˜å®ç°ç”¨äºåˆ›å»ºHTTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚ åŒæ—¶ï¼Œéšç€ç¨‹åºåŒ…çš„å¼€å‘ï¼Œè¯¥ç¨‹åºåŒ…å·²æ”¶åˆ°ä¸€äº›å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä½¿ç¨‹åºå‘˜éå¸¸æ–¹ä¾¿åœ°æ³¨å†Œå¤„ç†ç¨‹åºï¼Œä»è€Œæ„å»ºå…¸å‹çš„æœåŠ¡ã€‚ å¦å¤–ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œå†…ç½®äº†å¯¹WebSocketåè®®çš„æ”¯æŒï¼Œè¯¥å®ç°ä»¥å‰æ˜¯ä½œä¸ºå•ç‹¬çš„è½¯ä»¶åŒ…WebSocket.jlçš„ä¸€éƒ¨åˆ†è¿›è¡Œçš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒHTTP.jlç›®å‰å¯ä»¥æ»¡è¶³ç¨‹åºå‘˜çš„å¤§å¤šæ•°éœ€æ±‚ã€‚ è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°çœ‹å‡ ä¸ªä¾‹å­ã€‚ </p><br><h3 id="klient-http">  HTTPå®¢æˆ·ç«¯ </h3><br><p> æˆ‘ä»¬ä»å®¢æˆ·ç«¯ä»£ç å¼€å§‹å®æ–½ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¯¥ä»£ç æ¥éªŒè¯å¯æ“ä½œæ€§ã€‚ </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env julia --project=@. import HTTP import JSON.json const PORT = "8080" const HOST = "127.0.0.1" const NAME = "Jemand" #    struct Document title::String body::String end #         Base.show(r::HTTP.Messages.Response) = println(r.status == 200 ? String(r.body) : "Error: " * r.status) #    r = HTTP.get("http://$(HOST):$(PORT)") show(r) #   /user/:name r = HTTP.get("http://$(HOST):$(PORT)/user/$(NAME)"; verbose=1) show(r) #  JSON- POST- doc = Document("Some document", "Test document with some content.") r = HTTP.post( "http://$(HOST):$(PORT)/resource/process", [("Content-Type" =&gt; "application/json")], json(doc); verbose=3) show(r)</span></span></code> </pre> <br><p>  HTTPåŒ…æä¾›äº†ä¸HTTPåè®®å‘½ä»¤åç§°åŒ¹é…çš„æ–¹æ³•ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>get</code>å’Œ<code>post</code> ã€‚ å¯é€‰çš„å‘½åå‚æ•°<code>verbose</code>å…è®¸æ‚¨è®¾ç½®è¦è¾“å‡ºçš„è°ƒè¯•ä¿¡æ¯çš„æ•°é‡ã€‚ å› æ­¤ï¼Œä¾‹å¦‚ï¼Œ <code>verbose=1</code>å°†äº§ç”Ÿï¼š </p><br><pre> <code class="plaintext hljs">GET /user/Jemand HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET /user/Jemand HTTP/1.1)</code> </pre> <br><p> åœ¨<code>verbose=3</code>çš„æƒ…å†µä¸‹<code>verbose=3</code>æˆ‘ä»¬å·²ç»è·å¾—äº†å®Œæ•´çš„å‘é€å’Œæ¥æ”¶æ•°æ®é›†ï¼š </p><br><pre> <code class="plaintext hljs">DEBUG: 2019-04-21T22:40:40.961 eb4f ï¸-&gt; "POST /resource/process HTTP/1.1\r\n" (write) DEBUG: 2019-04-21T22:40:40.961 eb4f ï¸-&gt; "Content-Type: application/json\r\n" (write) DEBUG: 2019-04-21T22:40:40.961 eb4f ï¸-&gt; "Host: 127.0.0.1\r\n" (write) DEBUG: 2019-04-21T22:40:40.961 eb4f ï¸-&gt; "Content-Length: 67\r\n" (write) DEBUG: 2019-04-21T22:40:40.961 eb4f ï¸-&gt; "\r\n" (write) DEBUG: 2019-04-21T22:40:40.961 e1c6 ï¸-&gt; "{\"title\":\"Some document\",\"body\":\"Test document with some content.\"}" (unsafe_write) DEBUG: 2019-04-21T22:40:40.963 eb4f ï¸&lt;- "HTTP/1.1 200 OK\r\n" (readuntil) DEBUG: "Content-Type: application/json\r\n" DEBUG: "Transfer-Encoding: chunked\r\n" DEBUG: "\r\n" DEBUG: 2019-04-21T22:40:40.963 eb4f ï¸&lt;- "5d\r\n" (readuntil) DEBUG: 2019-04-21T22:40:40.963 eb4f ï¸&lt;- "{\"body\":\"Test document with some content.\",\"server_mark\":\"confirmed\",\"title\":\"Some document\"}" (unsafe_read) DEBUG: 2019-04-21T22:40:40.968 eb4f ï¸&lt;- "\r\n" (readuntil) DEBUG: "0\r\n" DEBUG: 2019-04-21T22:40:40.968 eb4f ï¸&lt;- "\r\n" (readuntil)</code> </pre> <br><p> å°†æ¥ï¼Œæˆ‘ä»¬å°†ä»…ä½¿ç”¨<code>verbose=1</code> ï¼Œä»¥ä¾¿ä»…æŸ¥çœ‹æœ‰å…³æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„æœ€å°‘ä¿¡æ¯ã€‚ </p><br><p> æœ‰å…³ä»£ç çš„ä¸€äº›æ³¨é‡Šã€‚ </p><br><pre> <code class="julia hljs">doc = Document(<span class="hljs-string"><span class="hljs-string">"Some document"</span></span>, <span class="hljs-string"><span class="hljs-string">"Test document with some content."</span></span>)</code> </pre> <br><p> ç”±äºæˆ‘ä»¬å…ˆå‰å·²ç»å£°æ˜äº†Documentç»“æ„ï¼ˆè€Œä¸”æ˜¯ä¸å¯å˜çš„ï¼‰ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°ï¼Œè¯¥æ„é€ å‡½æ•°çš„å‚æ•°å¯¹åº”äºè¯¥ç»“æ„çš„å£°æ˜å­—æ®µã€‚ ä¸ºäº†å°†å…¶è½¬æ¢ä¸ºJSONï¼Œæˆ‘ä»¬ä½¿ç”¨<code>JSON.jl</code>åŒ…åŠå…¶<code>json(doc)</code>æ–¹æ³•ã€‚ <br> æ³¨æ„ç‰‡æ®µï¼š </p><br><pre> <code class="julia hljs">r = HTTP.post( <span class="hljs-string"><span class="hljs-string">"http://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$(HOST)</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$(PORT)</span></span></span><span class="hljs-string">/resource/process"</span></span>, [(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>)], json(doc); verbose=<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><p> ç”±äºæˆ‘ä»¬ä¼ é€’çš„æ˜¯JSONï¼Œå› æ­¤æ‚¨å¿…é¡»åœ¨<code>Content-Type</code>æ ‡å¤´ä¸­æ˜ç¡®æŒ‡å®šç±»å‹<code>application/json</code> ã€‚ æ ‡å¤´ä½¿ç”¨åŒ…å«æ ‡å¤´åç§°-å€¼å¯¹çš„æ•°ç»„ï¼ˆå‘é‡ç±»å‹ï¼Œä½†ä¸åŒ…æ‹¬Dictç±»å‹ï¼‰ä¼ é€’åˆ°<code>HTTP.post</code>æ–¹æ³•ï¼ˆä½†æ˜¯ï¼Œä¸æ‰€æœ‰å…¶ä»–æ ‡å¤´ä¸€æ ·ï¼‰ã€‚ </p><br><p> å¯¹äºå¥åº·æµ‹è¯•ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä¸‰ä¸ªæŸ¥è¯¢ï¼š </p><br><ul><li>  GETè¯·æ±‚åˆ°æ ¹è·¯ç”±ï¼› </li><li>  GETè¯·æ±‚ï¼Œæ ¼å¼ä¸º/ç”¨æˆ·/åç§°ï¼Œå…¶ä¸­åç§°ä¸ºä¼ è¾“çš„åç§°ï¼› </li><li> å¸¦æœ‰JSONå¯¹è±¡çš„POSTè¯·æ±‚/èµ„æº/è¿›ç¨‹ã€‚ æˆ‘ä»¬å¸Œæœ›æ”¶åˆ°ç›¸åŒçš„æ–‡æ¡£ï¼Œä½†æ˜¯æ·»åŠ äº†<code>server_mark</code>å­—æ®µã€‚ </li></ul><br><p> æˆ‘ä»¬å°†ä½¿ç”¨æ­¤å®¢æˆ·ç«¯ä»£ç æ¥æµ‹è¯•æ‰€æœ‰æœåŠ¡å™¨å®ç°é€‰é¡¹ã€‚ </p><br><h3 id="server-http">  HTTPæœåŠ¡å™¨ </h3><br><p> ç¡®å®šå®¢æˆ·ç«¯ä¹‹åï¼Œå°±è¯¥å¼€å§‹å®æ–½æœåŠ¡å™¨äº†ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»…åœ¨<code>HTTP.jl</code>çš„å¸®åŠ©ä¸‹ä½¿è¯¥æœåŠ¡æˆä¸ºåŸºæœ¬é€‰é¡¹ï¼Œè€Œæ— éœ€å®‰è£…å…¶ä»–è½¯ä»¶åŒ…ã€‚ æˆ‘ä»¬æé†’æ‚¨ï¼Œæ‰€æœ‰å…¶ä»–è½¯ä»¶åŒ…<code>HTTP.jl</code>ä½¿ç”¨<code>HTTP.jl</code> </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env julia --project=@. import Sockets import HTTP import JSON #    #    index(req::HTTP.Request) = HTTP.Response(200, "Hello World") #     function welcome_user(req::HTTP.Request) # dump(req) user = "" if (m = match( r".*/user/([[:alpha:]]+)", req.target)) != nothing user = m[1] end return HTTP.Response(200, "Hello " * user) end #  JSON function process_resource(req::HTTP.Request) # dump(req) message = JSON.parse(String(req.body)) @info message message["server_mark"] = "confirmed" return HTTP.Response(200, JSON.json(message)) end #      const ROUTER = HTTP.Router() HTTP.@register(ROUTER, "GET", "/", index) HTTP.@register(ROUTER, "GET", "/user/*", welcome_user) HTTP.@register(ROUTER, "POST", "/resource/process", process_resource) HTTP.serve(ROUTER, Sockets.localhost, 8080)</span></span></code> </pre> <br><p> åœ¨ç¤ºä¾‹ä¸­ï¼Œæ‚¨åº”æ³¨æ„ä»¥ä¸‹ä»£ç ï¼š </p><br><pre> <code class="julia hljs">dump(req)</code> </pre> <br><p> å°†å¯¹è±¡å·²çŸ¥çš„æ‰€æœ‰å†…å®¹æ‰“å°åˆ°æ§åˆ¶å°ã€‚ åŒ…æ‹¬æ•°æ®ç±»å‹ï¼Œå€¼ä»¥åŠæ‰€æœ‰åµŒå¥—å­—æ®µåŠå…¶å€¼ã€‚ æ­¤æ–¹æ³•å¯¹äºåº“ç ”ç©¶å’Œè°ƒè¯•éƒ½æ˜¯æœ‰ç”¨çš„ã€‚ </p><br><p> å¼¦ä¹ </p><br><pre> <code class="julia hljs">(m = match( <span class="hljs-string"><span class="hljs-string">r".*/user/([[:alpha:]]+)"</span></span>, req.target))</code> </pre> <br><p> æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºè§£æå¤„ç†ç¨‹åºåœ¨å…¶ä¸Šæ³¨å†Œçš„è·¯ç”±ã€‚  <code>HTTP.jl</code>åŒ…<code>HTTP.jl</code>æä¾›è‡ªåŠ¨çš„æ–¹æ³•æ¥æ ‡è¯†è·¯ç”±ä¸­çš„æ¨¡å¼ã€‚ </p><br><p> åœ¨<code>process_resource</code>å¤„ç†ç¨‹åºä¸­ï¼Œæˆ‘ä»¬è§£ææœåŠ¡æ¥å—çš„JSONã€‚ </p><br><pre> <code class="julia hljs">message = JSON.parse(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(req.body))</code> </pre> <br><p> é€šè¿‡<code>req.body</code>å­—æ®µè®¿é—®æ•°æ®ã€‚ è¯·æ³¨æ„ï¼Œæ•°æ®é‡‡ç”¨å­—èŠ‚æ•°ç»„æ ¼å¼ã€‚ å› æ­¤ï¼Œè¦å°†å®ƒä»¬ä½œä¸ºå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œå¿…é¡»æ‰§è¡Œå¯¹å­—ç¬¦ä¸²çš„æ˜¾å¼è½¬æ¢ã€‚  <code>JSON.parse</code>æ–¹æ³•æ˜¯<code>JSON.jl</code>åŒ…æ–¹æ³•ï¼Œç”¨äºååºåˆ—åŒ–æ•°æ®å¹¶æ„å»ºå¯¹è±¡ã€‚ ç”±äºåœ¨è¿™ç§æƒ…å†µä¸‹å¯¹è±¡æ˜¯å…³è”æ•°ç»„ï¼ˆDictï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å‘å…¶æ·»åŠ æ–°é”®ã€‚ å¼¦ä¹ </p><br><pre> <code class="julia hljs">message[<span class="hljs-string"><span class="hljs-string">"server_mark"</span></span>] = <span class="hljs-string"><span class="hljs-string">"confirmed"</span></span></code> </pre> <br><p> æ·»åŠ <code>server_mark</code>å¯†é’¥å¹¶<code>confirmed</code>å€¼ã€‚ </p><br><p> è¯¥æœåŠ¡åœ¨æ‰§è¡Œ<code>HTTP.serve(ROUTER, Sockets.localhost, 8080)</code>è¡Œæ—¶<code>HTTP.serve(ROUTER, Sockets.localhost, 8080)</code> ã€‚ </p><br><p> åŸºäºHTTP.jlçš„æœåŠ¡çš„æ§åˆ¶å“åº”ï¼ˆè¿è¡Œ<code>verbose=1</code>çš„å®¢æˆ·ç«¯ä»£ç æ—¶è·å¾—ï¼‰ï¼š </p><br><pre> <code class="plaintext hljs">GET / HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET / HTTP/1.1) Hello World GET /user/Jemand HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET /user/Jemand HTTP/1.1) Hello Jemand POST /resource/process HTTP/1.1 HTTP/1.1 200 OK &lt;= (POST /resource/process HTTP/1.1) {"body":"Test document with some content.","server_mark":"confirmed","title":"Some document"}</code> </pre> <br><p> åœ¨<code>verbose=1</code>è°ƒè¯•ä¿¡æ¯çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ä»¥ä¸‹è¡Œï¼š <code>Hello World</code> ï¼Œ <code>Hello Jemand</code> ï¼Œ <code>"server_mark":"confirmed"</code> ã€‚ </p><br><p> æŸ¥çœ‹æœåŠ¡ä»£ç åï¼Œè‡ªç„¶è€Œç„¶åœ°å‡ºç°äº†ä¸€ä¸ªé—®é¢˜-å¦‚æœHTTPä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å¾ˆç®€å•ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨æ‰€æœ‰å…¶ä»–è½¯ä»¶åŒ…ã€‚ æœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ç­”æ¡ˆã€‚  HTTP-å…è®¸æ³¨å†ŒåŠ¨æ€å¤„ç†ç¨‹åºï¼Œä½†æ˜¯å³ä½¿æ˜¯ä»ç›®å½•è¯»å–é™æ€å›¾ç‰‡æ–‡ä»¶çš„åŸºæœ¬å®ç°ä¹Ÿéœ€è¦å•ç‹¬çš„å®ç°ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬è¿˜è€ƒè™‘äº†ä¸“æ³¨äºåˆ›å»ºWebåº”ç”¨ç¨‹åºçš„è½¯ä»¶åŒ…ã€‚ </p><br><h2 id="paket-muxjl">  Mux.jlè½¯ä»¶åŒ… </h2><br><p> è¯¥è½¯ä»¶åŒ…è¢«å®šä½ä¸ºåœ¨Juliaä¸Šå®ç°çš„Webåº”ç”¨ç¨‹åºçš„ä¸­é—´å±‚ã€‚ å®ƒçš„å®ç°éå¸¸è½»å·§ã€‚ ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ç§æè¿°å¤„ç†ç¨‹åºçš„ç®€ä¾¿æ–¹æ³•ã€‚ è¿™å¹¶ä¸æ˜¯è¯´é¡¹ç›®æ²¡æœ‰å¼€å‘ï¼Œè€Œæ˜¯è¿›å±•ç¼“æ…¢ã€‚ ä½†æ˜¯ï¼Œè¯·æŸ¥çœ‹æœåŠ¡äºç›¸åŒè·¯çº¿çš„æœåŠ¡çš„ä»£ç ã€‚ </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env julia --project=@. using Mux using JSON @app test = ( Mux.defaults, page(respond("&lt;h1&gt;Hello World!&lt;/h1&gt;")), page("/user/:user", req -&gt; "&lt;h1&gt;Hello, $(req[:params][:user])!&lt;/h1&gt;"), route("/resource/process", req -&gt; begin message = JSON.parse(String(req[:data])) @info message message["server_mark"] = "confirmed" return Dict( :body =&gt; JSON.json(message), :headers =&gt; [("Content-Type" =&gt; "application/json")] ) end), Mux.notfound() ) serve(test, 8080) Base.JLOptions().isinteractive == 0 &amp;&amp; wait()</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œä½¿ç”¨<code>page</code>æ–¹æ³•æ¥æè¿°è·¯ç”±ã€‚ ä½¿ç”¨<code>@app</code>å®å£°æ˜Webåº”ç”¨ç¨‹åºã€‚  <code>page</code>æ–¹æ³•çš„å‚æ•°æ˜¯è·¯ç”±å’Œå¤„ç†ç¨‹åºã€‚ å¯ä»¥å°†å¤„ç†ç¨‹åºæŒ‡å®šä¸ºæ¥å—è¯·æ±‚ä½œä¸ºè¾“å…¥çš„å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å°†å…¶æŒ‡å®šä¸ºlambdaå‡½æ•°ã€‚ åœ¨å…¶ä»–æœ‰ç”¨çš„åŠŸèƒ½ä¸­ï¼Œæä¾›äº†<code>Mux.notfound()</code>æ¥å‘é€æŒ‡å®šçš„â€œ <code>Not found</code>å“åº”ã€‚ è€Œä¸”ï¼Œåº”è¯¥å‘é€åˆ°å®¢æˆ·ç«¯çš„ç»“æœä¸éœ€è¦åƒå‰é¢ç¤ºä¾‹ä¸­é‚£æ ·æ‰“åŒ…åœ¨<code>HTTP.Response</code>ä¸­ï¼Œå› ä¸ºMuxä¼šè‡ªå·±å®Œæˆã€‚ ä½†æ˜¯ï¼Œæ‚¨ä»ç„¶éœ€è¦è‡ªå·±è¿›è¡ŒJSONè§£æï¼Œä¸ºå“åº”åºåˆ—åŒ–å¯¹è±¡<code>JSON.json(message)</code> ã€‚ </p><br><pre> <code class="julia hljs"> message = JSON.parse(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(req[:data])) message[<span class="hljs-string"><span class="hljs-string">"server_mark"</span></span>] = <span class="hljs-string"><span class="hljs-string">"confirmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Dict</span></span>( :body =&gt; JSON.json(message), :headers =&gt; [(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>)] )</code> </pre> <br><p> å“åº”ä½œä¸ºå…³è”æ•°ç»„å‘é€ï¼Œå…¶å­—æ®µä¸º<code>:body</code> <code>:headers</code> ã€‚ </p><br><p> ä½¿ç”¨<code>serve(test, 8080)</code>æ–¹æ³•å¯åŠ¨æœåŠ¡å™¨æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤åœ¨Juliaä¸­ç»„ç»‡ç­‰å¾…å®Œæˆçš„é€‰é¡¹ä¹‹ä¸€æ˜¯è°ƒç”¨ä»£ç ï¼š </p><br><pre> <code class="julia hljs">Base.JLOptions().isinteractive == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; wait()</code> </pre> <br><p> å¦åˆ™ï¼Œè¯¥æœåŠ¡ä¸<code>HTTP.jl</code>ä¸Šçš„å…ˆå‰ç‰ˆæœ¬ç›¸åŒã€‚ </p><br><p> æ§åˆ¶æœåŠ¡çš„å“åº”ï¼š </p><br><pre> <code class="plaintext hljs">GET / HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET / HTTP/1.1) &lt;h1&gt;Hello World!&lt;/h1&gt; GET /user/Jemand HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET /user/Jemand HTTP/1.1) &lt;h1&gt;Hello, Jemand!&lt;/h1&gt; POST /resource/process HTTP/1.1 HTTP/1.1 200 OK &lt;= (POST /resource/process HTTP/1.1) {"body":"Test document with some content.","server_mark":"confirmed","title":"Some document"}</code> </pre> <br><h2 id="paket-bukdujl"> è½¯ä»¶åŒ…Bukdu.jl </h2><br><p> è¯¥ç¨‹åºåŒ…æ˜¯åœ¨Phoenixæ¡†æ¶çš„å½±å“ä¸‹å¼€å‘çš„ï¼Œè¯¥æ¡†æ¶åˆåœ¨Elixirä¸Šå®ç°ï¼Œå¹¶ä¸”æ˜¯Rubyç¤¾åŒºåœ¨Elixirä¸Šçš„Webæ„å»ºæ€æƒ³çš„å®ç°ã€‚ è¯¥é¡¹ç›®æ­£åœ¨éå¸¸ç§¯æåœ°è¿›è¡Œå¼€å‘ï¼Œå¹¶ä¸”è¢«å®šä½ä¸ºç”¨äºåˆ›å»ºRESTful APIå’Œè½»é‡çº§Webåº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚ æœ‰ä¸€äº›åŠŸèƒ½å¯ä»¥ç®€åŒ–JSONåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚  <code>HTTP.jl</code>å’Œ<code>Mux.jl</code>ç¼ºå°‘æ­¤<code>Mux.jl</code> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„WebæœåŠ¡çš„å®ç°ã€‚ </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env julia --project=@. using Bukdu using JSON #   struct WelcomeController &lt;: ApplicationController conn::Conn end #   index(c::WelcomeController) = render(JSON, "Hello World") welcome_user(c::WelcomeController) = render(JSON, "Hello " * c.params.user) function process_resource(c::WelcomeController) message = JSON.parse(String(c.conn.request.body)) @info message message["server_mark"] = "confirmed" render(JSON, message) end #   routes() do get("/", WelcomeController, index) get("/user/:user", WelcomeController, welcome_user, :user =&gt; String) post("/resource/process", WelcomeController, process_resource) end #   Bukdu.start(8080) Base.JLOptions().isinteractive == 0 &amp;&amp; wait()</span></span></code> </pre> <br><p> æ‚¨é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ç”¨äºå­˜å‚¨æ§åˆ¶å™¨çŠ¶æ€çš„ç»“æ„çš„å£°æ˜ã€‚ </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> WelcomeController &lt;: ApplicationController conn::Conn <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä½œä¸ºæŠ½è±¡ç±»å‹<code>ApplicationController</code>çš„åä»£åˆ›å»ºçš„å…·ä½“ç±»å‹ã€‚ </p><br><p> ç›¸å¯¹äºå…ˆå‰çš„å®ç°ï¼Œæ§åˆ¶å™¨çš„æ–¹æ³•ä»¥ç±»ä¼¼çš„æ–¹å¼å£°æ˜ã€‚ æˆ‘ä»¬çš„JSONå¯¹è±¡çš„å¤„ç†ç¨‹åºç•¥æœ‰ä¸åŒã€‚ </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> process_resource(c::WelcomeController) message = JSON.parse(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>(c.conn.request.body)) <span class="hljs-meta"><span class="hljs-meta">@info</span></span> message message[<span class="hljs-string"><span class="hljs-string">"server_mark"</span></span>] = <span class="hljs-string"><span class="hljs-string">"confirmed"</span></span> render(JSON, message) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> å¦‚æ‚¨æ‰€è§ï¼Œååºåˆ—åŒ–ä¹Ÿå¯ä»¥ä½¿ç”¨<code>JSON.parse</code>æ–¹æ³•ç‹¬ç«‹æ‰§è¡Œï¼Œä½†æ˜¯<code>JSON.parse</code>çš„<code>render(JSON, message)</code>æ–¹æ³•ç”¨äºåºåˆ—åŒ–å“åº”ã€‚ </p><br><p> è·¯çº¿å£°æ˜æ˜¯é’ˆå¯¹æ‘©æ“¦è®ºè€…çš„ä¼ ç»Ÿé£æ ¼è¿›è¡Œçš„ï¼ŒåŒ…æ‹¬ä½¿ç”¨<code>do...end</code>å—ã€‚ </p><br><pre> <code class="julia hljs">routes() <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, WelcomeController, index) get(<span class="hljs-string"><span class="hljs-string">"/user/:user"</span></span>, WelcomeController, welcome_user, :user =&gt; <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) post(<span class="hljs-string"><span class="hljs-string">"/resource/process"</span></span>, WelcomeController, process_resource) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> åŒæ ·ï¼Œå¯¹äºæ‘©æ“¦è®ºè€…æ¥è¯´ï¼Œä¼ ç»Ÿæ–¹å¼æ˜¯åœ¨è·¯çº¿<code>/user/:user</code>å£°æ˜ä¸€ä¸ªè·¯æ®µã€‚ æ¢å¥è¯è¯´ï¼Œè¡¨è¾¾å¼çš„å˜é‡éƒ¨åˆ†å¯ä»¥é€šè¿‡æ¨¡æ¿ä¸­æŒ‡å®šçš„åç§°è¿›è¡Œè®¿é—®ã€‚ åœ¨è¯­æ³•ä¸Šè¢«æŒ‡å®šä¸º<code>Symbol</code>ç±»å‹çš„ä»£è¡¨ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¯¹äºJuliaè€Œè¨€ï¼Œç±»å‹<code>Symbol</code>æœ¬è´¨ä¸Šä¸Rubyå«ä¹‰ç›¸åŒ-è¿™æ˜¯ä¸€ä¸ªä¸å˜çš„å­—ç¬¦ä¸²ï¼Œåœ¨å†…å­˜ä¸­ç”±å•ä¸ªå®ä¾‹è¡¨ç¤ºã€‚ </p><br><p> å› æ­¤ï¼Œåœ¨å£°æ˜å…·æœ‰å¯å˜éƒ¨åˆ†çš„è·¯ç”±å¹¶æŒ‡ç¤ºè¯¥å¯å˜éƒ¨åˆ†çš„ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å¼•ç”¨å·²é€šè¿‡åˆ†é…åç§°è§£æçš„æ•°æ®ã€‚ åœ¨å¤„ç†è¯·æ±‚çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä»…é€šè¿‡ç‚¹å½¢å¼<code>c.params.user</code>æ¥è®¿é—®å­—æ®µã€‚ </p><br><pre> <code class="julia hljs">welcome_user(c::WelcomeController) = render(JSON, <span class="hljs-string"><span class="hljs-string">"Hello "</span></span> * c.params.user)</code> </pre> <br><p> æ§åˆ¶æœåŠ¡çš„å“åº”ï¼š </p><br><pre> <code class="plaintext hljs">GET / HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET / HTTP/1.1) "Hello World" GET /user/Jemand HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET /user/Jemand HTTP/1.1) "Hello Jemand" POST /resource/process HTTP/1.1 HTTP/1.1 200 OK &lt;= (POST /resource/process HTTP/1.1) {"body":"Test document with some content.","server_mark":"confirmed","title":"Some document"}</code> </pre> <br><p> æ§åˆ¶å°æœåŠ¡çš„ç»“è®ºï¼š </p><br><pre> <code class="plaintext hljs">&gt;./bukdu_json.jl INFO: Bukdu Listening on 127.0.0.1:8080 INFO: GET WelcomeController index 200 / INFO: GET WelcomeController welcome_user 200 /user/Jemand INFO: Dict{String,Any}("body"=&gt;"Test document with some content.","title"=&gt;"Some document") INFO: POST WelcomeController process_resource200 /resource/process</code> </pre> <br><h2 id="paket-geniejl"> è½¯ä»¶åŒ…Genie.jl </h2><br><p> å®šä½ä¸ºMVC Webæ¡†æ¶çš„å®ä¼Ÿé¡¹ç›®ã€‚ åœ¨ä»–çš„æ–¹æ³•ä¸­ï¼ŒJuliaä¸Šçš„â€œ Railsâ€éå¸¸æ¸…æ™°å¯è§ï¼ŒåŒ…æ‹¬ç”±ç”Ÿæˆå™¨åˆ›å»ºçš„ç›®å½•ç»“æ„ã€‚ è¯¥é¡¹ç›®æ­£åœ¨å¼€å‘ä¸­ï¼Œä½†æ˜¯ç”±äºæœªçŸ¥åŸå› ï¼Œæ­¤è½¯ä»¶åŒ…æœªåŒ…å«åœ¨Juliaè½¯ä»¶åŒ…å­˜å‚¨åº“ä¸­ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»gitå­˜å‚¨åº“å®‰è£…ï¼š </p><br><pre> <code class="julia hljs">julia&gt;] <span class="hljs-comment"><span class="hljs-comment"># switch to pkg&gt; mode pkg&gt; add https://github.com/essenciary/Genie.jl</span></span></code> </pre> <br><p> æˆ‘ä»¬åœ¨Genieä¸­çš„æœåŠ¡ä»£ç å¦‚ä¸‹ï¼ˆæˆ‘ä»¬ä¸ä½¿ç”¨ç”Ÿæˆå™¨ï¼‰ï¼š </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env julia --project=@. #     import Genie import Genie.Router: route, @params, POST import Genie.Requests: jsonpayload, rawpayload import Genie.Renderer: json! #      route("/") do "Hello World!" end route("/user/:user") do "Hello " * @params(:user) end route("/resource/process", method = POST) do message = jsonpayload() # if message == nothing # dump(Genie.Requests.rawpayload()) # end message["server_mark"] = "confirmed" return message |&gt; json! end #   Genie.AppServer.startup(8080) Base.JLOptions().isinteractive == 0 &amp;&amp; wait()</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæ‚¨åº”è¯¥æ³¨æ„å£°æ˜çš„æ ¼å¼ã€‚ </p><br><pre> <code class="julia hljs">route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Rubyç¨‹åºå‘˜å¯¹æ­¤ä»£ç éå¸¸ç†Ÿæ‚‰ã€‚  <code>do...end</code>å—ä½œä¸ºå¤„ç†ç¨‹åºï¼Œè€Œè·¯ç”±ä½œä¸ºæ–¹æ³•çš„å‚æ•°ã€‚ è¯·æ³¨æ„ï¼Œå¯¹äºJuliaè€Œè¨€ï¼Œæ­¤ä»£ç å¯ä»¥ç”¨ä»¥ä¸‹æ ¼å¼é‡å†™ï¼š </p><br><pre> <code class="julia hljs">route(req -&gt; <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>, <span class="hljs-string"><span class="hljs-string">"/"</span></span>)</code> </pre> <br><p> ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤„ç†ç¨‹åºå‡½æ•°åœ¨ç¬¬ä¸€ä½ï¼Œè·¯ç”±åœ¨ç¬¬äºŒä½ã€‚ ä½†å°±æˆ‘ä»¬è€Œè¨€ï¼Œè®©æˆ‘ä»¬ç¦»å¼€çº¢å®çŸ³é£æ ¼ã€‚ </p><br><p>  Genieä¼šè‡ªåŠ¨å°†æ‰§è¡Œç»“æœæ‰“åŒ…åˆ°HTTPå“åº”ä¸­ã€‚ åœ¨æœ€å°çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è¿”å›æ­£ç¡®ç±»å‹çš„ç»“æœï¼Œä¾‹å¦‚Stringã€‚ åœ¨å…¶ä»–ä¾¿åˆ©è®¾æ–½ä¸­ï¼Œå°†è‡ªåŠ¨éªŒè¯è¾“å…¥æ ¼å¼åŠå…¶åˆ†æã€‚ ä¾‹å¦‚ï¼Œå¯¹äºJSONï¼Œæ‚¨åªéœ€è¦è°ƒç”¨<code>jsonpayload()</code>æ–¹æ³•ã€‚ </p><br><pre> <code class="julia hljs">route(<span class="hljs-string"><span class="hljs-string">"/resource/process"</span></span>, method = POST) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> message = jsonpayload() <span class="hljs-comment"><span class="hljs-comment"># if message == nothing # dump(Genie.Requests.rawpayload()) # end message["server_mark"] = "confirmed" return message |&gt; json! end</span></span></code> </pre> <br><p> æ³¨æ„æ­¤å¤„æ³¨é‡Šæ‰çš„ä»£ç ç‰‡æ®µã€‚ å¦‚æœç”±äºæŸç§åŸå› è¾“å…¥æ ¼å¼æ— æ³•è¯†åˆ«ä¸ºJSONï¼Œåˆ™<code>jsonpayload()</code>æ–¹æ³•å°†<code>nothing</code>è¿”å›<code>nothing</code> ã€‚ è¯·æ³¨æ„ï¼Œä»…ä¸ºæ­¤ï¼Œå°†æ ‡é¢˜<code>[("Content-Type" =&gt; "application/json")]</code>æ·»åŠ åˆ°æˆ‘ä»¬çš„HTTPå®¢æˆ·ç«¯ï¼Œå› ä¸ºå¦åˆ™Genieç”šè‡³ä¸ä¼šå¼€å§‹å°†æ•°æ®è§£æä¸ºJSONã€‚ å¦‚æœå‘ç”Ÿäº†ä¸€äº›ä¸å¯ç†è§£çš„äº‹æƒ…ï¼ŒæŸ¥çœ‹<code>rawpayload()</code>çš„å«ä¹‰å°†å¾ˆæœ‰ç”¨ã€‚ ä½†æ˜¯ï¼Œç”±äºè¿™åªæ˜¯è°ƒè¯•é˜¶æ®µï¼Œå› æ­¤ä¸åº”å°†å…¶ä¿ç•™åœ¨ä»£ç ä¸­ã€‚ </p><br><p> å¦å¤–ï¼Œæ‚¨åº”æ³¨æ„ä»¥æ ¼å¼<code>message |&gt; json!</code>è¿”å›ç»“æœ<code>message |&gt; json!</code>  ã€‚  <code>json!(str)</code>æ–¹æ³•æ”¾åœ¨æ­¤å¤„çš„æœ€åä¸€ä¸ªç®¡é“ä¸­ã€‚ å®ƒæä¾›JSONæ ¼å¼çš„æ•°æ®åºåˆ—åŒ–ï¼Œå¹¶ç¡®ä¿Genieæ·»åŠ æ­£ç¡®çš„<code>Content-Type</code> ã€‚ å¦å¤–ï¼Œè¯·æ³¨æ„ä»¥ä¸‹äº‹å®ï¼Œåœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­çš„å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå•è¯<code>return</code>æ˜¯å¤šä½™çš„ã€‚ ä¾‹å¦‚ï¼ŒJuliaä¸Rubyä¸€æ ·ï¼Œæ€»æ˜¯è¿”å›ä¸Šä¸€ä¸ªæ“ä½œçš„ç»“æœæˆ–ä¸Šä¸€ä¸ªæŒ‡å®šè¡¨è¾¾å¼çš„å€¼ã€‚ å³ï¼Œå•è¯<code>return</code>æ˜¯å¯é€‰çš„ã€‚ </p><br><p>  Genieçš„åŠŸèƒ½å¹¶ä¸æ­¢äºæ­¤ï¼Œä½†æˆ‘ä»¬ä¸éœ€è¦å®ƒä»¬æ¥å®ç°ç½‘ç»œæœåŠ¡ã€‚ </p><br><p> æ§åˆ¶æœåŠ¡çš„å“åº”ï¼š </p><br><pre> <code class="plaintext hljs">GET / HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET / HTTP/1.1) Hello World! GET /user/Jemand HTTP/1.1 HTTP/1.1 200 OK &lt;= (GET /user/Jemand HTTP/1.1) Hello Jemand POST /resource/process HTTP/1.1 HTTP/1.1 200 OK &lt;= (POST /resource/process HTTP/1.1) {"body":"Test document with some content.","server_mark":"confirmed","title":"Some document"}</code> </pre> <br><p> æ§åˆ¶å°æœåŠ¡çš„ç»“è®ºï¼š </p><br><pre> <code class="plaintext hljs">&gt;./genie_json.jl [ Info: Ready! 2019-04-24 17:18:51:DEBUG:Main: Web Server starting at http://127.0.0.1:8080 2019-04-24 17:18:51:DEBUG:Main: Web Server running at http://127.0.0.1:8080 2019-04-24 17:19:21:INFO:Main: / 200 2019-04-24 17:19:21:INFO:Main: /user/Jemand 200 2019-04-24 17:19:22:INFO:Main: /resource/process 200</code> </pre> <br><h2 id="paket-juliawebapijl"> è½¯ä»¶åŒ…JuliaWebAPI.jl </h2><br><p> åœ¨HTTP.jlåªæ˜¯å®ç°åè®®çš„åº“çš„é‚£ä¸ªå¹´ä»£ï¼Œæ­¤è½¯ä»¶åŒ…è¢«å®šä½ä¸ºåˆ›å»ºWebåº”ç”¨ç¨‹åºçš„ä¸­é—´å±‚ã€‚ è¯¥è½¯ä»¶åŒ…çš„ä½œè€…è¿˜å®ç°äº†åŸºäºSwaggerè§„èŒƒï¼ˆOpenAPIå’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://editor.swagger.io/</a> ï¼‰çš„æœåŠ¡å™¨ä»£ç ç”Ÿæˆå™¨-å‚è§é¡¹ç›®<a href="">https://github.com/JuliaComputing/Swagger.jl</a> ï¼Œè¯¥ç”Ÿæˆå™¨ä½¿ç”¨äº†JuliaWebAPI .jlã€‚ ä½†æ˜¯ï¼ŒJuliaWebAPI.jlçš„é—®é¢˜åœ¨äºå®ƒæ²¡æœ‰å®ç°å¤„ç†é€šè¿‡POSTè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨çš„è¯·æ±‚ä¸»ä½“ï¼ˆä¾‹å¦‚JSONï¼‰çš„åŠŸèƒ½ã€‚ ä½œè€…è®¤ä¸ºï¼Œä»¥é”®å€¼æ ¼å¼ä¼ é€’å‚æ•°é€‚ç”¨äºæ‰€æœ‰åœºåˆã€‚è¿™ä¸ªåŒ…çš„æœªæ¥å°šä¸æ¸…æ¥šã€‚ å®ƒçš„æ‰€æœ‰åŠŸèƒ½å·²ç»åœ¨è®¸å¤šå…¶ä»–åŒ…ä¸­å®ç°ï¼ŒåŒ…æ‹¬HTTP.jlã€‚  Swagger.jlç¨‹åºåŒ…ä¹Ÿä¸å†ä½¿ç”¨å®ƒã€‚ </p><br><h2 id="websocketsjl">  WebSockets.jl </h2><br><p>  WebSocketåè®®çš„æ—©æœŸå®ç°ã€‚ è¯¥åŒ…å·²ä½œä¸ºè¯¥åè®®çš„ä¸»è¦å®ç°ä½¿ç”¨äº†å¾ˆé•¿æ—¶é—´ï¼Œä½†æ˜¯ç›®å‰ï¼Œå…¶å®ç°å·²åŒ…å«åœ¨HTTP.jlåŒ…ä¸­ã€‚  WebSockets.jlåŒ…æœ¬èº«ä½¿ç”¨HTTP.jlå»ºç«‹è¿æ¥ï¼Œä½†æ˜¯ç°åœ¨ï¼Œåœ¨æ–°çš„å¼€å‘ä¸­ä¸å€¼å¾—ä½¿ç”¨å®ƒã€‚ åº”è¯¥å°†å…¶è§†ä¸ºå…¼å®¹æ€§çš„è½¯ä»¶åŒ…ã€‚ </p><br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p> è¿™ç¯‡è¯„è®ºæ¼”ç¤ºäº†åœ¨Juliaä¸Šå®ç°WebæœåŠ¡çš„å„ç§æ–¹æ³•ã€‚ æœ€ç®€å•ï¼Œæœ€é€šç”¨çš„æ–¹æ³•æ˜¯ç›´æ¥ä½¿ç”¨HTTP.jlåŒ…ã€‚ åŒæ ·ï¼ŒBukdu.jlå’ŒGenie.jlè½¯ä»¶åŒ…ä¹Ÿéå¸¸æœ‰ç”¨ã€‚ è‡³å°‘åº”ç›‘è§†å…¶å‘å±•ã€‚ å…³äºMux.jlåŒ…ï¼Œå®ƒçš„ä¼˜åŠ¿ç°åœ¨åœ¨HTTP.jlçš„èƒŒæ™¯ä¸‹å¾—åˆ°äº†ä½“ç°ã€‚ å› æ­¤ï¼Œä¸ªäººæ„è§æ˜¯ä¸ä½¿ç”¨å®ƒã€‚  Genie.jlæ˜¯ä¸€ä¸ªéå¸¸æœ‰å‰é€”çš„æ¡†æ¶ã€‚ ä½†æ˜¯ï¼Œåœ¨å¼€å§‹ä½¿ç”¨å®ƒä¹‹å‰ï¼Œæ‚¨å¿…é¡»è‡³å°‘äº†è§£ä¸ºä»€ä¹ˆä½œè€…æœªå°†å…¶æ³¨å†Œä¸ºå®˜æ–¹è½¯ä»¶åŒ…ã€‚ </p><br><p> è¯·æ³¨æ„ï¼Œç¤ºä¾‹ä¸­çš„JSONååºåˆ—åŒ–ä»£ç ä½¿ç”¨æ—¶æ²¡æœ‰é”™è¯¯å¤„ç†ã€‚ åœ¨é™¤Genieä¹‹å¤–çš„æ‰€æœ‰æƒ…å†µä¸‹ï¼Œéƒ½æœ‰å¿…è¦å¤„ç†è§£æé”™è¯¯å¹¶å‘ŠçŸ¥ç”¨æˆ·æœ‰å…³ä¿¡æ¯ã€‚  HTTP.jlçš„æ­¤ç±»ä»£ç ç¤ºä¾‹ï¼š </p><br><pre> <code class="julia hljs"> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> message = <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> body = <span class="hljs-built_in"><span class="hljs-built_in">IOBuffer</span></span>(HTTP.payload(req)) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> message = JSON.parse(body) <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> err <span class="hljs-meta"><span class="hljs-meta">@error</span></span> err.msg <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> HTTP.Response(<span class="hljs-number"><span class="hljs-number">400</span></span>, string(err.msg)) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p> é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨Juliaä¸­å·²ç»æœ‰è¶³å¤Ÿçš„èµ„é‡‘æ¥åˆ›å»ºWebæœåŠ¡ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ— éœ€â€œé‡æ–°å‘æ˜è½®å­â€æ¥ç¼–å†™å®ƒä»¬ã€‚ ä¸‹ä¸€æ­¥æ˜¯è¯„ä¼°Juliaåœ¨æœ‰äººæ„¿æ„æ‰¿æ‹…çš„æƒ…å†µä¸‹å¦‚ä½•æ‰¿å—ç°æœ‰åŸºå‡†ä¸­çš„è´Ÿæ‹…ã€‚ ä½†æ˜¯ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹è¯¥è¯„è®ºã€‚ </p><br><h2 id="ssylki"> å‚è€ƒæ–‡çŒ® </h2><br><ul><li>  <a href="">https://github.com/JuliaWeb/HTTP.jl</a> </li><li>  <a href="">https://github.com/JuliaWeb/Mux.jl</a> </li><li>  <a href="">https://github.com/wookay/Bukdu.jl</a> </li><li>  <a href="">https://github.com/essenciary/Genie.jl</a> </li><li>  <a href="">https://github.com/JuliaComputing/Swagger.jl</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN449338/">https://habr.com/ru/post/zh-CN449338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN449324/index.html">è´Ÿè½½ï¼Œæ™ºèƒ½æ‰‹æœºï¼Œå·¨å‹å…¬å¸ï¼šHeisenbug 2019 Piterç¨‹åº</a></li>
<li><a href="../zh-CN449326/index.html">WebRTCå’Œè§†é¢‘ç›‘è§†ï¼šæˆ‘ä»¬å¦‚ä½•å…‹æœæ‘„åƒæœºçš„è§†é¢‘å»¶è¿Ÿ</a></li>
<li><a href="../zh-CN449330/index.html">ç›¸å¹²CFP2-ACO / CFP2-DCO WDMå…‰æ¨¡å—ï¼ˆ100G / 200Gï¼‰åŠå…¶åœ¨DWDMç³»ç»Ÿä¸­çš„åº”ç”¨</a></li>
<li><a href="../zh-CN449334/index.html">æŠ€æœ¯ç¿»è¯‘å¦‚ä½•å˜æˆå¾®å‹ä¾¦æ¢</a></li>
<li><a href="../zh-CN449336/index.html">è‰¾æ»‹ç—…æ¯’-ä»ç¬¬ä¸€ç§è¯ç‰©åˆ°ä»Šå¤©çš„æ²»ç–—</a></li>
<li><a href="../zh-CN449340/index.html">åŸºäºæ•°å­—ç­¾åçš„åŸºäºå—é¢„è¨€çš„éšæœºé¢„è¨€</a></li>
<li><a href="../zh-CN449342/index.html">åŸºäºåŒºå—é“¾æ•°å­—ç­¾åçš„éšæœºé¢„è¨€æœº</a></li>
<li><a href="../zh-CN449344/index.html">Kodim â€“æŠ«è¨</a></li>
<li><a href="../zh-CN449346/index.html">MODX Digestï¼ƒ4ï¼ˆ2019å¹´4æœˆ8æ—¥è‡³22æ—¥ï¼‰</a></li>
<li><a href="../zh-CN449348/index.html">Buildroot-ç¬¬2éƒ¨åˆ†ã€‚åˆ›å»ºç”µè·¯æ¿çš„é…ç½®ï¼› å¤–éƒ¨æ ‘çš„åº”ç”¨ï¼Œrootfsè¦†ç›–ï¼Œæ„å»ºåè„šæœ¬</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>