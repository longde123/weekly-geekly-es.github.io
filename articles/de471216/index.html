<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏩 📋 🚍 Die lange Geschichte des Reiseführers - wie ich 5 Jahre lang einen Dienst für intelligente Wanderwege geschrieben habe 👨🏼‍🏭 🐃 🥂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Viele haben eines oder mehrere ihrer Heimprojekte. Dies sind kleine Dienstprogramme, experimentelle Teile, Beispiele neuer Technologien, Facebook- „Ki...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die lange Geschichte des Reiseführers - wie ich 5 Jahre lang einen Dienst für intelligente Wanderwege geschrieben habe</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471216/"><p>  Viele haben eines oder mehrere ihrer Heimprojekte.  Dies sind kleine Dienstprogramme, experimentelle Teile, Beispiele neuer Technologien, Facebook- „Killer“ und vieles mehr.  Besonders seltener werden solche Projekte schon lange betrieben. </p><br><p>  In dem Artikel werde ich meine Erfahrungen teilen und Ihnen erzählen, wie ich 5 Jahre lang gelegentlich an der Entwicklung eines intelligenten Leitfadens für St. Petersburg gearbeitet habe, wie ich es geschafft habe, dieses Geschäft nicht aufzugeben, wie sich die Einstellung zum Projekt geändert hat und was am Ende passiert ist. </p><br><p><img src="https://habrastorage.org/webt/ee/8f/lg/ee8flg22vilx7tptxu7jal6iity.jpeg"></p><a name="habracut"></a><br><blockquote>  Viele zweifelhafte technische Lösungen und Fahrräder werden im Folgenden beschrieben, aber wundern Sie sich nicht - fast alle sind für die zu diesem Zeitpunkt verfügbaren Ziele und Ressourcen gerechtfertigt (= normalerweise mein Wissen und meine Zeit). </blockquote><br><h2 id="ideya">  Idee </h2><br><p>  In jeder großen Touristenstadt gibt es Hunderte von guten und nicht sehr guten Führern, in denen die Hauptrouten, die Hauptpunkte und eine Reihe anderer nützlicher Informationen angegeben sind. <br>  Aber die Routen dort sind konstant und begrenzt, und die Sehenswürdigkeiten sind normalerweise nur die wichtigsten, wie "was in 3 Tagen zu sehen ist". </p><br><p>  Daher kam die Idee, intelligente Routen zu bauen.  Der Benutzer wählt die Punkte A und B aus und erhält nicht die klassische kürzeste Route, sondern etwas in der Nähe, sondern fährt durch nahe gelegene Sehenswürdigkeiten. </p><br><p>  Das Publikum eines solchen Führers sind nicht nur Touristen, sondern auch Anwohner, die ihre typischen Routen nach Hause / zur Arbeit / zum Geschäft diversifizieren möchten (und es gab solche Bewertungen in der App!) Oder einfach nur die Stadt besser kennenlernen möchten. </p><br><p>  <strong>TL; DR</strong> <br>  Das Endergebnis ist die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wander</a> Android-Anwendung, die jetzt nur für St. Petersburg funktioniert. </p><br><h2 id="akt-1-prototip">  Akt 1: Prototyp </h2><br><p> Die Idee kam 2014 an die Universität zurück. Ich bin mir nicht einmal sicher, ob die Idee ursprünglich meine war. In einigen Fällen war es notwendig, in Gruppen aufzubrechen, Projekte zu entwickeln und diese als Hausarbeit abzuschließen.  Sie stürzten ab und generierten die Idee des Projekts, und dann begann der Name <code>TravelPath</code> . </p><br><p>  Es sollte ein Webdienst sein, ich wusste ein wenig über PHP, also entschied ich mich für PHP. <br>  Es war notwendig, mehrere Probleme zu lösen: </p><br><p>  <strong>1. Basis der Attraktionen</strong> <br>  Hier haben wir uns mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OpenStreetMap getroffen</a> . Es stellte sich heraus, dass dies das coolste Projekt ist, das perfekt zu uns passt.  OSM ist ein Community-basiertes, gemeinnütziges Community-Map-Projekt.  Wie bei Wikipedia nur über Karten. <br>  Laden Sie die Karte im XML-Format von St. Petersburg herunter - <a href="">es</a> gibt eine Liste von Ressourcen, in denen Sie dies tun können. <br>  Ich erinnere mich, dass zu dieser Zeit Kartendateien mehr als 1 GB wogen, sodass ein Streaming-Parser geschrieben wurde, der Objekte aus ausgewählten Kategorien auswählt - Denkmäler, Parks, Kirchen, Museen. <br>  OSM verfügt über eine umfangreiche Dokumentation zu Tags, Attributen und allem, was Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> benötigen. Dank dieser Dokumentation ist es nicht schwierig, herauszufinden, wie Sie die benötigten Daten von den Karten erhalten. </p><br><p>  Kartografische Daten werden von Enthusiasten erstellt, daher nicht überall und nicht immer haben Objekte die erforderlichen Tags, einige Orte haben Fehler, Probleme.  Für Großstädte sind die Daten jedoch von recht hoher Qualität. </p><br><p>  Wenn ich meinen alten Code korrekt ausgegraben habe, habe ich die folgenden Tags zum Abrufen von Objekten verwendet: </p><br><ul><li>  <code>building</code> bedeutet <code>cathedral</code> , <code>chapel</code> , <code>church</code> ist zu einer <code>church</code> </li><li>  <code>amenity</code> mit <code>fountain</code> fällt ins <code>monument</code> </li><li>  <code>tourism</code> mit <code>artwork</code> und <code>viewpoint</code> geht zu <code>monument</code> , <code>zoo</code> und <code>museum</code> zu <code>museum</code> und <code>theme_park</code> zu <code>park</code> </li><li>  <code>historic</code> mit <code>boundary_stone</code> , schloss, <code>monument</code> , <code>monument</code> gehen in denkmalkategorie </li><li>  <code>leisure</code> mit einem Wert im <code>park</code> endet natürlich im <code>park</code> </li></ul><br><p>  Wir legen alle empfangenen Objekte mit Koordinaten in eine Datenbank und freuen uns!  In St. Petersburg wurden über 1.200 Punkte freigegeben. </p><br><p>  <strong>2. Eine Route erstellen</strong> <br>  Es war nicht beabsichtigt, komplexe Systeme als Teil des Kurses zu implementieren, und das technische Wissen war zu dieser Zeit knapp. Daher beschlossen wir, die Routenkonstruktion in zwei Teile zu unterteilen: die Auswahl der Objekte in der Route und die Routenkonstruktion selbst.  Zum Teil bestimmte dies das Schicksal der Zukunft, weil ich später dieses Schema nicht ändern wollte. </p><br><p>  Die Erstellung einer Route zwischen den ausgewählten Punkten wurde von der Google Maps-API vorgegeben, die Autorouten recht gut baute, aber zu diesem Zeitpunkt zumindest in Russland nicht wusste, wie man läuft. </p><br><p>  Die Auswahl der Objekte musste von Ihnen selbst vorgenommen werden.  Es stellte sich das folgende Schema der Anmeldung heraus: </p><br><p><img src="https://habrastorage.org/webt/qf/ji/cu/qfjicujbis8zm-4ojiuumt9vkqk.jpeg"></p><br><p>  Der Hauptnachteil des Ansatzes ist die Auswahl von Punkten in der Route ohne Berücksichtigung der Karte, nur basierend auf GPS-Koordinaten.  Und insgesamt funktioniert dies ziemlich gut, insbesondere wenn es ein häufiges Straßenraster gibt.  Seltene Probleme machen sich beispielsweise an Flüssen mit seltenen Brücken bemerkbar. </p><br><p>  Als nächstes entwickeln wir einen Algorithmus zum Auswählen von Punkten in der Route.  Einerseits ist es notwendig, dass die Route nicht viel zur Seite umleitet, andererseits werden dennoch einige Punkte in den angegebenen Stadtteilen ausgewählt. </p><br><p>  Keine sehr klare Aussage über das Problem, es kam derselbe Algorithmus heraus, ähnlich wie A * ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wiki</a> ): Es wird angenommen, dass es von jedem Punkt Übergänge zu jedem gibt.  Darüber hinaus wird in A * der Preis für das Gehen zum Scheitelpunkt n bei der Suche nach der AB-Route normalerweise wie folgt ausgedrückt: <code>f(n) = g(An) + h(nB)</code> , wobei <code>g(x,y)</code> die Pfadlänge von x nach y und <code>h(x,y)</code> ist eine heuristische Schätzung des Abstands von x zu y.  Mein Preis ist der gleiche - <code>f(n) = h(x,n) + h(n,y) * q</code> , wobei q eine Konstante kleiner als 1 ist. Durch Ändern des Werts von q können Sie die Anzahl der Punkte auf der Route beeinflussen. </p><br><p>  Wir implementieren den Algorithmus und, Prost, alles funktioniert, befestigen die Schnittstelle, kaufen eine Domain, laden sie auf das Hosting hoch, schreiben Berichte und andere Bürokratie und freuen uns!  Es sah ungefähr so ​​aus (und änderte sich danach nicht viel): </p><br><p><img src="https://habrastorage.org/webt/b3/fw/uz/b3fwuz0lqz_x3z2adx9qv-usau8.jpeg"></p><br><p>  <strong>Insgesamt: Ich</strong> habe einen Prototyp einer coolen Idee bekommen, OSM und Google API kennengelernt, als Team gearbeitet, an der Universität Anerkennung erhalten und es war auch interessant. </p><br><h2 id="akt-2-pervaya-polnocennaya-web-versiya">  Akt 2: Erste vollständige Webversion </h2><br><p>  Die Idee hat mir sehr gut gefallen und ich habe beschlossen, sie weiterzuentwickeln, aber bereits eine.  Und es war sofort klar, was zuallererst benötigt wurde: Zu dieser Zeit war Google Maps noch nicht in der Lage, Wanderrouten zu bauen, es wurden nur Automobilrouten gebaut.  Bei der gesamten Idee der Anwendung geht es in erster Linie um das Gehen. Das bedeutet, dass Sie Routen entlang der schattigen Gassen von Parks, Fußgängerwegen, Brücken und vielem mehr erstellen müssen. </p><br><p>  Es war im Jahr 2015, und ich arbeitete weiter an TravelPath, nahm die Korrektur dieses schwerwiegenden Fehlers auf - ich begann, selbst Wege zu bauen. </p><br><p>  Ich habe die Technologie <code>PHP</code> + <code>MySQL</code> nicht geändert.  Natürlich wurde mir sofort klar, dass dies nicht der beste technische Stack für eine solche Aufgabe war (Routen in PHP erstellen? Ernsthaft?). <br>  Aber ich war zeitlich begrenzt und nicht bereit, zu einem vernünftigeren Stapel zu wechseln, und zweitens wurde das Projekt bis jetzt "auf den Tisch" geschrieben - ich möchte eine solche Anwendung von einem mobilen Gerät aus verwenden, und in diesen Jahren bedeutete dies nur native Entwicklung.  Das heißt, seine Unanwendbarkeit in Form einer Webversion war trotz einiger Versuche, eine adaptive Schnittstelle zu erstellen, offensichtlich. </p><br><p>  Folgende Aufgaben entstanden: </p><br><p>  <strong>1. Ein Stadtdiagramm erhalten</strong> <br>  Hier rettet uns das gleiche OSM.  Laden Sie das Diagramm erneut im XML-Format herunter, analysieren Sie es, wählen Sie nur die erforderlichen Straßentypen aus und staunen Sie über die Datenmenge - zu diesem Zeitpunkt kamen mehr als 3 Millionen Scheitelpunkte und 500.000 Kanten heraus.  Die erste Idee ist, dass der Graph möglicherweise nicht in Beziehung steht. <br>  Alle Innenhöfe, umschlossenen Gebiete und unverständlichen Dinge sind für die Erstellung einer Route nicht sehr interessant. Daher wählen wir einen Punkt aus, umrunden das gesamte Diagramm, markieren die übergebenen Scheitelpunkte und erhalten den verbundenen Teil des Diagramms. <br>  Insgesamt kamen mehr als 600.000 Spitzen und 150.000 Kanten heraus. <br>  Das empfangene in der Datenbank gespeichert und bis zu besseren Zeiten verlassen. </p><br><p>  <strong>2. Eine Route erstellen</strong> <br>  Es gibt Daten, alles bleibt den Kleinen überlassen: Erstellen Sie Routen darauf.  Wir mussten nichts Neues erfinden - denken Sie an den Verlauf der Algorithmen, lesen Sie die Artikel zum Arbeiten mit Grafiken sorgfältig durch, nehmen Sie den A * -Algorithmus, implementieren Sie ihn in PHP und <del>  freue dich </del>  frustriert darüber, wie langsam alles funktioniert. </p><br><p>  Es gibt viele Daten, daher verwenden wir beim Erstellen des Diagramms nicht das vollständige, sondern lesen nur einen Teil davon - alles, was in das Rechteck fällt, das von allen ausgewählten Punkten in der Route erhalten wurde. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qc/p7/9k/qcp79klhlir-x7udd5im-0h-cw0.jpeg"></div><br><p>  (roter Rahmen = ~ ein solches Diagramm wurde gelesen, um den Pfad zu erstellen) </p><br><p>  Das gleiche gilt für die Kandidatenpunkte für die Route - wir berücksichtigen nicht alles, sondern nur die zwischen Anfang und Ende + einen kleinen Wert. <br>  Nachdem wir die Größe dieses Rechtecks ​​ausgewählt haben (die Konstante, um die wir es erhöhen), versuchen wir sicherzustellen, dass wir die minimal erforderliche Datengröße lesen. <br>  Es gab auch die Idee, die Stadt in Quadrate zu zerlegen, die Route zuerst nach Quadraten zu bauen, dann die Grafik innerhalb dieser Quadrate zu lesen und nur entlang dieser einen Pfad zu suchen.  Und Sie können die Pfade zwischen allen benachbarten Quadraten vorberechnen.  Oder noch mehr - um den Pfad zwischen allen Sehenswürdigkeiten zu berechnen und zu speichern.  Im laufenden Betrieb müssen dann nur noch die Pfade vom ersten bis zum ersten Objekt und vom letzten Objekt bis zur Ziellinie erstellt werden. <br>  Aber die Hände erreichten nicht die Realisierung solcher Fahrräder. </p><br><p>  <strong>3. Routing in angemessener Zeit</strong> <br>  Es wurde sofort klar, dass der Engpass darin besteht, Daten zu speichern und mit ihnen zu arbeiten - der Suchalgorithmus selbst ist nicht besonders beschleunigt.  Und Benchmarks am Knie bestätigen, dass die meiste Zeit mit Lesen aus der Datenbank und ähnlichen Manipulationen verbracht wird. <br>  Was ist in solchen Fällen zu tun?  Speichern Sie dieses Diagramm nicht.  Aber ich habe einen besonderen Weg, <code>MySQL</code> und nichts weiter, aber das Problem muss gelöst werden. </p><br><ol><li>  Das allererste - die Daten wurden normalisiert, was beim Parsen praktisch war, aber das Lesen von Zehntausenden von Datensätzen und sogar von zwei Tabellen ist schmerzhaft.  Die naheliegende Lösung besteht darin, eine von zwei Tabellen (für Scheitelpunkte und Kanten) nur für Kanten zu erstellen, in denen in jedem Datensatz die Koordinaten beider Scheitelpunkte und ihre ID aufgezeichnet werden. </li><li>  Wir zählen im Voraus die nächstgelegenen Eckpunkte des Diagramms zu den Sehenswürdigkeiten und tun dies nicht jedes Mal im laufenden Betrieb. </li><li>  Es wird viel Zeit damit verbracht, nach dem Diagrammpunkt zu suchen, der dem angegebenen Benutzer am nächsten liegt.  Um dies zu beschleunigen, habe ich das gesamte Diagramm in kleine Sektoren unterteilt. Mithilfe der Koordinatenformel können Sie sofort die Sektor-ID abrufen und dann den Scheitelpunkt nur innerhalb des Sektors und nicht im gesamten Diagramm auswählen, was viel schneller ist. </li></ol><br><p>  Nach all den Manipulationen erhalten wir innerhalb von 2 Sekunden den Bau einer angemessenen Wanderroute in St. Petersburg, was sich gut anhört - dies ist eine akzeptable Wartezeit für Benutzer. <br>  Das endgültige Schema sah folgendermaßen aus: </p><br><p><img src="https://habrastorage.org/webt/gk/f0/mh/gkf0mhnk5i9xnnnm6g1eym_a3ce.jpeg"></p><br><p>  <strong>Insgesamt: Ich</strong> habe <strong>mich</strong> noch besser mit OSM-Daten vertraut gemacht, in der Praxis habe ich Grafikprobleme gelöst (der Fall, als Grafikalgorithmen endlich nützlich waren) und meine ersten Benchmarks geschrieben. </p><br><h2 id="akt-3-pervaya-normalnaya-web-versiya">  Akt 3: Die erste normale Webversion </h2><br><p>  Hier kommen die ersten Gedanken über das Projekt als ein Produkt, das für jemanden nützlich sein kann, und nicht über das Handwerk auf dem Tisch. <br>  Sie müssen also die beiden wichtigsten Probleme lösen: </p><br><ol><li>  Es war sofort klar, dass das Bauen von Routen wie im letzten Absatz falsch ist. </li><li>  Eine Anleitung im Browser ist möglicherweise für niemanden geeignet. Sie möchten durch die Stadt spazieren und eine praktische Anwendung suchen, in der Sie lesen können, was das Besondere ist, und so weiter.  Kurz gesagt, zumindest - Sie benötigen eine coole adaptive Benutzeroberfläche und auf gute Weise eine mobile Anwendung. </li></ol><br><p>  Aber zu diesem Zeitpunkt habe ich beschlossen, mich nur mit dem ersten Punkt zu befassen.  Wir studieren das Internet zu diesem Thema und auch hier hilft OSM, oder besser gesagt das Projekt, das dank ihnen geboren wurde - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OSRM</a> . <br>  Basierend auf Kartendaten von OSM kann die Open Source Routing Machine in kürzester Zeit eine Vielzahl von Routen erstellen.  Ja, und ein Open Source-Projekt mit guter Dokumentation, die Sie auf Ihrem Server installieren und verwenden können. <br>  Als Bonus hat es auch eine ziemlich bequeme API. <br>  Und Antaresm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">schrieb</a> bereits über OSRM auf einem Habr, der mir damals half.  Es stimmt, es ist viel Wasser geflossen und der Artikel ist veraltet.  Aber vielen Dank an den Autor!  Die aktuelle und ziemlich gute Dokumentation finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br>  Nach einer erfolgreichen Installation werfen wir fast ohne Bedauern unseren gesamten Code über die Routen aus und beginnen, den Routen in der OSRM-API zu folgen. Das endgültige Diagramm sieht folgendermaßen aus: </p><br><p><img src="https://habrastorage.org/webt/by/2_/sg/by2_sgklt4qfns1b6l_i544t9z8.jpeg"></p><br><p>  Wir berühren nicht einmal den Client-Teil - seinerseits ändert sich die API unseres Service in keiner Weise. </p><br><p>  <strong>Total</strong> : Ich habe über die tatsächliche Verwendung der Anwendung durch andere nachgedacht. Es stellte sich heraus, dass es sich um eine normale Architektur und gute Routen handelt.  Die Webversion ist weiterhin verfügbar, hat sich jedoch seitdem nicht geändert.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://travelpath.ru/</a> </p><br><h2 id="akt-4-android-prilozhenie">  Akt 4: Android App </h2><br><p>  Trotz der Lösung eines früheren Problems ist immer noch klar, dass das Projekt für alle außer mir immer noch nutzlos ist.  Weil Sie eine normale Benutzeroberfläche und vor allem eine mobile Anwendung benötigen, keine Browserversion.  Jetzt ist die Technologie fortgeschritten und es wird vielleicht bereits möglich sein, eine gut funktionierende Browseranwendung dieser Art für mobile Clients zu erstellen, jedoch nicht in den Jahren 2015-2016.  Dies bedeutete eine sehr enge Möglichkeit, das Projekt in Form einer Webversion zu verwenden - um zu Hause zu sitzen und interessante Orte auszuwählen, die im Voraus besucht werden sollten.  Wenn es sich also um ein normales Produkt handelt, benötigen Sie eine mobile Anwendung mit einer guten Benutzeroberfläche. </p><br><p>  Bis 2016 habe ich dann angefangen, in Java (aber im Backend) zu schreiben und dachte, dass sie unter Android auch in Java schreiben.  Probieren Sie die Anwendungsentwicklung aus, es sollte eine interessante Erfahrung sein. <br>  Das zweite Problem ist, dass ich nicht weiß, wie man entwirft, und selbst keine gute Benutzeroberfläche mache.  Ich besuchte meinen ersten Arbeitsplatz (ein kleines Studio Le-Dantu) und lud meinen Kollegen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Burovk ein,</a> an dem Projekt teilzunehmen.  Seltsamerweise stimmte er zu, wofür vielen Dank :) </p><br><p>  <strong>Die ersten Layouts und Prototypen</strong> <br>  Zunächst versuchen wir, einen neuen Namen zu finden, da TravelPath keine sehr und zu sprechende Abkürzung ist.  Und so erscheint durch die Bemühungen von Cyril "Wander" mit einem lustigen Logo: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6t/8y/7f/6t8y7fht6pqmxvwnajhrtimxe5u.png"></div><br><p>  Ich habe es stark mit einem Mann mit Schnurrbart in Verbindung gebracht, aber im Allgemeinen mag ich es. </p><br><p>  Dann erscheinen die ersten Layouts der zukünftigen Anwendung: </p><br><p><img src="https://habrastorage.org/webt/t4/u6/x8/t4u6x8pszrlpk7vop64rizgsywu.jpeg"></p><br><p>  Wir denken auch, diskutieren, die zweite Option erscheint, die die erste Version der Anwendung wird: </p><br><p><img src="https://habrastorage.org/webt/uk/nr/py/uknrpyeckiz1gdqogmtyngojun4.jpeg"></p><br><p>  Von der Entwicklungsseite aus habe ich mich bewusst dafür entschieden, nicht alle Arten von trendigen Frameworks zu verwenden, die unterschiedliche Magie bewirken - da es große Risiken gibt, wenn man sie verwendet, ohne die Arbeit zu verstehen, und sowohl die Grundlagen als auch sie zu zeitaufwändig zu studieren.  Google, wir lesen offizielle Docks, Lehrartikel und überwinden Schwierigkeiten. </p><br><p>  Von den Problemen und Aufgaben, an die man sich erinnert: </p><br><ul><li>  Für Android gibt es <code>ProGuard</code> - ein Dienstprogramm, das den Quellcode während der Montage komprimiert, nicht verwendete Elemente herausschneidet, Namen ändert und vieles mehr.  Es ist vernünftig, dass es existiert, aber wenn Sie einfach in die Entwicklung gehen und es selbst tun, ist es nicht offensichtlich, dass es Umbenennungsfelder gibt, und dies kann das Verhalten beeinflussen.  Und dass alles nur in der Prod Assembly passiert.  Als Ergebnis der Veröffentlichung ist alles cool, aber aus irgendeinem Grund gibt es keine Statistiken.  Sie beginnen mit der Belastung vom Backend - und der Client sendet anstelle der normalen Feldnamen Unsinn - <code>a, b, c</code> usw.  Krücken, damit die API dies geschickt analysieren kann, und dann stellen Sie fest, dass ProGuard es versucht hat, und Sie müssen die erforderlichen Klassen als Ausnahme in der Konfiguration angeben.  Im Allgemeinen nichts Ungewöhnliches, aber die Debugging-Uhr flog davon. </li><li>  Eine interessante Aufgabe war die Aktualisierung der Anwendungsdaten.  Die Hauptdatenbank enthält eine <code>apk</code> Datei, die ich vor jeder Veröffentlichung aktualisiere.  Sie müssen das Update jedoch auch über das Netzwerk unterstützen, damit Clients bei Änderungen immer über neue Daten verfügen. <br>  In der ersten Version habe ich mich entschieden, mich nur auf die Zeit des letzten Updates zu konzentrieren.  Die Anwendung speichert die Zeit des aktuellsten Objekts und fragt bei jedem Start das Backend mit dieser Zeit, ob etwas Neues aufgetreten ist.  Aktualisierungen werden an ihn gesendet, der Client merkt sich erneut die Zeit des neuesten empfangenen Objekts (aber nicht die Zeit der Aktualisierung selbst, dies ist wichtig). <br>  Es stellte sich heraus, dass ich schlecht gedacht hatte - weil ein Jahr später eine fünfte Kategorie erschien - Gebäude.  Beim Upgrade von der alten auf die neue Version tritt ein Problem auf.  Ich musste mich ein wenig ändern und der Kunde sendet Zeit für jede Kategorie, nicht für die allgemeine.  Das Schema ist jedoch immer noch nicht perfekt - beim Hinzufügen neuer Felder zu Objekten treten Probleme auf, die so nicht gelöst werden können.  Es gibt Ideen, wie man es besser machen kann, aber die Hände haben es nicht erreicht und im Allgemeinen hat die Aufgabe keine große Priorität.  Moral - es lohnt sich, diese Themen sorgfältig anzugehen und ein wenig im Voraus zu überlegen. </li></ul><br><p>  Und ich möchte auch sagen, was jeder bereits weiß - Stack Overflow ist unglaublich cool und dies macht sich besonders bemerkbar, wenn Sie wie ich in die Entwicklung von etwas Außergewöhnlichem einfliegen -, schreiben Sie die Anwendung sofort und nicht reibungslos aus Kursen, Anleitungen und Demo-Beispielen .  Und wenn niemand einen Freund fragen kann.  Neben ihm halfen aber auch Chats über die Android-Entwicklung - dort können Sie abstraktere Fragen stellen und nach Tipps fragen, wie man etwas am besten macht. </p><br><p>  5. Dezember 2016 die Anwendung trifft Google Play <br>  Er hatte nur grundlegende Funktionen - eine Route legen, Informationen über Punkte anzeigen.  Aber auch das schien ein Erfolg zu sein!  Erfolg natürlich nur in den eigenen Augen.  Man war sich einig, dass die Anwendung noch roh ist und verbessert werden muss. </p><br><p>  <strong>Die erste Vollversion und die Medien</strong> <br>  Daher betrachte ich die nächste Version als Vollversion und ersten Start. <br>  Zuerst haben wir sowohl das Design als auch das Logo überprüft - jetzt ist es so geworden: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4c/0q/ii/4c0qii9_t77tgksfkp31mldx94k.png" width="96"></div><br><p>  Und sie fügten Funktionen hinzu, die für den Reiseführer wichtig sind - Favoriten, Anzeigepunkte auf der Karte selbst, eine Liste von Attraktionen mit einer Suche.  Die aktualisierte Anwendung sah folgendermaßen aus: </p><br><p><img src="https://habrastorage.org/webt/eo/fh/2j/eofh2jhc1tjz8lyrc1t-ra9kpnk.jpeg"></p><br><p>  Eine andere Idee kam auf - Museum Night zu kontaktieren und einen separaten Modus für die Veranstaltung in St. Petersburg zu erstellen. <br>  Die Museumsnacht ist ein jährlicher internationaler Feiertag, an dem Museen nachts oft mit speziellen Programmen geöffnet sind.  Ein einziges Ticket ist gültig und viele versuchen, viele Museen gleichzeitig zu erkunden.  Gleichzeitig gibt es keinen Navigator / keine Karte für Handys - nur einige Funktionen auf der offiziellen Website der Veranstaltung. <br>  Es klingt so, als würde es perfekt zur Idee von Wander passen und ist auch gefragt.  Ich habe die Organisatoren der Veranstaltung kontaktiert, aber leider wurde die Idee nicht gewürdigt und blieb mir bis zu besseren Zeiten im Gedächtnis. </p><br><p>  Am Ende stellte sich heraus, dass es cool war und die Anwendung endlich voll genutzt werden konnte.  Am 2. Juni 2018 wurde eine Veröffentlichung veröffentlicht und wir beschlossen, sie der Welt zu zeigen - wir kauften Werbung auf VKontakte und Instagram.  Vor allem aber schrieben sie an einige Medien.  Das Papier schrieb eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Notiz</a> über den Start der Anwendung, nachdem eine Reihe von Petersburger Veröffentlichungen - The Village, Dog und andere - mit einem Fan geschrieben oder nachgedruckt worden waren.  Und schließlich gab es Verkehr!  Die Installationen wurden mit einem Spitzenwert und Aktivitätsdiagrammen auch innerhalb der Anwendung beschleunigt.  Natürlich mussten wir uns nicht lange freuen - aber wir bekamen die ersten Benutzer, ein nützliches Feedback und im Allgemeinen war es sehr motivierend.  Im selben Sommer war der Verkehr von der Google Play-Suche spürbar, was sehr erfreulich war, aber später konnte das Ergebnis nicht reproduziert werden. <br>  Alles in allem war dies eine ziemlich starke Motivation und half, weiter an der Anwendung zu arbeiten. </p><br><p>  <strong>Was ist als nächstes zu tun?</strong>  <strong>Museumsnacht, böses Google, Rundwege</strong> </p><br><p>  Die Saison ist vorbei, die Aktivität in der Anwendung ist dramatisch gesunken und es war klar, dass nur Sägefunktionen nicht sehr nützlich sind - niemand wird sie sehen, es gibt kein Budget für Marketing.  Es war notwendig, sich etwas auszudenken, und dann kehrten wir mit der Nacht der Museen wieder zu der verschobenen Idee zurück. <br>  Aber auch hier war es nicht möglich, eine Partnerschaft zu vereinbaren, doch diesmal beschlossen wir, die Idee nicht aufzuschieben, sondern alles selbst zu tun.  In einem separaten Führungsmodus stellte sich eine Reihe nützlicher Funktionen heraus: Museen auf der Karte, Routen nur für Teilnehmer, Kurzinformationen, Favoriten. </p><br><p>  Zusätzlich zu diesem Modus haben wir sogar aus dem Rückstand die Beibehaltung der Route und vor allem die Funktion über Rundstrecken erhalten. </p><br><p>  Kreisrouten waren immer wichtiger als AB-Routen, wurden aber hartnäckig ignoriert.  Trotzdem laufen die Leute oft in der U-Bahn / zu Hause / bei der Arbeit / im Hotel herum als absichtlich von A nach B. Schließlich erreichten sie ihre Hände und ich fand eine einfache Heuristik: <br>  Wir erhalten alle Punkte innerhalb des angegebenen Radius.  Der Radius ist der Begrenzer für die Länge der Route.  Wir wählen zuerst einen Punkt aus (bedingt zufällig).  Alle anderen davon werden in aufsteigender Reihenfolge des Winkels zwischen ihm, dem Mittelpunkt und dem gegebenen Punkt sortiert.          /  ,  . </p><br><p>       ,            . </p><br><p>     ,  ,   : </p><br><p><img src="https://habrastorage.org/webt/fe/nx/6s/fenx6slnfgifc85nw-prhsv51mq.jpeg"></p><br><p>    ,   ,       ,     ,  ,    .     —  ,         , . </p><br><p>        Kotlin   , ,   Wander.   ,     .    ,   .         ,     java   —       . </p><br><p>     ,  ,  ,   .          —    The Village.        -        1000 ,    1400   . ,      Wander  , , ,       .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> . </p><br><p>    Google  .            —  2018      ,         API.        —         2018-        <code>Places API</code>   .         API,   -  —        .        . </p><br><p>        —  <code>Places API</code> ,          .        ,      .  ,         —   Google Maps,    .           . </p><br><p> <strong></strong> :  android        Google Play,       .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">burovk</a> ,    Wander    ,       . </p><br><h2 id="ty-teper-ne-tolko-razrabotchik">      </h2><br><p>    ,   ,       ,     —       .      ,  ,    ,      —     .   ,   — ,      .    ,         ,     . </p><br><ul><li>                 —          <code>git tag v1.0.5</code> . </li><li>   ,   ,   ,    . </li><li>         -   ,       . </li><li>            —      ,    //etc       . </li></ul><br><p>        Android  .      , ,      ,       . </p><br><p>       —      ,    . </p><br><h2 id="plany">  </h2><br><p>  !  ,       .  , ,    ,           ,      ,   . <br>      : </p><br><ol><li>     — ? -   ? </li><li>   .   ,    —   . </li><li>   IOS </li><li>   </li></ol><br><p>     . ,   IOS      ,    . </p><br><p>      — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  </a> .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Play</a> . </p><br><h2 id="vyvody">  Schlussfolgerungen </h2><br><ul><li>      ,   — .      ,          .           . ,       . </li><li>   —  ,      .   backend ,       ,    android   Kotlin,   ,  ,     .     ,     . </li><li>      — .      - ,           .   -   .   ,    —   . </li></ul><br><p>     .         IOS (   ) —   ! </p><br><p>  PS <br>         — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://habr.com/post/414433/</a> .         . ,       (    -!),       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471216/">https://habr.com/ru/post/de471216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471198/index.html">Wir untersuchen die Aussage des zentralen Grenzwertsatzes anhand der Exponentialverteilung</a></li>
<li><a href="../de471202/index.html">Wie ich mein MacBook aufgrund der Entfernung von TeamViewer nicht einschalten konnte</a></li>
<li><a href="../de471204/index.html">Erkennen Sie Datum und Uhrzeit in natürlicher Sprache</a></li>
<li><a href="../de471210/index.html">Gott ... Ballade über einen Programmierer</a></li>
<li><a href="../de471212/index.html">10 Tipps und Tricks, mit denen Sie der beste Entwickler für VueJS werden können</a></li>
<li><a href="../de471220/index.html">Cockpit - Vereinfachen Sie typische Verwaltungsaufgaben unter Linux über eine praktische Weboberfläche</a></li>
<li><a href="../de471222/index.html">Das Verständnis der Datenschutzrichtlinien für Anwendungen und Dienste hilft neuronalen Netzen</a></li>
<li><a href="../de471226/index.html">Linux hat viele Gesichter: wie man an jeder Distribution arbeitet</a></li>
<li><a href="../de471228/index.html">Grokay PyTorch</a></li>
<li><a href="../de471232/index.html">Meine Erfahrung mit der Verbindung von LPS331AP mit Omega Onion2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>