<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍⚖️ 📧 🔺 有趣的考古学：放大镜下的样式指南R 🔂 🥫 🤹🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="如您所知，代码的读取次数比编写的次数要多。 这样至少除作者以外的其他人都可以阅读它，并且有样式指南。 对于R，这可能是例如Hadley手册。 

 样式指南不仅是开发人员之间的默认协议-许多规则都有很好的背景。 为什么箭头<-比等号= ，为什么R的旧时人不喜欢下划线，推荐的行长与打孔卡之间的关系，等...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>有趣的考古学：放大镜下的样式指南R</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454432/">如您所知，代码的读取次数比编写的次数要多。 这样至少除作者以外的其他人都可以阅读它，并且有样式指南。 对于R，这可能是例如Hadley手册。 <br><br> 样式指南不仅是开发人员之间的默认协议-许多规则都有很好的背景。 为什么箭头<code>&lt;-</code>比等号<code>=</code> ，为什么R的旧时人不喜欢下划线，推荐的行长与打孔卡之间的关系，等等。 <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">免责声明：R样式指南</b> <div class="spoiler_text"> 与Python不同，R没有统一的标准。 因此，没有单一的指南。 除了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Hadley指南</a> （或其<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">tidyverse的</a>扩展版本）之外，还有其他一些指南，例如<a href="">Google</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Bioconductor</a> 。 <br><br> 但是，可以将Hadley指南视为最常见的指南（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">内置的</a> RStudio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">检查</a> ），而Hadley自己创建的库（dplyr，ggplot，tidyr以及tidyverse集合中的其他库）的普及极大地简化了该指南。 <br></div></div><br><h2>  1.赋值运算符： <code>&lt;-</code> vs <code>=</code> </h2><br> 所有可用指南都建议使用非标准运算符<code>&lt;-</code> ，但不要使用等号<code>=</code> ，这在其他现代语言中很常见。 甚至没有提到其他三个运算符（ <code>&lt;&lt;-</code> ， <code>-&gt;</code> ， <code>-&gt;&gt;</code> ）（就像早期版本中的运算符<code>:=</code> ）。 看来，为什么我们需要这个非标准箭头？ <br><br> 历史向我们揭示了卡片：在R中，箭头来自S，而箭头又从APL继承而来。 在APL中，它使我们能够将分配与平等区分开。 在R中，相等运算符是标准的，因此差异是不同的。 如果箭头最初是赋值运算符，则等号<i>仅</i>将值分配<i>给</i>命名参数。 在2001年，等号成为了赋值运算符，但从未成为箭头的同义词。 <br><br> 是什么让我们考虑<code>=</code>完全替代箭头？ 首先， <code>=</code>赋值运算符仅在顶层工作。 例如，在函数内部，一切将像以前一样工作： <br><br><pre> <code class="julia hljs">mean(x = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-comment"><span class="hljs-comment"># [1] 3 x # Error: object 'x' not found mean (x &lt;- 1:5) # [1] 3 x # [1] 1 2 3 4 5</span></span></code> </pre><br> 这里<code>=</code>仅设置函数参数，而<code>&lt;-</code>还将值分配给变量x。 我们可以通过将赋值操作放在括号中来达到相同的效果<s>（不，这仍然不是Lisp）</s> ： <br><br><pre> <code class="julia hljs">mean ((x = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># [1] 3 x # [1] 1 2 3 4 5</span></span></code> </pre><br>  ...或大括号： <br><br><pre> <code class="julia hljs">mean ({x = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>}) <span class="hljs-comment"><span class="hljs-comment"># [1] 3 x # [1] 1 2 3 4 5</span></span></code> </pre><br> 此外，箭头优先于等号： <br><br><pre> <code class="julia hljs">x &lt;- y &lt;- <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment"># OK x = y = 2 # OK x = y &lt;- 3 # OK x &lt;- y = 4 # Error in x &lt;- y = 4 : could not find function "&lt;-&lt;-"</span></span></code> </pre><br> 最后一个表达式失败，因为它等于<code>(x &lt;- y) = 4</code> ，并且解析器将其解释为 <br><br><pre> <code class="julia hljs"><span class="hljs-string"><span class="hljs-string">`&lt;-&lt;-`</span></span>(x, y = <span class="hljs-number"><span class="hljs-number">4</span></span>, value = <span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre><br> 换句话说，我们试图执行不正确的操作：首先我们将x分配给y，然后尝试将x和y分配给4。仅当您使用括号更改操作的优先级时，该表达式才会被正确处理： <code>x &lt;- (y = 4)</code> 。 <br><br><h2>  2.间距 </h2><br> 该指南建议在运算符之间（当然，方括号，：，::和:::除外）以及左括号之间放置空格。 显然，这是GNU编码标准的一部分。 但是，此子句与<code>&lt;-</code>作为赋值运算符的使用密切相关。 举个例子 <br><br><pre> <code class="julia hljs">x &lt;-<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br> 这是什么  X小于-1？ 或将x设为1？ <br><br> 但是，多余的空间并不比缺少的空间好，例如： <br><br><pre> <code class="julia hljs">x &lt;- <span class="hljs-number"><span class="hljs-number">0</span></span> ifelse(x &lt;-<span class="hljs-number"><span class="hljs-number">1</span></span>, T, F) <span class="hljs-comment"><span class="hljs-comment"># [1] TRUE x &lt;- 0 ifelse(x &lt; -1, T, F) # [1] FALSE</span></span></code> </pre><br> 在第一种情况下， <code>&lt;</code>和<code>-</code>之间没有空格，这将创建一个赋值运算符。 <br><br><h2>  3.函数和变量的名称 </h2><br> 样式指南在名称问题上存在分歧：Hadley指南建议在所有名称下划线。  Google指南-以点分隔变量和驼峰样式，函数首小写；  Bioconductor建议针对功能和变量使用lowerCamel。  R社区在这个问题上没有统一性，可以找到所有可能的样式： <br><br><pre> <code class="julia hljs">lowerCamel period.separation lower_case_with_underscores allowercase UpperCamel</code> </pre><br> 即使对于基本R名称也没有统一的样式（例如，行名和row.name是不同的功能！）。 如果您不考虑不允许使用的大写字母（只有Matlab用户会喜欢），则有三种最受欢迎​​的样式：lowerCamel，带_的小写字母和带点分隔的小写字母。 <br><br><img src="https://habrastorage.org/webt/kv/mr/a1/kvmra14xyiec6k6eiya0s6nxmys.png"><br><br> 函数名称和参数使用不同样式（一种名称可以对应不同样式）。 资料来源：RasmusBååth在useR！2017上的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">表现</a> 。 <br><br><div class="spoiler">  <b class="spoiler_title">2012年也是如此</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wx/tj/tt/wxtjttoeaoxb1zzoyokrrbxh2pg.png"><br> 资料来源：Baath（2012）。  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">R中的命名约定状态</a> ”。  R杂志第一卷  4/2，第74-75页。 <br></div></div><br> 点对点分离让人不禁联想到面向对象编程中方法的使用，但在历史上是很普遍的。 这种特殊的样式非常普遍，可以被视为真正的R'vsky。 例如，大多数基本功能都专门使用它（并且每个刚遇到data.table和as.factor的人）。 <br><br> 但是分隔符_是最不流行的样式之一（在这里，哈德利与大多数人背道而驰）。 对于许多R用户而言，下划线会很烦人：在流行的Emacs Speaks Statistics扩展中，默认情况下将其替换为赋值运算符<code>&lt;-</code> 。 当然，默认设置<s>几乎</s>没有任何变化。 <br><br> 但是，Emacs ESS的影响仍然是“尾巴摇狗”类别的一种解释。 还有一个更古老的原因：在R的早期版本中，下划线是箭头<code>&lt;-</code>同义词。 例如，在2000年，您可能会<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">遇到</a>以下情况： <br><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#      R c &lt;- c(1,2,3,4,5) mean(c) [1] 3 c_mean &lt;- mean(c) c [1] 3</span></span></code> </pre><br> 在这里，R不是创建变量<code>c_mean</code> ，而是<code>c_mean</code>值3分配给变量mean，然后分配给变量c。 在现代R中，这种变形当然不会发生。 <br><br> 由于不受欢迎，因此基本的_函数几乎找不到： <br><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#  3.5.1  25  grep("^[^\\.]*$", apropos("_"), value = T)</span></span></code> </pre><br> 最后，使用长名称时，lowerCamel样式的可读性很差： <br><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># ! GrossNationalIncomePerCapitaAtlasMethodCurrentUnitedStatesDollars</span></span></code> </pre><br> 因此，就名称而言，指南建议不能被认为是明确的。 毕竟，这是一个品味问题（只要保持一致性）。 <br><br><h2>  4.花括号 </h2><br> 根据指南，在大括号开头应加上新行，而在大括号后面应另行（除非跟随在其他行上）。 即 像这样的东西： <br><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { log(x) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { message(<span class="hljs-string"><span class="hljs-string">"Not applicable!"</span></span>) }</code> </pre> <br> 这里的一切都不是很有趣：这是K＆R的标准缩进样式，可以追溯到C语言以及Kernigan和Ritchie着名的著作“ The C Programming Language”（或K＆R的作者名字）。 <br><br> 这种样式的起源也很明显：它可以让您节省线条，同时保持可读性。 对于早期的计算机，垂直空间实在是太奢侈了。 例如，C是在PDP-11上开发的，其终端只有24条线。 在打印K＆R书籍时，这种样式节省了纸张！ <br><br><h2>  5. 80个字符串 </h2><br> 根据指南，建议的行长为80个字符。 神奇数字80不仅可以在R中找到，还可以在许多其他语言（Java，Perl，PHP等）中找到。 不仅是语言：Windows命令行也包含80个字符。 <br><br> 第一次在编程中，这个数字出现在1928年，而不是标准的IBM打孔卡，那里有80列数据。 一个更有趣的问题是为什么选择了这样的标准？ 毕竟，以前使用过不同长度的打孔卡（适用于24或45列）。 <br><br><img src="https://habrastorage.org/webt/6z/ny/ji/6znyjixcpaypxaaorp_y4_zdmc4.jpeg"><br><br> 最受欢迎的答案是打孔卡的长度与打字机的行长有关。 第一台机器是为8½x 11英寸的美国标准纸设计的，根据页边距的大小，可以打印72至90个字符。 因此，每行80个字符的版本看起来很合理，尽管在最后一招中并非如此。 就人体工程学而言，80个字符可能只是中间地带。 <br><br><h2>  6.行缩进：空格与制表符 </h2><br> 指南建议的样式是两个空格，而不是制表符。 拒绝制表是可以理解的：TAB的长度在不同的文本编辑器中有所不同（可以是2到8个空格）。 拒绝它们，我们立即获得两个好处：首先，代码看起来与我们键入的代码完全相同； 其次，不会意外违反建议的字符串长度。 当然，在这种情况下，我们会增加文件大小（谁想要在2k19中处理此类微优化？） <br><br> 争议空间与标签之间的历史悠久，可以等同于宗教领域（例如Win与Linux，Android与iOS等）。 但是，我们已经知道是谁赢了：根据Stack Overflow <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">研究</a> ，使用空格的开发人员比使用制表符的开发人员收入更高。 比样式指南的规则更有说服力吧？ <br><br>  <b>而不是得出结论：</b>样式指南<b>的</b>规则似乎很奇怪且不合逻辑。 确实，为什么箭头<code>&lt;-</code>如果存在标准运算符<code>=</code> ？ 但是，如果您深入研究，那么每条规则背后都有一些逻辑，通常已经被人们遗忘了。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN454432/">https://habr.com/ru/post/zh-CN454432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN454422/index.html">关于牛顿第一定律在现代物理学中的曲解</a></li>
<li><a href="../zh-CN454424/index.html">使用Android建筑组件时的5个常见错误</a></li>
<li><a href="../zh-CN454426/index.html">人工智能：人工智能的曙光</a></li>
<li><a href="../zh-CN454428/index.html">苹果在WWDC上介绍了什么以及iOS开发人员对此有何看法</a></li>
<li><a href="../zh-CN454430/index.html">3D粒子寿命</a></li>
<li><a href="../zh-CN454434/index.html">PDA（便携式旅行计算机）：电路GPS记录器</a></li>
<li><a href="../zh-CN454436/index.html">小资小资喜悦＃1：loguru</a></li>
<li><a href="../zh-CN454440/index.html">小趣味小游戏＃2：Starlette</a></li>
<li><a href="../zh-CN454442/index.html">如何为您的企业选择代理网络：3个实用技巧</a></li>
<li><a href="../zh-CN454444/index.html">我们分析了Habr的加载或页面上189个请求的呈现影响力</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>