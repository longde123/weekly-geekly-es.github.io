<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐱 🧚🏼 👧🏻 Intégration simple de MS Project et Redmine 🚿 👩🏽‍💼 💗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Épigraphe 


 "Si je mettais les lèvres de Nikanor Ivanovich sur le nez d'Ivan Kuzmich, je prendrais un fanfaron comme celui de Baltazar Baltazarych e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Intégration simple de MS Project et Redmine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452982/"><h4 id="epigraf">  Épigraphe </h4><br><p>  <em>"Si je mettais les lèvres de Nikanor Ivanovich sur le nez d'Ivan Kuzmich, je prendrais un fanfaron comme celui de Baltazar Baltazarych et, peut-être, ajouterais l'adversité d'Ivan Pavlovich à cela, je déciderais immédiatement."</em>  N.V.  Gogol.  Se marier. </p><br><p><img src="https://habrastorage.org/webt/nx/cv/ga/nxcvgacl4ywzb0ypkmtx5y1wtj0.png"></p><br><p>  Il existe deux outils de gestion de projet bien connus et très différents: MS Project et Redmine.  Chacun d'eux a ses propres mérites, et ces mérites pourraient parfaitement se compléter. </p><br><p>  Je veux attirer votre attention sur un petit utilitaire appelé P2R, qui permet sans aucune installation et avec un minimum de paramètres d'assurer la synchronisation en ligne des projets dans MS Project et Redmine.  Il est disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur</a> . </p><a name="habracut"></a><br><p>  À quoi sert Project: </p><br><ul><li>  Il est pratique de modifier le projet dans son ensemble en mode document - une feuille de calcul.  C'est également un avantage que plusieurs projets puissent être rapidement combinés en un projet consolidé et considérés dans leur ensemble.  (Dans Redmine, les tâches du projet sont modifiées une à la fois via le formulaire de tâche). </li><li>  Toutes sortes de variété et de flexibilité des connexions entre les tâches (dans Redmine, les communications sont mises en œuvre de façon minimaliste). </li><li> Surveillance du chargement des ressources et possibilité de distribuer automatiquement les tâches sur un calendrier, en tenant compte des relations et du chargement des ressources  Y compris les ressources "inhumaines" telles que l'équipement, les installations, etc.  (Il n'y a rien de tout cela dans Redmine; l'outil a été créé pour un autre.) </li></ul><br><p>  Ce qui est bien avec Redmine: </p><br><ul><li>  Un produit gratuit sur Ruby On Rails, assez simple, bien personnalisable et extensible, avec une communauté active, une large sélection de plugins, activement développés </li><li>  Web et travail d'équipe.  Par conséquent, il est très pratique d'enregistrer la progression de chaque tâche, y compris le journal des modifications, la correspondance et les discussions sur la tâche, les fichiers, les rapports individuels sur les heures passées, etc. (le projet n'a rien.) </li></ul><br><p>  Il serait pratique de préparer des projets dans MS Project, de les envoyer pour exécution à Redmine, d'obtenir les termes réels des tâches et les heures estimées / passées à partir de là, de les comparer avec la référence précédemment enregistrée, en faisant des ajustements si nécessaire.  (C'est particulièrement pratique, par exemple, dans une situation comme la nôtre au travail: il y a un flux de projets avec une structure régulière, qui doit être formée selon des modèles, légèrement spécifiés et donnés au travail.) </p><br><p>  Il existe des plugins Rredmine pour cette intégration.  Mais ils font l'intégration par le téléchargement et le téléchargement de fichiers xml, mais je le veux sans fichiers et plus facilement. </p><br><p>  Le script P2R proposé est écrit en rubis et fonctionne avec MS Project via OLE et avec Redfmine par API.  Si ruby ​​n'est pas installé, vous pouvez prendre le même script compilé en .exe (il se trouve dans le dossier des téléchargements, généré par l'utilitaire ocra). </p><br><p>  La préparation d'un projet MSP pour la publication et la synchronisation nécessite un minimum d'action. </p><br><ol><li>  P2R stocke les identifiants de tâche Redmine dans l'attribut Hyperlink des tâches MSP.  Pour marquer une tâche pour publication, vous devez mettre 0 dans cet attribut.  Après la publication, P2R changera automatiquement ce champ en l'ID de tâche réel et générera en même temps l'URL correcte dans l'attribut HyperlinkAddress, de sorte que le lien sera cliquable.  (Bien sûr, vous ne devez pas oublier d'enregistrer le projet MSP, il n'est pas automatiquement enregistré.) </li><li>  P2R stocke également les ID utilisateur Redmine dans l'attribut «Hyperlien» des ressources MSP.  Pour associer cette ressource à un utilisateur Redmine, vous devez trouver l'ID utilisateur auprès de l'administrateur Redmine.  (L'administrateur a accès à la liste des utilisateurs et peut voir leur ID, par exemple, dans les liens de la liste). </li><li>  P2R prend les paramètres d'accès dans Redmine à partir d'une tâche spéciale appelée «Synchronisation Redmine».  Vous devez créer une telle tâche et mettre les paramètres d'accès dans le champ «Notes» au format YAML en fonction de l'exemple (les valeurs des paramètres doivent bien sûr être remplacées par les vôtres): <br><br><pre><code class="plaintext hljs">redmine_host: 192.168.10.10 redmine_port: 3000 redmine_api_key: a21e583e7670b1fc79378441d485b9608e4c2dc4c redmine_project_uuid: test task_default_redmine_tracker_id: 4 resource_default_redmine_role_id: 4</code> </pre> </li></ol><br><p>  Après cela, le projet est prêt pour la synchronisation.  Le but des paramètres est clair d'après leurs noms. </p><br><p>  Le paramètre <code>redmine_project_uuid</code> contient un code de projet unique qui doit être inventé conformément aux règles Redmine, qui peuvent être trouvées via la page des paramètres de tout projet.  Si une erreur «Entrée non traitable» se produit lors de la création d'un projet, il est fort probable que vous ayez sélectionné l'uuid de projet incorrect. </p><br><p>  Le paramètre <code>task_default_redmine_tracker_id</code> facultatif.  Si vous l'omettez, la piste par défaut des paramètres Redmine sera apposée. </p><br><p>  Si vous ne souhaitez pas créer un nouveau projet dans Redmine, mais en connecter un existant, procédez comme suit: </p><br><ol><li>  Ajoutez le paramètre <code>redmine_project_id</code> paramètres de synchronisation Redmine et mettez-y l'ID du projet Redmine. Ce n'est pas uuid!  Cet entier est l'ID de l'entrée dans la base de données Redmine.  Vous pouvez trouver cet ID, par exemple, dans la fiche de projet au format XML ou JSON (pour l'exemple ci-dessus, vous pouvez l'obtenir à <a href="">http://192.168.10.10/10000000/projects/test.json</a> ). </li><li>  Pour que les tâches soient synchronisées avec celles existantes dans Redmine, mettez dans le champ Hyperlien non pas leurs zéros, mais leurs vrais ID Redmine. </li></ol><br><p>  Il existe une légère restriction sur l'affectation des ressources à une tâche: </p><br><ul><li>  Étant donné qu'un seul exécuteur peut être affecté à une tâche dans Redmine, le script jure et s'arrête lorsqu'il trouve plusieurs ressources dans la tâche MSP marquées pour la synchronisation.  (1) Il est possible que dans les versions futures, ce comportement soit remplacé par un comportement plus doux, comme l'émission d'un avertissement et le choix aléatoire de l'un d'entre eux.  (2) Les ressources non synchronisées peuvent être affectées autant que vous le souhaitez, P2R les ignore. </li></ul><br><p>  L'algorithme de synchronisation suivant est implémenté: </p><br><ul><li>  Le nom de la tâche, la structure de subordination et la personne responsable ont priorité du côté MSP, c'est-à-dire  ils doivent être modifiés dans MS Project, et les modifications iront à Redmine pendant la synchronisation. </li><li>  Le début de la tâche, la fin, les coûts de main-d'œuvre (évaluation et réels) sont prioritaires du côté de Redmine et vont au MSP lors de la synchronisation. </li></ul><br><p>  Il y a aussi un problème avec les coûts de main-d'œuvre: dans MSP, l'estimation des coûts de main-d'œuvre, les coûts de main-d'œuvre réels et le pourcentage d'achèvement sont étroitement liés par la formule, tandis que dans Redmine, ils sont fixés indépendamment.  Autrement dit, ils l'ont évalué à 10 heures, ont passé 40 heures et en même temps terminé la tâche de 30%.  Cela arrive dans la vie, et Redmine ne s'en soucie pas.  La solution choisie est: </p><br><ul><li>  Les coûts réels sont toujours écrits tels quels </li><li>  Si les coûts réels sont supérieurs à l'estimation et que le pourcentage d'achèvement est de 0, ignorez l'estimation </li><li>  Si les coûts réels sont supérieurs à l'estimation et que le pourcentage d'achèvement n'est pas nul, nous calculons une nouvelle estimation basée sur le fait et le pourcentage d'achèvement. </li></ul><br><p>  Au total, le processus de synchronisation ressemble à ceci: </p><br><ol><li>  Nous ouvrons notre projet dans MS Project et le laissons actif. </li><li>  Si nous le voulons, nous commençons la course inactive de P2R et nous regardons quels seront les changements. </li><li>  Nous commençons la synchronisation proprement dite: avec le commutateur –e. </li></ol><br><p>  Le répertoire de travail à partir duquel le script est lancé n'a pas d'importance. </p><br><p>  Vous pouvez démarrer le script par minuterie et la synchronisation deviendra complètement automatique. </p><br><p>  Merci de votre attention. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452982/">https://habr.com/ru/post/fr452982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452966/index.html">Le mythe de la pleine conscience: une vision «neurocentrique» de la méditation</a></li>
<li><a href="../fr452968/index.html">Index dans PostgreSQL - 10 (Bloom)</a></li>
<li><a href="../fr452974/index.html">Programmation asynchrone (cours complet)</a></li>
<li><a href="../fr452978/index.html">ok.tech: Explication des données</a></li>
<li><a href="../fr452980/index.html">AWP KBR-N - Le jour X arrivera bientôt, qui ne s'est pas préparé à blâmer</a></li>
<li><a href="../fr452984/index.html">Arduino et framboise interdits</a></li>
<li><a href="../fr452986/index.html">Serrures dans Postgres: 7 conseils pour travailler avec des serrures</a></li>
<li><a href="../fr452988/index.html">Tableau de bord Kubernetes et intégration GitLab</a></li>
<li><a href="../fr452990/index.html">«Vous devez connaître à la fois la pile Web et C ++»: une interview avec Alexei Kozyatinsky sur le développement de Chrome DevTools et pas seulement</a></li>
<li><a href="../fr452992/index.html">La plateforme CATIA CAD 3DEXPERIENCE a aidé à recréer le navire de guerre de Léonard de Vinci</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>