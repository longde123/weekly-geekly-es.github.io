<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ‘§â€ğŸ‘§ ğŸ¤¹ğŸ¾ ğŸ¦— Dari mana konfigurasi ini berasal? [Debian / Ubuntu] ğŸŒ‡ ğŸ’› ğŸ”‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tujuan dari posting ini adalah untuk menunjukkan teknik debugging debian / ubuntu yang terkait dengan "pencarian sumber" dalam file konfigurasi sistem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dari mana konfigurasi ini berasal? [Debian / Ubuntu]</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461033/"><p>  Tujuan dari posting ini adalah untuk menunjukkan teknik debugging debian / ubuntu yang terkait dengan "pencarian sumber" dalam file konfigurasi sistem. </p><br><p>  Contoh pengujian: setelah lama menggertak salinan tar.gz dari OS yang diinstal dan setelah memulihkannya dan menginstal pembaruan, kami menerima pesan: </p><br><pre><code class="plaintext hljs">update-initramfs: Generating /boot/initrd.img-4.15.0-54-generic W: initramfs-tools configuration sets RESUME=/dev/mapper/U1563304817I0-swap W: but no matching swap device is available. I: The initramfs will attempt to resume from /dev/dm-1 I: (/dev/mapper/foobar-swap) I: Set the RESUME variable to override this.</code> </pre> <br><p>  Tujuan: untuk memahami dari mana nilai ini (U1563304817I0) berasal dan bagaimana cara mengubahnya dengan benar.  <em>Ini adalah contoh pertama yang muncul, tidak terlalu menarik dalam dirinya sendiri, tetapi nyaman untuk menunjukkan metode praktis bekerja dengan Linux</em> . </p><br><h1 id="shag-nomer-1-otkuda-prishyol-resume">  Langkah nomor 1: Dari mana RESUME berasal? </h1><a name="habracut"></a><br><pre> <code class="plaintext hljs"># cd /etc # grep -r RESUME initramfs-tools/conf.d/resume:RESUME=/dev/mapper/U1563304817I0-swap</code> </pre> <br><p>  Kami secara rekursif ( <code>-r</code> ) mencari penyebutan variabel ini di direktori / etc (di mana sebagian besar konfigurasi berada).  Kami menemukan conf.d potongan yang secara eksplisit digunakan oleh paket initramfs-tools. </p><br><h1 id="otkuda-etot-snippet">  Dari mana cuplikan ini berasal? </h1><br><p>  Ada tiga opsi: </p><br><ol><li>  Artefak ajaib (seseorang menaruh dan lupa) </li><li>  Konfigurasi dari paket </li><li>  Konfigurasi yang dihasilkan oleh beberapa skrip dari paket sistem </li></ol><br><p>  Periksa No. 2 (sebagai yang paling sederhana): </p><br><pre> <code class="plaintext hljs"> dpkg -S initramfs-tools/conf.d/resume dpkg-query: no path found matching pattern *initramfs-tools/conf.d/resume*</code> </pre> <br><p>  <code>dpkg -S</code> memungkinkan kita untuk mencari basis data file yang diinstal dan menemukan paket milik file tersebut.  Berikut adalah contoh pencarian yang berhasil: </p><br><pre> <code class="plaintext hljs">dpkg -S resolv.conf manpages: /usr/share/man/man5/resolv.conf.5.gz systemd: /lib/systemd/resolv.conf</code> </pre> <br><p>  Kami kembali ke tugas kami: file <code>initramfs-tools/conf.d/resume</code> tidak diinstal ke dalam sistem dari paket.  Mungkin itu dihasilkan dalam skrip postinst / preinst dari paket?  Periksa nomor versi 3. </p><br><pre> <code class="plaintext hljs"># cd /var/lib/dpkg/info/ # grep -r initramfs-tools/conf.d/resume * initramfs-tools-core.postrm: rm -f /etc/initramfs-tools/conf.d/resume</code> </pre> <br><p>  Direktori <code>/var/lib/dpkg/info/</code> berisi versi yang dibongkar dari semua "metafile" paket (instal / uninstall skrip, deskripsi paket, dll.).  Anehnya, file ini dihapus dalam postrm (setelah dihapus) dari paket initramfs-tools-core.  Mari kita lihat isi postingannya ... Tidak ada yang berhubungan dengan direktori conf.d. </p><br><p>  Mari kita lihat file dari paket <code>initramfs-tools-core</code> . </p><br><pre> <code class="plaintext hljs"># dpkg -L initramfs-tools-core ... /usr/share/initramfs-tools/hooks/resume ...</code> </pre> <br><p>  Perintah <code>dpkg -L</code> memungkinkan Anda untuk melihat semua file yang ada di sistem dari paket yang ditentukan.  Saya menyoroti file yang menarik untuk dipelajari.  Memeriksa file menunjukkan bagaimana variabel ini digunakan, tetapi tidak menjawab dari mana asalnya. </p><br><h1 id="debconf">  debconf </h1><br><p>  Ternyata ini adalah artefak seseorang.  Milik siapa  Sebelum masuk ke installer, mari kita lihat infrastruktur Debian penting lainnya - jawaban atas pertanyaan.  Setiap kali sebuah paket mengajukan pertanyaan, dan dalam banyak kasus ketika sebuah paket tidak mengajukan pertanyaan, tetapi menggunakan opsi default, baik pertanyaan dan jawabannya diperbaiki dalam database khusus di Debian yang disebut debconf.  Kita dapat melihat pada database jawaban (dan bahkan mengaturnya sebelum menginstal paket itu sendiri - <code>debconf-set-selections</code> ), untuk ini kita memerlukan utilitas <code>debconf-get-selections</code> dari <code>debconf-utils</code> .  Sayangnya, tidak ada yang menarik ditemukan: ( <code>debconf-get-selections |grep -i resume</code> dikembalikan kosong). </p><br><h1 id="debian-installer">  installer-debian </h1><br><p>  Pemasang memiliki basis data sendiri untuk jawaban atas pertanyaan: <code>/var/log/installer/cdebconf/questions.dat</code> .  Sayangnya, tidak ada sepatah kata pun tentang resume kami di sana. <br>  Tetapi ada log di dekatnya, termasuk  syslog, di mana seluruh log instalasi ditulis.  Paket pemasang-dasar disebutkan di sana, dan pada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">halamannya</a> kita dapat melihat tautan ke raw. </p><br><p>  Di dalamnya, kita dengan mudah menemukan jawaban untuk pertanyaan kita: </p><br><pre> <code class="plaintext hljs"> resume="$(mapdevfs "$resume_devfs")"; then ... if [ "$do_initrd" = yes ]; then ... resumeconf=$IT_CONFDIR/resume .... echo "RESUME=$resume" &gt;&gt; $resumeconf</code> </pre> <br><p>  mapdevfs adalah utilitas dengan tujuan yang jelas, dan fungsi yang kami minati adalah <code>get_resume_partition</code> , yang bertuliskan / proc / swap dan memilih yang terbesar di sana.  Swap berasal dari partman. </p><br><p>  Jawaban untuk tugas pengujian kami: file dibuat oleh installer di / target pada saat instalasi, mis.  kita berbicara tentang yang terkenal, tetapi artefak.  Tidak ada seorang pun dan tidak ada dalam paket yang ada di sistem untuk mengubah file ini. </p><br><h1 id="podvodya-itog">  Untuk meringkas </h1><br><ol><li>  dpkg dan debconf adalah metode utama untuk menemukan penyedia file. </li><li>  pencarian di / var / lib / dpkg / info memungkinkan Anda melihat operasi file selama fase instalasi. </li><li>  Pemasang dapat membuat file artefak yang tidak pernah diubah oleh siapa pun (kecuali pengguna), dan ini dapat dilihat dalam kode pemasang. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id461033/">https://habr.com/ru/post/id461033/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id461017/index.html">Algoritma Pelacakan GPU Baru: Wavefront Path Tracing</a></li>
<li><a href="../id461019/index.html">Bagaimana kehidupan para pengembang di Iran</a></li>
<li><a href="../id461027/index.html">Java REPL Anda tidak menggunakan ScriptEngine</a></li>
<li><a href="../id461029/index.html">Danau data pemasaran - dari tabel mengerikan hingga laporan dan visualisasi</a></li>
<li><a href="../id461031/index.html">Kami menghubungkan peta online ke navigator di smartphone. Bagian 1 - peta raster standar</a></li>
<li><a href="../id461035/index.html">Episode instruktif dari seri Silicon Valley (Musim 1)</a></li>
<li><a href="../id461037/index.html">Dan di sinilah aku "nyata"</a></li>
<li><a href="../id461039/index.html">Buku â€œAlgoritma Sempurna. Algoritma Grafik dan Struktur Data "</a></li>
<li><a href="../id461041/index.html">Bulat atau sudut akut?</a></li>
<li><a href="../id461043/index.html">Manajemen konflik dalam tindakan penyeimbangan tim atau kebutuhan vital?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>