<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶á üö¥üèΩ üßëüèΩ‚Äçü§ù‚Äçüßëüèª Le chiffrement de cl√© par d√©faut d'OpenSSH est pire que rien üë©‚Äçüëß‚Äçüëß üëàüèæ üßòüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les auteurs de cet article s'opposent aux m√©canismes de cryptage de cl√© standard dans OpenSSH. 


 Les attaquants ont r√©cemment utilis√© le package npm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le chiffrement de cl√© par d√©faut d'OpenSSH est pire que rien</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/419829/">  <i>Les auteurs de cet article s'opposent aux m√©canismes de cryptage de cl√© standard dans OpenSSH.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6k/km/om/6kkmom9aovguj47f3092gm95xlw.jpeg"></div><br>  Les attaquants ont r√©cemment utilis√© le package npm eslint-scope pour voler des jetons npm dans les r√©pertoires personnels des utilisateurs.  √Ä la lumi√®re de cet √©v√©nement, nous avons commenc√© √† v√©rifier d'autres vuln√©rabilit√©s similaires et r√©fl√©chi √† la mani√®re de r√©duire les risques et les cons√©quences de tels incidents. <br><br>  La plupart d'entre nous ont une cl√© RSA SSH sous la main.  Cette cl√© donne au propri√©taire une vari√©t√© de privil√®ges: en r√®gle g√©n√©rale, elle est utilis√©e pour acc√©der √† l'environnement de production ou dans GitHub.  Contrairement aux jetons nmp, les cl√©s SSH sont crypt√©es, et il est donc g√©n√©ralement admis que rien de mauvais ne se produira, m√™me si elles tombent entre de mauvaises mains.  Mais est-ce vraiment le cas?  Voyons. <a name="habracut"></a><br><br><blockquote><code>user@work /tmp $ ssh-keygen <br> Generating public/private rsa key pair. <br> Enter file in which to save the key (/home/user/.ssh/id_rsa): mykey <br> ... <br> user@work /tmp $ head -n 5 mykey <br> -----BEGIN RSA PRIVATE KEY----- <br> Proc-Type: 4,ENCRYPTED <br> DEK-Info: AES-128-CBC,CB973D5520E952B8D5A6B86716C6223F <br> <br> +5ZVNE65kl8kwZ808e4+Y7Pr8IFstgoArpZJ/bkOs7rB9eAfYrx2CLBqLATk1RT/</code> </blockquote> <br>  Cette cl√© est crypt√©e, comme indiqu√© par l'une des premi√®res lignes du fichier.  De plus, au d√©but, il n'y a pas de cl√© de codage MII - base64 utilis√©e dans RSA.  Et, bien s√ªr, AES attire votre attention!  C'est bon, non?  Et CBC, √† premi√®re vue, avec un vecteur d'initialisation al√©atoire.  Il n'y a pas de code d'authentification (MAC).  Eh bien, il n'y aura pas d'attaque oracle de rembourrage, non? <br><br>  D√©couvrir ce que signifie r√©ellement le contenu de DEK-Info n'est pas si simple.  Une recherche du mot-cl√© ¬´DEK-Info¬ª dans le r√©f√©rentiel openssh-portable ne montre que des exemples de cl√©s.  Mais le fait est que la cl√© AES n'est rien d'autre qu'un simple hachage MD5 (mot de passe || vecteur d'initialisation [: 8]).  Et c'est mauvais, car les meilleures pratiques pour le stockage des mots de passe disent que les mots de passe sous leur forme pure, en raison de leur faible entropie, sont de mauvais supports de chiffrement.  Et pour le rendre meilleur, vous avez besoin d'une fonction co√ªteuse comme Argon2.  Mais MD5, contrairement √† ce dernier, est facile √† calculer. <br><br>  Le seul point positif de ce sch√©ma est que le sel est plac√© apr√®s le mot de passe, par cons√©quent, il ne fonctionnera pas pour calculer l'√©tat interm√©diaire MD5 (IV [8:]) et trouver les mots de passe en fonction de celui-ci.  Mais ce n'est pas une grande consolation, en particulier √† une √©poque o√π des machines qui effectuent des milliards d'appels MD5 par seconde sont √† notre disposition - plus que des mots de passe ne peuvent arriver. <br><br>  Vous vous demandez peut-√™tre comment OpenSSH a v√©cu pour voir cela.  H√©las, la r√©ponse est simple: l'outil de ligne de commande OpenSSL utilisait initialement ce sch√©ma par d√©faut, et il est simplement devenu la norme. <br><br>  En fin de compte, il devient vrai que les cl√©s standard crypt√©es par mot de passe ne valent pas mieux que les cl√©s ordinaires non crypt√©es simplement parce que le m√©canisme de cryptage est inefficace.  Cependant, nous parlerions encore plus audacieux - ils sont pires.  Et c'est facile de discuter. <br><br>  Il est peu probable que de nombreuses personnes utilisent un gestionnaire de mots de passe pour stocker le mot de passe de la cl√© SSH.  Au contraire, l'utilisateur s'en souviendra simplement.  Et, comme il s'agit de l'une des combinaisons m√©moris√©es, il est probable que l'utilisateur l'ait d√©j√† utilis√©e ailleurs.  Peut-√™tre qu'il correspond m√™me au mot de passe utilisateur de l'appareil.  Il est tout √† fait possible de le deviner (sa fonction formatrice est trop peu fiable), et si le mot de passe est connu, vous pouvez probablement le v√©rifier avec la cl√© publique. <br><br>  Il n'y a rien √† redire sur la paire de cl√©s RSA elles-m√™mes: la seule question est les m√©thodes de cryptage sym√©trique de la cl√© priv√©e.  Il est impossible de r√©aliser l'attaque d√©crite ci-dessus, en ne connaissant que la cl√© publique. <br><br><h3>  Comment puis-je r√©gler la situation? </h3><br>  OpenSSH fournit un nouveau format de cl√© √† utiliser.  Par nouveau, on entend introduit en 2013.  Ce format utilise bcrypt_pbkdf, qui est essentiellement un bcrypt √† complexit√© fixe impl√©ment√© sous la norme PBKDF2. <br><br>  De mani√®re pratique, vous recevez automatiquement une cl√© dans un nouveau format lors de la g√©n√©ration de cl√©s Ed25519, car l'ancien format de cl√© SSH ne prend pas en charge les nouveaux types de cl√©s.  C'est assez √©trange, car en fait, nous n'avons pas vraiment besoin du format de cl√© pour d√©terminer comment fonctionne la s√©rialisation Ed25519, car l'Ed25519 lui-m√™me d√©finit le travail de s√©rialisation.  Mais si vous avez vraiment besoin d'une bonne fonction formatrice, vous ne pouvez pas vous emb√™ter avec de telles bagatelles.  Par cons√©quent, l'une des r√©ponses est <i>ssh-keygen -t ed25519</i> . <br><br>  Si, pour des raisons de compatibilit√©, vous devez adh√©rer √† RSA, vous pouvez utiliser ssh-keygen -o.  Ainsi, un nouveau format peut √™tre obtenu m√™me pour les anciens types de cl√©s.  Vous pouvez mettre √† jour les anciennes cl√©s avec la commande <i>ssh-keygen -p -o -f key name</i> .  Si vos cl√©s vivent sur Yubikey ou sur des cartes √† puce, ces modifications ont d√©j√† √©t√© prises en compte. <br><br>  D'une mani√®re ou d'une autre, nous visons une sortie plus optimale.  D'une part, il existe un bon exemple d'aws-vault, dans lequel les informations d'identification ont √©t√© d√©plac√©es du disque vers les trousseaux.  Il existe une autre approche: d√©placer le d√©veloppement vers des environnements partag√©s.  Enfin, la plupart des startups devraient envisager d'abandonner le stockage √† long terme des cl√©s SSH et de passer √† un centre de certification SSH avec un temps de stockage des cl√©s limit√© coupl√© √† un syst√®me d'authentification unique.  Malheureusement, dans le cas de GitHub, cette approche n'est pas possible. <br><br>  <b>PS</b> Il est difficile de v√©rifier ces informations dans une source faisant autorit√©, mais si la m√©moire nous sert bien, le param√®tre versionn√© dans les cl√©s priv√©es du format OpenSSH PEM affecte uniquement la m√©thode de cryptage.  Cependant, cela ne joue aucun r√¥le: le probl√®me est la fonction de formation des cl√©s, et nous pensons que c'est un autre argument contre la discussion des protocoles en plusieurs parties.  Il y aura un article s√©par√© sur ce sujet dans notre blog. <br><br>  Et enfin - un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien</a> vers la cl√© compl√®te.  C'est au cas o√π vous √™tes pr√™t √† pirater quoi que ce soit aujourd'hui. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="image"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419829/">https://habr.com/ru/post/fr419829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419815/index.html">Secrets de tol√©rance aux fautes de notre front office</a></li>
<li><a href="../fr419817/index.html">Lancement du cluster RabbitMQ dans Kubernetes</a></li>
<li><a href="../fr419819/index.html">Biomarqueurs du vieillissement. Panel de fragilit√©. 2e partie</a></li>
<li><a href="../fr419823/index.html">Duo insolite - phrases de passe et images mn√©moniques</a></li>
<li><a href="../fr419825/index.html">Test des performances de plusieurs types de disques dans un environnement virtuel</a></li>
<li><a href="../fr419831/index.html">Fonctionnement de JS: √©l√©ments personnalis√©s</a></li>
<li><a href="../fr419833/index.html">Travail √† distance, comment √ßa marche</a></li>
<li><a href="../fr419835/index.html">Comment motiver les auteurs, n√©gocier avec des experts et g√©n√©ralement r√©diger de bons articles</a></li>
<li><a href="../fr419837/index.html">Moi, RoboLoyer, ou comment rechercher des anomalies dans les documents</a></li>
<li><a href="../fr419839/index.html">Piratage ATM NCR de bas niveau</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>