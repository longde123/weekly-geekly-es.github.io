<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💾 👐 ⚖️ 制作手机游戏的原型，从哪里开始以及如何做。 第三部分（最终） ⚰️ 🧑🏿‍🤝‍🧑🏼 🌔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在第一部分中，我谈到了为什么进行原型设计以及通常从何处开始 
 - 第1部分 

 在第二部分中，简要介绍了关键类 
 和建筑- 第2部分 

 第三部分-实际上，将进行一些讨论，我们将分析修饰符的工作原理，并涉足竞争领域（这并不难，但有细微差别）。 关于体系结构的一些知识，我会尽量避免乏味。 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>制作手机游戏的原型，从哪里开始以及如何做。 第三部分（最终）</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453748/"> 在第一部分中，我谈到了为什么进行原型设计以及通常从何处开始 <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第1部分</a> <br><br> 在第二部分中，简要介绍了关键类 <br> 和建筑- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第2部分</a> <br><br> 第三部分-实际上，将进行一些讨论，我们将分析修饰符的工作原理，并涉足竞争领域（这并不难，但有细微差别）。 关于体系结构的一些知识，我会尽量避免乏味。 <br><br> 有关该火箭的屏幕截图通常比较枯燥，因此我建议观看另一个原型的视频，该视频与图形一起在2周内组装完毕，由于平台游戏类型无法解决，因此被放弃了。 顺便说一下，这是围绕原型的关键思想之一-组装，看看是否很烂，是否有必要？ 如果答案似乎不令人信服，请诚实地投入购物篮。 但是！ 这不适用于创意项目-有时为了创意而发生创意）。 <br><br> 因此，vidosik，您需要查看按级别排列的文本，而不是游戏性）： <br><iframe width="560" height="315" src="https://www.youtube.com/embed/lY8e1igkzI0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><br><h3> 小题外话 </h3><br> 在上一篇文章中，我收到了审阅代码，并对此表示感谢；即使您不同意批评，批评也会有所助益。 <br><br>  <b>但是我想针对原型的体系结构和语法进行部署：</b> <br><ol><li> 无论您有多酷，都不能仅仅预见到它不会抵押，而且不需要的东西也有很多抵押。 因此，在任何情况下，都必须进行重构或扩展。 如果您无法描述代码/方法的特定好处，则最好不要花大量时间在此代码上。 </li><li> 在我看来，为什么原型的OOP /事件模型/组合比ECS，Unity COOP，DI FrameWorks，Reactive Frameworks等更容易。 较少的乱写，所有连接在代码中都是可见的，因为原型的主要任务是回答主要问题-是否可以玩，还有许多次要问题-对于这种或那样的游戏性更好。 因此，您需要尽快实现必要的功能。 为什么要在一个小项目上引入一个框架，规定所有垃圾以实现三个游戏实体？ 每个实际上是一类50-100行。 应该将架构视为原型任务的一部分，以及作为可能的alpha扩展的一部分，但是第二个需要比代码更重要的内容，以免在添加代码时费时 </li></ol><br><br><h3> 关于修饰符： </h3><br>  <b>最后是修饰符本身：</b> <br> 在这里和更早的时候，我将修改器称为火箭接触并影响其路径的力场，在原型中，它们有两种类型：加速和偏转。 <br><br><div class="spoiler">  <b class="spoiler_title">修饰语类</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PushSideModificator</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] TypeOfForce typeOfForce = TypeOfForce.Push; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> force; [SerializeField] DropPanelConfig dropPanelConfig; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> boundsOfCollider; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerEnter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ boundsOfCollider = other.bounds.extents.x; GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { TypeOfForce = typeOfForce, Force = force, ColliderBound = boundsOfCollider, CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); } }</code> </pre> <br></div></div><br> 这是一个非常简单的类，其任务是传递两个事件： <br><ol><li> 玩家进入该区域（实际上是一个物理上的统一触发器），以及所有必要的上下文（修改器的类型，其位置，对撞机的大小，修改器的强度等等）。 在这种情况下，再加上聚合器，他可以将任何上下文传达给感兴趣的各方。 在这种情况下，这是处理修改器的火箭模型。 </li><li> 第二事件-玩家离开了场地。 消除其对播放器轨迹的影响 </li></ol><br>  <b>事件模型有什么用？</b>  <b>还有谁可能需要此活动？</b> <b><br></b>  <b>在当前项目中，尚未实现，但是：</b> <br><ol><li> 语音表演（收到某人进入现场的事件-我们播放相应的声音，某人出去-类似） </li><li>  UI标记，例如，对于每个领域，我们都会从火箭中移除一些燃料，应该显示工具提示我们进入该领域并失去燃料，或者为该领域中的每次命中赚取积分，界面上有很多选项让玩家感兴趣领域。 </li><li> 特别的 特效-在不同类型的战场上命中时，可以在火箭本身以及火箭/战场周围的空间上叠加不同的特效。 特别的 效果可以由单独的实体/控制器处理，该实体/控制器也将订阅修饰符的事件。 </li><li> 好吧，这是最少的代码，不需要服务定位器，聚合，依赖项等。 </li></ol><br><br><h3> 游戏基础 </h3><br> 在此原型中，游戏玩法的实质是在战场上放置修改器，调整火箭的飞行路径，绕过障碍物飞行并击中目的地/行星。 为此，我们在右侧有一个面板，修改器图标位于该面板上。 <br><br><img src="https://habrastorage.org/webt/lj/eb/ga/ljebgar88u47kcyxyhz_6kzxyke.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">面板类</b> <div class="spoiler_text"><pre> <code class="java hljs"> [RequireComponent (typeof(CanvasGroup))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DragAndDropModifiersPanel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifiersIcon iconPrfb; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropPanelConfig config; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.AddListener&lt;ButtonStartPressed&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, RocketStarted); canvasGroup = GetComponent&lt;CanvasGroup&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RocketStarted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ButtonStartPressed obj)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.DOFade(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); (canvasGroup.transform as RectTransform).DOAnchorPosX(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.Push); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.AddSpeed); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } } }</code> </pre> <br></div></div><br><br> 预期问题： <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++)</code> </pre><br><br>  3和1-应该简单地避免所谓的魔术数字从头上插入并插入到代码中，但是为什么在这里呢？ 形成右面板的原理尚未确定，仅决定在原型上使用如此多的修饰符来测试原型。 <br><br> 怎么做对？  -至少将其放在可序列化的字段中，并通过检查器设置所需的数量。 为什么我太懒了，你应该这样做吗？ 在这里，我们必须从全局出发，为了形成所需数量的修饰符，仍将负责单独的实体和配置，因此在这里我太懒了，期望将来会进行大量的重构。 但是最好不要偷懒！  ） <br><br> 关于配置-关于ScriptableObject的第一堂课出现时，我喜欢将数据存储为资产的想法。 您可以在需要的地方获得必要的数据，而不必绑定到单副本实例。 接下来是关于ScriptableObject的游戏开发方法的讲座，他们用来存储实例设置。 实际上，资产中保存的内容的预设/设置是配置。 <br><br>  <b>考虑配置类：</b> <br><div class="spoiler">  <b class="spoiler_title">配置类</b> <div class="spoiler_text"><pre> <code class="java hljs"> [CreateAssetMenu(fileName = <span class="hljs-string"><span class="hljs-string">"DropModifiersPanel"</span></span>, menuName = <span class="hljs-string"><span class="hljs-string">"Configs/DropModifier"</span></span>, order = <span class="hljs-number"><span class="hljs-number">2</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropPanelConfig</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ScriptableObject</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ModifierBluePrintSimple[] modifierBluePrintSimples; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DropModifier </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetModifierByType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TypeOfForce typeOfModifiers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modifierBluePrintSimples.FirstOrDefault(x =&gt; x.GetValue.TypeOfModifier == typeOfModifiers).GetValue; } } [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br></div></div><br><br> 他的工作本质是什么？ 它存储一个自定义的修饰符数据类。 <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br><br> 识别器需要使用修饰符的类型，界面的图标，修饰符的游戏对象的游戏模式以及此处的材质，以便可以在配置期间进行更改。 修改器可能已经位于运动场上了，比方说，游戏设计师更改了它的类型，现在它提供了加速，配置中的修改器初始化，并根据这种修改器类型更新了包括材料在内的所有字段。 <br><br> 使用配置非常简单-我们转向配置以获取特定类型的数据，然后从该数据中获取该数据，直观的视觉效果以及可能的设置。 <br><br>  <b>利润在哪里？</b> <br> 好处是很大的灵活性，例如，如果您想更改加速修改器上的材质和图标，或者说您可以替换整个游戏项目。 无需重写并转发到检查人员的字段，我们只需在一个配置和更改中更改此数据-一切将随我们在所有场景/级别/面板上进行更新。 <br><br>  <b>并且在配置中是否有多个用于加速器修改器的数据？</b> <br> 在原型中，您可以轻松地手动对其进行跟踪，以使数据不会重复；在工作草案中，您需要测试和数据验证。 <br><br><h3> 从图标到运动场 </h3><br><div class="spoiler">  <b class="spoiler_title">修饰符图标类</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifiersIcon</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBeginDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IEndDragHandler</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Image icon; [Header(<span class="hljs-string"><span class="hljs-string">"       "</span></span>)] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RectTransform canvas; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifier currentModifier; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 startPoint; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 outV3; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameObject currentDraggedObj; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup = GetComponent&lt;CanvasGroup&gt;(); startPoint = transform.position; canvas = GetComponentInParent&lt;Canvas&gt;().transform as RectTransform; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropModifier dropModifier)</span></span></span><span class="hljs-function"> </span></span>{ icon.sprite = dropModifier.Icon; currentModifier = dropModifier; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnBeginDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ BlockRaycast(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); currentDraggedObj = Instantiate(currentModifier.Modifier, WorldSpaceCoord(), Quaternion.identity); GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BlockRaycast</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bool state)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.blocksRaycasts = state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ Vector2 outV2; RectTransformUtility.ScreenPointToLocalPointInRectangle(canvas, Input.mousePosition, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, out outV2); transform.position = canvas.transform.TransformPoint(outV2); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentDraggedObj != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) currentDraggedObj.transform.position = WorldSpaceCoord(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorldSpaceCoord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ RectTransformUtility.ScreenPointToWorldPointInRectangle(canvas, Input.mousePosition, Camera.main, out outV3); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outV3; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEndDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>) { Destroy(currentDraggedObj); transform.SetAsLastSibling(); canvasGroup.blocksRaycasts = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Destroy(gameObject); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct ImOnDragEvent { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool IsDragging; }</code> </pre><br></div></div><br><br>  <b>这是怎么回事</b> <br> 我们从面板上抓取图标，在面板下创建修改器本身的游戏博客。 实际上我们是在设置单击/独轮车到游戏空间的坐标，因此我们将游戏空间中的修饰符与UI中的图标一起移动，我建议您阅读有关RectTransformUtility的方式，这是一个很好的帮助程序类，其中该界面具有很多功能。 <br><br> 假设我们改变了主意，将修饰符放回面板， <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br> 这段代码使我们可以了解点击后的内容。 为什么还要在此处显示图层检查？ 又为什么魔术数字是5？ 正如我们在第二部分中所记得的，我们不仅在用户界面上使用rakester图表，还在场景中的按钮上使用rakester图表，如果我们添加了删除字段上已经放置的修改器或移动它们的功能，那么它们也将落入瑞克图表之下，因此还需要检查是否属于UI层。 这是默认层，其顺序不会更改，因此此处的数字5通常不是幻数。 <br><br> 结果，事实证明，如果我们释放面板上方的图标，它将返回面板，如果在比赛场地上方，修饰符仍保留在场地上，则图标将被删除。 <br><br> 原型代码花了1个工作日。 加上文件和图形上的小事。 总的来说，尽管在艺术和游戏设计芯片上有很多疑问，但游戏玩法还是合适的。 任务完成。 <br><br><h3> 结论与建议 </h3><br><ol><li> 放置最少的架构，但是架构 </li><li> 遵循基本原则，但不要狂热） </li><li> 选择简单的解决方案 </li><li> 在多功能性和速度之间-最好为原型选择速度 </li><li> 对于大/中型项目，意味着最好从头开始重写项目。 例如，现在Unity中的趋势是DOTS，您必须编写许多组件和系统，这对于短期运行，时间浪费，长期运行都是不利的-当所有组件和系统都注册后，时间就会增加。 我认为花很多时间研究趋势架构并找出原型是什么很酷 </li></ol><br> 成功的原型给所有人。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN453748/">https://habr.com/ru/post/zh-CN453748/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN453730/index.html">现代牙科：通过技术总监的眼睛同时进行牙齿植入和颌骨延伸</a></li>
<li><a href="../zh-CN453732/index.html">我来自莫里尼斯（Moreinis）。 意见倾斜还是尊重？</a></li>
<li><a href="../zh-CN453734/index.html">头盔3简介</a></li>
<li><a href="../zh-CN453742/index.html">Memcached插件：MySQL中的NoSQL</a></li>
<li><a href="../zh-CN453744/index.html">我们使用“突出显示纯CSS中表的活动行”任务的示例研究伪类的原理：not（）</a></li>
<li><a href="../zh-CN453750/index.html">关于最近的巴尔的摩网络攻击</a></li>
<li><a href="../zh-CN453756/index.html">确定FSTEC当前威胁的当前方法存在的问题</a></li>
<li><a href="../zh-CN453760/index.html">坦克和处理器巡回训练营</a></li>
<li><a href="../zh-CN453764/index.html">自愿性健忘症：海马操作可消除痛苦记忆</a></li>
<li><a href="../zh-CN453766/index.html">软件无线电-它如何工作？ 第6部分</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>