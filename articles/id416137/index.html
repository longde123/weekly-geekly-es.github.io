<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌀 🤦🏻 🥒 Zabbix sebagai pemindai keamanan 🤞 👌🏼 🚶🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hai Kita semua tahu dan menyukai produk untuk proses penilaian kerentanan seperti Nessus , Qualys , Max Patrol, dan segala macam OpenVAS lainnya. Sala...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zabbix sebagai pemindai keamanan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vulners/blog/416137/"><p>  Hai  Kita semua tahu dan menyukai produk untuk proses penilaian kerentanan seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nessus</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Qualys</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Max Patrol,</a> dan segala macam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">OpenVAS</a> lainnya.  Salah satu tugas utama yang mereka selesaikan adalah untuk memberikan kontrol atas kerentanan versi. </p><br><p>  Ini adalah proses yang cukup sederhana untuk membandingkan versi perangkat lunak yang diinstal dengan kisaran "tidak mengandung kerentanan yang diketahui".  Nah, kemudian orang-orang yang bertanggung jawab untuk keamanan informasi, bersama dengan pengembangan dan administrator, memutuskan risiko apa yang bisa diambil dan apa yang perlu ditambal hari ini. </p><br><p>  Ada banyak alat yang berbeda untuk menyelesaikan masalah ini, tetapi dari sudut pandang kami, semuanya memiliki satu masalah yang sama - mereka membutuhkan penyebaran yang terpisah dan menelurkan alat lain dengan akun root di infrastruktur Anda.  Tetapi bagaimanapun juga, untuk tindakan sederhana seperti mengumpulkan informasi tentang paket root yang diinstal tidak diperlukan!  Dan biasanya dalam infrastruktur sudah ada sistem yang dikerahkan dengan kemampuan untuk mengkonsolidasikan data, kolaborasi dan eksekusi perintah di server jauh.  Oleh karena itu, kami memutuskan untuk membuat alat yang memungkinkan beberapa klik untuk menggunakan sistem pemantauan kerentanan Linux di lingkungan kami dengan sedikit perubahan pada produksi. </p><br><p>  Apa yang digunakan di sebagian besar sistem pangan?  Tentu saja pemantauan.  Dan cukup sering itu adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zabbix</a> .  Jadi mari kita mulai dan kencangkan! </p><a name="habracut"></a><br><h1 id="v-odnoy-ruke-zabbix">  Di satu tangan Zabbix </h1><br><p>  Semuanya sederhana: sistem agen terdistribusi, dasbor untuk visualisasi, sistem akses multi-pengguna, dan melakukan tindakan sesuai dengan kriteria yang ditentukan telah dilakukan tanpa kita.  Kita tidak perlu menemukan kembali roda dan melakukan semuanya dari awal. </p><br><p>  Zabbix memiliki hak yang cukup untuk menerima informasi tentang paket, di mana harus meletakkannya juga.  Tetap menggabungkannya dan mengirimkannya untuk dianalisis ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">API Vulners</a> .  Dan kemudian proses pengetahuan yang diperoleh tentang kerentanan. </p><br><p>  Tapi mari kita mulai dengan pengantar singkat tentang apa yang bisa dilakukan Zabbix dan apa yang perlu kita lakukan. </p><br><p>  <strong>Agen Zabbix</strong> diinstal pada server dan memungkinkan: </p><br><ul><li>  Dapatkan berbagai metrik sistem operasi </li><li>  jalankan skrip dan program dan dapatkan hasil eksekusinya; </li><li>  menjalankan perintah apa pun dalam proses terpisah (garpu), terlepas dari proses agen Zabbix; </li><li>  bekerja dengan beberapa server Zabbix sekaligus; </li><li>  bekerja di belakang firewall, memulai koneksi ke server, atau sebaliknya, menunggu koneksi masuk. </li></ul><br><p>  <strong>Server Zabbix</strong> menerima metrik pemantauan sebagai input dan menulisnya ke database dan melakukan pemrosesan lebih lanjut. </p><br>  Menganalisis data yang diperoleh dan berdasarkan logika yang cukup fleksibel, ia dapat melakukan berbagai tindakan: <br><br><ul><li>  Kirim peringatan di berbagai saluran (surat, sms, pesan instan, dll.); </li><li>  Terhubung ke server melalui SSH atau IPMI dan jalankan berbagai perintah pada mereka; </li><li>  Atau, jalankan berbagai perintah korektif di server menggunakan koneksi Zabbix agent untuknya; </li></ul><br><p>  <strong>Antarmuka web</strong> ditulis dalam PHP dan akan memungkinkan Anda untuk menampilkan metrik yang dikumpulkan oleh Zabbix, grafik, peringatan yang dipicu tentang masalah, dan perintah dan tindakan yang dilakukan oleh sistem pemantauan. </p><br><p>  Administrasi Zabbix juga dilakukan melalui antarmuka web. </p><br><p>  <strong>Zabbix API</strong> adalah <strong>API</strong> berbasis web dan hadir sebagai bagian dari antarmuka web.  Ini menggunakan protokol JSON-RPC. </p><br><ul><li>  Memungkinkan Anda menerima, membuat, mengonfigurasi, dan menghapus objek apa pun di sistem pemantauan. </li><li>  Menggunakan API, Anda dapat dengan mudah mengintegrasikan sistem pemantauan dengan berbagai sistem eksternal. </li></ul><br><p>  Namun, Zabbix tidak tahu apa-apa tentang kerentanan!  Tapi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vulners</a> tahu tentang mereka :) </p><br><h2 id="v-drugoy-ruke-vulners">  Di sisi lain para Vulners </h2><br><ul><li>  Pengumpul data kerentanan dari lebih dari 115 sumber </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">API yang mudah digunakan untuk berbagai metode pemindaian</a> </li><li>  Menyediakan data dalam bentuk yang normal dan dapat dibaca mesin </li><li>  Sangat cepat </li><li>  Mengizinkan korelasi data dari berbagai sumber </li></ul><br><p>  Kami mencoba mengintegrasikan mereka satu sama lain dan itulah yang terjadi. </p><br><h1 id="zabbix-threat-control">  Kontrol ancaman Zabbix </h1><br><p>  Ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">plugin</a> Zabbix open source yang ditulis dengan Python yang: </p><br><ul><li>  Menampilkan informasi tentang kerentanan yang ditemukan dalam infrastruktur Anda di antarmuka web Zabbix. </li><li>  Menunjukkan tingkat ancaman dari setiap kerentanan sesuai dengan standar CVSS. </li><li>  Dan ia menawarkan metode yang mudah diterapkan untuk menghilangkan kerentanan yang ditemukan. </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CVSS</a> adalah standar industri terbuka untuk menilai kekritisan kerentanan.  Bahkan - skala 10 poin. </p><br>  Dengan menggunakan teknik ini, Anda dapat membawa kerentanan yang ditemukan dalam sistem yang berbeda dan dengan properti yang berbeda ke satu penyebut tunggal, yang menyederhanakan prioritas masalah yang terdeteksi. <br><br>  Kami berbicara tentang plugin ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pertemuan Zabbix Moscow</a> .  Bagi mereka yang tidak suka membaca, tetapi suka menonton - ada laporan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">video</a> . <br><br><h2 id="konsolidiruyte-informaciyu-ob-uyazvimostyah">  Konsolidasi Informasi Kerentanan </h2><br><p>  Hasil plugin di Zabbix adalah sebagai berikut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/70c/a22/394/70ca22394ca3092373bf8529d0c69025.png" alt="Dasbor"><br>  Ini adalah dasbor di Zabbix.  Di mana, dari kiri ke kanan, informasi berikut ini ditampilkan: </p><br><ul><li>  Distribusi skor CVSS oleh server.  Diagram lingkaran menunjukkan hubungan - berapa banyak server yang kita miliki dengan kerentanan kritis, berapa banyak kerentanan non-kritis yang diketahui atau tidak memiliki kerentanan sama sekali. </li><li>  Nilai median CVSS dari seluruh infrastruktur.  Ini ditampilkan dalam bentuk grafik, yang memungkinkan Anda untuk mengamati dinamika perubahannya. </li><li>  Daftar paket rentan dengan indeks dampak kerentanan terhadap infrastruktur. </li><li>  Daftar lengkap server rentan dengan tingkat ancaman untuk masing-masing server. </li><li>  Daftar buletin keamanan yang telah "ditemukan" di infrastruktur. </li></ul><br><p>  Di bawah ini lebih detail tentang yang paling menarik: </p><br><p>  <strong>Informasi tentang server rentan:</strong> </p><br><p><img src="https://habrastorage.org/webt/hb/nm/5m/hbnm5mgchmq1yfj9mxfzkdepwxu.gif" alt="Tuan rumah"></p><br><p>  Panel menampilkan daftar semua server dengan tingkat kerentanan di atas kritis.  Tingkat kekritisan minimum yang dapat diterima, setelah itu server mulai tampak rentan, ditentukan dalam pengaturan plugin. </p><br><p>  Informasi berikut tersedia untuk setiap server: </p><br><ol><li>  Sebenarnya nama server rentan. </li><li>  Skor server CVSS maksimum.  Skor tertinggi dari semua kerentanan yang ditemukan untuk server ini ditampilkan. </li><li>  Perintah untuk menghilangkan semua kerentanan yang terdeteksi di server ini.  Setelah menyelesaikannya, kami mendapatkan server yang tidak diketahui kerentanan versinya. </li></ol><br><p>  Data disajikan dengan penyortiran CVSS, dari maksimum ke minimum.  Ini memungkinkan Anda untuk menjaga server yang paling membutuhkan perhatian, selalu di bagian atas daftar, di depan mata Anda. </p><br><p>  <strong>Panel berikut menunjukkan paket yang rentan:</strong> </p><br><p><img src="https://habrastorage.org/webt/0q/75/em/0q75emnx6roeuhvz3ltalvwrbio.gif" alt="Paket"></p><br><p>  Di sini untuk setiap paket yang rentan dalam infrastruktur kami, kami memiliki ringkasan singkat: </p><br><ol><li>  Nama paket yang rentan. </li><li>  <em>Versi</em> paket yang rentan. </li><li>  Jumlah server tempat versi rentan paket diinstal. </li><li>  Skor CVSS untuk versi paket ini. </li><li>  Indeks dampak kerentanan ini terhadap infrastruktur. </li><li>  Daftar semua server tempat versi paket yang rentan terdeteksi. </li><li>  Tautan ke Buletin Keamanan.  Memungkinkan Anda membaca dan memahami betapa pentingnya kerentanan ini dalam situasi kami. </li><li>  Tim memperbaiki kerentanan dalam paket ini. </li></ol><br><p>  Data disajikan diurutkan berdasarkan <em>Indeks Dampak</em> , dari maksimum ke minimum. </p><br><p>  <em>Indeks Dampak</em> adalah jumlah server yang terpengaruh dikalikan dengan skor kerentanan CVSS.  Sering terjadi bahwa kerentanan dengan skor yang tidak terlalu tinggi jauh lebih luas dalam infrastruktur, dan karenanya berpotensi lebih berbahaya. </p><br><h2 id="vybirayte-strategii-ustraneniya-uyazvimostey">  Pilih Strategi Manajemen Kerentanan </h2><br><p>  Namun, Anda tidak bisa hanya mengambil dan memutakhirkan semua paket di semua server ke versi terbaru, yang menghilangkan kerentanan yang ada. </p><br><p>  Dalam setiap infrastruktur yang terdiri dari lebih dari beberapa server, ada banyak batasan: ketergantungan satu perangkat lunak pada versi yang lain, risiko gangguan fungsi, dan sebagainya. </p><br><p>  Karena itu, selalu ada pilihan - paket mana yang dapat kita perbarui tanpa rasa sakit.  Paket mana yang memerlukan rencana kerja terpisah untuk implementasi langkah-langkah kompensasi.  Dan dengan apa kita dapat menerima risiko. </p><br><p>  Pendekatan yang diusulkan dalam plugin memungkinkan Anda untuk memilih strategi untuk menghilangkan kerentanan yang cocok untuk Anda: </p><br><ul><li>  <strong>Satu kerentanan di seluruh infrastruktur:</strong> jika kerentanan tertentu sangat penting bagi Anda, plugin memberi Anda informasi tentang di mana kerentanan ini ada di infrastruktur Anda dan bagaimana kerentanan itu dapat segera diperbaiki di seluruh infrastruktur. </li><li>  <strong>Semua kerentanan pada server tertentu:</strong> jika Anda perlu memiliki server yang benar-benar aman, misalnya, terletak di DMZ atau di belakang perimeter perusahaan, menggunakan plug-in Anda mendapatkan informasi tentang cara menghilangkan semua kerentanan yang ditemukan di dalamnya. </li></ul><br><h2 id="ustranyayte-naydennye-uyazvimosti">  Perbaiki kerentanan yang ditemukan </h2><br><p>  Tapi itu tidak cukup untuk mengetahui kerentanan apa yang kita miliki dan untuk menentukan bagaimana dan mana yang bisa diperbaiki.  Hal ini juga perlu dilakukan! </p><br><p>  Sistem seperti Wayang atau Ansible banyak digunakan untuk manajemen konfigurasi terpusat dan pembaruan perangkat lunak.  Anda dapat menggunakan perintah perbaikan yang memperbaiki kerentanan dan menjalankannya secara terpusat menggunakan sistem tersebut. </p><br><p>  Jika infrastruktur Anda tidak menggunakan sistem seperti itu, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zabbix Threat Control</a> memungkinkan Anda untuk menghilangkan kerentanan langsung dari antarmuka web Zabbix. </p><br><p><img src="https://habrastorage.org/webt/f5/i7/pj/f5i7pjelugjzoildcxmb-qkttfc.png"></p><br><p>  Untuk ini, plugin menggunakan fungsi Zabbix standar: konfirmasi acara dan eksekusi perintah jarak jauh: </p><br><ol><li>  Segera setelah masalah dikonfirmasi melalui antarmuka web oleh pengguna yang berwenang; </li><li>  Perintah jarak jauh diluncurkan yang dijalankan pada server target, atau daftar server, perintah perbaikan yang memperbaiki kerentanan. </li></ol><br><h2 id="kak-eto-rabotaet">  Bagaimana cara kerjanya </h2><br><p><img src="https://habrastorage.org/webt/io/mf/li/iomflipmyk5lxwmn8qbntuswufs.gif"></p><br><ol><li>  Server Zabbix menerima informasi tentang paket dan sistem operasi semua server dalam infrastruktur melalui agen zabbix. </li><li>  Plugin (menggunakan Zabbix API) menerima laporan OS yang sebelumnya dikompilasi oleh server Zabbix.  Plugin tidak menerima apa pun secara langsung dari server.  Dan pada tahap ini tidak memerlukan kontak langsung dengan mereka. </li><li>  Setelah memproses informasi yang diterima dari Zabbix, plugin meneruskannya ke Vulners.  Dari mana ia menerima daftar kerentanan yang ditemukan, kekritisannya, dan cara untuk menghilangkannya. </li><li>  Plugin memproses data yang diterima, menggabungkannya untuk menghasilkan statistik dan menghasilkan paket data untuk transmisi ke Zabbix. </li><li>  Plugin mendorong data Zabbix dalam format sistem pemantauan yang diperlukan.  Dia melakukan ini menggunakan utilitas zabbix-sender.  Setelah itu, Anda sudah memantau segala hal tentang kerentanan yang ditemukan, yang ditampilkan di dasbor yang diperlihatkan sebelumnya. </li><li>  Setelah mengonfirmasi masalah, perintah jarak jauh dijalankan, yang beralih ke plugin: <br><ul><li>  Nama orang yang memprakarsai itu </li><li>  Perbaiki Tim Perbaikan Kerentanan </li><li>  Daftar Server </li></ul></li><li>  Setelah menerima semua Kontrol Ancaman Zabbix ini: <br><ul><li>  Periksa apakah perintah koreksi dijalankan oleh mereka yang membutuhkannya.  Dari orang yang tidak dibutuhkan - dia tidak menerima perintah :) </li><li>  Menjalankan perintah yang ditransfer ke sana pada sejumlah server yang diperlukan. </li></ul></li></ol><br><p> Secara default, plugin mengirimkan perintah perbaikan ke server yang rentan menggunakan utilitas zabbix-get, mengakses agen Zabbix di server target dengan parameter <code>nowait</code> .  Metode koneksi ini memungkinkan proses memperbarui paket untuk berjalan di latar belakang tanpa terikat dengan proses agen zabbix.  Dimungkinkan juga untuk mengeksekusi perintah pada server target melalui koneksi SSH sederhana.  Cara untuk menjalankan perintah perbaikan dipilih sebagai opsi dalam file konfigurasi plugin. </p><br><p>  Dan sebagai hasil dari pekerjaan - tidak adanya server yang rentan, Anda tidur nyenyak dan suasana hati yang baik :) </p><br><h2 id="ustanovka">  Instalasi </h2><br><p>  Kami berbicara tentang apa itu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zabbix Threat Control</a> , mengapa diperlukan dan bagaimana cara kerjanya.  Sekarang kami akan memberi tahu Anda cara menginstal dan mengkonfigurasinya! </p><br><h3 id="zavisimosti">  Ketergantungan </h3><br><p>  Agar berfungsi, plugin tidak memerlukan hal supernatural.  Adalah perlu bahwa pada <strong>server Zabbix</strong> tempat kami mengatur paket, yang berikut ini harus: </p><br><ul><li>  <strong>zabbix v3.4</strong> untuk menggunakan dasbor khusus (hanya muncul dalam versi ini). </li><li>  <strong>zabbix-sender</strong> diperlukan untuk mengirim data kerentanan ke sistem pemantauan. </li><li>  <strong>zabbix-get</strong> untuk mengirim perintah-perbaikan yang memperbaiki kerentanan ke server. </li><li>  <strong>python v3</strong> dengan modul: <strong>pyzabbix, jpath, permintaan</strong> untuk menjalankan skrip plugin utama. </li></ul><br><p>  Di semua <strong>server yang</strong> memerlukan <strong>pemindaian</strong> kerentanan, hanya: </p><br><ul><li>  <strong>zabbix-agent</strong> untuk mengumpulkan data dan menjalankan skrip. </li><li>  <strong>python v2</strong> untuk menjalankan skrip yang mengumpulkan laporan OS. </li></ul><br><h3 id="ustanovka-plagina-iz-paketov">  Menginstal plugin dari paket </h3><br><p>  Untuk memulai, hubungkan repositori dengan paket: </p><br><p>  Distribusi <strong>RPM</strong> </p><br><pre> <code class="bash hljs"> rpm -Uhv https://repo.vulners.com/redhat/vulners-repo.rpm</code> </pre> <br><p>  Distribusi <strong>DEB</strong> </p><br><pre> <code class="bash hljs"> wget https://repo.vulners.com/debian/vulners-repo.deb dpkg -i vulners-repo.deb</code> </pre> <br><p>  Setelah itu, pada server Zabbix kami menginstal paket utama yang menyediakan semua logika plug-in dan paket yang melaporkan pada OS: </p><br><p>  Distribusi <strong>RPM</strong> </p><br><pre> <code class="bash hljs"> yum install zabbix-threat-control-main zabbix-threat-control-host</code> </pre> <br><p>  Distribusi <strong>DEB</strong> </p><br><pre> <code class="bash hljs"> apt-get update &amp;&amp; apt-get install zabbix-threat-control-main zabbix-threat-control-host</code> </pre> <br><p>  Dan di semua server lain yang membutuhkan pemindaian kerentanan, kami memasang paket yang menghasilkan pelaporan OS: </p><br><p>  Distribusi <strong>RPM</strong> </p><br><pre> <code class="bash hljs"> yum install zabbix-threat-control-host</code> </pre> <br><p>  Distribusi <strong>DEB</strong> </p><br><pre> <code class="bash hljs"> apt-get update &amp;&amp; apt-get install zabbix-threat-control-host</code> </pre> <br><h3 id="ustanovka-iz-ishodnikov">  Instalasi dari sumber </h3><br><p>  Jika Anda lebih suka instalasi dari sumber, maka ini juga sangat sederhana: </p><br><p>  Di server Zabbix, kami memasang skrip utama yang menyediakan semua logika plug-in dan skrip yang melaporkan pada OS: </p><br><pre> <code class="bash hljs"> git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/vulnersCom/zabbix-threat-control.git <span class="hljs-comment"><span class="hljs-comment"># main mkdir -p /opt/monitoring/zabbix-threat-control cp zabbix-threat-control/ztc* /opt/monitoring/zabbix-threat-control/ chown -R zabbix:zabbix /opt/monitoring/zabbix-threat-control chmod 640 /opt/monitoring/zabbix-threat-control/ztc_config.py touch /var/log/zabbix-threat-control.log chown zabbix:zabbix /var/log/zabbix-threat-control.log chmod 664 /var/log/zabbix-threat-control.log # host cp -R zabbix-threat-control/os-report /opt/monitoring/ chown -R zabbix:zabbix /opt/monitoring/os-report</span></span></code> </pre> <br><p>  Di semua server lain yang membutuhkan pemindaian kerentanan, kami hanya menginstal skrip yang melaporkan pada OS: </p><br><pre> <code class="bash hljs"> git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/vulnersCom/zabbix-threat-control.git <span class="hljs-comment"><span class="hljs-comment"># host mkdir -p /opt/monitoring/ cp -R zabbix-threat-control/os-report /opt/monitoring/ chown -R zabbix:zabbix /opt/monitoring/os-report</span></span></code> </pre> <br><h2 id="nastroyka">  Kustomisasi </h2><br><p>  Setelah instalasi, Anda harus mengonfigurasi plugin dan menyiapkan sistem pemantauan untuk operasinya.  Berikut ini adalah deskripsi langkah demi langkah dari semua tindakan yang diperlukan. </p><br><h3 id="nastraivaem-servera-trebuyuschie-skanirovaniya">  Mengkonfigurasi server yang memerlukan pemindaian </h3><br><p>  Anda harus mengaktifkan agen Zabbix untuk menjalankan perintah jarak jauh.  Untuk melakukan ini, pada semua server yang memerlukan pemindaian, ubah parameter dalam file konfigurasi agen-zabbix seperti yang ditunjukkan di bawah ini: </p><br><pre> <code class="hljs">EnableRemoteCommands=1 LogRemoteCommands=1</code> </pre> <br><p>  File konfigurasi agen zabbix biasanya terletak di sini: <code>/etc/zabbix/zabbix_agentd.conf</code> </p><br><p>  Jika Anda ingin menggunakan fungsionalitas untuk menghilangkan kerentanan yang ditemukan menggunakan <em>Kontrol Ancaman Zabbix</em> , Anda harus mengizinkan pengguna zabbix untuk <strong>memperbarui</strong> paket (tetapi tidak menginstal atau menghapusnya). </p><br>  Untuk melakukan ini, tambahkan baris berikut ke file <code>/etc/sudoers</code> : <br><p>  Untuk distribusi <strong>RPM</strong> , garisnya terlihat seperti ini: </p><br><pre> <code class="hljs pgsql">zabbix <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span>) NOPASSWD: /usr/bin/yum -y <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> *</code> </pre> <br><p>  Untuk distribusi <strong>DEB</strong> sedikit berbeda: </p><br><pre> <code class="hljs powershell">zabbix ALL=(ALL) NOPASSWD: /usr/bin/apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> -<span class="hljs-literal"><span class="hljs-literal">-assume</span></span><span class="hljs-literal"><span class="hljs-literal">-yes</span></span> install -<span class="hljs-literal"><span class="hljs-literal">-only</span></span><span class="hljs-literal"><span class="hljs-literal">-upgrade</span></span> *</code> </pre> <br><h3 id="podklyuchaemsya-k-vulners">  Terhubung ke Vulners </h3><br><p>  Untuk menggunakan API Vulners, Anda memerlukan kunci api.  Untuk mendapatkannya: </p><br><ul><li>  Daftar ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">vulners.com</a> </li><li>  Di akun Anda, buka tab KEYS API </li><li>  Pilih "Pindai" di area Lingkup dan tekan "GENERATE NEW KEY". </li></ul><br><p>  Anda akan mendapatkan kunci api yang terlihat seperti ini: RGB9YPJG7CFAXP35PMDVYFFJPGZ9ZIRO1VGO9K9269B0K86K6XQQQR32O6007NUK </p><br><p><img src="https://habrastorage.org/webt/bu/r1/_8/bur1_85domk9m6gkzoaxsghzoqa.png"></p><br><p>  Sekarang Anda perlu menambahkan kunci api Vulners ke file konfigurasi plugin <code>/opt/monitoring/zabbix-threat-control/ztc_config.py</code> </p><br><p>  Contoh: </p><br><pre> <code class="hljs 1c">vuln_api_key = 'RGB9YPJG7CFAXP35PMDVYFFJPGZ9ZIRO1VGO9K<span class="hljs-number"><span class="hljs-number">9269</span></span>B0K86K6XQQQR32O<span class="hljs-number"><span class="hljs-number">6007</span></span>NUK'</code> </pre> <br><h3 id="podklyuchaemsya-k-zabbix">  Terhubung ke Zabbix </h3><br><p>  Agar plugin dapat terhubung ke Zabbix, Anda perlu menentukan data berikut dalam file konfigurasi: <code>/opt/monitoring/zabbix-threat-control/ztc_config.py</code> </p><br><ul><li>  Alamat antarmuka web Zabbix untuk bekerja dengan Zabbix-API; </li><li>  nama pengguna dan kata sandi di mana kami akan terhubung ke Zabbix API. </li></ul><br>  Nama domain dan port server Zabbix untuk mengirim data menggunakan utilitas zabbix-sender. <br><br><p>  Contoh: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">zbx_pass</span></span> = <span class="hljs-string"><span class="hljs-string">'yourpassword'</span></span> zbx_user = <span class="hljs-string"><span class="hljs-string">'yourlogin'</span></span> zbx_url = <span class="hljs-string"><span class="hljs-string">'https://zabbixfront.yourdomain.com'</span></span> zbx_server_fqdn = <span class="hljs-string"><span class="hljs-string">'zabbixserver.yourdomain.com'</span></span> zbx_server_port = <span class="hljs-string"><span class="hljs-string">'10051'</span></span></code> </pre> <br><h3 id="podgotavlivaem-zabbix">  Mempersiapkan Zabbix </h3><br><p>  Anda harus membuat objek di Zabbix yang menyediakan plugin.  Untuk melakukan ini, jalankan script <code>/opt/monitoring/zabbix-threat-control/ztc_create.py</code> .  Script akan memverifikasi bahwa plugin dikonfigurasi dengan benar dan, menggunakan API, itu akan dibuat di Zabbix: </p><br><ol><li>  <strong>Grup</strong> host tempat host yang menampilkan kerentanan ditambahkan. </li><li>  <strong>Templat</strong> tempat laporan OS dikumpulkan dari semua server. </li><li>  <strong>Host</strong> untuk menampilkan kerentanan berdasarkan paket, server, buletin, dan statistik umum. </li><li>  <strong>Tindakan</strong> untuk mengeksekusi perintah perbaikan kerentanan jarak jauh. </li><li>  <strong>Dasbor</strong> untuk memudahkan tampilan semua informasi ini. </li></ol><br><p><img src="https://habrastorage.org/webt/mh/p1/qe/mhp1qeyu_r-c-zvxhtrthl0bzyg.gif"></p><br><p>  Setelah membuat semua objek di Zabbix, skrip akan menunjukkan: </p><br><ul><li>  Tautan ke dasbor yang dibuat di Zabbix, di mana kerentanan akan ditampilkan. </li><li>  Waktu ketika pemindaian infrastruktur untuk kerentanan akan diluncurkan. </li></ul><br><p>  Setelah semua objek yang diperlukan telah dibuat di Zabbix, Anda harus pergi ke antarmuka web Zabbix dan menautkan template "Vulners OS-Report" yang baru saja dibuat oleh skrip dengan semua server yang membutuhkan pemindaian untuk kerentanan. </p><br><p><img src="https://habrastorage.org/webt/0h/px/im/0hpxim3eoxm9zxk-_isvvvkpycu.png"></p><br><p>  Setelah itu, tetap menunggu plugin untuk memulai pada waktu yang ditentukan selama instalasi. </p><br><h2 id="skaniruem">  Pindai! </h2><br><p>  Skrip pemrosesan data utama ( <code>ztc.py</code> ) <code>ztc.py</code> secara otomatis, sekali sehari, melalui "Item Layanan ..." pada host "Vulners - Statistics" pada waktu yang ditentukan oleh skrip. </p><br><p>  Anda dapat mengubah waktu mulai plugin menjadi apa pun yang nyaman bagi Anda dengan mengubah "Interval Penjadwalan" di elemen data ini.  Dalam hal ini, perlu juga untuk menyesuaikan waktu pengumpulan statistik dalam tiga elemen data dari template "Vulners OS-Report" - metrik dalam template harus bekerja 10 ... 15 menit lebih awal dari metrik "Item Layanan ..." utama pada host "Vulners - Statistics". </p><br><p>  Waktu di mana semua data kerentanan akan diproses tergantung pada jumlah server dalam infrastruktur dan jumlah paket yang diinstal pada mereka.  Sekitar 30 menit dihabiskan untuk memproses 1.000 server. </p><br><h1 id="plany">  Paket </h1><br><p>  Ini hanya versi pertama dari plugin Zabbix Threat Control.  Dan kami terus mengembangkannya. </p><br>  Rencananya: <br><br><ul><li>  Tambahkan informasi pada dasbor yang ditemukan di infrastruktur CVE. </li><li>  Menolak untuk menginstal skrip apa pun pada agen dan mengumpulkan semua informasi yang diperlukan tentang OS dan paket menggunakan kunci elemen data yang dibangun ke dalam agen Zabbix. </li></ul><br><p>  Dan karena ini adalah opensource - bergabunglah dengan kami!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Selamat datang permintaan tarik :)</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id416137/">https://habr.com/ru/post/id416137/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id416127/index.html">CUDA dan Remote GPU</a></li>
<li><a href="../id416129/index.html">Bagaimana AI belajar menghasilkan gambar kucing</a></li>
<li><a href="../id416131/index.html">Bagaimana menangani PD di Federasi Rusia dan tidak melanggar hukum</a></li>
<li><a href="../id416133/index.html">Pusat Data di Luar Negeri: Equinix LD8</a></li>
<li><a href="../id416135/index.html">Aplikasi GUI lebih kecil dari 1 kb</a></li>
<li><a href="../id416139/index.html">Otentikasi kuat sebagai bagian dari strategi GDPR</a></li>
<li><a href="../id416143/index.html">Buku "Otopsi akan ditampilkan!" Analisis malware praktis »</a></li>
<li><a href="../id416147/index.html">Organisasi navigasi di iOS-aplikasi menggunakan Root Controller</a></li>
<li><a href="../id416149/index.html">Pertanyaan dan Jawaban Energi Terbarukan, Bagian 1</a></li>
<li><a href="../id416151/index.html">Balon tanpa dimensi. Sihir Analisis Dimensi Utilitarian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>