<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>✌🏿 🛷 👨🏿‍🤝‍👨🏼 A renderização de texto odeia você 👨‍⚖️ 🌊 🕌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sumário 

- 1. Terminologia 
- 2. O estilo, o layout e a forma dependem um do outro? 
- 3. O texto não possui caracteres separados 3.1 Sobreposição de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A renderização de texto odeia você</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469529/"><div class="spoiler">  <b class="spoiler_title">Sumário</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Terminologia</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2. O estilo, o layout e a forma dependem um do outro?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3. O texto não possui caracteres separados</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobreposição de texto</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O estilo pode mudar a ligadura</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4. Emoji quebra cor e estilo</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5. Alisar é um inferno</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As compensações de subpixel quebram o cache de glifo</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Os subpixels de suavização não podem ser compostos</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6. Esotérico</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As fontes podem conter SVG</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Personagens podem ser muito grandes</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A seleção não é um quadro, mas o texto segue em todas as direções</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como escrever o que é impossível escrever?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.5</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O estilo faz parte da fonte (a menos que não seja)</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6.6</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nenhuma renderização de texto perfeita</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7. Links adicionais</a> </li></ul></div></div><br>  Renderização de texto: quão complicado pode ser?  Acontece ser incrivelmente desafiador!  Até onde eu sei, literalmente, nenhum sistema exibe o texto "perfeitamente".  Em algum lugar melhor, em algum lugar pior. <br><br>  Suponha que você queira texto arbitrário com fontes, cores e estilos arbitrários, com suporte para quebra de linha e destaque de texto.  De fato, esses são os requisitos mínimos para a exibição correta de textos complexos, uma janela de terminal, uma página da web etc. <br><br>  Em geral, digamos imediatamente: não há respostas corretas consecutivas, tudo é muito mais importante do que você pensa e tudo afeta todo o resto. <br><br>  Discutiremos tópicos que não estão unidos em um único conceito; esses são apenas os problemas que tive que enfrentar durante vários anos trabalhando na renderização de texto no Firefox.  Por exemplo, não discutiremos detalhadamente os problemas de segmentação de texto ou o gerenciamento de várias bibliotecas de texto para uma plataforma específica, pois não estou muito interessado nisso. <br><a name="habracut"></a><br><a name="1"></a><h1>  1. Terminologia </h1><br>  A natureza do texto é complexa e o inglês transmite mal todas as nuances.  Neste documento, tentarei aderir aos seguintes termos.  Observe que essas palavras não estão "corretas"; apenas as considero úteis para transmitir conceitos-chave a falantes nativos de inglês que não têm experiência em lingüística. <br><br>  Personagens: <br><br><ul><li>  Escalar (escalar): escalar Unicode, a "menor unidade" em Unicode (também é um ponto de código). <br></li><li>  Caractere: um cluster de grafema Unicode estendido (EGC), a “maior unidade” em Unicode (potencialmente composta por vários escalares). <br></li><li>  Glifo (glifo): a unidade atômica de renderização fornecida em uma fonte.  Geralmente, possui um identificador exclusivo na fonte. <br></li><li>  Ligadura: um glifo que consiste em vários escalares e potencialmente até vários caracteres (os falantes nativos podem representar uma ligadura como vários caracteres, mas para uma fonte é apenas um caractere). <br></li><li>  Emoji: glifo "colorido". <img src="https://habrastorage.org/webt/bz/bc/0l/bzbc0lnl6kzkaygl4g6kdufbtpo.png" width="70"></li></ul><br>  Fontes <br><br><ul><li>  Fonte: um documento que mapeia caracteres para glifos. <br></li><li>  Escrita / escrita (script): um conjunto de glifos que compõem um determinado idioma (as fontes, em regra, implementam certos scripts). <br></li><li>  Fonte manuscrita (script cursivo): qualquer fonte na qual os glifos se tocam e fluem entre si (por exemplo, árabe). <br></li><li>  Cor: valores RGB e alfa para fontes (não é necessário em alguns casos de uso, mas isso é interessante). <br></li><li>  Estilo: modificadores em negrito e itálico para fontes (em implementações práticas, dicas, aliases e outras configurações também são geralmente fornecidas). </li></ul><br><a name="2"></a><h1>  2. O estilo, o layout e a forma dependem um do outro? </h1><br>  Aqui está um breve resumo para ter uma idéia de como funciona um pipeline de renderização de texto típico: <br><br><ol><li>  Estilização (marcação de análise, sistema de consulta de fontes). <br></li><li>  Layout (dividindo o texto em linhas). <br></li><li>  Modelagem, modelagem (cálculo de glifos e suas posições). <br></li><li>  Rasterização dos glifos necessários para o atlas / cache de textura). <br></li><li>  Composição (copiar glifos do atlas para a posição desejada). </li></ol><br>  Infelizmente, essas etapas não são tão simples quanto parecem. <br><br>  A maioria das fontes não produz todos os glifos possíveis sob demanda.  Existem muitos glifos; portanto, as fontes geralmente implementam apenas uma letra específica.  Os usuários finais geralmente não sabem ou não se importam com isso; portanto, um sistema confiável deve <i>cascatear</i> com outras fontes se os caracteres não estiverem disponíveis. <br><br>  Por exemplo, embora a marcação do texto a seguir não <i>implique</i> várias fontes, é necessário para a renderização adequada em qualquer sistema: hello <img src="https://habrastorage.org/webt/s6/z5/b8/s6z5b8fxd5g525xyirad9asxejk.png" width="22"> 好 ب بسم 好.  Portanto, estamos nos aproximando perigosamente do fato de que a etapa 1 (estilização) começa a depender da etapa 3 (modelagem)! <br><br>  (Como alternativa, você pode adotar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">abordagem Noto</a> e usar uma única fonte Uber que contém todos os caracteres. Embora os usuários não possam configurá-la e você não pode fornecer uma interface de texto "nativa" para os usuários em todas as plataformas. Mas suponha que você precise de uma interface mais confiável. decisão). <br><br>  Da mesma forma, para o layout, você precisa saber quanto espaço cada parte do texto ocupa, mas isso só se torna conhecido após a modelagem!  A etapa 2 depende dos resultados da etapa 3? <br><br>  Mas para moldar, você precisa conhecer o layout e o estilo, por isso parecemos estar presos.  O que fazer? <br><br>  Em primeiro lugar, a estilização aplica truques.  Embora <i>realmente</i> desejemos obter glifos completos, os <i>escalares são</i> suficientes para modelar.  Se a fonte não suportar a escrita corretamente, ela não alegará saber nada sobre as escalares dessa escrita.  Assim, você pode encontrar facilmente a fonte "melhor" da seguinte maneira: <br><br>  Para cada símbolo (EGC) em nosso texto, interrogamos cada fonte da lista (cascata) se todos os escalares que compõem esse símbolo são conhecidos por ele.  Se sim, use-os.  Se chegarmos ao final da lista sem resultado, obteremos tofu ( <img src="https://habrastorage.org/webt/qv/6w/jj/qv6wjjqmos_ob7gzmy_ogneaowy.png" width="20">  , indicador de glifo ausente). <br><br>  Você provavelmente já viu esse indicador ao encontrar emoji!  Como alguns emojis são na verdade ligaduras de vários emojis mais simples, uma fonte pode indicar suporte para um caractere emitindo apenas componentes individuais.  Desta maneira <img src="https://habrastorage.org/webt/vr/mr/yk/vrmrykt5b5kjdkyj8b4nabjhjac.png" width="22">  pode literalmente parecer <img src="https://habrastorage.org/webt/6m/yv/6n/6myv6nhjem72asbiysa_wzah8t4.png" width="70">  se a fonte for "muito antiga" para saber sobre a nova ligadura.  Isso também pode acontecer se você tiver uma implementação Unicode "muito antiga" que não conhece o novo caractere, forçando o sistema de estilo a aceitar uma correspondência parcial. <br><br>  Portanto, agora sabemos exatamente quais fontes usaremos, sem precisar nos referir ao layout ou ao formato (embora o formato possa alterar nossas cores, mais sobre isso nas próximas seções).  Da mesma forma, podemos lidar com a interdependência entre layout e forma?  Não!  Coisas como quebras de parágrafo fornecem uma quebra de linha difícil, mas a única maneira de moldar é através da modelagem iterativa! <br><br>  É necessário supor que o texto seja colocado em uma linha e forme essa linha até o espaço acabar.  Nesse ponto, você pode executar operações de digitação e descobrir onde quebrar o texto e iniciar a próxima linha.  Repita até que tudo esteja pronto. <br><br><a name="3"></a><h1>  3. O texto não possui caracteres separados </h1><br>  A julgar apenas pelo inglês, você pode pensar que as ligaduras são algum tipo de absurdo bizarro.  Quero dizer, quem <i>realmente se</i> importa que "..." está escrito "ae"?  Mas acontece que algumas línguas consistem essencialmente em ligaduras.  Por exemplo, consists् ب بسم consiste nos caracteres individuais «ب ب س م.  Em qualquer sistema avançado de renderização de texto (ou seja, em qualquer um dos principais navegadores), essas duas linhas parecerão <i>muito</i> diferentes. <br><br>  E não: não se trata da diferença entre escalares Unicode e clusters de grafema estendidos.  Se você pedir a um sistema Unicode confiável (por exemplo, Swift) para fornecer grupos de grafemas estendidos dessa linha, ele fornecerá esses cinco caracteres! <br><br>  A forma do caractere depende de seus vizinhos: o <b>texto não pode exibir corretamente caractere após caractere</b> . <br><br>  Ou seja, você deve usar uma biblioteca de modelagem.  O padrão da indústria aqui é o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HarfBuzz</a> , e essas tarefas são extremamente difíceis de resolver por conta própria.  Então use o HarfBuzz. <br><br><a name="3_1"></a><h3>  3.1  Sobreposição de texto </h3><br>  Em fontes manuscritas, os glifos geralmente se sobrepõem para evitar costuras, e isso pode causar problemas. <br><br>  Vamos dar uma outra olhada em मनी م منش.  Parece normal?  Agora aumente: <br><br><img src="https://habrastorage.org/webt/sb/u0/kv/sbu0kvn9ii-lhltb9y7pqnj67pa.png"><br><br>  Ainda parece bonito, mas vamos tornar o texto parcialmente transparente.  Se você estiver no Safari ou Edge, o texto pode ficar bem!  Mas no Firefox ou Chrome, a visão é terrível: <br><br><img src="https://habrastorage.org/webt/0m/rs/fq/0mrsfqxdecmizkckojpww0o0iju.png"><br><br>  O problema é que o Chrome e o Firefox estão tentando <i>trapacear</i> .  Eles formaram o texto corretamente, mas assim que encontram esses glifos, ainda estão tentando desenhá-los separadamente.  Isso geralmente funciona bem, exceto quando há transparência e sobreposição que produzem esse escurecimento. <br><br>  Uma implementação “correta” trará o texto para uma superfície temporária <i>sem</i> transparência e depois para a cena <i>com</i> transparência.  Firefox e Chrome não fazem isso porque é caro e geralmente não é necessário para os principais idiomas ocidentais.  Curiosamente, eles realmente entendem o problema, porque processam especificamente esse script para emoji (mas retornaremos a isso mais tarde). <br><br><a name="3_1"></a><h3>  3.2  O estilo pode mudar a ligadura </h3><br>  Ok, neste exemplo estamos analisando <i>principalmente</i> por curiosidade sobre como a marcação pode ser quebrada, embora eu não conheça nenhum cenário razoável em que possa realmente doer.  Aqui estão duas partes de texto com o mesmo conteúdo, mas com cores diferentes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/450/9ef/bcd/4509efbcddabd9a36f7a77372f99a832.png"><br><br>  Aqui está a aparência deles no Safari: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cf0/1f5/057/cf01f505710b9a16186cb8671a852a08.png"><br><br>  É assim que eles se parecem no Chrome (ao usar sua <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nova implementação de maquete</a> ): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efa/a09/2d8/efaa092d8e5df031d1f7efbe0fdc991d.png"><br><br>  E aqui estão eles no Firefox: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/450/9ef/bcd/4509efbcddabd9a36f7a77372f99a832.png"><br><br>  Em resumo: <br><br><ul><li>  O Safari é inadequado <br></li><li>  O Chrome analisa glifos, mas descarta muitas cores <br></li><li>  O Firefox analisa simultaneamente glifos e exibe cores </li></ul><br>  Eu acho que todo mundo deveria estar no Firefox, certo?  Mas se você ampliar, veremos que ele está fazendo algo muito estranho: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/516/9ce/d38/5169ced3843dcd4ab70e98c58b1929ed.png"><br><br>  Ele simplesmente dividiu essa ligadura em quatro partes iguais, com cores diferentes! <br><br>  O problema é que realmente não há uma resposta razoável sobre o que <i>deve ser</i> feito aqui.  Dividimos a ligadura em diferentes estilos e, como a ligadura é, de certo modo, uma "unidade" de renderização, faz sentido simplesmente recusar-se a apoiar essa separação (como a maioria). <br><br>  Por alguma razão, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">alguém no Firefox estava realmente entusiasmado em fazer uma implementação mais elegante</a> .  Sua abordagem é desenhar uma ligadura várias vezes com máscaras ideais e cores diferentes, o que funciona surpreendentemente bem! <br><br>  Há <i>algum</i> sentido em tentar apoiar essas “ligaduras parciais”: apenas a modelagem pode saber se uma ligadura específica será exibida, e isso depende das fontes do sistema; portanto, a ligadura pode aparecer onde ninguém esperava!  Um exemplo clássico do idioma inglês é uma ligadura æ de uma fonte instalada pelo usuário na borda de um hiperlink. <br><br>  Também é bastante estranho que o inglês possa mudar no meio de uma palavra, mas não pode fontes manuscritas? <br><br>  Nem pergunte sobre código que quebra linhas com ligaduras parciais. <br><br><a name="4"></a><h1>  4. Emoji quebra cor e estilo </h1><br>  Se você exibir emojis como o sistema nativo, precisará ignorar as configurações de cor do texto (com exceção da transparência): <br><br><img src="https://habrastorage.org/webt/cp/4d/2f/cp4d2fokoxffueesiohd1urszuu.png"><br><br>  Normalmente, os emojis têm suas próprias cores nativas e essa cor pode até ter significado semântico, como é o caso dos modificadores de cor da pele.  Além disso: eles podem ter várias cores! <br><br>  Até onde eu sei, não havia esse problema antes dos emojis, então plataformas diferentes têm abordagens diferentes para resolver.  Alguns mostram emojis como uma imagem sólida (Apple), outros como uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">série de <i>camadas</i> monocromáticas</a> (Microsoft). <br><br>  A última abordagem não é ruim, porque se integra bem aos pipelines de renderização de texto existentes, “apenas” dividindo o glifo em uma série de glifos monocromáticos com os quais todos estão acostumados a trabalhar. <br><br>  No entanto, isso significa que, quando você desenha um glifo “único”, seu estilo pode mudar <i>repetidamente</i> .  Isso também significa que o glifo "um" pode se sobrepor, o que leva aos problemas de transparência mencionados na seção anterior.  Ainda assim, os navegadores <i>realmente</i> combinam corretamente a transparência das camadas nos emojis! <br><br>  Essa discrepância pode ser explicada de três maneiras: <br><br><ul><li>  Você já está procurando glifos coloridos para processá-los de uma maneira especial, para que seja fácil escolher um caminho de layout especial. <br></li><li>  Fontes manuscritas com pouca transparência parecem um pouco feias, mas os emojis se decompõem completamente e se transformam em um conjunto de caracteres ilegíveis, de modo que o trabalho extra é justificado. <br></li><li>  Os desenvolvedores ocidentais se preocupam mais com emojis do que com idiomas como árabe e marata. </li></ul><br>  Escolha a opção ao seu gosto. <br><br>  E, no entanto, como destacar um emoticon em itálico ou negrito?  Ignorar esses estilos?  Eles devem ser sintetizados?  Quem sabe ... <br><br>  Além disso, esses emojis não parecem estranhamente pequenos? <br><br>  Sim, por algum motivo, vários sistemas aumentam secretamente o tamanho da fonte dos emojis para torná-los melhores. <br><br><a name="5"></a><h1>  5. Alisar é um inferno </h1><br>  Os caracteres no texto são muito pequenos e detalhados.  É muito importante que o texto seja fácil de ler.  Parece uma tarefa de suavização!  Inferno, 480p é realmente de baixa resolução.  Mais suavização !!! <br><br><img src="https://habrastorage.org/webt/m9/8x/qa/m98xqayxjlpla-5bgc2rmktqpd8.png" align="right">  Portanto, existem dois tipos principais: <br><br><ul><li>  Suavização da escala de cinza <img src="https://habrastorage.org/webt/sf/xr/qu/sfxrqug5y1yihdid_djblyqhhii.png" width="22"><br></li><li>  Suavização de subpixel <img src="https://habrastorage.org/webt/i7/pt/mk/i7ptmkl9iwj6tve6ly5ch7dv-y0.png" width="22"></li></ul><br>  A suavização da escala de cinza é uma abordagem "natural".  A idéia básica é que pixels parcialmente revestidos obtenham transparência parcial.  Durante a composição, isso fará com que o pixel obtenha o tom apropriado, melhorando os detalhes gerais. <br><br>  O termo "tons de cinza" é usado para cores unidimensionais, assim como nossa transparência unidimensional (caso contrário, os glifos são exibidos em uma cor sólida).  Além disso, em uma situação típica de texto em preto sobre fundo branco, a suavização de serrilhado exibe literalmente tons de cinza nas bordas. <br><br>  O anti-aliasing de subpixel é um truque que abusa do posicionamento normal de pixels nos monitores.  É muito mais complicado, portanto, se você estiver realmente interessado, precisará ler uma documentação mais detalhada; aqui está apenas uma breve descrição do conceito de alto nível. <br><br>  Os pixels do seu monitor são na verdade três pequenas colunas de vermelho, verde e azul.  Se você quer ficar vermelho, você <i>meio que</i> diz "preto branco preto".  Da mesma forma, se você deseja obter uma cor azul, especifique "preto preto branco".  Em outras palavras, se você mexer com flores, poderá <i>triplicar a</i> resolução horizontal e obter muito mais detalhes! <br><br>  Você pode pensar que esse "arco-íris" seria muito feio, mas na prática o sistema funciona muito bem (embora alguns discordem disso).  O cérebro humano adora reconhecer padrões e suavizá-los.  No entanto, se você capturar uma captura de tela do texto com suavização de subpixel, verá claramente todas as cores extras se redimensionar a imagem ou apenas olhar para ela no monitor com um layout de subpixel diferente.  É por isso que as capturas de tela com texto geralmente parecem muito estranhas e ruins. <br><br>  (Em geral, esse sistema também significa que a cor do ícone pode mudar acidentalmente seu tamanho e posição percebidos, o que é realmente irritante). <br><br>  Portanto, o anti-aliasing de subpixel é um truque realmente limpo que pode melhorar significativamente a inteligibilidade do texto, ótimo!  Mas, infelizmente, isso também é uma grande lasca na bunda! <br><br>  Observe que as <i>alterações de glifo de subpixel</i> ocorrem em qualquer sistema de suavização de serrilhado.  Você sempre deseja que seus glifos rasterizados sejam ajustados a pixels completos, mas a própria rasterização foi projetada para um deslocamento específico de sub-pixels (um valor entre 0 e 1). <br><br>  Para entender isso, imagine um quadrado preto 1x1 com suavização da escala de cinza: <br><br><ul><li>  Se o deslocamento do subpixel for 0, apenas um pixel preto será exibido durante a rasterização. <br></li><li>  Se o deslocamento do subpixel for 0,5 e, quando rasterizado, dois pixels sairão com 50% de cinza. </li></ul><br><a name="5_1"></a><h3>  5.1  As compensações de subpixel quebram o cache de glifo </h3><br>  A rasterização de glifos requer uma quantidade incrível de computação, por isso é muito melhor armazená-los em cache em um atlas de textura.  Mas como armazenar em cache texturas com deslocamentos de subpixel?  Cada deslocamento possui sua própria rasterização exclusiva! <br><br>  Aqui você precisa encontrar um compromisso entre qualidade e desempenho, e isso pode ser feito otimizando as compensações de subpixel.  Para o texto em inglês, um equilíbrio razoável seria a falta de precisão do subpixel vertical com o deslocamento horizontal vinculado a um quarto de um número inteiro.  Isso deixa apenas quatro posições de sub-pixel, o que ainda melhora muito a qualidade, mantendo um tamanho de cache razoável. <br><br><a name="5_2"></a><h3>  5.2  Os subpixels de suavização não podem ser compostos </h3><br>  Um recurso interessante de suavização de serrilhado em tons de cinza é que você pode brincar livremente com ele, e isso degrada normalmente.  Por exemplo, se você converter uma textura com texto (escala, rotação ou transformação), ela poderá ficar um pouco embaçada, mas parecerá normal em geral. <br><br>  Se você fizer o mesmo com a suavização de serrilhado de subpixel, ela ficará horrível.  Sua idéia é manipular os pixels na tela.  Se os pixels da tela não corresponderem aos pixels da sua textura, as bordas vermelha e azul serão claramente visíveis! <br><br>  Você pode pensar que isso é "corrigido" simplesmente por uma nova rasterização de glifos em um novo local.  E, de fato, se a conversão for estática, isso pode funcionar.  Mas se a transformação for uma <i>animação</i> , ficará ainda pior.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na verdade, esse é um erro muito comum do navegador: se não achar que a animação está acontecendo com o texto, os caracteres </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tremerão</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pois cada glifo salta entre diferentes ligações de subpixel com dicas em cada quadro. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado, os navegadores contêm várias heurísticas para detectar essas animações, a fim de forçar o anti-aliasing de sub-pixel para esta parte da página (e, idealmente, até para o posicionamento de sub-pixel). Isso é bastante difícil de implementar de maneira confiável, porque uma animação pode ser acionada por um JS arbitrariamente complexo, sem dar ao navegador nenhuma "dica" clara.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Além disso, a suavização de subpixel é difícil de usar na presença de transparência parcial. De fato, aqui configuramos nossos canais R, G e B para codificar três valores de transparência (um para cada subpixel), mas o próprio texto também tem uma cor e um fundo, para que as informações sejam facilmente perdidas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao usar o anti-aliasing em escala de cinza, temos um canal alfa dedicado, para que nada seja perdido. Assim, os navegadores geralmente usam tons de cinza para trabalhar com objetos translúcidos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... Exceto Firefox. </font><font style="vertical-align: inherit;">Novamente, nessa organização estranha, alguém realmente se empolgou e fez algo complicado: um componente alfa. </font><font style="vertical-align: inherit;">Acontece que você pode realmente compor texto corretamente com anti-aliasing de subpixel, mas isso requer três canais de transparência adicionais para R, G e B. Não é de surpreender que esse anti-aliasing dobre o consumo de memória. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Felizmente, ao longo dos anos, a suavização sub-pixel se tornou menos relevante:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Os displays de retina não precisam disso. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O layout de sub-pixel nos telefones bloqueia esse truque (sem trabalho sério). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nas versões mais recentes do MacOS, o texto do subpixel é desativado por padrão no nível do SO. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O Chrome parece ser mais agressivo ao desativar o anti-aliasing de subpixel (não tenho certeza se essa é a política exata). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O novo backend gráfico do Firefox (webrender) abandonou o componente Alpha por simplicidade. </font></font></li></ul><br><a name="6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Esotérico </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esta parte é apenas um monte de pequenas coisas que não merecem muita discussão. </font></font><br><br><a name="6_1"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1 </font><font style="vertical-align: inherit;">As fontes podem conter SVG</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso é péssimo. </font><font style="vertical-align: inherit;">Essas fontes são fornecidas principalmente pela Adobe, porque há algum tempo elas entraram no SVG muito bem. </font><font style="vertical-align: inherit;">Às vezes, você pode simplesmente ignorar partes do SVG (acredito que a fonte do Source Code Pro contém tecnicamente alguns glifos SVG, mas na prática eles não são realmente usados ​​por sites), mas em geral você precisará implementar o suporte ao SVG para dar suporte formal a todas as fontes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E você já ouviu falar sobre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fontes animadas SVG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font> Não?  Bom<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eu acho que eles estão quebrados ou não foram implementados em todos os lugares (o Firefox acidentalmente os apoiou por um tempo devido a algum tipo de desenvolvedor entusiasmado). </font></font><br><br><a name="6_2"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2 </font><font style="vertical-align: inherit;">Personagens podem ser muito grandes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você deseja satisfazer ingenuamente a solicitação de um usuário por uma fonte muito grande (ou um nível de zoom muito grande), encontrará problemas extremos de gerenciamento de memória para um atlas de glifo desse tamanho, pois cada caractere pode ser maior que a tela inteira. </font><font style="vertical-align: inherit;">Existem várias maneiras de lidar com isso:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recuse-se a desenhar um glifo (usuário triste). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rasterize o glifo em um tamanho menor e aumente a escala durante a composição (isso é fácil, mas as formas ficam borradas ao longo das bordas). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rasterize o glifo diretamente na superfície após a composição (difícil, potencialmente caro). </font></font></li></ul><br><a name="6_3"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.3 </font><font style="vertical-align: inherit;">A seleção não é um quadro, mas o texto segue em todas as direções</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As pessoas geralmente sabem que a direção principal do texto pode ser da esquerda para a direita (inglês), da direita para a esquerda (árabe) ou de cima para baixo (japonês). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Então, aqui está um texto engraçado para você:</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Olá a todos </font></font><font color="purple"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">بسم الله لا</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beep beep !!</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você selecionar texto na área de trabalho com o mouse da esquerda para a direita, a seleção se tornará intermitente e, de alguma maneira, estranhamente se contorce no meio. </font><font style="vertical-align: inherit;">Isso ocorre porque misturamos o texto em uma linha da esquerda para a direita e da direita para a esquerda, o que acontece o tempo todo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro, a seleção à direita aumenta a seleção, mas diminui até que de repente começa a aumentar novamente. </font><font style="vertical-align: inherit;">Na verdade, isso é bastante correto: a seleção simplesmente permanece contínua </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na linha real</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Assim, você pode copiar corretamente um pedaço de texto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Você precisa levar isso em consideração no seu código para destacar o texto, bem como no algoritmo de quebra de linha para o layout. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas isso não é tudo. </font></font><br><img src="https://habrastorage.org/webt/h5/vm/ee/h5vmee428zjgkmlcs9syoyhzte0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que você não precise lidar com essas coisas.</font></font><br><br><a name="6_4"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.4 </font><font style="vertical-align: inherit;">Como escrever o que é impossível escrever?</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando não há caracteres na fonte, seria bom informar o usuário sobre isso. O glifo "tofu" é destinado a isso. Você pode simplesmente desenhar um tofu vazio (retângulo) e limitar-se a isso. Mas se você deseja fornecer informações realmente úteis, pode escrever o valor do caractere ausente para simplificar a depuração. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas espere, usamos texto para explicar que não podemos produzir o texto?</font></font> Hum. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Você pode dizer que deve haver uma fonte básica no sistema que sempre mostre os caracteres de 0 a 9 e AF, mas isso é uma suposição para os fracos. </font><font style="vertical-align: inherit;">Se o usuário realmente destruiu suas ferramentas com essas ferramentas, o Firefox oferece uma saída: uma micro fonte! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dentro do Firefox, há uma pequena matriz codificada de pixel art de um bit com um pequeno atlas com exatamente esses 16 caracteres. </font><font style="vertical-align: inherit;">Portanto, ao desenhar tofu, ele pode encaminhar esses caracteres sem se preocupar com fontes.</font></font><br><br><img src="https://habrastorage.org/webt/us/by/n1/usbyn1o8olhyj82uy1b5ljw_pzg.png"><br><br><a name="6_5"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.5 </font><font style="vertical-align: inherit;">O estilo faz parte da fonte (a menos que não seja)</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As fontes de alta qualidade são fornecidas inicialmente com estilos como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itálico</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">negrito</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pois não existe uma maneira algorítmica simples de trazer esses efeitos bem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, algumas fontes vêm sem esses estilos; portanto, você ainda precisa de uma maneira algorítmica simples para fazer esses efeitos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A detecção e o processamento exatos dos estilos são altamente dependentes do sistema e fora da minha área de especialização, por isso não posso explicá-lo bem. Gostaria apenas de me aprofundar no </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">código de manipulação de fontes no Webrender</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De qualquer forma, você precisa de um </font><font style="vertical-align: inherit;">fallback </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sintético</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Felizmente, a implementação é realmente bastante simples: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itálico sintético: incline cada glifo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Negrito sintético: desenhe cada glifo várias vezes com um leve deslocamento na direção do texto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Honestamente, essas abordagens se saem muito bem! </font><font style="vertical-align: inherit;">Mas os usuários podem perceber que tudo parece "errado". </font><font style="vertical-align: inherit;">Portanto, você pode fazer melhor se fizer um esforço.</font></font><br><br><a name="6_6"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.6 </font><font style="vertical-align: inherit;">Nenhuma renderização de texto perfeita</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada plataforma teve seus erros, otimizações e peculiaridades por tanto tempo que se tornaram estética. </font><font style="vertical-align: inherit;">Portanto, mesmo que você acredite firmemente que certas coisas são ideais ou importantes, sempre haverá um grande grupo de usuários com preferências diferentes. </font><font style="vertical-align: inherit;">Um sistema robusto de visualização de texto suporta essas várias preferências (ao escolher padrões razoáveis). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suas configurações devem levar em conta o sistema do usuário, fontes específicas, aplicativos específicos e textos específicos. </font><font style="vertical-align: inherit;">Você também deve tentar corresponder à "aparência" nativa de cada plataforma (tais peculiaridades). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso inclui:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Capacidade de desativar o anti-aliasing de sub-pixel (alguns realmente o odeiam). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A capacidade de desativar </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">qualquer</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anti-aliasing (sim, as pessoas fazem isso).</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Uma tonelada de propriedades específicas de plataforma / formato, como dicas, suavização, variações, gama, etc. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso também significa que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as bibliotecas de texto nativas devem ser usadas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para corresponder à estética de cada sistema (Core Text, DirectWrite e FreeType em suas respectivas plataformas).</font></font><br><br><a name="7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. Links adicionais </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aqui estão mais alguns artigos sobre o pesadelo da renderização de texto: </font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"O Windows precisará corrigir algumas fontes TrueType para funcionar"</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Existem tantos espaços de coordenadas no Firefox."</font></font></a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt469529/">https://habr.com/ru/post/pt469529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt469515/index.html">Preparando o Aplicativo para Istio</a></li>
<li><a href="../pt469521/index.html">Comprei uma moto para andar, para não cair</a></li>
<li><a href="../pt469523/index.html">Dependência do desempenho do código no contexto da declaração de variáveis ​​em JavaScript</a></li>
<li><a href="../pt469525/index.html">Sistema de controle automatizado para uma escavadeira de mineração</a></li>
<li><a href="../pt469527/index.html">O interfone é um ouvido espião?</a></li>
<li><a href="../pt469531/index.html">"Comparar linguagens de programação em uma base de pior a pior é uma ocupação completamente idiota."</a></li>
<li><a href="../pt469533/index.html">Problemas e ameaças da identificação biométrica</a></li>
<li><a href="../pt469537/index.html">Conhecendo Swift com Snake</a></li>
<li><a href="../pt469541/index.html">Montagem e implantação dos mesmos microsserviços com o werf e o GitLab CI</a></li>
<li><a href="../pt469543/index.html">Redis Scaling e Failover para Serviços DirectumRX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>