<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻 👨🏻‍🚒 ✡️ Monaden in 15 Minuten 🤙🏾 ✋🏿 👩🏼‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eintrag 
 Im YOW! 2013 einer der Entwickler der Haskell-Sprache, prof. Philip Wadler zeigte, wie Monaden es reinen Funktionssprachen ermöglichen, im W...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Monaden in 15 Minuten</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445800/"><h2>  Eintrag </h2><br>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">YOW!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2013</a> einer der Entwickler der Haskell-Sprache, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">prof.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Philip Wadler</a> zeigte, wie Monaden es reinen Funktionssprachen ermöglichen, im Wesentlichen zwingende Operationen wie Eingabe-Ausgabe und Ausnahmebehandlung auszuführen.  Es überrascht nicht, dass das Interesse des Publikums an diesem Thema zu einem explosionsartigen Wachstum der Veröffentlichungen über Monaden im Internet geführt hat.  Leider verwenden die meisten dieser Veröffentlichungen Beispiele, die in funktionalen Sprachen geschrieben sind, was bedeutet, dass Neulinge in der funktionalen Programmierung etwas über Monaden lernen möchten.  Monaden sind jedoch nicht spezifisch für Haskell oder funktionale Sprachen und können durch Beispiele in imperativen Programmiersprachen veranschaulicht werden.  Dies ist der Zweck dieses Handbuchs. <br><br>  Wie unterscheidet sich dieser Leitfaden von den anderen?  Wir werden versuchen, die Monaden in nicht mehr als 15 Minuten zu öffnen, wobei wir nur die Intuition und einige elementare Beispiele für Python-Code verwenden.  Daher werden wir nicht anfangen, zu theoretisieren und uns mit Philosophie zu befassen und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Burritos</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=http://web.archive.org/web/20081206204420/">Raumanzüge</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schreibtische</a> und Endofunktoren zu diskutieren. <br><a name="habracut"></a><br><h2>  Motivationsbeispiele </h2><br>  Wir werden drei Fragen im Zusammenhang mit der Zusammensetzung von Funktionen betrachten.  Wir werden sie auf zwei Arten lösen: den üblichen Imperativ und die Verwendung von Monaden.  Dann vergleichen wir die verschiedenen Ansätze. <br><br><h3>  1. Protokollierung </h3><br>  Angenommen, wir haben drei unäre Funktionen: <code>f1</code> , <code>f2</code> und <code>f3</code> , die eine Zahl annehmen und diese um 1, 2 bzw. 3 erhöht zurückgeben.  Jede Funktion generiert auch eine Nachricht, die einen Bericht über den abgeschlossenen Vorgang darstellt. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">1</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+1"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">2</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+2"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x + <span class="hljs-number"><span class="hljs-number">3</span></span>, str(x) + <span class="hljs-string"><span class="hljs-string">"+3"</span></span>)</code> </pre> <br>  Wir möchten sie verketten, um den Parameter <code>x</code> , mit anderen Worten, wir möchten <code>x+1+2+3</code> berechnen.  Darüber hinaus müssen wir eine lesbare Erklärung erhalten, was jede Funktion getan hat. <br><br>  Wir können das gewünschte Ergebnis auf folgende Weise erzielen: <br><pre> <code class="python hljs">log = <span class="hljs-string"><span class="hljs-string">"Ops:"</span></span> res, log1 = f1(x) log += log1 + <span class="hljs-string"><span class="hljs-string">";"</span></span> res, log2 = f2(res) log += log2 + <span class="hljs-string"><span class="hljs-string">";"</span></span> res, log3 = f3(res) log += log3 + <span class="hljs-string"><span class="hljs-string">";"</span></span> print(res, log)</code> </pre> <br>  Diese Lösung ist nicht ideal, da sie aus einer großen Anzahl monotoner Middleware besteht.  Wenn wir unserer Kette eine neue Funktion hinzufügen möchten, müssen wir diesen Verknüpfungscode wiederholen.  Darüber hinaus beeinträchtigen Manipulationen mit den Variablen <code>res</code> und <code>log</code> die Lesbarkeit des Codes, was es schwierig macht, der Hauptlogik des Programms zu folgen. <br><br>  Idealerweise sollte ein Programm wie eine einfache Funktionskette aussehen, wie <code>f3(f2(f1(x)))</code> .  Leider stimmen die von <code>f1</code> und <code>f2</code> Datentypen nicht mit den Parametertypen <code>f2</code> und <code>f3</code> überein.  Aber wir können der Kette neue Funktionen hinzufügen: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x, <span class="hljs-string"><span class="hljs-string">"Ops:"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, f)</span></span></span><span class="hljs-function">:</span></span> res = f(t[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (res[<span class="hljs-number"><span class="hljs-number">0</span></span>], t[<span class="hljs-number"><span class="hljs-number">1</span></span>] + res[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-string"><span class="hljs-string">";"</span></span>)</code> </pre> <br>  Jetzt können wir das Problem wie folgt lösen: <br><pre> <code class="python hljs">print(bind(bind(bind(unit(x), f1), f2), f3))</code> </pre> <br>  Das folgende Diagramm zeigt den bei <code>x=0</code> ablaufenden Rechenprozess.  Hier sind <code>v1</code> , <code>v2</code> und <code>v3</code> die Werte, die als Ergebnis von Aufrufen von <code>unit</code> und <code>bind</code> . <br><br><img src="https://habrastorage.org/webt/dy/ta/f0/dytaf0ku8j3y7ctrcrhjlqbs2ck.png"><br><br>  Die <code>unit</code> konvertiert den Eingabeparameter <code>x</code> in ein Tupel aus einer Zahl und einer Zeichenfolge.  Die <code>bind</code> ruft die an sie übergebene Funktion als Parameter auf und akkumuliert das Ergebnis in der Zwischenvariablen <code>t</code> . <br><br>  Wir konnten vermeiden, Middleware zu wiederholen, indem wir sie in die <code>bind</code> einfügten.  Wenn wir nun die Funktion <code>f4</code> , <code>f4</code> wir sie einfach in die Kette ein: <br><pre> <code class="python hljs">bind(f4, bind(f3, ... ))</code> </pre> <br>  Und wir müssen keine weiteren Änderungen vornehmen. <br><br><h3>  2. Liste der Zwischenwerte </h3><br>  Wir werden dieses Beispiel auch mit einfachen unären Funktionen beginnen. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Wie im vorherigen Beispiel müssen wir diese Funktionen zusammensetzen, um <code>x+1+2+3</code> zu berechnen.  Wir müssen auch eine Liste aller Werte erhalten, die sich aus der Arbeit unserer Funktionen ergeben, dh <code>x</code> , <code>x+1</code> , <code>x+1+2</code> und <code>x+1+2+3</code> . <br><br>  Im Gegensatz zum vorherigen Beispiel sind unsere Funktionen zusammensetzbar, dh die Typen ihrer Eingabeparameter stimmen mit dem Typ des Ergebnisses überein.  Daher gibt eine einfache Kette <code>f3(f2(f1(x)))</code> das Endergebnis zurück.  In diesem Fall verlieren wir jedoch die Zwischenwerte. <br><br>  Lösen wir das Problem "frontal": <br><pre> <code class="python hljs">lst = [x] res = f1(x) lst.append(res) res = f2(res) lst.append(res) res = f3(res) lst.append(res) print(res, lst)</code> </pre> <br>  Leider enthält diese Lösung auch viel Middleware.  Und wenn wir uns entscheiden, <code>f4</code> hinzuzufügen, müssen wir diesen Code erneut wiederholen, um die richtige Liste der Zwischenwerte zu erhalten. <br><br>  Daher fügen wir wie im vorherigen Beispiel zwei zusätzliche Funktionen hinzu: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x, [x]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t, f)</span></span></span><span class="hljs-function">:</span></span> res = f(t[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (res, t[<span class="hljs-number"><span class="hljs-number">1</span></span>] + [res])</code> </pre> <br>  Jetzt schreiben wir das Programm als eine Kette von Aufrufen um: <br><pre> <code class="python hljs">print(bind(bind(bind(unit(x), f1), f2), f3))</code> </pre> <br>  Das folgende Diagramm zeigt den bei <code>x=0</code> ablaufenden Rechenprozess.  Wiederum bezeichnen <code>v1</code> , <code>v2</code> und <code>v3</code> die Werte, die von <code>unit</code> und <code>bind</code> werden. <br><br><img src="https://habrastorage.org/webt/qh/uw/7y/qhuw7yx5fo1yjlcbce34kuhejj4.png"><br><br><h3>  3. Leere Werte </h3><br>  Versuchen wir, ein interessanteres Beispiel zu geben, diesmal mit Klassen und Objekten.  Angenommen, wir haben eine <code>Employee</code> Klasse mit zwei Methoden: <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Employee</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_boss</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Return the employee's boss def get_wage(self): # Compute the wage</span></span></code> </pre> <br>  Jedes Objekt der <code>Employee</code> Klasse verfügt über einen Manager (ein anderes Objekt der <code>Employee</code> Klasse) und ein Gehalt, auf die über geeignete Methoden zugegriffen wird.  Beide Methoden können auch <code>None</code> (der Mitarbeiter hat keinen Manager, das Gehalt ist unbekannt). <br><br>  In diesem Beispiel erstellen wir ein Programm, das das Gehalt des Leiters dieses Mitarbeiters anzeigt.  Wenn der Manager nicht gefunden wird oder sein Gehalt nicht ermittelt werden kann, gibt das Programm <code>None</code> . <br><br>  Im Idealfall müssen wir so etwas schreiben <br><pre> <code class="python hljs">print(john.get_boss().get_wage())</code> </pre> <br>  In diesem Fall wird unser Programm jedoch mit einem Fehler beendet, wenn eine der Methoden <code>None</code> zurückgibt. <br><br>  Ein offensichtlicher Weg, um mit dieser Situation umzugehen, könnte folgendermaßen aussehen: <br><pre> <code class="python hljs">result = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> john <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> john.get_boss() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> john.get_boss().get_wage() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: result = john.get_boss().get_wage() print(result)</code> </pre> <br>  In diesem Fall erlauben wir zusätzliche Aufrufe der <code>get_wage</code> <code>get_boss</code> und <code>get_wage</code> .  Wenn diese Methoden schwer genug sind (z. B. Zugriff auf die Datenbank), reicht unsere Lösung nicht aus.  Deshalb ändern wir es: <br><pre> <code class="python hljs">result = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> john <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: boss = john.get_boss() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boss <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: wage = boss.get_wage() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> wage <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: result = wage print(result)</code> </pre> <br>  Dieser Code ist hinsichtlich der Berechnung optimal, wird jedoch aufgrund von drei verschachtelten <code>if</code> schlecht gelesen.  Daher werden wir versuchen, den gleichen Trick wie in den vorherigen Beispielen zu verwenden.  Definieren Sie zwei Funktionen: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e, f)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> f(e)</code> </pre> <br>  Und jetzt können wir die gesamte Lösung in einer Zeile zusammenfassen. <br><pre> <code class="python hljs">print(bind(bind(unit(john), Employee.get_boss), Employee.get_wage))</code> </pre> <br>  Wie Sie wahrscheinlich bereits bemerkt haben, mussten wir in diesem Fall die <code>unit</code> nicht schreiben: Sie gibt einfach den Eingabeparameter zurück.  Aber wir werden es so lassen, dass es für uns einfacher ist, unsere Erfahrungen zu verallgemeinern. <br><br>  Beachten Sie auch, dass wir in Python Methoden als Funktionen verwenden können, mit denen wir <code>Employee.get_boss(john)</code> anstelle von <code>john.get_boss()</code> schreiben konnten. <br><br>  Das folgende Diagramm zeigt den Berechnungsprozess, wenn John keinen Anführer hat, d. H. <code>john.get_boss()</code> gibt <code>None</code> . <br><br><img src="https://habrastorage.org/webt/hm/ae/9r/hmae9rlrkzaorijygg-jg2u7wrq.png"><br><br><h2>  Schlussfolgerungen </h2><br>  Angenommen, wir möchten die Funktionen des gleichen Typs <code>f1</code> , <code>f2</code> , <code>…</code> , <code>fn</code> kombinieren.  Wenn ihre Eingabeparameter mit den Ergebnissen übereinstimmen, können wir eine einfache Kette der Form <code>fn(… f2(f1(x)) …)</code> .  Das folgende Diagramm zeigt einen verallgemeinerten Berechnungsprozess mit Zwischenergebnissen, die als <code>v1</code> , <code>v2</code> , <code>…</code> , <code>vn</code> . <br><br><img src="https://habrastorage.org/webt/dl/yl/lp/dlyllpbpaltz_hwgjbugs8ti2zg.png"><br><br>  Oft ist dieser Ansatz nicht anwendbar.  Die Arten von Eingabewerten und Funktionsergebnissen können wie im ersten Beispiel variieren.  Oder Funktionen können zusammensetzbar sein, aber wir möchten zusätzliche Logik zwischen Aufrufen einfügen, da wir in den Beispielen 2 und 3 eine Aggregation von Zwischenwerten bzw. eine Prüfung auf einen leeren Wert eingefügt haben. <br><br><h3>  1. Imperative Entscheidung </h3><br>  In allen Beispielen haben wir zunächst den einfachsten Ansatz verwendet, der durch das folgende Diagramm dargestellt werden kann: <br><br><img src="https://habrastorage.org/webt/bo/2i/co/bo2ico2rhkvds3jmirwyzsyd3yc.png"><br><br>  Bevor wir <code>f1</code> aufrufen <code>f1</code> wir einige Initialisierungen durchgeführt.  Im ersten Beispiel haben wir eine Variable zum Speichern eines gemeinsamen Protokolls initialisiert, im zweiten für eine Liste von Zwischenwerten.  Danach haben wir Funktionsaufrufe mit einem bestimmten Verbindungscode durchsetzt: Wir haben Aggregatwerte berechnet und das Ergebnis auf <code>None</code> überprüft. <br><br><h3>  2. Monaden </h3><br>  Wie wir in den Beispielen gesehen haben, litten imperative Entscheidungen immer unter Ausführlichkeit, Wiederholung und verwirrender Logik.  Um eleganteren Code zu erhalten, haben wir ein bestimmtes Entwurfsmuster verwendet, nach dem wir zwei Funktionen erstellt haben: <code>unit</code> und <code>bind</code> .  Diese Vorlage wird als <b>Monade bezeichnet</b> .  Die <code>bind</code> enthält Middleware, während das <code>unit</code> die Initialisierung implementiert.  Dies ermöglicht es uns, die endgültige Lösung auf eine Zeile zu vereinfachen: <br><pre> <code class="python hljs">bind(bind( ... bind(bind(unit(x), f1), f2) ... fn<span class="hljs-number"><span class="hljs-number">-1</span></span>), fn)</code> </pre> <br>  Der Berechnungsprozess kann durch ein Diagramm dargestellt werden: <br><br><img src="https://habrastorage.org/webt/tw/n5/ro/twn5ro-lppmqs2rssnne7buoqxo.png"><br><br>  Ein Aufruf von <code>unit(x)</code> erzeugt einen Anfangswert von <code>v1</code> .  Dann erzeugt <code>bind(v1, f1)</code> einen neuen Zwischenwert <code>v2</code> , der beim nächsten Aufruf zum <code>bind(v2, f2)</code> .  Dieser Prozess wird fortgesetzt, bis ein Endergebnis erhalten wird.  Durch die Definition verschiedener <code>unit</code> und <code>bind</code> im Rahmen dieser Vorlage können wir verschiedene Funktionen in einer Berechnungskette kombinieren.  <i>Monadenbibliotheken</i> ( <i>z. B. PyMonad oder OSlash, ca. Transl.</i> ) Enthalten normalerweise gebrauchsfertige Monaden (Paare von <code>unit</code> und <code>bind</code> ) zum Implementieren bestimmter Funktionszusammensetzungen. <br><br>  Um Funktionen zu verketten, müssen die von <code>unit</code> und <code>bind</code> zurückgegebenen Werte vom gleichen Typ sein wie die Eingabeparameter von <code>bind</code> .  Dieser Typ wird <b>monadisch genannt</b> .  In Bezug auf das obige Diagramm muss der Typ der Variablen <code>v1</code> , <code>v2</code> , <code>…</code> , <code>vn</code> ein monadischer Typ sein. <br><br>  Überlegen Sie abschließend, wie Sie den mit Monaden geschriebenen Code verbessern können.  Offensichtlich wirken wiederholte <code>bind</code> unelegant.  Um dies zu vermeiden, definieren Sie eine andere externe Funktion: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pipeline</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e, *functions)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> f <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> functions: e = bind(e, f) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e</code> </pre> <br>  Jetzt stattdessen <br><pre> <code class="python hljs">bind(bind(bind(bind(unit(x), f1), f2), f3), f4)</code> </pre> <br>  Wir können die folgende Abkürzung verwenden: <br><pre> <code class="python hljs">pipeline(unit(x), f1, f2, f3, f4)</code> </pre> <br><br><h2>  Fazit </h2><br>  Monaden sind ein einfaches und leistungsstarkes Entwurfsmuster, mit dem Funktionen erstellt werden.  In deklarativen Programmiersprachen hilft es, zwingende Mechanismen wie Protokollierung oder Eingabe / Ausgabe zu implementieren.  In imperativen Sprachen <br>  Es hilft, Code zu verallgemeinern und zu verkürzen, der eine Reihe von Aufrufen von Funktionen desselben Typs verknüpft. <br><br>  Dieser Artikel bietet nur ein oberflächliches, intuitives Verständnis von Monaden.  Weitere Informationen erhalten Sie bei folgenden Quellen: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wikipedia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Monaden in Python (mit schöner Syntax!)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zeitleiste der Monaden-Tutorials</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de445800/">https://habr.com/ru/post/de445800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de445788/index.html">Cloud-Videoüberwachung zum Selbermachen: Neue Funktionen des Ivideon Web SDK</a></li>
<li><a href="../de445792/index.html">Wie wir Dokumentation in einem offenen Embox-Projekt entwickeln</a></li>
<li><a href="../de445794/index.html">IT-Giganten stellen eine hybride Hybrid-Cloud-Bereitstellungslösung vor</a></li>
<li><a href="../de445796/index.html">Fintech Digest: Dorsey zahlt mit Bitcoins, Australiens Blockchain-Strategie, Levis Börsengang, Bürgermeister von Chicago und der Unvermeidlichkeit von Bitcoin</a></li>
<li><a href="../de445798/index.html">Nashorn in der Katze - Führen Sie die Firmware im Kopycat-Emulator aus</a></li>
<li><a href="../de445802/index.html">5 Dinge, über die Internet-Trends jeder wissen sollte</a></li>
<li><a href="../de445804/index.html">Kapselung für echte Samurai oder die Nuancen, die mit dem internen Schlüsselwort in C # verbunden sind</a></li>
<li><a href="../de445806/index.html">Wie künstliche Intelligenz die Wissenschaft verändert</a></li>
<li><a href="../de445808/index.html">Wir hassen und jagen: das gefährliche Leben eines Virus-Crackers, der sich mächtige Feinde macht</a></li>
<li><a href="../de445814/index.html">Wie ein Lieferroboter die kulinarischen Gewohnheiten amerikanischer Studenten verändert hat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>