<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšµğŸ½ ğŸ¥Š ğŸ’¡ Attaque DDoS sur les services RDP: reconnaÃ®tre et surmonter. ExpÃ©rience rÃ©ussie de Tucha ğŸ“» ğŸ‘‰ğŸ¾ ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous allons vous raconter une histoire intÃ©ressante sur la faÃ§on dont des Â«tiersÂ» ont tentÃ© d'interfÃ©rer avec le travail de nos clients, et comment ce...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Attaque DDoS sur les services RDP: reconnaÃ®tre et surmonter. ExpÃ©rience rÃ©ussie de Tucha</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474470/">  Nous allons vous raconter une histoire intÃ©ressante sur la faÃ§on dont des Â«tiersÂ» ont tentÃ© d'interfÃ©rer avec le travail de nos clients, et comment ce problÃ¨me a Ã©tÃ© rÃ©solu. <br><br><h2>  Comment tout a commencÃ© </h2><br>  Tout a commencÃ© dans la matinÃ©e du 31 octobre, le dernier jour du mois, alors que beaucoup ont dÃ©sespÃ©rÃ©ment besoin de parvenir Ã  rÃ©gler des problÃ¨mes urgents et importants. <br><br>  L'un des partenaires qui conserve dans notre cloud plusieurs machines virtuelles des clients qu'il sert, a indiquÃ© que de 9h10 Ã  9h20 Ã  la fois, plusieurs serveurs Windows exÃ©cutÃ©s sur notre site ukrainien n'ont pas acceptÃ© les connexions avec le service d'accÃ¨s Ã  distance , les utilisateurs ne pouvaient pas accÃ©der Ã  leurs bureaux, mais aprÃ¨s quelques minutes, le problÃ¨me semblait se rÃ©soudre lui-mÃªme. <br><br>  Nous avons relevÃ© les statistiques des canaux de communication, mais n'avons trouvÃ© ni rafales de trafic ni pannes.  RegardÃ© les statistiques sur la charge des ressources informatiques - aucune anomalie.  Et c'Ã©tait quoi? <br><br>  Ensuite, un autre partenaire, qui hÃ©berge une centaine de serveurs dans notre cloud, a signalÃ© les mÃªmes problÃ¨mes que certains de leurs clients ont notÃ©s, et il s'est avÃ©rÃ© qu'en gÃ©nÃ©ral les serveurs sont disponibles (ils rÃ©pondent correctement au test ping et Ã  d'autres demandes), mais le service L'accÃ¨s Ã  distance sur ces serveurs accepte soit de nouvelles connexions, puis les rejette, alors qu'il s'agissait de serveurs sur diffÃ©rents sites, dont le trafic provient de diffÃ©rents canaux de transmission de donnÃ©es. <br><br><a name="habracut"></a>  Et regardons ce trafic.  Un paquet avec une demande d'Ã©tablissement d'une connexion arrive sur le serveur: <br><br><pre><code class="plaintext hljs">xx:xx:xx.xxxxxx IP xxx.xxx.xxx.xxx.58355 &gt; 192.168.xxx.xxx.3389: Flags [S], seq 467744439, win 64240, options [mss 1460,nop,wscale 8,nop,nop,sackOK], length 0</code> </pre> <br>  Le serveur reÃ§oit ce paquet, mais la connexion rejette: <br><br><pre> <b><code class="plaintext hljs">xx:xx:xx.xxxxxx IP 192.168.xxx.xxx.3389 &gt; xxx.xxx.xxx.xxx.58355: Flags [R.], seq 0, ack 467744440, win 0, length 0</code></b> </pre> <br>  Cela signifie que le problÃ¨me est clairement causÃ© non pas du tout par des dysfonctionnements de l'infrastructure, mais par autre chose.  Peut-Ãªtre que tous les utilisateurs ont des problÃ¨mes avec les licences des postes de travail distants?  Peut-Ãªtre que certains logiciels malveillants ont rÃ©ussi Ã  s'infiltrer dans leurs systÃ¨mes, mais aujourd'hui, il s'est activÃ©, comme c'Ã©tait le cas avec <b>XData</b> et <b>Petya il y a</b> quelques annÃ©es? <br><br>  Pendant le tri, ils ont reÃ§u des demandes similaires de plusieurs autres clients et partenaires. <br>  Et que se passe-t-il sur ces machines? <br><br>  Les journaux d'Ã©vÃ©nements regorgent de messages sur la recherche d'un mot de passe: <br><br><img src="https://habrastorage.org/webt/bs/zs/n_/bszsn_28xboprso40nmivlngmiy.png"><br><br>  En rÃ¨gle gÃ©nÃ©rale, ces tentatives sont enregistrÃ©es sur tous les serveurs sur lesquels le port standard (3389) est utilisÃ© pour le service d'accÃ¨s Ã  distance et l'accÃ¨s est autorisÃ© de n'importe oÃ¹.  Internet regorge de bots qui analysent constamment tous les points de connexion disponibles et essaient de trouver un mot de passe (pour cette raison, nous vous recommandons fortement d'utiliser des mots de passe complexes au lieu de Â«123Â»).  Cependant, l'intensitÃ© de ces tentatives ce jour-lÃ  Ã©tait trop Ã©levÃ©e. <br><br><h3>  Que faire? </h3><br>  Recommander aux clients de consacrer beaucoup de temps Ã  modifier les paramÃ¨tres d'un grand nombre d'utilisateurs finaux pour passer Ã  un autre port?  Ce n'est pas une bonne idÃ©e, les clients ne seront pas contents.  Recommander d'autoriser l'accÃ¨s uniquement via VPN?  Dans la hÃ¢te et la panique, pour augmenter les connexions IPSec, dont ils ne sont pas issus - peut-Ãªtre, un tel bonheur ne sourit pas non plus aux clients.  Bien que, je dois dire que c'est en tout cas une affaire caritative, nous recommandons toujours de cacher le serveur sur un rÃ©seau privÃ© et sommes prÃªts Ã  aider avec les paramÃ¨tres, et pour ceux qui aiment trier, nous partagerons indÃ©pendamment les instructions pour configurer IPSec / L2TP dans notre cloud en mode site Ã  site ou en mode route -warrior, et si quelqu'un veut augmenter un service VPN sur son propre serveur Windows, il est toujours prÃªt Ã  partager des conseils sur la faÃ§on de monter un RAS standard ou OpenVPN.  Mais peu importe Ã  quel point nous Ã©tions cool, ce n'Ã©tait pas le meilleur moment pour effectuer un travail Ã©ducatif auprÃ¨s des clients, car il Ã©tait nÃ©cessaire de rÃ©soudre le problÃ¨me avec un minimum de pression pour les utilisateurs le plus rapidement possible. <br><br>  La solution que nous avons implÃ©mentÃ©e Ã©tait la suivante.  Nous avons configurÃ© une analyse du trafic passant de maniÃ¨re Ã  surveiller toutes les tentatives d'Ã©tablissement d'une connexion TCP au port 3389 et Ã  sÃ©lectionner parmi celles-ci des adresses qui, dans les 150 secondes, tentent d'Ã©tablir des connexions avec plus de 16 serveurs diffÃ©rents sur notre rÃ©seau - ce sont les sources de l'attaque ( Bien sÃ»r, si l'un des clients ou partenaires a vraiment besoin d'Ã©tablir des connexions avec autant de serveurs de la mÃªme source, vous pouvez toujours ajouter ces sources Ã  la Â«liste blancheÂ». De plus, si dans un rÃ©seau de classe C pour ces 150  secondes, plus de 32 adresses ont Ã©tÃ© dÃ©tectÃ©es, il est logique de bloquer l'ensemble du rÃ©seau. Le blocage est dÃ©fini sur 3 jours, et si aucune attaque de cette source n'a Ã©tÃ© effectuÃ©e pendant cette pÃ©riode, cette source est automatiquement supprimÃ©e de la liste noire. La liste des sources bloquÃ©es est mise Ã  jour toutes les 300 secondes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/l4/m_/thl4m_cpt8fhmpcrpzofbyw4eaa.jpeg"></div><cut></cut><br><br>  Cette liste est disponible ici Ã  cette adresse: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://secure.tucha.ua/global-filter/banned/rdp_ddos</a> , vous pouvez construire vos propres ACL sur la base de celle-ci. <br><br>  Nous sommes prÃªts Ã  partager le code source d'un tel systÃ¨me, il n'y a rien de super compliquÃ© (ce sont quelques scripts simples Ã©crits littÃ©ralement en quelques heures "Ã  genoux"), et en mÃªme temps il peut Ãªtre adaptÃ© et utilisÃ© non seulement pour se protÃ©ger contre une telle attaque, mais aussi pour identifier et bloquer toute tentative de scan du rÃ©seau: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">suivez ce lien.</a> <br><br>  De plus, nous avons apportÃ© quelques modifications aux paramÃ¨tres du systÃ¨me de surveillance, qui surveille dÃ©sormais de prÃ¨s la rÃ©action du groupe de contrÃ´le des serveurs virtuels de notre cloud Ã  une tentative d'Ã©tablissement d'une connexion RDP: si la rÃ©action n'a pas suivi pendant une seconde, c'est l'occasion de faire attention. <br><br>  La solution s'est avÃ©rÃ©e assez efficace: il n'y a plus de plaintes des clients et partenaires, ainsi que du systÃ¨me de suivi.  La Â«liste noireÂ» comprend rÃ©guliÃ¨rement de nouvelles adresses et des rÃ©seaux entiers, ce qui indique que l'attaque se poursuit, mais n'affecte plus le travail de nos clients. <br><br><h3>  Seul sur le terrain n'est pas un guerrier </h3><br>  Aujourd'hui, nous avons appris que d'autres opÃ©rateurs Ã©taient confrontÃ©s Ã  un problÃ¨me similaire.  Quelqu'un croit toujours que Microsoft a apportÃ© des modifications au code du service d'accÃ¨s Ã  distance (si vous vous souvenez, nous avons soupÃ§onnÃ© la mÃªme chose le premier jour, mais nous avons rejetÃ© cette version trÃ¨s bientÃ´t) et promet de faire tout son possible pour trouver une solution bientÃ´t.  Quelqu'un ignore simplement le problÃ¨me et conseille aux clients de se protÃ©ger (changer le port de connexion, masquer le serveur sur un rÃ©seau privÃ©, etc.).  Et dÃ¨s le premier jour, nous avons non seulement rÃ©solu ce problÃ¨me, mais Ã©galement crÃ©Ã© des bases pour un systÃ¨me de dÃ©tection des menaces plus global, que nous prÃ©voyons de dÃ©velopper. <br><br><img src="https://habrastorage.org/webt/v6/iy/fz/v6iyfz27ppf36lm7sjwsmf3biym.jpeg"><br><br>  Un merci spÃ©cial aux clients et partenaires qui ne sont pas restÃ©s silencieux et ne se sont pas assis sur la rive du fleuve en prÃ©vision qu'un jour le cadavre de l'ennemi flotterait dessus et a immÃ©diatement attirÃ© notre attention sur le problÃ¨me, ce qui nous a permis de l'Ã©liminer le mÃªme jour. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474470/">https://habr.com/ru/post/fr474470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474452/index.html">Rapport de situation automne Haxe</a></li>
<li><a href="../fr474458/index.html">Total cumulÃ© en SQL</a></li>
<li><a href="../fr474460/index.html">Description des architectures de processeur dans LLVM utilisant TableGen</a></li>
<li><a href="../fr474462/index.html">Ã‰norme ensemble de donnÃ©es ouvertes de la version russe du discours 1.0</a></li>
<li><a href="../fr474466/index.html">Histoire du premier Diablo</a></li>
<li><a href="../fr474472/index.html">Liste de contrÃ´le UX en 30 points pour les applications mobiles</a></li>
<li><a href="../fr474474/index.html">RepÃ¨res ouverts pour le test de charge des serveurs et des applications Web</a></li>
<li><a href="../fr474476/index.html">Stockage de photos sur DVD au 2K19Ã¨me (en 2190? En 2238?)</a></li>
<li><a href="../fr474478/index.html">Synopsis sur l'apprentissage automatique. Statistiques mathÃ©matiques. MÃ©thode du maximum de vraisemblance</a></li>
<li><a href="../fr474480/index.html">Comment Ã©duquer les enfants Ã  utiliser correctement la technologie si ce nâ€™Ã©tait pas dans votre enfance?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>