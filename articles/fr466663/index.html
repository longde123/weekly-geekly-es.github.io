<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏿 🌉 👹 Expériences simples avec le microcontrôleur STM32F103 (Blue Tablet) 🌝 👩🏿‍🍳 🐹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beaucoup ont acquis une «pilule bleue» pour essayer. Mais en raison de la complexité de la programmation, cette chose était quelque part sur l'étagère...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Expériences simples avec le microcontrôleur STM32F103 (Blue Tablet)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466663/"><img src="https://habrastorage.org/webt/kx/9h/1s/kx9h1synxem3k3qz1dixgibvyqu.jpeg"><br><br>  Beaucoup ont acquis une «pilule bleue» pour essayer.  Mais en raison de la complexité de la programmation, cette chose était quelque part sur l'étagère, jusqu'à des temps meilleurs. <br><br>  Nous considérerons que les «meilleurs moments» sont arrivés. <br><a name="habracut"></a><br><h2>  Ce qui est nécessaire pour les expériences: </h2><br><ul><li>  Matériel informatique </li><li>  Logiciels <br></li></ul><br><h3>  Matériel informatique </h3><br>  Toutes les pièces / composants utilisés peuvent être achetés sur aliexpress.com <br><br><ul><li>  Bien sûr, tout d'abord, le contrôleur lui-même. "Blue Tablet" </li><li>  Adaptateur USB-UART </li><li>  Câble micro usb </li><li>  un ensemble de fils pour connecter les composants les uns aux autres </li></ul><br>  Il est recommandé d'utiliser le programmateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ST-Link V2</a> pour accélérer, par rapport à UART, le chargement du «firmware» et le débogage des programmes <br><br><h3>  Logiciels </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Démonstrateur du chargeur flash STM32</a> (UM0462) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pilote de port COM virtuel STM32</a> (usb vcp) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Utilitaire STM32 ST-LINK</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.embitz.org</a> Environnement de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">développement</a> </li><li>  <a href="">MIOC</a> - programme - configurateur, création d'un modèle de firmware. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">émulateur de</a> terminal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">terraterm</a> </li></ul><br><h3>  Qu'est-ce qu'un module? </h3><br>  Un module est une combinaison de matériel et de logiciel.  La partie matérielle est la «tablette» STM32F103C8T6, la partie logicielle est le «modèle de firmware» créé à l'aide du programme <a href="">MIOC.</a> Ce programme est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenSource</a> . <br><br><h3>  Ports du microcontrôleur </h3><br>  Le microcontrôleur a des broches ou des pattes.  Certains d'entre eux sont alimentés par un microcontrôleur, certains ont un objectif spécial (par exemple, Réinitialiser), certains sont une interface d'entrée / sortie à usage général (entrée / sortie à usage général en anglais, GPIO). <br><br>  Les ports sont regroupés (A; B; C ...).  Chaque groupe contient jusqu'à 16 ports, numérotés de 0 à 15. Par conséquent, la numérotation des ports ressemble à PA0, PA1, ... <br><br>  Les ports sont utilisés pour la communication entre les composants du module, par exemple, un microprocesseur et divers périphériques.  Les ports peuvent agir comme une entrée, une sortie et bidirectionnel. <br><br>  La carte «tablette» est marquée de ports. <br><br><h3>  GPIO - Interface d'E / S à usage général </h3><br>  Dans le module IO, les principaux types de ports sont présentés dans le tableau: <br><br><img src="https://habrastorage.org/webt/ba/cq/jp/bacqjpfg63onfpm_e7mwbuxzjze.gif"><br><br>  En tant que capteurs, actionneurs, nous utiliserons divers appareils Arduino. <br><br><h3>  Programme MIOC (Module Input-Output Configurator) </h3><br>  En utilisant ce programme, nous créons / configurons le modèle de firmware (projet pour Embitz; Keil) du module IO.  Le programme d'installation ne nécessite pas.  Téléchargez, exécutez.  En utilisant ce programme, nous créons des variables globales que nous utiliserons dans notre firmware.  Les variables peuvent être associées aux ports. <br><br>  Première fenêtre d'exécution: <br><br><img src="https://habrastorage.org/webt/5n/jn/wx/5njnwxghrgvkrq9yjjxkouggsua.jpeg"><br><br>  Créez un projet: <br><br><img src="https://habrastorage.org/webt/lo/dr/qv/lodrqvlrldvd9xihb8zaqwekjeq.jpeg"><br><br>  Sélectionnez un dossier pour le projet.  Dossier, car le projet doit être vide! <br><br><img src="https://habrastorage.org/webt/eo/tr/2s/eotr2seugfw0avhcxmcndtpee10.jpeg"><br><br><img src="https://habrastorage.org/webt/qb/1z/t8/qb1zt8kk5zjv8jc4yiyhimcz2qc.jpeg"><br><br><img src="https://habrastorage.org/webt/sm/pn/xb/smpnxb-emshy7udwbo2sbpmqums.jpeg"><br><br><h3>  Le premier programme - "bonjour" pour le microcontrôleur </h3><br>  Nous clignotons la LED qui se trouve sur la «pilule bleue».  Cette LED est connectée au port PC13. <br><br>  Ajouter une ligne à la table des variables <br><br><img src="https://habrastorage.org/webt/m9/lq/te/m9lqtesqbqvk4o6kwyxod4ggdcy.jpeg"><br><br><img src="https://habrastorage.org/webt/nw/n-/90/nwn-90xwcb4o5vmmptxcigg62t0.jpeg"><br><br>  Générer du code BSP (bouton F8) <br><br><img src="https://habrastorage.org/webt/xq/g0/2b/xqg02b2-mticafa2p5rhrxqk6zk.jpeg"><br><br>  De plus, chaque fois après un changement de projet, la génération de BSP est requise! <br><br>  Ouvrez le projet créé dans l'environnement de développement d'EmBitz ou Keil.  EmBitz est toujours une solution de contournement.  Il semble que l'auteur ait abandonné ce projet.  Très probablement à l'avenir, le projet utilisera Code :: Blocks. <br><br>  Dans le fichier main.c, écrivez ce qui suit: <br><br><img src="https://habrastorage.org/webt/xo/8q/8_/xo8q8_n85hbj-4ykrjc7am3eq0e.jpeg"><br>  <i>(Pour augmenter la taille de l'image, ouvrez-la dans un nouvel onglet)</i> <br><br>  Dans EmBitz, appuyez sur F2, après l'apparition de la fenêtre d'informations, appuyez sur F7.  La compilation doit être faite. <br><br>  Appuyez à nouveau sur F2 pour masquer les signets d'informations. <br><br><img src="https://habrastorage.org/webt/kh/ba/ca/khbaca7tie6wd77h8eblau1r_he.jpeg"><br><br>  Téléchargez sur le microcontrôleur, voyez comment cela fonctionne. <br><br><h3>  Bouton </h3><br>  Ajoutez un bouton, par exemple ceci: <br><br><img src="https://habrastorage.org/webt/4r/ka/jo/4rkajoaqqvrg1axdbg7xbkuseo8.jpeg"><br><br>  Schéma de câblage: <br><br><img src="https://habrastorage.org/webt/r6/dh/nz/r6dhnzxdasck_-f0jbdvdykdpow.jpeg"><br><br>  Ajoutez une variable à la table: <br><br><img src="https://habrastorage.org/webt/g5/jb/o7/g5jbo7sxovbdjuttlxhugp5-q8m.jpeg"><br><br>  Nous générons BSP. <br><br>  Modifiez le programme comme suit: <br><br><img src="https://habrastorage.org/webt/e-/2y/xm/e-2yxmvestebzsnczhv4yplgl-i.jpeg"><br><br>  Nous créons un nouveau BSP (F8), le compilons, le chargeons dans le microcontrôleur. <br><br>  Nous appuyons sur le bouton - la LED s'allume, relâchez - elle s'éteint. <br><br>  Au lieu d'une LED, un relais peut être connecté à un autre port, par exemple: <br><br><img src="https://habrastorage.org/webt/n6/vo/zd/n6vozderwmz30oa6poco81scyby.jpeg"><br><br>  Et gérer une sorte de charge utile. <br><br><h3>  Messages de sortie vers la console </h3><br>  Vous devez déterminer quelle sera la console. <br><br>  Les options sont les suivantes: <br><br><ul><li>  Adaptateur USB-UART </li><li>  port COM virtuel (câble micro-USB) </li></ul><br>  Si UART1 et USB en tant que console sont sélectionnés dans la configuration et que USB VCP n'est pas sélectionné, la console sera affectée à nulle part.  C'est-à-dire  il n'y aura pas de serment sur la fonction print_str (ou la macro d'impression), mais il n'y aura pas non plus de sortie.  Le même comportement sera si vous ne sélectionnez aucune interface, ou sélectionnez USB VCP mais ne sélectionnez ni UART1 ni USB comme console. <br><br>  Configuration de la console: <br><br><img src="https://habrastorage.org/webt/y9/qg/ts/y9qgtsdjms0dvksn2oy0g6kjkbm.jpeg"><br><br>  Connectez TettaTerm au port COM (console).  Si nous téléchargeons le firmware via UART1, n'oubliez pas de déconnecter / connecter le port COM.  Dans TerraTerm "boutons chauds" Alt + I;  Alt + N Ceci n'est pas requis pour l'option de démarrage via ST-Link. <br><br>  Modifiez le programme: <br><br><img src="https://habrastorage.org/webt/jd/vz/dv/jdvzdv3ysbtb_mw5ljqfhinoubq.jpeg"><br><br>  Maintenant, l'état du bouton sera affiché sur la console: <br><br><img src="https://habrastorage.org/webt/ni/ni/jd/ninijd5kgzqc5d7fepqkumdg4fs.jpeg"><br><br><h3>  DS18B20 </h3><br>  Connectez le capteur de température DS18B20 à la «tablette». <br><br><img src="https://habrastorage.org/webt/nx/6g/j0/nx6gj0jicce7mzwi4tcq9gjh15s.jpeg"><br><br>  Mettez la variable dans le tableau: <br><br><img src="https://habrastorage.org/webt/di/h5/un/dih5unsvycncq2dlpeuyyzcedxm.jpeg"><br><br>  Modifiez le programme comme suit: <br><br><img src="https://habrastorage.org/webt/vf/9x/nv/vf9xnvbxydmf9yjv9prbiu3fet0.jpeg"><br><br>  Nous créons une nouvelle configuration, la compilons, la chargeons dans le microcontrôleur. <br><br>  La console affichera la température mesurée par le capteur. <br><br><img src="https://habrastorage.org/webt/8q/bp/va/8qbpva-pp3sshfv601v3mhwgaao.jpeg"><br><br><h3>  ADC </h3><br>  Comme exemple de travail avec l'ADC, vous pouvez utiliser le potentiomètre: <br><br><img src="https://habrastorage.org/webt/ui/wv/18/uiwv18tudkf-usapa7dnxugzblo.jpeg"><br><br>  Ou capteur d'humidité du sol <br><br><img src="https://habrastorage.org/webt/zi/yr/b9/ziyrb9if07uzocowtawvuh_piua.jpeg"><br><br>  Arrêtons-nous sur le dernier: <br><br>  Configurez le port: <br><br><img src="https://habrastorage.org/webt/uc/uq/rh/ucuqrhsqpjsu3gc7uoed5igu3xq.jpeg"><br><br>  Modification du programme: <br><br><img src="https://habrastorage.org/webt/ds/qz/6x/dsqz6xdakkh6brl7fmus3jybjrq.jpeg"><br><br>  Nous compilons, chargeons. <br><br>  Dans la console, nous observons: <br><br><img src="https://habrastorage.org/webt/z5/ch/2d/z5ch2dfitfph2j44d61tgfunwim.jpeg"><br><br>  adc - lecture ADC actuelle.  max et min - relevés minimum et maximum enregistrés du capteur, complètement secs (0%) et très humides (100%). <br><br>  Très humide (100%) - placez le capteur dans un verre d'eau.  Très sec (0%) - réside en plein air. <br><br>  En fait, nous avons calibré le capteur d'humidité du sol de 0 à 100%.  Nous plaçons les valeurs maximales et minimales dans le texte du programme. <br><br><img src="https://habrastorage.org/webt/ie/ra/w_/ieraw_hmrfqtonarnunsy1qm2a8.jpeg"><br><br>  Le résultat du travail.  Le capteur est placé dans le sol du pot de fleur: <br><br><img src="https://habrastorage.org/webt/5w/gy/ls/5wgylsgq8ilhkkderxlso_udjja.jpeg"><br><br>  Ce projet est un modèle de solution pour l'arrosage des plantes. <br><br>  C'est tout pour l'instant.  Le programme MIOC sera réapprovisionné avec des fonctionnalités supplémentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466663/">https://habr.com/ru/post/fr466663/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466651/index.html">Choisir entre XML et SQL pour lancer des scripts LiquiBase en utilisant Java / Spring / H2 comme exemple</a></li>
<li><a href="../fr466653/index.html">Débogage de jeux pour NES: comment ça se passe aujourd'hui</a></li>
<li><a href="../fr466657/index.html">Détail dynamique: jeux cachés du compilateur, fuite de mémoire, nuances de performances</a></li>
<li><a href="../fr466659/index.html">Examen de Kubecost pour économiser de l'argent sur Kubernetes dans les nuages</a></li>
<li><a href="../fr466661/index.html">Master à distance à l'étranger: notes avant la thèse</a></li>
<li><a href="../fr466665/index.html">Débordement CSS et perte de données</a></li>
<li><a href="../fr466667/index.html">Le condensé de matières fraîches du monde du front-end de la dernière semaine n ° 379 (2 - 8 septembre 2019)</a></li>
<li><a href="../fr466669/index.html">Tesla développe des batteries capables de parcourir 1,6 million de kilomètres sans remplacement</a></li>
<li><a href="../fr466671/index.html">PHP Digest n ° 164 (27 août - 9 septembre 2019)</a></li>
<li><a href="../fr466673/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 46. Vérification des performances OSPF</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>