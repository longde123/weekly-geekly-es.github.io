<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌦️ 👩🏻‍🚀 ❎ 使用Spring平台时最常见的10个错误。 第一部分 👩🏽‍🎨 👨‍👩‍👧 📒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大家好 今天，我们分享了文章的第一部分，该文章的翻译是专门为“ Spring Framework开发人员 ”课程的学生准备的。 让我们开始吧！ 




 Spring可能是最受欢迎的Java开发平台之一。 这是一个功能强大但很难学习的工具。 它的基本概念相当容易理解和学习，但是要成为一名经验丰富的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用Spring平台时最常见的10个错误。 第一部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/464429/">  <i>大家好</i>  <i>今天，我们分享了文章的第一部分，该文章的翻译是专门为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ Spring Framework开发人员</a> ”课程的学生准备的。</i>  <i>让我们开始吧！</i> <br><br><img src="https://habrastorage.org/webt/sp/gg/np/spggnpu1e19b9c_yb66nbynmbqq.png"><br><br><hr><br>  Spring可能是最受欢迎的Java开发平台之一。 这是一个功能强大但很难学习的工具。 它的基本概念相当容易理解和学习，但是要成为一名经验丰富的Spring开发人员需要花费时间和精力。 <br><br> 在本文中，我们将介绍在Spring中工作时犯的一些最常见的错误，尤其是与Web应用程序的开发和Spring Boot平台的使用有关的错误。 如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Spring Boot网站</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">所述</a> ，Spring Boot采用<i>标准化的</i>方法来创建现成的应用程序，本文将沿用这种方法。 它将提供许多建议，这些建议可以有效地用于基于Spring Boot的标准Web应用程序的开发中。 <a name="habracut"></a><br><br> 如果您对Spring Boot平台不是很熟悉，但想尝试本文中的示例，那么我创建了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub存储库，其中包含本文的其他材料</a> 。 如果您在阅读本文时有些困惑，我建议您创建此存储库的副本并在计算机上尝试代码。 <br><br><h2> 常见错误＃1：编程太底层 </h2><br> 我们很容易屈服于这个普遍存在的错误，因为在编程环境中， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“拒绝别人的发展综合征”是</a>非常典型的。 其症状之一是经常重写一些常用的代码，这是许多程序员都看到的一种症状。 <br> 研究特定库的内部结构和实现功能通常是一个有用，必要和有趣的过程，但是如果您在执行功能的低级实现时不断编写相同类型的代码，那么对于软件开发人员来说可能对您有害。 这就是为什么存在和使用诸如Spring之类的抽象和平台的原因-它们使您免于重复的手工工作，并让您可以在更高层次上专注于主题领域的对象和程序代码逻辑。 <br><br> 因此，不应避免抽象。 下次遇到需要解决特定问题的需求时，请先进行快速搜索，并找出解决问题的库是否已内置在Spring中-您可能会找到合适的交钥匙解决方案。 这样的一个有用的库就是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Project Lombok</a> ，我将在本文的示例中使用这些注释。  Lombok被用作模板代码生成器，因此生活在我们每个人中的懒惰开发人员将非常高兴结识该库。 例如，请参阅<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">标准JavaBean组件</a>在Lombok中的外观： <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-meta"><span class="hljs-meta">@Setter</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; String secondBeanProperty; }</code> </pre> <br> 您可能已经理解，以上代码将转换为以下形式： <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bean</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstBeanProperty; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String secondBeanProperty; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFirstBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> firstBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstBeanProperty = firstBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSecondBeanProperty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String secondBeanProperty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondBeanProperty = secondBeanProperty; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bean</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br> 请注意，如果要在集成开发环境中使用Lombok，则很可能必须安装适当的插件。 可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到用于IntelliJ IDEA的此插件的版本。 <br><br><h2> 常见错误2。内部结构“泄漏” </h2><br> 允许访问内部结构从来都不是一个好主意，因为它会削弱服务模型的灵活性，并因此导致不良的编程风格的形成。 内部结构的“泄漏”表现在以下事实：从某些API端点可以访问数据库结构。 例如，假设下面的“良好的旧Java对象”（POJO）代表数据库中的一个表： <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TopTalentEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } }</code> </pre> <br> 假设有一个端点需要访问<code>TopTalentEntity</code>对象的数据。 返回<code>TopTalentEntity</code>实例似乎是一个诱人的主意，但更灵活的解决方案是创建一个新类来表示API端点的TopTalentEntity数据： <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@NoArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; }</code> </pre> <br> 因此，对数据库的内部组件进行更改将不需要在服务级别进行其他更改。 让我们看看如果将密码字段添加到<code>TopTalentEntity</code>类以将用户密码哈希存储在数据库中会发生什么：如果没有诸如<code>TopTalentData</code>连接器，并且开发人员忘记更改服务的接口部分，这会导致非常不希望的秘密信息泄露！ <br><br><h2> 常见错误编号3。合并一些功能，这些功能最好在代码中进行分配 </h2><br> 随着应用代码的增长来组织它变得越来越重要。 奇怪的是，当达到一定程度的开发规模时，尤其是在尚未深思熟虑的应用程序体系结构的情况下，大多数有效编程的原理都将停止工作。 最常见的错误之一是代码中更合理地单独实现的功能组合。 <br><br> 违反<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">职责分离</a>原则的原因通常是在现有类中添加新功能。 也许这是一个很好的瞬时解决方案（特别是，它需要编写少量的代码），但是在将来，它将不可避免地成为一个问题，包括在测试和维护代码以及它们之间的阶段。 考虑以下从存储库返回<code>TopTalentData</code>控制器： <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::entityToData) .collect(Collectors.toList()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">entityToData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br> 乍一看，此代码片段似乎没有明显的错误。 它提供了一个<code>TopTalentData</code>对象的列表，该列表取自<code>TopTalentEntity</code>类的实例。 但是，如果您仔细看一下代码，我们会发现实际上<code>TopTalentController</code>在这里执行了几个操作，即，它将请求与特定端点相关联，从存储库中检索数据，并将从<code>TopTalentRepository</code>接收到的对象转换为<code>TopTalentRepository</code>一种格式。 较干净的解决方案应将这些功能分为不同的类。 例如，它可能看起来像这样： <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/toptal"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentService topTalentService; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/get"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentService.getTopTalent(); } } <span class="hljs-meta"><span class="hljs-meta">@AllArgsConstructor</span></span> <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentRepository topTalentRepository; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TopTalentEntityConverter topTalentEntityConverter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;TopTalentData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTopTalent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> topTalentRepository.findAll() .stream() .map(topTalentEntityConverter::toResponse) .collect(Collectors.toList()); } } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TopTalentEntityConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TopTalentData </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TopTalentEntity topTalentEntity)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TopTalentData(topTalentEntity.getName()); } }</code> </pre> <br> 这种层次结构的另一个优点是，它使我们可以通过简单地查看类名来了解函数的位置。 随后，在测试期间，如果需要，我们可以轻松地用代理代码替换任何此类的代码。 <br><br><h2> 常见错误编号4。代码统一且错误处理不善 </h2><br> 代码统一性的主题不是Spring（或Java）所独有的，但是，它是在Spring中处理项目时必须考虑的重要方面。 选择特定的编程样式可能是讨论的主题（通常在开发团队中或整个公司内是一致的），但是在任何情况下，存在用于编写代码的通用标准都有助于提高工作效率。 如果有几个人在编写代码，则尤其如此。 可以在开发人员之间传递统一的代码，而无需花费很多精力来维护它，也不必花很多时间解释为什么需要这些类。 <br><br> 想象有一个Spring项目，其中有各种配置文件，服务和控制器。 在命名它们时遵循语义统一性，我们创建了一个结构，您可以通过该结构轻松地进行搜索，并且任何开发人员都可以在其中轻松地理解代码。 例如，您可以将Config后缀添加到配置类的名称中，将Service后缀添加到服务名称中，并将Controller后缀添加到控制器名称中。 <br><br> 服务器端错误处理与代码统一性密切相关，值得特别注意。 如果您曾经处理过来自写得不好的API的异常，那么您可能知道正确理解这些异常的含义有多困难，甚至更难确定它们真正发生的原因。 <br> 作为API开发人员，理想情况下，您希望涵盖用户正在使用的所有端点，并使其使用一种错误消息格式。 通常，这意味着您需要使用标准错误代码及其说明，并放弃可疑的决定，例如向用户发送“ 500 Internal Server Error”消息或堆栈跟踪的结果（顺便说一句，应尽一切可能避免使用后一种选择，因为这是在泄露内部数据，而且，这种结果很难在客户端进行处理）。 <br> 例如，在这里，错误消息的一般格式如下所示： <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ErrorResponse</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer errorCode; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String errorMessage; }</code> </pre> <br> 在最流行的API中通常会找到与这种格式相似的格式，并且通常可以很好地工作，因为它可以轻松而系统地记录下来。 您可以通过将<code>@ExceptionHandler</code>批注添加到方法中来将异常转换为这种格式（有关批注的示例，请参见“常见错误＃6”部分）。 <br><br><h2> 常见错误编号5。多线程工作不正确 </h2><br> 无论在桌面应用程序还是Web应用程序，Spring项目或其他平台项目中使用多线程，实现多线程都是一项艰巨的任务。 由程序的并行执行引起的问题很难跟踪，并且通常很难用调试器进行处理。 如果您了解正在处理并行执行错误，那么很可能将不得不放弃调试器并手动检查代码，直到找到错误的根本原因为止。 不幸的是，没有解决这些问题的标准方法。 在每种情况下，都有必要评估情况并使用在给定条件下看起来最好的方法“攻击”问题。 <br><br> 理想情况下，当然，您希望完全避免与多线程相关的错误。 尽管这里没有通用的方法，但我仍然可以提供一些实用的建议。 <br><br><h3> 避免使用全局状态 </h3><br> 首先，请始终记住“全局状态”的问题。 如果要开发多线程应用程序，则需要仔细监视绝对所有全局可修改的变量，并在可能的情况下完全消除它们。 如果仍然有理由修改全局变量，请正确<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">同步</a>并监视应用程序的性能-您应确保它不会由于增加的等待时间而变慢。 <br><br><h3> 避免易变的物体 </h3><br> 这个想法直接来自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">函数式编程</a>的原理，并且与OOP的原理相适应，指出应该避免可变的类和可变的状态。 简而言之，这意味着您应该避免设置方法（设置器），并在所有模型类中使用带有final修饰符的私有字段。 它们的值唯一的改变是在创建对象时。 在这种情况下，您可以确保与资源竞争没有任何问题，并且在访问对象的属性时，将始终获得正确的值。 <br><br><h3> 记录重要数据 </h3><br> 评估应用程序中可能出现问题的位置，并预先设置所有重要数据的日志记录。 如果发生错误，您将很高兴获得有关已收到哪些请求的信息，并且您将能够更好地理解应用程序故障的原因。 但是，请记住，日志记录涉及其他文件I / O，因此不应滥用，因为这会对应用程序性能产生不利影响。 <br><br><h3> 使用现成的线程实现 </h3><br> 当您需要产生线程时（例如，创建对各种服务的异步请求），请使用现成的安全线程实现，而不是创建自己的线程。 在大多数情况下，您可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ExecutorService</a>抽象和Java 8出色的功能抽象<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CompletableFuture</a>创建线程，而Spring平台还允许您使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DeferredResult</a>类处理异步请求。 <br><br> 第一部分结束。 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">阅读第二部分。</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN464429/">https://habr.com/ru/post/zh-CN464429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN464413/index.html">PVS-Studio-进步的引擎</a></li>
<li><a href="../zh-CN464415/index.html">用于搜索hh.ru的新提示服务</a></li>
<li><a href="../zh-CN464417/index.html">2019年10种流行的PHP框架</a></li>
<li><a href="../zh-CN464421/index.html">Viber电台-在线Messenger中的所有电台</a></li>
<li><a href="../zh-CN464423/index.html">如何管理时间？ 自由职业者的回应</a></li>
<li><a href="../zh-CN464433/index.html">云移动测试平台</a></li>
<li><a href="../zh-CN464435/index.html">如何避免淹没在技术和方法的海洋中：50位专家的经验</a></li>
<li><a href="../zh-CN464437/index.html">开发团队如何通过创建交通站点来赚取更多收入[实施指南]</a></li>
<li><a href="../zh-CN464443/index.html">Natas网站。 通过CTF平台旨在利用Web漏洞。 第二部分</a></li>
<li><a href="../zh-CN464445/index.html">为什么真的不可能成为素食主义者</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>