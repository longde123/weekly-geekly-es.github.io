<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçõ üåû ü§ò Membangun grafik garis rata-rata bergerak yang bergerak dalam R. Mengambil data melalui NBA API üåú üë©üèº‚Äçü§ù‚Äçüë®üèæ ü§¥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami terus menganalisis data bola basket menggunakan R. 


 Berbeda dengan artikel sebelumnya, yang benar-benar menghibur, grafik yang akan dibangun d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membangun grafik garis rata-rata bergerak yang bergerak dalam R. Mengambil data melalui NBA API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459142/"><p>  Kami terus menganalisis data bola basket menggunakan R. </p><br><p>  Berbeda dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> sebelumnya, yang benar-benar menghibur, grafik yang akan dibangun dalam artikel ini mungkin menarik dari sudut pandang menganalisis permainan tim musim ini. </p><br><p>  Dan kami akan membuat grafik rata-rata bergerak untuk tiga jenis peringkat tim NBA: menyerang, defensif, dan net-rating (yaitu perbedaan antara dua yang pertama).  Singkatnya tentang mereka.  Peringkat menyerang dan bertahan adalah jumlah poin yang dicetak / dilewatkan oleh tim untuk 100 harta.  Peringkat NET - ini adalah perbedaan mereka untuk seratus harta.  Siapa pun yang tertarik untuk mempelajari lebih lanjut tentang mereka dapat membaca glosarium tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">referensi basket</a> .  Ada rumus perhitungan, yang juga saya terapkan menggunakan R, tapi saya belum menerbitkan artikel tentang itu. </p><a name="habracut"></a><br><p>  Saya juga akan menjelaskan mengapa saya akan membuat grafik moving average.  Dalam setiap pertandingan individu, proporsi keacakan terlalu tinggi, indikator melompat dari 70 hingga 150, yang membuat analisis data tidak berguna, dan grafik itu sendiri lebih mirip kardiogram.  Jika kita mengambil rata-rata kumulatif, maka kita mendapatkan ekstrem lain: jadwalnya mirip dengan fluktuasi teredam, dan permainan di akhir musim, ketika mereka ditambahkan ke yang sudah diadakan 70-75 pertandingan, praktis tidak mempengaruhi indikator keseluruhan.  Secara kasar, mereka "tidak terlihat."  Rata-rata bergerak dalam kasus ini adalah jalan keluar dari jalan buntu.  Di satu sisi, pengaruh kesempatan berkurang, di sisi lain, tidak ada akumulasi hasil yang berlebihan.  Dalam statistik bola basket, mereka biasanya melakukan rata-rata bergerak 10 pertandingan. </p><br><h2 id="ispolzuemye-biblioteki">  Perpustakaan digunakan </h2><br><pre><code class="plaintext hljs">library(httr) library(jsonlite) library(tidyverse) library(lubridate) library(zoo) library(ggthemes) library(gganimate)</code> </pre> <br><h2 id="poluchenie-dannyh-s-pomoschyu-nba-api">  Mengambil Data Menggunakan API NBA </h2><br><p>  Terakhir kali, saya mengambil data menggunakan ekstensi <strong>NBA Data Retriever</strong> .  Kali ini saya akan menggunakan NBA API untuk secara langsung memuat data yang diperlukan ke dalam R. </p><br><p>  Pertama, kami mencari tahu dari mana mendapatkan data ini.  Untuk melakukan ini, buka halaman yang kami butuhkan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">stats.nba.com</a> dan buka alat pengembang.  Kemudian buka Network -&gt; XHR dan tekan F5.  Dalam daftar yang muncul, kami menemukan file dengan nama yang mirip dengan nama halaman.  Kami membutuhkannya.  Setelah memastikan bahwa Anda telah memilih file yang benar, salin alamatnya di R. Dalam gambar itu terlihat seperti ini. </p><br><p>  <em>buka file yang diinginkan</em> </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/3ce/6cf/41f/3ce6cf41f2cb07bcd73b757b311c9c80.png"></p><br><p>  <em>file akan terlihat seperti ini</em> </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/7c8/9c4/aca/7c89c4aca8872754cdb2212bdeba85df.png"></p><br><p>  <em>salin ke alamat R.</em> </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a43/06c/c65/a4306cc65e873df80d9501bb329cc3ca.png"></p><br><p>  Sekarang mari kita mulai bekerja di <strong>R Studio</strong> .  Untuk mendapatkan informasi yang kami butuhkan, kami menggunakan fungsi <code>GET</code> dari paket <code>http</code> .  Namun, agar permintaan dieksekusi dengan benar (ini dapat diperiksa oleh fungsi <code>status_code</code> , harus 200), Anda perlu menambahkan header untuk menentukan parameter kerja dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">transaksi HTTP</a> </p><br><pre> <code class="plaintext hljs">##Adding headers request_headers &lt;- c( "accept-encoding" = "gzip, deflate, sdch", "accept-language" = "en-US,en;q=0.8", "cache-control" = "no-cache", "connection" = "keep-alive", "host" = "stats.nba.com", "pragma" = "no-cache", "upgrade-insecure-requests" = "1", "user-agent" = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.9 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9" ) #Getting a response request &lt;- GET(adv_box_team, add_headers(request_headers))</code> </pre> <br><p>  Kami mendapat jawaban seperti ini: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d08/a37/841/d08a378417726a4e7ae4c535dec57836.png"></p><br><p>  Tetapi sementara data yang kita butuhkan tidak terlihat.  Untuk mendapatkannya, pertama-tama kita mengekstrak <code>content</code> permintaan dengan <code>content</code> fungsi ke file json, dan kemudian mengonversinya menjadi daftar dengan fungsi dari paket <code>jsonlite</code> dengan nama pembicaraan <code>fromJSON</code> </p><br><pre> <code class="plaintext hljs">boxscore_data &lt;- fromJSON(content(request, as = "text"))</code> </pre> <br><p>  Akibatnya, kami mendapatkan daftar yang sudah berisi semua informasi yang kami butuhkan dan kemudian kami membawanya ke dalam formulir yang diperlukan untuk pekerjaan. </p><br><h2 id="podgotovka-dannyh">  Persiapan data </h2><br><p>  Untuk melakukan ini, buat tabel data alih-alih daftar, lalu tambahkan tajuk kolom. </p><br><pre> <code class="plaintext hljs">#Convert to tibble data and assigning column names table &lt;- tbl_df(data.frame(boxscore_data$resultSets$rowSet[[1]], stringsAsFactors = FALSE)) names(table) &lt;- toupper(boxscore_data$resultSets$headers[[1]])</code> </pre> <br><p>  <code>toupper</code> adalah fungsi yang menggantikan semua karakter dengan huruf besar.  Setelah itu, kita akan mendapatkan tabel dengan 2460 baris dan 46 kolom.  Pada prinsipnya, Anda dapat bekerja dengan tabel dalam formulir ini, tetapi lebih baik untuk mengecualikan informasi yang tidak perlu, untuk pekerjaan yang lebih nyaman dan cepat. </p><br><pre> <code class="plaintext hljs">##Select the columns you want to analyze rating &lt;- table %&gt;% select(TEAM_ID, TEAM_ABBREVIATION, TEAM_NAME, GAME_ID, GAME_DATE, MATCHUP, WL, E_OFF_RATING, E_DEF_RATING, E_NET_RATING)</code> </pre> <br><p>  Jika Anda melihat tabel sumber, Anda dapat melihat dua jenis peringkat yang sama: "normal" dan dengan awalan E. Tanpa masuk ke detail, E-rating memperhitungkan kecepatan permainan, oleh karena itu lebih akurat.  Kami mengambilnya. </p><br><p>  Selanjutnya, saya ingin menyederhanakan nama-nama peringkat.  Mereka perlu dimasukkan ke dalam argumen fungsi dan lebih baik menggunakan notasi yang lebih akrab bagi berbagai pengguna: ORTG, DRTG, NRTG.  Di sini Anda bisa "bingung" dengan menulis ekspresi reguler dan mengganti dengan <code>str_replace</code> , tetapi menulisnya masih menyenangkan dan di sini kita bisa melakukannya tanpa mereka dengan sempurna.  Kita hanya perlu mengekstrak 3, 7, 9 dan 12 karakter dari nama saat ini, menggabungkannya dan mengganti nama kolom dengan vektor karakter yang dihasilkan.  Semua ini dilakukan dengan menggunakan fungsi-fungsi dari paket <code>str_sub</code> : <code>str_sub</code> dan <code>str_c</code> (analog dari <code>paste0</code> ). </p><br><pre> <code class="plaintext hljs">## Renaming columns with E_OFF_RATING on ORTG rating1 &lt;- rating %&gt;% rename_at(vars(starts_with("E_")), list(~str_c(str_sub(., start = 3, end = 3), str_sub(., start = 7, end = 7), str_sub(., start = 9, end = 9), str_sub(., start = 12, end = 12))))</code> </pre> <br><p>  <strong>di</strong> dalam fungsi paket, <code>dplyr</code> memiliki properti yang sama dengan <code>dt[, lapply(.SD, func), .SDols = col1]</code> dalam paket <code>data.table</code> : aksi diterapkan ke beberapa kolom pada saat yang bersamaan.  Di sini kita memilih semua kolom yang namanya dimulai dengan "E_". </p><br><p>  Sebagai hasilnya, kami mendapatkan tabel seperti itu, yang dengannya kami akan terus bekerja dengan: </p><br><div class="scrollable-table"><table><thead><tr><th>  TEAM_ID </th><th>  TEAM_ABBREVIATION </th><th>  TEAM_NAME </th><th>  GAME_ID </th><th>  GAME_DATE </th><th>  MATCHUP </th><th>  Wl </th><th>  ORTG </th><th>  DRTG </th><th>  NRTG </th></tr></thead><tbody><tr><td>  1610612749 </td><td>  Mil </td><td>  Milwaukee bucks </td><td>  0021801226 </td><td>  2019-04-10T00: 00: 00 </td><td>  MIL vs.  Oke </td><td>  L. </td><td>  102.4 </td><td>  116.8 </td><td>  -14,4 </td></tr><tr><td>  1610612766 </td><td>  Cha </td><td>  Charlotte hornets </td><td>  0021801222 </td><td>  2019-04-10T00: 00: 00 </td><td>  CHA vs.  ORL </td><td>  L. </td><td>  121.4 </td><td>  130.1 </td><td>  -8.6 </td></tr><tr><td>  1610612758 </td><td>  SAC </td><td>  Raja Sacramento </td><td>  0021801230 </td><td>  2019-04-10T00: 00: 00 </td><td>  SAC @ POR </td><td>  L. </td><td>  129.7 </td><td>  136.4 </td><td>  -6.8 </td></tr><tr><td>  1610612748 </td><td>  MIA </td><td>  Miami panas </td><td>  0021801221 </td><td>  2019-04-10T00: 00: 00 </td><td>  MIA @ BKN </td><td>  L. </td><td>  84.2 </td><td>  103.6 </td><td>  -19,4 </td></tr><tr><td>  1610612750 </td><td>  MIN </td><td>  Minnesota woodwolves </td><td>  0021801228 </td><td>  2019-04-10T00: 00: 00 </td><td>  MIN @ DEN </td><td>  L. </td><td>  98.3 </td><td>  103.7 </td><td>  -5.4 </td></tr></tbody></table></div><br><h2 id="funkciya-rolling_offnet_rating_nba-dlya-postroeniya-grafika-i-animacii-skolzyaschego-srednego">  Fungsi <strong><em>rolling_offnet_rating_nba</em></strong> untuk merencanakan dan menghidupkan rata-rata bergerak. </h2><br><p>  Sekali lagi, seperti yang terakhir kali, mari kita buat fungsi untuk membuat perubahan minimal dalam perhitungan. </p><br><p>  Fungsi <code>rolling_offnet_rating_nba</code> seperti ini: </p><br><pre> <code class="plaintext hljs">rolling_offnet_rating_nba &lt;- function(table, name, variable, col1 = col1, col2 = col2)</code> </pre> <br><p>  <strong>tabel</strong> adalah nama tabel data, <br>  <strong>name</strong> - singkatan dari tim yang grafiknya akan dibuat ("BOS", "LAL", dll.). <br>  <strong>variabel</strong> - peringkat yang akan dihitung (di sini ada dua opsi, ORTG atau NRTG, untuk peringkat pelindung saya membuat fungsi terpisah) <br>  <strong>col1</strong> dan <strong>col2</strong> - warna garis pada nilai di atas / di bawah rata-rata. </p><br><p>  Sebagian besar fungsi <code>dplyr</code> menggunakan <em>evaluasi non-standar (NSE</em> ).  Ini adalah istilah umum yang berarti bahwa penilaian mereka berbeda dari penilaian biasa di R. Ini memungkinkan kami untuk menyederhanakan penulisan kode dan bekerja dengan database SQL, tetapi minusnya adalah bahwa kami tidak dapat mengganti nilai dengan objek setara yang didefinisikan di tempat lain. </p><br><p>  <em>Dplyr</em> menggunakan <strong>evaluasi Tidy</strong> .  Oleh karena itu, perlu untuk menggunakan alat khusus (fungsi kutipan, operator !!) untuk menyelesaikan masalah yang dihadapi selama pemrograman.  Anda dapat membaca lebih lanjut tentang ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , dan lihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><p>  Kode berikut mengambil nama argumen fungsi dan menulis ekspresi yang disajikan kepadanya.  (Untuk memahami bagaimana <code>enquo</code> dan sejenisnya, berguna untuk mencetak output dari fungsi ini) </p><br><pre> <code class="plaintext hljs">##Return the entered value in the function argument in the type quosure quo_rating &lt;- enquo(variable) quo_col1 &lt;- enquo(col1) quo_col2 &lt;- enquo(col2)</code> </pre> <br><p>  Selanjutnya, kami mengubah format data dari beberapa kolom: kami membuat <strong>GAME_DATE</strong> karakter menjadi kolom dalam format Tanggal, dan kami membuat kolom rating numerik.  Karena  kita menerapkan fungsi <code>as.numeric</code> ke tiga kolom, kemudian <code>mutate_at</code> digunakan alih-alih <code>mutate</code> .  Dan kami mengurutkan semuanya dalam urutan tanggal yang naik. </p><br><pre> <code class="plaintext hljs">##Changing the data type of multiple columns test1 &lt;- table %&gt;% mutate(GAME_DATE = as.Date(ymd_hms(GAME_DATE))) %&gt;% mutate_at(vars(ORTG:NRTG), list(~as.numeric)) %&gt;% arrange(GAME_DATE)</code> </pre> <br><p>  Dan kemudian kita menghitung rata-rata bergerak 10 pertandingan dari tim yang kita butuhkan.  Untuk melakukan ini, gunakan fungsi <code>rollmeanr</code> dari paket <code>zoo</code> .  r pada akhir nama berarti bahwa hasilnya harus lurus.  Untuk sembilan pertandingan pertama musim ini, rata-rata bergerak 10 pertandingan sama sekali tidak mungkin untuk dihitung, jadi kami membiarkan bidang ini tidak berubah dengan mengisinya dalam NA menggunakan argumen fill.  <code>na.omit</code> menghapus dari tabel baris di mana NA ini terjadi. </p><br><pre> <code class="plaintext hljs">##The calculation of the moving average team &lt;- test1 %&gt;% filter(TEAM_ABBREVIATION == "DAL") %&gt;% mutate(RATING = rollmeanr(ORTG, k = 10, fill= NA)) %&gt;% na.omit(test1)</code> </pre> <br><p>  Tabel tim terlihat seperti ini: </p><br><div class="scrollable-table"><table><thead><tr><th>  TEAM_ID </th><th>  TEAM_ABBREVIATION </th><th>  TEAM_NAME </th><th>  GAME_ID </th><th>  GAME_DATE </th><th>  MATCHUP </th><th>  Wl </th><th>  ORTG </th><th>  DRTG </th><th>  NRTG </th><th>  Peringkat </th></tr></thead><tbody><tr><td>  1610612742 </td><td>  DAL </td><td>  Dallas mavericks </td><td>  0021800150 </td><td>  2018-11-06 </td><td>  DAL vs.  Apakah </td><td>  W </td><td>  116.8 </td><td>  99.2 </td><td>  17.6 </td><td>  105.51 </td></tr><tr><td>  1610612742 </td><td>  DAL </td><td>  Dallas mavericks </td><td>  0021800160 </td><td>  2018-11-07 </td><td>  DAL @ UTA </td><td>  L. </td><td>  98.5 </td><td>  112.0 </td><td>  -13.6 </td><td>  104,92 </td></tr><tr><td>  1610612742 </td><td>  DAL </td><td>  Dallas mavericks </td><td>  0021800181 </td><td>  2018-11-10 </td><td>  DAL vs.  Oke </td><td>  W </td><td>  115.0 </td><td>  101.1 </td><td>  13.9 </td><td>  104.13 </td></tr><tr><td>  1610612742 </td><td>  DAL </td><td>  Dallas mavericks </td><td>  0021800193 </td><td>  2018-11-12 </td><td>  DAL @ CHI </td><td>  W </td><td>  98.3 </td><td>  91.0 </td><td>  7.3 </td><td>  103.03 </td></tr><tr><td>  1610612742 </td><td>  DAL </td><td>  Dallas mavericks </td><td>  0021800210 </td><td>  2018-11-14 </td><td>  DAL vs.  UTA </td><td>  W </td><td>  117.3 </td><td>  65.8 </td><td>  51.6 </td><td>  105.34 </td></tr></tbody></table></div><br><p>  Pada prinsipnya, kami telah menerima informasi yang kami butuhkan.  Dengan menggunakan dua baris kode, Anda dapat membuat grafik garis.  Tetapi garis hitam pada latar belakang putih tidak begitu menarik dari sudut pandang estetika dan informatif.  Bagian selanjutnya dari "tubuh fungsi" mengoreksi ini. </p><br><p>  Untuk mulai dengan, kami menambahkan data pada nilai rata-rata, 10 dan 21 (kesepuluh dari bawah), serta tanggal 10 pertandingan tim (mis., Yang pertama yang dihitung rata-rata bergeraknya dan yang tersisa di tabel tim setelah menghapus garis dari NA) . </p><br><pre> <code class="plaintext hljs">##The average, 10 and 21 ratings in the entire League. average &lt;- league %&gt;% mutate(average = mean(!! quo_rating)) %&gt;% select(average) %&gt;% unique() %&gt;% .$average top10 &lt;- league %&gt;% arrange(desc(!! quo_rating)) %&gt;% select(!! quo_rating) %&gt;% slice(10) top10 &lt;- top10[[1]] bottom10 &lt;- league %&gt;% arrange(desc(!! quo_rating)) %&gt;% select(!! quo_rating) %&gt;% slice(21) bottom10 &lt;- bottom10[[1]] ##Getting the date of the first rollaverage data &lt;- team %&gt;% select(GAME_DATE) %&gt;% arrange(GAME_DATE) data &lt;- data[[1,1]]</code> </pre> <br><p>  Dari fungsi yang sebelumnya tidak digunakan, fungsi <code>slice</code> muncul di sini, yang memilih baris dengan nomor seri mereka. </p><br><p>  Selanjutnya, kami memilih 2 warna dan namanya.  Data, seperti terakhir kali, <code>table_color</code> dari <code>table_color</code> tabel.  Nama akan digunakan dalam judul bagan untuk menjelaskan warna mana yang sesuai dengan nilai di bawah rata-rata, dan mana yang lebih tinggi. </p><br><pre> <code class="plaintext hljs">##Getting color and color_name selected color color1 &lt;- table_color %&gt;% filter(TEAM_ABBREVIATION == name) %&gt;% select(!! quo_col1) color1 &lt;- color1[[1]] color2 &lt;- table_color %&gt;% filter(TEAM_ABBREVIATION == name) %&gt;% select(!! quo_col2) color2 &lt;- color2[[1]] name1 &lt;- paste0("name_", quo_name(quo_col1)) name2 &lt;- paste0("name_", quo_name(quo_col2)) name_color1 &lt;- table_color %&gt;% filter(TEAM_ABBREVIATION == name) %&gt;% select(name1) name_color1 &lt;- name_color1[[1]] name_color2 &lt;- table_color %&gt;% filter(TEAM_ABBREVIATION == name) %&gt;% select(name2) name_color2 &lt;- name_color2[[1]]</code> </pre> <br><p>  Argumen fungsi default ke col1 dan col2, ini adalah warna pertama dan kedua dari perintah.  Dalam kebanyakan kasus (lebih tepatnya dalam 26), nilai-nilai ini tidak perlu diubah, namun, untuk empat tim, warna berikut harus digunakan dalam palet warna mereka.  Di Dallas dan Minnesota, warna pertama dan kedua terlalu mirip, sedangkan di Milwaukee dan Brooklyn mereka tidak terlihat pada latar belakang putih.  Baik itu, dan yang lain menyulitkan pembacaan jadwal karena itu layak menggunakan argumen col2 = col3 untuk mereka. </p><br><p>  Selanjutnya kita mendapatkan peringkat maksimum untuk tim.  Kami akan membutuhkan nilai ini untuk mengatur teks dengan nilai peringkat pada grafik.  Saya ingin memperhatikan baris kode terakhir.  Kebetulan bahwa fungsi sempurna merencanakan grafik di 89 dari 90 kasus, tetapi ketika membangun peringkat pelindung, Milwaukee memberikan kesalahan.  Ternyata nilai nilai maksimum di Milwaukee dicapai dua kali dan <code>ggplot2</code> secara alami mulai bersumpah bahwa estetika seharusnya, dalam kasus kami, baik 1 atau 73. Oleh karena itu, kami memerlukan nilai peringkat maksimum tunggal. </p><br><pre> <code class="plaintext hljs">##The maximum value of the rating max &lt;- team %&gt;% filter(RATING == max(RATING)) %&gt;% select(RATING) max &lt;- max[[1]]</code> </pre> <br><h2 id="postroenie-statichnogo-grafika-v-ggplot2">  Membangun grafik statis di <code>ggplot2</code> </h2><br><pre> <code class="plaintext hljs">##Building and save a static chart Sys.setlocale("LC_ALL", "C") gg &lt;- ggplot(team, aes(GAME_DATE, RATING)) + geom_hline(yintercept = c(top10, bottom10), col = c("red", "blue")) + annotate(geom = "text", x = as.Date(data) + 2, y = top10 - 0.2, label = "TOP 10", col = "red") + annotate(geom = "text", x = as.Date(data) + 2, y = bottom10 + 0.2, label = "BOTTOM 10", col = "blue") + geom_line(size = 2, col = if_else(team$RATING &gt; average, color1, color2)) + theme_tufte() + labs(title = paste0(team$TEAM_NAME, " 10-Game Rolling ", quo_name(quo_rating)), subtitle = paste0(paste0(name_color1, " - above average ", quo_name(quo_rating)), "\n", paste0(name_color2, " - below average ", quo_name(quo_rating))), caption = "Source: BBall Index Data &amp; Tools\nTelegram: @NBAatlantic, twitter: @vshufinskiy") theme(plot.title = element_text(size = 12, hjust = 0.5), plot.caption = element_text(size = 10), plot.subtitle = element_text(size = 9)) ggsave(paste0(unique(team$TEAM_NAME), quo_name(quo_rating), ".jpeg"), gg, width = 8, units = "in")</code> </pre> <br><p>  Dari yang baru di sini, penggunaan fungsi <code>if_else</code> untuk mengubah warna garis tergantung pada apakah peringkat rata-rata Liga lebih tinggi atau lebih rendah, serta baris pertama yang mengubah lokal.  Ini dilakukan agar singkatan untuk nama bulan di sepanjang sumbu X ditulis dalam bahasa Inggris. <br><img src="https://habrastorage.org/webt/3b/yv/la/3byvlasu52uwfin6f8prdwipms0.jpeg"></p><br><h2 id="postroenie-animacii-10-matchevogo-skolzyaschego-srednego">  Animasi rata-rata bergerak 10 pertandingan. </h2><br><p>  Dalam pembuatan animasi, saya menambahkan beberapa lotion yang tidak mungkin pada versi statis.  Pertama, tanggal perubahan (mirip dengan bagaimana tahun berubah di artikel terakhir), serta nilai peringkat pada titik waktu tertentu.  Itu juga berubah warna tergantung pada apakah itu di atas atau di bawah rata-rata. </p><br><pre> <code class="plaintext hljs">##Building animations anim &lt;- gg + theme(plot.title = element_text(hjust = 0.5, size = 25), plot.subtitle = element_text(size = 15), plot.caption = element_text(size = 15), axis.text = element_text(size = 15), axis.title = element_text(size = 18)) + geom_text(aes(x = as.Date(data), y = max + 0.5), label = paste0(quo_name(quo_rating)," ", round(team$RATING, digits = 1)), size = 6, col = if_else(team$RATING &gt; average, color1, color2)) + transition_reveal(GAME_DATE) + labs(title = paste0(team$TEAM_NAME, " 10-Game Rolling ", quo_name(quo_rating)), subtitle = paste0(paste0(name_color1, " - above average ",quo_name(quo_rating)), "\n", paste0(name_color2, " - below average ",quo_name(quo_rating)), "\n", "Date: {frame_along}"), caption = paste0("Source: stats.nba.com\nTelegram: @NBAatlantic, twitter: @vshufinskiy"))</code> </pre> <br><h2 id="rezultat">  Hasil </h2><br><p><img src="https://habrastorage.org/webt/do/b-/hy/dob-hyqopjihkywk9kaq4jsrihg.gif"></p><br><p>  Pada grafik, sangat jelas bahwa Dallas merosot di paruh kedua Februari-Maret.  Penjelasan untuk ini sangat sederhana: pada titik ini di musim itulah Mavericks bertukar 4 dari 5 pemain dalam lima awal mereka, dan aset masuk utama, Latvian Kristaps Porzingis, tidak bermain selama satu menit karena pecahnya ligamen berhamburan. </p><br><p>  Di sini saya tidak akan menyelidiki komponen olahraga, jadi jika ada yang tertarik untuk melihat 89 grafik yang tersisa dari musim 2018-19, maka Anda dipersilakan untuk blog saya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sports.ru</a> , di mana saya berencana untuk menulis artikel dengan ikhtisar yang paling menarik dari mereka atau di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Telegram</a> saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran</a> tentang NBA, di mana saya akan memposting semuanya. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Repositori GitHub</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id459142/">https://habr.com/ru/post/id459142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id459130/index.html">Penanganan kesalahan yang lembut di layanan microser</a></li>
<li><a href="../id459134/index.html">Pengalaman menggunakan BDD</a></li>
<li><a href="../id459136/index.html">Pil Biru Palsu</a></li>
<li><a href="../id459138/index.html">Bagaimana kunci rahasia Huawei masuk ke firmware router Cisco</a></li>
<li><a href="../id459140/index.html">Penempatan implan: bagaimana hal ini dilakukan?</a></li>
<li><a href="../id459144/index.html">Frontend Weekly Digest (1 - 7 Juli 2019)</a></li>
<li><a href="../id459146/index.html">Intisari Desain Makanan Juni 2019</a></li>
<li><a href="../id459150/index.html">Intisari bahan-bahan segar dari dunia front-end untuk minggu terakhir No. 372 (1 - 7 Juli 2019)</a></li>
<li><a href="../id459152/index.html">Isi dokumen dalam Microsoft Word menggunakan Python. Bagian 2</a></li>
<li><a href="../id459154/index.html">Jaringan untuk usaha kecil menggunakan peralatan Cisco. Bagian 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>