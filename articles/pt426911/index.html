<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöñ üà∫ üò™ GreyEnergy: Sucessor do BlackEnergy ataca empresas do setor de energia üöÆ üë®üèæ‚Äçüéì üíò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os especialistas da ESET realizaram uma an√°lise de malware complexo que n√£o havia sido estudado antes, projetado para ataques direcionados a empresas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GreyEnergy: Sucessor do BlackEnergy ataca empresas do setor de energia</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/426911/">  Os especialistas da ESET realizaram uma an√°lise de malware complexo que n√£o havia sido estudado antes, projetado para ataques direcionados a empresas de infraestrutura cr√≠tica na Europa Central e Oriental.  O programa, chamado GreyEnergy, tem uma semelhan√ßa conceitual com o BlackEnergy, um malware que foi usado em ataques a empresas de energia ucranianas em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dezembro de 2015</a> .  Al√©m disso, existem links indicando que os operadores da GreyEnergy trabalharam com o grupo TeleBots por tr√°s de v√°rios ataques destrutivos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/d5/8-/dvd58-ginvoshns9sbcaupqnvzy.jpeg"></div><br>  O relat√≥rio fornece informa√ß√µes sobre as atividades do Grupo GreyEnergy nos √∫ltimos anos.  Observe que n√£o atribu√≠mos ataques e desenvolvimento de malware a nenhum estado.  De acordo com nossa terminologia, "grupo ART" √© um conjunto de indicadores t√©cnicos. <br><a name="habracut"></a><br><h2>  1. Introdu√ß√£o </h2><br>  Em dezembro de 2015, o grupo BlackEnergy atacou o complexo energ√©tico ucraniano usando malware das fam√≠lias BlackEnergy e KillDisk.  Este foi o √∫ltimo incidente conhecido com o software BlackEnergy em condi√ß√µes reais.  Ap√≥s esse ataque, o grupo se transformou em pelo menos dois subgrupos: TeleBots e GreyEnergy. <br><br>  A TeleBots √© especializada em sabotagem cibern√©tica por meio de ataques de computador em rede (CNA).  O grupo contou ataques destrutivos, incluindo: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma s√©rie de ataques</a> usando a vers√£o atualizada do KillDisk para Windows e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linux</a> em dezembro de 2016; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Epidemia de NotPetya</a> em junho de 2017, implementada com a ajuda de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">backdoor</a> complexo implementado com a ajuda do software de contabilidade MEDoc; </li><li>  ataque usando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">codificador BadRabbit</a> em outubro de 2017. </li></ul><br>  Os especialistas da ESET monitoram a atividade do grupo GreyEnergy h√° v√°rios anos.  O grupo usa a fam√≠lia exclusiva de malware com o mesmo nome.  A arquitetura Malvari se assemelha √† fam√≠lia BlackEnergy. <br><br>  Al√©m das semelhan√ßas conceituais dos programas, h√° outros links indicando que os operadores da GreyEnergy trabalham em estreita colabora√ß√£o com o grupo TeleBots.  Em particular, em dezembro de 2016, o grupo GreyEnergy lan√ßou um worm semelhante ao NotPetya, e uma vers√£o mais avan√ßada desse programa apareceu em junho de 2017 em um ataque do TeleBots. <br><br>  Vale ressaltar que o GreyEnergy e o TeleBots t√™m objetivos diferentes - o GreyEnergy est√° interessado principalmente em redes industriais pertencentes a empresas de infraestrutura cr√≠tica e, diferentemente do TeleBots, n√£o se limita a objetos na Ucr√¢nia. <br><br>  No final de 2015, notamos o malware GreyEnergy voltado para uma empresa de energia na Pol√¥nia.  No entanto, a GreyEnergy tamb√©m ataca alvos ucranianos.  O grupo se concentra no setor de energia, infraestrutura de transporte e outras instala√ß√µes de alto n√≠vel.  Pelo menos uma organiza√ß√£o alvo do BlackEnergy foi atacada pelo GreyEnergy.  O √∫ltimo uso do GreyEnergy foi registrado em meados de 2018. <br><br>  O programa malicioso GreyEnergy possui uma arquitetura modular; no entanto, ao contr√°rio do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Industroyer</a> , n√£o vimos nenhum m√≥dulo que pudesse afetar o ICS (Industrial Control Systems).  No entanto, os operadores GreyEnergy implantaram uma v√≠bora no disco pelo menos uma vez para interromper os fluxos de trabalho e ocultar tra√ßos de um ataque cibern√©tico. <br><br>  Um dos detalhes mais interessantes encontrados durante nossa pesquisa √© que uma das amostras da GreyEnergy foi assinada com um certificado digital v√°lido.  Muito provavelmente, este certificado foi roubado de um fabricante taiwan√™s de equipamentos ICS.  Nesse sentido, o grupo GreyEnergy seguiu os passos dos autores do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Stuxnet</a> . <br><br><h2>  GreyEnergy: m√©todo de trabalho </h2><br>  Durante as observa√ß√µes da atividade do grupo GreyEnergy, vimos principalmente dois vetores de infec√ß√£o inicial.  O primeiro diz respeito a organiza√ß√µes com servi√ßos da web localizados nos pr√≥prios servidores das v√≠timas.  Se o servi√ßo p√∫blico da Web estiver sendo executado em um servidor conectado √† rede interna, os invasores tentar√£o compromet√™-lo a penetrar na rede.  O segundo vetor √© o phishing direcionado com anexos de email maliciosos. <br><br>  Documentos maliciosos descartam o GreyEnergy mini - um backdoor leve do primeiro est√°gio que n√£o requer privil√©gios administrativos.  Depois que um computador √© comprometido usando o GreyEnergy mini, os atacantes criam um mapa de rede e coletam senhas para obter direitos de administrador de dom√≠nio.  Com esses privil√©gios, os invasores podem controlar toda a rede.  O grupo GreyEnergy usa ferramentas bastante padr√£o para realizar estas tarefas: Nmap e Mimikatz. <br><br>  Ap√≥s uma explora√ß√£o inicial da rede, os atacantes podem implantar um backdoor principal - o principal GreyEnergy.  O software malicioso requer direitos de administrador, que devem ser obtidos antes da fase de implanta√ß√£o do GreyEnergy principal.  De acordo com nossa pesquisa, os operadores GreyEnergy instalam o backdoor principal principalmente em dois tipos de terminais: servidores de longa dura√ß√£o e esta√ß√µes de trabalho usadas para gerenciar ambientes ICS. <br><br>  Para disfar√ßar as comunica√ß√µes com os servidores da C&amp;C, os invasores podem instalar software adicional nos servidores internos de uma rede comprometida, para que cada servidor atue como um proxy.  Esse proxy C&amp;C redireciona solicita√ß√µes de n√≥s infectados na rede para um servidor C&amp;C externo na Internet.  A "comunica√ß√£o" de v√°rios computadores da rede com um servidor interno n√£o parece t√£o suspeita quanto com um servidor externo.  O m√©todo tamb√©m pode ser usado para gerenciar malware em diferentes segmentos de uma rede comprometida.  Um m√©todo semelhante usando servidores internos como proxy-C &amp; C foi observado na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">campanha ART Duqu 2.0</a> . <br><br>  Se a organiza√ß√£o comprometida tiver servidores p√∫blicos da Web conectados √† rede interna, os invasores poder√£o implantar backdoors de "backup" nesses servidores.  Eles s√£o usados ‚Äã‚Äãpara restaurar o acesso √† rede no caso de as principais backdoors serem descobertas e exclu√≠das. <br><br>  Todos os servidores C&amp;C relacionados ao malware GreyEnergy usam Tor. <br><br><img src="https://habrastorage.org/webt/xx/oq/go/xxoqgo-8cdke9obd1fcazkwa3cq.png"><br>  <i>Figura 1. Um diagrama simplificado de dois cen√°rios de comprometimento de rede usados ‚Äã‚Äãpelo grupo GreyEnergy</i> <br><br><h2>  Greyenergy mini </h2><br>  O GreyEnergy mini √© um backdoor leve do primeiro est√°gio, usado pelos atacantes para avaliar um computador comprometido e fornecer uma ponte inicial na rede.  Normalmente, o GreyEnergy mini era baixado usando um documento malicioso distribu√≠do em emails de phishing.  O GreyEnergy mini tamb√©m √© conhecido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FELIXROOT</a> . <br><br>  Em setembro de 2017, a ESET descobriu um documento do Microsoft Word em ucraniano contendo uma macro maliciosa.  O documento da isca imita um formul√°rio interativo para incentivar a v√≠tima a ativar a macro e preench√™-la. <br><br><img src="https://habrastorage.org/webt/fw/vr/33/fwvr33hhjxbw8fufl_c6qpeluoo.png"><br>  <i>Figura 2. Documento de isca usado pela GreyEnergy em setembro de 2017</i> <br><br>  Depois de ativar a macro, seu c√≥digo tenta baixar e executar o arquivo bin√°rio do servidor remoto. <br><br><img src="https://habrastorage.org/webt/lu/xi/c8/luxic8ibbi5mgwhz7rhefr978ak.png"><br>  <i>Figura 3. Macro VBA maliciosa (coment√°rios adicionados pela ESET)</i> <br><br>  Curiosamente, um link que leva a uma imagem externa √© incorporado no corpo do documento.  Depois de abrir o documento, ele tenta fazer upload dessa imagem - dessa maneira os atacantes descobrem que o arquivo est√° aberto.  O m√©todo permite rastrear quais destinos incluem uma macro maliciosa e que acabam de abrir um documento. <br><br><img src="https://habrastorage.org/webt/0j/td/ot/0jtdotwwqqa9vzly3-cd92brvsa.png"><br>  <i>Figura 4. Link para um desenho ‚Äúrastreador‚Äù externo em um documento malicioso</i> <br><br>  O execut√°vel baixado √© um mini conta-gotas GreyEnergy.  O conta-gotas grava a DLL maliciosa na <code>%APPDATA%</code> , usando um GUID gerado aleatoriamente como o nome.  Al√©m disso, o conta-gotas cria um arquivo <code>.LNK</code> com um nome de arquivo vazio na pasta <code></code> no menu Iniciar, com uma entrada que executa <code>rundll32.exe</code> com o caminho para a DLL como argumento para a linha de comando.  Este √© o m√©todo de mini persist√™ncia GreyEnergy. <br><br>  A DLL liberada √© o m√≥dulo principal do GreyEnergy mini;  est√° disfar√ßado como um arquivo leg√≠timo relacionado ao Microsoft Windows. <br><br><img src="https://habrastorage.org/webt/ly/yu/lg/lyyulg-m5vxpbdbsgqvyssghhww.png"><br>  <i>Figura 5. A mini DLL backdoor do GreyEnergy se disfar√ßa como uma DLL leg√≠tima do Windows</i> <br><br>  Para avaliar um computador comprometido, o malware coleta o m√°ximo de informa√ß√µes poss√≠vel e envia dados para a C&amp;C.  Os dados s√£o coletados usando a linguagem de consulta WMI (WQL) e as consultas de registro do Windows.  Os seguintes dados s√£o coletados: <br><br><ul><li>  nome do computador </li><li>  vers√£o do sistema operacional, incluindo a vers√£o do service pack </li><li>  idioma padr√£o </li><li>  nome de usu√°rio </li><li>  privil√©gios atuais de usu√°rio do Windows, eleva√ß√£o, n√≠vel de UAC </li><li>  configura√ß√µes de proxy </li><li>  informa√ß√µes do computador (fabricante, modelo, tipo de sistema) </li><li>  fuso hor√°rio </li><li>  software de seguran√ßa instalado (antiv√≠rus e firewall) </li><li>  lista de usu√°rios e dom√≠nios </li><li>  lista de programas instalados obtidos a partir do registro </li><li>  informa√ß√µes de rede (endere√ßos IP, servidor DHCP, etc.) </li><li>  lista de processos em execu√ß√£o </li></ul><br>  O software malicioso recebe comandos do servidor C&amp;C.  Suporte para os seguintes comandos √© fornecido (abaixo est√£o os IDs de comando e seus significados): <br><br><ol><li>  coletar informa√ß√µes do computador </li><li>  baixe e execute o arquivo execut√°vel na pasta de arquivos tempor√°rios </li><li>  executar comando shell </li><li>  remover-se de um computador comprometido </li><li>  baixe e execute o arquivo .BAT da pasta de arquivos tempor√°rios </li><li>  baixar arquivo para o disco local </li><li>  carregar arquivo </li></ol><br>  A configura√ß√£o do malware no formato JSON √© incorporada ao arquivo bin√°rio e criptografada usando um algoritmo personalizado.  Os dados criptografados cont√™m quatro bytes no in√≠cio;  esses bytes s√£o usados ‚Äã‚Äãcomo a chave para a opera√ß√£o XOR descriptografar o restante dos dados.  A maioria das strings usadas pelo malware √© criptografada usando esse algoritmo. <br><br><img src="https://habrastorage.org/webt/ra/1e/7q/ra1e7q7lgjkezdzs1cvknhtjytc.png"><br>  <i>Figura 6. Configura√ß√£o embutida do GreyEnergy mini antes e depois da descriptografia</i> <br><br>  Todas as mini configura√ß√µes do GreyEnergy que vimos incluem servidores HTTPS e HTTP usados ‚Äã‚Äãcomo C&amp;C.  Isso permite que os invasores alternem para HTTP nos destinos em que a conex√£o HTTPS n√£o √© suportada pela configura√ß√£o de rede ou firewall. <br><br>  O GreyEnergy mini tem semelhan√ßas no c√≥digo com outros programas maliciosos da fam√≠lia GreyEnergy.  Al√©m disso, o GreyEnergy mini e o principal backdoor GreyEnergy usam os mesmos servidores C&amp;C. <br><br><h2>  Porta traseira principal GreyEnergy </h2><br>  O GreyEnergy √© o principal backdoor deste grupo cibern√©tico.  As amostras de malware analisadas aqui s√£o gravadas em C e compiladas usando o Visual Studio, mas sem o uso das fun√ß√µes padr√£o da biblioteca de tempo de execu√ß√£o C (CRT).  As amostras embaladas podem conter um carimbo de data / hora falso de PE, mas ap√≥s descompactar, o carimbo de data / hora √© redefinido (1 de janeiro de 1970). <br><br><img src="https://habrastorage.org/webt/4g/30/bx/4g30bxseryscxui0m-0z3hrdrzo.png"><br>  <i>Figura 7. Carimbo de data e hora de PE da amostra GreyEnergy descompactada</i> <br><br>  Curiosamente, uma das primeiras amostras de GreyEnergy analisadas foi assinada com um certificado de propriedade da Advantech.  Esta √© uma empresa de Taiwan que fabrica equipamentos para a ind√∫stria e a Internet das coisas.  Como descobrimos que o mesmo certificado foi usado para assinar o software limpo e n√£o malicioso da Advantech, acreditamos que ele foi roubado.  Observe que a amostra detectada n√£o possui uma assinatura digital - isso significa que a assinatura se tornou inv√°lida quando o certificado expirou. <br><br><img src="https://habrastorage.org/webt/y4/qe/i8/y4qei8gt9buk4eftsr5_5bukgiy.png"><br>  <i>Figura 8. Certificado Advantech usado para assinar a amostra de malware GreyEnergy</i> <br><br>  Os dados do certificado s√£o os seguintes: <br><br> <code>Serial Number: 15:f4:8f:98:c5:79:41:00:6f:4c:9a:63:9b:f3:c1:cc <br> Validity: <br> Not Before: Feb 10 00:00:00 2014 GMT <br> Not After : Feb 26 23:59:59 2017 GMT <br> SHA1 Fingerprint=97:53:AD:54:DF:6B:D6:73:E0:6C:00:36:3D:34:6A:06:00:7A:0A:9B</code> <br> <br>  Percebemos que o GreyEnergy geralmente √© implantado em dois modos: somente na mem√≥ria e com a persist√™ncia do servi√ßo DLL.  O primeiro modo √© usado quando os invasores t√™m certeza de que a instala√ß√£o n√£o exige medidas especiais para garantir a estabilidade (por exemplo, em servidores com um tempo de atividade longo);  o segundo modo √© quando o malware deve suportar qualquer reinicializa√ß√£o. <br><br><h4>  Modo Somente Mem√≥ria </h4><br>  Para esse modo, os invasores colocam o arquivo DLL em uma pasta espec√≠fica e o executam usando o aplicativo <code>rundll32.exe</code> do Windows.  Observamos que os invasores usam a ferramenta Windows Sysinternals PsExec localmente para executar o <code>rundll32.exe</code> com os privil√©gios mais altos poss√≠veis ( <code>NT AUTHORITY\SYSTEM</code> ). <br><br>  Abaixo est√° a linha de comando usada na fase de execu√ß√£o inicial do GreyEnergy apenas na mem√≥ria: <br><br> <code>cmd.exe /c "C:\Windows\System32\rundll32.exe "C:\Sun\Thumbs.db",#1 CAIAABBmAAAgAAAA8GFGvkHVGDtGRqcl3Z3nYJ9aXCm7TVZX8klEdjacOSU="</code> <br> <br>  Neste exemplo, <code>Thumbs.db</code> √© um arquivo DLL GreyEnergy do qual a fun√ß√£o com o primeiro n√∫mero de sequ√™ncia √© chamada pelo processo <code>rundll32.exe</code> .  O exemplo de linha de comando fornecido cont√©m uma sequ√™ncia de bytes criptografados com base64, que √© subsequentemente usada como uma chave AES-256 para descriptografar um pequeno stub.  Depois disso, o c√≥digo no "stub" inicia uma nova c√≥pia do processo <code>svchost.exe</code> e injeta a carga √∫til do GreyEnergy.  No √∫ltimo est√°gio, o processo GreyEnergy do <code>rundll32.exe</code> termina, o arquivo DLL malicioso √© protegido contra exclus√£o do disco.  Portanto, a carga √∫til GreyEnergy existir√° apenas no contexto da mem√≥ria do processo <code>svchost.exe</code> . <br><br>  Provavelmente, os autores pretendiam desenvolver malware de tal maneira que, sem uma chave na linha de comando, fosse imposs√≠vel descriptografar o "stub" e a carga √∫til. <br><br><img src="https://habrastorage.org/webt/rb/l5/vt/rbl5vtt2xe-e3ud4p9wxpuhsgz8.png"><br>  <i>Figura 9. Nome interno da DLL GreyEnergy para o modo somente mem√≥ria</i> <br><br>  Se voc√™ usar o modo "apenas na mem√≥ria", concluir o processo <code>svchost.exe</code> correspondente ou reiniciar o computador √© suficiente para remover o GreyEnergy. <br><br><h4>  Persist√™ncia do servi√ßo DLL </h4><br>  Para usar esse m√©todo, os operadores implantam o conta-gotas GreyEnergy, que deve ser executado com privil√©gios de administrador. <br><br>  A chave de registro <code>ServiceDLL</code> permite iniciar o m√≥dulo DLL de servi√ßo no contexto do processo <code>svchost.exe</code> .  Recurso n√£o documentado pela Microsoft;  no entanto, √© usado por v√°rias fam√≠lias de malware, incluindo o worm Conficker. <br><br>  Para garantir a persist√™ncia do servi√ßo DLL, o conta-gotas procura um servi√ßo existente e adiciona uma nova chave de registro <code>ServiceDLL</code> .  Como o m√©todo pode levar √† falha do sistema, o conta-gotas realiza inicialmente uma s√©rie de verifica√ß√µes para selecionar um servi√ßo que atenda a v√°rios requisitos. <br><br>  Primeiro, o conta-gotas localiza todos os servi√ßos do Windows que est√£o atualmente parados executando a seguinte consulta WQL: <br><br> <code>Select * from Win32_Service where PathName Like '%%svchost%%' and State = 'Stopped'</code> <br> <br>  As seguintes condi√ß√µes podem ser adicionadas √† solicita√ß√£o: <br><br><ul><li>  <code>and StartMode = 'Disabled'</code> ou <code>and StartMode = 'Manual'</code> </li><li>  <code>and ServiceType = 'Own Process'</code> ou <code>and ServiceType = 'Share Process'</code> </li></ul><br>  Em seguida, o conta-gotas tenta selecionar o servi√ßo desejado, verificando os resultados e ignorando aqueles que atendem √†s seguintes condi√ß√µes: <br><br><ul><li>  o nome do servi√ßo cont√©m <code>winmgmt</code> (Instrumenta√ß√£o de Gerenciamento do Windows) ou <code>BITS</code> (Servi√ßo de Transfer√™ncia Inteligente em <code>winmgmt</code> Plano) </li><li>  conta-gotas n√£o tem acesso ao servi√ßo ou chave do registro </li><li>  <code>DependOnService</code> registro <code>DependOnService</code> n√£o <code>DependOnService</code> vazio </li><li>  valor do registro para <code>ServiceDll</code> ou <code>ImagePath</code> n√£o existe </li><li>  A linha de comando do servi√ßo cont√©m uma das seguintes palavras: </li><li>  <code>DcomLaunch</code> , <code>LocalServiceNetworkRestricted</code> , <code>LocalServiceNoNetwork</code> , <code>LocalServicePeerNet</code> , <code>LocalSystemNetworkRestricted</code> , <code>NetworkServiceNetworkRestricted</code> , <code>secsvcs</code> , <code>wcssvc</code> </li></ul><br>  Ap√≥s a detec√ß√£o de um servi√ßo que atenda a essas condi√ß√µes, o programa de malware despeja o arquivo DLL no diret√≥rio <code>system32</code> do Windows e grava a chave de registro <code>ServiceDLL</code> .  O nome da DLL cont√©m quatro caracteres gerados aleatoriamente e <code>svc.dll</code> ou <code>srv.dll</code> no final.  Al√©m disso, o conta-gotas falsifica os metadados de tempo do arquivo, copiando-o do arquivo <code>user32.dll</code> existente. <br><br>  A vers√£o mais recente do conta-gotas GreyEnergy suporta sistemas operacionais de 32 e 64 bits. <br><br><img src="https://habrastorage.org/webt/ih/kq/uu/ihkquuwr7ha_ggshsdfwgngg3sw.png"><br>  <i>Figura 10. DLL DLL GreyEnergy implementada atrav√©s do m√©todo de persist√™ncia de servi√ßo DLL</i> <br><br>  O Dropper usa um m√©todo interessante para disfar√ßar uma DLL maliciosa como um arquivo leg√≠timo.  Em particular, o conta-gotas copia o recurso VERSIONINFO, que cont√©m uma descri√ß√£o detalhada do arquivo execut√°vel pertencente ao servi√ßo Windows em quest√£o e grava esses dados em uma DLL mal-intencionada.  Para esse fim, <code>EndUpdateResource</code> fun√ß√µes da API do Windows <code>BeginUpdateResource</code> / <code>UpdateResource</code> / <code>EndUpdateResource</code> .  Vers√µes recentes n√£o chamam essas fun√ß√µes da API;  o c√≥digo deles √© implementado no pr√≥prio programa malicioso para evitar a libera√ß√£o do arquivo DLL no disco sem um recurso VERSIONINFO falso.  Presumivelmente, isso evita a detec√ß√£o de certos produtos de seguran√ßa.  O mesmo conta-gotas pode criar arquivos DLL maliciosos com descri√ß√µes diferentes em computadores diferentes.  Cada padr√£o expandido dessa maneira ter√° um hash exclusivo. <br><br>  Se o malware j√° estiver presente no sistema, o conta-gotas pode atualiz√°-lo usando o pipe nomeado. <br><br>  No √∫ltimo est√°gio, o conta-gotas √© exclu√≠do automaticamente, substituindo o arquivo por zeros e excluindo do disco.  Dropper tamb√©m limpa a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">revista USN</a> .  As a√ß√µes s√£o executadas atrav√©s dos seguintes comandos do shell: <br><br> <code>timeout 2 &gt; nul &amp; fsutil file setzerodata offset=0 length=%DROPPER_FILESIZE% "%DROPPER_PATH%" &amp; timeout 2 &amp; cmd /c del /F /Q "%DROPPER_PATH%" &amp; fsutil usn deletejournal /D %DROPPER_DRIVE%</code> <br> <br><h4>  Configura√ß√£o e Comunica√ß√µes </h4><br>  O modo de persist√™ncia selecionado pelos operadores n√£o afeta a funcionalidade do programa malicioso, que permanece inalterado nos dois m√©todos. <br><br>  O software malicioso cont√©m uma configura√ß√£o incorporada que √© criptografada usando o algoritmo AES-256 e compactada usando LZNT1. <br><br>  O formato MIME de v√°rios componentes √© usado para a configura√ß√£o de malware incorporado.  Os autores n√£o implementaram seu pr√≥prio analisador para este formato;  em vez disso, eles usam as interfaces COM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IMimeMessage</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IMimeBody</a> .  Curiosamente, a documenta√ß√£o da Microsoft recomenda n√£o usar essas interfaces. <br><br><img src="https://habrastorage.org/webt/wr/uw/mb/wruwmbzmf4phjtbinjintm9ryfw.png"><br>  <i>Figura 11. Exemplo de configura√ß√£o interna do GreyEnergy</i> <br><br>  Para configura√ß√£o externa, o formato MIME id√™ntico √© usado;  no entanto, o malware criptografa a configura√ß√£o externa de v√°rias maneiras.  Ele usa a DPAPI (Data Protection Application Programming Interface), em particular, as fun√ß√µes da API do Windows <code>CryptProtectData</code> e <code>CryptUnprotectData</code> .  A configura√ß√£o externa √© salva no seguinte caminho <code>C:\ProgramData\Microsoft\Windows\%GUID%</code> , em que <code>%GUID%</code> √© um valor GUID gerado aleatoriamente com base no n√∫mero de s√©rie do volume da unidade C :. <br><br>  Algumas amostras do GreyEnergy cont√™m uma vers√£o ofuscada da configura√ß√£o.  Em particular, os campos <code>Type</code> dessas configura√ß√µes cont√™m letras em vez de nomes de op√ß√µes. <br><br><img src="https://habrastorage.org/webt/wj/dl/7-/wjdl7-_lpzwki1oifgi_awjctxy.png"><br>  <i>Figura 12. Um exemplo de uma configura√ß√£o GreyEnergy ofuscada</i> <br><br>  A configura√ß√£o pode conter os seguintes valores: <br><br><img src="https://habrastorage.org/webt/yo/_s/8e/yo_s8eqfgp-xgxf3mooreev9tmo.png"><br><br>  Um programa malicioso se remove do sistema infectado se o n√∫mero de tentativas malsucedidas exceder o valor de <code>MaxAttempts</code> e a √∫ltima conex√£o bem-sucedida <code>MaxAttempts</code> mais do que o <code>Lifetime</code> dias atr√°s. <br><br>  A comunica√ß√£o com C&amp;C geralmente √© feita via HTTPS;  no entanto, em alguns casos, o HTTP tamb√©m √© usado.  O mesmo formato MIME √© encapsulado em solicita√ß√µes HTTP.  Vale ressaltar que os dados s√£o criptografados usando o AES-256 e o ‚Äã‚ÄãRSA-2048. <br><br><img src="https://habrastorage.org/webt/b1/g8/6d/b1g86dydvt2stlutlwkgy79ydem.png"><br>  <i>Figura 13. Comunica√ß√£o GreyEnergy sobre HTTP capturada no Wireshark</i> <br><br>  Se estiver usando HTTP, √© mais f√°cil identificar uma m√°quina comprometida na rede analisando seu tr√°fego de rede.  As amostras de malware estudadas sempre usaram os seguintes agentes de usu√°rio codificados: <br><br><ul><li> <code>Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko</code> </li> <li> <code>Mozilla/5.0 (compatible, MSIE 11, Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko</code> </li> </ul><br>  Para ajudar os operadores GreyEnergy a identificar computadores infectados, o malware envia os resultados das seguintes consultas WQL ao servidor C&amp;C: <br><br><ul><li> <code>SELECT Caption, Version, CSName, ProductType, CurrentTimeZone, LocalDateTime, OSLanguage, OSType FROM Win32_OperatingSystem</code> </li> <li> <code>SELECT MACAddress, IPAddress, IPSubnet, DHCPEnabled, DHCPServer, DNSDomain FROM Win32_NetworkAdapterConfiguration WHERE MACAddress IS NOT NULL</code> </li> </ul><br>  As respostas do servidor C&amp;C s√£o criptografadas, mas ap√≥s a descriptografia, elas cont√™m o mesmo formato MIME com os seguintes valores poss√≠veis: <br><img src="https://habrastorage.org/webt/go/am/pd/goampdwrvmb0ospdus377v4jvj8.png"><br><br>  O GreyEnergy carrega m√≥dulos adicionais e carga √∫til na mem√≥ria usando seu pr√≥prio carregador de arquivos PE. <br><br><h4>  M√≥dulos GreyEnergy </h4><br>  Como muitas amea√ßas complexas, o malware GreyEnergy possui uma arquitetura modular.  Sua funcionalidade pode ser expandida adicionando m√≥dulos adicionais.  O m√≥dulo GreyEnergy √© um arquivo DLL que √© executado chamando uma fun√ß√£o com o primeiro n√∫mero de sequ√™ncia.  Cada m√≥dulo, incluindo o m√≥dulo principal GreyEnergy, aceita comandos de texto com v√°rios par√¢metros. <br><br>  Os operadores GreyEnergy n√£o enviam todos os m√≥dulos imediatamente para uma m√°quina comprometida.  Como regra, um programa malicioso baixa e executa os m√≥dulos necess√°rios para executar tarefas espec√≠ficas. <br><br>  Estamos cientes da exist√™ncia dos seguintes m√≥dulos GreyEnergy: <br><br>  <code>remoteprocessexec</code> - injeta um arquivo RE bin√°rio em um processo remoto <br>  <code>info</code> - coleta informa√ß√µes do sistema, logs de eventos, malware SHA-256 <br>  <code>file</code> - opera√ß√µes do sistema de arquivos <br>  <code>sshot</code> - tira screenshots <br>  <code>keylogger</code> - intercepta as teclas digitadas <br>  <code>passwords</code> - coleta senhas armazenadas em v√°rios aplicativos <br>  <code>mimikatz</code> - ferramenta <code>mimikatz</code> usada para coletar credenciais do Windows <br>  <code>plink</code> - software de <code>plink</code> usado para criar t√∫neis SSH <br>  <code>3proxy</code> - software <code>3proxy</code> usado para criar proxies <br><br>  O m√≥dulo <code>remoteprocessexec</code> permite que um invasor execute arquivos bin√°rios arbitr√°rios no contexto de processos existentes.  Por exemplo, voc√™ pode executar o Mimikatz ou um scanner de portas no contexto do Windows Explorer sem solt√°-los no disco.  Para redirecionar sa√≠da padr√£o e threads de processo e finaliza√ß√£o de processo, o m√≥dulo intercepta cinco fun√ß√µes da API do Windows. <br><br><img src="https://habrastorage.org/webt/vn/c9/2a/vnc92aap-hqdl_ps_0r-tzj4ngc.png"><br>  <i>Figura 14. Fun√ß√µes da API do Windows capturadas pelo remoteprocessexec</i> <br><br>  Como a DLL GreyEnergy redefinida √© exclusiva para cada m√°quina infectada, os invasores podem coletar hashes SHA-256 usando o m√≥dulo de informa√ß√µes.  A presen√ßa de hashes permitir√° que voc√™ acompanhe se o arquivo foi carregado em servi√ßos p√∫blicos da Web, como o VirusTotal. <br><br><h4>  Prote√ß√£o Reversa e M√©todos Anti-Criminosos </h4><br>  GreyEnergy usa v√°rios m√©todos para complicar a an√°lise.  Por exemplo, um programa de malware criptografa seq√º√™ncias de caracteres.  Algumas op√ß√µes usam o mesmo algoritmo que o GreyEnergy mini. <br><br>  No entanto, a maioria das amostras GreyEnergy possui um algoritmo de criptografia diferente.  Em particular, os quatro primeiros bytes em um blob criptografado n√£o s√£o usados ‚Äã‚Äãcomo uma chave para opera√ß√µes XOR.  Em vez disso, eles s√£o usados ‚Äã‚Äãpara inicializar o n√∫mero inicial do algoritmo de gera√ß√£o de n√∫meros pseudo-aleat√≥rios ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mersenne Whirlwind</a> ) e, em seguida, os quatro bytes gerados s√£o a chave.  Antes de liberar um buffer de mem√≥ria contendo uma sequ√™ncia de texto sem formata√ß√£o, o malware substitui o buffer por zeros. <br><br><img src="https://habrastorage.org/webt/on/px/a6/onpxa6j99a73zoqabotlcujmfyu.png"><br>  <i>Figura 15. C√≥digo descompilado para a fun√ß√£o de decodifica√ß√£o de string GreyEnergy</i> <br><br>  O programa malicioso intercepta as <code>DeleteFileW</code> e <code>DeleteFileW</code> na tabela de importa√ß√£o de cada arquivo PE bin√°rio carregado na mem√≥ria.  O gancho substitui essas fun√ß√µes por fun√ß√µes que apagam arquivos com seguran√ßa.  Em particular, o arquivo ser√° substitu√≠do por zeros antes de ser exclu√≠do do disco.  Cada carga √∫til ou plug-in usar√° essa fun√ß√£o sem a necessidade de sua implementa√ß√£o em cada m√≥dulo. <br><br><img src="https://habrastorage.org/webt/h1/ii/9y/h1ii9yhj8un7_f4zsauhxcaf4wg.png"><br>  <i>Figura 16. C√≥digo descompilado para uma rotina que intercepta DeleteFileA e DeleteFileW</i> <br><br><h2>  As ferramentas </h2><br>  Os invasores usaram o scanner de portas Nmap como a principal ferramenta para mapear as redes internas da v√≠tima.  Al√©m disso, observamos o uso de um scanner de porta personalizado leve, onde o Nmap n√£o era poss√≠vel. <br><br><img src="https://habrastorage.org/webt/6s/6p/wu/6s6pwugb_rufwoeytkhlkorgc_m.png"><br>  <i>Figura 17. Sa√≠da do console de um scanner de porta de grupo GreyEnergy personalizado</i> <br><br>  Os invasores usam ativamente ferramentas leg√≠timas, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SysInternals PsExec</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WinExe</a> , para movimento horizontal dentro de redes comprometidas.  A ferramenta WinExe, o an√°logo de c√≥digo aberto do WinExe, pode ser controlado a partir de um dispositivo Linux, por exemplo, a partir de um servidor da Web Linux comprometido. <br><br>  Vale ressaltar que, al√©m dessas ferramentas, os invasores usam scripts do PowerShell. <br><br><h2>  Backdoors do servidor da Web </h2><br>  Como mencionado anteriormente, o grupo GreyEnergy implementa backdoors adicionais em servidores Web, se esses servidores estiverem acess√≠veis na Internet.  Percebemos que os invasores usam backdoors escritos em PHP para esse fim.  Eles usam o shell da web WSO e c99shell do shell da web PHP acess√≠vel ao p√∫blico. <br><br>  Os invasores podem modificar um script PHP existente em um servidor da Web ou implantar um novo.  O c√≥digo PHP real de backdoor geralmente oculta v√°rios n√≠veis de ofusca√ß√£o e criptografia. <br><br><img src="https://habrastorage.org/webt/zo/ri/hz/zorihzdc7ajclfmonz_fcia53yy.png"><br>  <i>Figura 18. C√≥digo ofuscado do backdoor PHP do grupo GreyEnergy</i> <br><br>  O √∫ltimo n√≠vel de c√≥digo √© protegido pela criptografia de fluxo.  A gera√ß√£o de chaves para essa cifra √© baseada em uma sequ√™ncia do valor do cookie fornecido pelos atacantes por meio de uma solicita√ß√£o HTTP.  Cada backdoor do PHP √© criptografado com uma chave separada. <br><br><img src="https://habrastorage.org/webt/cs/8t/yh/cs8tyhnegnb6c1rk1avs7dxfgtk.png"><br>  <i>Figura 19. O √∫ltimo n√≠vel que o c√≥digo de backdoor do PHP decodifica</i> <br><br>  A t√©cnica de ofusca√ß√£o √© usada para impedir a an√°lise, bem como a impossibilidade de usar esse backdoor PHP por outros grupos cibern√©ticos. <br><br><h2>  Proxy C&amp;C (triulina) </h2><br>  Como mencionamos anteriormente, os atacantes podem usar o servidor interno como um proxy C&amp;C. <br><br>  Descobrimos que os invasores at√© criaram cadeias de proxies C&amp;C nos quais o primeiro servidor desse tipo pode redirecionar o tr√°fego de rede para o pr√≥ximo e assim por diante at√© chegar ao destino final na Internet. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os invasores usam v√°rios m√©todos para transformar o servidor interno em um proxy C&amp;C. </font><font style="vertical-align: inherit;">Para fazer isso, eles podem usar diretamente o malware GreyEnergy, software ou scripts adicionais de terceiros. </font><font style="vertical-align: inherit;">No primeiro caso, os operadores podem comprometer o servidor Windows usando o GreyEnergy, transform√°-lo em um proxy C&amp;C usando os m√≥dulos 3proxy e plink. </font><font style="vertical-align: inherit;">No processo de monitoramento da atividade da GreyEnergy, observamos a instala√ß√£o dos seguintes programas leg√≠timos em servidores Linux internos:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Proxy pequeno 3proxy </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Servidor Dante SOCKS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Liga√ß√£o PuTTY (Plink) </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em vez de software de terceiros, os invasores podem usar servidores da Web internos instalando seus pr√≥prios scripts neles. As linguagens de programa√ß√£o PHP e ASP s√£o usadas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em todos os casos que observamos, os scripts PHP implantados foram ofuscados e criptografados usando o mesmo tipo de ofusca√ß√£o que nas backdoors para servidores da web. No entanto, nesse caso, o cookie que cont√©m a chave de descriptografia √© fornecido pelo pr√≥prio malware GreyEnergy. Por esse motivo, os operadores devem usar um formato de configura√ß√£o especial para o URL do servidor. </font></font><br><br><img src="https://habrastorage.org/webt/ms/tm/84/mstm84awqgzzm0rxykrmni1ocmw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 20. O √∫ltimo n√≠vel que descriptografa o c√≥digo de backdoor do PHP usando um cookie.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Curiosamente, a configura√ß√£o de malware cont√©m a palavra </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">triungulin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no caminho para o script PHP ofuscado do servidor proxy. </font><font style="vertical-align: inherit;">Esse parece ser o nome interno desse m√©todo usado pelas instru√ß√µes GreyEnergy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se o programa malicioso tiver um proxy C&amp;C interno na configura√ß√£o, ele n√£o conter√° servidores C&amp;C externos. </font><font style="vertical-align: inherit;">Portanto, para encontrar o endere√ßo C&amp;C externo, voc√™ precisa ter uma amostra de malware e todos os scripts PHP associados a ela. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observamos o uso dos seguintes scripts PHP:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> script de proxy php personalizado </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vers√£o ligeiramente modificada do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antichat Socks5 Server</font></font></a> </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um script proxy PHP personalizado cont√©m uma URL com um cabe√ßalho C&amp;C externo. </font></font><br><br><img src="https://habrastorage.org/webt/z1/il/bq/z1ilbqnz3shhbn__app1xhpgtem.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 21. Um servidor C&amp;C externo incorporado no script do servidor proxy PHP customizado O script PHP customizado</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usa as bibliotecas OpenSSL e Curl para redirecionar a solicita√ß√£o do malware para o servidor C&amp;C externo na Internet. </font></font><br><br><img src="https://habrastorage.org/webt/ph/bc/20/phbc20w7dx91bjkhopbartak4cw.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 22. C√≥digo para o script PHP personalizado do servidor proxy do grupo GreyEnergy</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como mencionado acima, os invasores podem usar scripts ASP para o mesmo objetivo. Em um caso que observamos, o script ASP utilizava um cookie fornecido pelo malware para descriptografar apenas o endere√ßo C&amp;C real usando o AES; o restante do c√≥digo n√£o foi criptografado ou ofuscado. </font></font><br><br><img src="https://habrastorage.org/webt/y-/2k/tq/y-2ktq8-zcd2m9e70sobitai9se.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 23. C√≥digo de proxy ASP usado pelo grupo GreyEnergy</font></font></i> <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Servidores C e C com acesso √† Internet </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos os servidores GreyEnergy C&amp;C usavam o Tor quando estavam ativos. </font><font style="vertical-align: inherit;">As configura√ß√µes de infraestrutura da C&amp;C s√£o semelhantes √†s do BlackEnergy, TeleBots e Industroyer, que tamb√©m usavam servidores Tor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Provavelmente, todo servidor C&amp;C tem um endere√ßo de cebola e os atacantes o usam para acessar, gerenciar ou transmitir dados. </font><font style="vertical-align: inherit;">Parece ser um requisito OPSEC que adiciona uma camada extra de anonimato aos atacantes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os especialistas da ESET identificaram os servidores de C&amp;C usados ‚Äã‚Äãpelo malware GreyEnergy nos √∫ltimos tr√™s anos. </font><font style="vertical-align: inherit;">A lista √© apresentada abaixo na se√ß√£o "Indicadores de compromisso".</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Compara√ß√£o de GreyEnergy e BlackEnergy </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As fam√≠lias de malware GreyEnergy e BlackEnergy t√™m a mesma estrutura, conjunto de m√≥dulos e fun√ß√µes. </font><font style="vertical-align: inherit;">Embora a implementa√ß√£o dessas fun√ß√µes seja diferente, elas ainda s√£o compar√°veis.</font></font><br><img src="https://habrastorage.org/webt/mn/zc/sj/mnzcsjrof8t61sfkfi3lzs15p8k.png"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker petya </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em dezembro de 2016, os atacantes lan√ßaram um worm, que, em nossa opini√£o, era o antecessor do NotPetya (tamb√©m conhecido como Petya, ExPetr, Nyetya, EternalPetya). O worm foi usado em ataques a um pequeno n√∫mero de objetos e tinha recursos limitados de distribui√ß√£o, por isso n√£o era amplamente conhecido. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um worm √© um arquivo DLL com um nome </font></font><code>msvcrt120b.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localizado no diret√≥rio do Windows. O nome do arquivo interno √© </font></font><code>moonraker.dll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o que, talvez, √© uma refer√™ncia ao </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e ao </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">romance de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bond </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">com o</font></a><font style="vertical-align: inherit;"> mesmo </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">nome</font></a><font style="vertical-align: inherit;"> . Em geral, chamamos o programa Moonraker Petya. </font></font><br><br><img src="https://habrastorage.org/webt/21/ez/o5/21ezo5wz4iwkebpqamk88nnuv3e.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 24. O nome interno do worm instalado em dezembro de 2016</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O registro de data e hora do PE na DLL sugere que o arquivo foi compilado em dezembro de 2016, presumivelmente antes da instala√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moonraker Petya cont√©m c√≥digo ap√≥s o qual o computador para de carregar. Em particular, substitui o valor </font></font><code>ImagePath</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nas chaves do registro </font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet001\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font><code>[HKEY_LOCAL_MACHINE\System\ControlSet002\Services\ACPI]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e apaga o primeiro setor da unidade do sistema. Ao contr√°rio do NotPetya, o Moonraker Petya n√£o cont√©m c√≥digo que interage diretamente com o MBR e o carregador de inicializa√ß√£o do sistema operacional. Em vez disso, a DLL Moonraker Petya cont√©m um blob de dados bin√°rios criptografados. O malware espera um argumento de linha de comando que posteriormente ser√° usado como a chave de descriptografia. Ap√≥s descriptografar e descompactar usando a biblioteca zlib, o c√≥digo √© carregado na mem√≥ria como um arquivo RE bin√°rio e executado. N√£o temos uma chave de descriptografia, mas analisamos as imagens de disco dos computadores infectados. Eles continham o c√≥digo MBR e bootloader, que corresponde ao c√≥digo encontrado no Green Petya original usado por diferentes grupos cibern√©ticos. Assumimos que o blob pode conter o Petya Verde original.</font></font><br><br><img src="https://habrastorage.org/webt/ok/4h/pk/ok4hpk-oion7dmngxdeo0ud8tka.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 25. A tela pop-up exibida ap√≥s a reinicializa√ß√£o em computadores infectados com Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √â interessante que a descriptografia no Moonraker Petya seja muito semelhante ao mesmo processo nos arquivos DLL GreyEnergy no modo "only in memory". </font></font><br><br><img src="https://habrastorage.org/webt/mb/ef/mq/mbefmqjst4qziv5a8wxnrggyxky.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 26. Compara√ß√£o do c√≥digo Moonraker Petya descompilado (√† esquerda) e do c√≥digo GreyEnergy (√† direita)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker Petya pode ser distribu√≠do em uma rede local usando o SysInternals PsExec. Programas maliciosos cont√™m arquivos bin√°rios compactados com zlib em seus recursos. Posteriormente, o bin√°rio √© liberado para o diret√≥rio do Windows com o nome do arquivo </font></font><code>conhost.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este programa malicioso √© distribu√≠do de forma semelhante NotPetya: enumera os n√≥s da rede que utilizam m√©todos diferentes ( </font></font><code>WNetEnumResourceW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetIpNetTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>GetExtendedTcpTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>NetServerEnum</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, TERMSRV-registros usando</font></font><code>CredEnumerateW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), conecta-se ao host da rede usando a fun√ß√£o </font></font><code>WNetAddConnection2W</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e salva o malware como </font></font><code>\\%TARGET-HOST%\admin$\%MALWARE%</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Depois disso, o Moonraker Petya executa o seguinte comando, que inicia o programa malicioso no computador remoto usando a PsExec redefinida: </font></font><br><br> <code>C:\Windows\conhost.exe \\%TARGET-HOST% -accepteula -s -d C:\Windows\System32\rundll32.exe "C:\Windows\msvcrt120b.dll", #1 %TIMEOUT% "USER1:PASSWORD1;USER2:PASSWORD2" "%DECRYPTIONKEY%"</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â importante observar que o programa malicioso n√£o possui fun√ß√µes de coleta de credenciais usando o Mimikatz e n√£o cont√©m a explora√ß√£o EternalBlue. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m dos recursos listados, o Moonraker Petya tamb√©m suporta criptografia de arquivos. O programa malicioso verifica todos os arquivos nos discos r√≠gidos, ap√≥s o que tenta criptograf√°-los usando o algoritmo AES-256. Ap√≥s a conclus√£o do processo de criptografia, o malware pode criar um arquivo </font></font><code>README.txt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com instru√ß√µes de pagamento.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A instru√ß√£o cont√©m uma chave pessoal criptografada usando RSA-2048. Al√©m disso, cont√©m os mesmos endere√ßos de texto e cebola que o Petya Verde original. Parece que os atacantes queriam disfar√ßar o uso desse malware como um ataque com o Green Petya. </font></font><br><br><img src="https://habrastorage.org/webt/9f/i3/qu/9fi3quz_fckxngvtzjm6eay2svy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figura 27. Arquivo leia-me com instru√ß√µes de pagamento criadas por Moonraker Petya</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como etapa final, o Moonraker Petya tenta reiniciar o computador.</font></font><br><br><h2>  Conclus√£o </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GreyEnergy √© uma parte importante do arsenal de um dos grupos mais perigosos de ART que tem atacado alvos ucranianos nos √∫ltimos anos. N√≥s a vemos como a sucessora do BlackEnergy, semelhan√ßas e diferen√ßas est√£o listadas neste post. As principais raz√µes pelas quais chegamos a essa conclus√£o s√£o uma estrutura semelhante de malware, uma escolha de objetivos e m√©todos de trabalho. A transi√ß√£o do BlackEnergy para o GreyEnergy ocorreu no final de 2015 - possivelmente porque os invasores tiveram que atualizar o pacote de malware ap√≥s aumentar a aten√ß√£o √† infraestrutura do BlackEnergy.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma parte interessante do quebra-cabe√ßa √© o fato estabelecido de usar o Moonraker Petya em junho de 2016, que, de acordo com nossas estimativas, √© o antecessor do programa destrutivo NotPetya. </font><font style="vertical-align: inherit;">Isso pode indicar que os grupos TeleBots e GreyEnergy est√£o colaborando ou, pelo menos, compartilhando c√≥digo e algumas id√©ias. </font><font style="vertical-align: inherit;">No entanto, n√≥s os consideramos como grupos separados, cujos objetivos s√£o um pouco diferentes. </font><font style="vertical-align: inherit;">No momento da reda√ß√£o deste artigo, n√£o vimos as atividades intencionais do TeleBots fora da Ucr√¢nia, ao contr√°rio do GreyEnergy e do BlackEnergy antes dele. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De qualquer forma, os operadores GreyEnergy representam um s√©rio perigo. </font><font style="vertical-align: inherit;">Continuamos monitorando as atividades da GreyEnergy e TeleBots e recomendamos que usu√°rios privados e corporativos usem os produtos mais avan√ßados para proteger os terminais.</font></font><br><br><h2>  Indicadores de compromisso </h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detec√ß√£o por produtos ESET: </font></font></h4><br> <code>VBA/TrojanDownloader.Agent.EYV <br> Win32/Agent.SCT <br> Win32/Agent.SCM <br> Win32/Agent.SYN <br> Win64/Agent.SYN <br> Win32/Agent.WTD <br> Win32/GreyEnergy <br> Win64/GreyEnergy <br> Win32/Diskcoder.MoonrakerPetya.A <br> PHP/Agent.JS <br> PHP/Agent.JX <br> PHP/Agent.KJ <br> PHP/Agent.KK <br> PHP/Agent.KL <br> PHP/Agent.KM <br> PHP/Agent.KN <br> PHP/Agent.KO <br> PHP/Agent.KP <br> PHP/Agent.KQ <br> PHP/Agent.KR <br> PHP/Agent.KS <br> PHP/Agent.KT <br> PHP/Agent.KU <br> PHP/Agent.LC <br> PHP/Agent.NBP <br> PHP/Kryptik.AB <br> PHP/TrojanProxy.Agent.B <br> ASP/Agent.L <br> Win64/HackTool.PortScanner.A <br> Win64/Riskware.Mimikatz.A <br> Win64/Riskware.Mimikatz.AE <br> Win64/Riskware.Mimikatz.AH <br> Win32/Winexe.A <br> Win64/Winexe.A <br> Win64/Winexe.B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Documento GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>177AF8F6E8D6F4952D13F88CDF1887CB7220A645</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GreyEnergy mini: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>455D9EB9E11AA9AF9717E0260A70611FF84EF900 <br> 51309371673ACD310F327A10476F707EB914E255 <br> CB11F36E271306354998BB8ABB6CA67C1D6A3E24 <br> CC1CE3073937552459FB8ED0ADB5D56FA00BCD43 <br> 30AF51F1F7CB9A9A46DF3ABFFB6AE3E39935D82C</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conta-gotas GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>04F75879132B0BFBA96CB7B210124BC3D396A7CE <br> 69E2487EEE4637FE62E47891154D97DFDF8AAD57 <br> 716EFE17CD1563FFAD5E5E9A3E0CAC3CAB725F92 <br> 93EF4F47AC160721768A00E1A2121B45A9933A1D <br> 94F445B65BF9A0AB134FAD2AAAD70779EAFD9288 <br> A414F0A651F750EEA18F6D6C64627C4720548581 <br> B3EF67F7881884A2E3493FE3D5F614DBBC51A79B <br> EBD5DC18C51B6FB0E9985A3A9E86FF66E22E813E <br> EC7E018BA36F07E6DADBE411E35B0B92E3AD8ABA</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DLLs redefin√≠veis GreyEnergy: </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0B5D24E6520B8D6547526FCBFC5768EC5AD19314 <br> 10D7687C44BECA4151BB07F78C6E605E8A552889 <br> 2A7EE7562A6A5BA7F192B3D6AED8627DFFDA4903 <br> 3CBDC146441E4858A1DE47DF0B4B795C4B0C2862 <br> 4E137F04A2C5FA64D5BF334EF78FE48CF7C7D626 <br> 62E00701F62971311EF8E57F33F6A3BA8ED28BF7 <br> 646060AC31FFDDFBD02967216BC71556A0C1AEDF <br> 748FE84497423ED209357E923BE28083D42D69DE <br> B75D0379C5081958AF83A542901553E1710979C7 <br> BFC164E5A28A3D56B8493B1FC1CA4A12FA1AC6AC <br> C1EB0150E2FCC099465C210B528BF508D2C64520 <br> CBB7BA92CDF86FA260982399DAB8B416D905E89B <br> DF051C67EE633231E4C76EC247932C1A9868C14F <br> DFD8665D91C508FAF66E2BC2789B504670762EA2 <br> E2436472B984F4505B4B938CEE6CAE26EF043FC7 <br> E3E61DF9E0DD92C98223C750E13001CBB73A1E31 <br> E496318E6644E47B07D6CAB00B93D27D0FE6B415 <br> EDA505896FFF9A29BD7EAE67FD626D7FFA36C7B2 <br> F00BEFDF08678B642B69D128F2AFAE32A1564A90 <br> F36ECAC8696AA0862AD3779CA464B2CD399D8099</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> DLL GreyEnergy (modo "apenas na mem√≥ria"): </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>0BCECB797306D30D0BA5EAEA123B5BF69981EFF4 <br> 11159DB91B870E6728F1A7835B5D8BE9424914B9 <br> 6ABD4B82A133C4610E5779C876FCB7E066898380 <br> 848F0DBF50B582A87399428D093E5903FFAEEDCD <br> 99A81305EF6E45F470EEE677C6491045E3B4D33A <br> A01036A8EFE5349920A656A422E959A2B9B76F02 <br> C449294E57088E2E2B9766493E48C98B8C9180F8 <br> C7FC689FE76361EF4FDC1F2A5BAB71C0E2E09746 <br> D24FC871A721B2FD01F143EB6375784144365A84 <br> DA617BC6DCD2083D93A9A83D4F15E3713D365960 <br> E4FCAA1B6A27AA183C6A3A46B84B5EAE9772920B</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Moonraker petya </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>1AA1EF7470A8882CA81BB9894630433E5CCE4373</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Scripts PHP e ASP </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>10F4D12CF8EE15747BFB618F3731D81A905AAB04 <br> 13C5B14E19C9095ABA3F1DA56B1A76793C7144B9 <br> 1BA30B645E974DE86F24054B238FE77A331D0D2C <br> 438C8F9607E06E7AC1261F99F8311B004C23DEC3 <br> 4D1C282F9942EC87C5B4D9363187AFDC120F4DC7 <br> 4E0C5CCFFB7E2D17C26F82DB5564E47F141300B3 <br> 5377ADB779DE325A74838C0815EEA958B4822F82 <br> 58A69A8D1B94E751050DECF87F2572E09794F0F8 <br> 5DD34FB1C8E224C17DCE04E02A4409E9393BCE58 <br> 639BCE78F961C4B9ECD9FE1A8537733388B99857 <br> 7127B880C8E31FBEB1D376EB55A6F878BC77B21A <br> 71BA8FE0C9C32A9B987E2BB827FE54DAE905D65E <br> 78A7FBDD6ADF073EA6D835BE69084E071B4DA395 <br> 81332D2F96A354B1B8E11984918C43FB9B5CB9DB <br> 8CC008B3189F8CE9A96C2C41F864D019319EB2EE <br> 940DE46CD8C50C28A9C0EFC65AEE7D567117941B <br> A415E12591DD47289E235E7022A6896CB2BFDE96 <br> D3AE97A99D826F49AD03ADDC9F0D5200BE46AB5E <br> E69F5FF2FCD18698BB584B6BC15136D61EB4F594 <br> E83A090D325E4A9E30B88A181396D62FEF5D54D5 <br> ECF21EFC09E4E2ACFEEB71FB78CB1F518E1F5724</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Scanner de porta personalizado </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>B371A5D6465DC85C093A5FB84D7CDDEB1EFFCC56 <br> B40BDE0341F52481AE1820022FA8376E53A20040</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mimikatz </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SHA-1: </font></font><br> <code>89D7E0DA80C9973D945E6F62E843606B2E264F7E <br> 8B295AB4789105F9910E4F3AF1B60CBBA8AD6FC0 <br> AD6F835F239DA6683CAA54FCCBCFDD0DC40196BE</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Winexe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1: </font><font style="vertical-align: inherit;">Aviso: a maioria dos servidores com esses endere√ßos IP fazia parte da rede Tor, ou seja, o uso desses indicadores pode levar a falsos positivos.</font></font><br> <code>0666B109B0128599D535904C1F7DDC02C1F704F2 <br> 2695FCFE83AB536D89147184589CCB44FC4A60F3 <br> 3608EC28A9AD7AF14325F764FB2F356731F1CA7A <br> 37C837FB170164CBC88BEAE720DF128B786A71E0 <br> 594B809343FEB1D14F80F0902D764A9BF0A8C33C <br> 7C1F7CE5E57CBDE9AC7755A7B755171E38ABD70D <br> 90122C0DC5890F9A7B5774C6966EA694A590BD38 <br> C59F66808EA8F07CBDE74116DDE60DAB4F9F3122 <br> CEB96B364D6A8B65EA8FA43EB0A735176E409EB0 <br> FCEAA83E7BD9BCAB5EFBA9D1811480B8CB0B8A3E</code> <br> <br><font style="vertical-align: inherit;"></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O servidor C&amp;C endere√ßa o GreyEnergy mini </font></font></h4><br> <code>https://82.118.236[.]23:8443/27c00829d57988279f3ec61a05dee75a <br> http://82.118.236[.]23:8080/27c00829d57988279f3ec61a05dee75a <br> https://88.198.13[.]116:8443/xmlservice <br> http://88.198.13[.]116:8080/xmlservice <br> https://217.12.204[.]100/news/ <br> http://217.12.204[.]100/news/ <br> http://pbank.co[.]ua/favicon.ico (IP: 185.128.40.90)</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Endere√ßos do servidor GreyEnergy C &amp; C (per√≠odos de atividade e IP) </font></font></h4><br> <code>2015‚Äì2016 ‚Äì 109.200.202.7 <br> 2015‚Äì2015 ‚Äì 193.105.134.68 <br> 2015‚Äì2016 ‚Äì 163.172.7.195 <br> 2015‚Äì2016 ‚Äì 163.172.7.196 <br> 2016‚Äì2016 ‚Äì 5.149.248.77 <br> 2016‚Äì2016 ‚Äì 31.148.220.112 <br> 2016‚Äì2016 ‚Äì 62.210.77.169 <br> 2016‚Äì2016 ‚Äì 85.25.211.10 <br> 2016‚Äì2016 ‚Äì 138.201.198.164 <br> 2016‚Äì2017 ‚Äì 124.217.254.55 <br> 2017‚Äì2017 ‚Äì 46.249.49.231 <br> 2017‚Äì2017 ‚Äì 37.59.14.94 <br> 2017‚Äì2017 ‚Äì 213.239.202.149 <br> 2017‚Äì2017 ‚Äì 88.198.13.116 <br> 2017‚Äì2017 ‚Äì 217.12.202.111 <br> 2017‚Äì2017 ‚Äì 176.31.116.140 <br> 2017‚Äì2018 ‚Äì 185.217.0.121 <br> 2017‚Äì2018 ‚Äì 178.150.0.200 <br> 2018‚Äì2018 ‚Äì 176.121.10.137 <br> 2018‚Äì2018 ‚Äì 178.255.40.194 <br> 2018‚Äì2018 ‚Äì 193.105.134.56 <br> 2018‚Äì2018 ‚Äì 94.130.88.50 <br> 2018‚Äì2018 ‚Äì 185.216.33.126</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426911/">https://habr.com/ru/post/pt426911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426899/index.html">V√≠deo de Meetup de Ci√™ncia de V√≠deo</a></li>
<li><a href="../pt426901/index.html">A c√¢mera mais r√°pida do mundo grava 10 trilh√µes de quadros por segundo</a></li>
<li><a href="../pt426903/index.html">A cidade de Chengdu quer colocar um refletor de sat√©lite em √≥rbita para iluminar as ruas com um ponto de luz solar 10-80 km</a></li>
<li><a href="../pt426905/index.html">Lan√ßamento do PVS-Studio 6.26</a></li>
<li><a href="../pt426907/index.html">Problemas comuns de seguran√ßa de rede corporativa que podem ser detectados com o Check Point Security CheckUP</a></li>
<li><a href="../pt426913/index.html">Como fazer entrevistas entre relat√≥rios e um pequeno relat√≥rio no DevOops</a></li>
<li><a href="../pt426915/index.html">NASA Hackathon: Desafio de Aplicativos Espaciais</a></li>
<li><a href="../pt426917/index.html">Plataforma inteligente e segura da Cisco para empresas na era digital</a></li>
<li><a href="../pt426919/index.html">Apresentando o Microsoft Learn</a></li>
<li><a href="../pt426921/index.html">Oh, meu c√≥digo: como se tornar bem-sucedido em TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>