<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöΩ üë¶üèø üíò Sobre lo inmutable: historia del noveno lugar de la Copa AI rusa 2019 ‚òùÔ∏è üë©‚ÄçüöÄ üë®üèº‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mi nombre es Andrey Rybalka, participo en la Copa AI de Rusia bajo el sobrenombre de lama y les dir√© nuevamente c√≥mo no ganar un macbook. Afortunadame...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sobre lo inmutable: historia del noveno lugar de la Copa AI rusa 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/485372/"><p>  Mi nombre es Andrey Rybalka, participo en la Copa AI de Rusia bajo el sobrenombre de <a href="https://russianaicup.ru/profile/lama">lama</a> y <a href="https://habr.com/ru/post/345598/">les</a> <a href="https://habr.com/ru/post/440574/">dir√©</a> <a href="https://habr.com/ru/post/345598/">nuevamente</a> c√≥mo no ganar un macbook.  Afortunadamente, soy una persona con experiencia en esto, con estas manos no he ganado hasta 7 piezas. </p><br><p>  Por lo tanto, la tarea de este a√±o fue un juego de plataformas / juego de disparos en 2D, para el que ten√≠a que escribir un bot.  El juego se ve√≠a as√≠: </p><br><p><img src="https://habrastorage.org/webt/81/rg/vp/81rgvptb0d2fztphudph9deltvc.jpeg"></p><br><p>  El bot se ve√≠a as√≠: </p><br><p><img src="https://habrastorage.org/webt/au/a7/qp/aua7qpjn5khyazt7nqnefeyvra0.png"></p><br><p>  Si est√° interesado en c√≥mo la imagen # 2 jug√≥ en la imagen # 1, debajo de cat. </p><a name="habracut"></a><br><p>  Si no particip√≥ y no ley√≥ otros art√≠culos, le recomiendo que primero vea c√≥mo se ve todo en din√°mica <a href="https://russianaicup.ru/profile/lama">en el sitio</a> o en el tubo: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/vfImU0kAFI0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="turnirnaya-sistema">  Sistema de torneo </h2><br><p>  Para empezar, se dan m√°s de 2 semanas para la programaci√≥n.  Entonces comienza la primera ronda.  Dura 2 d√≠as y los 300 mejores contin√∫an.  Despu√©s de la ronda, las reglas del juego cambian (ahora controlamos dos personajes a la vez) y se da otra semana, despu√©s de lo cual pasa la segunda ronda.  Luego, las reglas se complican nuevamente (ahora jugamos en mapas mucho m√°s complejos), se da otra semana y, finalmente, jugamos la final. </p><br><p> Pero este no es el final.  Despu√©s de la final, hay otra semana, al final de la cual el sandbox simplemente se detiene, y tambi√©n se otorgan los 6 mejores, excluyendo a los ganadores de la final.  La diferencia fundamental entre el final del sandbox y el final del campeonato es que en el sandbox, los juegos se crean en un formato aleatorio, y no solo en el formato de la ronda actual. </p><br><h1 id="istoriya-uchastiya">  Historial de participaci√≥n </h1><br><p>  ¬øD√≥nde sin eso?  Puedes saltarte a los que no est√©n interesados.  La parte t√©cnica ser√° m√°s baja. </p><br><h2 id="nedelya-beta-testirovaniya-i-pervyy-raund">  Beta Test Week y Round One </h2><br><p>  Parece que comenc√© a programar el d√≠a despu√©s del inicio de la Prueba Beta abierta.  Pero personalmente, fue algo desmotivador para m√≠ que los organizadores esta vez, a diferencia del pasado, decidieran alejarse nuevamente de la pr√°ctica de publicar un pseudoc√≥digo de un simulador.  Seguramente entre los participantes estaban aquellos a quienes les gusta escribir un simulador por ingenier√≠a inversa, pero yo no soy uno de ellos, y me aburr√≠ con esto.  Como este no era mi primer campeonato, sab√≠a que tarde o temprano me involucrar√≠a, pero por la raz√≥n descrita anteriormente, me involucr√© demasiado tarde.  Como resultado, lo que hicieron algunos participantes en los primeros d√≠as, pude obligarme a terminar en solo una semana y media.  Como resultado, escrib√≠ la primera l√≠nea de c√≥digo del bot 5 d√≠as antes de la primera ronda.  En resumen, al comienzo de la primera ronda, no estaba listo, y la ronda pas√≥ sin mi participaci√≥n.  Decid√≠ llegar a la segunda ronda, a trav√©s de la marcaci√≥n de extensi√≥n. </p><br><h2 id="vtoroy-raund">  Segunda ronda </h2><br><p>  En este punto, ya program√© al m√°ximo, en promedio de 4 a 6 horas al d√≠a.  Un par de d√≠as antes del comienzo de la segunda ronda, cargu√© la primera versi√≥n del bot.  Inmediatamente subi√≥ r√°pidamente y se meti√≥ r√°pidamente en los 10 mejores cajones de arena.  Entonces comenz√≥ la ronda, donde ocup√© el quinto lugar. </p><br><h2 id="final">  Final </h2><br><p>  Pas√© la primera noche de la √∫ltima semana (de cuatro, porque estaba programada una salida para el viernes) para encontrar el camino.  Todav√≠a hab√≠a muchas ideas, pero no estaba claro en qu√© concentrarse y cu√°l de las ideas potencialmente dar√≠a el mejor resultado, as√≠ que intent√© mejorar en primer lugar qu√© caus√≥ la mayor cantidad de derrotas.  El martes y mi√©rcoles, estas fueron mejoras en la punter√≠a y el tiro, as√≠ como el control de los botiquines de primeros auxilios. </p><br><p>  Entonces vi que hab√≠a sucedido algo que hab√≠a estado esperando durante mucho tiempo, pero esperaba que esto no sucediera, algunos oponentes comenzaron a usar minas activamente. </p><br><p>  El hecho es que durante el OBT, los organizadores escucharon la propuesta de los participantes y cambiaron una de las mec√°nicas del juego.  En el caso general, esto, por supuesto, es bueno cuando se escucha a los participantes.  Pero espec√≠ficamente esta vez, la presencia de comentarios jug√≥ una broma cruel.  En resumen, los organizadores hicieron posible que las minas fueran detonadas con un disparo. </p><br><p>  Esto en s√≠ mismo es l√≥gico.  Si fuera una mina y me dispararan, tambi√©n explotar√≠a.  Pero el problema es que jugamos en puntos, y se otorgaron puntos no solo por asesinatos, sino tambi√©n por da√±os.  Por lo tanto, result√≥ que si te acercas lo suficiente al enemigo, colocas minas debajo de ti y les disparas, matas tanto al enemigo como a ti mismo con una explosi√≥n.  Es imposible esquivarlo.  Ambos obtienen 1000 puntos por los dos personajes que mueren, pero tambi√©n obtienen puntos por da√±o.  Por lo tanto, si el enemigo estaba sano, recibir√°s 1000 puntos por matar y 100 por da√±o, y el enemigo, solo 1000. </p><br><p>  Aunque todos lo sab√≠an, pero en la parte superior casi nadie usaba minas hasta el final.  No s√© c√≥mo otros, pero personalmente, no lo us√© simplemente porque no quer√≠a abusar del error de c√°lculo involuntario.  Pero, como dec√≠an en una pel√≠cula, sab√≠a que tarde o temprano iremos a esta basura. </p><br><p>  En resumen, en medio de la noche, de mi√©rcoles a jueves, agit√© la autointerrupci√≥n.  Puramente situacional, nada avanzado.  Solo por el principio de que si en el tic actual mi personaje es rentable para suicidarse, y √©l puede hacerlo, lo hace.  Como lo ha demostrado la pr√°ctica, algunos otros participantes planearon usar minas por adelantado, por lo que implementaron un suicidio m√°s avanzado, pero planearon estrat√©gicamente desatarlo justo antes de la final.  Como resultado, result√≥ lo que sucedi√≥: noveno lugar en la final, as√≠ como el a√±o pasado. </p><br><h2 id="final-pesochnicy">  Sandbox Finale </h2><br><p>  Despu√©s del final, me fui de la ciudad para las vacaciones.  Regres√≥ una semana m√°s tarde y la primera noche, literalmente en 2-3 horas de trabajo, mejor√≥ mucho las minas, sobre las que escribir√© m√°s en la parte t√©cnica.  El resto de los cambios se refer√≠an principalmente a la edici√≥n de errores y la finalizaci√≥n de la funci√≥n de evaluaci√≥n.  En resumen, un poco de programaci√≥n y muchas pruebas. </p><br><h1 id="tehnicheskaya-chast">  Parte t√©cnica </h1><br><p>  Ya sea la velocidad de Java o el radio de curvatura de las manos, sino que ambos juntos, una vez m√°s, no me permitieron llevarme bien con una simulaci√≥n pura.  Por lo tanto, el movimiento, el disparo normal y la instalaci√≥n de minas est√°n separados de m√≠. </p><br><h2 id="simulyaciya">  Simulaci√≥n </h2><br><p>  A trav√©s de los ojos de un bot, el mundo se ve√≠a as√≠: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/jwnUo2b96eA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  En el video, creo, y todo est√° aproximadamente claro.  En la esquina superior izquierda se encuentra la depuraci√≥n de la funci√≥n de evaluaci√≥n.  Puedes ver en qu√© consiste la puntuaci√≥n de cada trayectoria.  Siluetas amarillas (por ejemplo, a las 2:30): estas son las mismas trayectorias en 9 direcciones, aproximadamente ser√°n m√°s bajas.  Las l√≠neas de flechas en alg√∫n lugar entre las 2:50 son una b√∫squeda de un camino (rojo - al enemigo, verde - al botiqu√≠n de primeros auxilios, amarillo-verde - al arma, azul - a la mina).  Los cuadrados verdes al final del video son mis mosaicos PVS, que son visibles desde el mosaico seleccionado.  Los puntos rojos en sus centros indican de d√≥nde proviene la visibilidad inversa. </p><br><p>  Los movimientos de los personajes simulan sin microtics.  Las balas tambi√©n vuelan, pero en ellas utilizo varios hacks para que sea menos probable que ocurran situaciones cuando la garrapata completa la bala "atraviesa" al personaje sin tocarlo, aunque deber√≠a haberlo tocado con micr√≥fonos.  Por ejemplo, si lo piensa, la situaci√≥n descrita solo puede ocurrir en las esquinas: </p><br><p><img src="https://habrastorage.org/webt/ve/b3/wf/veb3wfaqijpe7p-qk2scwgfrueq.png"></p><br><p> En la marca 1, la vi√±eta est√° en la posici√≥n 1, en la marca 2 - en la posici√≥n 2, respectivamente.  Sin Mikrotik - Boris-r√°bano picante - obtienes, con Mikrotik - oreja de bala.  Entonces, para que esto suceda, la posici√≥n de la vi√±eta en las marcas 1 y 2 debe estar en lados diferentes de al menos una de las caras del personaje o mosaico (un rect√°ngulo de menta).  Por lo tanto, es posible simular una vi√±eta sin microtics hasta que, como se aplica en la imagen de arriba, se <code>old_bullet.x &gt; character_left_side.x != new_bullet.x &gt; character_left_side.x</code> la condici√≥n <code>old_bullet.x &gt; character_left_side.x != new_bullet.x &gt; character_left_side.x</code> , y si esto sucede, debe analizar esta marca m√°s cuidadosamente . </p><br><p>  Adem√°s, cada tic recuento las trayectorias de todas las balas voladoras antes de que chocaran con la pared y guardaran su posici√≥n en cada tic en una matriz, para que en la simulaci√≥n pudieras comprobar r√°pidamente las colisiones con ellos. </p><br><p>  Para una bazuca, despu√©s de golpear una pared, matem√°ticamente, sin microtics, calcul√© el punto exacto de impacto para calcular correctamente el epicentro de la explosi√≥n. </p><br><p>  Adem√°s, cada tick llen√© la matriz <code>dodge_trajectories</code> : <code>dodge_trajectories</code> el movimiento de cada personaje, incluidos los enemigos, en 8 direcciones para 25 ticks (siluetas amarillas en el video del visualizador, despu√©s de activar la posible casilla de verificaci√≥n de traj. Por ejemplo, a las 2:30).  Y, como con las balas, mantuvo todas las posiciones posibles en cada tic.  Luego se us√≥ en muchos lugares, algunos de los cuales mencionar√©. </p><br><p>  Tambi√©n <a href="https://www.wikiwand.com/en/Potentially_visible_set">calcul√© PVS</a> por azulejos de antemano.  Para cada celda, mantuve una lista de fichas, cuyo centro se puede ver de pie en ella.  Se calcul√≥ por trazado de rayos.  Esto se puede ver en el video del visualizador, al final.  Los cuadrados verdes son mosaicos que son visibles desde la celda seleccionada.  Los puntos rojos en sus centros indican de d√≥nde proviene la visibilidad inversa. </p><br><h2 id="poisk-puti">  Busca un camino </h2><br><p>  Implementado por el algoritmo de Dijkstra seg√∫n Waypoints.  El mosaico en el que puedes pararte fue considerado Waypoint.  La adaptaci√≥n del algoritmo para el juego de plataformas 2D es propia, propia y, por lo tanto, en aras de la optimizaci√≥n, se basa en muletas.  Pero funcion√≥ lo suficientemente r√°pido: anteriormente constru√≠ Dijkstra (no sab√≠a c√≥mo decirlo correctamente) de cada sujeto en el nivel de cada mosaico.  Constru√≠ caminos solo para aquellos que ten√≠an capacidad de campo a trav√©s en dos sentidos.  Esto era necesario para que luego pudieras pasar r√°pidamente de cualquier ficha a cualquier botiqu√≠n de primeros auxilios / arma / mina.  Era posible deshacerse de esta restricci√≥n, pero en la pr√°ctica, consideraba m√°s razonable dedicar tiempo a otras cosas, porque no hab√≠a mucho da√±o por esta restricci√≥n. </p><br><p>  Adem√°s, cada vez que cambiaba a otra ficha con cualquier personaje (el m√≠o y el del enemigo), contaba para √©l el camino al enemigo m√°s cercano, el botiqu√≠n de primeros auxilios, y tambi√©n a la mina y las armas, si a√∫n las necesitaba. </p><br><p>  En la computadora de mi casa en un juego con 1000 ticks, la b√∫squeda de ruta completa tom√≥ alrededor de 100 ms en total. </p><br><p>  Si el camino se cruza con un enemigo o amigo, simplemente agrego un par de docenas de unidades a su peso.  Por lo tanto, si hay un desv√≠o relativamente corto, o si despu√©s de eso es m√°s rentable correr hacia otro objeto, lo har√©.  En el video del visualizador anterior, esto se puede ver a las 2:55, donde se omiti√≥ el camino hacia el enemigo m√°s cercano, porque  Un camino recto cruza el segundo personaje. </p><br><p>  Visualizaci√≥n de ruta de b√∫squeda: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Dyk03lk14Ho" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Los cuadrados p√∫rpuras transl√∫cidos son puntos de referencia, tambi√©n son los v√©rtices del gr√°fico.  Flechas verde lima - bordes <sup>1</sup> columna <sup>2</sup> <br>  <em><sup>1</sup> no debe confundirse con las costillas; <sup>2</sup> cualquier coincidencia de naturaleza mon√°rquica es aleatoria [aprox.]</em> </p><br><h2 id="peredvizhenie">  Movimiento </h2><br><p>  Dos personajes caminaron por turno.  Si solo pensabas: "¬°¬øy ahora est√° entre los 10 primeros?!", Entonces pensaste correctamente.  :) No hab√≠a suficientes recursos para caminar con ambos.  Una excepci√≥n fue el caso de la aparici√≥n de una nueva bala voladora. </p><br><p>  La base para elegir una trayectoria es la gen√©tica sin cruzar.  Pero si el a√±o pasado, en el f√∫tbol, ‚Äã‚Äãla gen√©tica se mostr√≥ perfectamente, entonces este a√±o dio una ventaja muy peque√±a.  Mis experimentos mostraron un resultado muy cercano tanto en gen√©tica como en b√∫squedas aleatorias.  Veo varias razones para esto, pero la principal me parece la siguiente: en el f√∫tbol, ‚Äã‚Äãten√≠amos un objetivo fijo: el bal√≥n.  La mayor parte de su tiempo su comportamiento era predecible: si encontramos una buena trayectoria para golpear la pelota en la porter√≠a y la seguimos, luego de 20 ticks, esta trayectoria probablemente seguir√° siendo buena, porque  la pelota no puede cambiar espont√°neamente su camino.  Pero este a√±o jugamos no con la pelota, sino con personajes enemigos.  Cambiaron su comportamiento cada tic.  Entonces la relevancia de la trayectoria se mantuvo muy corta. </p><br><p>  Todav√≠a us√© la gen√©tica por dos razones: </p><br><ol><li>  Acabo de copiar su c√≥digo del a√±o pasado.  Incluso fue divertido lo poco que tuve que hacer cambios, con la excepci√≥n de la funci√≥n de evaluaci√≥n, para que el bot comenzara a moverse de manera tolerable.  En resumen, escrib√≠ un simulador durante una semana y media, y luego durante aproximadamente una hora copi√© la l√≥gica del movimiento del a√±o pasado, en otra hora arroj√© una estimaci√≥n simple y el bot, al disparar a la Quick Start, comenz√≥ a ganar de manera bastante estable. </li><li>  Aparentemente amo el dolor.  De lo contrario, no s√© c√≥mo explicar por qu√© volv√≠ a escribir en Java, y no me gustan todas las tapas normales: </li></ol><br><p><img src="https://habrastorage.org/webt/kt/qp/2n/ktqp2np94dkdbxjbajr9pgp0fky.png"></p><br><p>  As√≠ que tuve que hacer todo en todos los sentidos para que la estrategia simplemente no cayera con un tiempo de espera en cada primer juego.  Y el enfoque con la gen√©tica me permiti√≥ guardar una instant√°nea de la simulaci√≥n del mundo y los puntos contados, y luego, al calcular las pr√≥ximas generaciones, desactivar las instant√°neas solo a partir del primer gen <em>mutado</em> . </p><br><p>  Es decir  Hablando en t√©rminos generales, si en la primera generaci√≥n fui 10 tics a la derecha, y luego salt√©, y en la segunda generaci√≥n eval√∫o un mutante que va 10 ticks a la derecha y luego salta, entonces el punto de referencia para el mutante ser√° la instant√°nea calculada previamente del mundo y los puntos posteriores 10 movimientos a la derecha.  Por lo tanto, reduje significativamente el c√°lculo. </p><br><p>  Igogo, un algoritmo de movimiento aproximado: </p><br><ol><li>  Generamos N genotipos aleatorios.  Cada uno consta de M genes aleatorios.  Cada gen son n√∫meros codificados por acci√≥n: un n√∫mero es responsable de la direcci√≥n del movimiento, el segundo es para saltar / caminar / saltar hacia abajo, el tercero es para el disparo b√°sico (puramente para la funci√≥n de evaluaci√≥n, el algoritmo de disparo b√°sico se describir√° a continuaci√≥n), el cuarto para el n√∫mero de repeticiones de este acci√≥n  El n√∫mero total de acciones en el genotipo, junto con las repeticiones, no supera la profundidad de simulaci√≥n: 40 ticks. </li><li>  Agregamos una serie de genotipos codificados: movimiento directo en 9 direcciones (8 lados + parado) y un par de ajustes preestablecidos simples, que en la pr√°ctica ayudaron a salir de algunas situaciones t√≠picas en el laberinto un poco m√°s r√°pido.  Por ejemplo, estas son las trayectorias: ‚Æ§ ‚Æ• </li><li>  Agregue el mejor genotipo del movimiento anterior. </li><li>  Eval√∫a todo, deja la M mejor. </li><li>  Estamos creando la pr√≥xima generaci√≥n en la que en cada genotipo mutaron uno o m√°s genes. </li><li>  Los agregamos al grupo general, que ya contiene el mejor M de la √∫ltima generaci√≥n. </li><li>  Repetimos, comenzando desde el punto 4, varias veces m√°s. </li></ol><br><h2 id="ocenochnaya-funkciya">  Funci√≥n de evaluaci√≥n </h2><br><p>  En realidad, el lugar donde vive la estrategia. </p><br><p>  A lo largo del campeonato, se agreg√≥ una gran cantidad de todo tipo de m√©tricas (para ser precisos, 57).  Algunos de ellos no vivieron para ver las finales.  La otra parte sobrevivi√≥, pero en el contexto de la inflaci√≥n de la puntuaci√≥n durante el campeonato, como resultado, pr√°cticamente no afect√≥ el resultado, pero el resto, del orden de 20-25, fue precisamente responsable del movimiento y los disparos b√°sicos. </p><br><p>  Dar√© algunos ejemplos de m√©tricas importantes, en orden aleatorio: </p><br><ol><li>  Pena por una explosi√≥n de bala / bazooka en m√≠. </li><li>  Bonificaci√≥n por grados de libertad.  Es decir  para la cantidad de direcciones (arriba / abajo / izquierda / derecha) donde puedo moverme desde el mosaico actual.  Como puede suponer, cuantos m√°s grados de libertad, m√°s posibilidades de esquivar una bala.  Esta bonificaci√≥n oblig√≥ al bot a adherirse a plataformas y escaleras.  La bonificaci√≥n es tres veces mayor si el oponente tiene una bazuca. </li><li>  Penalizaci√≥n por la distancia (a trav√©s de la b√∫squeda del camino) al botiqu√≠n de primeros auxilios m√°s cercano;  para la distancia promedio (a trav√©s de la b√∫squeda de la ruta) a todos los botiquines de primeros auxilios;  porque el camino de √©l al botiqu√≠n de primeros auxilios m√°s cercano a √©l es menor que el camino de m√≠ a su (!) botiqu√≠n de primeros auxilios. </li><li>  Pena por el hecho de que el enemigo ve mi cabeza. </li><li>  Penalizaci√≥n por el hecho de que el enemigo ve mis piernas (los puntos 4 y 5 obligaron al bot a esconderse detr√°s de refugios parciales). </li><li>  Ataque adicional mientras se recargan armas enemigas. </li><li>  Bonificaci√≥n por disparos realizados. </li><li>  Penalizaci√≥n por demasiado o muy poca distancia del enemigo.  Depende de varios factores: la salud de ambos, si las armas de ambos fueron recargadas, etc. </li><li>  Bonificaci√≥n por condiciones de trabajo peligrosas. </li><li>  Sanciones por el estado de ca√≠da y por el estado de vuelo en la plataforma de salto (porque estos dos estados no se pueden interrumpir y, por lo tanto, es mucho menos probable que evadan la bala). </li><li>  La bonificaci√≥n por la cantidad de botiquines de primeros auxilios que est√°n en el lado opuesto de m√≠, en comparaci√≥n con el enemigo (es decir, si el enemigo est√° a mi derecha, entonces obtendr√© una bonificaci√≥n por la cantidad de botiquines de primeros auxilios que est√°n a mi izquierda. Esto b√°sicamente ten√≠a sentido en Rondas 1 y 2, donde el √∫nico camino del enemigo a estos botiquines fue a trav√©s de m√≠). </li><li>  Bonificaci√≥n por seguir el camino al enemigo, al botiqu√≠n de primeros auxilios (si estoy herido), a una mina (si tengo menos de dos), a las armas (si no hay ninguna). </li><li>  Penalizaci√≥n por la proximidad de las paredes en caso de que el enemigo tenga una bazuca.  M√°s espec√≠ficamente, consider√© cu√°ntas garrapatas el cohete del enemigo, si lo libera, volar√° a la pared cerca de m√≠, y en base a esto, esa zona cerca de la pared de la que es imposible escapar de la explosi√≥n se consider√≥ peligrosa y recib√≠ una multa por estar en ella. </li><li>  Bono de a√±o nuevo. </li></ol><br><h2 id="uklonenie-ot-pul">  Evasi√≥n de bala </h2><br><p>  Sucede autom√°ticamente, debido a lo anterior. </p><br><h2 id="pricelivanie">  Apuntando </h2><br><p>  Est√°n sucediendo muchas cosas.  Quiz√°s lo m√°s importante es un algoritmo simple y efectivo que decida si debo apuntar un arma al enemigo (porque apuntar aumenta la propagaci√≥n de armas): </p><br><ol><li>  Consideramos el √°ngulo entre (last_angle - min_spread) y (last_angle + max_spread). </li><li>  Disparamos los rayos desde el centro de mi personaje a las dos esquinas del enemigo <a href="https://www.wikiwand.com/ru/AABB">AABB</a> m√°s cercano a la perpendicular.  Si alguno de ellos est√° fuera de rango (last_angle - min_spread) ... (last_angle + max_spread), cortamos este rango. </li><li>  Consideramos el √°ngulo entre estos rayos. </li><li>  Divida la primera segunda esquina entre la primera, obtenemos cobertura (cobertura).  Representa la probabilidad <em>actual</em> en porcentaje de que la trayectoria de la bala disparada se cruce con la caja del oponente. </li><li>  Simulamos una Acci√≥n en la que se apunta a un enemigo, junto con un cambio en la dispersi√≥n. </li><li>  Repita los pasos 1..4 para el nuevo conjunto [last_angle, min_spread, max_spread].  Por lo tanto, consideramos cu√°l ser√° la cobertura en caso de que apuntemos. </li><li>  Como resultado, tenemos la cobertura actual, as√≠ como la cobertura prevista en caso de que apuntemos con el arma al enemigo.  Si la cobertura estimada es mayor que la actual, apuntamos. </li></ol><br><p>  Demo 2 puntos: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/au1eInNY9XQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Si las l√≠neas son verdes, entonces el enemigo cae completamente en el √°rea de punter√≠a.  Naranja - parcialmente, rojo - no cae en absoluto. </p><br><p>  Pero generalmente apunto no al vientre del enemigo, sino a alg√∫n punto m√°s √≥ptimo. </p><br><p>  Para una pistola y un rifle de asalto, si el enemigo est√° en el aire, considero cu√°ntas garrapatas alcanzar√° la bala en su posici√≥n actual, luego tomo de su matriz <code>dodge_trajectories</code> descrita anteriormente todas sus posiciones posibles a trav√©s de este n√∫mero de ticks, promedia las 8 posiciones y, al apuntar, considero que el enemigo est√° en este punto promedio. </p><br><p>  Si se para en el suelo, apunto "a la cabeza", sobre la base de esas consideraciones de que solo puede saltar hacia arriba, de modo que un disparo en la cabeza es mucho m√°s dif√≠cil de esquivar que un disparo en el est√≥mago, y a√∫n m√°s, en las piernas. </p><br><p>  Para una bazuca, tambi√©n tomo 8 posiciones posibles a trav√©s de tantas garrapatas como el cohete llega al enemigo.  Para ellos, construyo un cono (m√°s precisamente, un sector de un c√≠rculo) que describe todas estas posiciones y dentro de este cono clasifico las trayectorias con alg√∫n paso.  Para cada trayectoria, simulo un vuelo de cohete, junto con una explosi√≥n en caso de un golpe en la pared.  La trayectoria en la que el enemigo tiene menos posibilidades de esquivar, la uso para apuntar. </p><br><p>  Incluso en algunos casos, para caer y volar desde la plataforma de salto (es decir, aquellos estados que el enemigo no puede interrumpir), simplemente considero el punto de intercepci√≥n por la bala del enemigo, resolviendo el sistema de ecuaciones de movimiento.  El c√≥digo fue copiado de su propio robot de hockey 2014, donde fue utilizado para interceptar el disco.  :) </p><br><p>  Entre otras cosas, en ciertas situaciones, cancel√© el apuntar si hay una posici√≥n en mi camino para los pr√≥ximos 10 ticks en los que el rayo desde el centro de esta posici√≥n en la direcci√≥n del √∫ltimo √°ngulo <em>actual se</em> cruza con el enemigo.  Esto me permiti√≥ apuntar con movimiento, sin cambiar el √°ngulo y, por lo tanto, sin aumentar la extensi√≥n. </p><br><h2 id="strelba">  Disparando </h2><br><p>  El disparo b√°sico fue cosido en la trayectoria encontrada y fue puramente situacional.  Pero tambi√©n, cada vez que mi bot intentaba calcular si tiene sentido disparar en este momento, y si lo hizo, dispar√≥.  Por ejemplo: </p><br><ul><li>  si no se garantiza que el enemigo esquive; </li><li>  si la cobertura fue superior a alg√∫n valor fijo. </li></ul><br><p>  Adem√°s, si mi arma era una bazuca, simulaba todo tipo de trayectorias dentro de la propagaci√≥n en caso de un disparo inmediato, con alg√∫n paso.  Y si el resultado mostr√≥ que el beneficio potencial excede el da√±o potencial, dispar√©.  Evalu√© el beneficio mediante 4 m√©tricas en orden descendente de importancia para m√≠ y para el enemigo: muerte garantizada (m√≠a o del enemigo), posible muerte, da√±o garantizado, posible da√±o.  Si hab√≠a al menos una trayectoria en la que, por ejemplo, se me <em>garantizaba</em> matarme a m√≠ mismo y solo <em>posiblemente</em> matar al enemigo, no disparaba. </p><br><p>  Hubo otros controles.  Por ejemplo, podr√≠a cancelar un disparo si en el siguiente tic de mi trayectoria la cobertura potencial es mayor que en el actual. </p><br><p>  En general, la l√≥gica me dijo que los disparos b√°sicos deber√≠an desactivarse, pero las pruebas mostraron lo contrario.  No puedo imaginar por qu√©. </p><br><h2 id="miny">  Minas </h2><br><p>  En el momento de la final, estaban en su infancia: marcaba cada tic lo que suceder√≠a si pon√≠a 1 o 2 minas en este momento, dependiendo de la salud del oponente, y les disparaba.  Si tengo la garant√≠a de matar al enemigo y si es rentable para m√≠ (ya sea en puntos o porque solo el enemigo morir√°), lo hice. </p><br><p>  Despu√©s del a√±o nuevo, volviendo de un viaje, escrib√≠ el algoritmo la primera noche, lo que me llev√≥ a 2-4 lugares en la tabla.  El algoritmo era simple: simplemente simul√© cada tic que suceder√≠a si cambiara inmediatamente al modo berserker y corriera hacia el enemigo para explotarlo con una mina lo antes posible.  Para el enemigo, simul√© una evasi√≥n simple, usando las mismas esquivar_trajectories: tom√© tres trayectorias que aumentan la distancia de m√≠.  Por ejemplo, si estaba a la izquierda del enemigo, entonces analizaba tres casos: el enemigo se escapa a la derecha;  el enemigo corre hacia la derecha y salta;  corre hacia la derecha y salta hacia abajo.  Si en los tres casos se me garantiz√≥ que ten√≠a tiempo para matarlo con una mina y se le garantiz√≥ que no podr√≠a poner minas antes que yo, lo hice. </p><br><p>  Adem√°s, el algoritmo pudo saltar o saltar en el nivel de estrategia de Inicio r√°pido, simplemente en funci√≥n de la diferencia en la coordenada Y. </p><br><p>  Como resultado, en los mapas finales, casi todas las partidas terminaron en menos de 1000 ticks con autodestrucci√≥n de mis dos personajes. </p><br><h2 id="pacifizm">  Pacifismo </h2><br><p>  Al ver cu√°n efectivas eran mis minas, decid√≠ verificar mi suposici√≥n hecha anteriormente en el <a href="https://t.me/aicups">canal de telegramas de</a> que en la final era posible tomar un lugar en la parte superior sin disparar en absoluto.  As√≠ que simplemente tom√© y apagu√© el disparo en mi bot, con la excepci√≥n de un disparo en la mina.  Lo √∫nico es que, para no perder la calificaci√≥n, este modo se activ√≥ solo si ten√≠a suficientes minas para matar al enemigo. </p><br><p>  En resumen, mi bot se ha convertido en un pacifista.  Para demostrar su paz y humildad, ni siquiera mir√≥ al enemigo (ver video).  Bueno, a veces dispar√≥ minas, piensas.  ¬°No le dispar√© a los oponentes!  Y si murieron al mismo tiempo, bueno, qu√© puedes hacer, un tr√°gico accidente. </p><br><p>  En general, cargu√© esta versi√≥n en el sitio, cre√© 4 juegos con cada uno de los 3 principales y ... </p><br><p><img src="https://habrastorage.org/webt/sv/e8/69/sve869ijby1cp9lduijtx5wfusc.png"></p><br><p>  ... gan√≥ 3 de 4 juegos contra cada uno.  En general, es extra√±o que los vecinos no vinieran a quejarse de mi risa hom√©rica en medio de la noche.  :) </p><br><p>  Admirate a ti mismo: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZpvvN21vufg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Eh, si pasara estas 2-3 horas antes de la final, y no despu√©s, tal vez este art√≠culo dir√≠a c√≥mo ganar un MacBook, y no c√≥mo evitarlo por todos los medios, qui√©n sabe.  Por desgracia, la historia no conoce el modo subjuntivo. </p><br><h1 id="testirovanie">  Prueba </h1><br><p>  En general, prob√© los cambios tantas veces que el resultado fue estad√≠sticamente significativo.  M√°s precisamente, el l√≠mite inferior del intervalo de confianza debe superar el 50%.  Para las finales del sandbox, el script seleccion√≥ los coeficientes.  En a√±os anteriores prob√© la gen√©tica, pero funcion√≥ mal: para un resultado normal, hab√≠a que jugar demasiados juegos.  As√≠ que esta vez solo cambi√© un coeficiente a la vez y recuper√© 200 juegos.  En aquellos casos en que el resultado fue bueno, realic√© pruebas adicionales.  En resumen, dej√≥ durante la noche dos docenas de coeficientes y tuvo un resultado en la ma√±ana. </p><br><h1 id="v-zaklyuchenie">  En conclusi√≥n </h1><br><p>  De alguna manera, todo funcion√≥ con el dolor por la mitad. </p><br><p>  En los √∫ltimos d√≠as antes del final del sandbox, pas√© la mayor parte del tiempo en el segundo lugar en la mesa por un margen significativo desde el tercero, pero unas pocas horas antes del final del sandbox no tuve suerte y comenc√© una serie de juegos de acuerdo con las reglas de las rondas 1 y 2, mientras que mi estrategia jug√≥ m√°s con las reglas del final.  Por ejemplo, aqu√≠ de 13 juegos solo hay 1 de acuerdo con las reglas finales.  As√≠ que tambi√©n, mi tasa de victorias en estos juegos sali√≥ mucho peor de lo habitual.  En general, el todopoderoso al azar: </p><br><p><img src="https://habrastorage.org/webt/4-/xl/wi/4-xlwimvw-jwctcn8qerejyjsma.jpeg"></p><br><p>  Como resultado, perd√≠ demasiados juegos, perd√≠ toda mi ventaja y ca√≠ de 2 a 4 lugares, y no tuve tiempo de recuperarme, porque el campeonato hab√≠a terminado.  Es bueno que el sandbox no haya perdido el primer lugar en la lista de ganadores. </p><br><p>  Una vez m√°s, quiero agradecer a Mail.ru Group por este pr√≥ximo campeonato maravilloso.   , ,   ,          ( 1100 ).      ‚Äî ,   .  ,         .  , , ,  ! </p><br><p>   ,    .  , ,       .       "   8 ". </p></div></div><p>Source: <a href="https://habr.com/ru/post/485372/">https://habr.com/ru/post/485372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../485352/index.html">Informe de Annie de la aplicaci√≥n 2019: una mirada al pasado, notas futuras</a></li>
<li><a href="../485354/index.html">Motocicleta hecha con impresi√≥n 3D SLS</a></li>
<li><a href="../485358/index.html">¬øEl desarrollo m√≥vil es f√°cil y aburrido? Informe Yandex</a></li>
<li><a href="../485364/index.html">C√≥mo dejar de perder el tiempo de los desarrolladores en deuda t√©cnica</a></li>
<li><a href="../485370/index.html">¬øC√≥mo puede un desarrollador ayudar a un gerente a hacer un trato?</a></li>
<li><a href="../485374/index.html">La cach√© es el rey del rendimiento: los procesadores necesitan un cuarto nivel de cach√©</a></li>
<li><a href="../485376/index.html">¬øC√≥mo hacer que la interfaz sea tres veces m√°s r√°pida y cu√°ndo aplicar comandos en lugar de repositorios? Video</a></li>
<li><a href="../485378/index.html">Estudio de caso: C√≥mo aparecer en Google Play y adaptar ASO a diferentes pa√≠ses</a></li>
<li><a href="../485380/index.html">Artesan√≠a y √âxito de TI</a></li>
<li><a href="../485384/index.html">NeurIPS 2019: tendencias de ML que estar√°n con nosotros durante la pr√≥xima d√©cada</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>