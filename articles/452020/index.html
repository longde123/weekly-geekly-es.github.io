<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöµ #‚É£ üåæ La mejor priorizaci√≥n HTTP / 2 para la aceleraci√≥n web üß¶ üèûÔ∏è üôå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="HTTP / 2 prometi√≥ acelerar significativamente la web, y Cloudflare implement√≥ hace mucho tiempo el acceso HTTP / 2 para todos los clientes. Pero una c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La mejor priorizaci√≥n HTTP / 2 para la aceleraci√≥n web</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452020/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/57d/5cf/dbe/57d5cfdbe917c7b464a249fb187b3ffd.png"></div><br>  HTTP / 2 prometi√≥ acelerar significativamente la web, y Cloudflare implement√≥ hace mucho tiempo el acceso HTTP / 2 para todos los clientes.  Pero una caracter√≠stica de HTTP / 2, la priorizaci√≥n, no cumpli√≥ con las expectativas.  No porque est√© fundamentalmente roto, sino por la implementaci√≥n en los navegadores. <br><br>  Hoy, Cloudflare sugiere cambiar la priorizaci√≥n de HTTP / 2, lo que les da a nuestros servidores control sobre las decisiones de priorizaci√≥n que realmente aceleran Internet. <br><br>  Hist√≥ricamente, era el navegador el que controlaba c√≥mo y cu√°ndo descargar contenido web.  Hoy, para todos los planes pagos, estamos haciendo cambios radicales en este modelo.  Transfieren el control directamente al propietario del sitio.  En la pesta√±a "Velocidad" en el panel de Cloudflare, los clientes pueden habilitar la "Priorizaci√≥n HTTP / 2 avanzada": anula la configuraci√≥n predeterminada del navegador a un esquema de programaci√≥n mejorado, lo que acelera significativamente el acceso de los visitantes (en algunos casos, vimos un aumento del 50%).  Con los trabajadores de Cloudflare, los propietarios de sitios pueden ir m√°s all√° y personalizar completamente la configuraci√≥n para sus necesidades espec√≠ficas. <br><a name="habracut"></a><br><h1>  Situaci√≥n actual </h1><br>  Las p√°ginas web consisten en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://discuss.">docenas (a veces cientos) de</a> recursos individuales que el navegador descarga y recopila en el contenido final que se muestra.  Esto incluye el contenido visible con el que interact√∫a el usuario (HTML, CSS, im√°genes), as√≠ como la l√≥gica de la aplicaci√≥n (JavaScript) para el sitio en s√≠, publicidad, an√°lisis y balizas de seguimiento de marketing.  Desde el punto de vista del usuario, la secuencia en la que se cargan estos recursos es muy importante: esto afecta el momento en que ve el contenido y puede interactuar con la p√°gina. <br><br>  Un navegador es, de hecho, un motor de procesamiento de HTML que pasa a trav√©s de un documento HTML y sigue las instrucciones en orden: de principio a fin HTML, construyendo la p√°gina a medida que se mueve.  Los enlaces de hoja de estilo (CSS) le indican al navegador c√≥mo aplicar estilo al contenido de la p√°gina, y el navegador retrasar√° la visualizaci√≥n del contenido hasta que cargue la hoja de estilo.  Las secuencias de comandos en la p√°gina pueden tener comportamientos diferentes.  Si el script est√° marcado como "as√≠ncrono" o "pendiente", el navegador puede continuar procesando el documento y simplemente ejecutar el script cuando est√© disponible.  Si el script no est√° marcado como as√≠ncrono o diferido, el navegador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DEBE</a> dejar de procesar el documento hasta que el script se cargue y ejecute.  Dichos scripts se denominan "bloqueo" porque impiden que el navegador contin√∫e procesando el documento. <br><br>  El documento HTML se divide en dos partes.  El t√≠tulo del documento &lt;head&gt; se encuentra al principio y contiene hojas de estilo, scripts y otras instrucciones del navegador necesarias para mostrar el contenido.  Despu√©s de que el encabezado es el cuerpo del documento &lt;body&gt;, contiene el contenido real que se muestra en la ventana del navegador (aunque los scripts y las hojas de estilo tambi√©n pueden estar en el cuerpo).  Hasta que el navegador llegue al cuerpo del documento, el usuario no tiene nada que mostrar y la p√°gina permanece en blanco.  Por lo tanto, es importante procesar el encabezado lo m√°s r√°pido posible.  Si est√° interesado en los detalles, el sitio web <i>HTML5 Rocks</i> tiene un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">excelente tutorial</a> sobre c√≥mo funcionan los navegadores. <br><br>  El navegador generalmente es responsable del orden en que se cargan los diversos recursos necesarios para crear la p√°gina y procesar el documento.  En HTTP / 1.x, existen restricciones sobre cu√°ntos objetos puede solicitar el navegador a cualquier servidor a la vez (generalmente 6 conexiones y solo un recurso a la vez por conexi√≥n), por lo que el navegador controla estrictamente el orden de las solicitudes.  En HTTP / 2, la situaci√≥n es completamente diferente.  El navegador puede solicitar todos los recursos a la vez (al menos tan pronto como se entere de ellos) y proporciona al servidor instrucciones detalladas sobre c√≥mo entregar estos recursos. <br><br><h1>  √ìptimo orden de carga de recursos </h1><br>  Para la mayor√≠a de las partes, existe un orden √≥ptimo en el ciclo de carga de la p√°gina que maximiza la disponibilidad de la p√°gina para el usuario (y la diferencia entre el orden de carga √≥ptimo y el no √≥ptimo puede alcanzar el 50% o m√°s). <br><br>  Como se describi√≥ anteriormente, antes de que el navegador pueda mostrar cualquier contenido, CSS y JavaScript lo bloquean en la secci√≥n <code>&lt;head&gt;</code> .  En esta etapa, es m√°s rentable usar el 100% del canal para cargar recursos de bloqueo, en lugar de cargarlos en orden, ya que est√°n escritos en el c√≥digo HTML.  Esto permite al navegador analizar y ejecutar cada elemento mientras carga el siguiente recurso de bloqueo, lo que crea una canalizaci√≥n √≥ptima. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db9/e18/fbe/db9e18fbe00d27755a152a8deabbcaa4.png"><br><br>  El tiempo de carga del script para la carga paralela o secuencial no difiere, pero para la carga secuencial, el primer script puede procesarse y ejecutarse durante la segunda carga. <br><br>  Despu√©s de cargar recursos de bloqueo, la situaci√≥n se vuelve un poco m√°s interesante.  Aqu√≠, la carga √≥ptima puede depender de un sitio en particular o incluso de las prioridades comerciales (selecci√≥n de contenido generado por el usuario o publicidad, o an√°lisis, etc.).  Otro problema con las fuentes, porque el navegador detecta las fuentes deseadas despu√©s de aplicar la hoja de estilo al contenido mostrado.  Por lo tanto, para cuando el navegador descubra la fuente, es necesario mostrar el texto que ya est√° listo para mostrarse en la pantalla.  Cualquier retraso en la carga de la fuente no da como resultado texto en la pantalla (o el texto se muestra en la fuente incorrecta). <br><br>  Como regla general, se deben considerar algunas compensaciones: <br><br><ul><li>  Las fuentes e im√°genes personalizadas en la parte visible de la p√°gina (ventana gr√°fica) deben cargarse lo m√°s r√°pido posible.  Afectan directamente la experiencia visual del usuario al cargar la p√°gina. <br></li><li>  JavaScript sin bloqueo debe cargarse secuencialmente con respecto a otros recursos de JavaScript para que cada uno de ellos pueda ser canalizado.  JavaScript puede incluir l√≥gica de aplicaci√≥n personalizada, as√≠ como rastreadores para an√°lisis y marketing, y su retraso puede conducir a una disminuci√≥n en los indicadores rastreados por la empresa. <br></li><li>  Las im√°genes se pueden cargar en paralelo.  Los primeros bytes del archivo de imagen contienen su tama√±o, que puede ser necesario para el dise√±o del navegador, y la carga paralela de im√°genes progresivas puede proporcionar integridad visual despu√©s de transferir aproximadamente el 50% del volumen total. </li></ul><br>  Dadas las compensaciones, en la mayor√≠a de los casos, esta estrategia funciona bien: <br><br><ul><li>  Las fuentes personalizadas se descargan secuencialmente y comparten el ancho de banda disponible con im√°genes dentro del alcance. <br></li><li>  Las im√°genes visibles se cargan en paralelo, compartiendo entre ellas la parte del ancho de banda asignado a ellas. <br></li><li>  Cuando no hay m√°s fuentes o im√°genes visibles: <br><ul><li>  Las secuencias de comandos sin bloqueo se cargan secuencialmente y comparten el ancho de banda disponible con im√°genes invisibles (que est√°n fuera del alcance). <br></li><li>  Las im√°genes invisibles se cargan en paralelo, compartiendo entre ellas la parte del ancho de banda asignado a ellas. </li></ul></li></ul><br>  Por lo tanto, el contenido visible para el usuario se carga lo m√°s r√°pido posible, la l√≥gica de la aplicaci√≥n se retrasa al m√≠nimo y las im√°genes invisibles se cargan de tal manera que se complete el dise√±o lo m√°s r√°pido posible. <br><br><h1>  Ejemplo </h1><br>  Para ilustrar, use una p√°gina de categor√≠a de producto simplificada de un sitio de comercio electr√≥nico t√≠pico: <br><br><ul><li>  <b>Azul</b> : archivo HTML de la p√°gina en s√≠. <br></li><li>  <b>Verde</b> : una hoja de estilo externa (archivo CSS). <br></li><li>  <b>Naranja</b> : cuatro scripts externos (JavaScript).  Dos scripts de bloqueo en la parte superior de la p√°gina y dos as√≠ncronos.  Las secuencias de comandos de bloqueo se muestran en un tono m√°s oscuro de naranja. <br></li><li>  <b>El rojo</b> es una fuente web personalizada. <br></li><li>  <b>Violeta</b> - 13 im√°genes.  El logotipo de la p√°gina y las cuatro im√°genes del producto se muestran en la ventana de visualizaci√≥n, otras 8 im√°genes del producto requieren desplazamiento.  Las cinco im√°genes visibles est√°n indicadas por un tono m√°s oscuro de p√∫rpura. </li></ul><br>  Para simplificar, suponga que todos los recursos tienen el mismo tama√±o y cada carga en 1 segundo.  La descarga de todos los recursos lleva un total de 20 segundos, pero el orden y el m√©todo de carga son extremadamente importantes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbd/07b/58a/fbd07b58a4c8aeff2a758ad1946d8523.png"><br><br>  As√≠ se ver√° la carga √≥ptima de recursos en un navegador: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b2/6a8/2cd/8b26a82cdb5c546e9005200e5528b988.gif"><br><br><ul><li>  La p√°gina est√° en blanco durante los primeros 4 segundos mientras carga HTML, CSS y scripts de bloqueo: todos usan una conexi√≥n 100%. <br></li><li>  En la marca de 4 segundos, el fondo y la estructura de la p√°gina se muestran sin texto o im√°genes. <br></li><li>  Despu√©s de un segundo, alrededor de 5 segundos, se muestra el texto de la p√°gina. <br></li><li>  En el intervalo de 5-10 segundos, las im√°genes se descargan, borrosas al principio, pero muy r√°pidamente se vuelven claras.  Aproximadamente a los 7 segundos, el resultado es casi indistinguible de la versi√≥n final. <br></li><li>  Aproximadamente 10 segundos, se completa la carga de todo el contenido visual en la parte visible de la p√°gina. <br></li><li>  Durante los siguientes dos segundos, se carga y ejecuta JavaScript as√≠ncrono, ejecutando cualquier l√≥gica no cr√≠tica (an√°lisis, etiquetas de marketing, etc.). <br></li><li>  Durante los √∫ltimos 8 segundos, las im√°genes restantes se cargan en caso de que el usuario se desplace por la p√°gina. </li></ul><br><h1>  Priorizaci√≥n actual del navegador </h1><br>  Todos los motores de navegador actuales implementan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://calendar.perfplanet.com/2018/">varias estrategias de priorizaci√≥n</a> , ninguna de las cuales es √≥ptima. <br><br>  <b>Microsoft Edge e Internet Explorer</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://calendar.perfplanet.com/2018/">no admiten la priorizaci√≥n</a> , por lo que funcionan con la configuraci√≥n predeterminada de HTTP / 2, que carga todo en paralelo, distribuyendo uniformemente el ancho de banda entre todos los recursos.  Microsoft Edge en futuras versiones cambiar√° a usar el motor Chromium, lo que puede mejorar la situaci√≥n.  Pero por ahora, en nuestro ejemplo, el navegador se atasca la mayor parte del tiempo en el encabezado de la p√°gina, ya que las im√°genes ralentizan la transmisi√≥n de scripts de bloqueo y hojas de estilo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9c/844/a65/e9c844a65472a56d92cb37cd27f2f035.png"><br><br>  Visualmente, esto lleva a una experiencia bastante dolorosa: el usuario mira una pantalla en blanco durante 19 segundos, y luego hay un retraso de 1 segundo para mostrar el texto.  Cuando vea la animaci√≥n a continuaci√≥n, tenga paciencia, porque durante 19 segundos puede parecer que no sucede nada en una pantalla en blanco (aunque es as√≠): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c9/fae/539/6c9fae539ae1d3c99570cf53af415be4.gif"><br><br>  <b>Safari</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://calendar.perfplanet.com/2018/">carga todos los recursos en paralelo</a> , compartiendo el ancho de banda seg√∫n su importancia, de acuerdo con Safari (los recursos de bloqueo como los scripts y las hojas de estilo son m√°s importantes que las im√°genes).  Las im√°genes se cargan en paralelo, pero tambi√©n simult√°neamente con contenido de bloqueo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c75/a7d/f05/c75a7df05716f5706aa4b037774733d2.png"><br><br>  Aunque Safari es similar a Edge en el sentido de que todo se carga al mismo tiempo, asignar m√°s ancho de banda para bloquear recursos le permite mostrar contenido mucho antes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f0c/840/5a1/f0c8405a1b6ddc40645ab7985e28a5eb.gif"><br><br><ul><li>  Despu√©s de aproximadamente 8 segundos, se completa la carga de la hoja de estilo y los scripts, por lo que puede comenzar a representar la p√°gina.  Como las im√°genes se cargaron en paralelo, tambi√©n se pueden mostrar parcialmente (borrosas para im√°genes progresivas).  Esto sigue siendo el doble de lento que el escenario √≥ptimo, pero mucho mejor que en Edge. <br></li><li>  Despu√©s de unos 11 segundos, se carga la fuente.  Puedes mostrar el texto.  En este punto, se est√°n cargando m√°s datos para las im√°genes, y se est√°n volviendo un poco m√°s n√≠tidos.  Esto es comparable a la situaci√≥n alrededor de la marca de 7 segundos para un escenario de carga √≥ptimo. <br></li><li>  Durante los 9 segundos restantes, las im√°genes se vuelven m√°s n√≠tidas a medida que se descargan m√°s datos hasta que, finalmente, el proceso se completa en 20 segundos. </li></ul><br>  <b>Firefox</b> crea un √°rbol de dependencia que agrupa los recursos y luego planifica los grupos para cargar uno tras otro o compartir el ancho de banda entre los grupos.  Dentro de este grupo, los recursos comparten ancho de banda y se cargan simult√°neamente.  Se planea que las im√°genes se carguen despu√©s de las hojas de estilo que bloquean la representaci√≥n y se cargan en paralelo, pero los scripts y las hojas de estilo que bloquean la representaci√≥n tambi√©n se cargan en paralelo y no se benefician de la canalizaci√≥n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/870/e6d/83c/870e6d83c673b9c706dac49c78d3848d.png"><br><br>  En nuestro ejemplo, esto sucede un poco m√°s r√°pido que en Safari, ya que las im√°genes est√°n esperando que se cargue la hoja de estilo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd2/806/b55/bd2806b55e830bd4c2a7e08bb1b18ce4.gif"><br><br><ul><li>  Aproximadamente 6 segundos, el contenido de la p√°gina original se muestra con un fondo y versiones borrosas de las im√°genes del producto (en comparaci√≥n con 8 segundos para Safari y 4 segundos en el mejor de los casos). <br></li><li>  A los 8 segundos, la fuente se carg√≥ y puede mostrar el texto junto con im√°genes ligeramente m√°s n√≠tidas del producto (en comparaci√≥n con los 11 segundos y 7 segundos de Safari en el mejor de los casos). <br></li><li>  Durante los 12 segundos restantes, las im√°genes se vuelven m√°s n√≠tidas a medida que se carga el contenido restante. </li></ul><br>  <b>Chrome</b> (y todos los navegadores basados ‚Äã‚Äãen Chromium) prioriza el inventario.  Esto funciona muy bien para bloquear recursos que se cargan de manera √≥ptima en orden, pero no tan buenos para las im√°genes.  Cada imagen se carga hasta el 100% antes de comenzar la siguiente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e22/14d/4e0/e2214d4e04fab810f0a4398fe02434c1.png"><br><br>  En la pr√°ctica, este es un escenario de descarga casi √≥ptimo, con la √∫nica diferencia de que las im√°genes se descargan de una en una, y no en paralelo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91e/76c/d1d/91e76cd1d814aef138b35345eda46d82.gif"><br><br><ul><li>  Hasta 5 segundos, cargar Chrome es id√©ntico al escenario √≥ptimo, mostrando el fondo en el cuarto segundo y el contenido de texto en el quinto. <br></li><li>  Durante los siguientes 5 segundos, las im√°genes del √°rea de visibilidad se cargan de una en una hasta que el proceso se completa en aproximadamente 10 segundos (en comparaci√≥n con el escenario √≥ptimo, cuando se muestran de forma ligeramente borrosa en aproximadamente 7 segundos y se vuelven m√°s n√≠tidas durante los tres segundos restantes). <br></li><li>  Despu√©s de completar la parte visual de la p√°gina en 10 segundos (id√©ntico al escenario √≥ptimo), los 10 segundos restantes se gastan en ejecutar scripts asincr√≥nicos y cargar im√°genes ocultas (al igual que en el escenario √≥ptimo). </li></ul><br><h1>  Comparaci√≥n visual </h1><br>  La diferencia visual es bastante diferente, aunque t√©cnicamente cargar todo el contenido lleva el mismo tiempo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/62e/2a1/d5f/62e2a1d5f10b801af61992517d7f5a5a.gif"><br><br><h1>  Priorizaci√≥n del lado del servidor </h1><br>  El cliente (navegador) solicita la priorizaci√≥n de HTTP / 2, y el servidor debe decidir qu√© hacer en funci√≥n de la solicitud.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://github.com/andydavies/">Una gran cantidad de servidores no admiten esta funci√≥n en absoluto</a> , y el resto cumple con una solicitud del cliente.  Otra opci√≥n es decidir la mejor priorizaci√≥n del lado del servidor seg√∫n la solicitud del cliente. <br><br>  De acuerdo con la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://http2.github.io/">especificaci√≥n</a> , la priorizaci√≥n HTTP / 2 es un √°rbol de dependencia que requiere un conocimiento completo de todas las solicitudes actuales para poder priorizar los recursos entre s√≠.  Esto le permite implementar estrategias incre√≠blemente complejas, pero es dif√≠cil implementarlo bien en el lado del navegador o del servidor (como lo demuestran varias estrategias del navegador y diferentes niveles de soporte del servidor).  Para simplificar la gesti√≥n de priorizaci√≥n, hemos desarrollado un esquema m√°s simple que todav√≠a tiene toda la flexibilidad necesaria para una planificaci√≥n √≥ptima. <br><br>  El esquema de priorizaci√≥n de Cloudflare consta de 64 "niveles" prioritarios, y dentro de cada nivel hay grupos de recursos que determinan c√≥mo dividir la conexi√≥n entre ellos: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba5/7e5/efa/ba57e5efa56119a58bbd39596da3f9ce.png"><br><br>  Primero, todos los recursos se descargan en un nivel de prioridad m√°s alto, luego se realiza una transici√≥n a un nivel m√°s bajo. <br><br>  Dentro de un nivel de prioridad dado, hay tres grupos de concurrencia diferentes: <br><br><ul><li>  <b>0</b> : todos los recursos en el grupo "0" se env√≠an secuencialmente en el orden en que se solicitaron utilizando 100% de ancho de banda.  Solo despu√©s de cargar todos los recursos del grupo "0" se consideran otros grupos en el mismo nivel. <br></li><li>  <b>1</b> : todos los recursos en el grupo de concurrencia "1" se env√≠an secuencialmente en el orden en que se solicitaron.  El ancho de banda disponible se distribuye uniformemente entre el grupo de paralelismo "1" y el grupo de paralelismo "n". <br></li><li>  <b>n</b> : los recursos en el grupo de concurrencia "n" se transmiten en paralelo, compartiendo el ancho de banda disponible. </li></ul><br>  En la pr√°ctica, el grupo de paralelismo "0" es √∫til para contenido cr√≠tico que necesita ser procesado secuencialmente (scripts, CSS, etc.).  El grupo "1" es √∫til para contenido menos importante que puede compartir el ancho de banda con otros recursos, pero donde los recursos mismos se benefician del procesamiento secuencial (scripts as√≠ncronos, im√°genes no progresivas, etc.).  El grupo de concurrencia "n" es √∫til para los recursos que se benefician del procesamiento paralelo (im√°genes progresivas, video, audio, etc.). <br><br><h1>  Priorizaci√≥n predeterminada de Cloudflare </h1><br>  Con la opci√≥n de priorizaci√≥n avanzada, se implementa el orden "√≥ptimo" de carga de recursos, descrito anteriormente.  Las prioridades espec√≠ficas aplicadas son las siguientes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b89/e96/e4f/b89e96e4f4534f5df00d732e97b5db62.png"><br><br>  Este esquema le permite enviar secuencialmente recursos que bloquean la representaci√≥n, luego enviar im√°genes visibles en paralelo y luego el resto del contenido de la p√°gina con alg√∫n nivel de uso compartido de ancho de banda para equilibrar la carga de la aplicaci√≥n y el contenido.  La <i>advertencia * If Detectable</i> es que no todos los navegadores distinguen entre diferentes tipos de hojas de estilo y scripts, pero a√∫n as√≠ ser√° mucho m√°s r√°pido en todos los casos.  La aceleraci√≥n del 50%, especialmente para los visitantes de Edge y Safari, no ser√° nada inusual: <br><br> <a href=""><img src="https://habrastorage.org/webt/u_/1n/px/u_1npxrzhg0svmgdyzelnamxj84.png"></a> <br><br><h1>  Establecer prioridades con los trabajadores </h1><br>  El trabajo predeterminado m√°s r√°pido es excelente, pero se vuelve realmente interesante gracias a la capacidad de configurar la priorizaci√≥n con el soporte de Cloudflare Workers, por lo que los sitios pueden redefinir la prioridad predeterminada para los recursos o implementar sus propios esquemas de priorizaci√≥n. <br><br>  Si el trabajador agrega el encabezado de <code>cf-priority</code> a la respuesta, los servidores perimetrales de Cloudflare aplicar√°n la prioridad y concurrencia especificadas.  El formato del encabezado es &lt;priority&gt; / &lt;concurrency&gt;, por lo tanto, el <code>response.headers.set('cf-priority', ‚Äú30/0‚Äù);</code>  establecer√° la prioridad 30 y el paralelismo 0 para esta respuesta. Del mismo modo, "30/1" establecer√° el paralelismo "1" y "30 / n" establecer√° el paralelismo en n. <br><br>  Con tal flexibilidad, un sitio puede establecer una prioridad arbitraria de recursos para sus necesidades.  Por ejemplo, para aumentar la prioridad de algunos scripts as√≠ncronos o im√°genes principales importantes: se descargan incluso antes de que el navegador determine que est√°n dentro del alcance. <br><br>  Para informar sobre las decisiones de priorizaci√≥n, el tiempo de ejecuci√≥n de los trabajadores tambi√©n indica la informaci√≥n solicitada por el navegador sobre la priorizaci√≥n en el objeto de solicitud, que se pasa al receptor de los eventos del trabajador (request.cf.requestPriority).  Las prioridades entrantes son una lista de atributos separados por punto y coma.  Se parece a esto: <code>weight=192;exclusive=0;group=3;group-weight=127</code> . <br><br><ul><li>  <b>peso</b> : peso para priorizar HTTP / 2. <br></li><li>  <b>exclusivo</b> : el distintivo HTTP / 2 exclusivo (1 para navegadores basados ‚Äã‚Äãen Chromium, 0 para otros). <br></li><li>  <b>group</b> : identificador de flujo HTTP / 2 para el grupo de solicitud (distinto de cero para Firefox). <br></li><li>  <b>ponderaci√≥n de grupo</b> : <b>ponderaci√≥n</b> HTTP / 2 para el grupo de solicitudes (no es cero para Firefox). </li></ul><br><h1>  Esto es solo el comienzo. </h1><br>  La capacidad de configurar y controlar la prioridad de las respuestas es el principal componente para un gran trabajo futuro.  Tenemos la intenci√≥n de presentar nuestras propias optimizaciones avanzadas adem√°s de esto, pero con el apoyo de los trabajadores, todos los sitios e investigadores pueden experimentar con diversas estrategias de priorizaci√≥n.  A trav√©s del Mercado de aplicaciones, las empresas tambi√©n pueden crear nuevos servicios de optimizaci√≥n sobre la plataforma de trabajo y ponerlos a disposici√≥n de otros sitios. <br><br>  Si tiene un plan Pro o superior, vaya a la pesta√±a "Velocidad" en el panel de control de Cloudflare y habilite la "priorizaci√≥n HTTP / 2 avanzada" para acelerar su sitio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/386/d53/276/386d532767b6396ee628a7e0eb837282.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/452020/">https://habr.com/ru/post/452020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452004/index.html">Encontr√≥ el lugar del accidente de Bereshit en la luna</a></li>
<li><a href="../452006/index.html">Metaverso √©pico: por qu√© los autores de Fortnite deber√≠an obtenerlo</a></li>
<li><a href="../452008/index.html">Enfoques de ingenier√≠a y lista de verificaci√≥n: c√≥mo no volverse loco en el caos de las tareas</a></li>
<li><a href="../452010/index.html">Osmo Action: la primera c√°mara de acci√≥n de DJI</a></li>
<li><a href="../452016/index.html">12 a√±os en la nube</a></li>
<li><a href="../452022/index.html">Google informa a los usuarios sobre una vulnerabilidad con sus claves de seguridad Titan</a></li>
<li><a href="../452026/index.html">Hace 20 a√±os, Microsoft cambi√≥ para siempre la forma en que usamos el mouse</a></li>
<li><a href="../452028/index.html">Rayo de luz en el reino oscuro: como la tecnolog√≠a devuelve la visi√≥n perdida</a></li>
<li><a href="../452030/index.html">Historia de Internet: descubriendo la interactividad</a></li>
<li><a href="../452034/index.html">Autocontrol del tiempo para la autoeducaci√≥n y tiempo para leer libros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>