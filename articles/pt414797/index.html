<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßû ü§πüèø üñ®Ô∏è Como criamos linhas abertas na Bitrix24 üèì üëá üëÉüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje, os usu√°rios n√£o querem se comunicar com as empresas por e-mail e telefone, mas por meio de mensagens instant√¢neas e contas de m√≠dia social favor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como criamos linhas abertas na Bitrix24</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bitrix/blog/414797/">  Hoje, os usu√°rios n√£o querem se comunicar com as empresas por e-mail e telefone, mas por meio de mensagens instant√¢neas e contas de m√≠dia social favoritas. <br><br>  Em resposta, as redes sociais e os mensageiros instant√¢neos come√ßaram a introduzir novas funcionalidades.  VKontakte e Facebook lan√ßaram mensagens privadas para grupos e p√°ginas p√∫blicas. <br><br>  O telegrama, com seus canais e bots, tornou-se uma plataforma para publicar e interagir com o p√∫blico.  No Viber, contas p√∫blicas apareceram. <br><br>  Para obter o lucro m√°ximo, as empresas precisam usar todos os recursos de todas as plataformas sociais. <br><br>  Assim, a Open Lines nasceu - uma nova ferramenta para a intera√ß√£o dos clientes Bitrix24 com os usu√°rios finais. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/703/824/144/70382414416e170d5519600c0ee6cc58.png"><br><a name="habracut"></a><br>  O fluxo de trabalho do Open Lines √© direto: <br><br><ol><li>  Recebemos todas as mensagens de usu√°rios de mensageiros e redes sociais. </li><li>  N√≥s os roteamos usando o messenger ‚ÄúBitrix24‚Äù embutido.  Distribu√≠mos pelos operadores </li><li>  Os clientes respondem √†s mensagens e encaminhamos as respostas para os gerentes das empresas que trabalham na Bitrix24 </li></ol><br>  A principal tarefa de desenvolvimento deste projeto √© simplificar a conex√£o dos canais de comunica√ß√£o o m√°ximo poss√≠vel.  Para que qualquer gerente comum possa fazer isso.  Para fazer isso, tive que negociar com os desenvolvedores de todas as redes sociais integr√°veis ‚Äã‚Äãe mensageiros instant√¢neos - tudo √© oficial, sem truques. <br><br>  E para garantir uma opera√ß√£o est√°vel nas vers√µes em nuvem e em caixa do Bitrix24, criamos um servidor de conectores centralizado.  Ele processa todos os fluxos de informa√ß√£o. <br><br><h2>  VKontakte </h2><br>  O pr√≥ximo passo foi um dueto com os desenvolvedores do VKontakte.  Conseguimos criar o esquema ideal para trabalhar com o servi√ßo - agora fizemos v√°rias a√ß√µes t√©cnicas para os usu√°rios se conectarem. <br><br>  Agora, este VKontakte da API pode usar outros servi√ßos. <br><br>  Como √© a conex√£o do Open Lines para um usu√°rio comum: <br><br><ul><li>  Fa√ßa login no VK. </li><li>  Na se√ß√£o de conex√£o, selecione o grupo desejado. </li><li>  Confirme. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/87c/bbb/e8b/87cbbbe8b671c848012b7bcd48b05c9e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c29/31b/fcb/c2931bfcb0c36553963f5e75d2427ad0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b88/341/b78/b88341b78a35dc771280fbb6d8fbba43.png"><br><br>  Parece simples, mas apenas porque ocultamos toda a "cozinha" sob o cap√¥ - cerca de dez opera√ß√µes, junto com pedidos de chaves diferentes. <br><br><h2>  Skype </h2><br>  Mas com a Microsoft foi dif√≠cil.  Infelizmente, eles est√£o muito focados no pessoal de TI da "velha escola".  Conectar-se √† estrutura de bot acabou sendo dif√≠cil.  Agora, para isso, voc√™ precisa passar por uma miss√£o de horror: <br><br><ul><li>  Instale o aplicativo. </li><li>  Crie uma conta. </li><li>  No Skype, pegue uma chave. </li><li>  No Bitrix 24, outro. </li><li>  Para conectar. </li></ul><br><h2>  Viber </h2><br>  Tornamos essa integra√ß√£o uma das primeiras.  N√≥s constantemente nos comunicamos com os desenvolvedores do messenger.  E, em geral, mantiveram a m√£o no pulso.  Agora o Open Lines pode ser conectado a partir do Bitrix24 ou do aplicativo m√≥vel Viber. <br><br><h2>  Telegram </h2><br>  O telegrama possui uma API simples - a conex√£o √© simples.  E apesar de todos os bloqueios, agora tudo funciona. <br><br><h2>  Instagram </h2><br>  A integra√ß√£o com o Instagram √© uma das mais populares entre nossos clientes.  Mas, devido ao esc√¢ndalo com a dissemina√ß√£o de dados pessoais, o Instagram reduziu muito os recursos da API. <br><br>  Temos que "entrevist√°-lo" e determinar novas mensagens a cada 15 minutos por conta pr√≥pria.  Al√©m disso, a API permite que voc√™ receba n√£o as pr√≥prias mensagens, mas apenas coment√°rios nas postagens.  H√° tamb√©m um limite no n√∫mero de respostas por hora. <br><br>  Sistemas externos s√£o organismos vivos nos quais algo muda constantemente.  Na API de redes sociais e mensageiros instant√¢neos, algumas altera√ß√µes s√£o feitas, geralmente h√° alguns erros do lado ‚Äúoutro‚Äù. <br><br>  Um exemplo  VKontakte quebrou a codifica√ß√£o nos nomes das mercadorias, eles resolveram esse problema dentro de um ano.  O Instagram simplesmente n√£o avisou ningu√©m sobre a desativa√ß√£o de v√°rias fun√ß√µes da API - descobrimos depois que alguns recursos pararam de funcionar.  Tivemos que procurar solu√ß√µes em um modo de emerg√™ncia. <br><br>  Ap√≥s a integra√ß√£o bem-sucedida da rede social ou do messenger, voc√™ n√£o pode relaxar.  Constantemente, precisamos monitorar a corre√ß√£o do processamento das mensagens recebidas. <br><br><h2>  Servidor conector </h2><br>  A arquitetura Open Lines √© baseada em um servidor conector.  Este √© um ponto de entrada √∫nico no esquema de mensagens entre o messenger interno do Bitrix24 e mensageiros externos e redes sociais. <br><br>  Existem tr√™s tipos de canais de entrada no Open Lines: <br><br><ul><li>  Externo que funciona atrav√©s do servidor de filas. </li><li>  Bate-papo ao vivo que √© executado no portal do cliente.  Pegamos o c√≥digo do widget no portal do cliente.  E, neste caso, n√£o se fala em n√£o entrega de mensagens - se o portal estiver "mentindo", o widget de bate-papo simplesmente n√£o ser√° exibido. </li><li>  Rede - um canal que permite criar uma ‚ÄúLinha Aberta‚Äù e encontrar entre outros portais Bitrix24, incluindo os de caixa.  Isso √© especialmente verdade para nossos parceiros que desejam organizar bate-papos de suporte para as empresas clientes.  Tais chats funcionam atrav√©s da plataforma bot Bitrix24 e n√£o usam o servidor de conectores - todas as opera√ß√µes ocorrem dentro da nossa plataforma. </li></ul><br>  H√° uma nuance importante em todas as linhas abertas e conectores de conex√£o.  Sup√µe-se que o cliente seja sempre o primeiro a tomar a iniciativa.  S√≥ podemos responder √†s mensagens do usu√°rio.  Mas n√£o os escreva primeiro. <br><br>  O servidor est√° na nuvem e est√° dispon√≠vel 24/7.  Aceita mensagens do usu√°rio sem feriados e fins de semana.  Para um cliente com a vers√£o em caixa do Bitrix24, o portal pode estar temporariamente indispon√≠vel: o servidor travou ou ocorreu um problema com a Internet.  Nesses casos, as mensagens dos usu√°rios podem ser perdidas. <br><br>  O servidor do conector da nuvem resolve esse problema. <br><br>  Primeiro, ele encaminha as mensagens diretamente para os portais de destino.  Se um portal n√£o estiver dispon√≠vel, o servidor do conector acumular√° mensagens para esse portal durante o dia.  E tentando entreg√°-los ao portal. <br><br>  Calculamos que 24 horas s√£o suficientes para corrigir quaisquer problemas e reiniciar o portal da vers√£o em caixa.  Fizemos uma forte √™nfase no fato de que a ordem das mensagens n√£o muda.  Todo o conte√∫do ser√° entregue na ordem exata em que foi escrito.  Mensagens personalizadas, embora com atraso, mas ser√£o entregues. <br><br>  Todos os sistemas externos t√™m seus pr√≥prios formatos de mensagem, com seus pr√≥prios conjuntos de dados.  Em algum lugar voc√™ pode trocar emojis, fotos e outros arquivos.  E em algum lugar, apenas o texto est√° dispon√≠vel com um conjunto muito limitado de recursos. <br><br>  Servidor de conectores: <br><br><ul><li>  Converte todas as mensagens recebidas em um formato universal que os portais entendem. </li><li>  Criptografa dados e assina-os com uma chave de licen√ßa. </li><li>  Envia para portais. </li></ul><br>  A criptografia √© necess√°ria n√£o apenas para proteger a correspond√™ncia em si, mas tamb√©m para confirmar a autenticidade das partes. <br><br>  Depois de unificar o formato da mensagem, elas s√£o colocadas na fila.  A partir disso, eles se espalham para os destinat√°rios. <br><br>  As redes sociais podem gerar mensagens com uma frequ√™ncia impressionante, mas nem todos os portais de clientes podem ter hardware poderoso.  Outras tarefas podem ser executadas em paralelo na mesma m√°quina. <br><br>  E se as mensagens v√£o "eixo" - h√° uma possibilidade de duplica√ß√£o de sess√µes.  Para impedir que isso aconte√ßa, as mensagens s√£o enviadas para cada portal em um √∫nico fluxo, em pacotes e com um pequeno atraso. <br><br>  Agora, a vez est√° girando no servidor do conector, mas j√° temos um servidor escal√°vel separado.  Ele suporta filas de v√°rios tipos: <br><br><ol><li>  Paralelo em v√°rios segmentos. </li><li>  Sequencial em um segmento. </li></ol><br>  A entrega pode ser: <br><br><ol><li>  Garantido.  Muitas tentativas. </li><li>  Indevida.  Uma tentativa. </li></ol><br>  Em breve transferiremos para este servidor os conectores de redes sociais, plataformas de bot e mensageiros instant√¢neos.  Viva! <br><br><h2>  Configurar e processar mensagens </h2><br>  Tentamos tornar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conex√£o e configura√ß√£o do</a> Open Lines o mais simples poss√≠vel. <br><br>  O Bitrix24 √© usado por uma grande variedade de empresas, desde grandes representantes do neg√≥cio de TI a empreendedores individuais que vendem autope√ßas.  √â ainda mais f√°cil para um administrador de TI fazer alguns cliques.  E n√£o estude a documenta√ß√£o, registre chaves e configura√ß√µes. <br><br>  Em "Linhas abertas", existem v√°rias configura√ß√µes para a fila do operador, hor√°rio de trabalho, trabalho com CRM, v√°rios rastreadores de bate-papo e formul√°rios. <br><br>  O sistema leva em considera√ß√£o se o dia √∫til come√ßou com um operador espec√≠fico, seja online ou offline, e v√°rios outros par√¢metros. <br><br>  Para processar mensagens, os operadores usam o aplicativo Bitrix24 ou o messenger embutido.  Existem ferramentas de gerenciamento adicionais: aceitar, pular, rejeitar, concluir. <br><br>  Ap√≥s concluir a correspond√™ncia com o usu√°rio, o sistema pode solicitar automaticamente que ele avalie. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt414797/">https://habr.com/ru/post/pt414797/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt414785/index.html">Visualiza√ß√£o de dados com Angular e D3</a></li>
<li><a href="../pt414787/index.html">Novo Android RAT usa protocolo Telegram</a></li>
<li><a href="../pt414789/index.html">O Tesla Model S est√° novamente ligado e a sabotagem intencional [de acordo com Elon Mask] √© revelada na oficina de montagem do Modelo 3</a></li>
<li><a href="../pt414791/index.html">Semin√°rio "Infraestrutura virtual para desenvolvedores: oportunidades, aplicativos e servi√ßos", 28 de junho, S√£o Petersburgo</a></li>
<li><a href="../pt414793/index.html">Como os canais de pagamento e a rede de raios funcionam no Bitcoin?</a></li>
<li><a href="../pt414799/index.html">LLTR Parte 0: Detec√ß√£o autom√°tica de topologia de rede e comutadores n√£o gerenciados. Miss√£o imposs√≠vel?</a></li>
<li><a href="../pt414801/index.html">Moscow Vue.js Meetup # 2 no grupo Mail.Ru</a></li>
<li><a href="../pt414803/index.html">Como vimos os pagamentos da IoT em um hackathon em Hong Kong</a></li>
<li><a href="../pt414805/index.html">Semin√°rio on-line aberto "M√©todos alternativos de recrutamento"</a></li>
<li><a href="../pt414809/index.html">Swift 4.1: por que a Apple renomeou flatMap para compactMap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>