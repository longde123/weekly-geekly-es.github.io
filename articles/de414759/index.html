<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👩🏽 ⛷️ 😺 Servlet-Wettbewerb 🎮 👍🏼 ☣️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! 

 Wir starten den siebten Stream des Java Developer- Kurses. In mehr als einem Jahr des Bestehens dieses Kurses wurde er verfeinert...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Servlet-Wettbewerb</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/414759/">  Hallo allerseits! <br><br>  Wir starten den siebten Stream des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java Developer-</a> Kurses.  In mehr als einem Jahr des Bestehens dieses Kurses wurde er verfeinert, verfeinert und ein neuer hinzugefügt, der über diese Zeit hinausging.  Der gleiche Strom unterscheidet sich vom Rest dadurch, dass wir ein neues System von Schritten eingeführt haben, das den Kurs in drei Teile aufteilt und seine Gesamtdauer leicht erhöht.  Jetzt muss man nicht mehr fünf Monate hintereinander erschöpft sein, um ein Zertifikat zu erhalten, sondern in Ruhe zwei Monate wählen und sich einer Schulung unterziehen.  Aber dies sind die Texte. Kehren wir zu unserer Tradition über die verschiedenen Dienstprogramme vor dem Start des Kurses zurück. <br><br>  Lass uns gehen. <br><br><h3>  1. Übersicht </h3><br>  Der Java-Servlet-Container (oder Webserver) ist multithreaded: Es können mehrere Anforderungen an dasselbe Servlet gleichzeitig ausgeführt werden.  Daher müssen Sie beim Schreiben eines Servlets den Wettbewerb berücksichtigen. <br><br>  Wie bereits erwähnt, wird nur eine Servlet-Instanz erstellt, und für jede neue Anforderung erstellt der Servlet-Container einen neuen Thread, um die Methoden doGet () oder doPost () des Servlets auszuführen. <br><br>  Standardmäßig sind Servlets nicht threadsicher, der Programmierer muss sich selbst darum kümmern.  In diesem Kapitel werden wir den Servlet-Wettbewerb diskutieren.  Dies ist ein sehr wichtiges Konzept, also konzentrieren Sie sich. <br><br><h3>  2. Übersicht der Threads </h3><br><img src="https://habrastorage.org/webt/pd/ny/_n/pdny_ncj8kfu4odnv_15o_p6-ua.png"><a name="habracut"></a><br><br>  Ein Thread ist ein einfacher Prozess, der über einen eigenen Aufrufstapel verfügt und auf die offenen Daten anderer Threads im selben Prozess zugreift (gemeinsam genutzter Heap).  Jeder Thread hat seinen eigenen Cache. <br><br>  Wenn wir sagen, dass ein Programm Multithreading ist, meinen wir, dass dieselbe Instanz eines Objekts mehrere Threads generiert und ein einzelnes Codeelement verarbeitet.  Dies bedeutet, dass mehrere aufeinanderfolgende Steuerflüsse denselben Speicherblock durchlaufen.  Daher führen mehrere Threads eine Instanz eines Programms aus und teilen daher Instanzvariablen und können versuchen, diese gemeinsam genutzten Variablen zu lesen und zu schreiben. <br><br>  Schauen wir uns ein einfaches Java-Beispiel an. <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Counter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> counter=<span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(“Inital Counter = ” + counter); counter ++; System.out.println(“Post Increment Counter = ” + counter); } }</code> </pre> <br>  Jetzt erstellen wir zwei Threads Thread1 und Thread2, um <code>doSomething()</code> auszuführen.  Infolgedessen ist es möglich, dass: <br><br><ol><li>  Thread1 liest einen Zählerwert von 10 </li><li>  Zeigt den Anfangszähler = 10 an und wird erhöht </li><li>  Bevor Thread1 den Zähler erhöht, erhöht Thread2 auch den Zähler und ändert den Zähler auf 11 </li><li>  Infolgedessen hat Thread1 einen Zählerwert von 10, der bereits veraltet ist </li></ol><br>  Dieses Szenario ist in einer Umgebung mit mehreren Threads wie Servlets möglich, da Instanzvariablen von allen Threads gemeinsam genutzt werden, die in derselben Instanz ausgeführt werden. <br><br><h3>  3. Thread-sichere Servlets schreiben </h3><br>  Ich hoffe, dass Sie in diesem Abschnitt die Probleme verstehen, die ich hervorheben möchte.  Wenn Sie irgendwelche Zweifel haben, lesen Sie Punkt 2 noch einmal. <br><br>  Es gibt einige Punkte, die wir beim Schreiben von Servlets berücksichtigen müssen. <br><br><ol><li>  <code>Service()</code> , <code>doGet()</code> , <code>doPost()</code> oder allgemeiner die Methoden <code>doXXX()</code> sollten <code>doXXX()</code> nicht aktualisieren oder ändern, da Instanzvariablen von allen Threads derselben Instanz gemeinsam genutzt werden. </li><li>  Wenn die Instanzvariable geändert werden muss, führen Sie dies in einem synchronisierten Block durch. </li><li>  Beide oben genannten Regeln gelten auch für statische Variablen, da sie ebenfalls häufig vorkommen. </li><li>  Lokale Variablen sind immer threadsicher. </li><li>  Die Anforderungs- und Antwortobjekte sind für die Verwendung threadsicher, da für jede Anforderung in Ihrem Servlet und daher für jeden in Ihrem Servlet ausgeführten Thread eine neue Instanz erstellt wird. </li></ol><br>  Das Folgende sind zwei Ansätze zur Gewährleistung der Gewindesicherheit: <br><br>  a) Synchronisieren Sie den Block, in dem Sie die Instanz oder statische Variablen ändern (siehe den folgenden Codeausschnitt). <br><br>  Wir empfehlen, dass Sie den Block synchronisieren, in dem Ihr Code die Instanzvariablen ändert, anstatt die vollständige Methode zu synchronisieren, um die Leistung zu verbessern. <br><br>  Beachten Sie, dass wir die Servlet-Instanz sperren müssen, um den spezifischen Thread der Servlet-Instanz sicher zu machen. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreadSafeServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doGet</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ServletException, IOException </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> counter</span></span>; { <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//code in this block is thread-safe so update the instance variable } //other processing; }</span></span></code> </pre> <br>  b) Single-Thread-Modell - Implementieren Sie die SingleThreadModel-Schnittstelle, um den Thread Single-Threaded zu machen. Dies bedeutet, dass jeweils nur ein Thread die Methode service () oder doXXX () ausführt.  Ein Single-Threaded-Servlet ist unter Last langsamer, da neue Anforderungen auf die Verarbeitung einer freien Instanz warten müssen <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreadSafeServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleThreadModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> counter; <span class="hljs-comment"><span class="hljs-comment">// no need to synchronize as implemented SingleThreadModel @override public void doGet (HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { }</span></span></code> </pre> <br>  Die Verwendung von SingleThreadModel ist veraltet, da empfohlen wird, synchronisierte Blöcke zu verwenden. <br><br><h3>  4. Fazit </h3><br>  Wir müssen beim Schreiben von Servlets sehr vorsichtig sein, da "Servlets standardmäßig nicht threadsicher sind" <br><br><ol><li>  Wenn Ihr Servlet keine statische Variable oder Mitgliedsvariable hat, brauchen Sie sich keine Sorgen zu machen, und Ihr Servlet ist threadsicher </li><li>  Wenn Ihr Servlet nur die Instanzvariable liest, ist Ihr Servlet threadsicher. </li><li>  Wenn Sie eine Instanz oder statische Variablen ändern müssen, aktualisieren Sie sie in einem synchronisierten Block, wobei die Instanz gesperrt bleibt </li></ol><br>  Wenn Sie die oben genannten Regeln befolgen und das nächste Mal jemand Sie fragt: "Ist der Servlet-Thread sicher?"  - Antworten Sie sicher: "Standardmäßig sind sie nicht, aber" Meine Servlets "sind threadsicher." <br><br>  DAS ENDE <br><br>  Wie immer warten wir hier auf Ihre Fragen, Vorschläge usw. oder Sie können Sergey Petrelevich bei der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Open-Lektion zum</a> Thema Multithreading fragen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414759/">https://habr.com/ru/post/de414759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414749/index.html">Gentleman Sysadmin eingestellt</a></li>
<li><a href="../de414751/index.html">WSUS mit Ansible und mehr zähmen</a></li>
<li><a href="../de414753/index.html">PCIe-Bus: Beeinflussen physikalische Einschränkungen die Übertragungsrate?</a></li>
<li><a href="../de414755/index.html">Hackathon ist die Lösung des Problems</a></li>
<li><a href="../de414757/index.html">Modernes Präsentationsformat</a></li>
<li><a href="../de414761/index.html">5 kreative Nachrichtenseiten in Englisch</a></li>
<li><a href="../de414763/index.html">Vier Arten von Produktmanagerfehlern, die vermieden werden können (und sollten)</a></li>
<li><a href="../de414767/index.html">Implementieren Sie IdM. Wen soll ich gehen, um Probleme zu lösen?</a></li>
<li><a href="../de414769/index.html">Starten Sie das mobile Retargeting mit Appsflyer: Einstellungen, Berichte und Links</a></li>
<li><a href="../de414771/index.html">DevOps on HightLoad ++ Siberia: Mythen entlarven und Tools diskutieren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>