<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ต๐พ ๐ฑ ๐๏ธ 3D ูุนุจุฉ ุชุธููู ูููุจุชุฏุฆูู: ุงูุขุซุงุฑ ๐คฆ ๐ฉ๐ฝ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[ ุงูุฌุฒุก ุงูุฃูู ] 

 ุจุนุฏ ุงูุชุนุงูู ูุน ุงูุฃุณุงุณูุงุช ุ ูู ูุฐุง ุงูุฌุฒุก ูู ุงูููุงูุฉ ุ ูููู ุจุชูููุฐ ุชุฃุซูุฑุงุช ูุซู ุญุฏูุฏ ุงููุงุฆู ุ bloom ุ SSAO ุ ุทูุณ ุ ุนูู ุงููุฌุงู ุ ุงูุจูุณู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>3D ูุนุจุฉ ุชุธููู ูููุจุชุฏุฆูู: ุงูุขุซุงุฑ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453692/" style=";text-align:right;direction:rtl">  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฌุฒุก ุงูุฃูู</a> ] <br><br>  ุจุนุฏ ุงูุชุนุงูู ูุน ุงูุฃุณุงุณูุงุช ุ ูู ูุฐุง ุงูุฌุฒุก ูู ุงูููุงูุฉ ุ ูููู ุจุชูููุฐ ุชุฃุซูุฑุงุช ูุซู ุญุฏูุฏ ุงููุงุฆู ุ bloom ุ SSAO ุ ุทูุณ ุ ุนูู ุงููุฌุงู ุ ุงูุจูุณู ุ ูุบูุฑูุง. <br><br><h2 style=";text-align:right;direction:rtl">  ุญุฏูุฏ </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3b8/96f/9b2/3b896f9b246e1695fa908b4bdc145480.gif"></div><br>  ูุนุทู ุฅูุดุงุก ูุนุงูู ุญูู ููุฏุณุฉ ุงููุดูุฏ ููุนุจุฉ ูุธูุฑูุง ูุฑูุฏูุง ูุดุจู ุงูููููุฏูุง โโุฃู ุงูุฑุณูู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุดุฑ ุงูููุงุฏ </h3><br>  ูุญุชุงุฌ ุชุธููู ุงูููุชูุฑ ุฅูู ูุงุฏุฉ ุฅุฏุฎุงู ููุชุนุฑู ุนูู ุงูุญูุงู ูุชูููููุง.  ูููู ูููุฑุดุญูู ููุซู ูุฐุง ุงููููุณ ุงููุงุฑุฏ ุฃู ูููู ููููุง ููุชุดุฑูุง ูู ููุงุฏ ุฃู ุฃููุงู ูู ููุงุฏ ููุชุดุฑุฉ ุฃู ุฃุดูุงู ุฑุฃุณูุฉ ุนุงุฏูุฉ ุฃู ุญุชู ุฃููุงู ูู ุงูุฎุฑุงุฆุท ุงูุนุงุฏูุฉ. <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs">uniform <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> vec4 diffuse ; } p3d_Material; out vec4 fragColor; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ vec3 diffuseColor = p3d_Material.diffuse.rgb; fragColor = vec4(diffuseColor, <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br>  ูุฐุง ูู ุชุธููู ุดุธูุฉ ุตุบูุฑ ูุฌุนู ุงูููู ุงูููุชุดุฑ ููุงุฏุฉ ููุฏุณูุฉ ูู ูุณูุฌ ุนุงุฒูุฉ ููุฅุทุงุฑ.  ุณูููู ูุฐุง ุงููููุณ ุงููููู ุงูููุชุดุฑ ูู ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ ูู ูุณูุฌ ุงูุฅุฏุฎุงู ูุชุธููู ุงููุณุงุฑ. <br><a name="habracut"></a><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f0b/abd/05c/f0babd05caf7104156c15929995c9279.gif"></div><br>  ูุฐุง ูู ูุณูุฌ ุงูููู ุงูููุชุดุฑ ูููุงุฏุฉ ูู ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ ุ ูุงูุฐู ูุนุฑุถ ุงูุฃููุงู ุงูุชู ูููุง ุจุชุนููููุง ูู Blender.  ุณูู ูุชุนุฑู ุชุธููู ุงููุญูุท ุนูู ุงูุญูุงู ุงูููุฌูุฏุฉ ูู ุงููุดูุฏ ููููููุง. <br><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูููู ุงูููุชุดุฑ ููููุงุฏ ูู ูุนูู ุฅุฐุง ูู ููู ูุฏู ุฃุฌุฒุงุก ูุนููุฉ ูู ุงููุดูุฏ ููู ููุชุดุฑ ุฎุงุต ุจูุง ูู ุงููุงุฏุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฎูู ุญูุงู </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/33a/a0d/57a/33aa0d57aeba90366ddd95865ea0d6c6.gif"></div><br>  ูุดุจู ุฅูุดุงุก ุงูุญูุงู ุงุณุชุฎุฏุงู ูุฑุดุญุงุช ุงูุชุนุฑู ุนูู ุงูุญูุงู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GIMP</a> . <br><br>  ูุชู ุฅุฌุฑุงุก ุฌููุน ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงูุฎุงุตุฉ ุจุชูููุฉ ุงูุชุธููู ูุฐู ูู ุชุธููู ุงูุฃุฌุฒุงุก.  ูุฅูุดุงุก ุญุฏูุฏ ูุชุธููู ููุฉ ุงูุฑุฃุณ ุ ูููู ุชูุฑูุฑ ุฃุฑุจุนุฉ ุฑุคูุณ ูู ุดุจูุฉ ูุณุชุทููุฉ ุฅูู ุงูุฅุฎุฑุงุฌ ูุชูุงุณุจ ุงูุดุงุดุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// ... uniform sampler2D materialDiffuseTexture; // ... vec2 texSize = textureSize(materialDiffuseTexture, 0).xy; vec2 texCoord = gl_FragCoord.xy; // ...</span></span></code> </pre> <br>  ูุจู ุฃู ุชุจุฏุฃ ูู ุงูุชุนุฑู ุนูู ุงูุญูุงู ุ ุชุญุชุงุฌ ุฅูู ุฅุนุฏุงุฏ ุงููููุณ ุงููุงุฑุฏ ุ ุงูุฐู ุณูุนูู ุจู.  ูุธุฑูุง ูุฃู ุงููุณูุฌ ูุญุชูู ุนูู ุญุฌู ุงูุดุงุดุฉ ุ ูููููุง ุญุณุงุจ ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุ ููุนุฑูุฉ ุฅุญุฏุงุซูุงุช ุงูุฌุฒุก ูุญุฌู ุงููุณูุฌ ุงููุงุฑุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... int separation = 1; // ...</span></span></code> </pre> <br>  ูููู ุชุฎุตูุต <code>separation</code> ูููุงุณุจ ุฐููู.  ูููุง ุฒุงุฏ ุงููุตู ุ ุฒุงุฏุช ุณูุงูุฉ ุงูุญูุงู ุฃู ุงูุฎุทูุท. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float threshold = 0; // ... vec4 mx = vec4(0); vec4 mn = vec4(1); int x = -1; int y = -1; for (int i = 0; i &lt; 9; ++i) { vec4 color = texture ( materialDiffuseTexture , (texCoord + (vec2(x, y) * separation)) / texSize ); mx = max(color, mx); mn = min(color, mn); x += 1; if (x &gt;= 2) { x = -1; y += 1; } } float alpha = ((mx.r + mx.g + mx.b) / 3) - ((mn.r + mn.g + mn.b) / 3); if (alpha &gt; threshold) { alpha = 1; } // ...</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/42f/d24/e56/42fd24e5682700e1e7cd5186bebc33af.gif"></div><br>  ุชููู ุชูููุฉ ุงูุชุนุฑู ุนูู ุงูุญุงูุฉ ุจุงูุนุซูุฑ ุนูู ุชุบููุฑุงุช ูู ุฃููุงู ุงููุณูุฌ ุงููุงุฑุฏ.  ูุน ุงูุชุฑููุฒ ุนูู ุงูุฌุฒุก ุงูุญุงูู ุ ูุฅูู ูุณุชุฎุฏู ูุงูุฐุฉ ุงูุฃุฌุฒุงุก 3 ร 3 ููุนุซูุฑ ุนูู ุงูุฃููุงู ุงูุฃูุซุฑ ุณุทูุนูุง ูุธูุงููุง ูู ุงูุนููุงุช ุงูุชุณุนุฉ.  ุซู ุชุทุฑุญ ูู ุณุทูุน ููู ูุงุญุฏ ุณุทูุน ุขุฎุฑ ุ ูุงูุญุตูู ุนูู ุงููุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec3 lineRgb = vec3(0.012, 0.014, 0.022); // ... vec4 lineColor = vec4(lineRgb, alpha); // ... fragColor = lineColor; // ...</span></span></code> </pre> <br>  ูุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูุงุฎุชูุงู ูู ููุงุฉ ุฃููุง ูู ููู ุงูุฅุฎุฑุงุฌ.  ุฅุฐุง ูู ููู ููุงู ูุฑู ุ ููุง ูุชู ุฑุณู ุงูุญุงูุฉ ุฃู ุงูุฎุท.  ุฅุฐุง ูุงู ููุงู ูุฑู ุ ูุชู ุฑุณู ุงูุญุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float threshold = 0; // ... if (alpha &gt; threshold) { alpha = 1; } // ...</span></span></code> </pre> <br>  ุญุงูู ุชุฌุฑุจุฉ ุงููููุฉ ุงูุนุชุจุฉ.  ุงูุขู ูู ุตูุฑ.  ุชุตุจุญ ุฃู ูููุฉ ุบูุฑ ุตูุฑูุฉ ููุฒุฉ ุ ูููู ุชุบููุฑ ูุฐู ุงูุนุชุจุฉ.  ูุฐุง ูููุฏ ุจุดูู ุฎุงุต ููููุงู ุงููุงุฑุฏุฉ ุงูุตุงุฎุจุฉ ูุน ูุฌูุฏ ุงุฎุชูุงูุงุช ุตุบูุฑุฉ.  ูู ุญุงูุฉ ูุฌูุฏ ูุงุฏุฉ ูุงุฑุฏุฉ ุตุงุฎุจุฉ ุ ุชุญุชุงุฌ ุนุงุฏุฉู ุฅูู ุฅูุดุงุก ุญุฏูุฏ ุฎุงุฑุฌูุฉ ููุท ููุงุฎุชูุงูุงุช ุงููุจูุฑุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงููุตุฏุฑ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">main.cxx</a> </li><li style=";text-align:right;direction:rtl">  <a href="">base.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">basic.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">ุงูููุงุฏ diffuse.frag</a> </li><li style=";text-align:right;direction:rtl">  <a href="">outline.frag</a> </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุถุจุงุจ </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5af/02c/e52/5af02ce52f813b27461f79e5dca5fe20.gif"></div><br>  ูุถูู ุงูุถุจุงุจ (ุฃู ุงูุถุจุงุจ ุ ููุง ูุทูู ุนููู ูู Blender) ุงูุถุจุงุจ ูู ุงูุฌู ุ ููุง ูุฎูู ุฃุฌุฒุงุก ุจุงุฑุฒุฉ ุบุงูุถุฉ ูุงุนูุฉ.  ุชุธูุฑ ุงูุฃุฌุฒุงุก ุงูุจุงุฑุฒุฉ ุนูุฏูุง ุชุณูุท ุจุนุถ ุงูุฃุดูุงู ุงูููุฏุณูุฉ ูุฌุฃุฉ ูู ูุฑู ุฑุคูุฉ ุงููุงููุฑุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// ... uniform struct p3d_FogParameters { vec4 color ; float start ; float end ; } p3d_Fog; // ...</span></span></code> </pre> <br>  ูุญุชูู Panda3D ุนูู ุจููุฉ ุจูุงูุงุช ูุฑูุญุฉ ุชุญุชูู ุนูู ุฌููุน ูุนููุงุช ุงูุถุจุงุจ ุ ูููู ููููู ููููุง ุฅูู ุชุธูููู ูุฏูููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float fogIntensity = clamp ( ( p3d_Fog.end - vertexPosition.y) / ( p3d_Fog.end - p3d_Fog.start) , 0 , 1 ); fogIntensity = 1 - fogIntensity; // ...</span></span></code> </pre> <br>  ูู ูุซุงู ุงูููุฏ ุ ูุชู ุงุณุชุฎุฏุงู ูููุฐุฌ ุฎุทู ูุญุณุงุจ ุณุทูุน ุงูุถุจุงุจ ุนูุฏ ุงูุงุจุชุนุงุฏ ุนู ุงููุงููุฑุง.  ุจุฏูุงู ูู ุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุฃุณู.  ุณุทูุน ุงูุถุจุงุจ ูู ุตูุฑ ูุจู ุฃู ูู ุจุฏุงูุฉ ุงูุถุจุงุจ.  ุนูุฏูุง ููุชุฑุจ ููุถุน ููุฉ ุงูุฑุฃุณ ูู ููุงูุฉ ุงูุถุจุงุจ ุ ููุชุฑุจ <code>fogIntensity</code> ุงููุญุฏุฉ.  ุจุงููุณุจุฉ ูุฌููุน ุงูููู ุจุนุฏ ููุงูุฉ ุงูุถุจุงุจ ุ ุชูุชุตุฑ <code>fogIntensity</code> ุงูุถุจุงุจ ุนูู 1 ูู ุฃุนูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... fragColor = mix ( outputColor , p3d_Fog.color , fogIntensity ); // ...</span></span></code> </pre> <br>  ุงุณุชูุงุฏูุง ุฅูู ุณุทูุน ุงูุถุจุงุจ ุ ููุฒุฌ ููู ุงูุถุจุงุจ ูุน ููู ุงููุฎุฑุฌุงุช.  ูุน ุงูุชุฑุงุจ <code>fogIntensity</code> ุงููุญุฏุฉ ุ ุณูููู ููุงู ุฃูู ูุฃูู ูู <code>outputColor</code> ูููู ุถุจุงุจ ุฃูุซุฑ ูุฃูุซุฑ.  ุนูุฏูุง ูุตู <code>fogIntensity</code> ุฅูู ุงููุญุฏุฉ ุ <code>fogIntensity</code> ููุท ููู ุงูุถุจุงุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ุถุจุงุจ ุนูู ุงูุฎุทูุท </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e1f/ee8/d49/e1fee8d490abe10ecb798df618f183f7.gif"></div><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// ... uniform sampler2D positionTexture; // ... vec4 position = texture(positionTexture, texCoord / texSize); float fogIntensity = clamp ( ( p3d_Fog.end - position.y) / ( p3d_Fog.end - p3d_Fog.start) , 0 , 1 ); fogIntensity = 1 - fogIntensity; vec4 lineWithFogColor = mix ( lineColor , p3d_Fog.color , fogIntensity ); fragColor = vec4(lineWithFogColor.rgb, alpha); // ...</span></span></code> </pre> <br>  ูุทุจู Path Shader ุงูุถุจุงุจ ุนูู ุฃููุงู ุงูุญูุงู ููุญุตูู ุนูู ุตูุฑุฉ ุฃูุซุฑ ุดููููุฉ.  ุฅุฐุง ูู ููุนู ุฐูู ุ ูุณูุชู ุฅุฎูุงุก ุงูุถุจุงุจ ุ ุญูุซ ุณุชุจุฏู ููุฏุณุฉ ุงูุฃููุฉ ุบุงูุถุฉ.  ููุน ุฐูู ุ ูุง ุฒุงู ูุฎูู ุญุฏูุฏูุง ุนูู ุงูุญูุงู ุงูุฎุงุฑุฌูุฉ ูููุฏุณุฉ ุงููุฑุญูุฉ ุจุงุณุชุฎุฏุงู ุงููุทุญูุฉ ุ ูุฃู ุงูุญูุงู ุชุชุฌุงูุฒ ุงูุดูู ุงูููุฏุณู - ุฅูู ุญูุซ ูุง ุชูุฌุฏ ููุงุถุน ููุฉ. <br><br>  <code>positionTexture</code> ูู ูุณูุฌ ุนุงุฒู ุฅุทุงุฑ ูุญุชูู ุนูู ููุงุถุน ุฑุคูุณ ูุณุงุญุฉ ุงูุนุฑุถ.  ุณูู ุชุชุนูู ุนู ูุฐุง ุนูุฏูุง ูุทุจู ุชุธููู SSAO. <br><br><h3 style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงููุตุฏุฑ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">main.cxx</a> </li><li style=";text-align:right;direction:rtl">  <a href="">base.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">basic.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">base.frag</a> </li><li style=";text-align:right;direction:rtl">  <a href="">outline.frag</a> </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุฅุฒูุงุฑ </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/31d/744/f35/31d744f35168ac87f609474998802b12.gif"></div><br>  ูููู ุฃู ุชุคุฏู ุฅุถุงูุฉ ุงูุฅุฒูุงุฑ ุฅูู ุงููุดูุฏ ุฅูู ุฎูู ููู ูููุน ููููุฐุฌ ุงูุฅุถุงุกุฉ.  ุงูุฃุฌุณุงู ุงูุจุงุนุซุฉ ููุถูุก ุชุตุจุญ ุฃูุซุฑ ุฅููุงุนูุง ุ ูุชุชููู ุงูุนูุงุณุงุช ุงูุถูุก ูููุฉ ุฅุถุงููุฉ ูู ุงูุฅุดุนุงุน. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">//... float separation = 3; int samples = 15; float threshold = 0.5; float amount = 1; // ...</span></span></code> </pre> <br>  ููููู ุชุฎุตูุต ูุฐู ุงูุฅุนุฏุงุฏุงุช ุญุณุจ ุฑุบุจุชู.  ูุตู ูุฒูุฏ ูู ุญุฌู ุทูุณ.  ุนููุงุช ุชุญุฏุฏ ููุฉ ุงูุชูููู.  ุงูุนุชุจุฉ ุชุญุฏุฏ ูุง ุณูู ููู ูุชุฃุซุฑ ุจูุฐุง ุงูุชุฃุซูุฑ.  ูุชุญูู ุงููุจูุบ ูู ููุฏุงุฑ ูุงุชุฌ ุงูุฅุฒูุงุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... int size = samples; int size2 = size * size; int x = 0; int y = 0; // ... float value = 0; vec4 result = vec4(0); vec4 color = vec4(0); // ... for (int i = 0; i &lt; size2; ++i) { // ... } // ...</span></span></code> </pre> <br>  ุชุจุฏุฃ ูุฐู ุงูุชูููุฉ ุจุชูุฑูุฑ <code>samples</code> ุจุญุฌู ุงููุงูุฐุฉ ุนูู <code>samples</code> ุชูุฑูุฒูุง ุจุงููุณุจุฉ ููุฌุฒุก ุงูุญุงูู.  ูุจุฏู ููุฃูู ูุงูุฐุฉ ุชุณุชุฎุฏู ูุฅูุดุงุก ูุณุงุฑุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... color = texture ( bloomTexture , ( gl_FragCoord.xy + vec2(x * separation, y * separation) ) / texSize ); value = ((0.3 * color.r) + (0.59 * color.g) + (0.11 * color.b)); if (value &lt; threshold) { color = vec4(0); } result += color; // ...</span></span></code> </pre> <br>  ูุญุตู ูุฐุง ุงูุฑูุฒ ุนูู ุงูููู ูู ุงููุณูุฌ ุงููุงุฑุฏ ููุญูู ููู ุงูุฃุญูุฑ ูุงูุฃุฎุถุฑ ูุงูุฃุฒุฑู ุฅูู ูููุฉ ุจุชุฏุฑุฌ ุงูุฑูุงุฏู.  ุฅุฐุง ูุงูุช ุงููููุฉ ูู ุงูุชุฏุฑุฌ ุงูุฑูุงุฏู ุฃูู ูู ุงูุนุชุจุฉ ุ ูุฅููุง ุชุชุฌุงูู ูุฐุง ุงูููู ุ ููุง ูุฌุนูู ุฃุณูุฏ. <br><br>  ูุฑูุฑุง ุจุฌููุน ุงูุนููุงุช ุฏุงุฎู ุงููุงูุฐุฉ ุ ูุฅูู ูุฌูุน ูู ููููุง ูู <code>result</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... result = result / size2; // ...</span></span></code> </pre> <br>  ุจุนุฏ ุงูุงูุชูุงุก ูู ุฌูุน ุงูุนููุงุช ุ ููุณู ูุฌููุน ุนููุงุช ุงูุฃููุงู ุนูู ุนุฏุฏ ุงูุนููุงุช ุงูุชู ุชู ุงูุชูุงุทูุง.  ูุงููุชูุฌุฉ ูู ุงูููู ุงูุฃูุณุท ููุดุธูุฉ ููุณูุง ูุฌูุฑุงููุง.  ูู ุฎูุงู ุงูููุงู ุจุฐูู ููู ุฌุฒุก ุ ูุญุตู ุนูู ุตูุฑุฉ ุถุจุงุจูุฉ.  ูุฐุง ุงูููุน ูู ุงูุถุจุงุจูุฉ ูุณูู ูุฑุจุน ุงูุถุจุงุจูุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f90/16f/ea4/f9016fea492bc7b136ef6437a683c937.gif"></div><br>  ููุง ุชุฑู ุนูููุฉ ุชูููุฐ ุฎูุงุฑุฒููุฉ ุงุฒูุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงููุตุฏุฑ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">main.cxx</a> </li><li style=";text-align:right;direction:rtl">  <a href="">basic.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">bloom.frag</a> </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงูุณุฏุงุฏ ูุณุงุญุฉ ุงูุดุงุดุฉ ุงููุญูุทุฉ (SSAO) </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f93/5ab/5bf/f935ab5bf4794caae3be90b611ad771c.gif"></div><br>  SSAO ูู ุฃุญุฏ ุชูู ุงูุขุซุงุฑ ุงูุชู ูุง ุชุนุฑู ูุฌูุฏูุง ุ ูููู ุจูุฌุฑุฏ ุฃู ุชุนุฑู ุฃูู ูู ูุนุฏ ุจุฅููุงูู ุงูุนูุด ุจุฏูููุง.  ููููู ุชุญููู ุงููุดูุฏ ุงููุชูุณุท โโุฅูู ูุดูุฏ ุฑุงุฆุน!  ูู ุงููุดุงูุฏ ุงูุณุงููุฉ ุ ูููู ุชุบุทูุฉ ุงูุงูุณุฏุงุฏ ุงููุญูุท ูู ุงููุณูุฌ ุ ูููู ูู ุงููุดุงูุฏ ุงูุฃูุซุฑ ุฏููุงููููุฉ ูุญุชุงุฌ ุฅูู ุชุธููู.  ุชุนุฏ SSAO ูุงุญุฏุฉ ูู ุฃุณุงููุจ ุงูุชุธููู ุงูุฃูุซุฑ ุชุทูุฑุงู ุ ูููู ุจูุฌุฑุฏ ูุนุฑูุฉ ุฐูู ุ ุณุชุตุจุญ ุฃุฏุงุฉ ุชุธููู ุฑุฆูุณูุฉ. <br><br>  ูุงุญุธ ุฃู ูุตุทูุญ "ูุณุงุญุฉ ุงูุดุงุดุฉ" ูู ุงูุนููุงู ุบูุฑ ุตุญูุญ ุชูุงููุง ุ ูุฃูู ูุง ูุชู ุชูููุฐ ุฌููุน ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูู ูุณุงุญุฉ ุงูุดุงุดุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุจูุงูุงุช ุงููุงุฑุฏุฉ </h3><br>  ุณูู SSAO ุชุธููู ุชุญุชุงุฌ ุฅูู ุงููุฏุฎูุงุช ุงูุชุงููุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงููุงุช ููุงูู ููุฉ ุงูุฑุฃุณ ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ. </li><li style=";text-align:right;direction:rtl">  ูุงููุงุช ุทุจูุนูุฉ ุฅูู ุงูููู ูู ูุณุงุญุฉ ุงูุนุฑุถ. </li><li style=";text-align:right;direction:rtl">  ูุงููุงุช ุนููุฉ ูู ูุณุงุญุฉ ุงูุธู. </li><li style=";text-align:right;direction:rtl">  ูุงููุงุช ุงูุถูุถุงุก ูู ุงููุถุงุก ุงูุธู. </li><li style=";text-align:right;direction:rtl">  ูุตูููุฉ ุงูุฅุณูุงุท ุนูู ุนุฏุณุฉ ุงููุงููุฑุง. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ูููู </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2d2/f36/d42/2d2f36d425c2596288d8982158687354.png"></div><br>  ููุณ ูู ุงูุถุฑูุฑู ุชุฎุฒูู ููุงุถุน ุงูุฑุฃุณ ูู ูุณูุฌ ุงูุฅุทุงุฑ ุงูุนุงุฒู.  ูููููุง ุฅุนุงุฏุฉ ููู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ุงููุฎุฒู ุงููุคูุช ุนูู ุงููุงููุฑุง</a> .  ุฃูุชุจ ุฏููููุง ูููุจุชุฏุฆูู ุ ูุฐูู ูู ูุณุชุฎุฏู ูุฐุง ุงูุชุญุณูู ุ ูุณูุจุฏุฃ ุงูุนูู ุนูู ุงูููุฑ.  ูู ุงูุชุทุจูู ุงูุฎุงุต ุจู ุ ููููู ุจุณูููุฉ ุงุณุชุฎุฏุงู ุนูู ุงูุนุงุฒูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">PT(Texture) depthTexture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Texture(<span class="hljs-string"><span class="hljs-string">"depthTexture"</span></span>); depthTexture-&gt;set_format(Texture::Format::F_depth_component32); PT(GraphicsOutput) depthBuffer = graphicsOutput-&gt;make_texture_buffer(<span class="hljs-string"><span class="hljs-string">"depthBuffer"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, depthTexture); depthBuffer-&gt;set_clear_color(LVecBase4f(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); NodePath depthCameraNP = window-&gt;make_camera(); DCAST(Camera, depthCameraNP.node())-&gt;set_lens(window-&gt;get_camera(<span class="hljs-number"><span class="hljs-number">0</span></span>)-&gt;get_lens()); PT(DisplayRegion) depthBufferRegion = depthBuffer-&gt;make_display_region(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); depthBufferRegion-&gt;set_camera(depthCameraNP);</code> </pre> <br>  ุฅุฐุง ูุฑุฑุช ุงุณุชุฎุฏุงู ุงููุฎุฒู ุงููุคูุช ููุนูู ุ ูุฅููู ููููุฉ ุชููููู ูู Panda3D. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">in vec4 vertexPosition; out vec4 fragColor; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ fragColor = vertexPosition; }</code> </pre> <br>  ููุง ุชุธููู ุจุณูุท ูุชูุฏูู ููุงุถุน ููุฉ ุงูุฑุฃุณ ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ ุฅูู ูุณูุฌ ุนุงุฒูุฉ ููุฅุทุงุฑ.  ุชุชูุซู ุงููููุฉ ุงูุฃูุซุฑ ุตุนูุจุฉ ูู ุถุจุท ูุณูุฌ ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ ุจุญูุซ ูุง ุชูุชุตุฑ ููููุงุช ูุชุฌู ุงูุฌุฒุก ุงูุฐู ุชู ุงูุญุตูู ุนููู ุจูุงุณุทุชู ุนูู ุงููุงุตู ุงูุฒููู <code>[0, 1]</code> ุ ูููู ููููุง ุฏูุฉ ุนุงููุฉ ุจูุง ููู ุงูููุงูุฉ (ุนุฏุฏ ูุจูุฑ ุจุดูู ูุงูู ูู ุงูุจุชุงุช).  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ููุงู ููุน ูู ููุถุน ููุฉ ุงูุฑุฃุณ <code>&lt;-139.444444566, 0.00000034343, 2.5&gt;</code> ุ ููุง ููููู ุญูุธู ูู ุงููุณูุฌ ูู <code>&lt;0.0, 0.0, 1.0&gt;</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... FrameBufferProperties fbp = FrameBufferProperties::get_default(); // ... fbp.set_rgba_bits(32, 32, 32, 32); fbp.set_rgb_color(true); fbp.set_float_color(true); // ...</span></span></code> </pre> <br>  ูููุง ููู ุฑูุฒ ูุซุงู ููุนุฏ ูุณูุฌูุง ูุคูุชูุง ููุฅุทุงุฑ ูุชุฎุฒูู ููุงุถุน ุงูุฐุฑูุฉ.  ูุญุชุงุฌ ุฅูู 32 ุจุช ููุฃุญูุฑ ูุงูุฃุฎุถุฑ ูุงูุฃุฒุฑู ูุงูุฃููุง ุ ูุฐุง ููู ูุนุทู ุชูููุฏ ุงูููู ุจูุงุณุทุฉ ุงููุงุตู ุงูุฒููู <code>[0, 1]</code> .  ุงุณุชุฏุนุงุก <code>set_rgba_bits(32, 32, 32, 32)</code> ุชุนููู ุญุฌู ุงูุจุช ูุชุนุทูู ุงูุชูููุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> glTexImage2D ( GL_TEXTURE_2D , <span class="hljs-number"><span class="hljs-number">0</span></span> , GL_RGB32F , <span class="hljs-number"><span class="hljs-number">1200</span></span> , <span class="hljs-number"><span class="hljs-number">900</span></span> , <span class="hljs-number"><span class="hljs-number">0</span></span> , GL_RGB , GL_FLOAT , <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> );</code> </pre> <br>  ูุฐู ููุงููุฉ ููุงุซูุฉ ุนูู OpenGL.  <code>GL_RGB32F</code> ูุนูู ุงูุจุชุงุช ููุนุทู ุงูุชูููุฏ. <br><br><blockquote style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงููุฎุฒู ุงููุคูุช ูููู ูุญุชูู ุนูู ูุงุตูุฉ ุซุงุจุชุฉ ุ ูุฅู ููููุงุช ุงูููู ุงูุฃูููุฉ ูุงูููุงุฆูุฉ ุ ููุฐูู ูุคุดุฑุงุช ุงูุฎูุท ุ ูุจู ุญุณุงุจ ูุนุงุฏูุฉ ุงูุฎูุท ุชูุชุตุฑ ุนูู [0 ุ 1] ุฃู [ุ1 ุ 1] ุ ุนูู ุงูุชูุงูู ุ ุจุงููุณุจุฉ ููุงุฌูุฉ ุชุฎุฒูู ุงูุฃููุงู ุงูุทุจูุนูุฉ ุงููููุณุฉ ูุงููููุนุฉ ุบูุฑ ุงููููุนุฉ.  ุฅุฐุง ูุงู ุงููุฎุฒู ุงููุคูุช ูููู ูุญุชูู ุนูู ููุทุฉ ุนุงุฆูุฉ ุ ููู ูุชุญูู ุงูุชูููุฏ. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">ูุตุฏุฑ</a> </blockquote><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/17b/2d0/2ad/17b2d02ad53c411dc251d90fdc16fdf3.png"></div><br>  ููุง ุชุฑู ููุงูู ุงูููู.  ุงููุญูุฑ ุต ูู ูุง ูุตู. <br><br>  ุชุฐูุฑ ุฃู Panda3D ูุนุฑูู ุงููุญูุฑ z ุจุฃูู ูุชุฌู ูุดูุฑ ุฅูู ุงูุฃุนูู ุ ุจูููุง ูู OpenGL ุ ูุจุญุซ ุงููุญูุฑ y.  ูุนุฑุถ ุชุธููู ุงูููุถุน ููุงุถุน ุงูููู ุจุนูุงูุฉ z ุงูุชุตุงุนุฏู ุ ูุฃูู ูู Panda3D <br>  ุชู ุชูููู ุงููุนููุฉ <code>gl-coordinate-system default</code> . <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฃูุถุงุน ุงูุทุจูุนูุฉ </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0c4/064/9c5/0c40649c525edd7bcf3c829d6e948789.gif"></div><br>  ูู ุฃุฌู ุงูุงุชุฌุงู ุงูุตุญูุญ ููุนููุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุชุธููู SSAO ุ ูุญุชุงุฌ ุฅูู ุงูููู ุงูุทุจูุนูุฉ ูู ุงูููู.  ููุดุฆ ุฑูุฒ ุนููุฉ ุงูุนุฏูุฏ ูู ูุชุฌูุงุช ุฃุฎุฐ ุงูุนููุงุช ุงูููุฒุนุฉ ุนูู ูุตู ุงููุฑุฉ ุ ูููู ููููู ุงุณุชุฎุฏุงู ุงููุฌุงู ูุญู ูุดููุฉ ุงูุญุงุฌุฉ ุฅูู ุงูุญุงูุฉ ุงูุทุจูุนูุฉ ุชูุงููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">in vec3 vertexNormal; out vec4 fragColor; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ vec3 normal = normalize(vertexNormal); fragColor = vec4(normal, <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br>  ูุซู ุชุธููู ุงูููุถุน ุ ุงูุชุธููู ุงูุนุงุฏู ุจุณูุท ููุบุงูุฉ.  ุชุฐูุฑ ุฃู ุชุทุจูุน ุงูุฃูุถุงุน ุงูุทุจูุนูุฉ ูู ุงูููู ูุชุฐูุฑ ุฃููุง ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/57b/a82/f00/57ba82f003b0ab9c2aafa7c9affa28bb.gif"></div><br>  ูุชู ุนุฑุถ ุงูุฃูุถุงุน ุงูุทุจูุนูุฉ ูู ุงูููู ููุง ุ  ุงููุญูุฑ ุต ูู ูุง ูุตู. <br><br>  ุชุฐูุฑ ุฃู Panda3D ุชุนุชุจุฑ ุงููุญูุฑ z ูู ุงููุชุฌู ุงูุชุตุงุนุฏู ุ ู OpenGL ูููุญูุฑ y.  ูุนุฑุถ ุงูุชุธููู ุงูุนุงุฏู ููุงุถุน ุงูููู ูุน ุชูุฌูู ุงููุญูุฑ z ูุฃุนูู ุ ูุฃู ุชูููู <code>gl-coordinate-system default</code> ูู Panda3D. <br><br><h3 style=";text-align:right;direction:rtl">  ุนููุงุช </h3><br>  ูุชุญุฏูุฏ ูููุฉ ุงูุฅุบูุงู ุงููุญูุท ูุฃู ุฌุฒุก ููุฑุฏ ุ ูุญุชุงุฌ ุฅูู ุฃุฎุฐ ุนููุงุช ูู ุงูููุทูุฉ ุงููุญูุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... for (int i = 0; i &lt; numberOfSamples; ++i) { LVecBase3f sample = LVecBase3f ( randomFloats(generator) * 2.0 - 1.0 , randomFloats(generator) * 2.0 - 1.0 , randomFloats(generator) ).normalized(); float rand = randomFloats(generator); sample[0] *= rand; sample[1] *= rand; sample[2] *= rand; float scale = (float) i / (float) numberOfSamples; scale = lerp(0.1, 1.0, scale * scale); sample[0] *= scale; sample[1] *= scale; sample[2] *= scale; ssaoSamples.push_back(sample); } // ...</span></span></code> </pre> <br>  ูููุฏ ุฑูุฒ ุงูุนููุฉ 64 ุนููุฉ ุนุดูุงุฆูุฉ ููุฒุนุฉ ูู ูุตู ุงููุฑุฉ ุงูุบุฑุจู.  ุณูุชู ุชูุฑูุฑ ูุฐู ssaoSamples ุฅูู ุชุธููู SSAO. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> LVecBase3f sample = LVecBase3f ( randomFloats(generator) * <span class="hljs-number"><span class="hljs-number">2.0</span></span> - <span class="hljs-number"><span class="hljs-number">1.0</span></span> , randomFloats(generator) * <span class="hljs-number"><span class="hljs-number">2.0</span></span> - <span class="hljs-number"><span class="hljs-number">1.0</span></span> , randomFloats(generator) * <span class="hljs-number"><span class="hljs-number">2.0</span></span> - <span class="hljs-number"><span class="hljs-number">1.0</span></span> ).normalized();</code> </pre> <br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชูุฒูุน ุงูุนููุงุช ุงูุฎุงุตุฉ ุจู ุนุจุฑ ูุฑุฉ ุ ููู ุจุชุบููุฑ ุงููุงุตู ุงูุฒููู ูููููู ุงูุนุดูุงุฆู z ุจุญูุซ ูุชุบูุฑ ูู ูุงูุต ูุงุญุฏ ุฅูู ูุงุญุฏ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุถูุถุงุก </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... for (int i = 0; i &lt; 16; ++i) { LVecBase3f noise = LVecBase3f ( randomFloats(generator) * 2.0 - 1.0 , randomFloats(generator) * 2.0 - 1.0 , 0.0 ); ssaoNoise.push_back(noise); } // ...</span></span></code> </pre> <br>  ูู ุฃุฌู ุชุบุทูุฉ ุงูููุทูุฉ ุงูุชู ุชู ุฃุฎุฐ ุนููุงุช ูููุง ุฌูุฏูุง ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุชุฌูุงุช ุถูุถุงุก.  ูููู ุฃู ุชููู ููุงูู ุงูุถูุถุงุก ูุฐู ุจุชุฏููุฑ ุงูุนููุงุช ุญูู ุงูุฌุฒุก ุงูุนููู ูู ุงูุณุทุญ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุณุฏุงุฏ ุงููุญูุทุฉ </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d35/c1d/bb4/d35c1dbb4e0e9dfeedc3bd4285f26004.gif"></div><br>  ุชูุฌุฒ SSAO ูููุชูุง ุนู ุทุฑูู ุฃุฎุฐ ุนููุงุช ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ ุญูู ุงูุฌุฒุก.  ููุฒูุฏ ูู ุงูุนููุงุช ุงูููุฌูุฏุฉ ุฃุณูู ุงูุณุทุญ ุ ูููุง ูุงู ููู ุงููุทุนุฉ ุฃูุซุฑ ูุชุงูุฉ.  ุชูุฌุฏ ูุฐู ุงูุนููุงุช ูู ุงูุดุธูุฉ ูุชุดูุฑ ูู ุงูุงุชุฌุงู ุงูุนุงู ููุนุงุฏู ุฅูู ุงูุฑุฃุณ.  ูุชู ุงุณุชุฎุฏุงู ูู ุนููุฉ ููุจุญุซ ุนู ููุถุน ูู ูุณูุฌ ููุถุน ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ.  ุชุชู ููุงุฑูุฉ ุงููููู ุงูุฐู ุชู ุฅุฑุฌุงุนู ูุน ุงูุนููุฉ.  ุฅุฐุง ูุงูุช ุงูุนููุฉ ุจุนูุฏุฉ ุนู ุงููุงููุฑุง ุนู ุงูููุถุน ุ ููุชู ุบูู ุงูุนููุฉ ุจุงุชุฌุงู ุงูุฌุฒุก. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cb7/b9a/f1d/cb7b9af1d4dc613f337da5a253ef5a8c.gif"></div><br>  ููุง ุชุฑู ูุณุงุญุฉ ุฃุนูู ุงูุณุทุญ ุงูุฐู ุชู ุฃุฎุฐ ุนููุงุช ููู ููุงูุณุฏุงุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float radius = 1.1; float bias = 0.026; float lowerRange = -2; float upperRange = 2; // ...</span></span></code> </pre> <br>  ูุซู ุจุนุถ ุงูุชูููุงุช ุงูุฃุฎุฑู ุ ูุฅู shader SSAO ูุฏูู ุงูุนุฏูุฏ ูู ูุนููุงุช ุงูุชุญูู ุงูุชู ูููู ุชุบููุฑูุง ููุญุตูู ุนูู ุงููุธูุฑ ุงููุทููุจ.  ูุถุงู ุงูุชุญูุฒ ุฅูู ุงููุณุงูุฉ ูู ุงูุนููุฉ ุฅูู ุงููุงููุฑุง.  ูุฐู ุงููุนููุฉ ูููู ุงุณุชุฎุฏุงููุง ูููุงูุญุฉ ุงูุจูุน.  ูุฒูุฏ ูุตู ุงููุทุฑ ุฃู ูููู ูู ูุณุงุญุฉ ุชุบุทูุฉ ูุณุงุญุฉ ุงูุนููุฉ.  LowerRange ู upperRange ูุบูุฑุงู ุงููุทุงู ุงูููุงุณู ููููุงุณ ุงูุนุงูู ูู <code>[0, 1]</code> ุฅูู ุฃู ูููุฉ ุชุญุฏุฏูุง.  ุนู ุทุฑูู ุฒูุงุฏุฉ ุงููุทุงู ุ ููููู ุฒูุงุฏุฉ ุงูุชุจุงูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 position = texture(positionTexture, texCoord); vec3 normal = texture(normalTexture, texCoord).xyz; int noiseX = int(gl_FragCoord.x - 0.5) % 4; int noiseY = int(gl_FragCoord.y - 0.5) % 4; vec3 random = noise[noiseX + (noiseY * 4)]; // ...</span></span></code> </pre> <br>  ูุญุตู ุนูู ุงููููู ุ ูุงููุงุช ุทุจูุนูุฉ ูุนุดูุงุฆูุฉ ููุงุณุชุฎุฏุงู ูุฑุฉ ุฃุฎุฑู.  ุชุฐูุฑ ุฃูู ูู ูุซุงู ุงูููุฏ ุ ุชู ุฅูุดุงุก 16 ูุชุฌู ุนุดูุงุฆู.  ูุชู ุชุญุฏูุฏ ูุชุฌู ุนุดูุงุฆู ุจูุงุกู ุนูู ููุถุน ุดุงุดุฉ ุงูุฃุฌุฒุงุก ุงูุญุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec3 tangent = normalize(random - normal * dot(random, normal)); vec3 binormal = cross(normal, tangent); mat3 tbn = mat3(tangent, binormal, normal); // ...</span></span></code> </pre> <br>  ุจุงุณุชุฎุฏุงู ูุชุฌู ุนุดูุงุฆู ููุงูู ุทุจูุนู ุ ูููู ุจุชุฌููุน ูุตูููุฉ ุงูููุงุณ ุ ุฐู ุงูุญุฏูู ูุงูุนุงุฏู.  ูุญู ุจุญุงุฌุฉ ุฅูู ูุฐู ุงููุตูููุฉ ูุชุญููู ุนููุงุช ุงููุชุฌูุงุช ูู ูุณุงุญุฉ ุงูุธู ุฅูู ูุณุงุญุฉ ุงููุณุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float occlusion = NUM_SAMPLES; for (int i = 0; i &lt; NUM_SAMPLES; ++i) { // ... } // ...</span></span></code> </pre> <br>  ุนูุฏ ูุฌูุฏ ูุตูููุฉ ุ ูููู ููุชุธููู ุฅุฌุฑุงุก ุญููุฉ ูู ุฎูุงู ุฌููุน ุงูุนููุงุช ุงูููุฌูุฏุฉ ูู ุงูุญููุฉ ุ ูุทุฑุญ ุนุฏุฏ ุงูุนููุงุช ุบูุฑ ุงูููุชูุญุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec3 sample = tbn * samples[i]; sample = position.xyz + sample * radius; // ...</span></span></code> </pre> <br>  ุจุงุณุชุฎุฏุงู ุงููุตูููุฉ ุ ุถุน ุงูุนููุฉ ุจุฌุงูุจ ููุถุน ููุฉ ุงูุฑุฃุณ / ุงูุดุธูุฉ ูุญุฌููุง ุจูุงุณุทุฉ ูุตู ุงููุทุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 offset = vec4(sample, 1.0); offset = lensProjection * offset; offset.xyz /= offset.w; offset.xyz = offset.xyz * 0.5 + 0.5; // ...</span></span></code> </pre> <br>  ุจุงุณุชุฎุฏุงู ููุถุน ุงูุนููุฉ ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ ุ ูููู ุจุชุญููููุง ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ ุฅูู ูุณุงุญุฉ ุงููุทุน ุ ุซู ุฅูู ูุณุงุญุฉ ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">-1</span></span> * <span class="hljs-number"><span class="hljs-number">0.5</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-number"><span class="hljs-number">0.5</span></span> + <span class="hljs-number"><span class="hljs-number">0.5</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  ูุง ุชูุณู ุฃู ููููุงุช ูุณุงุญุฉ ุงููุทุน ุชููู ูู ุงููุทุงู ูู ูุงูุต ูุงุญุฏ ุฅูู ูุงุญุฏ ุ ูุฃู ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูู ุงููุทุงู ูู ุตูุฑ ุฅูู ูุงุญุฏ.  ูุชุญููู ุฅุญุฏุงุซูุงุช ูุณุงุญุฉ ุงููุทุน ุฅูู ุฅุญุฏุงุซูุงุช UV ุ ุงุถุฑุจูุง ูู ุซุงููุฉ ูุงุญุฏุฉ ูุฃุถู ุซุงููุฉ ูุงุญุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 offsetPosition = texture(positionTexture, offset.xy); float occluded = 0; if (sample.y + bias &lt;= offsetPosition.y) { occluded = 0; } else { occluded = 1; } // ...</span></span></code> </pre> <br>  ุจุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุฅุฒุงุญุฉ UV ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุนู ุทุฑูู ุฅุณูุงุท ุงูุนููุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ุนูู ูุณูุฌ ุงูููุถุน ุซูุงุฆู ุงูุฃุจุนุงุฏ ุ ูุฌุฏ ูุชุฌู ุงูููุถุน ุงูููุงุจู.  ููููู ูุฐุง ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ ุฅูู ูุณุงุญุฉ ุงููุทุน ุฅูู ูุณุงุญุฉ ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ุซู ุงูุนูุฏุฉ ุฅูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ.  ูุนูู ุงูุชุธููู ุนูู ุชูููุฐ ูุฐู ุงูุญููุฉ ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ููุงู ุฃู ููุฏุณุฉ ุฎูู ุงูุนููุฉ ุฃู ูู ูููุน ุงูุนููุฉ ุฃู ุฃูุงู ุงูุนููุฉ.  ุฅุฐุง ูุงูุช ุงูุนููุฉ ููุฌูุฏุฉ ุฃูุงู ุฃู ูู ุจุนุถ ุงูุฃุดูุงู ุงูููุฏุณูุฉ ุ ูุจุจุณุงุทุฉ ูุง ุชุคุฎุฐ ูุฐู ุงูุนููุฉ ูู ุงูุงุนุชุจุงุฑ ุจุงููุณุจุฉ ููุฌุฒุก ุงููุชุฏุงุฎู.  ุฅุฐุง ูุงูุช ุงูุนููุฉ ูุฑุงุก ุจุนุถ ุงูุฃุดูุงู ุงูููุฏุณูุฉ ุ ูุชู ุฃุฎุฐ ูุฐู ุงูุนููุฉ ูู ุงูุงุนุชุจุงุฑ ุจุงููุณุจุฉ ููุฌุฒุก ุงููุชุฏุงุฎู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float intensity = smoothstep ( 0.0 , 1.0 , radius / abs(position.y - offsetPosition.y) ); occluded *= intensity; occlusion -= occluded; // ...</span></span></code> </pre> <br>  ุฃุถู ุงูุขู ูุฒูุงู ุฅูู ูุฐุง ุงููุถุน ุงูุฐู ุชู ุฃุฎุฐ ุนููุงุช ููู ุจูุงุกู ุนูู ูุฏู ุงููุณุงูุฉ ุฏุงุฎู ุฃู ุฎุงุฑุฌ ูุตู ุงููุทุฑ.  ุจุนุฏ ุฐูู ุ ูู ุจุทุฑุญ ูุฐู ุงูุนููุฉ ูู ููุงุณ ุงูุงูุณุฏุงุฏ ูุฃููุง ุชูุชุฑุถ ุฃู ุฌููุน ุงูุนููุงุช ูุฏ ุชู ุชุฏุงุฎููุง ูุจู ุงูุญููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... occlusion /= NUM_SAMPLES; // ... fragColor = vec4(vec3(occlusion), position.a); // ...</span></span></code> </pre> <br>  ุงูุณู ุนุฏุฏ ุงูุชุฏุงุฎู ุนูู ุนุฏุฏ ุงูุนููุงุช ูุชุญููู ูุคุดุฑ ุงูุฅุบูุงู ูู ุงููุงุตู ุงูุฒููู <code>[0, NUM_SAMPLES]</code> ุฅูู ุงููุงุตู ุงูุฒููู <code>[0, 1]</code> .  ุงูุตูุฑ ูุนูู ุงูุณุฏุงุฏ ูุงูู ุ ูุงููุญุฏุงุช ูุง ุชุนูู ุฃู ุงูุณุฏุงุฏ.  ุงูุขู ูู ุจุชุนููู ุงูุณุฏุงุฏ ุนูู ููู ุงูุฌุฒุก ุ ููุฐุง ูู ุดูุก. <br><br>  ูุฑุฌู ููุงุญุธุฉ ุฃูู ูู ุฑูุฒ ุงููุซุงู ุ ูุชู ุชุนููู ููุงุฉ ุฃููุง ููููุฉ ุฃููุง ููููุณ ุงูููุถุน ูู ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ ูุชุฌูุจ ุชุฏุงุฎู ุงูุฎูููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุทูุณ (ุทูุณ) </h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5b1/566/2a7/5b15662a7c46db6b8102fe9eabae17c9.gif"></div><br>  ุชููู ุจููุฉ ูุฎุฒู ุฅุทุงุฑ SSAO ุตุงุฎุจุฉ ุจุนุถ ุงูุดูุก ุ ูุฐุง ูุฌุจ ุนููู ุทูุณูุง ูุชูุนูููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... for (int i = 0; i &lt; size2; ++i) { x = size - xCount; y = yCount - size; result += texture ( ssaoTexture , texCoord + vec2(x * parameters.x, y * parameters.x) ).rgb; xCount -= 1; if (xCount &lt; countMin) { xCount = countMax; yCount -= 1; } } result = result / size2; // ...</span></span></code> </pre> <br>  SSAO ุทูุณ ุชุธููู ูู ูุฑุจุน ููุชุธู ุทูุณ.  ูุซู ุชุธููู bloom ุ ูุฑุณู ูุงูุฐุฉ ุนูู ุงูููุงู ุงููุงุฑุฏ ููุนุฏู ูู ุฌุฒุก ุจููู ุฌูุฑุงูู. <br><br>  ูุงุญุธ ุฃู <code>parameters.x</code> ูู ูุนููุฉ ูุตู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูููู ุงููุญูุท </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec2 ssaoBlurTexSize = textureSize(ssaoBlurTexture, 0).xy; vec2 ssaoBlurTexCoord = gl_FragCoord.xy / ssaoBlurTexSize; float ssao = texture(ssaoBlurTexture, ssaoBlurTexCoord).r; vec4 ambient = p3d_Material.ambient * p3d_LightModel.ambient * diffuseTex * ssao; // ...</span></span></code> </pre> <br>  ุงูุชุญุฏู ุงูุฃุฎูุฑ ู SSAO ูู ูุฑุฉ ุฃุฎุฑู ูู ุญุณุงุจุงุช ุงูุฅุถุงุกุฉ.  ููุง ูุฑู ููู ูุชู ุงูุนุซูุฑ ุนูู ุงูุณุฏุงุฏ ูู ูุณูุฌ SSAO ุงูุนุงุฒูุฉ ุงููููุณ ููุชู ุชุถููููุง ูู ุญุณุงุจ ุงูุฅุถุงุกุฉ ุงููุญูุทุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุดูุฑุฉ ุงููุตุฏุฑ </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="">main.cxx</a> </li><li style=";text-align:right;direction:rtl">  <a href="">base.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">basic.vert</a> </li><li style=";text-align:right;direction:rtl">  <a href="">position.frag</a> </li><li style=";text-align:right;direction:rtl">  <a href="">normal.frag</a> </li><li style=";text-align:right;direction:rtl">  <a href="">ssao.frag</a> </li><li style=";text-align:right;direction:rtl">  <a href="">blur.frag</a> </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุนูู ุงูููุฏุงู </h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6ef/eb0/10f/6efeb010f4623ff49b928d72550f7985.gif"></div><br>  ุนูู ุงููุฌุงู ูู ุฃูุถูุง ูุซู ูุฐุง ุงูุชุฃุซูุฑ ุ ุจุนุฏ ุฃู ุชุนุฑูุช ุนูู ุฃู ุดูุก ุ ูุง ููููู ุงูุนูุด ุจุฏููู.  ูู ูุฌูุฉ ูุธุฑ ูููุฉ ุ ููููู ุงุณุชุฎุฏุงูู ูุฌุฐุจ ุงูุชุจุงู ุงููุดุงูุฏ ุฅูู ูุงุฆู ูุนูู.  ููู ูู ุงูุญุงูุฉ ุงูุนุงูุฉ ุ ูุถูู ุนูู ุงููุฌุงู ุนูู ุญุณุงุจ ุฌูุฏ ูููู ุญุตุฉ ูุจูุฑุฉ ูู ุงููุงูุนูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ูู ุงูุชุฑููุฒ </h3><br>  ุงูุฎุทูุฉ ุงูุฃููู ูู ุฌุนู ุงููุดูุฏ ูู ุจุคุฑุฉ ุงูุชุฑููุฒ.  ุชูุฏููู ุฅูู ูุณูุฌ ุงูุฅุทุงุฑ ุงูุนุงุฒูุฉ.  ุณูููู ุฃุญุฏ ููู ุงูุฅุฏุฎุงู ูุนูู ุงูุญูู ุงููุฎุฒู ุงููุคูุช. <br><br><h3 style=";text-align:right;direction:rtl">  ุฎุงุฑุฌ ุงูุชุฑููุฒ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 result = vec4(0); for (int i = 0; i &lt; size2; ++i) { x = size - xCount; y = yCount - size; result += texture ( blurTexture , texCoord + vec2(x * parameters.x, y * parameters.x) ); xCount -= 1; if (xCount &lt; countMin) { xCount = countMax; yCount -= 1; } } result = result / size2; // ...</span></span></code> </pre> <br>  ูุงูุฎุทูุฉ ุงูุซุงููุฉ ูู ุทูุณ ุงููุดูุฏ ููุง ูู ูุงู ุฎุงุฑุฌ ูุทุงู ุงูุชุฑููุฒ ุชูุงููุง.  ููุง ูู ุงูุญุงู ูุน ุงุฒูุฑ ู SSAO ุ ููููู ุงุณุชุฎุฏุงู ูุฑุจุน ุทูุณ.  ุชูุฏูู ูุฐุง ุงููุดูุฏ defocused ุฅูู ูุณูุฌ ุงูุฅุทุงุฑ ุงูุนุงุฒูุฉ.  ุณุชููู ูููุฉ ุฅุฏุฎุงู ุฃุฎุฑู ูุนูู ุชุธููู ุงูุญูู. <br><br>  ูุงุญุธ ุฃู <code>parameters.x</code> ูู ูุนููุฉ ูุตู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฎูุท </h3><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d68/067/83a/d6806783a567c4708d8f13dcb0763f7c.gif"></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float focalLengthSharpness = 100; float blurRate = 6; // ...</span></span></code> </pre> <br>  ููููู ุชุฎุตูุต ูุฐู ุงูุฎูุงุฑุงุช ูุฐููู.  ูุคุซุฑ <code>focalLengthSharpness</code> ุนูู ูุฏู <code>focalLengthSharpness</code> ุงููุดูุฏ ุนูู ุงูุจุนุฏ ุงูุจุคุฑู.  ุฃุตุบุฑ <code>focalLengthSharpness</code> ุ ุณูููู ุงููุดูุฏ ุฃูุซุฑ <code>focalLengthSharpness</code> ูู ุงูุจุนุฏ ุงูุจุคุฑู.  <code>blurRate</code> ูุคุซุฑ ุนูู ุณุฑุนุฉ ุชุดููุด ุงููุดูุฏ ุนูุฏ ุงูุงุจุชุนุงุฏ ุนู ุงูุจุนุฏ ุงูุจุคุฑู.  ุฃุตุบุฑ ุญุฌู <code>blurRate</code> ุ ูููุง ูุงู ุงููุดูุฏ ุฃูู ูุถูุญูุง ุนูุฏ ุงูุงุจุชุนุงุฏ ุนู ููุทุฉ ุงูุชุฑููุฒ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 focusColor = texture(focusTexture, texCoord); vec4 outOfFocusColor = texture(outOfFocusTexture, texCoord); // ...</span></span></code> </pre> <br>  ุณูุญุชุงุฌ ุงูุฃููุงู ูู ุงูุชุฑููุฒ ููู ุตูุฑุฉ defocused. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 position = texture(positionTexture, texCoord); // ...</span></span></code> </pre> <br>  ูุฏ ูุญุชุงุฌ ุฃูุถูุง ุฅูู ููุถุน ููุฉ ุงูุฑุฃุณ ูู ูุณุงุญุฉ ุงููุดุงูุฏุฉ.  ููููู ุฅุนุงุฏุฉ ุชุทุจูู ูุณูุฌ ุงูููุงุถุน ูู ุงููุฎุฒู ุงููุคูุช ููุฅุทุงุฑ ุงูุฐู ุชู ุงุณุชุฎุฏุงูู ูู SSAO. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float blur = clamp ( pow ( blurRate , abs(position.y - focalLength.x) ) / focalLengthSharpness , 0 , 1 ); // ... fragColor = mix(focusColor, outOfFocusColor, blur); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ูุญุฏุซ ุงูุงุฑุชุจุงู. </font><font style="vertical-align: inherit;">ูููุง ุงูุชุฑุจูุง </font></font><code>blur</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุงุญุฏ ุ ูููุง ุงุณุชุฎุฏู ุฃูุซุฑ </font></font><code>outOfFocusColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูููุฉ ุงูุตูุฑ </font></font><code>blur</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุฃู ูุฐู ุงููุทุนุฉ ูู ุชุฑููุฒ ูุงูู. </font><font style="vertical-align: inherit;">ูุน </font></font><code>blur &gt;= 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ุงูุฌุฒุก ูู defocused ุชูุงูุง.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดูุฑุฉ ุงููุตุฏุฑ </font></font></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cxx</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic.vert</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blur.frag</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุนูู ูู field.frag</font></font></a> </li></ul><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู posterization </font></font></h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/f18/078/84d/f1807884d79c5c73915ce9adf6ead5cb.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุซู ุนูููุฉ ุงูููุตูุงุช ุ ุฃู ุฃุฎุฐ ุนููุงุช ุงูุฃููุงู ุ ุนูููุฉ ุชูููู ุนุฏุฏ ุงูุฃููุงู ุงููุฑูุฏุฉ ูู ุตูุฑุฉ ูุง. </font><font style="vertical-align: inherit;">ููููู ุงุณุชุฎุฏุงู ูุฐุง ุชุธููู ูุฅุนุทุงุก ุงููุนุจุฉ ูุธุฑุฉ ูุฒููุฉ ุฃู ุงูุฑุฌุนูุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุจุฏูุฌูุง ูุน ูุฎุทุท ุชูุตููู ุ ูุณุชุญุตู ุนูู ููุท ูุงุฑููุงุชูุฑู ุญูููู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float levels = 8; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุชุฌุฑุจุฉ ูุฐู ุงููุนููุฉ. </font><font style="vertical-align: inherit;">ูููุง ุฒุงุฏ ุญุฌููุง ุ ุณุชุธู ุงููุฒูุฏ ูู ุงูุฒููุฑ ูุชูุฌุฉ ูุฐูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec4 texColor = texture(posterizeTexture, texCoord); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณูุญุชุงุฌ ุงูููู ุงููุงุฑุฏ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec3 grey = vec3((texColor.r + texColor.g + texColor.b) / 3.0); vec3 grey1 = grey; grey = floor(grey * levels) / levels; texColor.rgb += (grey - grey1); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุง ูู ุฃุฑ ูุซู ูุฐู ุงูุทุฑููุฉ ูู posterization. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงูุชุญูู ูู ุฐูู ุ ุฑุฃูุช ุฃูู ูุฎูู ูุชุงุฆุฌ ุฃูุซุฑ ุฌูุงูุง ููุงุฑูุฉ ุจุงูุทุฑู ุงูุชูููุฏูุฉ. </font><font style="vertical-align: inherit;">ูุชูููู ููุญุฉ ุงูุฃููุงู ุ ูู ุฃููุงู ุจุชุญููู ุงูููู ุฅูู ูููุฉ ุจุชุฏุฑุฌ ุงูุฑูุงุฏู. </font><font style="vertical-align: inherit;">ููุตู ุงูููู ุนู ุทุฑูู ุฑุจุทู ุจุฃุญุฏ ุงููุณุชููุงุช. </font><font style="vertical-align: inherit;">ูุญุณุจ ุงููุฑู ุจูู ุงููููุฉ ุงูุชู ุชู ุฃุฎุฐ ุนููุงุช ูููุง ูู ุงูุชุฏุฑุฌ ุงูุฑูุงุฏู ูุงููููุฉ ุบูุฑ ุงูุชู ุชู ุฃุฎุฐ ุนููุงุช ูููุง ูู ุงูุชุฏุฑุฌ ุงูุฑูุงุฏู. </font><font style="vertical-align: inherit;">ุฃุถู ูุฐุง ุงูุงุฎุชูุงู ุฅูู ููู ุงูุฅุฏุฎุงู. </font><font style="vertical-align: inherit;">ูุฐุง ุงูุงุฎุชูุงู ูู ุงูููุฏุงุฑ ุงูุฐู ูุฌุจ ุฃู ูุฒูุฏ ุจู ุงูููู / ูููุต ุงูููู ูู ุฃุฌู ุชุญููู ูููุฉ ุชูุฏูุฑูุฉ ูู ุงูุชุฏุฑุฌ ุงูุฑูุงุฏู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... fragColor = texColor; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุง ุชูุณู ุชุนููู ูููุฉ ููู ุงูุฅุฏุฎุงู ุฅูู ููู ุงููุทุนุฉ. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณู ุงูุชุธููู </font></font></h3><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2d1/f9c/133/2d1f9c1333960c0299388fc51323a8b3.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ุชุนุทู ุงูุตูุฑุฉ ุงูุฎูููุฉ ูุธูุฑ ุชุธููู cel ุ ูุฃู ุชุธููู cel ูู ุนูููุฉ ูุชูุฏูุฑ ุงูุฃููุงู ุงูููุชุดุฑุฉ ูุงูููุชุดุฑุฉ ูู ุธูุงู ูููุตูุฉ. </font><font style="vertical-align: inherit;">ูุฑูุฏ ุงุณุชุฎุฏุงู ุฃููุงู ููุชุดุฑุฉ ุตูุจุฉ ููุท ุฏูู ุชูุงุตูู ุฏูููุฉ ููุฎุฑูุทุฉ ุงูุนุงุฏูุฉ ููููุฉ ุตุบูุฑุฉ </font></font><code>levels</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดูุฑุฉ ุงููุตุฏุฑ </font></font></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cxx</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic.vert</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">posterize.frag</font></font></a> </li></ul><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุจููุณููุงุดู </font></font></h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/396/0b9/9bc/3960b99bc2f1fa900c40a1c9f32169bc.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ุชุนุทููุง Pixelization ูู ูุนุจุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูุธูุฑูุง ูุซูุฑูุง ููุงูุชูุงู ุ ุฃู ูููู ุฃู ุชููุฑ ูู ุงูููุช ุงูุฐู ูุงู ูู ุงูููุชุฑุถ ุฃู ูุจุชูุฑ ููู ุฅูุดุงุก ูู ุฃุดูุงู ุงูุจูุณู ูุฏูููุง. </font><font style="vertical-align: inherit;">ุงูุฌูุน ุจูู ุฐูู ูุน posterization ูุฎูู ูุธุฑุฉ ุงูุฑุฌุนูุฉ ุงูุญููููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... int pixelSize = 5; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุถุจุท ุญุฌู ุงูุจูุณู ุจููุณู. </font><font style="vertical-align: inherit;">ูููุง ุฒุงุฏ ุญุฌููุง ุ ูููุง ูุงูุช ุงูุตูุฑุฉ ุฃูุณู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/413/818/aee/413818aee5509763cc383f800b837cfb.gif"></div><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float x = int(gl_FragCoord.x) % pixelSize; float y = int(gl_FragCoord.y) % pixelSize; x = floor(pixelSize / 2.0) - x; y = floor(pixelSize / 2.0) - y; x = gl_FragCoord.x + x; y = gl_FragCoord.y + y; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู ูุฐู ุงูุชูููุฉ ุจุฅุฑูุงู ูู ุฌุฒุก ุจูุณุท ุฃูุฑุจ ูุงูุฐุฉ ุบูุฑ ูุชุฑุงูุจุฉ ุจุญุฌู ุงูุจูุณู. </font><font style="vertical-align: inherit;">ุชุตุทู ูุฐู ุงูููุงูุฐ ุฃุนูู ุงููููุณ ุงููุงุฑุฏ. </font><font style="vertical-align: inherit;">ุชุญุฏุฏ ุงูุฃุฌุฒุงุก ุงูููุฌูุฏุฉ ูู ูุณุท ุงููุงูุฐุฉ ููู ุงูุฃุฌุฒุงุก ุงูุฃุฎุฑู ูู ุงููุงูุฐุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... fragColor = texture(pixelizeTexture, vec2(x, y) / texSize); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุฃู ูุญุฏุฏ ุชูุณูู ุงูุฌุฒุก ุงููุทููุจ ุงุณุชุฎุฏุงูู ุ ุฎุฐ ูููู ูู ุงููุณูุฌ ุงููุงุฑุฏ ููู ุจุชุนูููู ูููู ุงูุชุฌุฒุฆุฉ. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดูุฑุฉ ุงููุตุฏุฑ </font></font></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cxx</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic.vert</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pixelize.frag</font></font></a> </li></ul><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดุญุฐ </font></font></h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b52/674/617/b52674617a0733ee1fe0d525b0053750.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฒูุฏ ุชุฃุซูุฑ ุงูุชูุถูุญ (ุงูุชูุถูุญ) ุงูุชุจุงูู ุนูุฏ ุญูุงู ุงูุตูุฑุฉ. </font><font style="vertical-align: inherit;">ูุตุจุญ ูููุฏูุง ุนูุฏูุง ุชููู ุงูุฑุณููุงุช ูุงุนูุฉ ุฌุฏูุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float amount = 0.8; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนู ุทุฑูู ุชุบููุฑ ุงููููุฉ ุ ูููููุง ุงูุชุญูู ูู ุญุฌู ุญุฏุฉ ุงููุชูุฌุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ุงููููุฉ ุตูุฑูุง ุ ููู ุชุชุบูุฑ ุงูุตูุฑุฉ. </font><font style="vertical-align: inherit;">ูุน ุงูููู ุงูุณูุจูุฉ ุ ุชุจุฏุฃ ุงูุตูุฑุฉ ูุชุจุฏู ุบุฑูุจุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float neighbor = amount * -1; float center = amount * 4 + 1; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุธุงูุง ุงููุฌุงูุฑุฉ ูุถุฑูุจุฉ ูู </font></font><code>amount * -1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุงูุดุทุฑ ุงูุญุงูู ูุถุฑูุจ ูู </font></font><code>amount * 4 + 1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec3 color = texture(sharpenTexture, vec2(gl_FragCoord.x + 0, gl_FragCoord.y + 1) / texSize).rgb * neighbor + texture(sharpenTexture, vec2(gl_FragCoord.x - 1, gl_FragCoord.y + 0) / texSize).rgb * neighbor + texture(sharpenTexture, vec2(gl_FragCoord.x + 0, gl_FragCoord.y + 0) / texSize).rgb * center + texture(sharpenTexture, vec2(gl_FragCoord.x + 1, gl_FragCoord.y + 0) / texSize).rgb * neighbor + texture(sharpenTexture, vec2(gl_FragCoord.x + 0, gl_FragCoord.y - 1) / texSize).rgb * neighbor ; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุดุธุงูุง ุงููุฌุงูุฑุฉ ูู ุงูุฃุนูู ูุงูุฃุณูู ูุงููุณุงุฑ ูุงููููู. </font><font style="vertical-align: inherit;">ุจุนุฏ ุถุฑุจ ุงูุฌูุฑุงู ูุงูุฌุฒุก ุงูุญุงูู ุจููููู ุ ุชุชู ุฅุถุงูุฉ ุงููุชูุฌุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... fragColor = vec4(color, texture(sharpenTexture, texCoord).a); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฐุง ุงููุจูุบ ูู ุงูููู ุงูููุงุฆู ููุฌุฒุก. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดูุฑุฉ ุงููุตุฏุฑ </font></font></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cxx</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic.vert</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sharpen.frag</font></font></a> </li></ul><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ุงูุญุจูุจ </font></font></h2><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2f3/16e/232/2f316e232598d07fa8114f8db32c12a7.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุฃู ุชุถูู ุญุจุฉ ุงููููู (ุจุฌุฑุนุงุช ุตุบูุฑุฉ ุ ูููุณ ููุง ูู ุงููุซุงู) ูุงูุนููุง ุ ููู ุฃูุฑ ุบูุฑ ูุฑุฆู ุญุชู ุชุชู ุฅุฒุงูุฉ ูุฐุง ุงูุชุฃุซูุฑ. </font><font style="vertical-align: inherit;">ุนุงุฏุฉ ูุง ุชููู ูุฐู ูู ุงูุนููุจ ุงูุชู ุชุฌุนู ุงูุตูุฑุฉ ุงููููุฏุฉ ุฑููููุง ุฃูุซุฑ ุฅููุงุนูุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃู ุญุจุฉ ุงููููู ุชููู ุนุงุฏุฉู ุขุฎุฑ ุชุฃุซูุฑ ูุชู ุชุทุจููู ุนูู ุงูุฅุทุงุฑ ูุจู ุนุฑุถู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุฉ </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... float amount = 0.1; // ...</span></span></code> </pre> <br> <code>amount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชุญูู ูู ุฑุคูุฉ ูููู ุงูุญุจูุจ. </font><font style="vertical-align: inherit;">ูููุง ุฒุงุฏุช ุงููููุฉ ุ ุฒุงุฏ "ุชุณุงูุท ุงูุซููุฌ" ูู ุงูุตูุฑุฉ.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณุทูุน ุนุดูุงุฆู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// ... uniform float osg_FrameTime; //... float toRadians = 3.14 / 180; //... float randomIntensity = fract ( 10000 * sin ( ( gl_FragCoord.x + gl_FragCoord.y * osg_FrameTime ) * toRadians ) ); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุณุจ ูุฐู ุงูุดูุฑุฉ ุงูุณุทูุน ุงูุนุดูุงุฆู ุงููุงุฒู ูุถุจุท ุงููููุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">Time Since F1 = <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">01</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span> <span class="hljs-number"><span class="hljs-number">03</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">05</span></span> <span class="hljs-number"><span class="hljs-number">06</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-number"><span class="hljs-number">08</span></span> <span class="hljs-number"><span class="hljs-number">09</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> Frame Number = F1 F3 F4 F5 F6 osg_FrameTime = <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-number"><span class="hljs-number">08</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฉ </font></font><code>osg_FrameTime</code> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฏูุฉ ูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Panda3D. </font><font style="vertical-align: inherit;">ููุช ุงูุฅุทุงุฑ ูู ุทุงุจุน ุฒููู ูุญุชูู ุนูู ูุนูููุงุช ุญูู ุนุฏุฏ ุงูุซูุงูู ุงูุชู ูุฑุช ููุฐ ุงูุฅุทุงุฑ ุงูุฃูู. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูููุฐุฌ ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ูุชุญุฑูู ุญุจุฉ ุงููููู ุ ูุงูุชู </font></font><code>osg_FrameTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชููู ูุฎุชููุฉ ูู ูู ุฅุทุงุฑ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... ( gl_FragCoord.x + gl_FragCoord.y * 8009 // Large number here. // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ููุญุจูุจ ุงูุซุงุจุชุฉ ุ ูุฌุจ ุงุณุชุจุฏุงู ุงูุฃููุงู </font></font><code>osg_FrameTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏุฏ ูุจูุฑ. </font><font style="vertical-align: inherit;">ูุชุฌูุจ ุฑุคูุฉ ุงูุฃููุงุท ุ ููููู ุชุฌุฑุจุฉ ุฃุฑูุงู ูุฎุชููุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/358/2bd/6d2/3582bd6d2d67eb5ac1fdcdf8d52800e6.gif"></div><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... * sin ( ( gl_FragCoord.x + gl_FragCoord.y * someNumber // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅูุดุงุก ููุงุท ุฃู ุจูุน ูุญุจูุจ ุงููููู ุ ูุชู ุงุณุชุฎุฏุงู ูู ูู ุงูุฅุญุฏุงุซูุงุช ู x ู y. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุณุชุฎุฏู x ุ ูุณูุชู ุนุฑุถ ุงูุฎุทูุท ุงูุฑุฃุณูุฉ ููุท ุ ูุฅุฐุง ููุช ุชุณุชุฎุฏู y ุ ูุณูุชู ุนุฑุถ ุงูุฎุทูุท ุงูุฃูููุฉ ููุท. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุฏ ุ ูุชู ุถุฑุจ ุฅุญุฏุงุซู ูุงุญุฏ ุจุขุฎุฑ ูุชุฏููุฑ ุงูุชูุงุซู ุงููุงุฆู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4c0/ad6/d5a/4c0ad6d5ada5d533b6dc31bbfa7aa0fc.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุทุจุน ุ ููููู ุงูุชุฎูุต ูู ูุถุงุนู ุงูุฅุญุฏุงุซูุงุช ุ ูุงูุญุตูู ุนูู ุชุฃุซูุฑ ูุทุฑ ููุจูู ุชูุงููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃูู ูุชุญุฑูู ุชุฃุซูุฑ ุงููุทุฑ ุ ุงุถุฑุจ ุงููุงุชุฌ </font></font><code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจ </font></font><code>osg_FrameTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชุฌุฑุจุฉ ุฅุญุฏุงุซูุงุช x ู y ูุชุบููุฑ ุงุชุฌุงู ุงููุทุฑ. </font><font style="vertical-align: inherit;">ููุงุณุชุญูุงู ููุฃุณูู ุ ุงุชุฑู ุฅุญุฏุงุซู x ููุท.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">input = (gl_FragCoord.x + gl_FragCoord.y * osg_FrameTime) * toRadians frame(<span class="hljs-number"><span class="hljs-number">10000</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(input)) = fract(<span class="hljs-number"><span class="hljs-number">10000</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(<span class="hljs-number"><span class="hljs-number">6.977777777777778</span></span>)) = fract(<span class="hljs-number"><span class="hljs-number">10000</span></span> * <span class="hljs-number"><span class="hljs-number">0.6400723818964882</span></span>) =</code> </pre> <br> <code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณุชุฎุฏู ูุธููุฉ ุงูุชุฌุฒุฆุฉ. </font><font style="vertical-align: inherit;">ูุชู ุชุฌุฒุฆุฉ ุฅุญุฏุงุซูุงุช ุฌุฒุก ูุน ููู ุงูุฅุฎุฑุงุฌ </font></font><code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจูุถู ูุฐุง ุ ุชุธูุฑ ุฎุงุตูุฉ ููุงุฆูุฉ - ูููุง ูุงูุช ุจูุงูุงุช ุงูุฅุฏุฎุงู (ูุจูุฑุฉ ุฃู ุตุบูุฑุฉ) ุ ูุฅู ุงููุงุตู ุงูุฒููู ููุฅุฎุฑุงุฌ ุณูููู ูู ุงููุทุงู ูู ูุงูุต ูุงุญุฏ ุฅูู ูุงุญุฏ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">fract(<span class="hljs-number"><span class="hljs-number">10000</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(<span class="hljs-number"><span class="hljs-number">6.977777777777778</span></span>)) = fract(<span class="hljs-number"><span class="hljs-number">10000</span></span> * <span class="hljs-number"><span class="hljs-number">0.6400723818964882</span></span>) = fract(<span class="hljs-number"><span class="hljs-number">6400.723818964882</span></span>) = <span class="hljs-number"><span class="hljs-number">0.723818964882</span></span></code> </pre> <br> <code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุฑููุจุฉ ูุน </font></font><code>fract</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณุชุฎุฏู ุฃูุถุง ููููุฏ ุนุฏุฏ ุนุดูุงุฆู ุงูุฒุงุฆูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">&gt;&gt;&gt; [<span class="hljs-built_in"><span class="hljs-built_in">floor</span></span>(fract(<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>(x * toRadians)) * <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span><span class="hljs-function"> x in </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">] [0, 0, 1, 2, 2, 3, 4, 4, 5, 6] &gt;&gt;&gt; [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(fract(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10000</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">sin</span></span></span></span><span class="hljs-function"><span class="hljs-params">(x * toRadians)) * </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">for</span></span></span><span class="hljs-function"> x in </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">] [0, 4, 8, 0, 2, 1, 7, 0, 0, 5]</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅููุงุก ูุธุฑุฉ ุฃููู ุนูู ุงูุตู ุงูุฃูู ูู ุงูุฃุฑูุงู ุ ุซู ูู ุงูุตู ุงูุซุงูู. </font><font style="vertical-align: inherit;">ูู ุตู ูู ุญุชููุฉ ุ ูููู ุงูููุท ุฃูู ูุถูุญุง ูู ุงูุซุงููุฉ ูู ุงูุซุงููุฉ. </font><font style="vertical-align: inherit;">ูุฐูู ุ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุงูุฅุฎุฑุงุฌ </font></font><code>fract(10000 * sin(...))</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชููุฉ ุ ูุชู ุงูุชุนุฑู ุนูู ุงูููุท ุฃุถุนู ุจูุซูุฑ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b88/6e7/f0f/b886e7f0feda6760c5fc87df6680680f.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูุฑู ููู ูููู ุงูุนุงูู </font></font><code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃูู 1 ุ ุซู 10 ุ ุซู 100 ุ ุซู 1000. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุน ุฒูุงุฏุฉ ูุถุงุนู ููู ุงููุฎุฑุฌุงุช ุ </font></font><code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุจุญ ุงููููุฐุฌ ุฃูู ูุถูุญูุง. </font><font style="vertical-align: inherit;">ููุฐุง ุงูุณุจุจ ุ </font></font><code>sin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุถุฑุจ </font><font style="vertical-align: inherit;">ุงูููุฏ </font><font style="vertical-align: inherit;">ุจู 10ุ000.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดุธูุฉ ุงูููู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... vec2 texSize = textureSize(filmGrainTexture, 0).xy; vec2 texCoord = gl_FragCoord.xy / texSize; vec4 color = texture(filmGrainTexture, texCoord); // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญููู ุฅุญุฏุงุซูุงุช ุงูุฌุฒุก ุฅูู ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ. </font><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูุฐู ุ ูุฅููุง ูุจุญุซ ุนู ููู ุงููุณูุฌ ููุฌุฒุก ุงูุญุงูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... amount *= randomIntensity; color.rgb += amount; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุชุบููุฑ ุงููููุฉ ุฅูู ุณุทูุน ุนุดูุงุฆู ูุฅุถุงูุชูุง ุฅูู ุงูููู. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">// ... fragColor = color; // ...</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงุถุจุท ููู ุงููุทุนุฉ ุ ููุฐุง ูู ุดูุก. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดูุฑุฉ ุงููุตุฏุฑ </font></font></h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.cxx</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">basic.vert</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู grain.frag</font></font></a> </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุดูุฑ </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">Kiwi Soda Font</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar453692/">https://habr.com/ru/post/ar453692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar453672/index.html">CardInfo - API ูุชุญุฏูุฏ ุงูุดุนุงุฑ ูุฃููุงู ุงูุจูู ูุฃุดูุงุก ุฃุฎุฑู ุนู ุทุฑูู ุฑูู ุงูุจุทุงูุฉ</a></li>
<li><a href="../ar453676/index.html">ุงูุงุชุตุงู ุจู Windows ุนุจุฑ SSH ููุง ูู Linux</a></li>
<li><a href="../ar453678/index.html">ููููุฉ ุฑุคูุฉ ุงูุตุฏู ุฃู ููู ุงูููุฏูู ุนู ุทุฑูู ุงูุตูุช ูู ุฎูุงู ุงููุงุก - 2</a></li>
<li><a href="../ar453686/index.html">ุฃุณุจูุน ุงูุฃูู 22: ุฅุญุตุงุฆูุงุช ุงูุชูุฏูุฏ ุ ูุฃุญุตูุฉ ุทุฑูุงุฏุฉ ุงููุตุฑููุฉ ูุงูุงุณุชุบูุงูุงุช ุงูุดุนุจูุฉ</a></li>
<li><a href="../ar453688/index.html">ุฌุงูุง ููุณุช ููุท ูุคุณุณุฉ ุฏุงููุฉ ุ ูููู ุฃูุถูุง ุชุทุจููุงุช ุณุฑูุนุฉ ุญุณุงุณุฉ ุฒูู ุงููุตูู</a></li>
<li><a href="../ar453694/index.html">ุงุชุตู ุจู Windows ุนุจุฑ SSH ููุง ูู ูุธุงู Linux</a></li>
<li><a href="../ar453696/index.html">ุงูุฒุงูู ูู ุงุชุฌุงููู ููุฒูุฉ ุ ููู ุฃูุซุฑ ููููุง</a></li>
<li><a href="../ar453698/index.html">ุงููุนูููุงุช ุงููููููุฉ ูู ุงููุนู ุงูููููู</a></li>
<li><a href="../ar453700/index.html">ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ ูู SDL 2: ุงูุฏุฑุณ 1 - ูุฑุญุจูุง ุ SDL 2</a></li>
<li><a href="../ar453706/index.html">ููู ูุฌุญุช ูู ุงูุชุญุงู ุดูุงุฏุฉ ูููุฏุณ ุจูุงูุงุช Google Cloud Professional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>