<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💒 🎸 👃🏻 Cómo hacer que Python funcione aún mejor ♏️ 👊🏼 🎠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En realidad, el título de este maravilloso artículo de Jeff Knapp, el autor del libro " Writing Idiomatic Python " refleja plenamente su esencia. Lea ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cómo hacer que Python funcione aún mejor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/426381/">  En realidad, el título de este maravilloso artículo de Jeff Knapp, el autor del libro " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Writing Idiomatic Python</a> " refleja plenamente su esencia.  Lea atentamente y no dude en comentar. <br><br>  Como realmente no queríamos dejar el término importante en letras latinas en el texto, nos permitimos traducir la palabra "docstring" como "docstring", después de haber descubierto este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">término</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">varias</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuentes</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ruso</a> . <br><a name="habracut"></a><br>  En Python, como en la mayoría de los lenguajes de programación modernos, la función es el método principal de abstracción y encapsulación.  Usted, como desarrollador, probablemente ya haya escrito cientos de funciones.  Pero funciones a funciones - discordia.  Además, si escribe funciones "malas", esto afectará inmediatamente la legibilidad y el soporte de su código.  Entonces, ¿qué es una función "mala" y, lo que es más importante, cómo hacerla "buena"? <br><br><h3>  Actualizar el tema </h3><br>  Las matemáticas están repletas de funciones, sin embargo, es difícil recordarlas.  Así que volvamos a nuestra disciplina favorita: el análisis.  Probablemente has visto fórmulas como <code>f(x) = 2x + 3</code> .  Esta es una función llamada <code>f</code> que toma un argumento <code>x</code> y luego "devuelve" dos veces <code>x + 3</code> .  Aunque no es muy similar a las funciones a las que estamos acostumbrados en Python, es completamente similar al siguiente código: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>*x + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Las funciones han existido durante mucho tiempo en las matemáticas, pero en ciencias de la computación están completamente transformadas.  Sin embargo, este poder no se da en vano: tienes que superar varias trampas.  Analicemos qué debe ser una función "buena" y qué "campanas y silbatos" son típicos para funciones que pueden requerir refactorización. <br><br><h3>  Secretos de buena función </h3><br>  ¿Qué distingue una función Python "buena" de una función mediocre?  Se sorprenderá de cuántas interpretaciones permite la palabra "bueno".  Como parte de este artículo, consideraré la función de Python "buena" si satisface la <i>mayoría de los</i> elementos de la siguiente lista (a veces no es posible completar todos los elementos para una función en particular): <br><br><ul><li>  Se llama claramente </li><li>  Cumple con el principio del deber único </li><li>  Contiene muelle </li><li>  Valor devuelto </li><li>  Consiste en no más de 50 líneas </li><li>  Ella es idempotente y, si es posible, pura. </li></ul><br>  Para muchos de ustedes, estos requisitos pueden parecer demasiado duros.  Sin embargo, lo prometo: si sus funciones cumplen con estas reglas, resultarán tan hermosas que incluso perforarán un unicornio con una lágrima.  A continuación dedicaré una sección a cada uno de los elementos de la lista anterior, y luego completaré la historia contando cómo se armonizan entre sí y ayudan a crear buenas funciones. <br><br>  <b>Nombrar</b> <br><br>  Aquí está mi cita favorita sobre este tema, a menudo atribuida erróneamente a Donald, pero en realidad propiedad de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Phil Carleton</a> : <br><blockquote>  Hay dos desafíos para la informática: invalidación de caché y nombres. </blockquote>  No importa cuán tonto suene, nombrar es realmente algo complicado.  Aquí hay un ejemplo de un nombre de función "malo": <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_knn_from_df</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Ahora, los malos nombres me llegan casi a todas partes, pero este ejemplo está tomado del campo de la ciencia de datos (más precisamente, el aprendizaje automático), donde los profesionales generalmente escriben código en un cuaderno Jupyter y luego intentan ensamblar un programa digerible a partir de estas celdas. <br><br>  El primer problema con el nombre de esta función es que usa abreviaturas.  <b>Es mejor usar palabras completas en inglés, en lugar de abreviaturas y abreviaturas no conocidas</b> .  La única razón por la que quiero acortar las palabras es para no perder el tiempo escribiendo demasiado texto, pero <i>cualquier editor moderno tiene una función de autocompletado</i> , por lo que debe escribir el nombre completo de la función solo una vez.  La abreviatura es un problema, porque a menudo es específica para un área temática.  En el código anterior, <code>knn</code> significa "K-vecinos más cercanos", y <code>df</code> significa "DataFrame", una estructura de datos comúnmente utilizada en la biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pandas</a> .  Si un programador que no conoce estas abreviaturas lee el código, entonces no entenderá casi nada en el nombre de la función. <br><br>  Hay dos defectos menores más en el nombre de esta función.  En primer lugar, la palabra <code>"get"</code> redundante.  En la mayoría de las funciones con nombre competente, está claro de inmediato que esta función devuelve algo, que se refleja específicamente en el nombre.  El elemento <code>from_d</code> f tampoco es necesario.  Ya sea en la base de funciones o (si está en la periferia), el tipo del parámetro se describirá en la anotación de tipo si esta información <i>no es obvia del nombre del parámetro</i> . <br><br>  Entonces, ¿cómo cambiamos el nombre de esta función?  Solo: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k_nearest_neighbors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dataframe)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Ahora, incluso un lego entiende lo que se está calculando en esta función, y el nombre del parámetro <code>(dataframe)</code> no deja dudas sobre qué argumento se le debe pasar. <br><br><h3>  Responsabilidad exclusiva </h3><br>  Desarrollando la idea de Bob Martin, diré que el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">principio de responsabilidad exclusiva se</a> aplica a funciones no menos que clases y módulos (sobre los cuales el Sr. Martin escribió originalmente).  De acuerdo con este principio (en nuestro caso), una función debe tener una sola responsabilidad.  Es decir, ella debe hacer una y solo una cosa.  Una de las razones más convincentes para esto: si una función hace solo una cosa, entonces tendrá que reescribirse en el único caso: si esto mismo tiene que hacerse de una manera nueva.  También queda claro cuándo se puede eliminar una función;  si, haciendo cambios en otro lugar, entendemos que el único deber de una función ya no es relevante, entonces simplemente nos desharemos de ella. <br><br>  Es mejor dar un ejemplo.  Aquí hay una función que hace más de una "cosa": <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculate_and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_stats</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(list_of_numbers)</span></span></span><span class="hljs-function">:</span></span> sum = sum(list_of_numbers) mean = statistics.mean(list_of_numbers) median = statistics.median(list_of_numbers) mode = statistics.mode(list_of_numbers) print(<span class="hljs-string"><span class="hljs-string">'-----------------Stats-----------------'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'SUM: {}'</span></span>.format(sum) print(<span class="hljs-string"><span class="hljs-string">'MEAN: {}'</span></span>.format(mean) print(<span class="hljs-string"><span class="hljs-string">'MEDIAN: {}'</span></span>.format(median) print(<span class="hljs-string"><span class="hljs-string">'MODE: {}'</span></span>.format(mode)</code> </pre> <br>  A saber, dos: calcula un conjunto de estadísticas en una lista de números y los muestra en <code>STDOUT</code> .  Una función viola una regla: debe haber una única razón específica por la que deba modificarse.  En este caso, hay dos razones obvias por las que esto es necesario: o necesita calcular estadísticas nuevas o diferentes, o necesita cambiar el formato de salida.  Por lo tanto, es mejor reescribir esta función en forma de dos funciones separadas: una realizará cálculos y devolverá sus resultados, y la otra recibirá estos resultados y los mostrará en la consola.  <i>Una función (o más bien, tiene dos responsabilidades) con menudillos da la palabra <b>y</b> en su nombre</i> . <br><br>  Esta separación también simplifica enormemente la prueba de la función, y también le permite no solo dividirla en dos funciones dentro del mismo módulo, sino incluso separar estas dos funciones en módulos completamente diferentes, si corresponde.  Esto contribuye aún más a pruebas más limpias y simplifica el soporte de código. <br><br>  De hecho, las funciones que realizan exactamente dos cosas son raras.  Más a menudo, te encuentras con funciones que realizan muchas, muchas más operaciones.  Nuevamente, por razones de legibilidad y comprobabilidad, tales funciones de "múltiples estaciones" deben dividirse en tareas únicas, cada una de las cuales contiene un solo aspecto del trabajo. <br><br><h3>  Docstrings </h3><br>  Parece que todos saben que hay un documento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEP-8</a> que da recomendaciones sobre el estilo del código Python, pero hay muchas menos personas entre nosotros que conocen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEP-257</a> , en el que se dan las mismas recomendaciones con respecto a las cadenas de acoplamiento.  Para no volver a contar el contenido de PEP-257, lo envío a este documento usted mismo, lea en su tiempo libre.  Sin embargo, sus ideas principales son las siguientes: <br><br><ul><li>  Cada función necesita una cadena de documentación. </li><li>  Debe observar gramática y puntuación;  escribir oraciones completas </li><li>  La cadena de documentación comienza con una breve descripción (en una oración) de lo que hace la función. </li><li>  La cadena de documentos se formula en un estilo prescriptivo en lugar de descriptivo </li></ul><br>  Todos estos puntos son fáciles de seguir al escribir características.  Simplemente escribir docstrings debería convertirse en un hábito e intentar escribirlos antes de continuar con el código de la función en sí.  Si no puede escribir una cadena de documentos clara que describa la función, esta es una buena razón para pensar por qué está escribiendo esta función. <br><br><h3>  Valores de retorno </h3><br>  Las funciones pueden (y <i>deben</i> ) interpretarse como pequeños programas autónomos.  Toman alguna entrada en forma de parámetros y devuelven el resultado.  Los parámetros, por supuesto, son opcionales.  <i>Pero los valores de retorno son necesarios desde el punto de vista de la estructura interna de Python</i> .  Si incluso intenta escribir una función que no devuelve un valor, no puede.  Si la función ni siquiera devuelve valores, entonces el intérprete de Python la "obligará" a devolver <code>None</code> .  No lo creo?  Pruébalo tú mismo: <br><br><pre> <code class="python hljs">❯ python3 Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (default, Jul <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span>) [Clang <span class="hljs-number"><span class="hljs-number">9.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (clang<span class="hljs-number"><span class="hljs-number">-902.0</span></span><span class="hljs-number"><span class="hljs-number">.39</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>)] on darwin Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span><span class="hljs-function">:</span></span> ... print(a + b) ... &gt;&gt;&gt; b = add(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;&gt;&gt; b &gt;&gt;&gt; b <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Como puede ver, el valor de <code>b</code> es esencialmente <code>None</code> .  Entonces, incluso si escribe una función sin una declaración de devolución, aún devolverá algo.  Y deberia.  Después de todo, este es un programa pequeño, ¿verdad?  ¿Qué tan útiles son los programas de los cuales no hay conclusión, y por lo tanto es imposible juzgar si este programa se ejecutó correctamente?  Pero lo más importante, ¿cómo vas a <i>probar</i> dicho programa? <br><br>  Ni siquiera tengo miedo de decir lo siguiente: cada función debería devolver un valor útil, al menos en aras de la capacidad de prueba.  El código que escribo debe ser probado (esto no se discute).  Solo imagine lo torpe que puede resultar la prueba de la función de <code>add</code> anterior (pista: tendrá que redirigir la entrada / salida, después de lo cual todo saldrá mal pronto).  Además, al devolver un valor, podemos encadenar métodos y, por lo tanto, escribir código como este: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'foo.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.strip().lower().endswith(<span class="hljs-string"><span class="hljs-string">'cat'</span></span>): <span class="hljs-comment"><span class="hljs-comment"># ...     - </span></span></code> </pre> <br>  Cadena <code>if line.strip().lower().endswith('cat'):</code> funciona porque cada uno de los métodos de cadena ( <code>strip()</code> , <code>lower()</code> , <code>endswith()</code> ) devuelve una cadena como resultado de llamar a la función. <br><br>  Aquí hay algunas razones comunes que un programador puede darle al explicar por qué una función que escribe no devuelve un valor: <br><blockquote>  “Es solo [algún tipo de operación relacionada con la entrada / salida, por ejemplo, almacenar un valor en una base de datos].  Aquí no puedo devolver nada útil. </blockquote>  No estoy de acuerdo  La función puede devolver True si la operación se completó con éxito. <br><blockquote>  “Aquí cambiamos uno de los parámetros disponibles, lo usamos como parámetro de referencia”. "" </blockquote>  Aquí hay dos puntos.  Primero, haz tu mejor esfuerzo para no hacer esto.  En segundo lugar, proporcionar una función con algún tipo de argumento solo para descubrir que ha cambiado es sorprendente en el mejor de los casos, y simplemente peligroso en el peor.  En cambio, al igual que con los métodos de cadena, intente devolver una nueva instancia del parámetro que ya refleje los cambios que se le aplicaron.  Incluso si esto no se puede hacer, ya que la creación de una copia de algún parámetro está cargada de costos excesivos, aún puede volver a la opción "Volver <code>True</code> si la operación se completó con éxito" propuesta anteriormente. <br><blockquote>  “Necesito devolver múltiples valores.  No hay un valor único que en este caso sería aconsejable devolver ". </blockquote>  Este argumento es un poco exagerado, pero lo he escuchado.  La respuesta, por supuesto, es precisamente lo que el autor quería hacer, pero no sabía cómo: <i>usar una tupla para devolver múltiples valores</i> . <br><br>  Finalmente, el argumento más fuerte de que es mejor devolver un valor útil en cualquier caso es que la persona que llama siempre puede ignorar justificadamente estos valores.  En resumen, devolver un valor de una función es casi seguro una buena idea, y es muy poco probable que dañemos algo de esta manera, incluso en las bases de código existentes. <br><br><h3>  Longitud de la función </h3><br>  Admití más de una vez que soy bastante tonto.  Puedo tener alrededor de tres cosas en mi cabeza al mismo tiempo.  Si me permite leer la función de 200 líneas y preguntar qué hace, probablemente la miraré durante al menos 10 segundos.  <b>La longitud de una función afecta directamente su legibilidad y, por lo tanto, su soporte</b> .  Por lo tanto, trate de mantener sus funciones cortas.  50 líneas: un valor tomado completamente del techo, pero me parece razonable.  (Espero) que la mayoría de las funciones que escribes serán mucho más cortas. <br><br>  Si una función cumple con el Principio de responsabilidad exclusiva, es probable que sea lo suficientemente breve.  Si es de lectura o idempotente (hablaremos de esto) a continuación, entonces, probablemente, también será breve.  Todas estas ideas se combinan armoniosamente entre sí y ayudan a escribir un código bueno y limpio. <br><br>  Entonces, ¿qué hacer si su función es demasiado larga?  <b>REFACTOR!</b>  Probablemente tenga que refactorizar todo el tiempo, incluso si no conoce el término.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Refactorizar</a> es simplemente cambiar la estructura de un programa, sin cambiar su comportamiento.  Por lo tanto, extraer varias líneas de código de una función larga y convertirlas en una función independiente es uno de los tipos de refactorización.  Resulta que esta es también la forma más común y rápida de acortar productivamente las funciones largas.  Como le está dando a estas nuevas funciones nombres apropiados, el código resultante es mucho más fácil de leer.  Escribí un libro completo sobre refactorización (de hecho, lo hago todo el tiempo), así que no entraré en detalles aquí.  Solo sepa que si tiene una función que es demasiado larga, debe refactorizarla. <br><br><h3>  Idempotencia y limpieza funcional </h3><br>  El título de esta sección puede parecer un poco intimidante, pero conceptualmente la sección es simple.  Una función idempotente con el mismo conjunto de argumentos siempre devuelve el mismo valor, independientemente de cuántas veces se llame.  El resultado no depende de variables no locales, la variabilidad de los argumentos o de ningún dato proveniente de flujos de entrada / salida.  La siguiente función <code>add_three(number)</code> es idempotente: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Independientemente de cuántas veces llamemos <code>add_three(7)</code> , la respuesta siempre será 10. Pero otro caso es una función que no es idempotente: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 3 + ,  ."""</span></span> number = int(input(<span class="hljs-string"><span class="hljs-string">'Enter a number: '</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Esta función francamente ideada no es idempotente, ya que el valor de retorno de la función depende de la entrada / salida, es decir, del número ingresado por el usuario.  Por supuesto, con diferentes llamadas a <code>add_three()</code> valores de retorno serán diferentes.  Si llamamos a esta función dos veces, el usuario en el primer caso puede ingresar 3, y en el segundo - 7, y luego dos llamadas a <code>add_three()</code> devolverán 6 y 10, respectivamente. <br><br>  Fuera de la programación, también hay ejemplos de idempotencia: por ejemplo, el botón arriba del elevador está diseñado de acuerdo con este principio.  Al presionarlo por primera vez, "notificamos" al elevador que queremos subir.  Como el botón es idempotente, no importa cuánto lo presiones más tarde, no pasará nada malo.  El resultado siempre será el mismo. <br><br><h3>  ¿Por qué es tan importante la idempotencia? </h3><br>  Capacidad de prueba y usabilidad.  Las funciones idempotentes son fáciles de probar, ya que se garantiza que devolverán el mismo resultado en cualquier caso si las llama con los mismos argumentos.  Las pruebas se reducen a verificar que con una variedad de llamadas, la función siempre devuelve el valor esperado.  Además, estas pruebas serán rápidas: la velocidad de prueba es un tema importante que a menudo se pasa por alto en las pruebas unitarias.  Y refactorizar cuando se trabaja con funciones idempotentes es generalmente una caminata fácil.  No importa cómo cambie el código fuera de la función: el resultado de llamarlo con los mismos argumentos siempre será el mismo. <br><br><h3>  ¿Qué es una función "pura"? </h3><br>  En la programación funcional, una función se considera pura si, en <i>primer lugar</i> , es idempotente y, en <i>segundo lugar</i> , no causa los <b>efectos secundarios</b> observados.  No lo olvide: una función es idempotente si siempre devuelve el mismo resultado con un conjunto específico de argumentos.  Sin embargo, esto no significa que la función no pueda afectar a otros componentes, por ejemplo, variables no locales o flujos de entrada / salida.  Por ejemplo, si la versión idempotente de la función <code>add_three(number)</code> anterior <code>add_three(number)</code> el resultado en la consola, y solo luego lo devuelve, aún se consideraría idempotente, porque cuando accede a la secuencia de entrada / salida, esta operación de acceso no afecta el valor devuelto de la función  La llamada <code>print()</code> es solo un <i>efecto secundario</i> : interacción con el resto del programa o sistema como tal, que ocurre junto con el valor de retorno. <br><br>  Desarrollemos un poco nuestro ejemplo con <code>add_three(number)</code> .  Puede escribir el siguiente código para determinar cuántas veces se ha llamado a <code>add_three(number)</code> : <br><br><pre> <code class="python hljs">add_three_calls = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> add_three_calls print(<span class="hljs-string"><span class="hljs-string">f'Returning </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{number + </span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">'</span></span>) add_three_calls += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num_calls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""",     *add_three*."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> add_three_calls</code> </pre> <br>  Ahora ejecutamos la salida a la consola (esto es un efecto secundario) y cambiamos la variable no local (otro efecto secundario), pero dado que ninguno de los dos afecta el valor devuelto por la función, de todos modos es idempotente. <br><br>  La función pura no tiene efectos secundarios.  No solo no utiliza ningún "dato externo" al calcular el valor, sino que no interactúa con el resto del programa / sistema, solo calcula y devuelve el valor especificado.  Por lo tanto, aunque nuestra nueva definición de <code>add_three(number)</code> sigue siendo idempotente, esta función ya no es pura. <br><br>  En las funciones puras no hay instrucciones de registro o llamadas <code>print()</code> .  Cuando trabajan, no acceden a la base de datos y no usan conexiones a Internet.  No acceda ni modifique variables no locales.  <b>Y no llame a otras funciones no puras</b> . <br><br>  En resumen, no tienen una "acción terrible de largo alcance", como lo expresan las palabras de Einstein (pero en el contexto de la informática, no de la física).  No alteran de ninguna manera el resto del programa o sistema.  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">programación imperativa</a> (que es lo que haces cuando escribes código en Python), tales funciones son las más seguras.  Son conocidos por su capacidad de prueba y facilidad de soporte;  Además, dado que son idempotentes, se garantiza que probar tales funciones sea tan rápido como ejecutarlo.  Las pruebas en sí también son simples: no tiene que conectarse a la base de datos o simular ningún recurso externo, preparar la configuración inicial del código y, al final del trabajo, no necesita limpiar nada. <br><br>  Honestamente, la idempotencia y la limpieza son muy deseables, pero no requeridas.  ,         ,     ,     . , ,  ,    ,         .  ,        ,           . <br><br><h3>  Conclusión </h3><br>  Eso es todo ,     –   .          . ,   .    –    !          . ,  ,   ,       « ».     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es426381/">https://habr.com/ru/post/es426381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es426371/index.html">Resumen de audio: 17 materiales y guías prácticas sobre el tema de la acústica profesional.</a></li>
<li><a href="../es426373/index.html">Construyendo funciones en la consola. Parte 1</a></li>
<li><a href="../es426375/index.html">Análisis tecnológico: dónde comenzar a trabajar en el panorama de patentes</a></li>
<li><a href="../es426377/index.html">Juego usando tablas de matemáticas en lugar de tablas</a></li>
<li><a href="../es426379/index.html">Deshacerse de las ilusiones</a></li>
<li><a href="../es426385/index.html">¿Por qué no deberías aprender inglés académico?</a></li>
<li><a href="../es426387/index.html">Gráficos en Julia. Patrones extraños, el reflejo de un triángulo desde una línea recta y la construcción de las normales de un gato esférico en el vacío.</a></li>
<li><a href="../es426389/index.html">El resumen de materiales frescos del mundo del front-end para la última semana No. 334 (7-14 de octubre de 2018)</a></li>
<li><a href="../es426391/index.html">PHP Digest No. 141 (1 al 15 de octubre de 2018)</a></li>
<li><a href="../es426395/index.html">Se cobrará una tarifa por los productos de las tiendas en línea extranjeras en el momento de la compra.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>