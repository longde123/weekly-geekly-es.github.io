<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíí üé∏ üëÉüèª C√≥mo hacer que Python funcione a√∫n mejor ‚ôèÔ∏è üëäüèº üé†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En realidad, el t√≠tulo de este maravilloso art√≠culo de Jeff Knapp, el autor del libro " Writing Idiomatic Python " refleja plenamente su esencia. Lea ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo hacer que Python funcione a√∫n mejor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/426381/">  En realidad, el t√≠tulo de este maravilloso art√≠culo de Jeff Knapp, el autor del libro " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Writing Idiomatic Python</a> " refleja plenamente su esencia.  Lea atentamente y no dude en comentar. <br><br>  Como realmente no quer√≠amos dejar el t√©rmino importante en letras latinas en el texto, nos permitimos traducir la palabra "docstring" como "docstring", despu√©s de haber descubierto este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">t√©rmino</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">varias</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuentes</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ruso</a> . <br><a name="habracut"></a><br>  En Python, como en la mayor√≠a de los lenguajes de programaci√≥n modernos, la funci√≥n es el m√©todo principal de abstracci√≥n y encapsulaci√≥n.  Usted, como desarrollador, probablemente ya haya escrito cientos de funciones.  Pero funciones a funciones - discordia.  Adem√°s, si escribe funciones "malas", esto afectar√° inmediatamente la legibilidad y el soporte de su c√≥digo.  Entonces, ¬øqu√© es una funci√≥n "mala" y, lo que es m√°s importante, c√≥mo hacerla "buena"? <br><br><h3>  Actualizar el tema </h3><br>  Las matem√°ticas est√°n repletas de funciones, sin embargo, es dif√≠cil recordarlas.  As√≠ que volvamos a nuestra disciplina favorita: el an√°lisis.  Probablemente has visto f√≥rmulas como <code>f(x) = 2x + 3</code> .  Esta es una funci√≥n llamada <code>f</code> que toma un argumento <code>x</code> y luego "devuelve" dos veces <code>x + 3</code> .  Aunque no es muy similar a las funciones a las que estamos acostumbrados en Python, es completamente similar al siguiente c√≥digo: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>*x + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Las funciones han existido durante mucho tiempo en las matem√°ticas, pero en ciencias de la computaci√≥n est√°n completamente transformadas.  Sin embargo, este poder no se da en vano: tienes que superar varias trampas.  Analicemos qu√© debe ser una funci√≥n "buena" y qu√© "campanas y silbatos" son t√≠picos para funciones que pueden requerir refactorizaci√≥n. <br><br><h3>  Secretos de buena funci√≥n </h3><br>  ¬øQu√© distingue una funci√≥n Python "buena" de una funci√≥n mediocre?  Se sorprender√° de cu√°ntas interpretaciones permite la palabra "bueno".  Como parte de este art√≠culo, considerar√© la funci√≥n de Python "buena" si satisface la <i>mayor√≠a de los</i> elementos de la siguiente lista (a veces no es posible completar todos los elementos para una funci√≥n en particular): <br><br><ul><li>  Se llama claramente </li><li>  Cumple con el principio del deber √∫nico </li><li>  Contiene muelle </li><li>  Valor devuelto </li><li>  Consiste en no m√°s de 50 l√≠neas </li><li>  Ella es idempotente y, si es posible, pura. </li></ul><br>  Para muchos de ustedes, estos requisitos pueden parecer demasiado duros.  Sin embargo, lo prometo: si sus funciones cumplen con estas reglas, resultar√°n tan hermosas que incluso perforar√°n un unicornio con una l√°grima.  A continuaci√≥n dedicar√© una secci√≥n a cada uno de los elementos de la lista anterior, y luego completar√© la historia contando c√≥mo se armonizan entre s√≠ y ayudan a crear buenas funciones. <br><br>  <b>Nombrar</b> <br><br>  Aqu√≠ est√° mi cita favorita sobre este tema, a menudo atribuida err√≥neamente a Donald, pero en realidad propiedad de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Phil Carleton</a> : <br><blockquote>  Hay dos desaf√≠os para la inform√°tica: invalidaci√≥n de cach√© y nombres. </blockquote>  No importa cu√°n tonto suene, nombrar es realmente algo complicado.  Aqu√≠ hay un ejemplo de un nombre de funci√≥n "malo": <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_knn_from_df</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Ahora, los malos nombres me llegan casi a todas partes, pero este ejemplo est√° tomado del campo de la ciencia de datos (m√°s precisamente, el aprendizaje autom√°tico), donde los profesionales generalmente escriben c√≥digo en un cuaderno Jupyter y luego intentan ensamblar un programa digerible a partir de estas celdas. <br><br>  El primer problema con el nombre de esta funci√≥n es que usa abreviaturas.  <b>Es mejor usar palabras completas en ingl√©s, en lugar de abreviaturas y abreviaturas no conocidas</b> .  La √∫nica raz√≥n por la que quiero acortar las palabras es para no perder el tiempo escribiendo demasiado texto, pero <i>cualquier editor moderno tiene una funci√≥n de autocompletado</i> , por lo que debe escribir el nombre completo de la funci√≥n solo una vez.  La abreviatura es un problema, porque a menudo es espec√≠fica para un √°rea tem√°tica.  En el c√≥digo anterior, <code>knn</code> significa "K-vecinos m√°s cercanos", y <code>df</code> significa "DataFrame", una estructura de datos com√∫nmente utilizada en la biblioteca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pandas</a> .  Si un programador que no conoce estas abreviaturas lee el c√≥digo, entonces no entender√° casi nada en el nombre de la funci√≥n. <br><br>  Hay dos defectos menores m√°s en el nombre de esta funci√≥n.  En primer lugar, la palabra <code>"get"</code> redundante.  En la mayor√≠a de las funciones con nombre competente, est√° claro de inmediato que esta funci√≥n devuelve algo, que se refleja espec√≠ficamente en el nombre.  El elemento <code>from_d</code> f tampoco es necesario.  Ya sea en la base de funciones o (si est√° en la periferia), el tipo del par√°metro se describir√° en la anotaci√≥n de tipo si esta informaci√≥n <i>no es obvia del nombre del par√°metro</i> . <br><br>  Entonces, ¬øc√≥mo cambiamos el nombre de esta funci√≥n?  Solo: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k_nearest_neighbors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dataframe)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Ahora, incluso un lego entiende lo que se est√° calculando en esta funci√≥n, y el nombre del par√°metro <code>(dataframe)</code> no deja dudas sobre qu√© argumento se le debe pasar. <br><br><h3>  Responsabilidad exclusiva </h3><br>  Desarrollando la idea de Bob Martin, dir√© que el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">principio de responsabilidad exclusiva se</a> aplica a funciones no menos que clases y m√≥dulos (sobre los cuales el Sr. Martin escribi√≥ originalmente).  De acuerdo con este principio (en nuestro caso), una funci√≥n debe tener una sola responsabilidad.  Es decir, ella debe hacer una y solo una cosa.  Una de las razones m√°s convincentes para esto: si una funci√≥n hace solo una cosa, entonces tendr√° que reescribirse en el √∫nico caso: si esto mismo tiene que hacerse de una manera nueva.  Tambi√©n queda claro cu√°ndo se puede eliminar una funci√≥n;  si, haciendo cambios en otro lugar, entendemos que el √∫nico deber de una funci√≥n ya no es relevante, entonces simplemente nos desharemos de ella. <br><br>  Es mejor dar un ejemplo.  Aqu√≠ hay una funci√≥n que hace m√°s de una "cosa": <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculate_and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_stats</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(list_of_numbers)</span></span></span><span class="hljs-function">:</span></span> sum = sum(list_of_numbers) mean = statistics.mean(list_of_numbers) median = statistics.median(list_of_numbers) mode = statistics.mode(list_of_numbers) print(<span class="hljs-string"><span class="hljs-string">'-----------------Stats-----------------'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'SUM: {}'</span></span>.format(sum) print(<span class="hljs-string"><span class="hljs-string">'MEAN: {}'</span></span>.format(mean) print(<span class="hljs-string"><span class="hljs-string">'MEDIAN: {}'</span></span>.format(median) print(<span class="hljs-string"><span class="hljs-string">'MODE: {}'</span></span>.format(mode)</code> </pre> <br>  A saber, dos: calcula un conjunto de estad√≠sticas en una lista de n√∫meros y los muestra en <code>STDOUT</code> .  Una funci√≥n viola una regla: debe haber una √∫nica raz√≥n espec√≠fica por la que deba modificarse.  En este caso, hay dos razones obvias por las que esto es necesario: o necesita calcular estad√≠sticas nuevas o diferentes, o necesita cambiar el formato de salida.  Por lo tanto, es mejor reescribir esta funci√≥n en forma de dos funciones separadas: una realizar√° c√°lculos y devolver√° sus resultados, y la otra recibir√° estos resultados y los mostrar√° en la consola.  <i>Una funci√≥n (o m√°s bien, tiene dos responsabilidades) con menudillos da la palabra <b>y</b> en su nombre</i> . <br><br>  Esta separaci√≥n tambi√©n simplifica enormemente la prueba de la funci√≥n, y tambi√©n le permite no solo dividirla en dos funciones dentro del mismo m√≥dulo, sino incluso separar estas dos funciones en m√≥dulos completamente diferentes, si corresponde.  Esto contribuye a√∫n m√°s a pruebas m√°s limpias y simplifica el soporte de c√≥digo. <br><br>  De hecho, las funciones que realizan exactamente dos cosas son raras.  M√°s a menudo, te encuentras con funciones que realizan muchas, muchas m√°s operaciones.  Nuevamente, por razones de legibilidad y comprobabilidad, tales funciones de "m√∫ltiples estaciones" deben dividirse en tareas √∫nicas, cada una de las cuales contiene un solo aspecto del trabajo. <br><br><h3>  Docstrings </h3><br>  Parece que todos saben que hay un documento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEP-8</a> que da recomendaciones sobre el estilo del c√≥digo Python, pero hay muchas menos personas entre nosotros que conocen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PEP-257</a> , en el que se dan las mismas recomendaciones con respecto a las cadenas de acoplamiento.  Para no volver a contar el contenido de PEP-257, lo env√≠o a este documento usted mismo, lea en su tiempo libre.  Sin embargo, sus ideas principales son las siguientes: <br><br><ul><li>  Cada funci√≥n necesita una cadena de documentaci√≥n. </li><li>  Debe observar gram√°tica y puntuaci√≥n;  escribir oraciones completas </li><li>  La cadena de documentaci√≥n comienza con una breve descripci√≥n (en una oraci√≥n) de lo que hace la funci√≥n. </li><li>  La cadena de documentos se formula en un estilo prescriptivo en lugar de descriptivo </li></ul><br>  Todos estos puntos son f√°ciles de seguir al escribir caracter√≠sticas.  Simplemente escribir docstrings deber√≠a convertirse en un h√°bito e intentar escribirlos antes de continuar con el c√≥digo de la funci√≥n en s√≠.  Si no puede escribir una cadena de documentos clara que describa la funci√≥n, esta es una buena raz√≥n para pensar por qu√© est√° escribiendo esta funci√≥n. <br><br><h3>  Valores de retorno </h3><br>  Las funciones pueden (y <i>deben</i> ) interpretarse como peque√±os programas aut√≥nomos.  Toman alguna entrada en forma de par√°metros y devuelven el resultado.  Los par√°metros, por supuesto, son opcionales.  <i>Pero los valores de retorno son necesarios desde el punto de vista de la estructura interna de Python</i> .  Si incluso intenta escribir una funci√≥n que no devuelve un valor, no puede.  Si la funci√≥n ni siquiera devuelve valores, entonces el int√©rprete de Python la "obligar√°" a devolver <code>None</code> .  No lo creo?  Pru√©balo t√∫ mismo: <br><br><pre> <code class="python hljs">‚ùØ python3 Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (default, Jul <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span>) [Clang <span class="hljs-number"><span class="hljs-number">9.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (clang<span class="hljs-number"><span class="hljs-number">-902.0</span></span><span class="hljs-number"><span class="hljs-number">.39</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>)] on darwin Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span><span class="hljs-function">:</span></span> ... print(a + b) ... &gt;&gt;&gt; b = add(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;&gt;&gt; b &gt;&gt;&gt; b <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  Como puede ver, el valor de <code>b</code> es esencialmente <code>None</code> .  Entonces, incluso si escribe una funci√≥n sin una declaraci√≥n de devoluci√≥n, a√∫n devolver√° algo.  Y deberia.  Despu√©s de todo, este es un programa peque√±o, ¬øverdad?  ¬øQu√© tan √∫tiles son los programas de los cuales no hay conclusi√≥n, y por lo tanto es imposible juzgar si este programa se ejecut√≥ correctamente?  Pero lo m√°s importante, ¬øc√≥mo vas a <i>probar</i> dicho programa? <br><br>  Ni siquiera tengo miedo de decir lo siguiente: cada funci√≥n deber√≠a devolver un valor √∫til, al menos en aras de la capacidad de prueba.  El c√≥digo que escribo debe ser probado (esto no se discute).  Solo imagine lo torpe que puede resultar la prueba de la funci√≥n de <code>add</code> anterior (pista: tendr√° que redirigir la entrada / salida, despu√©s de lo cual todo saldr√° mal pronto).  Adem√°s, al devolver un valor, podemos encadenar m√©todos y, por lo tanto, escribir c√≥digo como este: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'foo.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.strip().lower().endswith(<span class="hljs-string"><span class="hljs-string">'cat'</span></span>): <span class="hljs-comment"><span class="hljs-comment"># ...     - </span></span></code> </pre> <br>  Cadena <code>if line.strip().lower().endswith('cat'):</code> funciona porque cada uno de los m√©todos de cadena ( <code>strip()</code> , <code>lower()</code> , <code>endswith()</code> ) devuelve una cadena como resultado de llamar a la funci√≥n. <br><br>  Aqu√≠ hay algunas razones comunes que un programador puede darle al explicar por qu√© una funci√≥n que escribe no devuelve un valor: <br><blockquote>  ‚ÄúEs solo [alg√∫n tipo de operaci√≥n relacionada con la entrada / salida, por ejemplo, almacenar un valor en una base de datos].  Aqu√≠ no puedo devolver nada √∫til. </blockquote>  No estoy de acuerdo  La funci√≥n puede devolver True si la operaci√≥n se complet√≥ con √©xito. <br><blockquote>  ‚ÄúAqu√≠ cambiamos uno de los par√°metros disponibles, lo usamos como par√°metro de referencia‚Äù. "" </blockquote>  Aqu√≠ hay dos puntos.  Primero, haz tu mejor esfuerzo para no hacer esto.  En segundo lugar, proporcionar una funci√≥n con alg√∫n tipo de argumento solo para descubrir que ha cambiado es sorprendente en el mejor de los casos, y simplemente peligroso en el peor.  En cambio, al igual que con los m√©todos de cadena, intente devolver una nueva instancia del par√°metro que ya refleje los cambios que se le aplicaron.  Incluso si esto no se puede hacer, ya que la creaci√≥n de una copia de alg√∫n par√°metro est√° cargada de costos excesivos, a√∫n puede volver a la opci√≥n "Volver <code>True</code> si la operaci√≥n se complet√≥ con √©xito" propuesta anteriormente. <br><blockquote>  ‚ÄúNecesito devolver m√∫ltiples valores.  No hay un valor √∫nico que en este caso ser√≠a aconsejable devolver ". </blockquote>  Este argumento es un poco exagerado, pero lo he escuchado.  La respuesta, por supuesto, es precisamente lo que el autor quer√≠a hacer, pero no sab√≠a c√≥mo: <i>usar una tupla para devolver m√∫ltiples valores</i> . <br><br>  Finalmente, el argumento m√°s fuerte de que es mejor devolver un valor √∫til en cualquier caso es que la persona que llama siempre puede ignorar justificadamente estos valores.  En resumen, devolver un valor de una funci√≥n es casi seguro una buena idea, y es muy poco probable que da√±emos algo de esta manera, incluso en las bases de c√≥digo existentes. <br><br><h3>  Longitud de la funci√≥n </h3><br>  Admit√≠ m√°s de una vez que soy bastante tonto.  Puedo tener alrededor de tres cosas en mi cabeza al mismo tiempo.  Si me permite leer la funci√≥n de 200 l√≠neas y preguntar qu√© hace, probablemente la mirar√© durante al menos 10 segundos.  <b>La longitud de una funci√≥n afecta directamente su legibilidad y, por lo tanto, su soporte</b> .  Por lo tanto, trate de mantener sus funciones cortas.  50 l√≠neas: un valor tomado completamente del techo, pero me parece razonable.  (Espero) que la mayor√≠a de las funciones que escribes ser√°n mucho m√°s cortas. <br><br>  Si una funci√≥n cumple con el Principio de responsabilidad exclusiva, es probable que sea lo suficientemente breve.  Si es de lectura o idempotente (hablaremos de esto) a continuaci√≥n, entonces, probablemente, tambi√©n ser√° breve.  Todas estas ideas se combinan armoniosamente entre s√≠ y ayudan a escribir un c√≥digo bueno y limpio. <br><br>  Entonces, ¬øqu√© hacer si su funci√≥n es demasiado larga?  <b>REFACTOR!</b>  Probablemente tenga que refactorizar todo el tiempo, incluso si no conoce el t√©rmino.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Refactorizar</a> es simplemente cambiar la estructura de un programa, sin cambiar su comportamiento.  Por lo tanto, extraer varias l√≠neas de c√≥digo de una funci√≥n larga y convertirlas en una funci√≥n independiente es uno de los tipos de refactorizaci√≥n.  Resulta que esta es tambi√©n la forma m√°s com√∫n y r√°pida de acortar productivamente las funciones largas.  Como le est√° dando a estas nuevas funciones nombres apropiados, el c√≥digo resultante es mucho m√°s f√°cil de leer.  Escrib√≠ un libro completo sobre refactorizaci√≥n (de hecho, lo hago todo el tiempo), as√≠ que no entrar√© en detalles aqu√≠.  Solo sepa que si tiene una funci√≥n que es demasiado larga, debe refactorizarla. <br><br><h3>  Idempotencia y limpieza funcional </h3><br>  El t√≠tulo de esta secci√≥n puede parecer un poco intimidante, pero conceptualmente la secci√≥n es simple.  Una funci√≥n idempotente con el mismo conjunto de argumentos siempre devuelve el mismo valor, independientemente de cu√°ntas veces se llame.  El resultado no depende de variables no locales, la variabilidad de los argumentos o de ning√∫n dato proveniente de flujos de entrada / salida.  La siguiente funci√≥n <code>add_three(number)</code> es idempotente: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Independientemente de cu√°ntas veces llamemos <code>add_three(7)</code> , la respuesta siempre ser√° 10. Pero otro caso es una funci√≥n que no es idempotente: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 3 + ,  ."""</span></span> number = int(input(<span class="hljs-string"><span class="hljs-string">'Enter a number: '</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Esta funci√≥n francamente ideada no es idempotente, ya que el valor de retorno de la funci√≥n depende de la entrada / salida, es decir, del n√∫mero ingresado por el usuario.  Por supuesto, con diferentes llamadas a <code>add_three()</code> valores de retorno ser√°n diferentes.  Si llamamos a esta funci√≥n dos veces, el usuario en el primer caso puede ingresar 3, y en el segundo - 7, y luego dos llamadas a <code>add_three()</code> devolver√°n 6 y 10, respectivamente. <br><br>  Fuera de la programaci√≥n, tambi√©n hay ejemplos de idempotencia: por ejemplo, el bot√≥n arriba del elevador est√° dise√±ado de acuerdo con este principio.  Al presionarlo por primera vez, "notificamos" al elevador que queremos subir.  Como el bot√≥n es idempotente, no importa cu√°nto lo presiones m√°s tarde, no pasar√° nada malo.  El resultado siempre ser√° el mismo. <br><br><h3>  ¬øPor qu√© es tan importante la idempotencia? </h3><br>  Capacidad de prueba y usabilidad.  Las funciones idempotentes son f√°ciles de probar, ya que se garantiza que devolver√°n el mismo resultado en cualquier caso si las llama con los mismos argumentos.  Las pruebas se reducen a verificar que con una variedad de llamadas, la funci√≥n siempre devuelve el valor esperado.  Adem√°s, estas pruebas ser√°n r√°pidas: la velocidad de prueba es un tema importante que a menudo se pasa por alto en las pruebas unitarias.  Y refactorizar cuando se trabaja con funciones idempotentes es generalmente una caminata f√°cil.  No importa c√≥mo cambie el c√≥digo fuera de la funci√≥n: el resultado de llamarlo con los mismos argumentos siempre ser√° el mismo. <br><br><h3>  ¬øQu√© es una funci√≥n "pura"? </h3><br>  En la programaci√≥n funcional, una funci√≥n se considera pura si, en <i>primer lugar</i> , es idempotente y, en <i>segundo lugar</i> , no causa los <b>efectos secundarios</b> observados.  No lo olvide: una funci√≥n es idempotente si siempre devuelve el mismo resultado con un conjunto espec√≠fico de argumentos.  Sin embargo, esto no significa que la funci√≥n no pueda afectar a otros componentes, por ejemplo, variables no locales o flujos de entrada / salida.  Por ejemplo, si la versi√≥n idempotente de la funci√≥n <code>add_three(number)</code> anterior <code>add_three(number)</code> el resultado en la consola, y solo luego lo devuelve, a√∫n se considerar√≠a idempotente, porque cuando accede a la secuencia de entrada / salida, esta operaci√≥n de acceso no afecta el valor devuelto de la funci√≥n  La llamada <code>print()</code> es solo un <i>efecto secundario</i> : interacci√≥n con el resto del programa o sistema como tal, que ocurre junto con el valor de retorno. <br><br>  Desarrollemos un poco nuestro ejemplo con <code>add_three(number)</code> .  Puede escribir el siguiente c√≥digo para determinar cu√°ntas veces se ha llamado a <code>add_three(number)</code> : <br><br><pre> <code class="python hljs">add_three_calls = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> add_three_calls print(<span class="hljs-string"><span class="hljs-string">f'Returning </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{number + </span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">'</span></span>) add_three_calls += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num_calls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""",     *add_three*."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> add_three_calls</code> </pre> <br>  Ahora ejecutamos la salida a la consola (esto es un efecto secundario) y cambiamos la variable no local (otro efecto secundario), pero dado que ninguno de los dos afecta el valor devuelto por la funci√≥n, de todos modos es idempotente. <br><br>  La funci√≥n pura no tiene efectos secundarios.  No solo no utiliza ning√∫n "dato externo" al calcular el valor, sino que no interact√∫a con el resto del programa / sistema, solo calcula y devuelve el valor especificado.  Por lo tanto, aunque nuestra nueva definici√≥n de <code>add_three(number)</code> sigue siendo idempotente, esta funci√≥n ya no es pura. <br><br>  En las funciones puras no hay instrucciones de registro o llamadas <code>print()</code> .  Cuando trabajan, no acceden a la base de datos y no usan conexiones a Internet.  No acceda ni modifique variables no locales.  <b>Y no llame a otras funciones no puras</b> . <br><br>  En resumen, no tienen una "acci√≥n terrible de largo alcance", como lo expresan las palabras de Einstein (pero en el contexto de la inform√°tica, no de la f√≠sica).  No alteran de ninguna manera el resto del programa o sistema.  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">programaci√≥n imperativa</a> (que es lo que haces cuando escribes c√≥digo en Python), tales funciones son las m√°s seguras.  Son conocidos por su capacidad de prueba y facilidad de soporte;  Adem√°s, dado que son idempotentes, se garantiza que probar tales funciones sea tan r√°pido como ejecutarlo.  Las pruebas en s√≠ tambi√©n son simples: no tiene que conectarse a la base de datos o simular ning√∫n recurso externo, preparar la configuraci√≥n inicial del c√≥digo y, al final del trabajo, no necesita limpiar nada. <br><br>  Honestamente, la idempotencia y la limpieza son muy deseables, pero no requeridas.  ,         ,     ,     . , ,  ,    ,         .  ,        ,           . <br><br><h3>  Conclusi√≥n </h3><br>  Eso es todo ,     ‚Äì   .          . ,   .    ‚Äì    !          . ,  ,   ,       ¬´ ¬ª.     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es426381/">https://habr.com/ru/post/es426381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es426371/index.html">Resumen de audio: 17 materiales y gu√≠as pr√°cticas sobre el tema de la ac√∫stica profesional.</a></li>
<li><a href="../es426373/index.html">Construyendo funciones en la consola. Parte 1</a></li>
<li><a href="../es426375/index.html">An√°lisis tecnol√≥gico: d√≥nde comenzar a trabajar en el panorama de patentes</a></li>
<li><a href="../es426377/index.html">Juego usando tablas de matem√°ticas en lugar de tablas</a></li>
<li><a href="../es426379/index.html">Deshacerse de las ilusiones</a></li>
<li><a href="../es426385/index.html">¬øPor qu√© no deber√≠as aprender ingl√©s acad√©mico?</a></li>
<li><a href="../es426387/index.html">Gr√°ficos en Julia. Patrones extra√±os, el reflejo de un tri√°ngulo desde una l√≠nea recta y la construcci√≥n de las normales de un gato esf√©rico en el vac√≠o.</a></li>
<li><a href="../es426389/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 334 (7-14 de octubre de 2018)</a></li>
<li><a href="../es426391/index.html">PHP Digest No. 141 (1 al 15 de octubre de 2018)</a></li>
<li><a href="../es426395/index.html">Se cobrar√° una tarifa por los productos de las tiendas en l√≠nea extranjeras en el momento de la compra.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>