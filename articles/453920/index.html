<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöá ü§¶üèΩ üë®‚Äçüç≥ C√≥mo tomar el control de su infraestructura de red. Cap√≠tulo cuatro Automatizaci√≥n Plantillas üìè üèÜ üñçÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este art√≠culo es el sexto de una serie de art√≠culos titulados "C√≥mo tomar la infraestructura de red bajo su control". El contenido de todos los art√≠cu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo tomar el control de su infraestructura de red. Cap√≠tulo cuatro Automatizaci√≥n Plantillas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453920/">  <i>Este art√≠culo es el sexto de una serie de art√≠culos titulados "C√≥mo tomar la infraestructura de red bajo su control".</i>  <i>El contenido de todos los art√≠culos de la serie y los enlaces se puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a></i> . <br><br>  Dejando algunos temas atr√°s, decid√≠ comenzar un nuevo cap√≠tulo. <br><br>  Volver√© a la seguridad un poco m√°s tarde.  Aqu√≠ quiero discutir un enfoque simple pero efectivo que, estoy seguro, de una forma u otra, puede ser √∫til para muchos.  Es m√°s bien una historia corta sobre c√≥mo la automatizaci√≥n puede cambiar la vida de un ingeniero.  Se tratar√° del uso de plantillas.  Al final hay una lista de mis proyectos, donde puede ver c√≥mo funciona todo lo que se describe aqu√≠. <br><br><h2>  DevOps para la web </h2><br>  Crear una configuraci√≥n con un script, usar GIT para controlar los cambios en la infraestructura de TI, "relleno" remoto: estas ideas son lo primero cuando se piensa en la implementaci√≥n t√©cnica del enfoque DevOps.  Las ventajas son obvias.  Pero, desafortunadamente, tambi√©n hay desventajas. <br><br>  Cuando hace m√°s de 5 a√±os, nuestros desarrolladores acudieron a nosotros, a los networkers, con estas ofertas, no est√°bamos entusiasmados. <br><a name="habracut"></a><br>  Debo decir que heredamos una red bastante heterog√©nea que consta del equipo de unos 10 proveedores diferentes.  Algo era conveniente de configurar a trav√©s de nuestro cli favorito, pero en alg√∫n lugar preferimos usar la GUI.  Adem√°s, el trabajo prolongado en equipos "en vivo" se ense√±√≥ al control en tiempo real.  Por ejemplo, cuando hago cambios, me siento mucho m√°s c√≥modo trabajando directamente a trav√©s de cli.  Entonces puedo ver r√°pidamente que algo sali√≥ mal y "revertir" los cambios.  Todo esto estaba en contradicci√≥n con sus ideas. <br><br>  Surgen otras preguntas, por ejemplo, de una versi√≥n a otra, la interfaz puede variar ligeramente.  Esto, al final, har√° que su script cree la "configuraci√≥n" incorrecta.  No quisiera usar la producci√≥n para un robo. <br><br>  O, ¬øc√≥mo entender que los comandos de configuraci√≥n se aplicaron correctamente y qu√© hacer en caso de error? <br><br>  No quiero decir que todos estos problemas son irresolubles.  Simplemente diciendo "A", probablemente sea sabio decir "B", y si desea utilizar los mismos procesos para el control de cambios que en el desarrollo, necesita tener entornos de desarrollo y puesta en escena adem√°s de la producci√≥n.  Entonces este enfoque parece completo.  ¬øPero cu√°nto costar√°? <br><br>  Pero hay una situaci√≥n en la que los contras est√°n casi nivelados, y solo quedan los profesionales.  Estoy hablando del trabajo de dise√±o. <br><br><h2>  Proyecto </h2><br>  Durante los √∫ltimos dos a√±os, he estado participando en un proyecto para construir un centro de datos para un proveedor importante.  Soy responsable del F5 y Palo Alto en este proyecto.  Desde el punto de vista de Cisco, es el "equipo de terceros". <br><br>  Para m√≠ personalmente, hay dos etapas distintas en este proyecto. <br><br><h3>  Primera etapa </h3><br>  El primer a√±o estuve infinitamente ocupado, trabajaba de noche y los fines de semana.  No pude levantar la cabeza.  La presi√≥n de la gerencia y del cliente fue fuerte y continua.  En una rutina constante, ni siquiera pod√≠a intentar optimizar el proceso.  No fue solo y no tanto la configuraci√≥n del equipo como la preparaci√≥n de la documentaci√≥n de dise√±o. <br><br>  Entonces comenzaron las primeras pruebas, y me sorprender√≠a cu√°ntos errores menores e inexactitudes se hicieron.  Por supuesto, todo funcion√≥, pero faltaba una letra en el nombre, faltaba una l√≠nea en el equipo ... Las pruebas continuaron y continuaron, y ya estaba en una lucha constante y diaria con errores, pruebas y documentaci√≥n. <br><br>  Esto continu√≥ por un a√±o.  El proyecto, seg√∫n tengo entendido, no fue f√°cil para todos, pero gradualmente el cliente se sinti√≥ cada vez m√°s satisfecho, y esto hizo posible contratar ingenieros adicionales que pudieron asumir parte de la rutina. <br><br>  Ahora era posible mirar un poco alrededor. <br>  Y ese fue el comienzo de la segunda etapa. <br><br><h3>  Segunda etapa </h3><br>  Decid√≠ automatizar el proceso. <br><br>  Lo que entend√≠ de la comunicaci√≥n con los desarrolladores en ese momento (y debemos rendir homenaje, ten√≠amos un equipo s√≥lido) es que el formato de texto, aunque a primera vista parece algo del mundo del sistema operativo DOS, tiene una serie de propiedades valiosas . <br>  Por ejemplo, un formato de texto ser√° √∫til si desea aprovechar al m√°ximo GIT y todos sus derivados.  Yo queria <br><br>  Bueno, parece que puede almacenar una configuraci√≥n o una lista de comandos, pero hacer cambios es bastante inconveniente.  Adem√°s, al dise√±ar, hay otra tarea importante.  Debe tener documentaci√≥n que describa su dise√±o general (dise√±o de bajo nivel) y su implementaci√≥n espec√≠fica (plan de implementaci√≥n de red).  Y en este caso, el uso de plantillas parece ser una opci√≥n muy adecuada. <br><br>  Entonces, cuando se usa YAML y Jinja2, el archivo YAML con par√°metros de configuraci√≥n, como direcciones IP, n√∫meros BGP AS, ... cumple perfectamente el rol de NIP, mientras que las plantillas Jinja2 incluyen la sintaxis apropiada para el dise√±o, que es, de hecho, un reflejo de LLD. <br><br>  Tom√≥ dos d√≠as aprender los idiomas YAML y Jinja2.  Algunos buenos ejemplos son suficientes para entender c√≥mo funciona esto.  Luego, tom√≥ aproximadamente dos semanas crear todas las plantillas que se ajustan a nuestro dise√±o: una semana para Palo Alto y otra semana para F5.  Todo esto fue publicado en githab corporativo. <br><br>  Ahora el proceso de cambio fue el siguiente: <br><br><ul><li>  archivo yaml cambiado </li><li>  cre√≥ un archivo de configuraci√≥n usando una plantilla (Jinja2) </li><li>  guardado en un repositorio remoto </li><li>  subi√≥ la configuraci√≥n creada al equipo </li><li>  vi un error </li><li>  archivo YAML cambiado o plantilla Jinja2 </li><li>  cre√≥ un archivo de configuraci√≥n usando una plantilla (Jinja2) </li><li>  ... </li></ul><br>  Est√° claro que al principio se dedic√≥ mucho tiempo a la edici√≥n, pero despu√©s de una o dos semanas ya era m√°s probable que fuera una rareza. <br><br>  Una buena prueba y la capacidad de depurar todo fue el deseo del cliente de cambiar la convenci√≥n de nomenclatura.  Quien trabaj√≥ con F5 comprende lo picante de la situaci√≥n.  Pero para m√≠ fue bastante simple.  Cambi√© los nombres en el archivo YAML, elimin√© toda la configuraci√≥n del equipo, gener√© una nueva y la cargu√©.  Todo, teniendo en cuenta las correcciones de errores, tom√≥ 4 d√≠as: dos d√≠as para cada tecnolog√≠a.  Despu√©s de eso, estaba listo para el siguiente paso, es decir, la creaci√≥n de centros de datos DEV y Staging. <br><br><h3>  Dev y puesta en escena </h3><br>  La puesta en escena en realidad repite la producci√≥n por completo.  Dev es una copia muy simplificada construida principalmente en hardware virtual.  Situaci√≥n ideal para un nuevo enfoque.  Si a√≠slo el tiempo que pas√© del proceso general, creo que el trabajo no tom√≥ m√°s de 2 semanas.  El tiempo principal es el tiempo de espera del otro lado y una b√∫squeda conjunta de problemas.  La implementaci√≥n de la tercera parte fue casi invisible para los dem√°s.  Incluso hubo tiempo para ense√±ar algo y escribir un par de art√≠culos sobre Habr√© :) <br><br><h2>  Para resumir </h2><br>  Entonces, ¬øqu√© tengo en la l√≠nea de fondo? <br><br><ul><li>  todo lo que necesito para cambiar la configuraci√≥n es modificar un archivo YAML simple, claramente estructurado con par√°metros de configuraci√≥n.  Nunca cambio el script de Python y muy raramente (solo si hay un error) cambio Jinja2 </li><li>  desde el punto de vista de la documentaci√≥n, se obtiene una situaci√≥n casi ideal.  Cambia la documentaci√≥n (los archivos YAML act√∫an como NIP) y carga esta configuraci√≥n en el equipo.  Por lo tanto, su documentaci√≥n siempre est√° actualizada. </li></ul><br>  Todo esto llev√≥ al hecho de que <br><br><ul><li>  el porcentaje de errores disminuy√≥ a casi 0 </li><li>  tom√≥ el 90 por ciento de la rutina </li><li>  la velocidad de implementaci√≥n ha aumentado significativamente </li></ul><br><h2>  PAGAR, F5Y, ACY </h2><br>  Dije que algunos ejemplos son suficientes para entender c√≥mo funciona esto. <br>  Aqu√≠ hay una versi√≥n breve (y, por supuesto, modificada) de lo que se cre√≥ en el proceso de mi trabajo. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PAY</a> = despliegue <b>P</b> alo <b>A</b> lto de <b>Y</b> aml = Palo Alto de Yaml <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">F5Y</a> = despliegue <b>F5</b> desde <b>Y</b> aml = <b>F5</b> desde <b>Y</b> aml (pr√≥ximamente) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ACY</a> = despliegue <b>AC</b> i desde <b>Y</b> aml = <b>F5</b> desde <b>Y</b> aml <br><br>  Agregar√© algunas palabras sobre ACY (que no debe confundirse con ACI). <br><br>  Los que trabajaron con ACI saben que este milagro (y en el buen sentido, tambi√©n) fue creado no por los networkers :).  Olv√≠dese de todo lo que sab√≠a sobre la red: ¬°no ser√° √∫til para usted! <br>  Es un poco exagerado, pero transmite aproximadamente la sensaci√≥n que constantemente experimento durante 3 a√±os, trabajando con ACI. <br><br>  Y en este caso, ACY no es solo una oportunidad para construir un proceso de control de cambios (que es especialmente importante en el caso de ACI, porque se supone que esta es la parte central y m√°s cr√≠tica de su centro de datos), sino que tambi√©n le brinda una interfaz amigable para crear una configuraci√≥n. <br><br>  Los ingenieros en este proyecto usan Excel para usar ACI en lugar de YAML para exactamente el mismo prop√≥sito.  Hay algunas ventajas de usar Excel, por supuesto: <br><br><ul><li>  su pellizco en un archivo </li><li>  hermosas se√±ales de que el cliente se complace en mirar </li><li>  puedes usar algunas herramientas de Excel </li></ul><br>  Pero hay un inconveniente y, en mi opini√≥n, supera a los profesionales.  Controlar los cambios y coordinar el trabajo en equipo se vuelve mucho m√°s dif√≠cil. <br><br>  ACY en realidad est√° aplicando los mismos enfoques que utilic√© para terceros para configurar ACI. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/453920/">https://habr.com/ru/post/453920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453904/index.html">Desh√°gase de "vk.com/away.php" o siga los enlaces de una persona sana</a></li>
<li><a href="../453906/index.html">¬øQu√© es un "modelo de dominio"?</a></li>
<li><a href="../453908/index.html">RTOS Neutrino en computadoras industriales</a></li>
<li><a href="../453914/index.html">Instrucciones de instalaci√≥n del cliente de prueba TON</a></li>
<li><a href="../453916/index.html">C√≥mo protegerse de los estafadores m√≥viles</a></li>
<li><a href="../453926/index.html">C√≥mo funciona y funciona el servicio de coche compartido</a></li>
<li><a href="../453930/index.html">Comparaci√≥n y selecci√≥n de sistemas de migraci√≥n de datos.</a></li>
<li><a href="../453932/index.html">Unas palabras en defensa del monolito</a></li>
<li><a href="../453934/index.html">11 preguntas para discutir antes de comenzar a trabajar</a></li>
<li><a href="../453938/index.html">Seguimiento de bicicletas robadas NB-IoT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>