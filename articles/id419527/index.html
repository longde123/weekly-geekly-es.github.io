<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🚀 🧑🏼‍🤝‍🧑🏻 🔱 Bagaimana detak jantung terdengar: mengubah kardiogram kertas ke format WAV 👨🏿‍🎓 🍱 ⛅️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Banyak kali harus berurusan dengan pemeriksaan jantung di lembaga medis menggunakan kardiograf. Unit ini mengukur aktivitas bioelektrik jantung, merek...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana detak jantung terdengar: mengubah kardiogram kertas ke format WAV</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419527/"><img src="https://habrastorage.org/webt/vd/8i/cs/vd8icsdtkcxv6x3i-djvtgs6hrs.jpeg"><br>  Banyak kali harus berurusan dengan pemeriksaan jantung di lembaga medis menggunakan kardiograf.  Unit ini mengukur aktivitas bioelektrik jantung, merekam hasilnya pada pita kertas.  Kardiograf modern mencatat hasil pengukuran bukan di atas kertas, tetapi dalam memori digital.  Namun, pita kertas sering digunakan sebagai media akhir dari informasi yang direkam.  Secara visual, itu adalah kertas milimeter panjang lebar kecil, yang dipelintir menjadi gulungan.  Di atas kertas, selain kisi milimeter, grafik tertentu digambar dengan panjang penuh, yang mencerminkan hukum dari nilai yang terukur berubah seiring waktu.  Nilai yang diukur, seperti yang saya mengerti, adalah perbedaan potensial antara lead.  Paling sering, beberapa bagan disajikan pada satu kaset sekaligus, karena perbedaan potensial antara banyak lead dicatat.  Namun, tanpa masuk ke rincian obat, di masa depan kami akan mempertimbangkan salah satu jadwal utama pertama.  Selain grafik, ada informasi tekstual tambahan pada kaset: skala horizontal (mm / s), vertikal (mm / mV), detak jantung terukur (bpm) dan banyak lagi. <br><br>  Ada ide untuk mengubah bagan ini menjadi format suara, mereproduksi hasilnya dan mendengarkan bagaimana bunyinya. <br><a name="habracut"></a><br>  Menurut analisis pendahuluan, kita dapat menyimpulkan bahwa komposisi frekuensi gelombang semacam itu tidak terlalu jenuh.  Bahkan, ini adalah frekuensi rendah, termasuk infrasonik, yang diyakini tidak terdengar.  Namun, akan mungkin untuk melihat bagaimana kerucut woofer akan mengulangi getaran yang serupa dengan "getaran" jantung.  Faktanya, karena adanya sirkuit pembeda kapasitif pada jalur perambatan sinyal dari kartu suara PC ke penguat bass, getaran kepala dinamis tidak akan persis mengulangi getaran yang disajikan pada kardiogram.  Dan ini asalkan filter yang memotong frekuensi sangat rendah tidak dipasang di mana pun.  Selain itu, distorsi non-linear akan hadir, disertai oleh beberapa harmonik frekuensi tinggi.  Namun demikian, tanpa memperhitungkan analisis di atas, kami menimbulkan masalah sebagai berikut: konversi grafik di atas kertas ke format WAV sehingga ketika Anda membuka file ini dalam editor suara, bentuk gelombang cocok dengan versi kertas dan, lebih lanjut, sesuai dengan skala waktu. <br><br>  Pertama, Anda perlu memperkirakan kedalaman kuantisasi (resolusi audio digital secara vertikal).  Saya sedang mempertimbangkan salah satu standar: 8 atau 16 bit.  Pilihan kedua (16 bit) adalah 65536 sampel vertikal, yang akan sesuai dengan 65536 piksel gambar, yang merupakan pemindaian atau foto kardiogram.  Ini banyak, dan itu tidak masuk akal.  Jika Anda mengambil 8 bit - ini adalah 256 sampel, atau 256 piksel gambar.  Sekarang ini pilihan yang lebih cocok.  Dalam hal ini, rentang dinamis audio adalah 6 * 8 = 48 dB.  Saya tidak tahu kisaran dinamis apa yang dimiliki kardiogram, tapi saya pikir tidak lebih.  Perangkat itu sendiri secara alami lebih besar, tetapi kesalahan tidak bisa dihindari ketika menampilkan kardiogram di atas kertas, terutama ketika datang untuk menggambar langsung dengan pena.  Omong-omong, tentang yang terakhir.  Saya tidak akan memperhitungkan pola lama yang digambar dengan pena "radial".  Pita kertas milimeter untuk kardiogram semacam itu spesifik: busur vertikal bukan garis lurus ditarik.  Sedangkan untuk skala horizontal - laju sampling - akan dihitung berdasarkan skala kardiogram dan ukuran gambar.  Kecepatan pemutaran akan tergantung pada parameter ini, dan harus sesuai dengan "kecepatan kardiogram" yang sebenarnya. <br><br>  Kertas kardiogram harus dipindai dalam b / w dengan nuansa abu-abu dalam resolusi yang memadai.  Maka Anda perlu mengubah ukuran gambar sehingga kardiogram yang diinginkan sesuai dengan strip 256 piksel.  Saya menemukan banyak gambar dengan kardiogram di Internet.  Sebagai contoh, perhatikan dua di antaranya. <br><br><img src="https://habrastorage.org/webt/6a/ao/ve/6aaoveakfnrluqr-m-hybxevcly.jpeg"><br><br>  Gambar pertama, bisa dikatakan, hampir siap.  Tinggi gambar - 431. Lebar - 1023. Gelombang melintasi lebar memenuhi seluruh gambar.  Tetapi Anda harus meninggalkan 256 ketinggian, memotong gambar di atas dan di bawah sehingga gelombang terletak kira-kira di tengah. <br><br><img src="https://habrastorage.org/webt/1y/pl/9b/1ypl9b8u33wmyo2xa6cdkhbx9n0.png"><br><br>  Gambar kedua menunjukkan beberapa kardiogram sekaligus.  Ambil yang pertama.  Setelah memotong, kami mendapat gambar berukuran 508 kali 61. <br><br><img src="https://habrastorage.org/webt/od/sr/nc/odsrncybq1ghgyy1tmf-x7rxmh4.png"><br><br>  Tanpa meregangkan gambar secara vertikal, kita akan membuat gambar dengan tinggi 256, mengisi area yang dibuat dengan kekosongan putih.  Gelombang juga harus terletak kira-kira di tengah.  Saat memotong, saya memilih lebar 508 sehingga meninggalkan sel-sel milimeter integer sebanyak mungkin, yang juga terlihat dalam gambar. <br><br>  Kedua gambar perlu dikonversi ke tampilan di mana hanya grafik hitam akan terlihat pada latar belakang putih dan tidak ada yang lain.  Ini dilakukan dengan cara dasar.  Karena kenyataan bahwa grafik yang digambar jauh lebih gemuk daripada kisi milimeter, pada editor grafis menggunakan penyesuaian "kecerahan, kontras, saturasi", Anda dapat mencapai hasil yang diinginkan.  Jika konversi sempurna gagal, sisa "sampah" berlebih di atas bagan harus dihapus dengan alat penghapus.  Semua gambar harus disimpan dalam format BMP monokrom.  Dengan demikian, hanya warna putih dan hitam yang pasti akan tetap ada dalam gambar. <br><br>  Sebelum Anda mulai menjelaskan algoritme untuk mengonversi gambar ke WAV, ada baiknya Anda menentukan beberapa nuansa yang menyederhanakan pemrograman.  Gambar yang dihasilkan harus diputar 90 derajat berlawanan arah jarum jam (lebar dan tinggi gambar akan berubah tempat).  Ini diperlukan untuk mengarahkan awal kardiogram dengan awal file BMP.  Diketahui bahwa data warna setiap piksel dalam file BMP ditulis ke file baris demi baris, mulai dari sudut kiri bawah.  Maka Anda perlu membuka gambar di editor "MS Paint" (Saya memiliki Windows XP) dan menyimpan ke BMP 8-bit (256 warna).  Tentu saja, akan ada "redefinisi informasi", tetapi dengan format ini, setiap piksel dalam gambar bersesuaian dengan satu byte, yang sangat nyaman saat pemrograman.  Byte "0" adalah piksel hitam, dan byte "255" berwarna putih.  Hasilnya harus seperti berikut (di sini dua gambar terhubung dan dibelah dua). <br><br><img src="https://habrastorage.org/webt/vr/cc/nh/vrccnhi1qkyegtfpanecxls5c40.jpeg"><br><br>  Adapun format output, kami akan output tidak ke file WAV standar, tetapi ke file data RAW (PCM).  Ini juga menyederhanakan pemrograman, karena ketika mengeluarkan ke WAV, Anda masih harus menjaga header 44-byte.  Dalam editor audio umum Adobe Audition 1.5, file PCM terbuka tanpa masalah.  Selain itu, Anda bahkan dapat menampilkan angka desimal data PCM ke kolom dalam file teks, setelah sebelumnya membentuk header teks tertentu.  Anehnya, tetapi file seperti itu Adobe Audition juga terbuka. <br><br>  Kami menggambarkan algoritma transformasi.  Dan algoritma ini sangat sederhana: Anda perlu menganalisis setiap baris file BMP dari bawah ke atas.  Analisis akan terdiri dari penghitungan piksel putih dari kiri ke kanan berturut-turut hingga hitam ditemukan.  Nilai integer non-negatif yang diperoleh harus ditulis ke file PCM output dalam bentuk biner.  Ukuran file output akan sama persis dengan tinggi gambar yang diproses.  Kedalaman kuantisasi 8 bit format data audio PCM menyiratkan pengkodean sampel sesuai dengan prinsip yang sama.  Nilai "0" adalah nilai negatif maksimum dari sampel audio, nilai "255" adalah positif maksimum, dan "128" adalah nilai nol (di tengah).  Misalnya, file PCM data audio diam akan berisi byte yang sama dengan nilai "128".  Perlu disebutkan bahwa satu baris dapat mengandung beberapa piksel hitam berturut-turut, tergantung pada ketebalan garis kardiogram.  Tetapi algoritma yang dijelaskan "menangkap" amplop atas, yang akan cukup.  Selain itu, puncak tajam dari kardiogram diarahkan ke atas akan lebih baik dipahami dengan cara ini. <br><br>  Sekarang Anda dapat mulai menulis teks program.  Program yang ditulis dalam C sangat sederhana dan tidak perlu komentar rinci. <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; // ,  ; int main(){ //  ; FILE *in,*out; //   ; unsigned long int h,i; //    ; unsigned char px,s; //     ; in=fopen("1.bmp","rb"); //   ; out=fopen("1.pcm","wb"); //   ; fseek(in,22,SEEK_SET); //    ,     fread(&amp;h,4,1,in); //   (4 ); for(i=0;i&lt;h;i++){ // -   ; fseek(in,0x436+i*256,SEEK_SET); //   i-  s=0; //  ( ); do{ //  ; fread(&amp;px,1,1,in); //  ; s+=1; //   ; }while(px); // ,     ; fwrite(&amp;s,1,1,out); //     ; } fclose(in); //  ; fclose(out); //  ; return 0; //  ; }</span></span></span></span></code> </pre> <br><br>  Setelah program dieksekusi pada file "1.bmp", file "1.pcm" akan dibuat dalam direktori yang sama dengan program.  Ketika Anda mencoba untuk membuka file di Adobe Audition, jendela berikut akan muncul. <br><br><img src="https://habrastorage.org/webt/sw/lj/pg/swljpg5dphpocfdbnvsartz0k-8.png"><br><br>  Anda harus memilih "Mono", "8-bit", dan mencetak frekuensi pengambilan sampel dalam bidang input berdasarkan perhitungan: f = h / (s / v), di mana h adalah ketinggian gambar (juga jumlah sampel dalam audio), s - panjang kardiogram dalam milimeter, v adalah skala kardiogram dalam mm / s.  Parameter terakhir ditulis pada kardiogram.  Pada kardiogram pertama tidak ada yang tertulis, tetapi skalanya, biasanya, 25 mm / detik.  Perhitungan laju sampel di Excel untuk contoh kami ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/tl/vw/jp/tlvwjpkgjgxsh2z5bwrgkmzjuy8.png"><br><br>  Seperti disebutkan di atas, kami memasukkan nilai frekuensi sampling yang diperlukan untuk masing-masing contoh di bidang yang sesuai.  Anda bahkan dapat memasukkan desimal, toh kemudian akan ada pembulatan otomatis ke keseluruhan terdekat. <br><br><img src="https://habrastorage.org/webt/ha/tr/jt/hatrjtjokkoinjcox4ed9ushjiw.png"><br><br>  Dengan mengklik "OK", kami setuju bahwa kami bekerja dengan sampel "8 bit Tidak Ditandatangani" (akan ada jendela lain), setelah itu bentuk gelombang file kami akan meluas di bidang utama editor suara.  Perhatikan bahwa tampilan ini akan disajikan "terbalik", dan untuk kepatuhan penuh dengan versi kertas, Anda harus membalikkan gelombang di menu yang sesuai.  Hasilnya, akan terlihat seperti ini. <br><br><img src="https://habrastorage.org/webt/ru/pf/zj/rupfzjhna9czkxh3xifzjuzhubu.png"><br><br>  Kardiogram kedua terlihat "lebih tenang", karena ukuran aslinya tidak terlalu besar. <br><br><img src="https://habrastorage.org/webt/-u/fl/vz/-uflvzhf_iswthnmhrwsdd3xvl4.png"><br><br>  Sayangnya, tidak semua kartu suara memungkinkan Anda memutar audio pada frekuensi pengambilan sampel yang sewenang-wenang, lebih tepatnya, sebagian besar tidak tahu caranya.  Agar dapat memutar file dengan benar, Anda harus menjalankan fungsi "Konversi tipe sampel".  Kami akan mengonversi ke nilai standar terdekat 8000 Hz, pada saat yang sama meningkatkan resolusi dalam amplitudo menjadi 16 bit.  Yang terakhir ini diperlukan untuk akurasi pada tahap interpolasi selama upsampling.  Jika Anda meninggalkan 8 bit, maka wilayah spektrum yang tersisa akan diisi dengan noise kuantisasi.  Omong-omong, prosedur ini dapat dilakukan secara terprogram pada tahap konversi BMP-PCM, bahkan menggunakan interpolasi.  Tetapi salah satu tujuannya adalah kesederhanaan kode program. <br><br>  Setelah operasi upampling, Anda dapat mendengarkan dan menikmati hasilnya.  Anda dapat menyimpan hasilnya dalam file wav atau mp3 standar.  Kedengarannya persis sama dengan yang saya harapkan. <br><br>  Tautan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> memungkinkan Anda untuk mengunduh arsip rar, yang berisi dua file WAV dengan hasilnya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id419527/">https://habr.com/ru/post/id419527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id419513/index.html">Konfigurasikan kebijakan keamanan kata sandi di Zimbra</a></li>
<li><a href="../id419515/index.html">Bagaimana sebuah startup “bebas merek” mendapat $ 240 juta untuk mengalahkan Amazon</a></li>
<li><a href="../id419519/index.html">Kiat Game Seluler: Bagian 1, Peluncuran lunak</a></li>
<li><a href="../id419523/index.html">Tim PVS-Studio tidak bias ketika menulis artikel</a></li>
<li><a href="../id419525/index.html">Dari API pertama di Swagger ke Single kontrak pada RAML</a></li>
<li><a href="../id419531/index.html">Memilih pasangan yang tepat untuk telinga Anda: sepuluh tips praktis</a></li>
<li><a href="../id419535/index.html">Perbarui pada Pemanggang Roti</a></li>
<li><a href="../id419537/index.html">CyberDemons: Kecerdasan Buatan DOOM 2016</a></li>
<li><a href="../id419539/index.html">Buka webinar "Pemrograman Asinkron dengan Python"</a></li>
<li><a href="../id419547/index.html">Mengelola log digest biasa dengan python dan dimungkinkan menggunakan asterisk sebagai contoh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>