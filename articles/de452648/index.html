<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÜüèº üë©üèª‚Äçü§ù‚Äçüë®üèæ üèè PHP: Wie man eine komplexe XML-Datei analysiert und nicht in nativem Code ertrinkt üëçüèª üßëüèæ‚Äçü§ù‚Äçüßëüèº üî∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gute Tageszeit! 

 Der Umfang des XML-Formats ist ziemlich umfangreich. Neben CSV, JSON und anderen ist XML eine der h√§ufigsten Methoden, um Daten f√ºr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP: Wie man eine komplexe XML-Datei analysiert und nicht in nativem Code ertrinkt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452648/"> Gute Tageszeit! <br><br>  Der Umfang des XML-Formats ist ziemlich umfangreich.  Neben CSV, JSON und anderen ist XML eine der h√§ufigsten Methoden, um Daten f√ºr den Austausch zwischen verschiedenen Diensten, Programmen und Sites darzustellen.  Als Beispiel k√∂nnen wir das CommerceML-Format f√ºr den Austausch von Waren und Bestellungen zwischen 1C "Trade Management" und einem Online-Shop anf√ºhren. <br><br>  Daher muss sich fast jeder, der von Zeit zu Zeit Webdienste erstellt, mit der Notwendigkeit befassen, XML-Dokumente zu analysieren.  In meinem Beitrag schlage ich eine der Methoden vor, wie dies mit XMLReader so klar und transparent wie m√∂glich gemacht werden kann. <br><a name="habracut"></a><br>  PHP bietet verschiedene M√∂glichkeiten, um mit dem XML-Format zu arbeiten.  Ohne auf Details einzugehen, m√∂chte ich sagen, dass sie im Prinzip in zwei Gruppen unterteilt werden k√∂nnen: <br><br><ol><li>  Laden des gesamten XML-Dokuments als Objekt in den Speicher und Arbeiten mit diesem Objekt </li><li>  Schrittweises Lesen einer XML-Zeichenfolge auf der Ebene von Tags, Attributen und Textinhalten </li></ol><br>  Der erste Weg ist intuitiver, der Code sieht transparenter aus.  Diese Methode eignet sich gut f√ºr kleine Dateien. <br><br>  Die zweite Methode ist ein Ansatz auf niedrigerer Ebene, der uns eine Reihe von Vorteilen bietet und gleichzeitig das Leben etwas √ºberschattet.  Lassen Sie uns n√§her darauf eingehen.  Vorteile: <br><br><ul><li>  Analysegeschwindigkeit.  Sie k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ausf√ºhrlicher lesen. </li><li>  Verbrauch von weniger RAM.  Wir speichern nicht alle Daten in Form eines Objekts, das im Speicher sehr teuer ist. </li></ul><br>  Aber: Wir opfern die Lesbarkeit des Codes.  Wenn das Ziel unserer Analyse beispielsweise darin besteht, die Summe der Werte an bestimmten Stellen in XML mit einer einfachen Struktur zu berechnen, gibt es keine Probleme. <br>  Wenn die Dateistruktur jedoch komplex ist, h√§ngt selbst das Arbeiten mit Daten vom vollst√§ndigen Pfad zu diesen Daten ab, und das Ergebnis sollte viele Parameter enthalten. Dann kommen wir hier zu einem ziemlich chaotischen Code. <br><br>  Also schrieb ich eine Klasse, die mir sp√§ter das Leben leichter machte.  Seine Verwendung vereinfacht das Schreiben von Regeln und verbessert die Lesbarkeit von Programmen erheblich, ihre Gr√∂√üe wird um ein Vielfaches kleiner und der Code ist sch√∂ner. <br><br>  Die Hauptidee ist folgende: Wir werden sowohl das Schema unseres XML als auch die Arbeitsweise in einem einzigen Array speichern, das die Hierarchie nur der ben√∂tigten Tags wiederholt.  Au√üerdem k√∂nnen wir f√ºr jedes der Tags im selben Array die Funktionen registrieren, die wir ben√∂tigen, um ein Tag zu √∂ffnen, zu schlie√üen, Attribute zu lesen oder Text zu lesen oder alles zusammen.  Daher speichern wir unsere XML-Struktur und Handler an einem Ort.  Ein einziger Blick auf unsere Verarbeitungsstruktur reicht aus, um zu verstehen, was wir mit unserer XML-Datei machen.  Ich werde reservieren, dass bei einfachen Aufgaben (wie in den folgenden Beispielen) der Vorteil der Lesbarkeit gering ist, aber es wird offensichtlich, wenn Sie mit Dateien mit einer relativ komplexen Struktur arbeiten - zum Beispiel einem Austauschformat mit 1C. <br><br>  Nun die Einzelheiten.  Hier ist unsere Klasse: <br><br>  Debug-Version (mit $ debug-Parameter): <br><div class="spoiler">  <b class="spoiler_title">XMLReaderStruct-Klasse - Zum Vergr√∂√üern anklicken</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XMLReaderStruct</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XMLReader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xmlStruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($xml, $structure, $encoding = null, $options = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $debug = false)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xml($xml, $encoding, $options); $stack = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $node = &amp;$structure; $skipToDepth = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;read()) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;nodeType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ELEMENT: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($skipToDepth === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//       ,     ,  :      //  ,   ,      ,      .  //  ,    ,        . if (isset($node[$this-&gt;name])) { if ($debug) echo "[  ]: ",$this-&gt;name," -   .   .\r\n"; $stack[$this-&gt;depth] = &amp;$node; $node = &amp;$node[$this-&gt;name]; if (isset($node["__open"])) { if ($debug) echo "    ",$this-&gt;name," - .\r\n"; if (false === $node["__open"]()) return false; } if (isset($node["__attrs"])) { if ($debug) echo "    ",$this-&gt;name," - .\r\n"; $attrs = array(); if ($this-&gt;hasAttributes) while ($this-&gt;moveToNextAttribute()) $attrs[$this-&gt;name] = $this-&gt;value; if (false === $node["__attrs"]($attrs)) return false; } if ($this-&gt;isEmptyElement) { if ($debug) echo "  ",$this-&gt;name," .   .\r\n"; if (isset($node["__close"])) { if ($debug) echo "    ",$this-&gt;name," - .\r\n"; if (false === $node["__close"]()) return false; } $node = &amp;$stack[$this-&gt;depth]; } } else { $skipToDepth = $this-&gt;depth; if ($debug) echo "[  ]: ",$this-&gt;name," -    .        ",$skipToDepth,".\r\n"; } } else { if ($debug) echo "(  ): ",$this-&gt;name," -    .\r\n"; } break; case self::TEXT: if ($skipToDepth === false) { if ($debug) echo "[  ]: ",$this-&gt;value," -  .\r\n"; if (isset($node["__text"])) { if ($debug) echo "    - .\r\n"; if (false === $node["__text"]($this-&gt;value)) return false; } } else { if ($debug) echo "(  ): ",$this-&gt;value," -    .\r\n"; } break; case self::END_ELEMENT: if ($skipToDepth === false) { //  $skipToDepth  ,   ,        , //       . if ($debug) echo "[  ]: ",$this-&gt;name," -   .   .\r\n"; if (isset($node["__close"])) { if ($debug) echo "    ",$this-&gt;name," - .\r\n"; if (false === $node["__close"]()) return false; } $node = &amp;$stack[$this-&gt;depth]; } elseif ($this-&gt;depth === $skipToDepth) { //  $skipToDepth ,   ,    ,         . if ($debug) echo "[  ]: ",$this-&gt;name," -   ",$skipToDepth,".    .\r\n"; $skipToDepth = false; } else { if ($debug) echo "(  ): ",$this-&gt;name," -    .\r\n"; } break; } } return true; } }</span></span></code> </pre> <br></div></div><br>  Release-Version (ohne den $ debug-Parameter und Kommentare): <br><div class="spoiler">  <b class="spoiler_title">XMLReaderStruct-Klasse - Zum Vergr√∂√üern anklicken</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XMLReaderStruct</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XMLReader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xmlStruct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($xml, $structure, $encoding = null, $options = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;xml($xml, $encoding, $options); $stack = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $node = &amp;$structure; $skipToDepth = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;read()) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;nodeType) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::ELEMENT: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($skipToDepth === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name])) { $stack[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;depth] = &amp;$node; $node = &amp;$node[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-string"><span class="hljs-string">"__open"</span></span>]) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> === $node[<span class="hljs-string"><span class="hljs-string">"__open"</span></span>]())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-string"><span class="hljs-string">"__attrs"</span></span>])) { $attrs = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;hasAttributes) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;moveToNextAttribute()) $attrs[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;name] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> === $node[<span class="hljs-string"><span class="hljs-string">"__attrs"</span></span>]($attrs)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isEmptyElement) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-string"><span class="hljs-string">"__close"</span></span>]) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> === $node[<span class="hljs-string"><span class="hljs-string">"__close"</span></span>]())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $node = &amp;$stack[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;depth]; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $skipToDepth = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;depth; } } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::TEXT: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($skipToDepth === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-string"><span class="hljs-string">"__text"</span></span>]) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> === $node[<span class="hljs-string"><span class="hljs-string">"__text"</span></span>](<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;value))) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::END_ELEMENT: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($skipToDepth === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($node[<span class="hljs-string"><span class="hljs-string">"__close"</span></span>]) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> === $node[<span class="hljs-string"><span class="hljs-string">"__close"</span></span>]())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; $node = &amp;$stack[<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;depth]; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;depth === $skipToDepth) { $skipToDepth = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }</code> </pre><br></div></div><br><br>  Wie Sie sehen k√∂nnen, erweitert unsere Klasse die Funktionen der Standard-XMLReader-Klasse, zu der wir eine Methode hinzugef√ºgt haben: <br><br><pre> <code class="plaintext hljs">xmlStruct($xml, $structure, $encoding = null, $options = 0, $debug = false)</code> </pre> <br>  Parameter: <br><br><ul><li>  <b>$ xml, $ encoding, $ options</b> : wie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">XMLReader :: xml ()</a> </li><li>  <b>$ struct</b> : Ein assoziatives Array, das vollst√§ndig beschreibt, wie wir mit unserer Datei arbeiten sollen.  Es versteht sich, dass sein Aussehen im Voraus bekannt ist und wir genau wissen, welche Tags und was wir tun sollen. </li><li>  <b>$ debug</b> : (nur f√ºr die Debug-Version) Gibt an, ob Debugging-Informationen ausgegeben werden sollen (standardm√§√üig deaktiviert). </li></ul><br>  Das Argument <b>$ structure</b> . <br><br>  Dies ist ein assoziatives Array, dessen Struktur die Hierarchie der Tags der XML-Datei wiederholt. Falls erforderlich, kann jedes der Strukturelemente Handlerfunktionen haben (definiert als Felder mit dem entsprechenden Schl√ºssel): <br><br><ul><li>  <b>"__open"</b> - Funktion beim √ñffnen eines Tags - function () </li><li>  <b>"__attrs"</b> - Funktion zum Verarbeiten von Tag-Attributen (falls vorhanden) - Funktion ($ assocArray) </li><li>  <b>"__text"</b> - Funktion bei Vorhandensein des <b>Textwerts</b> der Tag - Funktion ($ text) </li><li>  <b>"__close"</b> - Funktion beim Schlie√üen einer Tag - Funktion () </li></ul><br>  Wenn einer der Handler false zur√ºckgibt, wird die Analyse abgebrochen und die Funktion xmlStruct () gibt false zur√ºck.  Die folgenden Beispiele zeigen, wie das Argument $ structure erstellt wird: <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel 1 zeigt die Reihenfolge, in der Handler aufgerufen werden</b> <div class="spoiler_text">  Angenommen, es gibt eine XML-Datei: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attr_1</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"123"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">attr_2</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"456"</span></span></span><span class="hljs-tag">&gt;</span></span>Abc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x</span></span></span><span class="hljs-tag">&gt;</span></span>This is node x inside b<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">c</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">c</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">d</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x</span></span></span><span class="hljs-tag">&gt;</span></span>This is node x inside d<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">x</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">d</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">e</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">e</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><pre> <code class="php hljs">$structure = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'root'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'a'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__attrs"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($array)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"ATTR ARRAY IS "</span></span>,json_encode($array),<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; }, <span class="hljs-string"><span class="hljs-string">"__text"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($text)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"TEXT a {$text}\r\n"</span></span>; } ), <span class="hljs-string"><span class="hljs-string">'b'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__open"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"OPEN b\r\n"</span></span>; }, <span class="hljs-string"><span class="hljs-string">"__close"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"CLOSE b\r\n"</span></span>; }, <span class="hljs-string"><span class="hljs-string">'x'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__open"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"OPEN x\r\n"</span></span>; }, <span class="hljs-string"><span class="hljs-string">"__text"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"TEXT x {$text}\r\n"</span></span>; }, <span class="hljs-string"><span class="hljs-string">"__close"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"CLOSE x\r\n"</span></span>; } ) ) ) ); $xmlReaderStruct-&gt;xmlStruct($xml, $structure);</code> </pre><br>  Handler werden aufgerufen (in chronologischer Reihenfolge): <br><br>  Wurzelattribute-&gt; a <br>  Textfeld root-&gt; a <br>  Wurzel √∂ffnen-&gt; b <br>  √ñffnungswurzel-&gt; b-&gt; x <br>  Text root-&gt; b-&gt; x <br>  Wurzel schlie√üen-&gt; b-&gt; x <br>  Wurzel schlie√üen-&gt; b <br><br>  Die verbleibenden Felder werden nicht verarbeitet (einschlie√ülich root-&gt; d-&gt; x wird ignoriert, da sie sich au√üerhalb der Struktur befinden). <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Beispiel 2 zeigt eine einfache praktische Aufgabe</b> <div class="spoiler_text">  Angenommen, es gibt eine XML-Datei: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shop</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>product<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>service<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>product<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>30<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>service<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>45<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>product<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>60<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>service<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Some product name. ID:5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">qty</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span>75<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">price</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">shop</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Dies ist ein Bankscheck mit Waren und Dienstleistungen. <br><br>  Jeder Pr√ºfdatensatz enth√§lt die Datensatzkennung, den Typ (Produkt ‚ÄûProdukt‚Äú oder Dienstleistung ‚ÄûDienstleistung‚Äú), den Namen, die Menge und den Preis. <br><br>  Aufgabe: Berechnen Sie den Scheckbetrag, jedoch getrennt f√ºr Waren und Dienstleistungen. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span> <span class="hljs-string"><span class="hljs-string">"xmlreaderstruct.class.php"</span></span>; $x = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLReaderStruct(); $productsSum = <span class="hljs-number"><span class="hljs-number">0</span></span>; $servicesSum = <span class="hljs-number"><span class="hljs-number">0</span></span>; $structure = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'shop'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'record'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__text"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($text)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$currentRecord)</span></span></span><span class="hljs-function"> </span></span>{ $currentRecord[<span class="hljs-string"><span class="hljs-string">'isService'</span></span>] = $text === <span class="hljs-string"><span class="hljs-string">'service'</span></span>; } ), <span class="hljs-string"><span class="hljs-string">'qty'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__text"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($text)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$currentRecord)</span></span></span><span class="hljs-function"> </span></span>{ $currentRecord[<span class="hljs-string"><span class="hljs-string">'qty'</span></span>] = (int)$text; } ), <span class="hljs-string"><span class="hljs-string">'price'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"__text"</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($text)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$currentRecord)</span></span></span><span class="hljs-function"> </span></span>{ $currentRecord[<span class="hljs-string"><span class="hljs-string">'price'</span></span>] = (int)$text; } ), <span class="hljs-string"><span class="hljs-string">'__open'</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$currentRecord)</span></span></span><span class="hljs-function"> </span></span>{ $currentRecord = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); }, <span class="hljs-string"><span class="hljs-string">'__close'</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$currentRecord, &amp;$productsSum, &amp;$servicesSum)</span></span></span><span class="hljs-function"> </span></span>{ $money = $currentRecord[<span class="hljs-string"><span class="hljs-string">'qty'</span></span>] * $currentRecord[<span class="hljs-string"><span class="hljs-string">'price'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($currentRecord[<span class="hljs-string"><span class="hljs-string">'isService'</span></span>]) $servicesSum += $money; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> $productsSum += $money; } ) ) ); $x-&gt;xmlStruct(file_get_contents(<span class="hljs-string"><span class="hljs-string">'example.xml'</span></span>), $structure); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'Overal products price: '</span></span>, $productsSum, <span class="hljs-string"><span class="hljs-string">', Overal services price: '</span></span>, $servicesSum;</code> </pre></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452648/">https://habr.com/ru/post/de452648/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452630/index.html">Backup, Teil 2: √úbersicht und Testen von rsync-basierten Backup-Tools</a></li>
<li><a href="../de452638/index.html">Wie wir 2GIS unter CarPlay gestartet haben und uns immer noch entwirren</a></li>
<li><a href="../de452642/index.html">Die St√§rke der Menge. Wie Chicago einen M√ºllroboter entwickelte - einen Flussreiniger</a></li>
<li><a href="../de452644/index.html">DevConf X Web Developer Conference - 21. Juni</a></li>
<li><a href="../de452646/index.html">Was das neuronale Netz auf dem ersten Foto eines Schwarzen Lochs sah</a></li>
<li><a href="../de452652/index.html">Sicherheitswoche 21: Eine L√ºcke in WhatsApp, eine neue Sicherheitsl√ºcke in Intel-Prozessoren, Zero-Day in Windows</a></li>
<li><a href="../de452656/index.html">Entwicklung der einfachsten ‚ÄûFirmware‚Äú f√ºr in Redd installierte FPGAs und Debugging am Beispiel des Speichertests</a></li>
<li><a href="../de452662/index.html">HPE Server in Selectel</a></li>
<li><a href="../de452664/index.html">Ich habe 18.000 US-Dollar f√ºr eine statische Webseite in Rechnung gestellt ... und bin damit durchgekommen</a></li>
<li><a href="../de452666/index.html">So erm√∂glichen Sie Mikrozahlungen in Ihrer App</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>