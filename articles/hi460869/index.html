<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯС░ ЁЯСитАНтЭдя╕ПтАНЁЯСи ЁЯП╣ YOLOv3 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ iOS рдкрд░ рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдорд╛рдиреНрдпрддрд╛ ЁЯМЫ тЬМЁЯП╗ ЁЯМ░</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░! 

 рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рд╡рд╕реНрддреБ рдкрд╣рдЪрд╛рди рдФрд░ рдорд╛рдиреНрдпрддрд╛ (рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рдЯреЗрдХреНрд╢рди) рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рд┐рдЦреЗрдВрдЧреЗред...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>YOLOv3 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ iOS рдкрд░ рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдорд╛рдиреНрдпрддрд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460869/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/ah/g9/grahg9mh7movhc2fcbn7m-yfoxu.png"></div><br>  рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░! <br><br>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рд╣рдо рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рд╡рд╕реНрддреБ рдкрд╣рдЪрд╛рди рдФрд░ рдорд╛рдиреНрдпрддрд╛ (рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рдЯреЗрдХреНрд╢рди) рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рд┐рдЦреЗрдВрдЧреЗред  рдХрд╛рд░реНрдпрдХреНрд░рдо рдЖрдИрдУрдПрд╕ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдлреНрдЯ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛ред  рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо YOLOv3 рдирд╛рдордХ рдПрдХ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЗ рд╕рд╛рде рдПрдХ рджреГрдврд╝ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ CoreML рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд╛рде iOS рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░реЗрдВ, YOLOv3 рдиреЗрдЯрд╡рд░реНрдХ рдХреНрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдФрд░ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдереЛрдбрд╝реА рд╕рдордЭ рд╣реИред  рд╣рдо рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреА рднреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВрдЧреЗ рдФрд░ YOLOv3 рдХреЗ рдХрдИ рд░реВрдкреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВрдЧреЗ: YOLOv3- рдЫреЛрдЯреЗ рдФрд░ YOLOv3-416ред <br><br>  рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕реНрд░реЛрдд рдЙрдкрд▓рдмреНрдз рд╣реЛрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╣рд░ рдХреЛрдИ рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред <br><a name="habracut"></a><br><h2>  рд╡рд╕реНрддреБ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ </h2><br>  рд╢реБрд░реБрдЖрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╕рдордЭреЗрдВрдЧреЗ рдХрд┐ рдЫрд╡рд┐ рдореЗрдВ рд╡рд╕реНрддреБрдУрдВ (рд╡рд╕реНрддреБ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХреНрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрдЬ рдХреМрди рд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдореИрдВ рд╕рдордЭрддрд╛ рд╣реВрдВ рдХрд┐ рдХрдИ рд▓реЛрдЧ рдЗрд╕ рд╡рд┐рд╖рдп рд╕реЗ рдХрд╛рдлреА рдкрд░рд┐рдЪрд┐рдд рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореИрдВ рдЕрднреА рднреА рдЦреБрдж рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рдмрддрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реВрдВред <br><br>  рдЕрдм рдХрдВрдкреНрдпреВрдЯрд░ рд╡рд┐рдЬрд╝рди рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдмрд╣реБрдд рд╕реЗ рдХрд╛рд░реНрдп рдХрдВрдлреНрдпреВрдЬрд╝рдирд▓ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХ (рдХрдиреНрд╡рд░реНрд╕реЗрд╢рдирд▓ рдиреНрдпреВрд░рд▓ рдиреЗрдЯрд╡рд░реНрдХреНрд╕) рдХреА рд╕рд╣рд╛рдпрддрд╛ рд╕реЗ рд╣рд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдмрд╛рдж рд╕реА.рдПрди.рдПрди.  рдЙрдирдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдХрд╛рд░рдг, рд╡реЗ рдЫрд╡рд┐ рд╕реЗ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВред  CNN рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд░реНрдЧреАрдХрд░рдг, рдорд╛рдиреНрдпрддрд╛, рд╡рд┐рднрд╛рдЬрди рдФрд░ рдХрдИ рдЕрдиреНрдп рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдСрдмреНрдЬреЗрдХреНрдЯ рдорд╛рдиреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рд▓реЛрдХрдкреНрд░рд┐рдп рд╕реАрдПрдирдПрди рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░: <br><br><ul><li>  <b>рдЖрд░-рд╕реАрдПрдирдПрдиред</b>  рд╣рдо рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓рд╛ рдореЙрдбрд▓ рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВред  рдПрдХ рдирд┐рдпрдорд┐рдд рдЫрд╡рд┐ рд╡рд░реНрдЧреАрдХрд░рдг рдХреА рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдЫрд╡рд┐ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдирдкреБрдЯ рд╕реЗ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгрд┐рдпрд╛рдВ рдХреА рдЬрд╛рддреА рд╣реИрдВред  рдмрд╣реБрдд рдзреАрдореА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рдЫрд╡рд┐ рдХреЛ рдХрдИ рд╣рдЬрд╛рд░ рдмрд╛рд░ рдЪрд▓рд╛рддрд╛ рд╣реИред </li><li>  <b>рдлрд╛рд╕реНрдЯ рдЖрд░-рд╕реАрдПрдирдПрдиред</b>  рдЖрд░-рд╕реАрдПрдирдПрди рдХрд╛ рдПрдХ рдмреЗрд╣рддрд░ рдФрд░ рддреЗрдЬ рд╕рдВрд╕реНрдХрд░рдг, рдПрдХ рд╕рдорд╛рди рд╕рд┐рджреНрдзрд╛рдВрдд рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ рдкреВрд░реА рдЫрд╡рд┐ рдХреЛ рд╕реАрдПрдирдПрди рдЗрдирдкреБрдЯ рд╕реЗ рдЦрд┐рд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдлрд┐рд░ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдЖрдВрддрд░рд┐рдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрднреА рднреА рдмрд╣реБрдд рдзреАрдореА рд╣реИред </li><li>  <b>рддреЗрдЬрд╝ рдЖрд░-рд╕реАрдПрдирдПрдиред</b>  рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рд╕реЗ рдореБрдЦреНрдп рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдЪрдпрдирд╛рддреНрдордХ рдЦреЛрдЬ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ "рдЙрдиреНрд╣реЗрдВ" рдпрд╛рдж рд░рдЦрдирд╛ред </li><li>  <b>YOLOред</b>  рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдСрдкрд░реЗрд╢рди рдХрд╛ рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рд╕рд┐рджреНрдзрд╛рдВрдд рд╕рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рд╕рдмрд╕реЗ рддреЗрдЬред  рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд▓реЗрдЦ рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреАред </li><li>  <b>рдПрд╕рдПрд╕рдбреАред</b>  рдпрд╣ YOLO рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ VGG16 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдХреЗ рдХрд╛рдо рдХреЗ рд▓рд┐рдП рднреА рдмрд╣реБрдд рддреЗрдЬ рдФрд░ рдЙрдкрдпреБрдХреНрдд рд╣реИред </li><li>  <b>рдлрд╝реАрдЪрд░ рдкрд┐рд░рд╛рдорд┐рдб рдиреЗрдЯрд╡рд░реНрдХ (FPN)ред</b>  рдПрдХ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЬреИрд╕реЗ рдХрд┐ рд╕рд┐рдВрдЧрд▓ рд╢реЙрдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░, рдлреАрдЪрд░ рдирд┐рд╖реНрдХрд░реНрд╖рдг рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рдПрд╕рдПрд╕рдбреА рд╕реЗ рдмреЗрд╣рддрд░ рд╣реИ рдХрд┐ рдЫреЛрдЯреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИред </li><li>  <b>RetinaNetред</b>  рдпрд╣ FPN + ResNet рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░, рдПрдХ рд╡рд┐рд╢реЗрд╖ рддреНрд░реБрдЯрд┐ рдлрд╝рдВрдХреНрд╢рди (рдлреЛрдХрд▓ рд▓реЙрд╕) рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдПрдХ рдЙрдЪреНрдЪ рд╕рдЯреАрдХрддрд╛ рджреЗрддрд╛ рд╣реИред </li></ul><br>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдпреЛрд▓реЛ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдЕрд░реНрдерд╛рддреН рдЗрд╕рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╢реЛрдзрди, рдпреЛрд▓реЛрд╡ рейред <br><br><h2>  рдХреНрдпреЛрдВ YOLO? </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i4/fy/lq/i4fylqlbpgsp-mu3w6k96zd5e1u.jpeg"></div><br><br>  YOLO рдпрд╛ рдпреВ рдУрдирд▓реА рд▓реБрдХ рд╡рдиреНрд╕ рдПрдХ рдмрд╛рд░ CNN рдХреА рдмрд╣реБрдд рд▓реЛрдХрдкреНрд░рд┐рдп рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рдЪрд┐рддреНрд░ рдореЗрдВ рдХрдИ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ</a> рдкрд░ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЙрд╕реА рд╕реНрдерд╛рди рдкрд░ рдЖрдк рдкреНрд░рдХрд╛рд╢рди рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдФрд░ рдЧрдгрд┐рддреАрдп рдШрдЯрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдЗрд╕рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  рджреВрд╕рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЗрд╕ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреА рдореБрдЦреНрдп рд╡рд┐рд╢реЗрд╖рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рд┐рд╕реНрдЯрдо рдЫрд╡рд┐ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдХрдИ рдмрд╛рд░ рд╕реАрдПрдирдПрди рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ, рдпреЛрд▓реЛ рдореЗрдВ, рд╕реАрдПрдирдПрди рдХреЛ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдкреВрд░реА рдЫрд╡рд┐ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдиреЗрдЯрд╡рд░реНрдХ рдПрдХ рддрд░рд╣ рдХреЗ рдЧреНрд░рд┐рдб рдореЗрдВ рдЫрд╡рд┐ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рдВрдЫрд┐рдд рд╡рд╕реНрддреБ рд╣реИред <br><br>  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдкреВрд░реА рдЫрд╡рд┐ рдХреЛ рджреЗрдЦрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рд╡рд╕реНрддреБ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рджреМрд░рд╛рди рд╕рдВрджрд░реНрдн рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддрд╛ рд╣реИред  YOLO рднреА R-CNN рд╕реЗ 1000 рдЧреБрдирд╛ рддреЗрдЬрд╝ рд╣реИ рдФрд░ Fast R-CNN рд╕реЗ рд▓рдЧрднрдЧ 100 рдЧреБрдирд╛ рддреЗрдЬрд╝ рд╣реИред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдСрдирд▓рд╛рдЗрди рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рд▓реЙрдиреНрдЪ рдХрд░реЗрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЧреБрдг рд╣реИред <br><br>  рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред <br><br><h4>  YOLOv3 </h4><br>  YOLOv3 YOLO рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХрд╛ рдПрдХ рдЙрдиреНрдирдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИред  рдЗрд╕рдореЗрдВ 106 рд╕рдВрдХреЗрдВрджреНрд░рд┐рдд рдкрд░рддреЗрдВ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рдкреВрд░реНрд╡рд╡рд░реНрддреА YOLOv2 рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЫреЛрдЯреА рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдмреЗрд╣рддрд░ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред  YOLOv3 рдХреА рдореБрдЦреНрдп рд╡рд┐рд╢реЗрд╖рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рддреАрди рдкрд░рддреЗрдВ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдЖрдХрд╛рд░реЛрдВ рдХреА рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br>  рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╕реНрд╡реАрд░ рдЗрд╕рдХреА рдпреЛрдЬрдирд╛рдмрджреНрдз рд╕рдВрд░рдЪрдирд╛ рдХреЛ рджрд░реНрд╢рд╛рддреА рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cl/rf/_j/clrf_jqzkt1qfszivfchhxkujv4.png"></div><br><br>  <b>YOLOv3- рдЫреЛрдЯреЗ</b> - YOLOv3 рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдПрдХ рдлрд╕рд▓реА рд╕рдВрд╕реНрдХрд░рдг, рдЬрд┐рд╕рдореЗрдВ рдХрдо рдкрд░рддреЗрдВ рд╣реИрдВ (рдХреЗрд╡рд▓ 2 рдЖрдЙрдЯрдкреБрдЯ рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВ)ред  рдпрд╣ рдЫреЛрдЯреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдЦрд░рд╛рдм рд╣реЛрдиреЗ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЫреЛрдЯреЗ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рдкреНрд░реЗрдд рд╣реИред  рд▓реЗрдХрд┐рди, рдЫрдВрдЯрдиреА рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдХрд╛рд░рдг, рдиреЗрдЯрд╡рд░реНрдХ рд╡рдЬрди рдХрдо рдорд╛рддреНрд░рд╛ рдореЗрдВ рдореЗрдореЛрд░реА (~ 35 рдПрдордмреА) рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдПрдХ рдЙрдЪреНрдЪ рдПрдлрдкреАрдПрд╕ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдмреЗрд╣рддрд░ рд╣реИред <br><br><h2>  рд╣рдо рд╡рд╕реНрддреБ рдорд╛рдиреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ </h2><br>  рдордЬрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ! <br><br>  рдЖрдЗрдП рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдПрдВ рдЬреЛ рдлреЛрди рдХреЗ рдХреИрдорд░реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдЫрд╡рд┐ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рдЪрд╛рди рд▓реЗрдЧрд╛ред  рд╕рднреА рдХреЛрдб рд╕реНрд╡рд┐рдлреНрдЯ 4.2 рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдореЗрдВ рд▓рд┐рдЦреЗ рдЬрд╛рдПрдВрдЧреЗ рдФрд░ рдПрдХ рдЖрдИрдУрдПрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЪрд▓реЗрдВрдЧреЗред <br><br>  рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рд╣рдо рдПрдХ рддреИрдпрд╛рд░ рдиреЗрдЯрд╡рд░реНрдХ рддреИрдпрд╛рд░ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕рдореЗрдВ рддрд░рд╛рдЬреВ рдХреЛ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">COCO</a> рдбреЗрдЯрд╛рд╕реЗрдЯ рдкрд░ рдкрд╣рд▓реЗ рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдпрд╣ 80 рд╡рд┐рднрд┐рдиреНрди рд╡рд░реНрдЧреЛрдВ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдиреНрдпреВрд░реЙрди 80 рд╡рд┐рднрд┐рдиреНрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗред <br><br><h4>  Darknet рд╕реЗ CoreML рддрдХ </h4><br>  рдореВрд▓ YOLOv3 рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдбрд╛рд░реНрдХрдиреЗрдЯ рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  IOS рдкрд░, рд╕рдВрд╕реНрдХрд░рдг 11.0 рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░, рдПрдХ рдЕрджреНрднреБрдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">CoreML</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдореЙрдбрд▓ рдХреЛ рд╕реАрдзреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред  рд▓реЗрдХрд┐рди рдПрдХ рд╕реАрдорд╛ рд╣реИ: <b>рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗрд╡рд▓ iOS 11 рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</b> <br><br>  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ CoreML рдХреЗрд╡рд▓ <i>.coreml</i> рдореЙрдбрд▓ рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рд╛рд░реВрдк рдХреЛ <i>рд╕рдордЭрддрд╛</i> рд╣реИред  рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓реЛрдХрдкреНрд░рд┐рдп рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ, рдЬреИрд╕реЗ рдХрд┐ рдЯреЗрдирд╕рдлрд╝реНрд▓реЛ, рдХреЗрд░рд╕ рдпрд╛ рдПрдХреНрд╕рдЬреАрдмреЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП, рд╕реАрдзреЗ рдХреЛрд░рдПрдордПрд▓ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред  рд▓реЗрдХрд┐рди рдбрд╛рд░реНрдХрдиреЗрдЯ рдХреЗ рд▓рд┐рдП рдРрд╕реА рдХреЛрдИ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИред  Darknet рд╕реЗ CoreML рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЧрдП рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Darknet рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ONNX</a> рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд╣реЗрдЬреЗрдВ</a> , рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ ONNX рд╕реЗ CoreML рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВред <br><br>  рд╣рдо рдПрдХ рд╕рд░рд▓ рддрд░реАрдХреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ рд╣рдо YOLOv3 рдХреЗ Keras рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдПрдХреНрд╢рди рдХрд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдпрд╣ рд╣реИ: рдбрд╛рд░реНрдХрдиреЗрдЯ рд╡реЗрдЯреНрд╕ рдХреЛ рдХреЗрд░рд╕ рдореЙрдбрд▓ рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдВ, рдЗрд╕реЗ рдХреЗрд░рд╕ рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рд╕реЗрд╡ рдХрд░реЗрдВ рдФрд░ рд╕реАрдзреЗ рдЗрд╕реЗ рдХреЛрд░рдПрдордПрд▓ рд╕реЗ рдЗрд╕реЗ рдХрдиреНрд╡рд░реНрдЯ рдХрд░реЗрдВред <br><br><ol><li>  <b>рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдбрд╛рд░реНрдХрдиреЗрдЯред</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ рд╕реЗ</a> рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд Darknet-YOLOv3 рдореЙрдбрд▓ рдХреА рдлрд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд░реЗрдВ</a> ред  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рдореИрдВ рджреЛ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрдВрдЧрд╛: YOLOv3-416 рдФрд░ YOLOv3- рдЫреЛрдЯреЗред  рд╣рдо рджреЛрдиреЛрдВ cfg рдФрд░ рд╡рдЬрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред </li><li>  <b>рдбрд╛рд░реНрдХрдиреЗрдЯ рд╕реЗ рд▓реЗрдХрд░ рдХреЗрд░реЗрд╕ рддрдХред</b>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдХреЛ</a> рдХреНрд▓реЛрди рдХрд░реЗрдВ, рд░реЗрдкреЛ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдБ: <br><br><pre><code class="bash hljs">python convert.py yolov3.cfg yolov3.weights yolo.h5</code> </pre> <br>  рдЬрд╣рд╛рдВ yolov3.cfg рдФрд░ yolov3.weights рдиреЗ Darknet рдлрд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рд╣реИрдВред  рдирддреАрдЬрддрди, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред <i>5</i> - рдпрд╣ рдХреЗрдЖрд░рдПрдПрд╕ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ YOLOv3 рдореЙрдбрд▓ рд╣реИред </li><li>  <b>рдХрд░реЗрд╕ рд╕реЗ рдХреЛрд░рдорд▓ рддрдХред</b>  рдЖрдЦрд┐рд░реА рдЪрд░рдг рдмрдирд╛ рд░рд╣рд╛ред  рдореЙрдбрд▓ рдХреЛ CoreML рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдЕрдЬрдЧрд░ рдХреЗ рд▓рд┐рдП рдХреЙрд░рдореНрд╕реНрдЯреВрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> coremltools coreml_model = coremltools.converters.keras.convert( <span class="hljs-string"><span class="hljs-string">'yolo.h5'</span></span>, input_names=<span class="hljs-string"><span class="hljs-string">'image'</span></span>, image_input_names=<span class="hljs-string"><span class="hljs-string">'image'</span></span>, input_name_shape_dict={<span class="hljs-string"><span class="hljs-string">'image'</span></span>: [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">416</span></span>, <span class="hljs-number"><span class="hljs-number">416</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]}, <span class="hljs-comment"><span class="hljs-comment">#      image_scale=1/255.) coreml_model.input_description['image'] = 'Input image' coreml_model.save('yolo.mlmodel')</span></span></code> </pre> </li></ol><br>  рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдЪрд░рдгреЛрдВ рдХреЛ рджреЛ рдореЙрдбрд▓ YOLOv3-416 рдФрд░ YOLOv3- рдЫреЛрдЯреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br>  рдЬрдм рд╣рдордиреЗ рдпрд╣ рд╕рдм рдХрд┐рдпрд╛, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджреЛ рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ: yolo.mlmodel рдФрд░ yolo-small.mlmodelред  рдЕрдм рдЖрдк рдЖрд╡реЗрджрди рдХрд╛ рдХреЛрдб рд▓рд┐рдЦрдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h4>  IOS рдРрдк рдмрдирд╛рдирд╛ </h4><br>  рдореИрдВрдиреЗ рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛрдб рдХрд╛ рд╡рд░реНрдгрди рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ, рдЖрдк рдЗрд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рд▓рд┐рдВрдХ рдЬрд┐рд╕реЗ рд▓реЗрдЦ рдХреЗ рдЕрдВрдд рдореЗрдВ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдореБрдЭреЗ рдХреЗрд╡рд▓ рдпрд╣ рдХрд╣рдиреЗ рджреЗрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рддреАрди UIViewController-a: OnlineViewController, PhotoViewController рдФрд░ SettingsViewController рд╣реИрдВред  рдкрд╣рд▓рд╛ рдХреИрдорд░рд╛ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдлреНрд░реЗрдо рдХреЗ рд▓рд┐рдП рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдСрдирд▓рд╛рдЗрди рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реИред  рджреВрд╕рд░реЗ рдореЗрдВ, рдЖрдк рдПрдХ рддрд╕реНрд╡реАрд░ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЧреИрд▓рд░реА рд╕реЗ рдПрдХ рддрд╕реНрд╡реАрд░ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрди рдЪрд┐рддреНрд░реЛрдВ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рддреАрд╕рд░реЗ рдореЗрдВ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╣реИрдВ, рдЖрдк YOLOv3-416 рдпрд╛ YOLOv3- рдЫреЛрдЯреЗ рдореЙрдбрд▓ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА рдереНрд░реЗрд╕рд╣реЛрд▓реНрдб IoU (рдпреВрдирд┐рдпрди рдкрд░ рдЪреМрд░рд╛рд╣рд╛) рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд┐рдбреЗрдВрд╕ (рд╡рд░реНрддрдорд╛рди рдЫрд╡рд┐ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛) рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  <b>CoreML рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣реЗ рдореЙрдбрд▓</b> <br><br>  рд╣рдордиреЗ рдбрд╛рд░реНрдХрдиреЗрдЯ рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЛ CoreML рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди <i>.mlmodel рдХреЗ</i> рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣реИред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореИрдВрдиреЗ рдХреНрд░рдорд╢рдГ YOLOv3-416 рдФрд░ YOLOv3- рдЫреЛрдЯреЗ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП рджреЛ рдлрд╛рдЗрд▓реЗрдВ <i>рдмрдирд╛рдИрдВ</i> : <i>yolo.mlmodel</i> рдФрд░ <i>yolo-small.mlmodel</i> ред  рдЕрдм рдЖрдк рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ Xcode рдореЗрдВ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рд╣рдо рдореЙрдбрд▓рдкреНрд░реЙрдЗрдбрд░ рд╡рд░реНрдЧ рдмрдирд╛рддреЗ рд╣реИрдВ, рдпрд╣ рд╡рд░реНрддрдорд╛рди рдореЙрдбрд▓ рдФрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд╕рдВрдЪрд┐рдд рдХрд░реЗрдЧрд╛ред  рдореЙрдбрд▓ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(type: YOLOType)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">YOLO</span></span>(type: type) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">assertionFailure</span></span>(<span class="hljs-string"><span class="hljs-string">"error creating model"</span></span>) } }</code> </pre><br>  YOLO рд╡рд░реНрдЧ рд╕реАрдзреЗ <i>.mlmodel</i> рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдореЙрдбрд▓ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред  рдбрд╛рдЙрдирд▓реЛрдб рдореЙрдбрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url: <span class="hljs-type"><span class="hljs-type">URL?</span></span> = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.type = type <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> type { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .v3_Tiny: url = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.url(forResource: <span class="hljs-string"><span class="hljs-string">"yolo-tiny"</span></span>, withExtension:<span class="hljs-string"><span class="hljs-string">"mlmodelc"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors = tiny_anchors <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .v3_416: url = <span class="hljs-type"><span class="hljs-type">Bundle</span></span>.main.url(forResource: <span class="hljs-string"><span class="hljs-string">"yolo"</span></span>, withExtension:<span class="hljs-string"><span class="hljs-string">"mlmodelc"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors = anchors_416 } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modelURL = url <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.modelFileNotFound } <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { model = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-type"><span class="hljs-type">MLModel</span></span>(contentsOf: modelURL) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> error { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.modelCreationError }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">рдкреВрд░реНрдг ModelProvider рдХреЛрдбред</b> <div class="spoiler_text"><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CoreML protocol ModelProviderDelegate: class { func show(predictions: [YOLO.Prediction]?, stat: ModelProvider.Statistics, error: YOLOError?) } @available(macOS 10.13, iOS 11.0, tvOS 11.0, watchOS 4.0, *) class ModelProvider { struct Statistics { var timeForFrame: Float var fps: Float } static let shared = ModelProvider(modelType: Settings.shared.modelType) var model: YOLO! weak var delegate: ModelProviderDelegate? var predicted = 0 var timeOfFirstFrameInSecond = CACurrentMediaTime() init(modelType type: YOLOType) { loadModel(type: type) } func reloadModel(type: YOLOType) { loadModel(type: type) } private func loadModel(type: YOLOType) { do { self.model = try YOLO(type: type) } catch { assertionFailure("error creating model") } } func predict(frame: UIImage) { DispatchQueue.global().async { do { let startTime = CACurrentMediaTime() let predictions = try self.model.predict(frame: frame) let elapsed = CACurrentMediaTime() - startTime self.showResultOnMain(predictions: predictions, elapsed: Float(elapsed), error: nil) } catch let error as YOLOError { self.showResultOnMain(predictions: nil, elapsed: -1, error: error) } catch { self.showResultOnMain(predictions: nil, elapsed: -1, error: YOLOError.unknownError) } } } private func showResultOnMain(predictions: [YOLO.Prediction]?, elapsed: Float, error: YOLOError?) { if let delegate = self.delegate { DispatchQueue.main.async { let fps = self.measureFPS() delegate.show(predictions: predictions, stat: ModelProvider.Statistics(timeForFrame: elapsed, fps: fps), error: error) } } } private func measureFPS() -&gt; Float { predicted += 1 let elapsed = CACurrentMediaTime() - timeOfFirstFrameInSecond let currentFPSDelivered = Double(predicted) / elapsed if elapsed &gt; 1 { predicted = 0 timeOfFirstFrameInSecond = CACurrentMediaTime() } return Float(currentFPSDelivered) } }</code> </pre><br></div></div><br>  <b>рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг</b> <br><br>  рдЕрдм рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдХрд┐ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рдХреИрд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░реЗрдВ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред  Xcode рдореЗрдВ, рдпрджрд┐ рдЖрдк рдПрдХ рдореЙрдбрд▓ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ рдХреНрдпрд╛ рд╣реИрдВ рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рд▓реЗрдпрд░реНрд╕ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m_/3b/vz/m_3bvzkroynfyfkpv1fal-ydf_k.png"></div><br>  <i>рдкреНрд░рд╡реЗрд╢ рдХрд░реЗрдВ рдФрд░ YOLOv3- рдЫреЛрдЯреЗ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВред</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0l/nl/hy/0lnlhydblax7trhpzdte8bojc0y.png"></div><br>  <i>рдкреНрд░рд╡реЗрд╢ рдФрд░ YOLOv3-416 рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓реЗрдВред</i> <br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдКрдкрд░ рдХреА рдЫрд╡рд┐ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ YOLOv3-416 рдХреЗ рд▓рд┐рдП рддреАрди рдФрд░ YOLOv3- рдЫреЛрдЯреЗ рдЖрдЙрдЯрдкреБрдЯ рдкрд░рддреЛрдВ рдХреЗ рд▓рд┐рдП рджреЛ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдП рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдЧрдИ рд╣реИред <br>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХрд╛ рдПрдХ рдирд┐рдпрдорд┐рдд рд╕рд░рдгреА рд╣реИ, рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдХрд┐ рдЗрд╕реЗ рдкрд╛рд░реНрд╕ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПред <br><br>  YOLOv3 рдореЙрдбрд▓ рдПрдХ рдЕрд▓рдЧ рдЧреНрд░рд┐рдб рдореЗрдВ рдЫрд╡рд┐ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рддреАрди рдкрд░рддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЗрди рдЧреНрд░рд┐рдбреЛрдВ рдХреЗ рд╕реЗрд▓ рдЖрдХрд╛рд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рди рд╣реИрдВ: 8, 16 рдФрд░ 32. рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЖрдХрд╛рд░ рдореЗрдВ 416x416 рдкрд┐рдХреНрд╕реЗрд▓ рдХреА рдЫрд╡рд┐ рд╣реИ, рддреЛ рдЖрдЙрдЯрдкреБрдЯ рдореИрдЯреНрд░рд┐рдХреНрд╕ (рдЧреНрд░рд┐рдб) рдХрд╛ рдЖрдХрд╛рд░ 52x5252 рд╣реЛрдЧрд╛ , 26x26 рдФрд░ 13x13 (416/8 = 52, 416/16 = 26 рдФрд░ 416/32 = 13)ред  YOLOv3- рдЫреЛрдЯреЗ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рдм рдХреБрдЫ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рддреАрди рдЧреНрд░рд┐рдбреЛрдВ рдХреЗ рдмрдЬрд╛рдп, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджреЛ: 16 рдФрд░ 32 рд╣реИрдВ, рдЕрд░реНрдерд╛рдд, 26x26 рдФрд░ 13x13 рдЖрдпрд╛рдореЛрдВ рдХреЗ рдореИрдЯреНрд░реЗрд╕ рд╣реИрдВред <br><br>  рд▓реЛрдб рдХрд┐рдП рдЧрдП CoreML рдореЙрдбрд▓ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдЖрдЙрдЯрдкреБрдЯ рдкрд░ MLMultiArray рд╡рд░реНрдЧ рдХреА рджреЛ (рдпрд╛ рддреАрди) рд╡рд╕реНрддреБрдПрдВ рдорд┐рд▓рддреА рд╣реИрдВред  рдФрд░ рдпрджрд┐ рдЖрдк рдЗрди рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреА рд╕рдВрдкрддреНрддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рджреЗрдЦреЗрдВрдЧреЗ (YOLOv3- рдЫреЛрдЯреЗ рдХреЗ рд▓рд┐рдП): <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mo" id="MJXp-Span-2" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-3">1</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-5">1</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-7">255</span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-9">26</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-11">26</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mspace" id="MJXp-Span-13" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-15">1</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-17">1</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-19">255</span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-21">13</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-23">13</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="6.033ex" viewBox="0 -832 33095.6 2597.7" role="img" focusable="false" style="vertical-align: -4.101ex; max-width: 638px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(13126,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="3671" y="0"></use><g transform="translate(4116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="5117" y="0"></use><g transform="translate(5562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-5D" x="6563" y="0"></use></g><g transform="translate(13126,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="1724" y="0"></use><g transform="translate(2169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="3671" y="0"></use><g transform="translate(4116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-33" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="5117" y="0"></use><g transform="translate(5562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-33" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-5D" x="6563" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> [1, 1, 255, 26, 26] \\ [1, 1, 255, 13, 13] </script></p><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЕрдкреЗрдХреНрд╖рд┐рдд рдерд╛, рдореЗрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдЖрдпрд╛рдо 26x26 рдФрд░ 13x13 рд╣реЛрдЧрд╛ред рд▓реЗрдХрд┐рди рд╕рдВрдЦреНрдпрд╛ 255 рдХрд╛ рдХреНрдпрд╛ рдЕрд░реНрде рд╣реЛрдЧрд╛?  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдЙрдЯрдкреБрдЯ рд▓реЗрдпрд░ 52x52, 26x26 рдФрд░ 13x13 рдореИрдЯреНрд░рд┐рд╕реЗрд╕ рд╣реИрдВред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рдПрдХ рд╡реЗрдХреНрдЯрд░ рд╣реИред  рдпрд╣реА рд╣реИ, рдЖрдЙрдЯрдкреБрдЯ рдкрд░рдд рдПрдХ рддреАрди-рдЖрдпрд╛рдореА рдореИрдЯреНрд░рд┐рдХреНрд╕ рд╣реИред  рдЗрд╕ рд╡реЗрдХреНрдЯрд░ рдореЗрдВ рдЖрдпрд╛рдо B x (5 + C) рд╣реИ, рдЬрд╣рд╛рдВ B рд╕реЗрд▓ рдореЗрдВ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ, C рдХрдХреНрд╖рд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИред  5 рдирдВрдмрд░ рдХрд╣рд╛рдВ рд╕реЗ рдЖрддрд╛ рд╣реИ?  рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ: рдкреНрд░рддреНрдпреЗрдХ рдмреЙрдХреНрд╕-рдП рдХреЗ рд▓рд┐рдП, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдПрдХ рд╡рд╕реНрддреБ (рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЙрдиреНрдлрд┐рдбреЗрдВрд╕) рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдЧрдИ рд╣реИ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ, рдФрд░ рд╢реЗрд╖ рдЪрд╛рд░ рдЕрдиреБрдорд╛рдирд┐рдд рдмреЙрдХреНрд╕-рдП рдХреЗ рд▓рд┐рдП x, y, рдЪреМрдбрд╝рд╛рдИ рдФрд░ рдКрдВрдЪрд╛рдИ рд╣реИрдВред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рдЗрд╕ рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдПрдХ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3d/j3/rl/3dj3rlk_te-4x-pthae9mreq7k0.png"></div><br>  <i>рдЖрдЙрдЯрдкреБрдЯ рд▓реЗрдпрд░ (рдлреАрдЪрд░ рдореИрдк) рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ред</i> <br><br>  80 рд╡рд░реНрдЧреЛрдВ рдореЗрдВ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рд╣рдорд╛рд░реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП, 3 рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕-рдП рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдЧреНрд░рд┐рдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд▓ рдХреЗ рд▓рд┐рдП рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдЧрдИ рд╣реИ, рдЙрдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП - 80 рд╡рд░реНрдЧ рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ + рдСрдмреНрдЬреЗрдХреНрдЯ рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕ + рдЗрд╕ рдмреЙрдХреНрд╕-рдП рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рдЖрдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ 4 рдирдВрдмрд░ред  рдХреБрд▓: 3 x (5 + 80) = 255 <br><br>  MLMultiArray рд╡рд░реНрдЧ рд╕реЗ рдЗрди рдорд╛рдиреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдХрдЪреНрдЪреЗ рд╕реВрдЪрдХ рдХреЛ рдбреЗрдЯрд╛ рд╕рд░рдгреА рдФрд░ рдкрддреЗ рдХреЗ рдЕрдВрдХрдЧрдгрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИ: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pointer = <span class="hljs-type"><span class="hljs-type">UnsafeMutablePointer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Double</span></span>&gt;(<span class="hljs-type"><span class="hljs-type">OpaquePointer</span></span>(out.dataPointer)) <span class="hljs-comment"><span class="hljs-comment">//    if out.strides.count &lt; 3 { throw YOLOError.strideOutOfBounds } let channelStride = out.strides[out.strides.count-3].intValue let yStride = out.strides[out.strides.count-2].intValue let xStride = out.strides[out.strides.count-1].intValue func offset(ch: Int, x: Int, y: Int) -&gt; Int { //     return ch * channelStride + y * yStride + x * xStride }</span></span></code> </pre><br>  рдЕрдм рдЖрдкрдХреЛ 255 рддрддреНрд╡реЛрдВ рдХреЗ рд╡реЗрдХреНрдЯрд░ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рдмреЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ 80 рд╡рд░реНрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡реНрдпрддрд╛ рд╡рд┐рддрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЖрдк рд╕реЙрдлреНрдЯрдореИрдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рд╕реЙрдлреНрдЯрдореИрдХреНрд╕ рдХреНрдпрд╛ рд╣реИ</b> <div class="spoiler_text">  рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╡реЗрдХреНрдЯрд░ рдХреЛ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mtext" id="MJXp-Span-26">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.354ex" height="2.074ex" viewBox="0 -772.3 4027.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="3455" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ mathbb x </script>  рдЖрдпрд╛рдо K, рдПрдХ рд╣реА рдЖрдпрд╛рдо рдХреЗ рдПрдХ рд╕рджрд┐рд╢ рдореЗрдВ, рдЬрд╣рд╛рдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рдордиреНрд╡рдп рдХрд░рддреЗ рд╣реИрдВ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-34"><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">b</span><span class="MJXp-msubsup" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-44" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.154ex" height="2.349ex" viewBox="0 -772.3 4371.8 1011.3" role="img" focusable="false" style="vertical-align: -0.555ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-69" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ mathbb x_i </script>  рдкрд░рд┐рдгрд╛рдореА рд╡реЗрдХреНрдЯрд░ рдХреЛ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдВрдЦреНрдпрд╛ [0,1] рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХрд╛ рдпреЛрдЧ 1 рд╣реИред <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-45"><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mtext" id="MJXp-Span-47" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-48" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-49">рд╕</span></span></span><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-54"><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-mrow" id="MJXp-Span-58"><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-61">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">b</span><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-70"><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-72" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-74">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">c</span><span class="MJXp-mrow" id="MJXp-Span-79"><span class="MJXp-msubsup" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-82" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mtext" id="MJXp-Span-87">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">u</span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">K</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">k</span><span class="MJXp-mo" id="MJXp-Span-94">=</span><span class="MJXp-mn" id="MJXp-Span-95">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-98"><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-101" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-104" style="vertical-align: -0.4em;">k</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.782ex" height="3.174ex" viewBox="0 -950 18850.4 1366.8" role="img" focusable="false" style="vertical-align: -0.968ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(250,-159)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(41.896) matrix(1 0 0 -1 0 0)">рд╕</text></g><g transform="translate(852,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(59.251) matrix(1 0 0 -1 0 0)">рд┐</text></g><g transform="translate(1621,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(59.251) matrix(1 0 0 -1 0 0)">рдЧ</text></g><g transform="translate(2213,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(59.251) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(2707,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(59.251) matrix(1 0 0 -1 0 0)">рдо</text></g><g transform="translate(3358,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(59.251) matrix(1 0 0 -1 0 0)">рд╛</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-28" x="4089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="4728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="5607" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="6136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="6498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="7074" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-62" x="7504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="7933" y="0"></use><g transform="translate(8506,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-69" x="550" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="9517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-66" x="10824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-72" x="11374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="11826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-63" x="12355" y="0"></use><g transform="translate(12789,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-69" x="809" y="-213"></use></g></g><g transform="translate(14003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-4B" x="1242" y="488"></use><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-31" x="1300" y="0"></use></g></g><g transform="translate(3543,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6B" x="809" y="-213"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ _ рд╕рд┐рдЧреНрдорд╛ (\ mathbb {x}) _ i = \ frac {e ^ {x_i}} {\ sum_ {k = 1} ^ {K} {e ^ {x_k}}} </script></p>  рдЬрд╣рд╛рдВ K рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЖрдпрд╛рдо рд╣реИред <br></div></div><br>  рд╕реНрд╡рд┐рдлреНрдЯ рдкрд░ рд╕реЙрдлреНрдЯрдореИрдХреНрд╕ рдлрд╝рдВрдХреНрд╢рди: <br><br><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">softmax</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> [Float])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> len = vDSP_Length(x.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">count</span></span> = <span class="hljs-type"><span class="hljs-type">Int32</span></span>(x.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) vvexpf(&amp;x, x, &amp;<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sum: <span class="hljs-type"><span class="hljs-type">Float</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> vDSP_sve(x, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;sum, len) vDSP_vsdiv(x, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;sum, &amp;x, <span class="hljs-number"><span class="hljs-number">1</span></span>, len) }</code> </pre><br>  рдмрд╛рдЙрдВрдбрд┐рдВрдЧ-рдП рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдФрд░ рдЖрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рд╕реВрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">x</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">a</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">x</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-124" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mspace" id="MJXp-Span-125" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">y</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">a</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">y</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mspace" id="MJXp-Span-145" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">w</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-msubsup" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-153" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">w</span></span></span><span class="MJXp-mspace" id="MJXp-Span-159" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">h</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-164" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-167" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">h</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="13.262ex" viewBox="0 -832 33095.6 5710.1" role="img" focusable="false" style="vertical-align: -11.33ex; max-width: 638px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11502,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-73" x="2156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-69" x="2626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-67" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="3452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="4330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-28" x="4860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="5499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="6076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="6605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="6967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-29" x="7539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2B" x="8151" y="0"></use><g transform="translate(9152,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="613" y="-213"></use></g></g><g transform="translate(11604,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-73" x="2081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-69" x="2551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-67" x="2896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6D" x="3377" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="4255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-28" x="4785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="5424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="6001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="6530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-79" x="6892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-29" x="7389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2B" x="8001" y="0"></use><g transform="translate(9002,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-79" x="613" y="-213"></use></g></g><g transform="translate(13787,-3064)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="994" y="0"></use><g transform="translate(2050,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-77" x="712" y="-213"></use></g><g transform="translate(3160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="930" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1459" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-77" x="1821" y="0"></use></g></g></g><g transform="translate(13877,-4593)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="854" y="0"></use><g transform="translate(1910,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="712" y="-213"></use></g><g transform="translate(2921,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="576" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1106" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="1467" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="2044" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> x = \ sigma (\ hat x) + c_x \\ y = \ sigma (\ hat y) + c_y \\ w = p_we ^ {\ hat w} \\ h = p_he ^ {hat h h} </script></p><br>  рдЬрд╣рд╛рдБ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mtext" id="MJXp-Span-174">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">x</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-179">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mrow" id="MJXp-Span-182"><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.278em; margin-right: 0.278em;">рдп</span></span><span class="MJXp-mrow" id="MJXp-Span-184"><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-187">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mrow" id="MJXp-Span-190"><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.278em; margin-right: 0.278em;">рд╡</span></span><span class="MJXp-mrow" id="MJXp-Span-192"><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.278em; margin-right: 0.278em;">реЙ</span></span><span class="MJXp-mrow" id="MJXp-Span-194"><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mrow" id="MJXp-Span-200"><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.278em; margin-right: 0.278em;">реИ</span></span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-204"><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.345ex" height="2.78ex" viewBox="0 -935.7 10051.2 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(250,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╣</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="1393" y="0"></use><g transform="translate(2088,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╣</text></g><g transform="translate(2658,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдп</text></g><g transform="translate(3281,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдЯ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="3851" y="0"></use><g transform="translate(4547,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╣</text></g><g transform="translate(5117,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╡</text></g><g transform="translate(5688,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЙ</text></g><g transform="translate(6493,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдЯ</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="7063" y="0"></use><g transform="translate(7759,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╣</text></g><g transform="translate(8329,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реИ</text></g><g transform="translate(8909,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдЯ</text></g><g transform="translate(9480,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╣</text></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ рд╣ x, \ рд╣ рдпрдЯ, \ рд╣ рд╡реЙрдЯ, \ рд╣реИрдЯ рд╣ </script>  - рдЕрдиреБрдорд╛рдирд┐рдд x, y рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ, рдЪреМрдбрд╝рд╛рдИ рдФрд░ рдКрдВрдЪрд╛рдИ рдХреНрд░рдорд╢рдГ, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mtext" id="MJXp-Span-208" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-210">рд╕</span></span></span><span class="MJXp-mrow" id="MJXp-Span-211"><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mrow" id="MJXp-Span-213"><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-217"><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-mrow" id="MJXp-Span-219"><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">x</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.734ex" height="2.901ex" viewBox="0 -883.9 5482.9 1249" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(250,-170)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(36.68) matrix(1 0 0 -1 0 0)">рд╕</text></g><g transform="translate(826,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд┐</text></g><g transform="translate(1587,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдЧ</text></g><g transform="translate(2210,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(2704,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдо</text></g><g transform="translate(3378,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╛</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-28" x="4131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="4520" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-29" x="5093" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> \ _ рд╕рд┐рдЧреНрдорд╛ (x) </script>  рд╕рд┐рдЧреНрдореЙрдЗрдб рдлрд╝рдВрдХреНрд╢рди рд╣реИ, рдФрд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-msubsup" id="MJXp-Span-225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-227" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-231" style="vertical-align: -0.4em;">h</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.05ex" height="1.817ex" viewBox="-38.5 -520.7 2605 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-77" x="712" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-2C" x="1110" y="0"></use><g transform="translate(1555,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-68" x="712" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> p_w, p_h </script>  - рддреАрди рдмрдХреНрд╕реЛрдВ рдХреЗ рд▓рд┐рдП рд▓рдВрдЧрд░ (рд▓рдВрдЧрд░) рдХрд╛ рдорд╛рдиред  рдпреЗ рдорд╛рди рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ Helpers.swift рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> anchors1: [<span class="hljs-type"><span class="hljs-type">Float</span></span>] = [<span class="hljs-number"><span class="hljs-number">116</span></span>,<span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-number"><span class="hljs-number">156</span></span>,<span class="hljs-number"><span class="hljs-number">198</span></span>, <span class="hljs-number"><span class="hljs-number">373</span></span>,<span class="hljs-number"><span class="hljs-number">326</span></span>] <span class="hljs-comment"><span class="hljs-comment">//     let anchors2: [Float] = [30,61, 62,45, 59,119] //     let anchors3: [Float] = [10,13, 16,30, 33,23] //    </span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ng/zf/pv/ngzfpvvch8bhnkdapz6url5ok-w.png"></div><br>  <i>рдПрдХ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдЧрдгрдирд╛ рдХрд╛ рдпреЛрдЬрдирд╛рдмрджреНрдз рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ред</i> <br><br><div class="spoiler">  <b class="spoiler_title">рдЖрдЙрдЯрдкреБрдЯ рд▓реЗрдпрд░реНрд╕ рдХреА рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреВрд░рд╛ рдХреЛрдбред</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(output out: MLMultiArray, name: String)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Prediction</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> predictions = [<span class="hljs-type"><span class="hljs-type">Prediction</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> grid = out.shape[out.shape.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> gridSize = <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.inputSize / <span class="hljs-type"><span class="hljs-type">Float</span></span>(grid) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> classesCount = labels.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(out.shape) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pointer = <span class="hljs-type"><span class="hljs-type">UnsafeMutablePointer</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Double</span></span>&gt;(<span class="hljs-type"><span class="hljs-type">OpaquePointer</span></span>(out.dataPointer)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> &lt; <span class="hljs-number"><span class="hljs-number">3</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-type"><span class="hljs-type">YOLOError</span></span>.strideOutOfBounds } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> channelStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">3</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> yStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">2</span></span>].intValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> xStride = out.strides[out.strides.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>].intValue <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ch: Int, x: Int, y: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ch * channelStride + y * yStride + x * xStride } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; grid { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; grid { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> box_i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.boxesPerCell { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> boxOffset = box_i * (classesCount + <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbx = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bby = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbw = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">2</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bbh = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">3</span></span>, x: x, y: y)]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidence = sigmoid(<span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">4</span></span>, x: x, y: y)])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> confidence &lt; confidenceThreshold { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> x_pos = (sigmoid(bbx) + <span class="hljs-type"><span class="hljs-type">Float</span></span>(x)) * gridSize <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> y_pos = (sigmoid(bby) + <span class="hljs-type"><span class="hljs-type">Float</span></span>(y)) * gridSize <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> width = exp(bbw) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors[name]![<span class="hljs-number"><span class="hljs-number">2</span></span> * box_i] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> height = exp(bbh) * <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.anchors[name]![<span class="hljs-number"><span class="hljs-number">2</span></span> * box_i + <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ..&lt; <span class="hljs-number"><span class="hljs-number">80</span></span> { classes[<span class="hljs-built_in"><span class="hljs-built_in">c</span></span>] = <span class="hljs-type"><span class="hljs-type">Float</span></span>(pointer[offset(ch: boxOffset + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>, x: x, y: y)]) } softmax(&amp;classes) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> (detectedClass, bestClassScore) = argmax(classes) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> confidenceInClass = bestClassScore * confidence <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> confidenceInClass &lt; confidenceThreshold { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } predictions.append(<span class="hljs-type"><span class="hljs-type">Prediction</span></span>(classIndex: detectedClass, score: confidenceInClass, rect: <span class="hljs-type"><span class="hljs-type">CGRect</span></span>(x: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(x_pos - width / <span class="hljs-number"><span class="hljs-number">2</span></span>), y: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(y_pos - height / <span class="hljs-number"><span class="hljs-number">2</span></span>), width: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(width), height: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span>(height)))) } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> predictions }</code> </pre><br></div></div><br>  <b>рдЧреИрд░ рдЕрдзрд┐рдХрддрдо рджрдорди</b> <br><br>  рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЛ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдФрд░ рдЖрдХрд╛рд░ рдФрд░ рдЫрд╡рд┐ рдореЗрдВ рд╕рднреА рдкрд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдорд┐рд▓ рдЬрд╛рддреА рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдЪрд┐рддреНрд░ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдЦреАрдВрдЪрдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдПрдХ рд╕рдорд╕реНрдпрд╛ рд╣реИ!  рдРрд╕реА рд╕реНрдерд┐рддрд┐ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрдм рдПрдХ рд╡рд╕реНрддреБ рдХреЗ рд▓рд┐рдП рдЙрдЪреНрдЪ рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рд╡рд╛рд▓реЗ рдХрдИ рдмреЙрдХреНрд╕реЛрдВ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдЬрд╛рддреА рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ?  рдпрд╣рд╛рдБ рдЧреИрд░-рдЕрдзрд┐рдХрддрдо рджрдорди рдирд╛рдордХ рдПрдХ рдХрд╛рдлреА рд╕рд░рд▓ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣рдорд╛рд░реА рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЖрддрд╛ рд╣реИред <br><br>  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <br><br><ol><li>  рд╣рдо рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЙрдЪреНрдЪрддрдо рд╕рдВрднрд╛рд╡рдирд╛ рд╡рд╛рд▓реЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред </li><li>  рд╣рдо рд╕рднреА рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЪрд▓рддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рд╡рд╕реНрддреБ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред </li><li>  рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ рдпрджрд┐ рдкрд╣рд▓реЗ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдШ (IoU) рдкрд░ рдЕрдВрддрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реАрдорд╛ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред </li></ol><br>  IoU рдХреА рдЧрдгрдирд╛ рдПрдХ рд╕рд░рд▓ рд╕реВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреА рдЬрд╛рддреА рд╣реИ: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-232"><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">t</span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">U</span></span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">c</span><span class="MJXp-mrow" id="MJXp-Span-248"><span class="MJXp-mtext" id="MJXp-Span-249">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">t</span><span class="MJXp-mrow" id="MJXp-Span-254"><span class="MJXp-mrow" id="MJXp-Span-255"><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0.278em; margin-right: 0.278em;">рдЕ</span></span><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.278em; margin-right: 0.278em;">рдВ</span></span><span class="MJXp-mrow" id="MJXp-Span-259"><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0.278em; margin-right: 0.278em;">рдд</span></span><span class="MJXp-mrow" id="MJXp-Span-261"><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.278em; margin-right: 0.278em;">рдГ</span></span><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-267"><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.278em; margin-right: 0.278em;">рд╖</span></span><span class="MJXp-mrow" id="MJXp-Span-269"><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-271"><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.278em; margin-right: 0.278em;">рдд</span></span><span class="MJXp-mrow" id="MJXp-Span-273"><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-275"><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.278em; margin-right: 0.278em;">рд░</span></span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-281"><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.278em; margin-right: 0.278em;">рд╖</span></span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-285"><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.278em; margin-right: 0.278em;">рдд</span></span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-289"><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.278em; margin-right: 0.278em;">рд░</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-291"><span class="MJXp-mtext" id="MJXp-Span-292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">t</span><span class="MJXp-mrow" id="MJXp-Span-297"><span class="MJXp-mrow" id="MJXp-Span-298"><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span><span class="MJXp-mrow" id="MJXp-Span-300"><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.278em; margin-right: 0.278em;">реЛ</span></span><span class="MJXp-mrow" id="MJXp-Span-304"><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mrow" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span><span class="MJXp-mrow" id="MJXp-Span-310"><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.278em; margin-right: 0.278em;">рд╢</span></span><span class="MJXp-mrow" id="MJXp-Span-312"><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span><span class="MJXp-mrow" id="MJXp-Span-314"><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-316"><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-318"><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.278em; margin-right: 0.278em;">рд╖</span></span><span class="MJXp-mrow" id="MJXp-Span-320"><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-322"><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.278em; margin-right: 0.278em;">рдд</span></span><span class="MJXp-mrow" id="MJXp-Span-324"><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-326"><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.278em; margin-right: 0.278em;">рд░</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="73.213ex" height="2.78ex" viewBox="0 -935.7 31522.3 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-6F" x="504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-55" x="990" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMAIN-3D" x="4047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-66" x="5353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-72" x="5904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-61" x="6355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-63" x="6885" y="0"></use><g transform="translate(7318,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдЕ</text><g transform="translate(726,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдВ</text></g><g transform="translate(1219,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдд</text></g><g transform="translate(1842,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдГ</text></g><g transform="translate(2550,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдХ</text></g><g transform="translate(3380,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(3874,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╖</text></g><g transform="translate(4444,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЗ</text></g><g transform="translate(5025,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдд</text></g><g transform="translate(5647,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(6141,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд░</text></g><g transform="translate(6660,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдХ</text></g><g transform="translate(7490,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(7983,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╖</text></g><g transform="translate(8554,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЗ</text></g><g transform="translate(9134,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдд</text></g><g transform="translate(9757,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(10250,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд░</text></g></g></g><g transform="translate(20100,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-65" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-78" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/460869/&amp;usg=ALkJrhhSYyjVipYzCv9ZQh5tPyHIK6tBhQ#MJMATHI-74" x="1650" y="0"></use><g transform="translate(2012,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдП</text><g transform="translate(570,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╕</text></g><g transform="translate(1244,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЛ</text></g><g transform="translate(1997,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╕</text></g><g transform="translate(2672,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд┐</text></g><g transform="translate(3433,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдП</text></g><g transform="translate(4004,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╢</text></g><g transform="translate(4730,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рди</text></g><g transform="translate(5300,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдХ</text></g><g transform="translate(6130,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(6624,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд╖</text></g><g transform="translate(7195,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реЗ</text></g><g transform="translate(7775,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рдд</text></g><g transform="translate(8397,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">реН</text></g><g transform="translate(8891,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">рд░</text></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ text {IoU} = \ frac {\ text {рдЕрдВрддрдГрдХреНрд╖реЗрддреНрд░ рдХреНрд╖реЗрддреНрд░}} {\ text {рдПрд╕реЛрд╕рд┐рдПрд╢рди рдХреНрд╖реЗрддреНрд░}}</script></p><div class="spoiler">  <b class="spoiler_title">IoU рдХреА рдЧрдгрдирд╛ред</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IOU</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: CGRect, b: CGRect)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Float</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> areaA = a.width * a.height <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> areaA &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> areaB = b.width * b.height <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> areaB &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> intersection = a.intersection(b) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> intersectionArea = intersection.width * intersection.height <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Float</span></span>(intersectionArea / (areaA + areaB - intersectionArea)) }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">рдЧреИрд░ рдЕрдзрд┐рдХрддрдо рджрдордиред</b> <div class="spoiler_text"><pre> <code class="swift hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nonMaxSuppression</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(boxes: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> [Prediction], threshold: Float)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> i &lt; boxes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = i + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> j &lt; boxes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> iou = <span class="hljs-type"><span class="hljs-type">YOLO</span></span>.<span class="hljs-type"><span class="hljs-type">IOU</span></span>(a: boxes[i].rect, b: boxes[j].rect) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> iou &gt; threshold { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].score &gt; boxes[j].score { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].classIndex == boxes[j].classIndex { boxes.remove(at: j) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> boxes[i].classIndex == boxes[j].classIndex { boxes.remove(at: i) j = i + <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { j += <span class="hljs-number"><span class="hljs-number">1</span></span> } } i += <span class="hljs-number"><span class="hljs-number">1</span></span> } }</code> </pre><br></div></div><br>  рдЙрд╕рдХреЗ рдмрд╛рдж, рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рдХрд╛рдо рдкреВрд░рд╛ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЕрдЧрд▓рд╛, рдЖрдкрдХреЛ рдХреИрдорд░реЗ рд╕реЗ рдлреБрдЯреЗрдЬ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдХрдХреНрд╖рд╛рдПрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рд╣реИ, рд╕реНрдХреНрд░реАрди рдкрд░ рдЫрд╡рд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдВред  рдореИрдВ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЗрд╕ рд╕рднреА рдХреЛрдб рдХрд╛ рд╡рд░реНрдгрди рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдореИрдВрдиреЗ рдСрдирд▓рд╛рдЗрди рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдХрд╛ рдереЛрдбрд╝рд╛ рдЪреМрд░рд╕рд╛рдИ рдХрд┐рдпрд╛, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ рдкрд┐рдЫрд▓реЗ 30 рдлрд╝реНрд░реЗрдореЛрдВ рдореЗрдВ рдЕрдиреБрдорд╛рдирд┐рдд рд╡рд░реНрдЧ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рдЖрдХрд╛рд░ рдХрд╛ рд╕рд╛рдорд╛рдиреНрдп рдФрд╕рдд рд╣реИред <br><br><h4>  рдХрд╛рд░реНрдпрдХреНрд░рдо рдХрд╛ рдкрд░реАрдХреНрд╖рдг </h4><br>  рдЕрдм рд╣рдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рдЖрдкрдХреЛ рдпрд╛рдж рджрд┐рд▓рд╛ рджреВрдВ: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рддреАрди рд╡реНрдпреВрдХрдВрдЯреНрд░реЛрд▓рд░ рд╣реИрдВ, рдПрдХ рдлреЛрдЯреЛ рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдСрдирд▓рд╛рдЗрди рд╡реАрдбрд┐рдпреЛ рд╕реНрдЯреНрд░реАрдо рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рддреАрд╕рд░рд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред <br><br>  рддреАрд╕рд░реЗ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдореЗрдВ рдЖрдк рджреЛ рдореЗрдВ рд╕реЗ рдПрдХ рдореЙрдбрд▓ YOLOv3- рд╕реНрдорд╛рд▓ рдпрд╛ YOLOv3-416 рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ, рдХреЙрдиреНрдлрд┐рдбреЗрдВрд╕ рдереНрд░реЗрд╢реЛрд▓реНрдб рдФрд░ IoU рдереНрд░реЗрд╢реЛрд▓реНрдб рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рдСрдирд▓рд╛рдЗрди рдПрдВрдЯреА-рдЕрд▓рд┐рдпрд╛рд╕рд┐рдВрдЧ рдХреЛ рдЗрдиреЗрдмрд▓ рдпрд╛ рдбрд┐рд╕реЗрдмрд▓ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sb/zq/tz/sbzqtzy6hai51objkormfzvtbuq.jpeg"></div><br>  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдиреНрдпреВрд░реЙрди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдо рдЧреИрд▓рд░реА рд╕реЗ рдПрдХ рддрд╕реНрд╡реАрд░ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВред  рдиреАрдЪреЗ рджреА рдЧрдИ рддрд╕реНрд╡реАрд░ рдЕрд▓рдЧ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде YOLOv3- рдЫреЛрдЯреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рджрд┐рдЦрд╛рддреА рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nr/j3/fj/nrj3fjpw0yvxgl2cigujbcb-1p4.png"></div><br>  <i>YOLOv3- рдЫреЛрдЯреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рдореЛрдбред</i>  <i>рдмрд╛рдИрдВ рддрд╕реНрд╡реАрд░ рдСрдкрд░реЗрд╢рди рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдореЛрдб рдХреЛ рджрд┐рдЦрд╛рддреА рд╣реИред</i>  <i>рдмреАрдЪ рдкрд░ - рджрд╣рд▓реАрдЬ IoU = 1 рдпрд╛рдиреАред</i>  <i>рдорд╛рдиреЛ рдЧреИрд░-рдЕрдзрд┐рдХрддрдо рджрдорди рдЧрд╛рдпрдм рд╣реИред</i>  <i>рджрд╛рдИрдВ рдУрд░ рд╡рд╕реНрддреБ рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреА рдХрдо рд╕реАрдорд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреНред</i>  <i>рд╕рднреА рд╕рдВрднрд╡ рдмрд╛рдЙрдВрдбрд┐рдВрдЧ рдмреЙрдХреНрд╕ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред</i> <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд YOLOv3-416 рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИред  рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐, YOLOv3- рдЫреЛрдЯреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдлрд╝реНрд░реЗрдо рдЕрдзрд┐рдХ рд╕рд╣реА рд╣реИрдВ, рд╕рд╛рде рд╣реА рдЫрд╡рд┐ рдореЗрдВ рдЫреЛрдЯреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдорд╛рдиреНрдпрддрд╛ рджреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рддреАрд╕рд░реА рдЖрдЙрдЯрдкреБрдЯ рдкрд░рдд рдХреЗ рдХрд╛рдо рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wc/nj/xq/wcnjxqeygnuriffqpatmtvevyfo.png"></div><br>  <i>YOLOv3-416 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЫрд╡рд┐ рд╕рдВрд╕рд╛рдзрд┐рдд рдХреА рдЧрдИред</i> <br><br>  рдЬрдм рдСрдирд▓рд╛рдЗрди рдСрдкрд░реЗрд╢рди рдореЛрдб рдЪрд╛рд▓реВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдлреНрд░реЗрдо рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХреА рдЧрдИ рдереА, <b>iPhone XS рдкрд░ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП рдЧрдП рдереЗ,</b> рдЗрд╕рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдо рджреЛрдиреЛрдВ рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рд╕реНрд╡реАрдХрд╛рд░реНрдп рдерд╛ред  <b>YOLOv3- рдЫреЛрдЯреЗ 23 - 25 рдПрдлрдкреАрдПрд╕ рд╕реЗ 30 - 32 рдПрдлрдкреАрдПрд╕, YOLOv3-416 - рдХрд╛ рдФрд╕рдд рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИред</b>  рдЬрд┐рд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдпрд╣ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рд╡рд╣ рдХрд╛рдлреА рдЙрддреНрдкрд╛рджрдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реЗ рдХреЗ рдореЙрдбрд▓ рдкрд░ рдкрд░рд┐рдгрд╛рдо рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдпрд╣ рдпреЛрд▓реЛрд╡ 3-рдЫреЛрдЯреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИред  рдПрдХ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ: yolo-рдЫреЛрдЯреЗ.mlmodel (YOLOv3- рдЫреЛрдЯреЗ) рдореЗрдВ рд▓рдЧрднрдЧ 35 рдПрдордмреА рд▓рдЧрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ yolo.mlmodel (YOLOv3 -16) рдХрд╛ рд╡рдЬрди рд▓рдЧрднрдЧ 250 рдПрдордмреА рд╣реИ, рдЬреЛ рдПрдХ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдВрддрд░ рд╣реИред <br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рдирддреАрдЬрддрди, рдПрдХ iOS рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдорджрдж рд╕реЗ рдЫрд╡рд┐ рдореЗрдВ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рдЪрд╛рди рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдордиреЗ рджреЗрдЦрд╛ рдХрд┐ рдХреЛрд░рдПрдордПрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рд╣реИ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдкреВрд░реНрд╡-рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ (рд╡реИрд╕реЗ, рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдСрдмреНрдЬреЗрдХреНрдЯ рдорд╛рдиреНрдпрддрд╛ рд╕рдорд╕реНрдпрд╛ YOLOv3 рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд▓ рдХреА рдЧрдИ рдереАред  IPhone XS рдкрд░, рдпрд╣ рдиреЗрдЯрд╡рд░реНрдХ (YOLOv3-small) ~ 30 рдлреНрд░реЗрдо рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдХреА рдЖрд╡реГрддреНрддрд┐ рдкрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред <br><br>  рдкреВрд░рд╛ рдЖрд╡реЗрджрди рдХреЛрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">GitHub</a> рдкрд░ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi460869/">https://habr.com/ru/post/hi460869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi460859/index.html">ITHink # 3 рд╕рдореНрдореЗрд▓рди Kharkov рдореЗрдВ - WWDC 2019 рдкрд░ рдЖрдзрд╛рд░рд┐рдд</a></li>
<li><a href="../hi460861/index.html">рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЗрдХреНрд╕рд┐рдХрд▓ рд╕реНрдХреЛрдк рдФрд░ рдХреНрд▓реЛрдЬрд░</a></li>
<li><a href="../hi460863/index.html">Cloudflare рдХреНрд░реИрд╢ рд╡рд┐рд╡рд░рдг 2 рдЬреБрд▓рд╛рдИ 2019</a></li>
<li><a href="../hi460865/index.html">рдЪрд╛рдБрдж рдкрд░ рд▓реЛрдЧред рд╕реВрддреНрд░реЛрдВ рдХрд╛ рдХрд╣рдирд╛ рд╣реИ</a></li>
<li><a href="../hi460867/index.html">рдЦрдЯреНрдЯреЗрдкрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рджрд╛рдпрд░реЗ рд╡рд╕реНрддреБ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi460873/index.html">рдХреНрдпреЛрдВ Turok: N64 рдХреЗ рд▓рд┐рдП рдбрд╛рдпрдирд╛рд╕реЛрд░ рд╣рдВрдЯрд░ рдЕрдкрдиреЗ рд╕рдордп рд╕реЗ рдЖрдЧреЗ рд╣реИ</a></li>
<li><a href="../hi460875/index.html">рд╣рдо рдХрд┐рд╕ рддрд░рд╣ QIWI рдореЗрдВ MVVM рдХреЗ рднреАрддрд░ View рдФрд░ ViewModel рдХреЗ рдмреАрдЪ рдмрд╛рддрдЪреАрдд рдХреА рдПрдХ рдЖрдо рд╢реИрд▓реА рдореЗрдВ рдЖрдП</a></li>
<li><a href="../hi460877/index.html">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕-рдПрдбрд╡реЗрдВрдЪрд░ рдбреЗрд▓реАрдореЛрд╢рди: рдореЗрдШреЛрдВ рдореЗрдВ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХрд╛ рдирд┐рд░реНрдорд╛рдг + рдСрди-рдкреНрд░рд┐рдорд╛рдЗрд╕реЗрд╕</a></li>
<li><a href="../hi460879/index.html">DUMP рдХрдЬрд╝рд╛рди 2019 - рддрд╛рддрд╛рд░рд╕реНрддрд╛рди рдбреЗрд╡рд▓рдкрд░реНрд╕ рд╕рдореНрдореЗрд▓рдиред рд╣рдо рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ рд▓рд┐рдП рдЖрд╡реЗрджрди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi460881/index.html">DLP рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ OCR рддрдХрдиреАрдХреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ рд╣реЛрддреА рд╣реИ, рдпрд╛ рд╣рдо OCR рдХреИрд╕реЗ рддреИрдпрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>