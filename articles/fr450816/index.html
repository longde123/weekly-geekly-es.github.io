<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêà üíê üë©‚Äçüëß‚Äçüë¶ En-t√™tes HTTP pour le d√©veloppeur responsable üë®üèø üë®üèª‚Äçüöí üë®üèª‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, √™tre en ligne est une condition courante pour de nombreuses personnes. Nous achetons, communiquons, lisons des articles, recherchons des ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>En-t√™tes HTTP pour le d√©veloppeur responsable</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/450816/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/9l/a1/ll/9la1llcyspwwfylwvmocsfvgnfe.jpeg"></div><br>  Aujourd'hui, √™tre en ligne est une condition courante pour de nombreuses personnes.  Nous achetons, communiquons, lisons des articles, recherchons des informations sur divers sujets.  Le r√©seau nous connecte au monde entier, mais surtout, il connecte les gens.  J'utilise moi-m√™me Internet depuis 20 ans et ma relation avec lui a chang√© il y a huit ans lorsque je suis devenu d√©veloppeur Web. <br><br>  Les d√©veloppeurs connectent les gens. <br>  Les d√©veloppeurs aident les gens. <br>  Les d√©veloppeurs donnent aux gens des opportunit√©s. <br><br>  Les d√©veloppeurs peuvent cr√©er un r√©seau pour tout le monde, mais cette capacit√© doit √™tre utilis√©e de mani√®re responsable.  En fin de compte, il est important de cr√©er des choses qui aident les gens et les responsabilisent.  Dans cet article, je veux parler de la fa√ßon dont les en-t√™tes HTTP peuvent vous aider √† cr√©er de meilleurs produits pour le meilleur travail de tous les utilisateurs sur Internet. <br><a name="habracut"></a><br><h2>  HTTP - Protocole de transfert hypertexte </h2><br>  Parlons d'abord de HTTP.  HTTP est un protocole utilis√© par les ordinateurs pour demander et envoyer des donn√©es sur Internet. <br><br>  Lorsque le navigateur demande une ressource au serveur, il utilise HTTP.  Cette demande comprend un ensemble de paires cl√©-valeur contenant des informations telles que la version du navigateur ou les formats de fichier qu'elle comprend.  Ces paires sont appel√©es en-t√™tes de demande. <br><br>  Le serveur r√©pond avec la ressource demand√©e, mais envoie √©galement des en-t√™tes de r√©ponse contenant des informations sur la ressource ou le serveur lui-m√™me. <br><br><pre><code class="plaintext hljs">Request: GET https://the-responsible.dev/ Accept: text/html,application/xhtml+xml,application/xml Accept-Encoding: gzip, deflate, br Accept-Language: en-GB,en-US;q=0.9,en;q=0.8,de;q=0.7 ... Response: Connection: keep-alive Content-Type: text/html; charset=utf-8 Date: Mon, 11 Mar 2019 12:59:38 GMT ... Response Body</code> </pre> <br>  Aujourd'hui, HTTP est le fondement d'Internet et offre de nombreuses fa√ßons d'optimiser l'exp√©rience utilisateur.  Voyons comment utiliser les en-t√™tes HTTP pour cr√©er un r√©seau s√©curis√© et accessible. <br><br><h2>  Le r√©seau doit √™tre s√©curis√© </h2><br>  Je ne me sentais jamais en danger lorsque je cherchais quelque chose sur Internet.  Mais plus j'en apprenais sur le World Wide Web, plus j'√©tais inquiet.  Vous pouvez lire comment les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pirates modifient les biblioth√®ques CDN mondiales</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des sites al√©atoires exploitent des cryptomonnaies dans le navigateur de leurs visiteurs,</a> ainsi que comment, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gr√¢ce √† l'ing√©nierie sociale, les gens ont r√©guli√®rement acc√®s √† des projets open source r√©ussis</a> .  Ce n'est pas bon.  Mais pourquoi devriez-vous vous en soucier? <br><br>  Si vous d√©veloppez pour le Web aujourd'hui, n'√©crivez pas seulement du code.  Aujourd'hui, dans le d√©veloppement web, beaucoup de gens travaillent sur un seul site.  Vous pouvez √©galement utiliser beaucoup d'open source.  De plus, √† des fins de marketing, vous pouvez inclure plusieurs scripts tiers.  Des centaines de personnes fournissent du code ex√©cut√© sur votre site.  Et les d√©veloppeurs doivent travailler dans de telles r√©alit√©s. <br><br>  Peut-on faire confiance √† toutes ces personnes et √† tout le code source? <br><br>  Je ne pense pas qu'il faille faire confiance √† un code tiers.  Heureusement, il existe des moyens de prot√©ger votre site et de le rendre plus s√©curis√©.  De plus, des outils tels que le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">casque peuvent √™tre utiles, par exemple, pour des applications express</a> . <br><br>  <i>Si vous souhaitez analyser la quantit√© de code tiers ex√©cut√© sur votre site, vous pouvez regarder dans le panneau des d√©veloppeurs ou essayer de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">demander le g√©n√©rateur de carte.</a></i> <br><br><h2>  HTTPS et HSTS - assurez-vous que votre connexion est s√©curis√©e </h2><br>  Une connexion s√©curis√©e est le fondement d'un Internet s√©curis√©.  Sans demandes crypt√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-">passant par</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://developers.google.com/web/fundamentals/security/encrypt-in-transit/why-">HTTPS</a> , vous ne pouvez pas √™tre s√ªr qu'il n'y a personne d'autre entre votre site et les visiteurs.  Une personne peut rapidement mettre en place un r√©seau Wi-Fi public et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lancer une attaque d'homme au milieu contre</a> quiconque se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">connecte √† ce r√©seau</a> .  √Ä quelle fr√©quence utilisez-vous le Wi-Fi public?  De plus, √† quelle fr√©quence v√©rifiez-vous si elle est fiable? <br><br>  Heureusement, aujourd'hui, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les certificats TLS sont gratuits</a> ;  HTTPS est devenu la norme, et les navigateurs fournissent des fonctionnalit√©s avanc√©es uniquement pour les connexions s√©curis√©es, et m√™me marquent les sites Web non HTTPS comme dangereux, ce qui facilite la mise en ≈ìuvre de ce protocole.  Malheureusement, nous ne sommes pas toujours en s√©curit√© lorsque nous sommes sur Internet.  Quand quelqu'un veut ouvrir un site, il n'entre pas le protocole dans la barre d'adresse (et pourquoi le devrait-il?).  Il en r√©sulte une requ√™te HTTP non chiffr√©e.  Les sites en cours d'ex√©cution redirigent l'utilisateur vers HTTPS.  Mais que se passe-t-il si quelqu'un intercepte la premi√®re demande non s√©curis√©e? <br><br>  Vous pouvez utiliser les en-t√™tes de r√©ponse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HSTS</a> (HTTP Strict Transport Security) pour indiquer aux navigateurs que votre site ne fonctionne que via HTTPS. <br><br><pre> <code class="plaintext hljs">Strict-Transport-Security: max-age=1000; includeSubDomains; preload</code> </pre> <br>  Cet en-t√™te indique au navigateur que vous ne souhaitez pas utiliser les requ√™tes HTTP, puis il appliquera automatiquement les m√™mes requ√™tes √† la m√™me source avec une connexion s√©curis√©e.  Si vous essayez d'ouvrir la m√™me URL via HTTP, le navigateur utilisera √† nouveau HTTPS et redirigera l'utilisateur. <br><br>  Vous pouvez configurer la dur√©e pendant laquelle cette option doit rester active ( <code>max-age</code> en secondes) si vous souhaitez r√©utiliser HTTP plus tard.  Si vous souhaitez activer les sous-domaines, vous pouvez le configurer √† l'aide de <code>includeSubDomains</code> . <br><br>  Si vous souhaitez faire tout votre possible pour que le navigateur ne demande jamais votre site via HTTP, vous pouvez √©galement d√©finir le pointeur de <code>preload</code> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">envoyer votre site</a> √† la liste globale.  Si la configuration HSTS de votre site correspond √† l' <code>max-age</code> minimum minimum d'un an et est active pour les sous-domaines, elle peut √™tre incluse dans la liste de navigation interne pour les sites qui fonctionnent uniquement via HTTPS. <br><br>  Vous √™tes-vous d√©j√† demand√© pourquoi vous ne pouvez plus utiliser de variables d'environnement locales telles que <code>my-site.dev</code> dans votre navigateur via HTTP?  La raison en est pr√©cis√©ment dans cette liste interne - <code>.dev</code> automatiquement inclus dans cette liste, car en f√©vrier 2019, il est devenu un v√©ritable domaine de premier niveau. <br><br>  L'en-t√™te HSTS rend non seulement votre site un peu plus s√ªr, mais acc√©l√®re √©galement son travail.  Imaginez que quelqu'un acc√®de √† une connexion mobile lente.  Si la premi√®re demande a √©t√© effectu√©e via HTTP uniquement pour recevoir une redirection, l'utilisateur ne peut rien voir √† l'√©cran pendant plusieurs secondes.  Et avec HSTS, vous pouvez enregistrer ces secondes, et le navigateur utilisera automatiquement HTTPS. <br><br><h2>  CSP - indiquez clairement ce qui est autoris√© sur votre site </h2><br>  Maintenant que votre site fonctionne via une connexion s√©curis√©e, vous pouvez rencontrer un probl√®me lorsque les navigateurs commencent √† bloquer les demandes qui atteignent une adresse non s√©curis√©e en raison de politiques de contenu mixtes.  L'en-t√™te <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CSP (Content Security Policy)</a> offre un excellent moyen de g√©rer ces situations.  Vous pouvez d√©finir votre ensemble de r√®gles CSP √† l'aide de m√©ta-√©l√©ments dans le code HTML fourni ou via les en-t√™tes HTTP. <br><br><pre> <code class="plaintext hljs">Content-Security-Policy: upgrade-insecure-requests</code> </pre> <br>  Le pointeur de <code>upgrade-insecure-requests</code> oblige le navigateur √† convertir comme par magie toutes les requ√™tes HTTP en requ√™tes HTTPS. <br><br>  Cependant, CSP n'est pas limit√© au protocole utilis√©.  Il offre des moyens d√©taill√©s de d√©terminer quelles ressources et activit√©s sont autoris√©es sur votre site.  Vous pouvez, par exemple, sp√©cifier les scripts √† ex√©cuter ou o√π t√©l√©charger les images.  Si quelque chose n'est pas autoris√©, le navigateur bloque cette action et emp√™che les attaques potentielles sur votre site. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e57/f6a/ef6/e57f6aef63f9ad95c2954539290a7caa.jpg"><br><br>  Au moment d'√©crire ces lignes, il y avait 24 options de configuration diff√©rentes pour CSP.  Ils vont des scripts aux feuilles de style en passant par les techniciens de maintenance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/281/7f5/713/2817f571357c4b488bd6dbcbbdec6ef0.png"><br><br>  <i>Vous pouvez trouver la critique compl√®te sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MDN.</a></i> <br><br>  √Ä l'aide de CSP, vous pouvez sp√©cifier ce que votre site doit inclure et ce qui ne doit pas. <br><br><pre> <code class="plaintext hljs">Content-Security-Policy: default-src 'self'; script-src 'self' just-comments.com www.google-analytics.com production-assets.codepen.io storage.googleapis.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: images.contentful.com images.ctfassets.net www.gravatar.com www.google-analytics.com just-comments.com; font-src 'self' data:; connect-src 'self' cdn.contentful.com images.contentful.com videos.contentful.com images.ctfassets.net videos.ctfassets.net service.just-comments.com www.google-analytics.com; media-src 'self' videos.contentful.com videos.ctfassets.net; object-src 'self'; frame-src codepen.io; frame-ancestors 'self'; worker-src 'self'; block-all-mixed-content; manifest-src 'self' 'self'; disown-opener; prefetch-src 'self'</code> </pre> <br>  L'ensemble de r√®gles ci-dessus est pour mon site personnel, et si vous pensez que cet exemple de d√©finition CSP est tr√®s compliqu√©, alors vous avez absolument raison.  J'ai impl√©ment√© ce kit lors de ma troisi√®me tentative, d√©ployant et annulant √† nouveau, car il a cass√© le site plusieurs fois.  Mais il y a une meilleure fa√ßon. <br><br>  Pour √©viter de pirater votre site, CSP propose √©galement un mode de g√©n√©ration de rapports uniquement. <br><br><pre> <code class="plaintext hljs">Content-Security-Policy-Report-Only: default-src 'self'; ... report-uri https://stefanjudis.report-uri.com/r/d/csp/reportOnly</code> </pre> <br>  En utilisant le mode <code>Content-Security-Policy-Report-Only</code> , les navigateurs enregistrent simplement les ressources qui seraient bloqu√©es, au lieu de les bloquer.  Ce m√©canisme de rapport vous permet de v√©rifier et de configurer votre ensemble de r√®gles. <br><br>  Les deux en-t√™tes, <code>Content-Security-Policy</code> et <code>Content-Security-Policy-Report-Only</code> , offrent √©galement un moyen de d√©terminer le point de terminaison pour envoyer un <code>report-uri</code> violation et des informations de journalisation ( <code>report-uri</code> ).  Vous pouvez configurer le serveur de journaux et utiliser les informations de journal envoy√©es pour configurer les r√®gles CSP jusqu'√† ce qu'il soit pr√™t √† √™tre envoy√©. <br><br>  Le processus recommand√© est le suivant: ex√©cutez d'abord CSP en mode rapport, analysez les violations entrantes avec du trafic r√©el, et uniquement lorsqu'aucune violation de vos ressources contr√¥l√©es n'est d√©tect√©e, activez-la. <br><br>  <i>Si vous cherchez un service qui pourrait vous aider √† traiter avec ces magazines, je recommande l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">URI de rapport</a> , cela m'aide beaucoup.</i> <br><br><h2>  Impl√©mentation g√©n√©rale du CSP </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Aujourd'hui, les navigateurs prennent bien en charge le</a> CSP, mais malheureusement, peu de sites l'utilisent.  Pour voir combien de sites fournissent du contenu √† l'aide de CSP, j'ai envoy√© une demande √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://">HTTParchive</a> et constat√© que seulement 6% des sites consult√©s utilisent cette politique.  Je pense que nous pouvons rendre Internet plus s√ªr et prot√©ger nos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilisateurs</a> contre l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">extraction</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">involontaire de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">crypto-monnaies</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d4/e19/246/6d4e192464d326a3722530d617cbaf78.jpg"><br><br><h2>  Le r√©seau doit √™tre accessible. </h2><br>  Pendant que j'√©cris cet article, je suis assis devant le relativement nouveau MacBook en utilisant une connexion Wi-Fi domestique rapide.  Les d√©veloppeurs oublient souvent que cette situation n'est pas standard pour la plupart de nos utilisateurs.  Les personnes visitant nos sites utilisent de vieux t√©l√©phones et des connexions douteuses.  Les sites lourds et encombr√©s avec des centaines de requ√™tes leur laissent une mauvaise impression. <br><br>  Et ce n'est pas seulement une question d'impression.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les gens paient des montants diff√©rents pour le trafic en fonction de leur lieu de r√©sidence</a> .  Imaginez que vous cr√©ez un site Web pour un h√¥pital.  Les informations √† ce sujet peuvent √™tre cruciales et sauver des vies.  Si la page du site Web de l'h√¥pital a une taille de 5 Mo, elle fonctionnera non seulement lentement, mais peut √™tre trop ch√®re pour ceux qui en ont le plus besoin.  Le prix de cinq m√©gaoctets de trafic en Europe ou aux √âtats-Unis est n√©gligeable par rapport au prix en Afrique.  Les d√©veloppeurs sont responsables de rendre les pages Web accessibles √† tous.  Cette responsabilit√© consiste √† fournir les bonnes ressources, √† choisir les bons outils (avez-vous vraiment besoin d'un framework JS pour atterrir?) Et √† √©viter les demandes. <br><br><h2>  Cache-Control - √âvitez les demandes de ressources immuables </h2><br>  Aujourd'hui, un site peut contenir des centaines de ressources, du CSS aux scripts et aux images.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>  Cache-Control</code></a> , les d√©veloppeurs peuvent sp√©cifier la dur√©e pendant laquelle la ressource doit √™tre consid√©r√©e comme ¬´fra√Æche¬ª et peut √™tre renvoy√©e depuis le cache du navigateur. <br><br><pre> <code class="plaintext hljs">Cache-Control: max-age=30, public</code> </pre> <br>  Avec une configuration correcte de <code>Cache-Control</code> , le transfert de donn√©es est pr√©serv√© et les fichiers peuvent √™tre utilis√©s √† partir du cache du navigateur pendant un certain nombre de secondes ( <code>max-age</code> ).  Les navigateurs doivent rev√©rifier les ressources mises en cache apr√®s cette p√©riode. <br><br>  Cependant, si les visiteurs actualisent la page, les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">navigateurs la rev√©rifieront quand m√™me, y compris les liens vers les ressources</a> pour s'assurer que les donn√©es mises en cache sont toujours valides.  Les serveurs r√©pondent avec un en-t√™te 304, signalant que les donn√©es mises en cache sont toujours valides, ou un en-t√™te 200 lors de la transmission de donn√©es mises √† jour.  Cela vous permet d'enregistrer les donn√©es transf√©r√©es, mais pas n√©cessairement les demandes faites. <br><br>  C'est l√† que la fonction <code>immutable</code> entre en jeu. <br><br><h2>  Immuable - ne demandez jamais une ressource deux fois </h2><br>  Dans les applications frontales modernes, les fichiers CSS et script ont g√©n√©ralement des noms uniques, par exemple <code>styles.123abc.css</code> .  Le nom de ce fichier d√©pend du contenu.  Et lorsque vous modifiez le contenu des fichiers, leurs noms changent √©galement. <br><br>  Ces fichiers uniques pourraient potentiellement √™tre mis en cache pour toujours, y compris lorsqu'un utilisateur actualise une page.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code> immutable</code></a> peut emp√™cher le navigateur de rev√©rifier la ressource √† un intervalle de temps sp√©cifique.  Ceci est tr√®s important pour les objets avec des sommes de contr√¥le et permet d'√©viter les demandes de validation r√©p√©t√©es. <br><br><pre> <code class="plaintext hljs">Cache-Control: max-age=31536000, public, immutable</code> </pre> <br>  L'impl√©mentation d'une mise en cache optimale est tr√®s difficile, et en particulier la mise en cache du navigateur n'est pas tr√®s intuitive, car elle a diff√©rentes configurations.  Je vous recommande de lire les documents suivants: <br><br><ul><li>  Harry Roberts a √©crit un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">excellent guide pour g√©rer votre cache et ses param√®tres</a> . <br></li><li>  Jack Archibald a donn√© des conseils sur les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">meilleures techniques de mise en cache</a> avec des illustrations. <br></li><li>  Ilya Grigorik a propos√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/">excellent sch√©ma technologique pour la mise en cache des en-t√™tes</a> . <br></li></ul><br><h2>  Accept-Encoding - compression maximale (au minimum) </h2><br>  Avec l'aide du <code>Cache control</code> du <code>Cache control</code> nous pouvons enregistrer les demandes et r√©duire la quantit√© de donn√©es transmises √† plusieurs reprises sur le r√©seau.  Nous pouvons non seulement enregistrer les demandes, mais √©galement r√©duire ce qui est transmis. <br><br>  Donnant des ressources, les d√©veloppeurs doivent veiller √† envoyer le moins de donn√©es possible.  Pour les ressources de texte telles que HTML, CSS et JavaScript, la compression joue un r√¥le important dans la sauvegarde des donn√©es transf√©r√©es. <br><br>  La m√©thode de compression la plus populaire aujourd'hui est GZIP.  Les serveurs ont suffisamment de puissance pour compresser des fichiers texte √† la vol√©e et fournir des donn√©es compress√©es sur demande.  Mais GZIP n'est plus la meilleure option. <br><br>  Si vous examinez les demandes de fichiers texte g√©n√©r√©es par le navigateur, telles que HTML, CSS et JavaScript, et analysez les en-t√™tes, vous trouverez parmi eux un <code>accept-encoding</code> . <br><br><pre> <code class="plaintext hljs">Accept-Encoding: gzip, deflate, br</code> </pre> <br>  Cet en-t√™te indique au serveur les algorithmes de compression qu'il comprend.  Le param√®tre <code>br</code> peu connu, signifie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">compression Brotli</a> et est utilis√© sur les sites √† fort trafic tels que Google et Facebook.  Pour utiliser Brotli, votre site doit fonctionner via HTTPS. <br><br>  Cet algorithme de compression a √©t√© cr√©√© en tenant compte de la petite taille du fichier.  Si vous essayez de compresser le fichier manuellement sur votre appareil local, vous constaterez que Brotli se comprime vraiment mieux que GZIP. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d5/681/a2b/6d5681a2b412489aae991170e16428e8.jpg"><br><br>  Vous avez peut-√™tre entendu que la compression Brotli est plus lente.  La raison en est que Brotli a 11 modes de compression, et par d√©faut celui qui s√©lectionne les plus petits fichiers est obtenu, ce qui allonge la proc√©dure.  GZIP, d'autre part, dispose de 9 modes, et par d√©faut, un est s√©lectionn√© qui prend en compte √† la fois la vitesse de compression et la taille du fichier.  Par cons√©quent, le mode Brotli n'est pas adapt√© √† la compression √† la vol√©e par d√©faut, mais si vous changez le mode, vous pouvez compresser de petits fichiers √† la m√™me vitesse que GZIP.  Vous pouvez l'utiliser √† la vol√©e pour la compression et le consid√©rer comme un remplacement potentiel de GZIP pour les navigateurs pris en charge. <br><br>  De plus, si vous souhaitez enregistrer des fichiers autant que possible, vous pouvez oublier la compression dynamique et pr√©-g√©n√©rer des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fichiers GZIP optimis√©s en utilisant les fichiers zopfli</a> et Brotli pour leur maintenance statique. <br><br>  <i>Si vous souhaitez en savoir plus sur la compression Brotli et sa comparaison avec GZIP, les employ√©s d'Akamai ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">effectu√© des recherches approfondies sur ce sujet</a></i> . <br><br><h2>  Accepter et accepter-CH - Servir des ressources individuelles pour l'utilisateur </h2><br>  L'optimisation des ressources de texte est tr√®s importante pour √©conomiser des kilo-octets, mais qu'en est-il des ressources plus lourdes telles que les images pour enregistrer encore plus de donn√©es? <br><br><h4>  Accepter - maintenance des images au format correct </h4><br>  Les navigateurs nous montrent non seulement quels algorithmes de compression ils comprennent.  Lorsque le navigateur demande une image, il fournit √©galement des informations sur les formats de fichier qu'il comprend. <br><br><pre> <code class="plaintext hljs">Accept: image/webp, image/apng, image/*,*/*;q=0.8</code> </pre> <br>  Pendant plusieurs ann√©es, une lutte a √©t√© men√©e autour d'un nouveau format d'image, mais a remport√© le webp.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Webp est un format d'image invent√© par Google</a> , et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prise en charge de</a> ce format est d√©sormais tr√®s pertinente. <br><br>  En utilisant cet en-t√™te de demande, les d√©veloppeurs peuvent envoyer une image <code>webp</code> m√™me si le navigateur a demand√© <code>image.jpg</code> , ce qui entra√Æne une taille de fichier plus petite.  Dean Hume a √©crit un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bon guide</a> sur la fa√ßon de l'appliquer.  Tr√®s cool! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ef/ce2/077/9efce2077a81469bfaa8840b8bb07b26.jpg"><br><br><h4>  Accept-CH - Servir des images de la bonne taille </h4><br>  Vous pouvez √©galement activer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les invites client</a> pour les navigateurs prenant en charge cette fonctionnalit√©.  Les conseils client sont un moyen de dire aux navigateurs d'envoyer des informations suppl√©mentaires sur la largeur de la zone de visualisation, la largeur de l'image et m√™me les conditions du r√©seau, telles que RTT (heure de transmission et de confirmation) et le type de connexion, par exemple <code>2g</code> . <br><br>  Vous pouvez activer les conseils en ajoutant un m√©ta-√©l√©ment: <br><br><pre> <code class="plaintext hljs">&lt;meta http-equiv="Accept-CH" content="Viewport-Width, Downlink"&gt; &lt;meta http-equiv="Accept-CH-Lifetime" content="86400"&gt;</code> </pre> <br>  Ou en d√©finissant des en-t√™tes dans la requ√™te HTML d'origine: <br><br><pre> <code class="plaintext hljs">Accept-CH: Width, Viewport-Width Accept-CH-Lifetime: 100</code> </pre> <br>  Dans les demandes suivantes, les navigateurs commenceront √† envoyer des informations suppl√©mentaires pendant un certain temps ( <code>Accept-CH-Lifetime</code> en secondes), ce qui peut aider les d√©veloppeurs √† adapter les images aux conditions de l'utilisateur sans modifier le code HTML. <br><br>  Par exemple, pour plus d'informations, telles que la largeur de l'image c√¥t√© serveur, vous pouvez fournir √† vos images l'attribut <code>sizes</code> pour donner au navigateur des informations suppl√©mentaires sur l'apparence de ces images. <br><br><pre> <code class="plaintext hljs">&lt;!-- this images is laid over the full width | 100 viewport width --&gt; &lt;img class="w-100" src="/img/header.jpg" alt="" sizes="100vw"&gt;</code> </pre> <br>  Une fois l'en <code>Accept-CH</code> t√™te de r√©ponse <code>Accept-CH</code> re√ßu et les images avec l'attribut <code>sizes</code> , les navigateurs incluront les en <code>viewport-width</code> t√™tes <code>viewport-width</code> et <code>width</code> la <code>viewport-width</code> affichage dans les demandes d'image, vous indiquant l'image la mieux adapt√©e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec1/fa5/15f/ec1fa515f2eaddf32e3f1ba8e3d9576c.jpg"><br><br>  Ayant un format et une taille d'image pris en charge, vous pouvez envoyer des donn√©es adapt√©es sans avoir √† enregistrer des √©l√©ments d'image non fiables et faire attention uniquement au format et √† la taille du fichier, comme indiqu√© ci-dessous. <br><br><pre> <code class="plaintext hljs">&lt;pictur&gt; &lt;!-- serve WebP to Chrome, Edge, Firefox and Opera --&gt; &lt;source media="(min-width: 50em)" sizes="50vw" srcset="/image/thing-200.webp 200w, /image/thing-400.webp 400w, /image/thing-800.webp 800w, /image/thing-1200.webp 1200w, /image/thing-1600.webp 1600w, /image/thing-2000.webp 2000w" type="image/webp"&gt; &lt;source sizes="(min-width: 30em) 100vw" srcset="/image/thing-crop-200.webp 200w, /image/thing-crop-400.webp 400w, /image/thing-crop-800.webp 800w, /image/thing-crop-1200.webp 1200w, /image/thing-crop-1600.webp 1600w, /image/thing-crop-2000.webp 2000w" type="image/webp"&gt; &lt;!-- serve JPEG to others --&gt; &lt;surce media="(min-width: 50em)" sizes="50vw" srcset="/image/thing-200.jpg 200w, /image/thing-400.jpg 400w, /image/thing-800.jpg 800w, /image/thing-1200.jpg 1200w, /image/thing-1600.jpg 1600w, /image/thing-2000.jpg 2000w"&gt; &lt;surce sizes="(min-width: 30em) 100vw" srcset="/image/thing-crop-200.jpg 200w, /image/thing-crop-400.jpg 400w, /image/thing-crop-800.jpg 800w, /image/thing-crop-1200.jpg 1200w, /image/thing-crop-1600.jpg 1600w, /image/thing-crop-2000.jpg 2000w"&gt; &lt;!-- fallback for browsers that don't support picture --&gt; &lt;img src="/image/thing.jpg" width="50%"&gt; &lt;/pictur&gt;</code> </pre> <br>  Si vous avez acc√®s √† la largeur de la fen√™tre d'affichage et √† la taille de l'image, vous pouvez placer la logique de redimensionnement des ressources au premier plan sur vos serveurs. <br><br>  Cependant, gardez √† l'esprit que vous ne devez pas cr√©er d'images pour une largeur quelconque simplement parce que vous avez la largeur exacte de l'image.  L'envoi d'images pour une plage de taille sp√©cifique ( <code>image-200</code> , <code>image-300</code> , <code>...</code> ) permet d'utiliser la mise en cache CDN et √©conomise du temps de calcul. <br><br>  De plus, avec les technologies modernes telles que les travailleurs de service, vous pouvez m√™me intercepter et modifier les demandes directement dans le client pour servir les meilleurs fichiers image.  Les info-bulles client √©tant activ√©es, les techniciens de maintenance ont acc√®s aux informations de mise en page et, en combinaison avec l'API d'image, telle que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cloudinary,</a> vous pouvez configurer l'URL de l'image directement dans le navigateur pour recevoir des images de la bonne taille. <br><br>  <i>Si vous recherchez des informations plus d√©taill√©es sur les conseils des clients, vous pouvez lire des articles de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jeremy Wagner</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ilya Grigorik</a> sur ce sujet.</i> <br><br><h2>  Le r√©seau doit √™tre prudent </h2><br>  Puisque chacun de nous passe de nombreuses heures par jour sur le r√©seau, il y a le dernier aspect que je consid√®re tr√®s important - le r√©seau doit √™tre prudent. <br><br><h4>  Pr√©charge - r√©duire le temps d'attente </h4><br>  En tant que d√©veloppeurs, nous appr√©cions le temps de nos utilisateurs.  Personne ne veut perdre de temps.      ,           .      ,   ,        . <br><br>  :       ,     ,    .      ,    HTML      .               ,   ,     .          . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Rel=preload</a>       ,       . <br><br>      HTML-: <br><br><pre> <code class="plaintext hljs">&lt;link rel="preload" href="/font.woff2" as="font" type="font/woff2" crossorigin="anonymous"&gt;</code> </pre> <br>  : <br><br><pre> <code class="plaintext hljs">Link: &lt;/font.woff2&gt;; rel=preload; as=font; no-push</code> </pre> <br>  ,       ,    ,      ,  .      . <br><br>                : <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>     ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>   . <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>    preload   ,   prefetch  preconnect. <br></li></ul><br><h4> Feature-Policy ‚Äî    </h4><br>      ,      .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>   . <br><br> <i>     </i> .         ,  .        .      ,      ,     ‚Äî  . <br><br>  ,         ,          ?  ,       ? <br><br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> Feature-Policy.      ,   ,       ,      ,    . <br><br><pre> <code class="plaintext hljs">Feature-Policy: vibrate 'none'; geolocation 'none'</code> </pre> <br>          .        , ,  ,         . <br><br><pre> <code class="plaintext hljs">&lt;iframe allow="camera 'none'; microphone 'none'"&gt;</code> </pre> <br>      <code>Feature-Policy</code> , , ,       .                ,     .      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa8/ada/e56/fa8adae56924a72210fc2009641eb8cb.jpg"><br><br> <i>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MDN.</a></i> <br><br>    ,        ‚Äî push-. ,   <code>Feature-Policy</code>  push- ,  .     ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub.</a> <br><br>  feature policy   ,           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> , ,  ,      . <br><br><h2>      </h2><br>         ,      .          ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´HTTP- ‚Äî  ¬ª</a> . <br><br>  ,      ‚Äî   .    , , ,  ‚Ä¶     . ,      ,     ,       -,      ,    -    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450816/">https://habr.com/ru/post/fr450816/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450804/index.html">L'impression 3D de m√©taux dans l'industrie automobile: commencez petit</a></li>
<li><a href="../fr450806/index.html">Lorsqu'une variable d'environnement acc√©l√®re le processus de 40 fois</a></li>
<li><a href="../fr450810/index.html">7 meilleures fa√ßons de v√©rifier rapidement les comp√©tences des informaticiens avant l'entretien</a></li>
<li><a href="../fr450812/index.html">PSR-14 - l'√©v√©nement principal en PHP</a></li>
<li><a href="../fr450814/index.html">Comment BGP fonctionne</a></li>
<li><a href="../fr450818/index.html">De la latence Ceph √©lev√©e au patch du noyau avec eBPF / BCC</a></li>
<li><a href="../fr450820/index.html">Comit√© du programme FrontendConf: cadres, horizons, exp√©rience mondiale et mission de la conf√©rence</a></li>
<li><a href="../fr450822/index.html">Cadres en voie de disparition</a></li>
<li><a href="../fr450824/index.html">L'√©tat du CSS</a></li>
<li><a href="../fr450826/index.html">Comment parler avec le microcontr√¥leur de JS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>