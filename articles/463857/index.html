<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèµÔ∏è ‚õé üôéüèæ Julia: tipos personalizados ‚õ∑Ô∏è üëæ üëÇüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, consideraremos agregar un tipo de datos personalizado al programa Julia y sobrecargar las funciones est√°ndar para un trabajo conveni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Julia: tipos personalizados</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463857/"><p>  En este art√≠culo, consideraremos agregar un tipo de datos personalizado al programa Julia y sobrecargar las funciones est√°ndar para un trabajo conveniente con el nuevo tipo. </p><a name="habracut"></a><br><h2 id="chto-takoe-polzovatelskiy-tip">  ¬øQu√© es un tipo personalizado? </h2><br><p>  Un terrible secreto: la frontera entre los tipos de datos "usuario" y "incorporado" en Julia est√° pr√°cticamente ausente.  En cualquier programa de Julia, puede definir sus propios tipos de datos, y trabajar con ellos casi no es diferente de trabajar con los datos integrados, ya sea en t√©rminos de escritura de c√≥digo o en t√©rminos de velocidad de ejecuci√≥n de este c√≥digo (hola, Python).  Los tipos de datos de entrada pueden ser primitivos o compuestos.  Estos √∫ltimos tambi√©n se dividen en tipos abstractos y concretos. </p><br><p>  Adem√°s consideraremos un ejemplo de tipos de concreto compuesto, ya que  Los objetos espec√≠ficos en la memoria son tipos espec√≠ficos, y los objetos abstractos solo se necesitan para construir una jerarqu√≠a. </p><br><p> Los tipos compuestos est√°n definidos por las palabras clave <code>struct</code> y <code>mutable struct</code> .  En el primer caso, se crea un tipo inmutable: </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment">#    x  y struct Point x y end</span></span></code> </pre> <br><p>  Los objetos de tipo <code>Point</code> inmutables, es decir  El valor del campo en el objeto una vez creado no se puede cambiar. </p><br><pre> <code class="julia hljs">julia&gt; p = Point(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) Point(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) julia&gt; px <span class="hljs-number"><span class="hljs-number">2</span></span> julia&gt; py <span class="hljs-number"><span class="hljs-number">3</span></span> julia&gt; px = <span class="hljs-number"><span class="hljs-number">4</span></span> ERROR: setfield! <span class="hljs-keyword"><span class="hljs-keyword">immutable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> of <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Point cannot be changed</code> </pre> <br><p>  Pero puedes hacer un tipo mutable: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">mutable struct</span></span> MutablePoint x y <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> julia&gt; mp = MutablePoint(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) MutablePoint(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) julia&gt; mp.y = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> julia&gt; mp MutablePoint(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br><p>  Para mayor eficiencia, se pueden agregar anotaciones de tipo a los campos de estructura y a la estructura misma.  Por ejemplo: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> ParametricPoint{T&lt;:<span class="hljs-built_in"><span class="hljs-built_in">Real</span></span>} x::T y::T <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Esto significa que el tipo <code>ParametricPoint</code> parametrizado por el tipo <code>T</code> y que los campos <code>x</code> e <code>y</code> ahora deber√≠an ser valores del mismo tipo <code>T</code>  El comportamiento ser√° el siguiente: </p><br><pre> <code class="julia hljs">julia&gt; ParametricPoint(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) ParametricPoint{<span class="hljs-built_in"><span class="hljs-built_in">Int64</span></span>}(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) julia&gt; ParametricPoint{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>}(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) ParametricPoint{<span class="hljs-built_in"><span class="hljs-built_in">Float64</span></span>}(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) julia&gt; ParametricPoint{<span class="hljs-built_in"><span class="hljs-built_in">Rational</span></span>}(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) ParametricPoint{<span class="hljs-built_in"><span class="hljs-built_in">Rational</span></span>}(<span class="hljs-number"><span class="hljs-number">1</span></span>//<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>//<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># :        T julia&gt; ParametricPoint{Int}(1, 3.4) ERROR: InexactError: Int64(3.4) # :    julia&gt; ParametricPoint(1, 1.0) ERROR: MethodError: no method matching Point(::Int64, ::Float64) # :  T      julia&gt; ParametricPoint{Any}(1,1) ERROR: TypeError: in Point, in T, expected T&lt;:Real, got Type{Any}</span></span></code> </pre> <br><p>  A continuaci√≥n, veamos un ejemplo un poco m√°s complejo de un tipo de contenedor para ver qu√© m√©todos hay en la biblioteca est√°ndar para trabajar con dichos tipos. </p><br><h2 id="dvustoronnyaya-ochered">  Cola de dos v√≠as </h2><br><p>  Haremos una cola bidireccional a partir de nodos del tipo <code>DequeNode</code> , que incluir√° un registro de datos y enlaces a los elementos anteriores y siguientes de la cola.  El tipo <code>DequeNode</code> debe ser mutable, porque  los enlaces deber√°n reescribirse. </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">mutable struct</span></span> DequeNode{T} data::T prev::DequeNode{T} next::DequeNode{T} <span class="hljs-comment"><span class="hljs-comment">#   -       function DequeNode{T}() where T node = new{T}() node.prev = node.next = node return node end #     function DequeNode{T}(x) where T node = new{T}() node.data = x node.prev = node.next = node return node end end</span></span></code> </pre> <br><p>  En este caso, se necesitan constructores internos, porque de forma predeterminada, al construir un objeto, debe pasar los valores de todos los campos con argumentos.  Dado que el tipo es autoreferenciado, ser√≠a imposible para un constructor est√°ndar crear el primer objeto de este tipo.  Por lo tanto, creamos constructores especiales que crean un nodo de cola que se refiere a s√≠ mismo. </p><br><p>  La cola en s√≠ misma puede representarse como un nodo de "entrada" ficticio que no contiene ning√∫n dato.  Su <code>next</code> enlace apuntar√° al primer elemento de la cola y <code>prev</code> al √∫ltimo.  Para una cola vac√≠a, ambos enlaces apuntan al nodo de entrada.  Dicha organizaci√≥n simplifica los procedimientos para agregar y eliminar nodos. </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> Deque{T} entry::DequeNode{T} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Deque{T}() <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T = Deque{T}(DequeNode{T}()) Deque() = Deque{<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span>}()</code> </pre> <br><p>  Ya no se necesita un constructor interno para la estructura de la cola misma. </p><br><h3 id="dobavlenie-elementov">  Agregar elementos </h3><br><p>  Los procedimientos est√°ndar para una cola son agregar un elemento al principio y al final, y extraer elementos del principio y del final.  Para estos procedimientos, la biblioteca est√°ndar ya tiene funciones a las que solo necesita agregar m√©todos para trabajar con otro tipo: </p><br><ul><li>  <code>push!(collection, element)</code> : agrega un elemento a la colecci√≥n (para una colecci√≥n ordenada, al final) </li><li>  <code>pushfirst!(collection, element)</code> : agrega un elemento al comienzo de una colecci√≥n ordenada </li><li>  <code>pop!(collection)</code> : elimina un elemento de la colecci√≥n (para una colecci√≥n ordenada, desde el final) </li><li>  <code>popfirst!(collection)</code> : elimina el primer elemento de una colecci√≥n ordenada </li></ul><br><p>  Todas estas funciones est√°n en el m√≥dulo <code>Base</code> , y debe agregarle nuevos m√©todos.  Adem√°s, escribiremos una funci√≥n para verificar si la colecci√≥n no est√° vac√≠a: <code>Base.isempty(collection)</code> . </p><br><pre> <code class="julia hljs">Base.isempty(deq::Deque) = deq.entry.prev ‚â° deq.entry <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.push!(deq::Deque{T}, elt) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T tail = deq.entry.prev new_item = DequeNode{T}(elt) new_item.prev, new_item.next = tail, deq.entry tail.next = deq.entry.prev = new_item <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deq <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.pushfirst!(deq::Deque{T}, elt) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T head = deq.entry.next new_item = DequeNode{T}(elt) new_item.prev, new_item.next = deq.entry, head head.prev = deq.entry.next = new_item <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deq <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.pop!(deq::Deque) !isempty(deq) || throw(<span class="hljs-built_in"><span class="hljs-built_in">ArgumentError</span></span>(<span class="hljs-string"><span class="hljs-string">"deque must be non-empty"</span></span>)) last = deq.entry.prev last.prev.next = deq.entry deq.entry.prev = last.prev <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> last.data <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.popfirst!(deq::Deque) !isempty(deq) || throw(<span class="hljs-built_in"><span class="hljs-built_in">ArgumentError</span></span>(<span class="hljs-string"><span class="hljs-string">"deque must be non-empty"</span></span>)) first = deq.entry.next first.next.prev = deq.entry deq.entry.next = first.next <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first.data <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  La funci√≥n <code>push!()</code> Hace que sea casi trivial escribir un constructor de colas basado en una colecci√≥n arbitraria: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Deque(itr) d = Deque{eltype(itr)}() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> elt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> itr push!(d, elt) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">#        Deque(args...) = Deque(args)</span></span></code> </pre> <br><p>  Ahora el nuevo tipo casi se puede usar como una cola, si solo necesitamos agregar y quitar operaciones y no necesitamos una funci√≥n como <code>peek()</code> (mira el elemento en la cabecera o cola de la cola sin extraerlo).  Para el acceso no destructivo a los elementos, es conveniente definir la funci√≥n de iteraci√≥n sobre el contenedor. </p><br><h3 id="iterirovanie">  Iteraci√≥n </h3><br><p>  Julia admite el concepto de iteradores para atravesar elementos contenedores.  Para la iteraci√≥n, debe definir una sola funci√≥n: <code>iterate(container, state)</code> , donde el <code>state</code> determina el estado actual del iterador.  En particular, la construcci√≥n <code>for x in collection</code> es az√∫car sint√°ctico para algo como esto: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> nextstate = iterate(collection) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> nextstate ‚â¢ <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> (x, state) = nextstate &lt;- &gt; nextstate = iterate(collection, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  La funci√≥n <code>iterate()</code> toma un contenedor y un "estado iterador" como argumento, y devuelve una tupla del elemento contenedor y el siguiente estado iterador, o <code>nothing</code> si el contenedor ha finalizado. <br>  Para una cola, es l√≥gico tomar el nodo de la cola, que la iteraci√≥n ha alcanzado, como el "estado": </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.iterate(deq::Deque{T}, state::DequeNode{T}=deq.entry) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T nextstate = state.next nextstate ‚â° deq.entry ? <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> : (nextstate.data, nextstate) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Ahora los elementos de la cola se pueden ordenar con un bucle <code>for</code> : </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Deque(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>) println(x); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  Una gran ventaja es que muchas de las funciones de la biblioteca est√°ndar de Julia se escriben utilizando interfaces generalizadas, en particular, la iteraci√≥n.  Por lo tanto, la comprobaci√≥n autom√°tica de si un elemento pertenece a un contenedor se determina autom√°ticamente: </p><br><pre> <code class="julia hljs">julia&gt; <span class="hljs-number"><span class="hljs-number">5</span></span> ‚àà Deque(<span class="hljs-number"><span class="hljs-number">3</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-literal"><span class="hljs-literal">true</span></span> julia&gt; <span class="hljs-number"><span class="hljs-number">100</span></span> ‚àà Deque(-<span class="hljs-number"><span class="hljs-number">5</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Tambi√©n encontramos que el m√©todo <code>first()</code> , que devuelve el primer elemento de la colecci√≥n, comenz√≥ a funcionar.  Para completar la imagen, complementamos el m√©todo <code>last()</code> para obtener el √∫ltimo elemento e iterar en el orden inverso: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.iterate(r::Base.Iterators.Reverse{Deque{T}}, state::DequeNode{T}=r.itr.entry) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T nextstate = state.prev nextstate ‚â° r.itr.entry ? <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> : (nextstate.data, nextstate) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.last(deq::Deque) isempty(deq) &amp;&amp; throw(<span class="hljs-built_in"><span class="hljs-built_in">ArgumentError</span></span>(<span class="hljs-string"><span class="hljs-string">"deque must be non-empty"</span></span>)) deq.entry.prev.data <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> julia&gt; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Iterators.reverse(Deque(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>)) println(x); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Entonces, la interfaz de la cola como estructura de datos ahora est√° completamente definida </p><br><div class="scrollable-table"><table><thead><tr><th>  Operaci√≥n </th><th>  Nombre de la funci√≥n </th></tr></thead><tbody><tr><td>  insertar al final </td><td> <code>push!(deque, element)</code> </td> </tr><tr><td>  inserci√≥n al principio </td><td> <code>pushfirst!(deque, element)</code> </td> </tr><tr><td>  eliminaci√≥n desde el principio </td><td>  <code>popfirst!(deque)</code> (devuelve el elemento eliminado) </td></tr><tr><td>  eliminaci√≥n del final </td><td>  <code>pop!(deque)</code> (devuelve el elemento eliminado) </td></tr><tr><td>  ver el primer elemento </td><td> <code>first(deque)</code> </td> </tr><tr><td>  ver el √∫ltimo art√≠culo </td><td> <code>last(deque)</code> </td> </tr></tbody></table></div><br><h3 id="raspechatka-struktury">  Estructura de impresi√≥n </h3><br><p>  Aunque la cola funciona completamente como una estructura de datos, en la impresi√≥n todav√≠a representa un desastre sin forma: </p><br><pre> <code class="julia hljs">julia&gt; Deque() Deque{<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span>}(DequeNode{<span class="hljs-built_in"><span class="hljs-built_in">Any</span></span>}(<span class="hljs-comment"><span class="hljs-comment">#undef, DequeNode{Any}(#= circular reference @-1 =#), DequeNode{Any}(#= circular reference @-1 =#)))</span></span></code> </pre> <br><p>  Agregue un m√©todo para imprimir la cola en una forma m√°s humana.  La salida de la estructura al terminal est√° controlada por la funci√≥n <code>Base.show()</code> , que sobrecargaremos: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.show(io::<span class="hljs-built_in"><span class="hljs-built_in">IO</span></span>, deq::Deque{T}) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T print(io, <span class="hljs-string"><span class="hljs-string">"Deque{"</span></span>, T, <span class="hljs-string"><span class="hljs-string">"}("</span></span>) next = iterate(deq) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> next ‚â¢ <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> item, state = next show(io, item) next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> next ‚â¢ <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> item, state = next print(io, <span class="hljs-string"><span class="hljs-string">", "</span></span>) show(io, item) next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> print(io, <span class="hljs-string"><span class="hljs-string">")"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">#        julia&gt; Deque(1:5) Deque{Int64}(1, 2, 3, 4, 5) #       julia&gt; Deque(Deque(), Deque(), Deque()) Deque{Deque{Any}}(Deque{Any}(), Deque{Any}(), Deque{Any}())</span></span></code> </pre> <br><h3 id="dostup-i-izmenenie-po-indeksu">  Acceso y cambio por √≠ndice </h3><br><p>  En principio, una cola tambi√©n se puede utilizar como contenedor con acceso por √≠ndice.  Las <code>getindex()</code> y <code>setindex!()</code> Controlan la recuperaci√≥n y el cambio de un valor por √≠ndice.  Implementamos los m√©todos necesarios para la cola. </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.getindex(deq::Deque, i::<span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>) i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) next = iterate(deq) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:i-<span class="hljs-number"><span class="hljs-number">1</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> &amp;&amp; throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) _, state = next next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.setindex!(deq::Deque, val, i::<span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>) i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) next = iterate(deq) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:i-<span class="hljs-number"><span class="hljs-number">1</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> &amp;&amp; throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) _, state = next next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> record = next[<span class="hljs-number"><span class="hljs-number">2</span></span>] record.data = val <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> val <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  ¬°Tambi√©n es √∫til agregar la funci√≥n de insertar un elemento en un lugar arbitrario <code>insert!()</code> Y eliminar un elemento de una posici√≥n arbitraria: </p><br><pre> <code class="julia hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.insert!(deq::Deque{T}, i::<span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>, val) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> T i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) next = iterate(deq) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:i-<span class="hljs-number"><span class="hljs-number">1</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> &amp;&amp; throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) _, state = next next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> push!(deq, val) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> record = next[<span class="hljs-number"><span class="hljs-number">2</span></span>] new_node = DequeNode{T}(val) new_node.prev, new_node.next = record.prev, record record.prev = record.prev.next = new_node deq <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> Base.deleteat!(deq::Deque, i::<span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span>) i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) next = iterate(deq) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:i-<span class="hljs-number"><span class="hljs-number">1</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> &amp;&amp; throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) _, state = next next = iterate(deq, state) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> next ‚â° <span class="hljs-literal"><span class="hljs-literal">nothing</span></span> throw(<span class="hljs-built_in"><span class="hljs-built_in">BoundsError</span></span>(deq, i)) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> record = next[<span class="hljs-number"><span class="hljs-number">2</span></span>] record.prev.next, record.next.prev = record.next, record.prev <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><h3 id="prochee">  Otros </h3><br><p>  Como ya se mencion√≥, una serie de funciones de la biblioteca est√°ndar se escriben utilizando iteradores, lo que les permite trabajar autom√°ticamente con cualquier tipo para el que se define la funci√≥n <code>iterate()</code> .  En particular, las funciones como <code>map()</code> , <code>collect()</code> y m√©todos de reducci√≥n como <code>sum()</code> o <code>minimum()</code> . <br>  Por ejemplo, una funci√≥n para encontrar la longitud de una cola se puede escribir como </p><br><pre> <code class="julia hljs">Base.length(deq::Deque) = sum(x-&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>, deq) julia&gt; length(Deque(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>)) <span class="hljs-number"><span class="hljs-number">7</span></span></code> </pre> <br><h3 id="zaklyuchenie">  Conclusi√≥n </h3><br><p>  Como puede ver, crear su propio tipo de datos en Julia y organizar un trabajo conveniente con √©l es muy simple.  Debido al uso de programaci√≥n generalizada en la biblioteca est√°ndar, generalmente es suficiente definir varias funciones b√°sicas, y varias dependientes funcionar√°n autom√°ticamente.  Entonces, al definir <code>push!(container, element)</code> para agregar un solo elemento, puede encontrar que <code>push!(container, elements...)</code> funcionar√° para agregar un n√∫mero arbitrario de argumentos.  Una vez definido un iterador, en general obtenemos autom√°ticamente todas las funciones de la biblioteca est√°ndar para trabajar con un contenedor abstracto. </p><br><p>  ¬°Feliz pirateo! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/463857/">https://habr.com/ru/post/463857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../463847/index.html">A qu√© va la pereza o c√≥mo llegar a escribir un analizador de psd y qu√© puede resultar de ello</a></li>
<li><a href="../463849/index.html">Lectura de fin de semana: 65 art√≠culos sobre streaming, la historia del viejo "hierro musical" y la tecnolog√≠a de audio</a></li>
<li><a href="../463851/index.html">¬øC√≥mo viven las estad√≠sticas del servidor de Internet y el nombre de dominio en casa?</a></li>
<li><a href="../463853/index.html">C√≥mo pirate√© Qiwi sin conocimiento de programaci√≥n</a></li>
<li><a href="../463855/index.html">Neuralink como un medio para ayudar a las personas paralizadas y una herramienta para combatir la IA malvada</a></li>
<li><a href="../463859/index.html">No te metas con NULL</a></li>
<li><a href="../463861/index.html">¬øPor qu√© ir al Festival 404 este a√±o? Ocho razones</a></li>
<li><a href="../463871/index.html">¬øCu√°les son los tipos de ceremonias Scrum y sus mejores pr√°cticas?</a></li>
<li><a href="../463873/index.html">Fallecido Premio Nobel Carey Mullis - Inventor de la reacci√≥n en cadena de la ADN polimerasa</a></li>
<li><a href="../463875/index.html">Intel Ice Lake. 10 nm - a las masas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>