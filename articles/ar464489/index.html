<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ โ๏ธ Buildbot ูู ุงูุฃูุซูุฉ ๐ธ ๐ท๏ธ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุช ุจุญุงุฌุฉ ูุฅุนุฏุงุฏ ุนูููุฉ ุชุฌููุน ูุชูุฏูู ุญุฒู ุงูุจุฑุงูุฌ ูู ูุณุชูุฏุน Git ุฅูู ุงููููุน. ูุจุนุฏ ุฃู ุฑุฃูุช ุ ููุฐ ููุช ููุณ ุจุจุนูุฏ ุ ููุง ุนูู Habr ุ ุงูููุงูุฉ ุนู buildbot (ุงูุฑุงุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Buildbot ูู ุงูุฃูุซูุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464489/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ููุช ุจุญุงุฌุฉ ูุฅุนุฏุงุฏ ุนูููุฉ ุชุฌููุน ูุชูุฏูู ุญุฒู ุงูุจุฑุงูุฌ ูู ูุณุชูุฏุน Git ุฅูู ุงููููุน.  ูุจุนุฏ ุฃู ุฑุฃูุช ุ ููุฐ ููุช ููุณ ุจุจุนูุฏ ุ ููุง ุนูู Habr ุ ุงูููุงูุฉ ุนู buildbot (ุงูุฑุงุจุท ูู ุงูููุงูุฉ) ูุฑุฑุช ุชุฌุฑุจุชูุง ูุงูุชูุฏู ุจุทูุจ ูุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู buildbot ูู ูุธุงู ููุฒุน ุ ูุณูููู ูู ุงูููุทูู ููู ููุฏุณุฉ ููุธุงู ุชุดุบูู ุฅูุดุงุก ูุถูู ุชุฌููุน ูููุตู.  ูู ุญุงูุชูุง ุ ุณุชููู ูุฐู ุญุงููุงุช LXC (ูู ุญุงูุฉ ูุธุงู ุงูุชุดุบูู linux) ู qemu (ูู ุญุงูุฉ ุงูุฅุทุงุฑุงุช): </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  vm-srv-build1 - centos 7 ุ ุณูููู ููุงู ุณูุฏ buildbot ููุงุญุฏ ูู ุงูุนูุงู </li><li style=";text-align:right;direction:rtl">  vm-srv-build2 - ุฏุจูุงู 10 ุ ูุจูุงุก ุญุฒู DEB </li><li style=";text-align:right;direction:rtl">  vm-srv-build3 - windows 10 ุ ููุชุฌููุน ุ ุฃูุช ููุณู ุชููู ูุง </li></ul><br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุฌูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Rac GUI</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฌูุฉ</a> ุฑุณูููุฉ ูู 1C rac ูุฅุฏุงุฑุฉ ูุฌููุนุฉ ูู ุงูุฎูุงุฏู.  ุถูู Linux ุ ุณูุชู ุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช ุงูููุงุณูุฉ ููู ูุธุงู ุชุดุบูู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชู</a> ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">freewrap</a> ูุฅูุดุงุก ููู exe ููููุงูุฐ ูู ุจุฑูุงูุฌ ูุตู tcl. </p><a name="habracut"></a><br><h3 id="ustanovka" style=";text-align:right;direction:rtl">  ุชุฑููุจ </h3><br><h4 id="gnulinux" style=";text-align:right;direction:rtl">  ุฌูู / ููููุณ </h4><br><p style=";text-align:right;direction:rtl">  ููุชุซุจูุช ุ ุงููุซุงุฆู ุนูู ุงูุดุจูุฉ ุชููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">1</a> ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">2</a> .  ููุง ูุณุจุจ ุฃู ูุดุงูู ุฎุงุตุฉ: <br>  ููุณูุฏ: </p><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">pip3 install buildbot pip3 install twisted pip3 install autobahn pip3 install pysqlite3 pip3 install sqlalchemy sqlalchemy-migrate pip3 install buildbot-www buildbot-grid-view buildbot-console-view buildbot-waterfall-view pip3 install python-dateutil</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู "ุงูุนูุงู" ุ ูุฐุง ูููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">pip3 install buildbot-worker</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงูุทุจุน ุ ุณูููู ูู ุงูุฃุตุญ ุฌูุน ุงูุญุฒู ููู ูุธุงู ุชุดุบูู ุ ูููู ูุฐุง ูุชุฌุงูุฒ ูุทุงู ุงูููุงูุฉ.  ููุฏ ุฃุบูููุง ุฃูุถูุง ูุตู ุชูููู ุงูุญุงููุงุช ููุนูู ุ ูุฃูุงุญุธ ููุท ุฃููู ุฃุณุชุฎุฏู ProxMox VE.  ูุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุชุซุจูุช ุงูุญุฒู ููู ูุญูุฑ ูุทููุจ ููุชุฌููุน (centos: rpmdevtools ุ ููุง ุฅูู ุฐูู ุ ุฏุจูุงู: ุฃุณุงุณูุงุช ุงูุจูุงุก ุ ู dh-make ุ ู pbuilder ุ ููุง ุฅูู ุฐูู) </p><br><p style=";text-align:right;direction:rtl">  ุณูุชู ุฅุทูุงู ุฎุฏูุงุช ุชุฌููุน ุงููุดุฑูุน ู buildbot ููุงุจุฉ ุนู ูุณุชุฎุฏู ุบูุฑ ูุญุชุฑู ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุฅูุดุงุฆู ุนูู ุฌููุน ุงููุถูููู ุงููุดุงุฑููู ูู ุงูุนูููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">adduser buildbot</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูู ุจุชููุฆุฉ ุงูุชุดุบูู ุงูุชููุงุฆู ููุฎุฏูุงุช ุ ุนูู ุงูุชูุงูู ุ ุนูู ูู ูู ุงููุถูููู (ุงูุญุงููุงุช): </p><br><p style=";text-align:right;direction:rtl">  ูุญุฏุฉ Systemd ูุชุดุบูู ุงููุนุงูุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">touch /etc/systemd/buildbot-master.service [Unit] Description=BuildBot master service After=network.target [Service] User=buildbot Group=buildbot WorkingDirectory=/home/buildbot/master ExecStart=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/buildbot start --nodaemon ExecReload=/bin/<span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> -HUP <span class="hljs-variable"><span class="hljs-variable">$MAINPID</span></span> [Install] WantedBy=multi-user.target</code> </pre> <br><p style=";text-align:right;direction:rtl">  ู "ุงูุนุงูู" </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">touch /etc/systemd/buildbot-worker.service [Unit] Description=BuildBot worker service After=network.target [Service]master User=buildbot Group=buildbot WorkingDirectory=/home/buildbot/worker ExecStart=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/buildbot-worker start --nodaemon [Install] WantedBy=buildbot-master.service</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ุฌููุน ุงูุจุฑุงูุฌ ุงููุตูุฉ (ูู ุญุงูุชูุง) ููุฌูุฏุฉ ูู / usr / local / ุ ูุฌุจ ุนููู ูุชุงุจุฉ ุงููุณุงุฑ ุฅูููุง ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">nano /root/.bash_profile PATH=<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span>:<span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/bin:/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ููููู ุฅูุดุงุก ุจููุฉ ุชุญุชูุฉ ููุฏููู ูู "ุงูุนูุงู" (ุนูู ุฌููุน ุงููุถูููู) ุ ููุฐุง ุ ูู ุจุงูุชุณุฌูู ุชุญุช ูุณุชุฎุฏู buildbot ูุชูููุฐ ุงูุฃูุงูุฑ ุงูุชุงููุฉ: </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุงููุถูู ุงูุฃูู ุ vm-srv-build1: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su - buildbot mkdir /home/buildbot/worker <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ buildbot-worker create-worker --<span class="hljs-built_in"><span class="hljs-built_in">umask</span></span>=0o22 --keepalive=60 worker vm-srv-build1:4000 CentOS 123456</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุงููุถูู ุงูุซุงูู ุ vm-srv-build2: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su - buildbot mkdir /home/buildbot/worker <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ buildbot-worker create-worker --<span class="hljs-built_in"><span class="hljs-built_in">umask</span></span>=0o22 --keepalive=60 worker vm-srv-build1:4000 Debian-10 123456</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุงููุถูููู ุงูุนุงูููู ุ ูููู ุจุฏุก ุชุดุบูู ุฎุฏูุฉ buildbot-worker </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl start buildbot-worker</code> </pre> <br><h4 id="ms-windows" style=";text-align:right;direction:rtl">  ูุงููุฑูุณููุช ูููุฏูุฒ </h4><br><p style=";text-align:right;direction:rtl">  ูุฅูุดุงุก "ุงูุนูู" ููููุงูุฐ ุ ุณูุชู ุงุณุชุฎุฏุงู ุฌูุงุฒ ุงูุธุงูุฑู ูุน ุฃุญุฏุซ ุฅุตุฏุงุฑ Win10. <br>  ููุนูู ุงูุฐู ุชุญุชุงุฌู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุซุนุจุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PyWIN</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุงุจุฉ</a> </li><li style=";text-align:right;direction:rtl">  ูุชุซุจูุช ุฌููุน ุฃููุงุน ุงูุฃุดูุงุก ุงููุฎุชููุฉ ูู ุจูุซูู ุ ููุช ุจุญุงุฌุฉ ูุชูุฒูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Build Tools ูู Visual Studio 2019</a> </li><li style=";text-align:right;direction:rtl">  7ZIP </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุชุซุจูุช ูู ูุง ุณุจู ุ ููููู ุชุซุจูุช buildbot ููุณู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">pip install buildbot-worker</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฏููู ุงูุนูู </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">md c:\worker</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงูุฑูุถ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">buildbot-worker start c:\worker</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ูู ุดูุก ูุนูู (ุฑุงุฌุน ุณุฌู c: \ worker \ twistd.log) ุ ูููููู ุชุณุฌูู "ุงูุนุงูู" ุงูุฎุงุต ุจูุง ูุฎุฏูุฉ ุนู ุทุฑูู ุฅุถุงูุฉ ุนูุตุฑ ูู ุฏููู ุงูุนูู ุฅูู ุงูุณุฌู (ูุชู ุชูููุฐ ุงูุฃูุงูุฑ ูู ุจูููุฑุดูู ูุนูู ููุณุคูู): </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">buildbot_worker_windows_service.exe --user VM-SRV-BUILD3\buildbot --password 123456 --startup auto install New-ItemProperty -path Registry::HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\BuildBot\Parameters -Name directories -PropertyType String -Value c:\worker</code> </pre><br><p style=";text-align:right;direction:rtl">  ูููููู ุชุดุบูู ุฎุงุฏู </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Start-Service buildbot</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ุดูุก ูุน "ุงูุนูุงู" ุ ุซู ูู ุชุถุทุฑ ุฅูู ููุณูู ุจุนุฏ ุงูุขู ุ ููู ุงูุฅุฏุงุฑุฉ ุชูุชูู ูู ุงููุนูู. </p><br><h3 id="nastroyka-mastera" style=";text-align:right;direction:rtl">  ูุนุงูุฌ ุงูุฅุนุฏุงุฏ </h3><br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณูููู ุจุฅูุดุงุก ุงูุจููุฉ ุงูุชุญุชูุฉ ูููุนุงูุฌ (ุนูู ุงููุถูู ุงูุฑุฆูุณู) ุ ููุฐุง ูููู ุจุงูุชุณุฌูู ุชุญุช ูุณุชุฎุฏู buildbot ูุชูููุฐ ุงูุฃูุงูุฑ ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su - buildbot mkdir /home/buildbot/master <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ buildbot create-master master</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุญุฒู ุงูููุชููุฉ ุ ูู ุจุฅูุดุงุก ุฏููู ุงูุจููุงุช </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">mkdir /home/buildbot/builds</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชู ุฅูุดุงุก ููู master.cfg ูู ุงูุฏููู / home / buildbot / master /.  ูุฐุง ุงูููู ูู ุฑูุฒ ุจูุซูู ููุญุชูู ุนูู ูุตู ูุฌููุน ุขููุงุช ุงููุธุงู ุ ูุณูู ูุณุชูุฑ ูู ุงูุนูู ูุนูุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">nano /home/buildbot/master/master.cfg</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, re <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> steps, util, schedulers, worker, changes, reporters c= BuildmasterConfig ={} <span class="hljs-comment"><span class="hljs-comment">#   . c['workers'] = [ worker.Worker('CentOS', '123456'), worker.Worker('Debian-10', '123456'), worker.Worker('Windows-10', '123456')] c['protocols'] = {'pb': {'port': 4000}} #      c['change_source'] = [] c['change_source'].append(changes.GitPoller( repourl = 'https://bitbucket.org/svk28/rac-gui.git', project = 'Rac-GUI', branches = True, pollInterval = 60 ) ) #    c['schedulers'] = [] c['schedulers'].append(schedulers.SingleBranchScheduler( name="Rac-GUI-schedulers", change_filter=util.ChangeFilter(branch='master'), builderNames=["Rac-GUI-RPM-builder", "Rac-GUI-DEB-builder", "Rac-GUI-WIN-builder"], properties = {'owner': 'admin'} ) ) @util.renderer ######################################3 #  RPM- rac_gui_build_RPM = util.BuildFactory() rac_gui_build_RPM.addStep(steps.Git( repourl = 'https://bitbucket.org/svk28/rac-gui.git', workdir = 'rac-gui', haltOnFailure = True, submodules = True, mode='full', progress = True) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃุชูุชุฉ ุชุฌููุน ุญุฒู ุงูุฅุตุฏุงุฑุงุช ุงููุฎุชููุฉ ุ ุจุญูุซ ูุง ุชุถุทุฑ ุฅูู ุงูุตุนูุฏ ุฅูู ุฑูุฒ ุงูููู master.cfg ุ ูู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุฑุฆูุณู ูุจุฑูุงูุฌ rac_gui.tcl ูู ุงูุฑุฃุณ ุ ุชูุช ุฅุถุงูุฉ ุฃุณุทุฑ ุจุงูุฅุตุฏุงุฑ ูุงูุฅุตุฏุงุฑ ุงูุญุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">###################################################### # Rac GUI ... # version: 1.0.3 # release: 1</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงุณุชูุงุฏุง ุฅูู ูุฐู ุงูุฎุทูุท ุ ุณูู ูููู buildbot ุจุชุฑููู ุงูุญุฒู.  ูุณุญุจ ุงูุจูุงูุงุช ุ ุงุณุชุฎุฏู ุงุณุชุฏุนุงุก ูุญุฏุฉ ุงูุชุญูู grep.  ูู buildbot ุ ูุง ููููู ุจุจุณุงุทุฉ ุชุญุฏูุฏ ุงููุชุบูุฑุงุช ูู "ุงูุนูุงู" (ุนูู ุฃู ุญุงู ุ ูู ุฃุฌุฏ ููู).  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏู ุงูุฎุตุงุฆุต.  ุฃู  ูู ุนูููุฉ ุงูุชุฌููุน ุ ุฃุถู ุงูุฎุทูุงุช ูุชุญุฏูุฏ ุงูุฅุตุฏุงุฑ ูุงูุฅุตุฏุงุฑ ุ ูุจุงูุชุงูู ุ ูู ุจุชุนููู ุฎุตุงุฆุต ุงูุฅุตุฏุงุฑ ูุงูุฅุตุฏุงุฑ.  ูููู ุถุจุท ุงูุฎุตุงุฆุต ุจุนุฏุฉ ุทุฑู ุ ููู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุงูุงุชุตุงู ุจุฃูุฑ ูุญุฏุฉ ุงูุชุญูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       rac_gui_build_RPM.addStep( steps.SetPropertyFromCommand( command="grep version ../rac-gui/rac_gui.tcl | grep -oE '\\b[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{1,2}\\b'", property="version" ) ) #       rac_gui_build_RPM.addStep( steps.SetPropertyFromCommand( command="grep release ../rac-gui/rac_gui.tcl | grep -oE '\\b[0-9]{1,3}\\b'", property="release" ) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุณุชุจุฏุงู ุงูููู ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุนู ุทุฑูู ุงุณุชุฏุนุงุก util.Interpolate (). </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   rac_gui_build_RPM.addStep( steps.ShellCommand( command=["tar", "czf", util.Interpolate("/home/buildbot/rpmbuild/SOURCES/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"), "../rac-gui"] ) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูุธุฑูุง ูุงุณุชุฎุฏุงู ุงููุถูู ููุชุฌููุน ุงููุฏูู ููุญุฒู ุ ุณูุชู ุงูุชุฌููุน ุนูู ุทูู ุงููุณุงุฑุงุช ุงูููุงุณูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  spec rac_gui_build_RPM.addStep(steps.ShellCommand( command=["cp", "../rac-gui/rac_gui.spec", "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"]))</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุนููู ุฃุฑูุงู ุงูุฅุตุฏุงุฑ ูุงูุฅุตุฏุงุฑ ุงูุตุญูุญุฉ ุ ุงุณุชุฎุฏู ุงุณุชุฏุนุงุก sed ุงูููุงุณู ุ ุฃู  ูุณุชุจุฏู ุงูุฃูุฑ ุงูููู ุงูููุฌูุฏุฉ ุฏุงุฎู ููู ุงูููุงุตูุงุช ุจุงูุถุฑุฑ </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   rac_gui_build_RPM.addStep(steps.ShellCommand( command=["sed", "-i", util.Interpolate("s/.*Version:.*/Version:\t%(prop:version)s/"), "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"])) #   rac_gui_build_RPM.addStep(steps.ShellCommand( command=["sed", "-i", util.Interpolate("s/.*Release:.*/Release:\t%(prop:release)s/"), "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"])) #    rac_gui_build_RPM.addStep(steps.RpmBuild( specfile="/home/buildbot/rpmbuild/SPECS/rac_gui.spec", dist='.el5', topdir='/home/buildbot/rpmbuild', builddir='/home/buildbot/rpmbuild/build', rpmdir='/home/buildbot/rpmbuild/RPMS', sourcedir='/home/buildbot/rpmbuild/SOURCES' ) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ุจูุณุฎ ุงูุญุฒูุฉ ุงูุชู ุชู ุชุฌููุนูุง ุงูุฌุงูุฒุฉ ูุงูุฃุฑุดูุฉ ูุน ุฑููุฒ ุงููุตุฏุฑ ุฅูู ุงูุฑุฆูุณู.  ูููู ููููู ุนูู ุงูููุฑ ูุณุฎ ุงููููุงุช ูู ุณุทุญ ุงูููุชุจ ุงูุฎุงุต ุจู ุฅูู ูุณุชูุฏุนู ุฃู ูููุน ุงูููุจ ุงูุฎุงุต ุจู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     rac_gui_build_RPM.addStep( steps.FileUpload( workersrc=util.Interpolate("/home/buildbot/rpmbuild/RPMS/noarch/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm") ) ) rac_gui_build_RPM.addStep( steps.FileUpload( workersrc=util.Interpolate("/home/buildbot/rpmbuild/SOURCES/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz") ) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุงููุนุงูุฌ ุ ูุจุฏุฃ ุนูููุฉ ูุณุฎ ุงูุญุฒู ุงููุฌูุนุฉ ุฅูู ุงุณุชุถุงูุฉ FTP.  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏู <a href="">ุงูุจุฑูุงูุฌ ุงููุตู</a> tcl. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">rac_gui_build_RPM.addStep( steps.MasterShellCommand( command=[<span class="hljs-string"><span class="hljs-string">"/usr/local/bin/deploy-ftp.tcl"</span></span>, util.Interpolate(<span class="hljs-string"><span class="hljs-string">"--local-file=/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm"</span></span>), util.Interpolate(<span class="hljs-string"><span class="hljs-string">"--remote-file=uploads/rac-gui/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm"</span></span>)] ) ) rac_gui_build_RPM.addStep( steps.MasterShellCommand( command=[<span class="hljs-string"><span class="hljs-string">"/usr/local/bin/deploy-ftp.tcl"</span></span>, util.Interpolate(<span class="hljs-string"><span class="hljs-string">"--local-file=/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"</span></span>), util.Interpolate(<span class="hljs-string"><span class="hljs-string">"--remote-file=uploads/rac-gui/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"</span></span>)] ) )</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุฐูู ูุน RPM ุงูุงูุชูุงุก.  ุงูุขู ููุจุฏุฃ ูู ูุตู ุฎูุงุฑุฒููุฉ ุงูุชุฌููุน ูุญุฒูุฉ DEB.  ูุธุฑูุง ูุฃู ุนูููุงุช ุจูุงุก ุงูุญุฒู ููุฃูุธูุฉ ุงููุฎุชููุฉ ูุณุชููุฉ ุนู ุจุนุถูุง ุงูุจุนุถ ุ ูุณูุชู ุชูุฑุงุฑ ุงูุนุฏูุฏ ูู ุงูุฎุทูุงุช. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">rac_gui_build_DEB = util.BuildFactory() rac_gui_build_DEB.addStep(steps.Git( repourl = <span class="hljs-string"><span class="hljs-string">'https://bitbucket.org/svk28/rac-gui.git'</span></span>, haltOnFailure = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, submodules = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'build'</span></span>, progress = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ) <span class="hljs-comment"><span class="hljs-comment">#       rac_gui_build_DEB.addStep( steps.SetPropertyFromCommand( command="grep version rac_gui.tcl | grep -oE '\\b[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{1,2}\\b'", property="version" ) ) #       rac_gui_build_DEB.addStep( steps.SetPropertyFromCommand( command="grep release rac_gui.tcl | grep -oE '\\b[0-9]{1,3}\\b'", property="release" ) ) #    rac_gui_build_DEB.addStep(steps.ShellCommand( command=["mv", "rac_gui.tcl", "racgui"]))</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุญุฒูุฉ RPM ุ ูุชู ุชูููุฐ ุฌุฒุก ูู ุงูุฅุฌุฑุงุกุงุช ุงูุชุงููุฉ ุจูุงุณุทุฉ rpm ููุณูุง ุฃุซูุงุก ุงูุชุฌููุน ููุชู ูุตููุง ุฏุงุฎู ุงูููุงุตูุงุช ุ ุจุงููุณุจุฉ ุฅูู ุฏุจูุงู ุ ูุชุนูู ุนููู ุงูููุงู ุจุฐูู ููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     rac_gui_build_DEB.addStep(steps.ShellCommand( command=["sed", "-i", "s+^set\ dir(lib)+set\ dir(lib)\ /usr/share/rac-gui/lib ;#+g", "racgui"])) #     rac_gui_build_DEB.addStep(steps.ShellCommand( command=["sed", "-i", "s+\[pwd\]+/usr/share/rac-gui+g", "racgui"])) #   rac_gui_build_DEB.addStep(steps.ShellCommand( command=["tar", "czf", util.Interpolate("../rac-gui_%(prop:version)s.orig.tar.gz"), "."])) #   rac_gui_build_DEB.addStep(steps.ShellCommand( command=["dpkg-buildpackage"])) #     rac_gui_build_DEB.addStep( steps.FileUpload( workersrc=util.Interpolate("../rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb") ) ) rac_gui_build_DEB.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb")] ) )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุชู DEB ุ ูุงูุขู ุงูููุงูุฐ! </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">rac_gui_build_WIN = util.BuildFactory() rac_gui_build_WIN.addStep(steps.Git( repourl = <span class="hljs-string"><span class="hljs-string">'https://bitbucket.org/svk28/rac-gui.git'</span></span>, haltOnFailure = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, submodules = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'build'</span></span>, progress = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) )</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู windows ูุง ูุญุชูู ุนูู grep ู sed (ุฃู ูู ููุงูุ) ุ ูุณูุณุชุฎุฏู ุจูููุฑุดูู </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       rac_gui_build_WIN.addStep( steps.SetPropertyFromCommand( command="powershell -command \"((Get-Content .\\rac_gui.tcl | Select-String -Pattern 'version:') -split '\\s')[2]", property="version" ) ) #       rac_gui_build_WIN.addStep( steps.SetPropertyFromCommand( command="powershell -command \"((Get-Content .\\rac_gui.tcl | Select-String -Pattern 'release:') -split '\\s')[2]", property="release" ) ) #    rac_gui_build_WIN.addStep(steps.ShellCommand( command=["c:\\bin\\freewrap.exe", "rac_gui.tcl"])) #  ,   rac_gui_build_WIN.addStep(steps.ShellCommand( command=["c:\\Program Files\\7-zip\\7z.exe", "a", "-r", util.Interpolate("..\\rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), "..\\build"])) #    rac_gui_build_WIN.addStep( steps.FileUpload( workersrc=util.Interpolate("..\\rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s.win.zip") ) ) #     rac_gui_build_WIN.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui_%(prop:version)s-%(prop:release)s.win.zip")] ) ) #        c['builders'] = [ util.BuilderConfig(name="Rac-GUI-RPM-builder", workername='CentOS', factory=rac_gui_build_RPM), util.BuilderConfig(name="Rac-GUI-DEB-builder", workername='Debian-10', factory=rac_gui_build_DEB), util.BuilderConfig(name="Rac-GUI-WIN-builder", workername='Windows-10', factory=rac_gui_build_WIN), ]</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฅุจูุงุบ ุนู ุญุงูุฉ ุนูููุฉ ุงูุชุฌููุน ุ ุณูุณุชุฎุฏู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [] template=<span class="hljs-string"><span class="hljs-string">u'''\ &lt;h4&gt;Build status: {{ summary }}&lt;/h4&gt; &lt;p&gt; Worker used: {{ workername }}&lt;/p&gt; {% for step in build['steps'] %} &lt;p&gt; {{ step['name'] }}: {{ step['result'] }}&lt;/p&gt; {% endfor %} &lt;p&gt;&lt;b&gt; -- The Buildbot&lt;/b&gt;&lt;/p&gt; '''</span></span> mailNotifier = reporters.MailNotifier(fromaddr=<span class="hljs-string"><span class="hljs-string">"builder@domain.ru"</span></span>, sendToInterestedUsers=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, mode=(<span class="hljs-string"><span class="hljs-string">'all'</span></span>), extraRecipients=[<span class="hljs-string"><span class="hljs-string">"admin@domain.ru"</span></span>], relayhost=<span class="hljs-string"><span class="hljs-string">"mail.domain.ru"</span></span>, smtpPort=<span class="hljs-number"><span class="hljs-number">587</span></span>, smtpUser=<span class="hljs-string"><span class="hljs-string">"builder@domain.ru"</span></span>, smtpPassword=<span class="hljs-string"><span class="hljs-string">"******"</span></span>, messageFormatter=reporters.MessageFormatter( template=template, template_type=<span class="hljs-string"><span class="hljs-string">'html'</span></span>, wantProperties=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, wantSteps=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>].append(mailNotifier) <span class="hljs-comment"><span class="hljs-comment">#    c['title'] = "The process of bulding" c['titleURL'] = "http://vm-srv-build1:80/" c['buildbotURL'] = "http://vm-srv-build1/" c['www'] = dict(port=80, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c['db'] = { 'db_url' : "sqlite:///state.sqlite" }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ุจุญูุธ ุงูููู ูููููู ูุญุงููุฉ ุจุฏุก ุชุดุบูู ุฎุฏูุฉ ุงููุนุงูุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl restart buildbot-master</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุณุฌู ุ ูุชุญูู ูู ุฃู ูู ุดูุก ูุชูุงูู ูุน ุงูุชูููู ูุฃู ูู ุดูุก ูุนูู ูุงููุนุชุงุฏ.  ูุฌุจ ุนูู ุฌููุน ููุธูููุง ุงูุงุชุตุงู ุงูุขู ุ ููุง ุณูุชู ุงูุฅุจูุงุบ ุจุณุนุงุฏุฉ ูู ุณุฌู '' '' '' '/ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ / ุจูุงุก ุงููููุน / ูุงุณุชุฑ / twistd.log' '' '' ุงูุณุฌู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> 2019-07-24 16:50:35+0300 [-] Loading buildbot.tac... 2019-07-24 16:50:35+0300 [-] Loaded. 2019-07-24 16:50:35+0300 [-] twistd 19.2.1 (/usr/bin/python3.6 3.6.8) starting up. 2019-07-24 16:50:35+0300 [-] reactor class: twisted.internet.epollreactor.EPollReactor. 2019-07-24 16:50:35+0300 [-] Starting BuildMaster -- buildbot.version: 2.3.1 2019-07-24 16:50:35+0300 [-] Loading configuration from '/home/buildbot/master/master.cfg' 2019-07-24 16:50:36+0300 [-] /usr/local/lib/python3.6/site-packages/buildbot/config.py:90: buildbot.config.ConfigWarning: [0.9.0 and later] `buildbotNetUsageData` is not configured and defaults to basic. This parameter helps the buildbot development team to understand the installation base. No personal information is collected. Only installation software version info and plugin usage is sent. You can `opt-out` by setting this variable to None. Or `opt-in` for more information by setting it to "full". 2019-07-24 16:50:36+0300 [-] Setting up database with URL 'sqlite:/state.sqlite' 2019-07-24 16:50:36+0300 [-] setting database journal mode to 'wal' 2019-07-24 16:50:36+0300 [-] adding 1 new services, removing 0 2019-07-24 16:50:36+0300 [-] adding 1 new change_sources, removing 0 2019-07-24 16:50:36+0300 [-] gitpoller: using workdir '/home/buildbot/master/gitpoller-work' 2019-07-24 16:50:36+0300 [-] adding 3 new builders, removing 0 2019-07-24 16:50:36+0300 [-] adding 1 new schedulers, removing 0 2019-07-24 16:50:36+0300 [-] initializing www plugin 'waterfall_view' 2019-07-24 16:50:36+0300 [-] initializing www plugin 'console_view' 2019-07-24 16:50:36+0300 [-] initializing www plugin 'grid_view' 2019-07-24 16:50:36+0300 [-] NOTE: www plugin 'sitenav' is installed but not configured 2019-07-24 16:50:36+0300 [-] initializing www plugin 'waterfall_view' 2019-07-24 16:50:36+0300 [-] initializing www plugin 'console_view' 2019-07-24 16:50:36+0300 [-] initializing www plugin 'grid_view' 2019-07-24 16:50:36+0300 [-] NOTE: www plugin 'sitenav' is installed but not configured 2019-07-24 16:50:36+0300 [-] BuildbotSite starting on 80 2019-07-24 16:50:36+0300 [-] Starting factory &lt;buildbot.www.service.BuildbotSite object at 0x7fe31c2657b8&gt; 2019-07-24 16:50:36+0300 [-] adding 3 new workers, removing 0 2019-07-24 16:50:36+0300 [-] PBServerFactory starting on 4000 2019-07-24 16:50:36+0300 [-] Starting factory &lt;twisted.spread.pb.PBServerFactory object at 0x7fe31c147470&gt; 2019-07-24 16:50:37+0300 [-] BuildMaster is running 2019-07-24 16:50:37+0300 [-] buildbotNetUsageData: sending {'installid': 'b6193b126b96689351d2fe95787c5a03fc0879f9', 'versions': {'Python': '3.6.8', 'Buildbot': '2.3.1', 'Twisted': '19.2.1'}, 'platform': {'platform': 'Linux-4.15.18-10- pve-x86_64-with-centos-7.6.1810-Core', 'system': 'Linux', 'machine': 'x86_64', 'processor': 'x86_64', 'python_implementation': 'CPython', 'version': '#1 SMP PVE 4.15.18-32', 'distro': 'centos:7'}, 'plugins': {'buildbot/worker/base/Worker': 3, 'buildbot/config/BuilderConfig': 3, 'buildbot/schedulers/basic/SingleBranchScheduler': 1, 'buildbot/reporters/mail/MailNotifier': 1, 'buildbot/changes/gitpoller/GitPoller': 1, 'buildbot/steps/worker/MakeDirectory': 1, 'buildbot/steps/source/git/Git': 3, 'buildbot/steps/shell/ShellCommand': 9, 'buildbot/steps/package/rpm/rpmbuild/RpmBuild': 1}, 'db': 'sqlite', 'mq': 'simple', 'www_plugins': ['waterfall_view', 'console_view', 'grid_view']} 2019-07-24 16:50:37+0300 [Broker,0,127.0.0.1] worker 'CentOS' attaching from IPv4Address(type='TCP', host='127.0.0.1', port=37332) 2019-07-24 16:50:37+0300 [Broker,0,127.0.0.1] Got workerinfo from 'CentOS' 2019-07-24 16:50:37+0300 [-] bot attached 2019-07-24 16:50:37+0300 [Broker,0,127.0.0.1] Worker CentOS attached to Rac-GUI-RPM-builder 2019-07-24 16:50:37+0300 [-] buildbotNetUsageData: buildbot.net said: ok 2019-07-24 16:50:39+0300 [Broker,1,192.168.55.15] worker 'Windows-10' attaching from IPv4Address(type='TCP', host='192.168.5.145', port=49831) 2019-07-24 16:50:39+0300 [Broker,1,192.168.55.15] Got workerinfo from 'Windows-10' 2019-07-24 16:50:40+0300 [-] bot attached 2019-07-24 16:50:40+0300 [Broker,1,192.168.55.15] Worker Windows-10 attached to Rac-GUI-WIN-builder 2019-07-24 16:50:41+0300 [Broker,2,192.168.55.99] worker 'Debian-10' attaching from IPv4Address(type='TCP', host='192.168.5.9', port=44430) 2019-07-24 16:50:41+0300 [Broker,2,192.168.55.99] Got workerinfo from 'Debian-10' 2019-07-24 16:50:41+0300 [-] bot attached 2019-07-24 16:50:41+0300 [Broker,2,192.168.55.99] Worker Debian-10 attached to Rac-GUI-DEB-builder</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ูููู ุนูููุฉ ุงูุฅุนุฏุงุฏ.  ููููู ุนุฑุถ ุงูุญุงูุฉ ุงูุญุงููุฉ ูู ุฎูุงู ูุงุฌูุฉ ุงูููุจ.  ุญูุซ ููููู ุฃูุถูุง ุฑุคูุฉ ุฃุฎุทุงุก ุงูุชุฌููุน ุ ูุงูุดุฑูุน ูู ุนูููุฉ ูุฌูุฏุฉ ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูุง ุ ุฅูุฎ. </p><br><p style=";text-align:right;direction:rtl">  ูุจุงุดุฑุฉ ุจุนุฏ ุฅุทูุงู ุนูุงููุง ุงูุดุงููู ุ ููููู ุฃู ุชุฑู ูู ุฎูุงู ูุงุฆูุฉ "Builds" -&gt; "ุงูุนูุงู" </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/425/92a/182/42592a182ecbe305bea2bff87c28755e.png" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุงูุชูุงู ุนูููุฉ ุงูุฅูุดุงุก ุงูุฃููู (ุฃู ุงูุชุบููุฑุงุช ูู ูุณุชูุฏุน Git) ุ ุณุชุธูุฑ ุญุงูุฉ ุงูุนูููุงุช ูู ุงูุตูุญุฉ ุงูุฃููู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/614/d81/2a1/614d812a145d9f25d7267d71de13c678.png" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจูุถุน ุงููุงูุณ ูู ุงูุณุทุฑ ุงููุฑุบูุจ ููู ุ ูุชู ูุชุญ ุตูุญุฉ ุจุงูุญุงูุฉ ุงูุญุงููุฉ ููุนูููุฉ ุ ุญูุซ ููููู ุฑุคูุฉ ูุง ูุญุฏุซ ุ ููุง ูู ุงูุฃุฎุทุงุก ุ ููุง ุฅูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/aeb/945/d73/aeb945d73a63cb5b3ead878ebf6fe774.png" alt="ุตูุฑุฉ"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููููู ุฃู ุชุฃุฎุฐ ุงูุชูููู ุงูุฑุฆูุณู ุจุฃูููู ููุง</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, re <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> steps, util, schedulers, worker, changes, reporters c= BuildmasterConfig ={} c[<span class="hljs-string"><span class="hljs-string">'workers'</span></span>] = [ worker.Worker(<span class="hljs-string"><span class="hljs-string">'CentOS'</span></span>, <span class="hljs-string"><span class="hljs-string">'123456'</span></span>), worker.Worker(<span class="hljs-string"><span class="hljs-string">'Debian-10'</span></span>, <span class="hljs-string"><span class="hljs-string">'123456'</span></span>), worker.Worker(<span class="hljs-string"><span class="hljs-string">'Windows-10'</span></span>, <span class="hljs-string"><span class="hljs-string">'123456'</span></span>)] c[<span class="hljs-string"><span class="hljs-string">'protocols'</span></span>] = {<span class="hljs-string"><span class="hljs-string">'pb'</span></span>: {<span class="hljs-string"><span class="hljs-string">'port'</span></span>: <span class="hljs-number"><span class="hljs-number">4000</span></span>}} c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>].append(changes.GitPoller( repourl = <span class="hljs-string"><span class="hljs-string">'https://bitbucket.org/svk28/rac-gui.git'</span></span>, project = <span class="hljs-string"><span class="hljs-string">'Rac-GUI'</span></span>, branches = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, pollInterval = <span class="hljs-number"><span class="hljs-number">600</span></span> )) <span class="hljs-comment"><span class="hljs-comment">#    c['schedulers'] = [] c['schedulers'].append(schedulers.SingleBranchScheduler( name="Rac-GUI-schedulers", change_filter=util.ChangeFilter(branch='master'), builderNames=["Rac-GUI-RPM-builder", "Rac-GUI-DEB-builder", "Rac-GUI-WIN-builder"], properties = {'owner': 'admin'} )) @util.renderer def get_name_version_release(props): prog_name = "rac-gui" prog_version = "1.0.3" prog_release = "3" return { "prog_name": prog_name #"prog_version": prog_version, #"prog_release": prog_release } rac_gui_build_RPM = util.BuildFactory() rac_gui_build_RPM.addStep(steps.Git( repourl = 'https://bitbucket.org/svk28/rac-gui.git', workdir = 'rac-gui', haltOnFailure = True, submodules = True, mode='full', progress = True) ) #       rac_gui_build_RPM.addStep( steps.SetPropertyFromCommand( command="grep version ../rac-gui/rac_gui.tcl | grep -oE '\\b[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{1,2}\\b'", property="version" ) ) #       rac_gui_build_RPM.addStep( steps.SetPropertyFromCommand( command="grep release ../rac-gui/rac_gui.tcl | grep -oE '\\b[0-9]{1,3}\\b'", property="release" ) ) rac_gui_build_RPM.addStep(steps.ShellCommand( command=["tar", "czf", util.Interpolate("/home/buildbot/rpmbuild/SOURCES/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"), "../rac-gui"])) rac_gui_build_RPM.addStep(steps.ShellCommand( command=["cp", "../rac-gui/rac_gui.spec", "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"])) rac_gui_build_RPM.addStep(steps.ShellCommand( command=["sed", "-i", util.Interpolate("s/.*Version:.*/Version:\t%(prop:version)s/"), "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"])) rac_gui_build_RPM.addStep(steps.ShellCommand( command=["sed", "-i", util.Interpolate("s/.*Release:.*/Release:\t%(prop:release)s/"), "/home/buildbot/rpmbuild/SPECS/rac_gui.spec"])) rac_gui_build_RPM.addStep(steps.RpmBuild( specfile="/home/buildbot/rpmbuild/SPECS/rac_gui.spec", dist='.el5', topdir='/home/buildbot/rpmbuild', builddir='/home/buildbot/rpmbuild/build', rpmdir='/home/buildbot/rpmbuild/RPMS', sourcedir='/home/buildbot/rpmbuild/SOURCES' )) #     rac_gui_build_RPM.addStep( steps.FileUpload( workersrc=util.Interpolate("/home/buildbot/rpmbuild/RPMS/noarch/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm") ) ) rac_gui_build_RPM.addStep( steps.FileUpload( workersrc=util.Interpolate("/home/buildbot/rpmbuild/SOURCES/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz") ) ) rac_gui_build_RPM.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui-%(prop:version)s-%(prop:release)s.noarch.rpm")] ) ) rac_gui_build_RPM.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui-%(prop:version)s-%(prop:release)s.tar.gz")] ) ) #################################### ## DEB #################################### rac_gui_build_DEB = util.BuildFactory() rac_gui_build_DEB.addStep(steps.Git( repourl = 'https://bitbucket.org/svk28/rac-gui.git', haltOnFailure = True, submodules = True, mode='full', workdir='build', progress = True) ) #       rac_gui_build_DEB.addStep( steps.SetPropertyFromCommand( command="grep version rac_gui.tcl | grep -oE '\\b[0-9]{1,2}\\.[0-9]{1,2}\\.[0-9]{1,2}\\b'", property="version" ) ) #       rac_gui_build_DEB.addStep( steps.SetPropertyFromCommand( command="grep release rac_gui.tcl | grep -oE '\\b[0-9]{1,3}\\b'", property="release" ) ) #    rac_gui_build_DEB.addStep(steps.ShellCommand( command=["mv", "rac_gui.tcl", "racgui"])) #     rac_gui_build_DEB.addStep(steps.ShellCommand( command=["sed", "-i", "s+^set\ dir(lib)+set\ dir(lib)\ /usr/share/rac-gui/lib ;#+g", "racgui"])) #     rac_gui_build_DEB.addStep(steps.ShellCommand( command=["sed", "-i", "s+\[pwd\]+/usr/share/rac-gui+g", "racgui"])) #   rac_gui_build_DEB.addStep(steps.ShellCommand( command=["tar", "czf", util.Interpolate("../rac-gui_%(prop:version)s.orig.tar.gz"), "."])) #   rac_gui_build_DEB.addStep(steps.ShellCommand( command=["dpkg-buildpackage"])) #     rac_gui_build_DEB.addStep( steps.FileUpload( workersrc=util.Interpolate("../rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb") ) ) rac_gui_build_DEB.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui_%(prop:version)s-%(prop:release)s_amd64.deb")] ) ) ############################################ # WIN ############################################ rac_gui_build_WIN = util.BuildFactory() rac_gui_build_WIN.addStep(steps.Git( repourl = 'https://bitbucket.org/svk28/rac-gui.git', haltOnFailure = True, submodules = True, mode='full', workdir='build', progress = True) ) #       rac_gui_build_WIN.addStep( steps.SetPropertyFromCommand( command="powershell -command \"((Get-Content .\\rac_gui.tcl | Select-String -Pattern 'version:') -split '\\s')[2]", property="version" ) ) #       rac_gui_build_WIN.addStep( steps.SetPropertyFromCommand( command="powershell -command \"((Get-Content .\\rac_gui.tcl | Select-String -Pattern 'release:') -split '\\s')[2]", property="release" ) ) #    rac_gui_build_WIN.addStep(steps.ShellCommand( command=["c:\\bin\\freewrap.exe", "rac_gui.tcl"])) #  ,   rac_gui_build_WIN.addStep(steps.ShellCommand( command=["c:\\Program Files\\7-zip\\7z.exe", "a", "-r", util.Interpolate("..\\rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), "..\\build"])) #    rac_gui_build_WIN.addStep( steps.FileUpload( workersrc=util.Interpolate("..\\rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), masterdest=util.Interpolate("/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s.win.zip") ) ) #     rac_gui_build_WIN.addStep( steps.MasterShellCommand( command=["/usr/local/bin/deploy-ftp.tcl", util.Interpolate("--local-file=/home/buildbot/builds/rac-gui_%(prop:version)s-%(prop:release)s.win.zip"), util.Interpolate("--remote-file=uploads/rac-gui/rac-gui_%(prop:version)s-%(prop:release)s.win.zip")] ) ) c['builders'] = [ util.BuilderConfig(name="Rac-GUI-RPM-builder", workername='CentOS', factory=rac_gui_build_RPM), util.BuilderConfig(name="Rac-GUI-DEB-builder", workername='Debian-10', factory=rac_gui_build_DEB), util.BuilderConfig(name="Rac-GUI-WIN-builder", workername='Windows-10', factory=rac_gui_build_WIN), ] c['services'] = [] template=u'''\ &lt;h4&gt;Build status: {{ summary }}&lt;/h4&gt; &lt;p&gt; Worker used: {{ workername }}&lt;/p&gt; {% for step in build['steps'] %} &lt;p&gt; {{ step['name'] }}: {{ step['result'] }}&lt;/p&gt; {% endfor %} &lt;p&gt;&lt;b&gt; -- The Buildbot&lt;/b&gt;&lt;/p&gt; ''' mailNotifier = reporters.MailNotifier(fromaddr="112@icvibor.ru", sendToInterestedUsers=False, mode=('all'), extraRecipients=["my@domain.local"], relayhost="mail.domain.local", smtpPort=587, smtpUser="buildbot@domain.local", smtpPassword="**********", messageFormatter=reporters.MessageFormatter( template=template, template_type='html', wantProperties=True, wantSteps=True)) c['services'].append(mailNotifier) c['title'] = "The process of bulding" c['titleURL'] = "http://vm-srv-build1:80/" c['buildbotURL'] = "http://vm-srv-build1/" c['www'] = dict(port=80, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c['db'] = { 'db_url' : "sqlite:///state.sqlite" }</span></span></code> </pre> </div></div><br><h3 id="materialy" style=";text-align:right;direction:rtl">  </h3><br><p style=";text-align:right;direction:rtl">      : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  Continuous Integration   BuildBot</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Buildbot:         </a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    Buildbot  Ubuntu 16.04</a> </li><li style=";text-align:right;direction:rtl">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Buildbot Tutorial</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar464489/">https://habr.com/ru/post/ar464489/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar464471/index.html">snmp ุฑุตุฏ ุงูุทุงุจุนุฉ ูู ุงููุชุฃูู</a></li>
<li><a href="../ar464479/index.html">"ุจูุงู ูู ุงููุจุฑูุฌูู ุงููุจุชุฏุฆูู ูู ุงูุชุฎุตุตุงุช ุฐุงุช ุงูุตูุฉ" ุฃู ููู ุฌุฆุช ุฅูู ูุซู ูุฐู ุงูุญูุงุฉ</a></li>
<li><a href="../ar464481/index.html">ููู ุจูููุง ูุธุงู ุงูุชุฏุฑูุจ ูุงูุชุญููุฒ ูู ุงูุงุณุชูุฏูู</a></li>
<li><a href="../ar464485/index.html">ShIoTiny: ุชูููุฉ ุงูุบุฑูุฉ ุงูุฑุทุจุฉ (ูุซุงู ุนูู ุฐูู ุงููุดุฑูุน)</a></li>
<li><a href="../ar464487/index.html">ูุญู ูุจูู ูุงุฌูุฉ ูุฅุฏุฎุงู ุงููุซุงุฆู ูู ุฎูุงู ุงูุงุฎุชูุงุฑ</a></li>
<li><a href="../ar464491/index.html">ูููุงูุฏู 2.7 - ุญูุงุฉ ููุซูุฉ ูู ุตูุช</a></li>
<li><a href="../ar464495/index.html">ุชุทููุฑ ูุฑูู ูุงูุชูููุฑ ูุงูุงุชุตุงู ุงูุฅุฏุงุฑู ููุงุฆุฏ ุงููุฑูู</a></li>
<li><a href="../ar464497/index.html">ุฌูุฑุง ูุนูุงุฌ ููุฃุฑู ูุงูุงูููุงุฑุงุช ุงูุนุตุจูุฉ</a></li>
<li><a href="../ar464499/index.html">"ูุงุช. ูููุฐุฌ ููู ุณุชุฑูุช "ุฃู ูุญุงููุฉ ูุชุญุณูู ุชูููุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุณุญุงุจูุฉ ูุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar464503/index.html">ูุทุงุจูุฉ ูููุฉ ูุฑูุฑ Wi-Fi ูุน aircrack-ng</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>