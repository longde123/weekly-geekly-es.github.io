<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§© üï¶ üñçÔ∏è Implementaci√≥n de Keras Deep Learning Model como una aplicaci√≥n web de Python üëÉüèæ üë©üèª‚Äçü§ù‚Äçüë®üèø üõÅ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La traducci√≥n del art√≠culo fue preparada espec√≠ficamente para estudiantes del curso "Desarrollador web en Python" . 



 Crear un proyecto genial de a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementaci√≥n de Keras Deep Learning Model como una aplicaci√≥n web de Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/477402/">  <i>La traducci√≥n del art√≠culo fue preparada espec√≠ficamente para estudiantes del curso <a href="https://otus.pw/PcSx/">"Desarrollador web en Python"</a> .</i> <br><br><img src="https://habrastorage.org/webt/vz/ii/2j/vzii2j88n5_-t9hihzrz276v7ho.png"><br><hr><br>  Crear un proyecto genial de aprendizaje autom√°tico es una cosa, otra cosa cuando necesitas que otras personas puedan verlo tambi√©n.  Por supuesto, puedes poner todo el proyecto en GitHub, pero ¬øc√≥mo entender√°n tus abuelos lo que hiciste?  No, necesitamos implementar nuestro modelo de aprendizaje profundo como una aplicaci√≥n web que estar√° disponible para cualquier persona en el mundo. <br><br>  En este art√≠culo, aprenderemos c√≥mo escribir una aplicaci√≥n web que utiliza la red neuronal recurrente entrenada por Keras y permite a los usuarios crear nuevas anotaciones de patentes.  Este proyecto se basa en el trabajo del art√≠culo <a href="https://medium.com/p/ffd204f99470%3Fsource%3Duser_profile---------6------------------">"Redes neuronales recurrentes por ejemplo"</a> , sin embargo, no es necesario saber c√≥mo se construye RNN ahora.  Por el momento, solo lo consideraremos como un recuadro negro: establecemos la secuencia inicial y muestra una anotaci√≥n de patente completamente nueva, que se puede ver en un navegador. <a name="habracut"></a><br><br>  Por lo general, los analistas de datos desarrollan modelos y el front-end los muestra al mundo.  En este proyecto, tendremos que desempe√±ar ambos roles y sumergirnos en el desarrollo web (aunque casi por completo en Python). <br><br>  Este proyecto requerir√° combinar varias herramientas: <br><br><ul><li>  <a href="http://flask.pocoo.org/">Frasco</a> : para crear una aplicaci√≥n web b√°sica en Python; </li><li>  <a href="http://keras.io/">Keras</a> : Implementaci√≥n de una red neuronal <a href="http://keras.io/">recurrente pre-entrenada</a> </li><li>  Plantillas del motor de plantillas <a href="http://jinja.pocoo.org/">Jinja</a> ; </li><li>  <a href="https://www.w3schools.com/html/">HTML</a> y <a href="https://www.w3schools.com/html/html_css.asp">CSS</a> para crear p√°ginas web. </li></ul><br>  En √∫ltima instancia, obtenemos una aplicaci√≥n web que permitir√° a los usuarios crear anotaciones de patentes completamente nuevas utilizando una red neuronal recurrente capacitada. <br><br><img src="https://habrastorage.org/webt/l_/oc/2j/l_oc2jgyuokd3kvrsk2pn87bhis.gif"><br><br>  Todo el c√≥digo del proyecto est√° disponible en <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">GitHub</a> . <br><br><h3>  El enfoque </h3><br>  El objetivo era implementar la aplicaci√≥n web lo m√°s r√°pido posible.  Para esto, eleg√≠ Flask, que te permite escribir aplicaciones en Python.  No me gusta jugar con estilos (creo que ya lo has visto), as√≠ que copio y pego casi todo CSS de fuentes de terceros.  Este <a href="https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html">art√≠culo</a> del equipo de Keras fue √∫til para aprender los conceptos b√°sicos, y tambi√©n es una gu√≠a √∫til. <br><blockquote>  <i>En general, este proyecto cumple con mis principios de dise√±o: crear un prototipo que funcione r√°pidamente (copiando y pegando tanto c√≥digo como sea necesario), y luego repita lo mismo para mejorar el producto.</i> </blockquote><h3>  Aplicaci√≥n web b√°sica en Flask </h3><br>  La forma m√°s r√°pida de crear una aplicaci√≥n web de Python es utilizar Flask (http://flask.pocoo.org/).  Para crear nuestra propia aplicaci√≥n, podemos usar lo siguiente: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Not Much Going On Here&lt;/h1&gt;"</span></span> app.run(host=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, port=<span class="hljs-number"><span class="hljs-number">50000</span></span>)</code> </pre> <br>  Si ejecuta este c√≥digo, ver√° su propia aplicaci√≥n en localhost: 50000.  Por supuesto, necesitamos algo m√°s, por lo que utilizaremos una funci√≥n m√°s compleja que generalmente hace lo mismo: procesa las solicitudes de su navegador y sirve alg√∫n contenido en forma de HTML. <br><br><h3>  Formulario de entrada del usuario </h3><br>  Cuando los usuarios acceden a la p√°gina principal de la aplicaci√≥n, les mostraremos un formulario con tres opciones: <br><br><ol><li>  Ingrese la secuencia de origen para el RNN o al azar genere. </li><li>  Selecci√≥n de la "diversidad" de pron√≥sticos RNN. </li><li>  La elecci√≥n del n√∫mero de palabras que salen del RNN. </li></ol><br>  Para crear un formulario en Python, usamos <a href="https://wtforms.readthedocs.io/">wtforms</a> .  Ver√° el c√≥digo para su creaci√≥n a continuaci√≥n: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> (Form, TextField, validators, SubmitField, DecimalField, IntegerField) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReusableForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Form)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""User entry form for entering specifics for generation"""</span></span> <span class="hljs-comment"><span class="hljs-comment"># Starting seed seed = TextField("Enter a seed string or 'random':", validators=[ validators.InputRequired()]) # Diversity of predictions diversity = DecimalField('Enter diversity:', default=0.8, validators=[validators.InputRequired(), validators.NumberRange(min=0.5, max=5.0, message='Diversity must be between 0.5 and 5.')]) # Number of words words = IntegerField('Enter number of words to generate:', default=50, validators=[validators.InputRequired(), validators.NumberRange(min=10, max=100, message='Number of words must be between 10 and 100')]) # Submit button submit = SubmitField("Enter")</span></span></code> </pre> <br>  Utiliz√°ndolo, creamos el formulario que se muestra a continuaci√≥n (con estilos de <code>main.css</code> ): <br><br><img src="https://habrastorage.org/webt/ja/mc/2j/jamc2jeigbqz87z4flruuzuzp4e.png"><br><br>  Es necesario verificar el c√≥digo para asegurarse de que el usuario ingrese la informaci√≥n correcta.  Por ejemplo, verificamos que todos los campos est√©n llenos, y que el valor del par√°metro de diversidad est√© entre 0.5 y 5. Estas condiciones deben cumplirse para comenzar. <br><br><img src="https://habrastorage.org/webt/wz/wy/e2/wzwye2lrn8rrnfdp1lemj9hf4p4.png"><br>  <i>Error al validar los datos ingresados</i> <br><br>  Procesamos este formulario usando plantillas en <code>Flask</code> . <br><br><h3>  Patrones </h3><br>  Una plantilla es un archivo con un "marco" ya preparado que simplemente necesita ser llenado de cierta manera.  Para una aplicaci√≥n web Flask, podemos usar la biblioteca de plantillas <a href="http://jinja.pocoo.org/">Jinja</a> para traducir el c√≥digo Python en un documento HTML.  Por ejemplo, en nuestra funci√≥n principal, enviaremos el contenido del formulario a una plantilla llamada <code>index.html</code> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> render_template <span class="hljs-comment"><span class="hljs-comment"># Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Cuando el usuario va a la p√°gina principal, nuestra aplicaci√≥n proporcionar√° <code>index.html</code> entrada del formulario.  La plantilla es una estructura HTML completa en la que nos referimos a las variables de Python usando la sintaxis <code>{{variable}}</code> . <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>RNN Patent Writing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span>Writing Novel Patent Abstracts with Recurrent Neural Networks<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {% for message in form.seed.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.diversity.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.words.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">post</span></span></span><span class="hljs-tag">&gt;</span></span> {{ form.seed.label }} {{ form.seed }} {{ form.diversity.label }} {{ form.diversity }} {{ form.words.label }} {{ form.words }} {{ form.submit }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Cuando se produce un error en el formulario (entrada que no se puede verificar), parpadear√° un mensaje de error.  Adem√°s, el formulario se mostrar√° como en el archivo anterior. <br><br>  Cuando el usuario ingresa informaci√≥n y hace clic en <code>submit</code> (solicitud <code>POST</code> ), si la informaci√≥n es correcta, redirigimos los datos de entrada a la funci√≥n correspondiente para hacer predicciones utilizando RNN capacitado.  Esto significa que necesita modificar <code>home()</code> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request <span class="hljs-comment"><span class="hljs-comment"># User defined utility functions from utils import generate_random_start, generate_from_seed # Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # On form entry and all conditions met if request.method == 'POST' and form.validate(): # Extract information seed = request.form['seed'] diversity = float(request.form['diversity']) words = int(request.form['words']) # Generate a random sequence if seed == 'random': return render_template('random.html', input=generate_random_start(model=model, graph=graph, new_words=words, diversity=diversity)) # Generate starting from a seed sequence else: return render_template('seeded.html', input=generate_from_seed(model=model, graph=graph, seed=seed, new_words=words, diversity=diversity)) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Ahora, cuando el usuario presiona <code>submit</code> y la informaci√≥n ingresada es correcta, dependiendo de la entrada, la entrada se env√≠a a <code>generate_random_start</code> o <code>generate_from_seed</code> .  Estas caracter√≠sticas utilizan el modelo entrenado de Keras para crear una nueva patente con el usuario y los par√°metros de <code>diversity</code> <code>num_words</code> .  El resultado de esta funci√≥n, a su vez, se env√≠a aleatoriamente a plantillas <code>random.html</code> o <code>seeded.html</code> para mostrarlas como una p√°gina web. <br><br><h2>  Crear predicciones usando el modelo pre-entrenado de Keras </h2><br>  El par√°metro par√°metro contiene el modelo Keras previamente entrenado, que se carga de la siguiente manera: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_keras_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Load in the pre-trained model"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> model model = load_model(<span class="hljs-string"><span class="hljs-string">'../models/train-embeddings-rnn.h5'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Required for model to work global graph graph = tf.get_default_graph() load_keras_model()</span></span></code> </pre> <br>  (Esencialmente, hay una soluci√≥n alternativa que se parece a <code>tf.get_default_graph()</code> ) <br>  No mostrar√© completamente dos funciones de <code>util</code> (el c√≥digo que encontrar√° <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py">aqu√≠</a> ), porque todo lo que necesita entender es que almacenan el modelo Keras ya entrenado junto con los par√°metros y hacen predicciones, anotaciones de patentes. <br><br>  Ambas funciones devuelven una cadena en Python con HTML formateado.  Esta l√≠nea se env√≠a a otra plantilla, que aparecer√° como una p√°gina web.  Por ejemplo, <code>generate_random_start</code> devuelve HTML con formato que se env√≠a a <code>random.html</code> : <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Random Starting Abstract <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {{input|safe}} {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Aqu√≠ nuevamente usamos el motor de plantillas <code>Jinja</code> para mostrar un archivo HTML formateado.  Como la cadena de Python ya est√° traducida a HTML, todo lo que tenemos que hacer para mostrarla es usar <code>{{input|safe}}</code> (donde <code>input</code> es una variable de Python).  Luego, en <code>main.css</code> , podemos agregar estilos a esta p√°gina, as√≠ como a otras p√°ginas HTML. <br><br><h3>  Resultado del trabajo </h3><br>  La funci√≥n <code>generate_random_start</code> selecciona una anotaci√≥n de patente aleatoria como una secuencia de entrada y hace predicciones basadas en ella.  Luego muestra la secuencia de entrada, la salida generada por RNN y la salida real: <br><br><img src="https://habrastorage.org/webt/z_/2y/6q/z_2y6q7q7xalfmwihsw3ohxwuza.png"><br>  <i>La salida se basa en una secuencia de entrada aleatoria.</i> <br><br>  La funci√≥n <code>generate_from_seed</code> acepta la secuencia inicial ingresada por el usuario y crea pron√≥sticos basados ‚Äã‚Äãen ella.  El resultado es el siguiente: <br><br><img src="https://habrastorage.org/webt/vd/4t/xw/vd4txwgqdyresaxrd5a0midnosm.png"><br>  <i>Salida basada en la secuencia de entrada del usuario.</i> <br><br>  Aunque los resultados no siempre forman secuencias l√≥gicas, muestran que la red neuronal est√° familiarizada con los conceptos b√°sicos del idioma ingl√©s.  Fue entrenada para predecir cada palabra siguiente en base a las 50 anteriores y, por lo tanto, seleccionar una anotaci√≥n convincente.  Dependiendo del par√°metro de <code>diversity</code> , la salida puede ser completamente aleatoria o c√≠clica. <br><br><h3>  Lanzamiento de la aplicaci√≥n </h3><br>  Para iniciar la aplicaci√≥n usted mismo, todo lo que necesita hacer es descargar el repositorio, ir al directorio donde se encuentra la implementaci√≥n e ingresar <code>run_keras_server.py</code> .  La aplicaci√≥n estar√° disponible en <code>localhost:10000</code> . <br><br>  Dependiendo de c√≥mo est√© configurado el Wi-Fi de su hogar, deber√≠a poder acceder a la aplicaci√≥n desde cualquier computadora en la red utilizando su direcci√≥n IP. <br><br><h3>  Pr√≥ximos pasos </h3><br>  La aplicaci√≥n web que se ejecuta en su computadora personal es ideal para compartir con amigos y familiares.  Sin embargo, definitivamente no recomiendo abrirlo a todos en su red dom√©stica.  M√°s adelante aprenderemos c√≥mo implementar la aplicaci√≥n en <a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">AWS EC2</a> y finalmente mostrarla al mundo. <br><br>  Para mejorar la aplicaci√≥n, puede cambiar los estilos ( <a href="">en main.css</a> ) y, opcionalmente, agregar par√°metros adicionales, como la capacidad de seleccionar una <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models">red</a> previamente capacitada.  Lo mejor de los proyectos personales es que puedes desarrollarlos todo el tiempo que quieras.  Si quieres jugar con la aplicaci√≥n, descarga el <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">repositorio</a> y comienza. <br><br><img src="https://habrastorage.org/webt/hu/z9/up/huz9upmw2zstf5wdojoflzsrxey.gif"><br><br><h2>  Conclusi√≥n </h2><br>  En este art√≠culo, aprendimos c√≥mo implementar un modelo de aprendizaje profundo pre-entrenado de Keras como una aplicaci√≥n web.  Esto requer√≠a la integraci√≥n de varias tecnolog√≠as diferentes, incluidas redes neuronales recurrentes, aplicaciones web, plantillas, HTML, CSS y, por supuesto, <a href="https://www.python.org/">Python</a> . <br><br>  Aunque esta es una aplicaci√≥n b√°sica, muestra que puede crear aplicaciones web utilizando el aprendizaje profundo con relativamente poco esfuerzo.  Pocas personas pueden decir que pudieron implementar un modelo de aprendizaje profundo en forma de una aplicaci√≥n web, pero si sigues las instrucciones de este art√≠culo, ¬°puedes convertirte en uno de ellos! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477402/">https://habr.com/ru/post/477402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477388/index.html">NILFS2 - sistema de archivos a prueba de balas para / home</a></li>
<li><a href="../477390/index.html">Depuraci√≥n de retrasos en la red en Kubernetes</a></li>
<li><a href="../477392/index.html">Micr√≥fono abierto: backend. Invitamos oradores</a></li>
<li><a href="../477396/index.html">C√≥mo inscribirse en un curso y ... ir al final</a></li>
<li><a href="../477400/index.html">Sobre la profesi√≥n de gerente de producto: ¬øc√≥mo lograr el ideal?</a></li>
<li><a href="../477404/index.html">El problema de crear y eliminar objetos con frecuencia en C ++</a></li>
<li><a href="../477406/index.html">Soporte t√©cnico y soporte. Gran investigaci√≥n sobre el mercado laboral y los salarios. ¬øQu√© ha cambiado en 2 a√±os?</a></li>
<li><a href="../477408/index.html">Tutorial JavaFX: dise√±os avanzados</a></li>
<li><a href="../477414/index.html">Ingeniero de datos: la profesi√≥n m√°s sexy del siglo XXI</a></li>
<li><a href="../477416/index.html">¬øCu√°ndo es perjudicial para el hach√≠s?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>