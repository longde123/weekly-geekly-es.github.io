<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßî ü¶Ö üà∑Ô∏è Encontrar Twitch Streamers en una partida de PUBG ‚ò¶Ô∏è üõçÔ∏è üèµÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recientemente, junto con las repeticiones de minmax.gg/chickendinner , lanzamos una nueva funci√≥n que muestra los videos transmitidos por los streamer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Encontrar Twitch Streamers en una partida de PUBG</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438294/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b8/261/fcb/0b8261fcbf965321f750c1e272b37339.jpg" alt="imagen"></div><br>  Recientemente, junto con las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">repeticiones de</a> minmax.gg/chickendinner <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">,</a> lanzamos una nueva funci√≥n que muestra los videos transmitidos por los streamers de PUBG Twitch participantes.  Para implementarlo, necesit√°bamos reconocer a los streamers de Twitch por sus nombres en el juego, lo que result√≥ ser una tarea bastante interesante. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/728/4b0/b8f/7284b0b8f675134aa04dc46398a52e1b.gif"></div><br>  <i>Nuestra nueva funci√≥n de Twitch en acci√≥n.</i> <br><br><h2>  La probabilidad de que juegues en el mismo partido con el streamer </h2><br>  Antes de comenzar a desarrollar esta funci√≥n, quer√≠amos asegurarnos de que la probabilidad de un partido en el que uno de los jugadores transmitiera en Twitch fuera lo suficientemente grande como para justificar nuestros esfuerzos.  Podemos hacer una estimaci√≥n muy aproximada mirando el n√∫mero de jugadores activos y compar√°ndolo con el n√∫mero de transmisiones activas. <br><br>  En el momento de escribir este art√≠culo, el juego transmiti√≥ en Twitch alrededor de 2100 usuarios, y en Steam hab√≠a alrededor de 700 mil jugadores activos en PUBG.  Esto significa que en ese momento los streamers representaban aproximadamente el 0.3% de la base de jugadores. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a6/ca3/24f/5a6ca324f8fb9d22756caec476464959.png"></div><br>  Dado que 100 personas juegan el partido con mayor frecuencia, la probabilidad de que al menos uno de ellos sea una serpentina es lo opuesto a la probabilidad de que <em>nadie</em> sea ‚Äã‚Äãuna serpentina.  Dado que la probabilidad de que el jugador no sea un streamer es del 99,7%, la probabilidad de que ninguno de los 100 jugadores sea un streamer es de 0,997 a la potencia de 100, es decir, 0,74.  En otras palabras, en cualquier partido hay aproximadamente un 25 por ciento de posibilidades de encontrar al menos un jugador transmitiendo en Twitch. <br><br>  Vale la pena se√±alar que podemos suponer en Twitch un fuerte cambio hacia la regi√≥n de Am√©rica del Norte en comparaci√≥n con la base general de jugadores de PUBG, por lo que si ve partidos desde Am√©rica del Norte, el porcentaje probablemente ser√° mucho mayor. <br><br><h2>  Adivina los nombres </h2><br>  Ahora que sabemos que hay una buena posibilidad de encontrar un transmisor en cualquier partido elegido, ¬øc√≥mo sabemos si un jugador est√° transmitiendo un juego en Twitch? <br><br>  Para obtener bonos adicionales, puede conectar su cuenta de Twitch al juego, pero, desafortunadamente, estos datos no est√°n disponibles en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">API de PUBG</a> .  Necesitamos otra forma de vincular el nombre del jugador al streamer en Twitch. <br><br>  Veamos un transmisor hipot√©tico con un nombre de cuenta de <em>Mitch</em> .  Mitch juega regularmente en PUBG, pero su canal Twitch a√∫n no ha alcanzado el nivel de vistas con el que sue√±a.  Tras reflexionar, cambia su nombre en el juego a <em>TwitchMitch</em> .  Ahora todos saben que Mitch transmite en Twitch. <br><br>  Este principio es muy com√∫n, a veces con variaciones ligeramente diferentes: <em>TTVMitch</em> o <em>Mitch_TV</em> .  Dichos nombres se pueden detectar mediante programaci√≥n y determinar a partir de ellos una cuenta en Twitch, lo que nos permite recibir videos para mostrar en la repetici√≥n del partido. <br><br><h2>  Mapeo manual </h2><br>  Este enfoque nos da un muy buen punto de referencia, pero est√° lejos de ser suficiente.  Los nombres de los streamers m√°s populares no coinciden con este patr√≥n.  Para encontrarlos, debe vincular individualmente desde la cuenta PUBG al nombre de su canal de Twitch. <br><br>  Para hacer frente a esto, comenzamos a buscar manualmente los streamers m√°s populares en Twitch y a registrar los nombres de cuenta en el juego que son visibles en la pantalla.  Si tienes suerte, podr√°s ver el momento en que el jugador est√° esperando en el lobby, donde puedes encontrar el nombre en varios lugares: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e0/2b0/d11/7e02b0d118ff09436f925b0e641e8c38.png"></div><br>  Sin embargo, es mucho m√°s probable encontrar un jugador que ya est√© jugando en el partido.  Si juega con el equipo, su nombre siempre ser√° visible en la esquina inferior izquierda: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad8/030/bda/ad8030bda4f3f0bc2ebf969b90fa612b.png"></div><br>  Sin embargo, es necesario calcular cu√°l de los nombres le pertenece, porque no siempre ser√° el mismo.  La forma m√°s f√°cil de hacer esto es mirar el minimapa en la esquina inferior derecha, que se centra en el marcador del jugador, marcado con un n√∫mero y un color. <br><br>  El enfoque m√°s hol√≠stico ser√° estudiar la parte inferior central de la pantalla, donde puede encontrar lo siguiente: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/405/15c/f0b/40515cf0b945f4a13e4f9363054bee81.png"></div><br>  Este texto contiene el nombre de la cuenta, la versi√≥n actual del juego, los √∫ltimos 6 caracteres del identificador del partido y la regi√≥n del servidor.  Vale la pena considerar que no siempre es tan limpio como se muestra arriba, porque generalmente se mezcla con lo que sucede detr√°s de √©l en la pantalla.  El texto es peque√±o, lo que significa que puede ser borroso y mal le√≠do cuando ocurren artefactos serios de video.  Pero tarde o temprano captar√° un marco lo suficientemente bueno como para leerlo. <br><br>  Quiz√°s ya est√© pensando en lo que nos dimos cuenta en ese momento: ¬°esta es una tarea ideal para una soluci√≥n inform√°tica autom√°tica! <br><br><h2>  Visi√≥n por computadora </h2><br>  En condiciones ideales, el algoritmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">OCR</a> debe reconocer lo que est√° escrito en el texto a continuaci√≥n.  Despu√©s de probar un par de opciones, finalmente decidimos que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">API de</a> Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="noopener">Cloud Vision</a> ofrece los mejores resultados.  Podemos crear un script que haga lo siguiente: <br><br><ol><li>  Obtiene una transmisi√≥n de PUBG en vivo y recorta la parte inferior de la captura de pantalla ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Twitch API</a> proporciona una imagen de vista previa de tama√±o completo, por lo que no necesitamos tomar capturas de pantalla nosotros mismos). </li><li>  Env√≠a una captura de pantalla a la API de Cloud Vision y analiza el nombre del jugador a partir del resultado. </li><li>  Verifica a trav√©s de la API de PUBG que el reproductor existe y luego guarda la cuenta de Twitch de la cuenta de PUBG en nuestra base de datos. </li></ol><br>  Esto funcionar√° muy bien, excepto por un peque√±o detalle: Google solicita $ 1.5 por cada mil solicitudes a la API de Cloud Vision.  En cualquier momento, puede haber alrededor de 2-3 mil transmisores activos, por lo que incluso una sola ejecuci√≥n del script nos costar√° hasta $ 4.5.  Teniendo en cuenta el hecho de que es probable que obtengamos muchas capturas de pantalla con texto ilegible, deber√° ejecutar el script varias veces para obtener una cantidad significativa de datos.  En otras palabras, este enfoque se convertir√° r√°pidamente en una tarea muy costosa.  Afortunadamente, podemos organizar solicitudes de Cloud Vision un poco m√°s inteligentes.  Podemos aprovechar el hecho de que Google solicita el pago de solicitudes individuales, independientemente del tama√±o de la imagen.  Es decir, podemos conectar muchas im√°genes a la cuadr√≠cula: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e90/1ec/f4b/e901ecf4b93fdedc2fa645feee12912f.png"></div><br>  Luego enviamos esta cuadr√≠cula de imagen a la API y adjuntamos el texto resultante a la unidad de cinta correspondiente al √°rea en la que se encontr√≥ el texto. <br><br>  Existe un l√≠mite en el tama√±o de los datos enviados por Google al mismo tiempo, por lo que tomaremos 300 im√°genes pegadas para una solicitud.  Esto significa que ahora podemos ejecutar el mismo script 300 veces al mismo precio que antes, lo que hace que este enfoque sea muy viable y efectivo. <br><br><h2>  Completa los √∫ltimos huecos </h2><br>  Nuestro gui√≥n funcion√≥ durante un par de semanas, y hasta ahora hemos obtenido 25 mil comparaciones entre Twitch y PUBG.  Sin embargo, el script no pudo vincular a algunos streamers, por ejemplo, aquellos que tienen su propia superposici√≥n en la parte superior del texto en la parte inferior de la pantalla. <br><br>  Tenemos que vincular estos streamers manualmente.  En lugar de hacer esto por nuestra cuenta, decidimos agregar una funci√≥n que permita a nuestros visitantes enviar el nombre de cualquier transmisor que no encontraron en nuestra base de datos: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4cd/180/4ce/4cd1804ce5d78b7f9cad545af3544b41.png"></div><br>  Estaremos encantados de seguir experimentando con los m√©todos para obtener estos pares de cuentas, y a√∫n m√°s queremos encontrar nuevas formas de utilizar la informaci√≥n existente.  ¬°Espere nuevos art√≠culos de nosotros! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/438294/">https://habr.com/ru/post/438294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../438280/index.html">"Eliminar" objetos en Django</a></li>
<li><a href="../438286/index.html">Trabajando con zonas horarias en JavaScript</a></li>
<li><a href="../438288/index.html">Protecci√≥n sin miedo. Seguridad de memoria en √≥xido</a></li>
<li><a href="../438290/index.html">Post-mortem con GGJ-2019: c√≥mo obtener golpes, pero a√∫n as√≠ hacer el juego</a></li>
<li><a href="../438292/index.html">Automatizaci√≥n de apartamentos con HomePod, Raspberry Pi y Node.js</a></li>
<li><a href="../438296/index.html">OpenSceneGraph: Sistema de complementos</a></li>
<li><a href="../438298/index.html">¬øPor qu√© ense√±ar si el desarrollo es m√°s rentable? Conversaci√≥n con GeekBrains</a></li>
<li><a href="../438302/index.html">La incre√≠ble creatividad de la evoluci√≥n digital.</a></li>
<li><a href="../438304/index.html">Subcontrataci√≥n? Genial, golpeas</a></li>
<li><a href="../438306/index.html">Radiaci√≥n: Laboratorio radioqu√≠mico de lunes a viernes.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>