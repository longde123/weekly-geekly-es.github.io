<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úÇÔ∏è ‚öìÔ∏è ‚õ∑Ô∏è Monorepositories: bitte üòó üë®üèæ‚Äç‚öñÔ∏è üëÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine √úbersetzung des Artikels wurde f√ºr Studenten des DevOps Practices and Tools- Kurses im OTUS- Bildungsprojekt erstellt. 



 Sie sollten ein Mono-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Monorepositories: bitte</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/453958/"><p><img src="https://habrastorage.org/webt/zb/qs/gu/zbqsgutqkd38ocudlbvzx5zeldc.png" alt="Bild"></p><br><p>  <em>Eine √úbersetzung des Artikels wurde f√ºr Studenten des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevOps Practices and Tools-</a> Kurses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im OTUS-</a> Bildungsprojekt erstellt.</em> </p><br><hr><br><p>  Sie sollten ein Mono-Repository ausw√§hlen, da das Verhalten, das es in Ihren Teams f√∂rdert, Transparenz und kollektive Verantwortung ist, insbesondere wenn Teams wachsen.  In jedem Fall m√ºssen Sie in Tools investieren, aber es ist immer besser, wenn das Standardverhalten das Verhalten ist, das Sie in Ihren Befehlen sehen m√∂chten. <a name="habracut"></a></p><br><h1 id="pochemu-my-govorim-ob-etom">  Warum reden wir dar√ºber? </h1><br><p>  Matt Klein schrieb einen Artikel: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Monorepos: Bitte nicht!"</a>  (Kommentar des √úbersetzers: √úbersetzung auf einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hub "Monorepositories: bitte nicht"</a> ).  Ich mag Matt, ich denke er ist sehr schlau und du solltest seinen Standpunkt lesen.  Er hat urspr√ºnglich die Umfrage getwittert: </p><br><p><img src="https://habrastorage.org/webt/x2/pl/sm/x2plsmnmw3xzn-hoeo7ksirx1rm.png" alt="Bild"></p><br><p>  <em>√úbersetzung:</em> <br>  <em>An diesem Neujahrstag werde ich dar√ºber streiten, wie l√§cherlich die Monorepositories sind.</em>  <em>2019 begann unbemerkt.</em>  <em>In diesem Sinne biete ich Ihnen eine Umfrage an.</em>  <em>Wer sind die gro√üen Fanatiker?</em>  <em>Unterst√ºtzer:</em> <br>  - <em>Monorepository</em> <br>  - <em>Rost</em> <br>  - <em>Falsche Umfrage / sowohl diese als auch diese</em> </p><br><p>  Meine Antwort war: "Ich bin buchst√§blich beide diese Leute."  Anstatt dar√ºber zu sprechen, welche Art von Rust-Droge wir haben, wollen wir herausfinden, warum er meiner Meinung nach in Bezug auf Mono-Repositories falsch liegt.  Ein bisschen √ºber dich.  Ich bin der CTO von Chef Software.  Wir haben ungef√§hr 100 Ingenieure, eine Codebasis von ungef√§hr 11-12 Jahren und 4 Hauptprodukte.  Ein Teil dieses Codes befindet sich im Polyrepository (meine Startposition), ein Teil im Monorepository (meine aktuelle Position). </p><br><p>  Bevor ich anfange: Jedes Argument, das ich hier zitiere, wird auf beide Arten von Repositorys angewendet.  Meiner Meinung nach gibt es keine technischen Gr√ºnde, warum Sie den einen oder anderen Repository-Typ w√§hlen sollten.  Sie k√∂nnen jeden Ansatz zum Laufen bringen.  Ich bin froh dar√ºber zu sprechen, aber ich interessiere mich nicht f√ºr die k√ºnstlichen technischen Gr√ºnde, warum einer dem anderen √ºberlegen ist. </p><br><p>  Ich stimme dem ersten Teil von Matts Standpunkt zu: </p><br><p>  <em>Denn im gro√üen Ma√üstab l√∂st das Monorepository dieselben Probleme, die das Polyrepository l√∂st, provoziert Sie jedoch gleichzeitig zu einer starken Koh√§renz Ihres Codes und erfordert unglaubliche Anstrengungen, um die Skalierbarkeit Ihres Versionskontrollsystems zu verbessern.</em> </p><br><p>  Sie m√ºssen dieselben Probleme l√∂sen, unabh√§ngig davon, ob Sie ein Monorepository oder ein Polyrepository ausw√§hlen.  Wie ver√∂ffentlichen Sie Releases?  Wie gehen Sie mit Updates um?  Abw√§rtskompatibel?  Projekt√ºbergreifende Abh√§ngigkeiten?  Welche Baustile sind akzeptabel?  Wie verwalten Sie Ihre Build- und Testinfrastruktur?  Die Liste ist endlos.  Und Sie werden sie alle l√∂sen, wenn Sie wachsen.  Es gibt keinen freien K√§se. </p><br><p>  Ich denke, Matts Argument √§hnelt den Ansichten vieler Ingenieure (und Manager), die ich respektiere.  Dies geschieht aus Sicht des Ingenieurs, der an der Komponente arbeitet, oder des Teams, das an der Komponente arbeitet.  Sie h√∂ren Dinge wie: </p><br><ul><li>  Die Codebasis ist umst√§ndlich - ich brauche diesen ganzen M√ºll nicht. </li><li> Dies ist schwieriger zu testen, da ich all diesen M√ºll √ºberpr√ºfen muss, den ich nicht brauche. </li><li>  Es ist schwieriger, mit externen Abh√§ngigkeiten zu arbeiten. </li><li>  Ich ben√∂tige meine eigenen virtuellen Versionskontrollsysteme. </li></ul><br><p>  Nat√ºrlich sind alle diese Punkte vern√ºnftig.  Dies passiert in beiden F√§llen - im Polyrepository habe ich meine eigenen Sachen, au√üer denen, die f√ºr die Montage ben√∂tigt werden ... Ich brauche m√∂glicherweise auch andere Sachen.  Daher erstelle ich "nur" Tools, die das gesamte Projekt auschecken.  Oder erstelle ich ein gef√§lschtes Mono-Repository mit Submodulen?  Wir k√∂nnten den ganzen Tag herumlaufen.  Aber ich denke, Matts Argumentation verfehlt den Hauptgrund, den ich so ziemlich zugunsten des Monorepositorys umgedreht habe: </p><br><h1 id="on-provociruet-obschenie-i-pokazyvaet-problemy">  Es provoziert Kommunikation und zeigt Probleme. </h1><br><p>  Wenn wir Repositories gemeinsam nutzen, entsteht de facto ein Koordinierungs- und Transparenzproblem.  Dies entspricht der Art und Weise, wie wir √ºber Teams denken (insbesondere wie einzelne Teilnehmer √ºber sie denken): Wir sind f√ºr eine bestimmte Komponente verantwortlich.  Wir arbeiten relativ isoliert.  Die Grenzen sind f√ºr mein Team und die Komponente (n) festgelegt, an denen wir arbeiten. </p><br><p>  Aufgrund der Komplexit√§t der Architektur kann ein Team sie nicht mehr alleine verwalten.  Nur sehr wenige Ingenieure behalten das gesamte System im Kopf.  Angenommen, Sie steuern eine gemeinsame Komponente A, die von den Befehlen B, C und D verwendet wird. Team A √ºberarbeitet die API, verbessert die API und √§ndert auch die interne Implementierung.  √Ñnderungen sind daher abw√§rtskompatibel.  Welchen Rat w√ºrden Sie geben? </p><br><ul><li>  Finden Sie alle Stellen, an denen die alte API verwendet wird. </li><li>  Gibt es Orte, an denen die neue API nicht verwendet werden kann? </li><li>  K√∂nnen Sie andere Komponenten reparieren und testen, um sicherzustellen, dass sie nicht kaputt gehen? </li><li>  K√∂nnen diese Teams Ihre √Ñnderungen jetzt √ºberpr√ºfen? </li></ul><br><p>  Bitte beachten Sie, dass diese Fragen unabh√§ngig von der Art des Repositorys sind.  Sie m√ºssen die Teams B, C und D finden. Sie m√ºssen mit ihnen sprechen, die Zeit herausfinden und ihre Priorit√§ten verstehen.  Zumindest hoffen wir, dass Sie es tun. </p><br><p>  Niemand will das wirklich tun.  Das macht viel weniger Spa√ü als nur die verdammte API zu reparieren.  Das alles ist menschlich und verwirrt.  Im Repository k√∂nnen Sie einfach √Ñnderungen vornehmen, denjenigen, die an dieser Komponente arbeiten (wahrscheinlich nicht B, C oder D), eine √úberpr√ºfung geben und fortfahren.  Die Teams B, C und D k√∂nnen einfach auf ihrer aktuellen Version bleiben.  Sie werden aktualisiert, wenn sie Ihr Genie erkennen! </p><br><p>  In einem einzelnen Repository wird die Verantwortung standardm√§√üig verschoben.  Team A √§ndert seine Komponente und bricht, wenn es nicht vorsichtig ist, sofort B, C und D. Dadurch erscheinen B, C und D an T√ºr A und fragen sich, warum Team A die Baugruppe gebrochen hat.  Dies lehrt A, dass sie meine Liste oben nicht √ºberspringen k√∂nnen.  Sie sollten dar√ºber sprechen, was sie tun werden.  K√∂nnen sich B, C und D bewegen?  Was ist, wenn B und C k√∂nnen, aber D eng mit einem Nebeneffekt des alten Algorithmus verbunden war? </p><br><p>  Dann m√ºssen wir dar√ºber sprechen, wie wir aus dieser Situation herauskommen: </p><br><ol><li>  Unterst√ºtzung f√ºr mehrere interne APIs, w√§hrend der alte Algorithmus als veraltet markiert wird, bis D ihn nicht mehr verwenden kann. </li><li>  Unterst√ºtzung f√ºr mehrere Versionen von Releases, eine mit der alten Schnittstelle, eine mit der neuen. </li><li>  Verz√∂gerte Freigabe von √Ñnderungen an A, bis sowohl B, C als auch D dies akzeptieren k√∂nnen. </li></ol><br><p>  Angenommen, wir w√§hlen 1, mehrere APIs aus.  In diesem Fall haben wir zwei Codeteile.  Alt und neu.  In manchen Situationen ziemlich praktisch.  Wir geben den alten Code zur√ºck, markieren ihn als veraltet und vereinbaren mit dem Befehl D einen Zeitplan f√ºr das Entfernen. Er ist im Wesentlichen f√ºr Poly und f√ºr das Mono-Repository identisch. </p><br><p>  Um mehrere Versionen freizugeben, ben√∂tigen wir einen Zweig.  Jetzt haben wir zwei Komponenten - A1 und A2.  Die Teams B und C verwenden A2 und D A1.  Wir ben√∂tigen jede Komponente, um zur Ver√∂ffentlichung bereit zu sein, da m√∂glicherweise Sicherheitsupdates und andere Fehlerkorrekturen erforderlich sind, bevor D fortfahren kann.  Im Repository k√∂nnen wir es in einem langlebigen Zweig verstecken, der sich gut anf√ºhlt.  Im Mono-Repository erzwingen wir den Code im neuen Modul.  Team D muss noch √Ñnderungen an der "alten" Komponente vornehmen.  Jeder kann die Kosten sehen, die wir hier bezahlen - wir haben jetzt doppelt so viel Code, und alle Fehlerbehebungen, die f√ºr A1 und A2 gelten, sollten auf beide angewendet werden.  Mit dem Ansatz, Zweige in einem Repository zu verwenden, ist dies hinter Cherry-Pick verborgen.  Wir betrachten die Kosten als geringer, da es keine Doppelarbeit gibt.  Aus praktischer Sicht sind die Kosten gleich: Sie erstellen, ver√∂ffentlichen und verwalten zwei im Grunde identische Codebasen, bis Sie eine davon l√∂schen k√∂nnen.  Der Unterschied besteht darin, dass dieser Schmerz im Monorepository direkt und sichtbar ist.  <strong>Das ist noch schlimmer und gut.</strong> </p><br><p>  Schlie√ülich kamen wir zum dritten Punkt.  Verz√∂gerung freigeben.  Es ist m√∂glich, dass die von A vorgenommenen √Ñnderungen das Leben von Team A verbessern. Es ist wichtig, aber nicht dringend.  K√∂nnen wir einfach durchhalten?  Im Repository dr√§ngen wir darauf, um das Artefakt zu konsolidieren.  Nat√ºrlich sprechen wir √ºber dieses Team D. Bleiben Sie einfach bei der alten Version, bis Sie aufholen!  Dies schafft ein Feiglingsspiel.  Team A arbeitet weiter an seiner Komponente und ignoriert die Tatsache, dass Team D eine zunehmend veraltete Version verwendet (dies ist ein Problem f√ºr Team D, sie sind dumm).  In der Zwischenzeit spricht Team D schlecht √ºber die nachl√§ssige Haltung von Team A gegen√ºber der Codestabilit√§t, wenn √ºberhaupt.  Monate vergehen.  Schlie√ülich beschlie√üt das D-Team, sich die Upgrade-Option anzusehen, aber es gibt nur weitere √Ñnderungen an A.  Team A erinnert sich kaum daran, wann und wie sie D gebrochen haben. Die Aktualisierung ist schmerzhafter und dauert l√§nger.  Was es weiter unten im Priorit√§tsstapel sendet.  Bis zu diesem Tag, bis wir ein Sicherheitsproblem in A haben, das uns zwingt, eine Niederlassung zu gr√ºnden.  Team A muss in der Zeit zur√ºckgehen, den Moment finden, in dem D stabil war, das Problem dort beheben und es f√ºr die Ver√∂ffentlichung vorbereiten.  <strong>Dies ist de facto die Wahl, die die Menschen treffen, und es ist bei weitem die schlimmste.</strong>  Dies scheint sowohl f√ºr Team A als auch f√ºr Team D gut zu sein, solange wir uns gegenseitig ignorieren k√∂nnen. </p><br><p>  Im Monorepository ist das dritte wirklich keine Option.  Sie sind gezwungen, auf zwei Arten mit der Situation umzugehen.  Sie m√ºssen die Kosten f√ºr zwei Release-Zweige sehen.  Erfahren Sie, wie Sie sich vor Updates sch√ºtzen, die die Abw√§rtskompatibilit√§t beeintr√§chtigen.  Aber Hauptsache: <em>Sie k√∂nnen ein schwieriges Gespr√§ch nicht vermeiden.</em> </p><br><p>  Nach meiner Erfahrung ist es nicht mehr m√∂glich, das gesamte System im Auge zu behalten, wenn Teams gro√ü werden, und dies ist der wichtigste Teil.  Sie m√ºssen die Sichtbarkeit von Meinungsverschiedenheiten im System verbessern.  Sie m√ºssen aktiv daran arbeiten, dass Teams ihre Augen von ihren Komponenten abwenden und die Arbeit anderer Teams und Verbraucher betrachten. </p><br><p>  Ja, Sie k√∂nnen Tools erstellen, mit denen versucht wird, das Problem der Polyrepositorys zu l√∂sen.  Meine Erfahrung im Unterrichten von kontinuierlicher Bereitstellung und Automatisierung in gro√üen Unternehmen zeigt mir jedoch Folgendes: Das Standardverhalten ohne Verwendung zus√§tzlicher Tools ist das Verhalten, das Sie erwarten.  <strong>Das Standardverhalten des Repositorys ist Isolation, das ist der springende Punkt.</strong>  <strong>Das Standardverhalten eines Mono-Repositorys ist gemeinsame Verantwortung und Transparenz. Das ist der springende Punkt.</strong>  In beiden F√§llen werde ich ein Werkzeug erstellen, das scharfe Ecken gl√§ttet.  Als F√ºhrungskraft werde ich jedes Mal ein Mono-Repository ausw√§hlen, da die Instrumente die von mir gew√ºnschte Kultur st√§rken m√ºssen und die Kultur aus winzigen Entscheidungen und der t√§glichen Arbeit des Teams resultiert. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453958/">https://habr.com/ru/post/de453958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453942/index.html">√úber Ethik mit dem PMI-Codex-Beispiel</a></li>
<li><a href="../de453944/index.html">Maskierte Bugs in eingebettet</a></li>
<li><a href="../de453950/index.html">Du sollst hier sein! 22 Jahre nach Ver√∂ffentlichung des legend√§ren Spiels Duke Nukem 3D</a></li>
<li><a href="../de453952/index.html">"Die Anfrage ist gereift": Alexei Fedorov √ºber eine neue Konferenz √ºber verteilte Systeme</a></li>
<li><a href="../de453956/index.html">Museum DataArt. Videoterminal ADM-3A. Das Auto ist schwer, zuverl√§ssig, geschlachtet</a></li>
<li><a href="../de453960/index.html">Globales DevOps Bootcamp 2019 in Moskau</a></li>
<li><a href="../de453962/index.html">RxSwift und Coroutines bei Kotlin - optionale mobile Entwicklung von AGIMA und GeekBrains</a></li>
<li><a href="../de453964/index.html">OOP in der R-Sprache (Teil 1): S3-Klassen</a></li>
<li><a href="../de453968/index.html">Verlernen Sie die √úberpr√ºfungspraktiken f√ºr toxischen Code</a></li>
<li><a href="../de453970/index.html">Wir schreiben Reverse socks5 Proxy auf Powershell. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>