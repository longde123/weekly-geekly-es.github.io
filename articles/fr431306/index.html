<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌌 👩🏼‍🤝‍👨🏻 🏓 Comment créer une pyramide dans le tronc ou les applications de développement piloté par les tests sur Spring Boot 🎷 🈲 🐪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le framework Spring est souvent cité comme exemple du framework Cloud Native , conçu pour fonctionner dans le cloud, développer des applications à dou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment créer une pyramide dans le tronc ou les applications de développement piloté par les tests sur Spring Boot</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431306/"><p> <em>Le framework Spring est</em> souvent cité comme exemple du framework <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cloud Native</a> , conçu pour fonctionner dans le cloud, développer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des applications à douze facteurs</a> , des microservices et l'un des produits les plus stables, mais en même temps innovants.  Mais dans cet article, je voudrais m'attarder sur un autre aspect fort de Spring: c'est son support au <em>développement par le biais de tests</em> (capacité TDD?).  Malgré la connectivité TDD, j'ai souvent remarqué que les projets Spring ignoraient certaines des meilleures pratiques pour les tests, inventaient leurs propres vélos ou n'écrivaient pas du tout parce qu'ils étaient "lents" ou "peu fiables".  Et je vais vous dire exactement comment écrire <strong>des</strong> tests <strong>rapides</strong> et <strong>fiables</strong> pour les applications sur Spring Framework et effectuer le développement par le biais de tests.  Donc, si vous utilisez Spring (ou voulez commencer), comprenez quels sont les tests en général (ou voulez comprendre), ou pensez que <code>contextLoads</code> est le niveau nécessaire et suffisant de test d'intégration - ce sera intéressant! </p><a name="habracut"></a><br><p>  La capacité TDD est très ambiguë et mal mesurable, mais Spring a néanmoins beaucoup de choses qui, par conception, aident à écrire l'intégration et les tests unitaires avec un minimum d'effort.  Par exemple: </p><br><ul><li>  Test d'intégration - vous pouvez facilement lancer l'application, verrouiller les composants, redéfinir les paramètres, etc. </li><li>  Concentrez les tests d'intégration - uniquement l'accès aux données, uniquement le Web, etc. </li><li>  Support prêt à l'emploi - bases de données en mémoire, files d'attente de messages, authentification et autorisation dans les tests </li><li>  Test via des contrats (Spring Cloud Contract) </li><li>  Prise en charge des tests de l'interface utilisateur Web à l'aide de HtmlUnit </li><li>  Flexibilité de la configuration de l'application - profils, configurations de test, composants, etc. </li><li>  Et bien plus </li></ul><br><p>  Pour commencer, une petite mais nécessaire introduction sur TDD et les tests en général. </p><br><h1 id="test-driven-development">  Développement piloté par les tests </h1><br><p>  TDD est basé sur une idée très simple - nous écrivons des tests <strong>avant d'</strong> écrire du code.  En théorie, cela semble effrayant, mais après un certain temps, une compréhension des pratiques et des techniques vient, et la possibilité de passer des tests <em>par la suite</em> provoque un inconfort tangible.  L'une des pratiques clés est l' <em>itération</em> , c'est-à-dire  faire tout petit, des itérations ciblées, dont chacune est décrite comme un <strong>Red-Green-Refactor</strong> . </p><br><p>  Dans la phase <strong>rouge</strong> , nous écrivons un test qui tombe, et il est très important qu'il tombe avec une raison et une description claires et compréhensibles, et que le test lui-même soit complet et réussit lorsque le code est écrit.  Le test doit vérifier le <em>comportement</em> , pas l' <em>implémentation</em> , c'est-à-dire  suivez l'approche de la boîte noire, puis je vais vous expliquer pourquoi. </p><br><p>  Dans la phase <strong>verte</strong> , nous écrivons le <em>code minimum nécessaire</em> pour réussir le test.  Parfois, il est intéressant de s'entraîner et de le rendre aussi fou que possible (même s'il vaut mieux ne pas s'emballer) et lorsqu'une fonction retourne un booléen selon l'état du système, le premier "pass" peut simplement être <code>return true</code> . </p><br><p>  Dans la phase de <strong>refactoring</strong> , qui ne <em>peut</em> être lancée que <em>lorsque tous les tests sont verts</em> , nous allons refactoriser le code et le remettre en bon état.  Ce n'est même pas nécessaire pour un morceau de code que nous avons écrit, il est donc important de commencer la refactorisation sur un système stable.  L'approche de la «boîte noire» aidera simplement à refactoriser, à changer l'implémentation, mais sans toucher au comportement. </p><br><p>  Je parlerai des différents aspects du TDD à l'avenir, après tout, c'est l'idée d'une série d'articles, donc maintenant je ne m'attarderai pas particulièrement sur les détails.  Mais avant de répondre aux critiques standard de TDD, je mentionnerai quelques mythes que j'entends souvent. </p><br><ul><li>  <em>"TDD représente une couverture à 100% du code, mais il ne donne aucune garantie"</em> - le développement par le biais de tests n'a aucun rapport avec une couverture à 100%.  Dans de nombreuses équipes où je travaillais, cette métrique n'était même pas mesurée et était classée comme métrique de vanité.  Et oui, une couverture de test à 100% ne veut rien dire. </li><li>  <em>"TDD ne fonctionne que pour des fonctions simples, une vraie application avec une base de données et un état difficile ne peut pas être créé avec elle"</em> est une excuse très populaire, généralement complétée par "Nous avons une application tellement compliquée que nous n'écrivons pas du tout les tests, c'est impossible".  J'ai vu une approche TDD fonctionnelle sur des applications complètement différentes - Web (avec et sans SPA), mobile, API, microservices, monolithes, systèmes bancaires complexes, plateformes cloud, frameworks, plateformes de vente au détail écrites dans différents langages et technologies.  Ainsi, le mythe populaire «Nous sommes uniques, tout est différent» est le plus souvent une excuse pour ne pas investir des efforts et de l'argent dans les tests, mais pas une vraie raison (bien qu'il puisse également y avoir de vraies raisons). </li><li>  <em>«Il y aura toujours des bogues avec TDD»</em> - bien sûr, comme dans tout autre logiciel.  TDD ne concerne pas les bugs ou leur absence, c'est un outil de développement.  Comme le débogage.  Comme un IDE.  Comme la documentation.  Aucun de ces outils ne garantit l'absence de bogues, ils aident seulement à faire face à la complexité croissante du système. </li></ul><br><blockquote>  L'objectif principal du TDD et des tests en général est de donner à l'équipe l' <strong>assurance</strong> que le système fonctionne de manière stable.  Par conséquent, aucune des pratiques de test ne détermine le nombre et les tests à écrire.  Écrivez combien vous pensez nécessaire, combien vous devez être sûr que le code <em>peut être mis en production</em> dès maintenant <em>et qu'il fonctionnera</em> .  Il y a des gens qui considèrent les tests d'intégration rapide comme une boîte noire ultimative nécessaire et suffisante, et les tests unitaires facultatifs.  Quelqu'un dit que les tests e2e avec la possibilité d'un retour rapide à la version précédente et la présence de versions canaries ne sont pas si critiques.  Combien d'équipes - tant d'approches, il est important de trouver la vôtre. </blockquote><p>  L'un de mes objectifs est de m'éloigner du format <em>«développement en testant une fonction qui ajoute deux nombres»</em> dans l'histoire de TDD et de regarder une application réelle, une sorte de pratique de test qui a été évaporée en une application minimale, collectée sur des projets réels.  En tant qu'exemple semi-réel, je vais utiliser une petite application Web que j'ai moi-même inventée pour l'abstrait <del>  usines </del>  Boulangerie - <strong>Pâtisserie</strong> .  Je prévois d'écrire de petits articles, en me concentrant à chaque fois sur un élément distinct des fonctionnalités de l'application et en montrant à travers TDD que vous pouvez concevoir des API, la structure interne de l'application et maintenir une refactorisation constante. </p><br><p>  Voici un exemple de plan pour une série d'articles, tel que je le vois actuellement: </p><br><ol><li>  Walking skeleton - cadre d'application où vous pouvez exécuter le cycle Red-Green-Refactor </li><li>  Test d'interface utilisateur et conception basée sur le comportement </li><li>  Test d'accès aux données (Spring Data) </li><li>  Tests d'autorisation et d'authentification (Spring Security) </li><li>  Jet Stack (WebFlux + Project Reactor) </li><li>  Interopérabilité des (micro) services et contrats (Spring Cloud) </li><li>  Test de Message Queuing (Spring Cloud) </li></ol><br><p>  Cet article d'introduction portera sur les points 1 et 2 - je vais créer un cadre d'application et un test d'interface utilisateur de base en utilisant le BDD - ou <strong>une</strong> approche de <strong>développement axée sur le comportement</strong> .  Chaque article débutera par une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">user story</a> , mais je ne parlerai pas de la partie «produit» pour gagner du temps.  La user story sera écrite en anglais, il sera bientôt clair pourquoi.  Tous les exemples de code peuvent être trouvés sur GitHub, donc je n'analyserai pas tout le code, seulement les parties importantes. </p><br><blockquote>  La user story est une description d'une caractéristique d'une application en langage naturel qui est généralement écrite au nom d'un utilisateur du système. </blockquote><br><h1 id="user-story-1-polzovatel-vidit-stranicu-privetstviya">  User story 1: L'utilisateur voit la page d'accueil </h1><br><blockquote>  <strong>Comme</strong> Alice, un nouvel utilisateur <br>  <strong>Je veux</strong> voir une page d'accueil lors de la visite du site Web de Cake Factory <br>  <strong>Pour que</strong> je sache quand Cake Factory est sur le point de se lancer <br><br>  Critères d'acceptation: <br>  Scénario: un utilisateur visitant le site Web avant la date de lancement <br>  Étant donné que je suis un nouvel utilisateur <br>  Quand je visite le site Web de Cake Factory <br>  Ensuite, je vois un message «Merci pour votre intérêt» <br>  Et je vois un message "Le site Web arrive bientôt ..." </blockquote><p>  Il faudra des connaissances: qu'est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-ce que le développement</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">basé sur</a> le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">comportement</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cucumber</a> , les bases du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring Boot Testing</a> . </p><br><p>  La première user story est assez basique, mais l'objectif n'est pas encore dans la complexité, mais dans la création d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un squelette ambulant</a> - une application minimale pour démarrer le <strong>cycle TDD</strong> . </p><br><p>  Après avoir créé un nouveau projet sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring Initializr</a> avec des modules Web et Moustache, pour commencer, j'aurai besoin de quelques modifications supplémentaires pour <code>build.gradle</code> : </p><br><ul><li>  ajoutez HtmlUnit <code>testImplementation('net.sourceforge.htmlunit:htmlunit')</code> .  Vous n'avez pas besoin de spécifier la version, le plugin de gestion des dépendances Spring Boot pour Gradle sélectionnera automatiquement la version nécessaire et compatible </li><li>  migrer un projet de JUnit 4 vers JUnit 5 (car 2018 est dans la cour) </li><li>  ajouter des dépendances à Cucumber - une bibliothèque que j'utiliserai pour écrire les spécifications BDD </li><li>  supprimer créé par défaut <code>CakeFactoryApplicationTests</code> avec inévitable <code>contextLoads</code> </li></ul><br><p>  En gros, c'est le "squelette" de base de l'application, vous pouvez déjà écrire le premier test. </p><br><p>  Pour faciliter la navigation dans le code, je parlerai brièvement des technologies utilisées. </p><br><h2 id="cucumber">  Concombre </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cucumber</a> est un cadre de <strong>développement axé sur le comportement</strong> qui aide à créer des "spécifications exécutables", c'est-à-dire  exécuter des tests (spécifications) écrits en langage naturel.  Le plugin Cucumber analyse le code source en Java (et dans de nombreux autres langages) et utilise des <em>définitions d'étapes</em> pour exécuter du code réel.  Les définitions d'étape sont des méthodes de classe annotées par <code>@Given</code> , <code>@When</code> , <code>@Then</code> et d'autres annotations. </p><br><h2 id="htmlunit">  Htmlunit </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La page d'accueil du</a> projet appelle HtmlUnit "un navigateur sans interface graphique pour les applications Java".  Contrairement à Selenium, HtmlUnit ne lance pas de véritable navigateur et, surtout, ne rend pas la page du tout, en travaillant directement avec le DOM.  JavaScript est pris en charge via le moteur Mozilla Rhino.  HtmlUnit est bien adapté aux applications classiques, mais pas très convivial avec les applications à page unique.  Pour commencer, ce sera suffisant, puis j'essaierai de montrer que même des choses comme un framework de test peuvent faire partie de l'implémentation, et non le fondement de l'application. </p><br><h1 id="pervyy-test">  Premier test </h1><br><p>  Maintenant, une histoire d'utilisateur écrite en anglais me sera utile.  Le meilleur déclencheur pour démarrer la prochaine itération TDD est des critères d'acceptation écrits de telle manière qu'ils peuvent être transformés en une spécification exécutable avec un minimum de gestes. </p><br><blockquote>  Idéalement, les user stories doivent être écrites de manière à pouvoir être simplement copiées dans la spécification BDD et exécutées.  C'est loin d'être toujours simple et pas toujours possible, mais cela devrait être l'objectif du propriétaire du produit et de toute l'équipe, bien qu'il ne soit pas toujours réalisable. </blockquote><p>  Donc, ma première fonctionnalité. </p><br><pre> <code class="plaintext hljs">Feature: Welcome page Scenario: a user visiting the web-site visit before the launch date Given a new user, Alice When she visits Cake Factory web-site Then she sees a message 'Thank you for your interest' And she sees a message 'The web-site is coming in December!'</code> </pre> <br><p>  Si vous générez des descriptions d'étapes (le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">plugin Intellij IDEA</a> aide à prendre en charge Gherkin aide beaucoup) et exécutez le test, alors, bien sûr, il sera vert - il ne teste encore rien.  Et voici la phase importante du travail sur le test - <em>vous devez écrire un test, comme si le code principal avait été écrit</em> . </p><br><p>  Souvent, pour ceux qui commencent à bannir le TDD, une stupeur s'installe ici - il est difficile de mettre en tête les algorithmes et la logique de quelque chose qui n'existe pas encore.  Et par conséquent, il est très important d'avoir des <em>itérations</em> aussi <em>petites et ciblées</em> que possible, en commençant par la user story et en descendant jusqu'au niveau de l'intégration et de l'unité.  Il est important de se concentrer <strong>sur un test à la fois</strong> et d'essayer de se mouiller et d'ignorer les dépendances qui ne sont pas encore importantes.  J'ai parfois remarqué à quel point les gens s'écartent facilement - créer une interface ou une classe pour une dépendance, générer immédiatement une classe de test vide pour elle, une dépendance supplémentaire y est ajoutée, une autre interface est créée et ainsi de suite. </p><br><blockquote>  Si l'histoire est "il serait nécessaire de rafraîchir le statut lors de l'enregistrement", il est très difficile d'automatiser et de formaliser.  Dans mon exemple, chaque étape peut être clairement présentée dans une séquence d'étapes qui peuvent être décrites par code.  Il est clair que c'est l'exemple le plus simple et il ne montre pas grand-chose, mais j'espère que, avec une complexité croissante, il sera plus intéressant. </blockquote><br><h2 id="red">  Rouge </h2><br><p>  Donc, pour ma première fonctionnalité, j'ai créé les descriptions d'étapes suivantes: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootTest</span></span>(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WelcomePage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WebClient webClient; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HtmlPage page; <span class="hljs-meta"><span class="hljs-meta">@LocalServerPort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> port; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String baseUrl; <span class="hljs-meta"><span class="hljs-meta">@Before</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ webClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebClient(); baseUrl = <span class="hljs-string"><span class="hljs-string">"http://localhost:"</span></span> + port; } <span class="hljs-meta"><span class="hljs-meta">@Given</span></span>(<span class="hljs-string"><span class="hljs-string">"a new user, Alice"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aNewUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// nothing here, every user is new by default } @When("she visits Cake Factory web-site") public void sheVisitsCakeFactoryWebSite() throws IOException { page = webClient.getPage(baseUrl); } @Then("she sees a message {string}") public void sheSeesAMessageThanksForYourInterest(String expectedMessage) { assertThat(page.getBody().asText()).contains(expectedMessage); } }</span></span></code> </pre> <br><p>  Quelques points à prendre en compte: </p><br><ul><li>  les fonctionnalités sont lancées par un autre fichier, <code>Features.java</code> utilisant l'annotation <code>RunWith</code> de JUnit 4, Cucumber ne prend pas en charge la version 5, hélas </li><li>  <code>@SpringBootTest</code> annotation <code>@SpringBootTest</code> est ajoutée à la description des étapes, <code>cucumber-spring</code> récupère à partir de là et configure le contexte de test (c.-à-d. Lance l'application) </li><li>  L'application Spring pour le test commence par <code>webEnvironment = RANDOM_PORT</code> et ce port aléatoire est transmis au test à l'aide de <code>@LocalServerPort</code> , Spring trouvera cette annotation et définira la valeur du champ sur le port du serveur </li></ul><br><p>  Et le test, comme prévu, se bloque avec l'erreur <code>404 for http://localhost:51517</code> . </p><br><blockquote>  Les erreurs avec lesquelles le test se bloque sont extrêmement importantes, en particulier en ce qui concerne les tests unitaires ou d'intégration, et ces erreurs font partie de l'API.  Si le test se bloque avec une <code>NullPointerException</code> ce n'est pas trop bon, mais la <code>BaseUrl configuration property is not set</code> - bien mieux. </blockquote><br><h2 id="green">  Vert </h2><br><p>  Pour rendre le test vert, j'ai ajouté un contrôleur de base et une vue avec un minimum de HTML: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Controller</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GetMapping</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"index"</span></span>; } }</code> </pre> <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Cake Factory<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Thank you for your interest<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>The web-site is coming in December!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Le test est vert, l'application fonctionne, bien qu'elle soit faite dans la tradition d'une conception technique sévère. </p><br><blockquote>  Sur un vrai projet et dans une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">équipe équilibrée</a> , bien sûr, je m'asseyais avec le designer et nous transformions le HTML nu en quelque chose de beaucoup plus beau.  Mais dans le cadre de l'article, un miracle ne se produira pas, la princesse restera une grenouille. </blockquote><p>  La question «quelle partie de TDD est la conception» n'est pas si simple.  L'une des pratiques que j'ai trouvées utiles est au début de ne même pas regarder du tout l'interface utilisateur (pas même d'exécuter l'application pour sauver vos nerfs), d'écrire un test, de le rendre vert - puis, ayant une base stable, de travailler sur le front-end, de redémarrer constamment les tests . </p><br><h2 id="refactor">  Refactor </h2><br><p>  Dans la première itération, il n'y a pas de refactoring particulier, mais bien que j'ai passé les 10 dernières minutes à choisir un modèle pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bulma</a> , qui peut être considéré comme du refactoring! </p><br><h1 id="v-zaklyuchenie">  En conclusion </h1><br><p>  Alors que l'application n'a ni travail de sécurité, ni base de données, ni API, les tests et TDD semblent assez simples.  Et en général, à partir de la pyramide des tests, je n'ai touché qu'au sommet, le test de l'interface utilisateur.  Mais en cela, en partie, le secret de l'approche Lean est de tout faire en petites itérations, un composant à la fois.  Cela permet de se concentrer sur les tests, de les rendre simples et de contrôler la qualité du code.  J'espère que dans les articles suivants il y aura plus d'intéressant. </p><br><h1 id="ssylki">  Les références </h1><br><ul><li>  Projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Concourse ci</a> </li></ul><br><p>  <em>PS Le titre de l'article n'est pas aussi fou que cela puisse paraître au début, je pense que beaucoup l'ont déjà deviné.</em>  <em>"Comment construire une pyramide dans votre démarrage" est une référence à la pyramide de test (je vous en dirai plus à ce sujet plus tard) et à Spring Boot, où démarrage en anglais britannique signifie également "tronc".</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr431306/">https://habr.com/ru/post/fr431306/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr431296/index.html">Rôles émotionnels dans les jeux. Narration compétente et implication dans le flux</a></li>
<li><a href="../fr431298/index.html">Validation de l'unicité véritable</a></li>
<li><a href="../fr431300/index.html">Trois ans de certification sans dirigeants - vol normal</a></li>
<li><a href="../fr431302/index.html">Faire une simple antenne sonar à la poubelle</a></li>
<li><a href="../fr431304/index.html">À la recherche d'ombres prometteuses pour roguelike</a></li>
<li><a href="../fr431308/index.html">Innotrans 2018: quel type de transport ferroviaire sera demain?</a></li>
<li><a href="../fr431310/index.html">Configurer Firefox / Chrome pour un Internet très lent et limité</a></li>
<li><a href="../fr431312/index.html">DeezLoader + PlexMediaServer. Créer un portail de musique à domicile</a></li>
<li><a href="../fr431316/index.html">Vote sur la deuxième version bêta du rapport révisé 7 sur le schéma de langage algorithmique (grand langage)</a></li>
<li><a href="../fr431318/index.html">Chaîne de transcripteur Python → 11l → C ++ [pour accélérer le code Python et plus]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>