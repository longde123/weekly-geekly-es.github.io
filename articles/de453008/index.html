<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💜 👩🏼‍🎤 👨‍👩‍👧‍👧 Zurück in die Zukunft mit WebAssembly 🐈 👰🏿 🤚🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! Ich präsentiere Ihnen die Übersetzung des Artikels "Zurück in die Zukunft mit WebAssembly" von Attila Vágó. 

 Dieser Beitrag ist eine Übe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zurück in die Zukunft mit WebAssembly</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453008/">  Hallo Habr!  Ich präsentiere Ihnen die Übersetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Zurück in die Zukunft mit WebAssembly"</a> von Attila Vágó. <br><br><h4>  Dieser Beitrag ist eine Übersetzung eines Artikels, der sich mit den Eigenschaften von WebAssemly und Emscripten befasst.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=http://">Originalartikel</a> in Englisch. </h4><br>  <i>Der Autor des Artikels, Attila Vago, ist ein leitender Softwareentwickler bei HMH.</i>  <i>Schreibt Code, Blogs und andere Dinge im Internet.</i>  <i>Eine Vielzahl von Programmiersprachen, eine pragmatische Figur mit einer Leidenschaft für JavaScript und einfachem Zugriff.</i>  <i>Leicht inspirierte und inspirierende Person mit einer starken Sucht nach Dingen für Nerds, großartiges Essen, Craft Beer und Lego.</i>  <i>Wird vom Mac verwendet.</i>  <i>Er trainiert um 6 Uhr morgens.</i> <br><br><p>  2011 schrieb ich meine erste unabhängige Zeile mit Nicht-HTML-Code (ich habe 2007 damit gearbeitet) und sie wurde in dem sehr guten alten C geschrieben, das von Professor David J. Malan von der Harvard University unterrichtet wurde.  Er wird für immer meine Inspiration bleiben, nicht nur für das Studium der Programmierung, sondern auch für das programmatische Denken.  Ich erinnerte mich auch daran, dass die Herstellung eines Erdnussbuttersandwichs nur für mich ist, aber es ist eine unglaublich schwierige Aufgabe für einen Computer und ebenso schwierig für eine Person, die vorgibt, ein Computer zu sein. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wEdvGqxafq8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><p>  Wenn Sie das Video mindestens die ersten 18 Minuten gesehen haben (ich weiß, dass es lange dauert, aber das Programmieren Zeit braucht), werden Sie verstehen, warum mir C bis heute am Herzen liegt.  Zu meiner Enttäuschung habe ich es nicht gelernt, denn für einen Webentwickler ist C die geringste Priorität.  Ich hatte nie einen wirklichen Grund, tief in diese Sprache einzutauchen, obwohl ich unzählige Udemy-Kurse und C-Bücher gekauft habe. Ich habe sie nie berührt (behalten Sie Ihr Urteilsvermögen für sich, das haben Sie auch getan) oder mich selbst belogen, wenn ich kaufe Smart Watch Pebble, die in C funktionieren, schreiben Sie dann unbedingt einen Code für sie.  Ja, genau!  Keiner dieser Gründe war gut genug. </p><br><h4>  Was ist WebAssembly und wie überholt es JS? </h4><br><p>  WebAssembly (kurz Wasm) ist ein binäres Befehlsformat für eine gestapelte virtuelle Maschine. </p><blockquote>  „Wasm wurde als tragbare Plattform zum Kompilieren von Hochsprachen wie C / C ++ / Rust entwickelt, mit der Sie Client- und Serveranwendungen im Internet bereitstellen können.“ </blockquote>  - erklärt freundlicherweise webassembly.org <p></p><br><p>  Mit anderen Worten bedeutet dies, dass Sie Module schreiben können, die im Internet in einem Browser / Server funktionieren, aber in Sprachen wie C geschrieben, in eine Binärdatei kompiliert und daher unglaublich schnell sind, da sie direkt auf der Hardware des Computers funktionieren.  Im Vergleich dazu weisen Skriptsprachen wie JavaScript mehrere Abstraktionsebenen zwischen Code und Hardware auf, was sie unter anderem verlangsamt.  Dies spielt natürlich nicht immer eine Rolle, und jeder von ihnen hat seinen eigenen Platz im Programm oder sogar im Web-Ökosystem. </p><br><p>  Auf dieser Grundlage unterstützt Wasm by Structure (anfangs) nur Ganzzahlen und Gleitkommazahlen, was eine hohe Rechenleistung bietet und daher häufig für Implementierungen vom Canvas-Typ verwendet wird.  Es ist wichtig zu verstehen, dass WebAssembly keine Bedrohung für JavaScript darstellt - zumindest noch nicht - und wie Sie später in diesem Artikel sehen werden, können C und JavaScript tatsächlich sehr glücklich im selben Projekt leben und den Code des anderen ausführen.  Ja, so etwas. </p><br><br><h4>  Emscripten "klebt" C und JS </h4><br><p>  Jetzt warte!  Ich weiß was ich sage.  Sie können keine Dinge wie "C in JS ausführen und umgekehrt" sagen und erwarten, dass die Welt nicht reagiert. Egal wie seltsam es klingt, ich täusche mich nicht. Es stellt sich heraus, dass Emscripten eine Kette von Tools zum Kompilieren in asm.js und WebAssembly ist. Entwickelt mit LLVM (mein Gott, ich habe die Hälfte dieser Dinge beim Schreiben des Textes des Artikels gelernt), mit dem Sie C und C ++ im Internet mit fast nativer Geschwindigkeit ohne Plug-Ins ausführen können. </p><br><p>  Nun, hier ist, was Sie daraus für sich selbst hervorheben müssen.  Emscripten hilft Ihnen beim Kompilieren von C-Code in WebAssembly und bietet zusätzliche Tools, um den Entwickler bei der Kommunikation zwischen den beiden Sprachen zu entlasten, und hilft beim Starten von Wasm in Ihrem Webprojekt.  Der grundlegende Kompilierungsbefehl für Emscripten lautet wie folgt: </p><br><pre><code class="plaintext hljs">emcc lib/strings.c -s WASM=1 -o public/strings.js</code> </pre> <br>  Während ein nicht grundlegender Befehl wie folgt ausgeführt wird: <br><br><pre> <code class="plaintext hljs">emcc lib/imports.c -s WASM=1 -s EXPORTED_FUNCTIONS="['_getNum', '_main', '_getDoubleNum', '_greet']" -o public/imports.js</code> </pre> <br><p>  Emscripten einzurichten ist nicht die einfachste Sache, aber keine Rakete zu starten.  Das einzige, was das Setup kompliziert, ist, dass es viele Abhängigkeiten wie Python, Node, xCode, Git und cMake hat.  Alle Anweisungen finden Sie auf der Installationsseite und sind leicht zu befolgen. <br>  Deshalb Emscripten: <br><br></p><ul><li>  ist ein großartiges Tool für die Portierung, mit dem Sie vorhandene Projekte, die in C oder C ++ geschrieben wurden, kompilieren und in allen modernen Browsern ausführen können.  <i>Verschwinde von hier, Internet Explorer!</i> </li><li>  Ideal für APIs, da OpenGL in WebGL konvertiert wird und Sie vertraute APIs wie SDL oder direkt HTML5 verwenden können.  <i>Oh ja!</i> </li><li>  Und es ist verdammt schnell: Dank LLVM, Emscripten, asm.js und WebAssembly läuft der Code fast mit seiner eigenen Geschwindigkeit.  <i>Lauf, Hase, lauf!</i> <br></li></ul><p></p><br><p>  Hinweis: Sie benötigen Emscripten nicht, um Wasm zu generieren, da alle neuen Browser eine API zur Unterstützung von Wasm im selben Fenster haben, in der Emscripten als oberste Ebene ausgeführt wird, was das Leben des Entwicklers erheblich erleichtert.  Zum Beispiel passt Emscripten die Speichermenge für Sie an, was durch C mühsam sein kann. </p><br><h4>  Beispiele ... Beispiele gibt es überall! </h4><br><p>  Sie wissen, wie sie sagen: <i>"Eine Codezeile</i> sagt <i>mehr als tausend Worte."</i> - OK, dies ist das Vorrecht des Erzählers und all das. Schauen wir uns also ohne weiteres einen echten Code an.  Off-Topic-Kommentar: An diesem Tag konnte ich die C-Syntax nicht überwinden. Sie wurde nicht die Hälfte der Zeit kompiliert, da mein Code wackelig wäre.  Und nach acht Jahren bin ich so: <i>"Ja, es sieht aus wie JavaScript</i> . <i>"</i> </p><br><p>  Leute, wenn jemand anfängt, C-Code in meinem React zu sehen, bringt mich einfach zurück in die Realität, okay? </p><br><p>  Ein wenig abseits des Themas, hier ist der aktuelle C-Code: </p><br><img src="http://habrastorage.org/webt/ck/lg/et/cklgetgfjlx_kvbbco7_mfazc7w.png" alt="Bild"><br><br><p>  Und dementsprechend in JavaScript: </p><br><img src="http://habrastorage.org/webt/tt/co/wk/ttcowkhhzlmtmqlqgst67lulqbg.png" alt="Bild"><br><br><p>  OK, was genau passiert in diesen Dateien?  Eigentlich ziemlich viel, also werde ich auflisten. <br></p><ol><li>  Es ist wichtig zu verstehen, dass <b>main ()</b> , sofern nicht anders angegeben, immer zuerst startet und standardmäßig auch kompiliert wird.  Wenn Sie eine andere Funktion kompilieren möchten, müssen Sie sie speziell im Flag des Arrays <b>EXPORTED_FUNCTIONS setzen</b> , wie im vorherigen Abschnitt gezeigt. </li><li>  Sie schreiben Ihren C-Code wie gewohnt und importieren seine regulären Bibliotheken. Darüber hinaus erhalten Sie den syntaktischen Zucker Emscripten sowie mehr Methoden / Funktionen als mit jedem anderen Tool. </li><li>  Die von HTML <b>referenzierte</b> Datei <b>imports.js</b> (der Name ist willkürlich, aber immer derselbe wie die C-Datei) ist nichts anderes als der Emscripten-Kleber, der beim Kompilieren automatisch generiert wird.  Sie müssen sich keine Sorgen machen, stellen Sie nur sicher, dass wirklich darauf verwiesen wird. </li><li>  <b>Printf</b> ist nur eine gewöhnliche C-Anweisung, die eine Zeichenfolge auf der Konsole registriert.  Nichts besonderes, mach weiter. </li><li>  Die Zeilen 14 und 17 sind ein Anti-Pattern, aber ein gutes Beispiel für die Ausführung von JS in Ihrem C-Code. Der einzige wirkliche Unterschied zwischen <b>emscripten_run_script</b> und <b>emscripten_async_run_script</b> besteht darin, dass Sie JS in C asynchron ausführen können.  Meistens mit <b>setTimeout ()</b> .  Der Grund, warum ich sagte, dass dies ein Anti-Muster ist, ist, dass es so ist.  Die ganze Idee von WebAssembly besteht darin, C in JS auszuführen, nicht JS in C, und daher ... </li><li>  Die Zeilen 20 und 24 und die zugehörigen JS-Funktionen in der Datei <b>index.html</b> stellen die richtige Vorlage dar, nämlich das Deklarieren Ihres JS in Ihrem JS und das Zurückgeben von etwas für C. </li><li>  <b>EM_JS</b> , das dann <b>jsFunction</b> startet, ist einfach ein einfacher Weg - um das gleiche Ziel wie in den Punkten 4 und 5 zu erreichen. </li></ol><br><p>  Das vorhergesagte Ergebnis des Obigen ist wie folgt: </p><br><img src="http://habrastorage.org/webt/xd/lp/ew/xdlpewar42x522efjks9j2tdii4.png" alt="Bild"><br><br><p></p><h4>  Ladies Ahead! </h4><p></p><br><p>  Wie bei jedem Code hat auch WebAssembly eine laufende Reihenfolge.  Leg dich nicht mit der Warteschlange an!  Die Bestellung ist in diesem Fall Standard für die C-Bestellung.  Alles beginnt in Main () und wann immer <b>main ()</b> bereit ist, ist Wasm bereit.  Was passiert jedoch, wenn Sie zur Laufzeit eine statische Funktion zum Aufrufen benötigen?  Nun, nur ein wenig Emscripten syntaktischer Zucker, und alles läuft wie am Schnürchen: </p><br><img src="http://habrastorage.org/webt/ak/vg/vy/akvgvyjdhbok35-ggr2ktamzsys.png" alt="Bild"><br><br><h4>  Wir sammeln Fliegen vom Kuchen </h4><br><p>  Dies ist gut geschriebener Code, insbesondere die einfachen Dinge, die in den vorherigen Abschnitten dargestellt wurden, aber wir alle wissen, dass die reale Welt viel größer als "Hallo Welt" ist und die Hälfte der Zeit jedes Entwicklers damit verbracht wird, herauszufinden, warum der Code nicht was tut sollte.  Fehler sind einfach unvermeidlich und in gewissem Sinne Teil des Lebens. </p><br><p>  Wenn Sie C in JS oder einem Wasm ausführen, kann alles noch deprimierender werden.  Glücklicherweise hilft Emscripten erneut mit zwei sehr nützlichen Debugging-Methoden: </p><br><pre> <code class="plaintext hljs">// browser debugger gets triggered emscripten_debugger(); // browser console warning with stack-trace emscripten_log(EM_LOG_WARN, “'param' your message”);</code> </pre> <br><h4>  Schnell beeilt sich Gonzalez, um zu helfen </h4><br>  Ob Sie es glauben oder nicht, die Schöpfer von Emscripten haben an alles gedacht.  Ein großes Feature - und das letzte, das ich in diesem Artikel erwähnen werde, da es zu viele gibt, um sie alle in einem zu vereinen - ist die Grundlage für eine schnelle Entwicklung und Erprobung.  Sie können Ihren Wasm kompilieren, ein Projekt erstellen und den Server auf einen Schlag starten: <p></p><br><pre> <code class="plaintext hljs">emrun --port 7777 --no_browser public/index.html Now listening at http://localhost:7777/</code> </pre> <br>  Die von Ihnen ausgeführte HTML-Seite ist nicht emrun-fähig.  Die Erfassung von Stdout, stderr und exit (Rückkehrcode) funktioniert nicht.  Kompilieren Sie die Anwendung mit dem Linker-Flag --emrun neu, um dies zu aktivieren, oder übergeben Sie --no_emrun_detect an emrun, um diese Prüfung auszublenden. <br><p>  Okay, in zwei Fällen ... das obige Beispiel funktioniert, aber das nächste funktioniert besser, was den angezeigten Fehler erklärt. </p><br><pre> <code class="plaintext hljs">&lt;b&gt;// compile as emrun project emcc lib/strings.c -s WASM=1 --emrun -o public/index.html // run the emrun server again emrun --port 7777 --no_browser public/index.html&lt;/b&gt;</code> </pre> <br><p>  Ich lasse es einfach so.  Als ich WebAssembly studierte, feierte ich den St. Patrick's Day und den nächsten Tag.  Ich bin mir nicht ganz sicher, was als nächstes passieren wird, aber es hat mich genug begeistert, zwei Tage vor dem Monitor zu sitzen und zu versuchen, die Grundlagen von WebAssebly zu erlernen, und das sollte etwas bedeuten, oder?  Dies ist genau der C-Code, den ich seit 2011 geschrieben habe, und er fühlt sich großartig an.  Ich denke, WebAssembly hat eine echte Zukunft, aber ich bin mir nicht sicher, ob es das Netzwerk vollständig übernehmen und JS töten wird, wie einige predigen.  Was denkst du? </p><br><img src="https://cdn-images-1.medium.com/max/800/1*PM2kQWEmOeAsRwenG-bDAA.png" alt="Bild"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453008/">https://habr.com/ru/post/de453008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452998/index.html">Android Ein dynamisches Widget in Form von Karten basierend auf StackView (so etwas wie Tinder)</a></li>
<li><a href="../de453000/index.html">Gepäckladen: BUgHunting. So finden Sie 200 Fehler pro Tag</a></li>
<li><a href="../de453002/index.html">Neues Windows-Terminal: Antworten auf Ihre Fragen</a></li>
<li><a href="../de453004/index.html">Wir schicken Habr zum Mars, auch Sie können fliegen</a></li>
<li><a href="../de453006/index.html">IT-Begriffe als Beispiel für den Prozess des Kartoffelanbaus</a></li>
<li><a href="../de453010/index.html">Vergleich von 10 Halogenlampen H4 Philips, Osram, PIAA, Koito, Bosch. Die Ergebnisse sind überraschend.</a></li>
<li><a href="../de453012/index.html">Eine kurze Fotostory über einen Ausflug zum Caucasus Mountain Observatory</a></li>
<li><a href="../de453014/index.html">EyeWire - studieren Sie weiterhin die Geheimnisse des Gehirns</a></li>
<li><a href="../de453016/index.html">Die Top 3D Academy lädt zum Erfahrungsaustausch in der Foliplast-Fabrik ein</a></li>
<li><a href="../de453018/index.html">Untersuchung des Einflusses verschiedener Reflektoren und Streuer auf die Form eines Lichtstrahls</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>