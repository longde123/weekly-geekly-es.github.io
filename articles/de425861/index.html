<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≥Ô∏è üèÇüèΩ üè£ Testen Sie sich selbst: K√∂nnen Sie das Unternehmen vor Cyber-Angriffen sch√ºtzen? üî° üçê üë©‚Äç‚ù§Ô∏è‚Äçüë©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor kurzem war Samara Gastgeber des internationalen offenen Wettbewerbs der WolgaCTF f√ºr Informationssicherheit. Vladimir Dryukov, Direktor des Solar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen Sie sich selbst: K√∂nnen Sie das Unternehmen vor Cyber-Angriffen sch√ºtzen?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/solarsecurity/blog/425861/">  Vor kurzem war Samara Gastgeber des internationalen offenen Wettbewerbs der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WolgaCTF</a> f√ºr Informationssicherheit.  Vladimir Dryukov, Direktor des Solar JSOC Cyber ‚Äã‚ÄãAttack Monitoring- und Reaktionszentrums, erz√§hlte den Teilnehmern von drei echten Angriffen und fragte, wie sie identifiziert werden k√∂nnten.  √úberpr√ºfen Sie, ob Sie richtig antworten k√∂nnen. <br><a name="habracut"></a><br>  Unten finden Sie eine Abschrift von Vladimirs Rede, aber f√ºr diejenigen, die die unzensierte und ungeschnittene Version (einschlie√ülich der Antworten des Publikums) sehen m√∂chten - hier ist das Video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GD4XtcGc5zA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Also das Wort an Vladimir: <br><br><img src="https://habrastorage.org/webt/cg/96/xz/cg96xz4oz_vipsa2ddddygmwgxu.jpeg"><br><br>  Ich m√∂chte einige Geschichten aus unserem Leben erz√§hlen.  Ich werde die meisten von ihnen vom Ende erz√§hlen - das hei√üt, beginnend mit dem Vorfall.  Und Sie versuchen herauszufinden, wie dieser Angriff zu Beginn gesehen werden kann, damit Sie als Verteidiger des Unternehmens die Aktionen der Angreifer auf Ihr Radar bringen. <br><br>  Ich hoffe, dies hilft Ihnen in Zukunft, wenn Sie professionelle Pentester werden und bei Positive Technologies, Digital Security oder bei uns arbeiten.  Sie werden wissen, wie das √úberwachungszentrum solche Angriffe sieht, wie es auf sie reagiert, und - wer wei√ü - vielleicht hilft Ihnen dies, die Verteidigung zu umgehen, Ihr Ziel zu erreichen und dem Kunden zu zeigen, dass er nicht so unverwundbar ist, wie er gedacht hat.  Nun, lass uns gehen? <br><br><h3>  Aufgabe Nummer 1.  Dieser Service ist sowohl gef√§hrlich als auch schwierig und scheint auf den ersten Blick nicht sichtbar zu sein ... </h3><br>  Die Geschichte begann mit der Tatsache, dass der Leiter des Informationssicherheitsdienstes eines Unternehmens zu uns kam und sagte: <br><br>  "Leute, ich mache einen seltsamen Unsinn.  Es gibt vier Autos, die spontan neu starten und auf einem blauen Bildschirm herausfallen - im Allgemeinen gibt es eine Art Unsinn.  Lass es uns kl√§ren. ‚Äú <br><br>  Als die Mitarbeiter der Forensikgruppe vor Ort ankamen, stellte sich heraus, dass die Sicherheitsprotokolle aller Maschinen bereinigt wurden - es gab so viele Aktivit√§ten, dass das Sicherheitsmagazin schnell gedreht (neu geschrieben) wurde.  Auch in der Master-Dateitabelle wurde nichts Interessantes gefunden - die Fragmentierung ist stark, die Daten werden schnell √ºberschrieben.  Trotzdem ist es uns gelungen, etwas im Systemprotokoll zu finden: Auf diesen vier Computern wird ungef√§hr einmal t√§glich der Dienst it_helpdesk angezeigt, f√ºhrt etwas Unbekanntes aus (es gibt keine Sicherheitsprotokolle, wie wir uns erinnern) und verschwindet. <br><br>  In unserem forensischen Kapitel ging es um diesen Gesichtsausdruck: <br><br><img src="https://habrastorage.org/webt/xj/sn/kn/xjsnkn-0rd57c2t65aajfzvyluy.jpeg"><br><br>  Sie begannen weiter zu verstehen und es stellte sich heraus, dass der Dienst it_helpdesk tats√§chlich in PSExec umbenannt wurde. <br><blockquote> Mit Dienstprogrammen wie Telnet und Remoteverwaltungsprogrammen wie Symantecs PC Anywhere k√∂nnen Sie Programme auf Remote-Systemen ausf√ºhren. Die Installation ist jedoch nicht so einfach, da Sie auch Client-Software auf den Remote-Systemen installieren m√ºssen, die Sie empfangen m√ºssen Zugang. <br><br>  PsExec ist eine leichte Version von Telnet.  Sie k√∂nnen Prozesse in Remote-Systemen ausf√ºhren und dabei alle Funktionen der interaktiven Schnittstelle von Konsolenanwendungen nutzen. Die Client-Software muss nicht manuell installiert werden.  Der Hauptvorteil von PsExec ist die M√∂glichkeit, die Befehlszeilenschnittstelle interaktiv auf Remote-Systemen aufzurufen und Tools wie IpConfig remote auszuf√ºhren.  Nur so k√∂nnen Informationen zum Remote-System auf dem lokalen Computerbildschirm angezeigt werden. <br><br>  technet.microsoft.com </blockquote><br>  Nachdem wir die Systemprotokolle auf anderen Computern √ºberpr√ºft hatten, stellten wir fest, dass nicht 4 Workstations beteiligt waren, sondern 20 plus 19 weitere Server, einschlie√ülich eines kritischen Servers.  Wir haben mit IT-Spezialisten gesprochen und festgestellt, dass sie keinen Bezug dazu haben und kein solches Subsystem haben.  Sie begannen weiter zu graben, und dann wurde eine ziemlich merkw√ºrdige und seltene Sache entdeckt - DNS-Tunneling, bei dem das Malware-Modul verwendet wurde, das f√ºr die Kommunikation mit dem Botnet-Kontrollzentrum verantwortlich war. <br><blockquote>  DNS-Tunneling - eine Technik, mit der Sie beliebigen Datenverkehr (tats√§chlich den Tunnel erh√∂hen) √ºber das DNS-Protokoll √ºbertragen k√∂nnen.  Es kann beispielsweise verwendet werden, um ab dem Punkt, an dem die Aufl√∂sung von DNS-Namen zul√§ssig ist, vollen Zugriff auf das Internet zu erhalten. <br><br>  DNS-Tunneling kann nicht durch einfache Firewall-Regeln verweigert werden, w√§hrend der Rest des DNS-Verkehrs zugelassen wird.  Dies liegt daran, dass DNS-Tunnelverkehr und legitime DNS-Abfragen nicht zu unterscheiden sind.  DNS-Tunneling kann anhand der Abfrageintensit√§t (wenn der Verkehr durch den Tunnel gro√ü ist) sowie anhand komplexerer Methoden unter Verwendung von Intrusion Detection-Systemen erkannt werden. <br><br>  xgu.ru <br></blockquote><br>  Sch√§dlicher Code gelangte per E-Mail in die Organisation, verteilte sich √ºber die Infrastruktur und interagierte √ºber den DNS-Tunnel mit dem C &amp; C-Server.  Daher funktionierten die Verbote f√ºr die Interaktion mit dem Internet, die im Serversegment standen, nicht. <br><br>  Auf einem der kritischen Server befand sich ein Keylogger, der Kennw√∂rter automatisch las, und die Malware versuchte, weiter zu crawlen. Sie erhielt neue Benutzeranmeldeinformationen, einschlie√ülich des L√∂schens von Autos im BSOD und des Lesens der Kennw√∂rter der Administratoren, die sie ausgel√∂st hatten. <br><br>  Was hat das gebracht?  W√§hrend der Zeit, in der die Malware in der Infrastruktur lebte, wurden viele Konten und dar√ºber hinaus eine gro√üe Menge anderer potenziell sensibler Daten kompromittiert.  W√§hrend der Untersuchung haben wir den Umfang der Angreifer lokalisiert und sie aus dem Netzwerk ‚Äûgeworfen‚Äú.  Der Kunde erhielt weitere vier Monate Mehl - es dauerte, bis die H√§lfte der Maschinen wieder aufgef√ºllt und alle Passw√∂rter neu ausgegeben wurden - aus Datenbanken, Konten usw.  Menschen mit IT-Erfahrung m√ºssen nicht erkl√§ren, was f√ºr eine schwierige Geschichte dies ist.  Trotzdem endete alles gut. <br><br>  Die Frage ist also: Wie k√∂nnte dieser Angriff erkannt und ein Cyberkrimineller im Arm gefangen werden? <br><br><div class="spoiler">  <b class="spoiler_title">Die Antwort auf die erste Aufgabe</b> <div class="spoiler_text">  Wie Sie sich erinnern, betraf die Infektion zun√§chst einen kritischen Server.  Wenn auf einem solchen Host ein neuer, bisher unbekannter Dienst gestartet wird, ist dies ein sehr kritischer Vorfall.  Dies sollte nicht passieren.  Wenn Sie zumindest Dienste √ºberwachen, die auf kritischen Servern ausgef√ºhrt werden, hilft dies allein, einen solchen Angriff fr√ºhzeitig zu erkennen und dessen Entwicklung zu verhindern. <br><br>  Zweitens vernachl√§ssigen Sie nicht die Informationen der grundlegendsten Schutzma√ünahmen.  PSExec wird von Virenschutzprogrammen gut erkannt, jedoch nicht als Malware, sondern als Remote Admin Tool oder Hacking Tool gekennzeichnet.  Wenn Sie sich die Antivirenprotokolle genau ansehen, k√∂nnen Sie die Antwort rechtzeitig sehen und geeignete Ma√ünahmen ergreifen. <br></div></div><br><br><h3>  Aufgabe Nummer 2.  Gruselgeschichten <br></h3><br>  Eine gro√üe Bank, eine Frau arbeitet im Finanzdienst und hat Zugang zu AWS des CBD. <br><blockquote>  AWP KBR - ein automatisierter Arbeitsplatz eines Kunden der Bank of Russia.  Es ist eine Softwarel√∂sung f√ºr den sicheren Informationsaustausch mit der Bank von Russland, einschlie√ülich des Versendens von Zahlungsauftr√§gen, Bankfl√ºgen usw. </blockquote><br>  Dieser Finanzbeauftragte brachte ein Flash-Laufwerk mit einer Datei namens Skazki_dlya_bolshih_i_malenkih.pdf.exe zum Laufen.  Sie hatte eine kleine Tochter, und die Frau wollte bei der Arbeit ein Kinderbuch drucken, das sie aus dem Internet heruntergeladen hatte.  Die Dateierweiterung .pdf.exe schien ihr nicht verd√§chtig zu sein, und als sie die Datei startete, wurde das √ºbliche PDF ge√∂ffnet. <br><br><img src="https://habrastorage.org/webt/wm/dl/-4/wmdl-4ix7ki9r5pdry7o6evkjqg.jpeg"><br><br>  Die Frau schlug das Buch auf und ging nach Hause.  Aber die .exe-Erweiterung war nat√ºrlich kein Zufall.  Hinter ihm befand sich das Remo Admin Tool, das sich auf einer Workstation befand und dort mehr als ein Jahr lang in Systemprozessen arbeitete. <br><br>  Wie funktioniert solche Malware?  Zun√§chst machen sie etwa 15 Mal pro Minute Screenshots.  In einer separaten Datei f√ºgen sie die vom Keylogger empfangenen Daten hinzu - Anmeldungen und Passw√∂rter, Korrespondenz per E-Mail, Instant Messenger und vieles mehr.  Nachdem wir den Client verbunden hatten, bemerkten wir schnell einen infizierten Host und entfernten den Virus aus dem Netzwerk. <br><br>  Frage: Wie k√∂nnte es m√∂glich sein, die "unsichtbare" Malware zu erkennen, die vom Antivirus nicht erkannt wurde? <br><br><div class="spoiler">  <b class="spoiler_title">Die Antwort auf die zweite Aufgabe</b> <div class="spoiler_text">  Erstens macht Malware in der Regel etwas im Dateisystem, √§ndert Registrierungseintr√§ge - kurz gesagt, es wird irgendwie in das System geladen.  Dies kann nachverfolgt werden, wenn Sie den Host auf der Ebene der Protokolle √ºberwachen, die das Betriebssystem selbst schreibt - Sicherheitsprotokolle, Prozessstarts, Registrierungs√§nderungen. <br><br>  Zweitens ist es wichtig, sich daran zu erinnern, dass solche Malware nicht autonom lebt, sondern immer irgendwo klopft.  Arbeitsstationen in einem Netzwerk verf√ºgen h√§ufig nur √ºber einen Proxy √ºber einen Internetzugang. Wenn also ein Computer versucht, irgendwo direkt zu klopfen, ist dies ein schwerwiegender Vorfall, der behoben werden muss. <br></div></div><br><br><h3>  Aufgabe Nummer 3.  "Verdammte Warez" <br></h3><br>  Der Systemadministrator musste 2 XML-Dateien vergleichen und ‚Äûzusammenkleben‚Äú.  Er ging den einfachen Weg - tippte in eine Suchmaschine "Download XML Merger ohne Registrierung und SMS".  Die offizielle Website des Entwicklers dieses Dienstprogramms befand sich in der Ausgabe an dritter Stelle und in den ersten beiden - Filesharing.  Dort hat der Administrator das Programm heruntergeladen. <br><br>  Wie Sie wahrscheinlich bereits vermutet haben, wurde in das Dienstprogramm "free" ein gutes, qualitativ hochwertiges Modul zur Eskalation von Berechtigungen integriert.  Er hat den Antiviren-Agenten auf dem Computer zerst√∂rt und stattdessen eine Datei mit demselben Namen erstellt.  Daher hing die Malware auch auf dem Computer und kommunizierte regelm√§√üig mit dem Kontrollzentrum. <br><br><img src="https://habrastorage.org/webt/vr/g-/mr/vrg-mrq9nozu9x1hpgh68r6olp0.png"><br><br>  Das Schlimmste war, dass der IT-Administrator der K√∂nig des Schlosses ist, er hat √ºberall Zugang.  Von seinem Computer aus kann der Virus jeden Host oder Server erreichen.  Die Malware kroch √ºber den Domain-Sharepoint √ºber das Netzwerk und versuchte, zum Auto des Cheffinanzierers zu gelangen.  In diesem Moment wurde sie vom Schwanz gefangen und die Geschichte wurde gel√∂scht. <br><br>  Frage: Wie kann ein solcher Angriff auf den Computer eines privilegierten Benutzers erkannt werden? <br><br><div class="spoiler">  <b class="spoiler_title">Die Antwort auf das dritte Problem</b> <div class="spoiler_text">  Auch hier k√∂nnen Sie den Datenverkehr abh√∂ren und versuchen, die Malware "auf frischer Tat" abzufangen - zum Zeitpunkt der Anforderung an den C &amp; C-Server.  Wenn das Unternehmen jedoch nicht √ºber NGFW, IDS, ein Netzwerkverkehrsanalysesystem oder SIEM verf√ºgt, das zumindest etwas Wertvolles aus dem Verkehr abf√§ngt, k√∂nnen Sie es ad infinitum anh√∂ren. <br><br>  Es ist effizienter, die Betriebssystemprotokolle anzuzeigen, indem Sie sie an ein externes System senden.  W√§hrend die Malware den Antiviren-Agenten entfernt hat, konnte sie die √úberwachungsdatei nicht l√∂schen. Daher enthalten die an das externe System gesendeten Protokolle definitiv Informationen √ºber das Entfernen des Antiviren-Agenten oder zumindest die Tatsache, dass die Pr√ºfung selbst bereinigt wurde.  Danach sind die Protokolle auf dem Computer selbst leer und es k√∂nnen keine Spuren gefunden werden. <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425861/">https://habr.com/ru/post/de425861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425849/index.html">Amazon gab auf und erh√∂hte die Geh√§lter der Mitarbeiter</a></li>
<li><a href="../de425851/index.html">Infer.NET: Leistungsstarkes maschinelles Lernsystem jetzt OpenSource</a></li>
<li><a href="../de425853/index.html">Alle Konversations-KI bei der ersten Konversationskonferenz</a></li>
<li><a href="../de425855/index.html">Zucken machte mich besser und half mir, die drei dunkelsten Monate meines Lebens zu √ºberleben.</a></li>
<li><a href="../de425859/index.html">Regionale Betreiber lehnen die Aufhebung des Roamings ab</a></li>
<li><a href="../de425867/index.html">Testen der Webdienstleistung im Rahmen der kontinuierlichen Integration. Yandex Erfahrung</a></li>
<li><a href="../de425869/index.html">iFixit: Apple hat das Blockieren von √ºberholten MacBooks noch nicht aktiviert</a></li>
<li><a href="../de425871/index.html">Jekaterinburg, 11. Oktober - Atlassian trifft Hafenarbeiter</a></li>
<li><a href="../de425873/index.html">[CppCon 2018] Herb Sutter: Auf dem Weg zu einem einfacheren und leistungsst√§rkeren C ++</a></li>
<li><a href="../de425875/index.html">Notebook-Matrix-Upgrade TN-> IPS oder wie man einen fortgeschritteneren Laptop von einem Budget-Laptop bekommt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>