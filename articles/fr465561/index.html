<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏼 👩🏻‍🚒 👋🏿 Ce que j'ai appris d'un grand programmeur 👊🏻 🍸 ⏭️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a un an, j'ai commencé à travailler à temps plein chez Bloomberg. Et puis j'ai décidé d'écrire cet article. J'ai pensé que je serais plein d'idée...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ce que j'ai appris d'un grand programmeur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/465561/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/m9/v8/ccm9v8yphneof1qcnuaru8peu1e.jpeg"></div><br>  Il y a un an, j'ai commencé à travailler à temps plein chez Bloomberg.  Et puis j'ai décidé d'écrire cet article.  J'ai pensé que je serais plein d'idées que je pourrais jeter sur papier le moment venu.  Mais en l'espace d'un mois, j'ai réalisé que tout ne serait pas si simple: j'ai déjà commencé à oublier ce que j'ai appris.  Soit la connaissance était si bien acquise que mon esprit m'a fait croire que je la savais toujours, soit ils ont juste volé hors de ma tête.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>1</sup></a> <br><br>  C'est l'une des raisons pour lesquelles j'ai commencé à tenir un journal.  Chaque jour, entrant dans des situations intéressantes, je les décrivais.  Et tout cela grâce au fait que j'étais assis à côté d'un programmeur de premier plan.  J'ai pu observer de près son travail et j'ai vu à quel point c'était différent de ce que je ferais.  Nous avons beaucoup programmé ensemble, ce qui a rendu mes observations encore plus faciles.  De plus, notre équipe ne condamne pas «l'espionnage» des personnes écrivant du code.  Quand il m'a semblé qu'il se passait quelque chose d'intéressant, je me suis retourné et j'ai regardé.  Grâce à l'augmentation constante, j'ai toujours été au courant de ce qui se passait. <br><br>  J'ai passé un an à côté d'un programmeur de premier plan.  Voilà ce que j'ai appris. <br><a name="habracut"></a><br><h1>  Table des matières </h1><br><ul><li>  Écriture de code <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment nommer les choses dans le code</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code hérité et prochain développeur</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Documentation et commentaires en code</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Atomic s'engage</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment supprimer en toute confiance le code moche</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Examen du code</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Test</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Réduction des risques</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'architecture</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Nous créons de l'architecture, sans oublier la maintenance</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Déployer</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quand quelque chose tourne mal</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vélo</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Suivi</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conclusion</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ce dont je ne suis pas sûr</a> <br></li></ul><br><h2>  Écriture de code </h2><br><a name="1"></a><h4>  Comment nommer les choses dans le code </h4><br>  L'une de mes premières tâches a été de travailler sur React UI.  Nous avions un composant principal qui contenait tous les autres composants.  J'aime ajouter un peu d'humour au code, et je voulais nommer le composant principal de <code>GodComponent</code> .  Le moment est venu de revoir le code, et j'ai compris pourquoi il est si difficile de donner des noms. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="7269997868"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Chaque morceau de code que j'ai baptisé a acquis un objectif implicite.  <code>GodComponent</code> ?  C'est le composant qui récupère toutes les ordures que je ne veux pas mettre au bon endroit.  Il contient tout.  Nommez-le <code>LayoutComponent</code> , et l'avenir, je déciderais que ce composant attribue une disposition.  Qu'il ne contient pas d'état. <br><br>  Une autre leçon importante que j'ai apprise est que si quelque chose semble trop gros, comme un <code>LayoutComponent</code> avec un tas de logique métier, il est temps de le refactoriser, car il ne devrait pas y avoir de logique métier ici.  Et dans le cas du nom <code>GodComponent</code> présence de la logique métier n'aura pas d'importance. <br><br>  Besoin de nommer les clusters?  Les appeler après les services qui s'exécutent sur eux sera une excellente idée jusqu'à ce que vous exécutiez autre chose sur ces clusters.  Nous leur avons donné un nom en l'honneur de notre équipe. <br><br>  La même chose s'applique aux fonctions.  <code>doEverything()</code> est un nom terrible avec de nombreuses conséquences.  Si la fonction fait tout, il sera sacrément difficile de tester ses différentes parties.  Quelle que soit la taille de cette fonction, elle ne vous semblera jamais trop étrange, car elle devrait tout faire.  Alors changez le nom.  Refact. <br><br>  Un nom significatif a un inconvénient.  Soudain, le nom sera trop significatif et cachera une sorte de nuance?  Par exemple, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fermeture de sessions</a> ne ferme pas la connexion à la base de données lorsque <code>session.close()</code> appelée dans SQLAlchemy.  J'aurais dû lire la documentation et éviter ce bug, plus à ce sujet dans la section <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vélo</a> . <br><br>  De ce point de vue, nommer des fonctions comme <code>x</code> , <code>y</code> , <code>z</code> au lieu de <code>count()</code> , <code>close()</code> , <code>insertIntoDB()</code> ne nous permet pas de leur donner une certaine signification et me fait surveiller attentivement ce que font ces fonctions.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>2</sup></a> <br><br>  Je n'ai jamais pensé que j'écrirais sur les principes de nommer plus d'une ligne de texte. <br><br><a name="2"></a><h4>  Code hérité et prochain développeur </h4><br>  Avez-vous déjà regardé le code et il vous semble étrange?  Pourquoi as-tu écrit ça?  Cela n'a aucun sens. <br><br>  J'ai eu la chance de travailler avec une base de code héritée.  Ceci, vous le savez, avec des commentaires comme "Décommentez le code lorsque Mahomet comprend la situation."  Que fais tu ici?  Qui est Mohammed? <br><br>  Je peux changer de rôle et penser à la personne qui recevra ensuite mon code, cela lui paraîtra-t-il étrange?  Une révision partielle de votre code aide vos collègues à réviser votre code.  Cela m'a amené à réfléchir au contexte: je dois me souvenir du contexte dans lequel mon équipe travaille. <br><br>  Si j'oublie ce code, y reviens plus tard et ne peux pas restaurer le contexte, je dirai: «Qu'est-ce qu'ils ont fait?  C'est stupide ... Ah, attends, je l'ai fait. " <br><br>  Et ici, la documentation et les commentaires du code entrent en jeu. <br><br><a name="3"></a><h4>  Documentation et commentaires en code </h4><br>  Ils aident à maintenir le contexte et à transmettre les connaissances.  Comme Lee l'a dit dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment construire un bon logiciel</a> : <br><br><blockquote>  La valeur principale du logiciel n'est pas dans le code créé, mais dans les connaissances accumulées par les personnes qui ont créé ce logiciel </blockquote><br>  Vous disposez d'un point de terminaison API client ouvert que personne ne semble avoir jamais utilisé.  Doit-il simplement être supprimé?  D'une manière générale, il s'agit d'un devoir technique.  Et si je vous dis que dans l'un des pays 10 journalistes envoient leurs reportages à ce point final une fois par an?  Comment le vérifier?  Si cela n'est pas mentionné dans la documentation (il l'était), il n'y a aucun moyen de le vérifier.  Nous n'avons pas vérifié.  Ils l'ont enlevé, et quelques mois plus tard est venu ce moment très annuel.  Dix journalistes n'ont pas pu envoyer leurs rapports importants car le point final n'existait plus.  Et des personnes connaissant les produits ont déjà quitté l'équipe.  Bien sûr, maintenant dans le code, il y a des commentaires expliquant pourquoi cela est nécessaire. <br><br>  Autant que je sache, chaque équipe se bat avec la documentation.  Et avec la documentation, non seulement par code, mais aussi par les processus qui lui sont associés. <br><br>  Nous n'avons pas encore trouvé la solution parfaite.  Personnellement, j'aime la façon dont Antirez a divisé les commentaires dans le code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">en différents types de valeurs</a> . <br><br><a name="4"></a><h4>  Atomic s'engage </h4><br>  Si vous devez revenir en arrière (et vous en avez besoin. Voir le chapitre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Test</a> ), cette validation aura-t-elle un sens en tant que module unique? <br><br><a name="5"></a><h4>  Comment supprimer en toute confiance le code moche </h4><br>  J'étais très désagréable de supprimer le code moche ou obsolète.  Il me semblait que tout ce qui était écrit il y a des siècles est sacré.  J'ai pensé: "Ils avaient quelque chose en tête quand ils ont écrit comme ça."  Il s'agit d'une confrontation entre tradition et culture d'une part, et réflexion à la manière du «principe primaire» d'autre part.  C'est la même chose que la suppression du point final annuel.  J'ai appris une leçon spéciale.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>3</sup></a> <br><br>  J'essaierais de contourner le code et les principaux développeurs essaieraient de le traverser.  Effacez-le.  Une expression if inaccessible?  Ouais, on efface.  Qu'ai-je fait?  Je viens d'écrire ma fonction dessus.  Je n'ai pas réduit la dette technique.  Quoi qu'il en soit, je viens d'augmenter la complexité du code et le transfert.  Il sera encore plus difficile pour la prochaine personne d'assembler les morceaux de l'image. <br><br>  Empiriquement, je suis arrivé à la conclusion: il y a un code que vous ne comprenez pas, mais il y a un code que vous ne contacterez certainement jamais.  Effacez le code que vous ne contactez pas et soyez prudent avec le code que vous ne comprenez pas. <br><br><a name="6"></a><h4>  Examen du code </h4><br>  Un examen du code est un excellent outil pour l'auto-éducation.  Il s'agit d'une boucle de rétroaction externe montrant comment ils écriraient le code et comment vous l'avez écrit.  Quelle est la différence?  D'une manière meilleure qu'une autre?  Je me suis posé des questions à ce sujet à chaque avis: «Pourquoi ont-ils écrit de cette façon?  Et s'il ne pouvait pas trouver une réponse appropriée, alors il est allé demander. <br><br>  Après le premier mois, j'ai commencé à trouver des erreurs dans le code de mes collègues (comme ils l'ont trouvé dans le mien).  C'était une sorte de folie.  La revue est devenue beaucoup plus intéressante pour moi, elle s'est transformée en un jeu qui me manquait, un jeu qui a amélioré mon "sens du code". <br><br>  D'après mon expérience, vous n'avez pas à approuver le code tant que je ne comprends pas comment il fonctionne. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96a/2ad/248/96a2ad248018ff0721f16a262dbb294c.png"><br>  <i>Mes statistiques github.</i> <br><br><a name="7"></a><h2>  Test </h2><br>  J'ai tellement aimé les tests qu'il est désagréable d'écrire du code dans une base de code sans tests. <br><br>  Si votre application ne fait qu'une seule chose (comme tous mes projets scolaires), vous pouvez toujours tester manuellement.  C'est exactement ce que j'ai fait.  Mais que se passe-t-il si une application effectue 100 tâches différentes?  Je ne veux pas passer une demi-heure à tester, et parfois je perds de vue quelque chose.  Un cauchemar. <br><br>  Les tests et l'automatisation des tests aident ici. <br><br>  Je traite les tests comme de la documentation.  Ceci est la documentation de mes idées sur le code.  Les tests me disent comment j'imagine (ou quelqu'un d'autre avant moi) le fonctionnement du code et où quelque chose devrait mal tourner. <br><br>  Aujourd'hui, quand j'écris des tests, j'essaye: <br><br><ol><li>  Montrez comment utiliser la classe, la fonction ou le système de test. <br></li><li>  Montrez ce qui, à mon avis, pourrait mal tourner. <br></li></ol><br>  Du coup, je teste le plus souvent le comportement, mais pas l'implémentation ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">voici un exemple</a> que j'ai choisi lors des pauses chez Google). <br><br>  Au paragraphe 2, je n'ai pas mentionné les sources de bugs. <br><br>  Lorsque je remarque un bogue, je m'assure que le correctif dispose d'un test approprié (appelé test de régression) pour documenter les informations.  C'est une autre raison pour laquelle quelque chose pourrait mal tourner.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>5</sup></a> <br><br>  Bien sûr, la qualité de mon code s'améliore non pas parce que j'écris des tests, mais parce que j'écris du code.  Mais la lecture des tests m'aide à mieux comprendre les situations et à écrire un meilleur code. <br><br>  C'est la situation générale des tests. <br><br>  Mais ce n'est pas le seul type de test que j'applique.  Je parle des environnements de déploiement.  Vous pouvez avoir des tests unitaires idéaux, mais si vous n'avez pas de tests système, quelque chose comme cela peut se produire: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/905/1c5/bb8/9051c5bb8da5d845cbd0d9c6dcccf236.gif"><br><br>  Cela s'applique également au code bien testé: si vous n'avez pas les bibliothèques nécessaires sur votre ordinateur, alors tout se bloquera. <br><br><ul><li>  Il y a des machines sur lesquelles vous développez (la source de tous les mèmes comme "Ça a fonctionné sur mon ordinateur!"). <br></li><li>  Il y a des machines sur lesquelles vous testez (peuvent coïncider avec les précédentes). <br></li><li>  Enfin, il y a des machines sur lesquelles vous déployez (elles ne doivent pas coïncider avec les machines sur lesquelles vous avez développé). <br></li></ul><br>  Si les environnements de test et de déploiement ne correspondent pas sur les machines, vous aurez des problèmes.  Les environnements de déploiement aideront à éviter cela. <br><br>  Nous faisons du développement local dans Docker sur notre ordinateur. <br><br>  Nous avons un environnement de développement, ces ordinateurs sont équipés d'un ensemble de bibliothèques (et d'outils de développement), et ici nous installons le code écrit.  Ici, il peut être testé avec tous les systèmes nécessaires.  Nous avons également un environnement bêta / intermédiaire qui reproduit entièrement l'environnement opérationnel.  Enfin, nous avons un environnement opérationnel - des machines qui exécutent du code pour nos clients. <br><br>  L'idée est de détecter les erreurs qui ne sont pas apparues lors des tests unitaires et système.  Par exemple, la différence d'API entre les systèmes demandeur et répondant.  Je pense que dans le cas d'un projet personnel ou d'une petite entreprise, la situation peut être complètement différente.  Tout le monde n'a pas la possibilité de créer sa propre infrastructure.  Cependant, vous pouvez recourir à des services cloud tels que AWS et Azure. <br><br>  Vous pouvez configurer des clusters individuels pour le développement et le fonctionnement.  AWS ECS utilise des images Docker pour se déployer, de sorte que les processus dans différents environnements seront relativement cohérents.  Il existe des nuances en termes d'intégration entre les différents services AWS.  Appelez-vous le bon point de terminaison à partir du bon environnement? <br><br>  Vous pouvez aller encore plus loin: téléchargez des images de conteneur alternatives pour d'autres services AWS et configurez un environnement local entièrement basé sur Docker-Compose.  Cela accélère la boucle de rétroaction.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>6</sup></a> J'acquérirai peut-être plus d'expérience lorsque je créerai et lancerai mon projet parallèle. <br><br><a name="8"></a><h2>  Réduction des risques </h2><br>  Quelles mesures pouvez-vous prendre pour réduire votre risque de catastrophe?  Si nous parlons d'un nouveau changement radical, comment pouvons-nous vérifier la durée minimale des temps d'arrêt, en cas de problème?  "Nous n'avons pas besoin de déployer complètement le système à cause de tous ces nouveaux changements."  Quoi vraiment?  Et pourquoi n'y ai-je pas pensé! <br><br><a name="9"></a><h2>  L'architecture </h2><br>  Pourquoi parle-t-on d'architecture après avoir écrit du code et testé?  Il peut être installé en premier, mais si je n'avais pas programmé et testé dans l'environnement que j'utilisais, je n'aurais probablement pas réussi à créer une architecture qui prenne en compte les caractéristiques de cet environnement.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><sup>7</sup></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a> <br>  Vous devez beaucoup réfléchir lors de la création d'une architecture. <br><br><ul><li>  Comment les numéros seront-ils utilisés? <br></li><li>  Combien d'utilisateurs y aura-t-il?  Combien leur nombre peut-il augmenter (le nombre de lignes dans la base de données en dépend)? <br></li><li>  Quels récifs peuvent se rencontrer? <br></li></ul><br>  Je dois transformer cela en une liste de contrôle appelée «Collection de réclamations».  Pour l'instant je n'ai pas assez d'expérience, j'essaierai de le faire l'année prochaine chez Bloomberg.  Ce processus est en grande partie contraire à Agile: combien pouvez-vous concevoir l'architecture avant de passer à l'implémentation?  Tout est question d'équilibre, vous devez choisir quand et ce que vous ferez.  Quand est-il sensé de se précipiter et quand - de prendre du recul?  Bien sûr, la collecte des exigences ne revient pas à considérer toutes les questions.  Je pense que cela vaut la peine si nous incluons les processus de développement dans la conception.  Par exemple: <br><br><ul><li>  Comment se déroulera le développement local? <br></li><li>  Comment allons-nous emballer et déployer? <br></li><li>  Comment procéderons-nous aux tests de bout en bout? <br></li><li>  Comment effectuerons-nous des tests de résistance du nouveau service? <br></li><li>  Comment garderons-nous des secrets? <br></li><li>  Intégration CI / CD? <br></li></ul><br>  Nous avons récemment développé un nouveau moteur de recherche pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BNEF</a> .  C'était merveilleux de travailler dessus, j'ai organisé un développement local et découvert DPG (packages et leur déploiement), levant le déploiement de secrets. <br><br>  Qui aurait pensé que le déploiement de secrets sur une prod pourrait être si simple: <br><br><ol><li>  Ils ne peuvent pas être placés dans le code, car quelqu'un peut les remarquer <br></li><li>  Les stocker comme variable d'environnement car la spécification propose 12 facteurs d'application?  Pas une mauvaise idée, mais comment les mettre là?  (Aller à la prod pour remplir les variables d'environnement à chaque démarrage de la voiture est une douleur) <br></li><li>  Les déployer en tant que fichiers?  Mais d'où viendront-ils et comment les remplir? <br></li></ol><br>  Nous ne voulons pas tout faire manuellement. <br><br>  En conséquence, nous sommes arrivés à une base de données avec un contrôle d'accès basé sur les rôles (seuls nous et nos ordinateurs pouvons communiquer avec la base de données).  Notre code reçoit des secrets de la base de données au démarrage.  Cette approche est bien reproduite dans le cadre des environnements de développement, de transfert et d'exploitation; les secrets sont stockés dans des bases de données appropriées. <br><br>  Encore une fois, avec des services cloud comme AWS, la situation peut être complètement différente.  Vous n'avez pas besoin de vous occuper des secrets d'une manière ou d'une autre.  Obtenez un compte pour votre rôle, entrez les secrets dans l'interface et votre code les trouvera quand ils seront nécessaires.  Cela simplifie grandement tout, mais je suis heureux d'avoir acquis de l'expérience, grâce à laquelle je peux apprécier cette simplicité. <br><br><a name="10"></a><h4>  Nous créons de l'architecture, sans oublier la maintenance </h4><br>  La conception du système est inspirante.  Et l'escorte?  Pas trop.  Mon voyage dans le monde des escortes m'a conduit à la question: pourquoi et comment les systèmes se dégradent-ils?  La première partie de la réponse n'est pas liée au déclassement de tous obsolètes, mais seulement à l'ajout d'un nouveau.  La tendance à ajouter plutôt qu'à supprimer (cela ne rappelle-t-il rien?).  La deuxième partie est la conception avec l'objectif ultime à l'esprit.  Un système qui, avec le temps, commence à faire ce à quoi il n'était pas destiné, ne fonctionnera pas nécessairement aussi bien qu'un système initialement conçu pour les mêmes tâches.  Il s'agit d'une approche de style pas en arrière, pas de trucs et astuces. <br><br>  Je connais au moins trois façons de réduire le taux de dégradation. <br><br><ol><li>  Logique métier et infrastructure distinctes: l'infrastructure se dégrade généralement - la charge augmente, les frameworks deviennent obsolètes, des vulnérabilités zero-day apparaissent, etc. <br></li><li>  Créez des processus pour une assistance future.  Appliquez les mêmes mises à jour pour les anciens et les nouveaux bits.  Cela évitera les différences entre l'ancien et le nouveau et gardera tout le code dans un état «moderne». <br></li><li>  Assurez-vous de jeter tout ce qui est inutile et ancien. <br></li></ol><br><a name="11"></a><h2>  Déploiement </h2><br>  Vais-je regrouper des fonctionnalités ou les déployer une à la fois?  Selon le processus en cours, si vous les regroupez, attendez les problèmes.  Demandez-vous pourquoi vous souhaitez regrouper des fonctionnalités? <br><br><ul><li>  Le déploiement prend beaucoup de temps? <br></li><li>  La révision de code n'est-elle pas trop amusante? <br></li></ul><br>  Quelle que soit la raison, cette situation doit être corrigée.  Je connais au moins deux problèmes liés à l'emballage: <br><br><ol><li>  Vous bloquez vous-même toutes les fonctionnalités si l'une d'elles a un bug. <br></li><li>  Vous augmentez le risque de problèmes. <br></li></ol><br>  Quel que soit le processus de déploiement que vous choisissez, vous voulez toujours que vos voitures soient comme du bétail, pas comme des animaux de compagnie.  Ils ne sont pas uniques.  Vous savez exactement ce qui est exécuté sur chaque machine, comment les recréer en cas de décès.  Vous ne serez pas contrarié si une voiture meurt, vous en prenez une nouvelle.  Vous les faites paître, vous ne grandissez pas. <br><br><a name="12"></a><h2>  Quand quelque chose tourne mal </h2><br>  En cas de problème - et c'est le cas - il existe une règle d'or: minimiser l'impact sur les clients.  En cas d'échecs, mon premier désir a toujours été de le réparer.  Cela ne semble pas être la solution optimale.  Au lieu de réparer, même si cela peut être fait sur une seule ligne, vous devez d'abord revenir en arrière.  Revenez à l'état de fonctionnement précédent.  C'est le moyen le plus rapide de ramener les clients à une version fonctionnelle.  Ce n'est qu'alors que je découvre quel est le problème et le règle. <br><br>  Il en va de même pour la machine «endommagée» de votre cluster: éteignez-la, marquez-la comme inaccessible, avant de découvrir ce qui lui est arrivé.  Je trouve étrange combien mon désir naturel et mes instincts contredisent la solution optimale. <br><br>  Je pense que cet instinct a également conduit au fait que j'ai corrigé les bugs plus longtemps.  Parfois, je me rendais compte que quelque chose ne fonctionnait pas, parce que le code que j'avais écrit était en quelque sorte faux, et je grimpais dans la nature, en regardant chaque ligne.  Quelque chose comme une recherche «d'abord en profondeur».  Et quand il s'est avéré que le problème est survenu en raison d'un changement de configuration, c'est-à-dire que je ne l'ai pas vérifié en premier lieu, cette situation m'a perturbé.  J'ai perdu beaucoup de temps à chercher un bug. <br><br>  Depuis lors, j'ai appris à chercher «en premier» et donc déjà «en premier» afin d'exclure des raisons de niveau supérieur.  Que puis-je confirmer exactement avec les ressources actuelles? <br><br><ul><li>  La voiture fonctionne-t-elle? <br></li><li>  Le code est-il installé correctement? <br></li><li>  Y a-t-il une configuration? <br></li><li>  &lt;Configuration spécifique au code&gt;, par exemple si le routage est correctement défini? <br></li><li>  La version du schéma est-elle correcte? <br></li><li>  Et puis je plonge dans le code. <br></li></ul><br><blockquote>  Nous pensions que nginx n'était pas installé correctement, mais il s'est avéré que la configuration était désactivée </blockquote><br>  Bien sûr, je n'ai pas besoin de le faire à chaque fois.  Parfois, un simple message d'erreur suffit pour passer immédiatement au code.  Lorsque je ne peux pas déterminer la cause, j'essaie de minimiser le nombre de changements de code afin de trouver la raison.  Moins il y a de changements, plus vite je peux trouver la véritable racine du problème.  De plus, j'ai maintenant un mémo pour les bugs qui m'a sauvé plus d'une heure en pensant "qu'est-ce que j'ai raté?"  Parfois, j'oublie les vérifications les plus simples, telles que la configuration du routage, le schéma correspondant et les versions de service, etc.  C'est une autre étape dans la maîtrise de la pile technologique que j'utilise, et ce que vous gagnez uniquement avec l'expérience, c'est l'intuition pour déterminer ce qui ne fonctionne pas exactement. <br><br><a name="13"></a><h4>  Vélo </h4><br>  Cet article ne peut pas être complet sans histoire.    ,        .      SQLAlchemy.  BNEF   ,     .      .          SQLAlchemy,   ,        Solr.  -   . <br><br>           «MYSQL server has gone away.»     .     ,     ,   . ,      .         ,    .     ,    ? <br><br>  ,      ?     ,      ,       .     ,         ,      <code>__exit__()</code>  <code>session.close()</code> . <br><br>     ,  ,    .             .          .      .    . <br><br> <code>Session.close()</code>  MySQL- SQLAlchemy      ,    NullPool.   . ,      ,           .      :     StackOverflow (,   !)     ,   ,     SQL- .       ,       .  ,        ,     (),     . <br><br>    «»  ,      1   8.   ,   ,       —          . <br><br><blockquote>     ,      . </blockquote><br><a name="14"></a><h2>  </h2><br>  ,       .  ,         ,      .    ,      . <br><br>    ,      ,      ,      .     ,      .  ,      . « <i>  ?!        ,  ?</i> ». <br><br>  ,      : ,   .   ,   ,  .  ,     ,     .     ,       .     —     ? ,   ,   .          .  ,     -,     ,    ,   ,  ,  ..        . <br><br>      .    ,     ,     ?          (,    AWS CloudWatch  Grafana).            . <br><br>        .       ,      ,       50 %,       —   .    ?   .     ,    —      (, ?). <br><br>        .   ,      ,  ,    ,      ?   ?    ,    ? <br><br>    ,   .      ,    .      —    -  . <br><br><a name="15"></a><h2>  Conclusion </h2><br>      .  ,     ,       ,     .   ,      - ! <br><br>        . ,    ! <br><br><blockquote>     ,        .     ,                — <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">How to Build Good Software</a> . </blockquote><br><a name="16"></a><h2>      </h2><br>        .       :     !     ,         . <br><br><ol><li>    ? <br></li><li>          ? ,    ?    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">,   </a> ? <br></li><li>   .       ,      ?    ? <br></li><li>     (utils) (,     ,   ,  )  ,   « »? <br></li><li>         ? <br></li><li>    ,  ,  -  ? <br></li><li>   —      API    ,         ? <br></li><li>    ?  ,     . <br></li><li>     ,   ,  .  ,   ,       . <br></li><li>      PR: «      ,    ,     52 ,  , ,  ,     ,   ».    ? <br></li><li>    .        ? <br></li><li>    ? <br></li><li>     ? <br></li></ol><br><h2>  </h2><br><ol><li><a name="17"></a>     .  ,    ?  - ?    ,    ? <br></li><li><a name="18"></a>    ,        <code>x()</code> , <code>y()</code>  <code>z(),</code>       <code>x()</code> , <code>y()</code>  <code>z()</code> .  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WYSIATI</a> . <br></li><li><a name="19"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> .</a> <br></li><li><a name="20"></a>       .      ,   ? <br></li><li><a name="21"></a>  ,    - ,      ,     .   ,   . <br></li><li><a name="22"></a>     ,    ,       Docker-  AWS. <br></li><li><a name="23"></a>         . <br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr465561/">https://habr.com/ru/post/fr465561/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr465547/index.html">Guide SQL: comment mieux écrire des requêtes (partie 1)</a></li>
<li><a href="../fr465551/index.html">Résumé des événements informatiques de septembre (première partie)</a></li>
<li><a href="../fr465553/index.html">Langage de programmation Ü. Introduction, motivation pour créer, objectifs</a></li>
<li><a href="../fr465555/index.html">12 compétences générales qui rendent les chefs de projet informatiques imparables</a></li>
<li><a href="../fr465557/index.html">Délais de développement de produits</a></li>
<li><a href="../fr465567/index.html">Test du code SQL Server avec tSQLt</a></li>
<li><a href="../fr465569/index.html">Carte de développement des développeurs mobiles</a></li>
<li><a href="../fr465571/index.html">Comment vendre des cigarettes aux hommes pour les femmes et protéger les sauvages: des rédacteurs qui pourraient</a></li>
<li><a href="../fr465573/index.html">Toute la puissance d'IntelliJ IDEA sur l'exemple d'une langue (en images)</a></li>
<li><a href="../fr465575/index.html">Opérations de comparaison en C ++ 20</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>