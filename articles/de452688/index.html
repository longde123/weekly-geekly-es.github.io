<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì° üßìüèæ ‚õπÔ∏è Windows-Dienst. Suchen Sie nach Systemfehlern und zeigen Sie diese in WinForm C # an üîÇ ü§¶üèø üë©‚Äç‚ù§Ô∏è‚Äçüë®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel wird erl√§utert, wie Sie eine Anwendung von Grund auf neu erstellen, die mit Windows-Diensten funktioniert und Systemfehler in WinFor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Windows-Dienst. Suchen Sie nach Systemfehlern und zeigen Sie diese in WinForm C # an</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452688/">  In diesem Artikel wird erl√§utert, wie Sie eine Anwendung von Grund auf neu erstellen, die mit Windows-Diensten funktioniert und Systemfehler in WinForm (C #) anzeigt. <br><br>  Der Umriss dieses Artikels: <br><br><ul><li>  Serviceerstellung </li><li>  Ereignisanzeige </li><li>  Service Code </li><li>  √úberpr√ºfen des Dienstes (Manuelles Starten des Dienstes) </li><li>  WinForm-Zuordnung </li></ul><br><h4>  Serviceerstellung </h4><br>  √ñffnen Sie Visual Studio.  N√§chste Datei ‚Üí Neu ‚Üí Projekt ‚Üí (Windows Desktop) ‚Üí Windows-Dienst (.Net Framework) ‚Üí Ok. <br><br>  Als n√§chstes m√ºssen Sie ein Installationsprogramm erstellen.  Klicken Sie im folgenden Fenster auf RMB und w√§hlen Sie "Installationsprogramm hinzuf√ºgen".  Sie haben "ProjectInstaller.cs [Design]" erstellt, danach m√ºssen Sie zum "F7" -Code oder RMB "View Code" wechseln.  Sie m√ºssen die Zeile "InitializeComponent ();" suchen, den Cursor darauf setzen und "F12" dr√ºcken, dann m√ºssen Sie die folgenden Zeilen hinzuf√ºgen: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.serviceProcessInstaller1.Account = System.ServiceProcess.ServiceAccount.LocalSystem; <span class="hljs-comment"><span class="hljs-comment">//       this.serviceInstaller1.Description = "Show me system error."; //       this.serviceInstaller1.DisplayName = "GetSystemError"; //       </span></span></code> </pre> <br>  Sie m√ºssen diese Zeilen jedoch nur in der folgenden Reihenfolge und an der folgenden Stelle hinzuf√ºgen.  Andernfalls tritt bei der Installation des Dienstes ein Fehler auf. <br><br><img src="https://habrastorage.org/webt/48/0y/wl/480ywl42i-wkfnuzfqvg0_5qznu.jpeg"><br><a name="habracut"></a><br><h4>  Ereignisanzeige </h4><br>  Dies ist notwendig, um den korrekten Betrieb unseres Programms zu √ºberpr√ºfen. <br><br>  Ereignisanzeige - Ein Programm zum Anzeigen des Ereignisprotokolls auf jedem Computer mit Windows.  Jedes Programm, das auf einem Computer ausgef√ºhrt wird, ver√∂ffentlicht eine Benachrichtigung im Ereignisprotokoll, bevor es gestoppt wird.  Jeder Zugriff auf das System, Sicherheits√§nderungen, Optimierung des Betriebssystems, Hardwarefehler und Treiberfehler - all dies wird in das Ereignisprotokoll aufgenommen.  Die Ereignisanzeige scannt Textprotokolldateien, kombiniert sie und platziert sie in der Benutzeroberfl√§che. <br><br>  Wie √∂ffne ich es?  - Start ‚Üí Ereignisanzeige (in der Suche) ‚Üí ‚ÄûEreignisprotokolle anzeigen‚Äú. <br><br>  Weiter "Benutzerdefinierte Ansichten" ‚Üí "Administrative Ereignisse".  Hier sehen wir alle Fehler, Warnungen und Informationen dazu. <br><br>  Es gibt drei Arten von Protokollen: Anwendung (Anwendung), System (System) und Sicherheit (Sicherheit).  Wir brauchen nur ein System (System). <br><cut></cut><br><h4>  Service Code </h4><br>  Wir finden die CS-Datei mit dem Namen des Dienstes, ich habe es "Service1.cs", √∂ffnen Sie es.  Die Datei muss zwei √ºberschriebene Methoden haben: <br><br><ul><li>  OnStart (string [] args) - wird ausgef√ºhrt, wenn der Dienst gestartet wird. </li><li>  OnStop () - wird ausgef√ºhrt, wenn der Dienst gestoppt wird. </li></ul><br>  Es gibt noch einige weitere Methoden, die wir jetzt jedoch nicht ben√∂tigen.  Sie k√∂nnen sie selbst finden. <br><br>  Die Daten, die wir erhalten, werden in einer aktualisierten Textdatei gespeichert, also f√ºgen wir hinzu <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO;</code> </pre> <br>  F√ºgen Sie den Code zur OnStart-Methode hinzu (string [] args): <br><br><pre> <code class="cs hljs">EventLog myLog; <span class="hljs-comment"><span class="hljs-comment">//       string filepath = AppDomain.CurrentDomain.BaseDirectory + @"\ServiceLog.txt";; //    List&lt;string&gt; list; //    protected override void OnStart(string[] args) { myLog = new EventLog(); myLog.Log = "System"; //     - (Application),    (System). myLog.Source = "System Error"; for (int index = myLog.Entries.Count - 1; index &gt; 0; index--) //         { var errEntry = myLog.Entries[index]; \\     if (errEntry.EntryType == EventLogEntryType.Error) \\    { //     var appName = errEntry.Source; list = new List&lt;string&gt;(); list.Add("Entry Type: " + Convert.ToString(errEntry.EntryType)); list.Add("Event log: " + (string)myLog.Log); list.Add("Machine Name: " + (string)errEntry.MachineName); list.Add("App Name: " + (string)errEntry.Source); list.Add("Message: " + (string)errEntry.Message); list.Add("Time Written: " + errEntry.TimeWritten.ToString()); list.Add("-*-"); WriteToFile(list); //    } } } public void WriteToFile(List&lt;string&gt; list) //   { using (StreamWriter sw = File.AppendText(filepath)) { for (int i = 0; i &lt; list.Count; i++) sw.WriteLine(list[i]); } }</span></span></code> </pre> <br>  Als n√§chstes m√ºssen Sie die L√∂sung "L√∂sung" -&gt; "L√∂sung neu erstellen" sammeln.  Nach erfolgreicher Montage k√∂nnen Sie den Vorgang √ºberpr√ºfen. <br><br><h4>  √úberpr√ºfen des Dienstes (Manuelles Starten des Dienstes) </h4><br>  Der Windows-Dienst kann nicht als regul√§re Anwendung gestartet werden.  Sie k√∂nnen nur als Administrator √ºber die Befehlszeile ausgef√ºhrt werden. <br><br>  F√ºhren Sie die Befehlszeile als Administrator aus.  Geben Sie die folgenden Befehle ein: <br><br><pre> <code class="plaintext hljs">cd C:\Windows\Microsoft.NET\Framework\v4.0.30319 InstallUtil.exe \  .exe (InstallUtil.exe C:\Users\\source\repos\WindowsService1\WindowsService1 \bin\Debug\WindowsService1.exe)    : InstallUtil.exe -u \  .exe</code> </pre> <br>  Dr√ºcken Sie anschlie√üend die Win + R-Taste.  Geben Sie "Services.msc" ein.  Wir finden unseren Service in der Liste, klicken darauf und klicken auf "Start".  Nach einem erfolgreichen Start wird unter dem im Code angegebenen Pfad eine Datei generiert, die eine Liste der Systemfehler enth√§lt. <br>  Vergessen Sie nicht, den Dienst nach der √úberpr√ºfung zu l√∂schen. <br><cut></cut><br><h4>  WinForm-Zuordnung </h4><br>  Wenn Sie versuchen, in der Konsole anzuzeigen, k√∂nnen Sie Artikel finden, aber ich habe nicht gefunden, dass sie in WinForm angezeigt werden. Hier ist sie also.  Standardm√§√üig wird ein Serviceprojekt vom Typ Anwendung erstellt.  Um √ºber die Konsole angezeigt zu werden, muss dieser Parameter in den Einstellungen ge√§ndert werden, damit WinForm ihn unver√§ndert l√§sst.  Als n√§chstes m√ºssen Sie das Formular zum Projekt hinzuf√ºgen.  "WindowsService1" ‚Üí RMB ‚Üí Hinzuf√ºgen ‚Üí Windows Form ‚Üí Hinzuf√ºgen.  Und machen Sie das folgende Design.  √Ñndern Sie als N√§chstes die Datei "Program.cs". <br><br>  Hinzuf√ºgen mit: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Principal; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics;</code> </pre> <br>  Und √§ndern Sie die Hauptmethode: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { WindowsPrincipal windowsPricipal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WindowsPrincipal(WindowsIdentity.GetCurrent()); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> hasAdministrativeRight = windowsPricipal.IsInRole(WindowsBuiltInRole.Administrator); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hasAdministrativeRight == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-comment"><span class="hljs-comment">//    { ProcessStartInfo processInfo = new ProcessStartInfo(); //   processInfo.Verb = "runas"; //       processInfo.FileName = Application.ExecutablePath; try { Process.Start(processInfo); //   } catch (Win32Exception){} Application.Exit(); } else { Application.EnableVisualStyles(); Application.SetCompatibleTextRenderingDefault(false); Application.Run(new Form1(args)); //  } }</span></span></code> </pre> <br>  F√ºgen Sie eine neue Klasse "SystemError" hinzu.  ("WindowsService1" -&gt; RMB -&gt; Hinzuf√ºgen -&gt; Klasse -&gt; Hinzuf√ºgen).  Hier speichern wir Fehlerdaten.  √Ñndern Sie es: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> EntryType{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> EventLog{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MachineName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> AppName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Message { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> TimeWritten { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre> <br>  Weiter in "Service1.cs" f√ºgen wir die Methode "RunFromForm (string [] args)" hinzu, die den Dienst startet. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunFromForm</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { OnStart(args); OnStop(); }</code> </pre> <br>  F√ºgen Sie eine neue Klasse "GetListErrors" hinzu.  ("WindowsService1" -&gt; RMB -&gt; Hinzuf√ºgen -&gt; Klasse -&gt; Hinzuf√ºgen).  Hier erhalten wir die Daten aus der Datei.  Hinzuf√ºgen mit: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO;</code> </pre> <br>  √Ñndern Sie es: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> filepath = AppDomain.CurrentDomain.BaseDirectory + <span class="hljs-string"><span class="hljs-string">@"\ServiceLog.txt"</span></span>; SystemError systemError; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;SystemError&gt; listSysErrs; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//          { systemError = new SystemError(); listSysErrs = new List&lt;SystemError&gt;(); using (StreamReader sr = new StreamReader(filepath)) { string line; while ((line = sr.ReadLine()) != null) { if (line.Contains("-*-")) { listSysErrs.Add(systemError); systemError = new SystemError(); //       } if (line.Contains("Entry Type")) { systemError.EntryType = line.Substring(12); } else if (line.Contains("Event log")) { systemError.EventLog = line.Substring(11); } else if (line.Contains("Machine Name")) { systemError.MachineName = line.Substring(14); } else if (line.Contains("App Name")) { systemError.AppName = line.Substring(10); } else if (line.Contains("Message")) { systemError.Message = line.Substring(9); } else if (line.Contains("Time Written")) { systemError.TimeWritten = line.Substring(14); } } } }</span></span></span></span></code> </pre> <br>  √Ñndern Sie als N√§chstes den Code des Formulars "Form1.cs".  Hinzuf√ºgen mit: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ServiceProcess; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics;</code> </pre> <br>  √Ñndern Sie es: <br><br><pre> <code class="cs hljs">Service1 service = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Service1(); List&lt;SystemError&gt; listSysErrs; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] args; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Form1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { InitializeComponent(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.args = args; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Environment.UserInteractive)<span class="hljs-comment"><span class="hljs-comment">//          { service.RunFromForm(args); //  GetListErrors getListErrors = new GetListErrors(); getListErrors.ReadFile(); //      listSysErrs = getListErrors.listSysErrs; FillDataGridView(); //    } else { ServiceBase[] ServicesToRun; ServicesToRun = new ServiceBase[] { service }; ServiceBase.Run(ServicesToRun); } } public void FillDataGridView() //     { foreach (SystemError item in listSysErrs) { dataGridView1.Rows.Add(item.AppName, item.Message); } } private void dataGridView1_CellClick(object sender, DataGridViewCellEventArgs e) //                { SystemError sys = listSysErrs[dataGridView1.CurrentRow.Index]; label1.Text = "Entry Type: " + sys.EntryType + "\nEvent log: " + sys.EventLog + "\nMachine Name: " + sys.MachineName + "\nApp Name: " + sys.AppName + "\n\nMessage: " + FormatMessage(sys.Message) + "\n\nTime Written: " + sys.TimeWritten; } private string FormatMessage(string msg) //       ,                 { string retMsg = ""; int count = 75; if (msg.Length &gt; count - 9) { retMsg += msg.Substring(0, count - 9) + "\n"; msg = msg.Substring(count - 9); } while (msg.Length &gt; count) { retMsg += msg.Substring(0, count) + "\n"; msg = msg.Substring(count); } retMsg += msg + "\n"; return retMsg; } private void button1_Click(object sender, EventArgs e) //          { if (Environment.UserInteractive) { while (dataGridView1.Rows.Count != 0) { dataGridView1.Rows.Remove(dataGridView1.Rows[dataGridView1.Rows.Count - 1]); } service.RunFromForm(args); GetListErrors getListErrors = new GetListErrors(); getListErrors.ReedFile(); listSysErrs = getListErrors.listSysErrs; FillDataGridView(); } else { ServiceBase[] ServicesToRun; ServicesToRun = new ServiceBase[] { service }; ServiceBase.Run(ServicesToRun); } } private void button2_Click(object sender, EventArgs e) { Process.Start(AppDomain.CurrentDomain.BaseDirectory); //  }</span></span></code> </pre> <br>  Jetzt k√∂nnen Sie den Dienst als regul√§re Anwendung starten.  Das Ergebnis ist wie folgt: <br><br><img src="https://habrastorage.org/webt/pk/jp/nr/pkjpnr07wztrn15ko5ofzouxov8.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452688/">https://habr.com/ru/post/de452688/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452672/index.html">W√∂chentlich Habr. Lernen Sie die Habrapodcast-Pilotversion kennen</a></li>
<li><a href="../de452674/index.html">Digitale Veranstaltungen in Moskau vom 21. bis 26. Mai</a></li>
<li><a href="../de452682/index.html">Prognose und Diskussion: Hybridspeichersysteme werden All-Flash weichen</a></li>
<li><a href="../de452684/index.html">Ein Spiel auf Svelte 3 entwickeln</a></li>
<li><a href="../de452686/index.html">Spionage, f√ºr die sie nicht verbieten (eine Geschichte aus den 80ern)</a></li>
<li><a href="../de452690/index.html">Was ist so interessant an der Transsibirischen Eisenbahn?</a></li>
<li><a href="../de452692/index.html">Der Autor des rePalm-Projekts hat Palm OS von Grund auf neu geschrieben und plant, es in eine Smart-Watch-Plattform umzuwandeln</a></li>
<li><a href="../de452696/index.html">So starten Sie Mikrozahlungen in Ihrer Anwendung</a></li>
<li><a href="../de452698/index.html">Zwei in einem: Touristendaten und Tickets f√ºr kulturelle Veranstaltungen waren √∂ffentlich verf√ºgbar</a></li>
<li><a href="../de452700/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 460 (05/07/2019 - 05/05/2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>