<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👴 🥙 👩🏻‍⚕️ Streaming WebRTC di dan sekitar realitas virtual 🚜 🕚 🥜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Realitas virtual sedang meningkat akhir-akhir ini. Peralatan yang sebelumnya merupakan milik eksklusif  ilmuwan gila  Geeks dengan uang besar  dari Ke...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Streaming WebRTC di dan sekitar realitas virtual</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flashphoner/blog/482270/"><p><img src="https://habrastorage.org/webt/jw/qo/v9/jwqov9cav_juhuolm3cwf8xm-aw.jpeg"></p><br><p>  Realitas virtual sedang meningkat akhir-akhir ini.  Peralatan yang sebelumnya merupakan milik eksklusif <del>  ilmuwan gila </del>  Geeks dengan uang besar <del>  dari Kementerian Pertahanan </del>  kembali pada hari-hari The Lawnmower Man, saat ini terjangkau untuk orang biasa;  mereka yang kantongnya kosong, dapat memasang headset VR dari kardus dan smartphone sesuai dengan banyak resep. </p><a name="habracut"></a><br><p>  VR dapat membawa lebih banyak manfaat daripada bioskop 3-4-5-6-7-sesuatu-D.  Katakanlah Anda tinggal di Chicago dan ingin menginvestasikan sumber daya yang diperoleh dengan jujur ​​ke real estat - di suatu tempat di sepanjang pantai Florida.  Seperti yang Anda ketahui, lebih baik memilih perumahan sendiri dan di tempat, tetapi bagaimana jika Anda tidak dapat mencurahkan cukup waktu untuk ini?  Di sinilah realitas virtual diperlukan.  Bayangkan saja: agen memasang kamera khusus di ruangan itu, dan Anda, tanpa meninggalkan kursi favorit Anda, dapat memeriksa ruangan ini, menoleh, dan bahkan menghargai langit-langit dengan mural abad ke-18 "Dewa-dewa Yunani berpesta!" </p><br><p>  Kemudian, masih tanpa meninggalkan tempat itu, Anda mungkin bertanya-tanya apa yang dilakukan anak-anak Anda di taman kanak-kanak.  Dan lagi: kamera ada di ruang permainan, dan Anda bisa mendapatkan pengalaman indera yang mendalam dengan memeriksa semua sudut tempat anak-anak Anda berada. <del>  bersembunyi </del>  . </p><br><p>  Sekarang kita akan mencari cara untuk memastikan semuanya bekerja, dan <del>  agen real estat </del>  anak-anak tidak berserakan. </p><br><h2 id="the-nuances-of-vr-picture">  Nuansa gambar VR </h2><br><p>  Secara teknis, aliran media VR tidak berbeda dari yang biasa;  ini adalah trek video plus trek audio.  Namun ada nuansa. </p><br><p>  Stream VR mengasumsikan gambar stereo.  Sebuah kamera khusus menatap dunia dengan dua <del>  mata </del>  lensa terbuka lebar (180 derajat), seperti robot. </p><br><p><img src="https://habrastorage.org/webt/yv/wq/gc/yvwqgcgjjnblruhtjnhduw3_xwq.jpeg"></p><br><p>  gambar-gambar bergabung dalam satu bingkai, </p><br><p><img src="https://habrastorage.org/webt/ot/mn/li/otmnli2-vsrodo4wcjplsdmuw50.png"></p><br><p>  oleh karena itu, pemain khusus harus diinstal pada perangkat pemirsa, yang akan membuat dua gambar satu.  Seperti yang Anda lihat, rasio aspek bingkai adalah 2: 1, yang menghasilkan gambar FullHD untuk setiap mata. </p><br><h2 id="the-nuances-of-vr-broadcast">  Nuansa siaran VR </h2><br><p>  Jadi, kita berbicara tentang menyiarkan stream 4K dengan bit rate yang tinggi.  Apa yang kita miliki  Kami memiliki RTMP dan WebRTC. </p><br><p>  RTMP adalah <del>  murah </del>  dapat diandalkan dan praktis.  Ini menggunakan TCP, yang berguna jika salurannya tidak terlalu bagus.  Ada berbagai solusi perangkat lunak untuk klien penerbitan, baik yang berbayar maupun gratis.  Namun, terlepas dari semua kelebihannya, RTMP memiliki latensi tinggi.  Dalam salah satu artikel sebelumnya, kami mencatat penundaan 2-3 detik dalam aliran 720p.  Dalam beberapa kasus, penundaan dapat diterima, tetapi VR akan tertinggal dari kenyataan, dan anak-anak pasti akan bubar. </p><br><p>  WebRTC sangat keren.  Dengan saluran yang baik, penundaan diukur dalam milidetik, dan kenyataan akan tetap menjadi kenyataan.  Namun ada nuansa. </p><br><p>  Pertama, secara default WebRTC berjalan pada UDP, yang akan menyebabkan kerugian dengan sedikit penurunan kualitas saluran.  Untuk streaming 4K, hal kecil apa pun pada saluran sudah menjadi kemunduran.  Ini dapat diatasi dengan beralih ke TCP transport, tetapi dalam hal ini ... </p><br><p> Kedua, WebRTC disiarkan dari browser, dan kami berdua tahu browser mana yang saat ini paling populer di planet ini (spoiler - bukan IE6).  Di browser populer ini, bitrate publikasi maksimum pada level mesin adalah 2.500 kbps. <del>  Seperti yang dipikirkan google </del>  , ini sudah cukup untuk FullHD tetapi tidak cukup untuk 4K.  Jika bitrate tidak dipercepat ke 5 - 10 Mbps, pemirsa akan melihat bintik-bintik cat air bergerak daripada realitas virtual.  Untungnya, ada pengaturan khusus untuk overclocking bitrate yang berfungsi <del>  cukup banyak </del>  semua browser di mesin Chromium.  Kemudian, mengatasi kendala ini, kita akan bertemu ... </p><br><p>  Ketiga, kita akan mengalami bandwidth saluran.  Untuk mempublikasikan dan memainkan gambar VR dengan bitrate yang disebutkan di atas, klien akan memerlukan saluran 20+ Mbit, atau lebih baik 50, dan bahkan lebih baik 100+ Mbit, baik untuk diunduh maupun diunggah.  Dalam hal ini, ini tidak boleh menjadi parameter yang dibicarakan oleh penyedia dalam buklet iklan, tetapi bandwidth aktual dari klien ke server.  Omong-omong, baca cara <a href="https://flashphoner.com/channel-quality-indicator-for-server-webrtc-over-tcp/">mengukurnya tanpa iperf dan baris perintah</a> .  Sejalan dengan itu, di sisi server, diinginkan untuk memiliki 10 Gb jika sejumlah besar aliran dibayangkan. </p><br><p>  Keempat adalah apa yang mengikuti dari persyaratan untuk saluran.  Transcoding stream 4K akan memakan terlalu banyak sumber daya prosesor di server.  Karena itu, Anda harus memilih server berukuran besar, yang mahal, atau menggunakan pengodean pada kartu video, yang juga sangat mahal, atau menghindari transcoding.  Artinya, jangan pernah mengubah resolusi, frame rate, dan bit rate stream selama penyiaran. </p><br><h2 id="lets-try-to-do-this">  Mari kita coba lakukan ini </h2><br><p>  Mari kita ambil: </p><br><ul><li>  kamera khusus; </li><li>  pemain spesial; </li><li>  server yang dapat <a href="https://flashphoner.com/browser-online-broadcasting-from-a-web-cam/">menyiarkan WebRTC dari browser</a> </li></ul><br><p>  Pasang kamera di atas meja atau tripod </p><br><p><img src="https://habrastorage.org/webt/q-/bo/tw/q-botwt5-af0pl19umr-zphiez0.jpeg"></p><br><p>  Hubungkan ke PC melalui USB 3.0 dengan daya 1A, seperti untuk drive eksternal </p><br><p><img src="https://habrastorage.org/webt/kh/4p/bp/kh4pbpwvvpvceliez14mgn0ocjc.jpeg"></p><br><p>  Perhatikan bahwa kamera sangat sensitif terhadap peralatan, dan jika laptop memiliki 2 port USB 3.0, ia mungkin menolak untuk bekerja dengan salah satunya.  Pastikan untuk tidak menggunakan kabel koneksi Cina murah;  semua pin yang disediakan oleh standar harus ada.  Bahkan dengan koneksi yang sempurna, kamera dapat menghasilkan kesalahan, seperti TV lama dalam badai.  Satu-satunya hal positif adalah bahwa tidak ada driver yang diperlukan untuk Windows 10;  ini koneksi tipe Plug-n-Play yang jujur. </p><br><p>  Kami akan menetapkan batas bitrate yang diperlukan di sisi server </p><br><pre><code class="plaintext hljs">webrtc_cc_min_bitrate=5000000 webrtc_cc_max_bitrate=10000000</code> </pre> <br><p>  Di Chrome, buka <a href="https://demo.flashphoner.com:8888/client2/examples/demo/streaming/media_devices_manager/media_device_manager.html">halaman</a> contoh, memungkinkan untuk mengatur parameter yang diperlukan untuk menangkap aliran dari kamera, dan mengatur </p><br><ul><li>  resolusi 3072x1536 </li><li>  FPS 24 (kamera hanya mendukung FPS ini saat siaran dari browser) </li><li>  Transportasi TCP </li></ul><br><p>  dan konfigurasikan pengaturan SDP agar browser tidak memotong bitrate di sisi klien </p><br><pre> <code class="javascript hljs">x-google-max-bitrate=<span class="hljs-number"><span class="hljs-number">10000</span></span>;x-google-min-bitrate=<span class="hljs-number"><span class="hljs-number">5000</span></span></code> </pre> <br><p>  atau sisi server (dalam hal ini, pengaturan akan berlaku untuk semua klien penerbitan) </p><br><pre> <code class="plaintext hljs">webrtc_sdp_min_bitrate_bps=5000000 webrtc_sdp_max_bitrate_bps=10000000</code> </pre> <br><p><img src="https://habrastorage.org/webt/ae/6z/r7/ae6zr7vxhkeeh65bp144sjklxfg.png"></p><br><p>  Mari publikasikan streaming dari kamera </p><br><p><img src="https://habrastorage.org/webt/hq/-r/hu/hq-rhunttdvkc4cff_o9uurcbec.png"></p><br><p>  Sekarang mari kita coba mainkan stream dengan pemutar WebRTC biasa </p><br><p><img src="https://habrastorage.org/webt/ot/mn/li/otmnli2-vsrodo4wcjplsdmuw50.png"></p><br><p>  Semuanya baik-baik saja ... Hampir.  Keutamaan itu tidak benar-benar virtual.  Sekarang mari kita mainkan streaming yang sama di pemutar khusus yang tertanam di halaman </p><br><p><img src="https://habrastorage.org/webt/ij/ki/m-/ijkim-0dccwdgyeccgirdcusgec.png"></p><br><p>  Nah, itu lebih baik (dan kami juga punya kucing).  Jika Anda memainkan streaming di perangkat seluler atau dalam kacamata VR, Anda dapat memutar kepala, dan kami akan menggerakkan mouse di browser pada PC.  Ada seorang anak yang bersembunyi di suatu tempat di ruangan ini.  Mari kita lihat ke kiri </p><br><p><img src="https://habrastorage.org/webt/gc/dm/df/gcdmdflghc1jm1wxnleffttk-he.png"></p><br><p>  Dan sekarang ke kanan </p><br><p><img src="https://habrastorage.org/webt/ct/iy/gl/ctiyglkgyc2wb987mj6pzpgqdji.png"></p><br><p>  Dan sekarang naik </p><br><p><img src="https://habrastorage.org/webt/nd/j8/3m/ndj83milhj9weql0x1ifufccuou.png"></p><br><p>  Dimana anak itu?  Itu dia, bersembunyi di balik tirai.  Tapi kucing melihatnya! </p><br><h2 id="we-need-more-code">  Kami membutuhkan lebih banyak kode! </h2><br><p>  Ada sedikit kode di sisi klien. </p><br><p>  Mari publikasikan aliran dari halaman browser </p><br><pre> <code class="javascript hljs">session.createStream({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: streamName, <span class="hljs-attr"><span class="hljs-attr">display</span></span>: localVideo, <span class="hljs-attr"><span class="hljs-attr">cacheLocalResources</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">transport</span></span>: <span class="hljs-string"><span class="hljs-string">"TCP"</span></span>, <span class="hljs-attr"><span class="hljs-attr">sdpHook</span></span>: rewriteSdp, <span class="hljs-attr"><span class="hljs-attr">constraints</span></span>: { <span class="hljs-attr"><span class="hljs-attr">audio</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">video</span></span>: { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">3072</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-number"><span class="hljs-number">1536</span></span>, <span class="hljs-attr"><span class="hljs-attr">frameRate</span></span>: <span class="hljs-number"><span class="hljs-number">24</span></span> } } }).publish();</code> </pre> <br><p>  Fitur menimpa browser SDP </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rewriteSdp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sdp</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sdpStringFind = <span class="hljs-string"><span class="hljs-string">"a=fmtp:(.*) (.*)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sdpStringReplace = <span class="hljs-string"><span class="hljs-string">"a=fmtp:$1 $2;x-google-max-bitrate=10000;x-google-min-bitrate=5000"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newSDP = sdp.sdpString.toString(); newSDP = newSDP.replace(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">RegExp</span></span>(sdpStringFind,<span class="hljs-string"><span class="hljs-string">"g"</span></span>), sdpStringReplace); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newSDP; }</code> </pre> <br><p>  Contoh halaman dengan pemutar VR </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>WebRTC Delight<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../../../flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../dependencies/jquery/jquery-1.12.0.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"../../dependencies/js/utils.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dl8-player.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dl8-custom-format"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'{"name": "STEREO_TERPON","base":"STEREO_MESH","params":{"uri": "03198702.json"}}'</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width: 50%;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl8-live-video</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"remoteVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"STEREO_TERPON"</span></span></span><span class="hljs-tag">&gt;</span></span> \<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl8-live-video</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"playStream"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Stream Name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"playBtn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">&gt;</span></span>Play<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stopBtn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">&gt;</span></span>Stop<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> Flashphoner.init({</span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">flashMediaProviderSwfLocation</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'../../../../media-provider.swf'</span></span></span><span class="javascript">}); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> SESSION_STATUS = Flashphoner.constants.SESSION_STATUS; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> STREAM_STATUS = Flashphoner.constants.STREAM_STATUS; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> STREAM_STATUS_INFO = Flashphoner.constants.STREAM_STATUS_INFO; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> playBtn = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'playBtn'</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> display = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'display'</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> dl8video = </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">null</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> url = setURL(); </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.addEventListener(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'x-dl8-evt-ready'</span></span></span><span class="javascript">, </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ dl8video = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'remoteVideo'</span></span></span><span class="javascript">); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#playBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">).click(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ playStream(); }); }); </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">playStream</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#playBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#stopBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> video = dl8video.contentElement; Flashphoner.createSession({</span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">urlServer</span></span></span><span class="javascript">: url}).on(SESSION_STATUS.ESTABLISHED, </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">session</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> session = Flashphoner.getSessions()[</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">]; session.createStream({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">name</span></span></span><span class="javascript">: </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'playStream'</span></span></span><span class="javascript">).value, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">display</span></span></span><span class="javascript">: display, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">remoteVideo</span></span></span><span class="javascript">: video, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">transport</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"TCP"</span></span></span><span class="javascript"> }).on(STREAM_STATUS.PLAYING, </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> (</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">stream</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ dl8video.start(); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#stopBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">).click(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#playBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'#stopBtn'</span></span></span><span class="javascript">).prop(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'disabled'</span></span></span><span class="javascript">, </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">); stream.stop(); dl8video.exit(); }); }).play(); }) } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Biasanya, saat membuat streaming untuk pemain (kueri <code>session.createStream()</code> ), kami meneruskan elemen div, ke mana elemen video akan dipasang untuk memutar streaming melalui WebRTC.  Tapi pemutar VR menggunakan elemen videonya sendiri, dan kita perlu entah bagaimana meneruskannya ke kode API yang digunakan.  Untuk melakukan ini, kami langsung meneruskan elemen video pemutar pihak ketiga ke session.createStream () dengan parameter <code>remoteVideo</code> </p><br><p>  demo.flashphoner.com digunakan sebagai sisi server;  contoh aplikasi web tersedia di tautan di bawah ini. </p><br><p>  Semoga sukses dalam usaha VR Anda!  Selamat streaming! </p><br><h2 id="links">  Tautan </h2><br><ol><li>  <a href="https://flashphoner.com/channel-quality-indicator-for-server-webrtc-over-tcp/">Indikator kualitas saluran untuk server WebRTC melalui TCP</a> - Kontrol kualitas saluran dari klien ke server </li><li>  <a href="https://flashphoner.com/browser-online-broadcasting-from-a-web-cam/">Penyiaran video dari kamera web browser atau perangkat seluler</a> - streaming WebRTC dari browser </li><li>  <a href="https://docs.flashphoner.com/display/WCS52EN/In%2Ba%2Bbrowser%2Bwith%2BDelight%2BPlayer">Dokumentasi untuk menggunakan WCS dengan pemutar VR</a> </li><li>  <a href="https://flashphoner.com/">WCS</a> - Server untuk mentransmisikan video VR 360 melalui WebRTC </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id482270/">https://habr.com/ru/post/id482270/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id482256/index.html">AI dan masa depan kerja: prospek kerja dalam waktu dekat</a></li>
<li><a href="../id482258/index.html">Bagaimana jaringan saraf bekerja dan mengapa mereka mulai menghasilkan uang besar</a></li>
<li><a href="../id482262/index.html">Cara masuk ke Talend Open Studio</a></li>
<li><a href="../id482264/index.html">Brasil, ilmu hitam, Mortal Kombat, Mars dan 15.000 orang. Hasil tahun Ontiko</a></li>
<li><a href="../id482268/index.html">Struktur masa depan: bola Dyson, mesin bintang dan "bom lubang hitam"</a></li>
<li><a href="../id482272/index.html">Memilih gudang data untuk Prometheus: Thanos vs VictoriaMetrics</a></li>
<li><a href="../id482274/index.html">5 alasan mengapa Anda harus berhenti menggunakan System.Drawing di ASP.NET</a></li>
<li><a href="../id482276/index.html">GOST R 57580. Dari tren hingga otomatisasi yang efisien</a></li>
<li><a href="../id482280/index.html">Bagaimana cosplay dilakukan. Kostum Jas Lanjutan Isaac Clarke dari Dead Space 2</a></li>
<li><a href="../id482282/index.html">Akhir dari era ARMv7 atau sedikit tentang porting game</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>