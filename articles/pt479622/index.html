<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüî¨ üóΩ üëè Como o prot√≥tipo de transa√ß√µes an√¥nimas na blockchain Waves funciona ‚è´ ‚ö±Ô∏è „ÄΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Implementamos um prot√≥tipo de transa√ß√µes an√¥nimas baseadas no zkSNARK para garantir transa√ß√µes confidenciais na blockchain Waves. Em nossa implementa√ß...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como o prot√≥tipo de transa√ß√µes an√¥nimas na blockchain Waves funciona</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/waves/blog/479622/"><p><img src="https://habrastorage.org/getpro/habr/post_images/fe6/1b5/5b2/fe61b55b2ceafb966bd362ba1d87e5f2.jpg" alt="imagem"></p><br><p>  Implementamos um <a href="https://github.com/wavesplatform/anonymous-transactions-prototype">prot√≥tipo de transa√ß√µes an√¥nimas</a> baseadas no zkSNARK para garantir transa√ß√µes confidenciais na blockchain Waves.  Em nossa implementa√ß√£o, usamos o sistema de evid√™ncias Groth16 na curva BN254 e no <a href="https://github.com/iden3/circom">DSC circom</a> . <br>  N√≥s explicamos como isso funciona. </p><a name="habracut"></a><br><h2 id="zksnarks">  zkSNARKs </h2><br><p>  <em>O zkSNARK</em> √© uma primitiva criptogr√°fica que confirma o conhecimento de um conjunto de dados especial (evid√™ncia) correspondente ao conjunto das seguintes equa√ß√µes (sistema de restri√ß√£o): </p><br><pre><code class="plaintext hljs">‚ü®ai,w‚ü©‚ü®bi,w‚ü©+‚ü®ci,w‚ü©=0</code> </pre> <br><p>  parte da evid√™ncia √© privada.  Essa constru√ß√£o nos permite provar, por exemplo, o conhecimento da imagem inversa de hash sem divulgar a imagem inversa.  Tamb√©m pode ser usado no mecanismo de transa√ß√£o privada do modelo <em>UTXO</em> ( <em>Sa√≠da n√£o</em> transacionada (TX)), onde apenas os hashes UTXO s√£o publicados, e a validade da transa√ß√£o √© comprovada no zkSNARK (prova de propriedade, prova de economia do valor). <br>  O zkSNARK √© uma tecnologia n√£o interativa de divulga√ß√£o zero, ou seja, n√£o implica um protocolo de intera√ß√£o entre participantes que √© implementado para provar o conhecimento.  Na tecnologia zkSNARK, o fornecedor constr√≥i a prova e a envia ao fornecedor - nenhuma intera√ß√£o adicional √© necess√°ria.  O examinador pode verificar a exatid√£o e a exatid√£o do uso de dados de evid√™ncias sem recorrer a informa√ß√µes adicionais.  Inicialmente, os zkSNARKs foram criados como um protocolo de ‚Äúcomputa√ß√£o confidencial‚Äù: ao calcular o resultado, os dados envolvidos nos c√°lculos n√£o s√£o divulgados. <br>  Usando a tecnologia zkSNARK, um esquema de divulga√ß√£o de confirma√ß√£o pode ser implementado: o provador calcula o hash, entrega ao provador e faz uma prova especial de que conhece a imagem inversa do hash x.  Substituindo os valores de x e hash na f√≥rmula e passando essa f√≥rmula e a prova para o examinador, o examinador pode garantir que o provador conhe√ßa x.  Essa √© a base para transa√ß√µes an√¥nimas: conhecemos a chave privada e alguma entrada espec√≠fica (UTXO n√£o gasto) com uma quantia espec√≠fica que o usu√°rio criou no contrato inteligente.  Sem divulgar esses dados, o usu√°rio pode confirmar com um contrato inteligente que essa √© a sua entrada, que pode descart√°-los e entreg√°-los a algu√©m para uso. <br>  Agora a tecnologia n√£o √© usada em todos os lugares, porque a prova √© gerada por v√°rios minutos, o que n√£o √© muito conveniente para o usu√°rio. <br>  Saiba mais sobre a programa√ß√£o do zkSNARK no artigo de Vitalik Buterin <a href="https://medium.com/%40VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649">"Programas aritm√©ticos quadr√°ticos: de zero a her√≥i"</a> e no <a href="https://medium.com/%40VitalikButerin/quadratic-arithmetic-programs-from-zero-to-hero-f6d558cea649">artigo</a> de Iden3 sobre design de circuitos circom. </p><br><h2 id="akkauntnaya-model">  Modelo de conta </h2><br><p>  Para transa√ß√µes no Waves, eles geralmente usam chaves e endere√ßos com base na <code>curve25519</code> .  Essa curva n√£o √© compat√≠vel com o zkSNARK, portanto, para transa√ß√µes an√¥nimas, usamos o subgrupo Edwards de curvas torcidas do <code>BabyJubJub</code> .  Al√©m disso, usamos chaves p√∫blicas como endere√ßos, pois ao enviar, voc√™ precisa criptografar os dados do destinat√°rio. </p><br><h2 id="utxo-model">  Modelo UTXO </h2><br><p>  Em nosso modelo, o UTXO √© representado por um conjunto de tr√™s par√¢metros: saldo, chave p√∫blica do propriet√°rio e segredo exclusivo.  O blockchain cont√©m apenas hashes sem criptografia adicional.  O propriet√°rio √© representado por uma chave p√∫blica e, como observado anteriormente, usamos chaves p√∫blicas n√£o na curva <code>curve25519</code> , mas na curva <code>BabyJubJub</code> compat√≠vel com <code>BabyJubJub</code> .  O ID do UTXO deve ser gerado aleatoriamente, porque se o usu√°rio especificar dois IDs id√™nticos, ele poder√° pegar (gastar) o UTXO apenas em um deles.  Nesse caso, apenas o UTXO com o ID correspondente para o usu√°rio atual ser√° bloqueado, mas n√£o para o restante.  √â do interesse do usu√°rio escolher a identifica√ß√£o usando um gerador de n√∫meros aleat√≥rios (253 bits s√£o alocados na identifica√ß√£o, por isso √© dif√≠cil obter uma colis√£o). <br>  Para gastar o UTXO, voc√™ deve publicar um nullifier, uma fun√ß√£o determin√≠stica do UTXO, definida como hash (segredo, owner_privkey).  Esse valor √© determin√≠stico e exclusivo para cada UTXO; somente o propriet√°rio o conhece.  Al√©m do propriet√°rio, ningu√©m pode associar o UTXO ao seu anulador correspondente. <br>  Os UTXOs s√£o armazenados dentro do mapa de hash do dApp, ou seja, no estilo do contrato.  No blockchain, os UTXOs s√£o criptografados.  Para receber seu dinheiro, o usu√°rio deve escanear o blockchain e tentar descriptografar cada UTXO. </p><br><h2>  Regi√£o dapp </h2><br><p>  O estilo do dApp cont√©m mapas de hash representando dois conjuntos: </p><br><ul><li>  utxo hashes </li><li>  anuladores </li></ul><br><p>  Assim, o dApp pode verificar a exist√™ncia de um conjunto an√¥nimo UTXO e a exclusividade de anuladores.  Isso √© suficiente para processar transfer√™ncias an√¥nimas com prote√ß√£o contra falsifica√ß√£o de novos ativos e duplica√ß√£o de gastos. <br>  O DApp possui 3 m√©todos que correspondem aos tipos b√°sicos de transa√ß√µes: </p><br><ul><li>  Depositar </li><li>  Transferir </li><li>  Conclus√£o </li></ul><br><p>  Para transferir e retirar fundos, usamos nossos pr√≥prios verificadores que garantem a intera√ß√£o do dApp com contas an√¥nimas especiais com base na curva BabyJubJub.  Os dep√≥sitos s√£o processados ‚Äã‚Äãa partir de contas regulares do Waves. </p><br><h2 id="komissii">  Comiss√µes </h2><br><p>  Para o reabastecimento da conta, √© cobrada uma taxa da conta <code>curve25519</code> .  Para transfer√™ncias e saques, a comiss√£o √© debitada da conta an√¥nima.  No n√≠vel do dApp, fica assim: <br>  O dApp paga pela transa√ß√£o em si, ou seja, o token nativo gasto no pagamento da comiss√£o √© debitado do seu saldo <br>  Entre entradas e sa√≠das, parte da comiss√£o √© queimada para anular os ativos correspondentes aos ativos reais no contrato inteligente <br>  No n√≠vel UTXO, queimamos uma certa quantia como comiss√£o ao processar uma transa√ß√£o. </p><br><h2 id="tranzakcii">  Transa√ß√µes </h2><br><p>  <strong>Um dep√≥sito</strong> √© uma opera√ß√£o simples, cada dep√≥sito adiciona um novo elemento ao UTXO. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/fc5/2f0/439/fc52f04398a60665021d26b4da4e4c8d.svg" alt="imagem"></p><br><p>  <strong>As transfer√™ncias s√£o</strong> baseadas na primitiva de convers√£o 2 para 2. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/47d/55e/9d3/47d55e9d3446e135ef5595a71c2fc8e7.svg" alt="imagem"></p><br><p>  Algumas entradas e sa√≠das podem ser zero.  Como exemplo parcial dessa constru√ß√£o, qualquer tipo de tradu√ß√£o simples pode ser representada (jun√ß√£o, divis√£o e outras transfer√™ncias, com exce√ß√£o dos swaps at√¥micos). </p><br><p>  <strong>As conclus√µes</strong> funcionam como outras transa√ß√µes, mas, em vez de criar um segundo UTXO, permitem que o usu√°rio retire seu UTXO do dApp.  Tamb√©m pode haver dois UTXOs na entrada, UTXOs na sa√≠da com o restante dos fundos e saque, que s√£o publicados na blockchain. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/8b3/f94/b3b/8b3f94b3b903188643b3139319587372.svg" alt="imagem"></p><br><p>  Ao retirar ou transferir, o dApp verifica se os anuladores correspondentes ainda n√£o foram encontrados em sua pilha. <br>  Usando zkSNARK, podemos calcular que a soma das entradas da transa√ß√£o √© igual √† soma das sa√≠das.  Ao executar uma transa√ß√£o, a gastamos no UTXO e em algum outro UTXO zero, que n√£o est√° na √°rvore de merkle.  Para gastar o UTXO, voc√™ precisa provar o conhecimento da chave privada de seu propriet√°rio.  Verifique se a chave privada, quando multiplicada pelo gerador do grupo, resulta em uma chave p√∫blica.  Assim, sem conhecer a chave privada, uma transa√ß√£o n√£o pode ser conclu√≠da. </p><br><h2 id="anonimnoe-mnozhestvo">  Conjunto an√¥nimo </h2><br><p>  Usamos um conjunto an√¥nimo de 8 elementos.  O elemento de destino √© selecionado em particular do conjunto representado na entrada p√∫blica zkSNARK.  Este m√©todo permite ofuscar o gr√°fico de transa√ß√£o (se for poss√≠vel restaurar o gr√°fico de intera√ß√£o UTXO, existe a possibilidade de desanonizar transa√ß√µes). <br>  Al√©m disso, um coletor simples de 8 elementos pode ser substitu√≠do por um coletor de √°rvores Merkle.  A abordagem oculta o gr√°fico da transa√ß√£o. <br>  Para criar uma transa√ß√£o v√°lida, provamos que gastamos um pouco de UTXO do conjunto de UTXO.  Colocamos provas do zkSNARK merkle e dados UTXO em entradas privadas e hash raiz na entrada p√∫blica.  Assim, usando SNARK, provamos que conhecemos o UTXO. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b7c/92a/4a3/b7c92a4a3e158862d0fdb32e810cc98d.svg" alt="imagem"></p><br><h2 id="zaschita-ot-dvoynogo-rashodovaniya">  Prote√ß√£o contra gastos duplos </h2><br><p>  Para proteger contra gastos duplos, usamos nullifiers - fun√ß√µes determin√≠sticas que n√£o dependem diretamente do hash UTXO.  Para calcular o nulo, tomamos a fun√ß√£o da chave privada, √© comprovado que corresponde √† chave p√∫blica, id e hash UTXO.  Para cada UTXO, existe apenas um nulo. </p><br><p>  Para cada transa√ß√£o, o anulador das sa√≠das UTXO gastas deve ser apresentado como uma entrada p√∫blica para zkSNARK.  Dentro do circuito zkSNARK, tamb√©m deve ser confirmado que ele pertence ao UTXO gasto. </p><br><p>  Se o contrato do dApp receber um valor nulo de nulificador, a transa√ß√£o ser√° rejeitada.  Assim, √© garantido que cada UTXO seja gasto uma vez. </p><br><p>  Depois que eles gastaram o UTXO, o anulador √© publicado na lista de anuladores gastos no artigo do dApp.  Ou seja, no mapa de hash, oposto a esse anulador, "true" est√° definido.  Antes de publicar o nullifier no artigo, verificamos que esse nullifier ainda n√£o foi usado, o que significa que UTXO com esse ID pode ser gasto. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt479622/">https://habr.com/ru/post/pt479622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt479598/index.html">Gato e cachorro alimentam o rob√¥</a></li>
<li><a href="../pt479600/index.html">Outro DSL para valida√ß√µes</a></li>
<li><a href="../pt479602/index.html">Qual √© o genoma completo e por que √© necess√°rio</a></li>
<li><a href="../pt479618/index.html">Lan√ßado o Postgres Pro Standard 12.1</a></li>
<li><a href="../pt479620/index.html">L√≥gica reversa</a></li>
<li><a href="../pt479624/index.html">O profissional do Postgres, Oleg Bartunov, fala a Faride Roslovets sobre o PostgreSQL e neg√≥cios na R√∫ssia</a></li>
<li><a href="../pt479626/index.html">Ressonador com um toque que os f√≠sicos n√£o conhecem</a></li>
<li><a href="../pt479630/index.html">Lute por aten√ß√£o</a></li>
<li><a href="../pt479636/index.html">Pilha de navega√ß√£o pr√≥pria. Melhor que ROS?</a></li>
<li><a href="../pt479642/index.html">Como decis√µes est√∫pidas ao projetar uma aeronave da Segunda Guerra Mundial levaram √† cria√ß√£o do Macintosh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>