<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçÅ ‚úçÔ∏è üçà A hist√≥ria da cria√ß√£o de uma nuvem dom√©stica. Parte 2. Criando um servidor - configurando o LAMP no Debian üîÆ üêí üïë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No caminho para criar nosso pr√≥prio servi√ßo de nuvem, acabamos de nos acostumar com o sistema Debian . Agora chegou a hora do pr√≥ximo passo - a cria√ß√£...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A hist√≥ria da cria√ß√£o de uma nuvem dom√©stica. Parte 2. Criando um servidor - configurando o LAMP no Debian</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409915/">  No caminho para criar nosso pr√≥prio servi√ßo de nuvem, acabamos de nos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">acostumar com o sistema Debian</a> .  Agora chegou a hora do pr√≥ximo passo - a cria√ß√£o e configura√ß√£o de um servidor da Web, com base no qual o Nextcloud pode ser iniciado. <img src="https://habrastorage.org/webt/ke/r5/x8/ker5x8nlot-vrpcr5iuvyrauhvm.png"><a name="habracut"></a><br><hr><a name="chap0"></a><br><h3>  Sum√°rio </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Parte 1. Configurando seu ambiente Debian para uso di√°rio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Parte 2. Criando um servidor - configurando o LAMP no Debian</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Parte 3. Criando uma nuvem pessoal - instalando e configurando o Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Parte 4. Atualiza√ß√£o 2018 - Debian 9 e Nextcloud 13</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Atualizando 2019 - PHP 7.2, MariaDB 10.4 e Nextcloud 17</a> <br><br><hr><br><h3>  Navega√ß√£o r√°pida por cap√≠tulo </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pref√°cio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instala√ß√£o de software</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configurando o servidor da web Apache2 e acessando-o atrav√©s dos protocolos HTTP e HTTPS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ajuste de SQL</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√£o do PHP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√µes de acesso SSH</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prote√ß√£o de acesso</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Refer√™ncia do servidor Web</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Refer√™ncia do MySQL</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Material de refer√™ncia Fail2ban</a> <br><br><hr><a name="chap1"></a><br><h3>  Pref√°cio </h3><br>  A primeira parte desta hist√≥ria mostrou uma das op√ß√µes poss√≠veis para configurar a GUI Debian para uso conveniente e familiar (ponto de vista exclusivamente subjetivo do autor) por uma pessoa que veio do Windows para Linux.  E se eu usei apenas o sistema host para configurar a m√°quina virtual com o Debian, trabalhei especificamente nessa m√°quina virtual, procurando informa√ß√µes na Internet, anotando no Notepadqq ou no gedit, ouvindo m√∫sica no Audacious, abrindo arquivos atrav√©s do LibreOffice e similares.  Dessa forma, voc√™ pode se acostumar e se sentir muito mais profundo e apreciar o trabalho com o sistema operacional e seu ambiente, que √© bastante completo e funcional no pacote Debian padr√£o. <br><br>  No momento, nosso sistema est√° configurado de tal maneira que, no futuro, voc√™ s√≥ poder√° usar a linha de comando com um editor de texto do console, por exemplo, nano ou usar o gerenciador de arquivos Double Commander com o editor Notepadqq integrado.  √â poss√≠vel combinar esses dois m√©todos, por exemplo, navegando no sistema e editando os arquivos de configura√ß√£o por meio do gerenciador de arquivos e todos os outros comandos pelo console.  Todos os m√©todos s√£o equivalentes para alcan√ßar o resultado final. <br><br>  O objetivo atual √© criar um servidor ao qual esta parte ser√° dedicada.  O servidor pode ser configurado com a instala√ß√£o e o uso da interface gr√°fica e sem ela.  No segundo caso, da parte anterior, voc√™ pode simplesmente pular as se√ß√µes relativas √† instala√ß√£o e configura√ß√£o de software para a interface gr√°fica e suas configura√ß√µes, instala√ß√£o de pacotes de software gr√°fico e vmware-tools. <br><br>  N√£o vejo nada de errado em usar a interface gr√°fica ao criar um servidor: se √© mais familiar, mais conveniente e confort√°vel para uma pessoa criar seu primeiro ou segundo servidor com um ambiente gr√°fico - por que n√£o?  No final, meu servidor Web com uma interface gr√°fica funcionou por um ano e funcionar√° quantos anos forem necess√°rios.  No entanto, voc√™ precisa ter em mente alguns pontos. <br><br>  Idealmente, uma vez configurado, o sistema ter√° que funcionar sem a nossa interven√ß√£o por muito tempo.  Meu servidor na vers√£o "finish" foi configurado em dois dias e funcionou sem interven√ß√£o por quase um ano.  Isso significa que a interface gr√°fica utilizou 0,05% da exist√™ncia ativa do servidor (o computador funciona apenas por meio dia) e, ao mesmo tempo, consumiu recursos: RAM, espa√ßo em disco, tempo do processador.  Todos esses recursos s√£o mais bem gastos em garantir o funcionamento do pr√≥prio servidor: por exemplo, aumente o memory_limit para PHP ou armazene mais dados do usu√°rio no disco r√≠gido.  Al√©m disso, em caso de problemas e mau funcionamento ao trabalhar com um servidor remoto real, geralmente √© muito mais f√°cil usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">acesso SSH</a> .  Nesse contexto, a presen√ßa de uma interface gr√°fica √© indesej√°vel e √© por isso que o segundo servidor da minha rede j√° era uma m√°quina virtual sem um ambiente gr√°fico no qual apenas o Midnight Commander foi instalado a partir do software gr√°fico, que eu usei para navegar no sistema de arquivos e editar os arquivos de configura√ß√£o atrav√©s do editor do mcedit .  Portanto, a seguir √© uma instru√ß√£o universal: dados comandos com √™nfase no uso da linha de comando, no entanto, entende-se que, pela primeira vez, o usu√°rio configura a m√°quina com um ambiente gr√°fico, devido ao uso de um navegador para verificar localmente a disponibilidade dos sites criados e alguns recursos de configura√ß√£o do programa de correio. <br><br>  No processo de cria√ß√£o do servidor e ao adicionar novos sites, acumulei algumas informa√ß√µes b√°sicas que podem ser √∫teis para um usu√°rio iniciante.  Eu o descrevi ap√≥s o material sobre instala√ß√£o e configura√ß√£o do servidor. <br><br>  <b>Nota</b> <br>  Ap√≥s uma leitura mais aprofundada nas constru√ß√µes do formul√°rio http: // 127.0.0.1 (https: // 127.0.0.1), o espa√ßo ap√≥s http: // (https: //) deve ser removido ao entrar na barra de endere√ßos do navegador.  Um espa√ßo foi inserido ao publicar este artigo para impedir que o mecanismo converta automaticamente o texto em links. <br><br><hr><a name="chap2"></a><br><h3>  Instala√ß√£o de software </h3><br>  Apache e Nginx s√£o um par de servidores Web de c√≥digo aberto nos quais cerca de 55% dos servidores em todo o mundo s√£o criados.  O Apache √© o servidor da web mais popular desde 1995 e eu o escolhi esperando por boa documenta√ß√£o, popularidade e, por assim dizer, eu queria come√ßar do come√ßo.  Isso n√£o significa que o Nginx √© pior: o Nginx √© mais eficiente no consumo de recursos e no trabalho sob carga.  No segmento russo da Internet, o servidor Nginx ocupa cerca de 65%, enquanto o Apache - cerca de 18%.  Um bom artigo comparativo de dois servidores √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">publicado no hub</a> <br><br>  Instalando o servidor Web Apache2: <br><br>  <b># apt-get install apache2 apache2-doc</b> <br><br>  E isso √© tudo.  Cerca de vinte megabytes e um servidor web j√° est√£o instalados.  N√£o s√£o necess√°rias reinicializa√ß√µes ou configura√ß√µes - o servidor j√° sabe como abrir p√°ginas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">HTML</a> .  No entanto, um site moderno na Internet n√£o √© apenas um conjunto de arquivos est√°ticos, estilos, fontes e afins, como vinte anos atr√°s.  Um site moderno cont√©m scripts escritos em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">PHP</a> e informa√ß√µes din√¢micas (por exemplo, conte√∫do de texto, coment√°rios, perfis de usu√°rio) n√£o s√£o gravadas nos arquivos pr√≥ximos aos arquivos PHP, mas em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">banco de dados SQL</a> especial.  Para um servidor completo, voc√™ deve fornecer suporte para essas tecnologias.  Al√©m disso, n√£o √© dif√≠cil: <br><br>  <b># apt-get install mysql-server mysql-client phpmyadmin</b> <br>  <b># apt-get install php5 php5-mysql libapache2-mod-php5</b> <br><br>  Durante a instala√ß√£o do MySQL, voc√™ ser√° solicitado a definir a senha do superusu√°rio do mysql e precisar√° selecionar o servidor apache2 para configurar automaticamente o trabalho com o mysql.  Ao instalar o pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">phpmyadmin</a> , concordei em configurar automaticamente o pacote e em todos os lugares digitei a senha root do mysql.  A instala√ß√£o do PHP ocorre sem solicita√ß√µes. <br><br>  Eu n√£o usei o PHP7 mais r√°pido ou o MariaDB gratuito como uma alternativa alternativa de SQL aberto e decidi construir meu servidor no LAMP "can√¥nico" = Linux + Apache + MySQL + PHP, usando solu√ß√µes antigas e comprovadas, em caso de problemas com os quais eu pudesse rapidamente e encontre facilmente informa√ß√µes na Internet. <br><br>  Tr√™s equipes (que de fato podem ser reduzidas a uma) e instalamos localmente um servidor completo e moderno.  √â muito simples! <br><br>  Mas a configura√ß√£o do servidor leva muito mais tempo do que a instala√ß√£o de seus componentes.  Inicialmente, nesta parte, eu queria mostrar meus erros t√≠picos, solu√ß√µes falsas para os problemas e os resultados que eles levaram, mas aconteceu que muitas coisas foram apagadas da minha mem√≥ria em um ano, eu tive que me recuperar muito dos registros, portanto, a seguir, apenas vou definir uma instru√ß√£o de trabalho com pequenas coment√°rios, permitindo alcan√ßar um resultado de trabalho universal. <br><br><hr><a name="chap3"></a><br><h3>  Configurar o servidor Web Apache2 </h3><br>  Primeiro, voc√™ precisa garantir que o servidor da web esteja funcionando.  Para fazer isso, abra um navegador e disque o endere√ßo http: // 127.0.0.1 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">localhost</a> ).  Uma inscri√ß√£o encorajadora deve abrir: ‚ÄúP√°gina Padr√£o do Apache2 Debian.  Isso funciona!  O servidor realmente funciona.  Se voc√™ tiver um conjunto de arquivos de site para o ano 2000, poder√° coloc√°-lo no diret√≥rio / var / www / html e provavelmente ser√° aberto em nosso servidor. <br><br><img src="https://habrastorage.org/webt/3t/q6/x-/3tq6x-2ahadvbbshmoxl2_3hfhc.png"><br><br>  Todas as configura√ß√µes b√°sicas do servidor da web s√£o armazenadas no caminho / etc / apache2.  Se voc√™ abrir esse diret√≥rio, poder√° ver o arquivo de configura√ß√£o principal apache2.conf e os diret√≥rios conf-available, mod-available, sites-available.  Esses diret√≥rios cont√™m arquivos pr√©-configurados com configura√ß√µes (os chamados snippets), que voc√™ pode simplesmente usar por padr√£o, com suas pr√≥prias edi√ß√µes, ou lev√°-los como modelo para criar suas pr√≥prias configura√ß√µes.  Por exemplo, no diret√≥rio sites dispon√≠veis, est√° o arquivo de configura√ß√£o do host padr√£o 000-default.conf.  Se voc√™ o abrir e estud√°-lo, esse arquivo define o caminho pelo qual nosso site √© aberto no endere√ßo http: // 127.0.0.1: ‚ÄúDocumentRoot / var / www / html‚Äù.  Al√©m disso, a linha "&lt;VirtualHost *: 80&gt;" significa que, se eu liberar minha m√°quina em uma rede local e acess√°-la na porta 80 (porta para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">HTTP</a> ), vou abrir um site localizado no caminho / var / www / html.  Como verificar isso? <br><br>  Primeiro, voc√™ precisa descobrir o endere√ßo IP atribu√≠do √† m√°quina virtual ap√≥s o carregamento.  Para visualizar a configura√ß√£o dos adaptadores de rede, execute: <br><br>  <b># ifconfig</b> <br><br>  Nas informa√ß√µes exibidas no console, √© f√°cil determinar se o seguinte endere√ßo est√° definido para o adaptador eth0: <br><br> <code>inet addr:192.168.233.138</code> <br> <br>  Agora, na m√°quina host, abro o endere√ßo do navegador http: // 192.168.233.138 no navegador e espero que uma p√°gina familiar seja aberta.  Mas ... ela n√£o abre.  Depois de algum tempo, meu navegador escreve: "A conex√£o expirou."  E ele escreve corretamente.  Na verdade, na primeira parte, liguei o firewall, mas a porta 80 n√£o abriu!  Vamos consertar isso: <br><br>  <b># ufw allow 80</b> <br><br>  Novamente, tente abrir o endere√ßo http: // 192.168.233.138 e verifique se a p√°gina esperada √© aberta.  O host virtual na m√°quina virtual foi aberto fora de toda essa virtualiza√ß√£o.  Demos um pequeno passo na constru√ß√£o de nossa pr√≥pria pequena Internet virtual. <br><br>  Al√©m dos diret√≥rios dispon√≠veis, tamb√©m existem diret√≥rios ativados que cont√™m o que est√° atualmente "inclu√≠do".  Se voc√™ olhar para eles, poder√° ver que esses diret√≥rios cont√™m links para arquivos localizados nos diret√≥rios dispon√≠veis.  Atualmente, existe apenas um link no diret√≥rio habilitado para sites - o arquivo /etc/apache2/sites-available/000-default.conf.  Isso √© muito conveniente - podemos controlar atalhos dentro ou fora dos hosts sem editar seus arquivos de configura√ß√£o.  Al√©m disso, a origem da configura√ß√£o √© se um arquivo de configura√ß√£o est√° inclu√≠do independentemente ou n√£o agora, e isso evita erros quando algo √© corrigido em um arquivo e esquecido em outro.  Para desativar nosso host, voc√™ precisa excluir o atalho necess√°rio e, para ativ√°-lo, cri√°-lo.  Para n√£o excluir ou criar atalhos manualmente, √© mais f√°cil e confi√°vel usar utilit√°rios especiais. <br><br>  Desative o host virtual: <br><br>  <b># a2dissite 000-default</b> <br><br>  Ligue o host virtual: <br><br>  <b># a2enssite 000-padr√£o</b> <br><br>  Ap√≥s cada altera√ß√£o, voc√™ precisa reiniciar as configura√ß√µes do host ou reiniciar o servidor: <br><br>  <b># service apache2 reload</b> <br><br>  ou <br><br>  <b># service apache2 restart</b> <br><br>  Portanto, agora est√° dispon√≠vel um entendimento b√°sico de como configurar hosts regulares no apache e mostrarei um exemplo de como configurei meu servidor para trabalhar com os protocolos HTTP e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">HTTPS</a> . <br><br>  Voc√™ precisa come√ßar com o fato de que, ao desconectar o host virtual 000 padr√£o, a desconex√£o n√£o ocorre.  Ou seja, o site √© aberto de dentro e de fora da m√°quina virtual - e ser√° aberto independentemente de sua configura√ß√£o estar na pasta habilitada para sites.  Isso foi inesperado e passei um tempo relativamente longo para entender se fiz tudo certo ou entendi.  At√© o final, eu ainda n√£o entendi isso, aparentemente isso se deve ao fato de o caminho / var / www / html estar definido globalmente como o diret√≥rio padr√£o do DocumentRoot.  Como n√£o queria que algo desnecess√°rio fosse inclu√≠do e acess√≠vel, decidi me livrar do pr√≥prio diret√≥rio html e, para todos os / var / www aninhados, negar o acesso por padr√£o. <br><br>  Para configurar o host virtual padr√£o, editei seu arquivo de configura√ß√£o: <br><br>  <b># nano /etc/apache2/sites-available/000-default.conf</b> <br><br>  O conte√∫do do arquivo de configura√ß√£o √© o seguinte: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;VirtualHost *:80&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> localhost ServerAdmin user@localhost DocumentRoot /var/www &lt;Directory /var/www&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> denied &lt;/Directory&gt; ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined &lt;/VirtualHost&gt;</code> </pre> <br>  Com essa configura√ß√£o, redefini o diret√≥rio padr√£o para / var / www, permiti que o servidor seguisse links simb√≥licos nesse diret√≥rio, permiti que o servidor executasse todas as diretivas declaradas nos arquivos .htaccess encontrados e neguei acesso a esse diret√≥rio.  A l√≥gica dessas a√ß√µes √© que eu posso controlar o acesso a esse diret√≥rio sem acessar as configura√ß√µes do servidor da Web e sem reinici√°-lo.  Agora voc√™ precisa verificar esta solu√ß√£o. <br>  Transfira o arquivo: <br><br>  <b># mv /var/www/html/index.html /var/www/index.html</b> <br><br>  E exclua o diret√≥rio: <br><br>  <b># rm / var / www / html</b> <br><br>  Reiniciamos o servidor para que as novas configura√ß√µes padr√£o do host virtual entrem em vigor: <br><br>  <b># service apache2 restart</b> <br><br>  Crie um arquivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  Na qual escrevemos uma linha (sem aspas): "Exigir tudo concedido". <br><br>  Para resumir.  Agora n√£o h√° caminho / var / www / html, mas o host √© reconfigurado por padr√£o para o caminho / var / www, onde o arquivo index.html est√° localizado e, por padr√£o, no n√≠vel do servidor da web, o acesso a esse diret√≥rio √© negado, mas o conte√∫do √© permitido localmente o arquivo .htaccess localizado l√°. <br><br>  Abra o navegador http: // 127.0.0.1 e veja a p√°gina j√° familiar ‚ÄúP√°gina Padr√£o do Apache2 Debian.  Isso funciona. "  Agora vamos verificar a operabilidade do controle de acesso "local": <br>  Exclua o arquivo .htaccess: <br><br>  <b># rm /var/www/.htaccess</b> <br><br>  E atualizamos a p√°gina aberta no navegador - a p√°gina com o aviso de restri√ß√£o de acesso (Proibido) deve abrir.  Sim, tudo isso funciona, ent√£o tudo √© feito corretamente. <br><br>  Em princ√≠pio, essas configura√ß√µes simples s√£o suficientes para a opera√ß√£o sem complica√ß√µes do servidor da web.  Mas me pareceu n√£o o suficiente.  Agora, nosso servidor da web pode funcionar apenas usando o protocolo HTTP.  Mas e o protocolo HTTPS?  Afinal, se no futuro trazer projetos baseados nesse servidor da Web para a Internet, a capacidade de trabalhar nesse protocolo √© pelo menos desej√°vel.  E decidi organizar o suporte HTTPS com base na cria√ß√£o de um certificado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">SSL</a> autoassinado. <br><br>  Primeiro, voc√™ precisa obter um certificado SSL que ser√° instalado em nosso servidor.  N√£o temos dom√≠nio e tamb√©m n√£o temos um endere√ßo IP est√°tico.  Mas tudo isso n√£o importa, porque eu mesmo gerarei o certificado, usando as ferramentas do meu sistema. <br><br>  Aten√ß√£o!  As instru√ß√µes abaixo assumem que o servidor est√° instalado em uma m√°quina sem nome.  Se houver um IP ou nome de dom√≠nio real, eles dever√£o ser especificados em TR√äS locais: &lt;Common Name IP / Domain&gt;;  &lt;Nome_do_servidor IP / dom√≠nio&gt;;  &lt;Redirecionar "/" "https: // IP / Dom√≠nio /"&gt; - nas constru√ß√µes apropriadas, substitua IP / Dom√≠nio por um endere√ßo IP ou nome de dom√≠nio.  No texto abaixo, localhost √© usado em vez de IP / Dom√≠nio. <br><br>  Gere um certificado SSL: <br><br>  <b># openssl req -x509 -nodes -days 3650 -newkey rsa: 2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt</b> <br><br>  Esse comando criar√° imediatamente um certificado autoassinado do padr√£o X.509 por 10 anos, ignorando a op√ß√£o de prote√ß√£o de certificado com uma senha - isso √© necess√°rio para que, ao iniciar o servidor Apache, possa ler o arquivo sem a interven√ß√£o do usu√°rio, pois, ao definir uma senha, voc√™ dever√° inseri-lo ap√≥s cada inicializa√ß√£o ou reinicializa√ß√£o servidor.  Juntamente com o certificado, uma nova chave RSA para 2048 bits ser√° criada, com a qual o certificado ser√° assinado.  As op√ß√µes ‚Äìkeyout e ‚Äìout indicam os caminhos pelos quais o OpenSSL deve gerar a chave e o certificado. <br><br>  No processo de cria√ß√£o do certificado, ser√£o feitas perguntas, √†s quais indiquei os seguintes dados: <br><br><blockquote>  Nome do pa√≠s = MW <br>  Nome do estado ou prov√≠ncia = Sun System <br>  Nome da localidade = Lunar <br>  Nome da Organiza√ß√£o = Hellium Inc. <br>  Nome da Unidade Organizacional = 2 <br>  Nome comum = localhost <br>  Endere√ßo de email = user @ localhost </blockquote><br>  Em seguida, crie as chaves Diffie-Hellman para fornecer suporte ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">PFS</a> : <br><br>  <b># openssl dhparam -out /etc/ssl/certs/dhparam.pem 2048</b> <br><br>  Pontos e vantagens ser√£o executados no terminal e, ap√≥s o final do desenho animado, voc√™ poder√° criar o arquivo ssl-params.conf no qual os par√¢metros SSL do servidor ser√£o definidos: <br><br>  <b># nano /etc/apache2/conf-available/ssl-params.conf</b> <br><br>  Para uma configura√ß√£o segura e atualizada, usei o c√≥digo gerado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">gerador para configurar o SSL no mozilla.github.io</a> .  No gerador, selecionei o servidor Apache2, o perfil Moderno e configurei corretamente as vers√µes do servidor e do OpenSSL, que podem ser reconhecidos pelos seguintes comandos: <br><br>  <b># apache2 -v</b> <b><br></b>  <b># vers√£o openssl</b> <br><br>  Como resultado, recebi o seguinte texto: <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment"># 14-01-2018 / for apache2 2.4.10 &amp; openssl 1.0.1t # from https://mozilla.github.io/server-side-tls/ssl-config-generator/ # parametrs help: https://raymii.org/s/tutorials/Strong_SSL_Security_On_Apache2.html # modern configuration, tweak to your needs SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1 SSLCipherSuite ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256 SSLHonorCipherOrder on SSLCompression off # OCSP Stapling, only in httpd 2.3.3 and later SSLUseStapling on SSLStaplingResponderTimeout 5 SSLStaplingReturnResponderErrors off SSLStaplingCache shmcb:/var/run/ocsp(128000)</span></span></code> </pre> <br>  Agora configure o host virtual com suporte SSL: <br><br>  <b># nano /etc/apache2/sites-available/default-ssl.conf</b> <br><br>  Eu trouxe o texto deste arquivo para o seguinte formul√°rio: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_ssl.c&gt;</span></span> <span class="hljs-section"><span class="hljs-section">&lt;VirtualHost _default_:443&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">ServerAdmin</span></span> user@localhost ServerName localhost DocumentRoot /var/www &lt;Directory /var/www&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> denied &lt;/Directory&gt; # HSTS (mod_headers is required) (15768000 seconds = 6 months) Header always set Strict-Transport-Security <span class="hljs-string"><span class="hljs-string">"max-age=15768000"</span></span> ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined SSLEngine <span class="hljs-literal"><span class="hljs-literal">on</span></span> SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key &lt;FilesMatch <span class="hljs-string"><span class="hljs-string">"\.(cgi|shtml|phtml|php)$"</span></span>&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory /usr/lib/cgi-bin&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [2-6]"</span></span> \ nokeepalive ssl-unclean-shutdown \ downgrade-1.0 force-response-1.0 BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [17-9]"</span></span> ssl-unclean-shutdown &lt;/VirtualHost&gt; &lt;/IfModule&gt;</code> </pre> <br>  Do exposto acima, tamb√©m temos / var / www definido como o diret√≥rio DocumentRoot, cujo acesso √© configurado de forma semelhante √†s configura√ß√µes anteriores.  O mecanismo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">HSTS</a> est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">ativado</a> , o que ajuda a for√ßar a conex√£o atrav√©s do protocolo HTTPS.  O suporte a SSL est√° inclu√≠do no certificado e na chave usados, bem como no processamento de dados do certificado em scripts PHP e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">CGI</a> .  A √∫ltima se√ß√£o foi projetada para fornecer compatibilidade com vers√µes anteriores do Internet Explorer e, em geral, n√£o √© necess√°ria. <br><br>  Agora vamos fazer os retoques finais. <br><br>  Vamos abrir a porta para SSL: <br><br>  <b># ufw allow 443</b> <br><br>  Ative os m√≥dulos apache para suporte a SSL e HSTS: <br><br>  <b># a2enmod ssl</b> <b><br></b>  <b># a2enmod cabe√ßalhos</b> <br><br>  Habilite a configura√ß√£o SSL: <br><br>  <b># a2enconf ssl-params</b> <br><br>  Ative o host virtual ativado para SSL: <br><br>  <b># a2ensite default-ssl</b> <br><br>  Reinicie o servidor para aceitar todas as novas configura√ß√µes: <br><br>  <b># service apache2 restart</b> <br><br>  Ent√£o chegou o momento interessante - verificar a operacionalidade da nova funcionalidade do sistema configurado. <br><br>  Crie um arquivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  Na qual prescrevemos uma linha: "Exigir tudo concedido". <br><br>  Abra no navegador https: // 127.0.0.1.  Uma p√°gina sobre um certificado desconhecido deve abrir, ap√≥s aceit√°-lo (permiss√£o √∫nica ou permanente), uma p√°gina familiar com uma notifica√ß√£o sobre um servidor Web em execu√ß√£o ser√° aberta. <br><br>  Exclua o arquivo .htaccess: <br><br>  <b># rm /var/www/.htaccess</b> <br><br>  E atualizamos a p√°gina aberta no navegador - a p√°gina com o aviso de restri√ß√£o de acesso (Proibido) deve abrir.  Tudo funciona corretamente.  Agora, nossos sites est√£o acess√≠veis via HTTP e HTTPS. <br><br>  O acesso HTTP pode ser deixado ativado, desativado ou for√ßado a redirecionar para HTTPS. <br><br>  Para acesso ativado por HTTP, nada precisa ser feito, pois o servidor processa as solicita√ß√µes das portas 80 e 443 individualmente e nosso site na pasta / var / www ser√° aberto por HTTP e HTTPS. <br><br>  Para desativar o acesso HTTP, basta desativar o host virtual correspondente e reiniciar o servidor da web: <br><br>  <b># a2dissite 000-default</b> <b><br></b>  <b># service apache2 restart</b> <br><br>  Agora, se voc√™ abrir http: // 127.0.0.1 em um navegador, uma p√°gina com uma notifica√ß√£o sobre a aus√™ncia de uma p√°gina (n√£o encontrada) dever√° ser aberta. <br><br>  A terceira op√ß√£o mais interessante.  Nesse caso, o HTTP permanece formalmente ativado, mas o processamento de dados ser√° redirecionado √† for√ßa via HTTPS. <br><br>  Para fazer isso, primeiro habilite o m√≥dulo de redirecionamento: <br><br>  <b># a2enmod reescrita</b> <br><br>  Agora abra o arquivo 000-default.conf: <br><br>  <b># nano /etc/apache2/sites-available/000-default.conf</b> <br><br>  E antes da tag de fechamento, adicione o seguinte texto: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">On</span></span> RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTPS}</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span> RewriteRule (.*) https://<span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span><span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span><span class="hljs-meta"><span class="hljs-meta"> [NC,R=301,L]</span></span></code> </pre> <br>  Reinicie o servidor: <br><br>  <b># service apache2 restart</b> <br><br>  Crie um arquivo: <br><br>  <b># nano /var/www/.htaccess</b> <br><br>  Na qual prescrevemos uma linha: "Exigir tudo concedido". <br><br>  Agora, se voc√™ abrir o endere√ßo http: // 127.0.0.1 em um navegador, seremos automaticamente redirecionados para https: // 127.0.0.1 com um aviso sobre um certificado desconhecido (se n√£o tiver sido adicionado anteriormente √† lista de exclus√£o no navegador), depois de aceit√°-lo, um j√° familiar ser√° aberto p√°gina de notifica√ß√£o do servidor da web. <br><br><hr><a name="chap4"></a><br><h3>  Ajuste de SQL </h3><br>  Para a configura√ß√£o inicial do mysql, basta executar o seguinte comando: <br><br>  <b># mysql_secure_installation</b> <br><br>  Depois de inserir a senha do superusu√°rio do mysql, respondi √†s perguntas na seguinte ordem: <br><br><ul><li>  recusou-se a alterar a senha root; </li><li>  confirmou a remo√ß√£o de usu√°rios an√¥nimos do banco de dados; </li><li>  Confirmado o bloqueio da conex√£o remota por raiz (por raz√µes de seguran√ßa, a raiz est√° conectada apenas localmente); </li><li>  confirmou a remo√ß√£o dos bancos de dados de teste; </li><li>  concordou em recarregar tabelas de privil√©gios. </li></ul><br>  Para verificar a sa√∫de do mysql, voc√™ pode executar o seguinte comando: <br><br>  <b># mysql -uroot -p</b> <br><br>  Ap√≥s digitar a senha do superusu√°rio do mysql, vemos o prompt do mysql - significa que o servi√ßo est√° em funcionamento.  Voc√™ pode sair do terminal mysql digitando o comando exit. <br><br>  Para verificar o desempenho do phpmyadmin, abra o endere√ßo http: // 127.0.0.1/phpmyadmin no navegador.  Se uma p√°gina for aberta com um convite para inserir phpmyadmin, o servi√ßo estar√° em funcionamento. <br><br><hr><a name="chap5"></a><br><h3>  Configura√ß√£o do PHP </h3><br>  Depois de instalar o PHP, abri o arquivo de configura√ß√µes: <br><br>  <b># nano /etc/php5/apache2/php.ini</b> <br><br>  E ele trouxe alguns par√¢metros para a seguinte forma: <br><br><ul><li>  memory_limit = 1024M </li><li>  default_charset = "UTF-8" </li><li>  upload_max_filesize = 256M </li><li>  sendmail_path = /usr/bin/fake_sendmail.sh </li></ul><br>  Usando o m√≥dulo PHP, voc√™ pode fornecer armazenamento em cache de dados na mem√≥ria.  O armazenamento em cache √© √∫til no caso de alta carga do servidor para dados, cuja gera√ß√£o requer uma grande quantidade de recursos, por exemplo, os resultados de consultas ao banco de dados ou o processamento de partes "pesadas" de um modelo de site.  Como servidor de cache, escolhi o m√≥dulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">memcached</a> . <br><br>  Instale o memcache: <br><br>  <sup>[ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Este texto foi</a> escrito especificamente para o site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">geektimes.ru</a> por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">AlexanderS</a> .</sup> <sup><br></sup>  <sup>O link para a fonte √© opcional, mas sua refer√™ncia √© altamente desej√°vel!</sup>  <sup>]</sup> <br><br>  <b># apt-get install memcached php5-memcached</b> <br><br>  Vamos dar uma olhada nas defini√ß√µes de configura√ß√£o do servi√ßo: <br><br>  <b># nano /etc/memcached.conf</b> <br><br>  Nas configura√ß√µes, aumentei o tamanho da mem√≥ria usada para armazenar em cache: -m 64 -&gt; -m 256. E verifiquei a disponibilidade do modo de opera√ß√£o apenas na zona local: -l 127.0.0.1. <br><br>  Reiniciamos o servi√ßo de armazenamento em cache e o servidor da web: <br><br>  <b># service memcached restart</b> <b><br></b>  <b># service apache2 restart</b> <br><br>  Agora voc√™ precisa garantir que o servi√ßo esteja funcionando.  Para fazer isso, crie um arquivo: <br><br>  <b># nano /var/www/info.php</b> <br><br>  E adicione o seguinte texto a ele: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> phpinfo (); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  N√£o se esque√ßa de verificar a exist√™ncia do arquivo .htaccess no diret√≥rio / var / www com o conte√∫do permissivo correspondente, se n√£o estiver l√°, crie-o. <br><br>  Agora voc√™ pode abrir em seu navegador http: // 127.0.0.1/info.php - uma p√°gina com informa√ß√µes sobre PHP deve abrir, na qual voc√™ precisa verificar a se√ß√£o memcached nela.  Se a tabela aparecer - o PHP est√° funcionando. <br><br>  Voc√™ pode verificar o servi√ßo memcached em execu√ß√£o assim: <br><br>  <b>$ ps -aux |</b>  <b>grep memcached</b> <br><br>  O terminal deve retornar uma string contendo configura√ß√µes armazenadas em cache. <br><br>  <b>Criando um Stub de Correio para PHP</b> <br><br>  Nas configura√ß√µes do PHP, um script de shell foi especificado como o par√¢metro sendmail_path.  A fun√ß√£o desse script √© salvar as cartas enviadas atrav√©s da fun√ß√£o php mail () padr√£o na m√°quina local, em alguma pasta conveniente, e n√£o envi√°-las para algum lugar. <br><br>  Crie um arquivo: <br><br>  <b># nano /usr/bin/fake_semdmail.sh</b> <br><br>  Com o seguinte conte√∫do: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh prefix="/var/mail/sendmail/new" numPath="/var/mail/sendmail" if [ ! -f $numPath/num ]; then echo "0" &gt; $numPath/num fi num=`cat $numPath/num` num=$(($num + 1)) echo $num &gt; $numPath/num name="$prefix/letter_$num.txt" while read line do echo $line &gt;&gt; $name done chmod 777 $name /bin/true</span></span></code> </pre> <br>  Torne este arquivo execut√°vel: <br><br>  <b># chmod + x /usr/bin/fake_semdmail.sh</b> <br><br>  Crie os diret√≥rios necess√°rios, se voc√™ configurar a cole√ß√£o de cartas pelo programa de email: <br><br>  <b># mkdir / var / mail / sendmail / var / mail / sendmail / cur / var / mail / sendmail / novo / var / mail / sendmail / tmp</b> <br><br>  E atribu√≠mos direitos para que o servidor possa gravar arquivos nesta pasta: <br><br>  <b># chmod 777 -R / var / mail / sendmail</b> <br><br>  Agora todos os emails enviados ser√£o adicionados a / var / mail / sendmail.  Eles podem ser visualizados com um editor de texto ou podem ser coletados por programa de correio.  O software pr√©-instalado Debian vem com um cliente de email Evolution.  Ao configurar a conta, selecione ‚ÄúDiret√≥rios de correio no formato Maildir‚Äù como o tipo de servidor e especifique o caminho para o diret√≥rio de correio (/ var / mail / sendmail) e selecione ‚ÄúSendmail‚Äù como servidor. <br><br>  S√≥ isso.  Em geral, terminamos o servidor - √© obtida uma m√°quina virtual universal, com base na qual voc√™ pode criar seus servi√ßos de rede.  Deixei os acessos HTTP e HTTPS.  No entanto, depois de ganhar experi√™ncia na cria√ß√£o e configura√ß√£o de um servidor, al√©m de adicionar sites (veja abaixo), eu recomendaria a cria√ß√£o de uma nova m√°quina virtual com um servidor sem uma interface gr√°fica como o consumo ideal de recursos. <br><br><hr><a name="chap6"></a><br><h3>  Configura√ß√µes de acesso SSH </h3><br>  Um servidor n√£o seria um servidor completo sem acesso atrav√©s do SSH.  O chamado "shell" permite que voc√™ se conecte de forma r√°pida e segura a um servidor remoto, usando, por exemplo, um pequeno programa de massa - no computador local, obtemos acesso direto ao terminal do servidor remoto. <br><br>  Instala√ß√£o de servi√ßo: <br><br>  <b># apt-get install ssh</b> <br><br>  Vamos abrir a porta para SSH (na verdade, a porta padr√£o deve estar no n√∫mero 22, mas abaixo eu redefini a porta na configura√ß√£o SSH): <br><br>  <b># ufw allow 106</b> <br><br>  Para organizar o acesso de nosso usu√°rio, abra o arquivo: <br><br>  <b># nano / etc / ssh / sshd_config</b> <br><br>  E adicione a diretiva no final do arquivo: <br><br><blockquote>  Usu√°rio AllowUsers </blockquote><br>  Al√©m disso, por motivos de seguran√ßa, fiz as seguintes altera√ß√µes neste arquivo: <br><br><ul><li>  porta alterada de 22 para outra ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">lista de portas</a> ): Porta 22 -&gt; Porta 106 </li><li>  desativou o protocolo herdado: Protocolo 2.1 -&gt; Protocolo 2 </li><li>  acesso remoto desabilitado para raiz: PermitRootLogin yes (ou PermitRootLogin sem senha) -&gt; PermitRootLogin no </li></ul><br>  Em seguida, reinicie o servi√ßo: <br><br>  <b># service sshd restart</b> <br><br>  Agora posso executar o programa putty na m√°quina host e conectar-me ao meu servidor no modo console digitando o endere√ßo de conex√£o 192.168.233.138, porta 106 e nome de usu√°rio user.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao conectar, voc√™ deve responder afirmativamente para aceitar as chaves e inserir a senha do usu√°rio. </font><font style="vertical-align: inherit;">Se voc√™ precisar executar comandos do superusu√°rio, poder√° usar o comando su j√° conhecido.</font></font><br><br><hr><a name="chap7"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prote√ß√£o de acesso </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o comecei a proteger o servidor da Web do DDoS, acreditando inicialmente que, se ele estiver hospedado no VPS / VDS, a hospedagem fornecer√° uma prote√ß√£o eficaz e, se voc√™ fizer o seu servidor "se destacar" na Internet, esse problema dever√° ser tratado com seriedade e este √© um t√≥pico artigo separado. A prote√ß√£o lenta contra DDoS HTTP √© relativamente simples, de acordo com in√∫meras instru√ß√µes na Internet, mas n√£o o salva de um ataque distribu√≠do de muitos endere√ßos IP diferentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Com o DDoS, nosso servidor simplesmente para de funcionar por um tempo. Mas ap√≥s um ataque que n√£o durar√° para sempre, o servidor se recuperar√°. Mas se algu√©m conseguir obter acesso via SSH, o controle sobre o servidor ser√° perdido e os dados ser√£o comprometidos; portanto, o controle de acesso ao servidor via SSH √© uma boa id√©ia.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A coisa mais simples e comum que pode ser feita √© alterar a porta padr√£o, o que fizemos ao configurar o SSH. Cerca de cinco anos atr√°s, eu "enviei" o servidor rec√©m-criado para a Internet em um endere√ßo IP real recebido recentemente e fiquei surpreso que, durante a semana de exist√™ncia do servidor, sobre a qual ningu√©m sabia nada ainda, um grande n√∫mero de logs foi acumulado nos logs do sistema sobre tentativas malsucedidas de autoriza√ß√£o via SSH e FTP. Obviamente, na Internet moderna, h√° um n√∫mero consider√°vel de servi√ßos rob√≥ticos que procuram computadores com portas abertas e tentam se conectar a eles, classificando senhas com base no banco de dados existente ou usando o m√©todo exaustivo de pesquisa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Felizmente para n√≥s, existe o fail2ban: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># apt-get install fail2ban</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imediatamente ap√≥s a instala√ß√£o, o utilit√°rio j√° est√° configurado para proteger a maioria das portas e se mais de seis tentativas falhas de conex√£o aparecerem nos logs do sistema em dez minutos, o invasor ser√° bloqueado por dez minutos. O mecanismo de opera√ß√£o do fail2ban √© bastante simples - as chamadas pris√µes que acionam uma a√ß√£o projetada para proteger o aplicativo s√£o acionadas por certos acionadores. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os par√¢metros de bloqueio podem ser definidos individualmente: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/fail2ban/jail.local</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No arquivo criado, √© necess√°rio prescrever as configura√ß√µes que substituir√£o as existentes por padr√£o. Um exemplo do conte√∫do do meu arquivo:</font></font><br><br> <code>#   <br> [DEFAULT] <br> ignoreip = 127.0.0.1 <br> bantime = 2592000 <br> findtime = 43200 <br> maxretry = 6 <br> banaction = iptables-multiport <br> #      <br> destemail = user@localhost <br> sendername = Fail2Ban <br> mta = sendmail <br> action = %(action_mwl)s <br> <br> #  SSH <br> [ssh] <br> enabled = true <br> port = 106 <br> filter = sshd <br> logpath = /var/log/auth.log <br> <br> #      <br> [apache] <br> enabled = true <br> port = http,https <br> filter = apache-auth <br> logpath = /var/log/apache*/*error.log <br> <br> #        php  <br> [apache-noscript] <br> enabled = true <br> port = http,https <br> filter = apache-noscript <br> logpath = /var/log/apache*/*error.log <br> <br> #     <br> [apache-overflows] <br> enabled = true <br> port = http,https <br> filter = apache-overflows <br> logpath = /var/log/apache*/*error.log <br> maxretry = 2 <br> <br> #          <br> [apache-nohome] <br> enabled = true <br> port = http,https <br> filter = apache-nohome <br> logpath = /var/log/apache*/*error.log <br> maxretry = 2</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A configura√ß√£o acima permite que voc√™ n√£o controle o acesso local e, com seis tentativas incorretas de login em 12 horas, o endere√ßo IP do invasor usando o iptables ser√° banido por 30 dias. </font><font style="vertical-align: inherit;">Ele controla n√£o apenas o acesso √† porta para SSH, mas tamb√©m a√ß√µes suspeitas destinadas a desestabilizar a opera√ß√£o do servidor da web.</font></font><br><br><hr><a name="chap8"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Refer√™ncia do servidor Web </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Iniciando, parando e reiniciando o servidor: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 start </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 stop </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Recarregando as configura√ß√µes do servidor: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 reload</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ativando e desativando o host de teste: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2ensite test </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2dissite test</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ativando e desativando a configura√ß√£o de teste: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2enconf test </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2disconf test</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificando a sintaxe dos arquivos (retorne: ‚ÄúSyntax OK‚Äù): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># apache2ctl configtest </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√£o para adicionar um site com acesso HTTP ou HTTPS usando um host virtual existente</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digamos que precisamos adicionar um novo site ao nosso servidor, localizado no diret√≥rio site.com, localizado em / home / user / www. Isso pode ser conveniente, pois o usu√°rio n√£o precisar√° sair dos limites do diret√≥rio inicial ao trabalhar com o site. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definimos as permiss√µes para o diret√≥rio do usu√°rio (apenas no caso): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># chmod 755 / home / user</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Crie um diret√≥rio para o site: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ mkdir / home / user / www /home/user/www/site.com Colocamos um</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> link simb√≥lico para o diret√≥rio do site: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># ln -s /home/user/www/site.com /var/www/site.com</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para adicionar acesso via HTTP, abra o arquivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/000-default.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ou para adicionar acesso via HTTPS abra o arquivo:</font></font><br><br>  <b># nano /etc/apache2/sites-available/default-ssl.conf</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E adicione o seguinte conte√∫do ao arquivo aberto antes da tag de fechamento / VirtualHost:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;Directory /var/www/site.com&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reiniciamos o servidor da Web: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificamos a disponibilidade do site em http: // 127.0.0.1/site.com ou https: // 127.0.0.1/site.com (m√©todo de verifica√ß√£o - veja abaixo). Deve-se observar que o site ser√° aberto independentemente da disponibilidade do arquivo .htaccess, uma vez que a diretiva: "Exigir tudo concedido" est√° definida para o diret√≥rio com o site. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op√ß√£o para adicionar um site com acesso HTTP ou HTTPS usando um novo host virtual e configurar o acesso atrav√©s do nome de dom√≠nio, n√£o</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IP.As condi√ß√µes da tarefa s√£o as mesmas que as anteriores: digamos que precisamos adicionar um novo site ao servidor localizado no diret√≥rio do site .com localizado em / home / user / www. Mas agora ainda quero acessar o site digitando apenas seu nome de dom√≠nio na linha do navegador.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Definimos as permiss√µes para o diret√≥rio do usu√°rio (apenas no caso): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># chmod 755 / home / user</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Crie um diret√≥rio para o site: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ mkdir /home/user/www/site.com Colocamos um</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> link simb√≥lico para o diret√≥rio do site: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># ln -s / home / user /www/site.com /var/www/site.com</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para adicionar acesso via HTTP, crie um arquivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/site.com.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E adicione o seguinte conte√∫do:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;VirtualHost *:80&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> site.com ServerAlias www.site.com ServerAdmin user@localhost DocumentRoot /var/www/site.com &lt;Directory /var/www/site.com&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt; # Redirect HTTP-&gt;HTTPS #RewriteEngine <span class="hljs-literal"><span class="hljs-literal">On</span></span> #RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTPS}</span></span> <span class="hljs-literal"><span class="hljs-literal">off</span></span> #RewriteRule (.*) https://<span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span><span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span><span class="hljs-meta"><span class="hljs-meta"> [NC,R=301,L] ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined &lt;/VirtualHost&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou, para adicionar acesso via HTTPS, crie um arquivo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/apache2/sites-available/site.com-ssl.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E adicione o seguinte conte√∫do:</font></font><br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_ssl.c&gt;</span></span> <span class="hljs-section"><span class="hljs-section">&lt;VirtualHost _default_:443&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">ServerName</span></span></span></span> site.com ServerAlias www.site.com ServerAdmin user@localhost DocumentRoot /var/www/site.com &lt;Directory /var/www/site.com&gt; Options FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt; # HSTS (mod_headers is required) (15768000 seconds = 6 months) Header always set Strict-Transport-Security <span class="hljs-string"><span class="hljs-string">"max-age=15768000"</span></span> ErrorLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/error.log CustomLog <span class="hljs-variable"><span class="hljs-variable">${APACHE_LOG_DIR}</span></span>/access.log combined SSLEngine <span class="hljs-literal"><span class="hljs-literal">on</span></span> SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key &lt;FilesMatch <span class="hljs-string"><span class="hljs-string">"\.(cgi|shtml|phtml|php)$"</span></span>&gt; SSLOptions +StdEnvVars &lt;/FilesMatch&gt; &lt;Directory /usr/lib/cgi-bin&gt; SSLOptions +StdEnvVars &lt;/Directory&gt; BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [2-6]"</span></span> \ nokeepalive ssl-unclean-shutdown \ downgrade-1.0 force-response-1.0 BrowserMatch <span class="hljs-string"><span class="hljs-string">"MSIE [17-9]"</span></span> ssl-unclean-shutdown &lt;/VirtualHost&gt; &lt;/IfModule&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicione a linha ‚Äú127.0.0.1 site.com‚Äù a </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / hosts</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;"># echo &gt;&gt; / etc / hosts 127.0.0.1 site.com</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ative o host HTTP: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># a2ensite site.com.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ou ative o host HTTPS: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># site a2ensite. com-ssl.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reiniciamos o servidor da Web: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service apache2 restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificamos a disponibilidade do site em http: // site.com ou https: // site.com (m√©todo de verifica√ß√£o - veja abaixo). Note-se que o site ser√° aberto independentemente da disponibilidade do arquivo .htaccess, pois a diretiva: "Exigir tudo concedido" est√° definida para o diret√≥rio com o site. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas as a√ß√µes s√£o executadas dentro da m√°quina virtual convidada. Seria interessante "abrir" o site no navegador do sistema host.</font></font> N√£o √© dif√≠cil.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conhecemos o nome de dom√≠nio e o endere√ßo IP da m√°quina convidada. </font><font style="vertical-align: inherit;">Se o sistema host for Windows, ser√° necess√°rio abrir o arquivo c: \ Windows \ System32 \ drivers \ etc \ hosts e adicionar a seguinte linha no final:</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 192.168.233.138 site.com </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ap√≥s essa altera√ß√£o, o computador ou o sistema host precisar√° reiniciar. Agora, quando voc√™ abrir o site.com em seu navegador, o acesso a ele ser√° redirecionado para nossa m√°quina virtual. De fato, fizemos o roteamento mais simples em nossa Internet pessoal no n√≠vel do sistema operacional do host. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caso voc√™ precise acessar o host virtual somente via HTTPS, mas n√£o desejar perder conex√µes via HTTP, voc√™ pode configurar o redirecionamento: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- crie o arquivo /etc/apache2/sites-available/site.com.conf de acordo com as instru√ß√µes acima, se n√£o estiver criado </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- no arquivo /etc/apache2/sites-available/site.com.conf, remova o coment√°rio das tr√™s linhas de RewriteEngine / RewriteCond / RewriteRule </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ative o host site.com.conf se n√£o estiver ativado</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- reinicie o servidor: # service apache2 restart </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verificando a integridade do site adicionado</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A maneira mais f√°cil de verificar a disponibilidade do site √© colocar o arquivo index.html com algum conte√∫do em seu diret√≥rio raiz. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crie um arquivo index.html: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ nano /home/user/www/site.com/index.html</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e adicione o seguinte conte√∫do:</font></font><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>TEST OK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>TEST OK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dependendo do m√©todo de adi√ß√£o do site, abra no navegador o endere√ßo http: // 127.0.0.1/site.com (https: // 127.0.0.1/site.com) ou http: // site.com (https: // site.com ) - uma p√°gina contendo o texto "TEST OK" deve ser aberta. </font></font><br><br><hr><a name="chap9"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Refer√™ncia do MySQL </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Criando usu√°rio user123 com senha pass123 e banco de dados db123 atrav√©s do console. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digite mysql digitando a senha do superusu√°rio mysql quando solicitado: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysql -u root -p</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E crie um banco de dados (voc√™ n√£o precisa digitar o prefixo ‚Äúmysql&gt;‚Äù, o ponto e v√≠rgula √© obrigat√≥rio no final): </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; CREATE DATABASE `db123`;</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Crie o usu√°rio user123 com a senha pass123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; CREATE USER 'user123' @ 'localhost' IDENTIFICADO POR 'pass123';</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conceda privil√©gios ao usu√°rio no banco de dados: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; GRANT ALL PRIVILEGES ON `db123`. * TO 'user123' @ 'localhost';</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Atualizar tabela de privil√©gios: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; FLUSH PRIVILEGES;</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saia do mysql: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; exit</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para verificar, abra o endere√ßo http: // 127.0.0.1/phpmyadmin e efetue login com os detalhes de acesso do usu√°rio123 / pass123. </font><font style="vertical-align: inherit;">O acesso ao banco de dados db123 deve ser aberto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alterando a senha do mysql raiz com pass123 para pass456: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysqladmin -uroot -ppass123 senha pass456</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alterando a senha do usu√°rio123 de pass123 para pass456: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># mysqladmin -uuser123 -ppass123 senha pass456</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Removendo user123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; DROP USER 'user123' @ 'localhost' ; </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Excluindo a tabela db123: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; DROP DATABASE `db123`;</font></font></b> <br><br><hr><a name="chap10"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Material de refer√™ncia Fail2ban </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reiniciando o servi√ßo: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># service fail2ban restart</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verificando as regras de execu√ß√£o: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client status</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Estat√≠sticas detalhadas sobre a regra sshd: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client status ssh</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Desconectando: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client defina ssh unbanip Banned_IP</font></font></b> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Retorne </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ao in√≠cio, ao √≠ndice</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><hr><br>  A hist√≥ria da cria√ß√£o de uma nuvem dom√©stica.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parte 2. Criando um servidor - configurando o LAMP no Debian. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vers√£o texto: 1.0.1. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data da primeira publica√ß√£o: 30/01/2018. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√öltima edi√ß√£o: 15/01/2020.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizar log</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.1 [15-01-2020] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualizando o √≠ndice. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.0 [30-01-2018] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira vers√£o. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descreve como instalar e configurar o LAMP no Debian 8.7.x.</font></font><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt409915/">https://habr.com/ru/post/pt409915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt409901/index.html">Voc√™ ainda pode entrar no mesmo rio duas vezes</a></li>
<li><a href="../pt409903/index.html">Por que as equa√ß√µes mais complexas da f√≠sica s√£o t√£o dif√≠ceis?</a></li>
<li><a href="../pt409905/index.html">Como usar um smartphone para melhorar a sa√∫de</a></li>
<li><a href="../pt409907/index.html">Roleta russa Ecola</a></li>
<li><a href="../pt409911/index.html">Novas revis√µes dos m√≥dulos baseados no ESP8266 n√£o podem gravar no SPI Flash</a></li>
<li><a href="../pt409917/index.html">Resultados de um estudo de quatro anos sobre recifes de coral: pl√°stico mata corais</a></li>
<li><a href="../pt409919/index.html">Pergunte a Ethan: Qu√£o perto estamos da Teoria de Tudo?</a></li>
<li><a href="../pt409921/index.html">Relat√≥rio de confiabilidade do disco r√≠gido em chamas: estat√≠sticas de 2013 a 2017</a></li>
<li><a href="../pt409923/index.html">Os matem√°ticos encontraram um problema nas famosas equa√ß√µes para a descri√ß√£o de l√≠quidos</a></li>
<li><a href="../pt409925/index.html">Trapa√ßa ao vivo no acidente de Ariane 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>