<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕺 👩🏿‍🔧 👩🏾‍🚒 @Pythonetc Septiembre 2018 🌾 🕥 🛕</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta es la cuarta colección de consejos y programación de Python de mi feed @pythonetc . 


 Selecciones anteriores: 


- Agosto 2018 
- Julio 2018 
-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>@Pythonetc Septiembre 2018</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/425125/"><p><img src="https://habrastorage.org/webt/79/ur/ug/79urugmgbgzjhlpozccip51e5_s.png"></p><br><p>  Esta es la cuarta colección de consejos y programación de Python de mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">feed @pythonetc</a> . </p><br><p>  Selecciones anteriores: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Agosto 2018</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Julio 2018</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Junio ​​2018</a> </li></ul><a name="habracut"></a><br><h2 id="pereopredelenie-i-peregruzka">  Anulación y sobrecarga </h2><br><p>  Hay dos conceptos que son fáciles de confundir: anulación y sobrecarga. </p><br><p> La anulación ocurre cuando una clase secundaria define un método ya proporcionado por las clases principales y, por lo tanto, lo reemplaza.  En algunos idiomas, es necesario marcar explícitamente el método de anulación (en C # se usa el modificador de <code>override</code> ), y en algunos idiomas esto se hace como se desee (anotación de <code>@Override</code> en Java).  Python no requiere el uso de un modificador especial y no proporciona el marcado estándar de dichos métodos (en aras de la legibilidad, alguien usa el decorador personalizado <code>@override</code> , que no hace nada). </p><br><p>  La sobrecarga es otra historia.  Este término se refiere a una situación en la que hay varias funciones con el mismo nombre, pero con firmas diferentes.  La sobrecarga es posible en Java y C ++; a menudo se usa para proporcionar argumentos predeterminados: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">System</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">out</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">println</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Hello</span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">; } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"world"</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">; } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(String name)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-class">, " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; } }</span></span></code> </pre> <br><p>  Python no admite la búsqueda de funciones por firma, solo por nombre.  Por supuesto, puede escribir código que analice explícitamente los tipos y la cantidad de argumentos, pero esto se verá incómodo, y esta práctica es mejor evitarla: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(args) == <span class="hljs-number"><span class="hljs-number">4</span></span>: quadrilateral = Quadrilateral(*args) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> len(args) == <span class="hljs-number"><span class="hljs-number">1</span></span>: quadrilateral = args[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> TypeError() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quadrilateral.area()</code> </pre> <br><p>  Si necesita sugerencias de <code>typing</code> , use el módulo de <code>typing</code> con el decorador <code>@overload</code> : </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> typing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> overload @overload <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( q: Quadrilateral )</span></span></span><span class="hljs-function"> -&gt; float:</span></span> ... @overload <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( p1: Point, p2: Point, p3: Point, p4: Point )</span></span></span><span class="hljs-function"> -&gt; float:</span></span> ...</code> </pre> <br><h2 id="avtovivifikaciya">  Vivificación automática </h2><br><p>  <code>collections.defaultdict</code> permite crear un diccionario que devuelve un valor predeterminado si falta la clave solicitada (en lugar de arrojar un <code>KeyError</code> ).  Para crear un <code>defaultdict</code> predeterminado <code>defaultdict</code> debe proporcionar no solo un valor predeterminado, sino una fábrica de dichos valores. </p><br><p>  Por lo tanto, puede crear un diccionario con un número prácticamente infinito de diccionarios anidados, lo que le permite utilizar construcciones como <code>d[a][b][c]...[z]</code> . </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">infinite_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defaultdict(infinite_dict) ... &gt;&gt;&gt; d = infinite_dict() &gt;&gt;&gt; d[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">10</span></span> &gt;&gt;&gt; dict(d[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">5</span></span>]) {}</code> </pre> <br><p>  Este comportamiento se llama "auto-vivificación", un término que proviene de Perl. </p><br><h2 id="instancirovanie">  Instanciación </h2><br><p>  La instanciación de objetos implica dos pasos importantes.  Primero, el método <code>__new__</code> se llama desde la clase, que crea y devuelve un nuevo objeto.  Luego, Python llama al método <code>__init__</code> , que establece el estado inicial de este objeto. </p><br><p>  Sin embargo, <code>__init__</code> no se llamará si <code>__new__</code> devuelve un objeto que no es una instancia de la clase original.  En este caso, el objeto podría ser creado por otra clase, lo que significa que <code>__init__</code> ya ha sido invocado en el objeto: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dict(x=x) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) <span class="hljs-comment"><span class="hljs-comment"># Never called print(Foo(0))</span></span></code> </pre> <br><p>  También significa que no debe crear una instancia de la misma clase en <code>__new__</code> usando el constructor regular ( <code>Foo(...)</code> ).  Esto puede conducir a la ejecución repetida de <code>__init__</code> , o incluso a una recursión infinita. </p><br><p>  Recursión infinita: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Foo(-x) <span class="hljs-comment"><span class="hljs-comment"># Recursion</span></span></code> </pre> <br><p>  Doble ejecución <code>__init__</code> : </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Foo(-x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__(cls) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) self._x = x</code> </pre> <br><p>  La forma correcta: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cls.__new__(cls, -x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__(cls) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) self._x = x</code> </pre> <br><h2 id="operator--i-srezy">  El operador [] y los cortes </h2><br><p>  En Python, puede anular el operador <code>[]</code> definiendo el método mágico <code>__getitem__</code> .  Entonces, por ejemplo, puede crear un objeto que virtualmente contenga un número infinito de elementos repetidos: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cycle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, lst)</span></span></span><span class="hljs-function">:</span></span> self._lst = lst <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, index)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._lst[ index % len(self._lst) ] print(Cycle([<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>])[<span class="hljs-number"><span class="hljs-number">100</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># 'b'</span></span></code> </pre> <br><p>  Lo inusual aquí es que el operador <code>[]</code> admite una sintaxis única.  Al usarlo puede obtener no solo <code>[2]</code> , sino también <code>[2:10]</code> , <code>[2:10:2]</code> , <code>[2::2]</code> e incluso <code>[:]</code> .  La semántica del operador es: [inicio: detener: paso], sin embargo, puede usarlo de cualquier otra manera para crear objetos personalizados. </p><br><p>  Pero si llama a <code>__getitem__</code> con esta sintaxis, ¿qué obtendrá como parámetro de índice?  Esto es exactamente por qué existen los objetos de corte. </p><br><pre> <code class="python hljs">In : <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Inspector</span></span></span><span class="hljs-class">:</span></span> ...: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, index)</span></span></span><span class="hljs-function">:</span></span> ...: print(index) ...: In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">1</span></span> In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>] slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>] slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) In : Inspector()[:] slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)</code> </pre> <br><p>  Incluso puede combinar la sintaxis de tuplas y sectores: </p><br><pre> <code class="python hljs">In : Inspector()[:, <span class="hljs-number"><span class="hljs-number">0</span></span>, :] (slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>))</code> </pre> <br><p>  <code>slice</code> no hace nada, solo almacena los atributos <code>start</code> , <code>stop</code> y <code>step</code> . </p><br><pre> <code class="python hljs">In : s = slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) In : s.start Out: <span class="hljs-number"><span class="hljs-number">1</span></span> In : s.stop Out: <span class="hljs-number"><span class="hljs-number">2</span></span> In : s.step Out: <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><h2 id="preryvanie-korutiny-asyncio">  Interrupción de la rutina de Asyncio </h2><br><p>  Cualquier asyncio <code>asyncio</code> ejecutable puede ser abortado usando el método <code>cancel()</code> .  En este caso, se enviará un CanceledError a la corutina, como resultado, esta y todas las corutinas asociadas con ella se interrumpirán hasta que el error sea detectado y eliminado. </p><br><p>  <code>CancelledError</code> es una subclase de <code>Exception</code> , lo que significa que puede detectarse accidentalmente mediante una combinación de <code>try ... except Exception</code> , diseñada para detectar "cualquier error".  Para atrapar con seguridad un error de una rutina, debe hacer esto: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> action() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> asyncio.CancelledError: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception: logging.exception(<span class="hljs-string"><span class="hljs-string">'action failed'</span></span>)</code> </pre> <br><h2 id="planirovanie-ispolneniya">  Planificación de la ejecución </h2><br><p>  Para planificar la ejecución de algún código en un momento determinado, <code>asyncio</code> generalmente crea una tarea que se ejecuta <code>await asyncio.sleep(x)</code> : </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> print(n) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) loop.create_task(do(n + <span class="hljs-number"><span class="hljs-number">1</span></span>)) loop.create_task(do(n + <span class="hljs-number"><span class="hljs-number">1</span></span>)) loop = asyncio.get_event_loop() loop.create_task(do()) loop.run_forever()</code> </pre> <br><p>  Pero crear una nueva tarea puede ser costoso, y no es necesario hacerlo si no planea realizar operaciones asincrónicas (como la función <code>do</code> en mi ejemplo).  En su lugar, puede usar las funciones <code>loop.call_later</code> y <code>loop.call_at</code> , que le permiten programar una llamada de devolución de llamada asíncrona: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyncio <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> print(n) loop = asyncio.get_event_loop() loop.call_later(<span class="hljs-number"><span class="hljs-number">1</span></span>, do, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) loop.call_later(<span class="hljs-number"><span class="hljs-number">1</span></span>, do, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) loop = asyncio.get_event_loop() do() loop.run_forever()</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425125/">https://habr.com/ru/post/es425125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425111/index.html">Trucos publicitarios que pueden costarle dinero y reputación</a></li>
<li><a href="../es425113/index.html">"Tipografía digital" o mi experiencia en digitalización móvil de libros</a></li>
<li><a href="../es425115/index.html">DevOps en toda regla: tragedia griega en tres actos</a></li>
<li><a href="../es425117/index.html">Dos bits por transistor: ROM de alta densidad en un chip Intel 8087 de punto flotante</a></li>
<li><a href="../es425123/index.html">El misterioso corazón de la caja de ritmos Roland TR-808</a></li>
<li><a href="../es425129/index.html">¿Cómo automatizar la creación de máquinas virtuales? Contamos en detalle</a></li>
<li><a href="../es425131/index.html">Qué leer sobre la tecnología blockchain: guías, libros y artículos.</a></li>
<li><a href="../es425133/index.html">Problemas de pago transfronterizos: por qué y cómo se usa blockchain aquí</a></li>
<li><a href="../es425135/index.html">Por qué VoIP es reconocido como un servicio de información en los EE. UU. Y qué significa para la industria de telecomunicaciones y los usuarios</a></li>
<li><a href="../es425137/index.html">Trabajamos en la consola de forma rápida y eficiente.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>