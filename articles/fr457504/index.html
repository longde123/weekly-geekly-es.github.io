<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì´ üñ•Ô∏è üé∏ Pourquoi √©crire votre grille de donn√©es React en 2019 ‚ô£Ô∏è üî¢ üë®üèª‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je suis impliqu√© dans le d√©veloppement d'un syst√®me ECM. Et dans une courte s√©rie d'articles, je veux partager notre exp√©rience et l'hi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pourquoi √©crire votre grille de donn√©es React en 2019</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457504/"><p>  Bonjour, Habr!  Je suis impliqu√© dans le d√©veloppement d'un syst√®me ECM.  Et dans une courte s√©rie d'articles, je veux partager notre exp√©rience et l'histoire du d√©veloppement de ma React Data Grid (ci-apr√®s simplement une grille), √† ‚Äã‚Äãsavoir: </p><br><ul><li>  pourquoi nous avons abandonn√© les composants finis </li><li>  quels probl√®mes et t√¢ches avons-nous rencontr√©s lors du d√©veloppement de notre grille </li><li>  quel b√©n√©fice le d√©veloppement de votre r√©seau apporte </li></ul><br><h3 id="predystoriya">  Contexte </h3><br><p>  Notre syst√®me dispose d'une application Web dans laquelle les utilisateurs travaillent avec des listes de documents, des r√©sultats de recherche, des r√©pertoires.  De plus, les listes peuvent √™tre petites (10 employ√©s) ou tr√®s grandes (50 000 entrepreneurs).  Pour afficher ces listes, nous avons d√©velopp√© notre propre grille: </p><br><p><img src="https://habrastorage.org/webt/1m/v3/py/1mv3pyhnf7emxc6xs2h8lcv8dis.png" alt="image"></p><a name="habracut"></a><br><p>  Lorsque nous avons commenc√© √† d√©velopper une application Web, nous voulions trouver une biblioth√®que pr√™te √† l'emploi pour afficher des grilles qui peuvent faire tout ce dont nous avons besoin: trier et grouper les enregistrements, glisser-d√©poser des colonnes, travailler avec plusieurs s√©lections, filtrer et calculer les totaux des colonnes, par portions T√©l√©chargez les donn√©es du serveur et affichez des dizaines de milliers d'enregistrements. </p><br><p>  J'expliquerai la derni√®re exigence ¬´afficher des dizaines de milliers d'enregistrements¬ª.  Dans les grilles, cette exigence est impl√©ment√©e de plusieurs mani√®res: pagination, d√©filement infini, d√©filement virtuel. </p><br><p>  Les approches de pagination et de d√©filement √† l'infini sont courantes sur les sites Web, vous les utilisez tous les jours.  Par exemple, la pagination dans Google: </p><br><p><img src="https://habrastorage.org/webt/v5/5q/vz/v55qvz8wjlhqmp-jfzievdnjvxe.png" alt="image"></p><br><p>  Ou d√©filement √† l'infini dans le m√™me Google sur les images, o√π la partie suivante des images est charg√©e lorsque vous faites d√©filer la premi√®re partie jusqu'√† la fin: </p><br><p><img src="https://habrastorage.org/webt/bs/r7/qk/bsr7qkhgokj6ezk3qlagzkkgdaq.png" alt="image"></p><br><p>  Mais le d√©filement virtuel (ci-apr√®s d√©nomm√© d√©filement virtuel) est rarement utilis√© sur le Web, sa principale diff√©rence avec le d√©filement √† l'infini est la possibilit√© de parcourir rapidement de tr√®s grandes listes n'importe o√π.  Dans ce cas, seules les donn√©es visibles par l'utilisateur seront t√©l√©charg√©es et affich√©es. </p><br><p><img src="https://habrastorage.org/webt/wf/j8/ct/wfj8ctaao00cbfi1txsytvpqwae.png" alt="image"></p><br><p>  Pour notre application Web, je voulais utiliser le d√©filement virtuel.  Je suis d'accord que faire d√©filer n'importe o√π dans la liste des 10 000 entr√©es est un cas plut√¥t invent√©.  Cependant, le d√©filement al√©atoire dans les 500 √† 1 000 enregistrements est un cas r√©el. </p><br><p>  Lorsqu'ils impl√©mentent le d√©filement virtuel, ils impl√©mentent souvent l'API logicielle pour g√©rer ce d√©filement.  C'est une caract√©ristique tr√®s importante.  Le d√©filement logiciel est utilis√©, par exemple, pour positionner l'enregistrement s√©lectionn√© au milieu de l'√©cran lors de l'ouverture du r√©pertoire: </p><br><p><img src="https://habrastorage.org/webt/ny/up/na/nyupnajuldvlpnb294u203xvy-w.png" alt="image"></p><br><p>  Retour aux exigences.  De quoi d'autre avions-nous besoin: </p><br><ul><li>  API de gestion du d√©filement virtuel </li><li>  Personnalisation de l'apparence de la grille (lignes, colonnes, menu contextuel) pour que la grille ne soit pas √©trang√®re dans notre application </li><li>  Prise en charge des technologies que nous utilisons: react, redux et flexbox </li><li>  Que la grille a fonctionn√© dans ie11 </li></ul><br><p>  En g√©n√©ral, il y avait de nombreuses exigences. </p><br><h3 id="popytka-pervaya-2016-god-devextreme-javascript-data-grid">  La premi√®re tentative (2016).  Grille de donn√©es JavaScript DevExtreme </h3><br><p>  Peu de temps apr√®s avoir explor√© les biblioth√®ques existantes, nous sommes tomb√©s sur la grille de donn√©es JavaScript DevExtreme.  Par exigences fonctionnelles, cette grille couvrait tous nos besoins et avait une apparence tr√®s pr√©sentable.  Cependant, il n'√©tait pas adapt√© aux exigences technologiques (pas de r√©action, pas de redux, pas de flexbox).  √Ä cette √©poque, DevExtreme n'avait pas de grille de r√©action. </p><br><p>  Eh bien, laissez-le ne pas r√©agir, nous avons d√©cid√©, car la grille est belle et fonctionnelle, nous allons l'utiliser.  Et ils ont ajout√© la biblioth√®que √† leur projet.  Il s'est av√©r√© que nous avons ajout√© 3 Mo de scripts. </p><br><p>  Pendant quelques semaines, nous avons int√©gr√© la grille dans notre application Web et augment√© les fonctionnalit√©s de base: </p><br><ul><li>  Envelopp√© d'une grille pour se faire des amis avec r√©agir et redux </li><li>  Augmentation du d√©filement virtuel et du chargement des portions de donn√©es √† partir de notre serveur Web </li><li>  Tri et s√©lection mis en ≈ìuvre </li></ul><br><p>  Dans le processus de vissage de la grille, deux probl√®mes graves sont devenus √©vidents et tout un tas de probl√®mes moins graves. </p><br><h3 id="pervaya-sereznaya-problema">  Premier probl√®me grave </h3><br><p>  Pour rendre la grille de donn√©es JavaScript DevExtreme avec redux tr√®s difficile.  Nous avons r√©ussi √† contr√¥ler les param√®tres de la colonne et √† mettre les enregistrements en surbrillance via redux, mais √† stocker des donn√©es charg√©es en partie dans redux et √† effectuer des op√©rations CRUD sur eux via redux - ce n'est pas r√©aliste.  J'ai d√ª faire une b√©quille qui, en contournant le redux, a manipul√© les donn√©es du r√©seau.  La b√©quille s'est av√©r√©e complexe et fragile.  Ce fut la premi√®re sonnette d'alarme que la grille ne nous convenait pas, mais nous avons continu√© √† la visser. </p><br><h3 id="vtoraya-sereznaya-problema">  Deuxi√®me probl√®me grave </h3><br><p>  Il n'y a pas d'API de gestion du d√©filement virtuel.  Nous ne pouvions pas refuser le contr√¥le logiciel du d√©filement, nous avons d√ª refaire les sources DevExtreme et trouver l'API de contr√¥le de d√©filement interne.  Bien s√ªr, cette API avait une montagne de limitations, car elle a √©t√© con√ßue pour un usage interne.  En cons√©quence, nous avons r√©ussi √† faire plus ou moins travailler l'API interne sur nos bo√Ætiers, mais encore une fois, en contournant le redux, et encore un tas de b√©quilles. </p><br><h3 id="menee-sereznye-problemy">  Probl√®mes moins graves </h3><br><p>  Des probl√®mes moins graves surgissaient tout le temps, car la fonctionnalit√© standard de grille de donn√©es JavaScript DevExtreme ne nous convenait pas compl√®tement, et nous avons essay√© de la corriger: </p><br><ol><li>  L'√©tirement de la grille DevExtreme en hauteur ne fonctionne pas.  J'ai d√ª √©crire un hack pour apprendre √† DevExtreme comment faire (peut-√™tre qu'il n'y a pas de probl√®me avec cela dans les versions r√©centes). </li><li>  Lorsque le focus n'est pas dans la grille, il est impossible de contr√¥ler la s√©lection des lignes via le clavier (et nous en avions besoin).  J'ai d√ª √©crire ma commande de clavier. </li><li>  Lors de la modification de la composition des colonnes et de la modification des donn√©es, nous avons eu le probl√®me de clignoter les donn√©es (avec le d√©filement virtuel activ√©). </li><li>  Le probl√®me d'un grand nombre de requ√™tes lors du premier affichage de la grille.  C'√©tait particuli√®rement visible lorsque nous contr√¥lions le d√©filement de l'API interne. </li><li>  Il est difficile de personnaliser certaines parties de la grille de l'interface utilisateur.  Par exemple, il y avait un d√©sir au-dessus de la ligne de grille s√©lectionn√©e de dessiner des actions de gestion de ligne (supprimer une ligne, copier, ouvrir une carte).  Mais comment visser cela dans DevExtreme n'√©tait pas clair, et m√™me en utilisant react: <br><img src="https://habrastorage.org/webt/yo/zv/9b/yozv9boc174n-rxmbdsxoham4g8.png" alt="image"></li><li>  Il est difficile de catomiser le tri (nous voulions trier par des donn√©es qui ne sont pas affich√©es dans la grille et non mapp√©es en colonnes). </li><li>  Des b√©quilles sont n√©cessaires pour visser le composant de r√©action dans les cellules de la grille (apr√®s tout, la grille n'est pas sur la r√©action). </li><li>  Pas de frappe de code DevExtreme (flux / tapuscrit). </li><li>  Probl√®me de vitesse avec un long d√©filement virtuel. </li><li>  Probl√®me de vitesse lors de l'√©tirement / de la r√©organisation des colonnes (apr√®s un d√©filement virtuel prolong√©). </li><li>  La taille des scripts de grille est de 3 Mo. </li></ol><br><p>  Bien que la grille de fonctionnalit√©s DevExtreme contienne tout ce dont nous avions besoin, mais je voulais r√©√©crire presque toutes les fonctionnalit√©s standard.  Lors de son utilisation, des centaines de lignes de code difficiles √† comprendre ont √©t√© ajout√©es qui tentaient de r√©soudre les probl√®mes d'interaction avec redux et de r√©agir, il √©tait difficile d'utiliser une grille non-r√©active dans une application React. </p><br><h3 id="otkaz-ot-devextreme-poisk-alternativ">  Refus de DevExtreme.  Recherche d'alternatives </h3><br><p>  Apr√®s un certain temps √† utiliser DevExtreme, il a √©t√© d√©cid√© de l'abandonner.  Jetez tous les hacks, le code complexe, ainsi que 3 Mo de scripts DevExtreme.  Et trouvez ou √©crivez une nouvelle grille. </p><br><p>  Cette fois, nous sommes plus attentifs √† l'√©tude des grilles existantes.  MS Fabric DetailsList, ReactVirtualized Grid, DevExtreme React Grid, Telerik Grid, KendoUI Grid ont √©t√© √©tudi√©s. <br>  Les exigences sont rest√©es les m√™mes, mais elles ont d√©j√† pris forme dans une liste qui nous √©tait claire. </p><br><p>  Exigences technologiques: </p><br><ul><li>  r√©agir </li><li>  redux </li><li>  flexbox </li></ul><br><p>  Exigences fonctionnelles: </p><br><ul><li>  D√©filement virtuel (avec la possibilit√© d'afficher des dizaines de milliers d'enregistrements) </li><li>  API de gestion du d√©filement </li><li>  Stockage des donn√©es et des param√®tres de grille dans redux </li><li>  Chargement de donn√©es par lots √† partir d'un serveur Web </li><li>  Gestion des colonnes (√©tirement / r√©organisation / contr√¥le de la visibilit√©) </li><li>  Tri + filtrage des colonnes </li><li>  S√©lection multiple </li><li>  Recherche similaire avec r√©tro√©clairage </li><li>  D√©filement horizontal </li><li>  Clavier </li><li>  Menu contextuel (sur une ligne, sur une zone vide, sur des colonnes) </li><li>  Prise en charge ie11, edge, chrome, ff, safari </li></ul><br><p>  √Ä ce stade, la premi√®re version de DevExtreme React Grid √©tait d√©j√† apparue, mais nous l'avons imm√©diatement abandonn√©e pour les raisons suivantes: </p><br><ul><li>  Le d√©filement virtuel n'est pas pris en charge dans ie11 </li><li>  Le d√©filement virtuel ne fonctionne pas en conjonction avec le t√©l√©chargement de donn√©es par lots √† partir du serveur (bien qu'il semble y avoir quelques solutions). </li><li>  Et surtout, je ne voulais pas marcher sur le m√™me r√¢teau quand je voulais r√©√©crire la moiti√© des fonctionnalit√©s standard d'une grille tierce. </li></ul><br><p>  L'analyse des solutions existantes a montr√© qu'il n'y a pas de ¬´solution miracle¬ª.  Une grille qui couvrirait toutes nos exigences n'existe pas.  Il a √©t√© d√©cid√© d'√©crire notre propre grille, que nous allons d√©velopper en termes de fonctionnalit√©s dans la direction dont nous avons besoin, et d'√™tre amis avec les technologies n√©cessaires √† notre produit. </p><br><h3 id="razrabotka-svoego-react-data-grid">  D√©veloppement de votre grille de donn√©es React </h3><br><p>  Le d√©veloppement de la grille a commenc√© avec des prototypes, o√π ils ont test√© les sujets les plus difficiles pour nous: </p><br><ul><li>  d√©filement virtuel </li><li>  stockage de toutes les donn√©es du r√©seau dans Redux </li></ul><br><h3 id="virtual-scrolling">  D√©filement virtuel </h3><br><p>  Le plus difficile s'est av√©r√© √™tre le d√©filement virtuel.  Pour la plupart, il est fait de 3 fa√ßons: </p><br><p>  <strong>1. Virtualisation des pages</strong> <br>  Les donn√©es sont dessin√©es en portions - pages.  Lors du d√©filement, des pages visibles sont ajout√©es, des pages invisibles sont supprim√©es.  La page se compose de 20 √† 60 lignes (g√©n√©ralement la taille est personnalisable).  C'est l√† que les produits sont all√©s: DevExtreme JavaScript Data Grid, MS Fabric DetailsList. </p><br><p><img src="https://habrastorage.org/webt/h7/tf/5l/h7tf5lynlgmje6wunlcowkeabqa.png" alt="image"></p><br><p>  <strong>2. Virtualisation ligne par ligne</strong> <br>  Seules les lignes visibles sont dessin√©es.  D√®s qu'une ligne quitte l'√©cran, elle est imm√©diatement supprim√©e.  Les produits ont suivi cette voie: ReactVirtualized Grid, DevExtreme React Grid, Telerik Grid. </p><br><p><img src="https://habrastorage.org/webt/9j/zs/bh/9jzsbhqw0_up5gnkt2g7cw3uth0.png" alt="image"></p><br><p>  <strong>3. Toile</strong> <br>  Toutes les lignes et leur contenu sont dessin√©s √† l'aide de Canvas.  C'est ce que Google Docs a fait. </p><br><p><img src="https://habrastorage.org/webt/12/f_/hd/12f_hdydog5ponrdm9filxne_1u.png" alt="image"></p><br><p>  Lors du d√©veloppement de la grille, nous avons r√©alis√© des prototypes pour les trois options de virtualisation (m√™me pour Canvas).  Et ils ont choisi la virtualisation page par page. </p><br><h3 id="pochemu-otkazalis-ot-drugih-variantov">  Pourquoi abandonn√© d'autres options? </h3><br><p>  La virtualisation ligne par ligne a rencontr√© des probl√®mes de vitesse de rendu dans le prototype.  D√®s que le contenu des lignes est devenu plus compliqu√© (beaucoup de texte, surlignage, d√©coupage, ic√¥nes, un grand nombre de colonnes et partout flexbox), il est devenu co√ªteux d'ajouter / supprimer des lignes plusieurs fois par seconde.  Bien s√ªr, les r√©sultats d√©pendent √©galement du navigateur (nous avons pris en charge, y compris pour ie11, edge): </p><br><p><img src="https://habrastorage.org/webt/fe/4v/xh/fe4vxhw7r5zjwqqezc7rmxubmmm.png" alt="image"></p><br><p>  L'option Canvas √©tait tr√®s s√©duisante dans la vitesse de rendu, mais laborieuse.  Il a √©t√© propos√© de tout dessiner: texte, habillage de texte, rognage de texte, mise en surbrillance, ic√¥nes, lignes de division, mise en surbrillance, indentation.  Faites une r√©action en cliquant sur le bouton de la souris sur le canevas, en mettant en √©vidence les lignes lorsque vous survolez.  Dans le m√™me temps, certains √©l√©ments Dom (montrant des astuces, des ¬´actions contextuelles¬ª sur la ligne) doivent √™tre appliqu√©s sur Canvas.  Il fallait encore r√©soudre le probl√®me de flou du texte et des ic√¥nes dans Canvas.  Tout cela est long et difficile √† faire.  Bien que nous ma√Ætrisions le prototype.  Dans le m√™me temps, toute personnalisation des lignes et des cellules √† l'avenir entra√Ænerait une grande p√©nibilit√© pour nous. </p><br><h4 id="plyusy-postranichnoy-virtualizacii">  Les avantages de la pagination </h4><br><p>  La virtualisation page par page s√©lectionn√©e pr√©sente des avantages par rapport √† la ligne par ligne, ce qui d√©termine son choix: </p><br><ul><li>  Si la page est d√©j√† rendue, le d√©filement √† l'int√©rieur de la page est bon march√© (l'arborescence DOM ne change pas lors du d√©filement).  La virtualisation ligne par ligne pour tout d√©filement mineur n√©cessite de modifier l'arborescence DOM, ce qui est co√ªteux lorsque l'arborescence DOM est complexe et que Flexbox est utilis√© partout. </li><li>  Pour les petites listes (&lt;200 entr√©es) les pages ne peuvent pas √™tre supprim√©es, il suffit d'ajouter.  T√¥t ou tard, toutes les pages seront construites et le d√©filement sera totalement gratuit (en termes de temps de rendu). </li></ul><br><h4 id="vybor-razmera-stranicy">  S√©lection du format de page </h4><br><p>  Un autre probl√®me est le choix de la taille de la page.  J'ai √©crit ci-dessus que la taille est personnalisable et est g√©n√©ralement de 20 √† 60 lignes.  Une grande page est dessin√©e pendant longtemps, une petite conduit √† un affichage fr√©quent d'un "√©cran blanc" lors du d√©filement.  Exp√©rimentalement, une taille de page de 25 lignes a √©t√© s√©lectionn√©e.  Cependant, pour ie11, la taille a √©t√© r√©duite √† 5 lignes.  On dirait que l'interface dans IE est plus r√©active si vous dessinez beaucoup de petites pages avec de petits retards qu'une grande avec un gros retard. </p><br><h4 id="react-i-virtual-scrolling">  React et d√©filement virtuel </h4><br><p>  La virtualisation des pages devait √™tre impl√©ment√©e √† l'aide de react.  Pour ce faire, plusieurs t√¢ches doivent √™tre r√©solues: </p><br><p>  <strong>T√¢che 1. Comment ajouter / supprimer des pages en r√©agissant lors du d√©filement?</strong> </p><br><p>  Pour r√©soudre ce probl√®me, les concepts suivants ont √©t√© introduits: </p><br><ul><li>  mod√®le de page </li><li>  vue page </li></ul><br><p>  Un mod√®le est une information sur laquelle construire une vue.  Une vue est un composant React. </p><br><p><img src="https://habrastorage.org/webt/ud/da/qi/uddaqigdtketfoh6cwk6lnklcpo.png" alt="image"></p><br><p>  En fait, la t√¢che de virtualisation apr√®s cela se r√©sumait √† manipuler des mod√®les de page: stocker une liste de mod√®les de page, ajouter et supprimer des mod√®les lors du d√©filement.  Et d√©j√† √† partir de la liste des mod√®les via react construire / reconstruire l'affichage: </p><br><p><img src="https://habrastorage.org/webt/4m/sr/g0/4msrg0gy9qwsv9u-8ljjqhzllwa.png" alt="image"></p><br><p>  Au cours de la mise en ≈ìuvre, les r√®gles de travail avec les mod√®les de page ont √©t√© form√©es: </p><br><ul><li>  Les pages doivent √™tre ajout√©es une par une.  Apr√®s chaque ajout, donnez le temps de dessiner.  Il est acceptable d'ajouter 1 page tous les 300 √† 500 ms - c'est une situation de d√©filement rapide.  Si vous ajoutez, par exemple, 5 pages √† la fois, l'interface de l'utilisateur se bloque sur leur construction. </li><li>  Les pages n'ont pas besoin d'√™tre conserv√©es par dizaines.  Un exemple de situation probl√©matique: 20 pages sont affich√©es, l'utilisateur passe √† une autre liste et les 20 pages doivent √™tre supprim√©es en m√™me temps.  La suppression d'un grand nombre de pages est une op√©ration co√ªteuse; le nettoyage de l'arborescence DOM prendra 1 seconde.  Pour √©viter cela, il est pr√©f√©rable de ne pas conserver plus de 10 pages √† la fois. </li><li>  Pour toute manipulation de colonne (r√©arrangement, ajout, suppression, √©tirement), il est pr√©f√©rable de supprimer les pages qui ne sont pas visibles √† l'avance par l'utilisateur.  Cela √©vitera une reconstruction co√ªteuse de toutes les pages rendues. </li></ul><br><p>  <strong>T√¢che 2. Comment afficher la barre de d√©filement?</strong> </p><br><p>  Le d√©filement virtuel suppose qu'une barre de d√©filement est disponible, qui prend en compte la taille de la liste et vous permet de faire d√©filer n'importe o√π: </p><br><p><img src="https://habrastorage.org/webt/lo/rc/ut/lorcutgz7bcopbjltcnziudkgks.png" alt="image"></p><br><p>  Comment afficher une telle barre de d√©filement?  La solution la plus simple consiste √† dessiner un div invisible de la taille requise au lieu de donn√©es r√©elles.  Et d√©j√† au dessus de cette div on affiche les pages visibles: </p><br><p><img src="https://habrastorage.org/webt/pp/_x/vg/pp_xvgowd1qtrnyigxnszou0xnw.png" alt="image"></p><br><p>  <strong>T√¢che 3. Comment surveiller la taille de la fen√™tre?</strong> </p><br><p>  La fen√™tre est la zone de donn√©es visible de la grille.  Pourquoi garder un ≈ìil sur sa taille?  Pour calculer le nombre de pages qui doivent √™tre affich√©es pour l'utilisateur.  Supposons que nous ayons une petite page (5 lignes) et une grande r√©solution d'√©cran (1920x1080).  Combien de pages l'utilisateur doit-il afficher pour fermer la fen√™tre enti√®re? </p><br><p><img src="https://habrastorage.org/webt/tt/g3/sx/ttg3sxfvvuf320ydcwe6esbukp4.png" alt="image"></p><br><p>  Vous pouvez r√©soudre ce probl√®me si vous connaissez la hauteur de la fen√™tre d'affichage et la hauteur d'une page.  Maintenant, compliquons la t√¢che, supposons que l'utilisateur modifie fortement l'√©chelle dans le navigateur - d√©finit 50%: </p><br><p><img src="https://habrastorage.org/webt/s8/47/mt/s847mtipiappdqe0qqsli_yvj14.png" alt="image"></p><br><p>  La situation avec l'√©chelle montre qu'il ne suffit pas de conna√Ætre la taille de la fen√™tre une fois, vous devez surveiller la taille.  Et maintenant, nous allons compliquer compl√®tement la t√¢che: les √©l√©ments html n'ont pas d'√©v√©nement de redimensionnement, auquel vous pouvez vous abonner et surveiller la taille.  Seul l'objet fen√™tre a √©t√© redimensionn√©. </p><br><p>  La premi√®re chose qui vient √† l'esprit est d'utiliser une minuterie et d'interroger constamment la hauteur de l'√©l√©ment html.  Mais il existe une solution encore meilleure que nous avons vue dans la grille de donn√©es JavaScript DevExtreme: cr√©er un iframe invisible, l'√©tirer √† la taille de la grille et vous abonner √† l'√©v√©nement resize de iframe.contentWindow: </p><br><p><img src="https://habrastorage.org/webt/fa/gi/ta/fagitaw870f5ahtworjownk__mk.png" alt="image"></p><br><p><img src="https://habrastorage.org/webt/dd/m9/tq/ddm9tqblgsmpwepcc7_gq7g32sm.png" alt="image"></p><br><h3 id="rezyume">  R√©sum√© </h3><br><p>  PS Ce n'est pas la fin.  Dans le prochain article, je dirai comment nous nous sommes li√©s d'amiti√© avec redux. </p><br><p>  Pour obtenir un d√©filement virtuel complet, de nombreuses autres t√¢ches devaient √™tre r√©solues.  Mais ceux d√©crits ci-dessus √©taient les plus int√©ressants.  Voici quelques autres t√¢ches qui apparaissent √©galement: </p><br><ul><li>  Tenez compte du sens et de la vitesse de d√©filement lorsque vous ajoutez / supprimez des pages. </li><li>  Tenez compte des modifications des donn√©es pour minimiser les mod√®les de page de reconstruction.  Par exemple, supprim√© une ligne ou ajout√© une ligne, que faire des pages d√©j√† rendues?  Jeter tout ou en laisser?  Il y a place pour l'optimisation. </li><li>  Lorsque vous modifiez la s√©lection, r√©organisez le nombre minimum de pages requis. </li></ul><br><p>  Si vous avez des questions sur la mise en ≈ìuvre, vous pouvez les √©crire dans les commentaires. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457504/">https://habr.com/ru/post/fr457504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457476/index.html">R√©duction de la taille d'une image Docker avec une application Spring Boot</a></li>
<li><a href="../fr457480/index.html">Cr√©ation d'une application d'√©coute pour visualiser le trafic MMORPG mobile</a></li>
<li><a href="../fr457490/index.html">Aisioshechka de Zuckerberg - bri√®vement et dans le cas de la Balance</a></li>
<li><a href="../fr457500/index.html">Comment nous avons fait le pilote automatique pour une station-service</a></li>
<li><a href="../fr457502/index.html">Comment le mod√®le de notation RICE am√©liore la hi√©rarchisation des fonctionnalit√©s du produit</a></li>
<li><a href="../fr457510/index.html">Utilisez mcrouter pour faire √©voluer horizontalement memcached</a></li>
<li><a href="../fr457512/index.html">R√©plication logique entre les versions de PostgreSQL</a></li>
<li><a href="../fr457514/index.html">Nevanger</a></li>
<li><a href="../fr457516/index.html">√âcrire un mod√®le de menace</a></li>
<li><a href="../fr457518/index.html">Plasma Cash Chain comme solution au trilemme d'√©volutivit√© de la blockchain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>