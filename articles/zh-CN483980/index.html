<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¼â€ğŸš’ ğŸŒ– ğŸ„ åˆ›å»ºå®¹é”™ITåŸºç¡€æ¶æ„ã€‚ ç¬¬1éƒ¨åˆ†-å‡†å¤‡éƒ¨ç½²oVirt 4.3é›†ç¾¤ ğŸ§œğŸ¿ ğŸ¤¶ğŸ½ ğŸ‘†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="é‚€è¯·è¯»è€…ç†Ÿæ‚‰åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…æ„å»ºå°å‹ä¼ä¸šçš„å®¹é”™åŸºç¡€æ¶æ„çš„åŸç†ï¼Œå°†åœ¨ç®€çŸ­çš„ç³»åˆ—æ–‡ç« ä¸­å¯¹å…¶è¿›è¡Œè¯¦ç»†ç ”ç©¶ã€‚ 
 å¼•è¨€ 


 åœ¨DPC ï¼ˆæ•°æ®å¤„ç†ä¸­å¿ƒï¼‰ä¸‹å¯ä»¥ç†è§£ï¼š 


- åœ¨ä¼ä¸šåŒºåŸŸå†…çš„â€œæœåŠ¡å™¨æœºæˆ¿â€ä¸­æ‹¥æœ‰è‡ªå·±çš„æœºæ¶ï¼Œè¯¥æœºæ¶æ»¡è¶³æä¾›ç”µæºå’Œå†·å´è®¾å¤‡ä»¥åŠé€šè¿‡ä¸¤ä¸ªç‹¬ç«‹æä¾›å•†è¿›è¡ŒInternetè®¿é—®çš„æœ€ä½è¦æ±‚...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åˆ›å»ºå®¹é”™ITåŸºç¡€æ¶æ„ã€‚ ç¬¬1éƒ¨åˆ†-å‡†å¤‡éƒ¨ç½²oVirt 4.3é›†ç¾¤</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lenvendo/blog/483980/"><p> é‚€è¯·è¯»è€…ç†Ÿæ‚‰åœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…æ„å»ºå°å‹ä¼ä¸šçš„å®¹é”™åŸºç¡€æ¶æ„çš„åŸç†ï¼Œå°†åœ¨ç®€çŸ­çš„ç³»åˆ—æ–‡ç« ä¸­å¯¹å…¶è¿›è¡Œè¯¦ç»†ç ”ç©¶ã€‚ </p><a name="habracut"></a><br><h2 id="vvodnaya-chast"> å¼•è¨€ </h2><br><p> åœ¨<strong>DPC</strong> ï¼ˆæ•°æ®å¤„ç†ä¸­å¿ƒï¼‰ä¸‹å¯ä»¥ç†è§£ï¼š </p><br><ul><li> åœ¨ä¼ä¸šåŒºåŸŸå†…çš„â€œæœåŠ¡å™¨æœºæˆ¿â€ä¸­æ‹¥æœ‰è‡ªå·±çš„æœºæ¶ï¼Œè¯¥æœºæ¶æ»¡è¶³æä¾›ç”µæºå’Œå†·å´è®¾å¤‡ä»¥åŠé€šè¿‡ä¸¤ä¸ªç‹¬ç«‹æä¾›å•†è¿›è¡ŒInternetè®¿é—®çš„æœ€ä½è¦æ±‚ï¼› </li><li> åœ¨æ­¤æ•°æ®ä¸­å¿ƒä¸­æ‹¥æœ‰è‡ªå·±è®¾å¤‡çš„ç§Ÿç”¨æœºæ¶-æ‰€è°“çš„ ç¬¦åˆTier IIIæˆ–IVæ ‡å‡†çš„é…ç½®ï¼Œå¯ç¡®ä¿å¯é çš„ç”µæºï¼Œå†·å´å¹¶æä¾›å®¹é”™çš„Internetè®¿é—®ï¼› </li><li> åœ¨Tier IIIæˆ–IVæ•°æ®ä¸­å¿ƒä¸­å®Œå…¨ç§Ÿç”¨çš„è®¾å¤‡ã€‚ </li></ul><br><p> é€‰æ‹©å“ªç§ä½å®¿é€‰æ‹©-åœ¨æ¯ç§æƒ…å†µä¸‹ï¼Œä¸€åˆ‡éƒ½æ˜¯ä¸ªåˆ«çš„ï¼Œé€šå¸¸å–å†³äºå‡ ä¸ªä¸»è¦å› ç´ ï¼š </p><br><ul><li> ä¼ä¸šä¸ºä½•æ‹¥æœ‰è‡ªå·±çš„ITåŸºç¡€æ¶æ„ï¼› </li><li> ä¼ä¸šä»ITåŸºç¡€æ¶æ„ä¸­åˆ°åº•éœ€è¦ä»€ä¹ˆï¼ˆå¯é æ€§ï¼Œå¯ä¼¸ç¼©æ€§ï¼Œå¯ç®¡ç†æ€§ç­‰ï¼‰ï¼› </li><li> å¯¹ITåŸºç¡€æ¶æ„çš„åˆå§‹æŠ•èµ„é‡‘é¢ï¼Œä»¥åŠå®ƒçš„æˆæœ¬ç±»å‹-èµ„æœ¬ï¼ˆè¿™æ„å‘³ç€è´­ä¹°è®¾å¤‡ï¼‰æˆ–è¿è¥ï¼ˆé€šå¸¸æ˜¯ç§Ÿç”¨è®¾å¤‡ï¼‰ï¼› </li><li> ä¼ä¸šæœ¬èº«çš„è®¡åˆ’èŒƒå›´ã€‚ </li></ul><br><p> å…³äºå½±å“ä¼ä¸šå†³å®šåˆ›å»ºå’Œä½¿ç”¨å…¶ITåŸºç¡€ç»“æ„çš„å†³å®šçš„â€‹â€‹å› ç´ å¾ˆå¤šï¼Œä½†æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨å®è·µä¸­å±•ç¤ºå¦‚ä½•åˆ›å»ºè¿™ç§åŸºç¡€ç»“æ„ï¼Œä»¥ä¾¿æ—¢å®¹é”™åˆå¯ä»¥èŠ‚çœé‡‘é’±ã€‚ -å‡å°‘è·å–å•†ä¸šè½¯ä»¶çš„æˆæœ¬ï¼Œç”šè‡³é¿å…ä½¿ç”¨å®ƒä»¬ã€‚ </p><br><p> é•¿æœŸçš„å®è·µè¡¨æ˜ï¼Œä¸å€¼å¾—åœ¨ç¡¬ä»¶ä¸ŠèŠ‚çœæˆæœ¬ï¼Œå› ä¸ºæ‚è´¹æ”¯ä»˜äº†ä¸¤å€ç”šè‡³æ›´å¤šã€‚ ä½†æ˜¯å†è¯´ä¸€é-å¥½çš„ç¡¬ä»¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªå»ºè®®ï¼Œæœ€ç»ˆè¦ä¹°çš„æ˜¯ä»€ä¹ˆï¼Œä»¥åŠè´­ä¹°å¤šå°‘å–å†³äºä¼ä¸šçš„èƒ½åŠ›åŠå…¶ç®¡ç†çš„â€œè´ªå©ªâ€ã€‚ æ­¤å¤–ï¼Œâ€œè´ªå©ªâ€ä¸€è¯åº”è¯¥æœ‰ä¸€ä¸ªå¾ˆå¥½çš„ç†è§£ï¼Œå› ä¸ºåœ¨åˆæœŸé˜¶æ®µæœ€å¥½æŠ•èµ„äºé“ï¼Œè¿™æ ·ä»¥ååœ¨è¿›ä¸€æ­¥çš„æ”¯æŒå’Œæ‰©å±•æ–¹é¢å°±ä¸ä¼šå‡ºç°ä¸¥é‡çš„é—®é¢˜ï¼Œå› ä¸ºæœ€åˆé”™è¯¯çš„è®¡åˆ’å’Œè¿‡å¤šçš„å‚¨è“„ä¼šå¯¼è‡´æœªæ¥çš„å‘å±•ã€‚æ¯”å¼€å§‹é¡¹ç›®æ—¶è¦è´µã€‚ </p><br><p> å› æ­¤ï¼Œè¯¥é¡¹ç›®çš„åˆå§‹æ•°æ®ï¼š </p><br><ul><li> æœ‰ä¸€å®¶ä¼ä¸šå†³å®šåˆ›å»ºè‡ªå·±çš„Webé—¨æˆ·å¹¶å°†å…¶æ´»åŠ¨æ”¾åˆ°Internetä¸Šã€‚ </li><li> è¯¥å…¬å¸å†³å®šç§Ÿç”¨æœºæ¶ï¼Œä»¥å°†å…¶è®¾å¤‡æ”¾ç½®åœ¨ç»è¿‡Tier IIIæ ‡å‡†è®¤è¯çš„è‰¯å¥½æ•°æ®ä¸­å¿ƒä¸­ï¼› </li><li> è¯¥å…¬å¸å†³å®šä¸èŠ‚çœå¤ªå¤šç¡¬ä»¶æˆæœ¬ï¼Œå› æ­¤è´­ä¹°äº†ä»¥ä¸‹å…·æœ‰é•¿æœŸä¿è¯å’Œæ”¯æŒçš„è®¾å¤‡ï¼š </li></ul><br><div class="spoiler">  <b class="spoiler_title">è®¾å¤‡æ¸…å•</b> <div class="spoiler_text"><blockquote><ul><li> ä¸¤å°ç‰©ç†Dell PowerEdge R640æœåŠ¡å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </li><li>  <em>ä¸¤ä¸ªIntel Xeon Gold 5120å¤„ç†å™¨</em> </li><li>  <em>512 Gbå†…å­˜</em> </li><li>  <em>RAID1ä¸­çš„ä¸¤ä¸ªSASç£ç›˜ï¼Œç”¨äºæ“ä½œç³»ç»Ÿå®‰è£…</em> </li><li>  <em>å†…ç½®4ç«¯å£1Gç½‘å¡</em> </li><li>  <em>ä¸¤ä¸ª2ç«¯å£10Gç½‘å¡</em> </li><li>  <em>1ä¸ª2ç«¯å£FC HBA 16Gã€‚</em> </li><li>  2æ§åˆ¶å™¨å­˜å‚¨ç³»ç»ŸDell MD3820fï¼Œé€šè¿‡FC 16Gç›´æ¥è¿æ¥åˆ°Dellä¸»æœºï¼› </li><li> ç¬¬äºŒçº§çš„ä¸¤ä¸ªäº¤æ¢æœº-Cisco WS-C2960RX-48FPS-Lå †å ï¼› </li><li>ä¸¤ä¸ªä¸‰å±‚äº¤æ¢æœº-Cisco WS-C3850-24T-Eï¼Œå †å ï¼› </li><li> æœºæ¶ï¼ŒUPSï¼ŒPDUï¼Œæ§åˆ¶å°æœåŠ¡å™¨-ç”±æ•°æ®ä¸­å¿ƒæä¾›ã€‚ </li></ul><br></blockquote></div></div><br><p> å¦‚æˆ‘ä»¬æ‰€è§ï¼Œå¦‚æœè¯¥å…¬å¸å¯ä»¥ä¸Internetä¸Šå…·æœ‰ç±»ä¼¼é…ç½®æ–‡ä»¶çš„å…¶ä»–å…¬å¸ç«äº‰ï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹èµšå–å¯ç”¨äºæ‰©å±•èµ„æºä»¥è¿›ä¸€æ­¥ç«äº‰å’Œå¢é•¿çš„åˆ©æ¶¦ï¼Œåˆ™ç°æœ‰è®¾å¤‡åœ¨æ°´å¹³å’Œå‚ç›´æ‰©å±•æ–¹é¢éƒ½å…·æœ‰è‰¯å¥½çš„å‰æ™¯ã€‚ </p><br><p> å¦‚æœä¼ä¸šå†³å®šæé«˜è®¡ç®—é›†ç¾¤çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å“ªäº›è®¾å¤‡ï¼š </p><br><ul><li> æˆ‘ä»¬ä¸º2960Xäº¤æ¢æœºä¸Šçš„ç«¯å£æ•°é‡é¢„ç•™äº†å¤§é‡ç©ºé—´ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥æ·»åŠ æ›´å¤šçš„ç¡¬ä»¶æœåŠ¡å™¨ï¼› </li><li> è´­ä¹°ä¸¤ä¸ªå…‰çº¤é€šé“äº¤æ¢æœºä»¥å°†å­˜å‚¨ç³»ç»Ÿå’Œå…¶ä»–æœåŠ¡å™¨è¿æ¥åˆ°å®ƒä»¬ï¼› </li><li> å¯ä»¥å‡çº§ç°æœ‰æœåŠ¡å™¨-æ·»åŠ å†…å­˜ï¼Œç”¨æ›´é«˜æ•ˆçš„æœåŠ¡å™¨æ›¿æ¢å¤„ç†å™¨ï¼Œå°†ç°æœ‰ç½‘ç»œé€‚é…å™¨è¿æ¥åˆ°10Gç½‘ç»œï¼› </li><li> æ‚¨å¯ä»¥æ ¹æ®è®¡åˆ’çš„è´Ÿè½½ï¼Œä½¿ç”¨å¿…è¦çš„ç£ç›˜ç±»å‹ï¼ˆSASï¼ŒSATAæˆ–SSDï¼‰å°†å…¶ä»–ç£ç›˜æ¶æ·»åŠ åˆ°å­˜å‚¨ä¸­ã€‚ </li><li> æ·»åŠ FCäº¤æ¢æœºåï¼Œæ‚¨å¯ä»¥è´­ä¹°å¦ä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿä»¥å¢åŠ æ›´å¤šçš„ç£ç›˜å®¹é‡ï¼Œå¦‚æœè´­ä¹°äº†ç‰¹æ®Šçš„è¿œç¨‹å¤åˆ¶é€‰ä»¶ï¼Œåˆ™å¯ä»¥åœ¨åŒä¸€æ•°æ®ä¸­å¿ƒå†…å’Œæ•°æ®ä¸­å¿ƒä¹‹é—´é…ç½®å­˜å‚¨ç³»ç»Ÿä¹‹é—´çš„æ•°æ®å¤åˆ¶ï¼ˆä½†æ˜¯ï¼Œè¿™å·²ç»è¶…å‡ºäº†èŒƒå›´ï¼‰æ–‡ç« çš„èŒƒå›´ï¼‰ï¼› </li><li> è¿˜æœ‰ä¸‰çº§äº¤æ¢æœº-Cisco 3850ï¼Œå¯ä»¥ç”¨ä½œç½‘ç»œçš„å®¹é”™æ ¸å¿ƒï¼Œä»¥åœ¨å†…éƒ¨ç½‘ç»œä¹‹é—´è¿›è¡Œé«˜é€Ÿè·¯ç”±ã€‚ éšç€å†…éƒ¨åŸºç¡€è®¾æ–½çš„å‘å±•ï¼Œè¿™å°†åœ¨å°†æ¥æå¤§åœ°å¸®åŠ©æ‚¨ã€‚  3850è¿˜å…·æœ‰10Gç«¯å£ï¼Œå¯åœ¨ä»¥åå°†ç½‘ç»œè®¾å¤‡å‡çº§åˆ°10Gæ—¶æ¿€æ´»ã€‚ </li></ul><br><p> æ—¢ç„¶ç°åœ¨æ²¡æœ‰è™šæ‹ŸåŒ–çš„åœ°æ–¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å½“ç„¶ä¼šå¤„äºè¶‹åŠ¿ä¹‹ä¸­ï¼Œè€Œä¸”è¿™æ˜¯é™ä½è´­ä¹°æŸäº›åŸºç¡€æ¶æ„å…ƒç´ ï¼ˆWebæœåŠ¡å™¨ï¼Œæ•°æ®åº“ç­‰ï¼‰çš„æ˜‚è´µæœåŠ¡å™¨çš„æˆæœ¬çš„å¥½æ–¹æ³•ï¼Œè€Œè¿™å¹¶éæ€»æ˜¯æœ€ä½³çš„åœ¨ä½è´Ÿè½½çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œè¿™æ°å¥½æ˜¯é¡¹ç›®å¯åŠ¨ä¹‹åˆçš„æ ·å­ã€‚ </p><br><p> æ­¤å¤–ï¼Œè™šæ‹ŸåŒ–è¿˜æœ‰è®¸å¤šå…¶ä»–ä¼˜åŠ¿ï¼Œå¯¹æˆ‘ä»¬å¯èƒ½éå¸¸æœ‰ç”¨ï¼šè™šæ‹Ÿæœºå¯¹ç¡¬ä»¶æœåŠ¡å™¨æ•…éšœçš„å®¹é”™èƒ½åŠ›ï¼Œé›†ç¾¤ç¡¬ä»¶èŠ‚ç‚¹ä¹‹é—´çš„å®æ—¶è¿ç§»ä»¥è¿›è¡Œç»´æŠ¤ï¼Œé›†ç¾¤èŠ‚ç‚¹ä¹‹é—´çš„æ‰‹åŠ¨æˆ–è‡ªåŠ¨è´Ÿè½½å¹³è¡¡ç­‰ã€‚ </p><br><p> å¯¹äºä¼ä¸šæ‰€è´­ç½®çš„ç¡¬ä»¶ï¼Œé«˜åº¦å¯è®¿é—®çš„VMware vSphereé›†ç¾¤çš„éƒ¨ç½²å¯ä»¥è¯´æ˜é—®é¢˜ï¼Œä½†æ˜¯ç”±äºVMwareçš„ä»»ä½•è½¯ä»¶éƒ½ä»¥å…¶é«˜æ˜‚çš„ä»·æ ¼è€Œé—»åï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç»å¯¹å…è´¹çš„è™šæ‹ŸåŒ–ç®¡ç†è½¯ä»¶<a href="https://ru.wikipedia.org/wiki/OVirt"><strong>-oVirt</strong></a> ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šä¼—æ‰€å‘¨çŸ¥çš„å·²ç»å•†ä¸šåŒ–çš„äº§å“<a href="https://ru.bmstu.wiki/RHEV_(Red_Hat_Enterprise_Virtualization)"><strong>-RHEV</strong></a> ã€‚ </p><br><p>  <strong>oVirt</strong>è½¯ä»¶æ˜¯å°†æ‰€æœ‰åŸºç¡€æ¶æ„å…ƒç´ ç»„åˆåœ¨ä¸€èµ·æ‰€å¿…éœ€çš„ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ–¹ä¾¿åœ°ä¸é«˜åº¦å¯è®¿é—®çš„è™šæ‹Ÿæœºä¸€èµ·ä½¿ç”¨-è¿™äº›è™šæ‹Ÿæœºæ˜¯æ•°æ®åº“ï¼ŒWebåº”ç”¨ç¨‹åºï¼Œä»£ç†ï¼Œå¹³è¡¡å™¨ï¼Œç”¨äºæ”¶é›†æ—¥å¿—å’Œåˆ†æçš„æœåŠ¡å™¨ç­‰ã€‚ nã€‚å³æˆ‘ä»¬ä¼ä¸šçš„Webé—¨æˆ·ç”±ä»€ä¹ˆç»„æˆã€‚ </p><br><p> æ€»ç»“æ­¤ä»‹ç»ï¼Œä»¥ä¸‹æ–‡ç« ç­‰å¾…ç€æˆ‘ä»¬ï¼Œè¿™äº›æ–‡ç« å®é™…ä¸Šå°†æ˜¾ç¤ºå¦‚ä½•éƒ¨ç½²ä¼ä¸šçš„æ•´ä¸ªç¡¬ä»¶å’Œè½¯ä»¶åŸºç¡€ç»“æ„ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æ–‡ç« æ¸…å•</b> <div class="spoiler_text"><ul><li>  <strong>ç¬¬1éƒ¨åˆ†ã€‚</strong>å‡†å¤‡éƒ¨ç½²oVirtç¾¤é›†4.3ã€‚ </li><li>  <strong>ç¬¬2éƒ¨åˆ†ã€‚</strong>å®‰è£…å’Œé…ç½®oVirtç¾¤é›†4.3ã€‚ </li><li>  <strong>ç¬¬3éƒ¨åˆ†ã€‚</strong>åœ¨VyOSè™šæ‹Ÿè·¯ç”±å™¨ä¸Šç»„ç»‡å®¹é”™è·¯ç”±ã€‚ </li><li>  <strong>ç¬¬4éƒ¨åˆ†ã€‚</strong>é…ç½®Cisco 3850å †æ ˆï¼Œç»„ç»‡å†…éƒ¨ç½‘è·¯ç”±ã€‚ </li></ul></div></div><br><h2 id="chast-1-podgotovka-k-razvyortyvaniyu-klastera-ovirt-43"> ç¬¬1éƒ¨åˆ†ã€‚å‡†å¤‡éƒ¨ç½²oVirt 4.3é›†ç¾¤ </h2><br><h3 id="bazovaya-nastroyka-hostov"> åŸºæœ¬ä¸»æœºé…ç½® </h3><br><p> å®‰è£…å’Œé…ç½®æ“ä½œç³»ç»Ÿæ˜¯æœ€ç®€å•çš„æ­¥éª¤ã€‚ å…³äºå¦‚ä½•æ­£ç¡®å®‰è£…å’Œé…ç½®æ“ä½œç³»ç»Ÿçš„æ–‡ç« å¾ˆå¤šï¼Œå› æ­¤å°è¯•ç»™å‡ºä¸€äº›æ’ä»–çš„å†…å®¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ </p><br><p> å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤å°Dell PowerEdge R640ä¸»æœºï¼Œæ‚¨éœ€è¦åœ¨å®ƒä»¬ä¸Šå®‰è£…æ“ä½œç³»ç»Ÿå¹¶æ‰§è¡Œé¢„é…ç½®ï¼Œä»¥å°†å®ƒä»¬ç”¨ä½œç®¡ç†ç¨‹åºæ¥åœ¨oVirt 4.3ç¾¤é›†ä¸­è¿è¡Œè™šæ‹Ÿæœºã€‚ </p><br><p> ç”±äºæˆ‘ä»¬è®¡åˆ’ä½¿ç”¨å…è´¹çš„éå•†ä¸šè½¯ä»¶oVirtï¼Œ <strong>å› æ­¤</strong>é€‰æ‹©<strong>CentOS 7.7</strong>æ¥éƒ¨ç½²ä¸»æœºï¼Œå°½ç®¡ä¹Ÿå¯ä»¥åœ¨oVirtçš„ä¸»æœºä¸Šå®‰è£…å…¶ä»–æ“ä½œç³»ç»Ÿï¼š </p><br><ul><li> åŸºäºRHELçš„ç‰¹æ®Šæ„å»ºï¼Œå³æ‰€è°“çš„  <a href="https://www.ovirt.org/documentation/admin-guide/chap-Hosts.html"><strong>oVirtèŠ‚ç‚¹</strong></a> ; </li><li>  OS Oracle Linuxå°†äº2019å¹´å¤å­£<a href="https://blogs.oracle.com/virtualization/announcing-oracle-linux-virtualization-manager">å®£å¸ƒ</a>æ”¯æŒoVirtçš„è¿è¡Œã€‚ </li></ul><br><p> åœ¨å®‰è£…æ“ä½œç³»ç»Ÿä¹‹å‰ï¼Œå»ºè®®ï¼š </p><br><ul><li> åœ¨ä¸¤å°ä¸»æœºä¸Šé…ç½®iDRACç½‘ç»œæ¥å£ </li><li> å°†BIOSå’ŒiDRACçš„å›ºä»¶æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼› </li><li> æœ€å¥½å°†ç³»ç»Ÿé…ç½®æ–‡ä»¶æœåŠ¡å™¨é…ç½®ä¸ºæ€§èƒ½æ¨¡å¼ï¼› </li><li> ä»æœ¬åœ°ç£ç›˜é…ç½®RAIDï¼ˆå»ºè®®ä½¿ç”¨RAID1ï¼‰ä»¥åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…OSã€‚ </li></ul><br><p> ç„¶åï¼Œæˆ‘ä»¬å°†æ“ä½œç³»ç»Ÿå®‰è£…åœ¨é€šè¿‡iDRACå…ˆå‰åˆ›å»ºçš„ç£ç›˜ä¸Š-å®‰è£…è¿‡ç¨‹æ˜¯æ­£å¸¸çš„ï¼Œå…¶ä¸­æ²¡æœ‰ç‰¹æ®Šçš„æ—¶åˆ»ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡iDRACè®¿é—®æœåŠ¡å™¨æ§åˆ¶å°ä»¥å¼€å§‹å®‰è£…æ“ä½œç³»ç»Ÿï¼Œå°½ç®¡æ²¡æœ‰ä»€ä¹ˆé˜»æ­¢æ‚¨å°†æ˜¾ç¤ºå™¨ï¼Œé”®ç›˜å’Œé¼ æ ‡ç›´æ¥è¿æ¥åˆ°æœåŠ¡å™¨ä»¥åŠä»é—ªå­˜é©±åŠ¨å™¨å®‰è£…æ“ä½œç³»ç»Ÿã€‚ </p><br><p> å®‰è£…æ“ä½œç³»ç»Ÿåï¼Œæ‰§è¡Œå…¶åˆå§‹è®¾ç½®ï¼š </p><br><pre><code class="plaintext hljs">systemctl enable network.service systemctl start network.service systemctl status network.service</code> </pre> <br><pre> <code class="plaintext hljs">systemctl stop NetworkManager systemctl disable NetworkManager systemctl status NetworkManager</code> </pre> <br><pre> <code class="plaintext hljs">yum install -y ntp systemctl enable ntpd.service systemctl start ntpd.service</code> </pre> <br><pre> <code class="plaintext hljs">cat /etc/sysconfig/selinux SELINUX=disabled SELINUXTYPE=targeted</code> </pre> <br><pre> <code class="plaintext hljs">cat /etc/security/limits.conf * soft nofile 65536 * hard nofile 65536</code> </pre> <br><pre> <code class="plaintext hljs">cat /etc/sysctl.conf vm.max_map_count = 262144 vm.swappiness = 1</code> </pre> <br><p>  <u>å®‰è£…åŸºæœ¬è½¯ä»¶</u> </p><br><p> å¯¹äºåˆå§‹æ“ä½œç³»ç»Ÿè®¾ç½®ï¼Œæ‚¨éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé…ç½®ä»»ä½•ç½‘ç»œæ¥å£ï¼Œä»¥ä¾¿å¯ä»¥è®¿é—®Internetï¼Œæ›´æ–°æ“ä½œç³»ç»Ÿå¹¶å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…ã€‚ è¿™æ—¢å¯ä»¥åœ¨å®‰è£…OSæœŸé—´ä¹Ÿå¯ä»¥åœ¨å®‰è£…OSä¹‹åè¿›è¡Œã€‚ </p><br><pre> <code class="plaintext hljs">yum -y install epel-release yum update yum -y install bind-utils yum-utils net-tools git htop iotop nmon pciutils sysfsutils sysstat mc nc rsync wget traceroute gzip unzip telnet</code> </pre> <br><p> ä»¥ä¸Šæ‰€æœ‰è®¾ç½®å’Œä¸€å¥—è½¯ä»¶éƒ½æ˜¯ä¸ªäººå–œå¥½çš„é—®é¢˜ï¼Œè¿™å¥—è½¯ä»¶ä»…ä¾›å‚è€ƒã€‚ </p><br><p> ç”±äºæˆ‘ä»¬çš„ä¸»æœºå°†æ‰®æ¼”è™šæ‹Ÿæœºç›‘æ§ç¨‹åºçš„è§’è‰²ï¼Œå› æ­¤æˆ‘ä»¬å°†å¯ç”¨æ‰€éœ€çš„æ€§èƒ½é…ç½®æ–‡ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">systemctl enable tuned systemctl start tuned systemctl status tuned</code> </pre> <br><pre> <code class="plaintext hljs">tuned-adm profile tuned-adm profile virtual-host</code> </pre> <br><p> æ‚¨å¯ä»¥åœ¨æ­¤å¤„é˜…è¯»æœ‰å…³æ€§èƒ½æ¦‚è¦æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼šâ€œ <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/virtualization_tuning_and_optimization_guide/chap-virtualization_tuning_optimization_guide-tuned">ç¬¬4ç« ã€‚tuned and tuned-adm</a> â€ã€‚ </p><br><p> å®‰è£…å®Œæ“ä½œç³»ç»Ÿåï¼Œæˆ‘ä»¬ç»§ç»­è¿›è¡Œä¸‹ä¸€éƒ¨åˆ†-åœ¨ä¸»æœºå’ŒCisco 2960Xäº¤æ¢æœºå †æ ˆä¸Šé…ç½®ç½‘ç»œæ¥å£ã€‚ </p><br><h3 id="nastroyka-steka-kommutatorov-cisco-2960x"> é…ç½®Cisco 2960Xäº¤æ¢æœºå †æ ˆ </h3><br><p> æˆ‘ä»¬çš„é¡¹ç›®å°†ä½¿ç”¨ä»¥ä¸‹æ•°é‡çš„VLAN-æˆ–å½¼æ­¤éš”ç¦»çš„å¹¿æ’­åŸŸï¼Œä»¥åˆ†ç¦»ä¸åŒç±»å‹çš„æµé‡ï¼š </p><br><p>  <strong>VLAN 10-</strong>äº’è”ç½‘ <br>  <strong>VLAN 17-</strong>ç®¡ç†ï¼ˆiDRACï¼Œå­˜å‚¨ï¼Œäº¤æ¢æœºç®¡ç†ï¼‰ <br>  <strong>VLAN 32</strong> -VMç”Ÿäº§ç½‘ç»œ <br>  <strong>VLAN 33-</strong>äº’è¿ç½‘ç»œï¼ˆåˆ°å¤–éƒ¨æ‰¿åŒ…å•†ï¼‰ <br>  <strong>VLAN 34-</strong>è™šæ‹Ÿæœºæµ‹è¯•ç½‘ç»œ <br>  <strong>VLAN 35</strong> -VMå¼€å‘äººå‘˜ç½‘ç»œ <br>  <strong>VLAN 40-</strong>ç›‘æ§ç½‘ç»œ </p><br><p> åœ¨å¼€å§‹å·¥ä½œä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨L2çº§åˆ«ä¸Šæä¾›ä¸€ä¸ªå›¾è¡¨ï¼Œæˆ‘ä»¬æœ€ç»ˆåº”è¯¥å¾—å‡ºä»¥ä¸‹å›¾è¡¨ï¼š </p><br><p><img src="https://habrastorage.org/webt/in/ak/8a/inak8aoyty8yujo2zagwdehdytg.jpeg"></p><br><p> ä¸ºäº†oVirtä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´çš„ç½‘ç»œäº¤äº’ä»¥åŠç®¡ç†æˆ‘ä»¬çš„å­˜å‚¨ï¼Œæ‚¨éœ€è¦é…ç½®Cisco 2960Xäº¤æ¢æœºå †æ ˆã€‚ </p><br><p>  Dellä¸»æœºå…·æœ‰å†…ç½®çš„4ç«¯å£ç½‘å¡ï¼Œå› æ­¤ï¼Œå»ºè®®ä½¿ç”¨å®¹é”™ç½‘ç»œè¿æ¥æ¥ç»„ç»‡å®ƒä»¬ä¸Cisco 2960Xçš„è¿æ¥ï¼Œå¹¶ä½¿ç”¨å°†ç‰©ç†ç½‘ç»œç«¯å£åˆ†ç»„ä¸ºé€»è¾‘æ¥å£å’ŒLACPåè®®ï¼ˆ802.3adï¼‰ï¼š </p><br><ul><li> ä¸»æœºä¸Šçš„å‰ä¸¤ä¸ªç«¯å£è¢«é…ç½®ä¸ºç»‘å®šæ¨¡å¼å¹¶è¿æ¥åˆ°2960Xäº¤æ¢æœº-åœ¨æ­¤é€»è¾‘æ¥å£ä¸Šï¼Œå°†é…ç½®ä¸€ä¸ªå…·æœ‰ç”¨äºç®¡ç†ä¸»æœºï¼Œç›‘è§†ï¼Œä¸oVirté›†ç¾¤ä¸­å…¶ä»–ä¸»æœºè¿›è¡Œé€šä¿¡çš„åœ°å€çš„<strong><em>ç½‘æ¡¥</em></strong> ï¼Œè¿˜å°†ç”¨äºè™šæ‹Ÿæœºçš„å®æ—¶è¿ç§»; </li><li> ä¸»æœºä¸Šçš„åä¸¤ä¸ªç«¯å£ä¹Ÿé…ç½®ä¸ºç»‘å®šæ¨¡å¼ï¼Œå¹¶è¿æ¥åˆ°2960X-ä½¿ç”¨oVirtåœ¨æ­¤é€»è¾‘æ¥å£ä¸Šï¼Œå°†åœ¨ä»¥åçš„ç½‘æ¡¥ä¸­ï¼ˆåœ¨ç›¸åº”çš„VLANä¸­ï¼‰åˆ›å»ºå°†è™šæ‹Ÿæœºè¿æ¥åˆ°çš„ç½‘æ¡¥ã€‚ </li><li> åŒä¸€é€»è¾‘æ¥å£å†…çš„ä¸¤ä¸ªç½‘ç»œç«¯å£éƒ½å°†å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œå³ å®ƒä»¬ä¹‹é—´çš„æµé‡å¯ä»¥ä»¥å¹³è¡¡æ¨¡å¼åŒæ—¶ä¼ è¾“ã€‚ </li><li> ç¾¤é›†èŠ‚ç‚¹ä¸Šçš„ç½‘ç»œè®¾ç½®å¿…é¡»å®Œå…¨ç›¸åŒï¼Œä½†IPåœ°å€é™¤å¤–ã€‚ </li></ul><br><p>  <u><strong>2960X</strong>äº¤æ¢æœº<strong>å †æ ˆ</strong>åŠå…¶ç«¯å£çš„åŸºæœ¬é…ç½®</u> </p><br><p> ä»¥å‰ï¼Œæˆ‘ä»¬çš„å¼€å…³åº”ä¸ºï¼š </p><br><ul><li> å®‰è£…åœ¨æœºæ¶ä¸­ï¼› </li><li> é€šè¿‡ä¸¤æ¡æ‰€éœ€é•¿åº¦çš„ç‰¹æ®Šç”µç¼†è¿æ¥ï¼Œä¾‹å¦‚CAB-STK-E-1Mï¼› </li><li> è¿æ¥ç”µæºï¼› </li><li> é€šè¿‡æ§åˆ¶å°ç«¯å£è¿æ¥åˆ°ç®¡ç†å‘˜çš„å·¥ä½œç«™ï¼Œä»¥è¿›è¡Œåˆå§‹é…ç½®ã€‚ </li></ul><br><p> æœ‰å…³æ­¤é—®é¢˜çš„å¿…è¦æŒ‡å—ï¼Œè¯·å‚è§åˆ¶é€ å•†çš„<a href="https://www.cisco.com/c/en/us/support/switches/catalyst-2960-x-series-switches/products-installation-guides-list.html">å®˜æ–¹é¡µé¢</a> ã€‚ </p><br><p> å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œé…ç½®äº¤æ¢æœºã€‚ <br> æ¯ä¸ªå›¢é˜Ÿçš„å«ä¹‰éƒ½ä¸åº”åœ¨æœ¬æ–‡çš„æ¡†æ¶å†…è§£å¯†ï¼›å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥ç‹¬ç«‹æ‰¾åˆ°æ‰€æœ‰ä¿¡æ¯ã€‚ <br> æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°½å¿«é…ç½®äº¤æ¢æœºå †æ ˆï¼Œå¹¶å°†ä¸»æœºå’Œå­˜å‚¨ç®¡ç†æ¥å£è¿æ¥åˆ°è¯¥å †æ ˆã€‚ </p><br><p>  1ï¼‰è¿æ¥åˆ°ä¸»äº¤æ¢æœºï¼Œè¿›å…¥ç‰¹æƒæ¨¡å¼ï¼Œç„¶åè¿›å…¥é…ç½®æ¨¡å¼å¹¶è¿›è¡ŒåŸºæœ¬è®¾ç½®ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">åŸºæœ¬å¼€å…³é…ç½®ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> enable configure terminal hostname 2960X no service pad service timestamps debug datetime msec service timestamps log datetime localtime show-timezone msec no service password-encryption service sequence-numbers switch 1 priority 15 switch 2 priority 14 stack-mac persistent timer 0 clock timezone MSK 3 vtp mode transparent ip subnet-zero vlan 17 name Management vlan 32 name PROD vlan 33 name Interconnect vlan 34 name Test vlan 35 name Dev vlan 40 name Monitoring spanning-tree mode rapid-pvst spanning-tree etherchannel guard misconfig spanning-tree portfast bpduguard default spanning-tree extend system-id spanning-tree vlan 1-40 root primary spanning-tree loopguard default vlan internal allocation policy ascending port-channel load-balance src-dst-ip errdisable recovery cause loopback errdisable recovery cause bpduguard errdisable recovery interval 60 line con 0 session-timeout 60 exec-timeout 60 0 logging synchronous line vty 5 15 session-timeout 60 exec-timeout 60 0 logging synchronous ip http server ip http secure-server no vstack interface Vlan1 no ip address shutdown exit</code> </pre></div></div><br><p> æˆ‘ä»¬ä½¿ç”¨<strong>wr mem</strong>å‘½ä»¤ä¿å­˜é…ç½®ï¼Œå¹¶ä½¿ç”¨ä¸»äº¤æ¢æœº1ä¸Šçš„<strong>reload</strong>å‘½ä»¤é‡æ–°åŠ è½½äº¤æ¢æœºå †æ ˆã€‚ </p><br><p>  2ï¼‰åœ¨VLAN 17ä¸­ä»¥è®¿é—®æ¨¡å¼é…ç½®äº¤æ¢æœºçš„ç½‘ç»œç«¯å£ï¼Œä»¥è¿æ¥å­˜å‚¨å’ŒiDRACæœåŠ¡å™¨çš„ç®¡ç†æ¥å£ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ç®¡ç†ç«¯å£è®¾ç½®ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">interface GigabitEthernet1/0/5 description iDRAC - host1 switchport access vlan 17 switchport mode access spanning-tree portfast edge interface GigabitEthernet1/0/6 description Storage1 - Cntr0/Eth0 switchport access vlan 17 switchport mode access spanning-tree portfast edge interface GigabitEthernet2/0/5 description iDRAC - host2 switchport access vlan 17 switchport mode access spanning-tree portfast edge interface GigabitEthernet2/0/6 description Storage1 â€“ Cntr1/Eth0 switchport access vlan 17 switchport mode access spanning-tree portfast edge exit</code> </pre> </div></div><br><p>  3ï¼‰é‡æ–°å¯åŠ¨å †æ ˆåï¼Œæ£€æŸ¥å…¶æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æ£€æŸ¥å †æ ˆæ“ä½œï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">2960X#show switch stack-ring speed Stack Ring Speed : 20G Stack Ring Configuration: Full Stack Ring Protocol : FlexStack 2960X#show switch stack-ports Switch # Port 1 Port 2 -------- ------ ------ 1 Ok Ok 2 Ok Ok 2960X#show switch neighbors Switch # Port 1 Port 2 -------- ------ ------ 1 2 2 2 1 1 2960X#show switch detail Switch/Stack Mac Address : 0cd0.f8e4. Mac persistency wait time: Indefinite H/W Current Switch# Role Mac Address Priority Version State ---------------------------------------------------------- *1 Master 0cd0.f8e4. 15 4 Ready 2 Member 0029.c251. 14 4 Ready Stack Port Status Neighbors Switch# Port 1 Port 2 Port 1 Port 2 -------------------------------------------------------- 1 Ok Ok 2 2 2 Ok Ok 1 1</code> </pre> </div></div><br><p>  4ï¼‰é…ç½®å¯¹2960Xå †æ ˆçš„SSHè®¿é—® </p><br><p> å¯¹äºé€šè¿‡SSHè¿›è¡Œçš„è¿œç¨‹å †æ ˆç®¡ç†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åœ¨SVIï¼ˆäº¤æ¢æœºè™šæ‹Ÿæ¥å£ï¼‰ <strong>VLAN17</strong>ä¸Šé…ç½®çš„IP 172.20.1.10ã€‚ </p><br><p> å°½ç®¡å‡ºäºç®¡ç†ç›®çš„ï¼Œå»ºè®®åœ¨äº¤æ¢æœºä¸Šä½¿ç”¨ç‰¹æ®Šçš„ä¸“ç”¨ç«¯å£ï¼Œä½†è¿™æ˜¯ä¸ªäººå–œå¥½å’Œæœºä¼šçš„é—®é¢˜ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é…ç½®å¯¹äº¤æ¢æœºå †æ ˆçš„SSHè®¿é—®ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">ip default-gateway 172.20.1.2 interface vlan 17 ip address 172.20.1.10 255.255.255.0 hostname 2960X ip domain-name hw.home-lab.ru no ip domain-lookup clock set 12:47:04 06 Dec 2019 crypto key generate rsa ip ssh version 2 ip ssh time-out 90 line vty 0 4 session-timeout 60 exec-timeout 60 0 privilege level 15 logging synchronous transport input ssh line vty 5 15 session-timeout 60 exec-timeout 60 0 privilege level 15 logging synchronous transport input ssh aaa new-model aaa authentication login default local username cisco privilege 15 secret my_ssh_password</code> </pre> </div></div><br><p> é…ç½®å¯†ç ä»¥è¿›å…¥ç‰¹æƒæ¨¡å¼ï¼š </p><br><pre> <code class="plaintext hljs">enable secret *myenablepassword* service password-encryption</code> </pre> <br><p> é…ç½®NTPï¼š </p><br><pre> <code class="plaintext hljs">ntp server 85.21.78.8 prefer ntp server 89.221.207.113 ntp server 185.22.60.71 ntp server 192.36.143.130 ntp server 185.209.85.222 show ntp status show ntp associations show clock detail</code> </pre> <br><p>  5ï¼‰é…ç½®ä»¥å¤ªé€šé“é€»è¾‘æ¥å£å’Œè¿æ¥åˆ°ä¸»æœºçš„ç‰©ç†ç«¯å£ã€‚ ä¸ºäº†ç®€åŒ–é…ç½®ï¼Œæ‰€æœ‰é€»è¾‘æ¥å£ä¸Šéƒ½å°†å…è®¸æ‰€æœ‰å¯ç”¨çš„VLANï¼Œä½†æ˜¯é€šå¸¸å»ºè®®ä»…é…ç½®æ‰€éœ€çš„VLANï¼š </p><br><div class="spoiler">  <b class="spoiler_title">é…ç½®ä»¥å¤ªé€šé“æ¥å£ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">interface Port-channel1 description EtherChannel with Host1-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk spanning-tree portfast edge trunk interface Port-channel2 description EtherChannel with Host2-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk spanning-tree portfast edge trunk interface Port-channel3 description EtherChannel with Host1-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk spanning-tree portfast edge trunk interface Port-channel4 description EtherChannel with Host2-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk spanning-tree portfast edge trunk interface GigabitEthernet1/0/1 description Host1-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 1 mode active interface GigabitEthernet1/0/2 description Host2-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 2 mode active interface GigabitEthernet1/0/3 description Host1-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 3 mode active interface GigabitEthernet1/0/4 description Host2-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 4 mode active interface GigabitEthernet2/0/1 description Host1-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 1 mode active interface GigabitEthernet2/0/2 description Host2-management switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 2 mode active interface GigabitEthernet2/0/3 description Host1-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 3 mode active interface GigabitEthernet2/0/4 description Host2-VM switchport trunk allowed vlan 10,17,30-40 switchport mode trunk channel-protocol lacp channel-group 4 mode active</code> </pre> </div></div><br><p>  <u>ä¸»æœº1å’Œ<strong>ä¸»æœº2</strong>ä¸Šè™šæ‹Ÿæœºçš„ç½‘ç»œæ¥å£çš„åˆå§‹é…ç½®</u> </p><br><p> æˆ‘ä»¬æ£€æŸ¥ç³»ç»Ÿä¸­ç”¨äºç»‘å®šçš„å¿…è¦æ¨¡å—çš„å¯ç”¨æ€§ï¼Œå®‰è£…ç”¨äºç®¡ç†ç½‘æ¡¥çš„æ¨¡å—ï¼š </p><br><pre> <code class="plaintext hljs">modinfo bonding modinfo 8021q yum install bridge-utils</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">ä¸ºä¸»æœºä¸Šçš„è™šæ‹ŸæœºåŠå…¶ç‰©ç†æ¥å£é…ç½®BOND1é€»è¾‘æ¥å£ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">cat /etc/sysconfig/network-scripts/ifcfg-bond1 #DESCRIPTION - management DEVICE=bond1 NAME=bond1 TYPE=Bond IPV6INIT=no ONBOOT=yes USERCTL=no NM_CONTROLLED=no BOOTPROTO=none BONDING_OPTS='mode=4 lacp_rate=1 xmit_hash_policy=2' cat /etc/sysconfig/network-scripts/ifcfg-em2 #DESCRIPTION - management DEVICE=em2 TYPE=Ethernet BOOTPROTO=none ONBOOT=yes MASTER=bond1 SLAVE=yes USERCTL=no NM_CONTROLLED=no cat /etc/sysconfig/network-scripts/ifcfg-em3 #DESCRIPTION - management DEVICE=em3 TYPE=Ethernet BOOTPROTO=none ONBOOT=yes MASTER=bond1 SLAVE=yes USERCTL=no NM_CONTROLLED=no</code> </pre> </div></div><br><p> åœ¨<strong>2960X</strong>å †æ ˆå’Œä¸»æœºä¸Šå®Œæˆè®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä¸»æœºä¸Šé‡æ–°å¯åŠ¨ç½‘ç»œå¹¶æ£€æŸ¥é€»è¾‘æ¥å£ã€‚ </p><br><ul><li> åœ¨ä¸»æœºä¸Šï¼š </li></ul><br><pre> <code class="plaintext hljs">systemctl restart network cat /proc/net/bonding/bond1 Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011) Bonding Mode: IEEE 802.3ad Dynamic link aggregation Transmit Hash Policy: layer2+3 (2) MII Status: up MII Polling Interval (ms): 100 Up Delay (ms): 0 Down Delay (ms): 0 ... 802.3ad info LACP rate: fast Min links: 0 Aggregator selection policy (ad_select): stable System priority: 65535 ... Slave Interface: em2 MII Status: up Speed: 1000 Mbps Duplex: full ... Slave Interface: em3 MII Status: up Speed: 1000 Mbps Duplex: full</code> </pre> <br><ul><li> åœ¨<strong>2960X</strong>äº¤æ¢æœº<strong>å †æ ˆä¸Š</strong> ï¼š </li></ul><br><pre> <code class="plaintext hljs">2960X#show lacp internal Flags: S - Device is requesting Slow LACPDUs F - Device is requesting Fast LACPDUs A - Device is in Active mode P - Device is in Passive mode Channel group 1 LACP port Admin Oper Port Port Port Flags State Priority Key Key Number State Gi1/0/1 SA bndl 32768 0x1 0x1 0x102 0x3D Gi2/0/1 SA bndl 32768 0x1 0x1 0x202 0x3D 2960X#sh etherchannel summary Flags: D - down P - bundled in port-channel I - stand-alone s - suspended H - Hot-standby (LACP only) R - Layer3 S - Layer2 U - in use N - not in use, no aggregation f - failed to allocate aggregator M - not in use, minimum links not met m - not in use, port not aggregated due to minimum links not met u - unsuitable for bundling w - waiting to be aggregated d - default port A - formed by Auto LAG Number of channel-groups in use: 11 Number of aggregators: 11 Group Port-channel Protocol Ports ------+-------------+-----------+----------------------------------------------- 1 Po1(SU) LACP Gi1/0/1(P) Gi2/0/1(P)</code> </pre> <br><p> ç”¨äºç®¡ç†<strong>Host1</strong>å’Œ<strong>Host2</strong>ä¸Šçš„ç¾¤é›†èµ„æºçš„ç½‘ç»œæ¥å£çš„åˆå§‹é…ç½® </p><br><div class="spoiler">  <b class="spoiler_title">åœ¨ä¸»æœºä¸Šé…ç½®ç”¨äºç®¡ç†çš„BOND1é€»è¾‘æ¥å£åŠå…¶ç‰©ç†æ¥å£ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">cat /etc/sysconfig/network-scripts/ifcfg-bond0 #DESCRIPTION - management DEVICE=bond0 NAME=bond0 TYPE=Bond BONDING_MASTER=yes IPV6INIT=no ONBOOT=yes USERCTL=no NM_CONTROLLED=no BOOTPROTO=none BONDING_OPTS='mode=4 lacp_rate=1 xmit_hash_policy=2' cat /etc/sysconfig/network-scripts/ifcfg-em0 #DESCRIPTION - management DEVICE=em0 TYPE=Ethernet BOOTPROTO=none ONBOOT=yes MASTER=bond0 SLAVE=yes USERCTL=no NM_CONTROLLED=no cat /etc/sysconfig/network-scripts/ifcfg-em1 #DESCRIPTION - management DEVICE=em1 TYPE=Ethernet BOOTPROTO=none ONBOOT=yes MASTER=bond0 SLAVE=yes USERCTL=no NM_CONTROLLED=no</code> </pre> </div></div><br><p> åœ¨<strong>2960X</strong>å †æ ˆå’Œä¸»æœºä¸Šå®Œæˆè®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä¸»æœºä¸Šé‡æ–°å¯åŠ¨ç½‘ç»œå¹¶æ£€æŸ¥é€»è¾‘æ¥å£ã€‚ </p><br><pre> <code class="plaintext hljs">systemctl restart network cat /proc/net/bonding/bond1 2960X#show lacp internal 2960X#sh etherchannel summary</code> </pre> <br><p> æˆ‘ä»¬åœ¨<strong>VLAN 17ä¸­çš„</strong>æ¯ä¸ªä¸»æœºä¸Šé…ç½®æ§åˆ¶ç½‘ç»œæ¥å£ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°é€»è¾‘æ¥å£BOND1ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">åœ¨Host1ä¸Šé…ç½®VLAN17ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">cat /etc/sysconfig/network-scripts/ifcfg-bond1.17 DEVICE=bond1.17 NAME=bond1-vlan17 BOOTPROTO=none ONBOOT=yes USERCTL=no NM_CONTROLLED=no VLAN=yes MTU=1500 IPV4_FAILURE_FATAL=yes IPV6INIT=no IPADDR=172.20.1.163 NETMASK=255.255.255.0 GATEWAY=172.20.1.2 DEFROUTE=yes DNS1=172.20.1.8 DNS2=172.20.1.9 ZONE=public</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">åœ¨Host2ä¸Šé…ç½®VLAN17ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">cat /etc/sysconfig/network-scripts/ifcfg-bond1.17 DEVICE=bond1.17 NAME=bond1-vlan17 BOOTPROTO=none ONBOOT=yes USERCTL=no NM_CONTROLLED=no VLAN=yes MTU=1500 IPV4_FAILURE_FATAL=yes IPV6INIT=no IPADDR=172.20.1.164 NETMASK=255.255.255.0 GATEWAY=172.20.1.2 DEFROUTE=yes DNS1=172.20.1.8 DNS2=172.20.1.9 ZONE=public</code> </pre> </div></div><br><p> æˆ‘ä»¬åœ¨ä¸»æœºä¸Šé‡æ–°å¯åŠ¨ç½‘ç»œï¼Œå¹¶æ£€æŸ¥å®ƒä»¬ä¹‹é—´çš„å¯è§æ€§ã€‚ </p><br><p> è¿™æ ·å°±å®Œæˆäº†Cisco 2960Xäº¤æ¢æœºå †æ ˆçš„è®¾ç½®ï¼Œå¦‚æœä¸€åˆ‡éƒ½æ­£ç¡®å®Œæˆï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨L2çº§åˆ«å°†æ‰€æœ‰åŸºç¡€æ¶æ„å…ƒç´ ç›¸äº’è¿æ¥èµ·æ¥ã€‚ </p><br><h3 id="nastroyka-shd-dell-md3820f"> é…ç½®Dell MD3820få­˜å‚¨ </h3><br><p> åœ¨å¼€å§‹è®¾ç½®å­˜å‚¨ç³»ç»Ÿä¹‹å‰ï¼Œå®ƒåº”è¯¥å·²ç»é€šè¿‡ç®¡ç†æ¥å£è¿æ¥åˆ°Cisco <strong>2960X</strong>äº¤æ¢æœºå †æ ˆï¼Œå¹¶ä¸”<strong>å·²ç»</strong>é€šè¿‡FCè¿æ¥åˆ°<strong>Host1</strong>å’Œ<strong>Host2ä¸»æœº</strong> ã€‚ </p><br><p> ä¸Šä¸€ç« ä¸­ç»™å‡ºäº†å¦‚ä½•å°†å­˜å‚¨è¿æ¥åˆ°äº¤æ¢æœºå †æ ˆçš„ä¸€èˆ¬æ–¹æ¡ˆã€‚ </p><br><p> å°†FCä¸Šçš„å­˜å‚¨è¿æ¥åˆ°ä¸»æœºçš„æ–¹æ¡ˆåº”å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><p><img src="https://habrastorage.org/webt/el/k8/5a/elk85aqc6ilmxeiowmh6acrkwri.jpeg"></p><br><p> åœ¨è¿æ¥æœŸé—´ï¼Œå¿…é¡»è®°å½•è¿æ¥åˆ°å­˜å‚¨ç³»ç»Ÿä¸ŠFCç«¯å£çš„FC HBAä¸»æœºçš„WWPNåœ°å€-è¿™å¯¹äºåç»­é…ç½®ä¸»æœºåˆ°å­˜å‚¨ç³»ç»Ÿä¸ŠLUNçš„ç»‘å®šå°†æ˜¯å¿…éœ€çš„ã€‚ </p><br><p> åœ¨ç®¡ç†å‘˜çš„å·¥ä½œç«™ä¸Šï¼Œä¸‹è½½å¹¶å®‰è£…Dell MD3820få­˜å‚¨ç®¡ç†å®ç”¨ç¨‹åº-PowerVault <strong>æ¨¡å—åŒ–ç£ç›˜å­˜å‚¨ç®¡ç†å™¨</strong> ï¼ˆ <strong>MDSM</strong> ï¼‰ã€‚ <br> æˆ‘ä»¬é€šè¿‡å…¶é»˜è®¤IPåœ°å€è¿æ¥åˆ°å®ƒï¼Œç„¶åé…ç½®<strong>VLAN17ä¸­</strong>çš„åœ°å€ä»¥é€šè¿‡TCP / IPæ§åˆ¶æ§åˆ¶å™¨ï¼š </p><br><p>  <strong>å­˜å‚¨1</strong> ï¼š </p><br><pre> <code class="plaintext hljs">ControllerA IP - 172.20.1.13, MASK - 255.255.255.0, Gateway - 172.20.1.2 ControllerB IP - 172.20.1.14, MASK - 255.255.255.0, Gateway - 172.20.1.2</code> </pre> <br><p> è®¾ç½®åœ°å€åï¼Œè¿›å…¥å­˜å‚¨ç®¡ç†ç•Œé¢å¹¶è®¾ç½®å¯†ç ï¼Œè®¾ç½®æ—¶é—´ï¼Œå¦‚æœ‰å¿…è¦ï¼Œæ›´æ–°æ§åˆ¶å™¨å’Œç£ç›˜çš„å›ºä»¶ç­‰ã€‚ <br> å­˜å‚¨<a href="https://www.dell.com/support/manuals/ru/ru/rubsdc/powervault-md3820f/mdseriesagpub/introduction%3Fguid%3Dguid-51208376-0df9-48a8-be66-63c1b06512ae%26lang%3Den-us">ç®¡ç†æŒ‡å—ä¸­</a>ä»‹ç»äº†å¦‚ä½•å®Œæˆæ­¤æ“ä½œã€‚ </p><br><p> å®Œæˆä¸Šè¿°è®¾ç½®åï¼Œæˆ‘ä»¬å°†åªéœ€è¦æ‰§è¡Œä¸€äº›æ“ä½œï¼š </p><br><ol><li> é…ç½®<strong>ä¸»æœº</strong> FC <strong>æ ‡è¯†ç¬¦</strong> ã€‚ </li><li> åˆ›å»ºä¸€ä¸ªä¸»æœºç»„- <strong>ä¸»æœºç»„ï¼Œ</strong>ç„¶åå°†æˆ‘ä»¬çš„ä¸¤ä¸ªDellä¸»æœºæ·»åŠ åˆ°å…¶ä¸­ã€‚ </li><li> åˆ›å»ºä¸€ä¸ªç£ç›˜ç»„å’Œå…¶ä¸­çš„è™šæ‹Ÿç£ç›˜ï¼ˆæˆ–LUNï¼‰ï¼Œè¿™äº›ç£ç›˜ç»„å°†æ˜¾ç¤ºç»™ä¸»æœºã€‚ </li><li> ä¸ºä¸»æœºé…ç½®è™šæ‹Ÿç£ç›˜ï¼ˆæˆ–LUNï¼‰çš„è¡¨ç¤ºã€‚ </li></ol><br><p> é€šè¿‡èœå•- <strong>ä¸»æœºæ˜ å°„</strong> -&gt; <strong>å®šä¹‰</strong> -&gt; <strong>ä¸»æœº...</strong>å‘å…¶æ·»åŠ æ–°ä¸»æœºå’Œä¸»æœºFCç«¯å£çš„ç»‘å®šæ ‡è¯†ç¬¦<strong>ã€‚</strong> <br> ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨iDRACæœåŠ¡å™¨ä¸­æ‰¾åˆ°FC HBAä¸»æœºçš„WWPNåœ°å€ã€‚ </p><br><p> ç»“æœï¼Œæˆ‘ä»¬åº”è¯¥å¾—åˆ°è¿™æ ·çš„ä¸œè¥¿ï¼š </p><br><p><img src="https://habrastorage.org/webt/p_/uk/u4/p_uku4o-ewgqpyi0xudxqjesfjc.png"></p><br><p> é€šè¿‡èœå•- <strong>ä¸»æœºæ˜ å°„</strong> -&gt; <strong>å®šä¹‰</strong> -&gt; <strong>ä¸»æœºç»„...</strong>æ·»åŠ æ–°çš„ä¸»æœºç»„å¹¶å°†ä¸»æœºç»‘å®šåˆ°<strong>ä¸»æœºã€‚</strong> <br> å¯¹äºä¸»æœºï¼Œé€‰æ‹©OS- <strong><em>Linuxï¼ˆDM-MPï¼‰çš„ç±»å‹</em></strong> ã€‚ </p><br><p> åˆ›å»ºä¸»æœºç»„åï¼Œé€šè¿‡â€œ <strong>å­˜å‚¨å’Œå¤åˆ¶æœåŠ¡â€</strong>é€‰é¡¹å¡ï¼Œåˆ›å»ºä¸€ä¸ªç£ç›˜ç»„<strong>-Disk Group</strong> ï¼Œå…¶ç±»å‹å–å†³äºå®¹é”™è¦æ±‚ï¼ˆä¾‹å¦‚RAID10ï¼‰ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­å…·æœ‰æ­£ç¡®å¤§å°çš„è™šæ‹Ÿç£ç›˜ï¼š </p><br><p><img src="https://habrastorage.org/webt/ue/g2/kn/ueg2kn0m3usv1kb4tygvx2vajz0.png"></p><br><p> æœ€åï¼Œæœ€åä¸€æ­¥æ˜¯ä¸ºä¸»æœºæä¾›è™šæ‹Ÿç£ç›˜ï¼ˆæˆ–LUNï¼‰ã€‚ <br> ä¸ºæ­¤ï¼Œé€šè¿‡èœå•- <strong>ä¸»æœºæ˜ å°„</strong> -&gt; <strong>Lunæ˜ å°„</strong> -&gt; <strong>æ·»åŠ ...ï¼Œ</strong>æˆ‘ä»¬å°†è™šæ‹Ÿç£ç›˜ç»‘å®šåˆ°ä¸»æœºï¼Œå¹¶ä¸ºå…¶åˆ†é…ç¼–å·ã€‚ </p><br><p> ä¸€åˆ‡åº”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š </p><br><p><img src="https://habrastorage.org/webt/db/a-/xq/dba-xqbacgrjxrutupvhvmua7ro.png"></p><br><p> æˆ‘ä»¬å·²ç»å®Œæˆäº†å­˜å‚¨ç³»ç»Ÿçš„é…ç½®ï¼Œå¦‚æœä¸€åˆ‡éƒ½æ­£ç¡®å®Œæˆï¼Œåˆ™ä¸»æœºåº”è¯¥å¯ä»¥é€šè¿‡å…¶FC HBAçœ‹åˆ°æä¾›ç»™å®ƒä»¬çš„LUNã€‚ <br> ä½¿ç³»ç»Ÿæ›´æ–°æœ‰å…³æ˜ å°„é©±åŠ¨å™¨çš„ä¿¡æ¯ï¼š </p><br><pre> <code class="plaintext hljs">ls -la /sys/class/scsi_host/ echo "- - -" &gt; /sys/class/scsi_host/host[0-9]/scan</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è®©æˆ‘ä»¬çœ‹çœ‹å“ªäº›è®¾å¤‡åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šå¯è§ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">cat /proc/scsi/scsi Attached devices: Host: scsi0 Channel: 02 Id: 00 Lun: 00 Vendor: DELL Model: PERC H330 Mini Rev: 4.29 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi15 Channel: 00 Id: 00 Lun: 00 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi15 Channel: 00 Id: 00 Lun: 01 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi15 Channel: 00 Id: 00 Lun: 04 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi15 Channel: 00 Id: 00 Lun: 11 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi15 Channel: 00 Id: 00 Lun: 31 Vendor: DELL Model: Universal Xport Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi18 Channel: 00 Id: 00 Lun: 00 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi18 Channel: 00 Id: 00 Lun: 01 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi18 Channel: 00 Id: 00 Lun: 04 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi18 Channel: 00 Id: 00 Lun: 11 Vendor: DELL Model: MD38xxf Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 Host: scsi18 Channel: 00 Id: 00 Lun: 31 Vendor: DELL Model: Universal Xport Rev: 0825 Type: Direct-Access ANSI SCSI revision: 05 lsscsi [0:2:0:0] disk DELL PERC H330 Mini 4.29 /dev/sda [15:0:0:0] disk DELL MD38xxf 0825 - [15:0:0:1] disk DELL MD38xxf 0825 /dev/sdb [15:0:0:4] disk DELL MD38xxf 0825 /dev/sdc [15:0:0:11] disk DELL MD38xxf 0825 /dev/sdd [15:0:0:31] disk DELL Universal Xport 0825 - [18:0:0:0] disk DELL MD38xxf 0825 - [18:0:0:1] disk DELL MD38xxf 0825 /dev/sdi [18:0:0:4] disk DELL MD38xxf 0825 /dev/sdj [18:0:0:11] disk DELL MD38xxf 0825 /dev/sdk [18:0:0:31] disk DELL Universal Xport 0825 -</code> </pre> </div></div><br><p> æ‚¨è¿˜å¯ä»¥åœ¨ä¸»æœºä¸Šé…ç½®<strong>å¤šè·¯å¾„</strong> ï¼Œå°½ç®¡å®‰è£…oVirtæ—¶ä»–å¯ä»¥è‡ªå·±è¿›è¡Œï¼Œä½†æ˜¯æœ€å¥½äº‹å…ˆè‡ªå·±æ£€æŸ¥MPã€‚ </p><br><p>  <u>å®‰è£…å’Œé…ç½®DM Multipath</u> </p><br><pre> <code class="plaintext hljs">yum install device-mapper-multipath mpathconf --enable --user_friendly_names y cat /etc/multipath.conf | egrep -v "^\s*(#|$)" defaults { user_friendly_names yes find_multipaths yes } blacklist { wwid 26353900f02796769 devnode "^(ram|raw|loop|fd|md|dm-|sr|scd|st)[0-9]*" devnode "^hd[az]" }</code> </pre> <br><p> ä»¥è‡ªåŠ¨å¯åŠ¨æ–¹å¼å®‰è£…MPæœåŠ¡å¹¶è¿è¡Œå®ƒï¼š </p><br><pre> <code class="plaintext hljs">systemctl enable multipathd &amp;&amp; systemctl restart multipathd</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æ£€æŸ¥æœ‰å…³ç”¨äºMPæ“ä½œçš„å·²åŠ è½½æ¨¡å—çš„ä¿¡æ¯ï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">lsmod | grep dm_multipath dm_multipath 27792 6 dm_service_time dm_mod 124407 139 dm_multipath,dm_log,dm_mirror modinfo dm_multipath filename: /lib/modules/3.10.0-957.12.2.el7.x86_64/kernel/drivers/md/dm-multipath.ko.xz license: GPL author: Sistina Software &lt;dm-devel@redhat.com&gt; description: device-mapper multipath target retpoline: Y rhelversion: 7.6 srcversion: 985A03DCAF053D4910E53EE depends: dm-mod intree: Y vermagic: 3.10.0-957.12.2.el7.x86_64 SMP mod_unload modversions signer: CentOS Linux kernel signing key sig_key: A3:2D:39:46:F2:D3:58:EA:52:30:1F:63:37:8A:37:A5:54:03:00:45 sig_hashalgo: sha256</code> </pre> </div></div><br><p> è¯·å‚é˜…ç°æœ‰å¤šè·¯å¾„é…ç½®æ‘˜è¦ï¼š </p><br><pre> <code class="plaintext hljs">mpathconf multipath is enabled find_multipaths is disabled user_friendly_names is disabled dm_multipath module is loaded multipathd is running</code> </pre> <br><p> å°†æ–°çš„LUNæ·»åŠ åˆ°å­˜å‚¨å¹¶å°†å…¶å‘ˆç°ç»™ä¸»æœºåï¼Œæœ‰å¿…è¦å¯¹å…¶è¿æ¥åˆ°HBAä¸»æœºçš„ç£ç›˜è¿›è¡Œæ‰«æã€‚ </p><br><pre> <code class="plaintext hljs">systemctl reload multipathd multipath -v2</code> </pre> <br><p> æœ€åï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æ‰€æœ‰LUNéƒ½å‡ºç°åœ¨ä¸»æœºçš„å­˜å‚¨ä¸­ï¼Œä»¥åŠæ˜¯å¦éƒ½æœ‰ä¸¤æ¡è·¯å¾„ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æ£€æŸ¥MPæ“ä½œï¼š</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">multipath -ll 3600a098000e4b4b3000003175cec1840 dm-2 DELL ,MD38xxf size=2.0T features='3 queue_if_no_path pg_init_retries 50' hwhandler='1 rdac' wp=rw |-+- policy='service-time 0' prio=14 status=active | `- 15:0:0:1 sdb 8:16 active ready running `-+- policy='service-time 0' prio=9 status=enabled `- 18:0:0:1 sdi 8:128 active ready running 3600a098000e4b48f000002ab5cec1921 dm-6 DELL ,MD38xxf size=10T features='3 queue_if_no_path pg_init_retries 50' hwhandler='1 rdac' wp=rw |-+- policy='service-time 0' prio=14 status=active | `- 18:0:0:11 sdk 8:160 active ready running `-+- policy='service-time 0' prio=9 status=enabled `- 15:0:0:11 sdd 8:48 active ready running 3600a098000e4b4b3000003c95d171065 dm-3 DELL ,MD38xxf size=150G features='3 queue_if_no_path pg_init_retries 50' hwhandler='1 rdac' wp=rw |-+- policy='service-time 0' prio=14 status=active | `- 15:0:0:4 sdc 8:32 active ready running `-+- policy='service-time 0' prio=9 status=enabled `- 18:0:0:4 sdj 8:144 active ready running</code> </pre> </div></div><br><p> å¦‚æ‚¨æ‰€è§ï¼Œå­˜å‚¨ç³»ç»Ÿä¸Šçš„æ‰€æœ‰ä¸‰ä¸ªè™šæ‹Ÿç£ç›˜éƒ½ä»¥ä¸¤ç§æ–¹å¼å¯è§ã€‚ è‡³æ­¤ï¼Œæ‰€æœ‰å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç»§ç»­è¿›è¡Œä¸»è¦éƒ¨åˆ†-è®¾ç½®oVirté›†ç¾¤ï¼Œå°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è¿›è¡Œè®¨è®ºã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483980/">https://habr.com/ru/post/zh-CN483980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483964/index.html">ä¸è¦æ‹…å¿ƒJSONæˆ–æ‚¨çš„ç¬¬ä¸€ä¸ªAPIåº”ç”¨ç¨‹åº</a></li>
<li><a href="../zh-CN483972/index.html">å¦‚ä½•ä½¿ç”¨Quoraä¿ƒè¿›æ‚¨çš„ä¸šåŠ¡</a></li>
<li><a href="../zh-CN483974/index.html">é€šè¿‡iSCSIè¿›è¡Œçš„Ceph-æˆ–ç«™åœ¨åŠåºŠä¸Šæ»‘é›ª</a></li>
<li><a href="../zh-CN483976/index.html">2020å¹´çš„ç½‘ç»œå®‰å…¨å’Œå¨èƒï¼šå‡æœŸè¿‡åæˆ‘ä»¬ç­‰å¾…ç€ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN483978/index.html">äº†è§£2020å¹´ç°ä»£Web Appå¼€å‘çš„æ¦‚å¿µ</a></li>
<li><a href="../zh-CN483986/index.html">ç”¨Emotiv Insightæ¥æ§åˆ¶æœºå™¨äººçš„æ€æƒ³</a></li>
<li><a href="../zh-CN483988/index.html">MicroSPAæˆ–å¦‚ä½•å‘æ˜æ–¹å½¢é½¿è½®</a></li>
<li><a href="../zh-CN483992/index.html">ä¸ºä»€ä¹ˆæœ‰äº›è¡Œæ˜Ÿä¼šåå™¬å¤©ç©º</a></li>
<li><a href="../zh-CN483994/index.html">æ¸¸è‰‡ä¸Šçš„ITè¿ç§»ã€‚ ä»ç‘å…¸åˆ°è¥¿ç­ç‰™</a></li>
<li><a href="../zh-CN484004/index.html">@Pythonetc 2019å¹´12æœˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>