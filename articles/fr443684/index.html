<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍💻 🐹 💘 Une liste exhaustive des différences entre VB.NET et C #. Partie 1 👇🏿 🚛 🦈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selon la note TIOBE en 2018, VB.NET a dépassé C # en popularité. Coïncidence ou non, mais en février, Eric Lippert, l'un des créateurs de C #, a exhor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une liste exhaustive des différences entre VB.NET et C #. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/443684/"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="image"><br><br>  Selon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la note</a> TIOBE en 2018, VB.NET a dépassé C # en popularité.  Coïncidence ou non, mais en février, Eric Lippert, l'un des créateurs de C #, a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exhorté les</a> lecteurs à prêter attention au blog de son ami, un ancien coéquipier du compilateur Roslyn et, en combinaison, un ardent fan de VB.NET, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anthony Green</a> .  «Ces ressources sont des détails détaillés d'experts qui ne sont pas si faciles à trouver en lisant la documentation», écrit Eric.  Nous présentons à votre attention la première partie de la traduction de l'article d'Anthony Green «Une liste exhaustive des différences entre VB.NET et C #».  C'est peut-être précisément dans ces différences que réside le secret de la dynamique de la notation de ces langues. <br><a name="habracut"></a><br>  Pendant près de la moitié de ma vie, j'ai assisté et participé à d'innombrables discussions sur la similitude ou la différence des deux langages .NET les plus populaires.  D'abord, en tant qu'amateur, puis en tant que professionnel, et enfin, en tant que défenseur des clients, gestionnaire de programme et concepteur de langage, je peux dire sans exagérer combien de fois j'ai entendu ou lu quelque chose comme: <br><blockquote>  <i>"... VB.NET n'est vraiment qu'une fine couche au-dessus d'IL, comme C # ..."</i> </blockquote>  ou <blockquote>  <i>"... VB.NET est en fait juste C # sans point-virgule ..."</i> </blockquote> Comme si les langues étaient une conversion XML ou une feuille de style. <br><br>  Et si un visiteur ardent n'écrit pas cela dans un commentaire, alors souvent cela est impliqué dans des questions comme: <i>«Bonjour, Anthony!</i>  <i>Je suis tombé sur une si petite différence en un seul endroit - est-ce un bug?</i>  <i>Comment ces deux langues par ailleurs identiques, qui devraient être identiques au nom de tous les bons et les saints de ce monde, pourraient-elles se disperser en ce même endroit?</i>  <i>Pourquoi avons-nous besoin d'une telle injustice?!</i> <br><br>  « <b>Séparés</b> », comme s'ils étaient les mêmes jusqu'à ce qu'une mutation se produise, <i>puis</i> deviennent des espèces distinctes.  Hah! <br><br>  Mais je comprends ça.  Avant de rejoindre Microsoft, j'aurais peut-être vaguement conservé cette idée et l'aurais utilisée comme argument pour répondre à des opposants ou pour rassurer quelqu'un.  Je comprends son charme.  Il est facile à comprendre et très facile à répéter.  Mais en travaillant sur Roslyn (essentiellement en réécrivant VB et C # à partir de zéro) pendant 5 ans, j'ai réalisé à quel point <b>cette idée était sans ambiguïté</b> .  J'ai travaillé avec une équipe de développeurs et de testeurs pour réimplémenter chaque centimètre des deux langues, ainsi que leurs outils dans une énorme solution multi-projets avec des millions de lignes de code écrites dans les deux langues.  Et compte tenu du grand nombre de développeurs qui alternent entre eux, du haut niveau de compatibilité avec les résultats et l'expérience des versions précédentes, ainsi que de la nécessité de reproduire de manière fiable le gigantesque volume d'API dans les moindres détails, j'ai été obligé de connaître de très près les différences.  En fait, il me semblait parfois que j'apprenais chaque jour quelque chose de nouveau sur VB.NET (ma langue préférée). <br><br>  Et enfin, j'ai pris le temps de m'asseoir et de décharger du cerveau une particule de ce que j'ai appris à utiliser et à créer VB.NET au cours des 15 dernières années, dans l'espoir de pouvoir au moins gagner du temps la prochaine fois. <br><br>  Avant de passer à la liste, je décrirai les règles de base: <br><br><ul><li>  Cette liste n'est pas exhaustive au sens habituel.  Il est exhaustif.  Ce ne sont pas toutes les différences.  Ce ne sont même pas toutes les différences que je connais généralement.  Ce ne sont que les différences dont je me souviens d'abord, jusqu'à ce que je sois trop fatigué pour continuer;  jusqu'à ce que je manque de force.  Si moi ou l'un d'entre vous rencontrez ou vous rappelez d'autres différences, je serai heureux de mettre à jour cette liste. </li><li>  Je vais commencer au début de la spécification VB 11 et descendre en utilisant son contenu pour me rappeler les différences qui me viennent à l'esprit en premier sur ce sujet. </li><li>  <b>Ce n'est PAS une liste de fonctions en VB qui ne sont pas en C #.</b>  Donc pas de "littéraux XML contre des pointeurs".  C'est trop banal, et il y a déjà des tonnes de telles listes sur Internet (dont certaines ont été écrites par moi, et peut-être à l'avenir j'écrirai plus).  Je me concentrerai principalement sur les constructions qui ont un analogue dans les deux langues, et où un observateur non informé peut suggérer que ces deux choses se comportent de la même manière, mais où il y a de petites ou de grandes différences;  ils peuvent se ressembler, mais fonctionnent différemment ou génèrent finalement un code différent. </li><li>  <b>Ce n'est PAS une liste de différences syntaxiques entre VB et C #</b> (qui sont innombrables).  Je parlerai principalement des différences sémantiques (ce que les choses signifient), et non des différences syntaxiques (comment les choses sont écrites).  Ainsi, aucun élément comme «VB ne commence les commentaires par», et C # utilise // »ou« en C # _ est un identifiant valide, mais pas en VB ».  Mais je vais enfreindre cette règle pour plusieurs cas.  Après tout, la première section de la spécification concerne les règles lexicales. </li><li>  Très souvent, je vais donner des exemples, et parfois je donnerai des raisons pour lesquelles le design pourrait aller dans un sens ou dans un autre.  Certaines décisions de conception ont été prises sous mes yeux, mais la grande majorité a précédé mon époque, et je ne peux que deviner pourquoi elles ont été prises. </li><li>  Veuillez laisser un commentaire ou me tweeter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@ThatVBGuy</a> ) pour me faire part de vos différences préférées et / ou de celles que vous souhaitez en savoir plus. </li></ul><br>  Ayant défini les attentes et sans plus tarder ... <br><br><h2>  Table des matières </h2><br><div class="spoiler">  <b class="spoiler_title">Texte masqué</b> <div class="spoiler_text"><h4>  Syntaxe et prétraitement </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Les mots clés et les opérateurs VB peuvent utiliser des caractères pleine largeur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. VB prend en charge les devis intelligents</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. Les constantes de prétraitement peuvent être de tout type primitif (y compris les dates) et peuvent contenir n'importe quelle valeur constante</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4. Les opérateurs arithmétiques peuvent être utilisés dans les expressions de prétraitement</a> </li></ul><br><h4>  Annonces, etc. </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5. VB ignore parfois les déclarations des implémentations dans IL pour empêcher l'implémentation implicite accidentelle d'une interface par son nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6. VB par défaut masque les membres de la classe de base par nom (Shadows), et non par nom et signature (Overloads)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7. Les versions VB11 et inférieures sont plus strictes pour les membres protégés dans les génériques</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8. La syntaxe «argument nommé» dans les attributs initialise toujours les propriétés / champs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">9. Toutes les déclarations de niveau supérieur (généralement) se trouvent implicitement dans l'espace de noms racine du projet.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">10. Les modules ne sont pas générés en tant que classes abstraites scellées dans IL, ils ne ressemblent donc pas exactement aux classes C # statiques et vice versa</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">11. Vous n'avez pas besoin d'une méthode explicite pour le point d'entrée (Sub Main) dans les applications WinForms</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">12. Si vous appelez des méthodes d'exécution VB obsolètes (par exemple, FileOpen), la méthode appelante sera implicitement marquée avec un attribut pour désactiver l'inline pour des raisons d'exactitude</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">13. Si votre type est marqué avec l'attribut DesignerGenerated et ne contient aucune déclaration de constructeur explicite, le compilateur généré par défaut appellera InitializeComponent s'il est défini pour ce type.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">14. L'absence du modificateur Partiel ne signifie PAS que le type n'est pas partiel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">15. Dans les classes par défaut, le niveau d'accès public est pour tout sauf les champs, et dans les structures publiques, pour les champs aussi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">16. VB initialise les champs APRÈS l'appel du constructeur de base, tandis que C # les initialise AVANT l'appel du constructeur de base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">17. Le champ de support implicitement déclaré des événements VB a un nom différent de celui en C # et est accessible par son nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">18. Le champ auxiliaire implicitement déclaré des propriétés automatiques VB a un nom commun et est accessible par ce nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">19. Le champ d'assistance en lecture seule implicitement déclaré des propriétés automatiques permet l'écriture</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">20. Les attributs d'événement sont parfois appliqués à un champ d'événement auxiliaire</a> </li></ul><br><h4>  Instructions </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">21. La portée de l'étiquette est le corps de la méthode entière qui la contient;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vous pouvez sauter à l'intérieur des blocs (pas tous)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">22. La durée de vie d'une variable locale &lt;&gt; portée</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">23. Les variables sont toujours initialisées à la valeur par défaut pour le type correspondant.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">24. RaiseEvent ne lève PAS d'exception si le champ auxiliaire est nul</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">25. Les affectations ne sont pas toujours les mêmes;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parfois une affectation de type de référence effectue un clone peu profond</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">26. Select Case ne prend pas en charge la fonction Fall-Through;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aucune pause nécessaire</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">27. Chaque bloc Case a sa propre portée</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">28, 29, 30. Select Case fonctionne avec des types non primitifs, peut utiliser des expressions arbitraires non constantes dans les vérifications et utilise par défaut l'opérateur =</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">31. Les variables déclarées à l'intérieur des boucles conservent leur signification entre les itérations d'une manière ou d'une autre</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">32. Trois expressions de boucle For sont évaluées une seule fois au début de la boucle.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">33. Pour chaque boucle dans VB peut utiliser la méthode d'extension GetEnumerator</a> </li></ul></div></div><br><h2>  Syntaxe et prétraitement </h2><br><a name="section1"></a><h3>  1. Les mots clés et les opérateurs VB peuvent utiliser des caractères pleine largeur </h3><br>  Certaines langues (je ne sais pas exactement combien, mais au moins dans certaines formes de chinois, japonais et coréen) utilisent des caractères pleine largeur.  En bref, cela signifie que lorsque vous utilisez une police monospace (comme le font la plupart des programmeurs), le caractère chinois occupera deux fois plus d'espace horizontal que les caractères latins que nous avions l'habitude de voir à l'ouest.  Par exemple: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Ici, j'ai une déclaration de variable écrite en japonais et une initialisation avec une chaîne également écrite en japonais.  Selon le traducteur Bing, la variable est appelée "message d'accueil" et la ligne indique "Bonjour tout le monde!"  Le nom de variable en japonais ne fait que 2 caractères, mais il occupe l'espace de 4 caractères demi-largeur que mon clavier donne normalement, comme le premier commentaire le montre.  Il existe des versions pleine largeur des nombres et de tous les autres caractères ASCII imprimés qui ont la même largeur que les caractères japonais.  Pour le démontrer, j'ai écrit un deuxième commentaire en utilisant les nombres pleine largeur «1» et «2».  Ce ne sont pas des «1» et des «2» comme dans le premier commentaire.  Il n'y a pas d'espaces entre les chiffres.  Vous pouvez également voir que la taille des caractères n'est pas exactement large de 2 caractères, il y a un léger décalage.  Cela est dû en partie au fait que ce programme mélange des caractères pleine largeur et demi-largeur sur une seule ligne et sur les trois lignes. <br><br>  Les espaces sont demi-largeur, les caractères alphanumériques sont pleine largeur.  Nous ne sommes pas des programmeurs sauf si nous sommes obsédés par l'alignement du texte.  Et il me semble que si vous êtes chinois, japonais ou coréen (ou quelqu'un d'autre qui utilise des caractères de taille normale pour leur langue) et utilisez des identifiants ou des chaînes écrits dans leur langue maternelle, ces erreurs d'alignement mineures sont exaspérantes. <br><br>  D'après ce que je comprends, en fonction de votre clavier japonais, le basculement entre les hiéroglyphes et le latin est facile, mais il est préférable d'utiliser des caractères latins pleine largeur.  VB le prend en charge dans les mots clés, les espaces, les opérateurs et même les guillemets.  Donc tout cela peut être écrit comme ceci: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  Comme vous pouvez le voir, dans cette version, les mots clés, les espaces, les commentaires, les opérateurs et même les guillemets utilisent leurs versions en taille réelle.  Dans le chaos a mis de l'ordre. <br><br>  Oui  Les Japonais utilisent VB.  En fait, malgré la syntaxe similaire à la langue anglaise (et c'est peut-être pour cela), pour la plupart des utilisateurs VB que je vois sur les forums, l'anglais n'est pas la langue principale.  Au cours de mon travail chez Microsoft, j'ai rencontré plusieurs fois le MVP japonais VB, au moins l'un d'eux apportait constamment des bonbons japonais.  Si vous êtes un programmeur VB de Chine, du Japon ou de Corée (ou de tout autre pays qui utilise des caractères pleine largeur), veuillez écrire dans les commentaires.  (Dans les commentaires à l'auteur, ils ont écrit que les Japonais essayaient partout dans le code d'utiliser ascii - <i>environ Per.</i> ) <br><br>  <i><b>Moment amusant:</b> lorsque j'ai initialement mis en œuvre des lignes interpolées en VB, je (à ma honte) n'ai pas pris en compte la possibilité de crochets bouclés pleine largeur dans les lieux de substitution.</i>  <i>Vladimir Reshetnikov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@vreshetnikov</a> ) a découvert et corrigé cette erreur, de sorte que la grande tradition de tolérance VB sur la largeur des caractères est restée valide.</i> <br><br><a name="section2"></a><h3>  2. VB prend en charge les devis intelligents </h3><br>  D'accord, c'est, bien sûr, un peu, mais mérite d'être mentionné.  Avez-vous déjà vu un exemple de code dans un document texte comme celui-ci: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  Et après avoir copié l'exemple dans votre code, avez-vous constaté qu'aucune des citations (mises en surbrillance) ne fonctionnait, car Word remplace toutes les citations ASCII habituelles par des <code>“</code> citations intelligentes <code>”</code> ? <br><br>  Non.  D'accord, je l'avais, mais seulement lorsque j'ai copié les exemples en C #.  Dans VB, les guillemets intelligents sont des délimiteurs valides pour les chaînes (il est amusant que les guillemets russes <code>«»</code> ne fonctionnent pas - Env. Per.): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  Ils fonctionnent également à l'intérieur de cordes, bien que peut-être d'une manière étrange.  Si vous doublez les guillemets intelligents pour l'échappement, alors tout ce que vous obtenez au moment de l'exécution est simplement le guillemet simple ("stupide").  Cela peut sembler un peu étrange, mais néanmoins très pratique, car presque partout ailleurs, les citations intelligentes sont autorisées dans la chaîne.  Le compilateur ne vous oblige PAS à terminer avec un devis intelligent ou à utiliser le bon si vous avez commencé avec un devis intelligent, vous pouvez donc le mélanger sans vous inquiéter.  Et oui, cela fonctionne également avec le caractère de guillemet simple utilisé pour les commentaires: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  J'ai essayé de faire admettre à Paul Wick ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@panopticoncntrl</a> ) qu'il l'avait fait uniquement parce qu'il était tourmenté par ce problème pendant qu'il travaillait sur la spécification, mais il nie toute culpabilité.  Ce n'était pas le cas dans VB6, donc quelqu'un l'a ajouté plus tard. <br><br><a name="section3"></a><h3>  3. Les constantes de prétraitement peuvent être de tout type primitif (y compris les dates) et peuvent contenir n'importe quelle valeur constante </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Les opérateurs arithmétiques peuvent être utilisés dans les expressions de prétraitement </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  Annonces, etc. </h2><br><a name="section5"></a><h3>  5. VB ignore parfois les implémentations IL pour empêcher l'implémentation implicite accidentelle d'une interface par son nom. </h3><br>  Cet article est de la catégorie de l'ésotérisme.  En VB, l'implémentation d'une interface se fait toujours explicitement.  Mais il s'avère qu'en l'absence d'une implémentation explicite, le comportement par défaut du CLR lors de l'appel d'une méthode d'interface est de rechercher des méthodes publiques par nom et signature.  Dans la plupart des cas, cela est normal, car dans VB, vous devez <i>généralement</i> fournir une implémentation pour chaque membre de l'interface que vous implémentez, à l'exception d'un cas: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  Dans cet exemple, la classe <code>FooDerived</code> souhaite simplement réaffecter <code>IFoo.Bar</code> à la nouvelle méthode, mais laisse les implémentations restantes inchangées.  Il s'avère que si le compilateur génère simplement la directive <code>FooDerived</code> pour <code>FooDerived</code> , le CLR récupérera également <code>FooDerived.Baz</code> tant que nouvelle implémentation de <code>IFoo.Baz</code> (bien que dans cet exemple, il ne soit pas lié à <code>IFoo</code> ).  En C #, cela se produit implicitement (et je ne suis pas sûr de pouvoir le refuser), mais en VB, le compilateur omet en fait `` Implements '' de la déclaration entière pour éviter cela, et redéfinit uniquement les membres spécifiques qui ont été réimplémentés.  En d'autres termes, si vous demandez à <code>FooDerived</code> s'il <code>IFoo</code> directement, il répondra non: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  Pourquoi est-ce que je le sais et pourquoi est-ce important?  Depuis de nombreuses années, les utilisateurs de VB demandent un support pour l'implémentation implicite d'une interface (sans spécifier explicitement <code>Implements</code> dans chaque déclaration), généralement pour la génération de code.  Le <code>FooDerived.Baz</code> fait d'incorporer cela à la syntaxe actuelle constituerait une rupture, car <code>FooDerived.Baz</code> désormais implicitement <code>IFoo.Baz</code> , bien qu'il ne l'ait encore jamais fait.  Mais plus récemment, j'ai appris plus sur ce comportement en discutant des problèmes de conception potentiels avec la fonctionnalité «implémentation d'interface par défaut», qui permettrait aux interfaces d'inclure les implémentations par défaut de certains membres et de ne pas nécessiter de réimplémentation dans chaque classe.  Cela serait utile pour les surcharges, par exemple, lorsque l'implémentation est susceptible d'être la même pour tous les implémenteurs (délégation à la surcharge principale).  Un autre scénario est le versioning.  Si une interface peut inclure des implémentations par défaut, vous pouvez y ajouter de nouveaux membres sans interrompre les anciennes implémentations.  Mais il y a un problème.  Étant donné que le comportement par défaut dans le CLR consiste à rechercher des implémentations publiques par nom et signature, si la classe VB n'implémente pas de membres d'interface avec des implémentations par défaut, mais a des membres publics avec un nom et une signature appropriés, ils implémentent implicitement ces membres d'interface, même si vous le faites complètement pas censé.  Vous pouvez contourner ce problème lorsque l'ensemble des membres de l'interface est connu au moment de la compilation.  Mais si le membre a été ajouté après la compilation du code, il modifie simplement le comportement en mode silencieux. <br><br><a name="section6"></a><h3>  6. VB par défaut masque les membres de la classe de base par nom (Shadows), et non par nom et signature (Overloads) </h3><br>  Je pense que cette différence est assez bien connue.  Le scénario est le suivant: vous <code>DomainObject</code> classe de base ( <code>DomainObject</code> ), éventuellement hors de votre contrôle, et déclarez une méthode avec un nom qui a du sens dans le contexte de votre classe, par exemple, <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  Le fait qu'une facture puisse être imprimée est logique.  Mais dans la prochaine version de l'API où votre classe de base est déclarée, ils décident pour le débogage d'ajouter à tous les DomainObjects une méthode qui affiche le contenu complet de l'objet dans la fenêtre de débogage.  Cette méthode est brillamment appelée Print.  Le problème est que le client de votre API peut remarquer que l'objet Facture a des méthodes <code>Print()</code> et <code>Print(Integer)</code> et penser que ce sont des surcharges liées.  Peut-être que le premier imprime juste une copie.  Mais ce n'est pas du tout ce que vous avez conçu comme l'auteur de Invoice.  Vous ne <code>DomainObject.Print</code> pas que <code>DomainObject.Print</code> apparaîtrait.  Alors oui, cela ne fonctionne pas en VB.  Lorsque cette situation apparaît, un avertissement apparaît, mais plus important encore, le comportement par défaut dans VB est de se masquer par son nom.  Autrement dit, jusqu'à ce que vous indiquiez explicitement avec le mot clé <code>Overloads</code> que votre <code>Print</code> est une surcharge de <code>Print</code> classe de base, un membre de la classe de base (et toute surcharge de celle-ci) sont complètement masqués.  Seule l'API que vous avez déclarée à l'origine est affichée pour vos clients de classe.  Cela fonctionne par défaut, mais vous pouvez le faire explicitement via le mot clé Shadows.  C # ne peut faire que des <code>Overloads</code> (bien qu'il prenne en compte les <code>Shadows</code> lorsqu'il se réfère à une bibliothèque VB) et le fait par défaut (en utilisant le <code>new</code> mot-clé).  Mais cette différence apparaît de temps en temps lorsque certaines hiérarchies d'héritage apparaissent dans des projets où une classe est définie dans une langue et une autre dans une autre, et il existe des méthodes surchargées, mais cela dépasse le cadre de l'élément actuel dans la liste des différences. <br><br><a name="section7"></a><h3>  7. Les versions VB11 et inférieures sont plus strictes pour les membres protégés dans les génériques </h3><br>  En fait, nous avons changé cela entre VS2013 et VS2015.  En particulier, nous avons décidé de ne pas nous soucier de la réimplémentation.  Mais j'écris cette distinction au cas où vous utilisez l'ancienne version et que vous la remarquiez.  En bref: si un membre protégé est déclaré dans le type générique, l'héritier, étant également générique, ne peut accéder à ce membre protégé que via l'instance héritée avec les mêmes arguments de type. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. La syntaxe «argument nommé» dans les attributs initialise toujours les propriétés / champs </h3><br>  VB utilise la même syntaxe <code>:=</code> pour initialiser les propriétés / champs d'attribut que pour passer des arguments de méthode par nom.  Par conséquent, il n'existe aucun moyen de transmettre un argument au constructeur d'attribut par son nom. <br><br><a name="section9"></a><h3>  9. Toutes les déclarations de niveau supérieur (généralement) sont implicitement situées dans l'espace de noms racine du projet </h3><br>  Cette différence est presque dans la catégorie «fonctionnalités avancées», mais je l'ai incluse dans la liste car elle change la signification du code.  Il y a un champ dans les propriétés du projet VB: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  Par défaut, il s'agit simplement du nom de votre projet au moment de sa création.  Ce n'est <b>PAS</b> le même champ que "l'espace de noms par défaut" dans les propriétés d'un projet C #.  L'espace de noms par défaut définit simplement le code qui est ajouté par défaut aux nouveaux fichiers en C #.  Mais l'espace de noms racine dans VB signifie que, sauf indication contraire, chaque déclaration de niveau supérieur dans ce projet se trouve implicitement dans cet espace de noms.  C'est pourquoi les modèles de document VB ne contiennent généralement aucune déclaration d'espace de noms.  De plus, si vous ajoutez une déclaration d'espace de noms, elle ne remplace pas la racine, mais y est ajoutée: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Ainsi, l'espace de noms <code>Controllers</code> déclare en fait l' <code>VBExamples.Controllers</code> noms <code>VBExamples.Controllers</code> , sauf si vous vous débarrassez de ce mécanisme en déclarant explicitement <code>Global</code> dans l'espace de noms. <br><br>  C'est pratique car il enregistre un niveau d'indentation et un concept supplémentaire pour chaque fichier VB.  Et cela est particulièrement utile si vous créez une application UWP (car tout doit être dans l'espace de noms dans UWP), et c'est extrêmement pratique si vous décidez de changer l'espace de noms de niveau supérieur pour l'ensemble de votre projet, par exemple, à partir d'un nom de code comme Roslyn en une version plus longue, comme <code>Microsoft.CodeAnalysis</code> , car vous n'avez pas à mettre à jour manuellement chaque fichier dans la solution.  Il est également important de garder cela à l'esprit lorsque vous travaillez avec des générateurs de code, des espaces de noms XAML et le nouveau <code>.vbproj</code> fichier <code>.vbproj</code> . <br><br><a name="section10"></a><h3>  10. Les modules ne sont pas générés en tant que classes abstraites scellées dans IL, ils ne ressemblent donc pas exactement aux classes statiques C # et vice versa. </h3><br>  Les modules en VB existaient avant les classes statiques C #, bien que nous ayons essayé en 2010 de les rendre identiques en termes d'IL.  Malheureusement, il s'agissait d'un changement de rupture, car le sérialiseur XML (ou peut-être qu'il était binaire) pour cette version de .NET (je pense qu'ils l'ont corrigé) ne voulait pas sérialiser le type imbriqué dans un type qui ne pouvait pas être créé (et une classe abstraite ne peut pas).  Il a levé une exception. <br><br>  Nous avons trouvé cela après avoir apporté les modifications et les avons annulées car du code utilisait quelque part le type d'énumération incorporé dans le module.  Et comme vous ne savez pas avec quelle version du sérialiseur le programme compilé fonctionnera, il ne sera jamais possible de le changer, car dans une version de l'application cela fonctionnera, et dans d'autres cas il lèvera des exceptions. <br><br><a name="section11"></a><h3>  11. Vous n'avez pas besoin d'une méthode explicite pour le point d'entrée (Sub Main) dans les applications WinForms </h3><br>  Si votre projet utilise Form comme objet de départ et n'utilise pas le «Framework d'application» (plus à ce sujet dans le prochain article), VB génère un <code>Sub Main</code> , qui crée votre formulaire de démarrage et le transmet à <code>Application.Run</code> , vous permettant d'économiser le fichier entier Pour gérer ce processus, soit une méthode supplémentaire dans votre <code>Form</code> , soit même la nécessité de réfléchir à ce problème. <br><br><a name="section12"></a><h3>  12. Si vous appelez des méthodes d'exécution VB obsolètes (par exemple, FileOpen), la méthode appelante sera implicitement marquée avec un attribut pour désactiver l'inline pour des raisons d'exactitude </h3><br>  En bref, les méthodes de travail avec des fichiers de style VB6 comme <code>FileOpen</code> reposent sur des contextes spécifiques à l'assembly où se trouve le code.  Par exemple, le fichier # 1 peut être un journal dans un projet et une configuration dans un autre.  Pour déterminer quel assembly est en cours d'exécution, <code>Assembly.GetCallingAssembly()</code> appelé.  Mais si le JIT <i>insère</i> votre méthode dans l'appelant, du point de vue de la pile, la méthode d'exécution VB ne sera pas appelée par votre méthode, mais par l'appelant, qui peut être dans un assembly différent, qui peut alors autoriser votre code à accéder ou à violer l'état interne de l'appelant objet.  Ce n'est pas un problème de sécurité, car si le code compromettant s'exécute dans votre processus, vous avez déjà perdu.  C'est une question d'exactitude.  Par conséquent, si vous utilisez ces méthodes, le compilateur désactive l'inline. <br><br>  Cette modification a été apportée au dernier moment en 2010, car le x64 JIT est TRÈS agressif lors de l'inlining / optimisation du code, et nous l'avons trouvé très tard, et c'était l'option la plus sûre. <br><br><a name="section13"></a><h3>  13. Si votre type est marqué avec l'attribut DesignerGenerated et ne contient aucune déclaration de constructeur explicite, le compilateur généré par défaut appellera InitializeComponent s'il est défini pour ce type </h3><br>  À l'époque avant l'avènement des types partiels, l'équipe VB a mené une guerre pour réduire le code standard dans les projets WinForms.  Mais même avec <code>Partial</code> cela est utile car il permet au fichier généré d'omettre complètement le constructeur, et l'utilisateur peut le déclarer manuellement dans son fichier si nécessaire, ou ne pas le déclarer sinon.  Sans cela, le concepteur serait obligé d'ajouter un constructeur uniquement pour appeler <code>InitializeComponent</code> , et si l'utilisateur ajoute également, ils seront des doublons, ou la boîte à outils devrait être suffisamment intelligente pour déplacer le constructeur du fichier de concepteur vers l'utilisateur et ne pas le régénérer dans le concepteur, s'il l'a déjà existe dans le fichier utilisateur. <br><br><a name="section14"></a><h3>  14. L'absence du modificateur Partiel ne signifie PAS que le type n'est pas partiel </h3><br>  Techniquement, en VB, une seule classe doit être marquée comme partielle.  Il s'agit généralement (dans les projets GUI) d'un fichier généré. <br><br>  <b>Pourquoi?</b>  Cela conserve le fichier utilisateur beau et propre, et peut être très pratique à inclure après avoir généré ou ajouté au code utilisateur généré.  Cependant, il est recommandé qu'au plus une classe n'ait pas de modificateur partiel, sinon un avertissement est émis. <br><br><a name="section15"></a><h3>  15. Dans les classes par défaut, le niveau d'accès public est pour tout sauf les champs, et dans les structures publiques, pour les champs aussi </h3><br>  J'ai des sentiments mitigés à ce sujet.  En C #, tout est <code>private</code> par défaut (acclamations, encapsulation!), Mais il y a un argument à faire en fonction de ce que vous déclarez souvent: un contrat public ou des détails d'implémentation.  Les propriétés et les événements sont généralement destinés à un usage externe ( <code>public</code> ) et les opérateurs ne sont pas accessibles autrement que <code>public</code> .  Cependant, je me fie rarement à l'accessibilité par défaut (à l'exception des démos comme les exemples de cet article). <br><br><a name="section16"></a><h3>  16. VB initialise les champs APRÈS l'appel du constructeur de base, tandis que C # les initialise AVANT l'appel du constructeur de base </h3><br>  Avez-vous entendu comment "certains" disent que la première chose qui se produit dans le constructeur est un appel au constructeur de la classe de base?  Eh bien, ce n'est pas le cas, du moins en C #.  En C #, avant d'appeler <code>base()</code> , explicite ou implicite, les initialiseurs de champ sont exécutés en premier, puis l'appel du constructeur, puis votre code.  Cette décision a des conséquences, et je pense que je sais pourquoi les développeurs de langage pourraient aller d'une manière ou d'une autre.  Je crois que l'une de ces conséquences est que le code suivant ne peut pas être directement traduit en C #: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  À l'époque où j'étais engagé dans Reflection, j'écrivais souvent un tel code.  Et je me souviens vaguement d'un collègue avant Microsoft (Josh), qui a traduit mon code en C #, se plaignant parfois de la nécessité de porter tous mes initialiseurs vers le constructeur.  En C #, il est interdit de faire référence à un objet en cours de création avant l'appel de <code>base()</code> .  Et puisque les initialiseurs de champ sont exécutés avant l'appel spécifié, ils ne peuvent pas non plus faire référence à d'autres champs ou à aucun membre de l'instance d'objet.  Cet exemple ne fonctionne donc également qu'en VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Ici, nous avons une classe de base, qui a censément beaucoup de fonctionnalités, mais elle a besoin d'un objet clé pour la gestion, le travail, qui est déterminé par le type dérivé.  Il existe de nombreuses façons de mettre en œuvre un tel modèle, mais j'utilise généralement celui-ci car: <br><br><ul><li>  il est petit; </li><li>  ne m'oblige pas à déclarer un constructeur; </li><li>  ne nécessite pas que je mette le code d'initialisation dans le constructeur, le cas échéant; </li><li>  me permet de mettre en cache l'objet créé et ne nécessite pas de types dérivés pour déclarer et gérer le stockage de l'objet fourni, bien que ce ne soit plus le cas avec les propriétés automatiques. </li></ul><br>  De plus, je me suis retrouvé dans les deux situations: lorsqu'un champ dans un type dérivé voulait appeler une méthode déclarée dans la classe de base, et lorsque l'initialiseur de classe de champ devait appeler le membre <code>MustOverride</code> implémenté par le type dérivé.  Les deux sont valides en VB et aucun en C #, et cela a du sens.  Si l'initialiseur de champ C # pouvait appeler un membre de la classe de base, ce membre pourrait dépendre des champs initialisés dans le constructeur de base (qui n'est pas déjà en cours d'exécution) et les résultats seraient presque certainement faux, et il n'y avait aucun moyen de contourner cela. <br><br>  Mais en VB, le constructeur de base a déjà fonctionné, vous pouvez donc tout faire!  Dans le cas contraire, tout est un peu plus compliqué, car appeler le membre <code>Overridable</code> depuis l'initialiseur (ou constructeur) de la classe de base peut conduire à accéder aux champs avant qu'ils ne soient «initialisés».  Mais seule votre implémentation sait si c'est un problème.  Dans mes scripts, cela ne se produit tout simplement pas.  Ils ne dépendent pas de l'état de l'instance, mais ne peuvent pas être des membres <code>Shared</code> car vous ne pouvez pas avoir de membre <code>Shared Overridable</code> dans n'importe quelle langue pour des raisons techniques dépassant le cadre de cet article.  De plus, il est clairement défini ce qui arrive aux champs avant de démarrer les initialiseurs personnalisés - ils sont initialisés avec des valeurs par défaut, comme toutes les variables dans VB.  Pas de surprise. <br><br>  <b>Alors pourquoi?</b>  En fait, je ne sais pas si mes scripts étaient ce que l'équipe originale de VB.NET avait en tête quand ils l'ont conçu.  Cela fonctionne juste dans mon cas!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    «» ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             «WithEvents»,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ….   VB     « »    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       «»       ,    « ». <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA «Expert Business Objects» <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  Instructions </h2><br><a name="section21"></a><h3> 21.    —    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try —    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      «».  VB6        Quick Basic  ( )       .      QB,      .     ,       « »,           .        GoTo,         —   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       «».   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       « » ( <i>definite assignment</i> ).   ,    , ,         « ».   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , —  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      «» ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       « »,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB —        ,     <code>null</code> ( ),    <code>null</code> - —  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , —     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   « »         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   «» (fall-through);   break </h3><br>     Friday    ,  Sunday —  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>«,    ?   !»</i>   <i>«,  »</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> —   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> —  ,           , … <br></li><li> <code>switch</code> —   / ,   « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>   ». <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>«     ,    ,    »</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> — « », -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API — ! ( <i>«… …  ?»</i> ) <br><br>  <b>Pourquoi?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   « ».   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   — .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  Minute de publicité. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443684/">https://habr.com/ru/post/fr443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443672/index.html">Tests basés sur les risques</a></li>
<li><a href="../fr443676/index.html">Vinyle au lieu d'un timbre-poste: rareté inhabituelle</a></li>
<li><a href="../fr443678/index.html">Lisibilité du code</a></li>
<li><a href="../fr443680/index.html">Semaine de travail de quatre jours. Expérience russe</a></li>
<li><a href="../fr443682/index.html">Monétisation du cloud: comment attirer des clients et ne pas faire faillite</a></li>
<li><a href="../fr443686/index.html">30 - 31 mars, SIBUR CHALLENGE à Nizhny Novgorod</a></li>
<li><a href="../fr443690/index.html">Parallels RAS: qu'est-ce que c'est et avec quoi mange-t-il?</a></li>
<li><a href="../fr443692/index.html">Alchimie du 21e siècle: conversion du deutérium en métal liquide en plasma</a></li>
<li><a href="../fr443694/index.html">Comment le navigateur aide le camarade Major</a></li>
<li><a href="../fr443698/index.html">Google a cessé d '"étrangler l'oie": DuckDuckGo est inclus dans la liste des moteurs de recherche Chrome standard pour 60 pays</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>