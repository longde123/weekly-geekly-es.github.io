<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüíª üêπ üíò Une liste exhaustive des diff√©rences entre VB.NET et C #. Partie 1 üëáüèø üöõ ü¶à</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selon la note TIOBE en 2018, VB.NET a d√©pass√© C # en popularit√©. Co√Øncidence ou non, mais en f√©vrier, Eric Lippert, l'un des cr√©ateurs de C #, a exhor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une liste exhaustive des diff√©rences entre VB.NET et C #. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/443684/"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="image"><br><br>  Selon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la note</a> TIOBE en 2018, VB.NET a d√©pass√© C # en popularit√©.  Co√Øncidence ou non, mais en f√©vrier, Eric Lippert, l'un des cr√©ateurs de C #, a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exhort√© les</a> lecteurs √† pr√™ter attention au blog de son ami, un ancien co√©quipier du compilateur Roslyn et, en combinaison, un ardent fan de VB.NET, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anthony Green</a> .  ¬´Ces ressources sont des d√©tails d√©taill√©s d'experts qui ne sont pas si faciles √† trouver en lisant la documentation¬ª, √©crit Eric.  Nous pr√©sentons √† votre attention la premi√®re partie de la traduction de l'article d'Anthony Green ¬´Une liste exhaustive des diff√©rences entre VB.NET et C #¬ª.  C'est peut-√™tre pr√©cis√©ment dans ces diff√©rences que r√©side le secret de la dynamique de la notation de ces langues. <br><a name="habracut"></a><br>  Pendant pr√®s de la moiti√© de ma vie, j'ai assist√© et particip√© √† d'innombrables discussions sur la similitude ou la diff√©rence des deux langages .NET les plus populaires.  D'abord, en tant qu'amateur, puis en tant que professionnel, et enfin, en tant que d√©fenseur des clients, gestionnaire de programme et concepteur de langage, je peux dire sans exag√©rer combien de fois j'ai entendu ou lu quelque chose comme: <br><blockquote>  <i>"... VB.NET n'est vraiment qu'une fine couche au-dessus d'IL, comme C # ..."</i> </blockquote>  ou <blockquote>  <i>"... VB.NET est en fait juste C # sans point-virgule ..."</i> </blockquote> Comme si les langues √©taient une conversion XML ou une feuille de style. <br><br>  Et si un visiteur ardent n'√©crit pas cela dans un commentaire, alors souvent cela est impliqu√© dans des questions comme: <i>¬´Bonjour, Anthony!</i>  <i>Je suis tomb√© sur une si petite diff√©rence en un seul endroit - est-ce un bug?</i>  <i>Comment ces deux langues par ailleurs identiques, qui devraient √™tre identiques au nom de tous les bons et les saints de ce monde, pourraient-elles se disperser en ce m√™me endroit?</i>  <i>Pourquoi avons-nous besoin d'une telle injustice?!</i> <br><br>  ¬´ <b>S√©par√©s</b> ¬ª, comme s'ils √©taient les m√™mes jusqu'√† ce qu'une mutation se produise, <i>puis</i> deviennent des esp√®ces distinctes.  Hah! <br><br>  Mais je comprends √ßa.  Avant de rejoindre Microsoft, j'aurais peut-√™tre vaguement conserv√© cette id√©e et l'aurais utilis√©e comme argument pour r√©pondre √† des opposants ou pour rassurer quelqu'un.  Je comprends son charme.  Il est facile √† comprendre et tr√®s facile √† r√©p√©ter.  Mais en travaillant sur Roslyn (essentiellement en r√©√©crivant VB et C # √† partir de z√©ro) pendant 5 ans, j'ai r√©alis√© √† quel point <b>cette id√©e √©tait sans ambigu√Øt√©</b> .  J'ai travaill√© avec une √©quipe de d√©veloppeurs et de testeurs pour r√©impl√©menter chaque centim√®tre des deux langues, ainsi que leurs outils dans une √©norme solution multi-projets avec des millions de lignes de code √©crites dans les deux langues.  Et compte tenu du grand nombre de d√©veloppeurs qui alternent entre eux, du haut niveau de compatibilit√© avec les r√©sultats et l'exp√©rience des versions pr√©c√©dentes, ainsi que de la n√©cessit√© de reproduire de mani√®re fiable le gigantesque volume d'API dans les moindres d√©tails, j'ai √©t√© oblig√© de conna√Ætre de tr√®s pr√®s les diff√©rences.  En fait, il me semblait parfois que j'apprenais chaque jour quelque chose de nouveau sur VB.NET (ma langue pr√©f√©r√©e). <br><br>  Et enfin, j'ai pris le temps de m'asseoir et de d√©charger du cerveau une particule de ce que j'ai appris √† utiliser et √† cr√©er VB.NET au cours des 15 derni√®res ann√©es, dans l'espoir de pouvoir au moins gagner du temps la prochaine fois. <br><br>  Avant de passer √† la liste, je d√©crirai les r√®gles de base: <br><br><ul><li>  Cette liste n'est pas exhaustive au sens habituel.  Il est exhaustif.  Ce ne sont pas toutes les diff√©rences.  Ce ne sont m√™me pas toutes les diff√©rences que je connais g√©n√©ralement.  Ce ne sont que les diff√©rences dont je me souviens d'abord, jusqu'√† ce que je sois trop fatigu√© pour continuer;  jusqu'√† ce que je manque de force.  Si moi ou l'un d'entre vous rencontrez ou vous rappelez d'autres diff√©rences, je serai heureux de mettre √† jour cette liste. </li><li>  Je vais commencer au d√©but de la sp√©cification VB 11 et descendre en utilisant son contenu pour me rappeler les diff√©rences qui me viennent √† l'esprit en premier sur ce sujet. </li><li>  <b>Ce n'est PAS une liste de fonctions en VB qui ne sont pas en C #.</b>  Donc pas de "litt√©raux XML contre des pointeurs".  C'est trop banal, et il y a d√©j√† des tonnes de telles listes sur Internet (dont certaines ont √©t√© √©crites par moi, et peut-√™tre √† l'avenir j'√©crirai plus).  Je me concentrerai principalement sur les constructions qui ont un analogue dans les deux langues, et o√π un observateur non inform√© peut sugg√©rer que ces deux choses se comportent de la m√™me mani√®re, mais o√π il y a de petites ou de grandes diff√©rences;  ils peuvent se ressembler, mais fonctionnent diff√©remment ou g√©n√®rent finalement un code diff√©rent. </li><li>  <b>Ce n'est PAS une liste de diff√©rences syntaxiques entre VB et C #</b> (qui sont innombrables).  Je parlerai principalement des diff√©rences s√©mantiques (ce que les choses signifient), et non des diff√©rences syntaxiques (comment les choses sont √©crites).  Ainsi, aucun √©l√©ment comme ¬´VB ne commence les commentaires par¬ª, et C # utilise // ¬ªou¬´ en C # _ est un identifiant valide, mais pas en VB ¬ª.  Mais je vais enfreindre cette r√®gle pour plusieurs cas.  Apr√®s tout, la premi√®re section de la sp√©cification concerne les r√®gles lexicales. </li><li>  Tr√®s souvent, je vais donner des exemples, et parfois je donnerai des raisons pour lesquelles le design pourrait aller dans un sens ou dans un autre.  Certaines d√©cisions de conception ont √©t√© prises sous mes yeux, mais la grande majorit√© a pr√©c√©d√© mon √©poque, et je ne peux que deviner pourquoi elles ont √©t√© prises. </li><li>  Veuillez laisser un commentaire ou me tweeter ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@ThatVBGuy</a> ) pour me faire part de vos diff√©rences pr√©f√©r√©es et / ou de celles que vous souhaitez en savoir plus. </li></ul><br>  Ayant d√©fini les attentes et sans plus tarder ... <br><br><h2>  Table des mati√®res </h2><br><div class="spoiler">  <b class="spoiler_title">Texte masqu√©</b> <div class="spoiler_text"><h4>  Syntaxe et pr√©traitement </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Les mots cl√©s et les op√©rateurs VB peuvent utiliser des caract√®res pleine largeur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. VB prend en charge les devis intelligents</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. Les constantes de pr√©traitement peuvent √™tre de tout type primitif (y compris les dates) et peuvent contenir n'importe quelle valeur constante</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4. Les op√©rateurs arithm√©tiques peuvent √™tre utilis√©s dans les expressions de pr√©traitement</a> </li></ul><br><h4>  Annonces, etc. </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5. VB ignore parfois les d√©clarations des impl√©mentations dans IL pour emp√™cher l'impl√©mentation implicite accidentelle d'une interface par son nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6. VB par d√©faut masque les membres de la classe de base par nom (Shadows), et non par nom et signature (Overloads)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7. Les versions VB11 et inf√©rieures sont plus strictes pour les membres prot√©g√©s dans les g√©n√©riques</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8. La syntaxe ¬´argument nomm√©¬ª dans les attributs initialise toujours les propri√©t√©s / champs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">9. Toutes les d√©clarations de niveau sup√©rieur (g√©n√©ralement) se trouvent implicitement dans l'espace de noms racine du projet.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">10. Les modules ne sont pas g√©n√©r√©s en tant que classes abstraites scell√©es dans IL, ils ne ressemblent donc pas exactement aux classes C # statiques et vice versa</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">11. Vous n'avez pas besoin d'une m√©thode explicite pour le point d'entr√©e (Sub Main) dans les applications WinForms</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">12. Si vous appelez des m√©thodes d'ex√©cution VB obsol√®tes (par exemple, FileOpen), la m√©thode appelante sera implicitement marqu√©e avec un attribut pour d√©sactiver l'inline pour des raisons d'exactitude</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">13. Si votre type est marqu√© avec l'attribut DesignerGenerated et ne contient aucune d√©claration de constructeur explicite, le compilateur g√©n√©r√© par d√©faut appellera InitializeComponent s'il est d√©fini pour ce type.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">14. L'absence du modificateur Partiel ne signifie PAS que le type n'est pas partiel</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">15. Dans les classes par d√©faut, le niveau d'acc√®s public est pour tout sauf les champs, et dans les structures publiques, pour les champs aussi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">16. VB initialise les champs APR√àS l'appel du constructeur de base, tandis que C # les initialise AVANT l'appel du constructeur de base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">17. Le champ de support implicitement d√©clar√© des √©v√©nements VB a un nom diff√©rent de celui en C # et est accessible par son nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">18. Le champ auxiliaire implicitement d√©clar√© des propri√©t√©s automatiques VB a un nom commun et est accessible par ce nom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">19. Le champ d'assistance en lecture seule implicitement d√©clar√© des propri√©t√©s automatiques permet l'√©criture</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">20. Les attributs d'√©v√©nement sont parfois appliqu√©s √† un champ d'√©v√©nement auxiliaire</a> </li></ul><br><h4>  Instructions </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">21. La port√©e de l'√©tiquette est le corps de la m√©thode enti√®re qui la contient;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vous pouvez sauter √† l'int√©rieur des blocs (pas tous)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">22. La dur√©e de vie d'une variable locale &lt;&gt; port√©e</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">23. Les variables sont toujours initialis√©es √† la valeur par d√©faut pour le type correspondant.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">24. RaiseEvent ne l√®ve PAS d'exception si le champ auxiliaire est nul</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">25. Les affectations ne sont pas toujours les m√™mes;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parfois une affectation de type de r√©f√©rence effectue un clone peu profond</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">26. Select Case ne prend pas en charge la fonction Fall-Through;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aucune pause n√©cessaire</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">27. Chaque bloc Case a sa propre port√©e</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">28, 29, 30. Select Case fonctionne avec des types non primitifs, peut utiliser des expressions arbitraires non constantes dans les v√©rifications et utilise par d√©faut l'op√©rateur =</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">31. Les variables d√©clar√©es √† l'int√©rieur des boucles conservent leur signification entre les it√©rations d'une mani√®re ou d'une autre</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">32. Trois expressions de boucle For sont √©valu√©es une seule fois au d√©but de la boucle.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">33. Pour chaque boucle dans VB peut utiliser la m√©thode d'extension GetEnumerator</a> </li></ul></div></div><br><h2>  Syntaxe et pr√©traitement </h2><br><a name="section1"></a><h3>  1. Les mots cl√©s et les op√©rateurs VB peuvent utiliser des caract√®res pleine largeur </h3><br>  Certaines langues (je ne sais pas exactement combien, mais au moins dans certaines formes de chinois, japonais et cor√©en) utilisent des caract√®res pleine largeur.  En bref, cela signifie que lorsque vous utilisez une police monospace (comme le font la plupart des programmeurs), le caract√®re chinois occupera deux fois plus d'espace horizontal que les caract√®res latins que nous avions l'habitude de voir √† l'ouest.  Par exemple: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Ici, j'ai une d√©claration de variable √©crite en japonais et une initialisation avec une cha√Æne √©galement √©crite en japonais.  Selon le traducteur Bing, la variable est appel√©e "message d'accueil" et la ligne indique "Bonjour tout le monde!"  Le nom de variable en japonais ne fait que 2 caract√®res, mais il occupe l'espace de 4 caract√®res demi-largeur que mon clavier donne normalement, comme le premier commentaire le montre.  Il existe des versions pleine largeur des nombres et de tous les autres caract√®res ASCII imprim√©s qui ont la m√™me largeur que les caract√®res japonais.  Pour le d√©montrer, j'ai √©crit un deuxi√®me commentaire en utilisant les nombres pleine largeur ¬´1¬ª et ¬´2¬ª.  Ce ne sont pas des ¬´1¬ª et des ¬´2¬ª comme dans le premier commentaire.  Il n'y a pas d'espaces entre les chiffres.  Vous pouvez √©galement voir que la taille des caract√®res n'est pas exactement large de 2 caract√®res, il y a un l√©ger d√©calage.  Cela est d√ª en partie au fait que ce programme m√©lange des caract√®res pleine largeur et demi-largeur sur une seule ligne et sur les trois lignes. <br><br>  Les espaces sont demi-largeur, les caract√®res alphanum√©riques sont pleine largeur.  Nous ne sommes pas des programmeurs sauf si nous sommes obs√©d√©s par l'alignement du texte.  Et il me semble que si vous √™tes chinois, japonais ou cor√©en (ou quelqu'un d'autre qui utilise des caract√®res de taille normale pour leur langue) et utilisez des identifiants ou des cha√Ænes √©crits dans leur langue maternelle, ces erreurs d'alignement mineures sont exasp√©rantes. <br><br>  D'apr√®s ce que je comprends, en fonction de votre clavier japonais, le basculement entre les hi√©roglyphes et le latin est facile, mais il est pr√©f√©rable d'utiliser des caract√®res latins pleine largeur.  VB le prend en charge dans les mots cl√©s, les espaces, les op√©rateurs et m√™me les guillemets.  Donc tout cela peut √™tre √©crit comme ceci: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  Comme vous pouvez le voir, dans cette version, les mots cl√©s, les espaces, les commentaires, les op√©rateurs et m√™me les guillemets utilisent leurs versions en taille r√©elle.  Dans le chaos a mis de l'ordre. <br><br>  Oui  Les Japonais utilisent VB.  En fait, malgr√© la syntaxe similaire √† la langue anglaise (et c'est peut-√™tre pour cela), pour la plupart des utilisateurs VB que je vois sur les forums, l'anglais n'est pas la langue principale.  Au cours de mon travail chez Microsoft, j'ai rencontr√© plusieurs fois le MVP japonais VB, au moins l'un d'eux apportait constamment des bonbons japonais.  Si vous √™tes un programmeur VB de Chine, du Japon ou de Cor√©e (ou de tout autre pays qui utilise des caract√®res pleine largeur), veuillez √©crire dans les commentaires.  (Dans les commentaires √† l'auteur, ils ont √©crit que les Japonais essayaient partout dans le code d'utiliser ascii - <i>environ Per.</i> ) <br><br>  <i><b>Moment amusant:</b> lorsque j'ai initialement mis en ≈ìuvre des lignes interpol√©es en VB, je (√† ma honte) n'ai pas pris en compte la possibilit√© de crochets boucl√©s pleine largeur dans les lieux de substitution.</i>  <i>Vladimir Reshetnikov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@vreshetnikov</a> ) a d√©couvert et corrig√© cette erreur, de sorte que la grande tradition de tol√©rance VB sur la largeur des caract√®res est rest√©e valide.</i> <br><br><a name="section2"></a><h3>  2. VB prend en charge les devis intelligents </h3><br>  D'accord, c'est, bien s√ªr, un peu, mais m√©rite d'√™tre mentionn√©.  Avez-vous d√©j√† vu un exemple de code dans un document texte comme celui-ci: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  Et apr√®s avoir copi√© l'exemple dans votre code, avez-vous constat√© qu'aucune des citations (mises en surbrillance) ne fonctionnait, car Word remplace toutes les citations ASCII habituelles par des <code>‚Äú</code> citations intelligentes <code>‚Äù</code> ? <br><br>  Non.  D'accord, je l'avais, mais seulement lorsque j'ai copi√© les exemples en C #.  Dans VB, les guillemets intelligents sont des d√©limiteurs valides pour les cha√Ænes (il est amusant que les guillemets russes <code>¬´¬ª</code> ne fonctionnent pas - Env. Per.): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  Ils fonctionnent √©galement √† l'int√©rieur de cordes, bien que peut-√™tre d'une mani√®re √©trange.  Si vous doublez les guillemets intelligents pour l'√©chappement, alors tout ce que vous obtenez au moment de l'ex√©cution est simplement le guillemet simple ("stupide").  Cela peut sembler un peu √©trange, mais n√©anmoins tr√®s pratique, car presque partout ailleurs, les citations intelligentes sont autoris√©es dans la cha√Æne.  Le compilateur ne vous oblige PAS √† terminer avec un devis intelligent ou √† utiliser le bon si vous avez commenc√© avec un devis intelligent, vous pouvez donc le m√©langer sans vous inqui√©ter.  Et oui, cela fonctionne √©galement avec le caract√®re de guillemet simple utilis√© pour les commentaires: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  J'ai essay√© de faire admettre √† Paul Wick ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@panopticoncntrl</a> ) qu'il l'avait fait uniquement parce qu'il √©tait tourment√© par ce probl√®me pendant qu'il travaillait sur la sp√©cification, mais il nie toute culpabilit√©.  Ce n'√©tait pas le cas dans VB6, donc quelqu'un l'a ajout√© plus tard. <br><br><a name="section3"></a><h3>  3. Les constantes de pr√©traitement peuvent √™tre de tout type primitif (y compris les dates) et peuvent contenir n'importe quelle valeur constante </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Les op√©rateurs arithm√©tiques peuvent √™tre utilis√©s dans les expressions de pr√©traitement </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  Annonces, etc. </h2><br><a name="section5"></a><h3>  5. VB ignore parfois les impl√©mentations IL pour emp√™cher l'impl√©mentation implicite accidentelle d'une interface par son nom. </h3><br>  Cet article est de la cat√©gorie de l'√©sot√©risme.  En VB, l'impl√©mentation d'une interface se fait toujours explicitement.  Mais il s'av√®re qu'en l'absence d'une impl√©mentation explicite, le comportement par d√©faut du CLR lors de l'appel d'une m√©thode d'interface est de rechercher des m√©thodes publiques par nom et signature.  Dans la plupart des cas, cela est normal, car dans VB, vous devez <i>g√©n√©ralement</i> fournir une impl√©mentation pour chaque membre de l'interface que vous impl√©mentez, √† l'exception d'un cas: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  Dans cet exemple, la classe <code>FooDerived</code> souhaite simplement r√©affecter <code>IFoo.Bar</code> √† la nouvelle m√©thode, mais laisse les impl√©mentations restantes inchang√©es.  Il s'av√®re que si le compilateur g√©n√®re simplement la directive <code>FooDerived</code> pour <code>FooDerived</code> , le CLR r√©cup√©rera √©galement <code>FooDerived.Baz</code> tant que nouvelle impl√©mentation de <code>IFoo.Baz</code> (bien que dans cet exemple, il ne soit pas li√© √† <code>IFoo</code> ).  En C #, cela se produit implicitement (et je ne suis pas s√ªr de pouvoir le refuser), mais en VB, le compilateur omet en fait `` Implements '' de la d√©claration enti√®re pour √©viter cela, et red√©finit uniquement les membres sp√©cifiques qui ont √©t√© r√©impl√©ment√©s.  En d'autres termes, si vous demandez √† <code>FooDerived</code> s'il <code>IFoo</code> directement, il r√©pondra non: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  Pourquoi est-ce que je le sais et pourquoi est-ce important?  Depuis de nombreuses ann√©es, les utilisateurs de VB demandent un support pour l'impl√©mentation implicite d'une interface (sans sp√©cifier explicitement <code>Implements</code> dans chaque d√©claration), g√©n√©ralement pour la g√©n√©ration de code.  Le <code>FooDerived.Baz</code> fait d'incorporer cela √† la syntaxe actuelle constituerait une rupture, car <code>FooDerived.Baz</code> d√©sormais implicitement <code>IFoo.Baz</code> , bien qu'il ne l'ait encore jamais fait.  Mais plus r√©cemment, j'ai appris plus sur ce comportement en discutant des probl√®mes de conception potentiels avec la fonctionnalit√© ¬´impl√©mentation d'interface par d√©faut¬ª, qui permettrait aux interfaces d'inclure les impl√©mentations par d√©faut de certains membres et de ne pas n√©cessiter de r√©impl√©mentation dans chaque classe.  Cela serait utile pour les surcharges, par exemple, lorsque l'impl√©mentation est susceptible d'√™tre la m√™me pour tous les impl√©menteurs (d√©l√©gation √† la surcharge principale).  Un autre sc√©nario est le versioning.  Si une interface peut inclure des impl√©mentations par d√©faut, vous pouvez y ajouter de nouveaux membres sans interrompre les anciennes impl√©mentations.  Mais il y a un probl√®me.  √âtant donn√© que le comportement par d√©faut dans le CLR consiste √† rechercher des impl√©mentations publiques par nom et signature, si la classe VB n'impl√©mente pas de membres d'interface avec des impl√©mentations par d√©faut, mais a des membres publics avec un nom et une signature appropri√©s, ils impl√©mentent implicitement ces membres d'interface, m√™me si vous le faites compl√®tement pas cens√©.  Vous pouvez contourner ce probl√®me lorsque l'ensemble des membres de l'interface est connu au moment de la compilation.  Mais si le membre a √©t√© ajout√© apr√®s la compilation du code, il modifie simplement le comportement en mode silencieux. <br><br><a name="section6"></a><h3>  6. VB par d√©faut masque les membres de la classe de base par nom (Shadows), et non par nom et signature (Overloads) </h3><br>  Je pense que cette diff√©rence est assez bien connue.  Le sc√©nario est le suivant: vous <code>DomainObject</code> classe de base ( <code>DomainObject</code> ), √©ventuellement hors de votre contr√¥le, et d√©clarez une m√©thode avec un nom qui a du sens dans le contexte de votre classe, par exemple, <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  Le fait qu'une facture puisse √™tre imprim√©e est logique.  Mais dans la prochaine version de l'API o√π votre classe de base est d√©clar√©e, ils d√©cident pour le d√©bogage d'ajouter √† tous les DomainObjects une m√©thode qui affiche le contenu complet de l'objet dans la fen√™tre de d√©bogage.  Cette m√©thode est brillamment appel√©e Print.  Le probl√®me est que le client de votre API peut remarquer que l'objet Facture a des m√©thodes <code>Print()</code> et <code>Print(Integer)</code> et penser que ce sont des surcharges li√©es.  Peut-√™tre que le premier imprime juste une copie.  Mais ce n'est pas du tout ce que vous avez con√ßu comme l'auteur de Invoice.  Vous ne <code>DomainObject.Print</code> pas que <code>DomainObject.Print</code> appara√Ætrait.  Alors oui, cela ne fonctionne pas en VB.  Lorsque cette situation appara√Æt, un avertissement appara√Æt, mais plus important encore, le comportement par d√©faut dans VB est de se masquer par son nom.  Autrement dit, jusqu'√† ce que vous indiquiez explicitement avec le mot cl√© <code>Overloads</code> que votre <code>Print</code> est une surcharge de <code>Print</code> classe de base, un membre de la classe de base (et toute surcharge de celle-ci) sont compl√®tement masqu√©s.  Seule l'API que vous avez d√©clar√©e √† l'origine est affich√©e pour vos clients de classe.  Cela fonctionne par d√©faut, mais vous pouvez le faire explicitement via le mot cl√© Shadows.  C # ne peut faire que des <code>Overloads</code> (bien qu'il prenne en compte les <code>Shadows</code> lorsqu'il se r√©f√®re √† une biblioth√®que VB) et le fait par d√©faut (en utilisant le <code>new</code> mot-cl√©).  Mais cette diff√©rence appara√Æt de temps en temps lorsque certaines hi√©rarchies d'h√©ritage apparaissent dans des projets o√π une classe est d√©finie dans une langue et une autre dans une autre, et il existe des m√©thodes surcharg√©es, mais cela d√©passe le cadre de l'√©l√©ment actuel dans la liste des diff√©rences. <br><br><a name="section7"></a><h3>  7. Les versions VB11 et inf√©rieures sont plus strictes pour les membres prot√©g√©s dans les g√©n√©riques </h3><br>  En fait, nous avons chang√© cela entre VS2013 et VS2015.  En particulier, nous avons d√©cid√© de ne pas nous soucier de la r√©impl√©mentation.  Mais j'√©cris cette distinction au cas o√π vous utilisez l'ancienne version et que vous la remarquiez.  En bref: si un membre prot√©g√© est d√©clar√© dans le type g√©n√©rique, l'h√©ritier, √©tant √©galement g√©n√©rique, ne peut acc√©der √† ce membre prot√©g√© que via l'instance h√©rit√©e avec les m√™mes arguments de type. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. La syntaxe ¬´argument nomm√©¬ª dans les attributs initialise toujours les propri√©t√©s / champs </h3><br>  VB utilise la m√™me syntaxe <code>:=</code> pour initialiser les propri√©t√©s / champs d'attribut que pour passer des arguments de m√©thode par nom.  Par cons√©quent, il n'existe aucun moyen de transmettre un argument au constructeur d'attribut par son nom. <br><br><a name="section9"></a><h3>  9. Toutes les d√©clarations de niveau sup√©rieur (g√©n√©ralement) sont implicitement situ√©es dans l'espace de noms racine du projet </h3><br>  Cette diff√©rence est presque dans la cat√©gorie ¬´fonctionnalit√©s avanc√©es¬ª, mais je l'ai incluse dans la liste car elle change la signification du code.  Il y a un champ dans les propri√©t√©s du projet VB: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  Par d√©faut, il s'agit simplement du nom de votre projet au moment de sa cr√©ation.  Ce n'est <b>PAS</b> le m√™me champ que "l'espace de noms par d√©faut" dans les propri√©t√©s d'un projet C #.  L'espace de noms par d√©faut d√©finit simplement le code qui est ajout√© par d√©faut aux nouveaux fichiers en C #.  Mais l'espace de noms racine dans VB signifie que, sauf indication contraire, chaque d√©claration de niveau sup√©rieur dans ce projet se trouve implicitement dans cet espace de noms.  C'est pourquoi les mod√®les de document VB ne contiennent g√©n√©ralement aucune d√©claration d'espace de noms.  De plus, si vous ajoutez une d√©claration d'espace de noms, elle ne remplace pas la racine, mais y est ajout√©e: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Ainsi, l'espace de noms <code>Controllers</code> d√©clare en fait l' <code>VBExamples.Controllers</code> noms <code>VBExamples.Controllers</code> , sauf si vous vous d√©barrassez de ce m√©canisme en d√©clarant explicitement <code>Global</code> dans l'espace de noms. <br><br>  C'est pratique car il enregistre un niveau d'indentation et un concept suppl√©mentaire pour chaque fichier VB.  Et cela est particuli√®rement utile si vous cr√©ez une application UWP (car tout doit √™tre dans l'espace de noms dans UWP), et c'est extr√™mement pratique si vous d√©cidez de changer l'espace de noms de niveau sup√©rieur pour l'ensemble de votre projet, par exemple, √† partir d'un nom de code comme Roslyn en une version plus longue, comme <code>Microsoft.CodeAnalysis</code> , car vous n'avez pas √† mettre √† jour manuellement chaque fichier dans la solution.  Il est √©galement important de garder cela √† l'esprit lorsque vous travaillez avec des g√©n√©rateurs de code, des espaces de noms XAML et le nouveau <code>.vbproj</code> fichier <code>.vbproj</code> . <br><br><a name="section10"></a><h3>  10. Les modules ne sont pas g√©n√©r√©s en tant que classes abstraites scell√©es dans IL, ils ne ressemblent donc pas exactement aux classes statiques C # et vice versa. </h3><br>  Les modules en VB existaient avant les classes statiques C #, bien que nous ayons essay√© en 2010 de les rendre identiques en termes d'IL.  Malheureusement, il s'agissait d'un changement de rupture, car le s√©rialiseur XML (ou peut-√™tre qu'il √©tait binaire) pour cette version de .NET (je pense qu'ils l'ont corrig√©) ne voulait pas s√©rialiser le type imbriqu√© dans un type qui ne pouvait pas √™tre cr√©√© (et une classe abstraite ne peut pas).  Il a lev√© une exception. <br><br>  Nous avons trouv√© cela apr√®s avoir apport√© les modifications et les avons annul√©es car du code utilisait quelque part le type d'√©num√©ration incorpor√© dans le module.  Et comme vous ne savez pas avec quelle version du s√©rialiseur le programme compil√© fonctionnera, il ne sera jamais possible de le changer, car dans une version de l'application cela fonctionnera, et dans d'autres cas il l√®vera des exceptions. <br><br><a name="section11"></a><h3>  11. Vous n'avez pas besoin d'une m√©thode explicite pour le point d'entr√©e (Sub Main) dans les applications WinForms </h3><br>  Si votre projet utilise Form comme objet de d√©part et n'utilise pas le ¬´Framework d'application¬ª (plus √† ce sujet dans le prochain article), VB g√©n√®re un <code>Sub Main</code> , qui cr√©e votre formulaire de d√©marrage et le transmet √† <code>Application.Run</code> , vous permettant d'√©conomiser le fichier entier Pour g√©rer ce processus, soit une m√©thode suppl√©mentaire dans votre <code>Form</code> , soit m√™me la n√©cessit√© de r√©fl√©chir √† ce probl√®me. <br><br><a name="section12"></a><h3>  12. Si vous appelez des m√©thodes d'ex√©cution VB obsol√®tes (par exemple, FileOpen), la m√©thode appelante sera implicitement marqu√©e avec un attribut pour d√©sactiver l'inline pour des raisons d'exactitude </h3><br>  En bref, les m√©thodes de travail avec des fichiers de style VB6 comme <code>FileOpen</code> reposent sur des contextes sp√©cifiques √† l'assembly o√π se trouve le code.  Par exemple, le fichier # 1 peut √™tre un journal dans un projet et une configuration dans un autre.  Pour d√©terminer quel assembly est en cours d'ex√©cution, <code>Assembly.GetCallingAssembly()</code> appel√©.  Mais si le JIT <i>ins√®re</i> votre m√©thode dans l'appelant, du point de vue de la pile, la m√©thode d'ex√©cution VB ne sera pas appel√©e par votre m√©thode, mais par l'appelant, qui peut √™tre dans un assembly diff√©rent, qui peut alors autoriser votre code √† acc√©der ou √† violer l'√©tat interne de l'appelant objet.  Ce n'est pas un probl√®me de s√©curit√©, car si le code compromettant s'ex√©cute dans votre processus, vous avez d√©j√† perdu.  C'est une question d'exactitude.  Par cons√©quent, si vous utilisez ces m√©thodes, le compilateur d√©sactive l'inline. <br><br>  Cette modification a √©t√© apport√©e au dernier moment en 2010, car le x64 JIT est TR√àS agressif lors de l'inlining / optimisation du code, et nous l'avons trouv√© tr√®s tard, et c'√©tait l'option la plus s√ªre. <br><br><a name="section13"></a><h3>  13. Si votre type est marqu√© avec l'attribut DesignerGenerated et ne contient aucune d√©claration de constructeur explicite, le compilateur g√©n√©r√© par d√©faut appellera InitializeComponent s'il est d√©fini pour ce type </h3><br>  √Ä l'√©poque avant l'av√®nement des types partiels, l'√©quipe VB a men√© une guerre pour r√©duire le code standard dans les projets WinForms.  Mais m√™me avec <code>Partial</code> cela est utile car il permet au fichier g√©n√©r√© d'omettre compl√®tement le constructeur, et l'utilisateur peut le d√©clarer manuellement dans son fichier si n√©cessaire, ou ne pas le d√©clarer sinon.  Sans cela, le concepteur serait oblig√© d'ajouter un constructeur uniquement pour appeler <code>InitializeComponent</code> , et si l'utilisateur ajoute √©galement, ils seront des doublons, ou la bo√Æte √† outils devrait √™tre suffisamment intelligente pour d√©placer le constructeur du fichier de concepteur vers l'utilisateur et ne pas le r√©g√©n√©rer dans le concepteur, s'il l'a d√©j√† existe dans le fichier utilisateur. <br><br><a name="section14"></a><h3>  14. L'absence du modificateur Partiel ne signifie PAS que le type n'est pas partiel </h3><br>  Techniquement, en VB, une seule classe doit √™tre marqu√©e comme partielle.  Il s'agit g√©n√©ralement (dans les projets GUI) d'un fichier g√©n√©r√©. <br><br>  <b>Pourquoi?</b>  Cela conserve le fichier utilisateur beau et propre, et peut √™tre tr√®s pratique √† inclure apr√®s avoir g√©n√©r√© ou ajout√© au code utilisateur g√©n√©r√©.  Cependant, il est recommand√© qu'au plus une classe n'ait pas de modificateur partiel, sinon un avertissement est √©mis. <br><br><a name="section15"></a><h3>  15. Dans les classes par d√©faut, le niveau d'acc√®s public est pour tout sauf les champs, et dans les structures publiques, pour les champs aussi </h3><br>  J'ai des sentiments mitig√©s √† ce sujet.  En C #, tout est <code>private</code> par d√©faut (acclamations, encapsulation!), Mais il y a un argument √† faire en fonction de ce que vous d√©clarez souvent: un contrat public ou des d√©tails d'impl√©mentation.  Les propri√©t√©s et les √©v√©nements sont g√©n√©ralement destin√©s √† un usage externe ( <code>public</code> ) et les op√©rateurs ne sont pas accessibles autrement que <code>public</code> .  Cependant, je me fie rarement √† l'accessibilit√© par d√©faut (√† l'exception des d√©mos comme les exemples de cet article). <br><br><a name="section16"></a><h3>  16. VB initialise les champs APR√àS l'appel du constructeur de base, tandis que C # les initialise AVANT l'appel du constructeur de base </h3><br>  Avez-vous entendu comment "certains" disent que la premi√®re chose qui se produit dans le constructeur est un appel au constructeur de la classe de base?  Eh bien, ce n'est pas le cas, du moins en C #.  En C #, avant d'appeler <code>base()</code> , explicite ou implicite, les initialiseurs de champ sont ex√©cut√©s en premier, puis l'appel du constructeur, puis votre code.  Cette d√©cision a des cons√©quences, et je pense que je sais pourquoi les d√©veloppeurs de langage pourraient aller d'une mani√®re ou d'une autre.  Je crois que l'une de ces cons√©quences est que le code suivant ne peut pas √™tre directement traduit en C #: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  √Ä l'√©poque o√π j'√©tais engag√© dans Reflection, j'√©crivais souvent un tel code.  Et je me souviens vaguement d'un coll√®gue avant Microsoft (Josh), qui a traduit mon code en C #, se plaignant parfois de la n√©cessit√© de porter tous mes initialiseurs vers le constructeur.  En C #, il est interdit de faire r√©f√©rence √† un objet en cours de cr√©ation avant l'appel de <code>base()</code> .  Et puisque les initialiseurs de champ sont ex√©cut√©s avant l'appel sp√©cifi√©, ils ne peuvent pas non plus faire r√©f√©rence √† d'autres champs ou √† aucun membre de l'instance d'objet.  Cet exemple ne fonctionne donc √©galement qu'en VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Ici, nous avons une classe de base, qui a cens√©ment beaucoup de fonctionnalit√©s, mais elle a besoin d'un objet cl√© pour la gestion, le travail, qui est d√©termin√© par le type d√©riv√©.  Il existe de nombreuses fa√ßons de mettre en ≈ìuvre un tel mod√®le, mais j'utilise g√©n√©ralement celui-ci car: <br><br><ul><li>  il est petit; </li><li>  ne m'oblige pas √† d√©clarer un constructeur; </li><li>  ne n√©cessite pas que je mette le code d'initialisation dans le constructeur, le cas √©ch√©ant; </li><li>  me permet de mettre en cache l'objet cr√©√© et ne n√©cessite pas de types d√©riv√©s pour d√©clarer et g√©rer le stockage de l'objet fourni, bien que ce ne soit plus le cas avec les propri√©t√©s automatiques. </li></ul><br>  De plus, je me suis retrouv√© dans les deux situations: lorsqu'un champ dans un type d√©riv√© voulait appeler une m√©thode d√©clar√©e dans la classe de base, et lorsque l'initialiseur de classe de champ devait appeler le membre <code>MustOverride</code> impl√©ment√© par le type d√©riv√©.  Les deux sont valides en VB et aucun en C #, et cela a du sens.  Si l'initialiseur de champ C # pouvait appeler un membre de la classe de base, ce membre pourrait d√©pendre des champs initialis√©s dans le constructeur de base (qui n'est pas d√©j√† en cours d'ex√©cution) et les r√©sultats seraient presque certainement faux, et il n'y avait aucun moyen de contourner cela. <br><br>  Mais en VB, le constructeur de base a d√©j√† fonctionn√©, vous pouvez donc tout faire!  Dans le cas contraire, tout est un peu plus compliqu√©, car appeler le membre <code>Overridable</code> depuis l'initialiseur (ou constructeur) de la classe de base peut conduire √† acc√©der aux champs avant qu'ils ne soient ¬´initialis√©s¬ª.  Mais seule votre impl√©mentation sait si c'est un probl√®me.  Dans mes scripts, cela ne se produit tout simplement pas.  Ils ne d√©pendent pas de l'√©tat de l'instance, mais ne peuvent pas √™tre des membres <code>Shared</code> car vous ne pouvez pas avoir de membre <code>Shared Overridable</code> dans n'importe quelle langue pour des raisons techniques d√©passant le cadre de cet article.  De plus, il est clairement d√©fini ce qui arrive aux champs avant de d√©marrer les initialiseurs personnalis√©s - ils sont initialis√©s avec des valeurs par d√©faut, comme toutes les variables dans VB.  Pas de surprise. <br><br>  <b>Alors pourquoi?</b>  En fait, je ne sais pas si mes scripts √©taient ce que l'√©quipe originale de VB.NET avait en t√™te quand ils l'ont con√ßu.  Cela fonctionne juste dans mon cas!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    ¬´¬ª ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             ¬´WithEvents¬ª,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ‚Ä¶.   VB     ¬´ ¬ª    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       ¬´¬ª       ,    ¬´ ¬ª. <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA ¬´Expert Business Objects¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  Instructions </h2><br><a name="section21"></a><h3> 21.    ‚Äî    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try ‚Äî    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      ¬´¬ª.  VB6        Quick Basic  ( )       .      QB,      .     ,       ¬´ ¬ª,           .        GoTo,         ‚Äî   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       ¬´¬ª.   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       ¬´ ¬ª ( <i>definite assignment</i> ).   ,    , ,         ¬´ ¬ª.   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , ‚Äî  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      ¬´¬ª ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       ¬´ ¬ª,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB ‚Äî        ,     <code>null</code> ( ),    <code>null</code> - ‚Äî  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , ‚Äî     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   ¬´ ¬ª         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   ¬´¬ª (fall-through);   break </h3><br>     Friday    ,  Sunday ‚Äî  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>¬´,    ?   !¬ª</i>   <i>¬´,  ¬ª</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> ‚Äî   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> ‚Äî  ,           , ‚Ä¶ <br></li><li> <code>switch</code> ‚Äî   / ,   ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>   ¬ª. <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>¬´     ,    ,    ¬ª</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> ‚Äî ¬´ ¬ª, -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API ‚Äî ! ( <i>¬´‚Ä¶ ‚Ä¶  ?¬ª</i> ) <br><br>  <b>Pourquoi?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   ¬´ ¬ª.   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   ‚Äî .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  Minute de publicit√©. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443684/">https://habr.com/ru/post/fr443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443672/index.html">Tests bas√©s sur les risques</a></li>
<li><a href="../fr443676/index.html">Vinyle au lieu d'un timbre-poste: raret√© inhabituelle</a></li>
<li><a href="../fr443678/index.html">Lisibilit√© du code</a></li>
<li><a href="../fr443680/index.html">Semaine de travail de quatre jours. Exp√©rience russe</a></li>
<li><a href="../fr443682/index.html">Mon√©tisation du cloud: comment attirer des clients et ne pas faire faillite</a></li>
<li><a href="../fr443686/index.html">30 - 31 mars, SIBUR CHALLENGE √† Nizhny Novgorod</a></li>
<li><a href="../fr443690/index.html">Parallels RAS: qu'est-ce que c'est et avec quoi mange-t-il?</a></li>
<li><a href="../fr443692/index.html">Alchimie du 21e si√®cle: conversion du deut√©rium en m√©tal liquide en plasma</a></li>
<li><a href="../fr443694/index.html">Comment le navigateur aide le camarade Major</a></li>
<li><a href="../fr443698/index.html">Google a cess√© d '"√©trangler l'oie": DuckDuckGo est inclus dans la liste des moteurs de recherche Chrome standard pour 60 pays</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>