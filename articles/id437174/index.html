<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò∞ üë¶üèª ‚òÄÔ∏è .NET, TensorFlow, dan kincir angin Kaggle - perjalanan dimulai üçå üëèüèº üï¥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ini adalah serangkaian artikel tentang perjalanan berkelanjutan saya ke hutan gelap kompetisi Kaggle sebagai pengembang .NET. 

 Saya akan fokus pada ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>.NET, TensorFlow, dan kincir angin Kaggle - perjalanan dimulai</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437174/"><img src="https://habrastorage.org/webt/tc/fj/ml/tcfjml8-rk618mttrw9qhvfan_u.png" align="left">  Ini adalah serangkaian artikel tentang perjalanan berkelanjutan saya ke hutan gelap kompetisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" title="Kaggle">Kaggle</a> sebagai pengembang .NET. <br><br>  Saya akan fokus pada (hampir) jaringan saraf murni dalam artikel ini dan berikut.  Ini berarti, bahwa sebagian besar bagian membosankan dari persiapan dataset, seperti mengisi nilai yang hilang, pemilihan fitur, analisis pencilan, dll.  akan sengaja dilewati. <br><br>  Tumpukan teknologi akan menjadi C # + TensorFlow <i>tf.keras</i> API.  Mulai hari ini juga akan memerlukan Windows.  Model yang lebih besar di artikel mendatang mungkin membutuhkan GPU yang sesuai agar waktu pelatihan mereka tetap waras. <br><a name="habracut"></a><br><h2>  Mari kita prediksi harga real estat! </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">House Prices</a> adalah kompetisi yang bagus untuk pemula.  Datasetnya kecil, tidak ada aturan khusus, papan publik memiliki banyak peserta, dan Anda dapat mengirimkan hingga 4 entri sehari. <br><br>  Daftar di Kaggle, jika Anda belum melakukannya, bergabunglah dengan kompetisi ini, dan unduh datanya.  Sasarannya adalah untuk memprediksi harga jual (kolom SalePrice) untuk entri dalam <i>test.csv</i> .  Arsip berisi <i>train.csv</i> , yang memiliki sekitar 1500 entri dengan harga jual yang dikenal untuk <i>pelatihan</i> .  Kami akan mulai dengan memuat dataset itu, dan menjelajahinya sedikit, sebelum masuk ke jaringan saraf. <br><br><h2>  Analisis data pelatihan </h2><br>  <i>Apakah saya mengatakan kami akan melewatkan persiapan dataset?</i>  <i>Saya berbohong!</i>  <i>Anda harus melihatnya setidaknya sekali.</i> <br><br>  Yang mengejutkan saya, saya tidak menemukan cara mudah untuk memuat file .csv di perpustakaan kelas standar .NET, jadi saya menginstal paket NuGet, yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CsvHelper</a> .  Untuk mempermudah manipulasi data, saya juga mendapatkan paket ekstensi LINQ favorit saya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MoreLinq</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Memuat data .csv ke dalam DataTable</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DataTable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> csvFilePath</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataTable(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CsvDataReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CsvReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamReader(csvFilePath)))) { result.Load(reader); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ML.NET</b> <div class="spoiler_text">  Menggunakan <i>DataTable</i> untuk melatih manipulasi data, sebenarnya, adalah ide yang buruk. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ML.NET</a> seharusnya memiliki pemuatan .csv dan banyak operasi pemeliharaan dan eksplorasi data.  Namun, itu belum siap untuk tujuan tertentu, ketika saya baru saja memasuki kompetisi House Prices. <br></div></div><br><br>  Data terlihat seperti ini (hanya beberapa baris dan kolom): <br><br><table><tbody><tr><td>  Id </td><td>  MSSubClass </td><td>  Menandai </td><td>  LotFrontage </td><td>  Lotarea </td></tr><tr><td>  1 </td><td>  60 </td><td>  RL </td><td>  65 </td><td>  8450 </td></tr><tr><td>  2 </td><td>  20 </td><td>  RL </td><td>  80 </td><td>  9600 </td></tr><tr><td>  3 </td><td>  60 </td><td>  RL </td><td>  68 </td><td>  11250 </td></tr><tr><td>  4 </td><td>  70 </td><td>  RL </td><td>  60 </td><td>  9550 </td></tr></tbody></table><br><br>  Setelah memuat data, kami perlu menghapus kolom <i>Id</i> , karena sebenarnya tidak terkait dengan harga rumah: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> trainData = LoadData(<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>); trainData.Columns.Remove(<span class="hljs-string"><span class="hljs-string">"Id"</span></span>);</code> </pre> <br><h3>  Menganalisis tipe data kolom </h3><br>  DataTable tidak secara otomatis menyimpulkan tipe data kolom, dan menganggap itu semua string.  Jadi langkah selanjutnya adalah menentukan apa yang sebenarnya kita miliki.  Untuk setiap kolom saya menghitung statistik berikut: jumlah nilai yang berbeda, berapa banyak dari mereka adalah bilangan bulat, dan berapa banyak dari mereka adalah angka floating point (kode sumber dengan semua metode pembantu akan dihubungkan pada akhir artikel): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> values = rows.Select(row =&gt; (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)row[column]); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> floats = values.Percentage(v =&gt; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> _)); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> ints = values.Percentage(v =&gt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> _)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distincts = values.Distinct().Count();</code> </pre> <br><h3>  Kolom angka </h3><br>  Ternyata sebagian besar kolom sebenarnya int, tetapi karena sebagian besar jaringan saraf bekerja pada angka mengambang, kita akan mengubahnya menjadi ganda. <br><br><h3>  Kolom kategorikal </h3><br>  Kolom lain menggambarkan kategori milik properti yang dijual.  Tidak ada satu pun dari mereka yang memiliki terlalu banyak nilai berbeda, yang bagus.  Untuk menggunakannya sebagai input untuk jaringan saraf kita di masa depan, mereka harus dikonversi menjadi <i>dua kali lipat</i> juga. <br><br>  Awalnya, saya hanya menetapkan angka dari 0 ke differValueCount - 1 untuk mereka, tetapi itu tidak masuk akal, karena sebenarnya tidak ada perkembangan dari "Facade: Blue" melalui "Facade: Green" menjadi "Facade: White".  Jadi sejak awal saya mengubahnya menjadi apa yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pengkodean satu-panas</a> , di mana setiap nilai unik mendapat kolom input yang terpisah.  Misalnya "Fasad: Biru" menjadi [1,0,0], dan "Fasad: Putih" menjadi [0,0,1]. <br><br><h3>  Menyatukan mereka semua </h3><br><div class="spoiler">  <b class="spoiler_title">Output besar dari eksplorasi data</b> <div class="spoiler_text">  CentralAir: 2 nilai, int: 0,00%, mengapung: 0,00% <br>  Jalan: 2 nilai, int: 0,00%, mengapung: 0,00% <br>  Utilitas: 2 nilai, int: 0,00%, mengapung: 0,00% <br>  Gang: 3 nilai, ints: 0,00%, mengapung: 0,00% <br>  BsmtHalfBath: 3 nilai, int: 100,00%, mengapung: 100,00% <br>  HalfBath: 3 nilai, int: 100,00%, mengapung: 100,00% <br>  LandSlope: 3 nilai, ints: 0,00%, mengapung: 0,00% <br>  PavedDrive: 3 nilai, ints: 0,00%, mengapung: 0,00% <br>  BsmtFullBath: 4 nilai, int: 100,00%, mengapung: 100,00% <br>  ExterQual: 4 nilai, ints: 0,00%, mengapung: 0,00% <br>  Perapian: 4 nilai, int: 100,00%, mengapung: 100,00% <br>  FullBath: 4 nilai, int: 100,00%, mengapung: 100,00% <br>  GarageFinish: 4 nilai, int: 0,00%, mengapung: 0,00% <br>  KitchenAbvGr: 4 nilai, int: 100,00%, mengapung: 100,00% <br>  DapurKual: 4 nilai, int: 0,00%, mengapung: 0,00% <br>  LandContour: 4 nilai, ints: 0,00%, mengapung: 0,00% <br>  LotShape: 4 nilai, ints: 0,00%, mengapung: 0,00% <br>  PoolQC: 4 nilai, ints: 0,00%, mengapung: 0,00% <br>  BldgType: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  BsmtCond: 5 nilai, int: 0,00%, mengapung: 0,00% <br>  BsmtExposure: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  BsmtQual: 5 nilai, int: 0,00%, mengapung: 0,00% <br>  ExterCond: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  Pagar: 5 nilai, int: 0,00%, mengapung: 0,00% <br>  GarageCars: 5 nilai, int: 100,00%, mengapung: 100,00% <br>  HeatingQC: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  LotConfig: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  MasVnrType: 5 nilai, int: 0,00%, mengapung: 0,00% <br>  MiscFeature: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  MSZoning: 5 nilai, ints: 0,00%, mengapung: 0,00% <br>  YrSold: 5 nilai, int: 100,00%, mengapung: 100,00% <br>  Listrik: 6 nilai, int: 0,00%, mengapung: 0,00% <br>  FireplaceQu: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  Foundation: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  GarageCond: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  GarageQual: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  Pemanasan: 6 nilai, int: 0,00%, mengapung: 0,00% <br>  RoofStyle: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  SaleCondition: 6 nilai, ints: 0,00%, mengapung: 0,00% <br>  Nilai BsmtFinType1: 7, int: 0,00%, mengapung: 0,00% <br>  Nilai BsmtFinType2: 7, int: 0,00%, mengapung: 0,00% <br>  Fungsional: 7 nilai, ints: 0,00%, mengapung: 0,00% <br>  GarageType: 7 nilai, ints: 0,00%, mengapung: 0,00% <br>  BedroomAbvGr: 8 nilai, int: 100,00%, mengapung: 100,00% <br>  Kondisi2: 8 nilai, ints: 0,00%, mengapung: 0,00% <br>  HouseStyle: 8 nilai, ints: 0,00%, mengapung: 0,00% <br>  PoolArea: 8 nilai, int: 100,00%, mengapung: 100,00% <br>  RoofMatl: 8 nilai, ints: 0,00%, mengapung: 0,00% <br>  Kondisi1: 9 nilai, ints: 0,00%, mengapung: 0,00% <br>  OverallCond: 9 nilai, ints: 100.00%, mengapung: 100.00% <br>  SaleType: 9 nilai, ints: 0,00%, mengapung: 0,00% <br>  KeseluruhanKual: 10 nilai, int: 100,00%, mengapung: 100,00% <br>  MoSold: 12 nilai, int: 100,00%, mengapung: 100,00% <br>  TotRmsAbvGrd: 12 nilai, int: 100,00%, mengapung: 100,00% <br>  Exterior1st: 15 nilai, ints: 0,00%, mengapung: 0,00% <br>  MSSubClass: 15 nilai, int: 100,00%, mengapung: 100,00% <br>  Exterior2nd: 16 nilai, ints: 0,00%, mengapung: 0,00% <br>  3SsnPorch: 20 nilai, int: 100,00%, mengapung: 100,00% <br>  MiscVal: 21 nilai, int: 100,00%, mengapung: 100,00% <br>  LowQualFinSF: 24 nilai, int: 100,00%, mengapung: 100,00% <br>  Sekitar: 25 nilai, int: 0,00%, mengapung: 0,00% <br>  YearRemodTambahkan: 61 nilai, int: 100,00%, mengapung: 100,00% <br>  ScreenPorch: 76 nilai, int: 100,00%, mengapung: 100,00% <br>  GarageYrBlt: nilai 98, int: 94,45%, mengapung: 94,45% <br>  LotFrontage: nilai 111, ints: 82,26%, mengapung: 82,26% <br>  YearBuilt: 112 nilai, int: 100,00%, mengapung: 100,00% <br>  EnclosedPorch: 120 nilai, int: 100,00%, mengapung: 100,00% <br>  BsmtFinSF2: 144 nilai, int: 100,00%, mengapung: 100,00% <br>  OpenPorchSF: 202 nilai, int: 100,00%, mengapung: 100,00% <br>  WoodDeckSF: 274 nilai, int: 100,00%, mengapung: 100,00% <br>  MasVnrArea: 328 nilai, ints: 99,45%, mengapung: 99,45% <br>  2ndFlrSF: nilai 417, int: 100,00%, mengapung: 100,00% <br>  GarageArea: nilai 441, int: 100,00%, mengapung: 100,00% <br>  BsmtFinSF1: nilai 637, int: 100,00%, mengapung: 100,00% <br>  SaleHarga: 663 nilai, int: 100,00%, mengapung: 100,00% <br>  TotalBsmtSF: nilai 721, int: 100,00%, mengapung: 100,00% <br>  1stFlrSF: 753 nilai, int: 100,00%, mengapung: 100,00% <br>  BsmtUnfSF: 780 nilai, int: 100,00%, mengapung: 100,00% <br>  GrLivArea: nilai 861, int: 100,00%, mengapung: 100,00% <br>  LotArea: nilai 1073, int: 100,00%, mengapung: 100,00% <br><br>  Banyak kolom nilai: <br>  Eksterior1st: AsbShng, AsphShn, BrkComm, BrkFace, CBlock, CemntBd, HdBoard, ImStucc, MetalSd, Kayu Lapis, Batu, Semen, VinylSd, Wd Sdng, WdShing <br>  Eksterior2nd: AsbShng, AsphShn, Brk Cmn, BrkFace, CBlock, CmentBd, HdBoard, ImStucc, MetalSd, Lainnya, Kayu Lapis, Batu, Semen, VinylSd, Wd Sdng, Wd Shng <br>  Sekitar: Blmngtn, Blueste, BrDale, BrkSide, ClearCr, CollgCr, Crawfor, Edwards, Gilbert, IDOTRR, MeadowV, Mitchel, NAmes, NoRidge, NPkVill, NridgHt, NWAmes, OldTown, Sawyer, SawyerW, Somerst, Stone, Stoner Veenker <br><br>  pelampung yang tidak dapat diurai <br>  GarageYrBlt: NA <br>  LotFrontage: NA <br>  MasVnrArea: NA <br><br>  rentang mengambang: <br>  BsmtHalfBath: 0 ... 2 <br>  HalfBath: 0 ... 2 <br>  BsmtFullBath: 0 ... 3 <br>  Perapian: 0 ... 3 <br>  FullBath: 0 ... 3 <br>  DapurAbvGr: 0 ... 3 <br>  GarageCars: 0 ... 4 <br>  YrSold: 2006 ... 2010 <br>  Kamar TidurAbvGr: 0 ... 8 <br>  PoolArea: 0 ... 738 <br>  OverallCond: 1 ... 9 <br>  KeseluruhanQual: 1 ... 10 <br>  MoSold: 1 ... 12 <br>  TotRmsAbvGrd: 2 ... 14 <br>  MSSubClass: 20 ... 190 <br>  3SsnPorch: 0 ... 508 <br>  MiscVal: 0 ... 15500 <br>  RendahQualFinSF: 0 ... 572 <br>  YearRemodAdd: 1950 ... 2010 <br>  ScreenPorch: 0 ... 480 <br>  GarageYrBlt: 1900 ... 2010 <br>  LotFrontage: 21 ... 313 <br>  YearBuilt: 1872 ... 2010 <br>  TertutupPorch: 0 ... 552 <br>  BsmtFinSF2: 0 ... 1474 <br>  OpenPorchSF: 0 ... 547 <br>  WoodDeckSF: 0 ... 857 <br>  MasVnrArea: 0 ... 1600 <br>  2ndFlrSF: 0 ... 2065 <br>  GarageArea: 0 ... 1418 <br>  BsmtFinSF1: 0 ... 5644 <br>  SaleHarga: 34.900 ... 755.000 <br>  TotalBsmtSF: 0 ... 6110 <br>  1stFlrSF: 334 ... 4692 <br>  BSmtUnfSF: 0 ... 2336 <br>  GrLivArea: 334 ... 5642 <br>  LotArea: 1300 ... 215245 <br></div></div><br><br>  Dengan mengingat hal itu, saya membuat <i>ValueNormalizer</i> berikut, yang mengambil beberapa info tentang nilai-nilai di dalam kolom, dan mengembalikan fungsi, yang mengubah nilai ( <i>string</i> ) menjadi vektor fitur numerik untuk jaringan saraf ( <i>double []</i> ): <br><br><div class="spoiler">  <b class="spoiler_title">ValueNormalizer</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[]&gt; ValueNormalizer( <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> floats, IEnumerable&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; values) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (floats &gt; <span class="hljs-number"><span class="hljs-number">0.01</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> max = values.AsDouble().Max().Value; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.TryParse(s, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> v) ? v / max : <span class="hljs-number"><span class="hljs-number">-1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] domain = values.Distinct().OrderBy(v =&gt; v).ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[domain.Length+<span class="hljs-number"><span class="hljs-number">1</span></span>] .Set(Array.IndexOf(domain, s)+<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> <br></div></div><br>  Sekarang kita punya data yang dikonversi menjadi format, cocok untuk jaringan saraf.  Sudah waktunya untuk membangun satu. <br><br><h2>  Membangun jaringan saraf </h2><br>  <i>Mulai hari ini, Anda harus menggunakan mesin Windows untuk itu.</i> <br><br>  Jika Anda sudah menginstal Python dan TensorFlow 1.1x, yang Anda butuhkan adalah <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gradient"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.1.10-tech-preview3"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  dalam file .csproj modern Anda.  Jika tidak, lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">manual Gradient</a> untuk melakukan pengaturan awal. <br><br>  Setelah paket aktif dan berjalan, kita dapat membuat jaringan mendalam pertama kami. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.keras; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.keras.layers; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> tensorflow.train; ... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sequential(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layer[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">16</span></span>, activation: tf.nn.relu_fn), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dropout(rate: <span class="hljs-number"><span class="hljs-number">0.1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">10</span></span>, activation: tf.nn.relu_fn), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dense(units: <span class="hljs-number"><span class="hljs-number">1</span></span>, activation: tf.nn.relu_fn), }); model.compile(optimizer: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdamOptimizer(), loss: <span class="hljs-string"><span class="hljs-string">"mean_squared_error"</span></span>);</code> </pre> <br>  Ini akan membuat jaringan saraf yang tidak terlatih dengan 3 lapisan neuron, dan lapisan putus, yang membantu mencegah overfitting. <br><br><div class="spoiler">  <b class="spoiler_title">tf.nn.relu_fn</b> <div class="spoiler_text">  <i>tf.nn.relu_fn</i> adalah fungsi aktivasi untuk neuron kita.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ReLU</a> dikenal bekerja dengan baik di jaringan yang dalam, karena memecahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">masalah gradien yang hilang</a> : turunan dari fungsi aktivasi non-linear asli cenderung menjadi sangat kecil ketika kesalahan diperbanyak kembali dari lapisan output di jaringan yang dalam.  Itu berarti, bahwa lapisan yang lebih dekat ke input hanya akan menyesuaikan sedikit, yang memperlambat pelatihan jaringan dalam secara signifikan. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Putus sekolah</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dropout</a> adalah lapisan fungsi-khusus dalam jaringan saraf, yang sebenarnya tidak mengandung neuron.  Sebagai gantinya, ia beroperasi dengan mengambil setiap input individu, dan secara acak menggantinya dengan 0 pada output sendiri (jika tidak hanya melewati nilai asli bersama).  Dengan melakukan hal itu membantu mencegah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">overfitting</a> ke fitur yang kurang relevan dalam dataset kecil.  Misalnya, jika kami tidak menghapus kolom <i>Id</i> , jaringan mungkin berpotensi menghafal pemetaan &lt;Id&gt; -&gt; &lt;SalePrice&gt;, yang akan memberi kami akurasi 100% pada set pelatihan, tetapi angka yang sama sekali tidak terkait pada data lain. <br><br>  Mengapa kita perlu putus sekolah?  Data pelatihan kami hanya memiliki ~ 1500 contoh, dan jaringan saraf kecil yang kami bangun ini memiliki&gt; 1.800 bobot yang bisa disetel.  Jika itu adalah polinomial sederhana, itu bisa cocok dengan fungsi harga yang kami coba perkiraan dengan tepat.  Tetapi kemudian akan memiliki nilai yang sangat besar pada input di luar set pelatihan asli. <br></div></div><br><h2>  Beri makan data </h2><br>  TensorFlow mengharapkan datanya baik dalam array NumPy, atau tensor yang ada.  Saya mengubah DataRows menjadi array NumPy: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> numpy; ... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> predict = <span class="hljs-string"><span class="hljs-string">"SalePrice"</span></span>; <span class="hljs-function"><span class="hljs-function">ndarray </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetInputs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;DataRow&gt; rowSeq</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array(rowSeq.Select(row =&gt; np.array( columnTypes .Where(c =&gt; c.column.ColumnName != predict) .SelectMany(column =&gt; column.normalizer( row.Table.Columns.Contains(column.column.ColumnName) ? (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>)row[column.column.ColumnName] : <span class="hljs-string"><span class="hljs-string">"-1"</span></span>)) .ToArray())) .ToArray() ); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> predictColumn = columnTypes.Single(c =&gt; c.column.ColumnName == predict); ndarray trainOutputs = np.array(predictColumn.trainValues .AsDouble() .Select(v =&gt; v ?? <span class="hljs-number"><span class="hljs-number">-1</span></span>) .ToArray()); ndarray trainInputs = GetInputs(trainRows);</code> </pre> <br>  Dalam kode di atas kami mengkonversi setiap <i>DataRow</i> menjadi <i>ndarray</i> dengan mengambil setiap sel di dalamnya, dan menerapkan <i>ValueNormalizer yang</i> sesuai dengan kolomnya.  Lalu kita meletakkan semua baris ke <i>ndarray</i> lain, mendapatkan array array. <br><br>  Tidak diperlukan transformasi seperti itu untuk keluaran, tempat kami hanya mengonversi nilai kereta ke <i>ndarray</i> lain. <br><br><h2>  Saatnya turun gradien </h2><br>  Dengan pengaturan ini, yang perlu kita lakukan untuk melatih jaringan kita adalah memanggil fungsi <i>fit</i> model: <br><br><pre> <code class="cs hljs">model.fit(trainInputs, trainOutputs, epochs: <span class="hljs-number"><span class="hljs-number">2000</span></span>, validation_split: <span class="hljs-number"><span class="hljs-number">0.075</span></span>, verbose: <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  Panggilan ini sebenarnya akan menyisihkan 7,5% terakhir dari pelatihan yang ditetapkan untuk validasi, kemudian ulangi sebanyak 2000 kali berikut ini: <br><br><ol><li>  membagi sisa <i>trainInput</i> menjadi batch </li><li>  memberi makan batch ini satu per satu ke dalam jaringan saraf </li><li>  hitung kesalahan menggunakan fungsi kerugian yang kami definisikan di atas </li><li>  backpropagate kesalahan melalui gradien koneksi neuron individu, menyesuaikan bobot </li></ol><br>  Saat pelatihan, itu akan menampilkan kesalahan jaringan pada data yang disisihkan untuk validasi sebagai <b>val_loss</b> dan kesalahan pada data pelatihan itu sendiri sebagai <b>kerugian</b> saja.  Secara umum, jika <b>val_loss</b> menjadi lebih besar, daripada <b>kerugian</b> , itu berarti jaringan mulai overfitting.  Saya akan membahasnya secara lebih rinci dalam artikel-artikel berikut. <br><br>  Jika Anda melakukan semuanya dengan benar, <u>akar kuadrat</u> dari salah satu kerugian Anda harus berada di urutan 20000. <br><br><img src="https://habrastorage.org/webt/fu/rn/vg/furnvg6dbs8ocijm91_3xcqdxhm.png"><br><br><h2>  Kiriman </h2><br>  Saya tidak akan bicara banyak tentang menghasilkan file untuk dikirim di sini.  Kode untuk menghitung output sederhana: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SubmissionInputFile = <span class="hljs-string"><span class="hljs-string">"test.csv"</span></span>; DataTable submissionData = LoadData(SubmissionInputFile); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> submissionRows = submissionData.Rows.Cast&lt;DataRow&gt;(); ndarray submissionInputs = GetInputs(submissionRows); ndarray sumissionOutputs = model.predict(submissionInputs);</code> </pre> <br>  yang sebagian besar menggunakan fungsi, yang didefinisikan sebelumnya. <br><br>  Maka Anda perlu menuliskannya ke file .csv, yang hanya merupakan daftar pasangan Id, predict_value. <br><br>  Ketika Anda mengirimkan hasil Anda, Anda harus mendapatkan skor pada urutan 0,17, yang akan berada di suatu tempat di kuartal terakhir tabel papan publik.  Tapi hei, jika sesederhana jaringan 3 layer dengan 27 neuron, para ilmuwan data sial itu tidak akan mendapatkan $ 300k + / y total kompensasi dari perusahaan-perusahaan besar AS <br><br><h2>  Membungkus </h2><br>  Kode sumber lengkap untuk entri ini (dengan semua pembantu, dan beberapa bagian komentar dari eksplorasi dan eksperimen saya sebelumnya) adalah sekitar 200 baris di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PasteBin</a> . <br><br>  Pada artikel berikutnya Anda akan melihat orang-orang jahat saya mencoba masuk ke dalam 50% teratas dari papan peringkat publik.  Ini akan menjadi petualangan seorang penjelajah amatir, pertarungan dengan The Windmill of Overfitting dengan satu-satunya alat yang dimiliki pengembara - model yang lebih besar (mis. NN dalam, ingat, tidak ada rekayasa fitur manual!).  Ini akan menjadi kurang dari tutorial pengkodean, dan lebih dari pencarian pikiran dengan matematika yang benar-benar jahat dan kesimpulan yang aneh.  Tetap disini! <br><br><h2>  Tautan </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kaggle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Persaingan Harga Rumah di Kaggle</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tutorial regresi TensorFlow</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Halaman muka TensorFlow</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Referensi TensorFlow API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gradient (TensorFlow binding)</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id437174/">https://habr.com/ru/post/id437174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id437160/index.html">Devops</a></li>
<li><a href="../id437164/index.html"># 10yearschallenge untuk programmer</a></li>
<li><a href="../id437166/index.html">Penerbangan tempur di Meteor-e</a></li>
<li><a href="../id437170/index.html">Facebook menyarankan penggunaan laser luar angkasa untuk komunikasi global</a></li>
<li><a href="../id437172/index.html">IBM MQ dan JMeter: Kontak Pertama</a></li>
<li><a href="../id437176/index.html">Aplikasi untuk iOS dan Android di Kotlin + Flutter UI</a></li>
<li><a href="../id437180/index.html">Harsh Siberian JVM: wawancara hebat tentang Excelsior JET</a></li>
<li><a href="../id437182/index.html">Intersepsi panggilan sistem dalam modul Linux-kernel</a></li>
<li><a href="../id437184/index.html">Nikolay Durov 90% menyelesaikan pengembangan platform Telegram Open Network</a></li>
<li><a href="../id437186/index.html">Monolith ke layanan microser. Sudut pandang infrastruktur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>