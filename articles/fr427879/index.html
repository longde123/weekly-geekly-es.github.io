<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∂Ô∏è üéõÔ∏è üë∫ Comment je suis pass√© de Python √† Julia (et pourquoi) üëßüèø üéæ üåó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un peu d'histoire sur Python 
 Python est un excellent langage. J'ai essay√© plusieurs langues avant: Pascal √† l'√©cole; C, C avec cours, C ++ √† l'unive...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment je suis pass√© de Python √† Julia (et pourquoi)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427879/"><h3>  Un peu d'histoire sur Python </h3><br>  Python est un excellent langage.  J'ai essay√© plusieurs langues avant: Pascal √† l'√©cole;  C, C avec cours, C ++ √† l'universit√©.  Les deux (trois) derniers ont instill√© une forte aversion pour la programmation: au lieu de r√©soudre le probl√®me, vous vous trompez d'allocations et de destructeurs (mots effrayants du pass√©), vous pensez en termes de primitives de bas niveau.  Mon opinion est que C ne convient pas pour r√©soudre des probl√®mes √©ducatifs et scientifiques (en tout cas, dans le domaine des math√©matiques).  Je suis s√ªr qu'ils s'opposeront √† moi, mais je n'essaie d'imposer quoi que ce soit √† personne, j'exprime simplement mon opinion. <br><br>  Python √©tait autrefois une r√©v√©lation.  Pour la premi√®re fois de ma vie, j'ai √©crit plusieurs niveaux d'abstraction sup√©rieurs √† ce qui est habituel en C.  La distance entre la t√¢che et le code a √©t√© r√©duite comme jamais auparavant. <br><br>  J'aurais probablement fait √ßa toute ma vie en Python si je n'avais pas eu √† mettre en place subitement des tests statistiques NIST.  Il semblerait que la t√¢che soit tr√®s simple: il y a un tableau de longueur plusieurs (&gt; = 10) m√©gaoctets, il y a un ensemble de tests qui doivent √™tre appliqu√©s √† ce tableau. <br><a name="habracut"></a><br><h3>  √Ä quoi sert bon numpy? </h3><br>  En python, il existe un bon paquet numpy pour travailler avec des tableaux, qui est essentiellement une interface de haut niveau pour des biblioth√®ques rapides comme LAPACK.  Il semblerait que l'ensemble complet de gentleman pour le calcul scientifique soit disponible (Sympy, Numpy, Scipy, Matplotlib), que demander de plus? <br><br>  Tous ceux qui ont trait√© avec numpy savent qu'il est bon, mais pas en tout.  Nous devons √©galement essayer de nous assurer que les op√©rations sont vectoris√©es (comme dans R), c'est-√†-dire  en un sens, uniforme pour l'ensemble du r√©seau.  Si tout √† coup votre probl√®me pour une raison quelconque ne rentre pas dans ce paradigme, alors vous avez des probl√®mes. <br><br>  De quel type de t√¢ches non vectoris√©es est-ce que je parle?  Oui, prenez au moins le m√™me NIST: calculez la longueur du registre √† d√©calage lin√©aire en utilisant l'algorithme Berlekamp-Messi;  calculer la longueur de la sous-s√©quence la plus longue d'unit√©s cons√©cutives et ainsi de suite.  Je n'exclus pas la possibilit√© qu'il existe une sorte de solution ing√©nieuse qui r√©duira le probl√®me √† une solution vectoris√©e. <br><br><div class="spoiler">  <b class="spoiler_title">Rus√©?</b> <div class="spoiler_text">  A titre d'exemple du m√™me NIST: il a fallu calculer le nombre de ¬´switchs¬ª de la s√©quence, o√π par ¬´switch¬ª je veux dire changer les unit√©s cons√©cutives (... 1111 ...) en z√©ros cons√©cutifs (... 000 ... ), et vice versa.  Pour ce faire, vous pouvez prendre la s√©quence d'origine sans le dernier √©l√©ment (x [: -1]) et en soustraire la s√©quence d√©cal√©e de 1 (x [2:]), puis calculer le nombre d'√©l√©ments non nuls dans la nouvelle s√©quence r√©sultante.  Tous ensemble ressembleront √†: <br><br><pre><code class="python hljs">np.count_nonzero(x[:<span class="hljs-number"><span class="hljs-number">-1</span></span>] - x[<span class="hljs-number"><span class="hljs-number">1</span></span>:])</code> </pre> <br>  Cela peut ressembler √† une s√©ance d'entra√Ænement divertissante pour l'esprit, mais essentiellement quelque chose de non naturel se produit ici, une astuce qui ne sera pas √©vidente pour le lecteur apr√®s un court laps de temps.  Sans oublier que c'est encore lent - personne n'a annul√© l'allocation de m√©moire. <br></div></div><br>  Les op√©rations non vectoris√©es en Python sont longues.  Comment y faire face si numpy ne suffit pas?  Ils proposent g√©n√©ralement plusieurs solutions: <br><br><ol><li>  <b>Numba JIT.</b>  Si elle a travaill√© comme d√©crit sur la page de titre de Numba, alors je pense que cela vaudrait la peine de terminer l'histoire.  J'avais un peu oubli√© par le pass√© ce qui avait mal tourn√© avec elle;  l'essentiel est que l'acc√©l√©ration n'a pas √©t√© aussi impressionnante que je m'y attendais, h√©las. </li><li>  <b>Cython.</b>  OK, levez la main ceux qui croient que le cython est une solution vraiment belle et √©l√©gante qui ne d√©truit pas le sens et l'esprit m√™me de Python?  Je ne le pense pas;  si vous arrivez √† Cython, vous pouvez d√©j√† arr√™ter de vous tromper et passer √† quelque chose de moins sophistiqu√© comme C ++ et C. </li><li>  R√©√©crivez les goulots d'√©tranglement en C et retirez-les de votre bien-aim√© Python.  D'accord, mais que se passe-t-il si j'ai tout le programme - tout est question de calculs et de goulots d'√©tranglement?  Xi n'offre pas!  Je ne parle pas du fait que dans cette solution, vous devez conna√Ætre non pas un, mais deux langages - Python et C. </li></ol><br><h3>  Voici le JULIA! </h3><br>  Ayant envisag√© les solutions existantes et n'ayant rien trouv√© (incapable de programmer), j'ai d√©cid√© de le r√©√©crire avec quelque chose de ¬´plus rapide¬ª.  En fait, si vous √©crivez ¬´batteur de nombres¬ª au 21e si√®cle avec un support normal pour les tableaux, les op√©rations vectoris√©es ¬´pr√™tes √† l'emploi¬ª, etc.  etc., alors votre choix n'est pas tr√®s dense: <br><br><ol><li>  <b>Fortran</b> .  Et ne riez pas, lequel d'entre nous n'a pas tir√© BLAS / LAPACK de nos langues pr√©f√©r√©es?  Fortran est un tr√®s bon (meilleur SI!) Langage pour l'informatique SCIENTIFIQUE.  Je ne l'ai pas pris pour la raison que depuis l'√©poque de Fortran beaucoup de choses ont √©t√© invent√©es et ajout√©es aux langages de programmation;  J'esp√©rais quelque chose de plus moderne. </li><li>  <b>R</b> souffre des m√™mes probl√®mes que Python (vectorisation). </li><li>  <b>Matlab</b> - probablement oui, je n'ai malheureusement pas d'argent pour v√©rifier. </li><li>  <b>Julia</b> - le cheval est sombre, d√©collera, ne d√©collera pas (et c'√©tait naturel jusqu'√† la version stable 1.0) </li></ol><br><h3>  Quelques avantages √©vidents de Julia </h3><br><ol><li>  Il ressemble √† Python, au moins le m√™me "de haut niveau", avec la possibilit√©, si n√©cessaire, de descendre en bits en nombre. </li><li>  Pas de probl√®me avec les allocations de m√©moire et autres. </li><li>  Syst√®me de type puissant.  Les types sont prescrits en option et tr√®s dos√©s.  Un programme peut √™tre √©crit sans sp√©cifier un seul type - et si vous le faites, ils pourront le faire rapidement.  Mais il y a des nuances. </li><li>  Il est facile d'√©crire des types personnalis√©s qui seront aussi rapides que les types int√©gr√©s. </li><li>  Envoi multiple.  Vous pouvez en parler pendant des heures, mais √† mon avis - c'est le meilleur que Julia a, c'est la base de la conception de tous les programmes et, en g√©n√©ral, la base de la philosophie de la langue. <br>  Gr√¢ce √† l'envoi multiple, beaucoup de choses sont √©crites de mani√®re tr√®s uniforme. <br><br><div class="spoiler">  <b class="spoiler_title">Exemples d'envois multiples</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>() #       <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) #   <span class="hljs-number"><span class="hljs-number">10</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>) #   <span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">5</span></span>   .... using Distributions d = Normal() #     <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(d) #     <span class="hljs-keyword"><span class="hljs-keyword">rand</span></span>(d, <span class="hljs-number"><span class="hljs-number">10</span></span>) #   <span class="hljs-number"><span class="hljs-number">10</span></span> ...   </code> </pre><br>  Autrement dit, le premier argument peut √™tre n'importe quelle distribution (unidimensionnelle) de Distributions, mais l'appel de fonction restera litt√©ralement le m√™me.  Et pas seulement la distribution (il est possible de transmettre le RNG lui-m√™me en tant qu'objet MersenneTwister et bien plus).  Un autre exemple (√† mon avis, illustratif) est la navigation dans les DataFrames sans loc / iloc. <br></div></div></li><li>  6. Les tableaux sont natifs et int√©gr√©s.  Vectorisation pr√™te √† l'emploi. <br></li></ol><br><h3>  Inconv√©nients de garder le silence sur ce qui serait un crime! </h3><br><ol><li>  Nouvelle langue.  D'un c√¥t√©, bien s√ªr, un moins.  Dans quelque chose, peut-√™tre immature.  D'autre part, il a pris en compte le rake de nombreuses langues pass√©es, se tient ¬´sur les √©paules de g√©ants¬ª, a absorb√© beaucoup de choses int√©ressantes et nouvelles. </li><li>  Il est peu probable que des programmes imm√©diatement rapides √©crivent.  Il y a des choses non √©videntes qui sont tr√®s faciles √† g√©rer: vous montez sur le r√¢teau, demandez de l'aide √† la communaut√©, recommencez ... etc.  Il s'agit principalement de l'instabilit√© de type, de l'instabilit√© de type et des variables globales.  En g√©n√©ral, pour autant que je sache par moi-m√™me, un programmeur qui veut √©crire rapidement en Julia passe par plusieurs √©tapes: a) √©crit en Python.  C'est tr√®s bien, et c'est le cas, mais parfois il y aura des probl√®mes de performances.  b) √©crit comme dans C: prescrire les types de fa√ßon maniaque dans la mesure du possible.  c) comprend progressivement o√π il est n√©cessaire (tr√®s mesur√©) de prescrire des types et o√π ils interf√®rent. </li><li>  √âcosyst√®me  Certains paquets sont bruts, dans le sens o√π quelque part en permanence quelque chose tombe;  certains sont matures, mais incoh√©rents (une conversion vers d'autres types est n√©cessaire, par exemple).  D'une part, c'est √©videmment mauvais;  d'un autre c√¥t√©, Julia a beaucoup d'id√©es int√©ressantes et audacieuses simplement parce que "nous sommes sur les √©paules des g√©ants" - nous avons accumul√© une √©norme exp√©rience de marcher sur un r√¢teau et "comment ne pas le faire", et cela est pris en compte (partiellement) par les d√©veloppeurs de packages. </li><li>  Num√©roter des tableaux √† partir de 1. Ha, en plaisantant, c'est bien s√ªr un plus!  Non, eh bien, s√©rieusement, quel est le probl√®me, avec quel index commence la num√©rotation?  On s'y habitue en 5 minutes.  Personne ne se plaint que les entiers soient appel√©s entiers, pas entiers.  Ce sont toutes des questions de go√ªt.  Et oui, prenez au moins le m√™me Cormen selon les algorithmes - tout est num√©rot√© √† partir d'un l√†, et il est parfois g√™nant de le refaire en Python au contraire. </li></ol><br><h3>  Eh bien, pourquoi la vitesse? </h3><br>  Il est temps de se rappeler pourquoi tout a commenc√©. <br><br>  Remarque: j'ai oubli√© Python en toute s√©curit√©, alors √©crivez vos am√©liorations dans les commentaires, je vais essayer de les ex√©cuter sur mon ordinateur portable et voir le temps d'ex√©cution. <br><br>  Donc, deux petits exemples avec des rep√®res microbiens. <br><br><div class="spoiler">  <b class="spoiler_title">Quelque chose vectoris√©</b> <div class="spoiler_text">  Probl√®me: un vecteur X de 0 et 1 est aliment√© en entr√©e de la fonction. Il faut le convertir en vecteur de 1 et (-1) (1 -&gt; 1, 0 -&gt; -1) et calculer combien de coefficients de la transform√©e de Fourier de ce vecteur sont la valeur absolue d√©passe la limite limite. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, boundary)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.count_nonzero(np.abs(np.fft.fft(<span class="hljs-number"><span class="hljs-number">2</span></span>*x<span class="hljs-number"><span class="hljs-number">-1</span></span>)) &gt; boundary) %timeit process_fft(x, <span class="hljs-number"><span class="hljs-number">2000</span></span>) <span class="hljs-number"><span class="hljs-number">84.1</span></span> ms ¬± <span class="hljs-number"><span class="hljs-number">335</span></span> ¬µs per loop (mean ¬± std. dev. of <span class="hljs-number"><span class="hljs-number">7</span></span> runs, <span class="hljs-number"><span class="hljs-number">10</span></span> loops each)</code> </pre><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, boundary)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t -&gt; t &gt; boundary, abs.(fft(2*x.-1)</span></span></span><span class="hljs-function">)) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">benchmark</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_fft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, 2000)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BenchmarkTools</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Trial</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">106</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">81</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MiB</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allocs</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">61</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minimum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">80</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">233</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4.75% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">median</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">80</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">746</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4.70% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">85</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">000</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(8.67% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maximum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">205</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">831</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(52.27% GC)</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">samples</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">59</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evals</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span></span></code> </pre><br>  Nous ne verrons rien de surprenant ici - tout de m√™me, ils ne le consid√®rent pas eux-m√™mes, mais le transmettent √† des programmes fortran bien optimis√©s. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Quelque chose de non vectorisable</b> <div class="spoiler_text">  Un tableau de 0 et 1 est appliqu√© √† l'entr√©e. Trouvez la longueur de la sous-s√©quence la plus longue d'unit√©s cons√©cutives. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> maxLen = <span class="hljs-number"><span class="hljs-number">0</span></span> currLen = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment"># This will count the number of ones in the block for bit in x: if bit == 1: currLen += 1 maxLen = max(maxLen, currLen) else: maxLen = max(maxLen, currLen) currLen = 0 return max(maxLen, currLen) %timeit longest(x) 599 ms ¬± 639 ¬µs per loop (mean ¬± std. dev. of 7 runs, 1 loop each)</span></span></code> </pre><br><pre> <code class="hljs powershell"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> # </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">This</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">will</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">the</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">number</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ones</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">the</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bit</span></span></span><span class="hljs-function"> == </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> += </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maxLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currLen</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">return</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(maxLen, currLen)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">benchmark</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">longest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BenchmarkTools</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Trial</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bytes</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allocs</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minimum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">094</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">median</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">248</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">319</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">maximum</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">12</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">177</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ms</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.00% GC)</span></span></span><span class="hljs-function"> -------------- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">samples</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">536</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">evals</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span></span></code> </pre><br>  La diff√©rence est √©vidente √† l'≈ìil nu.  Des conseils pour "terminer" et / ou vectoriser la version numpy sont les bienvenus.  Je veux √©galement noter que les programmes sont presque identiques.  Par exemple, je n'ai pas enregistr√© un seul type dans Julia (comparer avec le pr√©c√©dent) - tout de m√™me, tout fonctionne rapidement. <br></div></div><br>  Je tiens √©galement √† noter que les versions pr√©sent√©es n'ont pas √©t√© incluses dans le programme final, mais ont √©t√© encore optimis√©es;  ici, ils sont donn√©s √† titre d'exemple et sans complications inutiles (transmission de m√©moire suppl√©mentaire dans Julia pour faire rfft en place, etc.). <br><br><h3>  Qu'est-ce qui est finalement sorti? </h3><br>  Je ne montrerai pas le code final pour Python et pour Julia: c'est un secret (au moins pour l'instant).  Au moment o√π je me suis arr√™t√© pour terminer la version python, il a travaill√© tous les tests NIST sur un tableau de 16 m√©gaoctets de caract√®res binaires en ~ 50 secondes.  Sur Julia en ce moment, tous les tests s'ex√©cutent sur le m√™me volume ~ 20 secondes.  Il se pourrait bien que je sois un idiot, et qu'il y avait place pour des optimisations, etc.  etc.  Mais c'est moi, comme je suis, avec tous ses avantages et ses inconv√©nients, et √† mon avis, ce n'est pas la vitesse sph√©rique des programmes en vase clos dans les langages de programmation qui doit √™tre prise en compte, mais comment je peux personnellement le programmer (sans erreurs vraiment grossi√®res). <br><br><h3>  Pourquoi ai-je √©crit tout √ßa? </h3><br>  Les gens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici sont</a> devenus int√©ress√©s;  J'ai d√©cid√© d'√©crire quand l'heure appara√Æt.  √Ä l'avenir, je pense passer en revue Julia de mani√®re plus approfondie, avec un exemple de r√©solution de certains probl√®mes typiques.  Pourquoi?  Plus de langues, bonnes et diff√©rentes, et laissez tous ceux qui veulent trouver quelque chose qui lui convient personnellement. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427879/">https://habr.com/ru/post/fr427879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427869/index.html">Webinaire ouvert ¬´Multithreading en Java. Au-del√† de synchronized-notifyTous ¬ª</a></li>
<li><a href="../fr427871/index.html">Piraterie dans l'espace: - Marchands arm√©s et patrouilles militaires - Partie II</a></li>
<li><a href="../fr427873/index.html">Imprimante de construction 3D pour College of Modern Technology</a></li>
<li><a href="../fr427875/index.html">Contexte: ¬´Internet Archive¬ª - historique de la cr√©ation, mission et projets subsidiaires</a></li>
<li><a href="../fr427877/index.html">Langage de programmation Rockstar: quand le code ressemble √† du texte rock hit</a></li>
<li><a href="../fr427883/index.html">Pr√©sentation de la virtualisation, des conteneurs et de Kubernetes: 18 ressources cloud</a></li>
<li><a href="../fr427889/index.html">Faux, faux, FAUX! m√©thodes d'att√©nuation des DDoS</a></li>
<li><a href="../fr427891/index.html">Des millions de personnes peuvent √™tre attaqu√©es par une vuln√©rabilit√© dans la plate-forme de conf√©rence Cisco WebEx</a></li>
<li><a href="../fr427893/index.html">Bloody Lola sur Omega 2 ou Python √©touffant √† l'Halloween</a></li>
<li><a href="../fr427895/index.html">Suppression de donn√©es d'une base de donn√©es partageable</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>