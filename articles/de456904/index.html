<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏱️ 🚮 🏚️ Lasttest eines Webprojekts - kein Geld 🍖 🤽🏽 🤲🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Freunde, guten Tag! 

 Wir setzen die Reihe der Veröffentlichungen „ohne Kürzungen“ über entwicklungsbezogene Projekte fort, häufig mit dem Präfix „We...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lasttest eines Webprojekts - kein Geld</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bitrix/blog/456904/">  Freunde, guten Tag! <br><br>  Wir setzen die Reihe der Veröffentlichungen „ohne Kürzungen“ über entwicklungsbezogene Projekte fort, häufig mit dem Präfix „Web“.  Lassen Sie uns heute über Stresstests sprechen.  Das Problem ist, dass oft weder der Kunde noch der Projektmanager verstehen, warum es benötigt wird, welche Risiken es reduzieren kann, wie es zu organisieren ist und wie und dies meiner Meinung nach schwierig ist, seine Ergebnisse zum Nutzen des Unternehmens zu interpretieren.  Wir gießen Kaffee ein und lass uns gehen ... <br><a name="habracut"></a><br><h2>  Warum sollte ein Webprojekt geladen werden? </h2><br>  Tatsache ist, dass während in einigen Webprojekten noch Selbsttests geschrieben werden, um die Qualität aufrechtzuerhalten, nur wenige Personen in der Entwicklungsphase an der Leistungskontrolle beteiligt sind.  Es ist sehr selten, dass ein Webprojekt sowohl Autotests als auch Code-Benchmarks enthält.  Häufiger und aus vernünftigen Gründen werden bei der Entwicklung folgende Heuristiken eingehalten, die ein gutes Nutzen-Kosten-Verhältnis aufweisen: <br><br><ul><li>  Abfragen an MySQL (wir werden diese beliebte Datenbank als Beispiel verwenden) durchlaufen eine ziemlich angemessene API, die Indizes verwendet (obwohl wir nicht sehen, wie genau die Indizes vom Scheduler verwendet werden, wie hoch ihre Kardinalität ist). </li><li>  Ergebnisse der Ausführung von Datenbankabfragen und umfangreichen Codeteilen werden zwischengespeichert </li><li>  Der Entwickler hat 3.14 Mal die Erstellung der Webseite im Browser überprüft. Wenn das Auge dadurch nicht verlangsamt wird, ist alles in Ordnung </li></ul><br>  Heuristiken funktionieren oft gut, aber je größer und schwerer das Projekt ist, desto <b>mehr kann</b> mit exponentiell zunehmender Wahrscheinlichkeit etwas <b>schief gehen</b> . <br><br>  Nehmen Sie das Caching.  Bei der Entwicklung bleibt oft keine Zeit darüber nachzudenken, wie oft der Cache neu erstellt werden kann.  Aber vergebens.  Wenn das Wiederherstellen eines Caches, beispielsweise eines Produktkatalogs, lange dauert und der Cache beim Hinzufügen eines Produkts zurückgesetzt wird, kann das Zwischenspeichern mehr schaden als nützen. <br><br>  Aus diesem Grund wird übrigens nicht empfohlen, den integrierten MySQL-Abfragecache zu verwenden, der unter einem ähnlichen Problem leidet: Wenn Sie mindestens einen Tabellendatensatz ändern, wird der Tabellencache vollständig zurückgesetzt (stellen Sie sich eine Tabelle mit 100.000 Zeilen vor und die Absurdität der Situation wird offensichtlich). <br><br>  Eine ähnliche Situation bei MySQL-Abfragen.  Wenn Abfragen von Indizes ausgeführt werden, werden Abfragen im Allgemeinen ausgeführt ... "schneller".  Sie können davon ausgehen, dass die Ausführungszeit solcher Abfragen logarithmisch von der Datenmenge abhängt (O (log (n))).  In der Praxis stellt sich jedoch häufig heraus, dass einige Abfragen andere betreffen und gleichzeitig die allgemeinen Subsysteme der Datenbank verwenden (Sortieren auf einer Festplatte, die langsamer wird), und Sie können dies nicht sofort vorhersagen. <br><br>  Außerdem werden beim Laden häufig interessante Funktionen des Betriebssystems festgestellt, insbesondere ein Überlauf des Bereichs ausgehender TCP / IP-Client-Ports während der intensiven Arbeit mit Memcached.  Oder Apache wird mit Anfragen zur Bildverarbeitung verstopft, weil  Während der Konfiguration haben sie vergessen, ihre Verarbeitung durch den Nginx-Caching-Proxy-Server zu konfigurieren. <br><br>  Manchmal vergessen sie, in MySQL den Pfad für temporäre Tabellen auf einer Festplatte zu installieren, die Daten dem RAM zuordnet ("/ dev / shm"). Aus diesem Grund legt der Datenbankserver bei zunehmender Auslastung intensive Sortierungen fest. <br><br>  Wenn dem Webprojekt Daten hinzugefügt werden, zeigen Abfragen und Algorithmen in einem Volume in der Nähe des Kampfprojekts aggressiv ihre „O-Notation“ an: Wenn der Kartesier für eine kleine Datenmenge unsichtbar ist, wird der Datenbankserver aufgrund der Spannung rot, wenn das Kampfvolumen angezeigt wird. <br><br>  Es gibt noch viele weitere Beispiele. Lassen Sie uns zunächst darauf eingehen.  Das Wichtigste zu verstehen ist, dass Lasttests notwendig sind.  Weil es sehr teuer, sehr lang und wirtschaftlich unpraktisch ist, alle möglichen Optionen zum „Bremsen“ eines mittelgroßen Websystems im Voraus vorauszusehen. <br><br><h2>  Wie identifiziere ich Stresstestziele? </h2><br>  Hier ist es wichtig zu verstehen, was Ihnen und dem Kunden tatsächlich das Qualitätsniveau des Websystems während Stresstests zeigt.  Es gibt nichts Besseres als konkrete Beispiele für gute und schlechte Stresstestziele: <br><br><ul><li>  <b>1 Million Treffer gemacht.</b>  <b>Durchschnittliche Erstellungszeit der Webseite = 1 Sek.</b>  Was zeigt das?  Nichts.  Wie lange dauerte der Lasttest?  Die Ausführungszeit einer einzelnen Anforderung kann entweder 1 ms oder 600 Sekunden betragen, und es ist unklar, welche Anteile größer sind.  Und wie viele Fehler es gab (die Nginx-Antwort im Stil von "Fehler 50x") ist auch nicht klar :-) </li><li>  <b>1 Million Treffer gemacht.</b>  <b>Mittlere Erstellungszeit der Webseite = 1 Sek., Die Anzahl der HTTP-Fehler beträgt 0,5%.</b> Was zeigt dies?  Bisher ein wenig nützlich, aber besser.  Wir wissen bereits, dass der Anteil der unzureichenden Fehler, die der Kunde feststellen kann, großartig ist, und Sie können mit der Vorbereitung beginnen und in die Apotheke gehen.  Der Median ist eine Metrik, die gegenüber „Ausreißern“ widerstandsfähiger ist als der Durchschnitt (robustere Schätzung), daher ist sie zweifellos besser als der arithmetische Durchschnitt.  Aber lassen Sie uns die Metriken noch nützlicher machen. </li><li>  <b>Pro Tag wurden 1 Million Treffer erzielt.</b>  <b>25% der Treffer wurden in weniger als 10 ms erzielt, 50% der Treffer wurden in weniger als 1 Sekunde erzielt (dies ist der Median oder das 50-Perzentil), 75% der Treffer wurden in weniger als 1,5 Sekunden erzielt, 95% der Treffer wurden in weniger als 1 Sekunde erzielt 5 Sek. Und die Anzahl der HTTP-Fehler beträgt 0,5%.</b> Das war's!  Wir sehen den Anteil unzureichender Fehler, die der Client abfangen kann, aber wir sehen auch den Anteil der Anforderungen, die über einem bestimmten Schwellenwert ausgeführt werden. </li></ul><br>  Wie Sie sehen können, ist die Auswahl geeigneter Metriken zur Beurteilung der Geschwindigkeit eines Webprojekts während des Lasttests sehr, sehr wichtig.  Es gibt nur ein Prinzip: Metriken sollten sowohl für den Kunden als auch für Sie absolut klar sein und die Qualität gut und klar zeigen.  Tatsächlich ist die offensichtlichste und korrekteste Metrik die Verteilung der Trefferverarbeitungsgeschwindigkeit über die Zeit.  Wenn es Ihnen bei Ihren Stresstests gelingt, wird dies super.  Darüber hinaus können Sie 2 Stresstests anhand der Verteilung der Zeittreffer vergleichen und sehen, wie und wo sie besser wurden.  Visualisierung ist Macht! <br><br><h2>  Nichts ist klar: Perzentile, Mediane, Quantile, Entwürfe, Verteilung ... </h2><br>  Alles ist einfach!  Jetzt werde ich in einer wunderschönen Umgebung für die Datenanalyse zeichnen und zeigen: Jupyter Notebook / Python. <br><br>  Angenommen, innerhalb von Millisekunden wurden 10 Zugriffe auf die Website ausgeführt: <br><br><img src="https://habrastorage.org/webt/l-/e8/io/l-e8io0jdj8vupfnnzus5sjm54i.png"><br><br>  Sortieren Sie nun die Zeit, die benötigt wird, um die Treffer in aufsteigender Reihenfolge zu vervollständigen: <br><br><img src="https://habrastorage.org/webt/tp/m8/ay/tpm8ayfzhwxc3et6n74glp3ngnm.png"><br><br>  Wir sind einen Schritt vom Verständnis des Medians, des 25. und 75. Perzentels entfernt.  Alles ist einfach - wir teilen das Diagramm in zwei Hälften und in der Mitte befindet sich ein „Median“ (Nummer 1 auf dem Diagramm).  Das erste Quartal des Diagramms entspricht dem 25. Perzentil (Nummer 2 im Diagramm) und das dritte Quartal entspricht dem 75. Perzentil (Nummer 3 im Diagramm).  Dementsprechend werden andere Perzentile erhalten (oder, wie sie auch Quantile genannt werden) - 90, 95, 99 usw.: <br><br><img src="https://habrastorage.org/webt/zf/2l/wu/zf2lwu3o2z9xl7_zb2srwk2ayqc.png"><br><br>  Und es sieht aus wie die Verteilung (Histogramm) über die Ausführungszeit der oben genannten Treffer.  Wie Sie sehen, ist alles sehr klar und einfach: <br><br><img src="https://habrastorage.org/webt/ro/s8/yi/ros8yifhkgaa8phiovwj7xhffee.png"><br><br>  Auf diese Weise können Sie schnell eine Verteilung (Histogramm) erstellen, die auf dem Anforderungsprotokoll für Lasttests basiert.  Ändern Sie Ihr Protokollformat: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash TOTAL=`cat /var/log/nginx.access.log | wc -l` echo "Total:" $TOTAL cat /var/log/nginx.access.log | awk -F'-&gt;' '{ $2=$2*1000; zone = int($2/100)*100; hits[zone]++; } \ END {for (z in hits) {printf("%8s ms: %8s,%6.2f% ",z,hits[z],hits[z]/total*100);{s="";a=0;while(a++&lt;int(hits[z]/total*100)) s=s"*";print s} } }' \ total="$TOTAL" - | sort -n</span></span></code> </pre> <br>  Und du bekommst so etwas: <br><br><img src="https://habrastorage.org/webt/yi/cw/kt/yicwktq5m-gspcpb81-q9o5mele.png"><br><br>  Ich hoffe jetzt ist alles klar und in Ordnung.  Wenn nicht, fragen Sie in den Kommentaren. <br><br><h2>  Stresstestzeit </h2><br>  Oft wird gefragt, wie lange der Auslastungstest eines Webprojekts dauern soll.  Es gibt eine einfache Heuristik: Im Betriebssystem werden geplante Aufgaben häufig einmal am Tag ausgeführt: Sicherungen, Rotation von Protokollen usw. Daher sollte die Zeit für die Durchführung von Lasttests nicht weniger als korrekte Tage betragen.  Wenn das Webprojekt auf Bitrix basiert, hat die Plattform auch viele geplante Aufgaben und es ist ratsam, das Web-System mindestens einen Tag lang zu laden. <br><br><h2>  Lastausgleich </h2><br>  Wenn Sie bereits eine betriebene Website haben, können Sie von dort aus die Besuchsprotokolle abrufen und das neue Websystem damit laden.  Oft lösen sie jedoch das Problem, nur das entwickelte Websystem zu laden.  Für die Planung des Lastausgleichs eignet sich häufig das Modell der Aufteilung potenzieller Ketten von Ortsbesichtigungen in Anteile.  Zum Beispiel: <br><br><ul><li>  Home - News - Detaillierte News = 50% </li><li>  Home - Katalogübersicht - Detaillierter Katalog = 30% </li><li>  Detaillierter Katalog - Katalogübersicht - Detaillierter Katalog = 15% </li><li>  Suchergebnisse - Detaillierter Katalog = 5% </li></ul><br>  In der Software zum Erstellen einer Last (wir verwenden häufig Jmeter) werden für jede Kette so viele Lastflüsse erstellt, dass unter Berücksichtigung des Intervalls zwischen den Treffern in der Kette die Gesamtzahl der Treffer jeder Kette pro Zeiteinheit wie folgt korreliert wird: 50%, 30%, 15%, 5% . <br><br>  Die Berechnung von Intervallen und Lastflüssen ist in Excel oder auf einem Blatt mit einem Bleistift einfach. <br><br><h2>  Lastkettenstruktur </h2><br>  Es ist wichtig, die Merkmale des Lebenszyklus des Benutzers des Websystems zu berücksichtigen.  Oft melden sich Benutzer an und gehen dann zur Website.  Dazu müssen Sie die Aktionen, die zur Autorisierung führen, am Anfang der Lastkette platzieren: <br><br><img src="https://habrastorage.org/webt/lx/9a/5m/lx9a5m6lnnnjt0t4x0lk6avsn5e.png"><br><br>  Dem Pferd ist klar, dass es unmöglich ist, während Stresstests nur eine detaillierte Seite des Katalogs abzurufen. Daher ist es nützlich, die Liste aus der CSV-Datei zu lesen und zu drehen: <br><br><img src="https://habrastorage.org/webt/7o/uz/py/7ouzpyccej3ec5s2cfgederegqe.png"><br><br>  Zwischen den Treffern müssen Sie natürlich zufällige Pausen einlegen, damit wir der Last, die von echten Benutzern erzeugt wird, näher kommen.  Vergessen Sie nicht, Cookie-Werte zu speichern und an den Server zurückzugeben: <br><br><img src="https://habrastorage.org/webt/j-/x-/wb/j-x-wbxmqntmtxflqp31azfk2ka.png"><br><br>  Die globalen Variablen von Lastketten, einschließlich der Anzahl der Threads, sind einfach zu konfigurieren.  Bestimmte globale Variablen können dann an verschiedenen Stellen in den Lastketten verwendet werden: <br><br><img src="https://habrastorage.org/webt/1z/gd/zb/1zgdzbx3p1i53-kzx69v5uypvbc.png"><br><br><img src="https://habrastorage.org/webt/ei/qu/x8/eiqux8vtg5i-pkdagldbiiy-0rs.png"><br><br><img src="https://habrastorage.org/webt/cu/mu/rx/cumurxiaukl1feoyc0ltyeyj2pe.png"><br><br><h2>  Wie kann man Stresstests sicher beenden? </h2><br>  In der Praxis stürzt das Testen der Last in den ersten Minuten oder Stunden fast immer ab, alles beginnt zu rauchen, brennt dann, die Site öffnet sich nicht, MySQL fällt in einen Tausch und erlaubt sich nicht, eine Verbindung herzustellen, LA auf Servern nähert sich 100, Entwickler beginnen zu laufen mit den Worten "das hätte nicht passieren dürfen" und Sysadmins mit einem Grinsen antworten normalerweise "es gibt Gerechtigkeit im Leben!"  und fang an, Bier im Serverraum zu trinken. <br><br>  Um zu verstehen, warum alles heruntergefallen ist und was repariert werden muss, um dem Kunden die Ergebnisse eines „erfolgreichen“ Lasttests an einem Tag zu zeigen, müssen Sie zunächst die Aufzeichnung der wichtigsten Lebensdaten des Betriebssystems aktivieren - dies ist bei den kostenlosen Munun / Cacti-Produkten einfach. <br><br>  Ich werde auflisten, was während des Zusammenbruchs eines Websystems am häufigsten passiert und wie dies behoben werden kann. <br><br>  Zunächst wird der Apache- oder PHP-Fpm-Webserver mit Anfragen "verstopft": <br><br><img src="https://habrastorage.org/webt/tm/tv/pd/tmtvpdrhkkgk7vckhnxsglfb19m.png"><br><br>  Meistens geschieht dies aufgrund des Zusammenbruchs von MySQL - die Anzahl der hängenden Abfrageflüsse nimmt zu: <br><br><img src="https://habrastorage.org/webt/ow/dm/f2/owdmf24wsw1zbm9ksfbgczezzv0.png"><br><br>  Was ist der Grund dafür?  Oft vergessen sie von oben, die Anzahl der Apache- oder Abfrageflüsse auf MySQL zu beschränken, was dazu führt, dass Anwendungen aus dem RAM in einen langsamen Austausch mit Krämpfen fallen: <br><br><img src="https://habrastorage.org/webt/qq/dc/un/qqdcunmpuk0dbmuq0a1jfhqstas.png"><br><br>  Hier können Sie die plötzliche Aktivität bei der Arbeit mit einem Tausch sehen. Sie müssen verstehen, wer in den Tausch gefallen ist und wo: <br><br><img src="https://habrastorage.org/webt/jk/r4/6q/jkr46qtuyn9ttbbcxwav0iaxvhs.png"><br><br>  Manchmal liegt das Problem jedoch auf der Seite des langsamen Festplattensubsystems.  In diesem Fall steigt LA stark an und der Prozentsatz der Festplattenauslastung nähert sich 100 (Grafik unten rechts): <br><br><img src="https://habrastorage.org/webt/rn/sk/od/rnskodj5gr0xot-bozw4haogwas.png"><br><br><img src="https://habrastorage.org/webt/sp/za/yq/spzayqb1ud73lnrn9wezocfvjv4.png"><br><br>  Offensichtlich habe ich nur einen Teil des Interessantesten enthüllt, das mit einem Webprojekt während Stresstests beginnen kann.  Die Hauptsache ist jedoch, die richtige Richtung festzulegen und den richtigen Prozess aufzubauen.  Fragen Sie in den Kommentaren, was während des Ladens aufgetaucht ist, ich werde versuchen zu helfen. <br><br><h2>  Interpretation der Stresstestergebnisse </h2><br>  Normalerweise beginnt der Lasttest nach 5-10 Neustarts und Anpassungen mit dem Flug und wird erfolgreich abgeschlossen.  Daher sollten Sie ungefähr eine Reihe dieser Protokolle zur weiteren Analyse haben: <br><br><ul><li>  Protokoll der Anforderungen an nginx mit dem Zeitpunkt der Clientanforderung (in diesem Fall wird die Software geladen), der Proxy-Zeit von nginx an apache / php-fpm </li><li>  Nginx-Fehlerprotokoll </li><li>  Apache / PHP-Fpm-Anforderungsprotokoll mit Anforderungsverarbeitungszeit und HTTP-Antwortstatus </li><li>  apache / php-fpm fehlerprotokoll </li><li>  MySQL Slow Log </li><li>  MySQL-Fehlerprotokoll </li></ul><br>  Darüber hinaus sollten am vergangenen Tag analytische Diagramme zur Verwendung von CPU, Festplatten, MySQL, RAM, Apache-Workern usw. erstellt werden.  (siehe obige Beispiele für Munin-Diagramme). <br><br>  Mit diesen Artefakten können Sie mithilfe eines einfachen awk-Skripts am Anfang des Beitrags Verteilungen (Histogramme) über diese Protokolle erstellen und die Anzahl und Art der HTTP-Fehler berechnen.  In der Tat können Sie einen Bericht über den Erfolg von Stresstests über diesen Inhalt erstellen, der sehr umfangreich und nützlich für Unternehmen und Entscheidungen ist: <br><blockquote>  Während des Tages machte 1 Million Treffer.  25% der Treffer wurden in weniger als 50 ms erzielt, 50% der Treffer wurden in weniger als 0,5 Sekunden (Median) erzielt, 75% der Treffer wurden in weniger als 1 Sekunde ausgeführt, 95% der Treffer wurden in weniger als 5 Sekunden ausgeführt, die Anzahl der HTTP-Fehler - 0,01%.  Testdaten: Katalog, Benutzer, Nachrichten, Artikel wurden in einem Volumen überflutet, das dem erwarteten nahe kam.  <s>Ein Entwickler hat sich selbst erschossen.</s> <br><br>  Lastketten: <br><br>  Home - News - Detaillierte News = 50% <br>  Home - Katalogübersicht - Detaillierter Katalog = 30% <br>  Detaillierter Katalog - Katalogübersicht - Detaillierter Katalog = 15% <br>  Suchergebnisse - Detaillierter Katalog = 5% <br><br>  Diagramme zur Verwendung von Serverressourcen: <br>  ... <br></blockquote>  Dies ist ein guter und verständlicher Bericht über die Lasttests des Websystems.  Für Liebhaber akuter Schmerzen können Sie während des Belastungstests weiterhin empfehlen, jede Minute den Import / Export von Daten aus Systemen der Klassen SAP, 1C usw. auf eine Website einzuschließen.  und synchrone Verbindungen über TCP / IP-Sockets mit externen Austauschdiensten, beispielsweise Kryptowährungen :-) <br><br>  Aber um ehrlich zu sein, wenn Import-Export sorgfältig und ehrlich durchgeführt wird, zeigen Lasttests und unter solchen Bedingungen akzeptable Zahlen für das Geschäft. <br><br><h2>  Woher kommen Stresstests? </h2><br>  Übrigens, ja, wir haben diesen Moment nicht hervorgehoben.  Aus trivialen Gründen tritt normalerweise das mangelnde Gleichgewicht zwischen Nginx-Apache-MySQL-Mitarbeitern auf.  Das heißt,  Die Anzahl der Worker ist nicht von oben beschränkt. Infolgedessen können 500 Worker (jeweils manchmal 100 MB) sofort in Apache hochgehen, und 500 Threads mit Anforderungen werden sofort an MySQL gesendet. Dies führt zu einem Anstieg der HTTP 50x-Fehler und einem möglichen Zusammenbruch. <br><br>  Hier wird empfohlen, die Anzahl der Apache / PHP-Fpm-Worker auf die Anzahl zu beschränken, die in den Arbeitsspeicher passt, und in ähnlicher Weise die Anzahl der Threads in MySQL zu begrenzen, um einen Überlauf des verfügbaren Arbeitsspeichers zu verhindern.  Die Idee ist einfach: Lassen Sie die Clients vor nginx warten, da dies bei asynchronen und nicht blockierenden TCP / IP-Sockets, die in Apache / MySQL sofort "brechen", etwas langsamer werden kann. <br><br>  Von den ärgerlicheren Gründen könnte es Segfault PHP geben.  In diesem Fall müssen Sie die Coredump-Erfassung aktivieren und gdb verwenden, um zu sehen, warum dies geschieht.  In den meisten Fällen kann das Problem durch Aktualisieren / Konfigurieren von PHP umgangen werden. <br><br><h2>  Was bleibt hinter den Kulissen </h2><br>  Es gibt anhaltende Gerüchte, dass das moderne Frontend für das Web so aktiv begonnen hat, sein Leben zu leben, dass die in diesem Beitrag vorgestellten klassischen Lasttests des Backends nicht mehr alle möglichen Risiken des Einfrierens beim Erstellen einer Webseite in den Eingeweiden von Angular / React / Vue.js abdecken - daher <s>Verwenden Sie kein schweres und undurchsichtiges, schlecht getestetes Frontend.</s> Falls erforderlich, können Sie die Lastketten an diese Situation anpassen. <br><br>  Wenn die Ergebnisse der Stresstests im Backend gute Zahlen zeigten und die Website im Browser weiterhin langsamer wird, ist auf jeden Fall bereits klar, wer das dreiste rote Gesicht treffen soll :-) <br><br>  Im Ernst, wir hoffen, in den nächsten Beiträgen dieses wichtige Thema behandeln zu können. <br><br><h2>  Zusammenfassung und Schlussfolgerungen </h2><br>  Insgesamt - die Organisation und Durchführung von Lasttests eines für die Entwicklung und das Geschäft nützlichen Websystems ist nicht kompliziert. <br><br>  Ordnungsgemäß organisierte Lasttests sollten immer durchgeführt werden. Andernfalls besteht die Gefahr, dass während des Kampfeinsatzes größere Probleme auftreten, die nicht innerhalb weniger Tage behoben werden können. <br><br>  Um Stresstests durchführen zu können, ist es wichtig, nicht nur Entwickler, sondern auch Experten für Betriebssysteme und Hardware-erfahrene Systemadministratoren zu gewinnen. Die Probleme, in einen Tausch zu geraten oder den lokalen Bereich von IP-Adressen zu überschreiten, verursachen keine Augenblutungen und Ohnmachtsanfälle. <br><br>  Viel Glück Freunde und stellen Sie Fragen in den Kommentaren! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456904/">https://habr.com/ru/post/de456904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456892/index.html">So suchen Sie nach Schwachstellen in Webanwendungen: Vergleichen Sie acht gängige Scanner</a></li>
<li><a href="../de456894/index.html">Docker und Authentifizierung über Nginx</a></li>
<li><a href="../de456896/index.html">Identifizierung realer IP-Adressen von Benutzern des Tor-Netzwerks durch einen verzerrten Cache</a></li>
<li><a href="../de456898/index.html">Schnelle ganzzahlige Multiplikation mit Tabellen</a></li>
<li><a href="../de456902/index.html">Sichere Push-Benachrichtigungen: von der Theorie zur Praxis</a></li>
<li><a href="../de456908/index.html">Wie Telegramm Sie zu Rostelecom zusammenführt</a></li>
<li><a href="../de456910/index.html">Internetprojekt security.txt - Kennenlernen einer anderen bekannten Datei</a></li>
<li><a href="../de456912/index.html">So erstellen Sie Websites im Jahr 2019</a></li>
<li><a href="../de456916/index.html">Cross Compilation im Docker. Warum nicht?</a></li>
<li><a href="../de456920/index.html">Sony Xperia 1 in Russland - Preis- und Vorbestellungsboni</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>