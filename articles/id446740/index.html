<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤱 ⛱️ 🚉 Menggunakan Python untuk pelaporan dalam satu perusahaan 💪 👩🏽‍🤝‍👨🏿 👣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kisah ini terjadi di perusahaan yang nyata, terlepas dari kenyataan bahwa beberapa nama dan peristiwa adalah fiktif. 

 Glory adalah pengembang biasa ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menggunakan Python untuk pelaporan dalam satu perusahaan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446740/"> Kisah ini terjadi di perusahaan yang nyata, terlepas dari kenyataan bahwa beberapa nama dan peristiwa adalah fiktif. <br><br>  Glory adalah pengembang biasa di sebuah perusahaan kecil di kota N. Perusahaan ini bergerak dalam penyediaan layanan untuk organisasi pendidikan.  Ada beberapa aplikasi yang perlu didukung, secara bertahap berkembang sedikit demi sedikit.  Tetapi otoritas Glory tidak percaya pada usahanya dan fakta bahwa dia makan rotinya karena suatu alasan.  Selain itu, para bos di bidang teknologi informasi tidak benar-benar ingin, tetapi ingin memahami apa yang dilakukan karyawan dan jenis produktivitas apa yang departemen penjualan (yang harus saya katakan terdiri dari satu setengah orang). <br><a name="habracut"></a><br>  Pihak berwenang memandang manajer penjualan dengan mata licik dan bertanya: apa yang Anda lakukan hari ini untuk Tanah Air.  Penjual menjawab: mengadakan begitu banyak pertemuan, menawarkan layanan kepada begitu banyak orang.  Kepemimpinan datang kepada Glory dan berkata: katakan padaku apakah karyawan mengatakan yang sebenarnya atau lebih, mereka membawa lelucon.  Butuh statistik. <br><br>  Dialog berlangsung: <br><br>  - Apakah pengguna membayar untuk layanan melalui layanan pihak ketiga untuk menerima pembayaran online?  Jadi? <br>  - Jadi <br>  - Apakah manajemen perusahaan memiliki akses ke layanan ini? <br>  - Ada. <br>  - Jadi, mungkin, ada pembongkaran pembayaran di sana. <br>  - Ada. <br>  "Tapi apakah kamu perlu laporan tambahan?" <br>  - Dibutuhkan. <br>  - Kenapa? <br>  - Karena lebih nyaman, karena Anda harus, karena "begini dan begitu." <br><br>  Dalam keadilan, harus dikatakan bahwa data tambahan diperlukan. <br><br>  Tanpa ragu, Glory memenuhi permintaan sederhana dengan seleksi selanjutnya di Excel. <br><br>  Laporan itu adalah kumpulan data dalam satu kolom pada satu halaman.  Pada awalnya mereka mendekati Glory dengan cara yang kacau, di tengah hari dan bertanya.  Tetapi beri saya laporan tentang organisasi ini, dan sekarang yang ini.  Tanpa ragu-ragu, Slava memutuskan bahwa cukuplah untuk menanggung ini dan bahwa sesuatu yang indah dan bersatu harus dilakukan yang akan memenuhi kebutuhan mereka yang meminta. <br><br>  Sebuah skrip kecil muncul yang memungkinkan pengiriman buletin kepada orang-orang yang tertarik: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl, pymysql, os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> smtplib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SMTP_SSL <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email.mime.multipart <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MIMEMultipart <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email.mime.base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MIMEBase <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> email <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> encoders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime <span class="hljs-comment"><span class="hljs-comment"># Excel Settings today = datetime.date.today().strftime('%d.%m.%Y') excel_file = 'Oplata_polzovateley_' + today + '.xlsx' # SQL settings host = '' user = '' passwd = '' db = '' port=0000 headers = ['id', 'email', '', '', ' ', ' ', '', '- ', ' '] # SMTP Mail settings smtp_server = 'smtp.gmail.com' mail_login = '' mail_passwd = '' receiver = [''] cc = [''] def main(): # Fetch Data from SQL server conn = pymysql.connect(host=host, user=user, passwd=passwd, db=db, port=port) cursor = conn.cursor() cursor.execute('''select * from table''') data = cursor.fetchall() conn.close() # Write Data to Excel file wb = openpyxl.Workbook() contractors = {} for item in data: diff = item[6] - item[5] item = list(item) # print(item) if diff.days &gt; 10: item.append('') else: item.append('') item = tuple(item) if item[0][:30] in contractors: contractors[item[0][:30]] += 1 else: wb.create_sheet(item[0][:30]) contractors[item[0][:30]] = 2 for i in range(1, len(headers) + 1): letter = openpyxl.utils.get_column_letter(i) wb[item[0][:30]][letter + '1'] = headers[i - 1] wb[item[0][:30]]['A' + str(contractors[item[0][:30]])] = contractors[item[0][:30]] - 1 for i in range(2, len(headers) + 1): letter = openpyxl.utils.get_column_letter(i) wb[item[0][:30]][letter + str(contractors[item[0][:30]])] = item[i] wb.save(excel_file) wb.remove(wb['Sheet']) wb.save(excel_file) # Compose attachment part = MIMEBase('application', "octet-stream") part.set_payload(open(excel_file, "rb").read()) encoders.encode_base64(part) part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(excel_file)) # Compose message msg = MIMEMultipart() msg['From'] = mail_login msg['To'] = ', '.join(receiver) msg['Cc'] = ', '.join(cc) msg['Subject'] = excel_file msg.attach(part) # Send mail tosend = receiver + cc smtp = SMTP_SSL('smtp.gmail.com') smtp.connect(smtp_server) smtp.login(mail_login, mail_passwd) smtp.sendmail(mail_login, tosend, msg.as_string()) smtp.quit() # Wipe file os.remove(excel_file) if __name__ == '__main__': main()</span></span></code> </pre> <br>  Made, tentu saja, tidak terlalu memikirkan Glory.  Tetapi seperti yang mereka katakan: "Ah, dan itu akan terjadi." <br><br>  Setiap pagi, Slava datang ke kantor, menjalankan skrip, dan mengirim email ke pihak yang berkepentingan. <br>  Langkah selanjutnya adalah mengatur pengiriman otomatis.  Ini bekerja seperti ini: <br><br>  <i>build buruh pelabuhan - tag = laporan.</i> <i><br></i>  <i>run docker -it --rm report</i> <br>  Dan dengan kata-kata di mahkota: <br>  <i>0 8 * * * buruh pelabuhan menjalankan --rm foo</i> <br><br>  Setiap hari jam 8 pagi surat itu pergi.  Manajemennya cantik dan bahkan mulai berpikir bahwa Slava datang untuk bekerja setiap hari tepat jam 8 pagi, menyusun laporan dalam Excel, dan kemudian mengirimkannya melalui pos ke tangannya.  Dan dia melakukannya pada hari Sabtu, dan Minggu, dan di salju, dan di hujan, dan di malam kutub. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> <br><br>  Untuk saat ini, untuk sementara semuanya baik-baik saja dan kepemimpinan bertahan, tetapi tidak lama.  Suatu ketika ada pertemuan di mana orde baru diumumkan.  Dengarkan, dengarkan dan jangan katakan bahwa Anda tidak mendengar.  Sim menyatakan bahwa setiap karyawan, setiap hari harus melaporkan ke peringkat yang lebih tinggi, dan bahkan lebih tinggi.  Nah, secara umum, Anda mengerti. <br><br>  "Setiap hari?" Tanya Glory. <br>  - Setiap hari.  - jawab kepala departemen teknis. <br>  - Atau mungkin tidak? <br>  - Itu perlu Kemuliaan, itu perlu. <br><br>  Slava punya beberapa pertanyaan mengenai situasi ini.  Tanggung jawab langsung adalah menyelesaikan perangkat lunak dan laporannya harus terdiri dari sesuatu seperti ini: <br>  <b>feat (Module) Memperbaiki bug di NoteLineCount ... tidak serius ...</b> <b><br></b>  <b>upd (Module2) Tidak memperhatikan pria di balik tirai</b> <b><br></b>  <b>diperbaiki (Modul3) Saya disuruh meninggalkannya sendirian, tetapi saya memiliki benda yang disebut OCD ini, Anda tahu</b> <br>  * Catatan: nama pesan yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">akan diambil diambil dari sini</a> <br><br>  Glory memutuskan bahwa dia akan menyusun laporan berdasarkan pada mereka.  Seminggu telah berlalu.  Pembicaraan baru terjadi tentang konten berikut: <br><br>  - Jadi Anda mengirim laporan setiap hari, tetapi tidak ada kemajuan yang terlihat.  Contohnya adalah: "masker telah ditambahkan ketika memasukkan nomor telepon di ujung depan". <br>  - Baik, lihat.  Sebelumnya, Anda harus memasukkan nomor telepon Anda dan memeriksa jumlah digit dan itu tidak nyaman.  Dan jadi itu nyaman. <br>  - Hm.  Bagus  Saya melihat.  Dan bagaimana Anda menjelaskan ini: “Kode refactoring untuk modul Counterparties.  Fungsi untuk validasi adalah dalam metode yang terpisah. " <br>  - Begini.  Ada hal seperti itu - sistem kontrol versi, yang menunjukkan siapa, kapan dan apa yang melakukan.  Lihat di sini  Berikut adalah komit, dan ini adalah kode yang telah diubah.  Ini kode yang ditambahkan, ini kode yang dihapus. <br>  - Bagus  Ayo lakukan.  Buat laporan berdasarkan ini dari komitmen Anda, dan kemudian kami akan berkumpul dan memeriksa bagaimana ya apa yang Anda tulis di sana. <br><br>  Pada akhirnya - inilah yang terjadi: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>Github</b></a> <br><br>  Script mengambil perubahan dalam repositori dan mengirim surat tentang apa yang dilakukan dan apa yang tidak. <br><br>  Sebelumnya, Slava malu untuk melaporkan bahwa mereka yang tidak akan memeriksa apa pun tidak mengerti bagaimana menulis kode.  Mungkin manajemen memahami penjualan, pembelian, dan segala macam hal dan membayar uang, tetapi Anda akan melihat baris kode tertentu dalam bahasa yang tidak terlalu dikenal, mengamati bagaimana garis hijau dan merah berkedip ketika beralih dari komit ke komit. <br><br>  Ya, Slava adalah orang yang bertanggung jawab dan pekerjaannya berhasil, tetapi ada hari-hari ketika kode itu hampir tidak selesai atau itu adalah kemalasan.  Bagaimanapun, secara umum, sistem bekerja tanpa kegagalan dan tidak ingin menambahkan 15 lapisan abstraksi, tetapi laporan harus dikirim setiap hari. <br><br>  Tidak ada yang tersisa untuk dilakukan selain menjadi Mayakovsky baru dan menulis lelucon dengan tangga.  Tetapi setiap hari saya tidak benar-benar ingin menciptakan yang baru.  Sebagai hasilnya, Vyacheslav mulai mengembangkan solusi pertama yang muncul di pikiran dan ternyata menjadi kode sederhana, di mana, tanpa adanya pekerjaan yang dilakukan dan mendorong perubahan, sebuah laporan disusun.  Itu terlihat seperti ini: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> <br><br>  Tetap harus dilakukan sehingga kode palsu dibentuk dengan komitmen selanjutnya.  Apakah perlu melakukan ini?  Waktu akan memberi tahu. <br><br>  PS: Kisah Glory tidak berakhir di situ.  Ada beberapa peristiwa lagi yang memengaruhi nasibnya, tetapi ini adalah kisah yang sama sekali berbeda.  Sangat menarik untuk membaca di komentar cerita serupa dari kehidupan dan keputusan yang dibuat berdasarkan mereka.  Ada kemungkinan bahwa proyek akan dikembangkan lebih lanjut berdasarkan komentar ini. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446740/">https://habr.com/ru/post/id446740/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446728/index.html">Bagaimana daya yang diterima dari pengisian nirkabel berubah tergantung pada lokasi telepon</a></li>
<li><a href="../id446730/index.html">Bagian Backend pada DUMP: Serverless, Postgres dan Go, .NET Core, GraphQL dan banyak lagi</a></li>
<li><a href="../id446732/index.html">Feropoda tidak akan membantu: penelitian dan pemodelan matematis dari perangkap lubang untuk larva singa semut</a></li>
<li><a href="../id446736/index.html">Oracle APEX Laporan</a></li>
<li><a href="../id446738/index.html">Dasar-Dasar Pemrosesan Bahasa Alami untuk Teks</a></li>
<li><a href="../id446742/index.html">Topik dari Top 3D Expo 2019: "Anisoprinting - teknologi untuk produksi struktur komposit generasi baru", Fedor Antonov</a></li>
<li><a href="../id446744/index.html">VR dengan antarmuka saraf - perendaman lengkap dalam realitas virtual</a></li>
<li><a href="../id446746/index.html">Seorang karyawan UBS mendengar percakapan tentang tetangga kereta Eurostar dan mengetahui tentang kesepakatan $ 15 miliar. Sekarang dia dan bank akan didenda</a></li>
<li><a href="../id446750/index.html">Berita dari bawah: Raksasa IT telah mulai secara aktif membangun jaringan tulang punggung kapal selam mereka sendiri</a></li>
<li><a href="../id446752/index.html">Layanan Tracing, OpenTracing dan Jaeger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>