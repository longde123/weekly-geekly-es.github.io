<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ¡ï¸ ğŸ‘¨ğŸ»â€ğŸš’ ğŸ“¡ å…³äºé—¨æˆ·ç½‘ç«™çš„æ€è€ƒï¼šåœ¨è™šå¹»å¼•æ“4ä¸­åˆ›å»ºé—¨æˆ·ç½‘ç«™ ğŸ‘¨ğŸ½â€ğŸ³ ğŸ–ï¸ ğŸ‘‚ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨è™šå¹»å¼•æ“4ä¸­åˆ›å»ºé—¨æˆ·ã€‚æˆ‘æ²¡æœ‰æ‰¾åˆ°ä»»ä½•è¯¦ç»†æè¿°æ­¤ç±»ç³»ç»Ÿçš„èµ„æºï¼ˆé€šè¿‡é—¨æˆ·è¿›è¡Œç›‘è§†å¹¶é€šè¿‡é—¨æˆ·ï¼‰ï¼Œå› æ­¤æˆ‘å†³å®šç¼–å†™è‡ªå·±çš„ç³»ç»Ÿã€‚ 

 ä»€ä¹ˆæ˜¯é—¨æˆ·ï¼Ÿ 
 è®©æˆ‘ä»¬ä»é—¨æˆ·çš„ç¤ºä¾‹å’Œè§£é‡Šå¼€å§‹ã€‚ å°†é—¨æˆ·ç½‘ç«™æè¿°ä¸ºä»ä¸€ä¸ªç©ºé—´åˆ°å¦ä¸€ä¸ªç©ºé—´çš„é€šé“çš„æœ€ç®€å•æ–¹æ³•ã€‚ åœ¨æŸäº›æµè¡Œæ¸¸æˆä¸­ï¼Œæ­¤æ¦‚å¿µç”¨äºè§†è§‰æ•ˆæœï¼Œç”š...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å…³äºé—¨æˆ·ç½‘ç«™çš„æ€è€ƒï¼šåœ¨è™šå¹»å¼•æ“4ä¸­åˆ›å»ºé—¨æˆ·ç½‘ç«™</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448802/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a9/47f/229/5a947f2299f45d3deab4cfc258045cc1.gif" alt="å›¾ç‰‡"></div><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘Šè¯‰æ‚¨å¦‚ä½•åœ¨è™šå¹»å¼•æ“4ä¸­åˆ›å»ºé—¨æˆ·ã€‚æˆ‘æ²¡æœ‰æ‰¾åˆ°ä»»ä½•è¯¦ç»†æè¿°æ­¤ç±»ç³»ç»Ÿçš„èµ„æºï¼ˆé€šè¿‡é—¨æˆ·è¿›è¡Œç›‘è§†å¹¶é€šè¿‡é—¨æˆ·ï¼‰ï¼Œå› æ­¤æˆ‘å†³å®šç¼–å†™è‡ªå·±çš„ç³»ç»Ÿã€‚ <br><br><h2> ä»€ä¹ˆæ˜¯é—¨æˆ·ï¼Ÿ </h2><br> è®©æˆ‘ä»¬ä»é—¨æˆ·çš„ç¤ºä¾‹å’Œè§£é‡Šå¼€å§‹ã€‚ å°†é—¨æˆ·ç½‘ç«™æè¿°ä¸ºä»ä¸€ä¸ªç©ºé—´åˆ°å¦ä¸€ä¸ªç©ºé—´çš„é€šé“çš„æœ€ç®€å•æ–¹æ³•ã€‚ åœ¨æŸäº›æµè¡Œæ¸¸æˆä¸­ï¼Œæ­¤æ¦‚å¿µç”¨äºè§†è§‰æ•ˆæœï¼Œç”šè‡³ç”¨äºæ¸¸æˆæœºåˆ¶ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ¸¸æˆå…¥å£èŒƒä¾‹ï¼ˆGIFï¼‰</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/611/020/f86/611020f86b634e1946a79f86ee8c4024.gif"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/77d/7b9/813/77d7b9813811fc5b1748d8d29c7599ad.gif"></div><br>  <i>Antichamberï¼ˆ2013ï¼‰å’ŒPortalï¼ˆ2007ï¼‰</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/527/671/ad1/527671ad1b23838f56c324d350bf2e1e.gif"></div><br>  <i>çŒç‰©ï¼Œ2006å¹´</i> </div></div><br> åœ¨è¿™ä¸‰æ¬¾æ¸¸æˆä¸­ï¼Œæœ€è‘—åçš„å¯èƒ½æ˜¯ã€Šä¼ é€é—¨ã€‹ï¼Œä½†æˆ‘ä¸ªäººä¸€ç›´å¾ˆå–œæ¬¢ã€ŠçŒç‰©ã€‹ï¼Œæˆ‘æƒ³å¤åˆ¶çš„å°±æ˜¯å¥¹ã€‚ æ›¾ç»å°è¯•åœ¨Unreal Engine 4ä¸­å®ç°è‡ªå·±çš„ç‰ˆæœ¬ï¼Œä½†ç”±äºå¼•æ“ç¼ºä¹åŠŸèƒ½ï¼Œå› æ­¤å¹¶æ²¡æœ‰çœŸæ­£æˆåŠŸã€‚ ä¸è¿‡ï¼Œæˆ‘è®¾æ³•è¿›è¡Œäº†ä»¥ä¸‹å®éªŒï¼š <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;"> æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒHTML5è§†é¢‘ã€‚ <source src="http://froyok.fr/vine_archive/videos/1318354931002269696.mp4" type="video/mp4"></video></div></div></div><br> ä½†æ˜¯ï¼Œåªæœ‰åœ¨æ–°ç‰ˆæœ¬çš„è™šå¹»å¼•æ“ä¸­ï¼Œæˆ‘æ‰æœ€ç»ˆè®¾æ³•è¾¾åˆ°é¢„æœŸçš„æ•ˆæœï¼š <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/5lga4ppJiuI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h2> é—¨æˆ·-å®ƒä»¬å¦‚ä½•å·¥ä½œï¼Ÿ </h2><br> åœ¨ç»§ç»­å…·ä½“æ“ä½œä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é—¨æˆ·å¦‚ä½•å·¥ä½œçš„ä¸€èˆ¬æƒ…å†µã€‚ <br><br> å®é™…ä¸Šï¼Œé—¨æˆ·ç½‘ç«™æ˜¯ä¸€ä¸ªæ²¡æœ‰å¤–åœ¨ï¼Œè€Œæ˜¯åˆ°å¦ä¸€ä¸ªåœ°æ–¹çš„çª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°è®¾ç½®äº†ç›¸å¯¹äºå¯¹è±¡çš„ç‰¹å®šè§†ç‚¹ï¼Œå¹¶å°†è¯¥è§†ç‚¹å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ã€‚ ä½¿ç”¨æ­¤åŸç†ï¼Œå³ä½¿ä¸¤ä¸ªç©ºé—´å½¼æ­¤è·ç¦»å¾ˆè¿œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å®ƒä»¬è¿æ¥èµ·æ¥ã€‚ çª—å£å°±åƒä¸€ä¸ªé®ç½©ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ‰¾å‡ºä½•æ—¶ä½•åœ°æ˜¾ç¤ºå¦ä¸€ä¸ªç©ºé—´è€Œä¸æ˜¯åŸå§‹ç©ºé—´ã€‚ ç”±äºè§†å›¾çš„èµ·ç‚¹å·²å¤åˆ¶åˆ°å…¶ä»–åœ°æ–¹ï¼Œå› æ­¤ç»™äº†æˆ‘ä»¬è¿ç»­æ€§çš„é”™è§‰ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b3/d56/84b/6b3d5684bf30d66c8b60d551049f7a9b.png"></div><br> åœ¨æ­¤å›¾åƒä¸­ï¼Œæ•è·è®¾å¤‡ï¼ˆUE4ä¸­çš„SceneCaptureï¼‰ä½äºä¸ä»ç©å®¶çš„è§’åº¦çœ‹åˆ°çš„ç©ºé—´ç›¸å¯¹åº”çš„ç©ºé—´çš„å‰é¢ã€‚ è¯¥è¡Œä¹‹åå¯è§çš„æ‰€æœ‰å†…å®¹éƒ½å°†æ›¿æ¢ä¸ºæ•è·å†…å®¹ã€‚ ç”±äºæ•è·è®¾å¤‡å¯ä»¥ä½äºé—¨å’Œå…¶ä»–ç‰©ä½“ä¹‹é—´ï¼Œå› æ­¤ä½¿ç”¨æ‰€è°“çš„â€œè£å‰ªå¹³é¢â€å¾ˆé‡è¦ã€‚ å¯¹äºé—¨æˆ·ï¼Œæˆ‘ä»¬å¸Œæœ›å°é—­çš„å‰ªåˆ‡å¹³é¢é®ç›–é—¨æˆ·å‰é¢å¯è§çš„å¯¹è±¡ã€‚ <br><br> æ€»ç»“ä¸€ä¸‹ã€‚ æˆ‘ä»¬éœ€è¦ï¼š <br><br><ul><li> ç©å®¶ä½ç½® </li><li> é—¨æˆ·å…¥å£ç‚¹ </li><li> é—¨æˆ·å‡ºå£ç‚¹ </li><li> å¸¦æœ‰å‰ªåˆ‡å¹³é¢çš„å‰ªåˆ‡è£…ç½® </li></ul><br> å¦‚ä½•åœ¨è™šå¹»å¼•æ“ä¸­å®ç°å‘¢ï¼Ÿ <br><br> æˆ‘åŸºäº<b>PlayerController</b>å’Œ<b>Character</b>ç®¡ç†çš„ä¸¤ä¸ªä¸»è¦ç±»æ„å»ºäº†ç³»ç»Ÿã€‚  <b>Portal</b>ç±»æ˜¯ä¸€ä¸ªçœŸå®çš„é—¨æˆ·å…¥å£ç‚¹ï¼Œå…¶è§†å›¾/å‡ºå£ç‚¹æ˜¯Target actorã€‚ è¿˜æœ‰ä¸€ä¸ª<b>Portal Manager</b> ï¼Œç”±PlayerControllerç”Ÿæˆå¹¶ç”±Characteræ›´æ–°ï¼Œä»¥åœ¨çº§åˆ«ä¸Šç®¡ç†æ¯ä¸ªé—¨æˆ·å¹¶å¯¹å…¶è¿›è¡Œæ›´æ–°ï¼Œä»¥åŠæ“ä½œSceneCaptureå¯¹è±¡ï¼ˆæ‰€æœ‰é—¨æˆ·ç½‘ç«™éƒ½é€šç”¨ï¼‰ã€‚ <br><br><blockquote> è¯·è®°ä½ï¼Œæœ¬æ•™ç¨‹å¸Œæœ›æ‚¨å¯ä»¥ä»ä»£ç è®¿é—®Characterå’ŒPlayerControllerç±»ã€‚ å°±æˆ‘è€Œè¨€ï¼Œå®ƒä»¬ç§°ä¸ºExedreCharacterå’ŒExedrePlayerControllerã€‚ </blockquote><br><h2> åˆ›å»ºé—¨æˆ·ç½‘ç«™æ¼”å‘˜ç±» </h2><br> è®©æˆ‘ä»¬ä»é—¨æˆ·ç½‘ç«™çš„å‚ä¸è€…å¼€å§‹ï¼Œå®ƒå°†ç”¨äºè®¾ç½®â€œçª—å£â€ï¼Œé€šè¿‡è¿™äº›çª—å£æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å…³å¡ã€‚ æ¼”å‘˜çš„ä»»åŠ¡æ˜¯æä¾›æœ‰å…³ç©å®¶çš„ä¿¡æ¯ï¼Œä»¥è®¡ç®—å„ç§ä½ç½®å’Œè½¬å¼¯ã€‚ ä»–è¿˜å°†ä»äº‹è¯†åˆ«ç©å®¶æ˜¯å¦ç©¿è¿‡é—¨æˆ·åŠå…¶ä¼ é€çš„æ´»åŠ¨ã€‚ <br><br> åœ¨å¼€å§‹å¯¹å‚ä¸è€…è¿›è¡Œè¯¦ç»†è®¨è®ºä¹‹å‰ï¼Œè®©æˆ‘è§£é‡Šä¸€ä¸‹æˆ‘ä¸ºç®¡ç†é—¨æˆ·ç½‘ç«™ç³»ç»Ÿè€Œåˆ›å»ºçš„ä¸€äº›æ¦‚å¿µï¼š <br><br><ul><li> ä¸ºäº†æ–¹ä¾¿æ‹’ç»è®¡ç®—ï¼Œé—¨æˆ·ç½‘ç«™å¤„äºæ´»åŠ¨/ä¸æ´»åŠ¨çŠ¶æ€ã€‚ æ­¤çŠ¶æ€ç”±Portal Manageræ›´æ–°ã€‚ </li><li> é—¨æˆ·çš„æ­£é¢å’ŒèƒŒé¢ç”±å…¶ä½ç½®å’Œæ–¹å‘ï¼ˆæ­£å‘å‘é‡ï¼‰ç¡®å®šã€‚ </li><li> ä¸ºäº†æ‰¾å‡ºç©å®¶æ˜¯å¦è·¨è¿‡é—¨æˆ·ï¼Œä»–å­˜å‚¨äº†ç©å®¶çš„å…ˆå‰ä½ç½®å¹¶å°†å…¶ä¸å½“å‰ä½ç½®è¿›è¡Œæ¯”è¾ƒã€‚ å¦‚æœåœ¨ä»¥å‰çš„è¡¡é‡æ ‡å‡†ä¸­ï¼Œç©å®¶ä½äºé—¨æˆ·çš„å‰é¢ï¼Œè€Œå½“å‰ç©å®¶ä½äºé—¨æˆ·åé¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºç©å®¶è¶Šè¿‡äº†é—¨æˆ·ã€‚ åå‘è¡Œä¸ºå°†è¢«å¿½ç•¥ã€‚ </li><li> é—¨æˆ·ç½‘ç«™æœ‰ä¸€ä¸ªé™åˆ¶æ•°é‡ï¼Œä»¥ä¾¿åœ¨ç©å®¶è¿›å…¥æ­¤æ•°é‡ä¹‹å‰ä¸è¿›è¡Œè®¡ç®—å’Œæ£€æŸ¥ã€‚ ç¤ºä¾‹ï¼šå¦‚æœç©å®¶å®é™…ä¸Šæ²¡æœ‰è§¦æ‘¸é—¨æˆ·ï¼Œåˆ™å¿½ç•¥è·¯å£ã€‚ </li><li> æ’­æ”¾å™¨çš„ä½ç½®æ˜¯æ ¹æ®æ‘„åƒå¤´çš„ä½ç½®è®¡ç®—å¾—å‡ºçš„ï¼Œä»¥ç¡®ä¿å½“è§†ç‚¹ç©¿è¿‡é—¨æˆ·è€Œä¸æ˜¯æ’­æ”¾å™¨çš„èº«ä½“æ—¶æ­£ç¡®çš„è¡Œä¸ºã€‚ </li><li> é—¨æˆ·æ¥æ”¶ä¸€ä¸ªâ€œæ¸²æŸ“ç›®æ ‡â€ï¼Œå¦‚æœä¸‹æ¬¡çº¹ç†ä¸æ­£ç¡®å¹¶ä¸”éœ€è¦æ›¿æ¢ï¼Œåˆ™åœ¨æ¯ä¸ªåº¦é‡ä¸­æ˜¾ç¤ºä¸€ä¸ªä¸åŒçš„è§†ç‚¹ã€‚ </li><li> é—¨æˆ·ç½‘ç«™å­˜å‚¨åˆ°å¦ä¸€ä¸ªåä¸ºTargetçš„actorçš„é“¾æ¥ï¼Œä»¥ä¾¿çŸ¥é“è¦åœ¨ä½•å¤„è”ç³»å…¶ä»–ç©ºé—´ã€‚ </li></ul><br> ä½¿ç”¨è¿™äº›è§„åˆ™ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ExedrePortalç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªAActorã€‚ è¿™æ˜¯å®ƒçš„æ ‡é¢˜ï¼š <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CoreMinimal.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"GameFramework/Actor.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ExedrePortal.generated.h"</span></span></span><span class="hljs-meta"> UCLASS() class EXEDRE_API AExedrePortal : public AActor { GENERATED_UCLASS_BODY() protected: virtual void BeginPlay() override; public: virtual void Tick(float DeltaTime) override; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//Status of the Portal (being visualized by the player or not) UFUNCTION(BlueprintPure, Category="Exedre|Portal") bool IsActive(); UFUNCTION(BlueprintCallable, Category="Exedre|Portal") void SetActive( bool NewActive ); //Render target to use to display the portal UFUNCTION(BlueprintNativeEvent, BlueprintCallable, Category="Exedre|Portal") void ClearRTT(); UFUNCTION(BlueprintNativeEvent, BlueprintCallable, Category="Exedre|Portal") void SetRTT( UTexture* RenderTexture ); UFUNCTION(BlueprintNativeEvent, Category="Exedre|Portal") void ForceTick(); //Target of where the portal is looking UFUNCTION(BlueprintPure, Category="Exedre|Portal") AActor* GetTarget(); UFUNCTION(BlueprintCallable, Category="Exedre|Portal") void SetTarget( AActor* NewTarget ); //Helpers UFUNCTION(BlueprintCallable, Category="Exedre|Portal") bool IsPointInFrontOfPortal( FVector Point, FVector PortalLocation, FVector PortalNormal ); UFUNCTION(BlueprintCallable, Category="Exedre|Portal") bool IsPointCrossingPortal( FVector Point, FVector PortalLocation, FVector PortalNormal ); UFUNCTION(BlueprintCallable, Category="Exedre|Portal") void TeleportActor( AActor* ActorToTeleport ); protected: UPROPERTY(BlueprintReadOnly) USceneComponent* PortalRootComponent; private: bool bIsActive; AActor* Target; //Used for Tracking movement of a point FVector LastPosition; bool LastInFront; };</span></span></span></span></code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œè¿™é‡Œæè¿°äº†å¤§å¤šæ•°è¡Œä¸ºã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•åœ¨ä½“å†…ï¼ˆ.cppï¼‰å¤„ç†çš„ã€‚ <br><br><hr><br> è®¾è®¡äººå‘˜æ­£åœ¨å‡†å¤‡æ ¹ç»„ä»¶ã€‚ æˆ‘å†³å®šåˆ›å»ºä¸¤ä¸ªæ ¹ç»„ä»¶ï¼Œå› ä¸ºé—¨æˆ·ç½‘ç«™å‚ä¸è€…å°†ç»“åˆå›¾å½¢æ•ˆæœå’Œç¢°æ’/è¯†åˆ«ã€‚ å› æ­¤ï¼Œæˆ‘éœ€è¦ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ç¡®å®šçª—å£/é—¨æˆ·å¹³é¢çš„ä½ç½®ï¼Œè€Œæ— éœ€è“ç‰™åŠŸèƒ½æˆ–å…¶ä»–æŠ€å·§ã€‚  PortalRootComponentå°†æˆä¸ºä¸é—¨æˆ·ç›¸å…³çš„æ‰€æœ‰è®¡ç®—çš„åŸºç¡€ã€‚ <br><br> å¦‚æœBlueprintç±»å°†å…¶åŠ¨ç”»åŒ–ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨æ‰“å¼€/å…³é—­åŠ¨ç”»ï¼‰ï¼Œåˆ™é—¨æˆ·ç½‘ç«™æ ¹è®¾ç½®ä¸ºåŠ¨æ€ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Sets default values AExedrePortal::AExedrePortal(const FObjectInitializer&amp; ObjectInitializer) : Super(ObjectInitializer) { PrimaryActorTick.bCanEverTick = true; bIsActive = false; RootComponent = CreateDefaultSubobject&lt;USceneComponent&gt;(TEXT("RootComponent")); RootComponent-&gt;Mobility = EComponentMobility::Static; PortalRootComponent = CreateDefaultSubobject&lt;USceneComponent&gt;(TEXT("PortalRootComponent")); PortalRootComponent-&gt;SetupAttachment( GetRootComponent() ); PortalRootComponent-&gt;SetRelativeLocation( FVector(0.0f, 0.0f, 0.0f) ); PortalRootComponent-&gt;SetRelativeRotation( FRotator(0.0f, 0.0f, 0.0f) ); PortalRootComponent-&gt;Mobility = EComponentMobility::Movable; }</span></span></code> </pre> <br><hr><br> åªæœ‰Getå’ŒSetå‡½æ•°ï¼Œä»…æ­¤è€Œå·²ã€‚ æˆ‘ä»¬å°†ä»å¦ä¸€ä¸ªåœ°æ–¹ç®¡ç†æ´»åŠ¨çŠ¶æ€ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> AExedrePortal::IsActive() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bIsActive; } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::SetActive( <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> NewActive ) { bIsActive = NewActive; }</code> </pre> <br><hr><br> è“å›¾äº‹ä»¶ï¼Œæˆ‘åœ¨C ++ç±»ä¸­ä¸åšä»»ä½•äº‹æƒ…ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::ClearRTT_Implementation() { } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::SetRTT_Implementation( UTexture* RenderTexture ) { } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::ForceTick_Implementation() { }</code> </pre> <br><hr><br> ç›®æ ‡è§’è‰²çš„è·å–å’Œè®¾ç½®åŠŸèƒ½ã€‚ è¿™éƒ¨åˆ†ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ›´å¤æ‚çš„ã€‚ <br><br><pre> <code class="cpp hljs">AActor* AExedrePortal::GetTarget() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Target; } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::SetTarget( AActor* NewTarget ) { Target = NewTarget; }</code> </pre> <br><hr><br> ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å¹³é¢å‰é¢ï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¯¥ç‚¹æ˜¯å…¥å£ã€‚ è¯¥å‡½æ•°ä½¿ç”¨UE4å¼•æ“çš„FPlaneç»“æ„æ‰§è¡Œè®¡ç®—ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> AExedrePortal::IsPointInFrontOfPortal( FVector Point, FVector PortalLocation, FVector PortalNormal ) { FPlane PortalPlane = FPlane( PortalLocation, PortalNormal ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PortalDot = PortalPlane.PlaneDot( Point ); <span class="hljs-comment"><span class="hljs-comment">//If &lt; 0 means we are behind the Plane //See : http://api.unrealengine.com/INT/API/Runtime/Core/Math/FPlane/PlaneDot/index.html return ( PortalDot &gt;= 0 ); }</span></span></code> </pre> <br><hr><br> æ­¤åŠŸèƒ½æ£€æŸ¥è¯¥ç‚¹æ˜¯å¦å·²ç©¿è¿‡é—¨å¹³é¢ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨æ—§ä½ç½®æ¥æ‰¾å‡ºè¯¥ç‚¹çš„è¡Œä¸ºã€‚ æ­¤åŠŸèƒ½å¾ˆå¸¸è§ï¼Œå› æ­¤å¯ä»¥ä¸ä»»ä½•æ¼”å‘˜ä¸€èµ·ä½¿ç”¨ï¼Œä½†åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼Œä»…ä¸æ’­æ”¾å™¨ä¸€èµ·ä½¿ç”¨ã€‚ <br><br> è¯¥å‡½æ•°åœ¨å…ˆå‰ä½ç½®å’Œå½“å‰ä½ç½®ä¹‹é—´åˆ›å»ºæ–¹å‘/çº¿æ®µï¼Œç„¶åæ£€æŸ¥å®ƒä»¬æ˜¯å¦ä¸å¹³é¢ç›¸äº¤ã€‚ å¦‚æœæ˜¯è¿™æ ·ï¼Œåˆ™æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦æ²¿æ­£ç¡®çš„æ–¹å‘äº¤å‰ï¼ˆä»å‰åˆ°åï¼Ÿï¼‰ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> AExedrePortal::IsPointCrossingPortal( FVector Point, FVector PortalLocation, FVector PortalNormal ) { FVector IntersectionPoint; FPlane PortalPlane = FPlane( PortalLocation, PortalNormal ); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> PortalDot = PortalPlane.PlaneDot( Point ); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsCrossing = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsInFront = PortalDot &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsIntersect = FMath::SegmentPlaneIntersection( LastPosition, Point, PortalPlane, IntersectionPoint ); <span class="hljs-comment"><span class="hljs-comment">//Did we intersect the portal since last Location ? //If yes, check the direction : crossing forward means we were in front and now at the back //If we crossed backward, ignore it (similar to Prey 2006) if( IsIntersect &amp;&amp; !IsInFront &amp;&amp; LastInFront ) { IsCrossing = true; } //Store values for Next check LastInFront = IsInFront; LastPosition = Point; return IsCrossing; }</span></span></code> </pre> <br><h2> ä¼ é€æ¼”å‘˜ </h2><br> æˆ‘ä»¬å°†è®¨è®ºçš„é—¨æˆ·ç½‘ç«™å‚ä¸è€…çš„æœ€åä¸€éƒ¨åˆ†æ˜¯<b>TeleportActorï¼ˆï¼‰</b>å‡½æ•°ã€‚ <br><br> å°†è§’è‰²ä»Aç‚¹ä¼ é€åˆ°Bç‚¹æ—¶ï¼Œæ‚¨éœ€è¦å¤åˆ¶å…¶ç§»åŠ¨å’Œä½ç½®ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœç©å®¶è¿›å…¥é—¨æˆ·ï¼Œç„¶åç»“åˆé€‚å½“çš„è§†è§‰æ•ˆæœï¼Œåœ¨ä»–çœ‹æ¥ä»–å°±ç©¿è¿‡äº†æ™®é€šçš„é—¨ã€‚ <br><br> é—¨æˆ·çš„äº¤é›†æ„Ÿè§‰å°±åƒæ˜¯ç›´çº¿ç§»åŠ¨ï¼Œä½†æ˜¯å®é™…ä¸Šå‘ç”Ÿäº†å®Œå…¨ä¸åŒçš„äº‹æƒ…ã€‚ é€€å‡ºé—¨æˆ·ç½‘ç«™åï¼Œç©å®¶å¯èƒ½ä¼šå¤„äºå®Œå…¨ä¸åŒçš„ç¯å¢ƒä¸­ã€‚ è€ƒè™‘ä¸€ä¸ªæ¥è‡ªé—¨æˆ·ç½‘ç«™çš„ç¤ºä¾‹ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/185/809/d4f/185809d4fd81675cdd6f1cc871eaf193.gif"></div><br> å¦‚æ‚¨æ‰€è§ï¼Œç©¿è¿‡é—¨æˆ·æ—¶ï¼Œæ‘„åƒæœºç›¸å¯¹äºå…¶å‰å‘çŸ¢é‡æ—‹è½¬ï¼ˆæ—‹è½¬ï¼‰ã€‚ è¿™æ˜¯å› ä¸ºèµ·ç‚¹å’Œç»ˆç‚¹å¹³è¡Œäºä¸åŒçš„å¹³é¢ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/072/97f/b30/07297fb30171a80c1cc0d831701feb74.jpg"></div><br> å› æ­¤ï¼Œä¸ºäº†ä½¿å…¶æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦å°†ç©å®¶çš„åŠ¨ä½œè½¬æ¢ä¸ºé—¨æˆ·çš„ç›¸å¯¹ç©ºé—´ï¼Œä»¥ä¾¿å°†å…¶è½¬æ¢ä¸ºç›®æ ‡ç©ºé—´ã€‚ é€šè¿‡æ‰§è¡Œæ­¤æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿è¿›å…¥é—¨æˆ·å¹¶ä»å¦ä¸€ä¾§é€€å‡ºä¹‹åï¼Œæ’­æ”¾å™¨å°†ç›¸å¯¹äºç©ºé—´æ­£ç¡®å¯¹é½ã€‚ è¿™ä¸ä»…é€‚ç”¨äºæ¼”å‘˜çš„ä½ç½®å’Œæ—‹è½¬ï¼Œè¿˜é€‚ç”¨äºä»–çš„<b>é€Ÿåº¦</b> ã€‚ <br><br><blockquote> å¦‚æœæˆ‘ä»¬ä¸åšä»»ä½•æ”¹å˜å°±ä¼ é€ä¸€ä¸ªè§’è‰²ï¼Œå°†å…¶è½¬æ¢ä¸ºå±€éƒ¨æ—‹è½¬ï¼Œé‚£ä¹ˆç»“æœæ˜¯ï¼Œè¯¥è§’è‰²å¯ä»¥å€’ç«‹ã€‚ è¿™å¯èƒ½é€‚ç”¨äºå¯¹è±¡ï¼Œä½†ä¸é€‚ç”¨äºè§’è‰²æˆ–ç©å®¶æœ¬äººã€‚ æ‚¨éœ€è¦æ›´æ”¹actorçš„ä½ç½®ï¼Œå¦‚ä¸Šé¢Portalç¤ºä¾‹ä¸­æ‰€ç¤ºã€‚ </blockquote><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortal::TeleportActor( AActor* ActorToTeleport ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ActorToTeleport == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> || Target == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//------------------------------- //Retrieve and save Player Velocity //(from the Movement Component) //------------------------------- FVector SavedVelocity = FVector::ZeroVector; AExedreCharacter* EC = nullptr; if( ActorToTeleport-&gt;IsA( AExedreCharacter::StaticClass() ) ) { EC = Cast&lt;AExedreCharacter&gt;( ActorToTeleport ); SavedVelocity = EC-&gt;GetCharMovementComponent()-&gt;GetCurrentVelocity(); } //------------------------------- //Compute and apply new location //------------------------------- FHitResult HitResult; FVector NewLocation = UTool::ConvertLocationToActorSpace( ActorToTeleport-&gt;GetActorLocation(), this, Target ); ActorToTeleport-&gt;SetActorLocation( NewLocation, false, &amp;HitResult, ETeleportType::TeleportPhysics ); //------------------------------- //Compute and apply new rotation //------------------------------- FRotator NewRotation = UTool::ConvertRotationToActorSpace( ActorToTeleport-&gt;GetActorRotation(), this, Target ); //Apply new rotation ActorToTeleport-&gt;SetActorRotation( NewRotation ); //------------------------------- //If we are teleporting a character we need to //update its controller as well and reapply its velocity //------------------------------- if( ActorToTeleport-&gt;IsA( AExedreCharacter::StaticClass() ) ) { //Update Controller AExedrePlayerController* EPC = EC-&gt;GetPlayerController(); if( EPC != nullptr ) { NewRotation = UTool::ConvertRotationToActorSpace( EPC-&gt;GetControlRotation(), this, Target ); EPC-&gt;SetControlRotation( NewRotation ); } //Reapply Velocity (Need to reorient direction into local space of Portal) { FVector Dots; Dots.X = FVector::DotProduct( SavedVelocity, GetActorForwardVector() ); Dots.Y = FVector::DotProduct( SavedVelocity, GetActorRightVector() ); Dots.Z = FVector::DotProduct( SavedVelocity, GetActorUpVector() ); FVector NewVelocity = Dots.X * Target-&gt;GetActorForwardVector() + Dots.Y * Target-&gt;GetActorRightVector() + Dots.Z * Target-&gt;GetActorUpVector(); EC-&gt;GetCharMovementComponent()-&gt;Velocity = NewVelocity; } } //Cleanup Teleport LastPosition = NewLocation; }</span></span></code> </pre> <br><hr><br> æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¦è°ƒç”¨æ—‹è½¬/ä½ç½®ï¼Œæˆ‘è¦è°ƒç”¨å¤–éƒ¨å‡½æ•°ã€‚ ä»UToolç”¨æˆ·ç±»ä¸­è°ƒç”¨å®ƒä»¬ï¼Œè¯¥ç±»å®šä¹‰äº†å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ï¼ˆåŒ…æ‹¬è“å›¾ï¼‰è°ƒç”¨çš„é™æ€å‡½æ•°ã€‚ å®ƒä»¬çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥æŒ‰ç…§æœ€åˆé€‚çš„æ–¹å¼å®ç°å®ƒä»¬ï¼ˆå°†å®ƒä»¬æ”¾åœ¨Portal actorç±»ä¸­å¯èƒ½ä¼šæ›´å®¹æ˜“ï¼‰ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">FVector </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertLocationToActorSpace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FVector Location, AActor* Reference, AActor* Target )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( Reference == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> || Target == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FVector::ZeroVector; } FVector Direction = Location - Reference-&gt;GetActorLocation(); FVector TargetLocation = Target-&gt;GetActorLocation(); FVector Dots; Dots.X = FVector::DotProduct( Direction, Reference-&gt;GetActorForwardVector() ); Dots.Y = FVector::DotProduct( Direction, Reference-&gt;GetActorRightVector() ); Dots.Z = FVector::DotProduct( Direction, Reference-&gt;GetActorUpVector() ); FVector NewDirection = Dots.X * Target-&gt;GetActorForwardVector() + Dots.Y * Target-&gt;GetActorRightVector() + Dots.Z * Target-&gt;GetActorUpVector(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TargetLocation + NewDirection; }</code> </pre> <br> è¿™é‡Œçš„å˜æ¢æ˜¯é€šè¿‡è®¡ç®—å‘é‡çš„æ ‡é‡ç§¯æ¥ç¡®å®šä¸åŒè§’åº¦æ¥æ‰§è¡Œçš„ã€‚ æ–¹å‘å‘é‡æœªå½’ä¸€åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡å°†ç‚¹ç»“æœä¸ç›®æ ‡å‘é‡ç›¸ä¹˜ï¼Œä»¥åœ¨ç›®æ ‡è§’è‰²çš„å±€éƒ¨ç©ºé—´ä¸­è·å¾—å®Œå…¨ç›¸åŒè·ç¦»çš„ä½ç½®ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">FRotator </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertRotationToActorSpace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FRotator Rotation, AActor* Reference, AActor* Target )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( Reference == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> || Target == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FRotator::ZeroRotator; } FTransform SourceTransform = Reference-&gt;GetActorTransform(); FTransform TargetTransform = Target-&gt;GetActorTransform(); FQuat QuatRotation = FQuat( Rotation ); FQuat LocalQuat = SourceTransform.GetRotation().Inverse() * QuatRotation; FQuat NewWorldQuat = TargetTransform.GetRotation() * LocalQuat; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> NewWorldQuat.Rotator(); }</code> </pre> <br> è½¬å˜è½¬å‹æœ‰ç‚¹éš¾ä»¥å®æ–½ã€‚ æœ€åï¼Œæœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer">å››å…ƒæ•°</a> ï¼Œå› ä¸ºè¿™æ¯”ä½¿ç”¨æ­£å¸¸çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer">æ¬§æ‹‰è§’</a>æ›´ç²¾ç¡®ï¼Œå¹¶ä¸”åªéœ€è¦å‡ è¡Œä»£ç ã€‚ å››å…ƒæ•°çš„æ—‹è½¬ä½¿ç”¨ä¹˜æ³•è¿›è¡Œï¼Œå› æ­¤åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå°†Inverseï¼ˆï¼‰åº”ç”¨äºè¦è½¬æ¢çš„æ—‹è½¬ï¼Œæˆ‘ä»¬ä¼šå°†å…¶ç§»åŠ¨åˆ°å±€éƒ¨ç©ºé—´ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶å†ä¹˜ä»¥ç›®æ ‡è½¬å¼¯æ•°å³å¯è·å¾—æœ€åä¸€è½¬å¼¯ã€‚ <br><br><h2> åˆ›å»ºé—¨æˆ·ç½‘æ ¼ </h2><br> ä¸ºäº†ä»ç©å®¶çš„è§’åº¦çœ‹èµ·æ¥å¾ˆæ¼‚äº®ï¼Œæˆ‘çš„é—¨æˆ·ç½‘ç«™ç³»ç»Ÿä½¿ç”¨äº†ç‰¹å®šçš„ç½‘æ ¼ã€‚ ç½‘æ ¼åˆ’åˆ†ä¸ºä¸¤ä¸ªä¸åŒçš„å¹³é¢ï¼š <br><br><ul><li>  <b>å¹³é¢1</b> ï¼šæ˜¾ç¤ºé—¨æˆ·ç½‘ç«™æ¸²æŸ“ç›®æ ‡çš„ä¸»å¹³é¢ã€‚ è¿™æ¶é£æœºæœ‰ä¸€ç§éå¸¸ä¸å¯»å¸¸çš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒçš„ä»»åŠ¡æ˜¯åœ¨ç©å®¶æ¥è¿‘æ—¶å°†å…¶å‘åæ¨ä¸€ç‚¹ï¼Œä»¥å…è¢«ç›¸æœºå¤¹ä½ã€‚ ç”±äºå¹³é¢çš„è¾¹ç•Œä¸ç§»åŠ¨ï¼Œè€Œä»…å…¶ä¸­é—´å³°ç§»åŠ¨ï¼Œå› æ­¤å…è®¸ç©å®¶å åŠ æ¸²æŸ“é—¨æˆ·è€Œæ²¡æœ‰è§†è§‰ä¼ªåƒã€‚ è¾¹ç¼˜çš„è¾¹ç¼˜åœ¨ä¸ŠåŠéƒ¨åˆ†å…·æœ‰è‡ªå·±çš„UVï¼Œè€Œå†…éƒ¨è¾¹ç¼˜çš„ä¸‹åŠéƒ¨åˆ†å…·æœ‰è‡ªå·±çš„UVï¼Œè¿™ä½¿åœ¨ç€è‰²å™¨ä¸­è½»æ¾é®ç½©å®ƒä»¬æˆä¸ºå¯èƒ½ã€‚ </li><li>  <b>å¹³é¢2</b> ï¼šæ­¤å¹³é¢ä»…ç”¨äºæ‰©å±•ç½‘æ ¼çš„æ ‡å‡†è¾¹ç•Œæ¡†ã€‚ é¡¶ç‚¹çš„æ³•çº¿æœä¸‹ï¼Œå› æ­¤ï¼Œå³ä½¿åœ¨éå¹³é¢åœ°é¢ä¸Šï¼Œé»˜è®¤æƒ…å†µä¸‹ä¹Ÿå°†çœ‹ä¸åˆ°ç½‘æ ¼ï¼ˆå› ä¸ºæ¸²æŸ“ææ–™å°†ä¸ä¼šæ˜¯åŒé¢çš„ï¼‰ã€‚ </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72e/125/f6f/72e125f6fd315caa2777f65dc0eaf39a.gif"></div><br> ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿™æ ·çš„ç½‘æ ¼ï¼Ÿ <br><br> æˆ‘å†³å®šéšç€ç©å®¶çš„æ¥è¿‘ï¼Œâ€œå¹³é¢1â€å°†ä¼¸å±•ã€‚ è¿™å…è®¸æ’­æ”¾å™¨é‡å é—¨æˆ·å¹¶é€šè¿‡å®ƒè€Œä¸ä¼šä¿®å‰ªï¼ˆå‰ªåˆ‡ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‘„åƒå¤´å°šæœªè¶Šè¿‡é—¨æˆ·çš„å¹³é¢ï¼Œä½†ç©å®¶çš„è„šå·²ç»è§¦æ‘¸è¿‡é—¨æˆ·ï¼Œåˆ™å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µã€‚ è¿™æ ·ä¸€æ¥ï¼Œæ‚¨å°±æ— éœ€åˆ‡æ–­æ’­æ”¾å™¨å¹¶å¤åˆ¶ç½‘æ ¼ã€‚ <br><br>  â€œå¹³é¢2â€ä»»åŠ¡æ˜¯æ‰©å±•ç½‘æ ¼çš„æ ‡å‡†è¾¹ç•Œæ¡†ã€‚ ç”±äºâ€œå¹³é¢1â€æ˜¯å¹³å¦çš„ï¼Œå› æ­¤ä¸€è½´ä¸Šçš„è¾¹ç•Œæ¡†çš„åšåº¦ä¸º0ï¼Œå¹¶ä¸”å¦‚æœæ‘„å½±æœºåœ¨å…¶åæ–¹ï¼Œåˆ™å¼•æ“ä¼šå°†å…¶åˆ‡é™¤ï¼ˆå³ï¼Œå®ƒå°†ä¸ä¼šæ¸²æŸ“ï¼‰ã€‚ å¹³é¢1çš„å°ºå¯¸ä¸º128Ã—128ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å¼•æ“è½»æ¾ç¼©æ”¾ã€‚ å¹³é¢2ç¨å¤§ä¸”åœ¨åœ°æ¿ä¸‹æ–¹ï¼ˆ0ä¹‹ä¸‹ï¼‰ã€‚ <br><br> åˆ›å»ºç½‘æ ¼åï¼Œæˆ‘ä»¬åªéœ€ä»ç¬¬ä¸‰æ–¹3Dç¼–è¾‘å™¨ä¸­å°†å…¶å¯¼å‡ºå¹¶å¯¼å…¥åˆ°Unrealä¸­å³å¯ã€‚ å®ƒå°†åœ¨ä¸‹ä¸€æ­¥ä¸­ä½¿ç”¨ã€‚ <br><br><h2> åˆ›å»ºé—¨æˆ·èµ„æ–™ </h2><br> è¦æ˜¾ç¤ºé—¨æˆ·çš„å¦ä¸€ä¾§ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºè‡ªå·±çš„ææ–™ã€‚ åœ¨å†…å®¹æµè§ˆå™¨ä¸­åˆ›å»ºæ–°ææ–™ï¼ˆæˆ‘ç§°ä¹‹ä¸º<b>MAT_PortalBase</b> ï¼‰ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b0/402/a9c/7b0402a9cd6c6d62438e06fa3a7cd1f4.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dea/96c/a1b/dea96ca1b613a92acc7ca35e0bbe44b1.png"></div><br> ç°åœ¨æ‰“å¼€å®ƒå¹¶åˆ›å»ºä»¥ä¸‹å›¾å½¢ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cfe/4fa/c17/cfe4fac175e5e399c9e615a6afd0b800.jpg"></div><br> ææ–™çš„å·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼š <br><br><ul><li>  <b>FadeColor</b>æ˜¯å½“å…¶è·ç¦»å¾ˆè¿œæ—¶å°†é€šè¿‡é—¨æˆ·å¯è§çš„é¢œè‰²ã€‚ è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶ä¸æ€»æ˜¯æ¸²æŸ“æ‰€æœ‰é—¨æˆ·ï¼Œå› æ­¤å½“æ’­æ”¾å™¨/æ‘„åƒæœºè·ç¦»å¾ˆè¿œæ—¶ï¼Œæˆ‘ä»¬ä¼šé®æŒ¡æ¸²æŸ“ã€‚ </li><li> ä¸ºäº†æ‰¾å‡ºç©å®¶ç¦»é—¨æˆ·æœ‰å¤šè¿œï¼Œæˆ‘ç¡®å®šäº†æ‘„åƒæœºä½ç½®å’Œæ¼”å‘˜ä½ç½®ä¹‹é—´çš„<b>è·ç¦»</b> ã€‚ ç„¶åï¼Œæˆ‘å°†è·ç¦»é™¤ä»¥è¦è¿›è¡Œæ¯”è¾ƒçš„æœ€å¤§å€¼ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘è®¾ç½®çš„æœ€å¤§å€¼ä¸º2000ï¼Œè€Œè·æ’­æ”¾å™¨çš„è·ç¦»ä¸º1000ï¼Œåˆ™å¾—åˆ°0.5ã€‚ å¦‚æœç©å®¶èµ°å¾—æ›´è¿œï¼Œé‚£ä¹ˆæˆ‘ä¼šå¾—åˆ°ä¸€ä¸ªå¤§äº1çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨é¥±å’ŒèŠ‚ç‚¹å¯¹å…¶è¿›è¡Œé™åˆ¶ã€‚ æ¥ä¸‹æ¥æ˜¯SmoothstepèŠ‚ç‚¹ï¼Œç”¨äºå°†è·ç¦»ç¼©æ”¾ä¸ºæ¸å˜å¹¶æ›´ç²¾ç¡®åœ°æ§åˆ¶é—¨æˆ·ç€è‰²ã€‚ ä¾‹å¦‚ï¼Œæˆ‘æƒ³è¦åœ¨ç©å®¶å…³é—­æ—¶é˜´å½±å®Œå…¨æ¶ˆå¤±ã€‚ </li><li> æˆ‘å°†è·ç¦»è®¡ç®—ç”¨ä½œ<b>Lerp</b>èŠ‚ç‚¹çš„Alphaé€šé“å€¼ï¼Œä»¥æ··åˆé˜´å½±é¢œè‰²å’Œå°†æ¸²æŸ“é—¨æˆ·ç›®æ ‡çš„<b>çº¹ç†</b> ã€‚ </li><li> æœ€åï¼Œæˆ‘éš”ç¦»UVåæ ‡çš„Yåˆ†é‡ä»¥åˆ›å»ºä¸€ä¸ªé®ç½©ï¼Œä½¿æ‚¨çŸ¥é“å°†æ¨åŠ¨ç½‘æ ¼çš„å“ªäº›é¡¶ç‚¹ã€‚ æˆ‘å°†æ­¤é¢ç½©ä¹˜ä»¥æˆ‘æ‰€éœ€çš„æ’æ–¥åŠ›ã€‚ æˆ‘ä½¿ç”¨ä¸€ä¸ªè´Ÿå€¼ï¼Œä»¥ä¾¿å½“é¡¶ç‚¹çš„æ³•çº¿ä¸é¡¶ç‚¹ç›¸ä¹˜æ—¶ï¼Œå®ƒä»¬æ²¿ç›¸åçš„æ–¹å‘ç§»åŠ¨ã€‚ </li></ul><br> å®Œæˆæ‰€æœ‰è¿™äº›ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºäº†å³ç”¨å‹ææ–™ã€‚ <br><br><h2> åœ¨é’å™¨ä¸­åˆ›å»ºé—¨æˆ·ç½‘ç«™å‚ä¸è€… </h2><br> è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæ–°çš„ç»§æ‰¿è‡ªPortal actorçš„è“å›¾ç±»ã€‚ å³é”®å•å‡»å†…å®¹æµè§ˆå™¨ï¼Œç„¶åé€‰æ‹©Blueprintç±»ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ead/28b/5a2/ead28b5a23369c2c86a076ec8bb1dda0.png"></div><br> ç°åœ¨ï¼Œåœ¨æœç´¢å­—æ®µä¸­è¾“å…¥â€œé—¨æˆ·â€ä»¥é€‰æ‹©é—¨æˆ·ç±»åˆ«ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd7/da4/555/bd7da4555cff2dc953ab3b0b0f4d1057.png"></div><br> å¦‚æœå°šæœªæ‰“å¼€è“ç‰™ï¼Œè¯·æ‰“å¼€å®ƒã€‚ åœ¨ç»„ä»¶åˆ—è¡¨ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å±‚æ¬¡ç»“æ„ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/73c/34c/308/73c34c308a70f644759dc9057b0facd2.png"></div><br> å¦‚æˆ‘ä»¬æ‰€æ–™ï¼Œæœ‰ä¸€ä¸ªæ ¹ç»„ä»¶å’Œé—¨æˆ·ç½‘ç«™æ ¹ã€‚ è®©æˆ‘ä»¬å‘PortalRootComponentæ·»åŠ ä¸€ä¸ªé™æ€ç½‘æ ¼ç‰©ä½“ç»„ä»¶ï¼Œå¹¶å°†ä¸Šä¸€æ­¥ä¸­åˆ›å»ºçš„ç½‘æ ¼ç‰©ä½“åŠ è½½åˆ°å…¶ä¸­ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/ef3/11d/fa4ef311d11c803afc565060a9902c24.jpg"></div><br><hr><br> æˆ‘ä»¬è¿˜æ·»åŠ äº†â€œç¢°æ’ç›’â€ï¼Œè¯¥ç›’å°†ç”¨äºç¡®å®šç©å®¶æ˜¯å¦åœ¨é—¨æˆ·åŒºåŸŸå†…ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b0/28f/df6/0b028fdf696598f6b3eca9af3049caa1.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c2a/85d/747/c2a85d747c8b76900cae32e9f9cc1a59.png"></div><br> ç¢°æ’æ¡†ä½äºä¸ä¸»æ ¹ç›¸å…³è”çš„åœºæ™¯ç»„ä»¶ä¸‹æ–¹ï¼Œè€Œä¸ä½äºé—¨æˆ·ç½‘ç«™æ ¹ä¸‹æ–¹ã€‚ æˆ‘è¿˜æ·»åŠ äº†ä¸€ä¸ªå›¾æ ‡ï¼ˆå¹¿å‘Šç‰Œï¼‰å’Œä¸€ä¸ªç®­å¤´ç»„ä»¶ï¼Œä»¥ä½¿é—¨æˆ·åœ¨å„ä¸ªçº§åˆ«ä¸Šæ›´åŠ å¯è§ã€‚ å½“ç„¶ï¼Œè¿™ä¸æ˜¯å¿…éœ€çš„ã€‚ <br><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬åœ¨è“å›¾ä¸­è®¾ç½®ææ–™ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªå˜é‡-ä¸€ä¸ªå˜é‡ä¸º<b>Actor</b>ç±»å‹ï¼Œåç§°ä¸º<b>PortalTarget</b> ï¼Œç¬¬äºŒä¸ªå˜é‡ä¸º<b>Dynamic Material Instance</b>ç±»å‹ï¼Œå¹¶ç§°ä¸º<b>MaterialInstance</b> ã€‚  PortalTargetå°†æ˜¯å¯¹é—¨æˆ·çª—å£æ­£åœ¨æŸ¥çœ‹çš„ä½ç½®çš„å¼•ç”¨ï¼ˆå› æ­¤ï¼Œè¯¥å˜é‡æ˜¯å¸¸è§çš„ï¼Œå¸¦æœ‰çå¼€çš„çœ¼ç›å›¾æ ‡ï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨å°†actoræ”¾ç½®åœ¨æ°´å¹³ä½ç½®æ—¶å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚  MaterialInstanceå°†å­˜å‚¨åˆ°åŠ¨æ€æè´¨çš„é“¾æ¥ï¼Œä»¥ä¾¿å°†æ¥æˆ‘ä»¬å¯ä»¥åŠ¨æ€åˆ†é…é—¨æˆ·çš„æ¸²æŸ“ç›®æ ‡ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/474/0b9/772/4740b9772dfc7ce30cda63300f1682a5.png"></div><br> æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„äº‹ä»¶èŠ‚ç‚¹ã€‚ æœ€å¥½åœ¨â€œ <b>äº‹ä»¶å›¾â€ä¸­</b>æ‰“å¼€å³é”®å•å‡»èœå•ï¼Œç„¶åæ‰¾åˆ°<b>äº‹ä»¶</b>çš„åç§°ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc2/719/d22/bc2719d224381581c9bdb8ea5ce7c365.png"></div><br> åœ¨è¿™é‡Œåˆ›å»ºä¸‹å›¾ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f4/400/24f/0f440024f5c322c6640609bb8d20bcad.jpg"></div><br><ul><li>  <b>å¼€å§‹æ’­æ”¾</b> ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è°ƒç”¨é—¨æˆ·ç½‘ç«™çš„çˆ¶å‡½æ•°SetTargetï¼ˆï¼‰ä¸ºå…¶åˆ†é…åˆ°æ¼”å‘˜çš„é“¾æ¥ï¼Œè¯¥é“¾æ¥éšåå°†ç”¨äºSceneCaptureã€‚ ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„åŠ¨æ€æè´¨ï¼Œå¹¶ä¸ºå…¶æŒ‡å®šMaterialInstanceå˜é‡çš„å€¼ã€‚ ä½¿ç”¨è¿™ç§æ–°ææ–™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†é…ç»™â€œé™æ€ç½‘æ ¼ç‰©ä½“ç»„ä»¶â€ã€‚ æˆ‘è¿˜ä¸ºæè´¨æä¾›äº†è™šæ‹Ÿçº¹ç†ï¼Œä½†è¿™æ˜¯å¯é€‰çš„ã€‚ </li><li>  <b>æ¸…é™¤RTT</b> ï¼šæ­¤åŠŸèƒ½çš„ç›®çš„æ˜¯æ¸…é™¤åˆ†é…ç»™é—¨æˆ·ææ–™çš„â€œæ¸²æŸ“ç›®æ ‡â€çº¹ç†ã€‚ å®ƒç”±é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨å¯åŠ¨ã€‚ </li><li>  <b>è®¾ç½®RTT</b> ï¼šæ­¤åŠŸèƒ½çš„ç›®çš„æ˜¯è®¾ç½®é—¨æˆ·ç½‘ç«™çš„æ¸²æŸ“ç›®æ ‡ææ–™ã€‚ å®ƒç”±é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨å¯åŠ¨ã€‚ </li></ul><br> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†è“ç‰™çš„å·¥ä½œï¼Œä½†æ˜¯ç¨åå°†è¿”å›åˆ°è“ç‰™ä»¥å®ç°TickåŠŸèƒ½ã€‚ <br><br><h2> é—¨æˆ·ç½‘ç«™ç»ç† </h2><br> å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº†åˆ›å»ºä»AActorç»§æ‰¿çš„æ–°ç±»ï¼ˆå³Portal Managerï¼‰æ‰€éœ€çš„æ‰€æœ‰åŸºæœ¬å…ƒç´ ã€‚ æ‚¨çš„é¡¹ç›®ä¸­å¯èƒ½ä¸éœ€è¦Portal Managerç±»ï¼Œä½†å°±æˆ‘è€Œè¨€ï¼Œå®ƒæå¤§åœ°ç®€åŒ–äº†æŸäº›æ–¹é¢çš„å·¥ä½œã€‚ è¿™æ˜¯é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼š <br><br><ul><li> é—¨æˆ·ç®¡ç†å™¨æ˜¯<b>ç”±ç©å®¶æ§åˆ¶å™¨åˆ›å»º</b>å¹¶é™„åŠ åˆ°å…¶ä¸Šçš„è§’è‰²ï¼Œç”¨äºè·Ÿè¸ªæ¸¸æˆçº§åˆ«å†…ç©å®¶çš„çŠ¶æ€å’Œæ¼”å˜ã€‚ </li><li> åˆ›å»ºå¹¶é”€æ¯<b>æ¸²æŸ“ç›®æ ‡é—¨æˆ·</b> ã€‚ è¯¥æƒ³æ³•æ˜¯åŠ¨æ€åˆ›å»ºä¸æ’­æ”¾å™¨çš„å±å¹•åˆ†è¾¨ç‡åŒ¹é…çš„æ¸²æŸ“ç›®æ ‡çº¹ç†ã€‚ æ­¤å¤–ï¼Œåœ¨æ¸¸æˆè¿‡ç¨‹ä¸­æ›´æ”¹åˆ†è¾¨ç‡æ—¶ï¼Œç»ç†å°†è‡ªåŠ¨å°†å…¶è½¬æ¢ä¸ºæ‰€éœ€çš„å¤§å°ã€‚ </li><li> é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨<b>æŸ¥æ‰¾å¹¶æ›´æ–°</b>é—¨æˆ·ç½‘ç«™å‚ä¸è€…çº§åˆ«ï¼Œä»¥ä¸ºä»–ä»¬æä¾›æ¸²æŸ“ç›®æ ‡ã€‚ ä»¥ç¡®ä¿ä¸çº§åˆ«æµå…¼å®¹çš„æ–¹å¼æ‰§è¡Œæ­¤ä»»åŠ¡ã€‚ å½“æ–°æ¼”å‘˜å‡ºç°æ—¶ï¼Œä»–åº”è¯¥å¾—åˆ°ä¸€ä¸ªçº¹ç†ã€‚ æ­¤å¤–ï¼Œå¦‚æœâ€œæ¸²æŸ“â€ç›®æ ‡å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ç®¡ç†è€…è¿˜å¯ä»¥è‡ªåŠ¨åˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡ã€‚ è¿™ä½¿ç®¡ç†ç³»ç»Ÿæ›´åŠ å®¹æ˜“ï¼Œè€Œä¸æ˜¯è®©æ¯ä¸ªPortal actoræ‰‹åŠ¨è”ç³»ç®¡ç†å‘˜ã€‚ </li><li>  <b>SceneCapture</b>ç»„ä»¶<b>å·²</b>é™„åŠ åˆ°é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨ï¼Œä»¥ä¾¿ä¸ä¸ºæ¯ä¸ªé—¨æˆ·ç½‘ç«™åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ã€‚ æ­¤å¤–ï¼Œå®ƒä½¿æ‚¨æ¯æ¬¡æˆ‘ä»¬åœ¨çº§åˆ«ä¸Šåˆ‡æ¢åˆ°ç‰¹å®šé—¨æˆ·ç½‘ç«™å‚ä¸è€…æ—¶éƒ½å¯ä»¥é‡ç”¨å®ƒã€‚ </li><li> é—¨æˆ·å†³å®š<b>ä¼ é€</b>æ’­æ”¾å™¨æ—¶ï¼Œå®ƒå°†å‘é—¨æˆ·ç®¡ç†å™¨å‘é€è¯·æ±‚ã€‚ ä¸ºäº†åŒæ—¶æ›´æ–°æºé—¨æˆ·å’Œç›®æ ‡é—¨æˆ·ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œè¿™æ˜¯å¿…éœ€çš„ï¼Œè¿™æ ·è¿‡æ¸¡å°±å¯ä»¥å®ç°ã€‚ </li><li> åœ¨â€œ <b>è§’è‰²â€å‹¾å·ï¼ˆï¼‰</b>å‡½æ•°çš„æœ«å°¾ä¼š<b>æ›´æ–°</b>é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨ï¼Œä»¥ä¾¿æ­£ç¡®æ›´æ–°æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ç©å®¶çš„ç›¸æœºã€‚ è¿™æ ·å¯ä»¥ç¡®ä¿å±å¹•ä¸Šçš„æ‰€æœ‰å†…å®¹éƒ½åŒæ­¥ï¼Œå¹¶é¿å…å¼•æ“æ¸²æŸ“æœŸé—´å»¶è¿Ÿä¸€å¸§ã€‚ </li></ul><br> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Portal Manageræ ‡å¤´ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CoreMinimal.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"GameFramework/Actor.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ExedrePortalManager.generated.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//Forward declaration class AExedrePlayerController; class AExedrePortal; class UExedreScriptedTexture; UCLASS() class EXEDRE_API AExedrePortalManager : public AActor { GENERATED_UCLASS_BODY() public: AExedrePortalManager(); //Called by a Portal actor when wanting to teleport something UFUNCTION(BlueprintCallable, Category="Portal") void RequestTeleportByPortal( AExedrePortal* Portal, AActor* TargetToTeleport ); //Save a reference to the PlayerControler void SetControllerOwner( AExedrePlayerController* NewOwner ); //Various setup that happens during spawn void Init(); //Manual Tick void Update( float DeltaTime ); //Find all the portals in world and update them //returns the most valid/usable one for the Player AExedrePortal* UpdatePortalsInWorld(); //Update SceneCapture void UpdateCapture( AExedrePortal* Portal ); //Accessor for Debug purpose UTexture* GetPortalTexture(); //Accessor for Debug purpose FTransform GetCameraTransform(); private: //Function to create the Portal render target void GeneratePortalTexture(); UPROPERTY() USceneCaptureComponent2D* SceneCapture; //Custom class, can be replaced by a "UCanvasRenderTarget2D" instead //See : https://api.unrealengine.com/INT/API/Runtime/Engine/Engine/UCanvasRenderTarget2D/index.html UPROPERTY() UExedreScriptedTexture* PortalTexture; UPROPERTY() AExedrePlayerController* ControllerOwner; int32 PreviousScreenSizeX; int32 PreviousScreenSizeY; float UpdateDelay; };</span></span></span></span></code> </pre> <br><hr><br> åœ¨è¯¦ç»†ä»‹ç»ä¹‹å‰ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä»PlayerControllerç±»ï¼ˆä»BeginPlayï¼ˆï¼‰å‡½æ•°è°ƒç”¨ï¼‰åˆ›å»ºactorï¼š <br><br><pre> <code class="cpp hljs"> FActorSpawnParameters SpawnParams; PortalManager = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; PortalManager = GetWorld()-&gt;SpawnActor&lt;AExedrePortalManager&gt;( AExedrePortalManager::StaticClass(), FVector::ZeroVector, FRotator::ZeroRotator, SpawnParams); PortalManager-&gt;AttachToActor( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, FAttachmentTransformRules::SnapToTargetIncludingScale); PortalManager-&gt;SetControllerOwner( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> ); PortalManager-&gt;Init();</code> </pre> <br> å› æ­¤ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªactorï¼Œå°†å…¶é™„åŠ åˆ°æ’­æ”¾å™¨çš„æ§åˆ¶å™¨ï¼ˆthisï¼‰ï¼Œç„¶åä¿å­˜é“¾æ¥å¹¶è°ƒç”¨Initï¼ˆï¼‰å‡½æ•°ã€‚ <br><br> è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä»Characterç±»ä¸­æ‰‹åŠ¨æ›´æ–°actorï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedreCharacter::TickActor( <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> DeltaTime, <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> ELevelTick TickType, FActorTickFunction&amp; ThisTickFunction ) { Super::TickActor( DeltaTime, TickType, ThisTickFunction ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( UGameplayStatics::GetPlayerController(GetWorld(), <span class="hljs-number"><span class="hljs-number">0</span></span>) != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { AExedrePlayerController* EPC = Cast&lt;AExedrePlayerController&gt;( UGameplayStatics::GetPlayerController(GetWorld(), <span class="hljs-number"><span class="hljs-number">0</span></span>) ); EPC-&gt;PortalManager-&gt;Update( DeltaTime ); } }</code> </pre> <br> è¿™æ˜¯Portal Managerçš„æ„é€ å‡½æ•°ã€‚ è¯·æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬å°†é€šè¿‡æ’­æ”¾å™¨æ‰‹åŠ¨æ›´æ–°Portal Managerï¼Œå› æ­¤Tickè¢«ç¦ç”¨ã€‚ <br><br><pre> <code class="cpp hljs">AExedrePortalManager::AExedrePortalManager(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FObjectInitializer&amp; ObjectInitializer) : Super(ObjectInitializer) { PrimaryActorTick.bCanEverTick = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; PortalTexture = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; UpdateDelay = <span class="hljs-number"><span class="hljs-number">1.1f</span></span>; PreviousScreenSizeX = <span class="hljs-number"><span class="hljs-number">0</span></span>; PreviousScreenSizeY = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><hr><br> è¿™æ˜¯get / set Portal Managerçš„åŠŸèƒ½ï¼ˆæ­¤åï¼Œæˆ‘ä»¬å°†ç»§ç»­ä»‹ç»æ›´æœ‰è¶£çš„äº‹æƒ…ï¼‰ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::SetControllerOwner( AExedrePlayerController* NewOwner ) { ControllerOwner = NewOwner; } FTransform AExedrePortalManager::GetCameraTransform() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( SceneCapture != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SceneCapture-&gt;GetComponentTransform(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FTransform(); } } UTexture* AExedrePortalManager::GetPortalTexture() { <span class="hljs-comment"><span class="hljs-comment">//Portal Texture is a custom component class that embed a UCanvasRenderTraget2D //The GetTexture() simply returns the RenderTarget contained in that class. //IsValidLowLevel() is used here as a way to ensure the Texture has not been destroyed or garbage collected. if( PortalTexture != nullptr &amp;&amp; PortalTexture-&gt;IsValidLowLevel() ) { return PortalTexture-&gt;GetTexture(); } else { return nullptr; } }</span></span></code> </pre> <br><hr><br> æ˜¾ç„¶ï¼Œé¦–å…ˆè¦å¼€å§‹çš„æ˜¯<b>Initï¼ˆï¼‰</b>å‡½æ•°ã€‚ <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤åŠŸèƒ½çš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºSceneCaptureç»„ä»¶ï¼ˆå³ä¸Šè¿°æ•è·è®¾å¤‡ï¼‰å¹¶æ­£ç¡®é…ç½®å®ƒã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†å…¶æ³¨å†Œä¸ºè¯¥å‚ä¸è€…çš„ç»„ä»¶ã€‚</font><font style="vertical-align: inherit;">ç„¶åï¼Œæˆ‘ä»¬ç»§ç»­è®¾ç½®ä¸æ­¤æ•è·æœ‰å…³çš„å±æ€§ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦æåˆ°çš„å±æ€§ï¼š</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bCaptureEveryFrame = false</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæˆ‘ä»¬ä¸å¸Œæœ›åœ¨ä¸éœ€è¦æ•è·æ—¶æ‰“å¼€æ•è·ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†æ‰‹åŠ¨å¯¹å…¶è¿›è¡Œç®¡ç†ã€‚</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bEnableClipPlane = true</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šä¸€ä¸ªéå¸¸é‡è¦çš„å±æ€§ï¼Œç”¨äºæ­£ç¡®å‘ˆç°é—¨æˆ·æ•è·ã€‚</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bUseCustomProjectionMatrix = true</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šè¿™ä½¿æˆ‘ä»¬å¯ä»¥æ ¹æ®ç©å®¶çš„è§‚ç‚¹å°†CaptureæŠ•å½±æ›¿æ¢ä¸ºæˆ‘ä»¬è‡ªå·±çš„ã€‚</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CaptureSource = ESceneCaptureSource :: SCS_SceneColorSceneDepth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæ­¤æ¨¡å¼æœ‰ç‚¹æ˜‚è´µï¼Œä½†æ˜¯å¿…é¡»å‘ˆç°è¶³å¤Ÿæ•°é‡çš„ä¿¡æ¯ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å…¶ä½™å±æ€§ä¸»è¦ä¸åå¤„ç†å‚æ•°æœ‰å…³ã€‚</font><font style="vertical-align: inherit;">å®ƒä»¬æ˜¯æ§åˆ¶è´¨é‡å¹¶å› æ­¤æ•è·æ€§èƒ½çš„ä¾¿æ·æ–¹æ³•ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åä¸€éƒ¨åˆ†è°ƒç”¨åˆ›å»ºæ¸²æŸ“ç›®æ ‡çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çœ‹åˆ°ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::Init() { <span class="hljs-comment"><span class="hljs-comment">//------------------------------------------------ //Create Camera //------------------------------------------------ SceneCapture = NewObject&lt;USceneCaptureComponent2D&gt;(this, USceneCaptureComponent2D::StaticClass(), *FString("PortalSceneCapture")); SceneCapture-&gt;AttachToComponent( GetRootComponent(), FAttachmentTransformRules::SnapToTargetIncludingScale ); SceneCapture-&gt;RegisterComponent(); SceneCapture-&gt;bCaptureEveryFrame = false; SceneCapture-&gt;bCaptureOnMovement = false; SceneCapture-&gt;LODDistanceFactor = 3; //Force bigger LODs for faster computations SceneCapture-&gt;TextureTarget = nullptr; SceneCapture-&gt;bEnableClipPlane = true; SceneCapture-&gt;bUseCustomProjectionMatrix = true; SceneCapture-&gt;CaptureSource = ESceneCaptureSource::SCS_SceneColorSceneDepth; //Setup Post-Process of SceneCapture (optimization : disable Motion Blur, etc) FPostProcessSettings CaptureSettings; CaptureSettings.bOverride_AmbientOcclusionQuality = true; CaptureSettings.bOverride_MotionBlurAmount = true; CaptureSettings.bOverride_SceneFringeIntensity = true; CaptureSettings.bOverride_GrainIntensity = true; CaptureSettings.bOverride_ScreenSpaceReflectionQuality = true; CaptureSettings.AmbientOcclusionQuality = 0.0f; //0=lowest quality..100=maximum quality CaptureSettings.MotionBlurAmount = 0.0f; //0 = disabled CaptureSettings.SceneFringeIntensity = 0.0f; //0 = disabled CaptureSettings.GrainIntensity = 0.0f; //0 = disabled CaptureSettings.ScreenSpaceReflectionQuality = 0.0f; //0 = disabled CaptureSettings.bOverride_ScreenPercentage = true; CaptureSettings.ScreenPercentage = 100.0f; SceneCapture-&gt;PostProcessSettings = CaptureSettings; //------------------------------------------------ //Create RTT Buffer //------------------------------------------------ GeneratePortalTexture(); }</span></span></code> </pre> <br><hr><br> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å½“æ‚¨éœ€è¦ä¸ºé—¨æˆ·ç½‘ç«™åˆ›å»ºæ–°çš„â€œæ¸²æŸ“ç›®æ ‡â€çº¹ç†æ—¶ï¼Œ</font><b><font style="vertical-align: inherit;">GeneratePortalTextureï¼ˆï¼‰</font></b><font style="vertical-align: inherit;">æ˜¯åœ¨å¿…è¦æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚</font><font style="vertical-align: inherit;">è¿™å‘ç”Ÿåœ¨åˆå§‹åŒ–åŠŸèƒ½ä¸­ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨Portal Managerå‡çº§æœŸé—´è°ƒç”¨ã€‚</font><font style="vertical-align: inherit;">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ­¤åŠŸèƒ½å…·æœ‰å†…éƒ¨æ£€æŸ¥ä»¥æ›´æ”¹è§†å£åˆ†è¾¨ç‡çš„åŸå› ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæœªå‘ç”Ÿï¼Œåˆ™ä¸æ‰§è¡Œæ›´æ–°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å°±æˆ‘è€Œè¨€ï¼Œæˆ‘ä¸ºUCanvasRenderTarget2Dåˆ›å»ºäº†ä¸€ä¸ªåŒ…è£…å™¨ç±»ã€‚æˆ‘ç§°å®ƒä¸ºExedreScriptedTextureï¼Œå®ƒæ˜¯å¯ä»¥é™„åŠ åˆ°actorçš„ç»„ä»¶ã€‚æˆ‘åˆ›å»ºäº†æ­¤ç±»ï¼Œä»¥ä¾¿ä¸å…·æœ‰æ¸²æŸ“ä»»åŠ¡çš„è§’è‰²æ–¹ä¾¿åœ°ç®¡ç†æ¸²æŸ“ç›®æ ‡ã€‚ä»–å¯¹æ¸²æŸ“ç›®æ ‡è¿›è¡Œäº†æ­£ç¡®çš„åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä¸æˆ‘è‡ªå·±çš„UIç³»ç»Ÿå…¼å®¹ã€‚ä½†æ˜¯ï¼Œåœ¨é—¨æˆ·ç½‘ç«™çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¸¸è§„çš„RenderTarget2Dçº¹ç†ç»°ç»°æœ‰ä½™ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨å®ƒã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::GeneratePortalTexture() { int32 CurrentSizeX = <span class="hljs-number"><span class="hljs-number">1920</span></span>; int32 CurrentSizeY = <span class="hljs-number"><span class="hljs-number">1080</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ControllerOwner != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { ControllerOwner-&gt;GetViewportSize(CurrentSizeX, CurrentSizeY); } CurrentSizeX = FMath::Clamp( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(CurrentSizeX / <span class="hljs-number"><span class="hljs-number">1.7</span></span>), <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">1920</span></span>); <span class="hljs-comment"><span class="hljs-comment">//1920 / 1.5 = 1280 CurrentSizeY = FMath::Clamp( int(CurrentSizeY / 1.7), 128, 1080); if( CurrentSizeX == PreviousScreenSizeX &amp;&amp; CurrentSizeY == PreviousScreenSizeY ) { return; } PreviousScreenSizeX = CurrentSizeX; PreviousScreenSizeY = CurrentSizeY; //Cleanup existing RTT if( PortalTexture != nullptr &amp;&amp; PortalTexture-&gt;IsValidLowLevel() ) { PortalTexture-&gt;DestroyComponent(); GEngine-&gt;ForceGarbageCollection(); } //Create new RTT PortalTexture = nullptr; PortalTexture = NewObject&lt;UExedreScriptedTexture&gt;(this, UExedreScriptedTexture::StaticClass(), *FString("PortalRenderTarget")); PortalTexture-&gt;SizeX = CurrentSizeX; PortalTexture-&gt;SizeY = CurrentSizeY; //Custom properties of the UExedreScriptedTexture class PortalTexture-&gt;Gamma = 1.0f; PortalTexture-&gt;WrapModeX = 1; //Clamp PortalTexture-&gt;WrapModeY = 1; //Clamp PortalTexture-&gt;bDrawWidgets = false; PortalTexture-&gt;bGenerateMipMaps = false; PortalTexture-&gt;SetClearOnUpdate( false ); //Will be cleared by SceneCapture instead PortalTexture-&gt;Format = ERenderTargetFormat::RGBA16; //Needs 16b to get &gt;1 for Emissive PortalTexture-&gt;AttachToComponent( GetRootComponent(), FAttachmentTransformRules::SnapToTargetIncludingScale ); PortalTexture-&gt;RegisterComponent(); PortalTexture-&gt;SetOwner( this ); PortalTexture-&gt;Init(); PortalTexture-&gt;SetFilterMode( TextureFilter::TF_Bilinear ); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘åˆ›å»ºäº†è‡ªå·±çš„ç±»ï¼Œå› æ­¤æ­¤å¤„è®¾ç½®çš„å±æ€§å¿…é¡»é€‚åº”é€šå¸¸çš„â€œæ¸²æŸ“ç›®æ ‡â€ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é‡è¦çš„æ˜¯è¦äº†è§£æ•è·å°†åœ¨ä½•å¤„æ˜¾ç¤ºã€‚</font><font style="vertical-align: inherit;">ç”±äºæ¸²æŸ“ç›®æ ‡å°†æ˜¾ç¤ºåœ¨æ¸¸æˆä¸­ï¼Œå› æ­¤è¿™å°†åœ¨æ•´ä¸ªåæœŸå¤„ç†ä¹‹å‰å‘ç”Ÿï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¶³å¤Ÿçš„ä¿¡æ¯æ¸²æŸ“åœºæ™¯ï¼ˆå­˜å‚¨å¤§äº1çš„å€¼ä»¥åˆ›å»ºBloomï¼‰ã€‚</font><font style="vertical-align: inherit;">è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©RGBA16æ ¼å¼çš„åŸå› ï¼ˆè¯·æ³¨æ„ï¼Œå®ƒå…·æœ‰è‡ªå·±çš„Enumï¼Œæ‚¨å°†éœ€è¦ä½¿ç”¨ETextureRenderTargetFormatï¼‰ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ä»¥ä¸‹èµ„æºï¼š</font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTextureRenderTarget2D</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ETextureRenderTargetFormat</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USceneCaptureComponent2D</font></font></a> </li></ul><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæˆ‘ä»¬å°†è€ƒè™‘æ›´æ–°åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">åŸºæœ¬åŠŸèƒ½éå¸¸ç®€å•ï¼Œå¯¼è‡´æ›´å¤æ‚ã€‚</font><font style="vertical-align: inherit;">è°ƒç”¨GeneratePortalTextureï¼ˆï¼‰å‡½æ•°ä¹‹å‰æœ‰ä¸€ä¸ªå»¶è¿Ÿï¼Œä»¥é¿å…åœ¨è°ƒæ•´è§†å£å¤§å°æ—¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­ï¼‰é‡æ–°åˆ›å»ºæ¸²æŸ“ç›®æ ‡ã€‚</font><font style="vertical-align: inherit;">åœ¨æ¸¸æˆå‘è¡ŒæœŸé—´ï¼Œå¯ä»¥æ¶ˆé™¤æ­¤å»¶è¿Ÿã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::Update( <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> DeltaTime ) { <span class="hljs-comment"><span class="hljs-comment">//----------------------------------- //Generate Portal texture ? //----------------------------------- UpdateDelay += DeltaTime; if( UpdateDelay &gt; 1.0f ) { UpdateDelay = 0.0f; GeneratePortalTexture(); } //----------------------------------- //Find portals in the level and update them //----------------------------------- AExedrePortal* Portal = UpdatePortalsInWorld(); if( Portal != nullptr ) { UpdateCapture( Portal ); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è°ƒç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdatePortalsInWorldï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ¥æŸ¥æ‰¾å½“å‰ä¸–ç•Œä¸­å­˜åœ¨çš„æ‰€æœ‰é—¨æˆ·ï¼ˆåŒ…æ‹¬æ‰€æœ‰å·²åŠ è½½çš„çº§åˆ«ï¼‰å¹¶è¿›è¡Œæ›´æ–°ã€‚</font><font style="vertical-align: inherit;">è¯¥åŠŸèƒ½è¿˜ç¡®å®šå“ªä¸ªæ˜¯â€œæ´»åŠ¨çš„â€ï¼Œå³ </font><font style="vertical-align: inherit;">å¯¹ç©å®¶å¯è§ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‰¾åˆ°æ´»åŠ¨çš„é—¨æˆ·ï¼Œåˆ™è°ƒç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateCaptureï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå®ƒæ§åˆ¶SceneCaptureç»„ä»¶ã€‚</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä¸–ç•Œæ›´æ–°åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdatePortalsInWorldï¼ˆï¼‰ä¸­çš„å·¥ä½œæ–¹å¼</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br><br><ol><li>   <b></b>   (    ) </li><li>   <b>iterator</b> ,         </li><li>     ,   ,    <b>ClearRTT()</b> ,    .    <b> </b> (,   ). </li><li>  ,     <b></b>  ,    ,     ,     . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¡®å®šä¼ é€é—¨æ­£ç¡®æ€§çš„æ£€æŸ¥å¾ˆç®€å•ï¼šæˆ‘ä»¬å°†æœ€æ¥è¿‘ç©å®¶çš„ä¼ é€é—¨ä½œä¸ºä¼˜å…ˆçº§ï¼Œå› ä¸ºä»ä»–çš„è§’åº¦æ¥çœ‹ï¼Œä»–å¾ˆå¯èƒ½æ˜¯æœ€å¯è§çš„ã€‚</font><font style="vertical-align: inherit;">è¦æ”¾ä¸‹äº²æˆšï¼Œä½†ä¾‹å¦‚ï¼Œæ”¾ç½®åœ¨ç©å®¶èº«åçš„é—¨æˆ·ï¼Œåˆ™éœ€è¦è¿›è¡Œæ›´å¤æ‚çš„æ£€æŸ¥ï¼Œä½†æˆ‘ä¸æƒ³åœ¨æœ¬æ•™ç¨‹ä¸­ç€é‡ä»‹ç»è¿™ä¸€ç‚¹ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå˜å¾—éå¸¸å›°éš¾ã€‚</font></font><br><br><pre> <code class="cpp hljs">AExedrePortal* AExedrePortalManager::UpdatePortalsInWorld() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ControllerOwner == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } AExedreCharacter* Character = ControllerOwner-&gt;GetCharacter(); <span class="hljs-comment"><span class="hljs-comment">//----------------------------------- //Update Portal actors in the world (and active one if nearby) //----------------------------------- AExedrePortal* ActivePortal = nullptr; FVector PlayerLocation = Character-&gt;GetActorLocation(); FVector CameraLocation = Character-&gt;GetCameraComponent()-&gt;GetComponentLocation(); float Distance = 4096.0f; for( TActorIterator&lt;AExedrePortal&gt;ActorItr( GetWorld() ); ActorItr; ++ActorItr ) { AExedrePortal* Portal = *ActorItr; FVector PortalLocation = Portal-&gt;GetActorLocation(); FVector PortalNormal = -1 * Portal-&gt;GetActorForwardVector(); //Reset Portal Portal-&gt;ClearRTT(); Portal-&gt;SetActive( false ); //Find the closest Portal when the player is Standing in front of float NewDistance = FMath::Abs( FVector::Dist( PlayerLocation, PortalLocation ) ); if( NewDistance &lt; Distance ) { Distance = NewDistance; ActivePortal = Portal; } } return ActivePortal; }</span></span></code> </pre> <br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨è¯¥è€ƒè™‘</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UpdateCaptureï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°äº†</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯ä¸€é¡¹å‡çº§åŠŸèƒ½ï¼Œå¯æ•è·é—¨æˆ·çš„å¦ä¸€ç«¯ã€‚</font><font style="vertical-align: inherit;">ä»æ³¨é‡Šä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½åº”è¯¥æ¸…æ¥šï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªç®€çŸ­æè¿°ï¼š</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è·å¾—</font><font style="vertical-align: inherit;">äº†è§’è‰²å’Œç©å®¶æ§åˆ¶å™¨çš„</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é“¾æ¥</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æ£€æŸ¥</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€åˆ‡æ˜¯å¦æ­£ç¡®</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼ˆPortalï¼ŒSceneCaptureç»„ä»¶ï¼ŒPlayerï¼‰ã€‚</font></font></li><li>   <b>Camera</b>    <b>Target</b>  . </li><li> <b></b>    ,     SceneCapture. </li><li>      SceneCapture     Target. </li><li> ,  SceneCapure  ,  ,   <b></b> . </li><li> <b> Render Target</b>  SceneCapture,  . </li><li>  <b> </b>  PlayerController. </li><li> ,    <b>Capture</b>  SceneCapture     . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æˆ‘ä»¬æ‰€è§ï¼Œåœ¨ä¼ é€ç©å®¶æ—¶ï¼ŒSceneCaptureè‡ªç„¶æ— ç‘•çš„è¡Œä¸ºçš„å…³é”®è¦ç´ æ˜¯å°†é—¨æˆ·çš„ä½ç½®å’Œæ—‹è½¬æ­£ç¡®è½¬æ¢åˆ°æœ¬åœ°ç›®æ ‡ç©ºé—´ã€‚ </font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ‰å…³ConvertLocationToActorSpaceï¼ˆï¼‰çš„å®šä¹‰ï¼Œè¯·å‚è§â€œä¼ é€è§’è‰²â€ã€‚ </font></font></blockquote><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::UpdateCapture( AExedrePortal* Portal ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ControllerOwner == <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } AExedreCharacter* Character = ControllerOwner-&gt;GetCharacter(); <span class="hljs-comment"><span class="hljs-comment">//----------------------------------- //Update SceneCapture (discard if there is no active portal) //----------------------------------- if(SceneCapture != nullptr &amp;&amp; PortalTexture != nullptr &amp;&amp; Portal != nullptr &amp;&amp; Character != nullptr ) { UCameraComponent* PlayerCamera = Character-&gt;GetCameraComponent(); AActor* Target = Portal-&gt;GetTarget(); //Place the SceneCapture to the Target if( Target != nullptr ) { //------------------------------- //Compute new location in the space of the target actor //(which may not be aligned to world) //------------------------------- FVector NewLocation = UTool::ConvertLocationToActorSpace( PlayerCamera-&gt;GetComponentLocation(), Portal, Target ); SceneCapture-&gt;SetWorldLocation( NewLocation ); //------------------------------- //Compute new Rotation in the space of the //Target location //------------------------------- FTransform CameraTransform = PlayerCamera-&gt;GetComponentTransform(); FTransform SourceTransform = Portal-&gt;GetActorTransform(); FTransform TargetTransform = Target-&gt;GetActorTransform(); FQuat LocalQuat = SourceTransform.GetRotation().Inverse() * CameraTransform.GetRotation(); FQuat NewWorldQuat = TargetTransform.GetRotation() * LocalQuat; //Update SceneCapture rotation SceneCapture-&gt;SetWorldRotation( NewWorldQuat ); //------------------------------- //Clip Plane : to ignore objects between the //SceneCapture and the Target of the portal //------------------------------- SceneCapture-&gt;ClipPlaneNormal = Target-&gt;GetActorForwardVector(); SceneCapture-&gt;ClipPlaneBase = Target-&gt;GetActorLocation() + (SceneCapture-&gt;ClipPlaneNormal * -1.5f); //Offset to avoid visible pixel border } //Switch on the valid Portal Portal-&gt;SetActive( true ); //Assign the Render Target Portal-&gt;SetRTT( PortalTexture-&gt;GetTexture() ); SceneCapture-&gt;TextureTarget = PortalTexture-&gt;GetTexture(); //Get the Projection Matrix SceneCapture-&gt;CustomProjectionMatrix = ControllerOwner-&gt;GetCameraProjectionMatrix(); //Say Cheeeeese ! SceneCapture-&gt;CaptureScene(); } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠŸèƒ½</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetCameraProjectionMatrixï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ç±»çš„é»˜è®¤çš„PlayerControllerä¸å­˜åœ¨ï¼Œæˆ‘è¯´æˆ‘è‡ªå·±ã€‚</font><font style="vertical-align: inherit;">å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</font></font><br><br><pre> <code class="cpp hljs">FMatrix AExedrePlayerController::GetCameraProjectionMatrix() { FMatrix ProjectionMatrix; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( GetLocalPlayer() != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { FSceneViewProjectionData PlayerProjectionData; GetLocalPlayer()-&gt;GetProjectionData( GetLocalPlayer()-&gt;ViewportClient-&gt;Viewport, EStereoscopicPass::eSSP_FULL, PlayerProjectionData ); ProjectionMatrix = PlayerProjectionData.ProjectionMatrix; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ProjectionMatrix; }</code> </pre> <br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åï¼Œæˆ‘ä»¬éœ€è¦å®ç°å¯¹Teleportå‡½æ•°çš„è°ƒç”¨ã€‚</font><font style="vertical-align: inherit;">é€šè¿‡é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨è¿›è¡Œéƒ¨åˆ†ä¼ é€å¤„ç†çš„åŸå› æ˜¯ï¼Œå¿…é¡»ä¿è¯å¿…è¦é—¨æˆ·çš„æ›´æ–°ï¼Œå› ä¸ºåªæœ‰ç®¡ç†å™¨æ‰å…·æœ‰æœ‰å…³åœºæ™¯ä¸­æ‰€æœ‰é—¨æˆ·çš„ä¿¡æ¯ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœæˆ‘ä»¬æœ‰ä¸¤ä¸ªå·²è¿æ¥çš„é—¨æˆ·ï¼Œé‚£ä¹ˆä»ä¸€ä¸ªé—¨æˆ·åˆ‡æ¢åˆ°å¦ä¸€ä¸ªé—¨æˆ·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸€ä¸ªæ ‡è®°ä¸­æ›´æ–°ä¸¤ä¸ªé—¨æˆ·ã€‚</font><font style="vertical-align: inherit;">å¦åˆ™ï¼Œæ’­æ”¾å™¨å°†è¿›è¡Œä¼ é€å¹¶ä½äºä¼ é€é—¨çš„å¦ä¸€ä¾§ï¼Œä½†æ˜¯ç›®æ ‡ä¼ é€é—¨å°†åœ¨ä¸‹ä¸€å¸§/å°èŠ‚ä¹‹å‰å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚</font><font style="vertical-align: inherit;">è¿™å°†ä¸æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„å¹³é¢ç½‘æ ¼çš„åç§»æè´¨äº§ç”Ÿè§†è§‰é—´éš™ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::RequestTeleportByPortal( AExedrePortal* Portal, AActor* TargetToTeleport ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( Portal != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> &amp;&amp; TargetToTeleport != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { Portal-&gt;TeleportActor( TargetToTeleport ); <span class="hljs-comment"><span class="hljs-comment">//----------------------------------- //Force update //----------------------------------- AExedrePortal* FuturePortal = UpdatePortalsInWorld(); if( FuturePortal != nullptr ) { FuturePortal-&gt;ForceTick(); //Force update before the player render its view since he just teleported UpdateCapture( FuturePortal ); } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å°±æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬ç»ˆäºå®Œæˆäº†Portal Managerï¼ </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å®Œæˆè“å›¾ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ŒæˆPortal Managerä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦å®ŒæˆPortal actoræœ¬èº«ï¼Œç„¶åç³»ç»Ÿå³å¯å·¥ä½œã€‚</font><font style="vertical-align: inherit;">å”¯ä¸€ç¼ºå°‘çš„æ˜¯åˆ»åº¦çº¿åŠŸèƒ½ï¼š</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/455/bd3/f0f/455bd3f0f3b7c9f4f3fb36d5d1ae85d0.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿ä½œæ–¹å¼å¦‚ä¸‹ï¼š </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æ­£åœ¨æ›´æ–°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Material</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œä»¥ä½¿å…¶ä¸ä¼šä¿æŒæ´»åŠ¨çŠ¶æ€ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœé—¨æˆ·ç½‘ç«™å½“å‰</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¤„äºéæ´»åŠ¨çŠ¶æ€</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œåˆ™å…¶ä½™åº¦é‡å°†è¢«ä¸¢å¼ƒã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬è·å¾—äº†Characterç±»æ¥è®¿é—®</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Camera Location</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€éƒ¨åˆ†æ£€æŸ¥æ‘„åƒå¤´æ˜¯å¦åœ¨é—¨æˆ·çš„å†²çªæ¡†ä¸­ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨å…¶</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Material</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åç§»é—¨æˆ·ç½‘æ ¼</font><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬äºŒéƒ¨åˆ†æ˜¯é‡æ–°æ£€æŸ¥ç¢°æ’ç›’å†…çš„ä½ç½®ã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‰§è¡Œäº†è¯¥å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥æ£€æŸ¥</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¦ç©¿è¶Šé—¨æˆ·</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></li><li>        ,   Portal manager,    <b> Teleport</b> . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æˆ‘çš„å›¾è¡¨çš„å±å¹•æˆªå›¾ä¸­ï¼Œæ‚¨å¯ä»¥æ³¨æ„åˆ°ä¸¤ä¸ªæœ‰è¶£çš„åœ°æ–¹ï¼š</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›’å­é‡Œé¢æ˜¯ç‚¹</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å’Œ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·å–é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚æˆ‘è¿˜æ²¡æœ‰è§£é‡Šè¿™ä¸¤ä¸ªåŠŸèƒ½ã€‚è¿™äº›æ˜¯æˆ‘åœ¨è‡ªå·±çš„ç±»ä¸­å®šä¹‰çš„é™æ€å‡½æ•°ï¼Œå› æ­¤æ‚¨å¯ä»¥ä»ä»»ä½•åœ°æ–¹è°ƒç”¨å®ƒä»¬ã€‚è¿™æ˜¯ä¸€ç§å¸®åŠ©ç¨‹åºç±»ã€‚è¿™äº›åŠŸèƒ½çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œæ‚¨å¯ä»¥è‡ªè¡Œå†³å®šå°†å®ƒä»¬æ’å…¥åˆ°å“ªé‡Œã€‚å¦‚æœä¸éœ€è¦åœ¨é—¨æˆ·ç½‘ç«™ç³»ç»Ÿä¹‹å¤–ä½¿ç”¨å®ƒä»¬ï¼Œå¯ä»¥å°†å®ƒä»¬ç›´æ¥æ’å…¥Portalæ¼”å‘˜ç±»ä¸­ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">èµ·åˆï¼Œæˆ‘æƒ³ä½¿ç”¨ç¢°æ’ç³»ç»Ÿæ¥ç¡®å®šç¢°æ’ç›’å†…çš„é—¨æˆ·ç½‘ç«™æ¼”å‘˜æ˜¯å¦åœ¨é—¨æˆ·ç½‘ç«™ä¸­ï¼Œä½†æ˜¯åœ¨æˆ‘çœ‹æ¥è¿™ä¸å¤Ÿå¯é ã€‚å¦å¤–ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ç§æ–¹æ³•ä½¿ç”¨èµ·æ¥æ›´å¿«ï¼Œå¹¶ä¸”å…·æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼šå®ƒè€ƒè™‘äº†actorçš„æ—‹è½¬ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsPointInsideBox</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( FVector Point, UBoxComponent* Box )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( Box != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-comment"><span class="hljs-comment">//From : //https://stackoverflow.com/questions/52673935/check-if-3d-point-inside-a-box/52674010 FVector Center = Box-&gt;GetComponentLocation(); FVector Half = Box-&gt;GetScaledBoxExtent(); FVector DirectionX = Box-&gt;GetForwardVector(); FVector DirectionY = Box-&gt;GetRightVector(); FVector DirectionZ = Box-&gt;GetUpVector(); FVector Direction = Point - Center; bool IsInside = FMath::Abs( FVector::DotProduct( Direction, DirectionX ) ) &lt;= Half.X &amp;&amp; FMath::Abs( FVector::DotProduct( Direction, DirectionY ) ) &lt;= Half.Y &amp;&amp; FMath::Abs( FVector::DotProduct( Direction, DirectionZ ) ) &lt;= Half.Z; return IsInside; } else { return false; } }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">AExedrePortalManager* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPortalManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( AActor* Context )</span></span></span><span class="hljs-function"> </span></span>{ AExedrePortalManager* Manager = <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; <span class="hljs-comment"><span class="hljs-comment">//Retrieve the World from the Context actor if( Context != nullptr &amp;&amp; Context-&gt;GetWorld() != nullptr ) { //Find PlayerController AExedrePlayerController* EPC = Cast&lt;AExedrePlayerController&gt;( Context-&gt;GetWorld()-&gt;GetFirstPlayerController() ); //Retrieve the Portal Manager if( EPC != nullptr &amp;&amp; EPC-&gt;GetPortalManager() != nullptr ) { Manager = EPC-&gt;GetPortalManager(); } } return Manager; }</span></span></code> </pre> <br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è“å›¾æ¼”å‘˜çš„æœ€åä¸€éƒ¨åˆ†æ˜¯</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ForceTick</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¯·è®°ä½ï¼Œå½“ç©å®¶è¶Šè¿‡ä¸€ä¸ªé—¨æˆ·å¹¶ä¸”ä¸Portal Managerå¼ºåˆ¶å¯¹å…¶è¿›è¡Œæ›´æ–°çš„å¦ä¸€ä¸ªé—¨æˆ·ç›¸é‚»æ—¶ï¼Œå°†è°ƒç”¨Force Tickã€‚</font><font style="vertical-align: inherit;">ç”±äºæˆ‘ä»¬åªæ˜¯ä¼ é€ï¼Œå› æ­¤ä¸å¿…ä½¿ç”¨ç›¸åŒçš„ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶ç®€åŒ–ç‰ˆæœ¬ï¼š</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf3/562/22e/cf356222e9d9c81dc38c57d021e51a90.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯¥è¿‡ç¨‹å¤§çº¦ä¸Tickå‡½æ•°åŒæ—¶å¼€å§‹ï¼Œä½†æ˜¯æˆ‘ä»¬åªæ‰§è¡Œåºåˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ›´æ–°ææ–™ã€‚ </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å®Œæˆäº†å— </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å·®ä¸å¤šäº† </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœä»¥è¿™ç§å½¢å¼å®ç°é—¨æˆ·ç½‘ç«™ç³»ç»Ÿï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c1/f2f/9f7/4c1f2f9f71e8ce213764d42dad1d20c3.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯æ€ä¹ˆå›äº‹</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤gifä¸­ï¼Œæ¸¸æˆçš„å¸§é¢‘é™åˆ¶ä¸º6 FPSï¼Œä»¥ä¾¿æ›´æ¸…æ¥šåœ°æ˜¾ç¤ºé—®é¢˜ã€‚åœ¨ä¸€ä¸ªå¸§ä¸­ï¼Œè¯¥å¤šç»´æ•°æ®é›†æ¶ˆå¤±äº†ï¼Œå› ä¸º</font><font style="vertical-align: inherit;">è™šå¹»å¼•æ“</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‰ªè¾‘ç³»ç»Ÿ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®¤ä¸ºå®ƒæ˜¯ä¸å¯è§çš„ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™æ˜¯å› ä¸ºå‘ç°æ˜¯åœ¨å½“å‰å¸§ä¸­æ‰§è¡Œçš„ï¼Œç„¶ååœ¨ä¸‹ä¸€ä¸ªå¸§ä¸­ä½¿ç”¨ã€‚è¿™æ ·ä¼šé€ æˆ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸€å¸§</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„</font><b><font style="vertical-align: inherit;">å»¶è¿Ÿ</font></b><font style="vertical-align: inherit;">ã€‚é€šå¸¸å¯ä»¥é€šè¿‡å±•å¼€å¯¹è±¡çš„è¾¹ç•Œæ¡†æ¥è§£å†³å®ƒï¼Œä»¥ä¾¿åœ¨å®ƒå˜å¾—å¯è§ä¹‹å‰å°±å¯¹å…¶è¿›è¡Œæ³¨å†Œã€‚ä½†æ˜¯ï¼Œè¿™åœ¨è¿™é‡Œä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå½“æˆ‘ä»¬ç©¿è¶Šé—¨æˆ·ç½‘ç«™æ—¶ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªåœ°æ–¹ä¼ é€åˆ°ä¸€ä¸ªå®Œå…¨ä¸åŒçš„åœ°æ–¹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¦ç”¨è£å‰ªç³»ç»Ÿä¹Ÿæ˜¯ä¸å¯èƒ½çš„ï¼Œå°¤å…¶æ˜¯å› ä¸ºåœ¨å…·æœ‰è®¸å¤šå¯¹è±¡çš„çº§åˆ«ä¸Šï¼Œè¿™ä¼šé™ä½æ€§èƒ½ã€‚å¦å¤–ï¼Œæˆ‘å°è¯•äº†è®¸å¤šä½¿ç”¨Unrealå¼•æ“çš„å›¢é˜Ÿï¼Œä½†æ²¡æœ‰å¾—åˆ°ç§¯æçš„ç»“æœï¼šåœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œéƒ½åªå»¶è¿Ÿäº†ä¸€å¸§ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨è¯¦ç»†ç ”ç©¶äº†è™šå¹»å¼•æ“æºä»£ç ä¹‹åï¼Œæˆ‘è®¾æ³•æ‰¾åˆ°äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆè·¯å¾„å¾ˆé•¿-èŠ±äº†ä¸€ä¸ªå¤šæ˜ŸæœŸçš„æ—¶é—´ï¼‰ï¼</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸SceneCaptureç»„ä»¶ä¸€æ ·ï¼Œæ‚¨å¯ä»¥å‘Šè¯‰æ’­æ”¾å™¨çš„ç›¸æœºæˆ‘ä»¬è¿›è¡Œäº†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è·³è·ƒå‰ªåˆ‡</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-æ‘„åƒæœºä½ç½®è·³åˆ°äº†ä¸¤å¸§ä¹‹é—´ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸èƒ½ä¾èµ–å‰ä¸€å¸§çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">å½“ä½¿ç”¨Matineeæˆ–Sequenceræ—¶ï¼Œä¾‹å¦‚åœ¨åˆ‡æ¢ç›¸æœºæ—¶ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ­¤è¡Œä¸ºï¼šè¿åŠ¨æ¨¡ç³Šæˆ–å¹³æ»‘ä¸èƒ½ä¾èµ–äºå‰ä¸€å¸§çš„ä¿¡æ¯ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤ä¸ªæ–¹é¢ï¼š</font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LocalPlayer</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šæ­¤ç±»å¤„ç†å„ç§ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œç©å®¶çš„è§†å£ï¼‰ï¼Œå¹¶ä¸PlayerControllerå…³è”ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å½±å“æ’­æ”¾å™¨ç›¸æœºçš„æ¸²æŸ“è¿‡ç¨‹ã€‚</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PlayerController</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼šå½“ç©å®¶è¿›è¡Œä¼ é€æ—¶ï¼Œç”±äºå¯ä»¥è®¿é—®LocalPlayerï¼Œå› æ­¤æ­¤ç±»å¼€å§‹æ‹¼æ¥ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯¥è§£å†³æ–¹æ¡ˆçš„æœ€å¤§ä¼˜åŠ¿åœ¨äºï¼Œå¼•æ“æ¸²æŸ“è¿‡ç¨‹ä¸­çš„å¹²é¢„æœ€å°‘ï¼Œå¹¶ä¸”æ˜“äºåœ¨å°†æ¥çš„è™šå¹»å¼•æ“æ›´æ–°ä¸­è¿›è¡Œç»´æŠ¤ã€‚ </font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªLocalPlayerçš„æ–°ç±»å¼€å§‹ã€‚</font><font style="vertical-align: inherit;">ä¸‹é¢çš„æ ‡é¢˜æ ‡è¯†äº†ä¸¤ä¸ªä¸»è¦ç»„ä»¶ï¼šé‡æ–°å®šä¹‰â€œåœºæ™¯è§†å£â€è®¡ç®—å’Œç”¨äºè°ƒç”¨ç›¸æœºèƒ¶åˆçš„æ–°åŠŸèƒ½ã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> once #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CoreMinimal.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Engine/LocalPlayer.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ExedreLocalPlayer.generated.h"</span></span></span><span class="hljs-meta"> UCLASS() class EXEDRE_API UExedreLocalPlayer : public ULocalPlayer { GENERATED_BODY() UExedreLocalPlayer(); public: FSceneView* CalcSceneView( class FSceneViewFamily* ViewFamily, FVector&amp; OutViewLocation, FRotator&amp; OutViewRotation, FViewport* Viewport, class FViewElementDrawer* ViewDrawer, EStereoscopicPass StereoPass) override; void PerformCameraCut(); private: bool bCameraCut; };</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¿™æ˜¯æ‰€æœ‰äº‹æƒ…çš„å®ç°æ–¹å¼ï¼š </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Exedre.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ExedreLocalPlayer.h"</span></span></span><span class="hljs-meta"> UExedreLocalPlayer::UExedreLocalPlayer() { bCameraCut = false; } FSceneView* UExedreLocalPlayer::CalcSceneView( class FSceneViewFamily* ViewFamily, FVector&amp; OutViewLocation, FRotator&amp; OutViewRotation, FViewport* Viewport, class FViewElementDrawer* ViewDrawer, EStereoscopicPass StereoPass) { </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// ULocalPlayer::CalcSceneView() use a ViewInitOptions to create // a FSceneView which contains a "bCameraCut" variable // See : H:\GitHub\UnrealEngine\Engine\Source\Runtime\Renderer\Private\SceneCaptureRendering.cpp // as well for bCameraCutThisFrame in USceneCaptureComponent2D FSceneView* View = Super::CalcSceneView(ViewFamily, OutViewLocation, OutViewRotation, Viewport, ViewDrawer, StereoPass ); if( bCameraCut ) { View-&gt;bCameraCut = true; bCameraCut = false; } return View; } void UExedreLocalPlayer::PerformCameraCut() { bCameraCut = true; }</span></span></span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PerformCameraCutï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åªæ˜¯ä½¿ç”¨å¸ƒå°”å€¼å¯åŠ¨Camera Cutã€‚</font><font style="vertical-align: inherit;">å½“å¼•æ“è°ƒç”¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CalcSceneViewï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°æ—¶</font><font style="vertical-align: inherit;">ï¼Œæˆ‘ä»¬é¦–å…ˆè¿è¡ŒåŸå§‹å‡½æ•°ã€‚</font><font style="vertical-align: inherit;">ç„¶åæˆ‘ä»¬æ£€æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œç²˜åˆã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬å°†åœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FSceneView</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“æ„ä¸­é‡æ–°å®šä¹‰Camera Cutå¸ƒå°”å˜é‡</font><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">å°†ç”±å¼•æ“æ¸²æŸ“â€‹â€‹è¿‡ç¨‹ä½¿ç”¨ï¼Œç„¶åé‡ç½®è¯¥å¸ƒå°”å˜é‡ï¼ˆä½¿ç”¨å®ƒï¼‰ã€‚</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ’­æ”¾å™¨æ§åˆ¶å™¨æ–¹é¢ï¼Œæ›´æ”¹å¾ˆå°ã€‚</font><font style="vertical-align: inherit;">æ‚¨éœ€è¦åœ¨æ ‡å¤´ä¸­æ·»åŠ ä¸€ä¸ªå˜é‡ï¼Œä»¥å­˜å‚¨æŒ‡å‘LocalPlayeræœ¬æœºç±»çš„é“¾æ¥ï¼š</font></font><br><br><pre> <code class="cpp hljs"> UPROPERTY() UExedreLocalPlayer* LocalPlayer;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç„¶ååœ¨</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeginPlayï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°ä¸­</font><font style="vertical-align: inherit;">ï¼š</font></font><br><br><pre> <code class="cpp hljs"> LocalPlayer = Cast&lt;UExedreLocalPlayer&gt;( GetLocalPlayer() );</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æˆ‘è¿˜æ·»åŠ äº†ä¸€ä¸ªåŠŸèƒ½æ¥å¿«é€Ÿå¯åŠ¨Cutï¼š </font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePlayerController::PerformCameraCut() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( LocalPlayer != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { LocalPlayer-&gt;PerformCameraCut(); } }</code> </pre> <br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ€åï¼Œåœ¨é—¨æˆ·ç½‘ç«™ç®¡ç†å™¨å‡½æ•°</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RequestTeleportByPortalï¼ˆï¼‰ä¸­ï¼Œ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬å¯ä»¥åœ¨Camera Cutéšå½¢ä¼ é€æœŸé—´æ‰§è¡Œï¼š</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> AExedrePortalManager::RequestTeleportByPortal( AExedrePortal* Portal, AActor* TargetToTeleport ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( Portal != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> &amp;&amp; TargetToTeleport != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ControllerOwner != <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span> ) { ControllerOwner-&gt;PerformCameraCut(); } [...]</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»…æ­¤è€Œå·²ï¼</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¿…é¡»åœ¨æ›´æ–°SceneCaptureä¹‹å‰è°ƒç”¨Camera Cutï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒåœ¨å‡½æ•°çš„å¼€å¤´ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æœ€ç»ˆç»“æœ </font></font></h2><br> <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="noopener noreferrer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç°åœ¨æˆ‘ä»¬å·²ç»å­¦ä¼šäº†åœ¨é—¨æˆ·ä¸­æ€è€ƒã€‚</font></font></a></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœç³»ç»Ÿè¿è¡Œè‰¯å¥½ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿåˆ›å»ºä»¥ä¸‹å†…å®¹ï¼š</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a9/47f/229/5a947f2299f45d3deab4cfc258045cc1.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> éªŒè¯æ­£ç¡®åˆ›å»ºå’Œåˆå§‹åŒ–äº†Portal Managerã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ­£ç¡®åˆ›å»ºäº†æ¸²æŸ“ç›®æ ‡ï¼ˆå¯ä»¥ä½¿ç”¨åœ¨å†…å®¹æµè§ˆå™¨ä¸­åˆ›å»ºçš„æ¸²æŸ“ç›®æ ‡å¼€å§‹ä½¿ç”¨ï¼‰ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é—¨æˆ·å·²æ­£ç¡®æ¿€æ´»å’Œåœç”¨ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é—¨æˆ·ç½‘ç«™å·²åœ¨ç¼–è¾‘å™¨ä¸­æ­£ç¡®è®¾ç½®äº†ç›®æ ‡å‚ä¸è€…ã€‚ </font></font></li></ul><br><h2> é—®ä¸ç­” </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ‰äººé—®æˆ‘å…³äºæœ¬æ•™ç¨‹çš„æœ€æµè¡Œçš„é—®é¢˜ï¼š</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯å¦å¯ä»¥ç”¨é’å™¨è€Œä¸æ˜¯C ++æ¥å®ç°ï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é™¤äº†ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼Œå¤§éƒ¨åˆ†ä»£ç éƒ½å¯ä»¥ç”¨é’å™¨å®ç°ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è“å›¾ä¸­ä¸æä¾›ç”¨äºè·å–æŠ•å½±çŸ©é˜µ</font><font style="vertical-align: inherit;">çš„LocalPlayer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GetProjectionDataï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è“å›¾ä¸­æ²¡æœ‰</font><font style="vertical-align: inherit;">LocalPlayer </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CalcSceneViewï¼ˆï¼‰</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ï¼Œè¿™å¯¹äºè§£å†³è£å‰ªç³»ç»Ÿé—®é¢˜è‡³å…³é‡è¦ã€‚</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å› æ­¤ï¼Œæ‚¨éœ€è¦ä½¿ç”¨C ++å®ç°æ¥è®¿é—®è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä¿®æ”¹å¼•æ“æºä»£ç ä»¥ä½¿å…¶å¯ä»¥é€šè¿‡è“å›¾è¿›è¡Œè®¿é—®ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å¯ä»¥åœ¨VRä¸­ä½¿ç”¨æ­¤ç³»ç»Ÿå—ï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ˜¯çš„ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼ŒæŸäº›éƒ¨åˆ†å°†å¿…é¡»è¿›è¡Œä¿®æ”¹ï¼Œä¾‹å¦‚ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨éœ€è¦ä½¿ç”¨ä¸¤ä¸ªæ¸²æŸ“ç›®æ ‡ï¼ˆæ¯åªçœ¼ç›ä¸€ä¸ªï¼‰ï¼Œå¹¶åœ¨é—¨æˆ·ææ–™ä¸­å¯¹å…¶è¿›è¡Œé®ç½©ï¼Œä»¥åœ¨å±å¹•ç©ºé—´ä¸­å¹¶æ’æ˜¾ç¤ºã€‚</font><font style="vertical-align: inherit;">æ¯ä¸ªæ¸²æŸ“ç›®æ ‡åº”ä¸ºVRè®¾å¤‡åˆ†è¾¨ç‡çš„ä¸€åŠã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ‚¨éœ€è¦ä½¿ç”¨ä¸¤ä¸ªSceneCaptureæ¥ä»¥æ­£ç¡®çš„è·ç¦»ï¼ˆçœ¼ç›ä¹‹é—´çš„è·ç¦»ï¼‰æ¸²æŸ“ç›®æ ‡ï¼Œä»¥åˆ›å»ºç«‹ä½“æ•ˆæœã€‚ </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸»è¦é—®é¢˜å°†æ˜¯æ€§èƒ½ï¼Œå› ä¸ºé—¨æˆ·çš„å¦ä¸€ä¾§å°†å¿…é¡»å‘ˆç°ä¸¤æ¬¡ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦ä¸€ä¸ªå¯¹è±¡å¯ä»¥ç©¿è¿‡é—¨æˆ·å—ï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘çš„ä»£ç ä¸­æ²¡æœ‰ã€‚ä½†æ˜¯ï¼Œä½¿å…¶æ›´é€šç”¨å¹¶ä¸æ˜¯é‚£ä¹ˆå›°éš¾ã€‚ä¸ºæ­¤ï¼Œé—¨æˆ·ç½‘ç«™éœ€è¦è·Ÿè¸ªæœ‰å…³é™„è¿‘æ‰€æœ‰ç‰©ä½“çš„æ›´å¤šä¿¡æ¯ï¼Œä»¥æ£€æŸ¥å®ƒä»¬æ˜¯å¦è¶Šè¿‡ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç³»ç»Ÿæ˜¯å¦æ”¯æŒé€’å½’ï¼ˆé—¨æˆ·å†…éƒ¨çš„é—¨æˆ·ï¼‰ï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æ•™ç¨‹ä¸æ˜¯ã€‚å¯¹äºé€’å½’ï¼Œæ‚¨éœ€è¦å…¶ä»–æ¸²æŸ“ç›®æ ‡å’ŒSceneCaptureã€‚è¿˜éœ€è¦ç¡®å®šé¦–å…ˆæ¸²æŸ“å“ªä¸ªRenderTargetï¼Œä¾æ­¤ç±»æ¨ã€‚è¿™æ˜¯ç›¸å½“å›°éš¾çš„ï¼Œå¹¶ä¸”æˆ‘ä¸æƒ³è¿™æ ·åšï¼Œå› ä¸ºå¯¹äºæˆ‘çš„é¡¹ç›®è€Œè¨€ï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘å¯ä»¥ç©¿è¿‡å¢™é™„è¿‘çš„å…¥å£å—ï¼Ÿ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œæˆ‘çœ‹åˆ°äº†ä¸¤ç§æ–¹æ³•ï¼ˆç†è®ºä¸Šï¼‰ï¼š</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¦ç”¨ç©å®¶çš„ç¢°æ’ï¼Œä»¥ä¾¿ä»–å¯ä»¥ç©¿è¿‡å¢™å£ã€‚</font><font style="vertical-align: inherit;">å®ƒå¾ˆå®¹æ˜“å®ç°ï¼Œä½†æ˜¯ä¼šå¸¦æ¥å¾ˆå¤šå‰¯ä½œç”¨ã€‚</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç ´è§£ä¸€ä¸ªç¢°æ’ç³»ç»Ÿä»¥åŠ¨æ€åˆ›å»ºä¸€ä¸ªæ´ï¼Œè¿™å°†å…è®¸ç©å®¶é€šè¿‡ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦ä¿®æ”¹å¼•æ“çš„ç‰©ç†ç³»ç»Ÿã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œæ®æˆ‘æ‰€çŸ¥ï¼ŒåŠ è½½å…³å¡åï¼Œé™æ€ç‰©ç†æ— æ³•æ›´æ–°ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œæ”¯æŒæ­¤åŠŸèƒ½å°†éœ€è¦å¤§é‡çš„å·¥ä½œã€‚</font><font style="vertical-align: inherit;">å¦‚æœæ‚¨çš„é—¨æˆ·ç½‘ç«™æ˜¯é™æ€çš„ï¼Œåˆ™å¯ä»¥ä½¿ç”¨çº§åˆ«æµåœ¨ä¸åŒçš„å†²çªä¹‹é—´åˆ‡æ¢æ¥è§£å†³æ­¤é—®é¢˜ã€‚</font></font></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448802/">https://habr.com/ru/post/zh-CN448802/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448788/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬2ç« ï¼Œç¼–å†™æµ‹è¯•å‡½æ•°</a></li>
<li><a href="../zh-CN448790/index.html">SpaceVIL-ç”¨äºåœ¨.Net Coreï¼Œ.Net Standardå’ŒJVMä¸Šå¼€å‘çš„è·¨å¹³å°GUIæ¡†æ¶</a></li>
<li><a href="../zh-CN448796/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ é…ç½®ï¼Œç¬¬6ç« </a></li>
<li><a href="../zh-CN448798/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ å°†pytestä¸å…¶ä»–å·¥å…·ç»“åˆä½¿ç”¨ï¼Œç¬¬7ç« </a></li>
<li><a href="../zh-CN448800/index.html">ä½¿ç”¨.vsconfigåœ¨æ•´ä¸ªç»„ç»‡ä¸­é…ç½®Visual Studio</a></li>
<li><a href="../zh-CN448804/index.html">ä¸ºmacOSçš„å¼ºåŒ–è¿è¡Œæ—¶å’Œå…¬è¯åšå¥½å‡†å¤‡</a></li>
<li><a href="../zh-CN448806/index.html">åœ¨Qtåº“ä¸Šåˆ›å»ºæ‰©å±•ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN448808/index.html">å…³äºç®€å•çš„äº‹æƒ…ï¼Œå¤æ‚çš„ã€‚ â€œç¡è§‰çš„é’¢ã€‚â€ å¦‚ä½•ç”¨å•ä¸ªèºæ “å¯¹ç”Ÿé”ˆçš„èºæ “æˆ–éWD-40èºæ “æ¶¦æ»‘</a></li>
<li><a href="../zh-CN448810/index.html">æˆ‘å¦‚ä½•æŠ“åˆ°é»‘å®¢</a></li>
<li><a href="../zh-CN448812/index.html">â€œ Bereshitâ€ç™»æœˆä»»åŠ¡-æ‰¿è¿äººäº‹æ•…å‘ç”Ÿåæœå¯»ç¬¬ä¸€ä¸ªç™»æœˆåº“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>