<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖüèæ ‚öìÔ∏è üêñ Uso de Unity3D en la aplicaci√≥n nativa de iOS / Android para modelar la iluminaci√≥n de espacios abiertos üë®üèº‚Äç‚öïÔ∏è üõ∏ üë©üèº‚Äçü§ù‚Äçüë©üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unity3D es una conocida plataforma de desarrollo de juegos en 3D y 2D que ha ganado popularidad en todo el mundo. Al mismo tiempo, sus capacidades no ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uso de Unity3D en la aplicaci√≥n nativa de iOS / Android para modelar la iluminaci√≥n de espacios abiertos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/417779/"><img src="https://habrastorage.org/webt/ac/6n/is/ac6nistgzfsvyyhyj3wqngoiak4.png" alt="imagen"><br><br>  Unity3D es una conocida plataforma de desarrollo de juegos en 3D y 2D que ha ganado popularidad en todo el mundo.  Al mismo tiempo, sus capacidades no se limitan al desarrollo de solo aplicaciones de juegos, sino que son adecuadas para su uso en cualquier otra √°rea que requiera la creaci√≥n de aplicaciones multiplataforma para trabajar con gr√°ficos.  En este art√≠culo hablaremos sobre la experiencia de usar Unity3D para desarrollar un sistema para calcular la iluminaci√≥n de espacios abiertos. <br><a name="habracut"></a><br>  La compa√±√≠a con la que colaboramos es la corporaci√≥n internacional de iluminaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BOOS LIGHTING GROUP</a> .  Para ampliar el atractivo de sus productos y simplificar la interacci√≥n con los clientes, fue necesario desarrollar una aplicaci√≥n que le permita simular visualmente la ubicaci√≥n de los dispositivos de iluminaci√≥n, as√≠ como realizar c√°lculos de iluminaci√≥n y mostrar la informaci√≥n t√©cnica necesaria en el informe.  Se asumi√≥ que la aplicaci√≥n fue lanzada en una tableta iPad o Android por un cliente potencial o representante de ventas y le permite al cliente tener una idea inmediata sobre la posibilidad de instalaciones de iluminaci√≥n. <br><br>  El trabajo se llev√≥ a cabo en etapas sobre la base de la especificaci√≥n desarrollada de requisitos y consultas de la corporaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BOOS LIGHTING GROUP</a> sobre el tema del proyecto. <br><br>  En t√©rminos generales, la aplicaci√≥n es un editor que le permite agregar y editar elementos de iluminaci√≥n, carreteras, elementos decorativos, realizar c√°lculos de ingenier√≠a de iluminaci√≥n de la escena, mostrar un informe en pdf.  Cada elemento tiene su propio conjunto de par√°metros para editar y subtipos que afectan su visualizaci√≥n y c√°lculo. <br><br><ul><li>  Hay varios tipos de m√°stiles de iluminaci√≥n, con varios tipos de accesorios, √°ngulos de inclinaci√≥n de l√°mparas y longitudes de extensi√≥n.  Para ciertos tipos de luminarias, el ajuste individual es posible con una indicaci√≥n de la direcci√≥n de la iluminaci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2o/ci/da/2ocida45cxhpgpekhtfat_mc_6y.png" width="70%" alt="imagen"></div></li><li>  Las carreteras pueden ser secciones lineales, elementos de arco, √°rea, anillo.  Para cada elemento, las dimensiones, la posici√≥n, el tipo de dise√±o y la capa se pueden personalizar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s1/3s/lx/s13slxoinkzba4yyljw518pqw78.png" alt="imagen" width="70%"></div></li><li>  Elementos decorativos: autom√≥viles, √°rboles, arbustos, se√±ales de tr√°fico. </li></ul><br>  Todos los elementos de la escena se pueden girar y mover.  Tambi√©n se admiten acciones est√°ndar para revertir o volver a intentar.  La configuraci√≥n general del proyecto le permite especificar la textura del dorg, la superficie de la tierra, la visualizaci√≥n de par√°metros adicionales.  La escena se muestra en modos 2D / 3D.  Y al calcular la iluminaci√≥n en la superficie, se muestra un mapa de la iluminaci√≥n de la superficie en colores ficticios. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ac/6n/is/ac6nistgzfsvyyhyj3wqngoiak4.png" width="100%" alt="imagen"></div><br><br>  Si es posible, toda la interfaz de usuario debe hacerse con herramientas nativas de iOS / Android. <br>  El principal requisito t√©cnico para la aplicaci√≥n es poder calcular la iluminaci√≥n del escenario de acuerdo con las especificaciones t√©cnicas de los accesorios.  Tambi√©n se requer√≠a la capacidad de cada dispositivo para mostrar y ver su patr√≥n de radiaci√≥n (curvas de intensidad de luz) en modos 3D / 2D. <br><br><h4>  Selecci√≥n de plataforma </h4><br>  Para implementar el proyecto, elegimos Unity como m√°s conveniente para que implementemos la funcionalidad requerida.  En general, nuestra empresa ten√≠a experiencia trabajando con otros motores y plataformas 3D (OpenSceneGraph, Ogre3D, LibGdx) y t√©cnicamente todos pueden hacer frente a la tarea requerida, pero esta vez la elecci√≥n recay√≥ en Unity, lo que facilita la administraci√≥n de la escena durante el desarrollo y la depuraci√≥n en el proceso de trabajo. <br><br><h4>  Las principales dificultades </h4><br>  No entraremos en las complejidades del desarrollo de toda la aplicaci√≥n, ya que t√©cnicamente la funcionalidad para mostrar y editar la escena es bastante est√°ndar.  Naturalmente, hubo dificultades con los mecanismos de edici√≥n espec√≠fica de objetos, agregarlos y eliminarlos, as√≠ como guardar una cadena de comandos para la posibilidad de repetir y cancelar acciones. <br>  Nos gustar√≠a detenernos solo en las caracter√≠sticas del sistema relacionadas con el trabajo con la interfaz de usuario nativa, generar informes en PDF y trabajar con fotometr√≠a y c√°lculos de iluminaci√≥n. <br><br><h4>  Trabajar con IU nativa </h4><br>  En la mayor√≠a de los casos, Unity interact√∫a con las funciones nativas del sistema utilizando el sistema de complemento, que le permite integrar la funcionalidad deseada en la aplicaci√≥n.  Sin embargo, en nuestro caso la situaci√≥n es algo opuesta.  Necesit√°bamos mostrar una IU completa en la parte superior de la ventana de Unity. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/0s/41/4z0s41r48kbp8cuzxnc7naj6l3i.png" width="70%" alt="imagen"></div><br><br>  Afortunadamente, Unity puede exportar un proyecto que puede usarse como base para una aplicaci√≥n nativa.  La principal dificultad en este caso es c√≥mo integrar una IU adicional en el proyecto resultante.  Adem√°s, es igualmente importante que al ensamblar un proyecto de Unity, su formato y ubicaci√≥n de archivo est√©n formados por Unity y se reescriban parcialmente, lo que limita la posibilidad de modificar el proyecto. <br><br>  Al desarrollar una aplicaci√≥n para iOS, utilizamos el mecanismo propuesto en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> .  Durante el desarrollo, se utiliz√≥ Unity 5.5 y, por el momento, lo que se indica en √©l puede perder relevancia.  Al ensamblar el proyecto de Android, no hubo problemas adicionales, con la excepci√≥n de que Unity sobrescribe el archivo de manifiesto y los archivos de recursos cada vez. <br>  Un problema adicional es que Unity solo puede funcionar en una ventana.  Al mismo tiempo, necesit√°bamos asegurarnos de que Unity mostrara toda la escena, y al abrir la ventana de configuraci√≥n, deber√≠a mostrarse un modelo 3D del cuerpo fotom√©trico de la l√°mpara.  Para lograr esto, tuve que usar un "hack" y usar el mismo objeto UIView en diferentes ventanas. <br><br>  Para enviar mensajes, utilizamos la funcionalidad est√°ndar que ofrece Unity.  Es decir, todos los mensajes estaban en formato json y se transmit√≠an en l√≠neas simples.  Esto no impuso ninguna restricci√≥n en el rendimiento ya que el tama√±o de los mensajes alcanz√≥ un m√°ximo de 100 caracteres, y su frecuencia fue determinada por la velocidad del trabajo con el programa.  Al mismo tiempo, en aplicaciones m√°s exigentes, tiene sentido crear su propio controlador de mensajes tal como se presenta en Haber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><h4>  C√°lculo de iluminaci√≥n </h4><br>  Todas las fuentes de luz utilizadas en la aplicaci√≥n se entregan en formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IES</a> est√°ndar, que describe la distribuci√≥n de la luz en diferentes direcciones ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n</a> ).  Este formato es ampliamente utilizado en sistemas CAD profesionales y editores 3D.  Es un archivo de texto que indica la intensidad de la luz en varias direcciones y una metainformaci√≥n adicional que indica el tipo, la intensidad total de la fuente, los ejes y los planos de simetr√≠a.  Dada la simetr√≠a de los aparatos, el archivo ies puede ser muy peque√±o.  Por ejemplo, en el caso de la simetr√≠a axial, es suficiente indicar el trazado de la luz en un solo plano. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de un archivo IES simple</b> <div class="spoiler_text"><pre><code class="plaintext hljs">IESNA91[TEST] Simple demo intensity distribution [MANUFAC] Lightscape Technologies, Inc. TILT=NONE 1 -1 1 8 1 1 2 0.0 0.0 0.0 1.0 1.0 0.0 0.0 5.0 10.0 20.0 30.0 45.0 65.0 90.0 0.0 1000.0 1100.0 1300.0 1150.0 930.0 650.0 350.0 0.0</code> </pre> <br></div></div><br>  Para mostrar el patr√≥n de radiaci√≥n, se utilizaron dos tipos de pantalla: <br><br><ul><li>  Las curvas de intensidad de luz (KSS) es un gr√°fico bidimensional que muestra la intensidad de la luz en uno de los planos principales seg√∫n la direcci√≥n.  Por conveniencia, este gr√°fico puede representarse tanto en el sistema de coordenadas polares como en el cartesiano. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/df/89/xc/df89xcesta0qlw4jcyuxpbihmyi.png" width="100%" alt="imagen"></div></li><li>  Cuerpo fotom√©trico: una imagen tridimensional de la intensidad de la luz en diferentes direcciones. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/su/1s/if/su1sifzigs4cwuy-jg6bhpni79o.png" width="100%" alt="imagen"></div></li></ul><br><h4>  M√≥dulo de c√°lculo </h4><br>  Para calcular la iluminaci√≥n, el cliente ten√≠a su propio m√≥dulo C ++ utilizado en otros productos de la compa√±√≠a y, por lo tanto, deb√≠a integrarlo en el proyecto de Unity.  El orden de conexi√≥n del m√≥dulo fue diferente de la plataforma utilizada. <br><br><ul><li>  En la plataforma iOS, Unitu puede llamar directamente a las funciones C, as√≠ que simplemente copie el c√≥digo fuente del m√≥dulo directamente en el proyecto y agregue clases para su interacci√≥n con Unity.  Las clases se pueden almacenar directamente en el proyecto de iOS y en la carpeta de complementos, que se copian autom√°ticamente cuando el proyecto se exporta a Xcode.  Un ejemplo de llamar a funciones de C ++ es el siguiente: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"__Internal"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateLight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[MarshalAs(UnmanagedType.LPArray, SizeParamIndex = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function">)] Light[] lights, </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> size, </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ref</span></span></span><span class="hljs-function"> CalculationResult result)</span></span>;</code> </pre> </li><li>  En la plataforma Android, el m√≥dulo C ++ debe estar precompilado en una biblioteca separada.  Esto se puede hacer directamente agregando fuentes C ++ al proyecto y configurando gradle para construirlas en bibliotecas. </li><li>  Adem√°s, para depurar y probar la parte de Unity, el desarrollo se llev√≥ a cabo en una m√°quina con Windows, por lo que tambi√©n fue necesario conectar el c√≥digo fuente del m√≥dulo en Windows.  Esto se hace de manera similar al proyecto de Android, solo en este caso los archivos descargados se recopilan en la biblioteca dll y se conectan al proyecto. </li></ul><br><h4>  Pantalla de mapa de luz </h4><br>  A petici√≥n del cliente, los resultados del c√°lculo de la iluminaci√≥n deben mostrarse en la superficie de la escena.  En la superficie de las carreteras, es necesario usar colores ficticios con la visualizaci√≥n de una escala para igualar el color y la intensidad de la luz, y en el resto de la superficie, basta con mostrar su brillo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/18/5q/k9/185qk9lbx4fsoq3ax0miaedzjkm.png" width="70%" alt="imagen"></div><br><br>  Como se mencion√≥ anteriormente, todo el c√°lculo se realiz√≥ mediante un complemento C ++ al que se transmitieron los datos sobre las fuentes de color.  El resultado del c√°lculo fue una matriz bidimensional de intensidad de luz sobre toda la superficie de la escena con un detalle dado. <br><br>  El mapa de irradiancia resultante se analiz√≥ para determinar el valor m√≠nimo y m√°ximo mediante el cual se construy√≥ una textura de gradiente unidimensional (GradientRamp).  Usando esta textura, la intensidad de la luz se convirti√≥ en colores ficticios directamente en el sombreador de fragmentos.  Al mismo tiempo, se us√≥ el mismo sombreador para diferentes superficies de carreteras y la superficie de la tierra, y se cambi√≥ el modo de iluminaci√≥n utilizando el sombreador de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">compilaci√≥n m√∫ltiple</a> ". <br><br><h4>  Generaci√≥n de archivos PDF </h4><br>  De acuerdo con los requisitos t√©cnicos, se generar√≠a un informe para el usuario que conten√≠a informaci√≥n sobre la escena general (dimensiones, sus im√°genes, par√°metros de iluminaci√≥n) e informaci√≥n sobre cada tipo de luminaria utilizada, indicando su posici√≥n, direcci√≥n de las caracter√≠sticas, as√≠ como diagramas KCC y una pantalla fotom√©trica del cuerpo. <br>  Dado que el informe deb√≠a mostrarse tanto en iOS como en Android, era necesario generar su informe directamente en el m√≥dulo Unity y luego mostrarlo utilizando herramientas nativas est√°ndar. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aw/fo/je/awfojewyanvogdxu6sihv6zr-i8.png" alt="imagen"></div><br>  Para compilar pdf, se seleccion√≥ la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">iTextSharp</a> que cumple con nuestros requisitos.  Crear un informe en √©l no es particularmente dif√≠cil y consiste en crear bloques de texto, tablas e im√°genes directamente desde el c√≥digo.  Sin embargo, durante el desarrollo, nos enfrentamos a muchos matices, cuya soluci√≥n a veces requer√≠a un esfuerzo considerable.  El principal problema fue el lanzamiento de la generaci√≥n de informes en el hilo de fondo. <br><br>  Si al probar en una m√°quina de escritorio, la generaci√≥n de pdf fue del orden de varios segundos, entonces, al probar en iPad mini 3, esta vez alcanz√≥ f√°cilmente 1-3 minutos.  Naturalmente, la creaci√≥n del informe necesitaba ser transferida a un hilo separado, para evitar problemas con la suspensi√≥n de la interfaz.  En el caso general, esto no es un problema, pero este no es el caso cuando se usa Unity, en el que est√° expl√≠citamente prohibido usar la API de Unity desde fuera del hilo principal.  Al mismo tiempo, para el informe necesit√°bamos, como m√≠nimo, renderizar el CSS y la imagen de la escena, lo que deber√≠a hacerse solo desde la transmisi√≥n principal. <br><br>  Por lo tanto, para construir el informe, necesitamos ejecutar las tareas en una secuencia determinada y, al mismo tiempo, algunas de ellas pueden funcionar en el hilo de fondo y parte debe iniciarse en la principal. <br><br>  A primera vista, para resolver este problema, puede intentar usar el mecanismo est√°ndar y ejecutar cada operaci√≥n en una rutina separada.  Sin embargo, esto no nos salva del problema de frenar la interfaz.  Como sabe, las corutinas funcionan en el hilo principal y no son adecuadas para operaciones lentas.  Al mismo tiempo, al generar un informe, muchas operaciones requieren un tiempo significativo y, por lo tanto, las rutinas no pueden ayudar a resolver nuestro problema. <br><br><h4>  UniRx </h4><br>  Otra soluci√≥n es dividir el c√≥digo en una parte que necesita trabajar en el hilo principal y una parte que se puede ejecutar en un hilo separado.  En este caso, por ejemplo, las im√°genes se pueden construir utilizando el mecanismo de rutina y luego se pueden incrustar en el informe en una secuencia separada.  Sin embargo, en este caso, ser√° necesario guardar resultados intermedios en alg√∫n lugar, lo que impone restricciones adicionales en la cantidad de memoria utilizada o espacio libre en el dispositivo. <br><br>  En nuestra aplicaci√≥n, preferimos seguir el camino directo y ejecutar tareas secuencialmente en los hilos principales o en segundo plano.  El √∫nico problema era c√≥mo organizar tal lanzamiento de tareas para no estancarse en este desastre y sincronizar correctamente las operaciones. <br>  El uso de Rx, su encarnaci√≥n como un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">activo</a> gratuito de UniRx, que ya se describi√≥ en detalle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">centro</a> , brind√≥ una ayuda importante para resolver este problema. <br><br>  Su uso ha simplificado enormemente la interacci√≥n entre hilos y el siguiente ejemplo muestra que puede ejecutar varios m√©todos en secuencia estricta, pero en diferentes hilos <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de c√≥digo</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> initializer = Observable.FromCoroutine(initMethod); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> heavyMethod1 = Observable.Start(() =&gt; doHardWork()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainThread1 = Observable.FromCoroutine(renderImage); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> heavyMethod2 = Observable.Start(() =&gt; doHardWork2()); initializer.SelectMany(heavyMethod1) .SelectMany(mainThread1) .SelectMany(heavyMethod2) .ObserveOnMainThread() .Subscribe((x) =&gt; done()) .AddTo(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>);</code> </pre><br>  En este ejemplo, el m√©todo doHardWork () se ejecutar√° secuencialmente en el hilo de fondo.  Despu√©s de su finalizaci√≥n, renderImage () se iniciar√° en el hilo principal, y luego doHardWork2 () se ejecutar√° nuevamente en el hilo de fondo. <br></div></div><br>  Tambi√©n vale la pena se√±alar que durante el an√°lisis de la generaci√≥n de informes para el rendimiento se descubri√≥ que la parte m√°s lenta es la implementaci√≥n de im√°genes en el informe.  Una b√∫squeda en Internet mostr√≥ que no somos los √∫nicos que enfrentamos este problema, pero que no hab√≠a una soluci√≥n adecuada para nosotros.  Tuvimos que reducir ligeramente la calidad de la imagen a un nivel aceptable, lo que aument√≥ la velocidad en un 20-40%. <br><br>  Por lo tanto, en la aplicaci√≥n que creamos, fue posible introducir con √©xito el motor de gr√°ficos Unity en la aplicaci√≥n nativa de iOS / Android.  Esto difiere del enfoque tradicional cuando Unity es la parte principal de la aplicaci√≥n y aborda las propiedades espec√≠ficas del sistema a trav√©s del sistema de complemento.  Al mismo tiempo, nuestro enfoque puede ser √∫til si necesita desarrollar una interfaz nativa compleja en la que desee incrustar gr√°ficos 3D no triviales. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417779/">https://habr.com/ru/post/es417779/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417769/index.html">Dise√±o de memoria de usuario: c√≥mo dise√±ar para edades</a></li>
<li><a href="../es417771/index.html">Plan de la ICANN: la corporaci√≥n ofrece un nuevo modelo de administraci√≥n del servidor ra√≠z DNS</a></li>
<li><a href="../es417773/index.html">Instalador casero de componentes OpenPnP</a></li>
<li><a href="../es417775/index.html">Mecanismo de comisi√≥n de Bitcoin y por qu√© ser amigo de los mineros</a></li>
<li><a href="../es417777/index.html">Lectura de fin de semana: 25 materiales para principiantes entusiastas del vinilo</a></li>
<li><a href="../es417781/index.html">La sonda de la NASA "toca" el Sol, y no se derrite</a></li>
<li><a href="../es417783/index.html">Optimizaciones utilizadas en Python: lista y tupla</a></li>
<li><a href="../es417785/index.html">¬øQu√© administrador de sistemas no sue√±a con su empresa de outsourcing?</a></li>
<li><a href="../es417787/index.html">Mi experiencia laboral en el papel del entrenador √°gil en Europa, primera parte</a></li>
<li><a href="../es417789/index.html">Debates sobre perspectivas de telecomunicaciones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>