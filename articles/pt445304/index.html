<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò® ü•§ üëºüèΩ Programando o LibreOffice Base. Parte 2 üì¨ ‚õÑÔ∏è ‚ôéÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A parte 2 discutir√° o relacionamento entre tabelas e formul√°rios do banco de dados. Em particular, como definir um relacionamento entre duas tabelas e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programando o LibreOffice Base. Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445304/"> A parte 2 discutir√° o relacionamento entre tabelas e formul√°rios do banco de dados.  Em particular, como definir um relacionamento entre duas tabelas e usar "tabelas de refer√™ncia" como fonte de dados para listas suspensas. <br><a name="habracut"></a><br>  Vers√µes do OpenOffice e LibreOffice para as quais esta mensagem √© relevante de 3.0 a 6.2 (a vers√£o atual do LibreOffice).  A partir da vers√£o 3.0, o OpenOffice Base tem a capacidade de salvar scripts em um arquivo de banco de dados (com a extens√£o .odb), o que facilita a distribui√ß√£o do c√≥digo de macro OO Basic <br><br>  Houve alguma confus√£o com os formul√°rios no OpenOffice Base.  O fato √© que, no processo de evolu√ß√£o do software de um pacote de escrit√≥rio para um ambiente de banco de dados, descobriu-se que Formul√°rios, Formul√°rios, Formul√°rios e Formul√°rios n√£o s√£o a mesma coisa.  E o formul√°rio n√£o √© apenas o formul√°rio.  Vou explicar com mais detalhes. <br><br>  Ao abrir o banco de dados do OpenOffice Base no modo de edi√ß√£o, voc√™ v√™ quatro marcadores no lado esquerdo da tela.  Na vers√£o russa, parecer√° <br><br><ul><li>  Tabelas </li><li>  Inqu√©ritos </li><li>  Formul√°rios </li><li>  Relat√≥rios </li></ul><br>  Nesse sentido, o formul√°rio √© um aplicativo separado que √© executado em uma janela separada.  Tamb√©m observo que, de fato, √© essa a janela na qual a inst√¢ncia do OpenOffice Writer √© iniciada. <br><br>  <i>Nota</i>  <i>Como o formul√°rio √© realmente uma inst√¢ncia do OpenOffice Writer - voc√™ pode criar um aplicativo sem carregar o componente OpenOffice Base - diretamente no OpenOffice Writer.</i> <br><br>  Cada formul√°rio tem uma cole√ß√£o de objetos de formul√°rios de formul√°rio.  No in√≠cio, esta cole√ß√£o est√° vazia.  Apesar disso, voc√™ pode abrir e fechar o formul√°rio.  E at√© exibir informa√ß√µes de texto nele.  E somente quando voc√™ adiciona um novo controle (por exemplo, Button), o sistema criar√° um objeto Form com o nome padr√£o Form, se voc√™ ainda n√£o tiver criado esse objeto. <br><br>  √â mais conveniente criar novos Formul√°rios a partir do Navegador de Formul√°rios (exibido na paleta como uma b√∫ssola), que tamb√©m podem ser chamados no menu Exibir | Barra de Ferramentas | Navega√ß√£o de Formul√°rios.  Os objetos de formul√°rio s√£o criados no n√≠vel superior da cole√ß√£o de formul√°rios ou subordinados a outro objeto de formul√°rio.  Isso n√£o afeta a apar√™ncia do formul√°rio, mas pode ser √∫til ao definir relacionamentos entre tabelas. <br><br><div class="spoiler">  <b class="spoiler_title">Captura de tela</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/e4b/db1/cebe4bdb1f339866597f8c0ba95736fb.png" alt="imagem"><br></div></div><br><br>  Aqui devemos observar uma anomalia do objeto Form.  Este objeto √© principalmente um objeto associado a uma tabela de banco de dados ou a uma consulta SQL.  Voc√™ pode pensar em Form como um objeto ResultSet (do jeito que realmente √©).  Por outro lado, o formul√°rio √© um cont√™iner para controles, como FORM em um documento HTML (e isso tamb√©m √© verdade). <br><br>  Abra o formul√°rio rec√©m-criado no modo de edi√ß√£o (bot√£o direito do mouse | Editar).  Crie um novo objeto Form com o nome Form ou outro nome que voc√™ desejar.  Nesse elemento Form, crie um elemento Form filho. <br><br>  Cada formul√°rio precisa estar associado a uma tabela, consulta ou consulta SQL existente do banco de dados.  No formul√°rio escravo, voc√™ pode definir as regras para que os dados filtrados pelo valor dos campos relacionados no formul√°rio principal sejam exibidos como mestre / escravo.  Para fazer isso, no editor de propriedades do formul√°rio subordinado, preencha os campos principais do link e as propriedades dos campos subordinados. <br><br>  Agora, adicionaremos um elemento de controle de tabela a cada um dos formul√°rios, selecionando o formul√°rio apropriado no Navegador de formul√°rios&gt;.  O elemento Table Control n√£o est√° no painel de elementos dispon√≠veis.  Para exibir uma lista expandida de elementos, voc√™ precisa ativar o bot√£o Mais controles na paleta de elementos.  Ap√≥s adicionar o elemento Table Control, √© necess√°rio entrar no modo de edi√ß√£o desse elemento e adicionar as colunas necess√°rias para a exibi√ß√£o da tabela (bot√£o direito do mouse -&gt; Inserir / Substituir / Excluir Coluna) <br><br>  O segundo tipo √© o tipo de relacionamento frequentemente encontrado na pr√°tica entre tabelas (ap√≥s Mestre / Escravo), e que consideraremos como um tipo de refer√™ncia.  Armazenamos na tabela de dados a chave do objeto GUID, autoincrement, e na tabela exibida exibimos seu nome completo, retirado da tabela vinculada, o ‚Äúdiret√≥rio‚Äù.  Existe um mecanismo conveniente para isso.  No visual Table Designer, adicione uma coluna do tipo Caixa de listagem.  Se uma coluna do tipo Num√©rico / Texto j√° foi criada, na qual a chave √© exibida (e n√£o o nome), √© poss√≠vel alterar seu tipo para Caixa de listagem (clique com o bot√£o direito do mouse em | Substituir por | Caixa de listagem).  Em seguida, edite a lista de propriedades da coluna.  Na guia dados, defina a propriedade Tipo de conte√∫do da lista como SQL.  A consulta na propriedade List Content deve conter o valor exibido na primeira coluna, e a propriedade Bound Field ser√° o √≠ndice da coluna com o campo key (supondo que a primeira coluna tenha o √≠ndice 0).  Ou seja, na grande maioria das consultas, ser√° 1 para consultas do tipo <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> USERNAME, USERID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USERS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> USERNAME</code> </pre> <br>  At√© agora, o trabalho foi descrito no modo configurador sem programa√ß√£o.  Adicione funcionalidade com macros OO Basic. <br><br>  Crie um filtro para a tabela do banco de dados pelo valor digitado na caixa de texto.  Para fazer isso, escrevemos na linguagem OO Basic um procedimento que processa um evento a partir do teclado. <br><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> TextBox_onKeyUp(oEvent) oDocument = ThisComponent oDocument.LockControllers sText = oEvent.Source.text <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(sText) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> oForm = ThisComponent.Drawpage.Forms.getByName(<span class="hljs-string"><span class="hljs-string">"MyForm"</span></span>) oForm.<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> = <span class="hljs-string"><span class="hljs-string">"USERNAME LIKE '"</span></span> + sText + <span class="hljs-string"><span class="hljs-string">"%'"</span></span> oForm.reload() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> oDocument.UnlockControllers <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  Associamos esse procedimento ao evento Liberado pela chave do campo de texto (na guia Evento da lista de propriedades do elemento).  Observe que esse campo de texto deve estar localizado em outro formul√°rio (n√£o no qual o filtro est√° sobreposto), para que recarregar oForm.reload () n√£o "anule" seu valor atual inserido no teclado. <br><br>  Para ser continuado. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445304/">https://habr.com/ru/post/pt445304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445292/index.html">O que nunca me disseram sobre CSS</a></li>
<li><a href="../pt445294/index.html">E, novamente, sobre o segundo monitor do tablet ...</a></li>
<li><a href="../pt445298/index.html">Semana 13 de seguran√ßa: abrir senhas no Facebook</a></li>
<li><a href="../pt445300/index.html">Not√≠cias da ind√∫stria de jogos (11 a 25 de mar√ßo de 2019)</a></li>
<li><a href="../pt445302/index.html">"Game of Thrones, siga em frente." O que a Apple mostrou hoje em seu evento Show Time</a></li>
<li><a href="../pt445308/index.html">Recursos de teste de hip√≥tese para aplicativos m√≥veis</a></li>
<li><a href="../pt445310/index.html">Sovereign Runet subiu de pre√ßo para billion30 bilh√µes</a></li>
<li><a href="../pt445312/index.html">Aloca√ß√£o de mem√≥ria da JVM</a></li>
<li><a href="../pt445314/index.html">Por que aster√≥ides de minera√ß√£o s√£o dif√≠ceis?</a></li>
<li><a href="../pt445316/index.html">DevDay Gerenciar TI. Grava√ß√£o de Performance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>