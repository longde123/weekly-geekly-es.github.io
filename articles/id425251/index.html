<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🚀 💅🏾 🚺 LoJax: rootkit UEFI pertama yang diketahui digunakan dalam kampanye jahat 🤷🏽 ⤴️ 🤱🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sednit Cybergroup, juga dikenal sebagai ART28, Strontium dan Fancy Bear, telah beroperasi setidaknya sejak 2004. Diyakini bahwa kelompok ini berada di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LoJax: rootkit UEFI pertama yang diketahui digunakan dalam kampanye jahat</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/425251/">  Sednit Cybergroup, juga dikenal sebagai ART28, Strontium dan Fancy Bear, telah beroperasi setidaknya sejak 2004.  Diyakini bahwa kelompok ini berada di belakang serangkaian serangan cyber resonan.  Beberapa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perusahaan IB</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Departemen Kehakiman AS telah</a> memanggil Sednit yang bertanggung jawab atas peretasan Komite Nasional Demokrat sebelum pemilu AS 2016.  Kelompok ini dikreditkan dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">meretas</a> jaringan televisi global TV5Monde, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kebocoran</a> email dari Badan Anti-Doping Dunia (WADA) dan insiden lainnya.  Sednit memiliki banyak tujuan dan beragam alat, beberapa di antaranya telah kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasikan</a> sebelumnya, tetapi untuk pertama kalinya dalam pekerjaan ini kami akan menjelaskan secara rinci penggunaan rootkit UEFI. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ai/yf/nq/aiyfnqxa7dzic4myqh6eircpapo.jpeg"></div><br><a name="habracut"></a><h2>  Ulasan singkat </h2><br>  Kami menemukan bahwa setidaknya sejak awal 2017, Sednit telah menggunakan versi lama dari agen pengguna lama program untuk melindungi perangkat dari pencurian oleh pengembang Absolute Software - LoJack.  Alat ini menarik perhatian para profesional keamanan informasi karena penggunaan modul UEFI / BIOS sebagai mekanisme untuk memastikan kegigihan.  Kami menyebut versi trojanized dari program ini <b>LoJax</b> . <br><br>  Kehadiran alat Sednit yang terkenal dalam sistem yang terinfeksi bersama dengan sampel LoJax, serta fakta bahwa beberapa server perintah yang digunakan oleh agen yang di-trojanized sebelumnya merupakan bagian dari infrastruktur Sednit, memungkinkan kami untuk secara andal menghubungkan rootkit UEFI dengan grup ini. <br><br>  Bersama dengan agen LoJax, alat untuk membaca firmware sistem UEFI ditemukan, dan dalam salah satu kasus alat ini dapat membuang, menambal, dan menulis ulang bagian dari memori flash sistem SPI.  Tujuan akhir dari alat ini adalah untuk menginstal modul UEFI berbahaya ke dalam sistem yang proteksi flash SPI-nya rentan atau tidak dikonfigurasi dengan benar. <br><br>  Modul UEFI bertanggung jawab untuk mengimplementasikan agen LoJax dalam sistem, ini adalah rootkit UEFI pertama yang diidentifikasi dari grup Sednit.  Karena berada dalam firmware sistem, ia dapat bertahan menginstal ulang Windows dan mengganti hard drive. <br><br>  Setidaknya ada satu kasus ketika rootkit ini berhasil diinstal dalam memori flash sistem SPI.  Menurut informasi kami, ini adalah rootkit UEFI pertama yang ditemukan di alam liar. <br><br><h2>  Pendahuluan </h2><br>  Sednit menggunakan sejumlah keluarga malware.  Deskripsi terperinci tentang alat grup yang sering digunakan yang kami sediakan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan</a> . <br><br>  Kami telah melacak aktivitas Sednit selama beberapa tahun dan telah merilis banyak laporan tentang kerja grup - dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">deskripsi</a> kerentanan nol hari hingga program khusus seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Zebrocy</a> .  Komponen yang dijelaskan dalam laporan ini membentuk kelompok yang terpisah. <br><br>  Rootkit UEFI telah dijelaskan dalam laporan oleh perusahaan keamanan informasi sebelumnya.  Misalnya, rkloader, yang ditampilkan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">presentasi</a> tentang kebocoran data di Tim Peretasan, dan DerStarke, sebuah implan dalam unduhan macOS EFI / UEFI, dari dokumen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vault7</a> , telah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diketahui</a> .  Kami menyadari keberadaan alat ini, namun, tidak ada laporan kompromi UEFI yang diterbitkan oleh rootkit. <br><br>  Sekarang kami tidak hanya membuktikan penggunaan firmware in-the-wild dengan modul UEFI LoJax yang berbahaya, tetapi juga menemukan seluruh jajaran alat yang paling mungkin digunakan untuk menginstalnya.  Sangat menarik untuk dicatat bahwa Sednit menggunakan bootkit DownDelph, yang digunakan pada 2013 dan 2014 untuk mempertahankan Downdelph, salah satu backdoor Sednit tahap pertama.  Idenya serupa, tetapi dalam versi baru UEFI, penggunaan bootkit tidak lagi memungkinkan.  Dengan demikian, kedua komponen ini berbeda secara signifikan dalam perilaku. <br><br>  Karya ini dibagi menjadi tiga bagian.  Dalam yang pertama, kami akan menganalisis studi awal keamanan LoJack / Computrace dan potensi untuk penggunaan program jahat.  Bagian kedua dikhususkan untuk proses penelitian, yang akhirnya membawa kami ke rootkit UEFI.  Akhirnya, pada bagian ketiga, kami menjelaskan secara rinci berbagai komponen LoJax dan bagaimana mereka memberikan ketekunan dalam sistem bahkan setelah menginstal ulang Windows dan mengganti hard drive. <br><br><h4>  Atribusi </h4><br>  Sementara banyak vendor telah membuat pernyataan mengenai kelompok Sednit di masa lalu, ESET sama sekali tidak menentukan afiliasi geopolitiknya.  Sejak publikasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">studi</a> 2016, posisi kami tidak berubah.  Menentukan sumber serangan siber berdasarkan pendekatan ilmiah adalah tugas kompleks yang berada di luar lingkup kompetensi spesialis ESET.  Apa yang kita sebut "Grup Sednit" hanyalah seperangkat perangkat lunak dan infrastruktur jaringan terkait yang tidak dapat kita asosiasikan secara asosiatif dengan organisasi tertentu. <br><br><h4>  Tujuan </h4><br>  Selama penelitian, kami menemukan sejumlah kecil gambar LoJax yang berbeda.  Berdasarkan data telemetri kami dan studi tentang program Sednit lain yang ditemukan di alam bebas, kami yakin bahwa modul khusus ini jarang digunakan dibandingkan dengan alat lain.  Tujuan utamanya adalah organisasi pemerintah yang berlokasi di Balkan, di Eropa Tengah dan Timur. <br><br><h2>  Riset Computertrace / LoJack Awal </h2><br>  LoJack - perangkat lunak untuk melindungi komputer dari pencurian dan kehilangan, yang dikembangkan oleh Absolute Software Corporation.  Versi awal agen dikenal sebagai Computrace.  Seperti namanya sebelumnya, setelah mengaktifkan layanan, komputer dapat mengakses server perintahnya - pemilik akan diberitahu tentang lokasi perangkat jika terjadi kehilangan atau pencurian. <br><br>  Bagian di bawah ini menjelaskan arsitektur LoJack sebelumnya.  Hanya versi lama dari perangkat lunak yang di-Trojan oleh penjahat cyber, jadi kami akan fokus pada itu.  Selain itu, Absolute Software merilis pada Mei 2018 sebuah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pernyataan yang</a> menyatakan bahwa kerentanan yang dijelaskan di bawah ini tidak memengaruhi pengoperasian versi terbaru agen mereka. <br><br>  Program Computrace menarik perhatian para profesional keamanan informasi karena menggunakan metode yang tidak biasa untuk memastikan kegigihan.  Tujuannya adalah untuk melindungi dari pencurian, oleh karena itu penting untuk itu tahan menginstal ulang OS dan mengganti hard drive - semua ini diimplementasikan dalam modul UEFI / BIOS yang dapat bertahan setelah tindakan ini.  Solusinya sudah diinstal dalam firmware sebagian besar laptop dari produsen yang berbeda, pengguna hanya perlu mengaktifkan fungsi ini.  Aktivasi dapat dilakukan di BIOS, seperti yang ditunjukkan pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/rf/vx/i_/rfvxi_hexr1f29e0hqddhak97ag.png"><br>  <i>Gambar 1. Mengaktifkan Computrace di BIOS</i> <br><br>  Salah satu laporan implementasi LoJack / Computrace yang pertama diterbitkan pada tahun 2009.  Arsitektur global produk, modul UEFI / BIOS pembilasan agen pengguna ke disk, dan cara agen berkomunikasi dengan server web yang dikendalikan oleh Absolute Software diungkapkan.  Diagram dapat dipahami dari gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/mh/5a/u2/mh5au2bhmrriy8sn8dtsd1g1avw.png"><br>  <i>Gambar 2. Mekanisme ketekunan LoJack (sekitar 2008)</i> <br><br>  Berikut ini adalah deskripsi langkah-langkah yang tercantum di atas: <br><br>  1. Jika diaktifkan, modul UEFI / BIOS dijalankan pada saat boot.  Dia sedang berusaha menemukan partisi FAT / FAT32 / NTFS.  Kemudian, menggunakan driver NTFS, ia membuat cadangan file <code>autochk.exe</code> dan menimpa isinya dengan pipet, yang bertanggung jawab untuk menginstal komponen agen pengguna.  File <code>autochk.exe</code> adalah file yang dapat dieksekusi Windows yang diluncurkan pada tahap awal boot sistem untuk memeriksa kemungkinan kerusakan pada hard disk. <br><br>  2. Ketika <code>autochk.exe</code> dimodifikasi dimulai, tujuan utamanya adalah untuk mengimplementasikan mini-agent <code>rpcnetp.exe</code> dan menambahkannya sebagai layanan sehingga ia memulai setiap kali reboot.  Langkah terakhir dalam komponen ini adalah mengembalikan versi asli <code>autochk.exe</code> . <br><br>  3. Mini-agent <code>rpcnetp.exe</code> - file kecil yang dapat dieksekusi, yang tujuannya adalah untuk memastikan operasi agen utama.  Jika agen utama tidak berfungsi, <code>rpcnetp.exe</code> mencoba menyambung ke server perintah C&amp;C Perangkat Lunak Absolute untuk mengunduh dan menjalankannya.  Pertama, mini-agent akan membuat salinannya sendiri, lalu membuat perubahan pada header PE untuk dikonversi ke DLL.  Pustaka ini kemudian dimuat ke dalam memori, memanggil proses <code>svchost.exe</code> , dan menyuntikkan DLL di sana.  Selanjutnya, proses Internet Explorer <code>iexplore.exe</code> dimulai, dan DLL disuntikkan ke dalamnya.  Proses terakhir kemudian akan digunakan untuk komunikasi melalui Internet.  Injeksi mini-agent Computrace ke proses pihak ketiga sering ditemukan di malware dan jarang dikaitkan dengan perangkat lunak yang sah. <br><br>  4. Sekarang agen yang berfungsi penuh berjalan pada sistem dan dapat menggunakan fungsi Computrace untuk melacak dan memulihkan. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Deskripsi</a> proses ini dan protokol jaringan yang terlibat antara agen mini dan server C&amp;C diterbitkan pada tahun 2014.  Karena kurangnya mekanisme otentikasi, jika penyerang mengontrol server yang berkomunikasi dengan agen mini, mereka dapat memaksanya untuk mengunduh kode arbitrer.  Ada beberapa mekanisme yang memungkinkan penyerang untuk menghubungi agen mini secara langsung.  Yang paling penting bagi kami adalah menggunakan metode mendapatkan alamat server C&amp;C sebagai agen mini.  Bahkan, informasi ini disimpan dalam file konfigurasi di file yang dapat dieksekusi itu sendiri. <br><br><img src="https://habrastorage.org/webt/qc/ww/es/qcwwesoicwoyw1aghae1smpgnao.png"><br>  <i>Gambar 3. File konfigurasi dekripsi parsial LoJack Terenkripsi di sebelah kanan</i> <br><br>  Gambar tersebut menunjukkan file konfigurasi agen mini LoJack.  Metode "enkripsi" yang digunakan adalah XOR sederhana dengan kunci byte tunggal.  Kunci 0xB5 sama untuk semua agen mini yang dipelajari.  Seperti dapat dilihat dari gambar, domain C&amp;C ditentukan dalam file.  Empat byte sebelumnya berisi alamat IP dari server C&amp;C.  Dengan tidak adanya validasi pada isi file konfigurasi, penyerang dengan izin menulis di <code>%WINDIR%</code> dapat mengubah kontennya sehingga mini-agent akan berkomunikasi dengan server perintah mereka, bukan yang sah.  Memahami protokol jaringan, Anda dapat membuat mini-agent mengunduh dan mengeksekusi kode arbitrer.  Risiko-risiko ini telah lama diketahui, tetapi sampai saat ini, mekanisme tersebut tidak digunakan dalam praktik. <br><br><h4>  LoJack berubah menjadi LoJax </h4><br>  Pada Mei 2018, sampel Trobor dari mini-agent LoJack, rpcnetp.exe, dijelaskan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di blog</a> Arbor Network.  Pengaturan jaringan hard-coded mereka diubah sehingga sampel berbahaya membuat koneksi dengan server C &amp; C penyerang alih-alih server Absolute Software yang sah.  Beberapa domain yang ditemukan dalam sampel Trojanized dipenuhi sebelumnya - mereka digunakan pada akhir 2017 sebagai domain server C &amp; C untuk SedUploader, pintu belakang tahap pertama dari cybergroup Sednit.  Gambar di bawah ini menunjukkan contoh konfigurasi yang dimodifikasi di salah satu agen mini LoJax. <br><br><img src="https://habrastorage.org/webt/om/ts/md/omtsmdgqzbkn-fbqrpjd59abp7a.png"><br>  <i>Gambar 4. Di sebelah kiri adalah file konfigurasi yang sah, di sebelah kanan adalah yang dimodifikasi</i> <br><br>  Perbedaan antara agen yang sah dan trojanized sangat kecil, hampir semua diberikan di atas.  Sampel mini-agent LoJax yang dapat kami temukan adalah versi yang di-trojan dari sampel mini-agent Computrace yang sama, <code>rpcnetp.exe</code> .  Mereka semua memiliki cap waktu kompilasi yang identik dan hanya beberapa lusin byte berbeda dari aslinya.  Selain perubahan pada file konfigurasi, ada perbedaan dalam variabel timer yang menentukan interval antara koneksi ke server C&amp;C. <br><br>  Pada saat publikasi, kami menemukan berbagai agen mini LoJax yang digunakan dalam serangan terhadap berbagai organisasi di Balkan, di Eropa Tengah dan Timur, tetapi kami tidak punya ide tentang cara menginstalnya.  Penjelasan yang jelas akan menginstal menggunakan salah satu backdoors Sednit yang terkenal.  Jangan lupa bahwa LoJack, sebagai alat yang mapan, telah masuk daftar putih oleh banyak vendor antivirus.  Jadi, bahkan jika dalam kampanye ini hanya mini-agent yang digunakan yang tidak bertahan setelah menginstal ulang Windows, itu masih memiliki keuntungan - kecil kemungkinannya terdeteksi sebagai malware.  Tetapi bagaimana jika kompromi itu lebih dalam dan penyerang mencoba menyalin LoJack untuk mendapatkan ke firmware sistem? <br><br><h2>  Cari komponen tingkat bawah </h2><br>  Kami mencatat serangan LoJax yang ditujukan pada beberapa organisasi di Balkan, di Eropa Tengah dan Timur.  Secara keseluruhan, kami berhasil menemukan jejak malware Sednit, termasuk: <br><br><ul><li>  SedUploader, backdoor tahap pertama </li><li>  XAgent, backdoor andalan Sednit </li><li>  Xtunnel, alat proxy jaringan yang dapat mentransfer lalu lintas jaringan apa pun antara server C&amp;C di Internet dan komputer tujuan di jaringan lokal </li></ul><br>  Kami menemukan jejak alat Sednit di sebagian besar sistem yang dipelajari yang menjadi target LoJax, serta beberapa sistem di mana hanya LoJax yang hadir.  Dapat diasumsikan bahwa dalam beberapa kasus LoJax digunakan sebagai alat terpisah, mungkin sebagai pintu belakang tambahan untuk memulihkan akses operator Sednit ke jaringan. <br><br>  Backdoor XAgent biasanya menjatuhkan modul tambahan ke dalam sistem yang dikompromikan, sehingga segera terlintas dalam pikiran bahwa sampel LoJax dikirim dengan cara yang sama, tanpa mekanisme lain.  Dapat diasumsikan bahwa Sednit hanya meminjam agen mini dari solusi LoJack.  Namun, tak lama setelah dimulainya analisis, kami menemukan beberapa bukti yang menunjukkan bahwa sumber inspirasi agak lebih luas. <br><br><h4>  Driver RWEverything (RwDrv) dan info_efi.exe </h4><br>  Bukti pertama ditemukan berkat alat khusus penjahat cyber, yang, ketika dieksekusi, membongkar informasi tentang pengaturan sistem tingkat yang lebih rendah ke dalam file teks.  Alat itu ditemukan bersama dengan beberapa sampel LoJax.  Gambar berikut menunjukkan fragmen file <code>info_efi.exe</code> alat ini dengan nama logis <code>info_efi.exe</code> . <br><br><img src="https://habrastorage.org/webt/8j/9x/kc/8j9xkcnbmste_xynugnkenaar6g.png"><br>  <i>Gambar 5. Kutipan dari file log yang dihasilkan oleh info_efi .exe</i> <br><br>  Untuk membaca jenis informasi ini, alat ini menyertakan driver yang disebut <code>RwDrv.sys</code> .  Driver kernel hadir dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RWEverything</a> , sebuah utilitas gratis yang tersedia di jaringan yang dapat digunakan untuk membaca informasi di hampir semua pengaturan level bawah, termasuk antarmuka PCI Express, memori, PCI Option ROM, dll.  Driver kernel adalah perangkat lunak yang sah dan ditandatangani dengan sertifikat yang valid. <br><br><img src="https://habrastorage.org/webt/2u/o-/mb/2uo-mbk6so15sdz9iusnxzl15qq.png"><br>  <i>Gambar 6. Sertifikat penandatanganan kode RwDrv.sys</i> <br><br>  RWEverything hadir dengan antarmuka pengguna grafis yang memungkinkan Anda untuk mengakses semua informasi ini. <br><br><img src="https://habrastorage.org/webt/if/yp/dp/ifypdpu-hnounvupxelxhcp5el4.png"><br>  <i>Gambar 7. Screenshot antarmuka RWEverything</i> <br><br>  Penemuan alat <code>info_efi</code> adalah tanda pertama bahwa modul UEFI LoJax bisa ada.  Ketika mencoba memperbarui firmware sistem, penting untuk memiliki informasi tentang vendor, versinya, dll.  Mengingat kerentanan yang memungkinkan proses pengguna untuk mengakses dan mengubah konten memori flash SPI tempat modul UEFI disimpan, memperoleh data firmware sistem adalah langkah pertama untuk serangan yang berhasil. <br><br>  Petunjuk terakhir yang memungkinkan kami menemukan rootkit UEFI pertama dari grup Sednit adalah dua alat - untuk membuang memori flash SPI dan untuk menulisnya. <br><br><h4>  Dump SPI Flash </h4><br>  Bagian pertama dari teka-teki adalah file bernama <code>ReWriter_read.exe</code> .  Itu berisi semua kode yang diperlukan untuk membuang sistem SPI flash menggunakan driver <code>RwDrv.sys</code> , <code>RwDrv.sys</code> .  Agar driver perangkat untuk melakukan operasi yang diperlukan, alat dump harus mengirim kode kontrol I / O (IOCTL) yang benar.  Sementara <code>RwDrv.sys</code> mendukung banyak kode IOCTL yang berbeda, alat dumper dan alat penulis yang dijelaskan dalam ini dan bagian selanjutnya hanya menggunakan empat dari mereka. <br><br>  RwDrv.sys: kode IOCTL yang didukung: <br><br>  <i>0x22280c</i> - menulis ke area memori yang dialokasikan untuk I / O <br>  <i>0x222808</i> - membaca area memori yang dialokasikan untuk input-output <br>  <i>0x222840</i> - membaca kata dari register konfigurasi PCI yang ditentukan <br>  <i>0x222834</i> - menulis byte ke register konfigurasi PCI yang ditentukan <br><br>  <code>ReWriter_read</code> pertama kali menciptakan layanan dengan <code>RwDrv.sys</code> kernel <code>RwDrv.sys</code> dan menulis informasi konfigurasi UEFI / BIOS, nilai yang sesuai dari tiga bidang yang terdapat dalam register manajemen BIOS (BIOS_CNTL): BIOS Lock Enable (BLE), BIOS Write Enable (BIOSWE) dan SMM BIOS Write Protect Disable (SMM_BWP).  Meskipun <code>ReWrite_read</code> tidak menggunakan nilai-nilai ini, di bagian berikut kami akan menjelaskan mengapa bidang ini menarik bagi alat ini. <br><br>  Tugas selanjutnya dari alat ini adalah untuk mendapatkan alamat dasar dari area memori BIOS dalam SPI dan ukurannya.  Informasi ini terkandung dalam register antarmuka SPI utama sebagai Wilayah Utama BIOS Flash.  Semua register ditampilkan dalam memori di Root Complex Register Block (RCRB), alamat dasar yang dapat diperoleh dengan membaca PCI Configuration Register yang diinginkan.  <code>ReWriter_read</code> mendapatkan alamat ini dengan menggunakan RwDrv IOCTL 0x22840 dan membaca indentasi yang benar (dalam kasus kami, 0xF0).  Segera setelah alamat dasar area BIOS dan ukurannya diketahui, alat dump membaca konten yang sesuai dari memori flash SPI dan menulisnya ke file pada disk.  Proses membaca memori flash SPI diilustrasikan pada gambar berikut.  Definisi singkatan diberikan dalam daftar istilah di bawah ini. <br><br><img src="https://habrastorage.org/webt/mw/wm/tb/mwwmtbzbrwmm18l1w7-2iugvpxc.png"><br>  <i>Gambar 8. Urutan pembacaan dari memori flash SPI</i> <br><br>  Selain dua langkah pertama, dijalankan hanya sekali, operasi diulang dalam satu siklus sampai semua data dari memori flash SPI telah dibaca.  Prosesnya juga dijelaskan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Kemudian <code>ReWriter_read</code> memvalidasi ukuran gambar yang digabungkan.  Ini mem-parsing deskriptor memori gambar untuk mendapatkan berbagai area BIOS, Gigabit Ethernet (GbE) dan Management Engine (ME).  Menambahkan dimensi ketiga area ini memungkinkan alat dumper untuk menghitung seluruh konten flash SPI.  Jika ukurannya cocok dengan ukuran yang diperoleh dari membaca area registri BIOS Utama Flash, gambar dianggap benar. <br><br><h4>  Patch firmware UEFI </h4><br>  Bagian kedua dari teka-teki adalah file bernama <code>ReWriter_binary.exe</code> .  File ini berisi bukti bahwa Sednit mendapatkan firmware.  File tersebut berisi kode untuk menerapkan tambalan gambar UEFI yang diunduh dan menulis kembali versi trojannya ke memori flash SPI.  Di bagian ini, kami menjelaskan bagaimana struktur file biner ini. <br><br>  Setelah konten memori flash dibongkar dan diverifikasi oleh alat di atas, modul UEFI berbahaya ditambahkan ke gambar.  Untuk melakukan ini, gambar UEFI harus dianalisis untuk menyoroti informasi yang diperlukan. <br><br>  Data yang disimpan dalam gambar UEFI diuraikan menjadi volume melalui sistem file (FFS).  Seperti namanya, ini adalah sistem file khusus untuk menyimpan gambar firmware.  Volume berisi file dengan GUID.  Setiap file biasanya terdiri dari banyak bagian, salah satunya berisi PE / COFF yang dapat dieksekusi, yang merupakan gambar UEFI.  Di bawah ini adalah tangkapan layar dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">UEFITool</a> , proyek sumber terbuka untuk bekerja dengan gambar firmware UEFI, untuk pemahaman yang lebih sederhana tentang rangkaian. <br><br><img src="https://habrastorage.org/webt/s6/th/mp/s6thmpgjnornwankifoul8d9zlk.png"><br>  <i>Gambar 9. Contoh gambar firmware UEFI yang dimuat ke UEFITool</i> <br><br>  ReWriter_binary menganalisis semua volume firmware yang ditemukan di area BIOS SPI dari memori flash dan mencari file tertentu: <br><br><ul><li>  IP4Dxe (8f92960f-2880-4659-b857-915a8901bdc8) </li><li>  NtfsDxe (768bedfd-7b4b-4c9f-b2ff-6377e3387243) </li><li>  SmiFlash (bc327dbd-b982-4f55-9f79-056ad7e987c5) </li><li>  Inti Dxe </li></ul><br><img src="https://habrastorage.org/webt/zt/ou/kc/ztoukch8w0mdyv-whzpkaibpc9u.png"><br>  <i>Gambar 10. Hasil penggunaan dekompiler Hex-Rays dalam volume firmware</i> <br><br>  Ip4Dxe dan NtfsDxe adalah driver DXE.  Dalam firmware UEFI, driver DXE adalah gambar PE / COFF yang dibuat untuk abstraksi perangkat keras atau untuk mengatur layanan untuk digunakan oleh driver DXE lain atau aplikasi UEFI.  Driver tersebut terdeteksi dan diunduh oleh DXE Foundation melalui DXE Manager (DXE kernel) pada tahap awal dalam proses booting.  Setelah menyelesaikan fase ini, semua layanan, seperti OS loader, tersedia untuk bekerja dengan aplikasi UEFI.  Biasanya, driver DXE disimpan dalam volume yang sama.  Namun, operator DXE mungkin terpisah. <br><br>  ReWriter_binary mencari Ip4Dxe hanya untuk mencari tahu apakah volume yang diberikan berisi driver DXE.  Seperti yang kami jelaskan nanti, volume ini menjadi kandidat untuk menginstal driver DXE berbahaya.  Dia juga mencari kernel DXE dan menambahkan volume di mana ia berada sebagai kandidat lain untuk tempat untuk merekam rootkit.  Ruang kosong yang tersedia di masing-masing volume ini disimpan dan kemudian digunakan untuk memeriksa kecukupan untuk menambahkan driver jahat. <br><br>  NtfsDxe - driver AMI NTFS DXE.  Jika ada dalam volume firmware, lokasinya disimpan dan nantinya digunakan untuk menghapus file ini dari volume.  Di bagian UEFI rootkit, kita akan melihat mengapa ia menghapus file ini. <br><br>  Adapun gambar SmiFlash, informasi yang terkait dengannya disimpan, tetapi tidak digunakan di mana pun di Malvari.  Menariknya, gambarnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rentan</a> .  Oleh karena itu, kami percaya bahwa operator Sednit dapat bekerja untuk mengeksploitasi kerentanan ini.  Ini memungkinkan mereka untuk menulis sistem yang dikonfigurasi dengan benar ke memori flash SPI.  Seperti yang akan kami sampaikan nanti, dalam bentuk saat ini, alat ini hanya dapat menulis ke area BIOS dari sistem yang dikonfigurasi dengan salah atau cukup lama (pada motherboard dengan chipset lebih tua dari Platform Controller Hub, diperkenalkan sekitar 2008). <br><br>  Setelah metadata yang diperlukan dialokasikan, <code>ReWriter_binary</code> menambal dump gambar UEFI dan menambahkan driver DXE berbahaya.  Pertama, ini menciptakan header file (EFI_FFS_FILE_HEADER).  Dia kemudian memilih volume tujuan berdasarkan lokasi Ip4Dxe dan kernel DXE, serta ruang kosong yang tersedia pada volume ini.  <code>ReWriter_binary</code> menyematkan bagian terkompresi yang berisi gambar PE dan bagian antarmuka pengguna yang mendefinisikan nama file yang dapat dibaca manusia: SecDxe.  Bagian yang dikompresi ditambahkan ke header file dan ditulis di akhir volume, di ruang kosong.  Gambar di bawah ini menunjukkan struktur - tampilan di UEFITool. <br><br><img src="https://habrastorage.org/webt/g6/9-/-a/g69--aub7xrb5b1iinzwrtpxyo8.png"><br>  <i>Gambar 11. Tampilan file SecDxe di UEFITool</i> <br><br>  Akhirnya, jika driver NtfsDxe ada pada gambar, itu akan dihapus.  Sistem file firmware menyimpan file dan isinya secara berurutan, sehingga prosesnya cukup sederhana: <br><br><ul><li>  indent ke ruang kosong di akhir volume </li><li>  Byte 0xFF ditulis di atas gambar NtfsDxe </li><li>  bagian selanjutnya dari volume firmware disalin, dimulai dengan lekukan di mana NtfsDxe berada </li><li>  sisa sistem file diisi dengan byte 0xFF, mis. ruang kosong </li></ul><br><h4>  Menulis firmware yang ditambal kembali ke memori flash SPI </h4><br>  Setelah berhasil membuat perubahan pada gambar firmware, langkah selanjutnya adalah menulisnya kembali ke memori flash SPI.  Sebelum masuk ke proses ini, kita perlu mengkarakterisasi beberapa perlindungan penulisan BIOS yang penting dalam kasus ini.  Mekanisme lain yang ada, seperti Range Write Protection BIOS, tetap menyendiri karena ReWriter_binary tidak memeriksanya. <br><br>  Platform menggunakan beberapa mekanisme keamanan untuk memblokir upaya tidak sah untuk menulis ke area BIOS.  Saya harus mengatakan bahwa mekanisme ini tidak diaktifkan secara default.  Firmware bertanggung jawab atas konfigurasi yang benar.  Konfigurasi ini disajikan dalam register kontrol BIOS (BIOS_CNTL).  Ini berisi bit BIOS Write Enable (BIOSWE), yang harus dialihkan ke "1" untuk menulis ke area BIOS dari memori flash SPI.  Karena platform seharusnya tidak mengizinkan upaya apa pun untuk menulis ke area BIOS, ada satu bit lagi di BIOS_CNTL untuk melindungi BIOSWE - ini adalah BIOS Lock Enable (BLE).  Ketika diset, mekanisme harus memblokir bit BIOSWE dan membiarkan nilainya sama dengan "0".  Namun, solusinya memiliki kerentanan.  Ketika permintaan datang untuk mengubah bit BIOSWE ke "1", BIOSWE sedikit ke "1", dan hanya setelah itu platform mengganggu tugas menggunakan System Management Interrupt (SMI), kode untuk SMI ini mengubah bit BIOSWE kembali ke "0". <br><br>  Ada banyak masalah dalam versi solusi ini.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama, prosesor SMI dibiarkan untuk pengembang firmware. Oleh karena itu, jika kode ini tidak diterapkan dalam firmware, bit BLE tidak berguna, karena bit BIOSWE tidak akan diatur kembali ke "0". Kedua, dalam hal ini, kami memiliki " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kerentanan kondisi ras</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " yang memungkinkan kami untuk sepenuhnya menghindari mekanisme ini, bahkan jika handler SMI diimplementasikan dengan benar. Untuk mengeksploitasi kerentanan ini, penyerang perlu menjalankan utas yang terus-menerus mengatur BIOSWE ke “1”, sedangkan utas lain harus menulis data ke memori flash SPI. Menurut </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">karya</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kallenberg dan Wojtchuk, serangan ini bekerja pada prosesor multi-core dan juga dapat berhasil digunakan pada prosesor single-core dengan teknologi Hyper-Threading diaktifkan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mengatasi masalah ini, mekanisme perlindungan baru yang dikonfigurasi melalui BIOS_CNTL ditambahkan ke platform. Ini diperkenalkan dalam keluarga chipset dari Intel Platform Controller Hub (PCH). Jika bit konfigurasi diatur, SMM BIOS Write Protect Disable (SMM_BWP) hanya akan memungkinkan penulisan ke area BIOS jika semua core berada dalam Mode Manajemen Sistem (SMM) dan BIOSWE diatur ke "1". Ini secara efektif melindungi sistem dari "kerentanan kondisi ras" yang dijelaskan di atas. Namun, seperti halnya BLE, SMM_BWP harus diaktifkan dari sisi firmware. Oleh karena itu, firmware di mana mekanisme ini tidak dikonfigurasi dengan benar membuat sistem berisiko memberikan hak penulisan yang tidak sah ke area BIOS. </font></font><br><br> <code>ReWriter_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">membaca isi register kontrol BIOS untuk memilih jalur yang benar.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dia pertama kali memeriksa untuk melihat apakah BIOSWE diatur. Jika demikian, ia masuk ke fase perekaman. Jika BIOSWE dinonaktifkan, BIOSWE memeriksa nilai bit BLE. Jika tidak diinstal, itu mengubah nilai bit BIOSWE dan mulai merekam firmware yang ditambal. Jika bit BLE diatur, bit tersebut memeriksa status SMM_BWP yang dinonaktifkan dan menerapkan "kerentanan kondisi ras" yang dijelaskan di atas. Jika bit SMM_BWP diatur, operasi gagal. Gambar di bawah menggambarkan proses. </font></font><br><br><img src="https://habrastorage.org/webt/db/3t/n5/db3tn5tpff0bgjciq9ciiy3a6p4.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 12. Pohon keputusan selama proses perekaman</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dengan asumsi bahwa file yang dianalisis </font></font><code>ReWriter_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan untuk menyebarkan UEFI rootkit, kita dapat menyimpulkan bahwa salah satu firmware salah mengkonfigurasi perlindungan penulisan BIOS atau chipset mesin korban lebih tua daripada Platform Controller Hub.</font></font><br><br> <code>ReWriter_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak dapat mengganti firmware UEFI pada sistem modern yang telah disesuaikan dengan baik. Namun, ketika mencari gambar SmiFlash UEFI yang rentan, parsing volume firmware UEFI menunjukkan bahwa penyerang juga dapat bekerja dengan teknik </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proteksi bypass BIOS yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lebih canggih </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam cara yang sangat mirip dengan prosedur membaca, penulisan ke memori flash SPI terjadi: </font></font><br><br><img src="https://habrastorage.org/webt/ct/wi/v3/ctwiv38relsl9rpveltd8imrpjy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 13. Urutan penulisan ke memori flash SPI</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selain dua langkah pertama, yang dilakukan hanya satu kali, operasi ini diulangi dalam satu siklus sampai semua informasi ditulis ke memori flash SPI. . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika proses perekaman selesai, isi memori flash SPI diturunkan lagi ke file </font></font><code>image.bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pemeriksaan integritas yang sama yang dilakukan</font></font><code>ReWriter_read</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, berjalan pada gambar gabungan baru. </font><font style="vertical-align: inherit;">Kemudian, gambar yang dibaca dari memori flash SPI dibandingkan dengan gambar yang ditambal dalam memori. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika ada byte yang berbeda, alamatnya ditulis ke log. </font><font style="vertical-align: inherit;">Ada atau tidak adanya perbedaan tidak mempengaruhi kemajuan malware. </font><font style="vertical-align: inherit;">Informasi ini hanya direkam sehingga operator mengerti apa yang terjadi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada tahap akhir, kunci registri diatur ke: </font></font><br><br> <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\BootExecute = “autocheck autochk *”</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemudian, layanan RwDrv dihentikan dan dihapus. </font><font style="vertical-align: inherit;">Penting bahwa nilai baris ini ditetapkan untuk kunci registri Windows, karena rootkit UEFI sedang mencari baris ini untuk mengubahnya dan mengeksekusi komponennya selama startup Windows. </font><font style="vertical-align: inherit;">Kami akan membicarakan hal ini secara lebih rinci ketika kami menjelaskan rootkit UEFI dan komponennya.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Analisis Teknis LoJax </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alat untuk membuang, menambal, dan menulis ke memori flash SPI disesuaikan untuk gambar firmware tertentu dan tidak dapat digunakan pada sistem apa pun. Dalam hal ini, modul UEFI lengkap dapat dibedakan. Hal pertama yang kami lakukan setelah menerima modul ini adalah mempelajari data telemetri untuk mengetahui apakah sudah terlihat sebelumnya. Dalam hal ini, kami harus bergantung pada pemindai UEFI baru, yang dapat memindai firmware sistem. Kami menemukan bahwa modul UEFI grup Sednit dipasang setidaknya sekali dalam sistem, yang berarti bahwa rootkit ini sebenarnya digunakan di alam bebas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Belum ditetapkan bagaimana alat jahat dikirim ke sistem yang dikompromikan. Kemungkinan besar, program lain digunakan untuk ini - misalnya, XAgent. Alat pembuangan dan perekaman ditemukan dalam sistem yang sama, tetapi pada waktu yang berbeda - mungkin, operator bekerja dalam beberapa tahap. Pertama, mereka membongkar firmware pada mesin target, memastikan bahwa alat untuk membuat penyesuaian ke program bekerja tanpa kegagalan, dan kemudian memuatnya dan benar-benar menambal firmware. Kami hanya menemukan satu versi alat untuk dump dan rekaman, tetapi ada kemungkinan versi lain ada untuk firmware lain dengan kerentanan yang dapat mereka temukan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar di bawah ini memberikan gambaran umum tentang operasi rootkit UEFI sampai OS mem-boot. </font><font style="vertical-align: inherit;">Pertama, pengandar DXE SecDxe dimuat oleh Manajer DXE. </font><font style="vertical-align: inherit;">Dengan cara ini, fungsi notifikasi untuk grup acara dikonfigurasikan </font></font><code>EFI_EVENT_GROUP_READY_TO_BOOT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ketika firmware siap untuk memilih perangkat boot dan memulai boot loader, fungsi notifikasi dipanggil. </font><font style="vertical-align: inherit;">Dia melakukan tiga tindakan:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memuat driver DXE NTFS bawaan untuk menyediakan akses dan kemampuan menulis ke partisi NTFS </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menulis dua file ke partisi Windows NTFS: rpcnetp.exe dan autoche.exe </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengubah kunci registri 'HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ BootExecute': ke: 'autocheck autochk *'; </font><font style="vertical-align: inherit;">setelah: 'autocheck autoche *'.</font></font></li></ul><br><img src="https://habrastorage.org/webt/at/qy/ec/atqyecti3adwerrfljy0ccirxgy.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 14. Proses booting sistem yang terinfeksi dengan rootkit UEFI</font></font></i> <br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SecDxe: Pengemudi DXE berbahaya </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di bagian ini, kami akan mengungkapkan urutan kejadian yang terjadi dalam sistem yang dikompromikan. Kita mulai dengan deskripsi tentang rootkit, dan kemudian mengikuti rantai peristiwa sampai komponen akhir dikerahkan di tingkat sistem operasi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rootkit UEFI Sednit adalah driver DXE dengan GUID </font></font><code>682894B5-6B70-4EBA-9E90-A607E5676297</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itu tidak ditandatangani, sehingga tidak dapat dijalankan pada sistem dengan perlindungan Boot Aman diaktifkan. Setelah disebarkan ke salah satu volume firmware, DXE Foundation mengunduhnya setiap kali sistem dinyalakan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SecDxe adalah driver DXE kecil yang pada dasarnya melakukan dua hal. Ini mengatur protokol khusus GUID.</font></font><code>832d9b4d-d8d5-425f-bd52-5c5afb2c85dc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang tidak pernah digunakan. Kemudian itu membuat acara yang terkait dengan fungsi notifikasi. Fungsi notifikasi dikonfigurasikan untuk memanggil sinyal per grup </font></font><code>EFI_EVENT_GROUP_READY_TO_BOOT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Sinyal ke grup peristiwa ini berasal dari manajer boot ketika sudah siap untuk memilih perangkat untuk boot. </font></font><br><br><img src="https://habrastorage.org/webt/sj/ff/6o/sjff6ohskqe2ewtsv8xnyis3oss.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 15. Hasil dekompiler Hex-Rays melewati proses pembuatan acara</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fitur notifikasi mengeksploitasi perilaku berbahaya rootkit UEFI Sednit. Dia menulis komponen ke sistem file Windows NTFS. Sebagai aturan, UEFI firmware sendiri bekerja dengan partisi sistem EFI, sehingga driver NTFS biasanya tidak disertakan. Hanya sistem file FAT yang didukung sebagai partisi untuk diunduh. Oleh karena itu, firmware UEFI tidak selalu disertai dengan driver NTFS. Karena alasan ini, SecDxe memiliki driver NTFS bawaannya sendiri. Driver ini melakukan booting terlebih dahulu dan terhubung ke perangkat disk. Yaitu, itu menginstal </font></font><code>EFI_SIMPLE_FILE_SYSTEM_PROTOCOL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada perangkat disk dengan partisi NTFS, sehingga termasuk akses file ke mereka. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang semuanya siap untuk menulis file ke partisi Windows, SecDxe me </font></font><code>rpcnetp.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font><font style="vertical-align: inherit;">reset </font><font style="vertical-align: inherit;">dan </font></font><code>autoche.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Kemudian </font></font><code>rpcnetp.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diinstal </font></font><code>%WINDIR%\SysWOW64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada versi 64-bit Windows atau</font></font><code>%WINDIR%\System32</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada versi 32-bit. </font><font style="vertical-align: inherit;">A </font></font><code>autoche.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diatur ke </font></font><code>%WINDIR%\SysWOW64</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Gambar berikut menunjukkan proses yang bertanggung jawab untuk menulis file-file ini ke disk. </font></font><br><br><img src="https://habrastorage.org/webt/si/jo/pn/sijopnar5xrablwh02xdrv5e37a.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 16. Hasil dekompiler Hex-Rays melalui proses penulisan file ke disk,</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kemudian SecDxe membuka </font></font><code>%WINDIR%\System32\config\SYSTEM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">file dengan cadangan dari satu set kunci registri </font></font><code>HKLM\SYSTEM</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ia mem-parsing file sampai menemukan </font></font><code>'autocheck autochk *'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan menggantikan </font></font><code>'k'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di </font></font><code>'autochk'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atas </font></font><code>'e'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Akibatnya, itu </font></font><code>'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\ BootExecute'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berubah menjadi </font></font><code>'autocheck autoche *'</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Saat boot Windows berikutnya, autoche.exe akan diluncurkan sebagai gantinya </font></font><code>autochk.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tim Peretasan Driver NTFS </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti dibahas sebelumnya, driver NTFS dibangun ke dalam modul SecDxe. Ada bukti kuat bahwa operator Sednit tidak menulis driver sendiri, tetapi menyusun salinan driver DXE NTFS yang diumumkan dari Tim Peretasan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Driver NTFS mereka menggunakan proyek ntfs-3g sebagai kernel. Ini hanya pembungkus untuk membuatnya berfungsi sebagai driver UEFI DXE. File INF rakitan driver Tim Hacking sendiri mencantumkan nama file proyek ntfs-3g. Baris kode driver SecDxe NTFS juga mencantumkan banyak nama file ini: </font><font style="vertical-align: inherit;">Sangat menarik untuk dicatat bahwa jalur ke proyek sama dengan yang ditemukan dalam vektor-edk, proyek pengembangan EFI Tim Peretasan. Ada subproyek dalam vektor-edk</font></font><br><br> <code>- c:\edk2\NtfsPkg\NtfsDxe\ntfs\inode.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\volume.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\bootsect.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\unistr.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\attrib.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\mft.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\index.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\cache.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\misc.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\dir.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\runlist.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\logfile.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\uefi_io.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\ntfsinternal.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\mst.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\lcnalloc.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\compress.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\bitmap.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\collate.c <br> - c:\edk2\NtfsPkg\NtfsDxe\ntfs\security.c</code> <br> <br><font style="vertical-align: inherit;"></font><code>NtfsPkg</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan tata letak direktori yang benar-benar identik. File sumber proyek ntfs-3g terletak di jalur alamat yang sama. Dan meskipun jalannya sendiri tidak biasa, kami percaya bahwa ini bukan kebetulan belaka. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Membandingkan kode sumber bocor ke jaringan dengan apa yang kita dapatkan pada output dekompiler Hex-Rays, menjadi jelas bahwa ini adalah proyek yang sama. Gambar di bawah ini menunjukkan contoh perbandingan fungsi yang </font></font><code>NtfsDriverBindingStart</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diambil </font></font><code>vector-edk/NtfsPkg/NtfsDxe/Ntfs.c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Komentar dari kode HT asli dihapus untuk persepsi yang lebih baik. Logika dan urutan pemanggilan fungsi adalah sama. Kedua proyek bahkan menggunakan satu variabel (LockedByMe) untuk menyimpan keadaan terkunci. </font></font><br><br><img src="https://habrastorage.org/webt/qn/-k/ut/qn-kutvxgtnyuqkcvvo8zwfglya.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 17. Perbandingan hasil pada output driver Sednit dekompiler Hex-Rays NTFS (kiri) dan driver NTFS HT (kanan)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kode di atas menunjukkan pengembang dari Tim Peretasan, yang tidak ada dalam open source ntfs-3g. Seperti disebutkan di bagian </font></font><code>ReWriter_binary</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, selama penguraian sistem file firmware, file yang dapat dieksekusi mencoba untuk menghapus driver AMI NTFS. Kami ingin mencari tahu mengapa itu dihapus alih-alih digunakan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menganalisis driver dan menemukan bahwa itu hanya dapat melakukan operasi baca. Karena menulis ke sistem file tidak tersedia, pengembang tidak dapat menggunakannya untuk tujuan mereka sendiri. Kemungkinan juga operator Sednit mengalami kesulitan karena fakta bahwa sudah ada driver NTFS lain dalam firmware, sehingga mereka memutuskan untuk hanya menghapusnya. Selain menerapkan kemampuan baca dan tulis, driver Tim Peretasan tidak menghormati izin file. Misalnya, itu dapat menimpa file read-only tanpa menyebabkan kesalahan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada titik ini, kami telah menggambarkan berbagai operasi kompromi sistem yang dilakukan oleh rootkit UEFI. </font><font style="vertical-align: inherit;">Kami juga membahas alasan mengapa operator Sednit menggunakan kode sumber vektor-edk dari Tim Peretasan untuk mengembangkan driver NTFS mereka untuk menulis file ke partisi NTFS Windows. </font><font style="vertical-align: inherit;">Nanti dalam makalah ini, kami akan menyajikan analisis komponen yang disampaikan oleh SecDxe.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autoche.exe vs. </font><font style="vertical-align: inherit;">autochk.exe</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malicious </font></font><code>autoche.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digunakan untuk memastikan persistensi mini-agent </font></font><code>rpcnetp.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Seperti yang Anda lihat dari gambar berikut, ia menggunakan panggilan asli ke Windows API untuk membuat layanan. </font></font><br><br><img src="https://habrastorage.org/webt/wc/dk/fv/wcdkfvfmcoog14t1orjmryouwd4.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 18. Malicious autoche .exe mengkonfigurasi kegigihan rpcnetp.exe</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perlu dicatat bahwa nama layanan sama dengan yang digunakan oleh agen Computrace yang sah. Setelah membuat layanan, ini mengembalikan nilai kunci registri sebelumnya </font></font><code>BootExecute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/yz/wc/lj/yzwclj1loxeconb728wvsxqvyse.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gambar 19. Autoche.exe berbahaya mengembalikan nilai asli kunci registri BootExecute.Karena</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proses ini terjadi selama startup Windows, pengguna tidak mungkin melihat perubahan nilai kunci.</font></font><code>BootExecute</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Perlu dicatat bahwa di autoche .exe beberapa kesamaan dengan modul autochk.exe di Computrace terlihat, misalnya, panggilan API yang diterapkan dan pendaftaran layanan, tetapi sisanya sangat berbeda. </font><font style="vertical-align: inherit;">Modul Computrace lebih besar, dan mengembalikan file yang dapat dieksekusi asli </font></font><code>autochk.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alih-alih mengubah kunci registri. </font><font style="vertical-align: inherit;">Dia juga bertanggung jawab untuk menyebarkan mini-agent ke disk, sementara LoJax melakukan ini dengan rootkit UEFI.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rpcnetp.exe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sementara agen mini </font></font><code>rpcnetp.exe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat diimplementasikan oleh UEFI rootkit, kemungkinan besar dalam kebanyakan kasus ketika kami menemukan versi LoJack yang di-trojan, mini-agent tidak menggunakan komponen ini. Sangat mungkin bahwa mereka melanjutkan dari pertimbangan oportunistik dan menginstal rootkit UEFI hanya ketika mereka memiliki kesempatan seperti itu, dan dalam organisasi yang paling menarik bagi mereka. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selama penyelidikan, kami menemukan berbagai versi mini-agent LoJax. Daftar indikator kompromi menunjukkan hash dan domain / alamat IP yang sesuai. Seperti yang telah kami katakan, semua sampel yang ditemukan adalah versi trojanized dari agen Computrace lama yang sama, yang disusun pada tahun 2008.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami belum pernah melihat agen LoJax mengunduh dan memasang modul tambahan, tetapi kami tahu bahwa fungsi tersebut ada. </font><font style="vertical-align: inherit;">Karena kualitas terbaik LoJax adalah sembunyi-sembunyi dan ketekunan, itu pasti dapat digunakan untuk menyediakan akses ke sumber daya utama.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attack Prevention and Recovery </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mencegah serangan, ekosistem kompleks yang terdiri dari banyak komponen aktif diperlukan. </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mekanisme keamanan pertama yang dapat memblokir serangan seperti itu adalah Boot Aman. Ketika Boot Aman diaktifkan, setiap komponen firmware yang diunduh berdasarkan permintaan firmware harus ditandatangani dengan benar, sehingga memastikan integritasnya.</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami menyarankan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda mengaktifkan fungsi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Boot Aman, ini adalah perlindungan dasar terhadap serangan pada firmware UEFI. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti halnya perangkat lunak, firmware UEFI harus selalu diperbarui tepat waktu. Kunjungi situs web produsen motherboard untuk memastikan Anda memiliki versi terbaru yang tersedia.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda juga harus memastikan bahwa semua sistem Anda dilengkapi dengan chipset modern dengan Platform Controller Hub (dimulai dengan chipset Intel Seri 5 dan seterusnya). Ini akan memastikan bahwa mekanisme keamanan bekerja melawan "kerentanan kondisi ras", yang, seperti yang kami </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebutkan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , hadir di platform. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian lain dari keamanan firmware ada di tangan UEFI / vendor BIOS. Mekanisme keamanan yang disediakan oleh platform harus dikonfigurasi dengan benar oleh firmware sistem untuk benar-benar memastikan perlindungannya. Oleh karena itu, firmware pada awalnya harus dibangun dengan pemahaman tentang langkah-langkah keamanan. Untungnya, semakin banyak peneliti keamanan memperhatikan keamanan firmware, menarik perhatian vendor. Juga layak disebutkan adalah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CHIPSEC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kerangka kerja open source yang melakukan penilaian keamanan tingkat rendah untuk menentukan apakah platform tersebut dikonfigurasi dengan benar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menghilangkan konsekuensi kompromi melalui firmware UEFI adalah tugas yang sulit. Tidak ada cara mudah untuk membersihkan sistem dari ancaman semacam itu, dan tidak ada produk keamanan khusus yang dapat memperbaiki semuanya. Dalam kasus yang dijelaskan di sini, untuk menghapus rootkit, perlu untuk mem-flash memori flash SPI. Ini adalah tugas yang tidak sepele, tidak cocok untuk pengguna biasa. Memperbarui firmware UEFI dapat menghapus rootkit jika seluruh area SPI dari memori flash ditulis ulang. Jika UEFI flashing tidak dimungkinkan, satu-satunya solusi adalah mengganti motherboard dari sistem yang terinfeksi.</font></font><br><br><h2>  Kesimpulan </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rootkit UEFI adalah salah satu alat penjahat cyber paling berbahaya dan kuat karena kegigihan dan kekebalannya yang tinggi untuk menginstal ulang OS dan mengganti hard drive, serta kesulitan luar biasa dalam pendeteksian dan penghapusan. Meskipun citra UEFI sistem sulit diubah, beberapa solusi memungkinkan Anda untuk memindai modul UEFI dan mengidentifikasi di antaranya yang berbahaya. Selain itu, membersihkan firmware UEFI berarti mem-flash-nya, yang bukan operasi biasa yang tidak dapat dilakukan oleh pengguna normal. Manfaat ini menjelaskan mengapa cybergroup dengan sumber daya tak terbatas akan terus menyerang sistem UEFI. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk pertanyaan apa pun tentang pekerjaan ini, silakan hubungi ancamanintel@eset.com. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami ingin mengucapkan terima kasih kepada mereka yang bekerja pada proyek opensecuritytraining.info Tentu saja</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengantar BIOS &amp; SMM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sangat membantu kami ketika kami menganalisis interaksi dengan chip flash SPI.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Glosarium </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lihat spesifikasi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk deskripsi singkatan yang lebih rinci. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- BIOS_CNTL: Register Kontrol BIOS </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- BIOSWE: BIOS Diaktifkan </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- BLE: BIOS Lock Diaktifkan </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- FADDR: Alamat Flash </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- FDATAX: Data Flash dari FDATA0 ke FDATAN </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- FDBC: Data Flash Byte Count </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- FGO: Flash Cycle Go </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- HSFC: Sequencing Perangkat Keras Flash Control </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- HSFS: Hardware Sequencing Flash Status </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- IOCTL: Input / Output Control </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- PCH: Platform Controller Hub </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- RCBA: Root Base Base Address Register </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- RCRB: Root Complex Register Block </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- SCIP: Siklus SPI dalam Kemajuan </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- SMI: System Management Interrupt </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- SMM: Mode Manajemen Sistem</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- SMM_BWP: SMM BIOS Write Protect Disable </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- SPI: Serial Peripheral Interface</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indikator kompromi </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ReWriter_read.exe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font></font><br> <code>Win32/SPIFlash.A</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>ea728abe26bac161e110970051e1561fd51db93b</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ReWriter_binary.exe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font></font><br> <code>Win32/SPIFlash.A</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>cc217342373967d1916cb20eca5ccb29caaf7c1b</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Secdexe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font></font><br> <code>EFI/LoJax.A</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>f2be778971ad9df2082a266bd04ab657bd287413</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> info_efi.exe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font></font><br> <code>Win32/Agent.ZXZ</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>4b9e71615b37aea1eaeb5b1cfa0eee048118ff72</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> autoche.exe </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font></font><br> <code>Win32/LoJax.A</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>700d7e763f59e706b4f05c69911319690f85432e</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agen Mini EXE </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deteksi ESET </font><font style="vertical-align: inherit;">SHA-1</font></font><br> <code>Win32/Agent.ZQE <br> Win32/Agent.ZTU</code> <br><font style="vertical-align: inherit;"></font><br> <code>1771e435ba25f9cdfa77168899490d87681f2029 <br> ddaa06a4021baf980a08caea899f2904609410b9 <br> 10d571d66d3ab7b9ddf6a850cb9b8e38b07623c0 <br> 2529f6eda28d54490119d2123d22da56783c704f <br> e923ac79046ffa06f67d3f4c567e84a82dd7ff1b <br> 8e138eecea8e9937a83bffe100d842d6381b6bb1 <br> ef860dca7d7c928b68c4218007fb9069c6e654e9 <br> e8f07caafb23eff83020406c21645d8ed0005ca6 <br> 09d2e2c26247a4a908952fee36b56b360561984f <br> f90ccf57e75923812c2c1da9f56166b36d1482be</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nama Domain Perintah Server </font></font></h4><br> <code>secao[.]org <br> ikmtrust[.]com <br> sysanalyticweb[.]com <br> lxwo[.]org <br> jflynci[.]com <br> remotepx[.]net <br> rdsnets[.]com <br> rpcnetconnect[.]com <br> webstp[.]com <br> elaxo[.]org</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alamat IP Command Server </font></font></h4><br> <code>185.77.129[.]106 <br> 185.144.82[.]239 <br> 93.113.131[.]103 <br> 185.86.149[.]54 <br> 185.86.151[.]104 <br> 103.41.177[.]43 <br> 185.86.148[.]184 <br> 185.94.191[.]65 <br> 86.106.131[.]54</code> <br> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agen mini DLL </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET </font></font><br> <code>Win32/Agent.ZQE</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SHA-1 </font><font style="vertical-align: inherit;">Deteksi </font></font><br> <code>397d97e278110a48bd2cb11bb5632b99a9100dbd</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perintah Server Nama Domain Perintah Server </font></font><br> <code>elaxo.org</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alamat IP</font></font><br> <code>86.106.131[.]54</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id425251/">https://habr.com/ru/post/id425251/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id425241/index.html">Pengembang 20 tahun kemudian: Dengan mudah Lebedev tentang ICRE, pendidikan, bukunya, dan pemrogramannya</a></li>
<li><a href="../id425243/index.html">Buku pegangan john willis</a></li>
<li><a href="../id425245/index.html">Pengumuman RamblerFront & # 6</a></li>
<li><a href="../id425247/index.html">Crowdsourcing dalam pengujian</a></li>
<li><a href="../id425249/index.html">Bagaimana berkenalan dengan LLP di ITMO University: kursus "Pemrograman Tingkat Rendah"</a></li>
<li><a href="../id425253/index.html">Kami sedang melakukan proyek pembelajaran mesin dengan Python. Bagian 1</a></li>
<li><a href="../id425255/index.html">Algoritma kompresi lossless dan delta coding Broo, perbandingan dengan Xdelta3. Pengembangan proyek rumah</a></li>
<li><a href="../id425259/index.html">Mencadangkan situs Anda menggunakan git dan Makefile</a></li>
<li><a href="../id425261/index.html">Sertifikat EV sudah mati</a></li>
<li><a href="../id425263/index.html">Festival iFEST akan diadakan di Nizhny Novgorod</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>