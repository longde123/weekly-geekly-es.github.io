<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👷🏻 👌🏿 🙋🏽 LogRock: Testen durch Protokollierung 🤩 🎸 🎀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LogRock: Testen durch Protokollierung 
 Seit über 2 Jahren arbeiten wir an unserem Cleverbrush- Projekt. Dies ist eine Software zum Arbeiten mit Vekto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LogRock: Testen durch Protokollierung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453652/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a0/8fe/e87/0a08fee87984969110aef2080f4687ae.png" alt="Logrock"></div><br><h2>  LogRock: Testen durch Protokollierung </h2><br>  Seit über 2 Jahren arbeiten wir an unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cleverbrush-</a> Projekt.  Dies ist eine Software zum Arbeiten mit Vektorgrafiken.  Die Arbeit mit einem grafischen Editor impliziert eine Vielzahl von Anwendungsfällen.  Wir versuchen, Geld und Zeit zu sparen, also optimieren wir alles, einschließlich Tests.  Das Abdecken der Testfälle mit jeder Option ist zu teuer und irrational, zumal es unmöglich ist, alle Optionen abzudecken. <br><br>  Während der Entwicklung wurde ein Modul für React JS-Anwendungen erstellt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LogRock (github)</a> . <br><br>  Mit diesem Modul können Sie moderne Protokollierungsanwendungen organisieren.  Basierend auf den Protokollen führen wir Tests durch.  In diesem Artikel werde ich Ihnen die Feinheiten der Verwendung dieses Moduls und das Organisieren von Tests durch Protokollierung erläutern. <br><a name="habracut"></a><br><h2>  Was ist das Problem? </h2><br>  Wenn Sie das Programm mit einem lebenden Organismus vergleichen, ist ein Fehler darin eine Krankheit.  Die Ursache dieser "Krankheit" kann eine Reihe von Faktoren sein, einschließlich der Umgebung eines bestimmten Benutzers.  Dies gilt insbesondere dann, wenn wir eine Webplattform in Betracht ziehen.  Manchmal ist ein Kausalzusammenhang sehr komplex, und der beim Testen festgestellte Fehler ist das Ergebnis einer Reihe von Ereignissen. <br><br>  Wie bei menschlichen Beschwerden wird niemand ihre Symptome besser erklären als der Patient, kein Tester kann besser als das Programm selbst sagen, was passiert ist. <br><br><h2>  Was tun? </h2><br>  Um zu verstehen, was passiert, benötigen wir eine Liste der Aktionen, die der Benutzer in unserer Anwendung ausgeführt hat. <br><br>  Damit unser Programm uns sagen kann, was es „weh tut“, nehmen wir das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LogRock-</a> Modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(Github)</a> und verknüpfen es mit ElasticSearch, LogStash und Kibana. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/1d6/7ea/6d41d67ea5bd247827fd03948fc8b0dd.png" alt="Bild"></div><br>  <b>ElasticSearch</b> ist eine leistungsstarke Volltextsuchmaschine.  Sie können das ElasticSearch-Tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ansehen. <br>  <b>LogStash</b> ist ein System zum Sammeln von Protokollen aus verschiedenen Quellen, die Protokolle senden können, einschließlich an ElasticSearch. <br>  <b>Kibana</b> ist eine Webschnittstelle zu ElasticSearch mit vielen Add-Ons. <br><br><h2>  Wie funktioniert es </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dcf/06e/706/dcf06e706a5ae052a2f15eaf09e45c93.png" alt="Bild"></div><br>  Im Falle eines Fehlers (oder nur bei Bedarf) sendet die Anwendung Protokolle an den Server, wo sie in einer Datei gespeichert werden.  Logstash speichert Daten schrittweise in ElasticSearch - in der Datenbank.  Der Benutzer meldet sich bei Kibana an und sieht die gespeicherten Protokolle. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e19/0b0/244/e190b0244b22db314385b5156e5c56cd.png" alt="Bild"></div><br>  Es sieht aus wie ein gut abgestimmtes Kibana.  Es zeigt Daten von ElasticSearch an.  Kibana kann Daten in Form von Tabellen, Grafiken, Karten usw. anzeigen. Dies ist sehr praktisch, um zu analysieren und zu verstehen, was mit unserer Anwendung geschieht. <br><br>  <b><u>In diesem Artikel werde ich NICHT auf das Einrichten von ElasticStack eingehen!</u></b> <br><br><h2>  Protokollierungssystem erstellen </h2><br>  Als Beispiel werden wir das Protokollierungssystem in eine einseitige JS-Anwendung integrieren, die in React geschrieben wurde.  Es spielt wirklich keine Rolle, auf welchem ​​Framework Ihre Anwendung geschrieben wird.  Ich werde versuchen, den Ansatz des Aufbaus eines Protokollsystems selbst zu beschreiben. <br><br><h3>  1. Kunde </h3><br><h4>  1.0 LogRock.  Installation </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link zu LogRock</a> <br><br>  Um zu installieren, müssen Sie Folgendes ausführen: <br><br><pre><code class="bash hljs">npm install logrock  yarn add logrock</code> </pre> <br><h4>  1.1 LogRock.  Anwendungssetup </h4><br>  Wickeln Sie unsere Anwendung zunächst in eine Komponente <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { LoggerContainer } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"logrock"</span></span>; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  LoggerContainer ist eine Komponente, die auf Ihre Anwendungsfehler reagiert und einen Stapel bildet. <br><br>  Ein Stapel ist ein Objekt mit Informationen über das Betriebssystem des Benutzers, den Browser, welche Maus- oder Tastaturtaste gedrückt wurde, und natürlich das Unterarray Aktionen, in dem alle Benutzeraktionen aufgezeichnet sind, die er in unserem System ausgeführt hat. <br><br>  LoggerContainer verfügt über eine Reihe von Einstellungen, von denen einige berücksichtigt werden <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  aktiv - Aktiviert oder deaktiviert den Logger <br><br>  limit - Legt ein Limit für die Anzahl der zuletzt vom Benutzer gespeicherten Aktionen fest.  Wenn der Benutzer 21 Aktionen ausführt, wird die erste in diesem Array automatisch gelöscht.  Somit haben wir die letzten 20 Aktionen, die dem Fehler vorausgingen. <br><br>  onError - Der Rückruf, der aufgerufen wird, wenn ein Fehler auftritt.  Darin wird das Stack-Objekt eingefügt, in dem alle Informationen über die Umgebung, Benutzeraktionen usw. gespeichert sind.  Aus diesem Rückruf müssen wir diese Daten an ElasticSearch oder das Backend senden oder zur weiteren Analyse und Überwachung in einer Datei speichern. <br><br><h4>  1.2 LogRock.  Protokollierung </h4><br>  Um Benutzeraktionen in hoher Qualität protokollieren zu können, müssen wir unseren Code mit Protokollaufrufen abdecken. <br><br>  Das LogRock-Modul wird mit einem Logger geliefert, der einem LoggerContainer zugeordnet ist <br><br>  Angenommen, wir haben eine Komponente <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { useState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [toggleState, setToggleState] = useState(<span class="hljs-string"><span class="hljs-string">"off"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ setToggleState(toggleState === <span class="hljs-string"><span class="hljs-string">"off"</span></span> ? <span class="hljs-string"><span class="hljs-string">"on"</span></span> : <span class="hljs-string"><span class="hljs-string">"off"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">switch</span></span></span></span><span class="xml"><span class="hljs-tag"> ${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">toggleState</span></span></span></span><span class="xml"><span class="hljs-tag">}`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{toggle}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">; }</span></span></code> </pre> <br>  Um es richtig mit einem Protokoll zu bedecken, müssen wir die Umschaltmethode ändern <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = toggleState === <span class="hljs-string"><span class="hljs-string">"off"</span></span> ? <span class="hljs-string"><span class="hljs-string">"on"</span></span> : <span class="hljs-string"><span class="hljs-string">"off"</span></span>; logger.info(<span class="hljs-string"><span class="hljs-string">`React.Toggle|Toggle component changed state </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${state}</span></span></span><span class="hljs-string">`</span></span>); setToggleState(state); }</code> </pre> <br>  Wir haben einen Logger hinzugefügt, in dem die Informationen in zwei Teile unterteilt sind.  React.Toggle zeigt uns, dass diese Aktion auf der Ebene von React, der Toggle-Komponente, stattgefunden hat, und dann haben wir eine verbale Erklärung der Aktion und des aktuellen Status, der zu dieser Komponente gekommen ist.  Eine solche Aufteilung in Ebenen ist nicht erforderlich, aber mit diesem Ansatz wird klarer, wo genau unser Code ausgeführt wurde. <br><br>  Im Fehlerfall können wir auch die in React Version 16 eingeführte Methode „componentDidCatch“ verwenden. <br><br><h4>  2. Serverinteraktion </h4><br>  Betrachten Sie das folgende Beispiel. <br><br>  Angenommen, wir haben eine Methode, die Benutzerdaten aus einem Backend sammelt.  Die Methode ist asynchron, ein Teil der Logik ist im Backend versteckt.  Wie protokolliere ich diesen Code richtig? <br><br>  Erstens, da wir eine Client-Anwendung haben, durchlaufen alle an den Server gesendeten Anforderungen eine einzelne Benutzersitzung, ohne die Seite neu zu laden.  Um Aktionen auf dem Client mit Aktionen auf dem Server zu verknüpfen, müssen wir eine globale Sitzungs-ID erstellen und diese bei jeder Anforderung an den Server dem Header hinzufügen.  Auf dem Server können wir jeden Logger verwenden, der unsere Logik wie ein Beispiel aus dem Frontend abdeckt, und im Fehlerfall diese Daten mit der angehängten Sitzungs-ID an Elastic an die Backend-Platte senden. <br><br>  1. Wir generieren SessionID auf dem Client <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID = <span class="hljs-string"><span class="hljs-string">`sessionid-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">Math</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.random().toString(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">36</span></span></span></span><span class="hljs-string"><span class="hljs-subst">).substr(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">, </span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">9</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">`</span></span>;</code> </pre> <br>  2. Wir müssen die SessionID für alle Anfragen an den Server festlegen.  Wenn wir Bibliotheken für Abfragen verwenden, ist dies sehr einfach, indem eine SessionID für alle Abfragen deklariert wird. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fetch = axios.create({...}); fetch.defaults.headers.common.sessionId = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID;</code> </pre> <br>  3. In LoggerContainer gibt es ein spezielles Feld für die Sitzungs-ID <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} sessionID={<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.SESSION_ID} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  4. Die Anfrage selbst (auf dem Client) sieht folgendermaßen aus: <br><br><pre> <code class="javascript hljs">logger.info(<span class="hljs-string"><span class="hljs-string">`store.getData|User is ready for loading... User ID is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">`</span></span>); getData(<span class="hljs-string"><span class="hljs-string">'/api/v1/user'</span></span>, { id }) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">userData</span></span></span><span class="hljs-function"> =&gt;</span></span> { logger.info(<span class="hljs-string"><span class="hljs-string">`store.getData|User have already loaded. User count is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">JSON</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.stringify(userData)}</span></span></span><span class="hljs-string">`</span></span>); }) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> { logger.error(<span class="hljs-string"><span class="hljs-string">`store.getData|User loaded fail </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${err.message}</span></span></span><span class="hljs-string">`</span></span>); });</code> </pre> <br>  So funktioniert alles: Wir protokollieren ein Protokoll vor der Anfrage auf dem Client.  Gemäß unserem Code sehen wir, dass das Laden von Daten vom Server jetzt beginnt.  Wir haben der Anfrage eine SessionID angehängt.  Wenn unser Backend mit dem Hinzufügen dieser SessionID mit Protokollen bedeckt ist und die Anforderung fehlschlägt, können wir sehen, was im Backend passiert ist. <br><br>  So überwachen wir den gesamten Zyklus unserer Anwendung nicht nur auf dem Client, sondern auch im Backend. <br><br><h4>  3. Der Tester </h4><br>  Die Arbeit mit einem Tester verdient eine separate Beschreibung des Prozesses. <br><br>  Da wir ein Startup haben, haben wir keine formalen Anforderungen und manchmal ist bei der Arbeit nicht alles logisch. <br><br>  Wenn der Tester das Verhalten nicht versteht, muss dies zumindest berücksichtigt werden.  Außerdem kann ein Tester häufig eine Situation einfach nicht zweimal wiederholen.  Da die Schritte, die zu falschem Verhalten führen, zahlreich und nicht trivial sein können.  Darüber hinaus führen nicht alle Fehler zu kritischen Konsequenzen wie Ausnahmen.  Einige von ihnen können nur das Verhalten der Anwendung ändern, werden jedoch vom System nicht als Fehler interpretiert.  Zu diesem Zweck können Sie beim Staging eine Schaltfläche im Anwendungsheader hinzufügen, um das Senden von Protokollen zu erzwingen.  Der Tester stellt fest, dass etwas nicht richtig funktioniert, klickt auf die Schaltfläche und sendet den Stapel mit Aktionen an ElasticSearch. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/154/7f0/5531547f03a044eda98449e829d67839.png" alt="Bild"></div><br><br>  Wenn dennoch ein kritischer Fehler aufgetreten ist, müssen wir die Schnittstelle blockieren, damit der Tester nicht weiter klickt und nicht in eine Sackgasse gerät. <br><br>  Zu diesem Zweck zeigen wir den blauen Bildschirm des Todes an. <br><br>  Wir sehen oben den Text mit dem Stapel dieses kritischen Fehlers und unten die Aktionen, die ihm vorangegangen sind.  Wir erhalten auch die Fehler-ID. Der Tester kann sie auswählen und an das Ticket anhängen.  Später kann dieser Fehler in Kibana anhand dieser ID leicht gefunden werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f3/5b8/4b7/7f35b84b746e584111ce64e6416e1f36.png" alt="Bild"></div><br>  Zu diesem Zweck verfügt LoggerContainer über eigene Eigenschaften. <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} bsodActive={<span class="hljs-literal"><span class="hljs-literal">true</span></span>} bsod={BSOD} onError={stack =&gt; { sendToServer(stack); }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  bsodActive - aktiviert / deaktiviert BSOD (das Deaktivieren von BSOD gilt für Produktionscode) <br><br>  bsod ist eine Komponente.  Standardmäßig sieht es wie im obigen Screenshot aus. <br><br>  Um eine Schaltfläche in einem UI LoggerContainer anzuzeigen, können wir sie im Kontext verwenden <br><br><pre> <code class="javascript hljs">context.logger.onError(context.logger.getStackData());</code> </pre> <br><h4>  4. LogRock.  Benutzerinteraktion </h4><br>  Sie können Protokolle an die Konsole ausgeben oder dem Benutzer anzeigen. Dazu müssen Sie die Methode stdout verwenden: <br><br><pre> <code class="javascript hljs">&lt;LoggerContainer active={<span class="hljs-literal"><span class="hljs-literal">true</span></span>|<span class="hljs-literal"><span class="hljs-literal">false</span></span>} limit={<span class="hljs-number"><span class="hljs-number">20</span></span>} bsodActive={<span class="hljs-literal"><span class="hljs-literal">true</span></span>} bsod={BSOD} onError={stack =&gt; { sendToServer(stack); }} stdout={(level, message, important) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>[level](message); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (important) { alert(message); } }} &gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">LoggerContainer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  stdout ist eine Methode, die für die Anzeige von Nachrichten verantwortlich ist. <br><br>  Damit die Nachricht wichtig wird, reicht es aus, den zweiten Parameter true an den Logger zu übergeben.  So kann diese Nachricht dem Benutzer in einem Popup-Fenster angezeigt werden. Wenn beispielsweise das Laden der Daten fehlgeschlagen ist, können wir eine Fehlermeldung anzeigen. <br><br><pre> <code class="javascript hljs">logger.log(<span class="hljs-string"><span class="hljs-string">'Something was wrong'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre> <br><h3>  Erweiterte Protokollierung </h3><br>  Wenn Sie Redux oder ähnliche Lösungen mit einem Geschäft verwenden, können Sie einen Logger in die Middleware einbinden, der Ihre Aktionen verarbeitet. Dadurch werden alle wichtigen Aktionen durch unser System geleitet. <br><br>  Für eine effektive Protokollierung können Sie Ihre Daten in ein Proxy-Objekt einschließen und alle Aktionen mit dem Objekt protokollieren. <br><br>  Um Methoden von Drittanbietern mit der Protokollierung abzudecken (Bibliotheksmethoden, Legacy-Codemethoden), können Sie Dekoratoren verwenden - "@". <br><br><h3>  Tipps </h3><br>  Protokollieren Sie Anwendungen, auch in der Produktion, da kein Tester Engpässe feststellen kann, da er besser als echte Benutzer ist. <br><br>  Vergessen Sie nicht, die Sammlung der Protokolle in der Lizenzvereinbarung anzugeben. <br><br>  <b>Protokollieren Sie KEINE Passwörter, Bankdaten und andere persönliche Informationen!</b> <br><br>  Die Redundanz der Protokolle ist ebenfalls schlecht. Machen Sie die Signaturen so klar wie möglich. <br><br><h3>  Alternativen </h3><br>  Als alternative Ansätze hebe ich Folgendes hervor: <br><br><ul><li>  Überrollbügel ist sehr anpassbar.  Ermöglicht das Protokollieren von 500.000 Fehlern für 150 US-Dollar pro Monat.  Ich empfehle es zu verwenden, wenn Sie eine Anwendung von Grund auf neu entwickeln. </li><li>  Sentry ist einfacher zu integrieren, aber weniger anpassbar.  Ermöglicht das Protokollieren von 1 Million Ereignissen für 200 US-Dollar pro Monat. </li></ul><br>  Mit beiden Diensten können Sie fast dasselbe tun und sich in das Backend integrieren. <br><br><h3>  Was weiter </h3><br>  Die Protokollierung ist nicht nur die Suche nach Fehlern, sondern überwacht auch Benutzeraktionen und die Datenerfassung.  Die Protokollierung kann eine gute Ergänzung zu Google Analytics- und User Experience-Tests sein. <br><br><h3>  Schlussfolgerungen </h3><br>  Wenn Sie die App veröffentlichen, fängt das Leben für ihn gerade erst an.  Seien Sie für Ihre Idee verantwortlich, erhalten Sie Feedback, überwachen Sie Protokolle und verbessern Sie sie.  Schreiben Sie hochwertige Software und gedeihen Sie :) <br><br>  PS Wenn Sie bei der Entwicklung von Modulen für Angular, Vue usw. helfen möchten.  Gerne ziehe ich Anfragen - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de453652/">https://habr.com/ru/post/de453652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453634/index.html">Alfa Bank School of System Analysis</a></li>
<li><a href="../de453642/index.html">Intelligenter Parser für eine in Worten geschriebene Zahl</a></li>
<li><a href="../de453644/index.html">Interview - 10 Fragen zu Swift. Teil 3</a></li>
<li><a href="../de453646/index.html">Normalisierung von Daten in einer verteilten Datenbank, Microservices und ERP</a></li>
<li><a href="../de453650/index.html">Softwarekern der On-Board-Cyber-Infrastruktur des einheitlichen Streikkämpfers F-35</a></li>
<li><a href="../de453656/index.html">Statisches Web: Zurück zu den Grundlagen?</a></li>
<li><a href="../de453660/index.html">Intel zeigte den neuen i9-9900KS-Prozessor mit 5 GHz Turbo-Frequenz pro Kern</a></li>
<li><a href="../de453662/index.html">Mars - noch mehr Eis am Nordpol, aber tief</a></li>
<li><a href="../de453664/index.html">Spring Boot - OAuth2 und JWT</a></li>
<li><a href="../de453666/index.html">Wie ich ein unbemanntes Taxi fuhr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>