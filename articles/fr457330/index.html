<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè∏ üíâ üìé Comment v√©rifier rapidement les avertissements int√©ressants donn√©s par l'analyseur PVS-Studio pour le code C et C ++? ü§∏üèæ üñ•Ô∏è üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De temps en temps, les programmeurs qui commencent √† se familiariser avec l'analyseur de code PVS-Studio me demandent: "Existe-t-il une liste d'averti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment v√©rifier rapidement les avertissements int√©ressants donn√©s par l'analyseur PVS-Studio pour le code C et C ++?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/457330/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df3/c29/8f2/df3c298f21cb71d0c7c699b7e27269d3.png"></div><br>  De temps en temps, les programmeurs qui commencent √† se familiariser avec l'analyseur de code PVS-Studio me demandent: "Existe-t-il une liste d'avertissements qui indiquent avec pr√©cision les erreurs?"  Il n'y a pas une telle liste car les avertissements (faux) inint√©ressants dans un projet sont tr√®s importants et utiles dans un autre.  Cependant, on peut certainement commencer √† creuser dans l'analyseur √† partir des avertissements les plus excitants.  Examinons de plus pr√®s ce sujet. <br><a name="habracut"></a><br>  Le probl√®me est, en r√®gle g√©n√©rale, que le programmeur s'ex√©cute d'abord dans un grand nombre d'avertissements qu'il re√ßoit.  Naturellement, il veut commencer √† passer en revue les avertissements les plus int√©ressants afin de comprendre s'il doit passer son temps √† r√©gler tout cela.  Bon, voici donc trois √©tapes simples qui lui permettront de consulter les avertissements les plus excitants. <br><br><h2>  √âtape 1 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/648/436/d98/648436d98521380495f1c9f8ee384646.png"></div><br><br>  D√©sactivez tous les types d'avertissements, √† l'exception des avertissements g√©n√©raux (GA).  Une erreur courante consiste √† activer tous les types d'avertissements.  Les utilisateurs inexp√©riment√©s pensent que plus il faut activer, mieux c'est.  Ce n'est pas le cas.  Il existe des ensembles de diagnostic, tels que les contr√¥les 64 bits et les r√®gles MISRA, qui ne doivent √™tre utilis√©s que lorsque l'on sait clairement de quoi il s'agit et comment les utiliser.  Par exemple, en activant les diagnostics MISRA pour un programme d'application ordinaire, vous vous noyerez dans des dizaines, des milliers ou des centaines de milliers d'avertissements tels que: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2506</a> .  Misra.  Une fonction doit avoir un seul point de sortie √† la fin. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2507</a> .  Misra.  Le corps d'une instruction loop \ conditional doit √™tre plac√© entre accolades. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2523</a> .  Misra.  Toutes les constantes enti√®res de type non sign√© doivent avoir le suffixe ¬´u¬ª ou ¬´U¬ª. </li></ul><br>  La plupart des avertissements MISRA n'indiquent pas des erreurs, mais des odeurs de code.  Naturellement, un programmeur commence √† poser des questions.  Comment trouvez-vous quelque chose d'int√©ressant dans la pile de tous ces avertissements?  Quels num√©ros doit-il regarder?  Ce ne sont pas les bonnes questions.  Il vous suffit de d√©sactiver l'ensemble MISRA.  Il s'agit de la norme pour √©crire du code de qualit√© pour les appareils int√©gr√©s.  Le but de la norme est de rendre le code extr√™mement simple et compr√©hensible.  N'essayez pas de l'appliquer l√† o√π c'est inappropri√©. <br><br>  Remarque  Oui, MISRA a des r√®gles con√ßues pour identifier les vrais bugs.  Exemple: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V2538</a> - La valeur de la variable non initialis√©e ne doit pas √™tre utilis√©e.  Mais n'ayez pas peur de d√©sactiver la norme MISRA.  Tu ne vas rien perdre.  Les vraies erreurs seront toujours trouv√©es dans le cadre des diagnostics g√©n√©raux (GA).  Par exemple, une variable non initialis√©e sera trouv√©e par le diagnostic <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V614</a> . <br><br><h2>  √âtape 2 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f30/9c1/d2f/f309c1d2fed7a2736170dad987cd4460.png"></div><br><br>  Tout analyseur statique √©met des faux positifs lors des premi√®res ex√©cutions et n√©cessite une configuration.  On ne peut rien y faire, mais ce n'est pas aussi effrayant que cela puisse para√Ætre.  M√™me un simple r√©glage rapide vous permet de supprimer la plupart des faux positifs et de commencer √† afficher un rapport assez pertinent.  Je n'en parlerai pas plus, comme je l'ai √©crit √† plusieurs reprises, par exemple, dans cet article: " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Caract√©ristiques de PVS-Studio Analyzer par l'exemple des biblioth√®ques de base EFL, 10-15% de faux positifs</a> ". <br><br>  Passez un peu de temps √† d√©sactiver les avertissements manifestement non pertinents et √† lutter contre les faux positifs li√©s aux macros.  De mani√®re g√©n√©rale, les macros sont la principale raison des faux positifs, car un avertissement appara√Æt dans tous les cas lorsqu'une macro mal impl√©ment√©e est utilis√©e.  Pour supprimer les avertissements dans les macros, vous pouvez √©crire des commentaires d'un type sp√©cial √† c√¥t√© de leur d√©claration.  Le plus de format de commentaires est couvert dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> . <br><br>  Oui, le r√©glage initial prendra un peu de temps, mais am√©liorera consid√©rablement la perception du rapport en √©liminant le bruit g√™nant.  Prenez le temps de le faire.  S'il y a des difficult√©s ou des questions, nous sommes toujours pr√™ts √† vous aider et √† vous dire comment configurer l'analyseur de la meilleure fa√ßon.  N'h√©sitez pas √† nous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©crire</a> et √† nous poser des questions. <br><br><h2>  √âtape 3 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f87/0ec/c49/f870ecc49989743ae8caea3c745e602e.png"></div><br><br>  Commencez √† afficher les avertissements √† partir du niveau 1. Seulement apr√®s avoir regard√© les niveaux 2 et 3. Les niveaux d'avertissement ne sont rien de plus que la v√©racit√© d'un avertissement.  Les avertissements du niveau 1 sont plus susceptibles d'indiquer une erreur r√©elle que les avertissements du niveau 2. <br><br>  Vous pouvez dire que lorsque vous choisissez de "regarder le niveau 1", vous appuyez sur le bouton "regarder les erreurs les plus int√©ressantes". <br><br>  Plus en d√©tail, la classification des avertissements de PVS-Studio par niveaux est d√©crite dans l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La fa√ßon dont les analyseurs statiques luttent contre les faux positifs, et pourquoi ils le font</a> ". <br><br><h2>  Alors pourquoi n'y a-t-il pas de liste? </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df2/95f/70b/df295f70b19562c12916ec578022829f.png"></div><br><br>  Cependant, l'id√©e d'avoir une liste des avertissements les plus utiles peut encore sembler raisonnable.  Permettez-moi de vous montrer dans un exemple pratique que l'utilit√© d'un diagnostic est relative et d√©pend du projet. <br><br>  Prenons l'avertissement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V550</a> .  L'avertissement d√©tecte une erreur potentielle li√©e au fait que pour comparer des nombres avec une virgule flottante, les op√©rateurs == ou! = Sont utilis√©s. <br><br>  La plupart des d√©veloppeurs √† qui j'ai parl√© pensent que ce diagnostic est inutile et ils le d√©sactivent car tous ses d√©clenchements pour leur projet sont faux.  C'est pourquoi ce diagnostic a un faible niveau de certitude et se rapporte au niveau 3. <br><br>  En effet, dans la plupart des applications, les types float / double sont utilis√©s dans des algorithmes tr√®s simples.  Souvent, la comparaison avec la constante sert uniquement √† v√©rifier si une certaine valeur est d√©finie par d√©faut ou si elle a chang√©.  Dans ce cas, la v√©rification exacte est tout √† fait appropri√©e.  Je vais l'expliquer avec un pseudo-code. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsUserInputNewValue()) value = GetUserValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-number"><span class="hljs-number">1.0f</span></span>) DefaultBehavior(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Foo(value);</code> </pre> <br>  Ici, la comparaison <i>(valeur de 1.0f)</i> est correcte et s√ªre. <br><br>  Est-ce √† dire que le diagnostic V550 est sans int√©r√™t?  Non.  Tout d√©pend du projet.  Permettez-moi de citer un extrait de l'article " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment nous avons essay√© l'analyse statique sur notre projet de simulateur de formation en chirurgie endovasculaire aux rayons X</a> ", r√©dig√© par notre utilisateur. <br><br>  Alors, √† quoi notre analyseur statique fait attention ici: <br><br>  V550 Une comparaison √©trange et pr√©cise: t! = 0. Il est probablement pr√©f√©rable d'utiliser une comparaison avec une pr√©cision d√©finie: fabs (A - B)&gt; Epsilon.  objectextractpart.cpp 3401 <br><br><pre> <code class="cpp hljs">D3DXVECTOR3 N = VectorMultiplication( VectorMultiplication(V-VP, VN), VN); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Qsqrt(Scalar(N, N)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { N/=t; V = V - N * DistPointToSurface(V, VP, N); }</code> </pre> <br>  Des erreurs de ce type se r√©p√®tent assez souvent dans cette biblioth√®que.  Je ne peux pas dire que cela m‚Äôa surpris.  Auparavant, j'ai rencontr√© une gestion incorrecte des nombres avec une virgule flottante dans ce projet.  Cependant, il n'y avait pas de ressources pour v√©rifier syst√©matiquement les sources.  √Ä la suite de la v√©rification, il est devenu clair qu'il √©tait n√©cessaire de donner au d√©veloppeur quelque chose pour √©largir ses horizons en termes de travail avec des nombres √† virgule flottante.  Il a √©t√© li√© √† quelques bons articles.  Nous verrons comment les choses se passeront.  Il est difficile de dire avec certitude si cette erreur provoque de v√©ritables perturbations dans le programme.  La solution actuelle expose un certain nombre d'exigences pour le maillage polygonal d'origine des art√®res, qui simule la propagation de la mati√®re de contraste aux rayons X.  Si les exigences ne sont pas remplies, le programme peut tomber ou le travail est clairement incorrect.  Certaines de ces exigences sont obtenues analytiquement, et d'autres - empiriquement.  Il est possible que cet ensemble empirique d'exigences croisse simplement en raison d'une mauvaise gestion des nombres √† virgule flottante.  Il convient de noter que tous les cas trouv√©s d'utilisation d'une comparaison pr√©cise des nombres avec une virgule flottante n'√©taient pas une erreur. <br><br>  Comme vous pouvez le voir, ce qui n'est pas int√©ressant dans certains projets int√©resse d'autres.  Il est donc impossible de cr√©er une liste des "plus int√©ressants". <br><br>  Remarque  Vous pouvez √©galement d√©finir le niveau des avertissements √† l'aide des param√®tres.  Par exemple, si vous pensez que le diagnostic du V550 m√©rite une attention particuli√®re, vous pouvez le d√©placer du niveau 3 au niveau 1.  Ce type de param√®tres est d√©crit dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> (voir ¬´Comment d√©finir votre niveau pour des diagnostics sp√©cifiques¬ª). <br><br><h2>  Conclusion </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37d/d9e/ecd/37dd9eecd44e33d66c2993ad552e11f7.png"></div><br>  Vous savez maintenant comment commencer √† √©tudier les avertissements de l'analyseur en examinant les plus int√©ressants.  Et n'oubliez pas de consulter la documentation pour obtenir une description d√©taill√©e des avertissements.  Parfois, il arrive que derri√®re un non-descriptif, √† premi√®re vue, l'avertissement se trouve l'enfer.  Un exemple de tels diagnostics: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V597</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V1026</a> .  Merci de votre attention. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457330/">https://habr.com/ru/post/fr457330/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457312/index.html">Introduction √† la th√©orie des ensembles</a></li>
<li><a href="../fr457316/index.html">Comment le jeu de r√¥le dans le monde r√©el est organis√© pour les invit√©s d'Arm√©nie avec des voyages dans la moiti√© du pays</a></li>
<li><a href="../fr457324/index.html">√âv√©nements num√©riques √† Moscou du 24 au 30 juin</a></li>
<li><a href="../fr457326/index.html">Cluster de basculement PostgreSQL + Patroni. Exp√©rience de mise en ≈ìuvre</a></li>
<li><a href="../fr457328/index.html">Cat√©gories au lieu de r√©pertoires, ou le syst√®me de fichiers s√©mantique pour Linux</a></li>
<li><a href="../fr457332/index.html">Comment voir rapidement les avertissements int√©ressants g√©n√©r√©s par l'analyseur PVS-Studio pour le code C et C ++?</a></li>
<li><a href="../fr457334/index.html">TacacsGUI, Configuration Manager</a></li>
<li><a href="../fr457336/index.html">Les cons√©quences du retrait pr√©matur√© des dents de sagesse</a></li>
<li><a href="../fr457338/index.html">Blitz avec Ilya Krasinsky: comment tirer les mauvaises hypoth√®ses, pourquoi rejeter un produit et comment grandir pour un minimum d'action?</a></li>
<li><a href="../fr457340/index.html">10 plugins PostCSS qui vous feront gagner du temps de mise en page</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>