<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚻 🍓 👦🏾 Data Lake概念中的分布式数据仓库：安装CDH 👩‍⚖️ 🍉 🧔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们将继续分享我们在组织数据仓库方面的经验，我们在上一篇文章中开始谈到。 这次我们要谈谈如何解决CDH安装任务。 



 CDH安装 


 我们启动Cloudera Manager服务器，将其添加到自动加载并检查它是否已切换为活动状态： 


systemctl start cloudera-s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Data Lake概念中的分布式数据仓库：安装CDH</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neoflex/blog/414831/"><p> 我们将继续分享我们在组织数据仓库方面的经验，我们在上一篇<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章中</a>开始谈到。 这次我们要谈谈如何解决CDH安装任务。 <br></p><br><img src="https://habrastorage.org/webt/x9/9c/ai/x99caiamrbi10fmc4qysbsac8cs.png"><br><a name="habracut"></a><br><h2>  CDH安装 </h2><br><p> 我们启动Cloudera Manager服务器，将其添加到自动加载并检查它是否已切换为活动状态： </p><br><pre><code class="hljs sql">systemctl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> cloudera-scm-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> systemctl <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> cloudera-scm-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> systemctl <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> cloudera-scm-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span></code> </pre> <br><p> 上升之后，我们单击链接“主机名：7180 /”，登录（admin / admin）并从GUI继续安装。 授权后，安装将自动开始，并将过渡到用于将主机添加到群集的页面： </p><br><br><img src="https://habrastorage.org/webt/vw/lb/gq/vwlbgqws_edvskh8hi1hbwoj1w8.jpeg"><br><br><p> 建议添加所有将以某种方式与已部署环境连接的主机（即使它们将不托管Cloudera服务）。 这些机器可以是具有连续集成工具，BI或ETL工具或数据发现工具的机器。 将这些计算机包含在群集中将使您能够安装包含文件的群集服务（网关）的网关以及群集服务的配置和位置，这将简化与第三方程序的集成。  Cloudera Manager还提供了方便的监视工具，并在单个窗口中为所有群集计算机创建了关键指标的监视器，这将简化操作过程中问题的定位。 使用“新建搜索”按钮添加主机-切换到用于将计算机添加到群集的页面，建议在该页面中为主机提供通过SSH连接的数据： </p><br><img src="https://habrastorage.org/webt/wk/u8/j0/wku8j0_1seamiqft3ejoewimr18.jpeg"><br><br><p> 添加主机后，我们进入选择安装方法的阶段。 由于我们下载了Parsels，因此我们选择“ Use Parcels（Recommended）”方法，现在我们需要添加存储库。 我们单击“更多选项”按钮，删除那里安装的所有默认存储库，并使用CDH解析器添加存储库地址-“主机名/包裹/ cdh /”。 确认后，在“选择CDH版本”字样的右侧，应显示下载的解析器中显示的CDH版本。 对于此安装方法，无法在此选项卡上配置任何内容： </p><br><br><img src="https://habrastorage.org/webt/i4/it/wv/i4itwvon6u8i5roi9joguikioxk.jpeg"><br><br><p> 下一个选项卡将提示您安装JDK。 由于我们已经为安装做准备了，因此我们跳过此步骤： </p><br><img src="https://habrastorage.org/webt/fc/-u/do/fc-udo9cvauocj_ods60mn4fclu.jpeg"><br><br><p> 当您转到下一个选项卡时，将开始在指定主机上安装群集组件。 安装完成后，即可进行下一步转换。 如果在安装过程中遇到错误（在安装本地Dev环境时遇到了这种情况），则可以使用命令<i>“ tail -f /var/log/cloudera-scm-server/cloudera-scm-server.log”</i>查看其详细信息。并点击表格右侧的“详细信息”按钮： </p><br><img src="https://habrastorage.org/webt/vx/2b/f9/vx2bf9zmuvu7vwzpxt8ek9yyzqy.jpeg"><br><br><p> 在下一个安装步骤中，系统将提示您选择准备的服务集之一进行安装。 以后，可以手动配置服务及其角色，因此在此选项卡上选择什么并不是很重要。 在我们的案例中，通常安装了“ Core with Impala”。 您还可以在此处指示需要安装Cloudera Navigator。 如果要安装企业版，则应安装此有用的工具： </p><br><img src="https://habrastorage.org/webt/xs/mu/tx/xsmutxajyfzc7onaobs11smfrlu.jpeg"><br><br><p> 在用于所选集合的服务的下一个选项卡上，建议选择将要安装它们的角色和主机。 以下是在主机上安装角色的一些准则。 </p><br><h4>  HDFS角色 </h4><br>  <b>NameNode-</b>放置在一个主节点（最好是最不负载）上的单个副本中，因为它对集群的运行非常重要，并且对资源利用做出了重大贡献。 <br>  <b>SecondaryNameNode-</b>放置在一个主节点上的单个副本中，最好与NameNode不在同一节点上（以确保容错）。 <br>  <b>平衡器</b> -放在一个主节点上的单个副本中。 <br>  <b>HttpFS</b> -HDFS的附加API，您无法安装。 <br>  <b>NFS网关</b> -一个非常有用的角色，允许您将HDFS挂载为网络驱动器。 它被放置在一个主节点上的单个副本中。 <br>  <b>DataNode-</b>放在所有数据节点上。 <br><br><h4> 蜂巢角色 </h4><br>  <b>网关</b> -Hive配置文件。 它放置在群集的所有主机上。 <br>  <b>Hive Metastore Server</b> （元数据服务器）安装在一个主节点上的单个副本中（例如，安装了PostgreSQL的一个节点-它在那里存储数据）。 <br>  <b>WebHCat-</b>无需安装。 <br>  <b>HiveServer2-</b>与Hive Metastore Server <b>安装</b>在同一主节点上的单个副本中（共同工作的要求）。 <br><br><h4> 色调角色 </h4><br>  <b>Hue Server</b> -HDFS的GUI，安装在一个主节点上的单个副本中。 <br>  <b>负载平衡器</b> -HDFS的GUI上的负载平衡器安装在一个主节点上的单个副本中。 <br><br><h4> 黑斑羚角色 </h4><br>  <b>Impala StateStore-</b>放置在一个主节点上的单个副本中。 <br>  <b>Impala Catalog Server-</b>放在一个主节点上的单个副本中。 <br>  <b>Impala守护程序</b> -置于所有数据节点上（您可以保留默认值）。 <br><br><h4>  Cloudera Manager服务角色 </h4><br>  Service Monitor，Activity Monitor，Host Monitor，Reports Manager，Event Server，Alert Publisher安装在一个主节点上的单个副本中。 <br><br><h4>  Oozie角色 </h4><br>  Oozie Server-放在一个主节点上的单个副本中。 <br><br><h4> 角色纱 </h4><br>  <b>ResourceManager-</b>放在一个主节点上的单个副本中。 <br>  <b>JobHistory Server-安装</b>在一个主节点上的单个副本中。 <br>  <b>NodeManager-</b>置于所有数据节点上（您可以保留默认值）。 <br><br><h4>  ZooKeeper角色 </h4><br>  ZooKeeper服务器-为确保容错能力，它一式三份地安装在主节点上。 <br><br><h4>  Cloudera Navigator角色 </h4><br>  <b>Navigator Audit Server-</b>安装在一个主节点上的单个副本中。 <br>  <b>Navigator Metadata Server-</b>放在单个副本中的一个主节点上。 <br><br><img src="https://habrastorage.org/webt/i0/ii/gh/i0iighjxghd32ioeloi1pkdip-w.jpeg"><br><br><p> 分配角色之后，将出现一个选项卡，其中列出了已安装服务的简短设置列表。 它们的更改将在安装后可用，并且在此阶段可以保持不变： </p><br><img src="https://habrastorage.org/webt/ck/bh/jv/ckbhjv2qojdszn2vhduah6smoes.jpeg"><br><br><p> 在服务设置之后，有需要它们的服务的数据库配置。 我们输入安装了PostgreSQL的主机的全名，在“数据库类型”列表框中，选择适当的项目，然后在其余字段中指定用于连接到相应数据库的数据。 输入所有数据后，单击“测试连接”按钮并检查数据库是否可用。 如果是这种情况，则在每个数据库对面的表格的右侧，将显示“成功”字样： </p><br><img src="https://habrastorage.org/webt/y1/kd/mo/y1kdmoq_mjofdhlu1nv3ezr7haw.jpeg"><br><br><p> 一切准备就绪，可以部署服务。 转到下一个选项卡，并观察此过程。 如果我们做对了所有事情，那么所有步骤将成功完成。 否则，该过程将在以下步骤之一被中断，并且通过按箭头可以查看错误日志： </p><br><img src="https://habrastorage.org/webt/vw/5f/u3/vw5fu307aqrern1xplyqme1vam0.jpeg"><br><br><p> 恭喜-CDH已启动并正在运行！ </p><br><img src="https://habrastorage.org/webt/bp/md/fw/bpmdfwhtybdn3dvnm1i-ekgqg3q.jpeg"><br><br><p> 您可以继续安装其他Parsels。 </p><br><h2> 设置其他parsels </h2><br><p> 如果基本的CHD服务集不够用或需要更新的版本，则可以安装其他Parsels，以扩展可在群集中部署的服务的可用列表。 在我们的项目期间，我们需要Spark 2.2版服务来启动开发的任务和数据发现工具的功能。 它不是CDH的一部分，因此请单独安装。 为此，请单击“主机”按钮，然后选择“包裹”下拉列表项： </p><br><img src="https://habrastorage.org/webt/ft/qb/ij/ftqbijbu7tsfmpymhio3cb_ecto.jpeg"><br><br><p> 将打开一个带有parsels的选项卡，显示此Cloudera Manager管理的集群的列表以及安装在它们上的parsels。 要使用Spark 2.2添加解析器，请选择所需的群集，然后单击右上角的“配置”按钮。 </p><br><img src="https://habrastorage.org/webt/tv/lw/gt/tvlwgty-zz44yiyetbkuegfjdvw.jpeg"><br><br><p> 我们单击“ +”按钮，在出现的行中，使用Spark 2.2解析器（“主机名/包裹/ spark /”）指示存储库的地址，然后单击“保存更改”按钮： </p><br><br><img src="https://habrastorage.org/webt/v1/cf/lc/v1cflc3hn9ugykckehyctwi2iuq.jpeg"><br><br><p> 完成这些操作后，一个名为SPARK2的新名称应出现在上一个选项卡上的解析列表中。 最初，它显示为可供下载，因此下一步是通过单击“下载”按钮来下载它： </p><br><img src="https://habrastorage.org/webt/um/_t/4x/um_t4xg_bvcwhsoq6uooegdi4zw.jpeg"><br><br><p> 下载的Parsel需要分散在群集节点上，以便可以从中安装服务。 为此，请单击显示在带有SPARK2解析器的行右侧的“分发”按钮： </p><br><img src="https://habrastorage.org/webt/jd/-g/2n/jd-g2nexsddwbmav6ninxufeors.jpeg"><br><br><p> 处理包裹的最后一步是激活包裹。 我们通过单击“激活”按钮来激活它，该按钮显示在带有解析器的行的右侧： </p><br><img src="https://habrastorage.org/webt/br/sq/ng/brsqnglu6d_dc9fmldnyvk6xnn4.jpeg"><br><br><p> 确认后，就可以安装我们需要的服务。 但是有细微差别。 要在集群中安装某些服务，除了安装解析器外，还需要执行其他任何操作。 通常，这是在官方网站上有关安装和更新此服务的部分中写的（这是她的Spark 2示例<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-www.cloudera.com/documentation/spark2/latest/topics/spark2_installing.html</a> ）。 在这种情况下，您需要下载Spark 2 CSD文件（可在“版本和打包信息”页面上找到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-www.cloudera.com/documentation/spark2/latest/topics/spark2_packaging.html</a> ），使用Cloudera Manager将其安装在主机上，然后重新启动后者。 让我们开始吧-下载此文件，将其传输到所需的主机，然后从指令中执行命令： </p><br><pre> <code class="hljs powershell">mv SPARK2_ON_YARN<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span>.cloudera1.jar /opt/cloudera/csd/ chown cloudera<span class="hljs-literal"><span class="hljs-literal">-scm</span></span>:cloudera<span class="hljs-literal"><span class="hljs-literal">-scm</span></span> /opt/cloudera/csd/SPARK2_ON_YARN<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span>.cloudera1.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /opt/cloudera/csd/SPARK2_ON_YARN<span class="hljs-literal"><span class="hljs-literal">-2</span></span>.<span class="hljs-number"><span class="hljs-number">1.0</span></span>.cloudera1.jar systemctl restart cloudera<span class="hljs-literal"><span class="hljs-literal">-scm</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span></code> </pre><br><p> 当Cloudera Manager上升时，一切都准备就绪，可以安装Spark2。在主屏幕上，单击集群名称右侧的箭头，然后在下拉菜单中选择“添加服务”项： </p><br><img src="https://habrastorage.org/webt/vz/py/df/vzpydfjiyc7wqvhjpu-6v-jvnku.jpeg"><br><br><p> 在可用于安装的服务列表中，选择我们需要的服务： <br><img src="https://habrastorage.org/webt/jj/kc/a2/jjkca23w65chxw-4rbthnt-cbzy.jpeg"><br> 在下一个选项卡上，选择新服务的依赖项集。 例如，列表较宽的那个： </p><br><img src="https://habrastorage.org/webt/05/bo/n6/05bon6tf9coig70q-5tlwsvxr7q.jpeg"><br><br><p> 接下来是带有角色和主机选择的选项卡，将在这些角色和主机上进行安装，类似于CDH的安装过程。 建议您将历史服务器角色放置在一个主节点上的一个副本中，并将网关放置在所有群集服务器上： </p><br><img src="https://habrastorage.org/webt/j9/e5/6r/j9e56rfar_1f2ci1wmlxgd7egog.jpeg"><br><br><p> 选择角色后，建议检查并确认在安装服务期间对集群所做的更改。 您可以在此处默认保留所有内容： </p><br><img src="https://habrastorage.org/webt/dd/2r/b9/dd2rb9yewzcjnmagqz8rutlyqp0.png"><br><br><p> 确认更改将开始在群集中安装服务。 如果一切正确完成，则安装将成功完成： </p><br><img src="https://habrastorage.org/webt/wt/tr/oa/wttroazkwjdljf6p-6pusmz_jhk.png"><br><br><p> 恭喜你！  Spark 2已成功安装在集群中： </p><br><img src="https://habrastorage.org/webt/xx/in/j2/xxinj2xoglf1qldbxahdof7ienw.png"><br><br><p> 您必须重新启动集群才能完成安装过程。 之后，一切准备就绪。 </p><br><p> 在服务的安装阶段可能会发生错误。 例如，在其中一种环境上安装时，无法部署Spark 2 Gateway的角色。 通过将文件/ var / lib / alternatives / spark2-conf的内容从已成功安装此角色的主机复制到问题机器中的类似文件，可以帮助解决该问题。 要诊断安装错误，使用相应进程的日志文件很方便，这些日志文件存储在/ var / run / cloudera-scm-agent / process /文件夹中。 </p><br><p> 今天就这些了。 该系列的下一篇文章将讨论CDH群集管理的主题。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN414831/">https://habr.com/ru/post/zh-CN414831/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN414819/index.html">欢迎来到本周六在圣彼得堡举行的虚幻引擎4聚会</a></li>
<li><a href="../zh-CN414821/index.html">信息安全学院实用视频课程</a></li>
<li><a href="../zh-CN414825/index.html">我能感觉到的唯一的情绪是愤怒和恐惧</a></li>
<li><a href="../zh-CN414827/index.html">到2050年，全球50％的能源生产将来自可再生能源。</a></li>
<li><a href="../zh-CN414829/index.html">我的方式：我如何拒绝购买Noolite网关，而将其替换为自行车</a></li>
<li><a href="../zh-CN414833/index.html">摘要：PayPal以4亿美元收购Hyperwallet，三星启动区块链项目</a></li>
<li><a href="../zh-CN414835/index.html">大气中的骤雨会导致超级计算机的故障：该怎么办</a></li>
<li><a href="../zh-CN414837/index.html">只允许通过CloudFlare（iptables）访问Web服务器</a></li>
<li><a href="../zh-CN414839/index.html">工厂生产的住宅模块能否帮助解决住房短缺问题</a></li>
<li><a href="../zh-CN414843/index.html">创建无暗物质星系的5种方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>