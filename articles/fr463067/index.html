<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úÇÔ∏è üë©‚Äçüè≠ üßê D'abord l'avant, puis l'arri√®re (un jour) ‚õ™Ô∏è üôã üêÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avant de commencer √† impl√©menter une nouvelle fonctionnalit√©, vous devez vous casser la t√™te. 


 Le d√©veloppement de fonctionnalit√©s complexes n√©cess...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D'abord l'avant, puis l'arri√®re (un jour)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463067/"><p>  Avant de commencer √† impl√©menter une nouvelle fonctionnalit√©, vous devez vous casser la t√™te. </p><br><p>  Le d√©veloppement de fonctionnalit√©s complexes n√©cessite une coordination fine des efforts d'une √©quipe d'ing√©nieurs. </p><br><p>  Et l'un des points les plus importants est la question de la parall√©lisation des t√¢ches. </p><br><p>  Est-il possible de sauver les soldats de premi√®re ligne d'avoir √† attendre une mise en ≈ìuvre en arri√®re-plan?  Existe-t-il un moyen de parall√©liser le d√©veloppement de fragments individuels de l'interface utilisateur? </p><br><p>  Le sujet de la parall√©lisation des t√¢ches dans le d√©veloppement Web sera abord√© dans cet article. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/72d/93d/13b/72d93d13b21e705a101b21c359c3a565.png"></p><a name="habracut"></a><br><h3 id="problema">  Le probl√®me </h3><br><p> Commen√ßons donc par identifier le probl√®me.  Imaginez que vous ayez un produit chevronn√© (service Internet), dans lequel plusieurs microservices diff√©rents sont collect√©s.  Chaque microservice de votre syst√®me est une sorte de mini-application int√©gr√©e √† l'architecture g√©n√©rale et r√©solvant certains probl√®mes sp√©cifiques de l'utilisateur du service.  Imaginez que ce matin (le dernier jour du sprint), le propri√©taire du produit appel√© Vasily vous a adress√© la parole et a annonc√©: "Au prochain sprint, nous commencerons √† scier l'importation de donn√©es, ce qui rendra les utilisateurs du service encore plus heureux. Cela permettra √† l'utilisateur de remplir le service imm√©diatement. dense 1C! ". </p><br><p>  Imaginez que vous √™tes un gestionnaire ou un chef d'√©quipe et que vous n'√©coutez pas toutes ces descriptions enthousiastes d'utilisateurs satisfaits d'un point de vue commercial.  Vous estimez combien de travail tout cela exigera.  En bon gestionnaire, vous vous efforcez de r√©duire l'app√©tit de Vasily pour les t√¢ches de notation pour MVP (ci-apr√®s, produit minimum viable).  Dans le m√™me temps, les deux principales exigences de MVP - la capacit√© du syst√®me d'importation √† r√©sister √† une charge importante et √† fonctionner en arri√®re-plan, ne peuvent pas √™tre supprim√©es. </p><br><p>  Vous comprenez que l'approche traditionnelle, lorsque toutes les donn√©es sont trait√©es dans la m√™me demande de l'utilisateur, ne fonctionnera pas.  Ici, vous devez cl√¥turer le jardin de tous les travailleurs de fond.  Vous devrez vous accrocher au bus d'√©v√©nements, r√©fl√©chir au fonctionnement de l'√©quilibreur de charge, de la base de donn√©es distribu√©e, etc.  En g√©n√©ral, tous les plaisirs de l'architecture de microservices.  En cons√©quence, vous concluez que le d√©veloppement du backend pour cette fonctionnalit√© se prolongera, ne vous rendez pas aux diseurs de bonne aventure. </p><br><p>  La question se pose automatiquement: "Que feront les soldats de premi√®re ligne pendant tout ce temps sans API?". </p><br><p>  De plus, il s'av√®re que les donn√©es ne doivent pas √™tre import√©es imm√©diatement.  Vous devez d'abord les valider et laisser l'utilisateur corriger toutes les erreurs trouv√©es.  Il s'av√®re √©galement un workflow astucieux sur le front-end.  Et il est n√©cessaire d'entailler la fonctionnalit√©, comme d'habitude, "hier".  Par cons√©quent, les anciens combattants doivent √™tre en quelque sorte coordonn√©s afin de ne pas se bousculer dans un navet, de ne pas provoquer de conflits et d'en voir calmement chaque morceau (voir KDPV au d√©but de l'article). </p><br><p>  Dans une situation diff√©rente, nous pourrions commencer √† scier de l'arri√®re vers l'avant.  Tout d'abord, impl√©mentez le backend et v√©rifiez qu'il maintient la charge, puis accrochez calmement l'extr√©mit√© avant dessus.  Mais le probl√®me est que les sp√©cifications d√©crivent la nouvelle fonctionnalit√© en termes g√©n√©raux, pr√©sentent des lacunes et des points controvers√©s en termes de convivialit√©.  Mais que se passe-t-il si √† la fin de la mise en ≈ìuvre frontale, il s'av√®re que sous cette forme, la fonctionnalit√© ne satisfera pas l'utilisateur?  Les changements d'utilisabilit√© peuvent n√©cessiter des modifications du mod√®le de donn√©es.  Nous devrons refaire √† la fois l'avant et l'arri√®re, ce qui sera tr√®s cher. </p><br><h3 id="agile-pytaetsya-nam-pomoch">  Agile essaie de nous aider. </h3><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b07/30c/c25/b0730cc25193b2363dbefb3b550d6f39.png"></p><br><p>  Des m√©thodologies flexibles fournissent des conseils judicieux.  "Commencez par la planche √† roulettes et montrez √† l'utilisateur. Soudain, il l'aimera. Si vous l'aimez, continuez dans la m√™me veine, vissez de nouvelles puces." <br>  Mais que se passe-t-il si l'utilisateur a imm√©diatement besoin d'au moins une moto et dans deux √† trois semaines?  Et si pour commencer √† travailler sur la fa√ßade de la moto, vous devez au moins d√©cider des dimensions du moteur et de la taille du ch√¢ssis? </p><br><p>  Comment s'assurer que la mise en ≈ìuvre de la fa√ßade ne soit pas retard√©e tant qu'il n'y a pas de certitude avec les autres couches de l'application? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ba2/5bc/5ad/ba25bc5ad7a863e7623f651f11eb12da.png"></p><br><p>  Dans notre situation, il vaut mieux utiliser une approche diff√©rente.  Il est pr√©f√©rable de commencer imm√©diatement √† faire une fa√ßade (avant) pour vous assurer que l'id√©e initiale de MVP est correcte.  D'une part, faire glisser une fa√ßade d√©corative au propri√©taire du produit Vasily, derri√®re laquelle il n'y a rien, semble √™tre de la triche, une escroquerie.  D'un autre c√¥t√©, nous obtenons ainsi tr√®s rapidement des commentaires sur la partie des fonctionnalit√©s que l'utilisateur rencontrera en premier lieu.  Vous pouvez avoir une architecture incroyablement cool, mais s'il n'y a pas d'utilisation, alors l'application enti√®re sera jet√©e sur le bord de l'application, sans comprendre les d√©tails.  Par cons√©quent, il me semble plus important de donner l'interface utilisateur la plus fonctionnelle le plus rapidement possible, au lieu de synchroniser la progression du front avec le backend.  Il est inutile d'√©mettre une interface utilisateur inachev√©e et un support pour les tests, dont la fonctionnalit√© ne satisfait pas aux exigences principales.  Dans le m√™me temps, l'√©mission de 80% des fonctionnalit√©s d'interface utilisateur requises, mais sans back-end fonctionnel, pourrait bien s'av√©rer rentable. </p><br><h3 id="nemnogo-tehnicheskih-detaley">  Quelques d√©tails techniques </h3><br><p>  J'ai donc d√©j√† d√©crit bri√®vement quelle fonctionnalit√© nous allons mettre en ≈ìuvre.  Ajoutez quelques d√©tails techniques. </p><br><p>  L'utilisateur doit pouvoir t√©l√©charger un fichier de donn√©es volumineux sur le service.  Le contenu de ce fichier doit √™tre dans un format sp√©cifique (par exemple, CSV).  Le fichier doit avoir une certaine structure de donn√©es et certains champs obligatoires ne doivent pas √™tre vides.  En d'autres termes, apr√®s le d√©chargement dans le backend, vous devrez valider les donn√©es.  La validation peut durer un temps consid√©rable.  Vous ne pouvez pas garder la connexion au backend ouverte (elle tombera par timeout).  Par cons√©quent, nous devons accepter rapidement le fichier et commencer le traitement en arri√®re-plan.  √Ä la fin de la validation, nous devons informer l'utilisateur qu'il peut commencer √† √©diter les donn√©es.  L'utilisateur doit corriger les erreurs d√©tect√©es lors de la validation. </p><br><p>  Une fois toutes les erreurs corrig√©es, l'utilisateur clique sur le bouton d'importation.  Les donn√©es corrig√©es sont renvoy√©es au backend.  pour terminer la proc√©dure d'importation.  Nous devons informer le front-end de l'avancement de toutes les √©tapes de l'importation. </p><br><p>  Le moyen le plus efficace d'alerter est WebSockets.  De face, via Websocket avec une certaine p√©riode, des demandes seront envoy√©es pour obtenir l'√©tat actuel du traitement des donn√©es en arri√®re-plan.  Pour le traitement des donn√©es d'arri√®re-plan, nous avons besoin de gestionnaires d'arri√®re-plan, d'une file d'attente de commandes distribu√©e, d'un bus d'√©v√©nements, etc. </p><br><p>  Le flux de donn√©es est vu comme suit (pour r√©f√©rence): </p><br><ol><li>  Gr√¢ce √† l'API du navigateur de fichiers, nous demandons √† l'utilisateur de s√©lectionner le fichier souhait√© sur le disque. </li><li>  Gr√¢ce √† AJAX, nous envoyons le fichier au backend. </li><li>  Nous attendons la fin de la validation et de l'analyse du fichier de donn√©es (nous interrogeons l'√©tat de l'op√©ration en arri√®re-plan via Websocket). </li><li>  Une fois la validation termin√©e, nous chargerons les donn√©es pr√©par√©es pour l'importation et les rendrons dans le tableau de la page d'importation. </li><li>  L'utilisateur modifie les donn√©es, corrige les erreurs.  En cliquant sur le bouton en bas de la page, nous envoyons les donn√©es corrig√©es au backend. </li><li>  Toujours du c√¥t√© client, nous ex√©cutons un sondage p√©riodique de l'√©tat de l'op√©ration en arri√®re-plan. </li><li>  Jusqu'√† la fin de l'importation en cours, l'utilisateur ne devrait pas pouvoir d√©marrer une nouvelle importation (m√™me dans la fen√™tre du navigateur voisin ou sur l'ordinateur voisin). </li></ol><br><h3 id="plan-razrabotki">  Plan de d√©veloppement </h3><br><h4 id="mokap-ui-vs-prototip-ui">  Interface utilisateur Mocap vs.  Interface utilisateur du prototype </h4><br><p><img src="https://habrastorage.org/getpro/habr/post_images/908/3bc/f90/9083bcf90698b20014ec29e4580d3f08.jpg"></p><br><p>  Soulignons imm√©diatement la diff√©rence entre Wireframe, Mockup, Prototype. </p><br><p>  L'image ci-dessus montre le filaire.  Ce n'est qu'un dessin (en chiffres ou sur papier - peu importe).  Les deux autres concepts sont plus compliqu√©s. </p><br><p>  Mocap est une forme de pr√©sentation de la future interface qui n'est utilis√©e qu'en tant que pr√©sentation et sera par la suite compl√®tement remplac√©e.  Ce formulaire sera archiv√© comme √©chantillon √† l'avenir.  L'interface r√©elle se fera √† l'aide d'autres outils.  Un mocap peut √™tre fait dans un √©diteur de vecteur avec suffisamment de d√©tails de conception, mais les d√©veloppeurs frontaux le mettront simplement de c√¥t√© et le regarderont comme un mod√®le.  Mocap peut √™tre cr√©√© m√™me dans des constructeurs de navigateurs sp√©cialis√©s et est livr√© avec une interactivit√© limit√©e.  Mais son sort est inchang√©.  Il deviendra un mod√®le dans l'album Design Guide. </p><br><p>  Le prototype est cr√©√© √† l'aide des m√™mes outils que la future interface utilisateur (par exemple, React).  Le code prototype est h√©berg√© dans le r√©f√©rentiel d'applications g√©n√©ral.  Il ne sera pas remplac√©, comme c'est le cas avec mocap.  Tout d'abord, il est utilis√© pour tester le concept (Proof of Concept, PoC).  Ensuite, s'il r√©ussit le test, ils commenceront √† le d√©velopper, en le transformant progressivement en une interface utilisateur √† part enti√®re. </p><br><p>  Maintenant plus pr√®s du point ... </p><br><p>  Imaginez que des coll√®gues de l'atelier de conception nous ont pr√©sent√© des artefacts de leur processus cr√©atif: des maquettes de la future interface.  Notre t√¢che est de planifier le travail de mani√®re √† rendre le plus rapidement possible le travail parall√®le des anciens combattants. </p><br><p>  Comme la compilation de l'algorithme commence par un organigramme, nous commen√ßons la cr√©ation d'un prototype avec un filaire minimaliste (voir la figure ci-dessus).  Sur ce Wireframe, nous divisons les fonctionnalit√©s futures en gros blocs.  Le principe principal ici est de focaliser la responsabilit√©.  Vous ne devez pas diviser un √©l√©ment de fonctionnalit√© en diff√©rents blocs.  Les mouches vont dans un bloc et les c√¥telettes dans un autre. </p><br><p>  Ensuite, vous devez cr√©er une page vierge (factice) d√®s que possible, configurer le routage et placer un lien vers cette page dans le menu.  Ensuite, vous devez cr√©er des blancs pour les composants de base (un pour chaque bloc dans le prototype Wireframe).  Et pour alimenter ce cadre particulier dans la branche de d√©veloppement d'une nouvelle fonctionnalit√©. </p><br><p>  Nous obtenons la hi√©rarchie de branches suivante dans git: </p><br><pre><code class="plaintext hljs">master ---------------------- &gt; ‚îî feature/import-dev ------ &gt;</code> </pre> <br><p>  La branche "import-dev" jouera le r√¥le de brunch de d√©veloppement pour l'ensemble de la fonctionnalit√©.  Il est conseill√© de fixer une personne responsable (mainteneur) dans cette branche qui tient en parall√®le les changements atomiques de tous les coll√®gues travaillant sur la fonctionnalit√©.  Il est √©galement conseill√© de ne pas effectuer de commits directs sur cette branche afin de r√©duire les risques de conflits et de changements inattendus lors de fusions dans cette branche de demandes d'attraction atomique. </p><br><p>  Parce que  √Ä ce moment, nous avons d√©j√† cr√©√© des composants pour les blocs principaux de la page, puis vous pouvez imm√©diatement cr√©er des branches distinctes pour chaque bloc d'interface utilisateur.  La hi√©rarchie finale peut ressembler √† ceci: </p><br><pre> <code class="plaintext hljs">master ----------------------- &gt; ‚îî feature/import-dev ------- &gt; ‚îú feature/import-head ---- &gt; ‚îú feature/import-filter -- &gt; ‚îú feature/import-table --- &gt; ‚îú feature/import-pager --- &gt; ‚îî feature/import-footer -- &gt;</code> </pre> <br><p>  <strong>Remarque:</strong> <em>peu importe √† quel moment cr√©er ces brunchs atomiques et la convention de d√©nomination pr√©sent√©e ci-dessus n'est pas la seule appropri√©e.</em>  <em>Le brunch peut √™tre cr√©√© imm√©diatement avant le d√©but des travaux.</em>  <em>Et les noms des brunchs doivent √™tre clairs pour tous les participants au d√©veloppement.</em>  <em>Le nom doit √™tre aussi court que possible et en m√™me temps indiquer explicitement de quelle partie de la fonctionnalit√© la branche est responsable.</em> </p><br><p>  Par l'approche d√©crite ci-dessus, nous garantissons le fonctionnement sans conflit de plusieurs d√©veloppeurs d'interface utilisateur.  Chaque fragment d'interface utilisateur a son propre r√©pertoire dans la hi√©rarchie du projet.  Le catalogue de fragments contient le composant principal, son ensemble de styles et son propre ensemble de composants enfants.  Chaque fragment peut √©galement avoir son propre gestionnaire d'√©tat (MobX, Redux, Parties VueX).  Peut-√™tre que les composants du fragment utilisent certains styles globaux.  Cependant, la modification des styles globaux lors du d√©veloppement d'un fragment d'une nouvelle page est interdite.  Changer le comportement et le style par d√©faut de l'atome g√©n√©ral du design n'en vaut pas la peine. </p><br><p>  <strong>Remarque:</strong> <em>¬´atome de conception¬ª signifie un √©l√©ment de l'ensemble des composants standard de notre service - voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conception atomique</a> ;</em>  <em>dans notre cas, on suppose que le syst√®me de conception atomique a d√©j√† √©t√© impl√©ment√©.</em> </p><br><p>  Nous avons donc physiquement s√©par√© les soldats de premi√®re ligne les uns des autres.  D√©sormais, chacun peut travailler tranquillement, sans crainte de conflits avec la fusion.  De plus, n'importe qui peut √† tout moment cr√©er une demande de pull depuis sa branche dans <strong>feature / import-dev</strong> .  D√©j√† maintenant, il est possible de lancer calmement du contenu statique et m√™me de former des √©l√©ments interactifs dans un seul stockage d'√©tat. </p><br><p>  Mais comment s'assurer que les fragments d'interface utilisateur peuvent interagir les uns avec les autres? </p><br><p>  Nous devons impl√©menter le lien entre les fragments.  Le service JS, agissant comme une passerelle pour l'√©change de donn√©es avec le support, convient au r√¥le de lien entre les fragments.  Gr√¢ce au m√™me service, vous pouvez impl√©menter la notification des √©v√©nements.  En souscrivant √† certains √©v√©nements, les fragments incluront implicitement le cycle de vie global du microservice.  Les modifications apport√©es aux donn√©es d'un fragment n√©cessiteront de mettre √† jour l'√©tat d'un autre fragment.  En d'autres termes, nous avons fait l'int√©gration de fragments √† travers des donn√©es et un mod√®le d'√©v√©nement. </p><br><p>  Pour cr√©er ce service, nous avons besoin d'une branche suppl√©mentaire dans git: </p><br><pre> <code class="plaintext hljs">master --------------------------- &gt; ‚îî feature/import-dev ----------- &gt; ‚îú feature/import-js-service -- &gt; ‚îú feature/import-head -------- &gt; ‚îú feature/import-filter ------ &gt; ‚îú feature/import-table ------- &gt; ‚îú feature/import-pager ------- &gt; ‚îî feature/import-footer ------ &gt;</code> </pre> <br><p>  <strong>Remarque:</strong> <em>n'ayez pas peur du nombre de branches et n'h√©sitez pas √† produire des branches.</em>  <em>Git vous permet de travailler efficacement avec un grand nombre de succursales.</em>  <em>Lorsqu'une habitude se d√©veloppe, il devient facile de se ramifier:</em> </p><br><pre> <code class="plaintext hljs">$/&gt; git checkout -b feature/import-service $/&gt; git commit . $/&gt; git push origin HEAD $/&gt; git checkout feature/import-dev $/&gt; git merge feature/import-service</code> </pre> <br><p>  <em>Cela peut sembler tendu pour certains, mais le b√©n√©fice de la minimisation des conflits est plus important.</em>  <em>De plus, pendant que vous √™tes le propri√©taire exclusif de la branche, vous pouvez <strong>pousser -f en</strong> toute s√©curit√© sans risquer d'endommager l'historique local des commits de quelqu'un.</em> </p><br><h4 id="feykovye-dannye">  Fake data </h4><br><p>  Ainsi, √† l'√©tape pr√©c√©dente, nous avons pr√©par√© le service d'int√©gration JS (importService) et pr√©par√© les fragments d'interface utilisateur.  Mais sans donn√©es, notre prototype ne fonctionnera pas.  Rien n'est dessin√© sauf pour les d√©corations statiques. </p><br><p>  Nous devons maintenant d√©cider d'un mod√®le de donn√©es approximatif et cr√©er ces donn√©es sous forme de fichiers JSON ou JS (le choix en faveur de l'un ou l'autre d√©pend des param√®tres d'importation de votre projet; est configur√© json-loader).  Notre importService, ainsi que ses tests (nous y r√©fl√©chirons plus tard), importent de ces fichiers les donn√©es n√©cessaires pour simuler les r√©ponses d'un vrai backend (il n'a pas encore √©t√© impl√©ment√©).  O√π placer ces donn√©es n'est pas important.  L'essentiel est qu'ils peuvent √™tre facilement import√©s dans importService lui-m√™me et test√©s dans notre microservice. </p><br><p>  Il est conseill√© de discuter imm√©diatement du format des donn√©es, de la convention de d√©nomination des champs avec les d√©veloppeurs de l'arri√®re.  Vous pouvez, par exemple, accepter d'utiliser un format conforme √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification OpenAPI</a> .  Quelles que soient les sp√©cifications du format de support qui suivent, nous cr√©ons de fausses donn√©es en conformit√© exacte avec le format de donn√©es de support. </p><br><p>  <strong>Remarque:</strong> <em>n'ayez pas peur de vous tromper avec le faux mod√®le de donn√©es;</em>  <em>Votre t√¢che consiste √† cr√©er une version pr√©liminaire du contrat de donn√©es, qui sera ensuite convenue avec les d√©veloppeurs backend.</em> </p><br><h4 id="kontrakty">  Contrats </h4><br><p>  Les fausses donn√©es peuvent √™tre un bon d√©but pour commencer √† travailler sur la sp√©cification de la future API dans le back-end.  Et ici, peu importe qui et comment la qualit√© met en ≈ìuvre le projet de mod√®le.  Crucial est la discussion et la coordination conjointes avec la participation des d√©veloppeurs avant et arri√®re. </p><br><p>  Vous pouvez utiliser des outils sp√©cialis√©s pour d√©crire les contrats (sp√©cifications API).  Par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenAPI / Swagger</a> .  Dans le bon sens, lors de la description d'une API avec un tel outil, il n'est pas n√©cessaire que tous les d√©veloppeurs soient pr√©sents.  Cela peut √™tre fait par un d√©veloppeur (√©diteur de sp√©cifications).  Le r√©sultat d'une discussion collective sur la nouvelle API devait √™tre des artefacts comme MFU (Meeting Follow Up), selon lesquels l'√©diteur de sp√©cifications construit √©galement une r√©f√©rence pour la future API. </p><br><p>  √Ä la fin du projet de sp√©cification, la v√©rification de l'exactitude ne devrait pas prendre longtemps.  Chaque participant √† la discussion collective pourra, ind√©pendamment des autres, effectuer une inspection rapide pour v√©rifier que son avis a bien √©t√© pris en compte.  Si quelque chose semble incorrect, il sera possible de clarifier les sp√©cifications de l'√©diteur (communications de travail normales).  Si tout le monde est satisfait de la sp√©cification, elle peut √™tre publi√©e et utilis√©e comme documentation pour le service. </p><br><h4 id="yunit-testirovanie">  Tests unitaires </h4><br><p>  <strong>Remarque:</strong> <em>Pour moi, la valeur des tests unitaires est assez faible.</em>  <em>Ici, je suis d'accord avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David Heinemeier Hansson @ RailsConf</a> .</em>  <em>"Les tests unitaires sont un excellent moyen de s'assurer que votre programme fait ce que vous pouvez faire ... comme pr√©vu."</em>  <em>Mais j'admets des cas particuliers o√π les tests unitaires apportent beaucoup d'avantages.</em> </p><br><p>  Maintenant que nous avons d√©cid√© des fausses donn√©es, nous pouvons commencer √† tester les fonctionnalit√©s de base.  Pour tester les composants frontaux, vous pouvez utiliser des outils tels que karma, jest, mocha, chai, jasmine.  Habituellement, le fichier avec le m√™me nom avec le suffixe "spec" ou "test" est plac√© √† c√¥t√© de la ressource JS sous test: </p><br><pre> <code class="plaintext hljs">importService ‚îú importService.js ‚îî importService.test.js</code> </pre> <br><p>  La valeur sp√©cifique du suffixe d√©pend des param√®tres du collecteur de packages JS dans votre projet. </p><br><p>  Bien s√ªr, dans une situation o√π le dos est dans un √©tat ¬´contraceptif¬ª, il est tr√®s difficile de couvrir tous les cas possibles par des tests unitaires.  Mais le but des tests unitaires est un peu diff√©rent.  Ils sont con√ßus pour tester le fonctionnement de pi√®ces logiques individuelles. </p><br><p>  Par exemple, il est bon de couvrir diff√©rents types d‚Äôaides avec des tests unitaires, √† travers lesquels des √©l√©ments de logique ou certains algorithmes sont partag√©s entre les composants et les services JS.  En outre, ces tests peuvent couvrir le comportement des composants et des magasins de MobX, Redux, VueX en r√©ponse aux modifications des donn√©es utilisateur. </p><br><h4 id="integracionnoe-i-e2e-testirovanie">  Int√©gration et tests E2E </h4><br><p>  Les tests d'int√©gration signifient la v√©rification du comportement du syst√®me pour la conformit√© avec la sp√©cification.  C'est-√†-dire  il est v√©rifi√© que l'utilisateur verra exactement le comportement d√©crit dans les sp√©cifications.  Il s'agit d'un niveau de test plus √©lev√© que les tests unitaires. </p><br><p>  Par exemple, un test qui v√©rifie une erreur dans le champ obligatoire lorsque l'utilisateur a effac√© tout le texte.  Ou un test qui v√©rifie qu'une erreur est g√©n√©r√©e lors de la tentative de sauvegarde de donn√©es non valides. </p><br><p>  Les tests E2E (End-to-End) fonctionnent √† un niveau encore plus √©lev√©.  Ils v√©rifient que le comportement de l'interface utilisateur est correct.  Par exemple, en v√©rifiant qu'apr√®s l'envoi du fichier de donn√©es au service, l'utilisateur voit une torsion qui signale un processus asynchrone continu.  Ou v√©rifiez que la visualisation des composants standards du service correspond aux guides des concepteurs. </p><br><p>  Ce type de test fonctionne avec un cadre d'automatisation d'interface utilisateur.  Par exemple, il pourrait s'agir de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©l√©nium</a> .  Ces tests ainsi que Selenium WebDriver s'ex√©cutent dans certains navigateurs (g√©n√©ralement Chrome avec le "mode sans t√™te").  Ils travaillent depuis longtemps, mais r√©duisent le fardeau des sp√©cialistes de l'AQ, en faisant un test de fum√©e pour eux. </p><br><p>  L'√©criture de ces types de tests prend beaucoup de temps.  Le plus t√¥t nous commencerons √† les √©crire, mieux ce sera.  Malgr√© le fait que nous n'avons pas de sauvegarde √† part enti√®re, nous pouvons d√©j√† commencer √† d√©crire les tests d'int√©gration.  Nous avons d√©j√† une sp√©cification. </p><br><p>  Avec une description de l'E2E, il y a encore moins de tests d'obstacles.  Nous avons d√©j√† esquiss√© les composants standard de la biblioth√®que d'atomes de conception.  Impl√©mentation d'√©l√©ments sp√©cifiques de l'interface utilisateur.  Rendu interactif en plus de fausses donn√©es et API dans importService.  Rien ne vous emp√™che de d√©marrer l'automatisation de l'interface utilisateur, au moins pour les cas de base. </p><br><p>  En √©crivant ces tests, vous pouvez √† nouveau d√©router les d√©veloppeurs individuels s'il n'y a pas de gens d√©concert√©s.  Et aussi pour d√©crire les tests, vous pouvez cr√©er une branche distincte (comme d√©crit ci-dessus).  Dans les branches pour les tests, il sera n√©cessaire de mettre √† jour p√©riodiquement les mises √† jour de la branche " <strong>feature / import-dev</strong> ". </p><br><p>  La s√©quence g√©n√©rale des fusions sera la suivante: </p><br><ol><li>  Par exemple, un d√©veloppeur de la branche " <strong>feature / import-filter</strong> " a cr√©√© un PR.  Ce PR est pr√©visualis√© et le mainteneur de la branche " <strong>feature / import-dev</strong> " injecte ce PR. </li><li>  Le responsable annonce que la mise √† jour a √©t√© vers√©e. </li><li>  Le d√©veloppeur de la branche " <strong>feature / import-tests-e2e</strong> " tire des changements extr√™mes avec la fusion de la branche "-dev. </li></ol><br><h4 id="ci-i-avtomatizaciya-testirovaniya">  CI et automatisation des tests </h4><br><p>  Les tests frontaux sont impl√©ment√©s √† l'aide d'outils qui fonctionnent via la CLI.  Dans package.json, les commandes sont √©crites pour ex√©cuter diff√©rents types de tests.  Ces commandes ne sont pas uniquement utilis√©es par les d√©veloppeurs dans l'environnement local.  Ils sont √©galement n√©cessaires pour ex√©cuter des tests dans l'environnement CI (int√©gration continue). </p><br><p>  Si maintenant nous ex√©cutons la construction dans CI et qu'il n'y a pas d'erreur, alors notre prototype tant attendu sera livr√© √† l'environnement de test (80% des fonctionnalit√©s √† l'avant avec un back-end non encore impl√©ment√©).  Nous pouvons montrer √† Vasily le comportement approximatif du futur microservice.  Vasiliy lance ce prototype et, peut-√™tre, fera quelques remarques (peut-√™tre m√™me s√©rieuses).  √Ä ce stade, faire des ajustements n'est pas cher.  Dans notre cas, le support n√©cessite de s√©rieux changements architecturaux, donc le travail peut √™tre plus lent que sur le devant.  Tant que le soutien n'est pas finalis√©, les modifications du plan de d√©veloppement n'entra√Æneront pas de cons√©quences d√©sastreuses.  Si n√©cessaire, changez quelque chose √† ce stade, nous vous demanderons de faire des ajustements √† la sp√©cification API (en swagger).  Apr√®s cela, les √©tapes d√©crites ci-dessus sont r√©p√©t√©es.  Les travailleurs de premi√®re ligne ne d√©pendent toujours pas des backends.  Les sp√©cialistes du frontend sont ind√©pendants les uns des autres. </p><br><h4 id="bekenda-kontrollery-zaglushki">  Backend.  Contr√¥leurs de talon </h4><br><p>  Le point de d√©part pour d√©velopper l'API dans le back-end est la sp√©cification approuv√©e de l'API ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenAPI / Swagger</a> ).  S'il existe une sp√©cification, le support deviendra √©galement plus facile √† parall√©liser.  L'analyse de la sp√©cification devrait conduire les d√©veloppeurs √† r√©fl√©chir aux √©l√©ments de base de l'architecture.  Quels composants / services communs vous devez cr√©er avant de proc√©der √† la mise en ≈ìuvre des appels API individuels.  Et l√† encore, vous pouvez appliquer l'approche comme avec des blancs pour l'interface utilisateur. </p><br><p>  Nous pouvons commencer par le haut, c'est-√†-dire  de la couche externe de notre dos (des contr√¥leurs).  √Ä ce stade, nous commen√ßons par le routage, les blancs du contr√¥leur et les fausses donn√©es.  La couche de services (BL) et d'acc√®s aux donn√©es (DAL) nous ne le faisons pas encore.  Nous transf√©rons simplement les donn√©es de JS vers le backend et programmons les contr√¥leurs afin qu'ils impl√©mentent les r√©ponses attendues pour les cas de base, en distribuant des morceaux √† partir des fausses donn√©es. </p><br><p>  √Ä la fin de cette √©tape, les soldats de premi√®re ligne devraient obtenir un backend fonctionnel sur les donn√©es de test statiques.  De plus, ce sont pr√©cis√©ment les donn√©es sur lesquelles les soldats de premi√®re ligne √©crivent les tests d'int√©gration.  En principe, √† ce moment, il ne devrait pas √™tre difficile de commuter la passerelle JS (importService) pour utiliser des blancs de contr√¥leur √† l'arri√®re. </p><br><p>  La partie r√©ponse pour les demandes via Websocket n'est pas conceptuellement diff√©rente des contr√¥leurs d'API Web.  Nous faisons √©galement cette ¬´r√©ponse¬ª sur les donn√©es de test et nous connectons importService √† cette pr√©paration. </p><br><p>  En fin de compte, tous les JS doivent √™tre transf√©r√©s pour fonctionner avec un vrai serveur. </p><br><h4 id="bekend-finalizaciya-kontrollerov-zaglushki-v-dao">  Backend.  Finalisation des contr√¥leurs.  Bouts DAO </h4><br><p>  C'est maintenant au tour de finaliser la couche de support externe.  Pour les contr√¥leurs, les services sont impl√©ment√©s un par un en BL.  D√©sormais, les services fonctionneront avec de fausses donn√©es.  L'ajout √† ce stade est que dans les services, nous impl√©mentons d√©j√† une v√©ritable logique m√©tier.  √Ä ce stade, il est conseill√© de commencer √† ajouter de nouveaux tests conform√©ment √† la logique m√©tier des sp√©cifications.  Il est important qu'aucun test d'int√©gration ne tombe. </p><br><p>  <strong>Remarque:</strong> nous ne d√©pendons toujours pas de l'impl√©mentation du sch√©ma de donn√©es dans la base de donn√©es. </p><br><h4 id="bekend-finalizaciya-dao-realnaya-bd">  Backend.  Finalisez DAO.  R√©el db </h4><br><p>  Une fois le sch√©ma de donn√©es impl√©ment√© dans la base de donn√©es, nous pouvons y transf√©rer les donn√©es de test des √©tapes pr√©c√©dentes et basculer notre DAL rudimentaire pour qu'il fonctionne avec le vrai serveur de base de donn√©es.  Parce que  nous transf√©rons les donn√©es initiales cr√©√©es pour le front dans la base de donn√©es, tous les tests doivent rester pertinents.  Si l'un des tests √©choue, alors quelque chose s'est mal pass√© et vous devez comprendre. </p><br><p>  <strong>Remarque:</strong> <em>en g√©n√©ral, avec une probabilit√© tr√®s √©lev√©e de travailler avec le sch√©ma de donn√©es dans la base de donn√©es, il y aura peu pour une nouvelle fonctionnalit√©;</em>  <em>peut-√™tre que des modifications √† la base de donn√©es seront apport√©es simultan√©ment avec la mise en ≈ìuvre des services en BL.</em> </p><br><p>  √Ä la fin de cette √©tape, nous obtenons un microservice complet, version alpha.  Cette version peut d√©j√† √™tre montr√©e aux utilisateurs internes (Product Owner, un technologue de produit ou quelqu'un d'autre) pour √©valuation en tant que MVP. </p><br><p>  Les it√©rations standard d'Agile sur le travail de correction des bogues, l'impl√©mentation de puces suppl√©mentaires et le polissage final continueront. </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p>  Je pense que vous ne devriez pas utiliser aveugl√©ment ce qui pr√©c√®de comme guide d'action.  Vous devez d'abord essayer et vous adapter √† votre projet.  L'approche d√©crite ci-dessus est capable de d√©lier les d√©veloppeurs individuels les uns des autres et de leur permettre de travailler en parall√®le dans certaines conditions.  Tous les gestes avec brunch et transfert de donn√©es, l'impl√©mentation de blancs sur les fausses donn√©es semblent √™tre un surco√ªt important.  Le b√©n√©fice de ces frais g√©n√©raux appara√Æt en raison d'une concurrence accrue.  Si l'√©quipe de d√©veloppement est compos√©e <del>  un creuseur et demi </del>  deux piles compl√®tes ou un freotovik avec un back-end, il y aura probablement beaucoup de profit de cette approche.  Bien que dans cette situation, certains points pourraient bien accro√Ætre l'efficacit√© du d√©veloppement. </p><br><p>  Le b√©n√©fice de cette approche appara√Æt lorsque, au tout d√©but, nous impl√©mentons rapidement des pi√®ces aussi proches que possible de la future impl√©mentation r√©elle et s√©parons physiquement le travail sur diff√©rentes parties au niveau de la structure des fichiers dans le projet et au niveau du syst√®me de gestion de code (git). </p><br><p>  J'esp√®re que cet article vous a √©t√© utile. </p><br><p>  Merci de votre attention! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463067/">https://habr.com/ru/post/fr463067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463055/index.html">√Ä propos des administrateurs, des devops, de la confusion sans fin et de la transformation DevOps au sein de l'entreprise</a></li>
<li><a href="../fr463057/index.html">Yii Framework 2 Droits personnalis√©s</a></li>
<li><a href="../fr463059/index.html">Trois vies en informatique et pas seulement</a></li>
<li><a href="../fr463061/index.html">R√®gles de pr√©paration des mises en page dans Figma</a></li>
<li><a href="../fr463063/index.html">Nous traitons les interfaces dans Go</a></li>
<li><a href="../fr463069/index.html">Guide anim√© React Basic</a></li>
<li><a href="../fr463071/index.html">Quel impact les pannes Internet ont-elles?</a></li>
<li><a href="../fr463073/index.html">QUIC en action: comment Uber l'a mis en ≈ìuvre pour optimiser les performances</a></li>
<li><a href="../fr463075/index.html">Nouvelles licences Open Source</a></li>
<li><a href="../fr463083/index.html">Prot√©ger les sauvegardes iPhone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>