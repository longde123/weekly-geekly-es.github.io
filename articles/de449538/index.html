<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÖ üîê üéº Verschieben des Webportals: vom Monolithen zur Microservice-Architektur üë®üèº‚Äç‚úàÔ∏è üíΩ üê†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir teilen die Erfahrung mit der Modernisierung der Architektur des Webportals, die es erm√∂glicht hat, das Produkt bequem, stabil und fehlertolerant z...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verschieben des Webportals: vom Monolithen zur Microservice-Architektur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/449538/">  Wir teilen die Erfahrung mit der Modernisierung der Architektur des Webportals, die es erm√∂glicht hat, das Produkt bequem, stabil und fehlertolerant zu machen: Der Datenverkehr stieg von 350.000 auf 7 Millionen Benutzer!  Die Geschichte wird f√ºr diejenigen n√ºtzlich sein, die planen, ihr Produkt zu erweitern.  Zun√§chst werden wir untersuchen, welche Faktoren die Arbeit und Entwicklung des Webportals beeintr√§chtigen k√∂nnen: <a name="habracut"></a><br><br><ul><li>  <b>Veralterung.</b>  Der Usability-Ansatz, die Anpassung an verschiedene Ger√§te, das elementare Erscheinungsbild und die Struktur entsprechen im Laufe der Zeit nicht mehr den Bed√ºrfnissen des Publikums. </li><li>  <b>Technologische Veralterung.</b>  Webstandards und -technologien werden st√§ndig weiterentwickelt.  √Ñnderungen wirken sich sowohl auf Entwicklertools (z. B. Frameworks, Datenbanken, andere Software) als auch auf die grundlegenden Grundlagen des Webs aus.  Seit relativ kurzer Zeit - ein massiver √úbergang von http zu https und die Aufgabe der Unterst√ºtzung f√ºr Legacy-DNS. <br></li><li>  <b>Fehler und Abst√ºrze.</b>  Entwickler k√∂nnen ihre Aufgabe unvollkommen bew√§ltigen und Fehler zulassen.  Infolgedessen k√∂nnen Verst√∂√üe gegen die Site auftreten - beginnend mit der Tatsache, dass die Schaltfl√§chen beim ersten Mal nicht funktionieren, bis die Systeme vollst√§ndig ausfallen. <br></li></ul><br>  <b>Fall</b> <br><br>  Wir wurden von einem Kunden angesprochen, dessen Webportal weiterentwickelt werden musste.  Zu einem bestimmten Zeitpunkt wurde jeden Monat eine Obergrenze von 350.000 Besuchern erreicht.  Dies schien unzureichend zu sein - das Projekt hatte eindeutig Perspektiven, und wir mussten herausfinden, was genau einer weiteren Skalierung der Ressource im Wege stand. <br><br>  <b>Audit</b> <br><br>  Es stellte sich heraus, dass die alte Bitrix-Engine nicht an Lasten und Skalierungen angepasst war.  Jede einzelne Komponente des Systems kreuzte sich eng und war voneinander abh√§ngig.  Das st√§ndige Beheben von Fehlern war eine so qualvolle Aufgabe, dass wir eine flexible und verst√§ndliche Microservice-Architektur vorschlugen.  In ihnen ist jede Komponente unabh√§ngig genug, damit die darin enthaltenen Fehler die verbleibenden Elemente des Systems nicht ‚Äûverletzen‚Äú. <br><br>  Bitrix blieb die Basis der Architektur - zumindest ist die Autorisierung daran gebunden, aber wo es m√∂glich war und gro√üe Effizienz versprach, haben wir die Funktionalit√§t auf Microservices √ºbertragen.  Sie wurden zum Eckpfeiler des Projekts. <br><br>  Die neue kombinierte Architektur hat uns einen stabilen, schnelleren Betrieb der Systeme und eine nahezu vollst√§ndige Fehlerfreiheit bei einigen Modulen erm√∂glicht.  Es diente auch als Grundlage f√ºr die effektive Arbeit der Vermarkter.  Dank der verbesserten Architektur gelang es den Werbespezialisten, die Pr√§senz der Ressource um das 20-fache zu erh√∂hen. <br><br><img src="https://habrastorage.org/webt/7d/bt/kv/7dbtkvfsxywcnuakaw_wdu92ebs.jpeg"><br><br>  <b>Microservices</b> <br><br>  In eigenst√§ndigen Microservices haben wir Module wie einen Dateilader, eine Suche und einen Newsfeed unterschieden.  Neben diesen benutzerfreundlichen und offensichtlichen Dingen wurden viele andere Funktionselemente in Form von Microservices implementiert: <br><br><ul><li>  Entladen, Speichern und Verwalten von Daten aus Open Source-Projekten; </li><li>  Dynamische Erstellung von RSS-Feeds; </li><li>  Dynamische Erstellung eines Blocksystems, Anordnung der Materialien aller Dienstleistungen zu Strukturbl√∂cken; </li><li>  Hinzuf√ºgen zus√§tzlicher Daten zu Servicematerialien; </li><li>  Technischer Support; </li><li>  Ein einziger Katalog verschiedener Daten. </li></ul><br>  Zus√§tzlich zu all dem haben wir viele Microservices f√ºr die bequeme Arbeit mit dem Admin-Panel erstellt. <br><br><img src="https://habrastorage.org/webt/mx/7t/e-/mx7te-grrfkdfydja2xll-yjc-w.png"><br><br>  Jeder Funktionsblock der Site ist zu einer ziemlich autonomen Einheit geworden.  Zum Laden und Rendern wird ein dedizierter Prozess verwendet, um die √úberschneidung mit anderen Diensten zu minimieren. <br><br>  Wenn ein Benutzer eine Zahlung vornimmt, m√∂chte er nicht lange auf das Laden des Skripts warten, das f√ºr die Wiedergabe des nicht ben√∂tigten Videos in einem anderen Teil der Seite verantwortlich ist.  In der Tat geschieht dies in monolithischen Systemen - Nebenfunktionen beeintr√§chtigen manchmal die Arbeit wirklich wichtiger Komponenten. <br><br>  Wir haben den ersten Schritt getan und sowohl Benutzern als auch Entwicklern das Leben erleichtert und mehr als 20 neue Dienste pro Jahr ver√∂ffentlicht.  Ergebend: <br><br><ul><li>  Wir haben das Problem der Skalierung gel√∂st. </li><li>  Implementierung eines effizienteren Entwicklungsprozesses durch verteilte Teams. </li><li>  Richten Sie ein dynamisches Ressourcenmanagement f√ºr einen reibungslosen und schnellen Systembetrieb ein. </li></ul><br><br>  <b>Technologie-Stack-Upgrade</b> <br><br>  Parallel dazu haben wir den Technologie-Stack aktualisiert.  Wenn das Portal urspr√ºnglich auf PHP 5.6 und MySQL 5.6 basierte, haben wir es im Zuge der Verbesserung der Engine auf PHP 7.0 und MySQL 5.7 umgestellt.  Implementierung des Yii2-Frameworks, Bereitstellung von Memcache-Caching. <br><br><img src="https://habrastorage.org/webt/zc/zb/6b/zczb6baxnrskcroqim0i0ry1dt8.jpeg"><br><br>  <b>Aufgabenwarteschlange</b> <br><br>  Um Aufgaben besser parallelisieren zu k√∂nnen, haben wir Web-Worker - interne Handler - in die RabbitMQ-Warteschlange √ºbertragen.  Es optimiert die Reihenfolge der ausl√∂senden Ereignisse, wodurch das System entlastet wird.  Die Arbeit mit der Website ist viel schneller und komfortabler geworden. <br><br>  <b>Kontinuierliche Integration</b> <br><br>  Mit GitLab CI wird ein transparenter und verwaltbarer Entwicklungsprozess unterst√ºtzt.  Dies ist eine wirklich kontinuierliche, nahtlose Entwicklung, bei der Programmierer und Tester mehr Zeit f√ºr wichtige Fragen haben, anstatt L√∂cher zu flicken. <br><br>  Um Fehler zu minimieren, haben wir zus√§tzliche Entwicklungsschleifen eingef√ºhrt.  Die Kette besteht aus mehreren Testschleifen f√ºr Anwendungen und Infrastrukturen: Pre-Release, in dem die neuesten Assembly-Tests (Pre-Prod), Combat (Prod), mehrere Testschleifen zum gleichzeitigen Testen mehrerer Builds sowie eine Schleife f√ºr Entwickler durchgef√ºhrt werden. <br><br>  <b>Montagesystem</b> <br><br>  In der Anfangsphase werden Builds aus den Projektquellen erstellt.  Anstelle eines unterschiedlichen Satzes von Klassen, Stilen und Handlern werden kombinierte Entit√§ten verwendet - jeweils in der Shell einer ausf√ºhrbaren Datei.  In der Assembly werden nur die erforderlichen Konstruktionen platziert, um Ereignisse auf der Seite auszuf√ºhren.  Dies bietet zus√§tzlich Flexibilit√§t und Geschwindigkeit der Site. <br><br>  <b>Fehler√ºberwachung</b> <br><br>  GitLab CI bietet erweiterte Funktionen f√ºr die Code√ºberpr√ºfung und das automatisierte Testen.  Bei der geringsten Abweichung von Assemblys mit den angegebenen Parametern benachrichtigt das System die Entwickler und erlaubt nicht, den weiteren Prozess der Komponentenimplementierung zu starten, bis Fehler behoben sind.  Zus√§tzlich haben wir Sentry installiert, ein vollst√§ndiges Tool zur Fehler√ºberwachung. <br><br><img src="https://habrastorage.org/webt/it/ut/p8/itutp8xvbdiiouv1swb1idprlxe.png"><br><br>  <b>Prozessoptimierung</b> <br><br>  Um das System auf einem hohen Leistungsniveau zu halten, haben wir Gesch√§ftsprozesse und Infrastruktur konsequent optimiert.  Gemeinsame Bibliotheken und Prototypen von Diensten wurden zur Grundlage f√ºr die schnelle Implementierung neuer Funktionen - wir nehmen vorgefertigte Vorlagen und erhalten in kurzer Zeit ein funktionierendes Produkt. <br><br>  <b>√úberwachung und Betrieb</b> <br><br>  Alle Prozesse sind in voller Sicht.  √úberwachung des Status jedes Knotens bieten wir Zabbix - ein umfassendes Tracking-System.  Wir hatten die M√∂glichkeit, in den Kern der Projektstruktur zu schauen und sie kompakt zu sehen. <br><br>  Wir haben auch die Grafana-Plattform verbunden, die trockene Daten f√ºr die Mitarbeiter der Kunden in ein visuelles Dashboard verwandelt. <br><br>  <b>Stabilisierung und Refactoring</b> <br><br>  Bei Bedarf haben wir das System √ºberarbeitet - der Code wird vereinfacht und pr√§gnant.  Gleichzeitig gibt es immer Raum zum Wachsen, da das regelm√§√üige Dotieren von Systemen den Standort beschleunigt.  Infolgedessen ist die Ressource f√ºr Suchmaschinen und Benutzer benutzerfreundlicher geworden. <br><br>  <b>Neue Architektur ist die Basis f√ºr Wachstum</b> <br><br>  Zu Beginn der Arbeit hatte die Ressource ein bescheidenes Werbepotential und war f√ºr Kunden nicht bequem genug, was die Gesch√§ftsprozesse des Unternehmens behinderte.  Um den Prozess der Benutzerinteraktion mit der Site zu verbessern, haben wir die Portalarchitektur und ihre Struktur fast vollst√§ndig aktualisiert und einen flexiblen Mechanismus geschaffen, der dank unserer eigenen API in eine gro√üe Anzahl von Diensten und Anwendungen integriert werden kann.  Viele Dienste arbeiten seit mehr als einem Jahr optimal, ohne dass Eingriffe erforderlich sind - die Anzahl der Fehler in ihrer Arbeit ist auf nahezu Null gesunken. <br><br>  Die neue Site ist ein leistungsstarkes Tool f√ºr die Gesch√§ftsentwicklung mit dem Potenzial f√ºr eine weitere Skalierung.  Mithilfe der aktualisierten Architektur der Webanwendung konnten die Vermarkter des Projekts ihre Werbema√ünahmen umsetzen und den Traffic von 350.000 Besuchern pro Monat auf √ºber 7 Millionen steigern.  Dar√ºber hinaus funktioniert das Portal nach einer mehrfachen Zunahme des Publikums weiterhin stabil. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de449538/">https://habr.com/ru/post/de449538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de449526/index.html">Einf√ºhrung in Tartiflette: Eine Open Source GraphQL-Implementierung f√ºr Python 3.6+</a></li>
<li><a href="../de449528/index.html">√úber die Zerlegung der Mehrkanalantwort eines Systems in "pseudo-eigene" Modi</a></li>
<li><a href="../de449532/index.html">ok.tech: Cassandra-Treffen</a></li>
<li><a href="../de449534/index.html">SLA Concept Car: Wie es in China gemacht wird</a></li>
<li><a href="../de449536/index.html">iOS Digest Nr. 4 (5. - 26. April)</a></li>
<li><a href="../de449540/index.html">Doodle-Shader-Effekt</a></li>
<li><a href="../de449542/index.html">Die Medizin bewegt sich ins Internet, in Chatrooms und in mobile Anwendungen. Gespr√§ch mit BestDoctor</a></li>
<li><a href="../de449544/index.html">Die moderne Welt beruht auf API</a></li>
<li><a href="../de449546/index.html">V8: ein Jahr mit Spectre</a></li>
<li><a href="../de449548/index.html">Weltraum-Rechenzentrum. Videobericht vom Start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>