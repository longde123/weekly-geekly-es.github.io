<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСитАНЁЯСйтАНЁЯСзтАНЁЯСж ЁЯСйЁЯП╗тАНЁЯЪТ ЁЯФШ IOS рдкрд░ рдЪреИрдЯ рдХрд░реЗрдВ: рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ ЁЯеб ЁЯР░ тШжя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЪрд┐рддреНрд░ rawpixel.com рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ 

 рдЗрд╕ рдкреНрд░рдХрд╛рд╢рди рдореЗрдВ, рд╣рдо рдЯреАрд╕реАрдкреА рдкрд░рдд рдкрд░ рдЬрд╛рдПрдВрдЧреЗ, рдЪреИрдЯ рдПрдкреНрд▓реАрдХреЗрд╢рди рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрд░ рдлрд╛рдЙрдВрдбреЗрд╢рди рдХреЗ рд╕реЙрдХреЗ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>IOS рдкрд░ рдЪреИрдЯ рдХрд░реЗрдВ: рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467909/"><img src="https://habrastorage.org/webt/dn/dv/gc/dndvgcrra0mv7ipvglf1ywvxdaw.png"><br>  <i>рдЪрд┐рддреНрд░ rawpixel.com рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛</i> <br><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд╢рди рдореЗрдВ, рд╣рдо рдЯреАрд╕реАрдкреА рдкрд░рдд рдкрд░ рдЬрд╛рдПрдВрдЧреЗ, рдЪреИрдЯ рдПрдкреНрд▓реАрдХреЗрд╢рди рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрд░ рдлрд╛рдЙрдВрдбреЗрд╢рди рдХреЗ рд╕реЙрдХреЗрдЯреНрд╕ рдФрд░ рдЯреВрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВред <br><br>  рдЕрдиреБрдорд╛рдирд┐рдд рдкрдврд╝рдиреЗ рдХрд╛ рд╕рдордп: 25 рдорд┐рдирдЯред <br><a name="habracut"></a><br><h2>  рд╕реЙрдХреЗрдЯ рдХреНрдпреЛрдВ? </h2><br>  рдЖрдк рд╕реЛрдЪ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ: "рдореБрдЭреЗ <b>URLSession</b> рд╕реЗ рдПрдХ рд╕реНрддрд░ рдХрдо рдХреНрдпреЛрдВ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП?"  рдпрджрд┐ рдЖрдк рдХрд╛рдлреА рдЪрддреБрд░ рд╣реИрдВ рдФрд░ рдпрд╣ рд╕рд╡рд╛рд▓ рдирд╣реАрдВ рдкреВрдЫрддреЗ рд╣реИрдВ, рддреЛ рд╕реАрдзреЗ рдЕрдЧрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдкрд░ рдЬрд╛рдПрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдЗрддрдирд╛ рд╕реНрдорд╛рд░реНрдЯ рдирд╣реАрдВ рд╣реЛрдиреЗ рдХрд╛ рдЬрд╡рд╛рдм</b> <div class="spoiler_text"> рдмрдбрд╝рд╛ рдЕрдЪреНрдЫрд╛ рд╕рд╡рд╛рд▓!  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ URLSession рдХрд╛ рдЙрдкрдпреЛрдЧ <b>HTTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓</b> рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЕрд░реНрдерд╛рддреН, рд╕рдВрдЪрд╛рд░ <b>рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛</b> рдХреА рд╢реИрд▓реА рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рд▓рдЧрднрдЧ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <br><br><ul><li>  JSON рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕реЗ рдХреБрдЫ рдбреЗрдЯрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз </li><li>  рдпрд╣ рдбреЗрдЯрд╛, рдкреНрд░рдХреНрд░рд┐рдпрд╛, рдкреНрд░рджрд░реНрд╢рди рдЖрджрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред </li></ul><br>  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рд╣рдореЗрдВ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдбреЗрдЯрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдпрдВ рдХреА рдкрд╣рд▓ рдкрд░ рдПрдХ рд╕рд░реНрд╡рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ?  рдпрд╣рд╛рдБ HTTP рдХрд╛рдо рд╕реЗ рдмрд╛рд╣рд░ рд╣реИред <br><br>  рдмреЗрд╢рдХ, рд╣рдо рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рдЦреАрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рд╣реИ (рдЙрд░реНрдл <b>рдкреЛрд▓рд┐рдВрдЧ</b> )ред  рдпрд╛ рд╣рдо рдЕрдзрд┐рдХ рдкрд░рд┐рд╖реНрдХреГрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рдВрдмреЗ рдорддрджрд╛рди рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдХрддреЗ рд╣реИрдВ</a> ред  рд▓реЗрдХрд┐рди рдЗрди рд╕рднреА рдмреИрд╕рд╛рдЦреА рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рдЕрдиреБрдЪрд┐рдд рд╣реИрдВред <br><br>  рдЖрдЦрд┐рд░рдХрд╛рд░, рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рддрд┐рдорд╛рди рддрдХ рд╕реАрдорд┐рдд рдХреНрдпреЛрдВ рдХрд░реЗрдВ рдпрджрд┐ рдпрд╣ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдп рдХреЛ рдХреБрдЫ рднреА рдирд╣реАрдВ рд╕реЗ рдХрдо рдлрд┐рдЯ рдмреИрдарддрд╛ рд╣реИ? <br><br>  рдЗрд╕ рдЧрд╛рдЗрдб рдореЗрдВ, рдЖрдк рд╕реАрдЦреЗрдВрдЧреЗ рдХрд┐ рдПрдмреНрд╕рдЯреНрд░реИрдХреНрд╢рди рдХреЗ рдирд┐рдЪрд▓реЗ рд╕реНрддрд░ рдкрд░ рдХреИрд╕реЗ рдЬрд╛рдПрдВ рдФрд░ рдЪреИрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕реАрдзреЗ <b>рд╕реЙрдХреЗрдЯ</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br>  рдирдП рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рд╣рдорд╛рд░рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрди рдзрд╛рд░рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдЬреЛ рдЪреИрдЯ рд╕рддреНрд░ рдХреЗ рджреМрд░рд╛рди рдЦреБрд▓реА рд░рд╣рддреА рд╣реИрдВред <br></div></div><br><h2>  рд╢реБрд░реБрдЖрдд рд╣реЛ рд░рд╣реА рд╣реИ </h2><br>  <a href="">рд╕реНрд░реЛрдд рд╕рд╛рдордЧреНрд░реА</a> рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред  рдПрдХ рдореЙрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ <b>рдЧреЛ</b> рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рд╕рд░реНрд╡рд░ рд╣реИред <br><br>  рдЖрдкрдХреЛ рдЧреЛ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддрд╛рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕рд╕реЗ рдЬреБрдбрд╝ рд╕рдХреЗрдВред <br><br><h2>  рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ </h2><br>  рд╕реНрд░реЛрдд рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдФрд░ рд╕реНрд░реЛрдд рджреЛрдиреЛрдВ рд╣реИрдВред  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕реНрд╡рд╕реНрде рд╡реНрдпрд╛рдореЛрд╣ рд╣реИ рдФрд░ рдХрд┐рд╕реА рдФрд░ рдХреЗ рд╕рдВрдХрд▓рд┐рдд рдХреЛрдб рдкрд░ рднрд░реЛрд╕рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк рд╕реНрд╡рдпрдВ рд╕реНрд░реЛрдд рдХреЛрдб рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдпрджрд┐ рдЖрдк рдмрд╣рд╛рджреБрд░ рд╣реИрдВ, рддреЛ <b>рдЯрд░реНрдорд┐рдирд▓</b> рдЦреЛрд▓реЗрдВ, рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдВ: <br><br><a name="a1"></a> <code>sudo ./server</code> <br> <br>  рд╕рдВрдХреЗрдд рджрд┐рдП рдЬрд╛рдиреЗ рдкрд░, рдЕрдкрдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВред  рдЙрд╕рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдПрдХ рд╕рдВрджреЗрд╢ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП <br><br>  <i>127.0.0.1:80 рдкрд░ рд╕реБрди рд░рд╣реЗ рд╣реИрдВред</i> <br><br><blockquote>  рдиреЛрдЯ: рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдореЛрдб ("sudo" рдХрдорд╛рдВрдб) рдореЗрдВ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреЛрд░реНрдЯ 80 рдкрд░ рд╕реБрдирддрд╛ рд╣реИред 1024 рд╕реЗ рдХрдо рд╕рдВрдЦреНрдпрд╛ рд╡рд╛рд▓реЗ рд╕рднреА рдкреЛрд░реНрдЯреНрд╕ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </blockquote><br>  рдЖрдкрдХрд╛ рдЪреИрдЯ рд╕рд░реНрд╡рд░ рддреИрдпрд╛рд░ рд╣реИ!  рдЖрдк рдЕрдЧрд▓реЗ рднрд╛рдЧ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдпрджрд┐ рдЖрдк рд╕рд░реНрд╡рд░ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рд╕реНрд╡рдпрдВ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ,</b> <div class="spoiler_text">  рдлрд┐рд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдкрдХреЛ <b>рд╣реЛрдордмреНрд░реЗ</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <b>рдЧреЛ</b> рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Homebrew рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдЗрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЯрд░реНрдорд┐рдирд▓ рдЦреЛрд▓реЗрдВ рдФрд░ рд╡рд╣рд╛рдВ рдирд┐рдореНрди рдкрдВрдХреНрддрд┐ рдЪрд┐рдкрдХрд╛рдПрдБ: <br><br> <code>/usr/bin/ruby -e \ <br> "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code> <br> <br>  рдлрд┐рд░ Go рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: <br><br> <code>brew install go</code> <br> <br>  рдЕрдВрдд рдореЗрдВ, рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рд╕реНрд░реЛрдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ: <br><br> <code>go build server.go</code> <br> <br>  рдЕрдВрдд рдореЗрдВ, рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕ рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ</a> рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд╕рд░реНрд╡рд░ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br></div></div><br><h2>  рд╣рдо рдЧреНрд░рд╛рд╣рдХ рдореЗрдВ рдЬреЛ рдХреБрдЫ рднреА рд╣реИ рдЙрд╕реЗ рджреЗрдЦрддреЗ рд╣реИрдВ </h2><br>  рдЕрдм <b>DogeChat</b> рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдЦреЛрд▓реЗрдВ, рдЗрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/webt/t5/mq/uw/t5mquwzt4dfvbn25cqglbf8sxgy.gif"><br><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, DogeChat рдЕрдм рдЖрдкрдХреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рджрд░реНрдЬ рдХрд░рдиреЗ рдФрд░ рд╕реНрд╡рдпрдВ рдЪреИрдЯ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдЬрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br>  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдбреЗрд╡рд▓рдкрд░ рдХреЛ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рдерд╛ рдХрд┐ рдЪреИрдЯ рдХреИрд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИред  рддреЛ рд╣рдо рд╕рдм рдПрдХ рдмреБрдирд┐рдпрд╛рджреА рдпреВрдЖрдИ рдФрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╣реИред  рд╣рдо рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рд▓реЗрдпрд░ рд▓рд┐рдЦреЗрдВрдЧреЗред  рд╣реБрд░реНрд░реЗ! <br><br><h2>  рдПрдХ рдЪреИрдЯ рд░реВрдо рдмрдирд╛рдПрдВ </h2><br>  рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <b>ChatRoomViewController.swift</b> рдкрд░ <b>рдЬрд╛рдПрдВ</b> ред  рдпрд╣ рдПрдХ рджреГрд╢реНрдп рдирд┐рдпрдВрддреНрд░рдХ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджрд░реНрдЬ рдХрд┐рдП рдЧрдП рдкрд╛рда рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдПрдХ рдЯреЗрдмрд▓рд╡реНрдпреВ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЪреВрдБрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ <b>ChatRoomViewController рд╣реИ</b> , рдпрд╣ рдПрдХ <b>ChatRoom</b> рд╡рд░реНрдЧ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ рдЬреЛ рд╕рднреА рдореЛрдЯреЗ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред <br><br>  рдЖрдЗрдП рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдирдпрд╛ рд╡рд░реНрдЧ рдХреНрдпрд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛: <br><br><ul><li>  рд╕рд░реНрд╡рд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдиреЗрдХреНрд╢рди рдЦреЛрд▓рдирд╛; </li><li>  рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪреИрдЯ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╛рдо рд╕реЗ рдЬреЛрдбрд╝рдирд╛; </li><li>  рд╕рдВрджреЗрд╢ рднреЗрдЬрдирд╛ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛; </li><li>  рдЕрдВрдд рдореЗрдВ рдХрдиреЗрдХреНрд╢рди рдмрдВрдж рдХрд░рдирд╛ред </li></ul><br>  рдЕрдм рдЬрдм рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдЗрд╕ рд╡рд░реНрдЧ рд╕реЗ рдХреНрдпрд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, <b>рдХрдорд╛рдВрдб-рдПрди</b> рджрдмрд╛рдПрдВ, <b>рд╕реНрд╡рд┐рдлреНрдЯ рдлрд╛рдЗрд▓</b> рдЪреБрдиреЗрдВ рдФрд░ рдЗрд╕реЗ <b>рдЪреИрдЯрд░реВрдо рдХрд╣реЗрдВ</b> ред <br><br><h2>  I / O рд╕реНрдЯреНрд░реАрдо рдмрдирд╛рдирд╛ </h2><br>  <b>рдЗрд╕рдХреЗ</b> рд╕рд╛рде <b>ChatRoom.swift рдХреА</b> рд╕рд╛рдордЧреНрд░реА рдХреЛ <b>рдмрджрд▓реЗрдВ</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit class ChatRoom: NSObject { <span class="hljs-comment"><span class="hljs-comment">//1 var inputStream: InputStream! var outputStream: OutputStream! //2 var username = "" //3 let maxReadLength = 4096 }</span></span></code> </pre> <br>  рдпрд╣рд╛рдБ рд╣рдо <b>ChatRoom</b> рд╡рд░реНрдЧ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрди рдЧреБрдгреЛрдВ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдирдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><ol><li>  рдкрд╣рд▓реЗ рд╣рдо рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдПрдХ рдЬреЛрдбрд╝реА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рд╣рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдЪреИрдЯ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╕реЙрдХреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗрдЧреАред  рдмреЗрд╢рдХ, рд╣рдо рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВрдЧреЗ, рдФрд░ рдЗрдирдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред </li><li>  рдЕрдЧрд▓рд╛, рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред </li><li>  рдФрд░ рдЕрдВрдд рдореЗрдВ, рд╣рдо рд╡реИрд░рд┐рдПрдмрд▓ рдореИрдХреНрд╕рд░реЗрд▓рдбреНрд░реАрдорд┐рдЯреА рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐рд╕реА рдПрдХ рд╕рдВрджреЗрд╢ рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред </li></ol><br>  рдЕрдм <b>ChatRoomViewController.swift</b> рдлрд╛рдЗрд▓ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕ рд▓рд╛рдЗрди рдХреЛ рдЗрд╕рдХреЗ рдЧреБрдгреЛрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> chatRoom = <span class="hljs-type"><span class="hljs-type">ChatRoom</span></span>()</code> </pre> <br>  рдЕрдм рдЬрдм рд╣рдордиреЗ рдХрдХреНрд╖рд╛ рдХреА рдореВрд▓ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдИ рд╣реИ, рддреЛ рдпрд╣ рдпреЛрдЬрдирд╛рдмрджреНрдз рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реЗ рдкрд╣рд▓рд╛ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ: рдЖрд╡реЗрджрди рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдХрдиреЗрдХреНрд╢рди рдЦреЛрд▓рдирд╛ред <br><br><h2>  рдХрдиреЗрдХреНрд╢рди рдЦреЛрд▓реЗрдВ </h2><br>  рд╣рдо ChatRoom.swift рдкрд░ рд▓реМрдЯрддреЗ рд╣реИрдВ рдФрд░ рд╕рдВрдкрддреНрддрд┐ рдкрд░рд┐рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupNetworkCommunication</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1 var readStream: Unmanaged&lt;CFReadStream&gt;? var writeStream: Unmanaged&lt;CFWriteStream&gt;? // 2 CFStreamCreatePairWithSocketToHost(kCFAllocatorDefault, "localhost" as CFString, 80, &amp;readStream, &amp;writeStream) }</span></span></code> </pre> <br>  рд╣рдо рдпрд╣рд╛рдБ рдХреНрдпрд╛ рдХрд░рддреЗ рд╣реИрдВ: <br><br><ol><li>  рдкрд╣рд▓реЗ рд╣рдо рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдореЗрдореЛрд░реА рдкреНрд░рдмрдВрдзрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдмрд┐рдирд╛ рд╕реЙрдХреЗрдЯ рдзрд╛рд░рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рджреЛ рдЪрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ </li><li>  рдлрд┐рд░, рд╣рдо рдЗрди рд╕рдорд╛рди рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╕реАрдзреЗ рд╕реНрдЯреНрд░реАрдо рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп рд╣реИрдВред </li></ol><br>  рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЪрд╛рд░ рддрд░реНрдХ рд╣реИрдВред  рдкрд╣рд▓рд╛ рдореЗрдореЛрд░реА рдПрд▓реЛрдХреЗрдЯрд░ рдХрд╛ рдкреНрд░рдХрд╛рд░ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдо рдереНрд░реЗрдбреНрд╕ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╕рдордп рдХрд░реЗрдВрдЧреЗред  рдЖрдкрдХреЛ <b>kCFAllocatorDefault рдХрд╛</b> рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╣рд╛рд▓рд╛рдБрдХрд┐ рдпрджрд┐ рдЖрдк рдереНрд░реЗрдбреНрд╕ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд╡рд┐рдХрд▓реНрдк рд╣реИрдВред <br><br><div class="spoiler">  <b class="spoiler_title">рдЕрдиреБрд╡рд╛рджрдХ рдХрд╛ рдиреЛрдЯ</b> <div class="spoiler_text">  <b>CFStreamCreatePairWithSocketToHost</b> рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╣рддрд╛ рд╣реИ: <b>NULL</b> рдпрд╛ <b>kCFAllocatorDefault рдХрд╛</b> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред  рдФрд░ <b>kCFAllocatorDefault</b> рдХрд╛ рд╡рд░реНрдгрди рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ <b>NULL рдХрд╛</b> рдкрд░реНрдпрд╛рдп <b>рд╣реИ</b> ред  рд╕рд░реНрдХрд▓ рдмрдВрдж рд╣реЛ рдЧрдпрд╛ рд╣реИ! <br></div></div><br>  рдлрд┐рд░ рд╣рдордиреЗ рд╣реЛрд╕реНрдЯ рдирд╛рдо рд╕реЗрдЯ рдХрд┐рдпрд╛ред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рд╕реНрдерд╛рдиреАрдп рд╕рд░реНрд╡рд░ рд╕реЗ рдЬреБрдбрд╝ рд░рд╣реЗ рд╣реИрдВред  рдпрджрд┐ рдЖрдкрдХрд╛ рд╕рд░реНрд╡рд░ рджреВрд╕рд░реА рдЬрдЧрд╣ рд╕реНрдерд┐рдд рд╣реИ, рддреЛ рдЖрдк рдЙрд╕рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдлрд┐рд░ рд╕рд░реНрд╡рд░ рдЬрд┐рд╕ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдкрд░ рд╕реБрди рд░рд╣рд╛ рд╣реИред <br><br>  рдЕрдВрдд рдореЗрдВ, рд╣рдо рдЕрдкрдиреЗ I / O рд╕реНрдЯреНрд░реАрдо рдХреЛ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдлрдВрдХреНрд╢рди рдЙрдиреНрд╣реЗрдВ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЙрди рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЗ рдЬреЛ рдЗрд╕реЗ рдмрдирд╛рддрд╛ рд╣реИред <br><br>  рдЕрдм рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рд╡рд╛рд╣ рд╣реИ, рд╣рдо рдЗрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ <b>setupNetworkCommunication ()</b> рд╡рд┐рдзрд┐ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="swift hljs">inputStream = readStream!.takeRetainedValue() outputStream = writeStream!.takeRetainedValue()</code> </pre> <br>  рдПрдХ рдЕрдкреНрд░рдмрдВрдзрд┐рдд рд╡рд╕реНрддреБ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ <b>takeRetainedValue ()</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣рдореЗрдВ рдПрдХ рд╕рдВрджрд░реНрдн рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░, рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рднрд╡рд┐рд╖реНрдп рдХреА рдореЗрдореЛрд░реА рд▓реАрдХ рд╕реЗ рдмрдЪреЗрдВред  рдЕрдм рд╣рдо рдЬрд╣рд╛рдВ рдЪрд╛рд╣реЗрдВ рд╡рд╣рд╛рдВ рдЕрдкрдиреЗ рдзрд╛рдЧреЛрдВ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЕрдм рд╣рдореЗрдВ рдЗрди рдереНрд░реЗрдбреНрд╕ рдХреЛ <b>рд░рди рд▓реВрдк рдореЗрдВ</b> рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рд╣рдорд╛рд░рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗрдЯрд╡рд░реНрдХ рдШрдЯрдирд╛рдУрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░ рд╕рдХреЗред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <b>setupNetworkCommunication ()</b> рдХреЗ рдЕрдВрдд рдореЗрдВ рдЗрди рджреЛ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs">inputStream.schedule(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: .current, forMode: .common) outputStream.schedule(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: .current, forMode: .common)</code> </pre> <br>  рдЕрдВрдд рдореЗрдВ рдпрд╣ рдкрд╛рд▓ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ!  рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ <b>setupNetworkCommunication ()</b> рд╡рд┐рдзрд┐ рдХреЗ рдмрд╣реБрдд рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs">inputStream.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>() outputStream.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>()</code> </pre> <br>  рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣рдорд╛рд░реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмреАрдЪ рдПрдХ рдЦреБрд▓рд╛ рд╕рдВрдмрдВрдз рд╣реИред <br><br>  рд╣рдо рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдФрд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдЕрднреА рддрдХ рдХреЛрдИ рдмрджрд▓рд╛рд╡ рдирд╣реАрдВ рджрд┐рдЦреЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЕрдкрдиреЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред <br><br><h2>  рдЪреИрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ </h2><br>  рдЕрдм рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрдиреЗрдХреНрд╢рди рд╣реИ, рддреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ!  рдЪреИрдЯ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдЕрдкрдирд╛ рдкрд░рд┐рдЪрдп рджреЗрдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдЖрдк рд╡рд╛рд░реНрддрд╛рдХрд╛рд░реЛрдВ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдпрд╣ рд╣рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд┐рд╖реНрдХрд░реНрд╖ рдкрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ: рдЪреВрдВрдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрджреЗрд╢ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХрд┐рд╕реА рддрд░рд╣ рдЙрдирдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><h2>  рдЪреИрдЯ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ </h2><br>  рдЯреАрд╕реАрдкреА рдкрд░рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ "рдкреНрд░реЛрдЯреЛрдХреЙрд▓" рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЕрдЧрд░ рд╣рдордиреЗ HTTP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЗрди рд╡рд┐рднрд┐рдиреНрди рд╢рдмреНрджреЛрдВ <b>GET</b> , <b>PUT</b> , <b>PATCH</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рд╣рдореЗрдВ URL рдмрдирд╛рдиреЗ рдФрд░ рд╕рд╣реА рд╣реЗрдбрд░ рдФрд░ рд╕рднреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред <br><br>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрджреЗрд╢ рд╣реИрдВред  рд╣рдо рднреЗрдЬ рджреЗрдВрдЧреЗ <br><br> <code>iam:Luke</code> <br> <br>  рдЪреИрдЯ рджрд░реНрдЬ рдХрд░рдиреЗ рдФрд░ рдЕрдкрдирд╛ рдкрд░рд┐рдЪрдп рджреЗрдиреЗ рдХреЗ рд▓рд┐рдПред <br><br>  рдФрд░ рд╣рдо рднреЗрдЬ рджреЗрдВрдЧреЗ <br><br> <code>msg:Hey, how goes it, man?</code> <br> <br>  рд╕рднреА рдЙрддреНрддрд░рджрд╛рддрд╛рдУрдВ рдХреЛ рдЪреИрдЯ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред <br><br>  рдпрд╣ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдмрд┐рд▓реНрдХреБрд▓ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдореЗрдВ рдЗрд╕ рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред <br><br>  рдЕрдм рд╣рдореЗрдВ рдкрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд╛рд░рд╛ рд╕рд░реНрд╡рд░ рдХреНрдпрд╛ рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╣рдо <b>рдЪреИрдЯрд░реВрдо</b> рдХреНрд▓рд╛рд╕ рдореЗрдВ рдПрдХ рд╡рд┐рдзрд┐ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪреИрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред  рдПрдХрдорд╛рддреНрд░ рддрд░реНрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдирд╛рдо рд╣реИред <br><br>  рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ <b>ChatRoom.swift рдХреЗ</b> рдЕрдВрджрд░ <b>рдЬреЛрдбрд╝реЗрдВ</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">joinChat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(username: String)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//1 let data = "iam:\(username)".data(using: .utf8)! //2 self.username = username //3 _ = data.withUnsafeBytes { guard let pointer = $0.baseAddress?.assumingMemoryBound(to: UInt8.self) else { print("Error joining chat") return } //4 outputStream.write(pointer, maxLength: data.count) } }</span></span></code> </pre> <br><ol><li>  рдкрд╣рд▓реЗ рд╣рдо рдЕрдкрдиреЗ "рдкреНрд░реЛрдЯреЛрдХреЙрд▓" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдирд╛ рд╕рдВрджреЗрд╢ рдмрдирд╛рддреЗ рд╣реИрдВ </li><li>  рднрд╡рд┐рд╖реНрдп рдХреЗ рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рдирд╛рдо рд╕рд╣реЗрдЬреЗрдВред </li><li>  <b>withUnsafeBytes (_ :)</b> рдПрдХ рдХреНрд▓реЛрдЬрд░ рдХреЗ рдЕрдВрджрд░ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреЙрдЗрдВрдЯрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </li><li>  рдЕрдВрдд рдореЗрдВ, рд╣рдо рдЕрдкрдирд╛ рд╕рдВрджреЗрд╢ рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рднреЗрдЬрддреЗ рд╣реИрдВред  рдпрд╣ рдЖрдкрдХреА рдЕрдкреЗрдХреНрд╖рд╛ рд╕реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд▓рд┐рдЦреЗрдВ (_: maxLength :) рдкрд┐рдЫрд▓реЗ рдЪрд░рдг рдореЗрдВ рдмрдирд╛рдП рдЧрдП рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </li></ol><br>  рдЕрдм рд╣рдорд╛рд░реА рд╡рд┐рдзрд┐ рддреИрдпрд╛рд░ рд╣реИ, <b>ChatRoomViewController.swift</b> рдЦреЛрд▓реЗрдВ рдФрд░ <b>viewWillAppear (_ :)</b> рдХреЗ рдЕрдВрдд рдореЗрдВ рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рдПрдХ рдХреЙрд▓ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="swift hljs">chatRoom.joinChat(username: username)</code> </pre> <br>  рдЕрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЪрд▓рд╛рдПрдВред  рдЕрдкрдирд╛ рдЙрдкрдирд╛рдо рджрд░реНрдЬ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕реА рдкрд░ рдЯреИрдк рдХрд░реЗрдВ ... <br><br><img src="https://habrastorage.org/webt/t5/mq/uw/t5mquwzt4dfvbn25cqglbf8sxgy.gif"><br><br>  ... <b>рдХрд┐ рдлрд┐рд░ рд╕реЗ рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрджрд▓рд╛ рд╣реИ!</b> <br><br>  рд░реБрдХреЛ, рдпрд╣ рд╕рдм рдареАрдХ рд╣реИ!  рдЯрд░реНрдорд┐рдирд▓ рд╡рд┐рдВрдбреЛ рдкрд░ рдЬрд╛рдПрдВред  рд╡рд╣рд╛рдБ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рд╕рдВрджреЗрд╢ <b>рд╡рд╛рд╕реНрдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ</b> рдпрд╛ рдХреБрдЫ рдРрд╕рд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХрд╛ рдирд╛рдо рд╡рд╛рд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИред <br><br>  рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдкрдиреЗ рдлреЛрди рдХреА рд╕реНрдХреНрд░реАрди рдкрд░ рдПрдХ рд╕рдлрд▓ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдирд╛ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ред <br><br><h2>  рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЬрд╡рд╛рдм </h2><br>  рд╕рд░реНрд╡рд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рд╕рд╛рде рдЪреИрдЯ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╕рднреА рд▓реЛрдЧреЛрдВ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИред  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рд╣рдорд╛рд░реЗ рдЖрд╡реЗрджрди рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА <b>ChatRoomViewController</b> рдХреА рд╕рдВрджреЗрд╢ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рд╕реА рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдм рдХреБрдЫ рд╣реИред <br><br>  рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЗрди рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ "рдкрдХрдбрд╝рдиреЗ" рдХреЗ рд▓рд┐рдП <b>рдЗрдирдкреБрдЯрд╕реНрдЯреНрд░реАрдо</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рдЙрдиреНрд╣реЗрдВ <b>рд╕рдВрджреЗрд╢</b> рд╡рд░реНрдЧ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдкрд╛рд╕ рдХрд░реЗрдВред <br><br>  рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <b>StreamDelegate</b> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ <b>рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ</b> рдХреЗ рд▓рд┐рдП <b>ChatRoom</b> рдХреА <b>рдЖрд╡рд╢реНрдпрдХрддрд╛</b> рд╣реИред <br><br>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ <b>ChatRoom.swift</b> рдлрд╝рд╛рдЗрд▓ рдХреЗ рдиреАрдЪреЗ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChatRoom</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StreamDelegate</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br>  рдЕрдм рдШреЛрд╖рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреМрди рдЗрдирдкреБрдЯрд╕реНрдЯреНрд░реАрдо рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдмрди рдЬрд╛рдПрдЧрд╛ред <br><br>  рд╢реЗрдбреНрдпреВрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ setupNetworkCommunication () рд╡рд┐рдзрд┐ рдореЗрдВ рдЗрд╕ рд▓рд╛рдЗрди рдХреЛ рдЬреЛрдбрд╝реЗрдВ: (forMode :): <br><br><pre> <code class="swift hljs">inputStream.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span></code> </pre> <br>  рдЕрдм рдзрд╛рд░рд╛ рдЬреЛрдбрд╝реЗрдВ (_: рд╕рдВрднрд╛рд▓ :) рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> aStream: Stream, handle eventCode: Stream.Event)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> eventCode { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .hasBytesAvailable: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"new message received"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .endEncountered: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"The end of the stream has been reached."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .errorOccurred: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"error occurred"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> .hasSpaceAvailable: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"has space available"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"some other event..."</span></span>) } }</code> </pre> <br><h2>  рд╣рдо рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ </h2><br>  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИрдВред  рд╡рд╣ рдШрдЯрдирд╛ рдЬреЛ рд╣рдореЗрдВ <b>рд░реБрдЪрддреА</b> рд╣реИ <b>.hasBytesAvailable</b> , рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рдВрджреЗрд╢ рдЖ рдЧрдпрд╛ рд╣реИред <br><br>  рд╣рдо рдПрдХ рд╡рд┐рдзрд┐ рд▓рд┐рдЦреЗрдВрдЧреЗ рдЬреЛ рдЗрди рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреА рд╣реИред  рдирдИ рдЧрдпреА рд╡рд┐рдзрд┐ рдХреЗ рдиреАрдЪреЗ, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд┐рдЦрддреЗ рд╣реИрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readAvailableBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(stream: InputStream)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//1 let buffer = UnsafeMutablePointer&lt;UInt8&gt;.allocate(capacity: maxReadLength) //2 while stream.hasBytesAvailable { //3 let numberOfBytesRead = inputStream.read(buffer, maxLength: maxReadLength) //4 if numberOfBytesRead &lt; 0, let error = stream.streamError { print(error) break } // Construct the Message object } }</span></span></code> </pre> <br><ol><li>  рд╣рдо рдмрдлрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдЖрдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдкрдврд╝реЗрдВрдЧреЗред </li><li>  рд╣рдо рдПрдХ рд▓реВрдк рдореЗрдВ рдШреВрдорддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдЗрдирдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рдХреБрдЫ рдкрдврд╝рдирд╛ рд╣реИред </li><li>  рд╣рдо рд░реАрдб (_: maxLength :) рдХрд╣рддреЗ рд╣реИрдВ, рдЬреЛ рд╕реНрдЯреНрд░реАрдо рд╕реЗ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрдлрд░ рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИред </li><li>  рдпрджрд┐ рдХреЙрд▓ рдПрдХ рдирдХрд╛рд░рд╛рддреНрдордХ рдорд╛рди рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдо рдПрдХ рддреНрд░реБрдЯрд┐ рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ рдФрд░ рд▓реВрдк рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рддреЗ рд╣реИрдВред </li></ol><br>  рд╣рдореЗрдВ рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреИрд╕реЗ рд╣реА рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЖрдиреЗ рд╡рд╛рд▓реА рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рдбреЗрдЯрд╛ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо <b>рд╕реНрдЯреНрд░реАрдо рдХреЗ</b> рдЕрдВрджрд░ <b>рд╕реНрд╡рд┐рдЪ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдкрд░ рдЬрд╛рдПрдВ</b> <b>(_: рд╣реИрдВрдбрд▓ :)</b> рд╡рд┐рдзрд┐, <b>.hasBytesAvailable</b> рд╕реНрд╡рд┐рдЪ <b>рдвреВрдВрдвреЗрдВ</b> рдФрд░ рдкреНрд░рд┐рдВрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ: <br><br><pre> <code class="swift hljs">readAvailableBytes(stream: aStream <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">InputStream</span></span>)</code> </pre> <br>  рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкреНрд░рд╛рдкреНрдд рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рдПрдХ рддреИрдпрд╛рд░ рдмрдлрд░ рд╣реИ! <br><br>  рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЕрднреА рднреА рдЗрд╕ рдмрдлрд░ рдХреЛ рд╕рдВрджреЗрд╢ рддрд╛рд▓рд┐рдХрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ <b>readAvailableBytes (рд╕реНрдЯреНрд░реАрдо :)</b> рдкрд░ <b>рд░рдЦреЗрдВ</b> ред <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processedMessageString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buffer: UnsafeMutablePointer&lt;UInt8&gt;, length: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Message?</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1 guard let stringArray = String( bytesNoCopy: buffer, length: length, encoding: .utf8, freeWhenDone: true)?.components(separatedBy: ":"), let name = stringArray.first, let message = stringArray.last else { return nil } //2 let messageSender: MessageSender = (name == self.username) ? .ourself : .someoneElse //3 return Message(message: message, messageSender: messageSender, username: name) }</span></span></code> </pre> <br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдмрдлрд░ рдФрд░ рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдЖрд░рдВрднреАрдХреГрдд рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВред <br><br>  рдкрд╛рда UTF-8 рдореЗрдВ рд╣реЛрдЧрд╛, рдЕрдВрдд рдореЗрдВ рд╣рдо рдмрдлрд░ рдХреЛ рдореБрдХреНрдд рдХрд░реЗрдВрдЧреЗ, рдФрд░ рд╕рдВрджреЗрд╢ рдХреЛ ':' рдХреЛ рдкреНрд░реЗрд╖рдХ рдХреЗ рдирд╛рдо рдФрд░ рд╕рдВрджреЗрд╢ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВрдЧреЗред <br><br>  рдЕрдм рд╣рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╕рдВрджреЗрд╢ рджреВрд╕рд░реЗ рдкреНрд░рддрд┐рднрд╛рдЧреА рд╕реЗ рдЖрдпрд╛ рд╣реИред  рдЙрддреНрдкрд╛рдж рдкрд░, рдЖрдк рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдЯреЛрдХрди рдЬреИрд╕рд╛ рдХреБрдЫ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдбреЗрдореЛ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред <br><br>  рдЕрдВрдд рдореЗрдВ, рдЗрд╕ рд╕рднреА рдЕрд░реНрдерд╡реНрдпрд╡рд╕реНрдерд╛ рдореЗрдВ, рд╣рдо рд╕рдВрджреЗрд╢ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <b>рд░реАрдб-рдЕрд╡реЗрд▓реЗрдмрд▓ рдмрд┐рдЯреНрд╕ (рд╕реНрдЯреНрд░реАрдо :)</b> рд╡рд┐рдзрд┐ рдореЗрдВ рдЕрдВрддрд┐рдо <b>рд▓реВрдк</b> рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд <b>рдЗрдл-рд▓реЗрдЯ</b> рдХреЛ рдЕрдВрддрд┐рдо рдЯрд┐рдкреНрдкрдгреА рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> message = processedMessageString(buffer: buffer, length: numberOfBytesRead) { <span class="hljs-comment"><span class="hljs-comment">// Notify interested parties }</span></span></code> </pre> <br>  рдЕрдм рд╕рдм рдХреБрдЫ рдХрд┐рд╕реА рдХреЛ <b>рд╕рдВрджреЗрд╢</b> рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИ ... рд▓реЗрдХрд┐рди рдХрд┐рд╕рд╕реЗ? <br><br><h2>  ChatRoomDelegate рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдмрдирд╛рдПрдБ </h2><br>  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ <b>ChatRoomViewController.swift</b> рдХреЛ рдирдП рд╕рдВрджреЗрд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЗрд╕рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдирд╣реАрдВ рд╣реИред  рдЪреВрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдПрдХ рдордЬрдмреВрдд <b>рдЪреИрдЯрд░реВрдо</b> рд▓рд┐рдВрдХ рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╣рдо рдПрдХ рдордЬрдмреВрдд рд▓рд┐рдВрдХ рдЪрдХреНрд░ рдХреЗ рдЬрд╛рд▓ рдореЗрдВ рдЧрд┐рд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдпрд╣ рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдЬрдЧрд╣ рд╣реИред  ChatRoom рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдирдП рдкрджреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред <br><br>  <b>ChatRoom.swift</b> рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ <b>,</b> рдПрдХ рдирдИ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рднрд╛рд╖рд╛ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChatRoomDelegate</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">received</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message: Message)</span></span></span></span> }</code> </pre> <br>  рдЕрдм <b>ChatRoom</b> рд╡рд░реНрдЧ рдХреЗ рдЕрдВрджрд░ <b>,</b> рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдордЬреЛрд░ рд▓рд┐рдВрдХ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдмрди рдЬрд╛рдПрдЧрд╛: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> delegate: <span class="hljs-type"><span class="hljs-type">ChatRoomDelegate?</span></span></code> </pre> <br>  рдЪрд▓рд┐рдП рдЕрдм <b>readAvailableBytes (рд╕реНрдЯреНрд░реАрдо :)</b> рдореЗрдердб рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдЕрдЧрд░-рд▓реЗрдЯ рдХрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рдЕрдВрджрд░ рдирд┐рдореНрди рд▓рд╛рдЗрди рдХреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рд╡рд┐рдзрд┐ рдореЗрдВ рдЕрдВрддрд┐рдо рдЯрд┐рдкреНрдкрдгреА рдХреЗ рддрд╣рдд: <br><br><pre> <code class="swift hljs">delegate?.received(message: message)</code> </pre> <br>  <b>ChatRoomViewController.swift рдкрд░</b> рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВ рдФрд░ рдирд┐рдореНрди рд╡рд░реНрдЧ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреЛрдбрд╝реЗрдВ, рдЬреЛ <b>ChatRoomDelegate</b> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, MessageInputDelegate рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChatRoomViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChatRoomDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">received</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message: Message)</span></span></span></span> { insertNewMessageCell(message) } }</code> </pre> <br>  рдореВрд▓ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП <b>рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░реЗрдВрдореЗрдиреЗрд╕реЗрдЬрд╕реЗрд▓ (_ :)</b> рдЖрдкрдХреЗ рд╕рдВрджреЗрд╢ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдЧрд╛ рдФрд░ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕рд╣реА рд╕реЗрд▓ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред <br><br>  рдЕрдм <b>viewWillAppear (_ :)</b> рдХреЛ super.viewWillearear () рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рдЗрд╕реЗ рдЬреЛрдбрд╝рдХрд░ рдПрдХ рджреГрд╢реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рджреГрд╢реНрдп рдирд┐рдпрдВрддреНрд░рдХ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ <br><br><pre> <code class="swift hljs">chatRoom.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span></code> </pre> <br>  рдЕрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЪрд▓рд╛рдПрдВред  рдПрдХ рдирд╛рдо рджрд░реНрдЬ рдХрд░реЗрдВ рдФрд░ рд╡рд╛рдкрд╕реА рдкрд░ рдЯреИрдк рдХрд░реЗрдВред <br><br><img src="https://habrastorage.org/webt/km/21/ed/km21ed-ey4avyntpx53si6oqbra.gif"><br><br>  рдЖрдк рдЪреИрдЯ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕реЗрд▓ рджреЗрдЦреЗрдВрдЧреЗред  рд╣реБрд░реНрд░реЗ, рдЖрдкрдиреЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрд╛ рдФрд░ рдЗрд╕реЗ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓реА! <br><br><h2>  рд╕рдВрджреЗрд╢ рдкреЛрд╕реНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ </h2><br>  рдЕрдм рдЬрдм ChatRoom рд╕рдВрджреЗрд╢ рднреЗрдЬ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреЗ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдЖ рдЧрдпрд╛ рд╣реИред <br><br>  <b>ChatRoom.swift рдореЗрдВ,</b> рдХрдХреНрд╖рд╛ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message: String)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = <span class="hljs-string"><span class="hljs-string">"msg:\(message)"</span></span>.data(using: .utf8)! <span class="hljs-number"><span class="hljs-number">_</span></span> = data.withUnsafeBytes { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pointer = $<span class="hljs-number"><span class="hljs-number">0</span></span>.baseAddress?.assumingMemoryBound(to: <span class="hljs-type"><span class="hljs-type">UInt8</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Error joining chat"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } outputStream.write(pointer, maxLength: data.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) } }</code> </pre> <br>  рдпрд╣ рд╡рд┐рдзрд┐ <b>joinChat (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо :) рдХреЗ</b> рд╕рдорд╛рди рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдерд╛, рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдЗрд╕рдореЗрдВ рдЯреЗрдХреНрд╕реНрдЯ рдХреЗ рд╕рд╛рдордиреЗ <b>msg</b> рдЙрдкрд╕рд░реНрдЧ рд╣реИ (рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЪреИрдЯ рд╕рдВрджреЗрд╢ рд╣реИ)ред <br><br>  рдЪреВрдБрдХрд┐ рд╣рдо <b>Send</b> рдмрдЯрди рджреНрд╡рд╛рд░рд╛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╣рдо <b>ChatRoomViewController.swift</b> рдкрд░ <b>рд▓реМрдЯрддреЗ рд╣реИрдВ</b> рдФрд░ рд╡рд╣рд╛рдВ <b>MessageInputDoggate</b> рдЦреЛрдЬреЗрдВред <br><br>  рдпрд╣рд╛рдВ рд╣рдо рдЦрд╛рд▓реА <b>SendWasTapped (рд╕рдВрджреЗрд╢ :)</b> рд╡рд┐рдзрд┐ рджреЗрдЦрддреЗ рд╣реИрдВред  рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ chatRoom рдкрд░ рднреЗрдЬреЗрдВ: <br><br><pre> <code class="swift hljs">chatRoom.send(message: message)</code> </pre> <br>  рдЕрд╕рд▓ рдореЗрдВ, рд╡рд╣ рд╕рдм рд╣реИ!  рдЪреВрдВрдХрд┐ рд╕рд░реНрд╡рд░ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рдФрд░ рдЗрд╕реЗ рд╕рднреА рдХреЛ рдЕрдЧреНрд░реЗрд╖рд┐рдд рдХрд░реЗрдЧрд╛, рдЪреИрдЯ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдиреЗ рдХреЗ рджреМрд░рд╛рди рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдЪреИрдЯрд░реВрдо рдХреЛ рдирдП рд╕рдВрджреЗрд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЪрд▓рд╛рдПрдВред <br><br><img src="https://habrastorage.org/webt/i6/e6/r1/i6e6r1tzjl-2r1ekzdk5gvplbsq.gif"><br><br>  рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдм рдХрд┐рд╕реА рд╕реЗ рдЪреИрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ рдирдИ рдЯрд░реНрдорд┐рдирд▓ рд╡рд┐рдВрдбреЛ рд▓реЙрдиреНрдЪ рдХрд░реЗрдВ рдФрд░ рджрд░реНрдЬ рдХрд░реЗрдВ: <br><br> <code>nc localhost 80</code> <br> <br>  рдпрд╣ рдЖрдкрдХреЛ рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдЧрд╛ред  рдЕрдм рдЖрдк рдЙрд╕реА "рдкреНрд░реЛрдЯреЛрдХреЙрд▓" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪреИрдЯ рд╕реЗ рдЬреБрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: <br><br> <code>iam:gregg</code> <br> <br>  рдФрд░ рдЗрд╕рд▓рд┐рдП - рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдВ: <br><br> <code>msg:Ay mang, wut's good?</code> <br> <br><img src="https://habrastorage.org/webt/qm/5e/_l/qm5e_l4wi4a0_whqffyzbmeyqzs.gif"><br><br>  рдмрдзрд╛рдИ рд╣реЛ, рдЖрдкрдиреЗ рдЪреИрдЯ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рд▓рд┐рдЦрд╛ рд╣реИ! <br><br><h2>  рд╣рдо рдЦреБрдж рдХреЛ рд╕рд╛рдл рдХрд░рддреЗ рд╣реИрдВ </h2><br>  рдпрджрд┐ рдЖрдк рдХрднреА рдРрд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рдХрд╕рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рддреЗ / рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЕрдЪреНрдЫреЗ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рдЙрдирдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рд╕реЙрдХреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХрд╛рдо рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░ рдЖрдкрдХреЛ рдЗрд╕реЗ рдХрд┐рд╕реА рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓ рдХреА рддрд░рд╣ рдмрдВрдж рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <b>Send</b> <b>(рд╕рдВрджреЗрд╢ :)</b> : рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж <b>ChatRoom.swift</b> рдореЗрдВ рдирд┐рдореНрди рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stopChatSession</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { inputStream.close() outputStream.close() }</code> </pre><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рд╢рд╛рдпрдж рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдерд╛, рдпрд╣ рд╡рд┐рдзрд┐ рдереНрд░реЗрдб рдХреЛ рдмрдВрдж рдХрд░ рджреЗрддреА рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЕрдм рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рди рдХрд░ рд╕рдХреЗрдВ рдФрд░ рд╕рдВрджреЗрд╢ рди рднреЗрдЬ рд╕рдХреЗрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдереНрд░реЗрдбреНрд╕ рдХреЛ <b>рд░рди рд▓реВрдк</b> рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣рдордиреЗ рдкрд╣рд▓реЗ рдЙрдиреНрд╣реЗрдВ рд░рдЦрд╛ рдерд╛ред <br><br>  рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рдПрдХ рдХреЙрд▓ рдЬреЛрдбрд╝реЗрдВред <b>рдзрд╛рд░рд╛ рдХреЗ</b> рдЕрдВрджрд░ <b>рд╕реНрд╡рд┐рдЪ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ</b> рдХреЗ <b>.Encountered</b> рд╕реЗрдХреНрд╢рди <b>(_: рд╣реИрдВрдбрд▓ :)</b> : <br><br><pre> <code class="swift hljs">stopChatSession()</code> </pre> <br>  рдЗрд╕рдХреЗ рдмрд╛рдж <b>ChatRoomViewController.swift</b> рдкрд░ <b>рдЬрд╛рдПрдВ</b> рдФрд░ <b>viewWillDisappear (_ :)</b> : рдореЗрдВ рднреА рдРрд╕рд╛ рд╣реА рдХрд░реЗрдВ <br><br><pre> <code class="swift hljs">chatRoom.stopChatSession()</code> </pre> <br>  рдпрд╣ рдмрд╛рдд рд╣реИ!  рдЕрдм рдкрдХреНрдХрд╛! <br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рдЕрдм рдЬрдм рдЖрдкрдиреЗ рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдХреА рдореВрд▓ рдмрд╛рддреЛрдВ рдореЗрдВ рдорд╣рд╛рд░рдд рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд▓реА рд╣реИ, рддреЛ рдЖрдк рдЕрдкрдиреЗ рдЬреНрдЮрд╛рди рдХреЛ рдЧрд╣рд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h4>  рдпреВрдбреАрдкреА рд╕реЙрдХреЗрдЯреНрд╕ </h4><br>  рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЯреАрд╕реАрдкреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрдЪрд╛рд░ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рдЬреЛ рдЧрдВрддрд╡реНрдп рддрдХ рдкреИрдХреЗрдЯ рдХреЗ рд╡рд┐рддрд░рдг рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИред <br><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдпреВрдбреАрдкреА рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдХрдиреЗрдХреНрд╢рди рдкреИрдХреЗрдЬ рдХреЗ рд╡рд┐рддрд░рдг рдХреЛ рдЙрдирдХреЗ рдЗрдЪреНрдЫрд┐рдд рдЙрджреНрджреЗрд╢реНрдп рдХреА рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рддреЗрдЬрд╝ рд╣реИред <br><br>  рдпрд╣ рдЦреЗрд▓реЛрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИред  рдХрднреА рдПрдХ рдЕрдВрддрд░рд╛рд▓ рдЕрдиреБрднрд╡ рдХрд┐рдпрд╛?  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдерд╛ рдХрд┐ рдЖрдкрдХреЗ рд╕рдВрдмрдВрдз рдЦрд░рд╛рдм рдереЗ рдФрд░ рдпреВрдбреАрдкреА рдХреЗ рдХрдИ рдкреИрдХреЗрдЯ рдЦреЛ рдЧрдП рдереЗред <br><br><h4>  WebSockets </h4><br>  рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ HTTP рдХрд╛ рдПрдХ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдк рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕реЗ рд╡реЗрдм рд╕реЙрдХреЗрдЯ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдирд┐рдпрдорд┐рдд рдЯреАрд╕реАрдкреА рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╡реЗрдм рд╕реЙрдХреЗрдЯ рд╕рдВрдЪрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЙрдирдХреА рдорджрдж рд╕реЗ, рдЖрдк рд╕рд╛рдзрд╛рд░рдг рд╕реЙрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╣реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрд░рд╛рдо рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд╕рд╛рде, рдЬреИрд╕реЗ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi467909/">https://habr.com/ru/post/hi467909/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi467897/index.html">рдСрдЯреЛ рдкрд░реАрдХреНрд╖рдг рдЙрдкрдХрд░рдг, рдпреИрдВрдбреЗрдХреНрд╕ рдореИрдкрдХрд┐рдЯ 3 рдПрдХреАрдХрд░рдг, рд╢рд╛рдВрдд рдбрд┐рдЬрд╛рдЗрди рдФрд░ рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдпреВрдЖрдИ рджреГрд╖реНрдЯрд┐рдХреЛрдг - рдПрдВрдбреНрд░реЙрдЗрдб рдорд╛рдЗрдЯреИрдк рдШреЛрд╖рдгрд╛</a></li>
<li><a href="../hi467901/index.html">рдЬрдВрдЧ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд╛рд░ рд╕реНрдЯреАрд░рд┐рдпреЛрдЯрд╛рдЗрдк рдХрд╛ рдЦрдВрдбрди рдХрд░реЗрдВ</a></li>
<li><a href="../hi467903/index.html">IntelliJ IDEA рдкрд░ рд╢реАрд░реНрд╖ 20 рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╕реБрд╡рд┐рдзрд╛рдПрдБред рднрд╛рдЧ 1</a></li>
<li><a href="../hi467905/index.html">рд╣рдордиреЗ рдХреНрд▓рд╛рдЙрдб Mail.ru рдореЗрдВ рд▓реИрдВрдбрдорд╛рд░реНрдХ рдкрд╣рдЪрд╛рди рдХреИрд╕реЗ рдмрдирд╛рдИ, рдФрд░ рдХреНрдпреЛрдВ</a></li>
<li><a href="../hi467907/index.html">рдЖрдЙрдЯрд╕реЛрд░реНрд╕рд┐рдВрдЧ рдХреЗ рдкреЗрд╢реЗрд╡рд░реЛрдВ рдФрд░ рд╡рд┐рдкрдХреНрд╖</a></li>
<li><a href="../hi467913/index.html">рд╕реМрд░ рдкреИрдирд▓ рдХреЗ рд▓рд┐рдП "рдХрдореАрдиреЗ рдЦрдирд┐рдЬ", рдпрд╛ рдирдП рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдХреИрд╕реЗ рд╕реБрдзрд╛рд░реЗрдВ</a></li>
<li><a href="../hi467915/index.html">рдирд┐рдЧрд░рд╛рдиреА Openshift рдХреЗ рдЕрдВрджрд░ рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдЯ рдХрд░рддреА рд╣реИ</a></li>
<li><a href="../hi467917/index.html">рдкреНрд░рдмрдВрдзрди рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕</a></li>
<li><a href="../hi467919/index.html">рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдЙрдирдХреЗ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рдмреИрдЪ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреА рд╕рдорд╕реНрдпрд╛рдПрдВ (рднрд╛рдЧ 2)</a></li>
<li><a href="../hi467921/index.html">рдзреВрд▓ рднрд░реЗ рдкреЗрди рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдВ: рд▓рд┐рдЦрд╛рд╡рдЯ рджрд┐рдорд╛рдЧ рдХреЗ рд▓рд┐рдП рдЕрдЪреНрдЫреА рд╣реЛрддреА рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>