<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ¤ ğŸ§—ğŸ» ğŸŒ§ï¸ Laraveläº‹ä»¶æŠ•å½±ä»ªå’Œäº‹ä»¶ç”Ÿæˆæ¦‚å¿µ ğŸ˜ ğŸ¤¡ ğŸ›ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬æ–‡çš„ç¿»è¯‘æ˜¯ä¸ºä¸“ä¸šè¯¾ç¨‹â€œ Framework Laravelâ€çš„å­¦ç”Ÿå‡†å¤‡çš„ 



 Frek Van der Hertenå’ŒSpatieå›¢é˜Ÿåœ¨Laravel Event Projectorä¸Šè¿›è¡Œäº†å¾ˆé•¿æ—¶é—´çš„å·¥ä½œï¼Œè¯¥è½¯ä»¶åŒ…ä½¿æ‚¨å¯ä»¥å°†Event Sourcingæ¦‚å¿µåº”ç”¨äºLaravelæ¡†æ¶ã€‚ æœ€åï¼Œç¬¬...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Laraveläº‹ä»¶æŠ•å½±ä»ªå’Œäº‹ä»¶ç”Ÿæˆæ¦‚å¿µ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/460683/"><p><img src="https://habrastorage.org/webt/b4/bo/ka/b4bokaxkzrjiulofshu9vowttiq.png"></p><br><p> æœ¬æ–‡çš„ç¿»è¯‘æ˜¯ä¸ºä¸“ä¸šè¯¾ç¨‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ Framework Laravelâ€çš„</a>å­¦ç”Ÿå‡†å¤‡çš„ </p><br><hr><br><p>  Frek Van der Hertenå’ŒSpatieå›¢é˜Ÿåœ¨Laravel Event Projectorä¸Šè¿›è¡Œäº†å¾ˆé•¿æ—¶é—´çš„å·¥ä½œï¼Œè¯¥è½¯ä»¶åŒ…ä½¿æ‚¨å¯ä»¥å°†Event Sourcingæ¦‚å¿µåº”ç”¨äºLaravelæ¡†æ¶ã€‚ æœ€åï¼Œç¬¬ä¸€ä¸ªç¨³å®šç‰ˆæœ¬ï¼ˆv1.0.0ï¼‰å¯ç”¨ï¼ </p><br><p> æ‚¨å¯ä»¥ä½¿ç”¨composerå°†Event Projectorå®‰è£…åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”ç”±äºLaravelä¸­çš„è‡ªåŠ¨æ•°æ®åŒ…æ£€æµ‹åŠŸèƒ½ï¼Œå› æ­¤åœ¨å‘å¸ƒè½¯ä»¶åŒ…è¿ç§»å’Œé…ç½®åå³å¯ç«‹å³å¼€å§‹å·¥ä½œï¼ <a name="habracut"></a></p><br><pre><code class="php hljs">composer <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> spatie/laravel-event-projector:^<span class="hljs-number"><span class="hljs-number">1.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span></code> </pre> <br><p>  Event Projectoréœ€è¦PHP 7.2ï¼Œå› æ­¤æ‚¨çš„åº”ç”¨ç¨‹åºå¿…é¡»æ”¯æŒæœ€æ–°ç‰ˆæœ¬çš„PHPï¼Œå°½ç®¡Laravelæ¡†æ¶æœ¬èº«éœ€è¦çš„PHPç‰ˆæœ¬è‡³å°‘ä¸º7.1.3ã€‚ </p><br><h1 id="chto-takoe-porozhdenie-sobytiy"> ä»€ä¹ˆæ˜¯â€œäº‹ä»¶ç”Ÿæˆâ€ </h1><br><p> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”Ÿæˆäº‹ä»¶ä¸€æ–‡ä¸­ï¼Œ</a>æ­¤æ¦‚å¿µæè¿°å¦‚ä¸‹ï¼š </p><br><blockquote> è€Œä¸æ˜¯å°†æ•°æ®çš„å½“å‰çŠ¶æ€å­˜å‚¨åœ¨åŸŸä¸­ï¼Œè€Œæ˜¯ç”¨äºè®°å½•å¯¹æ­¤æ•°æ®æ‰§è¡Œçš„æ•´ä¸ªæ“ä½œåºåˆ—ï¼Œè€Œæ˜¯åœ¨ä»…é™„åŠ æ¨¡å¼ä¸‹æ“ä½œçš„å­˜å‚¨ä»…æ·»åŠ æ•°æ®ã€‚ è¯¥å­˜å‚¨å……å½“è®°å½•ç³»ç»Ÿï¼Œå¯ç”¨äºå®ç°åŸŸå¯¹è±¡ã€‚ è¿™ä½¿æˆ‘ä»¬å¯ä»¥ç®€åŒ–å¤æ‚ä¸»é¢˜é¢†åŸŸä¸­çš„ä»»åŠ¡ï¼Œå› ä¸ºä¸éœ€è¦åŒæ­¥æ•°æ®æ¨¡å‹å’Œä¸»é¢˜é¢†åŸŸï¼Œä»è€Œæé«˜äº†å¯ä¼¸ç¼©æ€§ï¼Œæé«˜äº†ç”Ÿäº§ç‡å’Œè¿è¥æ•ˆç‡ã€‚ è¿™ç§æ–¹æ³•å¯ä»¥ç¡®ä¿äº‹åŠ¡æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè¿˜å¯ä»¥ä½¿æ‚¨ä¿ç•™å®Œæ•´çš„æ›´æ”¹æ—¥å¿—å’Œå†å²è®°å½•ï¼Œä»è€Œå¯ä»¥æ‰§è¡Œè¡¥å¿æ€§æ“ä½œã€‚ </blockquote><p> æˆ‘å»ºè®®æ‚¨é˜…è¯»å…¨æ–‡ã€‚ å®ƒæä¾›äº†å¯¹è¯¥æ¨¡æ¿çš„å‡ºè‰²æè¿°ï¼Œè¡¨è¾¾äº†æ­£ç¡®ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹ï¼Œå¹¶æè¿°äº†å¯èƒ½æœ‰ç”¨çš„æƒ…å†µã€‚ </p><br><p> æˆ‘è¿˜å–œæ¬¢å¯¹äº‹ä»¶ç”Ÿæˆçš„æ¦‚å¿µçš„è§£é‡Šï¼Œè¯¥è§£é‡Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨</a> Event Projectoræ–‡æ¡£<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„ç®€ä»‹ä¸­</a>ç»™å‡ºï¼š </p><br><blockquote> å…³äºæ•°æ®çš„äº‹ä»¶ç”Ÿæˆä¸å…³äºä»£ç çš„Gitç›¸åŒã€‚ å¤§å¤šæ•°åº”ç”¨ç¨‹åºä»…å°†å…¶å½“å‰çŠ¶æ€å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ å¤§é‡æœ‰ç”¨çš„ä¿¡æ¯ä¸¢å¤±äº†-æ‚¨ä¸çŸ¥é“åº”ç”¨ç¨‹åºå¦‚ä½•è¾¾åˆ°æ­¤çŠ¶æ€ã€‚ <br><br> äº‹ä»¶ç”Ÿæˆçš„æ¦‚å¿µæ˜¯é€šè¿‡ä¿å­˜åº”ç”¨ç¨‹åºä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶æ¥è§£å†³æ­¤é—®é¢˜çš„å°è¯•ã€‚ åº”ç”¨ç¨‹åºçš„çŠ¶æ€æ˜¯é€šè¿‡ä¾¦å¬è¿™äº›äº‹ä»¶è€Œå½¢æˆçš„ã€‚ <br><br> ä¸ºäº†ä¾¿äºç†è§£ï¼Œè¯·è€ƒè™‘ç”Ÿæ´»ä¸­çš„ä¸€ä¸ªå°ä¾‹å­ã€‚ å‡è®¾æ‚¨æ˜¯ä¸€å®¶é“¶è¡Œã€‚ æ‚¨çš„å®¢æˆ·æœ‰å¸æˆ·ã€‚ ä»…ä¿ç•™æœ‰å…³å¸æˆ·ä½™é¢çš„ä¿¡æ¯æ˜¯ä¸å¤Ÿçš„ã€‚ æ‚¨è¿˜å¿…é¡»è®°ä½æ‰€æœ‰äº¤æ˜“ã€‚ ä½¿ç”¨äº‹ä»¶ç”Ÿæˆæ¨¡æ¿æ—¶ï¼Œå¸æˆ·ä½™é¢å°†ä¸ä»…æ˜¯æ•°æ®åº“ä¸­çš„å•ç‹¬å­—æ®µï¼Œè€Œæ˜¯æ ¹æ®å­˜å‚¨çš„äº¤æ˜“ä¿¡æ¯è®¡ç®—å‡ºçš„å€¼ã€‚ è¿™åªæ˜¯äº‹ä»¶ç”Ÿæˆæ¦‚å¿µæä¾›çš„ä¼—å¤šå¥½å¤„ä¹‹ä¸€ã€‚ <br><br> è¯¥è½¯ä»¶åŒ…æ—¨åœ¨ä½¿Laravelæ¡†æ¶çš„ç”¨æˆ·ç†Ÿæ‚‰äº‹ä»¶ç”Ÿæˆçš„æ¦‚å¿µï¼Œå¹¶ä¿ƒè¿›å…¶åœ¨å®è·µä¸­çš„ä½¿ç”¨ã€‚ </blockquote><p> ä¼¼ä¹Event Projectoræœ‰åŠ©äºç®€åŒ–äº‹ä»¶ç”Ÿæˆæ¨¡å¼çš„å·¥ä½œã€‚ è¯¥æ–‡æ¡£è¿˜å¸®åŠ©æˆ‘å¼„æ¸…æ¥šäº†å¦‚ä½•å°†è¿™ç§æ–¹æ³•ç”¨ä½œæˆ‘å·²ç»çŸ¥é“çš„Laravelæ¡†æ¶æ¦‚å¿µçš„ä¸€éƒ¨åˆ†ã€‚ </p><br><h1 id="osnovy-porozhdeniya-sobytiy-v-laravel">  Laravel EventingåŸºç¡€ </h1><br><p> è¦äº†è§£Event Projectorç¨‹åºåŒ…ä¸­äº‹ä»¶ç”Ÿæˆçš„å·¥ä½œæ–¹å¼ä»¥åŠæ­¤è¿‡ç¨‹æ¶‰åŠå“ªäº›ç»„ä»¶ï¼Œæ‚¨åº”è¯¥é˜…è¯»â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ›å»ºç¬¬ä¸€ä¸ªæŠ•å½±ä»ªâ€</a>éƒ¨åˆ†ã€‚ </p><br><p> åœ¨è¾ƒé«˜çš„å±‚æ¬¡ä¸Šï¼ˆè¯·åŸè°…ï¼Œå¦‚æœæˆ‘çš„è¯„ä¼°ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºäº‹ä»¶çš„ç”Ÿæˆå¯¹æˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼‰ï¼Œä½¿ç”¨äº‹ä»¶æŠ•å½±ä»ªè¿›è¡Œçš„äº‹ä»¶ç”ŸæˆåŒ…æ‹¬ï¼š </p><br><ul><li> é›„è¾©çš„æ¨¡å‹ </li><li> å®ç°ShouldBeStoredæ¥å£çš„äº‹ä»¶ </li><li> æŠ•å½±æœºç±» </li></ul><br><p> æ–‡æ¡£ä¸­æä¾›çš„å¸¦æœ‰<code>createWithAttributes</code>é™æ€æ–¹æ³•çš„æ¨¡å‹ç±»ç¤ºä¾‹ï¼š </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Events</span></span>\<span class="hljs-title"><span class="hljs-title">AccountCreated</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Events</span></span>\<span class="hljs-title"><span class="hljs-title">AccountDeleted</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Events</span></span>\<span class="hljs-title"><span class="hljs-title">MoneyAdded</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Events</span></span>\<span class="hljs-title"><span class="hljs-title">MoneySubtracted</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Eloquent</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Ramsey</span></span>\<span class="hljs-title"><span class="hljs-title">Uuid</span></span>\<span class="hljs-title"><span class="hljs-title">Uuid</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Account</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $guarded = []; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $casts = [ <span class="hljs-string"><span class="hljs-string">'broke_mail_send'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'bool'</span></span>, ]; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createWithAttributes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $attributes)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Account</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* *      (uuid). */</span></span> $attributes[<span class="hljs-string"><span class="hljs-string">'uuid'</span></span>] = (string) Uuid::uuid4(); <span class="hljs-comment"><span class="hljs-comment">/* *          uuid. */</span></span> event(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AccountCreated($attributes)); <span class="hljs-comment"><span class="hljs-comment">/* *         uuid. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>::uuid($attributes[<span class="hljs-string"><span class="hljs-string">'uuid'</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addMoney</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $amount)</span></span></span><span class="hljs-function"> </span></span>{ event(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MoneyAdded(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;uuid, $amount)); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">subtractMoney</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $amount)</span></span></span><span class="hljs-function"> </span></span>{ event(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MoneySubtracted(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;uuid, $amount)); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ event(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AccountDeleted(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;uuid)); } <span class="hljs-comment"><span class="hljs-comment">/* *         uuid. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uuid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $uuid)</span></span></span><span class="hljs-function">: ?</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Account</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>::where(<span class="hljs-string"><span class="hljs-string">'uuid'</span></span>, $uuid)-&gt;first(); } }</code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæ‚¨éœ€è¦æ³¨æ„åˆ†åˆ«è§¦å‘çš„äº‹ä»¶<code>AccountCreated</code> ï¼Œ <code>MoneyAdded</code> ï¼Œ <code>MoneySubtracted</code>å’Œ<code>AccountDeleted</code> ï¼Œä»¥æ‰“å¼€ä¸€ä¸ªå¸æˆ·ï¼Œå‘è¯¥å¸æˆ·æ·»åŠ èµ„é‡‘ï¼Œä»è¯¥å¸æˆ·æå–èµ„é‡‘å¹¶åˆ é™¤è¯¥å¸æˆ·ã€‚ </p><br><p> ä¸‹é¢æ˜¯<code>MoneyAdded</code>äº‹ä»¶çš„ç¤ºä¾‹ï¼ˆå‘å¸æˆ·æ·»åŠ èµ„é‡‘ï¼‰ã€‚  ShouldBeStoredæ¥å£å‘ŠçŸ¥Event Projectorç¨‹åºåŒ…åº”ä¿å­˜æ­¤äº‹ä»¶ï¼š </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Events</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Spatie</span></span>\<span class="hljs-title"><span class="hljs-title">EventProjector</span></span>\<span class="hljs-title"><span class="hljs-title">ShouldBeStored</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MoneyAdded</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ShouldBeStored</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $accountUuid; <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> int */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $amount; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $accountUuid, int $amount)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;accountUuid = $accountUuid; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;amount = $amount; } }</code> </pre> <br><p> æœ€åï¼ŒæŠ•å½±ä»ªç±»ä¸­çš„äº‹ä»¶å¤„ç†ç¨‹åºçš„ä¸€ä¸ªå±€éƒ¨ç¤ºä¾‹ï¼Œç”¨äºè¡¥å……å¸æˆ·ä¸­çš„èµ„é‡‘ï¼ˆæˆ‘æœ€å–œæ¬¢çš„é“¶è¡Œäº‹ä»¶ç±»å‹ï¼‰ï¼š </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMoneyAdded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MoneyAdded $event)</span></span></span><span class="hljs-function"> </span></span>{ $account = Account::uuid($event-&gt;accountUuid); $account-&gt;balance += $event-&gt;amount; $account-&gt;save(); }</code> </pre> <br><p> è¦å°†æ‰€æœ‰è¿™äº›é“¾æ¥åœ¨ä¸€èµ·ï¼Œè¯·è€ƒè™‘æ–‡æ¡£ä¸­çš„æœ‰å…³åˆ›å»ºæ–°å¸æˆ·å’Œæ·»åŠ èµ„é‡‘çš„ç¤ºä¾‹ï¼š </p><br><pre> <code class="php hljs">Account::createWithAttributes([<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Luke'</span></span>]); Account::createWithAttributes([<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Leia'</span></span>]); $account = Account::where([<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Luke'</span></span>])-&gt;first(); $anotherAccount = Account::where([<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'Leia'</span></span>])-&gt;first(); $account-&gt;addMoney(<span class="hljs-number"><span class="hljs-number">1000</span></span>); $anotherAccount-&gt;addMoney(<span class="hljs-number"><span class="hljs-number">500</span></span>); $account-&gt;subtractMoney(<span class="hljs-number"><span class="hljs-number">50</span></span>);</code> </pre> <br><p> æˆ‘æ€€ç–‘å¢å…‹å’Œè±äºšå¸æˆ·ä¸­çš„ä½™é¢æ˜¯ä»¥é“¶æ²³æ ‡å‡†è´·æ¬¾è¡¨ç¤ºçš„ï¼Œå°½ç®¡æ€»çš„æ¥è¯´ï¼Œæˆ‘æ€€ç–‘å®ƒä»¬ä¼šå…¬å¼€è¿›è¡Œæ­¤ç±»æ“ä½œã€‚ </p><br><p> ä½¿ç”¨æ­¤ç¨‹åºåŒ…ç”Ÿæˆäº‹ä»¶çš„ä»¥ä¸‹ä¼˜ç‚¹ä¹Ÿå¸å¼•äº†æˆ‘çš„æ³¨æ„åŠ›ï¼Œè¿™åœ¨æ–‡æ¡£ä¸­æœ‰æ‰€è¯´æ˜ï¼š </p><br><blockquote> ä½¿ç”¨æŠ•å½±æœºæ—¶æœ‰è¶£çš„ä¸€ç‚¹-å®ƒä»¬å¯ä»¥åœ¨äº‹ä»¶å‘ç”Ÿååˆ›å»ºã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œé“¶è¡Œå¸Œæœ›æ”¶åˆ°æ¯ä¸ªå¸æˆ·çš„å¹³å‡ä½™é¢æŠ¥å‘Šã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ›å»ºæ–°çš„æŠ•å½±ä»ªï¼Œæ’­æ”¾æ‰€æœ‰äº‹ä»¶å¹¶æœ€ç»ˆè·å–æ­¤æ•°æ®å°±è¶³å¤Ÿäº†ã€‚ </blockquote><p> åœ¨æ´»åŠ¨ç»“æŸæ—¶åˆ›å»ºæ–°æŠ•å½±ä»ªçš„æƒ³æ³•ä¼¼ä¹å¾ˆæœ‰å¸Œæœ›ã€‚ äº‹å®è¯æ˜ï¼Œæ‚¨ä¸å¿…äº‹å…ˆè·å–æ‰€æœ‰â€œæ­£ç¡®çš„â€æ•°æ®ï¼Œä½†æ˜¯æ‚¨å¯ä»¥è¿­ä»£å¾—å‡ºç»“æœã€‚ </p><br><p> å…³äºæ€§èƒ½ï¼Œæ ¹æ®æ–‡æ¡£ï¼Œå¯¹æŠ•å½±ä»ªçš„è®¿é—®â€œéå¸¸å¿«â€ã€‚ </p><br><h1 id="hotite-uznat-bolshe"> æƒ³äº†è§£æ›´å¤šï¼Ÿ </h1><br><p> é¦–å…ˆï¼Œå»ºè®®æ‚¨é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Event Projectoræ–‡æ¡£</a> ï¼Œå¹¶ç¡®ä¿å·²å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„PHP 7.2ã€‚  Spatieå›¢é˜Ÿè¿˜åœ¨Laravelä¸Šä¸Šä¼ äº†ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¤ºä¾‹åº”ç”¨ç¨‹åº</a> ï¼Œå±•ç¤ºäº†Event Projectorè½¯ä»¶åŒ…çš„åŠŸèƒ½ã€‚ </p><br><p> æ‚¨å¯ä»¥ä¸‹è½½ä»£ç ï¼Œç”¨æ˜Ÿå·æ ‡è®°å­˜å‚¨åº“ï¼Œè¿˜å¯ä»¥ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHubä¸Š</a>çš„Event Projectoré¡¹ç›®çš„å¼€å‘åšå‡ºè´¡çŒ®ã€‚ åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œé¡¹ç›®Event Projectorå·²ç»æœ‰15ä½å‚ä¸è€…ï¼Œä»–ä»¬çš„åŠªåŠ›ä½¿1.0çš„ç¨³å®šç‰ˆæœ¬æˆä¸ºå¯èƒ½ã€‚ å¹²å¾—å¥½ï¼ŒSpatieï¼ æˆ‘ç›¸ä¿¡Event Projectorå°†æ˜¯Laravelç¤¾åŒºä¼šèµèµçš„å¦ä¸€ä¸ªå¾ˆæ£’çš„è½¯ä»¶åŒ…ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN460683/">https://habr.com/ru/post/zh-CN460683/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN460667/index.html">åœ¨iOSä¸Šè‡ªåŠ¨æµ‹è¯•ä»˜è´¹æœåŠ¡</a></li>
<li><a href="../zh-CN460669/index.html">å¦‚ä½•ç¡®ä¿å¼€å‘çš„å®‰å…¨æ€§ï¼ŒèŠ‚çœæ—¶é—´å’Œç¥ç»</a></li>
<li><a href="../zh-CN460671/index.html">Dçš„æ‰€æœ‰æƒå’Œå€Ÿæ¬¾</a></li>
<li><a href="../zh-CN460673/index.html">å±•ç°DiffUtilçš„é­”åŠ›</a></li>
<li><a href="../zh-CN460675/index.html">æœºå™¨å­¦ä¹ æ•°æ®æå–</a></li>
<li><a href="../zh-CN460685/index.html">æˆ‘ä»¬ä½¿ç”¨nginxåˆ†å‘Googleäº‘ç«¯ç¡¬ç›˜ä¸­çš„æ–‡ä»¶</a></li>
<li><a href="../zh-CN460687/index.html">ä»å†…éƒ¨çœ‹ç½å¤´</a></li>
<li><a href="../zh-CN460695/index.html">ä»€ä¹ˆæ˜¯DAAï¼Œè¯¥ç³»ç»Ÿå¦‚ä½•å¸®åŠ©æ— äººæœºï¼Ÿ</a></li>
<li><a href="../zh-CN460697/index.html">æœ€å°çš„å­—ä½“</a></li>
<li><a href="../zh-CN460699/index.html">ã€Šå“ˆä¼¯å‘¨åˆŠã€‹ç¬¬10æœŸ/è¶…çº§æœåŠ¡å’Œç”µå­æŠ¤ç…§ï¼Œæ™ºèƒ½æ‰‹æœºå’Œä¿„ç½—æ–¯äººï¼Œâ€œé—´è°å°å·¥å…·â€ï¼Œæ— å«æ˜Ÿç”Ÿæ´»</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>