<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßùüèæ üë®üèΩ‚Äçüöí üçì Editando arquivos CSV para n√£o quebrar dados üñïüèΩ ü•ü üåΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os produtos HFLabs em volumes industriais processam dados: endere√ßos, nomes completos, detalhes da empresa e at√© uma carruagem no total. Naturalmente,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Editando arquivos CSV para n√£o quebrar dados</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/432906/"><img src="https://habrastorage.org/webt/xr/j1/ia/xrj1ia0lo_magqpxw2sr51g-9dg.jpeg"><br><br>  Os produtos HFLabs em volumes industriais processam dados: endere√ßos, nomes completos, detalhes da empresa e at√© uma carruagem no total.  Naturalmente, os testadores lidam com esses dados todos os dias: atualizam os casos de teste, estudam os resultados da limpeza.  Freq√ºentemente, os clientes fornecem uma base "ativa" ao testador para configurar o servi√ßo para ele. <br><br>  A primeira coisa que ensinamos aos novos QAs √© salvar os dados em sua forma original.  Tudo de acordo com os conv√™nios: "N√£o fa√ßa mal".  Neste artigo, mostrarei como trabalhar com cuidado com arquivos CSV no Excel e no Open Office.  As dicas ajudar√£o a n√£o estragar nada, salvar informa√ß√µes ap√≥s a edi√ß√£o e geralmente se sentir mais confiante. <br><br>  <i>O material √© b√°sico, os profissionais definitivamente ficar√£o entediados.</i> <br><a name="habracut"></a><br><h2>  O que s√£o arquivos CSV? </h2><br>  O formato CSV √© usado para armazenar tabelas em arquivos de texto.  Os dados geralmente s√£o compactados em tabelas; portanto, os arquivos CSV s√£o muito populares. <br><br><img src="https://habrastorage.org/webt/ya/z5/vw/yaz5vwq0sruyxaqvir0cnxvu7je.png"><br>  <sub>Um arquivo CSV consiste em linhas de dados e delimitadores que indicam os limites da coluna</sub> <br><br>  CSV significa valores separados por v√≠rgula - "valores separados por v√≠rgulas".  Mas n√£o se deixe enganar pelo nome: ponto e v√≠rgula e guias podem servir como separadores de coluna em um arquivo CSV.  Ainda ser√° um arquivo CSV. <br><br>  O CSV possui muitas vantagens sobre o mesmo formato do Excel: os arquivos de texto s√£o simples como um bot√£o, abrem rapidamente, s√£o lidos em qualquer dispositivo e ambiente, sem ferramentas adicionais. <br><br>  Por causa de suas vantagens, o CSV √© um formato de troca de dados muito popular, embora j√° tenha 40 anos e usa aplicativos industriais, eles baixam dados de bancos de dados. <br><br>  Um problema - um editor de texto para trabalhar com CSV n√£o √© suficiente.  Ainda assim, se a tabela for simples: no primeiro campo o ID √© do mesmo tamanho, no segundo a data tem o mesmo formato e no terceiro h√° algum endere√ßo.  Mas quando os campos de comprimentos diferentes e h√° mais de tr√™s, o tormento come√ßa. <br><br><img src="https://habrastorage.org/webt/cv/lb/mm/cvlbmmwfjujdiowdolcfjgwbiik.png"><br>  <sub>Acompanhe divisores e colunas - voc√™ quebra os olhos</sub> <br><br>  Pior ainda com a an√°lise de dados - tente o Bloco de notas para adicionar pelo menos todos os n√∫meros em uma coluna.  N√£o estou falando de belos gr√°ficos. <br><br>  Portanto, os arquivos CSV s√£o analisados ‚Äã‚Äãe editados no Excel e seus an√°logos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Open Office</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LibreOffice</a> e outros. <br><br>  <i>Para os veteranos que, no entanto, l√™em: pessoal, conhecemos a an√°lise diretamente no banco de dados usando SQL, conhecemos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tableau</a> e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Talend Open Studio</a> .</i>  <i>Este artigo √© para iniciantes, mas em um n√≠vel b√°sico e uma pequena quantidade de dados do Excel com an√°logos √© suficiente.</i> <br><br><h2>  Como o Excel atrapalha os dados: dos cl√°ssicos </h2><br>  Tudo ficaria bem, mas o Excel, mal abrindo o arquivo CSV, inicia seus truques astutos.  Ele altera os dados sem demanda, para que eles se tornem in√∫teis.  E ele faz isso completamente despercebido.  Por causa disso, ao mesmo tempo, pegamos v√°rios problemas. <br><br>  A maioria dos incidentes se deve ao fato de o programa converter seq√º√™ncias de caracteres com um conjunto de n√∫meros em n√∫meros sem demanda. <br><br>  <b>Arredonda.</b>  Por exemplo, na c√©lula original, dois telefones s√£o armazenados separados por v√≠rgulas sem espa√ßos: "5235834.5235835".  O que o Excel far√°?  Famosamente converte n√∫meros em um n√∫mero e arredonda para duas casas decimais: "5235834.52".  Ent√£o perdemos o segundo telefone. <br><br>  <b>Leva √† forma exponencial.</b>  O Excel converte cuidadosamente "123456789012345" para o n√∫mero "1,2E + 15".  Perdemos completamente o valor original. <br><br>  O problema √© relevante para caracteres longos, de quinze linhas num√©ricas.  Por exemplo, c√≥digos CLADR (este √© um identificador de estado de um objeto de endere√ßo: cidade, rua, casa). <br><br>  <b>Remove as principais vantagens.</b>  O Excel acredita que o sinal de mais no in√≠cio de uma linha com n√∫meros √© um caractere completamente sup√©rfluo.  Como, e √© t√£o claro que o n√∫mero √© positivo, pois n√£o h√° menos na frente dele.  Portanto, o sinal de adi√ß√£o inicial no n√∫mero "+74955235834" ser√° descartado como desnecess√°rio - resultar√° em "74955235834".  (Na realidade, o n√∫mero sofrer√° ainda mais, mas, para maior clareza, vou me dar bem com o sinal de mais). <br><br>  A perda de um sinal de adi√ß√£o √© cr√≠tica, por exemplo, se os dados forem para um sistema de terceiros e esse verificar rigidamente o formato ao importar. <br><br>  <b>Divide tr√™s d√≠gitos.</b>  O Excel √© uma boa alma que analisa uma cadeia digital com mais de tr√™s caracteres.  Por exemplo, "8 495 5235834" se transformar√° em "84 955 235 834". <br><br>  A formata√ß√£o √© importante, pelo menos para os n√∫meros de telefone: os espa√ßos separam os c√≥digos de pa√≠s e cidade do resto do n√∫mero e um do outro.  O Excel viola facilmente a divis√£o correta do telefone. <br><br>  <b>Remove zeros √† esquerda.</b>  O Excel transformar√° a sequ√™ncia "00523446" em "523446". <br>  E no TIN, por exemplo, os dois primeiros d√≠gitos s√£o o c√≥digo da regi√£o.  Para a Rep√∫blica de Altai, come√ßa do zero - "04".  Sem zero, o significado do n√∫mero ser√° distorcido e a verifica√ß√£o do formato INN n√£o passar√°. <br><br>  <b>Altera as datas para as configura√ß√µes locais.</b>  O Excel corrige com prazer o n√∫mero da casa "1/2" a "01 de fevereiro".  Como o Windows sugeriu que, neste formul√°rio, √© mais conveniente ler as datas. <br><br><h2>  Derrubamos a corrup√ß√£o de dados importando adequadamente </h2><br>  Mas, falando s√©rio, o Excel n√£o √© o culpado pelos problemas, mas uma maneira √≥bvia de importar dados para o programa. <br><br>  Por padr√£o, o Excel aplica o tipo Geral aos dados no arquivo CSV baixado - o tipo geral.  Por causa disso, o programa reconhece seq√º√™ncias digitais como n√∫meros.  Esse pedido pode ser derrotado usando a ferramenta de importa√ß√£o interna. <br><br>  <b>Inicio o mecanismo de importa√ß√£o interno no Excel.</b>  No menu, √© ‚ÄúDados ‚Üí Obter dados externos ‚Üí Do texto‚Äù. <br><br>  <b>Eu seleciono um arquivo CSV com dados, uma caixa de di√°logo √© aberta.</b>  Na caixa de di√°logo, clico no tipo de arquivo Delimitado (delimitado).  Codifica√ß√£o - a que est√° no arquivo geralmente √© determinada automaticamente.  Se a primeira linha do arquivo for um cabe√ßalho, marque "Meus dados t√™m cabe√ßalhos". <br><br>  <b>Passo para o segundo passo do di√°logo.</b>  Eu seleciono o separador de campos (geralmente um ponto e v√≠rgula - ponto e v√≠rgula).  Desligo ‚ÄúTrate delimitadores consecutivos como um‚Äù e defino ‚ÄúQualificador de texto‚Äù como ‚Äú{none}‚Äù.  (O qualificador de texto √© um s√≠mbolo do come√ßo e do fim do texto. Se o separador no CSV for uma v√≠rgula, ser√° necess√°rio o qualificador de texto para distinguir as v√≠rgulas dentro do texto das v√≠rgulas do separador.) <br><br>  <b>Na terceira etapa, escolhi o formato dos campos</b> , para o efeito tudo foi iniciado.  Para todas as colunas, defino o tipo como "Texto".  A prop√≥sito, se voc√™ clicar na primeira coluna, mantenha pressionada a tecla Shift e clique na √∫ltima, todas as colunas ser√£o destacadas de uma s√≥ vez.  Convenientemente. <br><br>  Em seguida, o Excel perguntar√° onde colar os dados do CSV - basta clicar em "OK" e os dados aparecer√£o em uma planilha aberta. <br><br><img src="https://habrastorage.org/webt/rl/rf/cw/rlrfcwbol_yygemdyub2caobfpk.gif"><br>  <sub>Voc√™ deve criar uma nova pasta de trabalho no Excel antes de importar</sub> <br><br>  <b>Mas!</b>  <b>Se pretendo adicionar dados ao CSV via Excel, h√° mais alguma coisa a fazer.</b> <br><br>  Ap√≥s a importa√ß√£o, √© necess√°rio for√ßar todas as c√©lulas da planilha para o formato "Texto".  Caso contr√°rio, os novos campos adquirir√£o o mesmo tipo geral. <br><br><ul><li>  Pressiono Ctrl + A duas vezes, o Excel seleciona todas as c√©lulas da planilha; </li><li>  Clico no bot√£o direito do mouse; </li><li>  Eu seleciono "Formatar c√©lulas" no menu de contexto; </li><li>  na caixa de di√°logo exibida, selecione o tipo de dados Texto √† esquerda. </li></ul><br><img src="https://habrastorage.org/webt/3s/ux/aw/3suxawbdhnfuj5mokakdb8v6y74.gif"><br>  <sub>Para selecionar todas as c√©lulas, voc√™ precisa pressionar Ctrl + A duas vezes.</sub>  <sub>Exatamente dois, isso n√£o √© uma piada, tente</sub> <br><br>  Depois disso, com alguma sorte, o Excel deixar√° os dados originais em paz.  Mas essa n√£o √© a garantia mais dif√≠cil; portanto, ap√≥s salvar, definitivamente verificaremos o arquivo atrav√©s de um visualizador de texto. <br><br><h2>  Alternativa: Open Office Calc </h2><br>  Para trabalhar com arquivos CSV, eu uso o Calc.  N√£o √© que eles n√£o considerem os dados digitais como cadeias de caracteres, mas pelo menos n√£o os aplique a reformata√ß√£o de acordo com as configura√ß√µes regionais do Windows.  Sim, e a importa√ß√£o √© mais simples. <br><br>  Obviamente, voc√™ precisar√° do pacote Open Office (OO).  Durante a instala√ß√£o, ele oferecer√° a reatribui√ß√£o de arquivos do MS Office para si mesmo.  N√£o recomendo: embora o OO seja bastante funcional, ele n√£o entende completamente a complicada formata√ß√£o de documentos da Microsoft. <br><br>  Mas tornar o OO o programa padr√£o para arquivos CSV √© bastante razo√°vel.  Voc√™ pode fazer isso depois de instalar o pacote. <br><br>  Ent√£o, come√ßamos a importa√ß√£o de dados do CSV.  Ap√≥s clicar duas vezes no arquivo, o Open Office exibe uma caixa de di√°logo. <br><br><img src="https://habrastorage.org/webt/xe/uh/zy/xeuhzy60ogakabxxxoiwc8pcdq8.png"><br>  <sub>Observe que no OO voc√™ n√£o precisa criar uma nova pasta de trabalho e for√ßar a importa√ß√£o a iniciar, por si s√≥</sub> <br><br><ol><li>  Codifica√ß√£o - como no arquivo. </li><li>  "Separador" √© um ponto e v√≠rgula.  Naturalmente, se √© precisamente o separador no arquivo. </li><li>  "Separador de texto" - vazio (igual ao Excel). </li><li>  Na se√ß√£o "Campos", clico no quadrado superior esquerdo da tabela, todas as colunas s√£o destacadas.  Eu indico o tipo de "Texto". </li></ol><br>  Uma coisa que estragou muito sangue: se voc√™ selecionar erroneamente v√°rios separadores de campos ou o texto errado for dividido, o arquivo poder√° abrir corretamente, mas poder√° ser salvo incorretamente. <br><br>  Al√©m do Calc, o libreOffice √© popular no HFLabs, especialmente no Linux.  Ambos s√£o usados ‚Äã‚Äãmais ativamente para CSV do que para o Excel. <br><br><h2>  Faixa de b√¥nus: problemas ao salvar do Calc em .xlsx </h2><br>  Se voc√™ salvar dados do Calc no formato .xlsx do Excel, lembre-se - o OO √†s vezes inexplicavelmente e em larga escala perde dados. <br><br><img src="https://habrastorage.org/webt/yv/bw/7u/yvbw7u8x4lzavz3hztn4pff9wvw.jpeg"><br>  <sub>O terreno baldio branco no meio √© ricamente preenchido com dados no arquivo CSV original</sub> <br><br>  Portanto, depois de salvar, eu abro o arquivo novamente e verifique se os dados est√£o no lugar. <br><br>  Se algo for perdido, o tratamento √© salvar de CSV para .xlsx.  Ou, se o Windows estiver instalado, importe de CSV para Excel e salve a partir da√≠. <br><br>  Ap√≥s salvar novamente, eu definitivamente verificarei mais uma vez se todos os dados est√£o no lugar e n√£o h√° linhas vazias extras. <br><br>  <i>Se voc√™ estiver interessado em trabalhar com dados, consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nossas vagas</a> .</i>  <i>O HFLabs quase sempre precisa de analistas, testadores, engenheiros de implementa√ß√£o, desenvolvedores.</i>  <i>Forneceremos dados para que pouco pare√ßa :)</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432906/">https://habr.com/ru/post/pt432906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432896/index.html">AXIS P1425-LE Mk II vs IDIS DC-T3233HRXL: Compare C√¢meras CFTV</a></li>
<li><a href="../pt432898/index.html">Panoramas no StereoPi</a></li>
<li><a href="../pt432900/index.html">Caracter√≠sticas do trabalho em equipe internacional. Jap√£o</a></li>
<li><a href="../pt432902/index.html">Falha no voo para a lua: o que ficou conhecido sobre uma das miss√µes</a></li>
<li><a href="../pt432904/index.html">Melhores Empregadores em TI 2018: Classifica√ß√£o Anual do Meu C√≠rculo</a></li>
<li><a href="../pt432908/index.html">Na R√∫ssia, eles planejam introduzir controle adicional sobre pagamentos na Internet</a></li>
<li><a href="../pt432910/index.html">√â perigoso considerar a realidade virtual como uma m√°quina de empatia</a></li>
<li><a href="../pt432912/index.html">Como obter um est√°gio no Google</a></li>
<li><a href="../pt432914/index.html">Um bot de bate-papo muito simples para o Telegram, para os menores</a></li>
<li><a href="../pt432918/index.html">Desculpe, eu quebrei o seu recovery.conf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>