<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🎨 🚶🏽 🚴🏼 在最简单的廉价手机上快速加载页面 ✴️ 👵🏾 🕸️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="标题中提到的那些电话，英文称为“功能电话”。 它们的功能极为不同。 此外，它们非常实惠，因为它们的价格在20-25美元左右。 可以将它们与现代智能手机的精简版进行比较。 这些电话使来自发展中国家的亿万人民能够使用网络资源。 

  
 Jio电话 

 如果该网站基于旨在确保其高速度工作的技术，那么...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在最简单的廉价手机上快速加载页面</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/482470/"> 标题中提到的那些电话，英文称为“功能电话”。 它们的功能极为不同。 此外，它们非常实惠，因为它们的价格在20-25美元左右。 可以将它们与现代智能手机的精简版进行比较。 这些电话使来自发展中国家的亿万人民能够使用网络资源。 <br><br> <a href="https://habr.com/ru/company/ruvds/blog/482470/"><img src="https://habrastorage.org/webt/o4/v5/wk/o4v5wkungxpcvrq2kf6r5aftnec.jpeg"></a> <br>  <i><font color="#999999">Jio电话</font></i> <br><br> 如果该网站基于旨在确保其高速度工作的技术，那么每个人都将从中受益-既是廉价手机的所有者，又是那些使用功能强大的智能手机观看网页的人。 <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">情况概述</font> </h2><br> 我们正在谈论的设备（功能手机）价格便宜。 因此，它们的硬件功能相当弱。 因此，他们使用的CPU速度很慢（例如，廉价手机的处理器可能比顶级智能手机的处理器慢6倍）。 他们安装的RAM很少（可能大约为256-512 MB，通常小于4 GB）。 用于存储数据的内部存储器容量也相同，通常不超过4 GB。 这样的电话通常没有触摸屏。 相反，它们具有用于导航目的的键盘和简单的操纵杆。  cdpv显示了类似手机的外观。 <br><br> 这些手机执行JavaScript代码的速度无法与高级智能手机一样快。 他们很难显示包含大量媒体数据的网站。 因此，要准备在此类电话上可以正常使用的页面，您需要负责任地解决填充这些页面的问题。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/698/1d8/750/6981d8750b03293f9cbf5c9d00352db1.png"></div><br>  <i><font color="#999999">十大现代智能手机：处理器性能（2019年上半年）</font></i> <br><br> 以上是2019年最畅销的10款智能手机的性能研究结果。 这项研究是使用<a href="https://www.geekbench.com/">Geekbench</a> 4基准进行的，在上部，您可以看到流行的廉价手机-诺基亚3110的测试结果。 <br><br> 页面的JavaScript内容主要是在单核模式下执行的（值得记住的是，就其本质而言，JS代码比其余Web内容更“单线程”），因此JavaScript的性能<a href="https://habr.com/ru/company/ruvds/blog/459296/">与</a>处理器功能息息相关。 这表明在考虑针对发展中国家的Web项目时，您需要记住那里使用的设备的特性。 <br><br> 该材料旨在解决开发速度较慢的设备的问题。 应用其中描述的技术，您可以创建一个方便所有人使用的网站-无论手机的性能如何。 <br><br><h2>  <font color="#3AC1EF">一般资讯</font> </h2><br> 也许您还记得，也许不是，但是在智能手机问世和广泛使用之前，我们称之为功能手机的手机一直流行到2000年代中期。 这些是带有键盘而不是触摸屏的紧凑型设备。 它们仅具有基本功能：拨打电话，发送短信，浏览网站，专注于页面的文本内容。 自智能手机问世以来，发达国家的简单手机数量有所下降。 <br><br> 在发展中国家，并非每个人都能负担得起智能手机和无限的4G资费。 这个市场已经被称为智能功能手机的设备所占领。 它们将简单手机的硬件和价格与智能手机特有的某些功能结合在一起。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9eb/77d/6d7/9eb77d6d71eb217326b18e6e90bad99d.png"></div><br>  <i><font color="#999999">便宜的电话</font></i> <br><br> 自2017年以来，具有智能手机功能的廉价手机市场显着增长。  <a href="https://www.counterpointresearch.com/more-than-a-billion-feature-phones-to-be-sold-over-next-three-years/">预计</a>到2019年，此类设备将在全球销售约4亿个。 <br><br> 诺基亚恢复了其旧的流行机型，例如诺基亚3110和8110（ <a href="https://paul.kinlan.me/debugging-web-pages-on-the-nokia-8110-with-kaios/">这是</a>在带有KaiOS的诺基亚8110上调试网页<a href="https://paul.kinlan.me/debugging-web-pages-on-the-nokia-8110-with-kaios/">的</a>指南），这促进了低成本手机市场的增长。 在印度， <a href="https://www.jio.com/">Reliance Jio</a>手机为用户提供了廉价而现代的移动访问Web资源的方式。  Jio为<a href="https://www.kaiostech.com/">KaiOS</a>的开发做出了贡献， <a href="https://www.kaiostech.com/">KaiOS</a>是一种基于Linux的操作系统，专为价格适中的简单手机而设计。 <br><br> 不断增长的简单电话市场已经产生了对可以在此类设备上有效工作的站点的需求。 要开发此类网站，您需要考虑一些限制。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6ea/986/057/6ea986057a14aac270eb089a748ce43f.jpg"></div><br>  <i><font color="#999999">专为低成本手机设计的各种项目</font></i> <br><br> 上一张图片显示了Google Images Lite和Facebook mBasic项目的屏幕。 这些项目可以在简单的电话上快速加载；它们对客户端脚本功能的依赖程度最低。 另一个屏幕截图是<a href="http://proxx.app/">Proxx</a>游戏，该游戏虽然严重依赖脚本，但使用激进的代码分离来加快加载速度。 <br><br><h2>  <font color="#3AC1EF">廉价电话的局限性</font> </h2><br> 发展中国家的低端电话用户受到三个因素的限制： <br><br><ul><li> 少量廉价的高质量设备。 </li><li> 高速通信网络无法访问。 </li><li> 数据传输成本高。 </li></ul><br> 对于那些想通过“功能手机的棱镜”来熟悉网络开发的人们，应该记住这些限制。 如果我们更详细地讨论此类电话的局限性以及使用它们的环境，我们将获得以下信息： <br><br><ol><li> 硬体 简单的电话通常具有较慢的（如1.1 GHz之类的）单核或双核处理器，并且RAM少于512 MB。 为了了解这如何限制设备的功能，请将其与多核处理器和4 GB RAM iPhone XS进行比较。 </li><li> 数据传输。 移动套餐越来越便宜，但是在可以分发低成本电话的地区，套餐仍然受到严重限制。 这意味着在开发用于功能手机的页面时，您应努力减少这些页面所包含的数据量。 这将使网站首先加载得更快，其次，可以减少用户访问此类网站的成本。 </li><li> 屏幕尺寸有限。 廉价电话的屏幕尺寸通常比智能手机的屏幕尺寸小得多。 我们正在谈论的对角线约为2.4英寸的屏幕。 这样的屏幕仅允许您显示数量非常有限的元素。 这意味着网站开发人员应努力下载要在屏幕上显示的内容。 </li><li> 缺少触摸屏。 如果设备未配备触摸屏，则意味着使用键盘处理页面时，应该可以轻松访问用户可以与之交互的所有内容。 您不应在页面上显示太多可以使用的元素。 </li><li> 琴键 在低成本手机上，使用的是硬件键盘，它与智能手机用户熟悉的屏幕上的QWERTY键盘完全不同。 硬件键盘大约有15个按键，其中多个按键用于输入一些字符。 结果，事实证明，就UX而言，有必要努力使对文本输入的需求最小化。 </li></ol><br> 应当指出，即使在日本，有限的资费计划也会影响用户使用网络资源的可用性。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ba6/ba9/8bf/ba6ba98bf319e9517a24b634002d59b4.jpg"></div><br>  <i><font color="#999999">日本4G设备的页面加载时间</font></i> <br><br> 上图是<a href="https://twitter.com/yoavweiss/status/1195036487538003968">此</a>推文中的图片，其中说到月底在日本，由于关税计划的限制，页面加载速度变慢。 <br><br><h2>  <font color="#3AC1EF">网站设计准则</font> </h2><br> 以下准则可帮助您设计可在简单，便宜的电话上快速运行的网站。 通常，应该指出的是，不建议用户等待未明确请求的内容的下载。 在任何可能的地方，您都应努力减少<a href="https://habr.com/ru/company/ruvds/blog/459296/">加载和执行</a> JavaScript代码所需的时间。 <br><br><h3>  <font color="#3AC1EF">▍设置首次加载站点时传输的数据量的限制</font> </h3><br> 从服务器到客户端的过程中，页面的每个字节都会遇到许多瓶颈。 这些是慢速且不可靠的网络，它们是慢速处理器。 保证页面性能的唯一保证方法是严格计划页面的容量并实现（甚至超额完成）计划。 <br><br> 页面性能目标是由开发团队努力为其项目提供良好性能的约束条件设定的。 这些是度量标准的局限性，因此决定不对其进行超越。 在可测量的指标上设置此类约束，并在工作开始之前设置约束，有助于团队在向其添加新功能时确保项目的绩效在给定框架之内。 <br><br> 可以限制的资源指标的示例包括JavaScript包的大小，图像的大小（以字节为单位）和HTTP请求的数量。 可以设置度量标准的限制，这些度量标准会影响用户对页面的感知方式，这些度量标准可以设置为“ <a href="https://web.dev/first-contentful-paint">第一满意涂料”</a> ，“ <a href="https://web.dev/lcp/">最大满意涂料”</a>或“ <a href="https://developers.google.com/web/updates/2018/05/first-input-delay">第一输入延迟”</a> 。 它们使您可以评估用户看到该页面的速度以及与该页面进行交互的时间。 您可以根据网站目标受众的特征为此类指标设置阈值。 <br><br> 您可以针对自己的应用程序代码以及第三方脚本和类似的东西开发一个限制系统。 可以<a href="https://web.dev/incorporate-performance-budgets-into-your-build-tools/">在项目构建</a>期间使用<a href="https://web.dev/use-lighthouse-for-performance-budgets/">Lighthouse</a> （LightWallet）在<a href="https://web.dev/using-bundlesize-with-travis-ci/">连续集成</a>系统中检查约束。 <br><br><h3>  <font color="#3AC1EF">▍使用PRPL模式</font> </h3><br>  Chrome开发团队建议使用<a href="https://developers.google.com/web/fundamentals/performance/prpl-pattern/">PRPL</a>模式来分阶段下载代码。 它旨在确保使用它的应用程序在低成本设备和慢速网络上尽快交互。  PRPL模式鼓励预加载使页面正常工作所需的最少JS代码量。 然后使用惰性加载技术加载资源。 如有必要，您可以使用服务工作者预缓存将来与网站进行交互所必需的JavaScript资源。 <br><br>  PRPL-50模式对等于50 Kb的初始加载资源量设置了限制。 由于低成本手机的硬件资源非常有限，因此您需要设置更严格的限制。 在这里，我建议您考虑PRPL-30模式。  30是30 Kb的源资源，这是第一页加载时加载的压缩和最小化包的大小。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f2e/35e/04c/f2e35e04c3af079f53e7c1dfc3b33ff7.png"></div><br>  <i><font color="#999999">30 Kb JS捆绑包中的空间分配示例。</font></i>  <i><font color="#999999">这包括应用程序逻辑，框架代码，帮助程序实用程序和第三方依赖项</font></i> <br><br> 通过这种方法，在SSL连接过程完成之后，来自良好边界缓存服务器的站点资料的第一个字节将在大约2秒钟内到达设备。 这使我们有3秒钟的时间来下载原始路线的材料，显示它们并为用户交互准备页面。 对于基于JavaScript的项目，这意味着在首页输出中加载的压缩压缩包的总大小不应超过30 Kb。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/112/b49/e61/112b49e61740d6816118163fb6c99302.jpg"></div><br>  <i><font color="#999999">使用PRPL-30模式，开发人员可以在大约5秒钟的时间内通过廉价电话将页面置于交互模式</font></i> <br><br> 也许这会让某人感到惊讶：“我们在说什么？ 原始捆绑大小为30 Kb？ 真奇怪 毕竟，我什至都不会把React和应用程序代码放到这个卷中！”应该注意的是，在开发针对真正薄弱的设备设计的站点时，为了用户方便，项目的创建者将不得不做出艰难的妥协。 例如，如果React的使用仅限于服务器呈现（1），听起来很明智，或者（2）包含应用程序逻辑的代码片段非常，非常小并且这在他们的准备中将应用最严格的延迟加载规则。 第三种选择-选择轻量级的React类似物，例如Preact（3）。 我们将在下面详细讨论这种妥协。 <br><br> 使用30 Kb限制创建的应用程序的示例为<a href="https://web.dev/proxx-announce/">Proxx</a> 。 初始项目数据集的大小为25 Kb，其区别在于TTI（交互时间）指示器小于5秒。  <a href="https://perf-budget-calculator.firebaseapp.com/">这是一个</a>计算器，可用于查找Web项目的目标并选择自己的限制。 <br><br> 在延迟模式下加载的路由的建议大小不超过35 Kb。 但是“片段”的大小在30-35 Kb范围内，也足够大，可以谈论使用<a href="https://blog.chromium.org/2015/03/new-javascript-techniques-for-rapid.html">V8的</a>脚本流处理功能的并行处理。 <br><br><h3>  <font color="#3AC1EF">▍保存JavaScript资源</font> </h3><br> 简而言之，如果我们谈论节省JavaScript资源，那么您可以使用<a href="https://developers.google.com/web/updates/2019/02/rendering-on-the-web">静态呈现</a>或<a href="https://developers.google.com/web/updates/2019/02/rendering-on-the-web">服务器呈现</a> ，而无需占用客户端脚本。 如果没有客户端或混合渲染是完全不可能的，那么仅应将特定路由所必需的那些脚本发送给客户端，最好是在尽可能少的数据传输会话中执行此操作。 在这里，您可以考虑一些技术，例如<a href="https://developers.google.com/web/updates/2019/02/rendering-on-the-web">逐步准备页面以便在浏览器中工作</a> 。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af2/6bd/c66/af26bdc663cdb5f2677d76a2c27ccb94.png"></div><br>  <i><font color="#999999">静态渲染</font></i> <br><br><h4>  JavaScript是简单手机的主要瓶颈 </h4><br> 当开发用于廉价电话的交互式项目时，请注意，JavaScript通常是实现高页面性能的主要绊脚石。 这很重要，因为用户可以使用它们的时间取决于决定<a href="https://developers.google.com/web/updates/2019/02/rendering-on-the-web">呈现页面的方式</a> 。 即使他使用电话操纵杆与他们合作。 如果决定使用服务器端或静态呈现，请尝试使组织页面的交互式工作所需的JS代码量尽可能少。 <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8be/e42/511/8bee425111e469cd3c7aedc8a3d4f4f3.png"></div><br>  <i><font color="#999999">URL输入；</font></i>  <i><font color="#999999">加载服务器渲染结果；</font></i>  <i><font color="#999999">加载使页面进入交互模式所需的JavaScript代码；</font></i>  <i><font color="#999999">页面可供用户交互</font></i> <br><br>  JavaScript的价格包含两个指标：代码的加载时间和执行时间。 网络速度较慢（例如，稳定的3G连接）会增加JS的启动时间。 较慢的处理器将增加执行脚本所需的时间。 下图显示了各种设备处理流行的reddit.com资源的JavaScript代码所需的时间。 不难看出，速度较慢的设备（Alcatel 1X 5059D）所花费的时间是速度较快的设备（Pixel 3）的6倍。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce8/d29/009/ce8d2900931e0bb624f134da413c8472.png"></div><br>  <i><font color="#999999">不同设备处理流行网站的JS代码所需的时间</font></i> <br><br> 如果页面的呈现或使其进入交互模式的过程在很大程度上取决于JavaScript，则可能会导致这样一个事实，即廉价手机的用户将不得不等待30-60秒才能获得使用用户界面的机会。 因此，为了减少加载和处理JavaScript所需的时间，开发人员应谨慎使用脚本，并仅下载用户可能需要的那些路线和组件的代码。 当需要适当的代码时，您需要执行此操作。 <br><br><h4> 努力使交互页面所需的代码量最少 </h4><br> 以下是一些技巧，可帮助最大程度地减少提供页面交互功能所需的代码量： <br><br><ol><li> 尽可能广泛使用延迟加载机制。 我们谈论的是路线，组件，屏幕可见区域之外的资源，关于不能确保页面健康的极其重要的内容。 </li><li> 使用<a href="https://web.dev/reduce-javascript-payloads-with-code-splitting/">代码</a>拆分机制将JavaScript代码拆分为多个部分，并仅下载用户使用初始路由时所需的内容。 通过减少已加载和已处理脚本的数量，这将导致更快的页面加载。 </li><li> 从JavaScript包中删除未使用的代码，以尽可能减小它们的大小。 为此，您将需要分析捆绑软件并识别那些根本不使用的库，以及可以用更紧凑的库替换的库，以适应项目的需求。 首次加载页面时未使用的库可以以惰性模式加载。 </li><li> 考虑使用<a href="https://web.dev/serve-modern-code-to-modern-browsers/">差分</a>代码<a href="https://web.dev/serve-modern-code-to-modern-browsers/">加载</a>机制。 这将允许您将现代JavaScript代码提供给现代浏览器，从而避免过多使用已转译的代码并避免使用polyfill。 减少旧版浏览器的代码可以提高现代浏览器的代码性能。 </li><li> 如果JS代码对于呈现页面和以交互方式显示其界面是绝对必要的，请组织必要脚本的<a href="https://web.dev/preload-critical-assets/">初步加载</a> 。 如下所示，相应的属性告诉浏览器该脚本很重要，需要尽快下载该脚本。 </li></ol><br><pre><code class="javascript hljs">&lt;link rel=<span class="hljs-string"><span class="hljs-string">"preload"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>=<span class="hljs-string"><span class="hljs-string">"script"</span></span> href=<span class="hljs-string"><span class="hljs-string">"critical.js"</span></span>&gt;</code> </pre> <br><h3>  <font color="#3AC1EF">▍精心选择所使用的技术堆栈</font> </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1dd/b9d/d60/1ddb9dd609c101c129aa52960ac83030.png"></div><br>  <i><font color="#999999">框架和实用程序</font></i> <br><br> 尽管使用第三方库可以加快开发速度并简化复杂问题的解决方案，但库的大小可能会很大。 在开发针对弱设备的项目时应谨慎使用它们。 以下是使用外部依赖项的一些准则： <br><br><ol><li> 廉价电话的资源非常有限。 因此，如果可能，请避免使用JS框架或限制其使用。 本技巧的目的是为应用程序逻辑留出尽可能多的空间。 在开发人员试图限制JavaScript使用以减小页面大小并提高其性能的情况下，JS框架可能会使页面过度过载。 如果该项目基于React，请考虑将这个库的使用限制为服务器渲染，或者考虑在构建期间切换到<a href="https://preactjs.com/">Preact</a>并使用<a href="https://preactjs.com/">preact</a> <a href="https://preactjs.com/guide/switching-to-preact">-compat</a>来将<a href="https://preactjs.com/">分发</a>包的大小减少约30 Kb。 为了创建光束，看一下<a href="https://svelte.dev/">Svelte</a> ， <a href="https://lit-html.polymer-project.org/">lit-html</a>和纯JavaScript等技术是有意义的。 </li><li> 尝试确保第三方依赖项占用的空间尽可能少。 这将确保在页面的初始加载期间使用的捆的尺寸适合指定的限制。 要分析第三方库对<a href="https://bundlephobia.com/">分发</a>包的大小的贡献，可以使用<a href="https://bundlephobia.com/">bundlephobia.com</a> 。 严格分析捆绑的组成，以确定其空间是否得到有效利用。 例如，可以使用<a href="https://date-fns.org/">date-</a> <a href="https://moment.github.io/luxon/">fns</a>或<a href="https://moment.github.io/luxon/">luxon</a>代替Moment.js库（该库以标准形式包含与国家标准相关的大量数据）。 </li><li> 使用Redux和用于管理应用程序运行状况的Redux内置存储库时，请格外小心。  Redux存储库数据通常嵌入HTML中，因此可用于使页面可操作。 这很容易导致服务器响应客户端请求发送的数据大小过度增加。 </li></ol><br><h3>  <font color="#3AC1EF">▍调整站点资料，以免在连接缓慢时加载大量资源</font> </h3><br> 我想立即建议您看一下有关基于弱设备的资源适应性的材料。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/875/224/93c/87522493c1d9917931c9e0267e58c58a.png"></div><br>  <i><font color="#999999">自适应资源加载取决于网络连接速度</font></i> <br><br> 自适应资源加载是一种基于通过<a href="https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API">网络信息API</a>可供浏览器使用的<a href="https://developer.mozilla.org/en-US/docs/Web/API/NetworkInformation/effectiveType">有效连接类型</a> （ECT）的信息，“适应”发送给用户的<a href="https://developer.mozilla.org/en-US/docs/Web/API/Network_Information_API">资料的技术</a> 。 使用此API的方式如下所示： <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(navigator.connection.effectiveType); <span class="hljs-comment"><span class="hljs-comment">// 3G</span></span></code> </pre> <br> 自适应加载使站点可以确保使用慢速连接的用户与可以访问较快网络的用户获得与资源交互几乎相同的体验。 也许在网站的“慢速”版本上，一切都不会像“快速”的网页上一样漂亮，但这是可以接受的，因为它具有良好的性能。 <br><br> 请注意，即使在“快速” 4G连接上，用户也可能会遇到较低的数据传输速度。 也许您在餐厅或某个会议中使用WiFi Internet遇到了类似的问题。 <br><br> 考虑使用自适应材料加载的特定示例。 这将与代表站点上特定产品的组件有关。 使用慢速连接的用户将看到产品映像的压缩版本。 高速访问Internet的任何人都将看到高质量的图像，此外，他们将能够使用需要大量JavaScript代码来实现的其他功能。 例如，这是增加产品图像或在“轮播”中查看产品各种照片的能力。 <br><br> 就廉价电话而言，缓慢的网络并不一定是向其发送大量资源的主要障碍。 即使设备连接到相当快的4G网络，用户对网站的印象也很可能受到处理器速度慢和内存容量低的影响。 尽管网络开发人员尚无法访问有关处理器的详细信息，但是<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/client-hints/">客户端提示</a>可以提供有关设备内存，屏幕的宽度和像素密度，网络以及其他一些内容的大概信息。 此信息可用于开发更准确的策略，以将优化的数据传递给客户端。 <br><br><h3>  <font color="#3AC1EF">▍考虑用户的收费计划，并考虑Save-Data标头的内容</font> </h3><br> 适用于Android的Chrome浏览器有一个<a href="https://blog.chromium.org/2019/04/data-saver-is-now-lite-mode.html">特殊的选项</a> ，其中包括保存数据。 它允许对节省流量感兴趣的用户在浏览器自动优化资源，从而加快页面加载速度的模式下工作。 优化包括比平常更多的图像压缩，延迟不重要的资源的加载，在服务器上生成用于预览页面的图像。 您可以在这里找到有关此内容的详细信息。 <br><br> 当用户在支持该模式的浏览器中启用数据保存模式时，浏览器会将<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/save-data/">Save-Data</a>标头附加到HTTP和HTTPS请求。  Web项目的开发人员可以使用JavaScript检查请求是否具有这样的标题，如果有，可以为用户提供网站材料的优化版本。 结果，事实证明用户有意放弃了“艰难”的机会，而开发人员只是满足了他的愿望。 要检查请求中的Save-Data标头，可以使用以下代码： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"connection"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> navigator) {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (navigator.connection.saveData === <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {    <span class="hljs-comment"><span class="hljs-comment">//  ,    .  } }</span></span></code> </pre> <br> 这是使用页面精简版的样子。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b9/e2e/2a4/6b9e2e2a46b7ea65544f8faa1ce2958a.jpg"></div><br>  <i><font color="#999999">Google准备的网页的精简版</font></i> <br><br> 请注意，尽管简单廉价的手机可以支持Chrome，但这不能保证浏览器中数据保存模式的可用性。 最好将此功能视为某些浏览器的可选可选功能之类的东西。 <br><br><h3>  <font color="#3AC1EF">▍将资源密集型逻辑和应用程序状态管理机制引入Web Worker</font> </h3><br>  <a href="https://web.dev/load-faster-like-proxx/">这里有</a>一些很好的材料，可以找到有关在弱电话上加快Web应用程序加载速度的提示。 <br><br> 浏览器主线程除了执行JavaScript外，还忙于其他重要事情。 这就是页面布局的形成，即屏幕上像素的显示，确保了用户与页面的交互。 漫长而复杂的JavaScript操作可能会阻塞主线程，这意味着干扰页面。 <br><br>  <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">Web Worker</a>允许您在后台运行JavaScript代码，而不阻塞主线程。 应该使用它们，以便从主线程中消除由“大量” JavaScript操作创建的负载。 其中包括Web应用程序及其状态管理的复杂逻辑。 主线程和辅助线程使用<a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage">postMessage（）</a>函数和<a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker/onmessage">onmessage</a>事件<a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker/onmessage">处理程序</a>交换信息。  <code>postMessage()</code>函数允许发送方向接收方发送一个值，该值可以是例如JavaScript对象。 有像<a href="https://github.com/GoogleChromeLabs/comlink">Comlink</a>这样的库，可以更轻松地使用Web Worker。 <br><br>  <a href="https://dassur.ma/things/when-workers/">这是在</a>没有使用工作流程的情况下<a href="https://proxx.app/">研究Proxx</a>项目工作<a href="https://dassur.ma/things/when-workers/">的</a>材料。 在研究过程中，发现在不使用人工的情况下，执行特定操作的应用程序在Nokia 2手机（1 GB内存，频率为1.3 GHz的四核处理器）上“冻结”了6.6秒。 在相同条件下，但使用工人时，系统的反应时间仅为48 ms。 因此，如果您的代码需要大量的处理器资源，则应考虑将其移植到Web Worker是否会改善这种情况。 <br><br><h3>  <font color="#3AC1EF">images优化图像</font> </h3><br> 图像通常具有与网页有关的大量数据。 同时，不仅需要上传图像。 它们仍然需要解码，准备输出，这会给低功耗设备带来沉重负担。 结果，对于开发用于弱电话的站点，重要的是要努力确保在这些站点上使用的图像具有适当的大小并适当压缩。 以下是一些图像优化建议： <br><br><ol><li> 使用Imagemin等工具<a href="https://web.dev/use-imagemin-to-compress-images/">压缩图像</a> 。 它们使您可以减小图像尺寸而不会明显降低其质量。 </li><li>  <a href="https://web.dev/replace-gifs-with-videos/">将</a> GIF动画<a href="https://web.dev/replace-gifs-with-videos/">替换为</a>加载速度更快的视频文件。 但是，在视频方面，值得考虑的是，在为廉价手机设计的网站上是否需要大量媒体。 </li><li> 尽可能<a href="https://web.dev/use-lazysizes-to-lazyload-images/">使用</a>延迟加载图像的机制。 由于此类机制基于JavaScript，因此请尝试确保其软件实施不太“繁重”。 在这里，您可能会发现新的标准<a href="https://addyosmani.com/blog/lazy-loading/">加载属性</a>很有用。 </li><li>  <a href="https://web.dev/serve-responsive-images/">将</a>适当大小的响应图像<a href="https://web.dev/serve-responsive-images/">发送</a>给客户。 这可以通过创建许多版本的图像并为客户提供最适合其屏幕的图像来完成。 </li><li>  <a href="https://web.dev/serve-images-with-correct-dimensions/">使用</a>适合屏幕的图像。 向在弱电话上工作的用户输出充分压缩的小图像将导致这样的事实，即这些图像的解码速度更快。 </li></ol><br><h3>  <font color="#3AC1EF">▍提供与设备屏幕尺寸匹配的客户端资源</font> </h3><br> 可被归类为“智能功能手机”的许多现代设备均具有水平和垂直分辨率分别为320x240像素的QVGA屏幕。 如果在加载页面时需要找出设备的屏幕尺寸（例如，使用某些优化），则可以使用以下代码片段： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isFeaturePhone = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.min(screen.width, screen.height) &lt;= <span class="hljs-number"><span class="hljs-number">240</span></span>;</code> </pre> <br>  Proxx项目中使用了类似的<a href="">方法</a> 。 <br><br><h3>  <font color="#3AC1EF">▍在真实设备或仿真器中测试站点</font> </h3><br> 如果您正在开发针对简单廉价电话的网站，建议在此类电话上进行测试。 它们很便宜。 例如，一条推文说那些住在美国并想在KaiOS设备上测试其网站的开发人员建议去BestBuy并以15美元的价格购买一部手机。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ecf/f1e/775/ecff1e7757094e1f13fd19988c99ece7.jpg"></div><br>  <i><font color="#999999">用于KaiOS上测试站点的廉价电话</font></i> <br><br> 如果要模拟类似的手机（例如，在KaiOS上运行的Jio手机之类的东西），则可以使用Chrome开发者工具来实现此目的： <br><br><ul><li> 打开Chrome开发者工具。 </li><li> 打开<code>Device</code>工具栏。 </li><li> 在<code>Device</code>工具栏中，打开设备菜单，然后从中选择<code>Edit</code> 。 在出现的窗口中，单击<code>Add custom device</code>按钮。 </li><li> 命名新的KaiOS设备（或任何您想要的名称）。 </li><li> 将屏幕尺寸设置为<code>240x320</code> 。 </li><li> 在<code>User agent string</code>字段中，输入以下内容： <code>Mozilla/5.0 (Mobile; LYF/F90M/LYF-F90M-000-02-23-181217; Android; rv:48.0) Gecko/48.0 Firefox/48.0 KAIOS/2.5 YouTube/1.66.51.J</code> </li><li> 单击<code>Add</code>按钮保存设备。 </li><li> 如有必要，请启用处理器的速度降低，但请记住，在仿真器的帮助下，您将无法像使用真实设备那样检查站点。 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/e6a/6b8/553e6a6b893d1f4a78e7e55e924ebfa9.png"></div><br>  <i><font color="#999999">在Chrome开发者工具中设置新设备</font></i> <br><br><h2>  <font color="#3AC1EF">总结</font> </h2><br> 您可以创建绝对方便所有移动用户使用的网站，无论他们身在何处。 但是为此，开发人员需要做出一些努力，因为不同价格类别的移动设备之间存在很大差异。 <br><br> 手机价格越便宜，使用速度较慢的处理器的可能性就越高。  JavaScript网站的性能取决于代码加载的速度及其执行的速度。 对于那些想要创建可在任何设备和任何网络上正常工作的站点的用户，应考虑这一点。 <br><br> 上面我们讨论的所有内容对于智能手机都很重要，但是对于廉价的简单手机以及“功能手机”类的设备（在发展中国家非常受欢迎）而言，这一点甚至更为重要。 <br><br>  <b>亲爱的读者们！</b> 您是否针对较弱的移动设备优化了Web项目？ <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN482470/">https://habr.com/ru/post/zh-CN482470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN482460/index.html">SQL HowTo：在SQL中绘制冷淡的模式</a></li>
<li><a href="../zh-CN482462/index.html">在10分钟内学习元流</a></li>
<li><a href="../zh-CN482464/index.html">Python中的* args和** kwargs是什么？</a></li>
<li><a href="../zh-CN482466/index.html">您可以为Vue 3.0做准备的5件事</a></li>
<li><a href="../zh-CN482468/index.html">VS Code的5个扩展和主题可以改变前端开发人员的生活</a></li>
<li><a href="../zh-CN482472/index.html">JavaScript是由什么制成的？</a></li>
<li><a href="../zh-CN482474/index.html">我如何度过夏天</a></li>
<li><a href="../zh-CN482476/index.html">ActivityLifecycleCallbacks-公共API中的盲点</a></li>
<li><a href="../zh-CN482478/index.html">Iteraptor：用于深层透明地图重做的库</a></li>
<li><a href="../zh-CN482480/index.html">即将到来的一年的宇宙感</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>