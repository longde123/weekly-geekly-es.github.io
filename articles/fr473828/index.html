<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ù£Ô∏è üôÖüèΩ üî© La vision par ordinateur comme alternative aux laissez-passer de bureau üåπ üßîüèø ‚òëÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, je vais vous dire comment nous avons cr√©√© un syst√®me de contr√¥le d'acc√®s au bureau bas√© sur le service de reconnaissance faciale Vision ....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La vision par ordinateur comme alternative aux laissez-passer de bureau</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/473828/"><img src="https://habrastorage.org/webt/un/xu/h1/unxuh13fdsjq-aryuwovmchvjxw.jpeg"><br><br>  Aujourd'hui, je vais vous dire comment nous avons cr√©√© un syst√®me de contr√¥le d'acc√®s au bureau bas√© sur le service de reconnaissance faciale <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vision</a> .  Tout d'abord, un peu d'histoire.  Comme dans tout service de messagerie, nous avons cr√©√© un syst√®me anti-spam.  De tels syst√®mes sont maintenant fabriqu√©s sur la base de l'apprentissage automatique, nous avons une √©quipe puissante en charge.  Et l√† o√π il y a l'apprentissage automatique, il y a la vision par ordinateur.  Par cons√©quent, le service Vision est n√© tout naturellement et naturellement. <br><br>  Parall√®lement √† cela, nous avons lanc√© il y a quelques ann√©es le Cloud, un stockage de fichiers fiable avec g√©o-distribution vers les centres de donn√©es, qui peut √™tre utilis√© par les particuliers et les entreprises.  Au fil du temps, nous avons obtenu un "Cloud pour les entreprises", qui non seulement stocke les fichiers, mais vous permet √©galement de commander des machines virtuelles.  Progressivement, cela s'est transform√© en MCS - Mail.ru Cloud Solutions, o√π Vision s'int√®gre organiquement dans l'un des services. <br><a name="habracut"></a><br><h1>  Nuage </h1><br>  Nos r√©seaux de neurones sont capables de reconna√Ætre non seulement les visages, mais aussi divers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">objets, objets et sc√®nes</a> , y compris les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vues</a> .  Maintenant, ils peuvent reconna√Ætre environ 10 000 cat√©gories, et la vision industrielle fonctionne parfois mieux que l'homme. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/399/b8d/be4/399b8dbe4c0ba7bb25dcc7701b9efc34.jpg"><br><br>  C'est ma fille en 2012, en 2015 et 2018.  Si je ne la connaissais pas personnellement, je n‚Äôavais probablement pas imm√©diatement compris qu‚Äôil s‚Äôagissait d‚Äôune seule et m√™me personne.  Et le r√©seau neuronal a pu correspondre et comprendre. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/543/a67/56d/543a6756d6caa113dd04657c45f8b550.jpg"><br><br>  Ici, la fille se d√©tourna et plissa les yeux, et le gar√ßon en g√©n√©ral dans une casquette avec une ombre sur la moiti√© de son visage.  Mais en m√™me temps, le r√©seau de neurones les a reconnus avec pr√©cision, malgr√© des conditions aussi difficiles.  Naturellement, la technologie qui se d√©veloppe au sein de l'entreprise ne pouvait que trouver un support dans les services internes. <br><br><h1>  Notre intranet </h1><br>  Notre intranet s'appelle sys.  Il s'agit d'une sorte de r√©seau social (nous en avons peu).  Dans ce document, les employ√©s t√©l√©chargent des photos de divers √©v√©nements. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2c/f0b/a5b/e2cf0ba5b544efc7d8d52f1c2c7ef640.jpg"><br><br>  Lorsque plusieurs centaines de photos sont pr√©sent√©es lors de l'√©v√©nement, il est assez difficile de s'y retrouver.  Par cons√©quent, nous avons la vision industrielle connect√©e √† ces albums, qui directement sur l'intranet, en un seul endroit, montre les photographies dans lesquelles je suis repr√©sent√©.  Ici, le syst√®me m'a vu √† l'une des f√™tes d'entreprise d'√©t√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/69c/5b9/b4769c5b9c349f443e9968574d5417d3.jpg"><br><br>  Le r√©seau de neurones m'a reconnu m√™me au cr√©puscule de profil, et il y a beaucoup plus de gens sur la photo. <br><br><h1>  Supports de conf√©rence </h1><br>  Plus tard, nous avons fait des supports de conf√©rence.  J'ai √©crit un logiciel pour l'iPad, qui est install√© √† l'int√©rieur du rack, mais en g√©n√©ral, je suis un d√©veloppeur iOS et je n'ai rien √† voir avec la vision par ordinateur, j'aide simplement de mani√®re conviviale. <br><br><img src="https://habrastorage.org/webt/p5/01/ul/p501uly37m546fdxxrwwtuegigo.png"><br><br>  Quelle est l'essence de ce rack?  Tout au long de l'√©v√©nement - une r√©union, une conf√©rence, une f√™te d'entreprise ou au moins un anniversaire - vous √™tes photographi√© par un photographe.  De temps en temps, il d√©pose les images accumul√©es dans le cloud.  Vous pouvez vous rendre au comptoir √† tout moment, prendre une photo et cliquer sur le bouton ¬´Find Me¬ª.  Et le rack affichera imm√©diatement toutes les photos dans lesquelles vous √™tes captur√©, ou dira que rien n'a √©t√© trouv√© jusqu'√† pr√©sent, si le syst√®me n'a pas encore r√©ussi √† indexer les images, et vous invite √† entrer un e-mail.  Et apr√®s l'√©v√©nement, vous recevrez un lien par courrier √©lectronique vers le dossier dans le Cloud avec toutes les photos sur lesquelles vous vous trouvez.  C'est l'une des applications du service Vision. <br><br><h1>  Syst√®me d'acc√®s </h1><br>  Naturellement, je voulais utiliser ces capacit√©s de reconnaissance faciale non seulement pour rechercher ma physionomie dans des images d'entreprise, mais aussi pour quelque chose de plus pratique.  Par exemple, pour un syst√®me de d√©bit automatique.  Appliquer un laissez-passer √† chaque entr√©e de votre √©tage n'est pas tr√®s pratique: vous oubliez souvent le laissez-passer, et pour les filles en v√™tements l√©gers en √©t√©, il n'y a pas de place pour r√©parer le laissez-passer. <br><br>  Par cons√©quent, nous avons d√©cid√© d'exp√©rimenter.  Nous avons toutes les conditions pour cela: nous n'avons besoin de demander la permission √† personne, un service administratif tr√®s r√©actif, qui dit en soupirant: "D'accord.  Fixez vos cam√©ras.  Mais pas √† la porte.  Les portes concernent la s√©curit√© incendie. ¬ª  Nous sommes: ¬´Eh bien, alors.  Nous attacherons sur le c√¥t√©. "  Nous avons aussi des coll√®gues patients, ils ont souffert de nous. <br><br><h1>  L'architecture </h1><br>  √Ä premi√®re vue, l'architecture du syst√®me d'acc√®s semble tr√®s simple: la cam√©ra prend des photos, les envoie √† Vision, et Vision ouvre la porte.  Mais quand nous avons commenc√© √† peindre avec des coll√®gues comment faire cela, nous avons alors obtenu un tel sch√©ma: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7be/683/61c/7be68361c530fdb7f8da32500b7a5c4c.jpg"><br><br>  Le bloc √† droite, nous appelons la ¬´cam√©ra¬ª - c'est le module qui se bloque sur la porte.  Il se compose de trois parties.  Le Raspberry Pi re√ßoit la vid√©o d'une cam√©ra USB, encode avec FFmpeg et envoie.  Nous avons test√© plusieurs cam√©ras IP d'une gamme de prix raisonnable, et tout le monde avait un retard notable d'environ 0,5 s.  Et comme nous avons des retards √† d'autres stades, lorsqu'une personne se l√®ve, regarde la cam√©ra et que pendant quelques secondes rien ne se passe, elle veut d√©j√† faire une passe.  Par cons√©quent, nous avons r√©duit les d√©lais autant que possible, et le Raspberry Pi avec une cam√©ra USB s'est av√©r√© √™tre plus rapide que de nombreuses cam√©ras IP commerciales.  Un autre Arduino avec une LED multicolore et un squeaker est √©galement connect√© au Raspberry.  La LED par d√©faut est rouge.  Lorsqu'une personne se l√®ve et est reconnue, le vert s'allume. <br><br>  Ainsi, le Raspberry Pi transmet le flux vid√©o, qui via Ethernet filaire entre dans le serveur.  Nous avons une salle de serveurs √† chaque √©tage, dans laquelle il y a des commutateurs, des c√¢bles de connexion aux bureaux des employ√©s et un syst√®me de contr√¥le d'acc√®s √† temps plein - un syst√®me de contr√¥le et de gestion des acc√®s. <br><br>  Nous avons mis un autre Raspberry Pi dans la salle des serveurs, qui re√ßoit le flux vid√©o en temps r√©el et le fait passer par OpenCV.  Pourquoi avons-nous besoin d'OpenCV?  Nous devons d√©terminer s'il y a un visage dans l'image.  Un r√©seau de neurones qui d√©finit une personne sur une photo fonctionne un peu plus longtemps, et il est trop co√ªteux de lui envoyer un flux vid√©o en permanence.  Par cons√©quent, via OpenCV, nous d√©terminons la pr√©sence d'un visage, et s'il appara√Æt, nous l'envoyons √† Vision.  Le service r√©pond qu'il n'a pas trouv√© cet employ√© ou envoie l'identifiant de l'employ√© dans la base de donn√©es RH.  Avec cet identifiant d'employ√©, nous allons sur l'intranet associ√© √† l'ACS, et il nous renvoie l'identifiant du pass.  De plus, nous jetons cet identifiant de passe dans Arduino, qui le transmet √† l'ACS.  Pour un syst√®me de contr√¥le d'acc√®s, cela √©quivaut √† une personne appliquant un laissez-passer.  Autrement dit, nous ne modifions en aucun cas l'AEC; il enregistre toujours l'entr√©e et la sortie des employ√©s. <br><br>  Comment avons-nous int√©gr√© notre syst√®me √† ACS?  Dans notre bureau, des appareils Bolid C2000-2 sont utilis√©s. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/351/01a/0de/35101a0de56c7879ac661be35a5060b8.jpg"><br><br>  Il s'agit d'un syst√®me de contr√¥le d'acc√®s national.  Tr√®s probablement, vous pouvez vous connecter √† ces appareils via la 485e interface, mais nous nous sommes connect√©s via le protocole Wiegand. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5d/36e/70b/e5d36e70b78094589c3c63df5f6ee934.jpg"><br><br>  Nous avons connect√© l'Arduino, qui agit comme un proxy, au lecteur de laissez-passer install√© pr√®s de la porte. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9bc/26d/700/9bc26d7009e2dae347db5223fd50dfa8.jpg"><br><br>  La photo montre la connexion √©lectrique et deux lignes de donn√©es du lecteur de laissez-passer.  Le pad est utilis√© pour une connexion plus pratique. <br><br>  Arduino re√ßoit le num√©ro de passe soit du lecteur ou du Raspberry Pi via USB, et le donne √† l'ACS.  L'ACS ne sait m√™me pas d'o√π vient le num√©ro de passe. <br><br><h1>  Wiegand </h1><br>  Il s'agit d'un protocole standard pour les syst√®mes de contr√¥le d'acc√®s, il est pris en charge par la plupart des lecteurs.  Le protocole est tr√®s simple: deux lignes de donn√©es, une ligne de z√©ros et une ligne d'unit√©s.  D√®s que vous connectez la ligne z√©ro √† la terre, le lecteur comprend que le z√©ro est transmis, de m√™me avec les unit√©s.  Autrement dit, le protocole n'a pas de temporisations standardis√©es, et le num√©ro de saut est facile √† lire √† travers une interruption sur l'Arduino, il est facile de le repr√©senter comme une s√©quence de donn√©es.  Et comme l'enregistrement n√©cessite une certaine synchronisation, je me suis concentr√© sur ces valeurs: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6aa/d03/ee3/6aad03ee3eb8aa49fab36710af32b342.jpg"><br><br>  Il existe d√©j√† une biblioth√®que pr√™te √† l'emploi pour Arduino.  Elle peut lire diff√©rents formats Wiegand, mais ses capacit√©s sont limit√©es √† cela.  Et je devais encore transmettre.  Par cons√©quent, j'ai √©crit ma biblioth√®que, qui ne fonctionne qu'avec le format Wiegand-26.  26 est le nombre de bits: 3 octets du num√©ro de saut et 2 bits de parit√©.  De plus, dans toute la documentation et les articles, il est √©crit que, tr√®s probablement, votre contr√¥leur moderne ignorera les bits de parit√©, donc je suis paresseux et ne les compte pas, mais envoie toujours z√©ro.  ACS le per√ßoit normalement. <br><br>  Nous avons eu un autre probl√®me: si quelqu'un est apparu devant la cam√©ra, puis, sans attendre l'op√©ration, a appliqu√© un laissez-passer, une situation de course s'est produite: en m√™me temps, le num√©ro de passe provenait du lecteur et de la reconnaissance.  ACS n'a pas pu faire face √† cela et n'a pas laiss√© entrer les gens.  Par cons√©quent, j'ai d√ª ajouter un tampon en anneau avec 4 codes √† la biblioth√®que.  Peu importe d'o√π viennent les codes, ils sont plac√©s dans le tampon, puis avec un timeout de 0,5 s sont transmis √† l'ACS.  Depuis lors, les coll√®gues ont cess√© de se plaindre qu'ils ne sont pas autoris√©s. <br><br><h1>  Banc d'essai </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/158/b78/43f/158b7843fe5152a47f530123a3342908.jpg"><br><br>  Le premier prototype a √©t√© assembl√© √† partir de quelque chose d'horrible.  Le Raspberry Pi √©tait accroch√© dans une bo√Æte sur un rack ridicule, et un appareil photo √©tait coll√© sur un ruban adh√©sif double face.  Arduino se bloque sur les chapes lat√©rales.  En g√©n√©ral, tout ce que nous aimons est tr√®s bricolage. <br><br>  Bien s√ªr, sous cette forme il √©tait impossible de partir, il fallait s'organiser magnifiquement.  Nous avons discut√© avec plusieurs entrepreneurs, ils nous ont promis de commander des √©chantillons en Chine, mais tous les d√©lais convenus sont pass√©s et personne ne nous a rien offert. <br><br>  Les produits personnalis√©s ont un probl√®me - toutes les solutions sont hautement sp√©cialis√©es, elles seraient faites sp√©cialement pour nous.  Premi√®rement, nous devenons d√©pendants du fournisseur.  Deuxi√®mement, il s'av√®re une conception de circuit unique avec une petite circulation, ce qui signifie que le co√ªt d'une pi√®ce sera √©lev√©.  Troisi√®mement, le temps de production est suffisamment long et si une copie √©choue, nous ne pourrons pas acheter rapidement un rempla√ßant dans le magasin, nous devrons attendre la prochaine impression et si nous le faisons imm√©diatement, les copies restantes seront d√©poussi√©r√©es dans l'entrep√¥t. <br><br>  Apr√®s que tous les partenaires potentiels nous aient laiss√© tomber, je suis all√© voir un coll√®gue de Vision et lui ai dit: "Volodya, laissez-moi imprimer un √©tui sur votre imprimante 3D pour le rendre beau."  Il soupira et dit: ¬´Allez.  Que faire? " <br><br><h1>  Camera V 1 </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/6f1/4f0/c61/6f14f0c6132add7dcd3eb753d95e822e.jpg"><br><br>  Dans Fusion, j'ai dessin√© un tel monstre de Frankenstein.  Dans le coin √©tait cens√© √™tre un Raspberry Pi avec une entr√©e pour un c√¢ble Ethernet.  Entr√©e lat√©rale pour le pouvoir.  Le ¬´deuxi√®me √©tage¬ª √©tait une cam√©ra.  Le r√©sultat √©tait une grande structure, et je l'ai m√™me imprim√©e avec une fine couche afin de ne pas d√©penser beaucoup de plastique.  Cela avait l'air terrible, et le suspendre √©tait encore plus embarrassant. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5b/8ba/682/d5b8ba6826307a63d09473ef779d646c.jpg"><br><br>  De plus, un coll√®gue m'a envoy√© une telle r√©f√©rence, disent-ils, nous aimerions cela.  J'ai r√©pondu que je ne pouvais pas faire cela, mais j'ai d√©cid√© de concevoir un autre b√¢timent. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f6/668/e5e/9f6668e5e503946ad94e4a75319d4816.jpg"><br><br>  Le nouveau bo√Ætier avait un diam√®tre de 11 cm, plus petit que le CD.  Le placement du remplissage est √©galement √† deux couches.  Apr√®s avoir imprim√© la premi√®re version, j'ai r√©alis√© que cela n'avait aucun sens de mettre la cam√©ra USB enti√®rement dans son bo√Ætier d'origine.  Je l'ai d√©mont√© soigneusement et il s'est av√©r√© qu'il avait 4 trous d'atterrissage sur le panneau avant.  J'ai combin√© ce panneau avec une cam√©ra dans un assemblage commun avec un tweeter et une LED. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/031/180/4a4/0311804a49018e3b8f7f84b86caffc22.jpg"><br><br>  Tout d'abord, nous avons essay√© de g√©n√©rer un grincement sur le Raspberry Pi via gpio.  Cela s'est av√©r√© extr√™mement mauvais.  Par cons√©quent, nous avons d√©cid√© de prendre cette fonction s√©par√©ment du Raspberry Pi en connectant un petit arduino (en fait Iskra mini), auquel le squeaker et la LED ont √©t√© soud√©s, via TTL directement au bloc. <br><br>  Voici √† quoi cela ressemblait au combat: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/93b/9fe/6ec/93b9fe6ecea2fff3b39c6c60a83240a9.jpg"></div><br>  Nous avons accroch√© l'appareil au sol.  Sous cette forme, elle a v√©cu assez longtemps.  Grin√ßant, magnifiquement brillant, ouvrant la porte, cependant, pas √† chaque fois.  Des coll√®gues se sont toutefois plaints que la LED √©tait trop lumineuse.  J'ai d√ª l'affaiblir 4 fois. <br><br><h1>  Camera V 2 </h1><br>  Ensuite, ils ont fait cette option: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b73/9b4/caf/b739b4caf65d413e545e9f1f1a3bd784.jpg"><br><br>  Il a √©t√© inspir√© par la conception du moyeu Xiaomi, avec un anneau lumineux autour du p√©rim√®tre.  C'est tr√®s beau.  Le logo Vision est compos√© de pi√®ces individuelles imprim√©es dans des plastiques de diff√©rentes couleurs.  Voici le mod√®le: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ea/e91/536/1eae91536fc7fb62bf7b9dc8c4ee24d5.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d70/1ab/64d/d701ab64dc264959923d6c67ce011bd8.jpg"><br><br>  Cette fois, j'ai plac√© le grinceur sur le mur arri√®re, mont√© la LED dans un anneau transparent autour du p√©rim√®tre, imprim√© √† partir d'un PLA transparent.  Le d√©cor s'est presque imm√©diatement effondr√© √† l'int√©rieur, car il √©tait √† l'origine simplement ins√©r√© par friction, et j'ai d√ª le mettre sur de la colle. <br><br><h1>  Probl√®mes de cam√©ra </h1><br>  Nous avons eu l'id√©e de reproduire cette d√©cision dans tout le b√¢timent.  Mais il y a un probl√®me: presque tous les √©tages ont deux portes, et chacune devrait avoir deux cam√©ras, seulement 96 cam√©ras pour une seule de nos tours, et maintenant la deuxi√®me est en cours de d√©veloppement actif.  Il est possible d'imprimer autant de cas, mais cela semble d√©j√† compliqu√©.  De plus, nous avons plusieurs composants dans l'appareil, ce qui signifie de nombreux points de d√©faillance.  Si nous adaptons la solution √† l'ensemble du b√¢timent, nous maintiendrons constamment ces cam√©ras.  Encore une fois, la complexit√© du remplacement rapide, car chaque cam√©ra est un appareil monobloc.  Et vous devez soit en imprimer un grand nombre, avec une marge, soit, si quelque chose s'est produit, puis ex√©cuter imm√©diatement, imprimer et collecter un nouveau.  Nous avons r√©alis√© que les solutions de bricolage sont cool, mais vous avez besoin de quelque chose de plus pratique dans la r√©plication.  Et l'id√©e est venue de tout transf√©rer sur l'iPad. <br><br><h3>  IPad </h3><br>  L'iPad pr√©sente plusieurs avantages.  Le premier est l'√©cran.  Les coll√®gues se sont plaints du manque de r√©troaction, ils conviennent et ne comprennent pas si la reconnaissance a commenc√© ou non, attendez-les ou n'attendez pas. <br><br>  Deuxi√®mement, iOS a une fonction de reconnaissance faciale int√©gr√©e.  La fonction effectu√©e par OpenCV a √©t√© transmise √† l'iPad.  Un cadre est affich√© √† l'√©cran, et la personne doit venir si loin que le visage s'ins√®re dans ce cadre.  Apr√®s cela, le syst√®me commence √† le reconna√Ætre automatiquement, vous n'avez pas besoin d'appuyer sur quoi que ce soit. <br><br>  Troisi√®mement, l'iPad est un produit de masse.  S'il √©choue, nous en d√©finissons un autre.  Bien que la tablette elle-m√™me co√ªte environ 20 000 roubles, elle est toujours moins ch√®re que les cam√©ras personnalis√©es que nos partenaires nous ont propos√©es.  De plus, plus rapide et plus fiable. <br><br><h1>  Nouvelle architecture </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/35e/90f/685/35e90f685bd150fcc133f73a24b07cee.jpg"><br><br>  L'iPad a repris la plupart des fonctionnalit√©s.  Sur le Raspberry Pi, qui se trouve dans la salle des serveurs, il n'y a en fait qu'un h√¥te HTTP qui accepte une demande GET avec un ID de passe.  Il a imm√©diatement mandat√© le code dans Arduino, et elle a mandat√© dans ACS. <br><br>  Dans la premi√®re version, Raspberry Pi √©tait tr√®s charg√©, car OpenCV y travaillait constamment.  Il n'√©tait plus possible d'y connecter un deuxi√®me appareil photo, il n'y aurait pas assez de puissance de calcul.  Nous avons d√©j√† pens√© √† y installer un ordinateur honn√™te, qui analyserait 4 fils de deux portes.  Mais ce n'est pas arriv√© √† cela.  Maintenant, la recherche de visage dans l'image est effectu√©e ind√©pendamment sur chaque iPad.  Dans la croix, il y a deux Arduino, un pour chaque porte.  Les deux panneaux fonctionnent avec des laissez-passer d'entr√©e et de sortie.  Pourquoi est-il important de travailler avec des laissez-passer d'entr√©e et de sortie?  Premi√®rement, lorsque le visage est reconnu et que la porte s'ouvre, le voyant vert du lecteur de carte s'allume et les coll√®gues comprennent que vous pouvez sortir.  Deuxi√®mement, ACS enregistre les entr√©es et les sorties.  En √©mulant l'entr√©e et la sortie s√©par√©ment, nous ne cassons pas le sch√©ma de fonctionnement ACS. <br><br>  Naturellement, les designers se sont ressaisis qui nous ont dessin√© une belle interface.  Voici √† quoi cela ressemble maintenant sur l'un des √©tages de notre bureau: <br><br><img src="https://habrastorage.org/webt/t_/mv/27/t_mv273f9oor1vamysoa-hwybxe.jpeg"><br><br><h1>  Travailler avec Vision </h1><br>  Malgr√© le fait que MCS soit un produit professionnel, les amateurs peuvent √©galement l'utiliser.  Le service offre √† chacun 5 000 transactions gratuites par mois, soit 166 par jour.  Par cons√©quent, vous pouvez appliquer pour vos besoins domestiques, si vous vous adaptez √† la limite, bien s√ªr.  Comment cela peut-il se faire? <br><br><pre><code class="python hljs">python examples/python/smarty.py \ -u <span class="hljs-string"><span class="hljs-string">"https://smarty.mail.ru/api/v1/persons/recognize ?oauth_provider=mcs&amp;oauth_token=e50b000614a371ce 99c01a80a4558d8ed93b313737363830"</span></span> \ -p friends1.jpg \ --meta <span class="hljs-string"><span class="hljs-string">'{"space":"1", "create_new":true}'</span></span> \ -v</code> </pre> <br>  Prenez une photo et envoyez-la √† Vision avec notre jeton d'acc√®s.  Nous indiquons que nous travaillons avec le premier espace et d√©finissons <code>create_new</code> - alors le syst√®me cr√©era un nouvel identifiant pour chaque personne inconnue.  Voici ce que nous obtenons en r√©ponse: <br><br><pre> <code class="python hljs">{ <span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"objects"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"file_0"</span></span>, <span class="hljs-string"><span class="hljs-string">"persons"</span></span>:[ {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person1"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">102</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">184</span></span>,<span class="hljs-number"><span class="hljs-number">134</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99999</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.5025</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person2"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">393</span></span>,<span class="hljs-number"><span class="hljs-number">74</span></span>,<span class="hljs-number"><span class="hljs-number">461</span></span>,<span class="hljs-number"><span class="hljs-number">166</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99987</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.548</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person3"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">458</span></span>,<span class="hljs-number"><span class="hljs-number">48</span></span>,<span class="hljs-number"><span class="hljs-number">535</span></span>,<span class="hljs-number"><span class="hljs-number">149</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99976</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.4766</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person4"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">273</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span>,<span class="hljs-number"><span class="hljs-number">352</span></span>,<span class="hljs-number"><span class="hljs-number">147</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99963</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.504</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person5"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">525</span></span>,<span class="hljs-number"><span class="hljs-number">81</span></span>,<span class="hljs-number"><span class="hljs-number">600</span></span>,<span class="hljs-number"><span class="hljs-number">184</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.99954</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.4849</span></span>}, {<span class="hljs-string"><span class="hljs-string">"tag"</span></span>:<span class="hljs-string"><span class="hljs-string">"person6"</span></span>,<span class="hljs-string"><span class="hljs-string">"coord"</span></span>:[<span class="hljs-number"><span class="hljs-number">194</span></span>,<span class="hljs-number"><span class="hljs-number">76</span></span>,<span class="hljs-number"><span class="hljs-number">258</span></span>,<span class="hljs-number"><span class="hljs-number">167</span></span>],<span class="hljs-string"><span class="hljs-string">"confidence"</span></span>:<span class="hljs-number"><span class="hljs-number">0.9984</span></span>,<span class="hljs-string"><span class="hljs-string">"awesomeness"</span></span>:<span class="hljs-number"><span class="hljs-number">0.5725</span></span>} ] } ], <span class="hljs-string"><span class="hljs-string">"aliases_changed"</span></span>:false }, <span class="hljs-string"><span class="hljs-string">"htmlencoded"</span></span>:false, <span class="hljs-string"><span class="hljs-string">"last_modified"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span> }</code> </pre> <br>  J'ai un peu format√© JSON.  La r√©ponse contient l'identifiant de la personne, les coordonn√©es du visage sur la photo et deux param√®tres: dans quelle mesure le visage est reconnu et dans quelle mesure cette personne correspond √† la norme.  Vous pouvez envoyer une requ√™te POST avec une image dans votre langage de programmation, obtenir du JSON et analyser la r√©ponse. <br><br>  Si vous avez une grande croix et que vous devez d√©terminer seulement une douzaine de personnes, vous pouvez les d√©finir manuellement.  Ensuite, le syst√®me distribuera des identifiants pour les personnes famili√®res et ind√©finis pour les inconnus.  Les personnes peuvent √©galement √™tre supprim√©es de mani√®re s√©lective, par exemple, si un employ√© quitte. <br><br><h1>  Des id√©es </h1><br>  Dans quels projets pouvez-vous utiliser la reconnaissance faciale?  Si vous souhaitez impl√©menter un syst√®me de bande passante, vous devez vous soucier de l'anti-spoofing.  Par exemple, ajouter une cam√©ra infrarouge pour d√©terminer s'il s'agit d'une photographie ou d'une personne vivante.  Ou en mettant deux cam√©ras pour d√©terminer la profondeur de l'objet, cela peut √™tre fait en utilisant OpenCV. <br><br>  Vous pouvez organiser la reconnaissance des personnes dans l'entr√©e.  Si ce sont vos voisins, alors tout est en ordre, et si quelqu'un est un √©tranger, vous pouvez vous envoyer une alerte.  Nous avons un tel probl√®me dans notre maison, des √©trangers viennent r√©guli√®rement et laissent beaucoup de d√©chets apr√®s eux sur le palier. <br><br>  Si vous fabriquez un ¬´miroir intelligent¬ª, vous pouvez alors l'√©quiper de la reconnaissance des membres de la famille, afin que chacun puisse montrer ce qui l'int√©resse.  Dis, le miroir me montrera le programme des rendez-vous d'aujourd'hui, et avec ma fille elle me saluera gaiement et proposera de me brosser les dents, et pas vite, comme d'habitude, mais deux minutes. <br><br>  Une autre id√©e est la reconnaissance d'une plaque d'immatriculation par un portail automatique dans le pays.  Afin de ne pas sortir ou d'appuyer sur le porte-cl√©s, vous pouvez mettre une cam√©ra qui supprimera votre num√©ro, et le portail s'ouvrira automatiquement. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr473828/">https://habr.com/ru/post/fr473828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr473816/index.html">Fonctionnalit√©s du JavaScript moderne que vous ignorez peut-√™tre</a></li>
<li><a href="../fr473818/index.html">Application sur TSD et communication avec 1C: Enterprise 8.3 via HTTP-Service. Partie 4 (scanner OnKeyUp. SC avec √©mulation clavier)</a></li>
<li><a href="../fr473822/index.html">Offre d'emploi en 1 jour: comment nous avons interview√© et comment√© le m√™me jour</a></li>
<li><a href="../fr473824/index.html">Comment construire une technologie d'entreprise pour la planification des ventes dans un seul syst√®me</a></li>
<li><a href="../fr473826/index.html">Authentification OTP sur le serveur Web Apache</a></li>
<li><a href="../fr473832/index.html">ShIoTiny: mises √† jour et notifications</a></li>
<li><a href="../fr473834/index.html">Surveillance de Blackbox dans les r√©seaux Clos. Rapport Yandex</a></li>
<li><a href="../fr473838/index.html">DJI Mavic Mini: le quadricopt√®re pliant le plus l√©ger</a></li>
<li><a href="../fr473840/index.html">Diffusez des vid√©os depuis un appareil Android via UDP vers une application JAVA</a></li>
<li><a href="../fr473842/index.html">Sommaire des actualit√©s sur l'apprentissage automatique et l'intelligence artificielle d'octobre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>