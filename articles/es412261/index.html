<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèª üß° üë©üèΩ‚Äçü§ù‚Äçüë©üèª "Alice, enciende la luz". Control de voz de un hogar inteligente basado en openHAB. Sin programaci√≥n y SMS üëèüèæ üöµüèø üßóüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Noviembre de 2017, el n√∫mero once se mostr√≥ en el calendario. La venta en Aliexpress estaba en su apogeo, sus manos ara√±aron algo para comprar. La ele...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Alice, enciende la luz". Control de voz de un hogar inteligente basado en openHAB. Sin programaci√≥n y SMS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412261/"><iframe width="560" height="315" src="https://www.youtube.com/embed/bTpH3pVVMG4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Noviembre de 2017, el n√∫mero once se mostr√≥ en el calendario.  La venta en Aliexpress estaba en su apogeo, sus manos ara√±aron algo para comprar.  La elecci√≥n recay√≥ en la " <i>Mi-light RGBW LED Lamp AC86-265V Remote Control Smart Lighting</i> ".  Como resultado, se compraron dos copias de la potencia m√°xima, a 9 vatios, y un controlador de concentrador MiLight WiFi iBox.  La entrega desde China no se hizo esperar, y 4 meses despu√©s, el 13 de marzo de 2018, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">abri√≥ la plataforma Yandex.Dialogs</a> (una plataforma que permite a los desarrolladores externos agregar habilidades a la asistente de voz Alice).  A continuaci√≥n, Alice aprender√° a controlar la iluminaci√≥n (y no solo) en su apartamento, y la ayudaremos con esto, por etapas y sin una sola l√≠nea de c√≥digo. <br><a name="habracut"></a><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuraci√≥n de la l√°mpara inteligente Xiaomi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Instalar openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Control de luz a trav√©s de openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Acceso externo a openHAB</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">IFTTT</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Alice</a> </li></ol><br><a name="xiaomi"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/n8/ev/wx/n8evwxli9dh4en3ahsny_kmzn-e.jpeg"></div><br><h3>  1. Configuraci√≥n de l√°mparas inteligentes de Xiaomi. </h3><br>  Lo primero que debe hacer es configurar el control de la l√°mpara, al menos utilizando la aplicaci√≥n de Xiaomi.  Si se pasa esta etapa por usted, no dude en continuar con la configuraci√≥n de un servidor dom√©stico inteligente, o incluso m√°s, directamente a la integraci√≥n de Alice y openHAB.  Pero, primero lo primero.  Las l√°mparas en s√≠ no se conectar√°n al enrutador de su hogar, para esto necesita un concentrador iBox que pueda controlar hasta cuatro grupos de fuentes de luz.  Debe conectarlo a la red y luego conectarle la l√°mpara. <br><br><ol><li>  Suministramos energ√≠a al <b>iBox</b> conect√°ndolo a trav√©s de un usb, por ejemplo, a un cargador para el tel√©fono. </li><li>  Cuando se conecta por primera vez, debe restablecer el concentrador, as√≠ que presione <b>RST</b> . </li><li>  A continuaci√≥n, instale la aplicaci√≥n de <b>Xiaomi</b> para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">iOS</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Android</a> en el tel√©fono.  Aseg√∫rese de que el tel√©fono est√© conectado a la red Wi-Fi dom√©stica. </li><li>  Abra la aplicaci√≥n <b>Mi-Light 3.0</b> , haga clic en <b>+</b> .  Aqu√≠ estamos interesados ‚Äã‚Äãen la pesta√±a <b>Smart Link</b> . </li><li>  Ingrese el nombre y la contrase√±a de la red Wi-Fi dom√©stica a la que est√° conectado el tel√©fono y se planea conectar <b>iBox</b> . </li><li>  Ahora su <b>iBox</b> deber√≠a estar conectado a la red, y los indicadores <b>SYS</b> y <b>LINK</b> deber√≠an parpadear, lenta y r√°pidamente, respectivamente.  Si no, presione <b>RST</b> nuevamente. </li><li>  Si los indicadores parpadean, haga clic en la aplicaci√≥n <b>Iniciar configuraci√≥n</b> , <b>comenzar√°</b> el proceso de configuraci√≥n de la conexi√≥n para el concentrador. </li><li>  Despu√©s de unos diez segundos, el parpadeo se detendr√°, luego <b>SYS</b> comenzar√° a parpadear lentamente nuevamente y <b>LINK</b> permanecer√° encendido.  La aplicaci√≥n muestra <b>Configurado</b> .  El concentrador est√° conectado a la red.  Si no est√° en la <b>Lista de dispositivos</b> , simplemente haga clic en <b>Buscar dispositivo</b> . </li></ol><br>  Ya puede controlar el color y el brillo de la iBox, pero necesitamos conectar las l√°mparas.  Para hacer esto, ate las l√°mparas a una de las cuatro zonas disponibles para el centro de control. <br><br><ol><li>  Abrimos en la aplicaci√≥n <b>Mi-Light 3.0</b> de la lista del hub <b>Mi-Light</b> .  Ve a la secci√≥n <b>Colores</b> . </li><li>  En la parte superior de la pantalla, seleccione una de las zonas, deje que sea <b>Zone1</b> .  Y haga clic en el icono de emparejamiento del dispositivo en la esquina superior derecha.  <b>Aparece la pantalla LINK / UNLINK</b> con instrucciones. </li><li>  Ahora configuramos las l√°mparas que queremos vincular a <b>Zone1</b> , su gesti√≥n en el futuro ocurrir√° sincr√≥nicamente.  Para controlar el brillo y el color de cada l√°mpara individualmente, deben asignarse a zonas separadas.  Por lo tanto, encienda la l√°mpara y, dentro de los primeros tres segundos, haga clic en la aplicaci√≥n <b>Enlace</b> .  Si la l√°mpara parpade√≥ tres veces, entonces todo est√° bien, la sincronizaci√≥n fue exitosa.  Puedes controlar la l√°mpara. </li></ol><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/bj/gf/lj/bjgflj6c_5paymroxvyojr-7qpw.jpeg"></div><br>  B√°sicamente, en esta etapa ya tiene un control remoto para el control remoto de la luz.  Adem√°s, puede escribir su propio sistema de control de iluminaci√≥n, ya que el protocolo para comunicarse con el concentrador se conoce desde hace mucho tiempo (una vez estuvo disponible en <i>limitlessled.com/dev</i> ).  Hay bibliotecas listas para usar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">php</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">javascript</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">python</a> .  Pero la administraci√≥n solo es posible desde la red local, lo que claramente no es suficiente para Alice.  Intentemos resolver este problema. <br><br><a name="openhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  2. Instalar openHAB </h3><br>  Brevemente, qu√© es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">openHab</a> .  Este es un servidor de administraci√≥n inteligente para el hogar de c√≥digo abierto.  Desarrollado por la comunidad, admite la gesti√≥n de una gran cantidad de dispositivos.  Existe un cliente m√≥vil, existe la posibilidad de administrar Alexa desde Amazon y un asistente de Google.  Escrito en Java, basado en el marco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Eclipse SmartHome</a> .  Por lo tanto, se puede instalar incluso en un refrigerador, lo principal es que la m√°quina virtual Java se ejecuta en este refrigerador.  Las instrucciones de instalaci√≥n son para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Linux</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Windows</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mac OS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Raspberry Pi</a> , para varios dispositivos de almacenamiento de red <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Synology</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">QNAP</a> .  Repase r√°pidamente la primera opci√≥n. <br><br><ol><li>  Agregar claves de repositorio: <br><br><pre><code class="bash hljs">wget -qO - <span class="hljs-string"><span class="hljs-string">'https://bintray.com/user/downloadSubjectPublicKey?username=openhab'</span></span> | sudo apt-key add - sudo apt-get install apt-transport-https</code> </pre> </li><li>  Agregue el repositorio en s√≠: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'deb https://dl.bintray.com/openhab/apt-repo2 stable main'</span></span> | sudo tee /etc/apt/sources.list.d/openhab2.list</code> </pre> </li><li>  Actualizamos e instalamos el servidor junto con los complementos: <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get install openhab2 sudo apt-get install openhab2-addons sudo apt-get install openhab2-addons-legacy</code> </pre> </li><li>  Configuramos el inicio autom√°tico del servicio despu√©s de reiniciar el dispositivo y lo iniciamos: <br><br><pre> <code class="bash hljs">sudo systemctl start openhab2.service sudo systemctl status openhab2.service sudo systemctl daemon-reload sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> openhab2.service</code> </pre> </li><li>  Ahora esperamos en la regi√≥n de <b>15-20 minutos</b> (esto no es una exageraci√≥n, es una realidad dura con bromas sobre la velocidad de Java), mientras se <code>http://openhab-device:8080</code> interfaz web aparece en la direcci√≥n <code>http://openhab-device:8080</code> . </li><li>  En esta p√°gina, estamos interesados ‚Äã‚Äãen el √≠tem <b>Paper UI</b> .  Es con este tipo de interfaz que trabajaremos en el futuro. </li></ol><br><img src="https://habrastorage.org/webt/t7/7t/4n/t77t4n7ug5blggwf7yyfstz-wd0.png"><br><br><a name="binding"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  3. Control de luz a trav√©s de openHAB </h3><br>  Entonces, tenemos un servidor dom√©stico inteligente y l√°mparas de Xiaomi que funcionan con la posibilidad de control remoto.  Es necesario conectarlos.  openHAB admite carpetas (instrucciones para controlar la electr√≥nica conectada) para muchos dispositivos, incluidas estas l√°mparas. <br><br><ol><li>  Vaya a <b>Complemento</b> ‚Üí <b>Enlaces</b> . </li><li>  Instale el <b>enlace Milight</b> . </li><li>  Para agregar nuestro dispositivo, haga clic en <b>+</b> en la secci√≥n <b>Configuraci√≥n</b> ‚Üí <b>Cosas</b> . </li><li>  Seleccionamos <b>Milight Binding</b> , comienza la b√∫squeda autom√°tica del dispositivo. </li><li>  No encontr√© nada autom√°ticamente, as√≠ que agregu√© manualmente " <b>Agregar manualmente</b> ". </li><li>  Seleccionamos el hub <b>iBox / iBox2</b> para agregar. </li><li>  En la p√°gina que se abre, debe completar los campos <b>IP</b> e <b>ID de puente</b> (direcci√≥n mac del dispositivo conectado), puede encontrarlos, por ejemplo, en el panel de control del enrutador (mi concentrador est√° registrado en la red con el nombre del m√≥dulo HF-LPB100 utilizado en √©l).  A√±adir </li><li>  Genial, <b>iBox / iBox2</b> ahora aparece en la lista de dispositivos con la inscripci√≥n " <i>Online</i> ". </li><li>  <b>Haga clic</b> en <b>+ de</b> nuevo y seleccione <b>Milight Binding</b> , esta vez para agregar las l√°mparas directamente. </li><li>  Ahora no necesita agregar nada a mano, solo seleccione un grupo de l√°mparas de la lista (en mi caso, este es el <b>elemento Color Rgbww (Zona 1)</b> ). </li><li>  El elemento seleccionado debe aparecer en la lista de cosas con la inscripci√≥n " <i>En l√≠nea</i> ". <br><br><img src="https://habrastorage.org/webt/lo/1u/pf/lo1upfvlh54rsjnxqbgcuxu389i.png"></li><li>  Los dispositivos est√°n configurados, ahora debe agregarles controles.  Para hacer esto, haga clic en el elemento reci√©n agregado. </li><li>  Se abre una lista de par√°metros de la l√°mpara que podemos controlar de forma remota.  Haga clic en el c√≠rculo azul <b>Brillo</b> . </li><li>  A continuaci√≥n, seleccione el control con el que queremos asociar el par√°metro del dispositivo, porque  a√∫n no los tenemos, haga clic en <b>Crear nuevo elemento</b> . </li><li>  Establezca un nombre arbitrario, por ejemplo <b>Light_Switcher</b> , y cambie el tipo de <b>Dimmer</b> a <b>Switch</b> , porque  No tengo que ajustar el brillo de la l√°mpara, solo quiero encenderla y apagarla.  Simplemente cambiamos la categor√≠a a <b>Light</b> para que el control se muestre con un icono en la secci√≥n <b>Control</b> .  Haga clic en <b>enlace</b> . </li><li>  Vaya a la secci√≥n <b>Control</b> y disfrute de la operaci√≥n del interruptor de <b>Brillo</b> en el dispositivo. </li></ol><br><br><a name="myopenhab"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/hv/t3/5x/hvt35xyvexl22gkkyvfpef3_muw.jpeg"></div><br><h3>  4. Acceso externo a openHAB </h3><br>  Por razones de seguridad, despu√©s de las manipulaciones descritas anteriormente, la administraci√≥n del servidor dom√©stico inteligente solo es posible desde la red local.  Claramente, esto no es suficiente para nuestra tarea.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hay varias opciones de configuraci√≥n</a> : configurar una VPN para acceder desde Internet a una red local, configurar un proxy inverso o conectar su servidor al servicio de nube myopenHAB en myopenHAB.org.  Dado que en Rusia el n√∫mero de empleados de Roskomnadzor es directamente proporcional al n√∫mero de usuarios de VPN y servidores proxy, utilizaremos esta √∫ltima opci√≥n. <br><blockquote>  No multiplique cosas innecesariamente </blockquote><br><ol><li>  Nos registramos en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio</a> web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">myopenHAB</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">iniciamos</a> sesi√≥n y vamos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://myopenhab.org/account</a> .  En esta p√°gina nos interesan dos campos: <b>openHAB UUID</b> y <b>openHAB Secret</b> .  Le permiten organizar una conexi√≥n de servidor.  Averig√ºemos d√≥nde conseguirlos. </li><li>  Vamos al panel de control de <b>PaperUI openHAB</b> . </li><li>  Abra la secci√≥n <b>Configuraci√≥n</b> ‚Üí <b>Complementos</b> ‚Üí <b>Varios</b> . </li><li>  Instale <b>openHAB Cloud Connector</b> . </li><li>  En <b>Configuraci√≥n</b> ‚Üí <b>Servicios</b> , deber√≠a aparecer el m√≥dulo <b>openHAB Cloud</b> con el modo " <i>Notificaciones y acceso remoto</i> ". </li><li>  En <b>Configuraci√≥n</b> ‚Üí <b>Sistema</b> ‚Üí <b>Administraci√≥n de</b> <i>complementos</i> <b>, el</b> <i>interruptor</i> " <i>Acceess Remote Repository</i> " debe estar activado. </li><li>  Despu√©s de instalar el complemento, los datos que estamos <b>buscando</b> estar√°n en los archivos <b>/ var / lib / openhab2 / uuid</b> y <b>/ var / lib / openhab2 / openhabcloud / secret</b> ( <i>userdata /</i> <i>uuid</i> y <i>userdata / openhabcloud / secret</i> , si no lo <i>instal√≥</i> desde el paquete).  Los ingresamos en la configuraci√≥n de la cuenta en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">myopenHAB</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hacemos</a> clic en <b>Actualizar</b> .  Si todo est√° configurado correctamente, la palabra " <i>En l√≠nea</i> " deber√≠a aparecer a la izquierda de su direcci√≥n de correo.  Esto sugiere que el acceso a su hogar inteligente desde Internet est√° abierto, pero <b>Alice</b> no podr√° usarlo de inmediato.  Primero debe hacer que el dispositivo configurado previamente sea accesible desde el exterior. </li><li>  Vaya a <b>Configuraci√≥n</b> ‚Üí <b>Servicios</b> ‚Üí <b>openHAB Cloud</b> ‚Üí <b>Configurar</b> . </li><li>  En la lista <i>Elementos para exponer a aplicaciones como IFTTT,</i> active la casilla de verificaci√≥n para el control de brillo y haga clic en <b>Guardar</b> . </li><li>  Despu√©s de un tiempo, verificamos que el elemento seleccionado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aparezca</a> en la p√°gina <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">myopenhab.org/items</a> con el estado " <i>ON</i> ". </li></ol><br><img src="https://habrastorage.org/webt/tf/-a/3g/tf-a3gan7vajtb4qjy_urvu0nim.png"><br><br>  El control de la l√°mpara ahora es posible desde Internet, a trav√©s de openHAB Cloud API, que admite la autorizaci√≥n OAuth2.  Pero, desafortunadamente, los clientes est√°n predeterminados de antemano, estos son Alexa, Google Assistant y el servicio IFTTT.  Alice a√∫n no est√° en esta lista.  ¬°Pero esto no es un problema! <br><br><a name="ifttt"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/3w/q5/0d/3wq50dhkw-rwzok-o3nghgq9ioe.jpeg"></div><br><h3>  5. IFTTT </h3><br><blockquote>  Si es as√≠, entonces. </blockquote><br>  Un servicio que le permite construir una cadena de acciones a partir de varios servicios.  Responda condicionalmente con una acci√≥n en un servicio si un disparador para un evento en otro servicio ha funcionado.  IFTTT admite una gran cantidad de servicios, incluido myopenHAB que nos interesa.  Pero no es compatible con Alice.  En general, cualquiera puede crear un m√≥dulo para su servicio all√≠, en primer lugar, debe ponerse en contacto con el departamento de ventas y averiguar el monto de su pago anual a favor de IFTTT.  Nuestro objetivo es utilizar el servicio de forma gratuita para poder redirigir las solicitudes de Alice a openHAB. <br><br><ol><li>  Nos registramos en el sitio web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ifttt.com</a> y vamos a <b>Applets</b> ‚Üí <b>New Applet</b> . </li><li>  Despu√©s de hacer clic en <b>+ esto</b> , debe seleccionar el servicio en el que se desencadenar√° el evento.  Porque  <b>El</b> servicio <b>de Alice no est√°</b> en la lista, debemos elegir algo que pueda recibir comandos de ella.  Este es un servicio de <b>Webhooks</b> .  Haz clic en <b>Conectar</b> . </li><li>  A continuaci√≥n, seleccione el activador " <i>recibir solicitud web</i> " de la lista con un elemento. </li><li>  Especifique el nombre del evento, por ejemplo <b>light_on</b> , y haga clic en <b>Crear</b> . </li><li>  Ahora tenemos que seleccionar la respuesta, haga clic en <b>+ eso</b> .  Nuestra elecci√≥n de <b>openHAB</b> , plug. </li><li>  En la ventana que se abre, la autorizaci√≥n OAuth2 mencionada anteriormente, haga clic en <b>Permitir</b> . </li><li>  La √∫nica respuesta de <i>comando de env√≠o</i> est√° disponible. </li><li>  En la lista desplegable, seleccione el control de la l√°mpara (por ejemplo, Light_Switcher) y especifique la palabra " <i>ON</i> " como la luz en el comando.  Nosotros creamos </li></ol><br>  Para verificar, necesitamos llamar a un disparador en el servicio Webhooks.  Como hacerlo  Enviar una solicitud POST. <br><br><ol><li>  Buscamos <b>el</b> servicio <b>Webhooks</b> en el <b>sitio</b> <b>web de</b> <b>IFTTT</b> y vamos a la documentaci√≥n asociada a √©l. </li><li>  En la p√°gina que se abre, hay un comando que debemos ejecutar, reemplazando <b>{event}</b> con <b>light_on</b> . </li><li>  Despu√©s de hacer clic en <b>Probarlo</b> , la l√°mpara deber√≠a encenderse. </li></ol><br>  Queda por crear una receta similar para el evento light_off, que enviar√° el comando OFF al control de la luz.  Y luego ense√±e a Alice a llamar a estos disparadores a nuestra solicitud. <br><br><img src="https://habrastorage.org/webt/ky/z8/yw/kyz8ywf2mn07hfnfjpzj4jy26i4.png"><br><br><a name="alice"></a><div style="text-align:center;"><img src="https://habrastorage.org/webt/ba/ta/tn/batatn8tse9dchznkvkvxqgn98s.jpeg"></div><br><h3>  6. Alice </h3><br>  En mi orden, en mi deseo, Alice encender√° la luz si usa la plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yandex.Dialogs</a> .  La plataforma se abri√≥ en marzo de este a√±o y permite que cualquiera agregue habilidades a Alice escribiendo el c√≥digo apropiado.  Por el momento, una gran cantidad de habilidades ya se presentan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el cat√°logo</a> .  El desarrollo de habilidades es un tema para un art√≠culo separado sobre Habr√©, y aqu√≠ tenemos " <i>sin una sola l√≠nea de c√≥digo</i> ".  Entonces usaremos los desarrollos disponibles. <br><br><ol><li>  Instalamos la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">versi√≥n beta de la aplicaci√≥n de b√∫squeda Yandex</a> , solo que actualmente es compatible con <b>las habilidades del usuario</b> . </li><li>  Decimos que <b>Alice</b> " <i>activa hechizos m√°gicos</i> ".  Es la capacidad de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>los hechizos</b> / <b>hechizos</b> <b>m√°gicos lo que</b></a> nos permitir√° realizar solicitudes POST a los servidores <b>IFTTT</b> . </li><li>  Haga clic en <b>Agregar</b> y especifique la direcci√≥n para encender la luz del formulario: <br><br><pre> <code class="bash hljs">https://maker.ifttt.com/trigger/light_on/with/key/{user_id}</code> </pre> </li><li>  El siguiente paso es la expresi√≥n de una frase o palabra a la que Alice responder√° completando una solicitud en la direcci√≥n especificada (mi Alice responde "enciende la luz"). </li></ol><br>  Si ahora hace clic en el bot√≥n correspondiente o expresa la propuesta, la solicitud de los servidores de Yandex ir√° al servidor de habilidades, de all√≠ a IFTTT, luego a myopenHAB, que transferir√° los datos a su instancia local con acceso directo al centro de la l√°mpara y la luz se encender√°.  Inmediatamente agregaremos un comando similar para apagar la iluminaci√≥n. <br><br><div style="text-align:center;"><img height="400" src="https://habrastorage.org/webt/xr/5e/nb/xr5enbudszmydm0msmidvavxl_g.jpeg"></div><br>  Debes entender que encender a Alice y decir " <i>enciende la luz</i> " no es suficiente.  Yandex no sabe nada acerca de nuestros equipos para hogares inteligentes, los datos sobre ellos se almacenan en la base de datos de la habilidad " <i>hechizos m√°gicos</i> ".  Por lo tanto, primero debes llamar a la habilidad diciendo " <i>enciende hechizos m√°gicos</i> ", y solo luego enciende y apaga la luz con tu voz. <br><br><h3>  PS </h3><br>  El enfoque con la integraci√≥n de Alice y openHAB a trav√©s de IFTTT no limita su imaginaci√≥n.  Puedes usar la habilidad de " <i>hechizos m√°gicos</i> " para controlar cualquier cosa en tu voz de casa inteligente.  Por ejemplo, openHAB tiene carpetas para Samsung SmartTV, que le permite controlar el sonido y los canales del televisor.  La interacci√≥n de Alice y Webhooks es una implementaci√≥n de una interfaz de voz para todos los servicios IFTTT, los " <i>hechizos m√°gicos</i> " le permiten ejecutar el comando de cualquiera de ellos.  O no puede usar Alice en absoluto y escribir su interfaz, por ejemplo, una aplicaci√≥n m√≥vil que ejecutar√° solicitudes IFTTT a trav√©s de los mismos Webhooks.  S√≠, y no es necesario utilizar IFTTT, por analog√≠a, puede configurar los " <i>hechizos m√°gicos</i> " para cumplir con las solicitudes a su servidor. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es412261/">https://habr.com/ru/post/es412261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es412249/index.html">El trabajo cient√≠fico est√° desactualizado; lo que nos espera a continuaci√≥n</a></li>
<li><a href="../es412251/index.html">Escapar del infierno. El piloto cautivo Devyatayev secuestra un avi√≥n debajo de las narices de los cohetes alemanes.</a></li>
<li><a href="../es412253/index.html">Protegiendo un programa a trav√©s de Vk.com</a></li>
<li><a href="../es412255/index.html">Como fotograf√≠as del nuevo Honor 10. Compare con Huawei P20 y iPhone 7 Plus</a></li>
<li><a href="../es412259/index.html">En los Estados Unidos experimentar√°s un nuevo m√©todo de muerte: inhalaci√≥n de nitr√≥geno</a></li>
<li><a href="../es412263/index.html">C√≥mo funciona el sistema de calificaci√≥n de ciudadanos chinos: cr√≠menes y castigos</a></li>
<li><a href="../es412265/index.html">C√≥mo se cre√≥ World of Tanks VR y por qu√© result√≥ ser un juego completamente diferente</a></li>
<li><a href="../es412267/index.html">Consola de juegos Apple olvidada</a></li>
<li><a href="../es412269/index.html">Amazon Echo Dot vs. Google Home Mini: ¬øqu√© asistente es mejor?</a></li>
<li><a href="../es412271/index.html">El triunfo y la tragedia de "Buran"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>