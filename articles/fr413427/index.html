<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß¢ ü§ûüèΩ ü•Ä Programmation pour les ing√©nieurs r√©seau: utilisation de la configuration üìè üë©üèª‚Äçüè≠ üë®‚Äçüë®‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="M√™me dans un bon r√©seau, du point de vue de la conception, il est n√©cessaire de temps en temps de r√©aliser des travaux de mise √† jour des configuratio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmation pour les ing√©nieurs r√©seau: utilisation de la configuration</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413427/">  M√™me dans un bon r√©seau, du point de vue de la conception, il est n√©cessaire de temps en temps de r√©aliser des travaux de mise √† jour des configurations de certaines entit√©s.  Parmi les raisons les plus convaincantes et anticip√©es d'une telle activit√©, on peut noter la migration pour coordonner les plans physiques et logiques, le d√©veloppement du r√©seau dans le cadre du processus d'√©volution technologique, l'harmonisation de l'architecture des segments connect√©s et la solution des probl√®mes de croissance.  En effet, le cycle de vie d'un r√©seau consiste presque toujours en des changements avec l'un ou l'autre niveau de risque et un effet √©tendu sur un service, dans l'√©valuation desquels le facteur humain ne peut √™tre ignor√©.  Bien qu'il soit tout √† fait appropri√© de g√©n√©raliser cette description √† la plupart des domaines de l'activit√© humaine, le fonctionnement des r√©seaux de communication pr√©sente certaines caract√©ristiques qui m√©ritent d'√™tre comprises, ou du moins d'attention, - les √©l√©ments des r√©seaux de communication sont en communication √©troite, interagissent √©troitement et rendent non seulement directs, mais aussi indirects impact les uns sur les autres.  Par cons√©quent, une strat√©gie comp√©tente des travaux en cours ne deviendra plus productive que si elle est soutenue par des m√©canismes qui r√©duisent, dans la mesure du possible, la probabilit√© d'erreurs humaines.  Dans le prochain article de la s√©rie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Pourquoi les ing√©nieurs r√©seau devraient-ils programmer¬ª,</a> je parlerai des options d'utilisation de l'automatisation dans une t√¢che de ce type. <br><a name="habracut"></a><br>  Dans de nombreuses "amorces" sur l'architecture de r√©seau, les termes r√©seaux √† grande √©chelle et r√©seaux hi√©rarchiques sont utilis√©s de mani√®re presque synonyme, en ce qui concerne la conception d'un domaine IGP, une conception simple et, √† premi√®re vue, compr√©hensible est indiqu√©e - diviser un domaine en domaines.  Dans le m√™me temps, le seuil de saturation est une chose purement individuelle, dans certains cas, un millier de routeurs modernes peuvent normalement coexister dans une zone IGP, sinon trois cents suffisent pour r√©duire consid√©rablement les caract√©ristiques op√©rationnelles.  Pour la plupart, ce seuil est d√©termin√© par les protocoles impos√©s √† l'IGP, donc, dans des conditions de variabilit√© et d'incertitude des limites et des √©chelles du futur r√©seau, les ¬´bisons¬ª de l'industrie trouvent un moyen plus flexible de construire un domaine plat avec la migration ult√©rieure de ses parties form√©es dans des zones distinctes.  En d'autres termes, si vous ne pouvez pas ¬´regarder demain demain¬ª, construisez un r√©seau plat et divisez-le d√®s l'apparition des premiers signes de d√©gradation du temps de convergence ou d'une complexit√© d'exploitation excessive, car l'absence de hi√©rarchie est encore meilleure que la mauvaise choisie dans l'incertitude structure [1, 2, 3]. <br><br>  Des descriptions assez g√©n√©rales et des exemples abstraits, supposons qu'il s'agit d'une r√©gion envahie du domaine OSPFv2, dont la topologie des fibres / canaux physiques permet d√©j√† de discerner les limites des r√©gions futures dans la structure amorphe.  Je ne suis pas partisan de changer quelque chose sur le principe du "tout ou rien", il peut arriver qu'en raison de circonstances impr√©vues, l'espace des opportunit√©s devienne trop √©troit, et les risques attendus sont trop grands.  Changer la r√©gion OSPFv2 est une op√©ration destructrice, donc le sch√©ma le plus simple du processus de migration, qui consiste √† transf√©rer s√©quentiellement des routeurs vers une nouvelle r√©gion le long de la future fronti√®re, est bien pratique dans toutes les topologies.  Heureusement, il y a quelque temps, dans les recommandations pour le d√©veloppement de l'OSPF, la possibilit√© de renforcer la connectivit√© dans plusieurs domaines a √©t√© √©voqu√©e [4].  Gr√¢ce √† cette opportunit√©, nous pouvons diviser la migration en trois √©tapes: <br><br><ol><li>  Cr√©ation d'une connectivit√© suppl√©mentaire (secondaire) dans une nouvelle zone </li><li>  Transfert d'une nouvelle zone au mode principal et de l'ancienne √† une zone suppl√©mentaire </li><li>  Suppression de la connectivit√© dans l'ancien p√©rim√®tre </li></ol><br>  Au premier stade, la topologie de la nouvelle r√©gion se d√©veloppe progressivement; au second, la topologie de l'ancienne r√©gion se r√©tr√©cit.  Sous r√©serve de la congruence des topologies des zones anciennes et nouvelles, nous obtenons un routage coh√©rent entre les n≈ìuds traduits et non traduits, ce qui, √† son tour, permet de diviser les √©tapes en sous-√©tapes ind√©pendantes, √† chacune desquelles un travail peut √™tre effectu√© avec une partie des n≈ìuds.  Il convient d'aborder le choix des n≈ìuds de travail dans le cadre de la sous-√©tape du point de vue de l'utilisation effective des canaux dans un r√©seau particulier afin d'√©viter le rechargement √† la fronti√®re des anciennes et nouvelles zones.  Malgr√© le fait que l'article soit consacr√© √† la programmation, je pense qu'il ne serait pas superflu de dire quelques mots sur le comportement des protocoles impos√©s √† IGP dans le contexte de l'√©volution des domaines.  Le LDP se comporte de mani√®re assez pr√©visible; une traduction fluide est obtenue en fournissant une connectivit√© IP entre les sessions cibl√©es d'adresse de transport et d'interface.  √âtant donn√© que BGP est un protocole tr√®s flexible, vous devez faire tr√®s attention √† cet avion.  C'est bien si BGP n'introduit pas de libert√©s sp√©ciales sur les n≈ìuds traduits sous la forme de modifications dans les pr√©f√©rences locales ou d'autres crit√®res qui d√©terminent la d√©cision de routage local qui sont incoh√©rentes entre les n≈ìuds.  En d'autres termes, le comportement de BGP est √©galement pr√©visible si la s√©lection d'itin√©raire dans la r√©gion ne contredit pas la r√®gle de chemin IGP suivante.  Il y a un point subtil associ√© au travail de RSVP pendant la p√©riode de coexistence de deux zones.  Le fait de remplir la table TED √† partir de deux sources avec une visibilit√© diff√©rente fait r√©fl√©chir, par exemple, vous risquez de perdre les m√©canismes FRR jusqu'√† ce que le travail soit termin√©.  Cela peut se produire si les routeurs avec une visibilit√© plus √©lev√©e, qui se trouvent dans deux zones, calculent l'ERO via un routeur avec moins de visibilit√©, c'est-√†-dire  via un segment de r√©seau traduit sans informations topologiques sur une autre zone.  Cela ne peut pas √™tre qualifi√© de catastrophe, car le chemin sera finalement √©tabli, mais il ne faut pas l'oublier.  Un art particulier n√©cessite de combiner le travail d'introduction des hi√©rarchies IGP avec le m√™me type de travail dans le plan BGP, par exemple, en migrant le maillage complet dans les r√©flecteurs de route.  L'introduction de hi√©rarchies dans diff√©rents plans vaut mieux √™tre effectu√©e s√©quentiellement, la m√™me chose, √† mon avis, s'applique √† toutes les choses qui cachent les informations de routage, la synth√®se est plus facile √† construire sur une base stable d'IGP hi√©rarchique que de combiner ces √©tapes. <br><br>  Donc, nous avons un plan g√©n√©ral, et si vous n'avez pas encore chang√© d'avis, r√©fl√©chissons √† une impl√©mentation logicielle sur Pyez, quelque chose comme celle-ci dans l'image. <br><br><img src="https://habrastorage.org/webt/xm/0v/4s/xm0v4shfndzjxnvn1rirhmajgdq.png" alt="image"><br><br>  Chaque bel ovale peut √™tre une entit√© logicielle distincte, c'est-√†-dire  une chose qui fait le travail et pr√©pare les donn√©es pour la prochaine √©tape.  Les donn√©es initiales signifient des informations provenant du r√©seau, par exemple, pour pr√©parer la configuration d'une nouvelle zone OSPF, vous devez obtenir les noms des interfaces actives appartenant √† l'ancienne zone et leur poids, ce qui signifie que nous aurons besoin de comp√©tences pour travailler avec les tables d'op√©ration et les vues.  Ces concepts peuvent √™tre trouv√©s dans un article pr√©c√©dent de la s√©rie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Programmation pour les ing√©nieurs r√©seau: le premier cas¬ª</a> .  Au premier stade, le g√©n√©rateur enregistre dans les fichiers les commandes n√©cessaires pour activer la nouvelle zone, au second - pour supprimer l'ancien et transf√©rer le nouveau au mode principal, au troisi√®me - la commande pour supprimer l'ancienne zone.  Pour l'avenir, je dirai que pour cet article, je n'utilise pas intentionnellement des visualiseurs de mod√®le comme Jinja2.  Afin de ne pas √™tre distrait du sujet cible, le code est √©crit aussi simple que possible.  Si quelqu'un est int√©ress√© par la documentation sur le lien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Documentation Jinja2"</a> . <br><br><div class="spoiler">  <b class="spoiler_title">√âtape Code de g√©n√©ration de configuration</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) yml = <span class="hljs-string"><span class="hljs-string">''' --- OSPFInterface: rpc: get-ospf-interface-information args: area: '0.0.0.200' detail: True item: ospf-interface view: OSPFInterfaceView OSPFInterfaceView: fields: name: interface-name type: interface-type cost: interface-cost '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) ospf_interfaces = OSPFInterface(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st1-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-string"><span class="hljs-string">'ge'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interface.name ): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st2-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.250'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ospf_interface.cost != <span class="hljs-string"><span class="hljs-string">'0'</span></span>): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st3-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre> <br></div></div><br>  Pour plus de clart√©, j'ai mis en place dans un tel r√©seau sur vMX. <br><br><img src="https://habrastorage.org/webt/mk/hr/6i/mkhr6ig4wjo3n4hxkswba2xej4q.png" alt="image"><br><br>  vMX est un routeur logiciel complet de Juniper Networks, reproduisant en grande partie le comportement de son fr√®re a√Æn√©, le fer MX.  Non pas que ce soit un produit qui doit √™tre pr√©sent√©, il est juste utile de garder ces choses √† port√©e de main pour les exercices de programmation ou les tests de laboratoire.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">L'essai</a> peut √™tre t√©l√©charg√© ici <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"T√©l√©chargement d'essai vMX"</a> , et les instructions d'installation sur ce lien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Pr√©paration du syst√®me pour installer vMX"</a> . <br><br>  Les routeurs bb, abr1 et abr2 forment la r√©gion z√©ro, les routeurs r1, r2, r3 et r4 - doivent √™tre d√©plac√©s de la 200e r√©gion √† la 250e. <br><br><div class="spoiler">  <b class="spoiler_title">lab @ bb&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { passive; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ abr1&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ abr2&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ r1&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r2&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r3&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r4&gt; afficher les protocoles de configuration</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre> <br></div></div><br>  Pour le routeur r2, l'ensemble de commandes suivant sera g√©n√©r√©. <br><br><div class="spoiler">  <b class="spoiler_title">Pour la premi√®re √©tape</b> <div class="spoiler_text">  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 1.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 1.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 1.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 2.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 2.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 2.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 3.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 3.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 3.0 m√©trique 1</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Pour la deuxi√®me √©tape</b> <div class="spoiler_text">  <i>supprimer les protocoles zone ospf 0.0.0.200</i> <i><br></i>  <i>supprimer les protocoles zone ospf 0.0.0.250</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 1.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 1.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 1.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 1.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 1.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 2.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 2.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 2.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 2.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 2.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 3.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 3.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 3.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface ge-0/0 / 3.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface ge-0/0 / 3.0 m√©trique 1</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.250 interface lo0.0 type d'interface p2p</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface lo0.0 secondaire</i> <i><br></i>  <i>d√©finir les protocoles zone ospf 0.0.0.200 interface lo0.0 type d'interface p2p</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Pour la troisi√®me √©tape</b> <div class="spoiler_text">  <i>supprimer les protocoles zone ospf 0.0.0.200</i> <i><br></i> <br></div></div><br>  Comme je l'ai d√©j√† √©crit, les √©l√©ments du r√©seau ont un √©tat interne, autour et √† l'int√©rieur d'eux quelque chose se produit constamment, que nous le voulions ou non.  La survenance d'√©v√©nements tels qu'une d√©faillance de l'√©metteur-r√©cepteur, une panne de courant sur un n≈ìud ou une coupure dans un canal optique doit √™tre consid√©r√©e comme acquise et prise en compte pendant le travail.  Je propose de pr√™ter attention √† ce fait dans le cadre du choix de v√©rification du succ√®s des √©tapes de migration.  Aussi paradoxal que cela puisse para√Ætre, dans ce cas, il n'est pas n√©cessaire pour nous de v√©rifier si le voisinage OSPF est apparu sur telle ou telle interface, car les raisons de son absence peuvent √™tre dans un tout autre plan.  En plus de ce qui pr√©c√®de, une erreur ou une inexactitude peut toujours p√©n√©trer dans les donn√©es source, par exemple, sous la forme d'une interface oubli√©e qui doit √™tre supprim√©e, mais qui recherche actuellement le "vide".  Dans le processus de g√©n√©ration de contr√¥les, il est utile de monter d'un niveau pour regarder le r√©seau du point de vue des services fournis et des protocoles impos√©s, car en fin de compte l'√©tat de ces seules choses vous permet de prendre une d√©cision √©clair√©e sur le succ√®s d'une √©tape particuli√®re.  Peu de clients acceptent des articles publics bas√©s sur les r√©sultats de leur travail, c'est pourquoi j'ai mis en place un environnement virtuel de d√©monstration.  Dans cet environnement, je me limiterai √† v√©rifier l'√©tat des sessions BGP, qui sont construites sur une base un √† un entre les routeurs, ce seront nos services et services impos√©s.  Si, apr√®s le travail, les conditions de leurs performances sont r√©unies sous la forme d'une connectivit√© IP chacune avec chacun, alors il y a lieu de croire que le travail a √©t√© effectu√© avec succ√®s.  Dans les projets r√©els, les contr√¥les sont g√©n√©ralement limit√©s au volume de services et de protocoles impos√©s, qui est d√©sign√© comme critique pour l'entreprise dans un r√©seau donn√©.  Cela ne s'applique pas √† la programmation, n√©anmoins, je ne peux que me concentrer sur cette question, car le choix du crit√®re de r√©ussite est la cl√© d'un bon sommeil apr√®s le travail effectu√©. <br><br><div class="spoiler">  <b class="spoiler_title">Code de v√©rification de session BGP</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> yml = <span class="hljs-string"><span class="hljs-string">''' --- BGPGroup: rpc: get-bgp-group-information args: group-name: 'int' item: bgp-group view: BGPGroupView BGPGroupView: fields: count: peer-count established: established-count '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) bgp_group = BGPGroup(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bgp_group: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (group.count != group.established): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'bgp connection lost'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'dont panic!'</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">R√©sultats de son travail</b> <div class="spoiler_text">  DEBUG - obtenir une connexion ssh au 10.83.20.68 <br>  DEBUG - ssh cionnection pour h√©berger le 10.83.20.68 √©tabli <br>  DEBUG - connexion 10.83.20.68 nomm√©e r1 √©tablie <br>  pas de panique! <br>  DEBUG - obtenir une connexion ssh au 10.83.20.69 <br>  DEBUG - ssh cionnection pour h√©berger le 10.83.20.69 √©tablie <br>  DEBUG - connexion 10.83.20.69 nomm√©e r2 √©tablie <br>  pas de panique! <br>  DEBUG - obtenir une connexion ssh au 10.83.20.70 <br>  DEBUG - ssh cionnection pour h√©berger 10.83.20.70 √©tablie <br>  DEBUG - connexion 10.83.20.70 nomm√©e r3 √©tablie <br>  pas de panique! <br>  DEBUG - obtenir une connexion ssh au 10.83.20.71 <br>  DEBUG - ssh cionnection pour h√©berger 10.83.20.71 √©tablie <br>  DEBUG - connexion 10.83.20.71 nomm√©e r4 √©tablie <br>  pas de panique! <br>  DEBUG - obtenir une connexion ssh au 10.83.20.66 <br>  DEBUG - ssh cionnection pour h√©berger 10.83.20.66 √©tablie <br>  DEBUG - connexion 10.83.20.66 nomm√©e abr1 √©tablie <br>  pas de panique! <br>  DEBUG - obtenir une connexion ssh √† 10.83.20.67 <br>  DEBUG - ssh cionnection pour h√©berger le 10.83.20.67 √©tablie <br>  DEBUG - connexion 10.83.20.67 nomm√©e abr2 √©tablie <br>  pas de panique! <br></div></div><br>  Jusqu'√† pr√©sent, nous parlions principalement de certaines choses de r√©seau, mais je n'ai toujours pas mentionn√© un mot sur le code du programme, qui semble √™tre au centre de l'attention dans un article portant ce nom.  Premi√®rement, il me semble que les pens√©es sont beaucoup plus importantes que le code, ayant des entit√©s formalis√©es dans la t√™te, un ing√©nieur pourra les transformer en outil et les √©noncer sous forme de code.  Deuxi√®mement, je ne veux pas me r√©p√©ter, tout ce qui peut ne pas sembler √©vident dans ces exemples, ainsi que les connaissances minimales n√©cessaires pour commencer √† travailler avec Python et Pyez, sont contenus dans l'article pr√©c√©dent de la s√©rie.  Troisi√®mement, le code de pr√©paration de la configuration effectue son travail, qui est appel√© hors ligne et n'a pas d'effet imm√©diat sur le r√©seau, il est donc peu probable qu'il suscite un int√©r√™t.  Les choses sont quelque peu diff√©rentes avec le code d'impl√©mentation de la phase d'impl√©mentation; le d√©veloppement de ces proc√©dures pose les questions suivantes: <br><br><ul><li>  Comment v√©rifier que l'int√©gralit√© du volume de commandes est correctement per√ßu par l'interpr√®te? </li><li>  Comment v√©rifier que les modifications apport√©es √† la configuration ont bien √©t√© appliqu√©es? </li><li>  Comment impl√©menter un sch√©ma de configuration transactionnel? </li><li>  Comment restaurer la configuration en cas de perte de contr√¥le? </li><li>  Comment nettoyer si l'interpr√®te signale une erreur lors du transfert des commandes? </li></ul><br>  Plus on pr√™te attention √† ces questions, moins souvent les surprises seront servies au stade de l'ex√©cution.  Imaginez les tracas d'une erreur de syntaxe d√©crivant une politique de routage lorsque les classificateurs de cette politique ne sont que partiellement approuv√©s par l'interpr√©teur.  Si vous ne contr√¥lez pas ligne par ligne le processus de fusion de cette strat√©gie avec la configuration actuelle, vous pouvez mettre la pile d'√©quipement dans un √©tat inad√©quat en un seul clic sur un bouton.  Par cons√©quent, j'adh√®re √† peu pr√®s √† un tel bloc du diagramme de l'√©tape d'ex√©cution. <br><br><img src="https://habrastorage.org/webt/ou/kz/8q/oukz8qzqdaq9oqp6weqsg9-xpu4.png" alt="image"><br><br>  Arm√© de la documentation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pyez</a> , le code du chargeur de configuration universel suivant a √©t√© compil√©, que vous pouvez utiliser dans votre travail quotidien, tout comme je l'utilise dans le mien. <br><br><div class="spoiler">  <b class="spoiler_title">conf_change.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.utils.config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> copy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> traceback <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.exception <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path yml = <span class="hljs-string"><span class="hljs-string">''' --- VersionInfo: rpc: get-software-information item: software-information view: VersionInfoView VersionInfoView: fields: name: host-name '''</span></span> Device.auto_probe = <span class="hljs-number"><span class="hljs-number">3</span></span> ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> cur_stage=<span class="hljs-string"><span class="hljs-string">'2'</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTestOSPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF : at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d_conf = p_dev.cli(<span class="hljs-string"><span class="hljs-string">"show configuration | display set"</span></span>).split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) ret_val = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> set_found = <span class="hljs-number"><span class="hljs-number">0</span></span> c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(c_path, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f: c_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'delete '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c_line): set_found = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (c_line <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> d_conf) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (c_line != <span class="hljs-string"><span class="hljs-string">''</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF found missing line '</span></span> + c_line ret_val = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> f.close() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (set_found == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (f_do == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret_val <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> doTestOSPF(p_dev, p_node, f_do) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> v = VersionInfo(l_dev).get() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) traceback.print_exc() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCompare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCompare at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.diff() == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCompare : conf.diff at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doLoad at '</span></span> + p_node c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (os.path.isfile(c_path)): p_conf.load(path=c_path, format=<span class="hljs-string"><span class="hljs-string">'set'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doLoad : cant load config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_r)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doRollback at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.rollback(rb_id=p_r) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doRollback : cant rollback config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommitCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommitCheck at '</span></span> + p_node p_conf.commit_check() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommitCheck : cant config commit check config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_confirm_m=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommit at '</span></span> + p_node commit_res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p_confirm_m == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): commit_res = p_conf.commit(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: commit_res = p_conf.commit(confirm=p_confirm_m, timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (commit_res == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> CommitError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> c_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : cant config commit at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(c_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> RpcTimeoutError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> t_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : config was commited at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' with the following ex:'</span></span> + str(t_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> Config(p_dev) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> conf: is_compare = doCompare(conf, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : at config compare '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : configuration locked at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- starting to do config changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doLoad(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.load '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commit check at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommitCheck(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.doCommitCheck failed at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> commit_m = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commiting changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(conf, node, commit_m) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.commit '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after commit at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : cant do job '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> node_list = [] result_list = {} <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(ip_f_name, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_ip: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f_ip: c_ip_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c_ip_line != <span class="hljs-string"><span class="hljs-string">''</span></span>): node_list.append(c_ip_line) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ************************************ '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking '</span></span> + node result_list.setdefault(node, {}) cur_dev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) is_test = doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- error'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf exist'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'nn'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf not exist, doing change'</span></span> is_job = doJob(cur_dev, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- done job at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- going sleep at '</span></span> + node time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking job status '</span></span> + node cur_dev_confirm = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( cur_dev_confirm != <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- commiting the configuration at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(Config(cur_dev_confirm), node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant commit the configuration at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- configuration commited at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant find conf after job '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev_confirm) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant access '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' for commiting'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> result_list</code> </pre><br></div></div><br>  Et les r√©sultats de son travail en trois √©tapes <br><br><div class="spoiler">  <b class="spoiler_title">Texte masqu√©</b> <div class="spoiler_text"> <code>Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:19:30) [MSC v.1500 32 bit (Intel)] on win32 <br> Type "copyright", "credits" or "license()" for more information. <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br></code> <br></div></div><br><ol><li>  Le protocole de routage IS-IS complet - Hannes Gredler, Walter Goralski </li><li>  OSPF  Anatomie d'un protocole de routage Internet - John T. Moy </li><li>  Fusions et migrations de r√©seaux: conception et mise en ≈ìuvre de Junos - Gonzalo Gomez Herrero, Jan Anton Bernal Van Der Ven </li><li>  Adjacence multi-zones OSPF - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tools.ietf.org/html/rfc5185</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413427/">https://habr.com/ru/post/fr413427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413415/index.html">Limites de concurrence adaptative dans Netflix</a></li>
<li><a href="../fr413417/index.html">Efficacit√© √©nerg√©tique: les approches que nous testons en Russie</a></li>
<li><a href="../fr413419/index.html">R√©sum√© des nouvelles de PostgreSQL. Num√©ro 7</a></li>
<li><a href="../fr413421/index.html">Incertitudes possibles dans la carri√®re d'un programmeur</a></li>
<li><a href="../fr413423/index.html">Solutions d'acc√®s √† distance dans Mars IS</a></li>
<li><a href="../fr413429/index.html">Nous √©crivons un plugin pour recevoir les certificats g√©n√©riques Let's Encrypt</a></li>
<li><a href="../fr413431/index.html">Ateliers sur le d√©veloppement de contrats intelligents sur Solidity</a></li>
<li><a href="../fr413433/index.html">65% des informaticiens russes souhaitent travailler √† l'√©tranger</a></li>
<li><a href="../fr413435/index.html">L'h√©r√©dit√© au-del√† de la g√©n√©tique</a></li>
<li><a href="../fr413437/index.html">Le messager de tout</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>