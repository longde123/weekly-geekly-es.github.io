<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🏭 📃 🏂🏻 Amazon Lumberyard: der Schrei der Seele 👩🏿‍💼 🤛🏽 🐥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spiele sind eines der beliebtesten Softwareprodukte. Dies ist eine riesige Branche, in der eine neue Spiel-Engine - Amazon Lumberyard. Das Projekt bef...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Amazon Lumberyard: der Schrei der Seele</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/416565/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94c/9b7/4f0/94c9b74f00eae5bc8d344548dd744585.png"></div><br>  Spiele sind eines der beliebtesten Softwareprodukte.  Dies ist eine riesige Branche, in der eine neue Spiel-Engine - Amazon Lumberyard.  Das Projekt befindet sich noch im Beta-Status und es hat Zeit, Fehler zu beheben und die Qualität des Codes zu verbessern.  Die Entwickler der Engine haben in naher Zukunft viel zu tun, um Millionen von Spielern und Spieleentwicklern nicht zu enttäuschen. <br><a name="habracut"></a><br><h2>  Einführung </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Amazon Lumberyard</a> ist eine kostenlose plattformübergreifende AAA-Spiel-Engine, die von Amazon entwickelt wurde und auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CryEngine-</a> Engine-Architektur basiert, die 2015 von Crytek lizenziert wurde.  Die Analyse von CryEngine wurde von mir im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">August 2016</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">April 2017</a> bereits zweimal durchgeführt.  Gleichzeitig muss ich feststellen, dass sich der Code nach einem Jahr nur noch verschlechterte.  Und neulich habe ich mich entschlossen zu sehen, was Amazon basierend auf dieser Spiel-Engine gemacht hat.  Sie haben sehr gut mit der Umwelt gearbeitet.  Die Dokumentation für Entwickler und Software zur Bereitstellung einer Arbeitsumgebung ist sehr cool und auf hohem Niveau.  Aber das Problem ist wieder mit dem Code!  Ich hoffe, dass Amazon viel mehr Ressourcen für die Arbeit mit dem Projekt hat und trotzdem auf die Qualität des Codes achtet.  Mit diesem Test möchte ich die Entwickler auf die Qualität des Codes aufmerksam machen und auf einen neuen Ansatz bei der Entwicklung dieser Spiel-Engine drängen.  Der aktuelle Status des Codes war so bedauerlich, dass ich den Titel des Artikels mehrmals geändert und das Titelbild neu gezeichnet habe, als ich den Bericht mit den Analyseergebnissen durchgesehen habe.  Die erste Version des Bildes war weniger emotional: <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/fa3/c02/e6dfa3c02fad5fb4eadd6ca01cd68b62.png"></div><br><br>  Wir haben die Quellen von Amazon Lumberyard der neuesten verfügbaren Version 1.14.0.1 analysiert.  Der Quellcode wird aus dem Repository auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> entnommen.  Eines der ersten Spiele auf der Lumberyard-Engine sollte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Star Citizen sein</a> .  Potenzielle Spieler, die auf sie warten, lade ich Sie auch ein, einen Blick auf das zu werfen, was derzeit "unter der Haube" des Spiels ist. <br><br><h2>  Integration mit PVS-Studio </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PVS-Studio wurde</a> als statischer Code-Analysator verwendet.  Es ist für Windows, Linux und MacOS verfügbar.  Das heißt,  Für die Analyse plattformübergreifender Projekte steht sogar eine Auswahl für komfortableres Arbeiten zur Verfügung.  Neben C und C ++ wird die Analyse von Projekten in der Sprache C # unterstützt.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java-Pläne</a> .  Die überwiegende Mehrheit des Codes auf der Welt ist in den aufgeführten Sprachen geschrieben (natürlich nicht ohne Fehler). Probieren Sie also den PVS-Studio-Analysator für Ihr Projekt aus, Sie werden viele interessante Dinge lernen ;-). <br><br>  Als Lumberyard-Montagesystem wird WAF verwendet, das auch in CryEngine enthalten war.  Der Analysator hat keine spezielle Möglichkeit, sich in dieses Montagesystem zu integrieren.  Ich entschied mich für ein Projekt unter Windows und entschied mich für diese Methode zum Starten der Analyse: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ein Kompilierungsüberwachungssystem</a> .  Die Projektdatei für Visual Studio wird automatisch generiert.  Es kann verwendet werden, um das Projekt zu erstellen und den Analysebericht anzuzeigen. <br><br>  Die Liste der zu analysierenden Befehle sieht ungefähr so ​​aus: <br><br><pre><code class="cpp hljs">cd /path/to/lumberyard/dev lmbr_waf.bat ... CLMonitor.exe monitor MSBuild.exe ... LumberyardSDK_vs15.sln ... CLMonitor.exe analyze --<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> /path/to/report.plog</code> </pre> <br>  Der Bericht kann, wie gesagt, in Visual Studio angezeigt werden. <br><br><h2>  Über Igor und Qualcomm </h2><br>  Amazon Lumberyard positioniert sich als plattformübergreifende Spiel-Engine.  Es ist einfach, ein Projekt mit einer solchen Funktion bei den Massen bekannt zu machen, aber es ist sehr schwierig, es zu warten.  Eine der Warnungen von PVS-Studio wurde auf einem Codefragment ausgegeben, auf dem der Programmierer Igor mit dem Qualcomm-Compiler kämpfte.  Vielleicht hat er sein Problem gelöst, aber einen äußerst verdächtigen Code hinterlassen.  Ich beschloss, es mit einem Bild zu zeichnen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V523</a> Die Anweisung 'then' entspricht der Anweisung 'else'.  toglsloperand.c 700 <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/933/cc0/610/933cc0610c9968b8c0d1455ffcd4f245.png"></p><br>  Hier wird unabhängig von der berechneten Bedingung derselbe Code ausgeführt.  Vor dem Hintergrund der Kommentare sieht eine solche Entscheidung verdächtig aus. <br><br>  Im Allgemeinen ist das Projekt nicht der einzige Ort, an dem die Bedingungen aus Gründen der Klarheit oder zur Korrektur eines echten Fehlers vereinfacht werden müssen.  Hier ist eine Liste solcher Orte: <br><br><ul><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  livingentity.cpp 1385 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  tometalinstruction.c 4201 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  scripttable.cpp 905 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  budgetingsystem.cpp 701 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  editorframeworkapplication.cpp 562 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  partikular.cpp 130 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  trackviewnodes.cpp 1223 </li><li>  V523 Die Anweisung 'then' entspricht der Anweisung 'else'.  propertyoarchive.cpp 447 </li></ul><br><h2>  Python ++ </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/000/30b/8bd/00030b8bd5aa006af7df8c98db5ef66f.png"></div><br><br>  Der Analysator hat einen so lustigen Code gefunden: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V709</a> CWE-682 Verdächtiger Vergleich gefunden: 'a == b == c'.  Denken Sie daran, dass 'a == b == c' nicht gleich 'a == b &amp;&amp; b == c' ist.  toglslinstruction.c 564 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallBinaryOp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src1SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> src0SwizCount = GetNumSwizzleElements(....); <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> dstSwizCount = GetNumSwizzleElements(....); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src1SwizCount == src0SwizCount == dstSwizCount) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... } .... }</span></span></code> </pre> <br>  In C ++ wird ein solcher Code leider erfolgreich kompiliert, aber er wird überhaupt nicht ausgeführt, wie es scheint.  Ausdrücke in C ++ werden in der Reihenfolge ihrer Priorität ausgewertet und führen bei Bedarf implizite Castes aus. <br><br>  Eine solche Überprüfung wäre beispielsweise in der Python-Sprache korrekt.  Aber in dieser Situation hat sich der Entwickler "in den Fuß geschossen". <br><br>  3 weitere Kontrollaufnahmen: <br><br><ul><li>  V709 CWE-682 Verdächtiger Vergleich gefunden: 'a == b == c'.  Denken Sie daran, dass 'a == b == c' nicht gleich 'a == b &amp;&amp; b == c' ist.  toglslinstruction.c 654 </li><li>  V709 CWE-682 Verdächtiger Vergleich gefunden: 'a == b == c'.  Denken Sie daran, dass 'a == b == c' nicht gleich 'a == b &amp;&amp; b == c' ist.  toglslinstruction.c 469 </li><li>  V709 CWE-682 Verdächtiger Vergleich gefunden: 'a == b == c'.  Denken Sie daran, dass 'a == b == c' nicht gleich 'a == b &amp;&amp; b == c' ist.  tometalinstruction.c 539 </li></ul><br><h2>  Die erste und eine der besten Diagnosen </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e9/03c/f55/9e903cf5512521593ce3a8f226105025.png"></div><br><br>  Es geht um die Warnung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> - die erste Allzweckdiagnose in PVS-Studio.  Fehler, die allein durch diese Diagnose gefunden werden, können ausreichen, um einen Artikel zu schreiben.  Und das Amazon Lumberyard-Projekt zeigt dies sehr gut. <br><br>  Leider ist es langweilig, Fehler desselben Typs lange Zeit zu betrachten. Daher werde ich in diesem Abschnitt nur einige Codefragmente kommentieren und die restlichen Warnungen werden aufgelistet. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> Links und rechts vom '||' befinden sich identische Unterausdrücke.  Operator: hotX &lt;0 ||  hotX &lt;0 editorutils.cpp 166 <br><br><pre> <code class="cpp hljs">QCursor CMFCUtils::LoadCursor(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pm.isNull() &amp;&amp; (hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || hotX &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-function"><span class="hljs-function">QFile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span></span>; f.open(QFile::ReadOnly); <span class="hljs-function"><span class="hljs-function">QDataStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stream</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;f)</span></span></span></span>; stream.setByteOrder(QDataStream::LittleEndian); f.read(<span class="hljs-number"><span class="hljs-number">10</span></span>); quint16 x; stream &gt;&gt; x; hotX = x; stream &gt;&gt; x; hotY = x; } .... }</code> </pre> <br>  Der Bedingung fehlt die Variable <i>hot</i> <b><i>Y.</i></b>  Klassischer Tippfehler. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke 'sp.m_pTexture == m_pTexture'.  shadercomponents.h 487 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke 'sp.m_eCGTextureType == m_eCGTextureType'.  shadercomponents.h 487 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> != (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SCGTexture&amp; sp) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sp.m_RegisterOffset == m_RegisterOffset &amp;&amp; sp.m_Name == m_Name &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= 1 sp.m_RegisterCount == m_RegisterCount &amp;&amp; sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_BindingSlot == m_BindingSlot &amp;&amp; sp.m_Flags == m_Flags &amp;&amp; sp.m_pAnimInfo == m_pAnimInfo &amp;&amp; sp.m_pTexture == m_pTexture &amp;&amp; // &lt;= 1 sp.m_eCGTextureType == m_eCGTextureType &amp;&amp; // &lt;= 2 sp.m_bSRGBLookup == m_bSRGBLookup &amp;&amp; sp.m_bGlobal == m_bGlobal) { return false; } return true; }</span></span></code> </pre> <br>  In diesem Fragment wurden zwei Kopierpasten gleichzeitig gefunden.  Aus Gründen der Klarheit habe ich Pfeile gemalt. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> Links und rechts vom Operator '==' befinden sich identische Unterausdrücke: pSrc.GetLen () == pSrc.GetLen () fbxpropertytypes.h 978 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FbxTypeCopy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FbxBlob&amp; pDst, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> FbxString&amp; pSrc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> lCastable = pSrc.GetLen() == pSrc.GetLen(); FBX_ASSERT( lCastable ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( lCastable ) pDst.Assign(pSrc.Buffer(), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)pSrc.GetLen()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lCastable; }</code> </pre> <br>  Hier möchte ich die Entwickler von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AUTODESK begrüßen</a> .  Dieser Fehler stammt aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FBX SDK-</a> Bibliothek.  Verwirrte Variablen <i>pSrc</i> und <i>pDst</i> .  Ich denke, neben Lumberyard gibt es auch viele andere Benutzer, deren Projekte von Code mit diesem Fehler abhängen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501</a> Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: pTS-&gt; pRT_ALD_1 &amp;&amp; pTS-&gt; pRT_ALD_1 d3d_svo.cpp 857 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CSvoRenderer::ConeTracePass(SSvoTargetsSet* pTS) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pTS-&gt;pRT_ALD_1 &amp;&amp; pTS-&gt;pRT_ALD_1) { <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nPrevWidth = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { pTS-&gt;pRT_ALD_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">10</span></span>, m_nTexStateLinear); pTS-&gt;pRT_RGB_1-&gt;Apply(<span class="hljs-number"><span class="hljs-number">11</span></span>, m_nTexStateLinear); } } .... }</code> </pre> <br>  Zurück zum Lumberyard-Code.  In der Bedingung wird der gleiche Zeiger <i>pTS-&gt; pRT_ALD_1 überprüft</i> .  Einer von ihnen sollte <i>pTS-&gt; pRT_RGB_1 gewesen sein</i> .  Vielleicht ist es auch nach der Erklärung nicht sofort möglich, den Unterschied zu erkennen, aber es gibt einen: Der Unterschied liegt in den kurzen Teilzeichenfolgen <i>ALD</i> und <i>RGB</i> .  Wenn Ihnen mitgeteilt wird, dass die manuelle Codeüberprüfung ausreicht, zeigen Sie dieses Beispiel. <br><br>  Und wenn dieses Beispiel nicht ausreicht, gibt es 5 weitere ähnliche. <br><ul><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke.  Operator:! pTS-&gt; pRT_ALD_0 ||! pTS-&gt; pRT_ALD_0 d3d_svo.cpp 1041 </li><li>  V501 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: m_pRT_AIR_MIN &amp;&amp; m_pRT_AIR_MIN d3d_svo.cpp 1808 </li><li>  V501 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: m_pRT_AIR_MAX &amp;&amp; m_pRT_AIR_MAX d3d_svo.cpp 1819 </li><li>  V501 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: m_pRT_AIR_SHAD &amp;&amp; m_pRT_AIR_SHAD d3d_svo.cpp 1830 </li><li>  V501 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: s_pPropertiesPanel &amp;&amp; s_pPropertiesPanel entityobject.cpp 1700 </li></ul><br>  Und wie versprochen, hier eine Liste der verbleibenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V501-</a> Warnungen ohne Codebeispiele: <div class="spoiler">  <b class="spoiler_title">Liste erweitern</b> <div class="spoiler_text"><ul><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'MaxX &lt;0'.  Betreiber.  czbufferculler.h 128 </li><li>  V501 Es gibt identische Unterausdrücke 'm_joints [op [1]]. Limits [1] [i]' links und rechts vom Operator '-'.  artikulierte Identität.cpp 795 </li><li>  V501 Links und rechts vom Operator '-' befinden sich identische Unterausdrücke 'm_joints [i] .limits [1] [j]'.  artikulierte Identität.cpp 2044 </li><li>  V501 Links und rechts vom '|' gibt es identische Unterausdrücke 'irect [0] .x + 1 - irect [1] .x &gt;&gt; 31'.  Betreiber.  trimesh.cpp 4029 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1779 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1827 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1865 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1779 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1827 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'b-&gt; mlen &lt;= 0'.  Betreiber.  bstrlib.c 1865 </li><li>  V501 Links und rechts vom Operator '-' befinden sich identische Unterausdrücke: dd - dd finalizingspline.h 669 </li><li>  V501 Links und rechts vom Operator '^' befinden sich identische Unterausdrücke 'pVerts [2] - pVerts [3]'.  roadrendernode.cpp 307 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke '! PGroup-&gt; GetStatObj ()'.  Betreiber.  Terrain_Node.cpp 594 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke.  Operator: val == 0 ||  val == - 0 xmlcpb_attrwriter.cpp 367 </li><li>  V501 Links und rechts vom '|' befinden sich identische Unterausdrücke 'geom_colltype_solid'.  Betreiber.  Anhangmanager.cpp 1058 </li><li>  V501 Links und rechts vom '|' befinden sich identische Unterausdrücke '(TriMiddle - RMWPosition)'.  Betreiber.  modelmesh.cpp 174 </li><li>  V501 Links und rechts vom '|' befinden sich identische Unterausdrücke '(Ziel - pAbsPose [b3] .t)'.  Betreiber.  posemodifierhelper.cpp 115 </li><li>  V501 Links und rechts vom '|' befinden sich identische Unterausdrücke '(Ziel - pAbsPose [b4] .t)'.  Betreiber.  posemodifierhelper.cpp 242 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke '(m_eTFSrc == eTF_BC6UH)'.  Betreiber.  texturestreaming.cpp 983 </li><li>  V501 Links und rechts vom Operator '-' befinden sich identische Unterausdrücke: q2.vz - q2.vz azentitynode.cpp 102 </li><li>  V501 Links und rechts vom Operator '-' befinden sich identische Unterausdrücke: q2.vz - q2.vz entitynode.cpp 107 </li><li>  V501 Links und rechts vom '||' befinden sich identische Unterausdrücke 'm_listRect.contains (event-&gt; pos ())'.  Betreiber.  aidebuggerview.cpp 463 </li><li>  V501 Links und rechts vom Operator '&amp;&amp;' befinden sich identische Unterausdrücke: pObj-&gt; GetParent () &amp;&amp; pObj-&gt; GetParent () designerpanel.cpp 253 </li></ul></div></div><br><h2>  Über die Kameraposition in Spielen </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/564/587/079/5645870792e812044ad7bd3df6fdd2f0.png"></div><br><br>  Es gibt die zweitschnellste Diagnose in PVS-Studio - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V502</a> .  Diese Diagnose ist älter als einige neue Programmiersprachen, in denen ein solcher Fehler nicht mehr gemacht werden kann.  Und für C ++ ist dieser Fehler möglicherweise immer relevant. <br><br>  Beginnen wir mit einem kleinen einfachen Beispiel. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V502</a> Vielleicht arbeitet der Operator '?:' Anders als erwartet.  Der Operator '?:' Hat eine niedrigere Priorität als der Operator '+'.  zipencryptor.cpp 217 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> ZipEncryptor::ParseKey(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span>) ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>; RCLogError(<span class="hljs-string"><span class="hljs-string">"...."</span></span>, pos); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br>  Die Additionsoperation hat eine höhere Priorität als der ternäre Operator.  Daher hat dieser Ausdruck eine völlig andere Berechnungslogik als der Autor angenommen hat. <br><br>  Sie können den Fehler folgendermaßen beheben: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> pos = i * <span class="hljs-number"><span class="hljs-number">2</span></span> + (v1 == <span class="hljs-number"><span class="hljs-number">0xff</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V502</a> Vielleicht arbeitet der Operator '?:' Anders als erwartet.  Der Operator '?:' Hat eine niedrigere Priorität als der Operator '-'.  3dengine.cpp 1898 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> C3DEngine::GetDistanceToSectorWithWater() { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (bCameraInTerrainBounds &amp;&amp; (m_pTerrain &amp;&amp; m_pTerrain-&gt;GetDistanceToSectorWithWater() &gt; <span class="hljs-number"><span class="hljs-number">0.1f</span></span>)) ? m_pTerrain-&gt;GetDistanceToSectorWithWater() : max(camPostion.z - OceanToggle::IsActive() ? OceanRequest::GetOceanLevel() : GetWaterLevel(), <span class="hljs-number"><span class="hljs-number">0.1f</span></span>); }</code> </pre> <br>  Und hier ist ein Beispielcode, in dem sie mit der Kameraposition arbeiten.  Ein Beispiel ist mit den Augen schwer wahrzunehmen und es liegt ein Fehler vor.  Zur Veröffentlichung wurde die Formatierung des Codes geändert, aber in der Quelldatei ist dieser Code noch unlesbarer. <br><br>  In diesem Teilstring liegt ein Fehler vor: <br><br><pre> <code class="cpp hljs">camPostion.z - OceanToggle::IsActive() ? .... : ....</code> </pre> <br>  Wenn sich die Kamera in Ihrem Spiel plötzlich unangemessen verhält, sollten Sie wissen, dass die Entwickler bei der statischen Code-Analyse Folgendes gespeichert haben: D. <br><br>  Andere Beispiele mit ähnlichen Warnungen: <br><br><ul><li>  V502 Vielleicht arbeitet der Operator '?:' Anders als erwartet.  Der Operator '?:' Hat eine niedrigere Priorität als der Operator '-'.  scriptbind_ai.cpp 5203 </li><li>  V502 Vielleicht arbeitet der Operator '?:' Anders als erwartet.  Der Operator '?:' Hat eine niedrigere Priorität als der Operator '+'.  qcolumnwidget.cpp 136 </li><li>  V502 Vielleicht arbeitet der Operator '?:' Anders als erwartet.  Der Operator '?:' Hat eine niedrigere Priorität als der Operator '&amp;&amp;'.  Shapetool.h 98 </li></ul><br><h2>  CryEngine Legacy </h2><br>  Amazon Lumberyard basiert auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CryEngine-</a> Code.  Und nicht auf seiner besten Version.  Ich habe eine solche Schlussfolgerung gezogen, indem ich mir den Analysatorbericht angesehen habe.  Einige gefundene Fehler wurden bereits in der neuesten Version von CryEngine für meine beiden Codeüberprüfungen behoben, sind jedoch im Lumberyard-Code noch vorhanden.  Außerdem wurde der Analysator im vergangenen Jahr erheblich verbessert, und es konnten zusätzliche Fehler gefunden werden, die jetzt in zwei Spiel-Engines vorhanden sind.  Aber mit Lumberyard ist die Situation schlimmer.  Amazon hat im Wesentlichen alle technischen Schulden von CryEngine geerbt.  Aber seine eigene technische Pflicht erscheint natürlich in jeder Firma für sich :). <br><br>  In diesem Abschnitt werde ich Ihnen einige Fehler nennen, die in der neuesten Version von CryEngine behoben wurden und jetzt nur noch ein Problem des Lumberyard-Projekts sind. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V519</a> Der Variablen 'BlendFactor [2]' werden zweimal hintereinander Werte zugewiesen.  Vielleicht ist das ein Fehler.  Überprüfen Sie die Zeilen: 1283, 1284. ccrydxgldevicecontext.cpp 1284 <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/659/fb5/4bb/659fb54bb651df9abf4568dec3b76bf4.png"></div><br><br>  Ungefähr solche Emotionen werden von Lumberyard-Entwicklern erfahren, wenn sie herausfinden, dass dieser Fehler nur bei ihnen geblieben ist. <br><br>  Übrigens gibt es noch zwei: <br><br><ul><li>  V519 Der Variablen 'm_auBlendFactor [2]' werden zweimal hintereinander Werte zugewiesen.  Vielleicht ist das ein Fehler.  Überprüfen Sie die Zeilen: 919, 920. ccrydxgldevicecontext.cpp 920 </li><li>  V519 Der Variablen 'm_auBlendFactor [2]' werden zweimal hintereinander Werte zugewiesen.  Vielleicht ist das ein Fehler.  Überprüfen Sie die Zeilen: 926, 927. ccrydxgldevicecontext.cpp 927 </li></ul><br>  Es liegt ein solcher Fehler vor: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V546 Das</a> Mitglied einer Klasse wird von selbst initialisiert: 'eConfigMax (eConfigMax.VeryHigh)'.  Partikelparameterh 1837 <br><br><pre> <code class="cpp hljs">ParticleParams() : .... fSphericalApproximation(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), fVolumeThickness(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>), fSoundFXParam(<span class="hljs-number"><span class="hljs-number">1.f</span></span>), eConfigMax(eConfigMax.VeryHigh), <span class="hljs-comment"><span class="hljs-comment">// &lt;= fFadeAtViewCosAngle(0.f) {}</span></span></code> </pre> <br>  In CryEngine wurde diese Klasse im Allgemeinen neu geschrieben, aber hier blieb der Initialisierungsfehler bestehen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V521</a> Solche Ausdrücke mit dem Operator ',' sind gefährlich.  Stellen Sie sicher, dass der Ausdruck '! SWords [iWord] .empty (), iWord ++' korrekt ist.  takticalpointsystem.cpp 3376 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CTacticalPointSystem::Parse(....) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sInput</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sSpec)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MAXWORDS = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> sWords[MAXWORDS]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iC = <span class="hljs-number"><span class="hljs-number">0</span></span>, iWord = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; iWord &lt; MAXWORDS; !sWords[iWord].empty(), iWord++) { sWords[iWord] = sInput.Tokenize(<span class="hljs-string"><span class="hljs-string">"_"</span></span>, iC); } .... }</code> </pre> <br>  Der verdächtige Zyklus, den CryEngine bereits neu geschrieben hat. <br><br><h2>  Fehler leben länger als Sie denken </h2><br>  Für Benutzer, die PVS-Studio zum ersten Mal verwenden, ist die Situation ungefähr dieselbe: Sie finden einen Fehler, stellen fest, dass er vor einigen Monaten hinzugefügt wurde, und freuen sich zu erkennen, dass sie die Manifestation des Problems auf wundersame Weise bei ihren Benutzern vermieden haben.  Viele unserer Kunden haben PVS-Studio genau nach solchen Geschichten regelmäßig genutzt. <br><br>  Manchmal muss ein Unternehmen solche Situationen mehrmals besuchen, um Prozesse zur Kontrolle der Codequalität zu starten.  Hier ist ein Beispiel für CryEngine und Lumberyard: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V557</a> CWE-119 Array-Überlauf ist möglich.  Der 'id'-Index zeigt über die Array-Grenze hinaus.  gameobjectsystem.cpp 113 <br><br><pre> <code class="cpp hljs">uint32 CGameObjectSystem::GetExtensionSerializationPriority(....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (id &gt; m_extensionInfo.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xffffffff</span></span>; <span class="hljs-comment"><span class="hljs-comment">// minimum possible priority } else { return m_extensionInfo[id].serializationPriority; } }</span></span></code> </pre> <br>  Wie Sie wissen, basiert Amazon Lumberyard nicht auf der neuesten Version von CryEngine.  Trotzdem konnte mit Hilfe des PVS-Studio-Analysators ein Fehler gefunden werden, der jetzt in zwei Game-Engines vorhanden ist.  Der Index musste mit dem Operator '&gt; =' überprüft werden ... <br><br>  Der Indizierungsfehler ist schwerwiegend.  Darüber hinaus gibt es <b>sechs</b> solcher Orte <b>!</b>  Hier ist ein weiteres Beispiel: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V557</a> CWE-119 Array-Überlauf ist möglich.  Der 'Index'-Index zeigt über die Array-Grenze hinaus.  Fahrzeugsitzgruppe.cpp 73 <br><br><pre> <code class="cpp hljs">CVehicleSeat* CVehicleSeatGroup::GetSeatByIndex(<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> index) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; index &lt;= m_seats.size()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_seats[index]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; }</code> </pre> <br>  Jemand hat die Fehler des gleichen Typs gemacht und sie wurden nicht behoben, nur weil sie nicht einmal in den CryEngine-Bug-Reviews enthalten waren. <br><br>  Verbleibende Warnungen: <br><br><ul><li>  V557 CWE-119 Array-Überlauf ist möglich.  Der 'id'-Index zeigt über die Array-Grenze hinaus.  gameobjectsystem.cpp 195 </li><li>  V557 CWE-119 Array-Überlauf ist möglich.  Der 'id'-Index zeigt über die Array-Grenze hinaus.  gameobjectsystem.cpp 290 </li><li>  V557 CWE-119 Array-Überlauf ist möglich.  Der 'stateId'-Index zeigt über die Array-Grenze hinaus.  vehicleanimation.cpp 311 </li><li>  V557 CWE-119 Array-Überlauf ist möglich.  Der 'stateId'-Index zeigt über die Array-Grenze hinaus.  vehicleanimation.cpp 354 </li></ul><br>  Das lange Vorhandensein von Fehlern im Code kann nur durch die entsprechende Ebene der Projekttests erklärt werden.  Es wird angenommen, dass die statische Analyse Fehler nur in nicht verwendetem Code findet.  Das ist also nicht so.  Entwickler vergessen, dass die meisten Benutzer stillschweigend unter nicht offensichtlichen Fehlern in Programmen leiden, und die Manifestation dieser sehr seltenen Fehler wirkt sich häufig nachteilig auf die Arbeit des gesamten Unternehmens, den Ruf und gegebenenfalls seine Verkäufe aus. <br><br><h2>  Verschiedene Schattierungen der Copy-Paste-Programmierung </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b7b/18c/0d2/b7b18c0d2641836736a2bde2d19ba5ba.png"></div><br><br>  Als Sie diesen Abschnitt des Artikels erreichten, haben Sie wahrscheinlich bemerkt, dass das Kopieren und Einfügen die Ursache vieler Probleme ist.  In PVS-Studio wird die Suche nach solchen Fehlern in verschiedenen Diagnosen implementiert.  In diesem Abschnitt finden Sie Beispiele für das Kopieren und Einfügen des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V561</a> . <br><br>  Hier ist ein Beispiel für verdächtigen Code beim Deklarieren gleichnamiger Variablen in überlappenden Bereichen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V561</a> CWE-563 Es ist wahrscheinlich besser, der Variablen 'pLibrary' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: entityobject.cpp, Zeile 4703. entityobject.cpp 4706 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CEntityObject::OnMenuConvertToPrefab() { .... IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { IDataBaseLibrary* pLibrary = GetIEditor()-&gt;Get....; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pLibrary == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { QString sError = tr(....); CryMessageBox(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } .... }</code> </pre> <br>  Der pLibrary-Zeiger überschreibt nicht wie erwartet.  Die Initialisierung dieses Zeigers wurde unter der Bedingung zusammen mit der Typdeklaration vollständig kopiert. <br><br>  Ich werde alle ähnlichen Orte auflisten: <br><br><ul><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'eType' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Erklärung: toglsloperand.c, Zeile 838. toglsloperand.c 1224 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'eType' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Erklärung: toglsloperand.c, Zeile 838. toglsloperand.c 1305 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'rSkelPose' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: Anhangmanager.cpp, Zeile 409. Anhangmanager.cpp 458 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'nThreadID' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: d3dmeshbaker.cpp, Zeile 797. d3dmeshbaker.cpp 867 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'directoryNameList' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: Assetimportermanager.cpp, Zeile 720. Assetimportermanager.cpp 728 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'pNode' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: breakpointsctrl.cpp, Zeile 340. breakpointsctrl.cpp 349 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'pLibrary' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: prefabobject.cpp, Zeile 1443. prefabobject.cpp 1446 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'pLibrary' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: prefabobject.cpp, Zeile 1470. prefabobject.cpp 1473 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'cmdLine' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: fileutil.cpp, Zeile 110. fileutil.cpp 130 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'sfunctionArgs' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Erklärung: attributeitemlogiccallbacks.cpp, Zeile 291. attributeitemlogiccallbacks.cpp 303 </li><li>  V561 CWE-563 Es ist wahrscheinlich besser, der Variablen 'edgeName' einen Wert zuzuweisen, als ihn erneut zu deklarieren.  Vorherige Deklaration: qgradientselectorwidget.cpp, Zeile 475. qgradientselectorwidget.cpp 488 </li></ul><br>  Eine lange Liste ... einige der aufgelisteten Orte sind sogar vollständige Kopien des beschriebenen Beispiels. <br><br><h2>  Eigenwertinitialisierung </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/54a/3e3/bff/54a3e3bff4ffeeeb75087c52d644eaa6.png"></div><br><br>  Im Code der Spiel-Engine wurden viele Stellen gefunden, an denen die Variable sich selbst zugewiesen ist.  Irgendwo wurde dieser Code zum Debuggen gelassen, irgendwo ist der Code einfach wunderschön gestaltet (er ist auch oft eine Fehlerquelle), also werde ich Ihnen einen Code geben, der für mich am verdächtigsten ist. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V570</a> Die Variable 'behaviourParams.ignoreOnVehicleDestroyed' wird sich selbst zugewiesen.  Fahrzeugkomponente.cpp 168 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> CVehicleComponent::Init(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!damageBehaviorTable.getAttr(....) { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { behaviorParams.ignoreOnVehicleDestroyed = <span class="hljs-comment"><span class="hljs-comment">// &lt;= behaviorParams.ignoreOnVehicleDestroyed; // &lt;= } .... }</span></span></code> </pre> <br>  In der aktuellen Ansicht wird der Zweig <i>else überhaupt</i> nicht benötigt.  Aber vielleicht enthält dieser Code einen Fehler: Sie wollten der Variablen den entgegengesetzten Wert zuweisen: <br><br><pre> <code class="cpp hljs">bValue = !bValue</code> </pre> <br>  Für Entwickler ist es jedoch besser, sich mit den Ergebnissen dieser Diagnose vertraut zu machen. <br><br><h2>  Problembehandlung </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cef/4fe/a30/cef4fea30182004f3debd9467c1e8d16.png"></div><br><br>  In diesem Abschnitt finden Sie viele Beispiele, wenn bei der Fehlerbehandlung ein Fehler aufgetreten ist. <br><br>  <b>Beispiel 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V606</a> Besitzerloses Token 'nullptr'.  dx12rootsignature.cpp 599 <br><br><pre> <code class="cpp hljs">RootSignature* RootSignatureCache::AcquireRootSignature(....) { .... RootSignature* result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RootSignature(m_pDevice); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result-&gt;Init(params)) { DX12_ERROR(<span class="hljs-string"><span class="hljs-string">"Could not create root signature!"</span></span>); <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } m_RootSignatureMap[hash] = result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre> <br>  <i>Vergessen</i> zu schreiben <i>return nullptr;</i>  .  Jetzt wird der ungültige Wert der <i>Ergebnisvariablen an</i> anderer Stelle im Code verwendet. <br><br>  Der exakt gleiche Code wurde an eine weitere Stelle kopiert: <br><br><ul><li>  V606 Besitzerloses Token 'nullptr'.  dx12rootsignature.cpp 621 </li></ul><br>  <b>Beispiel 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V606</a> Besitzerloses Token 'falsch'.  fillspacetool.cpp 191 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> FillSpaceTool::FillHoleBasedOnSelectedElements() { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.size() == <span class="hljs-number"><span class="hljs-number">2</span></span>) { .... } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, iVertexSize(....); i &lt; iVertexSize; ++i) { validEdgeList.push_back(....); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validEdgeList.empty()) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { false; // &lt;= fail } std::vector&lt;BrushEdge3D&gt; linkedEdgeList; std::set&lt;int&gt; usedEdgeSet; linkedEdgeList.push_back(validEdgeList[0]); // &lt;= fail .... }</span></span></code> </pre> <br>  Ein sehr interessantes Beispiel für einen Fehler mit einer fehlenden <i>return-Anweisung</i> .  Jetzt ist eine Situation des Zugriffs auf einen leeren Container auf den Index möglich. <br><br>  <b>Beispiel 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V564</a> CWE-480 Der Operator '&amp;' wird auf den Wert des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bool</a> -Typs angewendet.  Sie haben wahrscheinlich vergessen, Klammern einzufügen, oder wollten den Operator '&amp;&amp;' verwenden.  toglslinstruction.c 2914 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetDataTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">// Check assumption that both the values which MOVC might pick // have the same basic data type. if(!psContext-&gt;flags &amp; HLSLCC_FLAG_AVOID_TEMP_REGISTER_ALIASING) { ASSERT(GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[2]) == GetOperandDataType(psContext, &amp;psInst-&gt;asOperands[3])); } .... }</span></span></code> </pre> <br>  Falsch auf das Vorhandensein von Bits im Flag überprüft.  Der Negationsoperator gilt für den Flag-Wert, nicht für den gesamten Ausdruck.  Schreiben Sie richtig so: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!(psContext-&gt;flags &amp; ....))</code> </pre> <br>  Weitere ähnliche Warnungen: <br><br><ul><li>  V564 CWE-480 Das '|'  Der Operator wird auf den Wert des Bool-Typs angewendet.  Sie haben wahrscheinlich vergessen, Klammern einzufügen, oder wollten das '||'  Betreiber.  d3dhwshader.cpp 1832 </li><li>  V564 CWE-480 Der Operator '&amp;' wird auf den Wert des Bool-Typs angewendet.  Sie haben wahrscheinlich vergessen, Klammern einzufügen, oder wollten den Operator '&amp;&amp;' verwenden.  trackviewdialog.cpp 2112 </li><li>  V564 CWE-480 Das '|'  Der Operator wird auf den Wert des Bool-Typs angewendet.  Sie haben wahrscheinlich vergessen, Klammern einzufügen, oder wollten das '||'  Betreiber.  imagecompiler.cpp 1039 </li></ul><br>  <b>Beispiel 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V596</a> CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1491 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; PyGetPrefabLibrarys() { CPrefabManager* pPrefabManager = GetIEditor()-&gt;GetPrefabMa....; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!pPrefabManager) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>); } .... }</code> </pre> <br>  Fehler beim Auslösen einer Ausnahme.  Es war notwendig, so zu schreiben: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::runtime_error(<span class="hljs-string"><span class="hljs-string">"Invalid Prefab Manager."</span></span>);</code> </pre> <br>  Die ganze Liste solcher Fehler: <br><br><ul><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1515 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1521 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1543 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1549 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1603 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1619 </li><li>  V596 CWE-390 Das Objekt wurde erstellt, wird jedoch nicht verwendet.  Das Schlüsselwort 'throw' könnte fehlen: throw runtime_error (FOO);  prefabobject.cpp 1644 </li></ul><br><br><h2>  Ein paar Probleme beim Arbeiten mit dem Speicher </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/521/55f/307/52155f307f3824842c324aa99902796e.png"></div><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V549</a> CWE-688 Das erste Argument der Funktion 'memcmp' entspricht dem zweiten Argument.  meshutils.h 894 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VertexLess</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.m_links[a].links.size() != m.m_links[b].links.size()) { res = (m.m_links[a].links.size() &lt; m.m_links[b].links.size()) ? <span class="hljs-number"><span class="hljs-number">-1</span></span> : +<span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { res = <span class="hljs-built_in"><span class="hljs-built_in">memcmp</span></span>(&amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], &amp;m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(m.m_links[a].links[<span class="hljs-number"><span class="hljs-number">0</span></span>]) * m.m_links[a].links.size()); } .... } .... };</code> </pre> <br>  Die Bedingung vergleicht die Größen von zwei Vektoren.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn sie gleich sind, werden im </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Zweig die </font><font style="vertical-align: inherit;">Werte der ersten Elemente der Vektoren mit der Funktion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memcmp ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verglichen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Das erste und das zweite Argument für diese Funktion sind jedoch dieselben! </font><font style="vertical-align: inherit;">Der Zugriff auf Array-Elemente ist ziemlich umständlich. </font><font style="vertical-align: inherit;">Es gibt Indizes </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Höchstwahrscheinlich ist ein Tippfehler in ihnen. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V611</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-762 Der Speicher wurde mit dem Operator 'new T []' zugewiesen, aber mit dem Operator 'delete' freigegeben. </font><font style="vertical-align: inherit;">Überprüfen Sie diesen Code. </font><font style="vertical-align: inherit;">Es ist wahrscheinlich besser, 'delete [] data;' zu verwenden. </font><font style="vertical-align: inherit;">vectorn.h 102</font></font><br><br><pre> <code class="cpp hljs">~vectorn_tpl() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>[] data; } } vectorn_tpl&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> vectorn_tpl&lt;ftype&gt;&amp; src) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (src.len != len &amp;&amp; !(flags &amp; mtx_foreign_data)) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> data; <span class="hljs-comment"><span class="hljs-comment">// &lt;= data = new ftype[src.len]; } .... }</span></span></code> </pre> <br><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Datenzeigerspeicher </font><i><font style="vertical-align: inherit;">wird</font></i><font style="vertical-align: inherit;"> mit einer ungültigen Anweisung freigegeben. </font><font style="vertical-align: inherit;">Der Operator </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delete []</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> muss </font><i><font style="vertical-align: inherit;">überall</font></i><font style="vertical-align: inherit;"> verwendet </font><i><font style="vertical-align: inherit;">werden</font></i><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nicht erreichbarer Code </font></font></h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 Nicht erreichbarer Code erkannt. </font><font style="vertical-align: inherit;">Möglicherweise liegt ein Fehler vor. </font><font style="vertical-align: inherit;">fbxskinimporter.cpp 67</font></font><br><br><pre> <code class="cpp hljs">Events::ProcessingResult FbxSkinImporter::ImportSkin(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (BuildSceneMeshFromFbxMesh(....) { context.m_createdData.push_back(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(createdData)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Events::ProcessingResult::Success; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return Events::ProcessingResult::Failure; // &lt;= } context.m_createdData.push_back(); // &lt;= fail return Events::ProcessingResult::Success; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alle Zweige der bedingten Anweisung enden mit dem Verlassen der Funktion. </font><font style="vertical-align: inherit;">Einige Codes werden jedoch nicht ausgeführt. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V779</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-561 Nicht erreichbarer Code erkannt. </font><font style="vertical-align: inherit;">Möglicherweise liegt ein Fehler vor. </font><font style="vertical-align: inherit;">Dockablelibrarytreeview.cpp 153</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> DockableLibraryTreeView::Init(IDataBaseLibrary* lib) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView &amp;&amp; m_titleBar &amp;&amp; m_defaultView) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_treeView-&gt;topLevelItemCount() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { ShowTreeView(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ShowDefaultView(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } else { return false; // &lt;= } emit SignalFocused(this); // &lt;= fail }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist leicht, einen Fehler in diesem Code zu erkennen. </font><font style="vertical-align: inherit;">Wenn Sie den Code jedoch längere Zeit schreiben, sinkt die Aufmerksamkeit stark und solche Fehler fallen leicht in das Projekt. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V622</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CWE-478 Überprüfen Sie die Anweisung 'switch'. </font><font style="vertical-align: inherit;">Möglicherweise fehlt der erste 'case'-Operator. </font><font style="vertical-align: inherit;">datum.cpp 872</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">AZ_INLINE </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsDataGreaterEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type.GetType()) { AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::Number: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsDataGreaterEqual&lt;Data::NumberType&gt;(lhs, rhs); .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::AABB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::AABBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Data::eType::OBB: AZ_Error(<span class="hljs-string"><span class="hljs-string">"ScriptCanvas"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"...."</span></span>, Data::Traits&lt;Data::OBBType&gt;::GetName()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Switch</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code außerhalb der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">case / default-Anweisung enthält</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wird er niemals ausgeführt.</font></font><br><br><h2>  Fazit </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Artikel enthält </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">95</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Warnungen des Analysators, 25 davon mit Codebeispielen. Wie viel Material stammt aus dem gesamten Analysatorbericht? Ich habe schnell nur ein </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drittel der High-Level-Warnungen gescrollt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es gibt auch Medium und Low, eine Gruppe von Diagnosen für die Suche nach Optimierungen und andere ungenutzte Möglichkeiten des Analysators - dies sind Hunderte offensichtlicherer Fehler und Tausende unerforschter Warnungen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und dann muss sich der Leser die Frage stellen: "Ist es mit dieser Herangehensweise an das Projekt möglich, eine gute Spiel-Engine zu veröffentlichen?". Es gibt keine Codequalitätskontrolle. CryEngine-Code mit alten Fehlern wurde zugrunde gelegt, neue Fehler wurden hinzugefügt. CryEngine selbst wird erst nach der nächsten Überprüfung des Codes fertiggestellt. Amazon hat mit seinen Ressourcen jede Chance, in Richtung Codequalität zu arbeiten und die coolste Spiel-Engine herauszubringen! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sei nicht sehr verärgert. Unter den PVS-Studio-Kunden gibt es mehr als 30 andere Unternehmen, die an Spielen beteiligt sind. Sie können sie und ihre Produkte auf der Seite unserer Website " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clients</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " kennenlernen, indem Sie den Filter "Spieleentwicklung" auswählen. Wir verbessern also allmählich die Welt. Vielleicht können wir Amazon Lumberyard verbessern :).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein Kollege hat kürzlich einen Artikel zum Thema Qualität von Spielesoftware geschrieben. Ich schlage vor, dass Sie interessiert sind: " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Statische Analyse in der Videospielbranche: Top 10 Softwarefehler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ." </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Link zum Herunterladen des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PVS-Studio-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Analysators </font><font style="vertical-align: inherit;">, wie kann man darauf verzichten ;-)</font></font><br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie diesen Artikel einem englischsprachigen Publikum zugänglich machen möchten, verwenden Sie bitte den Link zur Übersetzung: Svyatoslav Razmyslov. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Amazon Lumberyard: Ein Schrei der Angst</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haben Sie den Artikel gelesen und eine Frage?</font></font></b> <div class="spoiler_text">          .      : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">      PVS-Studio,  2015</a> . ,   . </div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de416565/">https://habr.com/ru/post/de416565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de416551/index.html">Theorie des Glücks. Das Gesetz der Wassermelonenschale und die Normalität der Abnormalität</a></li>
<li><a href="../de416553/index.html">Wie ändern sich die Ansätze zur Entwicklung von Terminals für den Handel an der Börse: 4 Trends von 2018</a></li>
<li><a href="../de416555/index.html">Newsfeed: Warum machen wir das falsch?</a></li>
<li><a href="../de416557/index.html">GitLab 11.0: Auto DevOps und Lizenzverwaltung veröffentlicht</a></li>
<li><a href="../de416561/index.html">Der Drucker hat gelebt, der Drucker lebt, der Drucker lebt! Canon MG7140 Behandlung</a></li>
<li><a href="../de416569/index.html">Wie Prius, aber nur unter Linux: Denken Sie an ein Hybridbüro</a></li>
<li><a href="../de416573/index.html">Senden einer E-Mail von einer beliebigen Adresse</a></li>
<li><a href="../de416575/index.html">Analyse von Supraleitungsstörungen der Large Hadron Collider Magnete am CERN</a></li>
<li><a href="../de416577/index.html">Digest MBLT DEV - frisch für iOS-Entwickler</a></li>
<li><a href="../de416579/index.html">Wir steuern LEDs mithilfe der Web-Bluetooth-API und von Arduino</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>