<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòã üêì ü§öüèø Um olhar s√≥brio para o Helm 2: "Isso √© o que √© ..." üë®üèª‚Äç‚öñÔ∏è üö¶ üëåüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como qualquer outra solu√ß√£o, Helm - o gerenciador de pacotes do Kubernetes - possui pr√≥s, contras e escopo. Portanto, ao us√°-lo, voc√™ deve avaliar cor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Um olhar s√≥brio para o Helm 2: "Isso √© o que √© ..."</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/438814/">  Como qualquer outra solu√ß√£o, Helm - o gerenciador de pacotes do Kubernetes - possui pr√≥s, contras e escopo. Portanto, ao us√°-lo, voc√™ deve avaliar corretamente suas expectativas ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ix/5j/fm/ix5jfmapr_v4yignapctr-x7_jc.jpeg"></div><br>  Usamos Helm em nosso arsenal de ferramentas de rolamento cont√≠nuo.  No momento da reda√ß√£o deste artigo, existem <b>mais de mil aplicativos</b> em nossos clusters e cerca de 4000 instala√ß√µes desses aplicativos em v√°rias varia√ß√µes.  Periodicamente, encontramos problemas, mas, em geral, estamos satisfeitos com a solu√ß√£o, n√£o temos tempo de inatividade nem perda de dados. <br><br>  O principal motivo para escrever este artigo √© fornecer ao usu√°rio uma <b>avalia√ß√£o objetiva dos</b> principais problemas do Leme 2 sem conclus√µes definitivas, bem como o desejo de compartilhar experi√™ncias e nossas solu√ß√µes. <a name="habracut"></a><br><br><h2>  [ERRO] Ap√≥s o lan√ßamento, o estado dos recursos de libera√ß√£o no cluster n√£o corresponde ao gr√°fico Helm descrito </h2><br>  Ao trabalhar, o Helm n√£o leva em considera√ß√£o o estado dos recursos de libera√ß√£o no cluster.  Ao reinstalar, o resultado √© determinado apenas pelas configura√ß√µes atuais e salvas.  Portanto, o estado do recurso no cluster e no registro Helm √© diferente e o Helm n√£o leva isso em considera√ß√£o. <br><br>  Considere como esse problema se manifesta: <br><br><ol><li>  O modelo de recurso no gr√°fico corresponde ao estado X. </li><li>  O usu√°rio instala o gr√°fico (o Tiller salva o estado do recurso X). </li><li>  Em seguida, o usu√°rio altera manualmente o recurso no cluster (o estado muda de X para Y). </li><li>  Sem fazer nenhuma altera√ß√£o, ele executa a <code>helm upgrade</code> ... E o recurso ainda est√° no estado Y, embora o usu√°rio espere X. </li></ol><br>  E isso n√£o √© tudo.  Em algum momento, o usu√°rio altera o modelo de recurso no gr√°fico (novo estado W) - ent√£o temos dois cen√°rios ap√≥s a <code>helm upgrade</code> : <br><br><ul><li>  A aplica√ß√£o do patch XW est√° caindo. </li><li>  Depois de aplicar o patch, o recurso entra no estado Z, que n√£o corresponde ao desejado. </li></ul><br>  Para evitar esse problema, prop√µe-se organizar o trabalho com libera√ß√µes da seguinte maneira: <b>ningu√©m deve alterar os recursos manualmente</b> , o Helm √© a √∫nica ferramenta para trabalhar com os recursos da libera√ß√£o.  Idealmente, as altera√ß√µes de gr√°fico s√£o versionadas no reposit√≥rio Git e aplicadas <b>exclusivamente</b> dentro do CD. <br><br>  Se essa op√ß√£o n√£o for adequada, voc√™ poder√° <b>monitorar a sincroniza√ß√£o dos estados do recurso de</b> libera√ß√£o.  A sincroniza√ß√£o manual pode ser assim: <br><br><ol><li>  N√≥s descobrimos o status dos recursos de libera√ß√£o atrav√©s do <code>helm get</code> . </li><li>  Descubra o status dos recursos no Kubernetes via <code>kubectl get</code> . </li><li>  Se os recursos forem diferentes, sincronizamos o Helm com o Kubernetes: <br><ol><li>  Crie uma ramifica√ß√£o separada. </li><li>  Atualizando manifestos do gr√°fico.  Os modelos devem corresponder aos estados de recurso no Kubernetes. </li><li>  Realizamos a implanta√ß√£o.  Sincronizamos o estado no registro e cluster do Helm. </li><li>  Depois disso, a ramifica√ß√£o pode ser exclu√≠da e continuar o trabalho regular. </li></ol></li></ol><br>  Ao aplicar patches usando o <code>kubectl apply</code> , a chamada <b>mesclagem de 3 vias</b> √© executada, ou seja,  o estado real do recurso atualizado √© levado em considera√ß√£o.  Voc√™ pode ver o c√≥digo do algoritmo <a href="">aqui</a> e ler sobre ele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  No momento da reda√ß√£o deste artigo, os desenvolvedores do Helm est√£o procurando maneiras de implementar a combina√ß√£o de tr√™s vias no Helm 3. Com o Helm 2, as coisas n√£o s√£o t√£o boas: a fus√£o de 3 vias n√£o est√° planejada para ser implementada, mas existe um PR para corrigir a maneira como os recursos s√£o criados - voc√™ pode descobrir detalhes ou at√© participar como parte da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">quest√£o relevante</a> . <br><br><h2>  [BUG] Erro: nenhum RECURSO com o nome NAME encontrado </h2><br>  O problema se manifesta se <b>novos recursos</b> forem criados com √™xito quando a distribui√ß√£o for repetida e a distribui√ß√£o em si falhar.  <b>Novos recursos</b> significam aqueles que n√£o estavam na √∫ltima instala√ß√£o do gr√°fico. <br><br>  Se a distribui√ß√£o falhar, a vers√£o ser√° salva no registro marcado como <b>FAILED</b> e, durante a instala√ß√£o, o Helm depender√° do estado da √∫ltima vers√£o <b>DEPLOYED</b> , que nesse caso n√£o sabe nada sobre novos recursos.  Como resultado, o Helm tenta recriar esses recursos e falha com o erro "nenhum RECURSO com o nome NAME encontrado" (o erro diz o contr√°rio, mas esse √© o problema).  Parte do problema √© que o Helm n√£o leva em considera√ß√£o o estado dos recursos de libera√ß√£o no cluster ao criar o patch, conforme descrito na se√ß√£o anterior. <br><br>  Por enquanto, a √∫nica solu√ß√£o √© remover manualmente novos recursos. <br><br>  Para evitar esse estado, √© poss√≠vel excluir automaticamente novos recursos criados na atualiza√ß√£o / revers√£o atual se o comando finalmente falhar.  Ap√≥s uma longa discuss√£o com os desenvolvedores no Helm, para os comandos de atualiza√ß√£o / revers√£o, foi adicionada a op√ß√£o <code>--cleanup-on-fail</code> , que ativa a limpeza autom√°tica quando a distribui√ß√£o falha.  Nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PR</a> est√° em discuss√£o, buscando a melhor solu√ß√£o. <br><br>  A partir da vers√£o 2.13 do Helm, a op√ß√£o <code>--atomic</code> aparece nos <code>helm install/upgrade</code> do <code>helm install/upgrade</code> , que ativam a limpeza e a revers√£o durante uma instala√ß√£o com falha (para obter mais detalhes, consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PR</a> ). <br><br><h2>  [BUG] Erro: rel√≥gio fechado antes at√© o tempo limite </h2><br>  O problema pode ocorrer quando o gancho Helm √© executado por muito tempo (por exemplo, durante migra√ß√µes) - mesmo que os tempos limite especificados para <code>helm install/upgrade</code> do <code>helm install/upgrade</code> e <code>spec.activeDeadlineSeconds</code> tarefa correspondente n√£o sejam excedidos. <br><br>  Este erro √© gerado pelo servidor da API Kubernetes enquanto aguarda a conclus√£o da tarefa de gancho.  O Helm n√£o lida com esse erro e trava imediatamente - em vez de tentar novamente a solicita√ß√£o de espera. <br><br>  Como solu√ß√£o, voc√™ pode aumentar o tempo limite no servidor api: <code>--min-request-timeout=xxx</code> no arquivo <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> . <br><br><h2>  [BUG] Erro: UPGRADE FAILED: "foo" n√£o possui lan√ßamentos implantados </h2><br>  Se a primeira vers√£o atrav√©s da <code>helm install</code> falhar, a <code>helm upgrade</code> subsequente do <code>helm upgrade</code> retornar√° um erro semelhante. <br><br>  Parece que a solu√ß√£o √© bastante simples: voc√™ precisa executar manualmente a <code>helm delete --purge</code> ap√≥s uma falha na primeira instala√ß√£o, mas esta a√ß√£o manual interrompe a automa√ß√£o do CI / CD.  Para n√£o interromper a execu√ß√£o dos comandos manuais, voc√™ pode usar os recursos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">werf</a> para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">implantar</a> .  Ao usar o werf, a vers√£o problem√°tica ser√° recriada automaticamente ap√≥s a reinstala√ß√£o. <br><br>  Al√©m disso, come√ßando com o Helm 2.13, nos <code>helm install</code> e <code>helm upgrade --install</code> basta especificar a op√ß√£o <code>--atomic</code> e, ap√≥s uma falha na instala√ß√£o, a libera√ß√£o ser√° exclu√≠da automaticamente (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PR para</a> obter detalhes). <br><br><h2>  Autorollback </h2><br>  O Helm n√£o possui a op√ß√£o <code>--autorollback</code> , que, quando <code>--autorollback</code> , lembrar√° a revis√£o bem-sucedida atual (ser√° descartada se a √∫ltima revis√£o n√£o for bem-sucedida) e, ap√≥s uma tentativa malsucedida de implanta√ß√£o, reverter√° para a revis√£o salva. <br><br>  Como √© fundamental que o produto funcione sem interrup√ß√µes, √© necess√°rio procurar solu√ß√µes, a implanta√ß√£o deve ser previs√≠vel.  Para minimizar a probabilidade de tempo de inatividade do produto, muitas vezes √© usada uma <b>abordagem com v√°rios circuitos</b> (por exemplo, prepara√ß√£o, qa e produ√ß√£o), que consiste na implanta√ß√£o sequencial nos circuitos.  Com essa abordagem, a maioria dos problemas √© corrigida antes de ser lan√ßada no produtivo e, em conjunto com o autorolback, permite obter bons resultados. <br><br>  Para organizar o autorollback, voc√™ pode usar o plug <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">-</a> in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">helm-monitor</a> , que permite vincular o rollback √†s m√©tricas do Prometheus.  Um bom artigo que descreve essa abordagem est√° dispon√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Para alguns de nossos projetos, uma abordagem bastante simples √© usada: <br><br><ol><li>  Antes da implanta√ß√£o, lembramos da revis√£o atual (acreditamos que, em uma situa√ß√£o normal, se a libera√ß√£o existir, ela estar√° necessariamente no estado DEPLOYED): <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _RELEASE_NAME=myrelease <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _LAST_DEPLOYED_RELEASE=$(helm list -adr | \ grep <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> | grep DEPLOYED | head -n2 | awk <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span>)</code> </pre> </li><li>  Execute a instala√ß√£o ou atualiza√ß√£o: <br><br><pre> <code class="bash hljs">helm install/upgrade ... || <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _DEPLOY_FAILED=1</code> </pre> </li><li>  Verificamos o status da implanta√ß√£o e fazemos revers√£o para o estado salvo: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] &amp;&amp; [ <span class="hljs-string"><span class="hljs-string">"x</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"x"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> helm rollback <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> <span class="hljs-variable"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li><li>  Encerramos o pipeline com um erro se a implanta√ß√£o n√£o tiver √™xito: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> 1 ; <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li></ol><br>  Novamente, come√ßando com o Helm vers√£o 2.13, ao chamar o <code>helm upgrade</code> basta especificar a op√ß√£o <code>--atomic</code> e depois que uma revers√£o de instala√ß√£o com falha ser√° executada automaticamente (consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PR para</a> obter detalhes). <br><br><h2>  Aguardando a disponibilidade de recursos de libera√ß√£o e feedback no momento da implementa√ß√£o </h2><br>  Conforme planejado, o Helm deve monitorar a execu√ß√£o dos testes de disponibilidade e disponibilidade correspondentes ao usar a op√ß√£o <code>--wait</code> : <br><br><pre> <code class="bash hljs">--<span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>, will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> until all Pods, PVCs, Services, and minimum number of Pods of a Deployment are <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a ready state before marking the release as successful. It will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> as long as --timeout</code> </pre> <br>  Esta fun√ß√£o n√£o funciona corretamente agora: nem todos os recursos e nem todas as vers√µes da API s√£o suportadas.  E o processo de espera declarado em si n√£o satisfaz nossas necessidades. <br><br>  Como no <code>kubectl wait</code> , n√£o h√° feedback r√°pido e n√£o h√° como regular esse comportamento.  Se o lan√ßamento falhar, s√≥ o saberemos <b>ap√≥s um tempo limite</b> .  No caso de uma instala√ß√£o problem√°tica, √© necess√°rio concluir o processo de implanta√ß√£o o mais r√°pido poss√≠vel, inverter o pipeline de CI / CD, reverter a libera√ß√£o para a vers√£o de trabalho e prosseguir para a depura√ß√£o. <br><br>  Se a vers√£o problem√°tica for revertida e o Helm n√£o retornar nenhuma informa√ß√£o durante o processo de lan√ßamento, o que √© a depura√ß√£o ?!  No caso do <code>kubectl wait</code> voc√™ pode organizar um processo separado para exibir logs, o que exigir√° nomes de recursos de libera√ß√£o.  Como organizar uma solu√ß√£o simples e funcional n√£o est√° claro imediatamente.  Al√©m dos logs de pod, informa√ß√µes √∫teis podem estar contidas no processo de lan√ßamento, eventos de recursos ... <br><br>  Nosso utilit√°rio CI / CD <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">werf</a> pode implantar um gr√°fico Helm e monitorar a disponibilidade de recursos, al√©m de exibir informa√ß√µes relacionadas √† implanta√ß√£o.  Todos os dados s√£o combinados em um √∫nico fluxo e emitidos para o log. <br><br>  Essa l√≥gica √© feita em uma solu√ß√£o separada do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">kubedog</a> .  Usando o utilit√°rio, voc√™ pode assinar um recurso e receber eventos e logs, al√©m de aprender sobre lan√ßamentos com falha em tempo h√°bil.  I.e.  como solu√ß√£o, depois de chamar <code>helm install/upgrade</code> sem a op√ß√£o <code>--wait</code> , <code>--wait</code> pode chamar kubedog para cada recurso de release. <br><br>  Nosso objetivo era criar uma ferramenta que forne√ßa todas as informa√ß√µes necess√°rias para depura√ß√£o na sa√≠da do pipeline de CI / CD.  Leia mais sobre o utilit√°rio em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso artigo recente</a> . <br><br>  Talvez no Helm 3 algum dia uma solu√ß√£o semelhante apare√ßa, mas at√© agora nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">problema</a> est√° em estado suspenso. <br><br><h2>  Seguran√ßa ao usar o helm init por padr√£o </h2><br>  Por padr√£o, quando o <code>helm init</code> √© executado, o componente do servidor √© instalado no cluster com privil√©gios semelhantes ao superusu√°rio, o que pode levar a consequ√™ncias indesej√°veis ‚Äã‚Äãquando acessado por terceiros. <br><br>  Para garantir a seguran√ßa do cluster, √© necess√°rio limitar os recursos do Tiller, bem como cuidar da conex√£o - a seguran√ßa da rede pela qual a comunica√ß√£o entre os componentes do Helm ocorre. <br><br>  O primeiro pode ser alcan√ßado atrav√©s do uso do mecanismo RBAC Kubernetes padr√£o, que limitar√° as a√ß√µes do leme, e o segundo - definindo SSL.  Leia mais na documenta√ß√£o do Helm: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protegendo sua instala√ß√£o do Helm</a> . <br><br>  <i>Acredita-se que a presen√ßa do componente do servidor - Tiller - seja um <b>grave erro arquitet√¥nico</b> , literalmente um recurso externo com direitos de superusu√°rio no ecossistema Kubernetes.</i>  <i>Em parte, concordamos: a implementa√ß√£o √© imperfeita, mas <b>vamos dar uma olhada nisso do outro lado</b> .</i>  <i>Se voc√™ interromper o processo de implanta√ß√£o e matar o cliente Helm, o sistema n√£o permanecer√° em um estado indefinido, ou seja,</i>  <i>O Tiller trar√° o status da libera√ß√£o para v√°lido.</i>  <i>Tamb√©m √© necess√°rio entender que, apesar do Tiller ser abandonado no Helm 3, essas fun√ß√µes de alguma forma ser√£o executadas pelo controlador CRD.</i> <br><br><h2>  Marciano Go Templates </h2><br>  Os modelos de go t√™m um grande limite de entrada, mas a tecnologia n√£o tem limita√ß√µes nos recursos e problemas com o DRY.  Os princ√≠pios b√°sicos, sintaxe, fun√ß√µes e operadores s√£o discutidos em nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior</a> da s√©rie Helm. <br><br><h2>  Falta de segredos fora da caixa </h2><br>  √â conveniente armazenar e manter modelos de c√≥digo de aplicativo, infraestrutura e distribui√ß√£o quando eles est√£o localizados em um √∫nico local.  E segredos n√£o s√£o excep√ß√£o. <br><br>  O Helm n√£o suporta segredos prontos para uso, no entanto, o plug <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">-</a> in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">helm-secrets</a> est√° dispon√≠vel, que √© essencialmente uma camada entre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sops</a> , o gerenciador de segredos do Mozilla e o Helm. <br><br>  Ao trabalhar com segredos, usamos nossa pr√≥pria solu√ß√£o implementada no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">werf</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o sobre segredos</a> ).  Dos recursos: <br><br><ul><li>  Facilidade de implementa√ß√£o. </li><li>  Mantendo um segredo em um arquivo, n√£o apenas no YAML.  Conveniente ao armazenar certificados, chaves. </li><li>  Regenera√ß√£o de segredos com uma nova chave. </li><li>  Lan√ßamento sem uma chave secreta (ao usar o werf).  Pode ser √∫til para os casos em que o desenvolvedor n√£o possui essa chave secreta, mas √© necess√°rio iniciar uma implanta√ß√£o em um circuito local ou de teste. </li></ul><br><h2>  Conclus√£o </h2><br>  O leme 2 est√° posicionado como um produto est√°vel, mas ao mesmo tempo h√° muitos bugs que ficam no limbo (alguns deles duram v√°rios anos!).  Em vez de solu√ß√µes, ou pelo menos patches, todos os esfor√ßos s√£o dedicados ao desenvolvimento do Helm 3. <br><br>  Apesar de o MR e o problema poderem demorar por meses ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui est√° um exemplo</a> de como adicionamos uma <code>before-hook-creation policy</code> de ganchos por v√°rios meses), voc√™ ainda pode participar do desenvolvimento do projeto.  Toda quinta-feira, ocorre um com√≠cio de meia hora de desenvolvedores do Helm, onde voc√™ pode aprender sobre as prioridades e orienta√ß√µes atuais da equipe, fazer perguntas e for√ßar suas pr√≥prias pr√°ticas recomendadas.  Sobre mete e outros canais de comunica√ß√£o est√° escrito em detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  A op√ß√£o de usar ou n√£o o Helm depende de voc√™, √© claro.  Hoje n√≥s mesmos aderimos a uma posi√ß√£o que, apesar das defici√™ncias, o Helm √© uma solu√ß√£o aceit√°vel para a implanta√ß√£o e √© √∫til para toda a comunidade participar do seu desenvolvimento. <br><br><h2>  PS </h2><br>  Leia tamb√©m em nosso blog: <br><br><ul><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando pacotes para o Kubernetes com Helm: estrutura e modelagem de gr√°ficos</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Uma introdu√ß√£o pr√°tica ao gerenciador de pacotes do Kubernetes - Helm</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerenciador de Pacotes para Kubernetes - Elmo: Passado, Presente, Futuro</a> ‚Äù; </li><li>  ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pratique com dapp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Implantando imagens do Docker no Kubernetes com Helm</a> . " </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438814/">https://habr.com/ru/post/pt438814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438804/index.html">Esperando por todos no pr√≥ximo Meetup de CocoaHeads</a></li>
<li><a href="../pt438806/index.html">Problemas de tradu√ß√£o liter√°ria</a></li>
<li><a href="../pt438808/index.html">ModelMapper: ida e volta</a></li>
<li><a href="../pt438810/index.html">HTTP / 3: da raiz √† ponta</a></li>
<li><a href="../pt438812/index.html">Qualidade do c√≥digo front-end HH</a></li>
<li><a href="../pt438818/index.html">UDB. O que √© isso? Parte 5. Caminho de Dados. Pequenas coisas √∫teis</a></li>
<li><a href="../pt438820/index.html">Gerenciamento de conhecimento: quais documentos s√£o necess√°rios e o que corrigir neles</a></li>
<li><a href="../pt438824/index.html">Curso de Gerenciamento Remoto</a></li>
<li><a href="../pt438826/index.html">Aperte o ingl√™s para uma entrevista - metodologia e custos trabalhistas</a></li>
<li><a href="../pt438828/index.html">Lazarus - escrevendo um componente para anima√ß√£o de sprites</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>