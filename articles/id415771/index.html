<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍👩‍👦 🧒🏾 🦐 Go Compiler: Aturan Optimasi SSA Deskripsi Bahasa 🧞 🍄 👉</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kompilator gc menggunakan bahasa berorientasi objek khusus ( DSL ) mirip Lisp untuk menggambarkan aturan optimasi Tugas Tunggal Statis (SSA). 


 Saya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Go Compiler: Aturan Optimasi SSA Deskripsi Bahasa</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415771/"><p><img src="https://habrastorage.org/webt/0b/vq/ua/0bvquazri632jnibzwkywt7hfim.png"></p><br><p> Kompilator <code>gc</code> menggunakan bahasa berorientasi objek khusus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DSL</a> ) mirip Lisp untuk menggambarkan aturan optimasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tugas Tunggal Statis</a> (SSA). </p><br><p>  Saya mengusulkan untuk menganalisis elemen-elemen utama dari bahasa ini, fitur-fiturnya dan keterbatasannya. <br>  Sebagai latihan, mari kita tambahkan ke kompiler Go generasi instruksi yang sebelumnya tidak dihasilkan, mengoptimalkan ekspresi <code>a*b+c</code> . </p><br><p>  Ini adalah artikel pertama dalam seri tentang internal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">backend kompiler Go SSA</a> , oleh karena itu, selain meninjau deskripsi DSL dari aturan itu sendiri, kami akan mempertimbangkan komponen terkait untuk membuat basis yang diperlukan untuk sesi berikutnya. </p><a name="habracut"></a><br><h1 id="vvedenie">  Pendahuluan </h1><br><p>  Compiler frontend go berakhir pada saat menghasilkan tampilan SSA dari AST beranotasi.  Fungsi yang bertanggung jawab untuk konversi dapat ditemukan di <a href="">cmd / compile / internal / gc / ssa.go.</a>  Titik masuk ke backend SSA adalah fungsi <code>ssa.Compile</code> , didefinisikan dalam <a href="">cmd / compile / internal / ssa / compile.go</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Terminologi</b> <div class="spoiler_text"><table><thead><tr><th>  EN </th><th>  RU </th><th>  Nilai </th></tr></thead><tbody><tr><td>  Frontend kompiler </td><td>  Frontend kompiler </td><td>  Parsing dan analisis leksikal, kadang-kadang ketik resolusi, representasi menengah dekat dengan kode sumber, biasanya beberapa AST beranotasi. </td></tr><tr><td>  Backend kompiler </td><td>  Backend kompiler </td><td>  Optimalisasi tingkat rendah dan representasi perantara, pembuatan kode. </td></tr><tr><td>  Formulir </td><td>  Formulir </td><td>  Hampir merupakan sinonim untuk kata "ekspresi" (ekspresi).  Biasanya dalam Lisp, <code>form</code> adalah cara yang cukup umum untuk menamai elemen program, baik itu daftar atau atom. </td></tr><tr><td>  Pass pengoptimalan </td><td>  Fase optimasi </td><td>  Eksekusi algoritma tertentu pada suatu program.  Kata "pass" agak ambigu, karena satu fase dapat melakukan beberapa pass, dan / atau menggunakan kode yang sama dengan fase lainnya. </td></tr></tbody></table><br><p>  Jika, ketika Anda membaca artikel, Anda menemukan istilah yang benar-benar tidak dapat dipahami oleh Anda, perlu melaporkan hal ini, mungkin ditambahkan ke tabel ini. </p></div></div><br><p>  Pengoptimal SSA Go terdiri dari beberapa fase, yang masing-masing melewati fungsi yang dikompilasi.  Beberapa fase menggunakan apa yang disebut "aturan penulisan ulang", aturan untuk mengubah satu urutan SSA ke yang lain, berpotensi lebih optimal. </p><br><p>  Aturan transformasi dijelaskan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">S-expressions</a> .  Elemen dari ekspresi ini adalah <a href="">ssa.Value</a> .  Dalam kasus paling sederhana, aturan-aturan ini memungkinkan Anda untuk mengganti satu <code>ssa.Value</code> dengan yang lain. </p><br><p>  Sebagai contoh, kode di bawah ini mengalikan perkalian konstanta 8-bit: </p><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">Mul8</span></span> (<span class="hljs-name"><span class="hljs-name">Const8</span></span> [c]) (<span class="hljs-name"><span class="hljs-name">Const8</span></span> [d])) -&gt; (<span class="hljs-name"><span class="hljs-name">Const8</span></span> [int64(<span class="hljs-name"><span class="hljs-name">int8</span></span>(<span class="hljs-name"><span class="hljs-name">c*d</span></span>))])</code> </pre> <br><p>  Ada dua kategori utama nilai SSA: tingkat tinggi, hampir tidak tergantung pada mesin target, dan yang spesifik arsitektur (biasanya dipetakan ke instruksi mesin 1-in-1). </p><br><p>  Optimalisasi dijelaskan dalam dua kategori ini.  Pertama, tingkat tinggi dan umum untuk semua arsitektur, kemudian berorientasi platform. </p><br><p>  Semua kode yang terkait dengan aturan terletak pada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">cmd / compile / internal / ssa / gen</a> .  Kami akan mempertimbangkan dua set: </p><br><ol><li>  <a href="">genericOps.go</a> - operasi independen-mesin. </li><li>  <a href="">AMD64Ops.go</a> - operasi khusus untuk <code>GOARCH=AMD64</code> (64-bit x86). </li></ol><br><p>  Setelah beberapa fase pertama yang bekerja pada mesin abstrak, yang disebut penurunan dilakukan, yang menghasilkan transisi dari <code>genericOps</code> ke seperangkat arsitektur tertentu.  Dalam contoh kita, ini akan menjadi <code>AMD64Ops</code> .  Setelah titik ini, semua fase berikutnya beroperasi pada presentasi dari kategori kedua. </p><br><p>  Setelah optimizer, generator kode mulai berlaku.  Untuk AMD64, implementasi pembuatan kode dapat ditemukan dalam paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">cmd / compile / internal / amd64</a> .  Tugas pembuat kode adalah mengganti <code>ssa.Block</code> dan <code>ssa.Value</code> dengan urutan <a href="">obj.Prog</a> diteruskan ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">assembler</a> .  Assembler akan mengumpulkan kode mesin, yang akan siap untuk dieksekusi setelah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menautkan</a> . </p><br><h1 id="pravila-optimizaciy">  Aturan Optimasi </h1><br><p>  Jika file dengan definisi operasi diberi nama seperti " <code>${ARCH}Ops.go</code> ", maka aturan optimasi ditempatkan di " <code>${ARCH}.Rules</code> ". </p><br><p>  Aturan tingkat tinggi melakukan transformasi sederhana, sebagian besar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lipatan ekspresi konstan</a> , serta beberapa transformasi yang menyederhanakan proses selanjutnya. </p><br><p>  Setiap file dengan aturan level rendah terdiri dari dua bagian: </p><br><ol><li>  Menurunkan - mengganti operasi abstrak dengan setara mesin. </li><li>  Optimalisasi sendiri. </li></ol><br><p>  Contoh mengurangi operasi ke mesin: </p><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">Const32</span></span> [val]) -&gt; (<span class="hljs-name"><span class="hljs-name">MOVLconst</span></span> [val]) // L - long, <span class="hljs-number"><span class="hljs-number">32</span></span>- (<span class="hljs-name"><span class="hljs-name">Const64</span></span> [val]) -&gt; (<span class="hljs-name"><span class="hljs-name">MOVQconst</span></span> [val]) // Q - quad, <span class="hljs-number"><span class="hljs-number">64</span></span>- | | generic op | AMD64 op</code> </pre> <br><p>  Dalam optimalisasi tingkat rendah, sejumlah utama optimasi penting dilakukan, seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengurangi biaya operasi</a> , menanamkan sebagian dan memanfaatkan kemampuan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mode pengalamatan memori yang</a> tersedia di prosesor. </p><br><p>  Operasi memiliki nama mnemonik, yang biasanya disebut opcode.  Opcode dari operasi yang bergantung pada arsitektur biasanya mencerminkan nama instruksi yang sebenarnya. </p><br><h1 id="sintaksis-yazyka-opisaniya-pravil">  Aturan Deskripsi Sintaks Bahasa </h1><br><p>  Tata bahasa dasar dijelaskan dalam <a href="">rulegen.go</a> : </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// rule syntax: // sexpr [&amp;&amp; extra conditions] -&gt; [@block] sexpr // // sexpr are s-expressions (lisp-like parenthesized groupings) // sexpr ::= [variable:](opcode sexpr*) // | variable // | &lt;type&gt; // | [auxint] // | {aux} // // aux ::= variable | {code} // type ::= variable | {code} // variable ::= some token // opcode ::= one of the opcodes from the *Ops.go files</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Terjemahan Cuplikan Di Atas</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//  : // sexpr [&amp;&amp;  ] -&gt; [@block] sexpr // // sexpr -  S- (   ) // sexpr ::= [variable:](opcode sexpr*) // | variable // | &lt;type&gt; // | [auxint] // | {aux} // // aux ::= variable | {code} // type ::= variable | {code} // variable ::= Go  ( ) // opcode ::=   *Ops.go </span></span></code> </pre> <br></div></div><br><p>  Perlu disebutkan juga bahwa komentar " <code>//</code> " diperbolehkan di dalam file <code>.Rules</code> . </p><br><p>  Mari kita lihat contoh sederhana yang berisi semua elemen ini: </p><br><pre> <code class="lisp hljs"> Opcode=ADDLconst -    <span class="hljs-number"><span class="hljs-number">32</span></span>-  : AuxInt=c - ,    `x` : : (<span class="hljs-name"><span class="hljs-name">ADDLconst</span></span> [c] x) &amp;&amp; int32(<span class="hljs-name"><span class="hljs-name">c</span></span>)==0 -&gt; x | / | / | | / | / | | / | /    | /   ( `<span class="hljs-symbol"><span class="hljs-symbol">&amp;&amp;</span></span>`    ) ,    </code> </pre> <br><blockquote>  Semua tanda tangan penjelasan ini bukan bagian dari catatan aturan yang valid. </blockquote><p>  Aturan ini mengonversi <code>x+0</code> ke <code>x</code> .  Segala sesuatu di dalam bagian ketentuan adalah kode Go normal, <br>  kecuali terbatas pada ekspresi, yang hasilnya harus <code>bool</code> . <br>  Anda dapat memanggil predikat yang ditentukan dalam <a href="">rewrite.go</a> . </p><br><p>  Selain opcode biasa, kombinasi dapat digunakan yang menimbulkan beberapa aturan: </p><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">ADD</span></span>(<span class="hljs-name"><span class="hljs-name">Q</span></span><span class="hljs-name"><span class="hljs-name">|L)const [off] x:(SP)) -&gt; (LEA(Q|</span></span><span class="hljs-name"><span class="hljs-name">L</span></span>) [off] x) //  Q|L alternation: (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> [off] x:(<span class="hljs-name"><span class="hljs-name">SP</span></span>)) -&gt; (<span class="hljs-name"><span class="hljs-name">LEAQ</span></span> [off] x) (<span class="hljs-name"><span class="hljs-name">ADDLconst</span></span> [off] x:(<span class="hljs-name"><span class="hljs-name">SP</span></span>)) -&gt; (<span class="hljs-name"><span class="hljs-name">LEAL</span></span> [off] x) //    `x`: (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> [off] (<span class="hljs-name"><span class="hljs-name">SP</span></span>)) -&gt; (<span class="hljs-name"><span class="hljs-name">LEAQ</span></span> [off] (<span class="hljs-name"><span class="hljs-name">SP</span></span>)) (<span class="hljs-name"><span class="hljs-name">ADDLconst</span></span> [off] (<span class="hljs-name"><span class="hljs-name">SP</span></span>)) -&gt; (<span class="hljs-name"><span class="hljs-name">LEAL</span></span> [off] (<span class="hljs-name"><span class="hljs-name">SP</span></span>))</code> </pre> <br><blockquote>  <code>(SP)</code> adalah salah satu operasi di genericOps.go dan menyatakan memuat pointer ke tumpukan perangkat keras.  Untuk arsitektur di mana tidak ada perangkat keras <code>SP</code> , itu ditiru. </blockquote><p>  Fitur variabel dalam templat (ekspresi S di sebelah kiri <code>-&gt;</code> ): </p><br><ul><li>  Variabel, seperti <code>x</code> , tanpa ekspresi melalui:, menangkap apa pun </li><li>  seperti variabel biasa, <code>_</code> menangkap nilai apa pun, tetapi hasilnya dapat diabaikan </li></ul><br><pre> <code class="lisp hljs">//       :    ADDQconst, //          : (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> _) -&gt; v (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> x) -&gt; (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> x)</code> </pre> <br><p>  Jika <code>AuxInt</code> tidak ditentukan (ekspresi dalam kurung siku), maka aturan akan <code>AuxInt</code> nilai <code>AuxInt</code> apa pun.  Demikian pula dengan <code>{}</code> -parameters (tentangnya di bawah). </p><br><p>  Nama <code>v</code> berarti bentuk tangkapan terluar. <br>  Misalnya, untuk ekspresi <code>(ADDQconst (SUBQconst x))</code> bentuk eksternal adalah <code>ADDQconst</code> . </p><br><p>  Variabel dapat digunakan beberapa kali, ini memungkinkan Anda untuk mengharuskan beberapa bagian ekspresi-S cocok satu sama lain: </p><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> [v] (<span class="hljs-name"><span class="hljs-name">ADDQconst</span></span> [v] x)) // , ,  <span class="hljs-string"><span class="hljs-string">"x+2+2"</span></span> (<span class="hljs-name"><span class="hljs-name">x+v+v</span></span>).</code> </pre> <br><h1 id="tipy-v-pravilah">  Jenis dalam Aturan </h1><br><p>  Dalam beberapa kasus, diperlukan untuk secara eksplisit menunjukkan jenis yang dihasilkan dan / atau formulir yang cocok. <br>  Tipe ditunjukkan dalam "kurung segitiga", sebagai argumen tipe dalam templat C ++: </p><br><pre> <code class="lisp hljs">// typ.UInt32 -   BTSLconst. // BSFL    typ.UInt32,    //    . (<span class="hljs-name"><span class="hljs-name">Ctz16</span></span> x) -&gt; (<span class="hljs-name"><span class="hljs-name">BSFL</span></span> (<span class="hljs-name"><span class="hljs-name">BTSLconst</span></span> &lt;typ.UInt32&gt; [<span class="hljs-number"><span class="hljs-number">16</span></span>] x))</code> </pre> <br><p>  Selain tipe, ada "karakter" (atau, lebih universal - properti <code>Aux</code> ). </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">StaticCall</span></span> [argsWidth] {target} mem) -&gt; (<span class="hljs-name"><span class="hljs-name">CALLstatic</span></span> [argsWidth] {target} mem)</code> </pre> <br><ul><li>  <code>[argsWidth]</code> - <code>Value.AuxInt</code> .  Untuk <code>StaticCall</code> - ukuran total argumen yang diteruskan </li><li>  <code>{target}</code> - <code>Value.Aux</code> .  Untuk fungsi <code>StaticCall</code> - disebut </li><li>  <code>&lt;typ.UInt32&gt;</code> - <code>Value.Type</code> .  Jenis nilai </li></ul><br><p>  Semantik <code>Aux</code> dan <code>AuxInt</code> sangat bervariasi dari operasi ke operasi.  Sumber dokumentasi terbaik dalam hal ini adalah file <code>*Ops.go</code>  Setiap <code>opData</code> opcode opData memiliki bidang isian yang menjelaskan bagaimana menafsirkan bidang ini. </p><br><p>  Untuk deskripsi tipe paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">cmd / compile / internal / types digunakan</a> .  Beberapa tipe khusus untuk backend SSA, misalnya <code>types.TypeFlags</code> , sisanya umum antara <code>cmd/compile/internal/gc</code> dan <code>cmd/compile/internal/ssa</code> . </p><br><h1 id="osobye-tipy">  Jenis khusus </h1><br><p>  Ada jenis tipe khusus. <code>types.TypeMem</code> yang melakukan beberapa fungsi sekaligus: </p><br><ol><li>  Memungkinkan Anda mengurutkan dan mengelompokkan <code>ssa.Value</code> berdasarkan pola akses memori.  Secara khusus, ini menjamin urutan eksekusi yang benar dalam kerangka blok dasar (tentangnya di bawah). </li><li>  Menentukan status aliran memori dalam program.  Jika instruksi mengubah memori, nilai SSA baru dari jenis tipe. <code>types.TypeMem</code> akan dihasilkan sebagai hasil dari operasi ini. </li></ol><br><p>  Seperti makna khusus <code>OpPhi</code> , memori ditafsirkan secara luar biasa dalam banyak fase pengoptimal. </p><br><div class="spoiler">  <b class="spoiler_title">Sedikit tentang Phi</b> <div class="spoiler_text"><p>  <code>Phi</code> memiliki peran yang sedikit berbeda dari fase ke fase. </p><br><p>  Pada awal pekerjaan SSA dari kompiler, <code>Phi</code> melayani tujuan klasiknya dan mengekspresikan pilihan nilai tergantung pada jalur eksekusi yang mengarahkan kami ke nilai ini. </p><br><p>  Misalnya, jika ada dua lompatan dalam sebuah blok, dan keduanya memodifikasi memori, maka blok tujuan akan menerima memori yang sama dengan <code>(Phi mem1 mem2)</code> .  Siklus juga menyeret nilai <code>Phi</code> . </p></div></div><br><p>  Tipe khusus lainnya adalah <code>types.TypeFlags</code> disebutkan di atas.  Tipe ini menjelaskan instruksi yang menghasilkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">flag CPU</a> . </p><br><p>  Dalam kasus ini, instruksi seperti <code>ADDQ</code> , meskipun mereka menghasilkan flag, bukan tipe <code>types.Flags</code> . <code>types.Flags</code> , tetapi ditandai dengan atribut <code>clobberFlags</code> . </p><br><p>  <code>types.Flags</code> digunakan untuk menyorot hasil instruksi seperti <code>CMPQ</code> , yang tidak menulis hasilnya ke salah satu operand eksplisit mereka, tetapi hanya memperbarui keadaan internal prosesor, yang dapat digunakan oleh instruksi berikutnya. </p><br><p>  Instruksi seperti <code>SETL</code> memungkinkan Anda untuk "membaca" flag dan mengembalikannya sebagai <code>ssa.Value</code> , yang dapat ditempatkan dalam register. </p><br><pre> <code class="lisp hljs"> L-less than G-greater than | | (<span class="hljs-name"><span class="hljs-name">SETL</span></span> (<span class="hljs-name"><span class="hljs-name">InvertFlags</span></span> x)) -&gt; (<span class="hljs-name"><span class="hljs-name">SETG</span></span> x) | ,  </code> </pre> <br><h1 id="inspekciya-ssa-programmy">  Program inspeksi SSA </h1><br><p>  Katakanlah kita memiliki program seperti ini ( <code>example.go</code> ): </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> example <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fusedMulAdd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b, c </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float64</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">float64</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a*c + b }</code> </pre> <br><p>  Kita dapat melihat kode SSA yang dihasilkan untuk fungsi <code>fusedMulAdd</code> : </p><br><pre> <code class="bash hljs">$ GOSSAFUNC=fusedMulAdd go tool compile example.go &gt; ssa.txt</code> </pre> <br><p>  Sekarang periksa direktori kerja (saat ini): </p><br><ul><li>  <code>ssa.txt</code> berisi dump tekt. </li><li>  <code>ssa.html</code> , yang dihasilkan secara otomatis, berisi informasi yang sama, tetapi dalam format yang lebih interaktif dan mudah dibaca.  Coba buka di browser. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Kode Mesin untuk fusedMulAdd</b> <div class="spoiler_text"><p>  Karakter <code>~r3</code> diubah namanya menjadi <code>ret</code> untuk ekspresif. </p><br><pre> <code class="hljs erlang"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v7</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> MOVSD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SP)</span></span></span><span class="hljs-function">, X0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v11</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> MOVSD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-function">+16</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SP)</span></span></span><span class="hljs-function">, X1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v12</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> MULSD X1, X0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v6</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> MOVSD </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function">+8</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SP)</span></span></span><span class="hljs-function">, X1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v13</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> ADDSD X1, X0 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v15</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> MOVSD X0, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ret</span></span></span><span class="hljs-function">+24</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SP)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b1</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> RET</span></span></code> </pre> </div></div><br><p>  Seperti inilah tampilan program SSA untuk <code>fusedMulAdd</code> setelah fase <code>lower</code> (ssa.html): </p><br><p><img src="https://habrastorage.org/webt/zs/yb/ax/zsybaxjcr1s0_u1csmhgkt3d1za.png"></p><br><div class="spoiler">  <b class="spoiler_title">Program format SSA teks</b> <div class="spoiler_text"><p>  Jika karena alasan tertentu Anda ingin menyalin ini: </p><br><pre> <code class="hljs xml">lower [77667 ns] b1: v1 (?) = InitMem <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> v2 (?) = SP <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uintptr</span></span></span><span class="hljs-tag">&gt;</span></span> v7 (?) = LEAQ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">*float64</span></span></span><span class="hljs-tag">&gt;</span></span> {~r3} v2 v8 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {a} v9 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {b} v10 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {c} v12 (+4) = MULSD <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v8 v10 v13 (4) = ADDSD <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v12 v9 v14 (4) = VarDef <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> {~r3} v1 v15 (4) = MOVSDstore <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> {~r3} v2 v13 v14 Ret v15 (line +4)</code> </pre> </div></div><br><p>  Menerjemahkan ini ke dalam ekspresi-S: </p><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">MOVQstore</span></span> {~r3} (<span class="hljs-name"><span class="hljs-name">SP</span></span>) (<span class="hljs-name"><span class="hljs-name">ADDSD</span></span> (<span class="hljs-name"><span class="hljs-name">MULSD</span></span> (<span class="hljs-name"><span class="hljs-name">Arg</span></span> {a}) (<span class="hljs-name"><span class="hljs-name">Arg</span></span> {c})) (<span class="hljs-name"><span class="hljs-name">Arg</span></span> {b})))</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">SSA setelah fase regalloc</b> <div class="spoiler_text"><p>  Ini adalah output dari <code>ssa.html</code> untuk fase <code>regalloc</code> . </p><br><p><img src="https://habrastorage.org/webt/ef/kx/u5/efkxu5pdwqvs14c9xwblajxoywo.png"></p><br><pre> <code class="hljs xml">regalloc [87237 ns] b1: v1 (?) = InitMem <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> v14 (4) = VarDef <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> {~r3} v1 v2 (?) = SP <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uintptr</span></span></span><span class="hljs-tag">&gt;</span></span> : SP v8 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {a} : a[float64] v9 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {b} : b[float64] v10 (3) = Arg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> {c} : c[float64] v7 (4) = LoadReg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v8 : X0 v11 (4) = LoadReg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v10 : X1 v12 (+4) = MULSD <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v7 v11 : X0 v6 (4) = LoadReg <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v9 : X1 v13 (4) = ADDSD <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">float64</span></span></span><span class="hljs-tag">&gt;</span></span> v12 v6 : X0 v15 (4) = MOVSDstore <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mem</span></span></span><span class="hljs-tag">&gt;</span></span> {~r3} v2 v13 v14 Ret v15 (line +4)</code> </pre> </div></div><br><h1 id="dobavlenie-novyh-pravil-optimizaciy">  Menambahkan Aturan Optimasi Baru </h1><br><p>  Pada prosesor dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FMA,</a> kita dapat menghitung <code>a*c + b</code> dalam satu instruksi, bukan dua. </p><br><p>  Ambil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL117295</a> sebagai dasar kepengarangan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ilya Tokar</a> . </p><br><p>  Untuk kenyamanan Anda, saya telah menyiapkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">patch <code> diff</code></a> . <br></p><br><h3 id="1-dobavlenie-novoy-operacii---fmasd">  1. Menambahkan operasi baru - FMASD </h3><br><p>  Dalam <code>compile/internal/ssa/gen/AMD64Ops.go</code> file <code>compile/internal/ssa/gen/AMD64Ops.go</code> temukan <code>AMD64ops</code> slice <code>AMD64ops</code> dan tambahkan elemen baru (di mana saja): </p><br><pre> <code class="go hljs">{ <span class="hljs-comment"><span class="hljs-comment">// fp64 fma name: "FMASD", //   SSA argLength: 3, reg: fp31, //   regalloc,   resultInArg0: true, //     source,  destination asm: "VFMADD231SD", //   },</span></span></code> </pre> <br><p>  Karena tidak ada operasi <code>(fp,fp,fp -&gt; fp)</code> sebelumnya, Anda perlu mendefinisikan kualifikasi baru: </p><br><pre> <code class="diff hljs"> fp01 = regInfo{inputs: nil, outputs: fponly} fp21 = regInfo{inputs: []regMask{fp, fp}, outputs: fponly} + fp31 = regInfo{inputs: []regMask{fp, fp, fp}, outputs: fponly}</code> </pre> <br><h3 id="2-dobavlenie-pravila-optimizacii">  2. Menambahkan aturan optimasi </h3><br><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">ADDSD</span></span> (<span class="hljs-name"><span class="hljs-name">MULSD</span></span> xy) z) -&gt; (<span class="hljs-name"><span class="hljs-name">FMASD</span></span> zxy)</code> </pre> <br><p>  Implementasi yang lebih benar tidak akan tanpa syarat dan akan memeriksa ketersediaan FMA.  Kami akan berasumsi bahwa pasti ada FMA di mesin target kami. </p><br><p>  Kompiler menggunakan <code>config</code> untuk pemeriksaan tersebut: </p><br><pre> <code class="lisp hljs">//  config.useFMA=false,    . (<span class="hljs-name"><span class="hljs-name">ADDSD</span></span> (<span class="hljs-name"><span class="hljs-name">MULSD</span></span> xy) z) &amp;&amp; config.useFMA-&gt; (<span class="hljs-name"><span class="hljs-name">FMASD</span></span> zxy)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Bagaimana cara memeriksa dukungan FMA?</b> <div class="spoiler_text"><p>  Jika <code>lscpu</code> tersedia di sistem, maka, misalnya, seperti ini: </p><br><pre> <code class="bash hljs">$ lscpu | grep fma</code> </pre> </div></div><br><h3 id="3-realizaciya-kodogeneracii">  3. Implementasi pembuatan kode </h3><br><p>  Sekarang, dalam fungsi <code>ssaGenValue</code> , didefinisikan dalam file <code>compile/internal/amd64/ssa.go</code> , Anda perlu menambahkan pembuatan kode untuk <code>FMASD</code> : </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ssaGenValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *gc.SSAGenState, v *ssa.Value)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> v.Op { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ssa.OpAMD64FMASD: p := s.Prog(v.Op.Asm()) <span class="hljs-comment"><span class="hljs-comment">//   obj.Prog    // From:  source . p.From = obj.Addr{Type: obj.TYPE_REG, Reg: v.Args[2].Reg()} // To: destination . // v.Reg()  ,      FMASD. p.To = obj.Addr{Type: obj.TYPE_REG, Reg: v.Reg()} // From3:  source . //  From3 .     //  RestArgs,    source ,  . p.SetFrom3(obj.Addr{ Type: obj.TYPE_REG, Reg: v.Args[1].Reg(), }) if v.Reg() != v.Args[0].Reg() { //   resultInArg0 s := v.LongString() v.Fatalf("input[0] and output not in same register %s", s) } //    ,     case. } }</span></span></code> </pre> <br><p>  Sekarang semuanya siap untuk menguji karya optimasi baru kami.  Sangat jarang menambahkan instruksi baru, biasanya optimasi baru dilakukan berdasarkan operasi SSA yang sudah ditentukan. </p><br><h1 id="proverka-rezultatov">  Memeriksa Hasil </h1><br><p>  Langkah pertama adalah membuat kode Go dari <code>gen/AMD64Ops.go</code> diperbarui <code>gen/AMD64Ops.go</code> dan <code>gen/AMD64.Rules</code> . </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  GOROOT  ,   ,   `go env GOROOT`. cd $GOROOT/src/cmd/compile/internal/ssa/gen &amp;&amp; go run *.go</span></span></code> </pre> <br><p>  Selanjutnya, kita perlu membangun kompiler baru kita: </p><br><pre> <code class="bash hljs">go install cmd/compile</code> </pre> <br><p>  Sekarang, ketika mengkompilasi contoh yang sama, kami mendapatkan kode mesin yang berbeda: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- v7 (4) MOVSD a(SP), X0 - v11 (4) MOVSD c+16(SP), X1 - v12 (4) MULSD X1, X0 - v6 (4) MOVSD b+8(SP), X1 - v13 (4) ADDSD X1, X0 - v15 (4) MOVSD X0, ret+24(SP) - b1 (4) RET + v12 (4) MOVSD b+8(SP), X0 + v7 (4) MOVSD a(SP), X1 + v11 (4) MOVSD c+16(SP), X2 + v13 (4) VFMADD231SD X2, X1, X0 + v15 (4) MOVSD X0, ret+24(SP) + b1 (4) RET</span></span></code> </pre> <br><h1 id="bazovye-bloki-basic-blocks">  Blok dasar </h1><br><p>  Sekarang setelah pekerjaan yang paling sulit telah dilakukan, mari kita bicara tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">blok dasar</a> . </p><br><p>  Nilai yang kami optimalkan di atas adalah dalam blok, dan blok dalam fungsi. </p><br><p>  Blok, seperti <code>ssa.Value</code> , abstrak dan bergantung pada mesin.  Semua blok memiliki tepat satu titik masuk dan dari 0 hingga 2 blok tujuan (tergantung pada jenis blok). </p><br><p>  Blok paling sederhana adalah <code>If</code> , <code>Exit</code> dan <code>Plain</code> : </p><br><ul><li>  Blok <code>Exit</code> memiliki 0 blok tugas.  Ini adalah blok daun yang membuat lompatan non-lokal, misalnya, menggunakan <code>panic</code> . </li><li>  Blok <code>Plain</code> memiliki 1 blok tugas.  Ini dapat dianggap sebagai lompatan tanpa syarat setelah menyelesaikan semua instruksi blok ke blok lain. </li><li>  <code>If</code> blok memiliki 2 blok tujuan.  Transisi dilakukan tergantung pada kondisinya ( <code>Block.Control</code> ). </li></ul><br><p>  Berikut adalah contoh sederhana penulisan ulang blok abstrak menjadi blok <code>AMD64</code> : </p><br><pre> <code class="lisp hljs">  <span class="hljs-string"><span class="hljs-string">"then"</span></span> ( ) |  <span class="hljs-string"><span class="hljs-string">"else"</span></span> ( ) | | (<span class="hljs-name"><span class="hljs-name">If</span></span> (<span class="hljs-name"><span class="hljs-name">SETL</span></span> cmp) yes no) -&gt; (<span class="hljs-name"><span class="hljs-name">LT</span></span> cmp yes no) (<span class="hljs-name"><span class="hljs-name">If</span></span> (<span class="hljs-name"><span class="hljs-name">SETLE</span></span> cmp) yes no) -&gt; (<span class="hljs-name"><span class="hljs-name">LE</span></span> cmp yes no)</code> </pre> <br><p>  Topik blok akan dipertimbangkan secara lebih rinci dalam konteks fase optimisasi lainnya di bagian SSA dari kompiler. </p><br><h1 id="ogranicheniya-pravil-optimizaciy">  Keterbatasan Aturan Optimasi </h1><br><p>  Backend SSA memiliki kelebihan.  Beberapa optimasi layak dilakukan di <code>O(1)</code> .  Namun, ada juga kelemahan karena SSA dari optimizer saja tidak akan cukup, setidaknya sampai beberapa aspek perubahan implementasinya. </p><br><p>  Misalkan Anda ingin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><code>  append</code></a> : </p><br><pre> <code class="go hljs">xs = <span class="hljs-built_in"><span class="hljs-built_in">append</span></span>(xs, <span class="hljs-string"><span class="hljs-string">'a'</span></span>) xs = <span class="hljs-built_in"><span class="hljs-built_in">append</span></span>(xs, <span class="hljs-string"><span class="hljs-string">'b'</span></span>) <span class="hljs-comment"><span class="hljs-comment">// =&gt; xs = append(xs, 'a', 'b')</span></span></code> </pre> <br><p>  Pada saat SSA dihasilkan, struktur kode tingkat tinggi hilang dan <code>append</code> , karena bukan fungsi biasa, sudah dibangun ke dalam tubuh blok yang berisi.  Anda harus menulis aturan rumit yang menangkap seluruh urutan operasi yang dihasilkan untuk <code>append</code> . </p><br><p>  Berbicara secara khusus tentang. <code>.Rules</code> , maka DSL ini memiliki kerja yang agak lemah dengan blok ( <code>ssa.Block</code> ).  Optimalisasi nontrivial apa pun yang terkait dengan blok tidak mungkin diungkapkan dalam bahasa ini.  Pembaruan blok sebagian tidak dimungkinkan.  Juga tidak mungkin untuk membuang blok (tetapi ada hack dalam bentuk blok <code>First</code> , yang digunakan untuk menghapus kode mati). </p><br><blockquote>  Bahkan jika beberapa kekurangan dapat diperbaiki, sebagian besar penyusun setuju bahwa tidak ada bentuk peralihan yang lebih baik untuk mewakili kode. </blockquote><br><h1 id="go-that-goes-faster">  Lakukan lebih cepat </h1><br><p>  Jika Anda membuat beberapa aturan optimasi yang keren, silakan kirim ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">go-review.googlesource.com</a> .  Saya akan senang untuk meninjau (tambahkan ke <code>iskander.sharipov@intel.com</code> di CC). </p><br><p>  Selamat kompiler peretasan! </p><br><p><img src="https://habrastorage.org/webt/op/wr/50/opwr50a-n6imbex_ykcxpia5_ny.gif"></p><br><h2 id="bonusnyy-material">  Bahan Bonus </h2><br><p>  Contoh tambalan yang baik di Go yang menambah atau mengubah aturan SSA: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL99656: cmd / compile / internal / ssa: emit IMUL3 {L / Q} untuk MUL {L / Q} const pada x86</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL102277: cmd / compile / internal / ssa: optimalkan NEG ganda pada amd64</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL54410: cmd / compile / internal / ssa: gunakan sse to zero pada amd64</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL58090: cmd / compile / internal / ssa: hapus redextant zeroextensions pada amd64</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL95475: cmd / compile / internal / ssa: gabungkan toko byte di amd64</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL97175: cmd / compile / internal / ssa: gabungkan toko LittleEndian berturut-turut di arm64</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL115617: cmd / compile / internal / ssa: hapus ekstensi nol yang tidak berguna</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CL101275: cmd / compile: tambahkan amd64 LEAL {1,2,4,8} ops</a> </li></ul><br><p>  Belum lama ini, dokumen <a href="">README</a> muncul untuk menggambarkan bagian SSA dari kompiler. <br>  Bacaan yang disarankan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id415771/">https://habr.com/ru/post/id415771/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id415761/index.html">Apa, Bagaimana dan Mengapa di Iklan yang Dapat Diputar</a></li>
<li><a href="../id415763/index.html">Pemerintah AS sedang mendiskusikan kemungkinan mendapatkan kembali kendali atas IANA [tetapi ini tidak mungkin]</a></li>
<li><a href="../id415765/index.html">Mengapa VMware memutuskan untuk membuat platform untuk mengembangkan blockchains perusahaan</a></li>
<li><a href="../id415767/index.html">Tesla Inc telah membuka kemungkinan memesan Tesla Model 3 untuk penduduk Kanada dan Amerika Serikat</a></li>
<li><a href="../id415769/index.html">Siapkan peluncuran otomatis uji UI aplikasi Android melalui TeamCity</a></li>
<li><a href="../id415773/index.html">Persyaratan non-fungsional: Skalabilitas</a></li>
<li><a href="../id415775/index.html">Sederhana, tetapi tidak jelas, kiat untuk menyiapkan laporan untuk konferensi keren</a></li>
<li><a href="../id415777/index.html">Kejuaraan pembelajaran mesin pertama dalam pengembangan</a></li>
<li><a href="../id415779/index.html">Implementasi platform perangkat lunak NAS yang aman</a></li>
<li><a href="../id415781/index.html">Mengapa fisikawan berpikir teori string bisa berubah menjadi "teori segalanya"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>