<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¢ ü•ì üë®üèø‚Äçü§ù‚Äçüë®üèæ Monitoreo continuo: automatizaci√≥n de controles de calidad de software en canalizaciones de CI / CD üëâüèª üö¢ üîô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ahora en el tema de exageraci√≥n DevOps. El transportador de integraci√≥n y entrega continua de CI / CD es implementado por todos los que lo desean. Per...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Monitoreo continuo: automatizaci√≥n de controles de calidad de software en canalizaciones de CI / CD</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/451630/">  Ahora en el tema de exageraci√≥n DevOps.  El transportador de integraci√≥n y entrega continua de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CI / CD es</a> implementado por todos los que lo desean.  Pero la mayor√≠a no siempre presta la debida atenci√≥n a garantizar la confiabilidad de los sistemas de informaci√≥n en varias etapas de la canalizaci√≥n de CI / CD.  En este art√≠culo, me gustar√≠a hablar sobre mi experiencia en la automatizaci√≥n de los controles de calidad del software y la implementaci√≥n de posibles escenarios para su "autocuraci√≥n". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/279/b1b/d43/279b1bd4301b7755a590307a9378243c.jpg"></div>  <a href=""><i>Fuente</i></a> <br><a name="habracut"></a><br>  Trabajo como ingeniero en el departamento de gesti√≥n de servicios de TI en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LANIT-Integration</a> .  Mi √°rea principal es la implementaci√≥n de varios sistemas para monitorear el rendimiento y la disponibilidad de las aplicaciones.  A menudo me comunico con clientes de TI de diferentes segmentos del mercado sobre cuestiones de actualidad relacionadas con la supervisi√≥n de la calidad de sus servicios de TI.  La tarea principal es minimizar el tiempo del ciclo de lanzamiento y aumentar la frecuencia de su lanzamiento.  Esto, por supuesto, es bueno: m√°s lanzamientos, m√°s funciones nuevas, m√°s usuarios satisfechos, m√°s ganancias.  Pero en realidad, no siempre todo sale bien.  A tasas de implementaci√≥n muy altas, la pregunta surge inmediatamente sobre la calidad de nuestros lanzamientos.  Incluso con una tuber√≠a totalmente automatizada, uno de los mayores problemas es la transferencia de servicios de prueba a producci√≥n, lo que no afecta el tiempo de actividad y la interacci√≥n del usuario con la aplicaci√≥n. <br><br>  Basado en los resultados de numerosas conversaciones con los clientes, puedo decir que el control de calidad de los lanzamientos, el problema de la confiabilidad de la aplicaci√≥n y la posibilidad de su "autocuraci√≥n" (por ejemplo, revertir a una versi√≥n estable) en varias etapas de la canalizaci√≥n de CI / CD se encuentran entre los temas m√°s interesantes y relevantes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/373/e6e/f90/373e6ef9080b3a7f8c6c4e65568254eb.png"></div><br>  Recientemente, yo mismo trabaj√© del lado del cliente, en el servicio de soporte de aplicaciones de banca en l√≠nea.  La arquitectura de nuestra aplicaci√≥n utilizaba una gran cantidad de microservicios autoescritos.  Lo m√°s triste es que no todos los desarrolladores hicieron frente al alto ritmo de desarrollo, la calidad de algunos microservicios sufrieron, lo que dio lugar a apodos rid√≠culos para ellos y sus creadores.  Hubo historias sobre de qu√© materiales est√°n hechos estos productos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/210/472/129/21047212917809f642f154cfa2b8e6c6.png"></div><br><h1>  "Declaraci√≥n del problema" </h1><br>  La alta frecuencia de lanzamientos y una gran cantidad de microservicios dificultan la comprensi√≥n de la aplicaci√≥n en su conjunto, tanto en la etapa de prueba como en la etapa operativa.  Los cambios ocurren constantemente y es muy dif√≠cil controlarlos sin buenas herramientas de monitoreo.  A menudo, despu√©s de un lanzamiento nocturno por la ma√±ana, los desarrolladores se sientan en un barril de p√≥lvora y esperan que nada se rompa, aunque en la etapa de prueba todas las comprobaciones tuvieron √©xito. <br><br>  Hay un punto m√°s.  En la etapa de prueba, se verifica la operatividad del software: la implementaci√≥n de las funciones principales de la aplicaci√≥n y la ausencia de errores.  Las estimaciones cualitativas del rendimiento est√°n ausentes o no tienen en cuenta todos los aspectos de la aplicaci√≥n y la capa de integraci√≥n.  Algunas m√©tricas pueden no verificarse en absoluto.  Como resultado, cuando se produce una falla en un entorno productivo, el departamento de soporte t√©cnico solo se entera cuando los usuarios reales comienzan a quejarse.  Me gustar√≠a minimizar el impacto del software de baja calidad en los usuarios finales. <br><br>  Una de las soluciones es implementar procesos de control de calidad de software en varias etapas de la canalizaci√≥n de CI / CD, agregar varios scripts para restaurar el sistema en caso de accidente.  Tambi√©n recuerda que tenemos DevOps.  Las empresas esperan recibir un nuevo producto lo m√°s r√°pido posible.  Por lo tanto, todos nuestros cheques y scripts deben ser automatizados. <br><br>  La tarea se divide en dos componentes: <br><br><ul><li>  control de calidad de conjuntos en la etapa de prueba (para automatizar el proceso de captura de conjuntos de calidad inferior); </li><li>  control de calidad del software en el entorno de producci√≥n (mecanismos autom√°ticos de detecci√≥n de problemas y posibles escenarios para la autocuraci√≥n). </li></ul><br><h1>  Herramienta para monitorear y recolectar m√©tricas </h1><br>  Para realizar las tareas establecidas, se requiere un sistema de monitoreo que pueda detectar problemas y transferirlos a sistemas de automatizaci√≥n en varias etapas de la tuber√≠a de CI / CD.  Adem√°s, un punto positivo ser√° si este sistema proporciona m√©tricas √∫tiles para varios equipos: desarrollo, pruebas, operaci√≥n.  Y bastante maravilloso, si es por negocios. <br><br>  Para recopilar m√©tricas, puede usar una combinaci√≥n de diferentes sistemas (Prometheus, ELK Stack, Zabbix, etc.), pero, en mi opini√≥n, las soluciones APM ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Application Performance Monitoring</a> ) son las m√°s adecuadas para estas tareas, lo que puede simplificar enormemente su vida. <br><br>  Como parte de mi trabajo en el servicio de acompa√±antes, comenc√© a hacer un proyecto similar utilizando la soluci√≥n de clase APM de Dynatrace.  Ahora, trabajando como integrador, conozco bastante bien el mercado de los sistemas de monitoreo.  Mi opini√≥n subjetiva: Dynatrace es la m√°s adecuada para tales tareas. <br>  La soluci√≥n Dynatrace proporciona una visualizaci√≥n horizontal de cada operaci√≥n del usuario con un profundo grado de detalle hasta el nivel de ejecuci√≥n del c√≥digo.  Puede realizar un seguimiento de toda la cadena de interacci√≥n entre varios servicios de informaci√≥n: desde niveles front-end de aplicaciones web y m√≥viles, servidores de aplicaciones back-end, bus de integraci√≥n hasta una llamada espec√≠fica a la base de datos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/223/706/776/223706776e2f818b7c9e58451f3b5874.png"></div>  <i><a href="">Fuente</a></i>  <i>Construcci√≥n autom√°tica de todas las dependencias entre los componentes del sistema.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/73f/796/e80/73f796e80d722c47cc6044f1c60bf2c8.png"></div>  <i><a href="">Fuente</a></i>  <i>Detecci√≥n autom√°tica y construcci√≥n de una ruta para una operaci√≥n de servicio.</i> <br><br>  Tambi√©n recuerde que necesitamos integrarnos con varias herramientas de automatizaci√≥n.  Aqu√≠ la soluci√≥n tiene una API conveniente que le permite enviar y recibir varias m√©tricas y eventos. <br><br>  A continuaci√≥n, pasaremos a una discusi√≥n m√°s detallada sobre c√≥mo resolver tareas utilizando el sistema Dynatrace. <br><br><h1>  Tarea 1. Automatizaci√≥n del control de calidad de ensamblajes en la etapa de prueba. </h1><br>  La primera tarea es encontrar los problemas lo antes posible en las etapas del proceso de entrega de la aplicaci√≥n.  Solo las compilaciones de c√≥digo "buenas" deber√≠an llegar al entorno de producci√≥n.  Para hacer esto, se deben incluir monitores adicionales en su tuber√≠a en la etapa de prueba para verificar la calidad de sus servicios. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/034/bd9/498/034bd9498761bf4addffd97f68e70699.png"></div><br><br>  Veamos los pasos para implementar esto y automatizar este proceso: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b6/2eb/b7f/1b62ebb7fa1fd652fc7ca5110926676e.png"></div>  <i><a href="">Fuente</a></i> <br><br>  La figura muestra el flujo de los pasos de control de calidad del software automatizado: <br><br><ol><li>  despliegue de un sistema de monitoreo (instalaci√≥n de agentes); </li><li>  definici√≥n de eventos de evaluaci√≥n de calidad de su software (m√©tricas y valores umbral) y su transferencia al sistema de monitoreo; </li><li>  generaci√≥n de carga y pruebas de rendimiento; </li><li>  recopilar datos de rendimiento y disponibilidad en un sistema de monitoreo; </li><li>  transferir datos de prueba basados ‚Äã‚Äãen eventos de evaluaci√≥n de calidad del software del sistema de monitoreo al sistema CI / CD.  An√°lisis de montaje autom√°tico. </li></ol><br>  <b>Paso 1. Implemente un sistema de monitoreo</b> <br><br>  Primero debe instalar los agentes en su entorno de prueba.  Al mismo tiempo, la soluci√≥n Dynatrace tiene una buena caracter√≠stica: utiliza el agente universal OneAgent, que se instala en la instancia del sistema operativo (Windows, Linux, AIX), detecta autom√°ticamente sus servicios y comienza a recopilar datos de monitoreo sobre ellos.  No necesita configurar un agente por separado para cada proceso.  Una situaci√≥n similar ser√° para las plataformas de nube y contenedores.  Al mismo tiempo, tambi√©n puede automatizar la instalaci√≥n de agentes.  Dynatrace encaja perfectamente en el concepto de "infraestructura como c√≥digo" ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Infraestructura como c√≥digo o IaC</a> ): hay scripts e instrucciones listos para todas las plataformas populares.  Incruste el agente en la configuraci√≥n de su servicio, y cuando lo implemente, inmediatamente obtendr√° un nuevo servicio con un agente que ya se est√° ejecutando. <br><br>  <b>Paso 2. Identifique los eventos de evaluaci√≥n de calidad de su software</b> <br><br>  Ahora debe determinar la lista de servicios y operaciones comerciales.  Es importante tener en cuenta exactamente las operaciones de los usuarios que son cr√≠ticas para su servicio.  Aqu√≠ recomiendo consultar con analistas comerciales y de sistemas. <br><br>  A continuaci√≥n, debe determinar qu√© m√©tricas desea incluir en la verificaci√≥n para cada uno de los niveles.  Por ejemplo, puede ser tiempo de ejecuci√≥n (con separaci√≥n por promedio, mediana, percentil, etc.), errores (l√≥gico, servicio, infraestructura, etc.) y varias m√©tricas de infraestructura (mont√≥n de memoria, recolector de basura, conteo de hilos, etc.). <br><br>  Para automatizaci√≥n y facilidad de uso, el equipo de DevOps presenta el concepto de "Monitoreo como c√≥digo".  Lo que quiero decir con esto es que un desarrollador / evaluador puede escribir un archivo JSON simple que defina los indicadores de control de calidad del software. <br><br>  Veamos un ejemplo de tal archivo JSON.  Los objetos de la API de Dynatrace se utilizan como un par clave / valor (consulte la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API de Dynatrace para obtener una descripci√≥n de la API</a> ). <br><br><pre><code class="json hljs">{    <span class="hljs-attr"><span class="hljs-attr">"timeseries"</span></span>: [    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"service.ResponseTime"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: <span class="hljs-string"><span class="hljs-string">"Frontend"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">250000</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">1000000</span></span>    },    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"service.ResponseTime "</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: <span class="hljs-string"><span class="hljs-string">"Backend"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">4000000</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">8000000</span></span>    },    {      <span class="hljs-attr"><span class="hljs-attr">"timeseriesId"</span></span>: <span class="hljs-string"><span class="hljs-string">"docker.Container.Cpu"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"aggregation"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"severe"</span></span>: <span class="hljs-number"><span class="hljs-number">50</span></span>,      <span class="hljs-attr"><span class="hljs-attr">"warning"</span></span>: <span class="hljs-number"><span class="hljs-number">70</span></span>    }  ] }</code> </pre> <br>  El archivo es una serie de definiciones de series de tiempo: <br><br><ul><li>  timeseriesId: m√©trica verificada, por ejemplo, Tiempo de respuesta, Conteo de errores, Memoria utilizada, etc. </li><li>  agregaci√≥n: el nivel de agregaci√≥n de m√©tricas, en nuestro caso promedio, pero puede usar lo que necesite (promedio, m√≠nimo, m√°ximo, suma, conteo, percentil); </li><li>  etiquetas: una etiqueta de objeto en el sistema de monitoreo, o puede especificar un identificador de objeto espec√≠fico; </li><li>  severa y de advertencia: estos indicadores ajustan los valores de umbral de nuestras m√©tricas, si el valor de las pruebas excede el umbral severo, entonces nuestro ensamblaje se marca como no exitoso. </li></ul><br>  La siguiente figura muestra un ejemplo del uso de dichos contenedores. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/087/be4/db9/087be4db9e8c7a51de722110e526f39a.png"></div>  <i><a href="">Fuente</a></i> <br><br>  <b>Paso 3. Generaci√≥n de carga</b> <br><br>  Despu√©s de determinar los niveles de calidad de nuestro servicio, es necesario generar una carga de prueba.  Puede usar cualquiera de las herramientas de prueba que le resulten convenientes, por ejemplo, Jmeter, Selenium, Neotys, Gatling, etc. <br><br>  El sistema de monitoreo Dynatrace le permite capturar varios metadatos de sus pruebas y reconocer qu√© prueba se relaciona con qu√© ciclo de lanzamiento y servicio.  Se recomienda que agregue encabezados adicionales a las solicitudes HTTP de prueba. <br><br>  La siguiente figura muestra un ejemplo en el que, utilizando el encabezado opcional X-Dynatrace-Test, marcamos que esta prueba se refiere a probar la operaci√≥n de agregar un art√≠culo a la cesta. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/96a/3b8/277/96a3b8277f52b4643cc05acc38b7258b.png"></div>  <i><a href="https://dt-cdn.net/images/dynatrace-loadtesting-">Fuente</a></i> <br><br>  Cuando ejecuta cada prueba de carga, env√≠a informaci√≥n contextual adicional a Dynatrace utilizando la API de eventos desde el servidor CI / CD.  Por lo tanto, el sistema puede distinguir entre diferentes pruebas entre s√≠. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/574/f50/948/574f509484f4a0fcc4dea39f9a39870e.png"></div>  <i><a href="">Fuente</a></i>  <i>Evento en el sistema de monitoreo sobre el lanzamiento de pruebas de carga</i> <br><br>  <b>Paso 4-5.</b>  <b>Recopile datos de rendimiento y transfiera datos a un sistema CI / CD</b> <br><br>  Junto con la prueba generada, se transmite un evento al sistema de monitoreo sobre la necesidad de recopilar datos para verificar los indicadores de calidad del servicio.  Tambi√©n se indica nuestro archivo JSON, en el que se definen las m√©tricas clave. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/584/427/af6/584427af69b059959ece68661cefbf9e.png"></div>  <i>Un evento sobre la necesidad de verificar la calidad del software generado en el servidor CI / CD para enviarlo al sistema de monitoreo</i> <br><br>  En nuestro ejemplo, el evento de control de calidad se llama <i>perfSigDynatraceReport</i> (Performance_Signature <i>)</i> ; este es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">complemento</a> listo para integrarse con Jenkins, que fue desarrollado por los chicos de T-Systems Multimedia Solutions.  Cada evento sobre el lanzamiento de la prueba contiene informaci√≥n sobre el servicio, el n√∫mero de compilaci√≥n y el tiempo de prueba.  El complemento recopila valores de rendimiento durante el ensamblaje, los eval√∫a y compara el resultado con ensamblajes anteriores y requisitos no funcionales. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e58/f13/7d8/e58f137d890618ddb2c59be5eb292b3d.png"></div>  <i>Evento en el sistema de monitoreo sobre el inicio del control de calidad del ensamblaje.</i>  <i><a href="">Fuente</a></i> <br><br>  Una vez completada la prueba, todas las m√©tricas de evaluaci√≥n de la calidad del software se transfieren al sistema de integraci√≥n continua, por ejemplo, Jenkins, que genera un informe sobre los resultados. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0y/nl/rc/0ynlrc9qxeffy9v4ei_s4ihn5v0.png"></div>  <i>El resultado de las estad√≠sticas de ensamblaje en el servidor CI / CD.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a></i> <br><br>  Para cada ensamblaje individual, vemos estad√≠sticas para cada m√©trica que establecemos durante toda la prueba.  Tambi√©n vemos si hubo violaciones en ciertos valores de umbral (advertencia y trabas severas).  Seg√∫n las m√©tricas agregadas, todo el ensamblaje se marca como estable, inestable o fallido.  Adem√°s, para mayor comodidad, puede agregar indicadores para comparar el ensamblaje actual con el anterior en el informe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09a/a3d/106/09aa3d106d50eb6be368d1be57e5ee39.png"></div>  <i>Ver estad√≠sticas detalladas de ensamblaje en el servidor CI / CD.</i>  <i><a href="">Fuente</a></i> <br><br>  <b>Comparaci√≥n detallada de dos conjuntos</b> <br><br>  Si es necesario, puede ir a la interfaz de Dynatrace y ver con m√°s detalle las estad√≠sticas de cada uno de sus ensamblajes y compararlos entre s√≠. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/586/d52/12d/586d5212dcf21aeb30d8f7a6bbd4f158.png"></div>  <i>Comparaci√≥n de estad√≠sticas de ensamblaje en Dynatrace.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a></i> <br><br>  <b>Conclusiones</b> <br><br>  Como resultado, obtenemos el servicio "monitoreo como servicio", automatizado en la tuber√≠a de integraci√≥n continua.  El desarrollador o probador solo necesita determinar la lista de m√©tricas en el archivo JSON, y todo lo dem√°s sucede autom√°ticamente.  Obtenemos un control de calidad transparente de las versiones: todas las notificaciones sobre rendimiento, consumo de recursos o regresiones arquitect√≥nicas. <br><br><h1>  Tarea 2. Automatizaci√≥n del control de calidad del software en un entorno de producci√≥n. </h1><br>  Entonces, resolvimos el problema de c√≥mo automatizar el proceso de monitoreo en la etapa de prueba en Pipeline.  Por lo tanto, minimizamos el porcentaje de ensamblajes de baja calidad que llegan al entorno alimentario. <br><br>  Pero qu√© hacer si el software defectuoso a√∫n llega al punto de venta, bueno, o simplemente se rompe algo.  Para la utop√≠a, quer√≠amos tener mecanismos para detectar problemas autom√°ticamente y, si es posible, el sistema en s√≠ mismo restablecer√≠a su capacidad de trabajo, al menos de noche. <br><br>  Para hacer esto, nosotros, por analog√≠a con la secci√≥n anterior, proporcionamos controles autom√°ticos de calidad del software en el entorno de producci√≥n y colocamos scripts para la autocuraci√≥n del sistema bajo ellos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/94d/63e/6c0/94d63e6c0575a310f5982386d731649a.png"></div><br>  <b>Correcci√≥n autom√°tica como c√≥digo</b> <br><br>  La mayor√≠a de las empresas ya tienen una base de conocimiento acumulada sobre varios tipos de problemas comunes y una lista de acciones para solucionarlos, por ejemplo, reiniciar procesos, limpiar recursos, revertir versiones, restaurar cambios de configuraci√≥n incorrectos, aumentar o disminuir el n√∫mero de componentes en un cl√∫ster, cambiar el contorno azul o verde y otro <br><br>  A pesar del hecho de que estos casos de uso se conocen desde hace muchos a√±os para muchos equipos con los que me comunico, solo unos pocos pensaron e invirtieron en su automatizaci√≥n. <br><br>  Si lo piensa, entonces, en la implementaci√≥n de procesos para autorreparar la salud de la aplicaci√≥n, no hay nada s√∫per complicado, debe presentar los escenarios de trabajo bien conocidos de sus administradores en forma de scripts de c√≥digo (el concepto de "autocorrecci√≥n como c√≥digo") que escribi√≥ de antemano para cada caso espec√≠fico.  Los escenarios de reparaci√≥n autom√°tica deben abordar la causa ra√≠z del problema.  Usted mismo establece las acciones correctas de respuesta a incidentes. <br><br>  Cualquier m√©trica de su sistema de monitoreo puede actuar como un disparador para ejecutar un script, lo principal es que estas m√©tricas determinan con precisi√≥n que todo es malo, ya que no me gustar√≠a obtener falsos positivos en un entorno productivo. <br><br>  Puede usar cualquier sistema o conjunto de sistemas: Prometheus, ELK Stack, Zabbix, etc.  Pero dar√© algunos ejemplos basados ‚Äã‚Äãen la soluci√≥n APM (Dynatrace volver√° a ser un ejemplo), que tambi√©n ayudar√°n a facilitarle la vida. <br><br>  En primer lugar, hay todo lo relacionado con la operabilidad en t√©rminos de la aplicaci√≥n.  La soluci√≥n proporciona cientos de m√©tricas en varios niveles que puede usar como desencadenantes: <br><br><ul><li>  nivel de usuario (navegadores, aplicaciones m√≥viles, dispositivos IoT, comportamiento del usuario, conversi√≥n, etc.); </li><li>  nivel de servicio y operaciones (rendimiento, disponibilidad, errores, etc.); </li><li>  nivel de infraestructura de la aplicaci√≥n (m√©tricas del sistema operativo host, JMX, MQ, servidor web, etc.); </li><li>  nivel de plataforma (virtualizaci√≥n, nube, contenedor, etc.). </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ac2/5f9/480/ac25f94800d26b672cace37d7495d008.png"></div>  <i>Monitoreo de niveles en Dynatrace.</i>  <i><a href="">Fuente</a></i> <br><br>  En segundo lugar, como dije antes, Dynatrace tiene una API abierta, lo que hace que sea muy conveniente integrarlo con varios sistemas de terceros.  Por ejemplo, enviar una notificaci√≥n al sistema de automatizaci√≥n cuando se exceden los par√°metros de control. <br><br>  A continuaci√≥n se muestra un ejemplo para interactuar con Ansible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b90/a7a/d74/b90a7ad74b93428578dafb42235e19b4.png"></div>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente</a></i> <br><br>  A continuaci√≥n dar√© algunos ejemplos de exactamente qu√© automatizaci√≥n se puede hacer.  Esto es solo una parte de los casos; enumerarlos en su entorno puede estar limitado solo por su imaginaci√≥n y las capacidades de sus herramientas de monitoreo. <br><br>  <b>1. Implementaci√≥n incorrecta: reversi√≥n de la versi√≥n</b> <br><br>  Incluso si todos probamos muy bien en un entorno de prueba, todav√≠a existe la posibilidad de que una nueva versi√≥n pueda matar su aplicaci√≥n en el entorno de producci√≥n.  El mismo factor humano no ha sido cancelado. <br><br>  En la siguiente figura, vemos que hay un salto brusco en el tiempo de ejecuci√≥n de las operaciones en el servicio.  El comienzo de este salto coincide con el tiempo de implementaci√≥n de la aplicaci√≥n.  Transferimos toda esta informaci√≥n como eventos al sistema de automatizaci√≥n.  Si la capacidad de servicio del servicio no se normaliza despu√©s de que expire el tiempo especificado por nosotros, se llama autom√°ticamente a un script que revierte la versi√≥n a la anterior. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lk/f9/ps/lkf9psxvdi6kivm-oa29pvypblw.png"></div>  <i>Degradaci√≥n del rendimiento despu√©s del despliegue.</i>  <i><a href="">Fuente</a></i> <br><br>  <b>2. Carga de recursos al 100%: agregue un nodo a la ruta</b> <br><br>  En el siguiente ejemplo, el sistema de monitoreo determina que uno de los componentes tiene un 100% de utilizaci√≥n de la CPU. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a6c/f16/d1a/a6cf16d1aebeb435e1a24c3760563f54.png"></div>  <i>Utilizaci√≥n de CPU 100%</i> <br><br>  Varios escenarios diferentes son posibles para este evento.  Por ejemplo, el sistema de monitoreo adem√°s verifica si la falta de recursos est√° asociada con un aumento en la carga del servicio.  Si, s√≠, se ejecuta un script que agrega autom√°ticamente el nodo al enrutamiento, restaurando as√≠ el sistema como un todo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/du/kc/1z/dukc1zzqhiae9ymfilbxpoem2qo.jpeg"></div>  <i>Escalando nodos despu√©s de un incidente</i> <br><br>  <b>3. Falta de espacio en el disco duro: limpieza del disco</b> <br><br>  Creo que muchos de estos procesos ya est√°n automatizados.  Usando APM, tambi√©n puede monitorear el espacio libre en el subsistema de disco.  En ausencia de espacio u operaci√≥n lenta del disco, llamamos al script para limpiar o agregar espacio. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ea8/0cc/b7f/ea80ccb7f269eb465f30e7c94ba18c6d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3d8/f22/64d/3d8f2264dd7f312dac430eaa4446d845.png"></div>  <i>Disco de carga 100%</i> <br><br>  <b>4. Baja actividad del usuario o baja conversi√≥n: cambie entre las ramas azul y verde</b> <br><br>  A menudo me encuentro con clientes que usan dos circuitos (despliegue azul-verde) para aplicaciones en el entorno de producci√≥n.  Esto le permite cambiar r√°pidamente entre sucursales al entregar nuevas versiones.  A menudo, despu√©s del despliegue, pueden ocurrir cambios cardinales que no se notan de inmediato.  Sin embargo, es posible que no se observe degradaci√≥n en el rendimiento y la disponibilidad.  Para responder r√°pidamente a dichos cambios, es mejor usar varias m√©tricas que reflejen el comportamiento del usuario (n√∫mero de sesiones y acciones del usuario, conversi√≥n, porcentaje de rebote).  La siguiente figura muestra un ejemplo en el que cuando cae la conversi√≥n, se produce el cambio entre las ramas de software. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f9c/db2/776/f9cdb27767029d743a6f7b51a31fc87b.png"></div>  <i>Ca√≠da de conversi√≥n despu√©s de cambiar entre ramas de software.</i>  <i><a href="">Fuente</a></i> <br><br>  <b>Mecanismos autom√°ticos de determinaci√≥n de problemas</b> <br><br>  Al final dar√© un ejemplo m√°s, por lo que me gusta m√°s Dynatrace. <br><br>  En parte de mi historia sobre la automatizaci√≥n del control de calidad del ensamblaje en un entorno de prueba, determinamos todos los valores de umbral en modo manual.  Esto es normal para un entorno de prueba, el probador mismo determina los indicadores antes de cada prueba, dependiendo de la carga.  En el entorno de producci√≥n, es deseable que los problemas se detecten autom√°ticamente, teniendo en cuenta los diversos mecanismos de referencia. <br><br>  Dynatrace tiene interesantes herramientas integradas de inteligencia artificial que, basadas en los mecanismos para determinar m√©tricas an√≥malas (l√≠nea de base) y construir un mapa de interacci√≥n entre todos los componentes, comparar y correlacionar eventos entre s√≠, determinar anomal√≠as en el trabajo de su servicio y proporcionar informaci√≥n detallada sobre cada problema y causa ra√≠z. <br><br>  Al analizar autom√°ticamente las dependencias entre los componentes, Dynatrace determina no solo si el servicio problem√°tico es la causa principal, sino tambi√©n su dependencia de otros servicios.  En el siguiente ejemplo, Dynatrace monitorea y eval√∫a autom√°ticamente el estado de cada servicio como parte de una transacci√≥n, identifica el servicio de Golang como la raz√≥n principal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/afa/623/f52/afa623f525f3c5e2565fcc6382c173e3.png"></div>  <i>Un ejemplo de determinaci√≥n de la causa ra√≠z de una falla.</i>  <i><a href="">Fuente</a></i> <br><br>  La siguiente figura muestra el proceso de monitoreo de problemas con su aplicaci√≥n desde el inicio del incidente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fu/z_/rt/fuz_rt4omgppab3zkuxs4b-xfmm.gif"></div>  <i>Visualizaci√≥n de un problema emergente con la visualizaci√≥n de todos los componentes y eventos en ellos.</i> <br><br>  El sistema de monitoreo ha compilado una cronolog√≠a completa de eventos sobre el problema.  En la ventana debajo de la l√≠nea de tiempo, vemos todos los eventos clave en cada uno de los componentes.  En funci√≥n de estos eventos, puede especificar procedimientos para la correcci√≥n autom√°tica en forma de scripts de c√≥digo. <br><br>  Adem√°s, le aconsejo que integre el sistema de monitoreo con Service Desk o un rastreador de errores.  Si se produce un problema, los desarrolladores reciben r√°pidamente informaci√≥n completa para su an√°lisis a nivel de c√≥digo en el entorno de producci√≥n. <br><br><h1>  Conclusi√≥n </h1><br>  Como resultado, terminamos con un transportador CI / CD con controles de calidad de software automatizados integrados en Pipeline.  Minimizamos la cantidad de ensamblajes de baja calidad, aumentamos la confiabilidad del sistema en su conjunto y, si a√∫n interrumpimos el rendimiento del sistema, lanzamos mecanismos para restaurarlo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e3/1c3/ae2/9e31c3ae24cc9f07a4771167ad2043d3.png"></div><br>  Definitivamente vale la pena el esfuerzo para automatizar el monitoreo de la calidad del software, no siempre es un proceso r√°pido, pero con el tiempo dar√° sus frutos.  Recomiendo que despu√©s de resolver un nuevo incidente en el entorno de producci√≥n, piense inmediatamente qu√© monitores agregar para las comprobaciones en el entorno de prueba a fin de evitar una compilaci√≥n incorrecta en la producci√≥n, y tambi√©n cree un script para solucionar autom√°ticamente estos problemas. <br><br>  Espero que mis ejemplos te ayuden en tus esfuerzos.  Tambi√©n ser√° interesante para m√≠ ver sus ejemplos de m√©tricas usadas para la implementaci√≥n de sistemas de autocuraci√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bea/ccc/1c5/beaccc1c5f2fb65ac9cf91e6dda3bbd5.jpg"></div>  <i><a href="">Fuente</a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451630/">https://habr.com/ru/post/451630/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451620/index.html">Autorizaci√≥n autom√°tica en la tarjeta Strava Heatmap</a></li>
<li><a href="../451622/index.html">Sobre el conteo de bits, los tipos sin signo en Kotlin y sobre situaciones en las que se justifica guardar en las coincidencias</a></li>
<li><a href="../451624/index.html">Sobre c√≥mo Harry Potter da forma a la educaci√≥n rusa, por supuesto, no donde la necesitas</a></li>
<li><a href="../451626/index.html">Aprender sin profesor: un alumno curioso</a></li>
<li><a href="../451628/index.html">Revisi√≥n de la Expo 3D en abril de 2019</a></li>
<li><a href="../451634/index.html">C√≥mo somos analizados en tiendas y restaurantes.</a></li>
<li><a href="../451636/index.html">Cinco a√±os de esclavitud</a></li>
<li><a href="../451638/index.html">Animaci√≥n en aplicaciones m√≥viles: prueba de Lottie</a></li>
<li><a href="../451640/index.html">Juego de tronos: creaci√≥n de infograf√≠as sobre asesinatos, sexo, viajes de Poniente y m√°s</a></li>
<li><a href="../451642/index.html">Encontrar un camino entre obst√°culos redondos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>