<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ üå•Ô∏è üë®üèø‚Äç‚öñÔ∏è Tom Hunter Tagebuch: Der Hund der Baskervilles üë®üèΩ‚Äçüîß üèÆ üõ¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Verz√∂gerungen bei der Unterzeichnung sind f√ºr jedes gro√üe Unternehmen √ºblich. Eine Ausnahme war keine Vereinbarung zwischen Tom Hunter und einer Onlin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tom Hunter Tagebuch: Der Hund der Baskervilles</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tomhunter/blog/467199/">  Verz√∂gerungen bei der Unterzeichnung sind f√ºr jedes gro√üe Unternehmen √ºblich.  Eine Ausnahme war keine Vereinbarung zwischen Tom Hunter und einer Online-Zoohandlung √ºber ein gr√ºndliches Pentesting.  Es war notwendig, sowohl die Site als auch das interne Netzwerk zu √ºberpr√ºfen und sogar Wi-Fi zu funktionieren. <br><br>  Es ist nicht √ºberraschend, dass die H√§nde gek√§mmt wurden, bevor alle Formalit√§ten erledigt waren.  Scannen Sie die Website nur f√ºr den Fall, dass es unwahrscheinlich ist, dass ein so bekanntes Gesch√§ft wie der "Baskervilov Dog" hier Fehler macht.  Nach ein paar Tagen lieferte Tom dennoch das unterschriebene Original des Vertrags - zu diesem Zeitpunkt bewertete Tom vom internen CMS hinter der dritten Tasse Kaffee den Zustand der Lager mit Interesse ... <br><br><img src="https://habrastorage.org/webt/y0/bf/ef/y0bfefcwg_2j0dk3qexegw3isxg.jpeg">  <i>Quelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ehsan Taebloo</a></i> <br><a name="habracut"></a><br>  Insbesondere in CMS war dies jedoch nicht m√∂glich - die Site-Administratoren haben die IP von Tom Hunter verboten.  Obwohl man es schaffen k√∂nnte, Boni auf der Karte des Gesch√§fts zu generieren und die geliebte Katze monatelang billig zu f√ºttern ... "Nicht dieses Mal, Darth Sidious", dachte Tom mit einem L√§cheln.  Es w√ºrde nicht weniger Spa√ü machen, von der Website-Zone zum lokalen Netzwerk des Kunden zu wechseln, aber anscheinend sind diese Segmente nicht mit dem Kunden verbunden.  Dies kommt jedoch in sehr gro√üen Unternehmen h√§ufiger vor. <br><br>  Nach allen Formalit√§ten bewaffnete sich Tom Hunter mit dem bereitgestellten VPN-Konto und ging zum lokalen Netzwerk des Kunden.  Das Konto befand sich in der Active Directory-Dom√§ne, sodass es m√∂glich war, AD ohne Tricks zu sichern, um alle √∂ffentlichen Informationen √ºber Benutzer und Arbeitsmaschinen zusammenzuf√ºhren. <br><br>  Tom startete das Dienstprogramm adfind und begann, LDAP-Anforderungen an den Dom√§nencontroller zu senden.  Mit einem Filter nach Klasse objectategory, der eine Person als Attribut angibt.  Die Antwort kam hier mit dieser Struktur zur√ºck: <br><br><pre><code class="plaintext hljs">dn:CN=,CN=Users,DC=domain,DC=local &gt;objectClass: top &gt;objectClass: person &gt;objectClass: organizationalPerson &gt;objectClass: user &gt;cn:  &gt;description:           &gt;distinguishedName: CN=,CN=Users,DC=domain,DC=local &gt;instanceType: 4 &gt;whenCreated: 20120228104456.0Z &gt;whenChanged: 20120228104456.0Z</code> </pre> <br>  Dar√ºber hinaus gab es noch viele n√ºtzliche Informationen, aber die interessantesten waren im Feld&gt; Beschreibung:&gt; Beschreibung.  Dieser Kontokommentar ist im Prinzip ein geeigneter Ort zum Speichern kleinerer Notizen.  Die Administratoren des Kunden waren jedoch der Ansicht, dass Passw√∂rter auch hier ruhig ruhen k√∂nnen.  Wer k√∂nnte sich schlie√ülich f√ºr all diese kleinen Serviceaufzeichnungen interessieren?  Daher sahen die Kommentare, die Tom erhielt, folgenderma√üen aus: <br><br><pre> <code class="plaintext hljs"> , 2018.11.16 7po!*Vqn</code> </pre> <br>  Sie m√ºssen nicht sieben Felder in der Stirn haben, um zu verstehen, warum die Kombination am Ende n√ºtzlich ist.  Es blieb eine gro√üe Antwortdatei von der CD durch das Feld&gt; Beschreibung zu analysieren: und hier sind sie - 20 Login-Passwort-Paare.  Und fast die H√§lfte hat RDP-Zugriffsrechte.  Guter Halt, Zeit, die angreifenden Kr√§fte aufzuteilen. <br><br><h2>  Netzwerkumgebung </h2><br>  Die zug√§nglichen Baskerville Dogs-B√§lle √§hnelten in all ihrem Chaos und ihrer Unvorhersehbarkeit einer Gro√üstadt.  Mit Benutzer- und RDP-Profilen war Tom Hunter ein armer Junge in dieser Stadt, aber selbst er schaffte es, viele Dinge durch die leuchtenden Fenster der Sicherheitsrichtlinien zu betrachten. <br><br>  Teile von Dateiservern, Abrechnungskonten und sogar damit verbundenen Skripten - all dies wurde gemeinsam genutzt.  In den Einstellungen eines dieser Skripte fand Tom den MS SQL-Hash eines Benutzers.  Ein bisschen Brute-Force-Magie - und der Hash des Benutzers wurde zu einem Klartext-Passwort.  Vielen Dank an John The Ripper und Hashcat. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/475/884/6c0/4758846c0301c7914bc41c33ad92efba.png"><br><br>  Dieser Schl√ºssel sollte zu einer Truhe gekommen sein.  Die Truhe wurde gefunden und au√üerdem wurden zehn weitere ‚ÄûTruhen‚Äú damit verbunden.  Und innerhalb von sechs lag ... Superuser-Rechte, keine Autorit√§t \ System!  Bei zwei gelang es mir, die gespeicherte Prozedur xp_cmdshell auszuf√ºhren und cmd-Befehle an Windows zu senden.  Was willst du mehr? <br><br><h2>  Dom√§nencontroller </h2><br>  Tom Hunter hat den zweiten Schlag f√ºr Domain-Controller vorbereitet.  Entsprechend der Anzahl der geografisch entfernten Server befanden sich drei von ihnen im Baskerville Dogs-Netzwerk.  Jeder Dom√§nencontroller verf√ºgt √ºber einen √∂ffentlichen Ordner, wie eine offene Storefront in einem Store, neben dem derselbe verarmte Junge Tom herumh√§ngt. <br><br>  Und diesmal hatte der Typ wieder Gl√ºck - er verga√ü, das Skript aus dem Fenster zu entfernen, in dem das Passwort des lokalen Serveradministrators fest codiert war.  Der Pfad zum Dom√§nencontroller war also offen.  Komm rein, Tom! <br><br>  Hier wurde ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mimikatz</a> aus dem magischen Hut extrahiert, der von mehreren Domain-Administratoren profitabel war.  Tom Hunter bekam Zugang zu allen Maschinen im lokalen Netzwerk, und ein teuflisches Lachen erschreckte die Katze von einem nahe gelegenen Stuhl aus.  Dieser Weg war k√ºrzer als erwartet. <br><br><h2>  Ewiges Blau </h2><br>  Die Erinnerung an WannaCry und Petya ist in den K√∂pfen der Pentester noch lebendig, aber einige Admins scheinen Kryptographen im Strom anderer Abendnachrichten vergessen zu haben.  Tom entdeckte drei Knoten mit einer Sicherheitsanf√§lligkeit im SMB-Protokoll - CVE-2017-0144 oder EternalBlue.  Dies ist dieselbe Sicherheitsanf√§lligkeit mit Hilfe der WannaCry- und Petya-Ransomware, einer Sicherheitsanf√§lligkeit, mit der beliebiger Code auf einem Host ausgef√ºhrt werden kann.  An einem der anf√§lligen Knoten gab es eine Dom√§nenadministrationssitzung - "Exploit and Get".  Was k√∂nnen Sie tun, die Zeit hat nicht alle gelehrt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/090/a04/c4d/090a04c4d07cd5a393972031e33776b3.png"><br><br><h2>  Der Basterville Hund </h2><br>  Klassiker der Informationssicherheit wiederholen gerne, dass der schw√§chste Punkt eines Systems eine Person ist.  Beachten Sie, dass der Titel oben nicht mit dem Gesch√§ftsnamen √ºbereinstimmt.  Vielleicht ist nicht jeder so vorsichtig. <br><br>  In der besten Tradition der Phishing-Blockbuster hat Tom Hunter eine Domain registriert, die sich von der Baskerville Dogs-Domain unterscheidet.  Die Postanschrift in dieser Domain simulierte die Adresse des Informationssicherheitsdienstes des Gesch√§fts.  Innerhalb von 4 Tagen von 16:00 bis 17:00 Uhr wurde eine solche Nachricht gleichm√§√üig von einer gef√§lschten Adresse an 360 Adressen gesendet: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/135/744/e45/135744e454ee0075f4745eee7906fdbc.png"><br><br>  Vielleicht rettete nur ihre eigene Faulheit die Mitarbeiter vor dem Massen-Dumping von Passw√∂rtern.  Von den 360 Briefen wurden nur 61 ge√∂ffnet - der Sicherheitsdienst ist nicht sehr beliebt.  Aber dann war es einfacher. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54a/d2f/c25/54ad2fc254381272cac2dcaefb743cf1.png"><br>  <i>Phishing-Seite</i> <br><br>  46 Personen klickten auf den Link und fast die H√§lfte - 21 Mitarbeiter - schauten nicht in die Adressleiste und gaben ruhig ihre Benutzernamen und Passw√∂rter ein.  Guter Fang, Tom. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ef/c17/e88/3efc17e88dd9a32689c7f6a679118f43.jpg"><br><br><h2>  Wi-Fi-Netzwerk </h2><br>  Jetzt musste ich nicht mehr auf die Hilfe einer Katze z√§hlen.  Tom Hunter warf ein paar Eisenst√ºcke in seine alte Limousine und ging zum B√ºro von Baskerville Dogs.  Sein Besuch wurde nicht vereinbart: Tom wollte das WLAN des Kunden testen.  Auf dem Parkplatz des Business Centers gab es mehrere freie Pl√§tze, die erfolgreich in den Umkreis des Zielnetzwerks gelangten.  Anscheinend haben sie nicht besonders √ºber die Einschr√§nkung nachgedacht - als ob Administratoren als Reaktion auf Beschwerden √ºber schwaches WLAN zuf√§llig zus√§tzliche Punkte gesetzt h√§tten. <br><br>  Wie funktioniert der WPA / WPA2 PSK-Schutz?  Die Verschl√ºsselung zwischen dem Zugriffspunkt und den Clients bietet einen Schl√ºssel vor der Sitzung - Pairwise Transient Key (PTK).  PTK verwendet den Pre-Shared Key und f√ºnf weitere Parameter: SSID, Authenticator Nounce (ANounce), Supplicant Nounce (SNounce), MAC-Adressen des Access Points und des Clients.  Tom hat alle f√ºnf Parameter abgefangen, und jetzt fehlte nur noch der Pre-Shared Key. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/793/240/7a8/7932407a8089981039a332bfb1d97bf6.png"><br><br>  Das Hashcat-Dienstprogramm hat dieses fehlende Glied in etwa 50 Minuten erhalten - und unser Held befand sich in einem Gastnetzwerk.  In der Nachbarschaft konnte man das Unternehmensarbeitsnetzwerk sehen - seltsamerweise verwaltete Tom hier das Passwort f√ºr etwa neun Minuten.  Und das alles ohne den Parkplatz zu verlassen, ohne VPN.  Das Arbeitsnetzwerk √∂ffnete unseren Helden Freir√§ume f√ºr monstr√∂se Aktivit√§ten, aber er ... warf keine Boni auf die Visitenkarte. <br><br>  <i>Tom blieb stehen, sah auf die Uhr, warf ein paar Banknoten auf den Tisch und verlie√ü das Caf√©, um sich zu verabschieden.</i>  <i>Vielleicht wieder ein Pentest, oder vielleicht habe ich mir einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Telegrammkanal</a> ausgedacht ...</i> <i><br></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467199/">https://habr.com/ru/post/de467199/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467187/index.html">Erstellen Sie die neueste Technologiebibliothek</a></li>
<li><a href="../de467189/index.html">Temperaturmessung</a></li>
<li><a href="../de467191/index.html">Wie wir Vivaldi f√ºr Android gemacht haben</a></li>
<li><a href="../de467193/index.html">Bergmannsvirus mit "Heaven's Gate"</a></li>
<li><a href="../de467197/index.html">Wie Polymorphismus in der JVM implementiert wird</a></li>
<li><a href="../de467201/index.html">CacheBrowser-Experiment: Umgehen einer chinesischen Firewall ohne Proxy mithilfe von Content-Caching</a></li>
<li><a href="../de467203/index.html">Nur Teilung oder wie man eine mathematische Theorie erstellt und 400.000 Dollar damit verdient. Serie zwei, vorletzte</a></li>
<li><a href="../de467205/index.html">Wir entwickeln eine Anwendung, die Daten an andere Anwendungen sendet (√ñkosystemanwendung)</a></li>
<li><a href="../de467207/index.html">F√ºnf vielversprechende Programmiersprachen mit einer gl√§nzenden Zukunft (3 Jahre sp√§ter)</a></li>
<li><a href="../de467209/index.html">"Autonome Agenten" oder Code in der offenen Kryptoplattform Obyte ausf√ºhren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>