<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš£ğŸ» ğŸ¤¤ ğŸ’¯ Stasiun kerja kriptografis berdasarkan token PKCS # 11. Memperoleh sertifikat untuk EGAIS. Bagian 4 ğŸ’˜ ğŸšµğŸ¿ â¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dan sekarang, ketika saya hampir menambahkan generasi sertifikat yang ditandatangani sendiri ke workstation kriptografi berdasarkan token cryptoarmpkc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Stasiun kerja kriptografis berdasarkan token PKCS # 11. Memperoleh sertifikat untuk EGAIS. Bagian 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464017/"><img src="https://habrastorage.org/webt/wp/sl/w1/wpslw1m_c55qfxj1sifpmgmge20.png" align="left">  Dan sekarang, ketika saya hampir menambahkan generasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sertifikat yang ditandatangani sendiri</a> ke workstation kriptografi berdasarkan token cryptoarmpkcs PKCS # 11 dan siap untuk mulai menulis artikel, saya menerima surat seperti ini: <blockquote> Kami adalah UZNIREK CA, kami mengalami kesulitan mengeluarkan ES dalam format pkcs # 11 untuk EGAIS, portal tidak memahami ES dalam format CSP Znamerek, kami meminta Anda untuk membantu dalam masalah ini. </blockquote>  Saya tidak tahu semua seluk-beluk bekerja dengan EGAIS, tetapi karena ini tentang PKCS # 11, saya menyarankan menggunakan utilitas cryptoarmpkcs untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menghasilkan permintaan</a> dan menginstal sertifikat untuk token setelah menerimanya dari CA  Jawaban yang saya terima agak mengganggu: <a name="habracut"></a><br><blockquote>  Sayangnya, kenyataannya adalah bahwa kami mencatat ES pada RuToken 2.0 melalui CryptoPro CSP, tetapi dengan semua pengaturan yang tepat, portal EGAIS tidak melihat ES pada media utama, klien menghubungi kami untuk mendukung dan kami menemukan bahwa masalahnya bukan sertifikat kunci ditulis dalam format itu, di sini adalah manual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dev.rutoken.ru/display/KB/RU1051</a> </blockquote>  . <br>  Saya (dan bukan hanya saya) sudah menulis berkali-kali bahwa banyak menggunakan token kriptografi dengan dukungan kriptografi Rusia sebagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">flash drive biasa</a> .  Dan ini hanya terjadi ketika kunci dan sertifikat tidak sampai ke token sebagai objek PKCS # 11.  Sayang sekali mereka tidak menerima saran dan bahkan tidak mencoba membuat permintaan.  Tapi kemudian saya memutuskan untuk mengesampingkan semuanya dan mencari tahu bagaimana dan pada sertifikat apa EGAIS Rosalkogolregulirovanie dikeluarkan.  Dan kami hanya akan mempertimbangkan token kriptografi PKCS # 11.  Kekecewaan terbesar adalah akses ke EGAIS hanya melalui Windows dan browser IE.  Di sisi lain, pembuatan permintaan sertifikat dan pemasangan sertifikat juga dapat dilakukan di bawah OS apa pun, jika memiliki driver / pustaka untuk token yang sesuai. <br><br>  Setidaknya PKCS # 11 token JaCarta, RutokenECP-2.0, token perangkat lunak LS11SW2016 dan bahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">token cloud</a> memiliki dukungan pada MS Windows, Linux, dan OS X. Dan tidak hanya pada OS ini. <br><br>  Bahkan, kita harus membayar upeti kepada pengembang EGAIS.  Mereka mengusulkan teknologi menarik yang memungkinkan akses untuk menggunakan sertifikat pribadi (sertifikat plus pasangan kunci) yang disimpan pada token kriptografi dengan dukungan untuk kriptografi Rusia, dan melindungi saluran pada sertifikat RSA.  Meskipun jika mereka mengatakan A, maka orang bisa mengatakan B, yaitu  melindungi saluran pada algoritma GOST-ov.  Satu-satunya hal yang menyedihkan adalah bahwa semua ini hanya dirancang untuk MS Windows (atau saya salah?), Atau lebih tepatnya, untuk Internet Explorer.  Dan utilitas untuk menghasilkan permintaan sertifikat untuk EGAIS terikat dengan token tertentu. <br><br>  Tetapi utilitas cryptoarmpkcs adalah multi-platform.  Selain itu, ia dapat bekerja dengan token kriptografi PKCS # 11 apa pun yang mendukung kriptografi Rusia. <br><br>  Jadi, apa keanehan dari permintaan sertifikat untuk EGAIS?  Fitur utama adalah kehadiran wajib dalam nama dibedakan dari pemegang sertifikat (subjek DN) dari bidang tambahan unstucturedName (UN) (oid - 1.2.840.113549.1.9.2).  Jika pemilik sertifikat adalah pengusaha perorangan, maka baris â€œKPP =â€ ditulis di bidang ini, dan jika pemiliknya adalah badan hukum, maka baris ini ditulis di bidang ini: <br>  PPC = reason_code_of_tax_account_account: <br><br><img src="https://habrastorage.org/webt/p5/ta/ik/p5taik-xzifzowoorpxbgrko-tu.png"><br><br>  Dalam hal ini, persyaratan pada halaman pertama tab permintaan sertifikat telah ditambahkan tombol EGAIS: <br><br><img src="https://habrastorage.org/webt/lu/3y/pe/lu3ypehfo1drl5bffwfzu7bkngc.png"><br><br>  Fitur lain adalah bahwa pemegang sertifikat untuk EGAIS dapat menjadi pemegang lisensi sistem deklarasi FSRAP (oid - 1.2.643.3.6.78.4.4).  Ini juga perlu dipertimbangkan saat membuat permintaan: <br><br><img src="https://habrastorage.org/webt/vs/zr/so/vszrso3twrpryl_cudxmggdw2ke.png"><br><br>  Setelah semua bidang permintaan sertifikat selesai dan Anda telah mengkonfirmasi kebenaran data, pasangan kunci akan dibuat dan permintaan akan dibuat: <br><br><img src="https://habrastorage.org/webt/rk/o3/to/rko3to_iuk4iaeq6aqjoxp-uf1o.png"><br><br>  Jika Anda melihat permintaan, maka di dalamnya Anda dapat melihat oid-s (Penggunaan Kunci yang Diperpanjang), yang diperlukan untuk EGAIS Rosalkogolregulirovanie: <br><br><img src="https://habrastorage.org/webt/g4/m-/mh/g4m-mh0xck7omdvymsuyalu_wfi.png"><br><br>  Di sini Anda harus memperhatikan (pada tangkapan layar sebelumnya) untuk label pasangan kunci.  Dalam terminologi PKCS # 11, ini adalah atribut CKA_LABEL untuk kunci publik dan pribadi.  Dengan skema seperti itulah label (nama kunci) dibuat oleh pembuat kueri EGAIS untuk JaCarta dari CenterInform FSUE: <br><br><img src="https://habrastorage.org/webt/zv/bl/dg/zvbldgbgw9kmcphcz-nzq68pzqa.png"><br><br>  Secara tradisional rangkap tiga <b>sertifikat x public_key x kunci pribadi</b> <b><br></b>  pada token terhubung melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">atribut CKA_ID</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><br></a>  : <br><blockquote>  Cara paling umum untuk menentukan CKA_ID adalah dengan menggunakan nilai fungsi hash dari nilai kunci publik.  Ini adalah metode yang digunakan untuk menghubungkan triple objek dalam proyek NSS (Layanan Keamanan Jaringan).  Pada saat yang sama, algoritma SHA1 digunakan sebagai fungsi hash. </blockquote>  Sayangnya, baik CKA_LABEL dan CKA_ID dapat disetel / diubah kapan saja dengan nilai apa pun.  Dengan demikian, selalu ada kemungkinan bahwa sertifikat akan dikaitkan dengan kunci pribadi orang lain.  Tidak perlu menjelaskan apa akibatnya nanti. <br><br>  Secara umum, apakah ada algoritma matematika ketat yang memungkinkan Anda untuk menghubungkan triple CKO_CERTIFICATE x CKO_PRIVATE_KEY x CKO_PUBLIC_KEY menjadi satu kesatuan? <br>  Ya, algoritma seperti itu yang didasarkan pada mekanisme kriptografi (CKM_) dari token <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ada</a> . <br><br>  Sayangnya (meskipun dapat dipahami secara objektif), ia menganggap banyak dalam tiga hingga CKA_LABEL, yang dibentuk oleh metode yang disebutkan di atas.  Selain itu, untuk kunci privat dan publik, SKA_ID dibentuk dengan cara yang serupa.  Untuk kunci, ini hanya bencana, karena  namun CKA_ID maupun CKA_LABEL tidak terikat dengan kunci apa pun.  Ini juga berlaku untuk sertifikat setelah diinstal pada token.  Jika dalam formasi tradisional CKA_ID sebagai hash dari kunci publik, Anda selalu dapat memeriksa apakah satu cocok dengan yang lain, maka ketika mengatur CKA_ID dan CKA_LABEL dengan cara yang dijelaskan di atas, ini tidak dapat dilakukan. <br><br>  Sebuah pertanyaan mungkin muncul, tetapi bagaimana memeriksa kepatuhan terhadap kunci pribadi?  Jawabannya sederhana - dengan menghitung nilai kunci publik terhadap kunci pribadi.  Adapun sertifikat, nilai kunci publiknya, secara alami, ada di dalamnya.  Selain itu, sertifikat itu sendiri berisi nilai CKA_ID untuk pemegang sertifikat (Pengidentifikasi Kunci Subjek Sertifikat) dan penerbit sertifikat (Pengidentifikasi Kunci Otoritas Sertifikat): <br><br><img src="https://habrastorage.org/webt/og/vx/9e/ogvx9esfdvq1vlfcy436vkwvqkm.png"><br><br>  Hal yang paling tidak menyenangkan adalah ketika memasang sertifikat, bukan keberadaan kunci pribadi yang diperiksa, tetapi hanya kunci publik yang memadai.  Dalam hal ini, sertifikat akan diinstal, tetapi tidak akan ada kunci pribadi di dalamnya.  Masalah lain.  Ini adalah pencarian kunci publik oleh TIN.  Bayangkan seseorang memiliki satu TIN dan beberapa kunci untuk berbagai sertifikat.  Milik siapa?  Setelah itu, menjadi jelas persyaratan bagi JaCarta untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hanya</a> memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">satu sertifikat</a> dan satu pasangan kunci: <br><blockquote>  Kesalahan ini mungkin terkait dengan duplikasi sertifikat.  Dalam JaCarta Single Client dalam mode administrator, pada tab GOST Setelah memasukkan kode PIN, satu publik, satu kunci pribadi dan sertifikat akan terlihat.  Dalam hal ini, duplikasi kunci terlihat.  Anda harus menghapus yang ekstra.  Masukkan kembali media ke dalam konektor usb dan coba pasang kembali UTM.  Jika kesalahan berlanjut, inisialisasi Jacarta sesuai dengan tautan 1 dan lanjutkan proses pembuatan lagi. </blockquote>  Semoga saja kekurangan ini bisa dihilangkan.  Anda dapat bertanya bagaimana utilitas cryptoarmpkcs untuk EGAIS menginstal sertifikat.  Untuk kompatibilitas penuh untuk JaCarta, kami telah mempertahankan ideologi bahwa CKA_ID dan CKA_LABEL untuk kunci adalah sama.  Tetapi hanya setelah menginstal sertifikat pada token dan mengikatnya pada pasangan kunci.  Hingga saat itu, pasangan kunci CKA_ID dijaga sama dengan nilai hash dari kunci publik. <br>  Setelah menginstal sertifikat, Anda dapat menggunakannya untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menandatangani dokumen</a> . <br><br>  Anda dapat membaca tentang sertifikat yang ditandatangani sendiri di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> : <br><br><img src="https://habrastorage.org/webt/df/ir/yw/dfirywymvzgoqq5u46qa4th6tcw.png" alt="gambar"><br><br><div class="spoiler">  <b class="spoiler_title">Distribusi berada di tempat yang sama.</b> <div class="spoiler_text"><ul><li>  <a href="">Linux32</a> </li><li>  <a href="">Linux64</a> </li><li>  <a href="">OS X</a> </li><li>  <a href="">WIN32</a> </li><li>  <a href="">WIN64</a> </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464017/">https://habr.com/ru/post/id464017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464003/index.html">Router 4G sebagai server universal untuk IoT</a></li>
<li><a href="../id464007/index.html">Bagaimana saya membuat model prediksi call center sehingga panggilan mereka tidak membuat marah pengguna</a></li>
<li><a href="../id464011/index.html">Bagaimana saya meninggalkan IT dalam psikologi</a></li>
<li><a href="../id464013/index.html">FAQ HeadHunter API (Job Post)</a></li>
<li><a href="../id464015/index.html">Instal OpenCV + CUDA di Windows</a></li>
<li><a href="../id464019/index.html">Sumber terbuka: pengembang kartu grafis mengungkapkan dokumentasi driver untuk Linux</a></li>
<li><a href="../id464021/index.html">Apa itu fitur toggle atau cara menyingkirkan walrus yang menyiksa dan cabang yang berumur panjang?</a></li>
<li><a href="../id464023/index.html">"Dasar-dasar pemrograman" diatur untuk kursus gratis dengan contoh dalam JavaScript</a></li>
<li><a href="../id464027/index.html">Bagaimana cara bertahan konten di era ledakan informasi</a></li>
<li><a href="../id464031/index.html">â€œFinds of an Audiomaniacâ€: kartu suara sebagai cara untuk terjun ke atmosfer kota yang tidak dikenal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>