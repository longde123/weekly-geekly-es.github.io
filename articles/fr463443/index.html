<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎓 📴 👩🏻‍⚕️ JMeter - Swiss Tester Knife (Partie 2) 🦔 🌎 🛄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, je vais vous dire comment, avec l'aide de JMeter, nous avons mis en place le processus de mise en cache des pages produits, testé le fonc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JMeter - Swiss Tester Knife (Partie 2)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463443/">  Aujourd'hui, je vais vous dire comment, avec l'aide de JMeter, nous avons mis en place le processus de mise en cache des pages produits, testé le fonctionnement d'une application mobile sans l'application elle-même et créé 2000 utilisateurs dans le système sans accès à la base de données. <br><br>  Quiconque ne sait pas ce qui se passe ici, lisez la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">première partie de l'article</a> - j'y ai expliqué comment JMeter nous a aidés à «résoudre» le problème de la chute du site chez certains utilisateurs. <br><a name="habracut"></a><br><h2>  Comment mettre en cache rapidement quelques milliers de pages de produits </h2><br>  Notre autre client est une entreprise italienne fabriquant des équipements pour l'éclairage intérieur, extérieur et décoratif. <br><br><img src="https://habrastorage.org/webt/xx/q1/q9/xxq1q96rdlara9p8zag2ig_h2lu.png" alt="Capture d'écran de l'application iPad"><br>  <font color="#999999"><i>L'équipement de nos clients illumine les chefs-d'œuvre de la peinture du monde, les monuments architecturaux, les monuments, les bâtiments des centres d'affaires et les aéroports</i></font> <br><br>  Nous avons développé le site de cette entreprise sur Kentico.  Il présente tous les matériaux et modèles d'équipement d'éclairage - 20 000 exemplaires.  Et chacun a une page distincte. <br><br>  Après la sortie du site, nous avons découvert une caractéristique désagréable de Kentico: il n'a pas d'outil pour charger automatiquement les fichiers multimédias dans le cache.  Après la mise à jour et le redémarrage du site (ce qui se produit régulièrement), le cache est réinitialisé et la plupart des pages s'ouvrent pendant 10 secondes.  Tous les utilisateurs ne sont pas prêts à attendre autant. <br><br>  Nous avons vu deux options pour charger des fichiers multimédias dans le cache.  Premièrement: il faut beaucoup de temps pour parcourir manuellement le site via un navigateur.  Deuxièmement: pour écrire un script qui fera cela pour nous - ça va! <br><br>  Nous avons décidé d'utiliser JMeter: nous venons de lui fournir le plan du site complet, il a marché dessus et envoyé les fichiers multimédias au cache. <br><br>  C'était une solution simple, mais pas très optimale.  Il a fallu six (!!!) heures pour terminer le script.  Un moyen plus rapide était nécessaire. <br><br>  Après avoir étudié un peu le sujet, nous avons décidé d'utiliser des expressions rationnelles.  JMeter est en mesure de demander au serveur des ressources intégrées dans la page pour certains masques.  C'est ce dont nous avons profité.  Après avoir éliminé ce qui ne se trouve pas sur notre serveur et ne nécessite pas de chargement dans le cache (images tierces, polices, styles, etc.), nous avons réduit le temps nécessaire au script pour parcourir les pages à deux heures. <br><img src="https://habrastorage.org/webt/df/25/0e/df250egkgmk3uozctdqxm77q6xm.png"><br>  <font color="#999999"><i>Cela devrait ressembler à une requête HTTP dans JMeter pour charger uniquement un certain type d'actif</i></font> <br><br>  Mais c'est trop long: le remplissage commence à 9h00 à Tcheliabinsk et prend une heure, puis deux autres heures sont consacrées au script, en conséquence, nous terminerons à 12h00.  En Italie, il est 08h00, et certains habitants commencent déjà à travailler à 6h-7h du matin.  Le site est lent, les plaintes affluent ... Il faut encore optimiser! <br><br>  La décision est venue lorsque nous avons réalisé que presque les mêmes images étaient utilisées sur les 20 000 pages de produits.  Nous avons effectué une analyse et réalisé qu'il suffit de charger complètement (avec toutes les ressources intégrées) seulement 30% des pages aléatoires, et le reste peut être exécuté sans charger de fichiers multimédias.  Ainsi, la grande majorité des matériaux - images, polices, scripts et styles pour les pages de produits - tombent dans le cache.  Lorsqu'un utilisateur contacte l'un d'entre eux, le téléchargement à partir du serveur ne nécessitera qu'une petite partie du contenu, et cela ne prendra pas plus de 1 à 2 secondes. <br><br><img src="https://habrastorage.org/webt/zm/ug/_o/zmug_ovryd349t3177cyuueac0m.png" alt="Nous randomisons le script JMeter en utilisant des paramètres"><br>  <font color="#999999"><i>En demandant un numéro de page aléatoire dans le tableau Variables définies par l'utilisateur, chaque fois que nous obtenons une page aléatoire dans la liste</i></font> <br><br>  En utilisant la méthode décrite, nous avons obtenu un site qui dans 90% des cas fonctionne rapidement.  Oui, dans un cas sur dix, il a fallu jusqu'à 30 secondes pour attendre le chargement de la page, mais dans les neuf autres, tout s'est envolé.  Et c'est en seulement 15-30 minutes. <br><br>  Maintenant, de telles astuces ne sont plus nécessaires - les développeurs ont optimisé le système de mise en cache lui-même.  Mais à cette époque, cette décision a été un véritable salut, et JMeter s'est avéré être un outil très utile, même après sa sortie et sa coulée. <br><br><h2>  Comment créer 2000 utilisateurs de l'application, si vous n'avez que leur e-mail et deux heures pour travailler </h2><br>  Le troisième client, dont je vais parler, est une entreprise qui développe, fabrique et vend du matériel médical: des scalpels simples aux découpeurs laser et aux forets complexes avec caméras intégrées.  Leurs gestionnaires se rendent dans les cliniques, communiquent avec les chirurgiens et leur parlent de leurs produits.  Pour ce faire, ils ont une application spéciale pour l'iPad: les données du médecin et une liste d'outils qui l'intéressent y sont entrées.  Plus tard, un lien vers une page personnelle avec une liste de tous ces outils, des descriptions détaillées et des caractéristiques est envoyé au courrier électronique du médecin.  Ce sont ces pages pour les chirurgiens que nous avons développées.  La demande et le bulletin électronique ont été créés par une autre société. <br><br>  L'une des tâches de JMeter sur ce projet est de tester le système pour créer différentes versions de ces pages, malgré le fait que nous n'avions qu'un backend.  Nous avons écrit un script pour que l'utilisation d'un générateur de nombres aléatoires crée des pages de différents types, puis les envoie à nos e-mails de travail pour vérification.  Tout est simple.  Et je ne mentionnerais même pas ce client dans l'article, sinon pour un cas. <br><br>  Quelques jours avant le lancement, mon manager m'a appelé et m'a demandé de créer 2000 utilisateurs pour l'application.  La difficulté était que nous n'avions accès ni au serveur en direct ni à la base de données.  Nous avons dû créer 2 000 utilisateurs uniquement via le CMS (dans ce cas, via Umbraco).  En même temps, après l'inscription, chaque utilisateur devrait recevoir une lettre d'environ le type suivant: <br><br><img src="https://habrastorage.org/webt/ae/gw/xx/aegwxxnxnhu_w0q34wz8nerttb0.png" alt="Lettre après inscription"><br>  <font color="#999999"><i>À la réception d'un tel e-mail, l'utilisateur installe l'application et change le mot de passe par défaut en son propre</i></font> <br><br>  Pour enregistrer un utilisateur, cinq champs sont obligatoires: <br><br><ul><li>  Courriel </li><li>  nom </li><li>  nom de famille; </li><li>  connexion; </li><li>  mot de passe </li></ul><br>  Je n'avais que deux heures pour terminer la tâche.  Encore une fois: 2000 utilisateurs, cinq champs pour chacun d'eux, deux heures ... Les données du manager se présentent sous la forme suivante: <br><br><img src="https://habrastorage.org/webt/bx/8s/_n/bx8s_nesrxxftxe1uty-wnsduty.png" alt="Pas le format de données le plus lisible, juste une liste d'e-mails sous forme de texte"><br><br>  Si j'étais un développeur, et non un spécialiste de l'assurance qualité, j'écrirais un script, par exemple, en perl: il analyserait ces données et disperserait rapidement tout.  Mais j'ai choisi un chemin différent et j'ai utilisé le plus, peut-être, l'outil idéal pour une organisation rapide des données - MS Excel.  Les feuilles de calcul sauvent le monde! <br><br>  À l'aide de manipulations simples pour remplacer les données, couper les excès et autres astuces, j'ai créé un fichier de ~ 10k lignes, de la forme: <br><br>  login1 |  john.smith <br>  login2 |  docteur.qui <br>  ... <br>  nom1 |  Jean <br>  ... <br><br>  Je ne me suis pas beaucoup soucié des mots de passe - je viens d'écrire PasswordNumber1 et «d'étendre» cette colonne dans Excel à tous les 2000 utilisateurs.  Cela n'a pas d'importance, car il n'a été utilisé que pour la première entrée.  Oui, et je n'ai pas trié la liste générale des e-mails par ordre alphabétique, ce qui signifie que la probabilité de deviner un mot de passe aléatoire a été minimisée. <br><br>  En alimentant ce fichier (via le presse-papiers) vers JMeter, je me suis penché en arrière sur ma chaise et j'ai regardé avec plaisir comment les utilisateurs ont été créés.  L'ensemble du processus de traitement des données et de création de nouveaux utilisateurs a pris 1 heure 45 minutes - même du temps pour le café! <br><br>  <b>Conclusion:</b> JMeter s'est avéré être un outil pratique pour les tests automatisés du backend des applications mobiles, et aussi, tout à coup, pour l'automatisation des tâches non standard - comme celle-ci, avec un tas d'utilisateurs et un minimum d'informations à leur sujet. <br><br>  En général, JMeter peut être utilisé (et a été utilisé par moi personnellement) pour une variété de tâches.  Par exemple, pour: <br><br><ul><li>  analyse d'optimisation: effectuer des tests de charge, corriger les corrections d'optimisation des rouleaux, effectuer à nouveau des tests, comparer les résultats; </li><li>  Test de sécurité des requêtes: écrire un script à l'aide d'un proxy, envoyer la requête directement au serveur sans vérification frontale, supprimer les différentes clés de la requête, vérifier que le serveur répond correctement; </li><li>  vérifier la réponse aux en-têtes: nous écrivons un script qui envoie des requêtes à la même page avec différents en-têtes en boucle, nous vérifions la réaction du serveur et voyons ce qui doit être supprimé; </li><li>  énumération des combinaisons d'autorisation: mettre un cycle avec des mots de passe dans un cycle avec des connexions, tester le formulaire d'autorisation; </li><li>  vérifie la protection contre les attaques: nous envoyons des demandes de soumission de formulaires dans plusieurs flux et voyons si votre protection fonctionne; </li><li>  automatisation des systèmes d'API: tous les résultats des demandes d'API peuvent être traités par un script et utilisés à l'étape suivante du cycle de test - de cette façon, vous pouvez automatiser les tests d'un tel système. </li></ul><br>  De ce qui précède, nous pouvons tirer une conclusion générale: JMeter est un outil universel, un véritable couteau suisse pour un testeur (et pour un développeur, pour être honnête). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463443/">https://habr.com/ru/post/fr463443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463433/index.html">Blog par e-mail: fonctionnalités de Gmail</a></li>
<li><a href="../fr463435/index.html">Présentation des services cloud pour développer un backend pour les applications mobiles</a></li>
<li><a href="../fr463437/index.html">Connectez un appareil mobile à la base de données sans écrire le code du serveur</a></li>
<li><a href="../fr463439/index.html">Ordinateur de contrôle embarqué Apollo: jauge et analyse technique de la mémoire sur plusieurs cœurs cousus</a></li>
<li><a href="../fr463441/index.html">Échantillonneur. Utilitaire de console pour visualiser le résultat des commandes shell</a></li>
<li><a href="../fr463445/index.html">9 types de solutions logicielles de collaboration pour la gestion d'équipes agiles</a></li>
<li><a href="../fr463447/index.html">Astra Linux 1.6 (Smolensk). Le système est-il prêt à fonctionner avec des utilisateurs ordinaires? Exemples de béquilles</a></li>
<li><a href="../fr463455/index.html">Des milliers de choses à corriger en Java à partir de la première version: une grande interview avec Sergey Kuksenko d'Oracle</a></li>
<li><a href="../fr463459/index.html">Erreurs cachées avec les transitions d'élément partagé</a></li>
<li><a href="../fr463461/index.html">Ce qui est et ce qui n'est pas dans Go. Partie 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>