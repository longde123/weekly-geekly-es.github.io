<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äçüé§ üëÜüèø ü§∑üèª R√°dio WiFi WOLNA. Como uma pequena startup foi criada üòó üôã üë®üèª‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° pouco tempo, coloquei em um tribunal p√∫blico um dispositivo de meu pr√≥prio projeto, desenvolvido no ano passado. Esta √© uma r√°dio na Internet usand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>R√°dio WiFi WOLNA. Como uma pequena startup foi criada</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403239/"> H√° pouco tempo, coloquei em um tribunal p√∫blico um dispositivo de meu pr√≥prio projeto, desenvolvido no ano passado.  Esta √© uma r√°dio na Internet usando wifi. <br><br><img src="https://habrastorage.org/files/f54/afe/69e/f54afe69e5d844a494f9a0dfec8604c4.png" alt="imagem"><br><br>  Prop√µe-se votar a favor ou contra pessoas em rublos em um dos sites de crowdfunding.  O dispositivo n√£o causou grande impacto, embora j√° existam patrocinadores.  Mas, desde ent√£o, houve muitas perguntas e solicita√ß√µes t√©cnicas para definir o circuito e o firmware.  Todos os interessados ‚Äã‚Äãem como o dispositivo nasceu e do que √© feito s√£o bem-vindos no gato. <br>  <i>Spoiler:</i> n√£o haver√° firmware. <br><a name="habracut"></a><br>  Ent√£o, tudo come√ßou com a necessidade de ter um r√°dio em casa na cozinha.  Obviamente, como desenvolvedor de eletr√¥nicos, imediatamente rejeitei a op√ß√£o de ir √† loja e comprar.  A prop√≥sito, por esse motivo, ainda n√£o tenho uma campainha normal. <br><br>  O r√°dio FM foi interrompido devido √† implementa√ß√£o chata.  E foi decidido fazer um r√°dio na Internet.  Olhando para o futuro, quero mostrar que esse receptor apareceu aqui. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiW4ZcnPw18" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <b>Sele√ß√£o de ferro</b> <br><br>  Primeiro, era necess√°rio escolher uma plataforma na qual voc√™ pudesse construir um r√°dio na Internet.  Existem muitas op√ß√µes, mas eu escolhi o que estava √† m√£o: <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Odroid W</a> + LCD <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">STM32F4DISCOVERY</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ESP8266</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VS1053B</a> <br><br>  Em um odroid, o processo de desenvolvimento levaria menos tempo, mas os contras, no meu caso particular (muitos discordam de mim), prevaleceram: <br><br>  - o processo de carregamento do sistema operacional leva algum tempo <br>  - Uma tend√™ncia crescente de infectar dispositivos IoT com v√≠rus <br>  - Eu tenho um fraco conhecimento de desenvolvimento Linux <br>  - pre√ßo <br><br>  No entanto, pedi a um amigo meu que escrevesse um softink para o Odroid W, que come√ßaria no in√≠cio do sistema e tocaria r√°dio na Internet.  Mas a incapacidade de editar corretamente o projeto sem empurrar um camarada enterrou essa op√ß√£o e me empurrou para a segunda. <br><br>  E montei o seguinte diagrama em uma t√°bua de p√£o: <br><br><img src="https://habrastorage.org/files/c09/207/c4d/c09207c4d0bb40d589c165e8493d4d7e.png" alt="imagem"><br><br>  <b>Como trabalhar com r√°dio na Internet</b> <br><br>  Depois disso, comecei a assistir como o r√°dio da Internet funciona.  Descobriu-se que a grande maioria das esta√ß√µes usa o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">icecast</a> para transmiss√£o.  Ele gira em algum lugar em um servidor com um IP fixo e aguarda uma conex√£o.  Como regra, na porta 8000 ou 8080.  Embora haja muitas exce√ß√µes.  Ap√≥s a conex√£o, voc√™ precisa enviar uma solicita√ß√£o desse tipo, substituindo o nome do fluxo e do servidor: <br><br><pre><code class="hljs powershell">GET /stream HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Icy<span class="hljs-literal"><span class="hljs-literal">-MetaData</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Mozilla/<span class="hljs-number"><span class="hljs-number">5.0</span></span> (X11; U; Linux i686; en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>; rv:<span class="hljs-number"><span class="hljs-number">1.6</span></span>) Gecko/<span class="hljs-number"><span class="hljs-number">20040413</span></span> Epiphany/<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Host: internetradioserver.ru Cache<span class="hljs-literal"><span class="hljs-literal">-Control</span></span>: no<span class="hljs-literal"><span class="hljs-literal">-cache</span></span></code> </pre> <br>  Em resposta, um fluxo <s>intermin√°vel de</s> mp3 come√ßa a cair, que j√° pode ser decodificado e reproduzido. <br><br>  A abertura de uma conex√£o TCP e outras alegrias de trabalhar com o ESP8266 s√£o feitas usando os comandos AT.  N√£o vou me debru√ßar sobre eles, as informa√ß√µes est√£o completas na Internet.  Tudo est√° muito bem pintado na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">comunidade de l√≠ngua russa esp8266</a> .  O procedimento para trabalhar com ele √© simples: <br><br>  1. Estamos aguardando uma conex√£o Wi-Fi, se ela n√£o estiver l√°, selecione uma rede, digite a senha. <br>  2. Abrimos a conex√£o TCP com o servidor da esta√ß√£o de r√°dio.  Endere√ßos de servidor, portas e nomes de fluxos s√£o armazenados diretamente na mem√≥ria flash do microcontrolador, mas mais sobre isso posteriormente. <br>  3. Envie a solicita√ß√£o GET acima. <br>  4. Recebemos em resposta um fluxo cont√≠nuo de mp3. <br>  5. Se voc√™ precisar trocar de esta√ß√£o, feche a conex√£o TCP e repita a partir da etapa 2. <br><br>  Vou falar um pouco sobre como as esta√ß√µes entram na mem√≥ria flash do microcontrolador.  Inicialmente, no est√°gio de verifica√ß√£o, simplesmente escrevi endere√ßos, n√∫meros de portas e nomes de fluxos em uma das p√°ginas de mem√≥ria do programa.  Mas com o tempo, quando os dispositivos se dispersaram entre parentes e amigos, tive que adicionar a capacidade de atualizar centralmente a lista.  Decidiu-se criar um servidor com um IP fixo, no qual um arquivo com uma lista de esta√ß√µes seria armazenado.  Quando conectado via TCP, o servidor aguarda uma senha e emite um arquivo, e o microcontrolador grava na sua mem√≥ria flash.  Desde que encontrei a cria√ß√£o de ‚Äúalgo na Internet‚Äù, fiquei agradavelmente surpreso ao alugar uma m√°quina virtual com um IP fixo que custa apenas 100 rublos por m√™s.  Milagres :) <br><br>  <b>Circuitry</b> <br><br>  Tendo jogado o suficiente com o STM32F4Discovery, decidi fazer meu pr√≥prio cart√£o, no qual todos os elementos do receptor estar√£o localizados, e n√£o precisarei puxar os fios para o monitor ou os conectores.  Isso melhora muito a confiabilidade e a capacidade de fabrica√ß√£o <s>e todos sonham com isso</s> . <br><br>  O esquema pode ser baixado aqui.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[DIAGRAMA]</a> .  N√£o a decorei ou penteei especificamente para publica√ß√£o.  Esta √© uma op√ß√£o de trabalho, e isso deve ser suficiente para aqueles que est√£o realmente interessados. <br><br>  O esquema consiste nas partes principais: <br><br>  1. MK STM32F415 com um chicote de fios - dois quartzo e uma bateria para um rel√≥gio em tempo real. <br>  2. ESP8266 <br>  3. VS1053 com cintas estritamente na folha de dados.  Iniciado no MK atrav√©s do SPI. <br>  4. Pot√™ncia - dois reguladores lineares LM1117 a 3,3 e 1,8 volts. <br>  5. Visor, conectores, bot√µes, potenci√¥metro.  Tudo isso √© institu√≠do no microcontrolador GPIO. <br><br>  Al√©m disso, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">amplificador de</a> classe D <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">PAM8403</a> n√£o √© exibido no diagrama, pois custa um m√≥dulo adquirido separadamente. <br><br>  <b>Taxa</b> <br><br>  Para sempre, antes de montar a placa, voc√™ precisa determinar a localiza√ß√£o dos elementos que se sobressaem do corpo - bot√µes, conectores e tela.  Eu fiz, mas sobre o caso mais tarde. <br><br>  O quadro ficou assim.  Cuidado geek morango! <br><br><img src="https://habrastorage.org/files/2b5/487/9d8/2b54879d8f6d4bf98a54004cccaf298b.JPG" alt="imagem"><br><br><img src="https://habrastorage.org/files/c9b/e26/4f7/c9be264f79f147428eed3b0bab40d95b.JPG" alt="imagem"><br><br><img src="https://habrastorage.org/files/819/d14/f09/819d14f09d91481785ce9787f32160a2.JPG" alt="imagem"><br><br>  A placa √© de duas camadas, com uma espessura de 1,5 mm.  Todos os componentes smd est√£o localizados em um lado, o que facilita a instala√ß√£o autom√°tica.  No entanto, ele ainda n√£o chegou. <br><br>  Eu j√° fui repreendido no pikabu por v√°rios especialistas por pequenas falhas na fia√ß√£o.  No entanto, o conselho funciona e funciona como deveria.  N√£o vejo o valor nos desenhos do quadro, por isso n√£o o publico.  Se houver pedidos, eu o publicarei.  Enfim, vou refaz√™-lo.  E, claro, cr√≠ticas bem fundamentadas s√£o muito bem-vindas! <br><br>  <b>Habita√ß√£o</b> <br><br>  O caso √© uma dor de todos os engenheiros eletr√¥nicos amadores.  E mesmo que voc√™ n√£o seja um amador, defendendo seu dinheiro, voc√™ se transforma nele. <br><br>  Em pequenos lotes, a op√ß√£o mais acess√≠vel √© fresar ou cortar a laser.  Com as op√ß√µes de metal, ele ainda pode dobrar chapas, mas esse n√£o √© o meu caso.  Por isso, escolhi a fresagem de pe√ßas de madeira + corte a laser de pain√©is.  Em termos de som, uma caixa de madeira tamb√©m √© uma grande vantagem. <br><br>  O resultado foi este conjunto de pe√ßas: <br><br><img src="https://habrastorage.org/files/0a9/510/970/0a9510970e2d4339982a28f32bdf729a.JPG" alt="imagem"><br><br>  Aten√ß√£o especial merece a inscri√ß√£o.  Ap√≥s muita reflex√£o, como aplic√°-las, foi decidido realiz√°-las com rejunte.  Ou seja, primeiro, com um moinho fino, a inscri√ß√£o √© selecionada no painel e depois a tinta √© derramada l√°.  Depois que a tinta seca, seu excesso √© removido.  Uma opera√ß√£o muito cara, mas eu n√£o estava mais parando.  Al√©m disso, uma das maneiras mais dur√°veis.  Se algu√©m tiver experi√™ncia com outras formas de aplicar r√≥tulos, compartilhe. <br><br>  √â assim que as inscri√ß√µes resultantes s√£o exibidas. <br><br><img src="https://habrastorage.org/files/05b/6e7/48c/05b6e748cb9e43aa9df7d02b72686eb8.JPG" alt="imagem"><br><br>  E aqui est√° o r√°dio montado por dentro: <br><br><img src="https://habrastorage.org/files/02e/abe/567/02eabe56732143659518590266241998.JPG" alt="imagem"><br><br>  E mais uma foto l√° fora: <br><br><img src="https://habrastorage.org/files/e3c/f6b/ab8/e3cf6bab85ca4789ae85310c6257eee8.JPG" alt="imagem"><br><br>  Conclus√£o  Este artigo descreveu os detalhes do desenvolvimento do dispositivo com tra√ßos amplos.  √â bastante dif√≠cil escrever sobre os detalhes, por um lado, pelo fato de que o mar, por outro lado, todos eles individualmente parecem √≥bvios.  Eu poderia escrever em um artigo separado sobre circuitos, placa de circuito impresso, firmware, trabalhando com esp8266 e vs1053b, se tiver interesse suficiente, escreverei.  Pois eu realmente quero que o r√°dio da Internet se torne popular. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt403239/">https://habr.com/ru/post/pt403239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt403229/index.html">Jogos de Cartas de Computador: Fl√¢mulas para Assistir</a></li>
<li><a href="../pt403231/index.html">Invasores de retrocesso ou como conectar um display LED de 64x64 ao Arduino</a></li>
<li><a href="../pt403233/index.html">NASA: Enceladus tem todas as condi√ß√µes para a origem e manuten√ß√£o da vida</a></li>
<li><a href="../pt403235/index.html">Por que o segundo √© mais interessante que o primeiro: uma nota sobre as novas escalas da Xiaomi</a></li>
<li><a href="../pt403237/index.html">Adicionando um contador SDM-220 ao OpenHab</a></li>
<li><a href="../pt403241/index.html">Pergunte a Ethan: Como a mat√©ria escura interage com os buracos negros?</a></li>
<li><a href="../pt403245/index.html">Como iniciante para montar um quadrocopter ZMR250 / QAV250 com Aliexpress (1 parte)</a></li>
<li><a href="../pt403247/index.html">A Microsoft corrigiu vulnerabilidades de dia zero em seu software muito antes de serem reveladas pelos Shadow Brokers</a></li>
<li><a href="../pt403249/index.html">Os planos da NASA est√£o mudando: os lan√ßamentos de foguetes pesados ‚Äã‚Äãda NASA provavelmente sofrer√£o</a></li>
<li><a href="../pt403253/index.html">A mat√©ria √© razo√°vel: por que o principal problema da neurobiologia se reflete na f√≠sica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>