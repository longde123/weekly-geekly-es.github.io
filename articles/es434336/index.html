<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê≤ üí° üë©üèº‚Äçüíº Trabajar con la API KOMPAS-3D ‚Üí Lecci√≥n 13 ‚Üí P√°rrafos üë©‚Äçüë©‚Äçüëß‚Äçüëß üßóüèª ü§òüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antes de pasar a formas documentadas de crear cadenas compuestas, necesitamos familiarizarnos con un objeto como un p√°rrafo. Es un bloque de texto for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trabajar con la API KOMPAS-3D ‚Üí Lecci√≥n 13 ‚Üí P√°rrafos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/434336/">  Antes de pasar a formas documentadas de crear cadenas compuestas, necesitamos familiarizarnos con un objeto como un p√°rrafo.  Es un bloque de texto formateado autom√°ticamente que consta de varias l√≠neas.  En esta lecci√≥n, veremos c√≥mo construir p√°rrafos simples. <br><br><img src="https://habrastorage.org/webt/m7/wu/vw/m7wuvw0aeqqqfed0yocjongme0g.png"><br><a name="habracut"></a><br><blockquote><h4>  El contenido de la serie de lecciones "Trabajando con la API KOMPAS-3D" </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los fundamentos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dise√±o de dibujo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conexi√≥n correcta a KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Inscripci√≥n principal</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Primitivas gr√°ficas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Guardar un documento en varios formatos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Conociendo la configuraci√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">M√©todos de escritura m√°s sofisticados en el bloque de t√≠tulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lectura de celdas de subt√≠tulos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Caracteres especiales que incluyen una cadena</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Etiquetas de texto simple</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cuerdas compuestas</a> </li><li>  <b>Los p√°rrafos</b> </li><li>  Texto multil√≠nea </li></ol></blockquote><h2>  <font color="#00B2FF">Par√°metros de p√°rrafo ( <b>ksParagraphParam</b> )</font> </h2><br>  La interfaz <b>ksParagraphParam</b> describe un p√°rrafo.  Para obtenerlo, debe usar el m√©todo <b>GetParamStruct</b> de la interfaz <b>KompasObject</b> , para esto debe pasarle la constante <b>ko_ParagraphParam</b> ( <i>0x0000001B</i> ).  Considere las propiedades de la interfaz <b>ksParagraphParam</b> . <br><br>  <b>ang</b> - el √°ngulo del texto en grados.  Se retrasa desde la l√≠nea horizontal en sentido antihorario.  Similar al par√°metro <b>ang</b> del m√©todo <b>ksText</b> . <br><br>  <b>altura</b> : la altura del p√°rrafo en mil√≠metros. <br><br>  <b>hFormat</b> : formatear el texto horizontalmente.  Esta propiedad se usa cuando el texto no se ajusta al ancho del p√°rrafo.  Los valores v√°lidos se enumeran en la tabla a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/-s/mj/m9/-smjm9ygdwb7dufeynhaolmpvuo.png"><br><br>  <b>estilo</b> : estilo del texto (descrito en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lecci√≥n 11</a> ). <br><br>  <b>vFormat</b> : formatear el texto verticalmente.  Esta propiedad se usa cuando el texto no cabe en el p√°rrafo en altura.  Los valores v√°lidos se enumeran en la tabla a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/jc/hj/9r/jchj9re-6fbg2cp6vc_x6dvsl2o.png"><br><br>  Hay dos <b>cosas</b> a tener en cuenta al trabajar con la propiedad <b>vFormat</b> : <br><br><ol><li>  Seg√∫n la documentaci√≥n de KOMPAS, los valores v√°lidos de la propiedad <b>vFormat</b> son <i>0</i> y <i>-1</i> , pero esto no es as√≠.  Los valores v√°lidos son <i>0</i> y <i>1</i> . </li><li>  COMPASS no cambia la altura de los caracteres.  Solo cambia la distancia entre las l√≠neas.  Si la altura de las l√≠neas es menor que la altura del p√°rrafo, entonces pueden superponerse.  Un ejemplo de dicha superposici√≥n se encuentra en la figura a continuaci√≥n. </li></ol><br> <a href=""><img src="https://habrastorage.org/webt/bk/hp/se/bkhpsesuq36ncmmwbotgfwuxdla.png"></a> <br><br>  <b>ancho</b> : el ancho del p√°rrafo en mil√≠metros. <br>  Las propiedades <b>height</b> , <b>hFormat</b> , <b>vFormat</b> y <b>width</b> nos permiten resolver el problema de colocar texto en un rect√°ngulo dado.  Este m√©todo es mucho m√°s confiable y eficiente que el m√©todo <b>ksGetTextLength</b> discutido en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lecci√≥n 11</a> . <br><br>  <i>x</i> e <i>y</i> son las coordenadas del punto de anclaje.  La posici√≥n del p√°rrafo con respecto al punto de anclaje a lo largo del eje horizontal se ajusta mediante el m√©todo <b>ksSetTextAlign</b> de la interfaz <b>ksDocument2D</b> (aunque esta posibilidad no est√° documentada).  El punto de anclaje vertical siempre coincide con la parte inferior de la primera l√≠nea del p√°rrafo.  Este comportamiento no se puede cambiar. <br>  La interfaz <b>ksParagraphParam tiene</b> un solo m√©todo: <b>Init ()</b> .  Inicializa los valores de propiedad de la interfaz.  No tiene par√°metros de entrada.  Si tiene √©xito, devuelve <i>verdadero</i> . <br><br><h2>  <font color="#00B2FF">P√°rrafo de construcci√≥n</font> </h2><br>  La creaci√≥n de un p√°rrafo consta de tres pasos secuenciales. <br><br><ol><li>  Declaraci√≥n de inicio de p√°rrafo.  Para hacer esto, se <b>llama al</b> m√©todo <b>ksParagraph</b> de la interfaz <b>ksDocument2D</b> .  Como √∫nico par√°metro, este m√©todo acepta la interfaz <b>ksParagraphParam</b> , que establece los par√°metros del p√°rrafo.  Si tiene √©xito, el m√©todo <b>ksParagraph</b> devuelve uno y, en caso de error, devuelve <i>cero</i> . </li><li>  Llenar el p√°rrafo  Para cada l√≠nea que se muestra en un p√°rrafo, se <b>llama al</b> m√©todo <b>ksTextLine</b> de la interfaz <b>ksDocument2D</b> .  Como √∫nico par√°metro, acepta la <b>interfaz</b> <b>ksTextItemParam</b> o <b>ksTextLineParam</b> (discutida en lecciones anteriores en el bucle) que describe la cadena.  Tenga en cuenta que las l√≠neas de salida no deben contener los caracteres <i>@</i> , <i>$</i> , <i>&amp;</i> , <i>~</i> , <i>^</i> y <i>#</i> , ya que son caracteres de control.  Trabajar con ellos se considerar√° en las pr√≥ximas lecciones del ciclo. </li><li>  Fin del parrafo.  Para hacer esto, se <b>llama al</b> m√©todo <b>ksEndObj ()</b> de la interfaz <b>ksDocument2D</b> .  No tiene par√°metros de entrada y, si tiene √©xito, devuelve un puntero entero al objeto creado (p√°rrafo).  En caso de error, devuelve <i>cero</i> . </li></ol><br><h2>  <font color="#00B2FF">Un ejemplo</font>  <font color="#00B2FF">El p√°rrafo m√°s simple</font> </h2><br><div class="spoiler">  <b class="spoiler_title">A continuaci√≥n se muestra el c√≥digo fuente del programa, que demuestra la construcci√≥n de un p√°rrafo simple.</b> <div class="spoiler_text"><pre><code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre> <br></div></div><br>  Como siempre, aqu√≠, por simplicidad, se omite el c√≥digo responsable de la creaci√≥n y ejecuci√≥n del documento (este tema se discuti√≥ en lecciones anteriores). <br><br>  En este ejemplo, KOMPAS determina el tama√±o del p√°rrafo en funci√≥n de su contenido.  La siguiente figura muestra el p√°rrafo generado. <br><br><img src="https://habrastorage.org/webt/jz/hi/b-/jzhib-bs44smvqvokcomp3shwmg.png"><br><br>  Nota: el texto se muestra como una sola l√≠nea.  No especificamos el ancho del p√°rrafo, por lo que KOMPAS lo aumenta autom√°ticamente seg√∫n sea necesario.  Si se estableciera el ancho, el comportamiento de COMPASS estar√≠a determinado por el valor de la propiedad <b>hFormat de la</b> interfaz <b>ksParagraphParam</b> . <br><br>  Para formar un texto compuesto y de varias l√≠neas, debe usar las caracter√≠sticas de dibujo que se discutieron parcialmente en la lecci√≥n anterior. <br><br><h2>  <font color="#00B2FF">Un ejemplo</font>  <font color="#00B2FF">Texto multil√≠nea</font> </h2><br>  Para <b>ajustar</b> expl√≠citamente a una nueva l√≠nea, use el indicador <b>NEW_LINE</b> ( <i>0x1000</i> ). <br><br><div class="spoiler">  <b class="spoiler_title">El siguiente es un programa de ejemplo que demuestra c√≥mo construir un p√°rrafo de varias l√≠neas usando esta bandera.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  En este ejemplo, se crea un p√°rrafo de tres l√≠neas.  La primera l√≠nea se muestra como de costumbre.  Para el segundo, se establece el indicador <b>NEW_LINE</b> .  √âl habla sobre el comienzo de una nueva l√≠nea.  El tercero se muestra como de costumbre, pero el indicador <b>NEW_LINE</b> todav√≠a est√° activo, ya que estamos trabajando con la misma instancia de la interfaz <b>ksTextItemParam</b> .  La siguiente figura muestra el p√°rrafo generado por este programa. <br><br> <a href=""><img src="https://habrastorage.org/webt/sw/3e/xl/sw3exlx1wgbxrnw6s7fmjshf4qm.png"></a> <br>  Ahora las l√≠neas se muestran correctamente. <br><br><h1>  <font color="#00B2FF">Desaf√≠os para trabajar con p√°rrafos</font> </h1><br><h2>  <font color="#00B2FF">Alineaci√≥n de texto</font> </h2><br>  La alineaci√≥n del texto se establece mediante el m√©todo <b>ksSetTextLineAlign</b> de la interfaz <b>ksDocument2D</b> .  Solo tiene un par√°metro entero: establecer la alineaci√≥n.  Sus valores v√°lidos se enumeran en la tabla a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/f2/yu/vd/f2yuvdi3o2kl2f7a5nsgglbsdli.png"><br><br>  Si tiene √©xito, el m√©todo <b>ksSetTextLineAlign</b> devuelve el indicador de alineaci√≥n anterior y, en caso de error, devuelve <i>-1</i> . <br><br>  Tenga en cuenta que el m√©todo <b>ksSetTextLineAlign</b> solo se puede usar dentro del bloque (en nuestro caso, se usa dentro del p√°rrafo).  Esto significa que no se puede usar para establecer la alineaci√≥n para la salida de texto mediante el m√©todo <b>ksText</b> .  Esta limitaci√≥n se debe al hecho de que, en este caso, KOMPAS no sabe con respecto a qu√© bordes es necesario alinear el texto. <br>  Otro punto importante est√° relacionado con el alcance del m√©todo <b>ksSetTextLineAlign</b> , que afecta a las l√≠neas de salida.  Considere un ejemplo (aqu√≠ se usa una sintaxis muy simplificada en comparaci√≥n con sus originales): <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú ‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú  ‚Äù);</code> </pre><br>  ¬øC√≥mo se alinear√°n las l√≠neas?  Contrariamente a nuestras expectativas, ambas l√≠neas estar√°n alineadas a la derecha.  Por qu√©  El hecho es que el m√©todo <b>ksSetTextLineAlign</b> cambia en primer lugar la alineaci√≥n de la √∫ltima l√≠nea de salida.  Esto es lo que sucede en nuestro ejemplo: la primera l√≠nea establece la alineaci√≥n central.  Como no hay una l√≠nea de salida anterior, esta llamada cambia la alineaci√≥n predeterminada (izquierda). <br><br>  Luego imprimimos la l√≠nea "Centro".  Inicialmente, utiliza la alineaci√≥n central establecida anteriormente. <br><br>  En la tercera l√≠nea, nuevamente cambiamos la alineaci√≥n.  En primer lugar, el m√©todo cambia la alineaci√≥n de la l√≠nea anterior ("Centro").  Por lo tanto, est√° alineado a la derecha y no al centro, como lo planeamos.  La misma alineaci√≥n se alinea por defecto. <br>  Mostramos la l√≠nea "Derecha".  Dado que el m√©todo <b>ksSetTextLineAlign</b> ya no se llama, utiliza la alineaci√≥n establecida anteriormente (a la derecha). <br>  Por lo tanto, ambas l√≠neas est√°n alineadas a la derecha.  Ahora cambiemos un poco el ejemplo: <br><br><pre> <code class="plaintext hljs">ksSetTextLineAlign(1); ksTextLine(‚Äú ‚Äù); ksTextLine(‚Äú‚Äù); ksSetTextLineAlign(2); ksTextLine(‚Äú  ‚Äù);</code> </pre><br>  Todo lo que cambiamos fue agregar la salida de una cadena vac√≠a sin cambiar la alineaci√≥n.  Ahora las l√≠neas se muestran correctamente.  Esto sucede porque la salida de una cadena vac√≠a "absorbe" la alineaci√≥n correcta establecida.  La segunda llamada al m√©todo <b>ksSetTextLineAlign</b> afecta a una l√≠nea vac√≠a y no afecta a la l√≠nea central de ninguna manera. <br>  El siguiente ejemplo muestra la alineaci√≥n correcta sin mostrar una cadena vac√≠a. <br><br><pre> <code class="plaintext hljs">ksTextLine(‚Äú ‚Äù); ksSetTextLineAlign(1); ksTextLine(‚Äú  ‚Äù); ksSetTextLineAlign(2);</code> </pre><br>  Las llamadas <b>ksTextLine</b> y <b>ksSetTextLineAlign</b> se intercambian.  Dado que el m√©todo <b>ksSetTextLineAlign</b> afecta principalmente a la √∫ltima l√≠nea mostrada, las alineaciones se configuran correctamente y las l√≠neas se muestran como quer√≠amos. <br><br><h2>  <font color="#00B2FF">Ejemplo</font> </h2><br><div class="spoiler">  <b class="spoiler_title">El siguiente es el c√≥digo fuente de un programa que demuestra la alineaci√≥n del texto en un p√°rrafo.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); paragraphParam-&gt;set_width(60.0); paragraphParam-&gt;set_hFormat(2); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L"    "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;SetBitVectorValue(NEW_LINE, true); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont.Unbind(); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(1); str = SysAllocString(L""); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); str = SysAllocString(L"    "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); Document2D-&gt;ksSetTextLineAlign(3); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  En este ejemplo, adem√°s de la alineaci√≥n del texto, tambi√©n se demuestra el uso de las propiedades de <b>ancho</b> y <b>hFormat de la</b> interfaz <b>ksParagraphParam</b> .  Se usan para limitar su ancho.  Si no los cambiamos, KOMPAS aumentar√≠a el ancho del p√°rrafo, y no ver√≠amos la alineaci√≥n a la izquierda y al ancho. <br><br>  Se muestran l√≠neas en blanco para mejorar la legibilidad del p√°rrafo.  No afectan la alineaci√≥n correcta. <br><br>  La siguiente figura muestra el p√°rrafo generado por este programa. <br><br> <a href=""><img src="https://habrastorage.org/webt/jh/kh/bx/jhkhbxlyjawnod_y31k2re1vuz8.png"></a> <br><br><h2>  <font color="#00B2FF">Activa o desactiva el estilo</font> </h2><br>  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">und√©cima lecci√≥n del ciclo,</a> examinamos las banderas que controlan el estilo ( <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>BOLD_ON</i> , <i>UNDERLINE_ON</i> y <i>UNDERLINE_OFF</i> ).  Luego los examinamos en relaci√≥n con el m√©todo <b>ksText</b> .  Una diferencia importante entre su uso en un p√°rrafo es que la acci√≥n no se limita a llamar al m√©todo <b>ksTextLine</b> , sino que se extiende a todo el p√°rrafo.  Veamos algunos ejemplos. <br><br><pre> <code class="plaintext hljs">TextItemFont-&gt;SetBitVectorValue(BOLD_ON, true); TextItemParam-&gt;s = SysAllocString(L‚Äù ‚Äù); Document2D-&gt;ksTextLine(TextItemParam); TextItemFont-&gt;Init(); TextItemParam-&gt;s = SysAllocString(L‚Äù ‚Äù); Document2D-&gt;ksTextLine(TextItemParam);</code> </pre><br>  La primera l√≠nea se mostrar√° en negrita.  No hay preguntas con esto.  Pero, ¬øc√≥mo se mostrar√° la segunda l√≠nea?  La bandera <i>BOLD_ON se ha</i> restablecido para ella.  Por lo tanto, podemos suponer que se mostrar√° en una fuente normal.  Pero esto no es as√≠.  Despu√©s de cumplir con el indicador <i>BOLD_ON</i> , KOMPAS entiende el comando de la siguiente manera: todas las l√≠neas posteriores de este p√°rrafo se muestran en negrita.  Por lo tanto, todas las l√≠neas posteriores se muestran en negrita hasta que se completa el p√°rrafo o KOMPAS encuentra el indicador <i>BOLD_OFF emparejado con √©l</i> .  Considere un ejemplo: <br><br><pre> <code class="plaintext hljs">TextItemFont.SetBitVectorValue(BOLD_ON, true); TextItemParam.s = SysAllocString(L‚Äù ‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemFont.SetBitVectorValue(BOLD_OFF, true); TextItemParam.s = SysAllocString(L‚Äú ‚Äù); Document2D.ksTextLine(TextItemParam); TextItemFont.Init(); TextItemParam.s = SysAllocString(L‚Äù ‚Äù); Document2D.ksTextLine(TextItemParam);</code> </pre><br>  La primera l√≠nea se muestra en negrita.  Para la segunda l√≠nea, <i>borramos la</i> bandera <i>BOLD_ON</i> y activamos la bandera BOLD_OFF <i>emparejada con ella</i> , lo que cancela el estilo en negrita.  Debido a esto, las l√≠neas segunda y tercera se muestran sin negrita. <br><br>  Este comportamiento se aplica a las banderas <i>ITALIC_ON</i> , <i>ITALIC_OFF</i> , <i>UNDERLINE_ON</i> y <i>UNDERLINE_OFF</i> , pero no se aplica a la bandera <i>NEW_LINE</i> , ya que no tiene un par de banderas anuladas. <br><br><h2>  <font color="#00B2FF">Ejemplo</font> </h2><br><div class="spoiler">  <b class="spoiler_title">El siguiente es el c√≥digo fuente del programa, que muestra la salida de texto con diferentes estilos usando p√°rrafos.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //  BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); // str = SysAllocString(L"  "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); // str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); // str = SysAllocString(L" "); textItemParam-&gt;set_s(str); Document2D-&gt;ksTextLine(textItemParam); SysFreeString(str); //  Document2D-&gt;ksEndObj(); paragraphParam.Unbind(); textItemFont.Unbind(); textItemParam.Unbind();</code> </pre><br></div></div><br>  La parte m√°s importante de este programa es la configuraci√≥n adecuada de banderas para las l√≠neas de salida.  Analicemos con m√°s detalle (las l√≠neas correspondientes del programa est√°n marcadas con un par de caracteres " <i>//</i> "). <br><br>  La primera l√≠nea se muestra sin ning√∫n cambio.  Por lo tanto, no hay banderas establecidas para ello. <br><br>  La segunda l√≠nea debe mostrarse sin pendiente y con una nueva l√≠nea.  Por lo tanto, los indicadores est√°n configurados para ello: <i>NEW_LINE</i> (comenzar en una nueva l√≠nea) e <i>ITALIC_OFF</i> (desactivar <i>cursiva</i> ). <br><br>  La tercera l√≠nea debe aparecer en cursiva y negrita.  Para hacer esto, <i>activamos</i> las banderas: <i>NEW_LINE</i> , <i>ITALIC_ON</i> ( <i>habilitar</i> cursiva) y <i>BOLD_ON</i> ( <i>habilitar</i> caras en negrita).  Todas las dem√°s banderas se reinician. <br><br>  La cuarta l√≠nea debe imprimirse en cursiva, subrayada y no en negrita.  Para hacer esto, <i>activamos</i> las banderas: <i>NEW_LINE</i> , <i>BOLD_OFF</i> (deshabilitar negrita, izquierda de la l√≠nea anterior) y <i>UNDERLINE_ON</i> (habilitar subrayado). <br><br>  Si hubiera m√°s l√≠neas en el p√°rrafo, se mostrar√≠an en letra cursiva subrayada.  Para deshabilitar el estilo subrayado, debe borrar el indicador UNDERLINE_ON y activar el indicador <i>UNDERLINE_OFF</i> . <br><br>  La siguiente figura muestra el resultado de este programa. <br><br> <a href=""><img src="https://habrastorage.org/webt/p-/gc/sy/p-gcsy8wpi5wz8gxaa69q55uut4.png"></a> <br><br><h2>  <font color="#00B2FF">Separar informaci√≥n de la presentaci√≥n</font> </h2><br>  Si sigue la estructura de sus programas, probablemente haya notado un serio inconveniente del ejemplo anterior: el c√≥digo responsable de generar la salida se mezcla con el c√≥digo responsable de implementar su salida.  Con un buen estilo de programaci√≥n, se acostumbra separar la informaci√≥n de su presentaci√≥n. <br><br>  Si la informaci√≥n de salida consta de varias l√≠neas de <b>ksTextItemParam</b> , entonces se pueden combinar en una interfaz <b>ksTextLineParam</b> .  El m√©todo <b>ksTextLine</b> puede manejar ambas interfaces.  Pero este enfoque tiene una limitaci√≥n desagradable: si el m√©todo <b>ksTextLine</b> acepta la interfaz <b>ksTextLineParam</b> , los <b>indicadores</b> <i>NEW_LINE</i> (y <i>SPECIAL_SYMBOL_END</i> ) se ignoran.  Es decir, toda la informaci√≥n se mostrar√° en una l√≠nea, incluso si el indicador <b>NEW_LINE</b> est√° <i>configurado</i> para algunas <i>instancias de</i> <b>ksTextItemParam</b> .  Para evitar esta limitaci√≥n, debe llamar manualmente a <b>ksTextLine</b> para cada l√≠nea. <br><br><div class="spoiler">  <b class="spoiler_title">El siguiente es el c√≥digo fuente de un ejemplo que demuestra esta t√©cnica.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//    DynamicArrayPtr dynamicArray; dynamicArray = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); dynamicArray-&gt;ksClearArray(); //  ksTextItemParam TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //   BSTR str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_OFF); str = SysAllocString(L"  "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | ITALIC_ON | BOLD_ON); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); textItemFont-&gt;set_bitVector(NEW_LINE | BOLD_OFF | UNDERLINE_ON); str = SysAllocString(L" "); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //    ParagraphParamPtr paragraphParam; paragraphParam = static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); //  Document2D-&gt;ksParagraph(paragraphParam); //     for(unsigned int i = 0; i &lt; dynamicArray-&gt;ksGetArrayCount(); ++i) { dynamicArray-&gt;ksGetArrayItem(i, textItemParam); Document2D-&gt;ksTextLine(textItemParam); } //  Document2D-&gt;ksEndObj(); //  textItemFont.Unbind(); textItemParam.Unbind(); paragraphParam.Unbind(); dynamicArray-&gt;ksDeleteArray(); dynamicArray.Unbind();</code> </pre><br></div></div><br>  En este ejemplo, las l√≠neas de salida se escriben primero en <b>DynamicArray</b> y solo luego se env√≠an al p√°rrafo.  Esto le permite separar la informaci√≥n de su presentaci√≥n.  Si el indicador <i>NEW_LINE</i> no se us√≥ en nuestro ejemplo, entonces podr√≠amos pasar con una llamada al m√©todo <b>ksTextLine</b> . <br><br>  El resultado de este programa es similar al resultado del ejemplo anterior. <br><br>  <b>Conclusi√≥n</b> <br><br>  En esta lecci√≥n, vimos c√≥mo construir un p√°rrafo y c√≥mo usarlo para mostrar texto de varias l√≠neas.  Tambi√©n aprendimos a separar la informaci√≥n de su presentaci√≥n.  Desafortunadamente, la salida correcta del texto de varias l√≠neas requiere un recorrido manual de una serie de cadenas.  Esto no es muy conveniente.  En la pr√≥xima lecci√≥n mostrar√© c√≥mo resolver este problema. <br><br>  <b>Para continuar, sigue las noticias del blog.</b> <br><br> <a href=""><img align="left" src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev, Ph.D., autor del libro "Desarrollo de aplicaciones para COMPAS en Delphi". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es434336/">https://habr.com/ru/post/es434336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es434326/index.html">Ballet en el aire: levitaci√≥n de part√≠culas controlada debido a las ondas sonoras</a></li>
<li><a href="../es434328/index.html">Firma electr√≥nica para participar en adquisiciones</a></li>
<li><a href="../es434330/index.html">Novedades de YouTrack 2018.4</a></li>
<li><a href="../es434332/index.html">Y una vez m√°s sobre KIB SearchInform: nos ocupamos de lo √∫ltimo</a></li>
<li><a href="../es434334/index.html">C√≥mo interceptaron los baghunters cartas de correo a√©reo en ZeroNights</a></li>
<li><a href="../es434338/index.html">Qt News, mayo de 2018 - diciembre de 2018</a></li>
<li><a href="../es434340/index.html">C√≥mo auditamos el Wi-Fi en el metro de Delhi y lo que surgi√≥</a></li>
<li><a href="../es434342/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 22: "MIT de seguridad de la informaci√≥n", parte 1</a></li>
<li><a href="../es434344/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 22: "MIT de seguridad de la informaci√≥n", parte 2</a></li>
<li><a href="../es434346/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 22: "MIT de seguridad de la informaci√≥n", parte 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>