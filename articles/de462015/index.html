<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëå ‚õπüèΩ üò¨ SAP-Berichtsuniversum üë©‚Äçüç≥ üë©‚Äçüíª üòÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor ungef√§hr 4 Jahren haben wir unser Berichtssystem von Oracle auf SAP Hana umgestellt. Heute werden etwa 10.000 Tische gespeichert, 38.000 Benutzer ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SAP-Berichtsuniversum</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mvideo/blog/462015/"><img src="https://habrastorage.org/webt/nf/96/da/nf96daardoyhax1e_lj6oy2wk9o.jpeg"><br><br>  Vor ungef√§hr 4 Jahren haben wir unser Berichtssystem von Oracle auf SAP Hana umgestellt.  Heute werden etwa 10.000 Tische gespeichert, 38.000 Benutzer verwenden es und t√§glich finden mehr als 5.000 Ladevorg√§nge statt.  Derzeit besteht unser Komplex, auf dem das System arbeitet, aus 8 Servern mit 14 TB Speicher.  Das Berichtssystem verarbeitet t√§glich 1,5 pb Daten.  Gleichzeitig war Hana etwa 20-mal produktiver als Oracle, DB2 und MySQL.  Und heute m√∂chte ich erz√§hlen, wie wir im Rahmen der Integration von M.Video und Eldorado zus√§tzlich die Leistung des Berichtssystems gesteigert haben, welche Optimierungen wir vorgenommen haben. <br><a name="habracut"></a><br><h2>  Laden </h2><br>  Heute erzeugen von mehreren tausend vom System erstellten Berichten nur 10 70% der Gesamtlast.  Der schwerste Bericht in der Hana-Datenbank ist Weekly Bussines Review.  Es l√§uft 30 Minuten und verbraucht 4 TB Speicher.  90% aller Berichte werden vom Contact Center erstellt: Wir haben einen Service erstellt, der beim Anrufen eines Kunden √ºber seine Telefonnummer automatisch einen Bericht √∂ffnet und dem Betreiber den gesamten Verlauf der Eink√§ufe des Anrufers und seine Interaktion mit dem Unternehmen anzeigt. <br><br><h2>  Datenmodell </h2><br>  Das Schl√ºsseldatenmodell, auf dem der Gro√üteil der Berichte basiert, enth√§lt 1.500 Tabellen.  Die meisten davon sind Referenztabellen.  Mit diesem Modell k√∂nnen Sie jede Richtung des Unternehmens analysieren.  Ein Beispiel ist die Visualisierung eines Datenmodells, das mit dem Universe-Designer erstellt wurde.  Es stimmt, es spiegelt nur ein Zehntel unseres Systems wider. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/054/47a/9d3/05447a9d3d7447a41a4732c49a7b205d.png"><br><br><h2>  Leistung </h2><br>  Zum Zeitpunkt der Fusion von M.Video und Eldorado betrug die Datenmenge in den beiden Meldesystemen etwa 10 TB: 7 TB im BW auf dem HANA M.Video-System, 2 TB im BW auf HANA Eldorado und 1 TB zus√§tzliche Daten in HADOOP (historische Daten).  Bei der Kombination der Systeme hatten wir Hardwareeinschr√§nkungen: Der M. Video-Komplex bestand aus 6 Knoten (jeweils 2 TB), einschlie√ülich einer Sicherung.  Dieses System kann auf maximal 8 Knoten erweitert werden, von denen eine Sicherung. <br><br>  In Vorbereitung auf den Zusammenschluss gingen wir davon aus, dass die Gesamtmenge aller Daten 13 TB erreichen w√ºrde.  Basierend auf den SAP-Empfehlungen ben√∂tigten wir daher ein System mit 16 Knoten mit jeweils 2 TB, einschlie√ülich zwei Sicherungsknoten.  Au√üerdem musste ein Knoten als Hauptknoten zugewiesen werden, der mit einem solchen Informationsvolumen Verwaltungsfunktionen √ºbernehmen w√ºrde.  Das hei√üt, f√ºr einen korrekten Betrieb mussten 13 Knoten bereitgestellt werden. <br><br>  Wie Sie sehen k√∂nnen, reichen die verf√ºgbaren Ressourcen kategorisch nicht aus.  Und das war die erste Herausforderung. <br><br>  Die zweite Hauptschwierigkeit vor dem Zusammenschluss bestand darin, dass die Geschwindigkeit des Systems h√§ufig nicht den Anforderungen des Unternehmens entsprach.  Der Hauptgrund war die gro√üe Anzahl gleichzeitiger Aufrufe der Datenbank.  Aus Sicht des Systems sah es aus wie ein Schneeball, der entweder zum Einfrieren und Unterbrechen eines Teils der Prozesse oder sogar zu globalen Speicherausz√ºgen von "nicht gen√ºgend Speicher" auf den Knoten f√ºhren kann. <br><br>  Es war klar, dass eine zweifache Erh√∂hung der Datenmenge in den Berichten (f√ºr zwei Marken) ohne wesentliche √Ñnderungen zu einer etwa zweifachen Verschlechterung der Situation f√ºhren w√ºrde. <br><br>  Aus diesem Grund haben wir uns entschlossen, das System in folgenden Bereichen zu optimieren: <br><br><ul><li>  <b>Berichterstattung</b>  Beschleunigung der kritischsten und ressourcenintensivsten Berichte und √úberarbeitung des Datenmodells. <br></li><li>  <b>Repository</b> .  Archivierungs- und Speicheroptimierung. <br></li><li>  <b>Downloads</b> .  Optimieren Sie das Verfahren und √§ndern Sie den Download-Zeitplan. <br></li></ul><br>  Der allgemeine Ansatz zur Optimierung war folgender: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1aa/534/20d/1aa53420d809464c7d3f28bd9761e411.png"><br><br>  Zuerst f√ºhrten wir eine Analyse in alle Richtungen durch, identifizierten die Ursachen von Problemen und analysierten dann die F√§higkeiten des Systems mit den erforderlichen Ressourcen.  Wir haben auch sofort versucht, diesen Prozess so weit wie m√∂glich zu automatisieren, damit wir in Zukunft die Ursachen von Problemen schnell identifizieren und die Leistung schnell wiederherstellen k√∂nnen. <br><br>  Was haben wir getan: <br><br><ul><li>  Die Konfiguration der ABAP-Anwendungsserver wurde ge√§ndert: Anzahl der Instanzen, effektive Nutzung der NUMA-Technologie und optimale Anzahl der Workflows. <br></li><li>  Wir haben die optimalen Parameter von HANA und dem Linux-Betriebssystem angewendet. <br></li><li>  Wir haben den R√ºckgang des CPU-Verbrauchs analysiert. <br></li><li>  Wir haben den RAM-Verbrauch im gesamten beobachteten Zeitintervall analysiert. <br></li><li>  Wir haben das Auftreten von OOM auf HANA analysiert. <br></li><li>  Wir haben das Auftreten von Sperren im System und die Verf√ºgbarkeit von Systemressourcen f√ºr Wartevorg√§nge (Warten) analysiert. <br></li><li>  Wir haben den Datenausgleich unter Ber√ºcksichtigung der Umverteilung und Aufteilung der Daten f√ºr die SCALE-OUT HANA-L√∂sung analysiert. <br></li><li>  Wir haben die Ursachen von ABAP-Dumps analysiert, die sich auf den Betrieb kritischer Ketten auswirken. <br></li></ul><br>  Basierend auf den Ergebnissen wurden Leistungsberichte sowie Anweisungen erstellt, damit in Zukunft Engp√§sse im System und Spitzenzeitintervalle unabh√§ngig ermittelt werden k√∂nnen. <br><br>  Welche Ergebnisse wurden erzielt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/82a/e7e/382/82ae7e3826abf0a8eaf2cafb2c10d27b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5a/b6e/221/d5ab6e221145f19b6f385738f57d9dca.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5e/a35/4d2/a5ea354d258baaed8ef8176ad0a0ad45.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1dc/654/1f7/1dc6541f7d68c70012d8203e92182775.png"><br><br>  Eine Reihe optimierter Berichte SAP BO begann um ein <b>Vielfaches schneller zu arbeiten</b> und verbrauchte <b>hunderte Male weniger Speicher</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7fc/ed2/3c7/7fced23c7b586cf2334745b265245447.png"><br><br>  Hier einige bemerkenswerte Beispiele daf√ºr, wie das System die Auswahlbedingungen falsch erf√ºllt und wie Abfragen in HANA korrekt erstellt werden. <br><br>  Beim Filtern nach nicht materialisierten Objekten wurden Probleme festgestellt, insbesondere (!) Bei Verwendung von <code>COUNT DISTINCT</code> Indikatoren (eine CD kann sowohl auf Universumsebene als auch in einer Funktion im Lebenslauf geschrieben werden). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2c/25c/e8c/c2c25ce8cab11363b6dd1958c9b1c25a.png"><br><br>  Selbst wenn Sie die CD von der Abfrage ausschlie√üen, wird die erste Option immer noch 20-mal langsamer als die zweite ausgef√ºhrt, und bei einer CD ist die Geschwindigkeit mehr als 500-mal h√∂her. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1dc/f0b/6a3/1dcf0b6a38e4053829e20a531d67c45a.png"><br><br>  Ein Sonderfall bei der Verwendung nicht materialisierter Objekte in Filtern: Verbundfilter von zwei oder mehr Objekten, z. B. Kleben einer Woche und eines Jahres: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cda/a3a/d8e/cdaa3ad8e73905c217346b6b00004dd0.png"><br><br>  Abfragen mit geklebten Filtern funktionieren nicht so langsam wie die Konvertierung in ein Datum, verlangsamen jedoch die Abfragen (etwa 2-3 Mal). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cec/182/9d6/cec1829d65a06d6d73f53b2110cfc4e3.png"><br><br>  Um Statistiken √ºber den Betrieb des Berichtssystems, Ladeprozesse und Ketten zu sammeln, haben wir das folgende Schema entwickelt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fc/3c5/d8a/9fc3c5d8aab834bca29c4988592f25f8.png"><br><br>  Gleichzeitig haben wir den Berichten einen speziellen Kommentar mit dem Namen des Berichts hinzugef√ºgt.  Somit k√∂nnen wir die Last von verschiedenen Teilen des Systems vergleichen und die Periode von Periode zu Periode vergleichen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14e/665/69b/14e66569bb4292fb4e66364fe51de6be.png"><br><br><h2>  <font color="#ec2028">Pl√§ne</font> </h2><br>  Wir haben viele Pl√§ne f√ºr die Entwicklung von Gesch√§ftsfunktionen und eine wesentliche √úberarbeitung des Datenvisualisierungstools.  Der globale Trend, an dem wir aktiv teilnehmen, besteht darin, das Berichtssystem in das Paradigma der digitalen Transformation zu integrieren. <br><br>  Was meinst du <br><br>  Als unser Berichtssystem noch jung war, kamen Benutzer h√§ufig mit √§hnlichen Anfragen zu uns: ‚ÄûAutomatisieren Sie die Erstellung eines Berichts, aus dem hervorgeht, wie viel Nettogewinn ein bestimmtes Gesch√§ft oder das gesamte Unternehmen erzielt hat.‚Äú <br><br>  Dann kamen sie zu uns mit der Bitte, einen Algorithmus zu entwickeln, der abh√§ngig von bestimmten Faktoren einen Plan oder eine Prognose f√ºr einen Nettogewinn erstellt. <br><br>  Und heute sind wir zu dem Schluss gekommen, dass Benutzer die genaue Prognose des Nettogewinns wissen wollen.  Wir haben alle notwendigen Daten f√ºr die Entwicklung von Prognosealgorithmen, und es gibt Datenanalysespezialisten, die Modelle f√ºr maschinelles Lernen erstellen k√∂nnen.  Wie Sie wissen, erfordert dies sehr gro√üe Datenmengen. Einer der Haupttrends bei der Entwicklung unseres Berichtssystems ist der √úbergang zur Analyse und Erstellung von Modellen, die auf Big Data basieren. <br><br><h2>  <font color="#ec2028">Ein paar Worte zu unserem Team</font> </h2><br>  Heutzutage f√ºhren gro√üe Unternehmen zunehmend Prognosesysteme ein, die auf vom System selbst entwickelten Algorithmen f√ºr maschinelles Lernen basieren.  Vor zwei Jahren haben wir ein Kompetenzzentrum im Bereich der Datenanalyse des Digital Retail Data Science Center eingerichtet. In diesem Jahr haben wir eine Gruppe von Dateningenieuren.  Wir f√ºhren ein neues System zur Verarbeitung und Analyse von Big Data ein.  Und wir brauchen Mitarbeiter im Team in den Abteilungen Support, Entwicklung und angewandte Datenanalyse. <br><br>  Wenn Sie sich f√ºr diese Bereiche interessieren, wenn Sie die St√§rke in sich sp√ºren - willkommen!  Sie werden interessante und schwierige Arbeit finden, manchmal stressig, aber immer kreativ. <img src="https://habrastorage.org/files/fa7/d16/199/fa7d16199fca4fee89c0b96fa9919513.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462015/">https://habr.com/ru/post/de462015/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462005/index.html">Funktionen von Google PageSpeed: Verbesserte Website-Bewertung und verbessertes Suchranking</a></li>
<li><a href="../de462007/index.html">Entwicklung robuster Python-Skripte</a></li>
<li><a href="../de462009/index.html">Programmtrends: Was ist im Jahr 2020 zu erwarten?</a></li>
<li><a href="../de462011/index.html">Web-Geoservices. √úberblick √ºber moderne L√∂sungen</a></li>
<li><a href="../de462013/index.html">Verlauf des Docker-Speicher-Migrationsproblems (Docker-Root)</a></li>
<li><a href="../de462021/index.html">Wie man aufh√∂rt, dasselbe zu tun</a></li>
<li><a href="../de462023/index.html">Cascadeur: Die Zukunft der Spielanimation</a></li>
<li><a href="../de462025/index.html">Relationales Netzwerkdatenmodell</a></li>
<li><a href="../de462027/index.html">Wie Dark 50ms Code einsetzt</a></li>
<li><a href="../de462029/index.html">19 n√ºtzliche Funktionen der .htaccess-Datei</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>