<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåç üìã üÜî Criamos uma esta√ß√£o de r√°dio na Internet simples, compacta e barata üòï ü§¥üèΩ ü§æüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Linux ser√° a plataforma de software. Para simplificar, √© melhor usar algo comum, com muitas informa√ß√µes na Internet, se algo der errado. O ferro par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criamos uma esta√ß√£o de r√°dio na Internet simples, compacta e barata</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426349/"> O Linux ser√° a plataforma de software. Para simplificar, √© melhor usar algo comum, com muitas informa√ß√µes na Internet, se algo der errado.  O ferro para uma esta√ß√£o de r√°dio da Internet pode ser qualquer coisa, um servidor completo com seus projetos, um laptop ou netbook antigo, queremos barato e n√£o precisamos de um desempenho especial do ferro. <br><br>  Se voc√™ n√£o tem nada em m√£os ou precisamos de um servidor completamente silencioso, por que n√£o tentar usar um mini computador? <br><br>  Algo como o Raspberry Pi 3? <br><br>  N√£o, queremos mais barato, por isso precisamos de algo como o Orange Pi.  Encontrei um modelo Orange Pi Pc Plus com 1 GB de RAM DDR3 e 8 GB de flash EMMC. <br><br><img src="https://habrastorage.org/webt/ew/ry/mf/ewrymf0vj-86hqfa2v8e7rrmjks.png"><a name="habracut"></a><br><br>  UPD: Ontem, todo mundo de alguma forma levou o artigo muito a s√©rio, mas, na verdade, o experimento foi conduzido pelo bem dos f√£s, para ver se funciona ou n√£o.  Naturalmente, n√£o se fala em nenhum uso "industrial", √© como tentar tocar o est√°dio com um centro de m√∫sica comum. <br><br>  Do que mais podemos precisar? <br><br>  Quero tentar configurar tudo de uma maneira simples, para que ainda precise de um cabo de par tran√ßado no roteador e um cart√£o de mem√≥ria Micro SD, pois n√£o consigo instalar o sistema operacional diretamente no microcomputador.  Eu encontrei um cart√£o de mem√≥ria para 8 gigabytes, essa quantidade √© suficiente. <br><br>  Portanto, primeiro, voc√™ precisa gravar a imagem do sistema operacional no cart√£o de mem√≥ria. <br>  Para servidores, eu prefiro usar o Debian testado pelo tempo (sim, a gera√ß√£o mais jovem provavelmente prefere o CentOS, mas os grisalhos concordam comigo que o Debian ainda √© muito bom). <br><br>  Em geral, existem muitas imagens prontas para o Orange Pi em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.orangepi.org/downloadresources</a> , mas ainda vou a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.armbian.com/download</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">baixo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o</a> arquivo torrent do armbian em dl.armbian.com/orangepipcplus (no meu caso Debian_stretch_next.7z). <br><br>  Eu tenho o Orange Pi Pc Plus, voc√™ pode ter qualquer outro mini computador, ent√£o procure a imagem apropriada. <br><br>  Ap√≥s o download, descompacte o arquivo e veja a imagem no formato img.  Qualquer pessoa que queira preencher com a imagem, eu pessoalmente prefiro o Etcher (https://etcher.io).  Inserimos um cart√£o de mem√≥ria, o selecionamos se voc√™ tiver v√°rias m√≠dias conectadas, clique no bot√£o costurar, digite a senha se tamb√©m tiver Linux no seu desktop ou laptop. <br><br><img src="https://habrastorage.org/webt/lq/3w/3y/lq3w3yteie6cz8jage7vau5zssw.png"><br><br>  O cart√£o com a imagem est√° pronto, voc√™ pode come√ßar a conectar tudo. <br>  O que precisamos para iniciar e come√ßar a configurar nosso servidor? <br>  O mini computador em si, Internet via fio Ethernet e fonte de alimenta√ß√£o. <br>  E √© isso. <br><br>  N√£o, √© claro que voc√™ pode ficar confuso, conectar o monitor e o teclado e configurar tudo diretamente, mas eu gosto mais do teclado do meu laptop, portanto, configurarei meu minicomputador remotamente, via SSH. <br><br>  Ent√£o, vamos come√ßar, ficamos no cabo Ethernet, um cart√£o Micro SD com uma imagem Armbian. <br>  Resta apenas fornecer energia ao minicomputador. <br><br>  Mas com o poder do Orange Pi, tudo √© muito triste.  O que est√° em um mini computador normal?  √â isso mesmo, Micro-USB, mas como posso ligar o Orange Pi?  Apenas 5V atrav√©s de um conector de pinos, que √© comprado separadamente. <br><br>  Um adaptador de energia com um conector adequado custa mais do que apenas um cabo com USB padr√£o no final, para que voc√™ possa us√°-lo. <br><br>  Se n√£o houver fonte de alimenta√ß√£o gratuita com USB (e n√£o precisamos, de qualquer forma, mas por 2 amperes), remexemos em nossa caixa com fios, adaptadores e placas para computadores (voc√™ tem essa caixa, certo?) E encontre um adaptador adequado em alguns antigos, quebrados h√° muito tempo por um tablet infantil, soldam o cabo e a energia do servidor est√° pronta. <br><br>  Bem, ou apenas pegue o carregador do antigo mp3 player de disco iRiver (s√£o apenas 4,7 volts e 1,2 amperes, mas tamb√©m funciona). <br><br>  Estamos servindo comida e estamos prontos para mudar, de fato, para aquele para o qual tudo foi concebido, para a cria√ß√£o de uma esta√ß√£o de r√°dio na Internet. <br><br>  Se voc√™, como eu, pretende conviver com um m√≠nimo de perif√©ricos, precisamos descobrir qual endere√ßo IP nosso mini computador recebeu.  A maneira mais f√°cil de descobrir isso √© acessar o seu roteador e ver o endere√ßo IP que o roteador forneceu ao nosso servidor (seu roteador pode fazer DHCP, certo?). <br><br>  Agora voc√™ pode fazer login via SSH em nosso servidor.  Quem usa o cliente SSH √© quem deve usar (voc√™ nunca tem o Windows, mas eu n√£o sei o que os clientes SSH fazem). <br>  No meu caso, apenas martelo no console ssh root@192.168.0.88, concordo em adicionar a chave ECDSA, a senha padr√£o do root √© definida como "1234". Ap√≥s o login, nos encontramos no console do microcomputador, o que sugere imediatamente a altera√ß√£o da senha do root. <br><br><img src="https://habrastorage.org/webt/gu/nz/c0/gunzc0ewl71jcxyhwrvoeegqpvc.png"><br><br>  Depois disso, prop√µe-se criar uma conta de usu√°rio sem privil√©gios, n√≥s a criamos. <br>  Comparada √†s vers√µes anteriores do sistema operacional, a vers√£o atual √© um pouco simplificada em termos de configura√ß√µes e muitas coisas j√° est√£o configuradas automaticamente. <br><br>  O Armbian possui uma ferramenta de configura√ß√£o muito conveniente: o <code>armbian-config</code> copia o comando para o console e v√™ o que pode ser √∫til. <br><br><img src="https://habrastorage.org/webt/ow/nr/yi/ownryigiv-au8gowgrfhvcetduk.png"><br><br>  Ainda n√£o precisamos das configura√ß√µes do sistema, mas podem ser necess√°rias posteriormente, por exemplo, para transferir o sistema configurado do Micro SD para a mem√≥ria Flash EMMC de 8 GB incorporada de um mini computador. <br><br>  A se√ß√£o Rede ser√° √∫til para n√≥s, mas seria bom ter um endere√ßo IP est√°tico para o servidor.  Nossa esta√ß√£o de r√°dio na Internet pode ser conectada √† rede mesmo via Wi-Fi.  Todo mundo define o n√≠vel de perversidade para si mesmo, mas se voc√™ constr√≥i um r√°dio na Internet exclusivamente para si e n√£o h√° planos para mais de 10 ouvintes ao mesmo tempo, por que n√£o colocar nosso servidor em Wi-Fi?  Em casos extremos, voc√™ pode conectar um cabo Ethernet a qualquer momento. <br><br>  Ent√£o, decidimos o tipo de conex√£o, agora precisamos configurar um endere√ßo IP est√°tico, para isso vamos √†s configura√ß√µes de IP e selecionamos a interface de rede desejada, ap√≥s o que dizemos que queremos um endere√ßo est√°tico, inicie-o e salve as configura√ß√µes.  N√£o √© necess√°rio alterar a m√°scara e o gateway, pois eles s√£o recebidos do seu roteador via DHCP. <br><br><img src="https://habrastorage.org/webt/b0/gp/qv/b0gpqvib6trft_pkir827aj8d3m.png"><br><br>  Depois de inserir um novo endere√ßo IP e pressionar Enter, sua sess√£o SSH ser√° congelada imediatamente, pois o dispositivo ter√° imediatamente um novo endere√ßo IP.  Portanto, simplesmente fechamos a janela com o terminal e acessamos nosso mini-computador via SSH usando o novo endere√ßo IP. <br><br>  A prop√≥sito, como todas as fun√ß√µes que temos ser√£o de natureza administrativa, para n√£o escrever constantemente antes de cada comando sudo, basta fazer login no minicomputador como root. <br><br>  Ao executar o <code>armbian-config</code> novamente, podemos ver o que mais pode ser configurado?  Na se√ß√£o Pessoal, podemos configurar o fuso hor√°rio, a localidade e o nome do host.  Adicionei o local ru_RU.UTF-8 UTF-8, que ser√° √∫til. <br><br>  Para que as configura√ß√µes sejam aplicadas, √© necess√°rio sair do utilit√°rio de configura√ß√£o, sair e efetuar login novamente ou reiniciar o servidor com o comando reboot. <br><br>  Usei o comando reboot para garantir que as configura√ß√µes foram salvas e o servidor iniciado com √™xito. <br><br>  A configura√ß√£o b√°sica do servidor foi feita e por que n√£o instalar o sistema operacional com o MicroSD OS na mem√≥ria Flash interna do EMMC?  Obviamente, se o seu mini computador tiver essa mem√≥ria a bordo. <br><br>  Para fazer isso, v√° para <code>armbian-config</code> - System - Install, selecione a unidade dispon√≠vel, pressione Enter, receba cumprimentos do passado, concorde e selecione o tipo de sistema de arquivo ext4. <br><br><img src="https://habrastorage.org/webt/yt/g4/ut/ytg4utinyttwtqoftarwnu-btv8.png"><br><br>  Agora podemos sentar e esperar at√© que o sistema operacional seja transferido para o armazenamento interno do minicomputador. <br><br><img src="https://habrastorage.org/webt/es/rz/0x/esrz0x4sqck7jn3sggbx6bba_yi.png"><br><br>  Ap√≥s a conclus√£o da c√≥pia, escolha desligar a energia.  Aguardamos alguns segundos at√© o LED do mini computador se apagar, desligar a alimenta√ß√£o, remover o cart√£o microSD, reconectar a alimenta√ß√£o e ligar o computador. <br><br>  Sim, se voc√™ n√£o possui mem√≥ria interna e n√£o transferiu o sistema operacional para ele, retirar um MicroSD provavelmente n√£o √© uma boa ideia. <br><br>  Depois de fazer login no nosso mini-computador via SSH e garantir que tudo funcione, voc√™ pode come√ßar a sintonizar a pr√≥pria esta√ß√£o de r√°dio. <br><br>  Primeiro, atualizamos as informa√ß√µes do pacote, direcionando o <code>apt update</code> para o console do servidor. <br><br>  Sim, eu amo o conforto, por isso instalo o mc com o comando <code>apt install mc</code> . <br>  Gosto de fazer tudo sob mc e, se precisar ver o console, basta pressionar ctrl + o. <br><br>  Primeiro, instale o pr√≥prio demon music player: <code>apt install mpd</code> . <br>  Um monte de depend√™ncias ser√£o instaladas com ele. <br><br>  Vamos seguir em frente.  O arquivo /etc/mpd.conf √© respons√°vel pela configura√ß√£o do daemon, abra-o com o <code>nano /etc/mpd.conf</code> . <br><br>  Meu nome de usu√°rio n√£o tem privil√©gios hzs e meu arquivo de configura√ß√£o √© mais ou menos assim: <br><br><pre> <code class="php hljs">music_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/music"</span></span> playlist_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/playlists"</span></span> db_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/tag_cache"</span></span> log_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd.log"</span></span> pid_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/pid"</span></span> state_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/state"</span></span> sticker_file <span class="hljs-string"><span class="hljs-string">"/var/lib/mpd/sticker.sql"</span></span> user <span class="hljs-string"><span class="hljs-string">"hzs"</span></span> bind_to_address <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> restore_paused <span class="hljs-string"><span class="hljs-string">"yes"</span></span> metadata_to_use <span class="hljs-string"><span class="hljs-string">"artist,title"</span></span> auto_update <span class="hljs-string"><span class="hljs-string">"yes"</span></span> audio_output { type <span class="hljs-string"><span class="hljs-string">"httpd"</span></span> name <span class="hljs-string"><span class="hljs-string">"My New Internet Radio Station!!!"</span></span> encoder <span class="hljs-string"><span class="hljs-string">"lame"</span></span> <span class="hljs-comment"><span class="hljs-comment"># optional, vorbis or lame port "8000" bind_to_address "0.0.0.0" # optional, IPv4 or IPv6 bitrate "256" # do not define if quality is defined format "44100:16:2" } volume_normalization "yes" filesystem_charset "UTF-8" id3v1_encoding "UTF-8"</span></span></code> </pre> <br>  Tudo est√° claro aqui e sem coment√°rios especiais. <br><br>  Para funcionar, voc√™ precisa criar uma estrutura de diret√≥rios a partir da parte superior das configura√ß√µes.  Observe que o propriet√°rio desses diret√≥rios deve ser um usu√°rio sem privil√©gios, de quem tudo funcionar√°, no meu caso hzs. <br><br>  Na raiz, execute os seguintes comandos: <br><br> <code>chown -cR hzs:hzs /home/hzs/music</code> <br> <code>chown -cR hzs:hzs /home/hzs/.mpd</code> <br> <br>  √â hora de fazer upload de m√∫sicas, temos SSH no servidor, para que possamos conectar nosso cliente FTP favorito ao nosso servidor. <br><br>  Sabemos o endere√ßo IP, a porta 22, o nome de usu√°rio e a senha que voc√™ especificou ao criar um usu√°rio n√£o privilegiado, o tipo de conex√£o SSH.  Coloque algumas m√∫sicas para o teste no diret√≥rio de m√∫sicas especificadas na configura√ß√£o. <br><br><img src="https://habrastorage.org/webt/hs/x6/wy/hsx6wyhf98bmwv5bvy5kkpdvogi.png"><br><br>  Agora o player √© iniciado com a configura√ß√£o errada, ent√£o paramos o daemon e o iniciamos novamente: <br><br> <code>service mpd stop</code> <br> <code>service mpd start</code> <br> <br>  Para o controle mais simples do daemon, <code>apt install mpc</code> utilit√°rio <code>apt install mpc</code> console usando o comando <code>apt install mpc</code> . <br><br>  Ap√≥s a instala√ß√£o, configuraremos um pouco o player: <br><br> <code>mpc random on</code> <br> <code>mpc repeat on</code> <br> <br>  Agora voc√™ precisa adicionar faixas e uma lista de reprodu√ß√£o, no console √© um pouco gimmorro, mas nada pode ser feito. <br><br>  Examinamos os arquivos dispon√≠veis, que podemos adicionar √† lista de reprodu√ß√£o: <br><br> <code>mpc ls</code> <br> <br>  Para adicionar um arquivo √† lista de reprodu√ß√£o, no comando <code>mpc add</code> , precisamos especificar o nome completo do arquivo a ser adicionado, a sele√ß√£o por m√°scara n√£o funciona: <br><br> <code>mpc add "01 Lost in Your Eyes.mp3"</code> <br> <br>  Observamos a lista de reprodu√ß√£o resultante: <br><br> <code>mpc playlist</code> <br> <br>  √â hora de lan√ßar nossa esta√ß√£o de r√°dio: <br><br> <code>mpc play</code> <br> <br><img src="https://habrastorage.org/webt/8p/gc/j5/8pgcj5ce-fqssnegu8svkdjqxwu.png"><br><br>  Vamos tentar ouvir, para isso, em qualquer reprodutor de √°udio, abrir o fluxo de √°udio da nossa esta√ß√£o de r√°dio.  Para fazer isso, digite o endere√ßo do fluxo <code>http://ip:port</code> , eu tenho <code>http://192.168.0.90:8000</code> . <br><br>  O Audacious tocou de forma intermitente, houve um problema com o cache, mas o SMPlayer e o VLC n√£o apresentaram problemas. <br><br><img src="https://habrastorage.org/webt/do/y_/e8/doy_e8rrunt7km5_eqddovxtp0c.png"><br><br><img src="https://habrastorage.org/webt/pl/dc/ec/pldcecft-jdoram8ixgsqbupi7o.png"><br><br><img src="https://habrastorage.org/webt/ff/j4/np/ffj4nptgv3ma90bakt63oyciqys.png"><br><br>  Em princ√≠pio, nesta fase, nossa esta√ß√£o de r√°dio da Internet j√° est√° funcionando, √© necess√°rio adicionar m√∫sica √† lista de reprodu√ß√£o e encaminhar as portas do roteador para que nossa esta√ß√£o de r√°dio da Internet se torne uma esta√ß√£o de r√°dio da Internet e n√£o um r√°dio na rede local. <br><br>  Como tenho v√°rios dom√≠nios, a primeira coisa que fa√ßo nas configura√ß√µes de DNS √© criar um registro ‚ÄúA‚Äù com testradio e o endere√ßo IP externo est√°tico do meu roteador em casa.  Voc√™ n√£o precisa fazer isso. <br><br>  Em seguida, no meu roteador, eu configuro o encaminhamento de porta. <br><br>  Como eu j√° tenho minha pr√≥pria esta√ß√£o de r√°dio em um servidor grande, especifique a porta de origem externa 9000 e a porta local interna 8000, portanto, de fora do r√°dio ser√° transmitido via <code>http://_ip:9000</code> . <br><br><img src="https://habrastorage.org/webt/z5/h5/vf/z5h5vf6bgcfm0k1t464-y9e1dlq.png"><br><br>  √â isso, agora temos uma esta√ß√£o de r√°dio na Internet "real". <br><br>  Se voc√™ n√£o quiser parar por a√≠, v√° mais longe. <br><br>  N√£o transmitimos a voz do DJ, mas, se necess√°rio, ela pode ser implementada, mas o que realmente √© necess√°rio √© uma interface de gerenciamento de playlist conveniente. <br><br>  Existem toneladas de consoles de gerenciamento, alguns podem ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">visualizados aqui</a> , mas usarei o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pitchfork MPD Client</a> . <br><br>  Este √© um focinho da web completo e, sim, dispararemos uma arma nos pardais e criaremos um servidor http completo em um mini computador com a nossa esta√ß√£o de r√°dio: <br><br> <code>apt install apache2</code> <br> <br>  Tamb√©m vamos precisar de PHP: <br><br> <code>apt-get install php</code> <br> <br>  Ainda precisa <br><br> <code>apt install php7.0-xml</code> <br> <br>  e <br><br> <code>apt install php-pear</code> <br> <br>  Criamos o diret√≥rio / home / hzs / wwwroot / pf na pasta inicial e descompactamos nele o Pitchfork MPD Client carregado anteriormente via SSH. <br><br><img src="https://habrastorage.org/webt/vt/3j/wh/vt3jwhnfoip8vuciat5mtbjja44.png"><br><br>  No arquivo de configura√ß√£o do servidor web apache2 /etc/apache2/sites-available/000-default.conf <br> <code>nano /etc/apache2/sites-available/000-default.conf</code> <br>  cortamos tudo e escrevemos (n√£o esque√ßa de mudar "hzs" para o seu nome de usu√°rio): <br><br><pre> <code class="php hljs">&lt;VirtualHost *:<span class="hljs-number"><span class="hljs-number">80</span></span>&gt; ServerName localhost ServerAdmin webmaster@localhost DocumentRoot /home/hzs/wwwroot &lt;Directory /home/hzs/wwwroot/&gt; Options All AllowOverride All DirectoryIndex index.php index.html index.htm Order Allow,Deny Allow from All <span class="hljs-keyword"><span class="hljs-keyword">Require</span></span> all granted &lt;/Directory&gt; &lt;/VirtualHost&gt;</code> </pre> <br>  Ent√£o reiniciamos o servidor http <br><br> <code>service apache2 restart</code> <br> <br>  Indo para o endere√ßo do seu servidor IP / pf (no meu caso: <code>http://192.168.0.90/pf</code> ) <br><br>  Vamos ver o painel de controle: <br><br><img src="https://habrastorage.org/webt/wf/ch/a-/wfcha-qsfl5kbftdhelmpue4a0s.png"><br><br>  Tudo √© bastante simples e intuitivo. <br><br>  Em seguida, clique no √≠cone da pasta √† direita e na guia Sistema de arquivos. <br><br>  Para atualizar a lista de arquivos, clique no bot√£o Atualizar banco de dados, selecione os arquivos restantes que ainda n√£o temos na lista de reprodu√ß√£o e clique no bot√£o Adicionar um pouco mais. <br><br>  Atualizamos a p√°gina e vemos que todos os arquivos que adicionamos √† playlist: <br><br><img src="https://habrastorage.org/webt/d4/iz/vm/d4izvmjxin4-aapy4fxwvelnbxk.png"><br><br>  Se voc√™ precisar ocultar o controle do player com uma senha, poder√° editar o arquivo de configura√ß√£o: <br><br> <code>nano /home/hzs/wwwroot/pf/config/config.xml</code> <br> <br>  Existe uma estrutura de configura√ß√µes completamente compreens√≠vel. <br><br>  Portanto, temos um servidor de servidor de r√°dio na Internet completo medindo 10 * 7 * 3 cent√≠metros.  Obviamente, o servidor de baixa pot√™ncia usado n√£o atrai centenas de ouvintes, mas pelo menos n√£o o deixa sem a sua m√∫sica favorita onde quer que esteja, se houver Internet por perto. <br><br>  Em princ√≠pio, voc√™ n√£o pode continuar lendo, mas para aqueles que s√£o especialmente persistentes, continuamos. <br>  Temos um servidor web completo, por que ... <br>  Bem, voc√™ j√° entende. <br><br>  Crie o diret√≥rio testradio na raiz do nosso servidor web, crie o arquivo <code>"index.php"</code> nele: <br><br><pre> <code class="php hljs">&lt;!DOCTYPE html&gt; &lt;html xmlns=<span class="hljs-string"><span class="hljs-string">"https://www.w3.org/1999/xhtml"</span></span> xml:lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"ltr"</span></span>&gt; &lt;head&gt; &lt;meta http-equiv=<span class="hljs-string"><span class="hljs-string">"content-type"</span></span> content=<span class="hljs-string"><span class="hljs-string">"text/html; charset=utf-8"</span></span> /&gt; &lt;title&gt;My Test Radio&lt;/title&gt; &lt;script src=<span class="hljs-string"><span class="hljs-string">"jquery-3.3.1.min.js"</span></span>&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;My Test Radio&lt;/h1&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"song"</span></span>&gt; now playing:&lt;br&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"title"</span></span>&gt;now playing&lt;/div&gt; &lt;br&gt; &lt;div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"play"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Play&lt;/span&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"pause"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Pause&lt;/span&gt; &lt;/div&gt; &lt;br&gt; &lt;div&gt; vol:&lt;br&gt; &lt;input id=<span class="hljs-string"><span class="hljs-string">"volume"</span></span> type=<span class="hljs-string"><span class="hljs-string">"range"</span></span> min=<span class="hljs-string"><span class="hljs-string">"0"</span></span> max=<span class="hljs-string"><span class="hljs-string">"10"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span> /&gt; &lt;/div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"duration"</span></span>&gt;&lt;/span&gt; &lt;br&gt; &lt;div&gt;<span class="hljs-number"><span class="hljs-number">256</span></span> kbps&lt;/div&gt; &lt;/div&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> audio = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Audio(<span class="hljs-string"><span class="hljs-string">'http://testradio.nisel.ru:9000'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> play = document.getElementById(<span class="hljs-string"><span class="hljs-string">'play'</span></span>); play.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.play(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pause = document.getElementById(<span class="hljs-string"><span class="hljs-string">'pause'</span></span>); pause.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.pause(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> volume = document.getElementById(<span class="hljs-string"><span class="hljs-string">'volume'</span></span>); volume.addEventListener(<span class="hljs-string"><span class="hljs-string">'change'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ audio.volume = parseFloat(this.value / <span class="hljs-number"><span class="hljs-number">10</span></span>); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); audio.addEventListener(<span class="hljs-string"><span class="hljs-string">"timeupdate"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duration = document.getElementById(<span class="hljs-string"><span class="hljs-string">'duration'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = parseInt(audio.currentTime % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">60</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">3600</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) s = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + s; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) m = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + m; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (h &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) h = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + h; duration.innerHTML = h + <span class="hljs-string"><span class="hljs-string">':'</span></span> + m + <span class="hljs-string"><span class="hljs-string">':'</span></span> + s; }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); &lt;/script&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $.ajax({ url: <span class="hljs-string"><span class="hljs-string">"trackname.php"</span></span>, cache: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, success: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(html)</span></span></span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#title"</span></span>).html(html); } }); } $(document).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ show(); setInterval(<span class="hljs-string"><span class="hljs-string">'show()'</span></span>,<span class="hljs-number"><span class="hljs-number">5000</span></span>); }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre> <br>  Este √© o exemplo mais simples de cria√ß√£o de um player para um site. Ele tamb√©m pode exibir o nome da composi√ß√£o atual, atualizada com ajax a cada 5 segundos. <br><br>  A apar√™ncia pode ser finalizada a gosto usando o css. <br><br>  O c√≥digo mostra que o fluxo de √°udio j√° est√° indo para o endere√ßo especificado no DNS do meu dom√≠nio. <br>  N√£o esque√ßa de soltar o arquivo jquery no diret√≥rio (no meu caso, jquery-3.3.1.min.js).  Em geral, √© claro, o jquery √© demais aqui e √© poss√≠vel fazer uma solicita√ß√£o do ajax sem ele, mas acabou sendo muito pregui√ßoso para pensar e eu usei um c√≥digo j√° pronto. <br><br>  Em seguida, crie o arquivo <code>"trackname.php"</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> file_get_contents(<span class="hljs-string"><span class="hljs-string">'http://192.168.0.90/mpc'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Tamb√©m na raiz do servidor web, criamos o diret√≥rio "mpc" e o arquivo <code>"index.php"</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> exec(<span class="hljs-string"><span class="hljs-string">'mpc current'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Por que alguns podem pedir muletas, o fato √© que, na minha esta√ß√£o de r√°dio militar, o servidor do jogador est√° no mesmo servidor e a face da web do site est√° em um servidor da web fisicamente diferente. <br><br><img src="https://habrastorage.org/webt/sl/mg/eq/slmgeqlpij1qqccf75z2yfurvy4.png"><br><br>  Como voc√™ precisa interrogar a faixa que est√° sendo reproduzida diretamente no servidor com o player, o diret√≥rio do servidor da web mpc deve estar nele e o arquivo <code>"trackname.php"</code> est√° no servidor da web do pr√≥prio site e faz o upload do arquivo com a descri√ß√£o da faixa de outro servidor para o seu endere√ßo IP. <br><br>  O pr√≥prio reprodutor e o site da esta√ß√£o de r√°dio podem estar muito distantes e se comunicar tanto em endere√ßos IP externos quanto em endere√ßos obstru√≠dos pelo DNS.  Para que tudo funcione, voc√™ s√≥ precisa encaminhar as portas corretamente. <br><br>  Voc√™ pode modificar o projeto ao seu gosto, bem, tive uma agrad√°vel tarde de s√°bado. <br>  Todas as experi√™ncias bem-sucedidas! <br><br>  <b>UPD2: Um experimento de uma semana chegou √† sua conclus√£o l√≥gica e eu desligo meu mini servidor com uma esta√ß√£o de r√°dio.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426349/">https://habr.com/ru/post/pt426349/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426339/index.html">25 de outubro de 2018 - Reuni√£o do Grupo de Usu√°rios Atlassian em Raiffeisenbank</a></li>
<li><a href="../pt426341/index.html">Memorizando o kwarg padr√£o no Python</a></li>
<li><a href="../pt426343/index.html">Regras de comportamento cavalheiresco em TI: a hist√≥ria do ITIL</a></li>
<li><a href="../pt426345/index.html">Enigmas interessantes de entrevistas t√©cnicas</a></li>
<li><a href="../pt426347/index.html">ITMO University Digest: Novos Estudos, Experi√™ncia de Alumni e Projetos Internacionais</a></li>
<li><a href="../pt426351/index.html">Altera√ß√µes nas certifica√ß√µes e exames da Microsoft</a></li>
<li><a href="../pt426355/index.html">Fun√ß√£o Math.Sin (dupla) para GPU</a></li>
<li><a href="../pt426357/index.html">Unity & Vive: Tutorial</a></li>
<li><a href="../pt426359/index.html">Iniciativa antipirataria Yandex n√£o aprovada pelos detentores de direitos autorais</a></li>
<li><a href="../pt426361/index.html">Sobre a maravilha da abelha e como a matamos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>