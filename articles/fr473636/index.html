<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧕 👨‍👩‍👧‍👧 ✡️ Télécharger 16 Go de torrent via tablette avec 4 Go d'espace libre 🙋🏻 🤚🏻 🧖🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Défi: 


 Il y a un PC sans Internet mais il est possible de transférer le fichier via USB. Il existe une tablette avec Internet à partir de laquelle ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Télécharger 16 Go de torrent via tablette avec 4 Go d'espace libre</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473636/"><p><img src="https://habrastorage.org/webt/wr/vp/h0/wrvph0mo5udgxojltbbxmiur0dm.png"></p><br><p>  <strong>Défi:</strong> </p><br><p>  Il y a un PC sans Internet mais il est possible de transférer le fichier via USB.  Il existe une tablette avec Internet à partir de laquelle ce fichier peut être transféré.  Sur la tablette, vous pouvez télécharger le torrent souhaité mais pas assez d'espace libre.  Le fichier dans le torrent est unique et volumineux. </p><br><p>  <strong>Chemin vers la solution:</strong> </p><br><p>  J'ai commencé le torrent à télécharger.  Lorsque l'espace libre a presque pris fin, j'ai interrompu le téléchargement.  J'ai connecté la tablette au PC et déplacé le fichier de la tablette vers le PC.  Il marqua une pause et, à ma grande surprise, le fichier fut de nouveau créé et le torrent continua de se balancer plus loin comme si de rien n'était. </p><br><p>  Étant donné que le client torrent définit l'indicateur clairsemé dans un fichier dans lequel il écrit les données reçues, le système n'essaie pas immédiatement de réserver 16 Go et il n'y aura aucune erreur lors de la tentative d'écriture dans un fichier au-delà de 4 Go. </p><br><p>  Répétant la procédure quatre fois, j'ai reçu quatre fichiers sur le PC dans lesquels différentes parties du même torrent.  Reste maintenant à les assembler.  La procédure est essentiellement simple.  Il est nécessaire de remplacer zéro octet par une autre valeur s'il se trouve à cette position dans l'un des quatre fichiers. </p><br><p>  Il me semblait qu'un programme aussi simple devrait être sur Internet.  Vraiment personne n'a fait face à une telle tâche?  Mais j'ai réalisé que je ne savais même pas quels mots clés rechercher.  Par conséquent, j'ai rapidement lancé un script Lua pour cette tâche et maintenant je l'ai optimisé.  Je veux le partager. </p><a name="habracut"></a><br><h2 id="zagruzhaem-torrent-po-chastyam">  Télécharger torrent en plusieurs parties </h2><br><ol><li>  commencer à télécharger torrent sur le premier appareil </li><li>  attendez que la ROM soit remplie </li><li>  interrompre le téléchargement </li><li>  transférer le fichier vers le deuxième appareil et ajouter un chiffre au nom du fichier </li><li>  revenir au premier point jusqu'à ce que le fichier soit complètement téléchargé </li></ol><br><h2 id="slivaem-chasti-v-odin-fayl">  Fusionner des pièces en un seul fichier </h2><br><p>  Une fois la dernière partie reçue, il est nécessaire de les rassembler dans un fichier entier. </p><br><p>  La tâche est simple: </p><br><ol><li>  Lisez toutes les pièces en même temps </li><li>  Si dans une partie de la position, l'octet non nul est écrit dans la sortie, sinon nous écrivons zéro </li></ol><br><p> La fonction <code>merge_part</code> prend un tableau de flux <code>streams_in</code> partir duquel elle lit une partie de la taille <code>buffer_length</code> et renvoie le résultat de la fusion de parties de différents flux. </p><br><pre> <code class="lua hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">merge_part</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(streams_in, buffer_length)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> out_part <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, stream <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ipairs</span></span>(streams_in) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> in_part = stream:<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>(buffer_length) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> out_part <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> out_part = in_part <span class="hljs-comment"><span class="hljs-comment">--       elseif in_part and #in_part &gt; 0 then if #out_part &lt; #in_part then out_part, in_part = in_part, out_part end if out_part ~= in_part --   and in_part:find("[^\0]") --    in_part and out_part:find("\0", 1, true) --     out_part then local find_index = 1 --[[</span></span></code> </pre> <br><p>  La fonction <code>string.gsub</code> convient à la tâche car elle trouvera des morceaux remplis de zéros et mettra ce qui lui est transmis. </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] out_part = out_part:gsub("\0+", function(zero_string) if #in_part &lt; find_index then return --     end --[[</span></span></code> </pre> <br><p>  <code>string.gsub</code> ne passe pas la position à laquelle une correspondance a été trouvée.  Par conséquent, nous faisons une recherche parallèle pour la position <code>zero_string</code> utilisant la fonction <code>string.find</code> .  Il suffit de trouver le premier octet zéro. </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] local start_index = out_part:find("\0", find_index, true) find_index = start_index + #zero_string --[[</span></span></code> </pre> <br><p>  Maintenant, si <code>in_part</code> a des données pour <code>out_part</code> copiez-les. </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] if #in_part &gt;= start_index then local end_index = start_index + #zero_string - 1 --[[</span></span></code> </pre> <br><p>  Nous <code>in_part</code> la partie correspondant à la séquence de zéros de <code>in_part</code> . </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] local part = in_part:sub(start_index, end_index) if (part:byte(1) ~= 0) or part:find("[^\0]") then --[[</span></span></code> </pre> <br><p>  Il y a des données en <code>part</code> . </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] if #part == #zero_string then return part else --[[</span></span></code> </pre> <br><p>  <code>part</code> s'est avérée inférieure à une séquence de zéros.  Nous le complétons avec eux. </p><br><pre> <code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--]] return part..zero_string:sub(1, end_index - #in_part) end end end end) end end end return out_part end</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Ainsi, il a été possible de télécharger et d'assembler ce fichier sur un PC.  Après la fusion, j'ai sorti un fichier torrent de la tablette.  J'ai installé le client torrent sur le PC et vérifié le fichier avec. </p><br><p>  La dernière partie téléchargée sur la tablette peut être laissée sur la distribution, mais vous devez activer la vérification répétée des parties avant cela et décocher le fichier afin qu'il ne se télécharge plus. </p><br><p>  <strong>Utilisé:</strong> </p><br><ol><li>  Client Torrent Flud sur la tablette. </li><li>  Client torrent QBittorent sur PC. </li><li>  <a href="">Script Lua</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr473636/">https://habr.com/ru/post/fr473636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr473626/index.html">«Le développeur veut acheter un avion dans trois ans. Ma tâche est de l'aider »- Denis Pushkin sur la motivation Skyeng</a></li>
<li><a href="../fr473628/index.html">C ++ au service de l'orthodontie: entretien avec Mikhail Matrosov, développeur CAO chez Align Technology</a></li>
<li><a href="../fr473630/index.html">Meilleures pratiques et outils pour développer des applications iOS</a></li>
<li><a href="../fr473632/index.html">Nous avons vu un article sur Habr</a></li>
<li><a href="../fr473634/index.html">Les lobbies de Comcast interdisent le cryptage DNS</a></li>
<li><a href="../fr473638/index.html">Shader n'est pas magique. Écriture de shaders dans Unity. Présentation</a></li>
<li><a href="../fr473640/index.html">Coucher de soleil Big Data</a></li>
<li><a href="../fr473642/index.html">Cribble Crabble Gradle: Auto-Build Magic</a></li>
<li><a href="../fr473646/index.html">Hackathon dans une petite entreprise: comment organiser sans vider un train de ressources</a></li>
<li><a href="../fr473648/index.html">Le cheval est mort - Cri: transition du tslint au eslint</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>