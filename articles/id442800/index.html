<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ–¼ï¸ ğŸ‘©ğŸ¾â€âœˆï¸ ğŸ“¯ Bot Telegram sederhana dengan Python dalam 30 menit ğŸ‘¨ğŸ¿â€âš•ï¸ ğŸ”¢ ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tentang HabrÃ©, dan bukan hanya itu, sudah banyak yang dikatakan tentang bot yang bahkan terlalu banyak. Tetapi setelah menjadi tertarik pada topik ini...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bot Telegram sederhana dengan Python dalam 30 menit</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442800/">  Tentang HabrÃ©, dan bukan hanya itu, sudah banyak yang dikatakan tentang bot yang bahkan terlalu banyak.  Tetapi setelah menjadi tertarik pada topik ini beberapa minggu yang lalu, saya masih tidak dapat menemukan materi normal: semua artikel baik untuk boneka sama sekali dan terbatas untuk mengirim pesan sebagai tanggapan terhadap pesan pengguna, atau tidak relevan.  Ini mendorong saya untuk menulis artikel yang akan menjelaskan kepada seorang pemula seperti saya cara menulis dan meluncurkan bot yang kurang lebih bermakna (dengan kemungkinan memperluas fungsionalitas). <br><br><a name="habracut"></a><h3>  Bagian 1: Daftarkan bot </h3><br>  Bagian paling sederhana dan paling dijelaskan.  Sangat singkat: Anda perlu menemukan bot <i>@BotFather</i> , menulisnya <i>/ mulai</i> , atau <i>/ newbot</i> , mengisi bidang yang ia minta (nama bot dan nama pendek), dan mendapatkan pesan dengan token bot dan tautan ke dokumentasi.  Token harus disimpan, sebaiknya dapat diandalkan, karena ini adalah satu-satunya kunci untuk mengotorisasi bot dan berinteraksi dengannya. <br><br><h3>  Bagian 2: Bersiap untuk Menulis Kode </h3><br>  Seperti yang telah disebutkan dalam judul, kita akan menulis bot dengan Python.  Artikel ini akan menjelaskan cara bekerja dengan perpustakaan PyTelegramBotAPI (Telebot).  Jika Anda tidak menginstal Python, maka pertama-tama Anda harus melakukan ini: di terminal Linux, Anda harus memasukkan <br><br><pre><code class="bash hljs">sudo apt-get install python python-pip</code> </pre> <br>  Jika Anda menggunakan Windows, maka Anda perlu mengunduh Python dari situs resmi. <br><br>  Setelah, di terminal Linux, atau prompt perintah Windows, masukkan <br><br><pre> <code class="bash hljs">pip install pytelegrambotapi</code> </pre> <br>  Sekarang Anda siap untuk menulis kode. <br><br><h3>  Bagian 3: Menerima pesan dan mengatakan "Halo" </h3><br>  <i>Penyimpangan kecil.</i>  <i>Telegram dapat memberi tahu bot tentang tindakan pengguna dengan dua cara: melalui respons terhadap permintaan server (Long Poll), dan melalui Webhook, ketika server Telegram sendiri mengirimkan pesan yang seseorang tulis ke bot.</i>  <i>Metode kedua jelas terlihat lebih baik, tetapi membutuhkan alamat IP khusus, dan SSL diinstal pada server.</i>  <i>Pada artikel ini saya ingin berbicara tentang menulis bot, tidak menyiapkan server, jadi kami akan menggunakan Long Poll.</i> <br><br>  Buka editor teks favorit Anda, dan mari kita menulis kode bot! <br><br>  Hal pertama yang harus dilakukan adalah mengimpor perpustakaan kami dan menghubungkan token bot: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> telebot; bot = telebot.TeleBot(<span class="hljs-string"><span class="hljs-string">'% %'</span></span>);</code> </pre> <br>  Sekarang nyatakan metode untuk menerima pesan teks: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(content_types=['text']) def get_text_messages(message):</span></span></code> </pre> <br>  Di bagian kode ini, kami menyatakan pendengar untuk pesan teks dan metode untuk memprosesnya.  Bidang content_types dapat mengambil nilai yang berbeda, dan tidak hanya satu, misalnya <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@bot.message_handler(content_types=['text', 'document', 'audio'])</span></span></code> </pre> <br>  Akan menanggapi pesan teks, dokumen, dan audio.  Rincian lebih lanjut dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi resmi.</a> <br><br>  Sekarang kami akan menambahkan sedikit fungsionalitas ke metode kami: jika pengguna menulis "Halo" kepada kami, maka kami akan mengatakan "Halo, bagaimana saya bisa membantu Anda?", Dan jika mereka menulis kepada kami perintah "/ bantuan", kami akan memberi tahu pengguna untuk menulis "Halo": <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text == <span class="hljs-string"><span class="hljs-string">""</span></span>: bot.send_message(message.from_user.id, <span class="hljs-string"><span class="hljs-string">",     ?"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> message.text == <span class="hljs-string"><span class="hljs-string">"/help"</span></span>: bot.send_message(message.from_user.id, <span class="hljs-string"><span class="hljs-string">" "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: bot.send_message(message.from_user.id, <span class="hljs-string"><span class="hljs-string">"   .  /help."</span></span>)</code> </pre> <br>  Sepotong kode ini tidak memerlukan komentar, menurut saya.  Sekarang kita perlu menambahkan hanya satu baris ke kode kita (di luar semua metode). <br><br><pre> <code class="python hljs">bot.polling(none_stop=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, interval=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Sekarang bot kami akan terus-menerus bertanya kepada server Telegram â€œApakah seseorang menulis kepada saya?â€ Dan jika kami menulis ke bot kami, Telegram akan mengirimkannya pesan kami.  Kami menyimpan seluruh file, dan menulis di konsol <br><br><pre> <code class="bash hljs">python bot.py</code> </pre> <br>  Di mana bot.py adalah nama file kami. <br><br>  Sekarang Anda dapat menulis bot dan melihat hasilnya: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ho/oo/c8/hoooc8j1mwnptnjfde8ll7nqzea.jpeg" alt="gambar" width="360"></div><br><h3>  Bagian 4: Tombol dan utas pesan </h3><br>  Mengirim pesan tidak diragukan lagi menyenangkan, tetapi bahkan lebih menyenangkan untuk berdialog dengan pengguna: ajukan pertanyaan kepadanya dan dapatkan jawabannya.  Misalkan sekarang bot kita akan menanyakan nama, nama keluarga, dan umur pengguna.  Untuk ini kita akan menggunakan metode register_next_step_handler bot: <br><br><pre> <code class="python hljs">name = <span class="hljs-string"><span class="hljs-string">''</span></span>; surname = <span class="hljs-string"><span class="hljs-string">''</span></span>; age = <span class="hljs-number"><span class="hljs-number">0</span></span>; @bot.message_handler(content_types=[<span class="hljs-string"><span class="hljs-string">'text'</span></span>]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> message.text == <span class="hljs-string"><span class="hljs-string">'/reg'</span></span>: bot.send_message(message.from_user.id, <span class="hljs-string"><span class="hljs-string">"  ?"</span></span>); bot.register_next_step_handler(message, get_name); <span class="hljs-comment"><span class="hljs-comment">#  â€“  get_name else: bot.send_message(message.from_user.id, ' /reg'); def get_name(message): #  global name; name = message.text; bot.send_message(message.from_user.id, '   ?'); bot.register_next_step_handler(message, get_surnme); def get_surname(message): global surname; surname = message.text; bot.send_message('  ?'); bot.register_next_step_handler(message, get_age); def get_age(message): global age; while age == 0: #    try: age = int(message.text) #,     except Exception: bot.send_message(message.from_user.id, ', '); bot.send_message(message.from_user.id, ' '+str(age)+' ,   '+name+' '+surname+'?')</span></span></code> </pre><br>  Jadi, kami mencatat data pengguna.  Contoh ini menunjukkan contoh yang sangat sederhana, untuk kebaikan, Anda perlu menyimpan data perantara dan status pengguna dalam basis data, tetapi hari ini kami bekerja dengan bot dan bukan dengan basis data.  Sentuhan terakhir - kami meminta pengguna untuk mengonfirmasi bahwa semuanya dimasukkan dengan benar, tetapi tidak hanya seperti itu, tetapi dengan tombol!  Untuk melakukan ini, edit sedikit kode metode get_age <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_age</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> age; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> age == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">#    try: age = int(message.text) #,     except Exception: bot.send_message(message.from_user.id, ', '); keyboard = types.InlineKeyboardMarkup(); #  key_yes = types.InlineKeyboardButton(text='', callback_data='yes'); # Â«Â» keyboard.add(key_yes); #    key_no= types.InlineKeyboardButton(text='', callback_data='no'); keyboard.add(key_no); question = ' '+str(age)+' ,   '+name+' '+surname+'?'; bot.send_message(message.from_user.id, text=question, reply_markup=keyboard)</span></span></code> </pre><br>  Dan sekarang bot kami mengirimkan keyboard, tetapi jika Anda mengkliknya, maka tidak ada yang terjadi.  Karena kami tidak menulis metode penanganan.  Mari menulis: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@bot.callback_query_handler(func=lambda call: True) def callback_worker(call): if call.data == "yes": #call.data  callback_data,       .... #  ,    bot.send_message(call.message.chat.id, ' : )'); elif call.data == "no": ... #</span></span></code> </pre><br>  Tetap hanya menambahkan satu baris ke awal file: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> telebot <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> types</code> </pre> <br>  Itu saja, simpan dan jalankan bot kami: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/gb/1t/ltgb1tt3oizmmk92_kr7r2ztkom.jpeg" alt="gambar" width="360"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442800/">https://habr.com/ru/post/id442800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442788/index.html">Mengapa kita membutuhkan sistem pemantauan pada sebuah chip</a></li>
<li><a href="../id442790/index.html">Pendaftaran terbuka untuk Allure Server Meetup di St. Petersburg</a></li>
<li><a href="../id442794/index.html">Kami mengundang Anda ke konferensi "(TI) arsitek dalam proyek dan organisasi TI"</a></li>
<li><a href="../id442796/index.html">Survei: Teknologi cloud dalam layanan GIS dan geodata</a></li>
<li><a href="../id442798/index.html">Memantau ping antara host Kubernetes adalah resep kami</a></li>
<li><a href="../id442804/index.html">MVCC-1. Isolasi</a></li>
<li><a href="../id442806/index.html">Program pendahuluan DUMP-2019 siap. Pembicara dari Evil Martians, Tinkoff.ru, HTML Academy, SkyEng, 2GIS</a></li>
<li><a href="../id442808/index.html">Kami mengundang Anda ke Pesta Droid - pertemuan yang membahas masalah praktis pengembangan aplikasi dan perangkat Android</a></li>
<li><a href="../id442810/index.html">Mitos Fisika Populer, melanjutkan: Gravity</a></li>
<li><a href="../id442812/index.html">"Saya tidak melihat alasan untuk menggunakan Python untuk bekerja dengan Spark, kecuali kemalasan"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>