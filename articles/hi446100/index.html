<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯМ╜ ЁЯСЗЁЯП╜ ЁЯШИ Excel рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ Android рдФрд░ iOS рд╕реНрдерд╛рдиреАрдпрдХрд░рдг рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдПрдБ тЭФ ЁЯШ▒ ЁЯСйЁЯП╜тАНЁЯФм</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╣реИрд▓реЛ, рдореЗрд░рд╛ рдирд╛рдо рдЕрд▓реЗрдХреНрдЬреЗрдВрдбрд░ рд╣реИ рдФрд░ рдореИрдВ рдПрдХ Android рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбреЗрд╡рд▓рдкрд░ рд╣реВрдВред рдПрдХ рдмрд╛рд░ рдореБрдЭреЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдорд┐рд▓рд╛ рдЬрд┐рд╕рдореЗрдВ 11 рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рднрд╛рд╖рд╛рдПрдВ рдФрд░ 600 рд╕реЗ рдЕрдзрд┐рдХ рд▓рд╛рдЗрдиреЗрдВ рдереАрдВ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Excel рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ Android рдФрд░ iOS рд╕реНрдерд╛рдиреАрдпрдХрд░рдг рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдПрдБ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446100/"><p><img src="https://habrastorage.org/webt/21/wm/80/21wm80y7vs8vlbtqiitqymhyuok.jpeg" alt="рдЫрд╡рд┐"></p><br><p>  рд╣реИрд▓реЛ, рдореЗрд░рд╛ рдирд╛рдо рдЕрд▓реЗрдХреНрдЬреЗрдВрдбрд░ рд╣реИ рдФрд░ рдореИрдВ рдПрдХ Android рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбреЗрд╡рд▓рдкрд░ рд╣реВрдВред  рдПрдХ рдмрд╛рд░ рдореБрдЭреЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдорд┐рд▓рд╛ рдЬрд┐рд╕рдореЗрдВ 11 рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рднрд╛рд╖рд╛рдПрдВ рдФрд░ 600 рд╕реЗ рдЕрдзрд┐рдХ рд▓рд╛рдЗрдиреЗрдВ рдереАрдВред  рдЧреНрд░рд╛рд╣рдХ рдкрдХреНрд╖ рдореЗрдВ рдХреЛрдИ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдирд╣реАрдВ рдереЗ, рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЛрдВрдиреЗ рдкреВрд░реА рдЪреАрдЬрд╝ рдХреЛ рдПрдХреНрд╕реЗрд▓ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ред  рдЬрдм рдЙрдиреНрд╣реЛрдВрдиреЗ рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрджрд▓рд╛рд╡ рдХрд┐рдпрд╛, рддреЛ рдЙрдиреНрд╣реЛрдВрдиреЗ рдпрд╣ рддрд╛рд▓рд┐рдХрд╛ "рд╣рдо рдкреАрд▓реЗ рд░рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд╕рд╛рде рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдХреНрд░рдорд╢рдГ рдПрдВрдбреНрд░реЙрдЗрдб рдФрд░ рдЖрдИрдУрдПрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВред"  рдЙрд╕рдХреЗ рдмрд╛рдж, рджреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдХреБрдЫ рдШрдВрдЯреЗ рдЦреЛ рджрд┐рдП, рдЬрд┐рд╕рд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрдПред  рдФрд░ рдлрд┐рд░ рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рдиреЗ рдХрд╣реАрдВ рдХреБрдЫ рднреВрд▓ рдХреА рдереА, рдПрдХ рдЧрд▓рддреА рдХреА рдереА рдпрд╛ рдЗрд╕реЗ рдЦрддреНрдо рдирд╣реАрдВ рдХрд┐рдпрд╛ рдерд╛, рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рдмреАрдЪ рд╡рд┐рд╕рдВрдЧрддрд┐рдпрд╛рдВ рдереАрдВ, рдЧреНрд░рд╛рд╣рдХ рдШрдмрд░рд╛рдП рд╣реБрдП рдереЗ, рдбреЗрд╡рд▓рдкрд░реНрд╕ рдмрд╛рд╣рд░ рдлреНрд░рд┐рдХ рдХрд░ рд░рд╣реЗ рдереЗред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдиреЗ рдореБрдЭреЗ рд░реВрдЯ рдкрд░ рд╕реВрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛, рдореИрдВрдиреЗ рдПрдХреНрд╕реЗрд▓ рд╕реЗ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рдЙрддрд╛рд░рдиреЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреА рддрд▓рд╛рд╢ рд╢реБрд░реВ рдХреАред  рдкрд░рд┐рдгрд╛рдо рдорд╣рд╛рди VBScript рдХреЛрдб рдерд╛, рдЬрд┐рд╕реЗ рд╣рдо рдЕрднреА рднреА рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЖрдирдВрдж рд▓реЗрддреЗ рд╣реИрдВред  рдЕрдм рдореИрдВ рдЗрд╕ рд▓рд┐рдкрд┐ рдХреЛ рдЖрдкрдХреЗ рд╕рд╛рдордиреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░реВрдВрдЧрд╛ред  рдХрдЯ рдХреЗ рддрд╣рдд, рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЪрд┐рддреНрд░ рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдбред </p><a name="habracut"></a><br><p>  рдЗрд╕рд▓рд┐рдП, рдкрд╣рд▓реЗ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рд╕реНрд╡рдпрдВ рджреЗрдЦреЗрдВ рдФрд░ рд╕рдорд╕реНрдпрд╛ рдХреЗ рдкреИрдорд╛рдиреЗ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ: </p><br><p><img src="https://habrastorage.org/webt/ub/sm/ky/ubsmkyvbqtrt0iq7mfwfwo8prtq.png" alt="рдЫрд╡рд┐"></p><br><p>  рд╡рд╣рд╛рдБ рд╡рд╣ рд╣реИ, рд╕реМрдВрджрд░реНрдп!  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдИ рд╕рд░реНрд╡рд┐рд╕ рдХреЙрд▓рдо, рдЧреНрд▓реЛрдмрд▓ рд▓рд╛рдЗрди рдХреЗ рдирд╛рдо рдФрд░ рдЙрдирдХреЗ рдЕрдиреБрд╡рд╛рдж рд╣реИрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рд▓рд╛рдЗрдиреЗрдВ рдХреЗрд╡рд▓ рдЕрдВрдЧреНрд░реЗрдЬреА рдФрд░ рдЬрд░реНрдорди рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рдВрд╕реНрдХрд░рдг 2.0 рдореЗрдВ рдЧреНрд░рд╛рд╣рдХ рдиреЗ рдХреЗрд╡рд▓ рджреЛ рднрд╛рд╖рд╛рдУрдВ рдХреЛ рдЕрднреА рдХреЗ рд▓рд┐рдП рдЫреЛрдбрд╝рдиреЗ рдФрд░ рдмрд╛рдХреА рдХреЛ рдмрд╛рдж рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред  рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдЕрдиреБрд╡рд╛рджрдХреЛрдВ рдХреЗ рдкреИрд╕реЗ рдкрд░ рджрдпрд╛ рдХрд░рддрд╛ рд╣реЛред  рд▓реЗрдХрд┐рди рдпрд╣ рдЙрд╕рдХрд╛ рд╡реНрдпрд╡рд╕рд╛рдп рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ред  рдпрд╣реА рд╣реИ, рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЦрд╛рд▓реА рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдРрд╕реА рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдП рдЦрд╛рд▓реА рд▓рд╛рдЗрдиреЗрдВ рдирд╣реАрдВ рдмрдирд╛рдиреА рдЪрд╛рд╣рд┐рдПред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реЗрд▓ F5 рдореЗрдВ "% s" рдЬреИрд╕реЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдкреНрд░рд╛рд░реВрдкрд┐рдд рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЙрдиреНрд╣реЗрдВ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЖрдИрдУрдПрд╕ рдореЗрдВ рдЬреЛ рдПрдВрдбреНрд░реЙрдЗрдб рдЕрдЪреНрдЫрд╛ рд╣реИ рдЙрд╕реЗ "% @" рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдореИрдВ рдЖрдкрдХреЛ рд░рд╛рд╕реНрддреЗ рдХреА рдЕрдиреНрдп рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рдКрдВрдЧрд╛ред </p><br><p>  рдкреВрдВрдЫ рд╕реЗ рдмрд┐рд▓реНрд▓реА рдХреЛ рди рд╣рдЯрд╛рдиреЗ рдФрд░ рди рдЦреАрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдЕрднреА рдкреВрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреЛрд╕реНрдЯ рдХрд░реВрдВрдЧрд╛: </p><br><div class="spoiler">  <b class="spoiler_title">рдЕрдкрдиреА рд╕рднреА рдорд╣рд┐рдорд╛ рдореЗрдВ VBScript</b> <div class="spoiler_text"><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">option</span></span> <span class="hljs-keyword"><span class="hljs-keyword">explicit</span></span> <span class="hljs-comment"><span class="hljs-comment">' Start it with: cscript ConvertExcelToTXTandXML.vbs If UCASE(right(wscript.fullname,11)) &lt;&gt; "CSCRIPT.EXE" Then Msgbox "Please enter: cscript ConvertExcelToTXTandXML.vbs &lt;filename&gt;.xlsx" WScript.Quit 255 End If ' The column of the key is 4 Const KeyColumn = 4 ' Names of destination files to create Const outFileiOS="\Localizable.strings" Const outFileiOSLocale="\InfoPlist.strings" Const outFileAndroid="\stringsToFormat.xml" Const NsCameraUsageDescription = "NsCameraUsageDescription" Const NSLocationAlwaysAndWhenInUseUsageDescription = "NSLocationAlwaysAndWhenInUseUsageDescription" Const NSLocationAlwaysUsageDescription = "NSLocationAlwaysUsageDescription" Const NSLocationWhenInUseUsageDescription = "NSLocationWhenInUseUsageDescription" Const NSPhotoLibraryAddUsageDescription = "NSPhotoLibraryAddUsageDescription" Const NSPhotoLibraryUsageDescription = "NSPhotoLibraryUsageDescription" Dim oExcel Dim oTranslations Dim objOutputFileiOS Dim objOutputFileiOSLocale Dim objFSO Dim objFSOandroid Dim objFSOios Dim myArgs Dim myParameter Dim sName Dim CompletePath Dim WorkingDir Dim WorkingDirAndroid Dim WorkingDirIos Dim LanguageColumnIndex Dim UsedRows Dim nCounter Dim xmlDoc Dim objIntro Dim objRoot Dim objHdr Dim objHdrAtt Dim theText Dim AndroidString Dim iOSString ' **************************************** ' MAKE PRETTY XML ' **************************************** Const strOutputFile = "\strings.xml" ' **************************************** Dim objInputFile, objOutputFile, strXML Dim objXML : Set objXML = WScript.CreateObject("Msxml2.DOMDocument") Dim objXSL : Set objXSL = WScript.CreateObject("Msxml2.DOMDocument") ' Create interface to Excel Set oExcel = CreateObject("Excel.application") ' Create the file interface Set objFSO=CreateObject("Scripting.FileSystemObject") ' Get the commandline parameter Set myArgs = WScript.Arguments.Unnamed If myArgs.count &gt; 0 Then If (not objFSO.FileExists(myArgs.item(0))) Then Wscript.Echo "Error: '" &amp; myArgs.item(0) &amp; "' not found" WScript.Quit 255 End If Set myParameter = objFSO.GetFile(myArgs.item(0)) sName = myParameter.Name CompletePath = myParameter.Path WorkingDir = myParameter.Path WorkingDir = Left(WorkingDir, Len(WorkingDir)-Len(sName)) WorkingDirAndroid = "res\" WorkingDirIos = "ios\" If Not objFSO.FolderExists(WorkingDir &amp; WorkingDirAndroid) Then ' Create folder if not exists' objFSO.CreateFolder(WorkingDir &amp; WorkingDirAndroid) End If If Not objFSO.FolderExists(WorkingDir &amp; WorkingDirIos) Then ' Create folder if not exists' objFSO.CreateFolder(WorkingDir &amp; WorkingDirIos) End If Else Wscript.Echo "Error: A filename is needed" WScript.Quit 255 End If ' Source file Set oTranslations = oExcel.Workbooks.Open(CompletePath) ' Get the maximum number of rows in the sheet UsedRows = oTranslations.Sheets(1).UsedRange.Rows.Count ' In this column start the start the languages' LanguageColumnIndex = 6 ' stop the processing when the cell is empty --&gt; end of languages while oTranslations.Sheets(1).Cells(3, LanguageColumnIndex) &lt;&gt; "" WScript.stdout.Write "Create files for: " WScript.stdout.Write oTranslations.Sheets(1).Cells(3, LanguageColumnIndex) WScript.stdout.Write " " objFSOandroid = oTranslations.Sheets(1).Cells(3, LanguageColumnIndex) If objFSOandroid = "values" Then objFSOios = "en" &amp; ".lproj" ElseIf objFSOandroid = "values-ru" Then objFSOios = "ru-RU" &amp; ".lproj" Else objFSOios = Right(objFSOandroid,2) &amp; ".lproj" End If WScript.stdout.Write "; iOs folder: " WScript.stdout.Write objFSOios If Not objFSO.FolderExists(WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid) Then ' Create folder if not exists' objFSO.CreateFolder(WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid) End If If Not objFSO.FolderExists(WorkingDir &amp; WorkingDirIos &amp; objFSOios) Then ' Create folder if not exists' objFSO.CreateFolder(WorkingDir &amp; WorkingDirIos &amp; objFSOios) End If ' Create the destination files Set objOutputFileiOS = CreateObject("ADODB.Stream") objOutputFileiOS.CharSet = "utf-8" objOutputFileiOS.Open Set objOutputFileiOSLocale = CreateObject("ADODB.Stream") objOutputFileiOSLocale.CharSet = "utf-8" objOutputFileiOSLocale.Open Set xmlDoc = CreateObject("Msxml2.DOMDocument") ' </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment"> chr(34) is " ' </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment"> vbCrLf is &lt;CR&gt;&lt;LF&gt; ' Create the XML header Set objIntro = xmlDoc.createProcessingInstruction("xml","version='1.0' encoding='UTF-8' standalone='yes'") xmlDoc.insertBefore objIntro,xmlDoc.childNodes(0) Set objRoot = xmlDoc.createElement("resources") xmlDoc.appendChild objRoot ' keys start in row 3!!! For nCounter = 3 To UsedRows WScript.stdout.Write "." If oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value &lt;&gt; "" Then ' Write to iOS file If Not oTranslations.Sheets(1).Cells(nCounter, LanguageColumnIndex).Value = "" Then objOutputFileiOS.WriteText chr(34) objOutputFileiOS.WriteText oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value objOutputFileiOS.WriteText chr(34) objOutputFileiOS.WriteText " = " objOutputFileiOS.WriteText chr(34) iOSString = Replace(oTranslations.Sheets(1).Cells(nCounter, LanguageColumnIndex).Value, "%s", "%@") iOSString = Replace(iOSString, "'", "\'") iOSString = Replace(iOSString, chr(34), "\" &amp; chr(34)) objOutputFileiOS.WriteText iOSString objOutputFileiOS.WriteText chr(34) objOutputFileiOS.WriteText ";" &amp; vbCrLf If ( (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NsCameraUsageDescription) _ or (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NSLocationAlwaysAndWhenInUseUsageDescription) _ or (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NSLocationAlwaysUsageDescription) _ or (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NSLocationWhenInUseUsageDescription) _ or (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NSPhotoLibraryAddUsageDescription) _ or (oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value = NSPhotoLibraryUsageDescription) _ ) Then objOutputFileiOSLocale.WriteText chr(34) objOutputFileiOSLocale.WriteText oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value objOutputFileiOSLocale.WriteText chr(34) objOutputFileiOSLocale.WriteText " = " objOutputFileiOSLocale.WriteText chr(34) objOutputFileiOSLocale.WriteText iOSString objOutputFileiOSLocale.WriteText chr(34) objOutputFileiOSLocale.WriteText ";" &amp; vbCrLf End If End If ' Write to Android file Set objHdr = xmlDoc.createElement("string") Set objHdrAtt = xmlDoc.createAttribute("name") objHdrAtt.text = oTranslations.Sheets(1).Cells(nCounter, KeyColumn).Value AndroidString =Replace (oTranslations.Sheets(1).Cells(nCounter, LanguageColumnIndex).Value, "'", "\'") AndroidString =Replace (oTranslations.Sheets(1).Cells(nCounter, LanguageColumnIndex).Value, Chr(10), "\n") If Not AndroidString = "" Then Set theText=xmlDoc.createTextNode(AndroidString) objHdr.setAttributeNode objHdrAtt objHdr.appendChild theText objRoot.appendChild objHdr End If End If Next ' Save the files xmlDoc.Save WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; outFileAndroid ' **************************************** ' Put whitespace between tags. (Required for XSL transformation.) ' **************************************** Set objInputFile = objFSO.OpenTextFile(WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; outFileAndroid,1,False,-2) Set objOutputFile = objFSO.CreateTextFile(WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; strOutputFile,True,False) strXML = objInputFile.ReadAll strXML = Replace(strXML,"&gt;&lt;","&gt;" &amp; vbCrLf &amp; "&lt;") objOutputFile.Write strXML objInputFile.Close objFSO.DeleteFile(WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; outFileAndroid) objOutputFile.Close ' **************************************** ' Create an XSL stylesheet for transformation. ' **************************************** Dim strStylesheet : strStylesheet = _ "&lt;xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform""&gt;" &amp; _ "&lt;xsl:output method=""xml"" indent=""yes""/&gt;" &amp; _ "&lt;xsl:template match=""/""&gt;" &amp; _ "&lt;xsl:copy-of select="".""/&gt;" &amp; _ "&lt;/xsl:template&gt;" &amp; _ "&lt;/xsl:stylesheet&gt;" ' **************************************** ' Transform the XML. ' **************************************** objXSL.loadXML strStylesheet objXML.load WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; strOutputFile objXML.transformNode objXSL objXML.save WorkingDir &amp; WorkingDirAndroid &amp; objFSOandroid &amp; strOutputFile ' **************************************** ' End transformation. ' **************************************** objOutputFileiOSLocale.SaveToFile WorkingDir &amp; WorkingDirIos &amp; objFSOios &amp; outFileiOSLocale, 2 objOutputFileiOS.SaveToFile WorkingDir &amp; WorkingDirIos &amp; objFSOios &amp; outFileiOS, 2 LanguageColumnIndex = LanguageColumnIndex + 1 WScript.stdout.Write vbCrLf wend oTranslations.Close oExcel.Quit WScript.Echo "With success done" WScript.Quit(0)</span></span></code> </pre> </div></div><br><p>  рдЕрдм рдмрд╛рд░реА рд╣реИ рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рд╕реЗ рдЧреБрдЬрд░рдиреЗ рдХреАред </p><br><p>  рд╣рдорд╛рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  IOS рдкрд░, рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣ Localizable.strings рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди InfoPlist.strings рдореЗрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣рдо рдЙрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рдирд╛рдореЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ InfoPlist рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: </p><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NsCameraUsageDescription = <span class="hljs-string"><span class="hljs-string">"NsCameraUsageDescription"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NSLocationAlwaysAndWhenInUseUsageDescription = <span class="hljs-string"><span class="hljs-string">"NSLocationAlwaysAndWhenInUseUsageDescription"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NSLocationAlwaysUsageDescription = <span class="hljs-string"><span class="hljs-string">"NSLocationAlwaysUsageDescription"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NSLocationWhenInUseUsageDescription = <span class="hljs-string"><span class="hljs-string">"NSLocationWhenInUseUsageDescription"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NSPhotoLibraryAddUsageDescription = <span class="hljs-string"><span class="hljs-string">"NSPhotoLibraryAddUsageDescription"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> NSPhotoLibraryUsageDescription = <span class="hljs-string"><span class="hljs-string">"NSPhotoLibraryUsageDescription"</span></span></code> </pre> <br><p>  рдЕрдЧрд▓рд╛ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рдЯреБрдХрдбрд╝рд╛ рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХрд╛ рдирд╛рдо рд╣реИ рдЬрд╣рд╛рдВ рд╕рднреА рдлрд╛рдЗрд▓реЗрдВ рд╕рд╣реЗрдЬреА рдЬрд╛рдПрдВрдЧреАред  IOS рдкрд░, рд╕рднреА рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЛ рджреЛ-рдЕрдХреНрд╖рд░ рднрд╛рд╖рд╛ рдкрджрдирд╛рдо рдХреЗ рд╕рд╛рде рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ "en.lproj", "de.lproj"ред  рд░реВрд╕реА рдХреЛ рдЫреЛрдбрд╝рдХрд░, рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ "рдЖрд░рдпреВ-рдЖрд░рдпреВ" рд╣реИред  рдФрд░ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╣реА, рдХреЙрд▓рдо рдПрдВрдбреНрд░реЙрдЗрдб рд╕рдВрдХреЗрддрди рдореЗрдВ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рдкрд╛рд░рд╕реАрдо: </p><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> objFSOandroid = <span class="hljs-string"><span class="hljs-string">"values"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> objFSOios = <span class="hljs-string"><span class="hljs-string">"en"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">".lproj"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ElseIf</span></span> objFSOandroid = <span class="hljs-string"><span class="hljs-string">"values-ru"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> objFSOios = <span class="hljs-string"><span class="hljs-string">"ru-RU"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">".lproj"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> objFSOios = <span class="hljs-built_in"><span class="hljs-built_in">Right</span></span>(objFSOandroid,<span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">".lproj"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span></code> </pre> <br><p>  рдФрд░ рдЕрдВрддрд┐рдо рдХрд╛рд░реНрдп, рд╡рд░реНрдгреЛрдВ рдХреЛ рдмрджрд▓рдирд╛ рдФрд░ рдмрдЪрдирд╛ред  IOS рдХреЗ рд▓рд┐рдП, рд╣рдо рдмрджрд▓реЗрдВрдЧреЗ, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдХрд╣рд╛, <strong>% s</strong> <strong>% @</strong> рдФрд░ рдмрдЪ рдЙрджреНрдзрд░рдг рдФрд░ рдПрдкреЛрд╕реНрдЯреНрд░реЛрдлрд┐рд╕: </p><br><pre> <code class="vbscript hljs">iOSString = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(oTranslations.Sheets(<span class="hljs-number"><span class="hljs-number">1</span></span>).Cells(nCounter, LanguageColumnIndex).Value, <span class="hljs-string"><span class="hljs-string">"%s"</span></span>, <span class="hljs-string"><span class="hljs-string">"%@"</span></span>) iOSString = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(iOSString, <span class="hljs-string"><span class="hljs-string">"'"</span></span>, <span class="hljs-string"><span class="hljs-string">"\'"</span></span>) iOSString = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(iOSString, <span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">34</span></span>), <span class="hljs-string"><span class="hljs-string">"\"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">34</span></span>))</code> </pre> <br><p>  рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдкреЛрд╕реНрдЯреНрд░реЛрдл рд╕реЗ рднреА рдмрдЪрддреЗ рд╣реИрдВ рдФрд░ рддрдерд╛рдХрдерд┐рдд рдиреНрдпреВ рдлреАрдб рдХреИрд░реЗрдХреНрдЯрд░ <strong>\ n рдХреЗ</strong> рд╕рд╛рде рддрдерд╛рдХрдерд┐рдд рд▓рд╛рдЗрди рдлреАрдб рдХреИрд░реЗрдХреНрдЯрд░ ( <strong>Chr (10)</strong> ) рдХреА рдЬрдЧрд╣ рд▓реЗрддреЗ рд╣реИрдВред  рдФрд░ рдЗрд╕рдХрд╛ рдПрдХ рдХрд╛рд░рдг рд╣реИред  рдПрдХ рд╕реЗрд▓ рдореЗрдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдордПрд╕ рд╡рд░реНрдб рдореЗрдВ рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХрд▓рд┐рдд рдПрдХ рдирд╣реАрдВ рдмрд▓реНрдХрд┐ рдмрдбрд╝реЗ рдкрд╛рда рд╣реИрдВ, рдФрд░ рддрдХрдиреАрдХреА рдХреЙрдкреА рдкреЗрд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд▓ рд╕реЗрд▓ рдореЗрдВ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред  рдФрд░ рдЬрдм рд╣рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдФрд░ рддреНрд░реБрдЯрд┐ рджреНрд╡рд╛рд░рд╛ рд╕рд╣реА рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдирд╣реАрдВ рдорд┐рд▓рд╛, рддреЛ рдЖрдИрдУрдПрд╕ рдореЗрдВ рдкрд╛рда рдХреЛ рдЖрд╡рд╢реНрдпрдХ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рдпрд╣ рдПрдХ рдкреИрд░рд╛рдЧреНрд░рд╛рдл рдореЗрдВ рд╡рд┐рд▓рдп рд╣реЛ рдЧрдпрд╛ред </p><br><h4 id="zaklyuchenie">  рдирд┐рд╖реНрдХрд░реНрд╖ </h4><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рд╢рд╛рдпрдж рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рдЪреБрдХреЗ рд╣реИрдВ, рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ рдЪрд▓рддреА рд╣реИред  рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ .xlsx рдлрд╝рд╛рдЗрд▓ рдХреЛ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВ, рд╡рд╣рд╛рдВ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдХрдорд╛рдВрдб рд▓рд┐рдЦреЗрдВ: </p><br><p> <code>cscript ConvertExcelToTXTandXML.vbs &lt;filename&gt;.xlsx</code> </p> <br><p>  рдЗрд╕рдХреЗ рдмрд╛рдж, Enter рджрдмрд╛рдПрдВ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд╡рд┐рдВрдбреЛ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдмрд┐рдВрджреБрдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдПрдХ рд╕реБрдВрджрд░ рджреГрд╢реНрдп рдХрд╛ рдЖрдирдВрдж рд▓реЗрдВред  рд╣рдорд╛рд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдЯрд╛рдЗрдЯреИрдирд┐рдХ рдХрд╛рд░реНрдп рдХрд╛ рдкрд░рд┐рдгрд╛рдо рджреЛ рдлрд╝реЛрд▓реНрдбрд░ рд╣реИрдВ, "рдЖрдИрдУрдПрд╕" рдФрд░ "рд░реЗрд╕", рдЬрд┐рдирдореЗрдВ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреНрд░рдорд╢рдГ рдЖрдИрдУрдПрд╕ рдФрд░ рдПрдВрдбреНрд░реЙрдЗрдб рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкрд░ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рд╣реИред </p><br><p>  рд╡рд╣ рд╕рдм рд╣реИред  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧреА рдФрд░ рдмрд╣реБрдд рд╕рдордп рдмрдЪрд╛рдПрдЧреАред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi446100/">https://habr.com/ru/post/hi446100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi446090/index.html">GSM + GPS рдореЙрдбреНрдпреВрд▓ A9G рдкрд░ рдорд╛рдЗрдХреНрд░реЛрдкрд╛рдпрдерди</a></li>
<li><a href="../hi446092/index.html">рдХреЗрд╡рд▓ рд╣рд╛рдереЛрдВ рдХреЗ рдмрд┐рдирд╛! рд░реЛрдмреЛрдЯ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдирд╣реАрдВ рджреЛрд╣рд░рд╛рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi446094/index.html">рдЬреАрд╡рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрд╡рд░реНрдд рд╕рд╛рд░рдгреА рдХреЗ рд╕рд╛рде</a></li>
<li><a href="../hi446096/index.html">"TasteVill: рдХреИрд╕реЗ рдЦреБрджрд░рд╛ рдореЗрдВ рдПрдХ рдХреНрд░рд╛рдВрддрд┐ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдм рдХреБрдЫ рдЧрд▓рдд"</a></li>
<li><a href="../hi446098/index.html">"рд╡реЛрд╕реНрддреЛрдХ" рдФрд░ "рд╕рдирд░рд╛рдЗрдЬ" рдХреЗ рд╕рдордп рдХреА рд╕реЛрд╡рд┐рдпрдд рдЙрдбрд╝рд╛рди рдирд┐рдпрдВрддреНрд░рдг рдХреЗрдВрджреНрд░</a></li>
<li><a href="../hi446104/index.html">рдкрд╛рдпрдерди рд╡рд┐рд░реЛрдзрд╛рднрд╛рд╕</a></li>
<li><a href="../hi446106/index.html">рдУрдЧ рд╢реЗрд▓рд╛рд╡ рдиреЗ рдЧреНрд░реЗрд╡рд╛рд▓рдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ jug.msk.ru рдкрд░</a></li>
<li><a href="../hi446108/index.html">рд╡рд┐рддрд░рд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдмрд┐рд▓реНрдбрд┐рдВрдЧ рдмреНрд▓реЙрдХред рдкрд╣рд▓рд╛ рддрд░реАрдХрд╛</a></li>
<li><a href="../hi446110/index.html">WavesKit - PHP рд╡реЗрд╡реНрд╕ рдмреНрд▓реЙрдХрдЪреЗрди рдлреНрд░реЗрдорд╡рд░реНрдХ</a></li>
<li><a href="../hi446112/index.html">WavesKit - рд▓рд╣рд░реЗрдВ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП PHP рдлреНрд░реЗрдорд╡рд░реНрдХ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>