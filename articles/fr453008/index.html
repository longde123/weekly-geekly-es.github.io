<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêå üéØ ü¶í Retour vers le futur avec WebAssembly ‚úùÔ∏è ü§üüèª üßöüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je vous pr√©sente la traduction de l'article "Retour vers le futur avec WebAssembly" par Attila V√°g√≥. 

 Cet article est la traduction d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Retour vers le futur avec WebAssembly</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453008/">  Bonjour, Habr!  Je vous pr√©sente la traduction de l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Retour vers le futur avec WebAssembly"</a> par Attila V√°g√≥. <br><br><h4>  Cet article est la traduction d'un article qui parle des propri√©t√©s de WebAssemly et Emscripten.  Article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=http://">original</a> en anglais. </h4><br>  <i>L'auteur de l'article, Attila Vago, est un d√©veloppeur de logiciels senior chez HMH.</i>  <i>√âcrit du code, des blogs et des trucs sur Internet.</i>  <i>Une polyglotte de langages de programmation, une figure pragmatique, passionn√©e par JavaScript et facile d'acc√®s.</i>  <i>Personne facilement inspir√©e et inspirante avec une forte d√©pendance aux choses pour les nerds, la bonne bouffe, la bi√®re artisanale et Lego.</i>  <i>Utilis√© par Mac.</i>  <i>Il fait de l'exercice √† 6 heures du matin.</i> <br><br><p>  En 2011, j'ai √©crit ma premi√®re ligne ind√©pendante de code non HTML (j'ai travaill√© avec elle en 2007), et elle a √©t√© √©crite dans le tr√®s bon vieux C enseign√© par le professeur David J. Malan de l'Universit√© Harvard.  Il restera √† jamais mon inspiration non seulement pour l'√©tude de la programmation, mais aussi pour la r√©flexion programmatique.  Je me suis √©galement souvenu que faire un sandwich au beurre d'arachide est juste pour moi, mais c'est une t√¢che incroyablement difficile pour un ordinateur et tout aussi difficile pour une personne qui pr√©tend √™tre un ordinateur. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wEdvGqxafq8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><p>  Si vous avez regard√© la vid√©o, au moins les 18 premi√®res minutes (je sais que cela prend beaucoup de temps, mais la programmation prend du temps), alors vous comprendrez pourquoi √† ce jour C me tient √† c≈ìur.  √Ä ma grande d√©ception, je ne l'ai jamais appris, car, avouons-le, pour un d√©veloppeur web, C est la moindre des priorit√©s.  Je n'ai jamais eu de vraie raison de plonger profond√©ment dans cette langue, malgr√© l'achat d'innombrables cours Udemy et de livres C, je ne les ai jamais touch√©s (gardez votre regard critique pour vous, vous l'avez fait aussi) montre intelligente Pebble, qui fonctionne en C, alors assurez-vous d'√©crire un code pour eux.  Oui, bien s√ªr!  Aucune de ces raisons n'√©tait suffisante. </p><br><h4>  Qu'est-ce que WebAssembly et comment d√©passe-t-il JS? </h4><br><p>  WebAssembly (Wasm pour faire court) est un format d'instructions binaires pour une machine virtuelle empil√©e. </p><blockquote>  ¬´Wasm a √©t√© d√©velopp√© comme une plate-forme portable pour la compilation de langages de haut niveau tels que C / C ++ / Rust, qui vous permet de d√©ployer des applications client et serveur sur Internet¬ª </blockquote>  - explique gentiment webassembly.org <p></p><br><p>  En d'autres termes, ce qui pr√©c√®de signifie que vous pouvez √©crire des modules qui fonctionnent sur Internet dans un navigateur / serveur, mais qui sont √©crits dans des langues telles que C, compil√©s dans un fichier binaire et donc incroyablement rapides car ils fonctionnent directement sur le mat√©riel de la machine.  Par rapport √† eux, les langages de script tels que JavaScript ont plusieurs niveaux d'abstraction entre le code et le mat√©riel, ce qui, entre autres, les ralentit.  Bien s√ªr, cela n'a pas toujours d'importance, et chacun d'eux a sa propre place dans le programme ou m√™me l'√©cosyst√®me web. </p><br><p>  Sur cette base, Wasm par structure (initialement) ne prend en charge que les entiers et les nombres √† virgule flottante, ce qui donne une grande puissance de calcul et, par cons√©quent, est souvent utilis√© pour les impl√©mentations de type canevas.  Il est important de comprendre que WebAssembly n'est pas une menace pour JavaScript - du moins pas encore - et, comme vous le verrez plus loin dans cet article, C et JavaScript peuvent r√©ellement vivre tr√®s heureux dans le m√™me projet et peuvent ex√©cuter le code de l'autre.  Oui, quelque chose comme √ßa. </p><br><br><h4>  Emscripten "colle" C et JS </h4><br><p>  Attends maintenant!  Je sais ce que je dis.  Vous ne pouvez pas dire des choses comme "ex√©cuter C dans JS et vice versa" et vous attendre √† ce que le monde ne r√©agisse pas. Peu importe √† quel point cela semble √©trange, je ne suis pas dupe. Il s'av√®re qu'Emscripten est une cha√Æne d'outils pour compiler dans asm.js et WebAssembly, con√ßu en utilisant LLVM (mon Dieu, j'ai appris la moiti√© de ces choses en tapant le texte de l'article), ce qui vous permet d'ex√©cuter C et C ++ sur Internet √† une vitesse presque native sans plug-ins. </p><br><p>  Eh bien, voici ce que vous devez mettre en √©vidence par vous-m√™me.  Emscripten vous aide √† compiler du code C dans WebAssembly, fournissant des outils suppl√©mentaires pour all√©ger la charge du d√©veloppeur en mati√®re de communication entre les deux langues, et aide √† lancer Wasm dans votre projet Web.  La commande de compilation de base pour Emscripten est la suivante: </p><br><pre><code class="plaintext hljs">emcc lib/strings.c -s WASM=1 -o public/strings.js</code> </pre> <br>  Alors qu'une commande non basique s'ex√©cute comme ceci: <br><br><pre> <code class="plaintext hljs">emcc lib/imports.c -s WASM=1 -s EXPORTED_FUNCTIONS="['_getNum', '_main', '_getDoubleNum', '_greet']" -o public/imports.js</code> </pre> <br><p>  La mise en place d'Emscripten n'est pas la chose la plus simple, mais pas le lancement d'une fus√©e.  La seule chose qui complique la configuration est qu'elle a de nombreuses d√©pendances comme Python, Node, xCode, Git et cMake.  Toutes les instructions se trouvent sur la page d'installation et sont faciles √† suivre. <br>  Par cons√©quent, Emscripten: <br><br></p><ul><li>  est un excellent outil de portage, vous permettant de compiler des projets existants √©crits en C ou C ++ et de les ex√©cuter dans tous les navigateurs modernes.  <i>Sortez d'ici, Internet Explorer!</i> </li><li>  id√©al pour les API car il convertit OpenGL en WebGL et vous permet d'utiliser des API famili√®res comme SDL ou directement HTML5.  <i>Oh oui!</i> </li><li>  Et c'est sacr√©ment rapide: gr√¢ce √† LLVM, Emscripten, asm.js et WebAssembly, le code s'ex√©cute √† presque sa propre vitesse.  <i>Courez, lapin, courez!</i> <br></li></ul><p></p><br><p>  Remarque: Vous n'avez pas besoin d'Emscripten pour g√©n√©rer Wasm, car tous les nouveaux navigateurs ont une API pour prendre en charge Wasm dans la m√™me fen√™tre, qui ex√©cute Emscripten comme couche sup√©rieure, ce qui facilite la vie du d√©veloppeur.  Par exemple, Emscripten ajustera la quantit√© de m√©moire pour vous, ce qui peut √™tre fastidieux en C. </p><br><h4>  Des exemples ... des exemples partout! </h4><br><p>  Vous savez, comme on dit, <i>"une ligne de code vaut mille mots"</i> , - OK, c'est la pr√©rogative du narrateur et tout cela, alors sans plus tarder, jetons un coup d'≈ìil √† un vrai code.  Commentaire hors sujet: ce jour-l√†, je n'ai pas pu surmonter la syntaxe C. Elle n'a pas compil√© la moiti√© du temps, car mon code serait fragile.  Et apr√®s huit ans, je me dis: <i>"Oui, √ßa ressemble √† JavaScript</i> . <i>"</i> </p><br><p>  Les gars, si quelqu'un commence √† voir le code C dans mon React, ramenez-moi simplement √† la r√©alit√©, d'accord? </p><br><p>  Un peu hors sujet, voici le code C actuel: </p><br><img src="http://habrastorage.org/webt/ck/lg/et/cklgetgfjlx_kvbbco7_mfazc7w.png" alt="image"><br><br><p>  Et, en cons√©quence, en JavaScript: </p><br><img src="http://habrastorage.org/webt/tt/co/wk/ttcowkhhzlmtmqlqgst67lulqbg.png" alt="image"><br><br><p>  OK, que se passe-t-il exactement dans ces fichiers?  En fait, beaucoup, donc je vais √©num√©rer. <br></p><ol><li>  Il est important de comprendre que <b>main ()</b> , sauf indication contraire, d√©marre toujours en premier et compile √©galement par d√©faut.  Si vous souhaitez compiler une autre fonction, vous devrez la d√©finir sp√©cifiquement dans l'indicateur du tableau <b>EXPORTED_FUNCTIONS</b> , comme indiqu√© dans la section pr√©c√©dente. </li><li>  Vous √©crivez votre code C, comme d'habitude, en important ses biblioth√®ques r√©guli√®res, mais en plus de cela, vous obtenez du sucre syntaxique Emscripten, ainsi que plus de m√©thodes / fonctions qu'avec tout autre outil. </li><li>  Le fichier <b>imports.js</b> (le nom est arbitraire, mais toujours le m√™me que le fichier C) r√©f√©renc√© par HTML n'est rien d'autre que l'Emscripten ¬´glue¬ª, qui est g√©n√©r√© automatiquement lors de la compilation.  Pas besoin de s'en inqui√©ter, assurez-vous simplement qu'il est vraiment r√©f√©renc√©. </li><li>  <b>Printf</b> est juste une instruction C ordinaire enregistrant une cha√Æne sur la console.  Rien de sp√©cial, passez √† autre chose. </li><li>  Les lignes 14 et 17 sont un anti-mod√®le, mais un bon exemple d'ex√©cution de JS dans votre code C. La seule vraie diff√©rence entre <b>emscripten_run_script</b> et <b>emscripten_async_run_script</b> est que ce dernier vous permet d'ex√©cuter JS en C de mani√®re asynchrone.  Surtout avec <b>setTimeout ()</b> .  La raison pour laquelle j'ai dit qu'il s'agit d'un anti-mod√®le est qu'il l'est.  L'id√©e de WebAssembly est d'ex√©cuter C en JS, pas JS en C, et donc ... </li><li>  Les lignes 20 et 24 et leurs fonctions JS associ√©es dans <b>index.html</b> repr√©sentent le mod√®le correct, √† savoir d√©clarer votre JS dans votre JS et renvoyer quelque chose pour C. </li><li>  <b>EM_JS</b> , qui lance ensuite <b>jsFunction</b> , est simplement un moyen plus simple - pour atteindre le m√™me objectif qu'aux points 4 et 5. </li></ol><br><p>  Le r√©sultat pr√©vu de ce qui pr√©c√®de est le suivant: </p><br><img src="http://habrastorage.org/webt/xd/lp/ew/xdlpewar42x522efjks9j2tdii4.png" alt="image"><br><br><p></p><h4>  Mesdames devant! </h4><p></p><br><p>  Comme pour tout code, WebAssembly a √©galement un ordre d'ex√©cution.  Ne jouez pas avec la file d'attente!  La commande dans ce cas est standard pour la commande C.  Tout commence dans Main () et chaque fois que <b>main () est</b> pr√™t, Wasm est pr√™t.  Cependant, que se passe-t-il si vous avez besoin d'une fonction statique pour appeler au moment de l'ex√©cution?  Eh bien, juste un peu de sucre syntaxique Emscripten, et tout se passe comme sur des roulettes: </p><br><img src="http://habrastorage.org/webt/ak/vg/vy/akvgvyjdhbok35-ggr2ktamzsys.png" alt="image"><br><br><h4>  Nous collectons des mouches du g√¢teau </h4><br><p>  C'est du code bien √©crit, en particulier les choses simples illustr√©es dans les sections pr√©c√©dentes, mais nous savons tous que le monde r√©el est beaucoup plus grand que ¬´Hello World¬ª, et la moiti√© du temps de chaque d√©veloppeur est consacr√© √† comprendre pourquoi le code ne fait pas quoi devrait.  Les bugs sont tout simplement in√©vitables et font en quelque sorte partie de la vie. </p><br><p>  Lorsque vous ex√©cutez C dans JS ou n'importe quel Wasm, d'ailleurs, tout peut devenir encore plus d√©primant.  Heureusement, Emscripten vient √† la rescousse en fournissant deux m√©thodes de d√©bogage tr√®s utiles: </p><br><pre> <code class="plaintext hljs">// browser debugger gets triggered emscripten_debugger(); // browser console warning with stack-trace emscripten_log(EM_LOG_WARN, ‚Äú'param' your message‚Äù);</code> </pre> <br><h4>  Gonzalez se d√©p√™che d'aider </h4><br>  Croyez-le ou non, les cr√©ateurs d'Emscripten ont pens√© √† tout.  Une grande caract√©ristique - et la derni√®re que je mentionnerai dans cet article, car il y en a trop pour les mettre tous en un - est la base d'un d√©veloppement et de tests rapides.  Vous pouvez compiler votre Wasm, cr√©er un projet et d√©marrer le serveur d'un seul coup: <p></p><br><pre> <code class="plaintext hljs">emrun --port 7777 --no_browser public/index.html Now listening at http://localhost:7777/</code> </pre> <br>  La page html que vous ex√©cutez n'est pas compatible avec emrun.  La capture stdout, stderr et exit (returncode) ne fonctionnera pas.  Recompilez l'application avec l'indicateur de l'√©diteur de liens --emrun pour l'activer, ou passez --no_emrun_detect √† emrun pour masquer cette v√©rification. <br><p>  D'accord, chez deux boursiers ... l'exemple ci-dessus fonctionne, mais le suivant fonctionne mieux, ce qui explique l'erreur indiqu√©e. </p><br><pre> <code class="plaintext hljs">&lt;b&gt;// compile as emrun project emcc lib/strings.c -s WASM=1 --emrun -o public/index.html // run the emrun server again emrun --port 7777 --no_browser public/index.html&lt;/b&gt;</code> </pre> <br><p>  Je laisse √ßa comme √ßa.  En √©tudiant WebAssembly, j'ai c√©l√©br√© la Saint-Patrick et le lendemain.  Je ne sais pas trop ce qui va se passer ensuite, mais cela m'a suffisamment excit√© pour m'asseoir devant le moniteur pendant deux jours, essayant d'entrer dans les bases de WebAssebly, et cela devrait signifier quelque chose, non?  C'est le code C que j'ai √©crit depuis 2011, et √ßa fait du bien.  Je pense que WebAssembly a un r√©el avenir, mais je ne sais pas s'il va compl√®tement prendre le contr√¥le du r√©seau et tuer JS, comme certains le pr√™chent.  Qu'en penses-tu? </p><br><img src="https://cdn-images-1.medium.com/max/800/1*PM2kQWEmOeAsRwenG-bDAA.png" alt="image"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453008/">https://habr.com/ru/post/fr453008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452998/index.html">Android Un widget dynamique sous forme de cartes bas√© sur StackView (quelque chose comme Tinder)</a></li>
<li><a href="../fr453000/index.html">Boutique de bagages: BUgHunting. Comment trouver 200 bugs par jour</a></li>
<li><a href="../fr453002/index.html">Nouveau terminal Windows: r√©ponses √† vos questions</a></li>
<li><a href="../fr453004/index.html">Nous envoyons Habr sur Mars, vous aussi pouvez voler</a></li>
<li><a href="../fr453006/index.html">Termes informatiques comme exemple du processus de culture des pommes de terre</a></li>
<li><a href="../fr453010/index.html">Comparaison de 10 lampes halog√®nes H4 Philips, Osram, PIAA, Koito, Bosch. Les r√©sultats sont surprenants.</a></li>
<li><a href="../fr453012/index.html">Un court reportage photo sur un voyage √† l'Observatoire des montagnes du Caucase</a></li>
<li><a href="../fr453014/index.html">EyeWire - continuez √† √©tudier les secrets du cerveau</a></li>
<li><a href="../fr453016/index.html">Top 3D Academy invite √† √©changer son programme d'exp√©rience √† l'usine Foliplast</a></li>
<li><a href="../fr453018/index.html">Etude de l'influence de divers r√©flecteurs et diffuseurs sur la forme d'un faisceau lumineux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>