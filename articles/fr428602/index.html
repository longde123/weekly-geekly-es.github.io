<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèø üèê üë®üèΩ‚Äç‚öñÔ∏è Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 4 ‚è±Ô∏è ‚è≤Ô∏è ü•â</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Escalade de privil√®ges 
 Liens vers toutes les parties: 
 Partie 1. Obtention de l'acc√®s initial (acc√®s initial) 
 Partie 2. Ex√©cution 
 Partie 3. Fix...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428602/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Escalade de privil√®ges</a> </h1><br>  <b>Liens vers toutes les parties:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1. Obtention de l'acc√®s initial (acc√®s initial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Ex√©cution</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 3. Fixation (persistance)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Escalade de privil√®ges</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. √âvasion de la d√©fense</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 6. Obtention des informations d'identification (acc√®s aux informations d'identification)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 7. D√©couverte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 8. Mouvement lat√©ral</a> <br><br>  L'escalade de privil√®ges est le r√©sultat d'actions qui permettent √† un attaquant ou √† un programme malveillant d'obtenir un niveau plus √©lev√© d'autorisations sur le syst√®me ou le r√©seau attaqu√©.  Les techniques d'escalade de privil√®ges d√©crivent les m√©thodes par lesquelles un adversaire, apr√®s avoir obtenu un acc√®s non privil√©gi√© √† un syst√®me attaqu√©, en utilisant diverses ¬´faiblesses¬ª d'un syst√®me peut obtenir des droits d'administrateur local, syst√®me ou root.  L'utilisation par des attaquants de comptes d'utilisateurs disposant de droits d'acc√®s √† des syst√®mes sp√©cifiques ou d'autorisations pour effectuer certaines op√©rations peut √©galement √™tre consid√©r√©e comme une escalade de privil√®ges. <br><a name="habracut"></a><br>  <i>L'auteur n'est pas responsable des cons√©quences possibles de l'application des informations √©nonc√©es dans l'article, et s'excuse √©galement pour d'√©ventuelles inexactitudes faites dans certaines formulations et termes.</i>  <i>Les informations publi√©es sont une nouvelle version gratuite du contenu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br>  Il est important d'annuler que certaines des techniques d√©crites dans la matrice <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ATT @ CK</a> sont simultan√©ment incluses dans plusieurs √©tapes de la cha√Æne d'attaque, par exemple, l'interception de recherche de DLL peut √™tre utilis√©e √† la fois pour s√©curiser l'acc√®s par l'ex√©cution non autoris√©e d'une DLL malveillante et pour augmenter les privil√®ges en lan√ßant la DLL dans le processus, travaillant dans le contexte d'un utilisateur plus privil√©gi√©. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Manipulation du jeton d'acc√®s</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description: les</i> attaquants peuvent utiliser des jetons d'acc√®s pour effectuer des actions dans divers contextes de s√©curit√© des utilisateurs ou du syst√®me, √©vitant ainsi la d√©tection d'activit√©s malveillantes.  Un adversaire peut utiliser les fonctions de l'API Windows pour copier des jetons d'acc√®s √† partir de processus existants (vol de jeton), pour cela, il doit √™tre dans le contexte d'un utilisateur privil√©gi√© (par exemple, un administrateur).  Le vol de jetons d'acc√®s est g√©n√©ralement utilis√© pour √©lever les privil√®ges de l'administrateur au syst√®me.  Un adversaire peut √©galement utiliser un jeton d'acc√®s au compte pour l'authentification sur un syst√®me distant, si ce compte dispose des autorisations n√©cessaires sur le syst√®me distant. <br>  Consid√©rez plusieurs fa√ßons d'abuser des jetons d'acc√®s: <br><ul><li>  Vol et usurpation d'identit√© de jetons.  L'emprunt d'identit√© de jetons est la capacit√© du syst√®me d'exploitation √† d√©marrer des threads dans un contexte de s√©curit√© autre que le contexte du processus auquel ce thread appartient.  En d'autres termes, la personnification des jetons vous permet d'effectuer toutes les actions au nom d'un autre utilisateur.  Un adversaire peut dupliquer un jeton d'acc√®s √† l'aide de la fonction <i>DuplicateTokenEX</i> et utiliser <i>ImpersonateLoggedOnUser</i> pour appeler un thread dans le contexte d'un utilisateur connect√©, ou utiliser <i>SetThreadToken</i> pour attribuer un jeton d'acc√®s √† un flux. </li><li>  Cr√©ez un processus √† l'aide d'un jeton d'acc√®s.  Un attaquant peut cr√©er un jeton d'acc√®s √† l'aide de la fonction <i>DuplicateTokenEX</i> puis l'utiliser avec <i>CreateProcessWithTokenW</i> pour cr√©er un nouveau processus qui s'ex√©cute dans le contexte de l'utilisateur emprunt√©. </li><li>  Obtention et usurpation d'identit√© de jetons d'acc√®s.  Un adversaire, disposant d'un nom d'utilisateur et d'un mot de passe, peut cr√©er une session de connexion √† l'aide de la fonction API <i>LogonUser</i> , qui renverra une copie du jeton d'acc√®s √† la session d'une nouvelle session, puis utilisera la <i>fonction SetThreadToken</i> pour attribuer un jeton au thread.  Metasploit Meterpreter et CobaltStrike disposent d'outils pour manipuler les jetons d'acc√®s afin d'√©lever les privil√®ges. </li></ul><br>  <i>Recommandations de protection:</i> Afin d'utiliser pleinement les tactiques ci-dessus, un attaquant doit avoir les droits d'administrateur syst√®me, alors n'oubliez pas de limiter les privil√®ges des utilisateurs ordinaires.  Tout utilisateur peut tromper les jetons d'acc√®s s'il poss√®de des informations d'identification l√©gitimes.  Limitez la possibilit√© pour les utilisateurs et les groupes de cr√©er des jetons d'acc√®s: <br>  <i>GPO: Configuration ordinateur&gt; [Strat√©gies]&gt; Param√®tres Windows&gt; Param√®tres de s√©curit√©&gt; Strat√©gies locales&gt; Attribution des droits utilisateur: cr√©er un objet jeton</i> <br>  D√©terminez √©galement qui peut remplacer les jetons de processus des services locaux ou r√©seau: <br>  <i>GPO: Configuration ordinateur&gt; [Strat√©gies]&gt; Param√®tres Windows&gt; Param√®tres de s√©curit√©&gt; Strat√©gies locales&gt; Attribution des droits utilisateur: remplacer un jeton de niveau de processus</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Modification des fichiers ex√©cutables des applications "fonctionnalit√©s d'accessibilit√© de Windows" (fonctionnalit√©s d'accessibilit√©)</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> Administrateur <br>  <i>Description: les</i> applications d'accessibilit√© (loupe d'√©cran, clavier √† l'√©cran, etc.) peuvent √™tre lanc√©es √† l'aide de combinaisons de touches avant qu'un utilisateur ne se connecte au syst√®me.  Un attaquant peut remplacer les fichiers de d√©marrage de ces programmes ou changer la fa√ßon dont ils sont lanc√©s et ouvrir une console de commande ou obtenir une porte d√©rob√©e sans se connecter. <br><ul><li>  <i>C: \ Windows \ System32 \ sethc.exe</i> - lanc√© en appuyant 5 fois sur la touche Maj; </li><li>  <i>C: \ Windows \ System32 \ utilman.exe</i> - lanc√© en appuyant sur la combinaison de Win + U. </li></ul><br>  Dans WinXP et versions ult√©rieures, sethc.exe et utilman.exe peuvent √™tre remplac√©s, par exemple, par cmd.exe, puis lorsque vous appuyez sur la combinaison de touches souhait√©e, cmd.exe d√©marre avant d'acc√©der √† Windows avec les privil√®ges syst√®me. <br>  Dans Vista et les versions ult√©rieures, vous devez modifier la cl√© de Registre qui configure cmd.exe ou un autre programme en tant que d√©bogueur, par exemple, pour ultiman.exe.  Apr√®s avoir modifi√© le registre et appuy√© sur la combinaison de touches souhait√©e sur l'√©cran de connexion ou lors de la connexion √† l'h√¥te via RDP, cmd.exe avec les droits syst√®me sera ex√©cut√©. <br>  Il existe √©galement des programmes Windows qui peuvent √™tre utilis√©s pour impl√©menter cette technique d'attaque: <br><ul><li>  <i>C: \ Windows \ System32 \ osk.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Magnify.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Narrator.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ DisplaySwitch.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ AtBroker.exe.</i> </li></ul><br>  <i>Recommandations de s√©curit√©:</i> configurez le d√©but de l'authentification r√©seau obligatoire pour les utilisateurs distants avant de cr√©er une session RDP et d'afficher l'√©cran de connexion ( <i>activ√© par d√©faut dans Windows Vista et versions ult√©rieures</i> ).  Utilisez la passerelle Bureau √† distance pour g√©rer les connexions et configurer la s√©curit√© RDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Modification de la cl√© des DLL AppCert</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> administrateur, syst√®me <br>  <i>Description: les</i> DLL sp√©cifi√©es dans la valeur de cl√© AppCertDLLs sont charg√©es dans chaque processus qui appelle les fonctions d'API fr√©quemment utilis√©es: <i>CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec</i> .  La valeur de la cl√© AppCertDLLs peut √™tre utilis√©e de mani√®re abusive en provoquant le chargement d'une DLL malveillante et en ex√©cutant certains processus.  AppCertDLLs est stock√© dans la cl√© de registre suivante: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager</i> . <br><br>  <i>Recommandations de protection:</i> utilisez tous les moyens possibles pour bloquer les logiciels potentiellement dangereux et t√©l√©charger des DLL inconnues, comme AppLocker et DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Modification de la cl√© des DLL AppInit</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> administrateur, syst√®me <br>  <i>Description: les</i> DLL sp√©cifi√©es dans la valeur de cl√© AppInit_DLLs sont charg√©es dans chaque processus charg√© par user32.dll.  En pratique, c'est presque tous les programmes. <br>  AppInit_DLLs est stock√© dans les cl√©s de registre suivantes: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  La valeur de la cl√© AppInit_DLLs peut √™tre utilis√©e abusivement pour d√©passer les privil√®ges en chargeant des DLL malveillantes et en d√©marrant certains processus.  La fonctionnalit√© AppInit_DLLs est d√©sactiv√©e dans Windows 8 et versions ult√©rieures lorsque Secure Boot est activ√©. <br><br>  <i>Recommandations de protection:</i> envisagez d'utiliser une version du syst√®me d'exploitation ant√©rieure √† Windows 8 et d'activer un d√©marrage s√©curis√©.  Utilisez toutes sortes de moyens pour bloquer les logiciels potentiellement dangereux et t√©l√©charger des DLL inconnues, telles que AppLocker et DeviceGuard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Abus du sous-syst√®me de compatibilit√© des applications (Application Shimming)</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> Administrateur <br>  <i>Description: l'</i> <i>infrastructure / l'infrastructure de compatibilit√© des applications Microsoft Windows a √©t√©</i> cr√©√©e pour garantir la compatibilit√© des programmes avec les mises √† jour Windows et les modifications du code du syst√®me d'exploitation.  Le syst√®me de compatibilit√© utilise les soi-disant shim ("joints") - des biblioth√®ques qui agissent comme un tampon entre le programme et le syst√®me d'exploitation.  √Ä l'aide du cache de shim, le syst√®me d√©termine le besoin de joints de shim (stock√©s en tant que base de donn√©es .sdb).  Divers fichiers .sdb stockent diverses proc√©dures pour intercepter le code d'application, le traiter, puis le rediriger vers le syst√®me d'exploitation.  La liste de tous les joints shim install√©s par le programme d'installation (sdbinst.exe) est stock√©e par d√©faut dans: <br><ul><li>  <i>% WINDIR% \ AppPatch \ sysmain.sdb</i> ; </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  Les bases de donn√©es shim personnalis√©es sont stock√©es dans: <br><ul><li>  <i>% WINDIR% \ AppPatch [64] \ Custom;</i> </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  Pour garantir la protection en mode utilisateur, la possibilit√© de changer le noyau du syst√®me d'exploitation √† l'aide de shim-gaskets est exclue et des droits d'administrateur sont requis pour les installer.  Cependant, certains cales peuvent √™tre utilis√©es pour contourner le contr√¥le de compte d'utilisateur (UAC), l'injection de DLL, d√©sactiver <a href="">la pr√©vention de l'ex√©cution des donn√©es</a> et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gestion des exceptions de structure</a> , ainsi que pour intercepter les adresses de m√©moire.  Un attaquant utilisant shim-gaskets peut augmenter les privil√®ges, installer des portes d√©rob√©es, d√©sactiver la protection du syst√®me d'exploitation, comme Windows Defender. <br><br>  <i>Recommandations de protection:</i> Il n'y a pas beaucoup de fa√ßons d'emp√™cher le shim d'application.  La d√©sactivation de la compatibilit√© des applications n'est pas recommand√©e afin d'√©viter des probl√®mes avec la stabilit√© du syst√®me d'exploitation.  Microsoft a publi√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">KB3045645</a> , qui supprimera l'indicateur ¬´√©l√©vation automatique¬ª dans le fichier sdbinst.exe pour emp√™cher l'utilisation du syst√®me de shim pour contourner l'UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Contourner le contr√¥le de compte d'utilisateur</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> Il existe de nombreuses fa√ßons de contourner l'UAC, dont les plus courantes sont impl√©ment√©es dans le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UACMe</a> .  De nouvelles fa√ßons de contourner l'UAC sont r√©guli√®rement d√©couvertes, telles que l'utilisation abusive de l'application syst√®me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">eventvwr.exe</a> , qui peut ex√©cuter un fichier binaire ou un script √©lev√©.  Les programmes malveillants peuvent √©galement √™tre int√©gr√©s dans des processus approuv√©s par lesquels l'UAC permet une √©l√©vation de privil√®ges sans inviter un utilisateur. <br>  Pour contourner l'UAC √† l'aide de eventvwr.exe, la cl√© est modifi√©e dans le registre Windows: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ mscfile \ shell \ open \ command</i> . <br>  Pour contourner l'UAC √† l'aide de sdclt.exe, les cl√©s du registre Windows sont modifi√©es: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Microsoft \ Windows \ CurrentVersion \ App Paths \ control.exe;</i> <i><br></i>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ exefile \ shell \ runas \ command \ isolatedCommand.</i> <br><br>  <i>Recommandations de protection:</i> supprimez les utilisateurs du groupe d'administrateurs locaux sur les syst√®mes prot√©g√©s.  Si possible, activez le niveau de protection le plus √©lev√© dans les param√®tres UAC. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interception de recherche de DLL (d√©tournement de commande de recherche de DLL)</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur, syst√®me <br>  <i>Description: La</i> technique consiste √† exploiter les vuln√©rabilit√©s de l'algorithme pour trouver par les applications les fichiers DLL dont elles ont besoin pour fonctionner ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MSA2269637</a> ).  Souvent, le r√©pertoire de recherche de DLL est le r√©pertoire de travail du programme. Les attaquants peuvent donc remplacer la DLL source par une DLL malveillante portant le m√™me nom de fichier. <br>  Des attaques √† distance sur les recherches de DLL peuvent √™tre effectu√©es lorsque le programme installe son r√©pertoire actuel dans un r√©pertoire distant, par exemple, un partage r√©seau.  De plus, les attaquants peuvent modifier directement la m√©thode de recherche et de chargement des DLL en rempla√ßant les fichiers .manifest ou .local, qui d√©crivent les param√®tres de recherche de DLL.  Si le programme attaqu√© fonctionne avec un niveau de privil√®ges √©lev√©, la DLL malveillante charg√©e par celui-ci sera √©galement ex√©cut√©e avec des droits √©lev√©s.  Dans ce cas, la technique peut √™tre utilis√©e pour augmenter les privil√®ges de l'utilisateur √† l'administrateur ou au syst√®me. <br><br>  <i>Recommandations de protection:</i> Emp√™chez le chargement de DLL √† distance (activ√© par d√©faut dans Windows Server 2012+ et disponible avec les mises √† jour pour XP + et Server 2003+).  Active le mode de recherche s√©curis√© pour les DLL, ce qui limite les r√©pertoires de recherche aux r√©pertoires tels que <i>% SYSTEMROOT%</i> avant d'effectuer une recherche de DLL dans le r√©pertoire d'application actuel. <br>  Activation du mode de recherche de DLL s√©curis√©e: <br>  <i>Configuration ordinateur&gt; [Strat√©gies]&gt; Mod√®les d'administration&gt; MSS (h√©rit√©): MSS: (SafeDllSearchMode) Activez le mode de recherche DLL s√©curis√©e.</i> <br>  Cl√© de registre correspondante: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br><br>  Envisagez d'auditer un syst√®me prot√©g√© pour corriger les d√©ficiences des DLL √† l'aide d'outils tels que PowerUP dans PowerSploit.  N'oubliez pas de bloquer les logiciels malveillants et potentiellement dangereux, ainsi que de suivre les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recommandations de Microsoft</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interception de recherche Dylib (d√©tournement de Dylib)</a> </h3><br>  <i>Syst√®me:</i> macOS <br>  <i>Droits:</i> utilisateur <br>  Description: La technique est bas√©e sur des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vuln√©rabilit√©s dans les algorithmes de recherche de biblioth√®que dynamique dylib sur macOS et OS X.</a>  L'essentiel est de d√©terminer le dylib que l'application attaqu√©e charge, puis de placer la version malveillante de dylib avec le m√™me nom dans le r√©pertoire de travail de l'application.  Cela entra√Ænera l'application √† charger dylib, qui se trouve dans le r√©pertoire de travail du programme.  Dans ce cas, le Dylib malveillant sera ex√©cut√© avec les droits d'acc√®s de l'application attaqu√©e. <br><br>  Conseils de s√©curit√© <i>:</i> emp√™chez les utilisateurs d'√©crire des fichiers dans les r√©pertoires de recherche dylib.  Audit des vuln√©rabilit√©s √† l'aide du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">scanner</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">piratage Dylib</a> d'Objective-See. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exploitation pour escalade de privil√®ges</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description: les</i> adversaires peuvent augmenter les privil√®ges du syst√®me attaqu√© en utilisant des vuln√©rabilit√©s logicielles. <br><br>  <i>Recommandations de protection:</i> mises √† jour logicielles r√©guli√®res sur tous les postes de travail, serveurs, √©quipements r√©seau et autres p√©riph√©riques prot√©g√©s connect√©s au r√©seau prot√©g√©.  Analysez les types de menaces, les vuln√©rabilit√©s et exploitez les programmes qui peuvent √™tre utilis√©s contre l'organisation prot√©g√©e.  Des syst√®mes de protection contre les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exploits</a> tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Windows Defender Exploit Guard (WDEG)</a> pour Windows 10 ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Enhanced Mitigation Experience Toolkit (EMET)</a> pour les versions ant√©rieures de Windows sont √©galement recommand√©s. <br><br>  h3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Injection EWM (injection de m√©moire extra-fen√™tre)</a> <br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> administrateur, syst√®me <br>  <i>Description: la</i> technique consiste √† abuser de la m√©moire Windows suppl√©mentaire, la m√©moire dite Extra Window (EWM).  La taille EWM est de 40 octets, adapt√©e pour stocker un pointeur 32 bits et est souvent utilis√©e pour indiquer une r√©f√©rence aux proc√©dures.  Les programmes malveillants au cours de la cha√Æne d'attaque peuvent placer un pointeur vers un code malveillant dans le EWM, qui sera ensuite lanc√© par le processus d'application infect√©. <br><br>  <i>Recommandations de protection:</i> √âtant donn√© que les techniques d'injection EWM sont bas√©es sur l'utilisation abusive des fonctions de d√©veloppement du syst√®me d'exploitation, les efforts de protection doivent viser √† emp√™cher le lancement de programmes malveillants et d'outils malveillants.  Il est recommand√© d'identifier et de bloquer les logiciels potentiellement dangereux √† l'aide d'AppLocker, d'applications de liste blanche ou d'appliquer des strat√©gies de restriction logicielle. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Inconv√©nients des autorisations au niveau du syst√®me de fichiers (faiblesse des autorisations du syst√®me de fichiers)</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> utilisateur, administrateur <br>  <i>Description:</i> L'essence de la technique est la substitution de fichiers ex√©cutables qui sont automatiquement lanc√©s par divers processus (par exemple, lorsque le syst√®me d'exploitation d√©marre ou √† un certain moment, si les droits sur les fichiers ex√©cutables sont configur√©s de mani√®re incorrecte).  Apr√®s l'usurpation d'identit√©, le fichier malveillant sera lanc√© avec les droits du processus, donc si le processus a un niveau d'acc√®s plus √©lev√©, l'attaquant pourra augmenter les privil√®ges.  Dans cette technique, les attaquants peuvent tenter de manipuler les fichiers binaires du service Windows. <br>  Une autre variante de l'attaque est associ√©e aux lacunes des algorithmes dans le travail des installateurs auto-extractibles.  Au cours du processus d'installation, les installateurs d√©compressent souvent divers fichiers utiles, y compris .dll et .exe, dans le r√©pertoire% TEMP%, cependant, ils ne peuvent pas d√©finir les autorisations appropri√©es pour restreindre l'acc√®s aux fichiers d√©compress√©s, ce qui permet aux attaquants d'effectuer une usurpation de fichier et, en cons√©quence, augmenter les privil√®ges ou contourner le contr√¥le de compte, comme  certains installateurs s'ex√©cutent avec des privil√®ges √©tendus. <br><br>  <i>Recommandations de protection:</i> limitez les privil√®ges des comptes afin que seuls les administrateurs puissent g√©rer les services et interagir avec les fichiers binaires utilis√©s par les services.  D√©sactivez les options d'escalade de privil√®ges UAC pour les utilisateurs standard.  Les param√®tres UAC sont stock√©s dans la cl√© de registre suivante: <br><ul><li>  <i>[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</i> . </li></ul><br>  Pour rejeter automatiquement les demandes d'escalade de privil√®ges, vous devez ajouter une cl√©: <br><ul><li>  <i>"ConsentPromptBehaviorUser" = dword: 00000000.</i> </li></ul><br>  Pour contr√¥ler le travail des installateurs, vous devez ajouter une cl√©: <br><ul><li>  <i>"EnableInstallerDetection" = dword: 00000001</i> , qui n√©cessitera un mot de passe pour installer les programmes. </li></ul><br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Interception des appels de fonctionnalit√©s de l'API Windows (accrochage)</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> administrateur, syst√®me <br>  <i>Description: les</i> fonctions de l'API Windows sont g√©n√©ralement stock√©es dans des DLL.  La technique du hooking consiste √† rediriger les appels vers les fonctions API en: <br><ul><li>  Proc√©dures de hook - proc√©dures int√©gr√©es au syst√®me d'exploitation qui ex√©cutent du code lorsque divers √©v√©nements sont appel√©s, par exemple, des frappes de touches ou le d√©placement de la souris; </li><li>  Modifications de la table d'adresses (IAT), qui stocke des pointeurs vers des fonctions API.  Cela vous permettra de "tromper" l'application attaqu√©e, la for√ßant √† lancer une fonction malveillante; </li><li>  Changement direct de fonction (√©pissage), au cours duquel les 5 premiers octets de la fonction sont modifi√©s, au lieu desquels la transition vers une fonction malveillante ou autre d√©termin√©e par l'attaquant est ins√©r√©e. </li></ul><br>  Comme les injections, les attaquants peuvent utiliser le hook pour ex√©cuter du code malveillant, masquer son ex√©cution, acc√©der √† la m√©moire du processus attaqu√© et augmenter les privil√®ges.  Les attaquants peuvent capturer des appels d'API qui incluent des param√®tres qui contiennent des donn√©es d'authentification.  Le hooking est g√©n√©ralement utilis√© par les rootkits pour masquer les activit√©s malveillantes dans le syst√®me. <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection: l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interception d'√©v√©nements dans le syst√®me d'exploitation fait partie du fonctionnement normal du syst√®me, donc toute restriction de cette fonctionnalit√© peut nuire √† la stabilit√© des applications l√©gitimes, telles que les logiciels antivirus. </font><font style="vertical-align: inherit;">Les efforts visant √† emp√™cher l'utilisation de techniques d'interception doivent se concentrer sur les premiers stades de la cha√Æne d'attaque. </font><font style="vertical-align: inherit;">Vous pouvez d√©tecter une activit√© de hook malveillante en surveillant les appels aux fonctions SetWindowsHookEx et SetWinEventHook, en utilisant des d√©tecteurs de rootkit et en analysant le comportement anormal des processus.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injection IFEO (injection d'options d'ex√©cution de fichier image)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> syst√®me </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Le m√©canisme IFEO (Image File Execution Options) vous permet d'ex√©cuter un d√©bogueur de programme au lieu d'un programme, pr√©c√©demment sp√©cifi√© par le d√©veloppeur dans le registre:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Options d'ex√©cution de fichier image / [ex√©cutable]</font></font></i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ SOFTWARE \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Image File Execution Options \ [ex√©cutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o√π </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ex√©cutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le binaire ex√©cutable du d√©bogueur.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme pour les injections, la valeur </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ex√©cutable]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> peut √™tre </font><font style="vertical-align: inherit;">utilis√©e </font><font style="vertical-align: inherit;">abusivement en ex√©cutant du code arbitraire pour augmenter les privil√®ges ou prendre pied dans le syst√®me. Les programmes malveillants peuvent utiliser IFEO pour contourner la protection en enregistrant des d√©bogueurs qui redirigent et rejettent diverses applications syst√®me et de s√©curit√©. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> technique d√©crite est bas√©e sur l'utilisation abusive des outils de d√©veloppement de syst√®me d'exploitation courants, de sorte que toute restriction peut provoquer l'instabilit√© de logiciels l√©gitimes, par exemple, des applications de s√©curit√©. Les efforts visant √† emp√™cher l'utilisation des techniques d'injection IFEO doivent se concentrer sur les premiers stades de la cha√Æne d'attaque. Vous pouvez d√©tecter une telle attaque en surveillant les processus avec </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch Daemon (Launch Daemon)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;</font></font></h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> technique consiste √† modifier les param√®tres des services de lancement du syst√®me - Launch Daemon, sp√©cifi√© dans les fichiers plist, par l'attaquant. </font><font style="vertical-align: inherit;">Au d√©marrage du syst√®me, le processus Launchd charge les param√®tres des services (d√©mons) √† partir des fichiers plist situ√©s dans les r√©pertoires suivants:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / System / Library / LaunchDeamons; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Biblioth√®que / LaunchDeamons. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch Daemon peut √™tre cr√©√© avec des privil√®ges d'administrateur, mais ex√©cut√© sous le compte root, de sorte qu'un attaquant peut augmenter les privil√®ges. </font><font style="vertical-align: inherit;">Les autorisations des fichiers plist doivent √™tre root: alors que, cependant, le script ou le programme sp√©cifi√© peut avoir des autorisations moins strictes. </font><font style="vertical-align: inherit;">Par cons√©quent, un attaquant peut modifier les fichiers ex√©cutables sp√©cifi√©s dans plist, et ainsi modifier les services syst√®me actuels pour s√©curiser le syst√®me ou augmenter les privil√®ges. </font><font style="vertical-align: inherit;">Conseils de </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√©curit√©:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitez les privil√®ges des utilisateurs afin que seuls les administrateurs autoris√©s puissent cr√©er Launch Daemon. </font><font style="vertical-align: inherit;">Pensez √† surveiller la fa√ßon dont les fichiers plist sont cr√©√©s sur votre syst√®me √† l'aide d'applications telles que KnockKnock.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De nouveaux services</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> syst√®me </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Nom d'acc√®s au syst√®me, les attaquants peuvent cr√©er de nouveaux services et les configurer pour d√©marrer automatiquement. </font><font style="vertical-align: inherit;">Le nom du service peut √™tre masqu√© √† l'aide de noms sp√©cifiques au syst√®me d'exploitation. </font><font style="vertical-align: inherit;">Les services peuvent √™tre cr√©√©s avec des privil√®ges d'administrateur, mais ex√©cut√©s au nom du syst√®me. </font><font style="vertical-align: inherit;">Les services peuvent √™tre cr√©√©s √† partir de la ligne de commande, √† l'aide d'outils d'acc√®s √† distance avec interop√©rabilit√© avec l'API Windows ou √† l'aide d'outils de gestion Windows et PowerShell standard. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de s√©curit√©:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limitez les droits des utilisateurs √† cr√©er de nouveaux services afin que seuls les administrateurs autoris√©s puissent le faire. </font><font style="vertical-align: inherit;">Appliquer AppLocker et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la politique de restriction logicielle</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interception de chemin</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur, syst√®me </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: La</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> technique d'interception d'un chemin consiste √† placer le fichier ex√©cutable dans un r√©pertoire √† partir duquel l'application le lancera √† la place du fichier cible. </font><font style="vertical-align: inherit;">Un attaquant peut employer les m√©thodes suivantes:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chemins inexistants. </font><font style="vertical-align: inherit;">Les chemins d'acc√®s aux fichiers ex√©cutables du service sont stock√©s dans les cl√©s de registre et peuvent avoir un ou plusieurs espaces, par exemple, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Program Files \ service.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , si l'attaquant cr√©e le fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Program.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans le syst√®me </font><font style="vertical-align: inherit;">, Windows le d√©marrera au lieu de traiter le chemin d'acc√®s fichier cible de service.</font></font></li><li>    .    PATH  <i>C:\example</i>  <i>c:\Windows\System32</i>    <i>C:\example\net.exe</i> ,     net,   <i>C:\example\net.exe</i> ,   <i>c:\Windows\System32\net.exe</i> . </li><li>    (Search order hijacking).        , Windows,  ,        ,      . ,  ¬´example.exe¬ª    cmd.exe      net use.       example.exe  net.exe       <i>c:\Windows\System32\net.exe</i> .  ,     net.com     net.exe,  Windows  net.com     ,     PATHEXT. </li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'interception de l'ordre de recherche de fichiers est √©galement utilis√©e pour ex√©cuter des DLL √† l'aide de la technique de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DLL de piratage de recherche</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de s√©curit√©: les</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> guillemets indiquent les chemins d'acc√®s sp√©cifi√©s dans les fichiers de configuration, les scripts, la variable PATH, les param√®tres de service et les raccourcis. </font><font style="vertical-align: inherit;">N'oubliez pas l'ordre de recherche des fichiers ex√©cutables et n'utilisez que des chemins d'acc√®s complets. </font><font style="vertical-align: inherit;">Nettoyez les anciennes cl√©s de registre laiss√©es par le logiciel distant afin qu'aucune cl√© ne soit laiss√©e dans le registre qui pointe vers des fichiers inexistants. </font><font style="vertical-align: inherit;">Interdire l'√©criture par les utilisateurs du syst√®me dans le r√©pertoire racine C: \ et les r√©pertoires syst√®me Windows, limiter les autorisations d'√©criture aux r√©pertoires contenant des fichiers ex√©cutables.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modification des fichiers Plist (Plist Modification)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: Les</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attaquants peuvent modifier les fichiers plist, en y indiquant leur propre code pour son ex√©cution dans le contexte d'un autre utilisateur. </font><font style="vertical-align: inherit;">Les fichiers de propri√©t√©s plist situ√©s dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont ex√©cut√©s avec des privil√®ges √©lev√©s, et le plist de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sont ex√©cut√©s avec des privil√®ges utilisateur. </font><font style="vertical-align: inherit;">Conseils de s√©curit√© </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Emp√™chez la modification des fichiers plist en les rendant en lecture seule.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modification des moniteurs de port dans le gestionnaire d'impression (moniteurs de port)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> syst√®me </font><i><font style="vertical-align: inherit;">: Un</font></i><font style="vertical-align: inherit;"> attaquant peut organiser l'ex√©cution d'une DLL arbitraire au nom du Syst√®me chaque fois que Windows d√©marre en utilisant abusivement les param√®tres du Gestionnaire d'impression (Spoolsv.exe). Pour interagir avec les p√©riph√©riques d'impression, Spoolsv.exe utilise les soi-disant moniteurs de port - ce sont des DLL qui utilisent des commandes de bas niveau √† envoyer aux p√©riph√©riques d'impression via une interface LAN, USB, LPT ou COM. Les DLL ci-dessus sont stock√©es dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ windows \ system32</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et enregistr√©es dans le registre: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Print \ Monitors</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port Monitor peut √™tre install√© √† l'aide de l'API AddMonitor ou directement en modifiant la cl√© de registre ci-dessus. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> organisez le blocage des logiciels potentiellement dangereux et utilisez des outils de contr√¥le de lancement d'applications.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injection de code dans un processus (injection de processus), </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dix techniques d'injection de processus</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur, administrateur, syst√®me, racine </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> l'injection de processus est une m√©thode d'ex√©cution de code arbitraire dans l'espace d'adressage d'un processus vivant distinct. L'ex√©cution de code dans le contexte d'un autre processus vous permet d'acc√©der √† la m√©moire du processus inject√©, aux ressources syst√®me / r√©seau et √©ventuellement √† des privil√®ges √©lev√©s. Les injections de processus peuvent √©galement √™tre utilis√©es pour √©viter la d√©tection √©ventuelle d'activit√©s malveillantes par des moyens de s√©curit√©. Les techniques de mise en ≈ìuvre des injections dans les processus sont bas√©es sur l'utilisation abusive de divers m√©canismes qui assurent le multithreading de l'ex√©cution du programme dans le syst√®me d'exploitation. Voici quelques approches pour injecter du code dans un processus. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Injections de DLL. Ils sont effectu√©s en √©crivant le chemin vers la DLL malveillante √† l'int√©rieur du processus, puis en l'ex√©cutant en cr√©ant un thread distant (thread distant - un thread qui s'ex√©cute dans l'espace d'adressage virtuel d'un autre processus). En d'autres termes, le logiciel malveillant √©crit la DLL sur le disque, puis utilise une fonction comme CreateRemoteTread, qui appellera la fonction LoadLibrary dans le processus inject√©. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Les injections PE (injection ex√©cutable portable) sont bas√©es sur l'abus des fonctionnalit√©s d'ex√©cution de la m√©moire des fichiers PE, tels que DLL ou EXE. Le code malveillant est √©crit dans le processus sans √©crire de fichiers sur le disque, puis l'ex√©cution est appel√©e √† l'aide du code suppl√©mentaire ou en cr√©ant un flux distant.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Le d√©tournement de l'ex√©cution des threads implique l'injection de code malveillant ou de chemins DLL directement dans le thread de processus. Comme la technique Process Hollowing, l'√©coulement doit d'abord √™tre suspendu. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ L'injection dans une injection APC (Asynchronous Procedure Call) implique l'incorporation de code malveillant dans la file d'attente APC d'un thread de processus. L'une des m√©thodes d'injection APC, appel√©e ¬´injection Earle Bird¬ª, implique la cr√©ation d'un processus suspendu dans lequel du code malveillant peut √™tre √©crit et lanc√© au point d'entr√©e du processus via APC. AtomBombing est une autre option d'injection qui utilise APC pour appeler du code malveillant pr√©c√©demment √©crit dans la table atomique globale.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Les injections d'injection TLS (Thread Local Storage) impliquent la manipulation de pointeurs de m√©moire dans un fichier PE ex√©cutable pour rediriger le processus vers du code malveillant. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mac et Linux</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Les variables syst√®me LD_RPELOAD, LD_LIBRARY_PATH (Linux), DYLIB_INSERT_LIBRARIES (macOS X) ou l'interface de programmation d'application (API) dlfcn peuvent √™tre utilis√©es pour charger dynamiquement une biblioth√®que (objet partag√©) dans un processus, qui √† son tour peut √™tre utilis√© pour intercepter des appels d'API √† partir de processus en cours. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ L'appel syst√®me Ptrace peut √™tre utilis√© pour se connecter √† un processus en cours d'ex√©cution et le modifier pendant son ex√©cution.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ / proc / [pid] / mem donne acc√®s √† la m√©moire du processus et peut √™tre utilis√© pour lire / √©crire des donn√©es arbitraires, cependant cette m√©thode est rarement utilis√©e en raison de la complexit√© de sa mise en ≈ìuvre. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ La capture VDSO (Virtual shared shared object) vous permet d'injecter du code lors de l'ex√©cution des binaires ELF en manipulant les talons de code de linux-vdso.so. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les programmes malveillants utilisent g√©n√©ralement l'injection de code dans un processus pour acc√©der aux ressources du syst√®me, ce qui permet √† un attaquant de prendre pied dans le syst√®me et d'effectuer d'autres modifications dans l'environnement attaqu√©. Des √©chantillons plus complexes peuvent effectuer plusieurs injections de processus pour les rendre difficiles √† d√©tecter. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les m√©thodes d'injection de code dans les processus sont bas√©es sur l'utilisation abusive des fonctions r√©guli√®res du syst√®me d'exploitation qui peuvent avoir un impact direct sur le fonctionnement instable des logiciels et produits de s√©curit√© l√©gitimes. </font><font style="vertical-align: inherit;">Les efforts visant √† emp√™cher l'utilisation de techniques d'interception doivent se concentrer sur les premiers stades de la cha√Æne d'attaque. </font><font style="vertical-align: inherit;">Utilisez des outils pour bloquer les logiciels potentiellement dangereux, tels que AppLocker. </font><font style="vertical-align: inherit;">Utilisez Yama comme mesure pr√©ventive contre l'injection de code dans ptrace, en limitant l'utilisation de ptrace aux utilisateurs privil√©gi√©s uniquement. </font><font style="vertical-align: inherit;">Des mesures de s√©curit√© suppl√©mentaires peuvent inclure le d√©ploiement de modules de s√©curit√© du noyau qui fournissent un contr√¥le d'acc√®s avanc√© et une restriction de processus. </font><font style="vertical-align: inherit;">Ces outils incluent SELinux, grsecurity, AppArmor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Injection d'historique SID</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrateur, syst√®me </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Chaque fois qu'un objet est d√©plac√© d'un domaine √† un autre, un nouveau SID est cr√©√©, qui devient le objectSID principal. Les SID pr√©c√©dents continuent d'√™tre stock√©s dans la propri√©t√© sIDHistory, garantissant ainsi que les droits que l'objet avait avant la migration interdomaine sont pr√©serv√©s. Les attaquants disposant de droits d'administrateur peuvent ins√©rer des SID pr√©c√©demment collect√©s dans SID-History pour effectuer une action au nom de groupes ou comptes d'acc√®s plus privil√©gi√©s, tels que des administrateurs de domaine. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sur Windows Server OS version 2003 et versions ult√©rieures, le filtrage SID est activ√© par d√©faut, ce qui implique la suppression ou le filtrage de tous les SID √† l'exception d'un domaine approuv√©, mais cette option peut √™tre d√©lib√©r√©ment d√©sactiv√©e pour autoriser l'acc√®s interdomaine. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les principales m√©thodes de filtrage SID: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ D√©sactivation de SIDHistory dans les param√®tres d'approbation (approbations) entre les for√™ts de domaine √† l'aide de la commande: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdom trust / domain: / EnableSIDHistory: no</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Application de la mise en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quarantaine du filtre SID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Cela garantit qu'un objet contenant un SID autre que le domaine approuv√© ne peut pas s'authentifier aupr√®s du domaine approuv√©. La mise en quarantaine du filtre SID est appliqu√©e aux approbations externes en ex√©cutant la commande:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">approbation / domaine de netdom: / quarantaine: oui</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation du filtrage SID entre les domaines de la m√™me for√™t n'est pas recommand√©e. </font><font style="vertical-align: inherit;">Si le domaine de la for√™t n'est pas fiable, il ne doit pas √™tre membre de la for√™t, dans une telle situation, vous devez d'abord diviser les domaines approuv√©s et non fiables en for√™ts distinctes, puis appliquer le filtrage SID pour les approbations entre les for√™ts.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√¢che planifi√©e</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Utilisateur, Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> syst√®me </font><i><font style="vertical-align: inherit;">: Des</font></i><font style="vertical-align: inherit;"> utilitaires tels que at, schtasks et le Planificateur de t√¢ches Windows peuvent √™tre utilis√©s pour planifier des programmes et des scripts √† ex√©cuter √† une date et une heure sp√©cifiques. Une t√¢che peut √™tre planifi√©e sur un syst√®me distant, √† condition que RPC soit utilis√© pour l'authentification et que le partage d'imprimantes et de fichiers soit activ√©. La planification des t√¢ches sur un syst√®me distant n√©cessite des privil√®ges d'administrateur. Un attaquant pourrait utiliser l'ex√©cution de code √† distance pour obtenir des privil√®ges syst√®me ou pour d√©marrer un processus sous un compte sp√©cifique. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limitez les privil√®ges des utilisateurs. </font><font style="vertical-align: inherit;">L'utilisation d'outils, tels que le module PowerUP dans PowerSploit, qui peuvent √™tre utilis√©s pour trouver des faiblesses dans la r√©solution des t√¢ches planifi√©es. </font><font style="vertical-align: inherit;">D√©sactiver la possibilit√© de d√©marrer des t√¢ches au nom du syst√®me, d√©sactiver l'option " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autoriser les op√©rateurs de serveur √† planifier des t√¢ches</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><font style="vertical-align: inherit;">dans la politique de s√©curit√© </font><font style="vertical-align: inherit;">et activer le param√®tre " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attribution des droits utilisateur: augmenter la priorit√© de planification</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faiblesses dans les autorisations de registre de services Faiblesse</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Administrateur, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description du</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> syst√®me </font><i><font style="vertical-align: inherit;">:</font></i><font style="vertical-align: inherit;"> Si les autorisations des utilisateurs et des groupes permettent de modifier les valeurs des cl√©s dans lesquelles les param√®tres de service sont stock√©s dans le registre Windows, les attaquants peuvent directement modifier les cl√©s dans lesquelles les chemins d'acc√®s aux fichiers ex√©cutables pour le lancement des services sont stock√©s ou utiliser divers outils de gestion services - sc.exe, PowerShell ou Reg. Les attaquants peuvent √©galement modifier les param√®tres li√©s √† une d√©faillance du service, par exemple, FailureCommand, indiquant une commande qui sera ex√©cut√©e en cas de d√©faillance du service ou de dommages intentionnels. Les param√®tres de service sont stock√©s dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assurez-vous que les utilisateurs du syst√®me prot√©g√© ne peuvent pas modifier les cl√©s du registre qui stockent les param√®tres des composants du syst√®me. </font><font style="vertical-align: inherit;">Utilisez tous les moyens possibles pour bloquer les logiciels potentiellement dangereux, par exemple Windows AppLocker.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid et Setgid</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"><i><font style="vertical-align: inherit;">Description de l'</font></i><font style="vertical-align: inherit;"> utilisateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid et Setgid sont des indicateurs d'autorisation sur les syst√®mes Unix qui permettent √† l'utilisateur d'ex√©cuter des fichiers ex√©cutables avec les droits du propri√©taire ou du groupe du fichier ex√©cutable. Si l'application doit √™tre ex√©cut√©e en tant que root, au lieu de cr√©er une entr√©e dans le fichier sudo, l'utilisateur peut sp√©cifier l'indicateur Setuid ou Setgid. Les adversaires peuvent abuser des indicateurs Setuid et Setgid pour effectuer un √©chappement du shell (lorsqu'une application console utilise un fichier ouvert dans une autre application) ou profiter de la vuln√©rabilit√© de l'application avec les indicateurs Setuid et Setgid et ex√©cuter du code dans le contexte de divers utilisateurs. Lorsque vous affichez les attributs de fichier avec la commande ls -l, les indicateurs ci-dessus sont indiqu√©s par le symbole "s" au lieu de "x". L'utilitaire chmod peut d√©finir les drapeaux Setuid et Setgid √† l'aide de la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commande chmod 4777 [fichier]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chmod u + s [fichier]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gardez le nombre de programmes avec les drapeaux Setuid et Setgid d√©finis au minimum.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âl√©ments de d√©marrage</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrateur </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description: Un</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attaquant peut utiliser le m√©canisme obsol√®te, mais toujours en cours d'ex√©cution de macOS Sierra, pour le d√©marrage automatique des applications √† l'aide de StartupItems pour configurer le lancement de son code avec les privil√®ges root au d√©marrage. </font><font style="vertical-align: inherit;">StartupItems est un r√©pertoire dans </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un script de commande et un fichier de propri√©t√©s StartupParameters.plist. </font><font style="vertical-align: inherit;">Le script et le fichier de propri√©t√©s doivent se trouver en haut de la hi√©rarchie: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems / [MyStartupItem]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recommandations de protection:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le m√©canisme StartupItems √©tant obsol√®te, l'interdiction d'√©crire dans le </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©pertoire / Library / Startupitems /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vous permettra d'√©viter de cr√©er des √©l√©ments de d√©marrage.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syst√®me:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Droits: </font></font></i><font style="vertical-align: inherit;"></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Description de l'</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> utilisateur </font><i><font style="vertical-align: inherit;">: les</font></i><font style="vertical-align: inherit;"> opposants peuvent tirer parti des failles de configuration de Sudo pour ex√©cuter des commandes au nom d'autres utilisateurs ou g√©n√©rer des processus avec des privil√®ges plus √©lev√©s. Les options de Sudo sont stock√©es dans le </font><font style="vertical-align: inherit;">fichier </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / sudoers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , des privil√®ges √©lev√©s sont requis pour √©diter ce fichier. Le fichier sudoers d√©crit les commandes que les utilisateurs peuvent ex√©cuter au nom d'autres utilisateurs ou groupes, ce qui permet aux utilisateurs de travailler la plupart du temps avec des privil√®ges minimaux et d'augmenter les privil√®ges uniquement si n√©cessaire. Cependant, dans le fichier sudoers, vous pouvez sp√©cifier les utilisateurs pour lesquels un mot de passe ne sera pas demand√©: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nom d'utilisateur ALL = (ALL) NOPASSWD: ALL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br> <i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conseils de </font><i><font style="vertical-align: inherit;">s√©curit√©:</font></i><font style="vertical-align: inherit;"> le fichier sudoers doit √™tre modifi√© afin que les utilisateurs saisissent toujours un mot de passe lors de l'ex√©cution de sudo. </font><font style="vertical-align: inherit;">Auditd sous Linux peut g√©n√©rer un avertissement lorsque les ID utilisateur r√©els et effectifs ne correspondent pas (cela se produit lorsque l'utilisateur utilise sudo).</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise en cache Sudo</font></font></a> </h3><br>  <i>Syst√®me:</i> Linux, macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description:</i> divers logiciels malveillants, comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><i>OCX Proton Malware</i></a> , peuvent abuser des param√®tres sudo pour ex√©cuter du code en tant que root sans entrer de mot de passe.  √âtant donn√© que la bo√Æte √† outils sudo a √©t√© cr√©√©e pour l'administration syst√®me, elle poss√®de certaines fonctions utiles telles que <i>timestamp_timeout</i> - ce param√®tre stocke le temps en minutes entre les d√©marrages sudo pendant lequel la commande ne demandera pas le mot de passe root.  Sudo a pu mettre en cache les informations d'identification depuis un certain temps.  L'horodatage du dernier d√©marrage de Sudo est stock√© dans <i>/ var / db / sudo</i> et est utilis√© pour d√©terminer le d√©lai sp√©cifi√©.  En outre, il existe une variable <i>tty_tickets</i> qui traite chaque nouvelle session de terminal de mani√®re isol√©e, de sorte que le d√©lai d'expiration dans une instance de la console n'affectera pas le d√©lai d'expiration dans une autre instance. <br><br>  <i>Recommandations de protection:</i> d√©finissez le param√®tre <i>timestamp_timeout = 0</i> pour que le syst√®me n√©cessite un mot de passe root √† chaque ex√©cution de sudo.  Activez le param√®tre <i>tty_tickets</i> pour emp√™cher l'impl√©mentation de l'attaque via des sessions de ligne de commande. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comptes valides</a> </h3><br>  <i>Description: les</i> attaquants peuvent voler les informations d'identification d'un compte d'utilisateur ou de service sp√©cifique √† l'aide des informations d'identification d'acc√®s, capturer les informations d'identification dans le processus de renseignement √† l'aide de l'ing√©nierie sociale.  Les informations d'identification compromises peuvent √™tre utilis√©es pour contourner les syst√®mes de contr√¥le d'acc√®s et acc√©der aux syst√®mes distants et aux services externes, tels que VPN, OWA, Remote Desktop, ou pour obtenir des privil√®ges √©lev√©s sur des syst√®mes et des zones sp√©cifiques du r√©seau.  Si le sc√©nario r√©ussit, les attaquants peuvent refuser les logiciels malveillants et les rendre difficiles √† d√©tecter.  En outre, les attaquants peuvent cr√©er des comptes en utilisant des noms et des mots de passe pr√©d√©finis pour maintenir l'acc√®s √† la sauvegarde en cas de tentatives infructueuses d'utiliser d'autres moyens. <br><br>  <i>Recommandations de protection:</i> appliquez une politique de mot de passe, suivez les recommandations de conception et d'administration d'un r√©seau d'entreprise pour limiter l'utilisation des comptes privil√©gi√©s √† tous les niveaux administratifs.  V√©rifications r√©guli√®res des comptes de domaine et locaux et de leurs droits afin d'identifier ceux qui pourraient permettre √† un attaquant d'obtenir un large acc√®s.  Suivi de l'activit√© du compte √† l'aide des syst√®mes SIEM. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Web shell</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> Web Shell peut √™tre utilis√© par un attaquant comme passerelle pour acc√©der √† votre r√©seau ou un acc√®s redondant au syst√®me attaqu√©, comme m√©canisme de sauvegarde √† s√©curiser en cas de d√©tection et de blocage des principaux canaux d'acc√®s √† l'environnement attaqu√©. <br><br>  <i>Recommandations de protection:</i> assurez-vous que vos serveurs Web externes sont r√©guli√®rement mis √† jour et qu'aucune vuln√©rabilit√© connue ne permet aux attaquants de t√©l√©charger un fichier ou un script sur le serveur avec une ex√©cution ult√©rieure.  V√©rifiez que les autorisations des comptes et des groupes avec des droits de gestion de serveur ne correspondent pas aux comptes du r√©seau interne qui peuvent √™tre utilis√©s pour se connecter au serveur Web, lancer le shell Web ou √©pingler au serveur Web.  Web Shell est difficile √† d√©tecter car  ils n'initient pas de connexion et leur c√¥t√© serveur peut √™tre petit et inoffensif, par exemple, la version PHP du shell Web China Chopper ressemble √† une ligne: <br>  <i>[? php <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">eval</a> ($ _POST ['mot de passe']);]</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428602/">https://habr.com/ru/post/fr428602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428590/index.html">Microinteractions et micro invites dans l'interface</a></li>
<li><a href="../fr428592/index.html">Arr√™tez d'embaucher des ¬´gestionnaires efficaces¬ª. Ils sont non seulement inutiles, mais nocifs</a></li>
<li><a href="../fr428596/index.html">Elon Musk a licenci√© des chefs de projet Internet par satellite Starlink en raison du non-respect des d√©lais</a></li>
<li><a href="../fr428598/index.html">R√©seaux de neurones profonds pour l'√©valuation automatique des appels</a></li>
<li><a href="../fr428600/index.html">SSD d'effets sp√©ciaux ou ce qui manquait pour le modding - Examen du lecteur HyperX FURY RGB</a></li>
<li><a href="../fr428604/index.html">Championnat de science des donn√©es en ligne</a></li>
<li><a href="../fr428606/index.html">¬´Comprendre le fonctionnement du syst√®me a permis beaucoup de piratage¬ª: Roy Beniosef sur le d√©veloppement Android</a></li>
<li><a href="../fr428608/index.html">Les m√©dias d√©tiennent un accord avec Yandex pour retirer les documents pirat√©s</a></li>
<li><a href="../fr428610/index.html">Le paradoxe du temps d'attente, ou pourquoi mon bus est-il toujours en retard?</a></li>
<li><a href="../fr428612/index.html">Fonctions d'ordre sup√©rieur en JavaScript: qu'est-ce que c'est?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>