<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍩 🐈 😸 Réplication de chaîne: création d'un référentiel KV efficace (partie 2/2) 🌯 💦 🆖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous continuons à considérer des exemples d'utilisation de la réplication de chaîne. Les définitions et architectures de base ont été données dans la ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Réplication de chaîne: création d'un référentiel KV efficace (partie 2/2)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432020/"><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/ou/4j/jl/ou4jjlsyjknckeriwguidrfcqqs.jpeg"></div><br>  Nous continuons à considérer des exemples d'utilisation de la réplication de chaîne.  Les définitions et architectures de base ont été données dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">première partie</a> , je vous recommande de vous familiariser avec celle-ci avant de lire la deuxième partie. <br><a name="habracut"></a><br>  Dans cet article, nous étudierons les systèmes suivants: <br><br><ul><li>  Hibari est un référentiel distribué tolérant aux pannes écrit en erlang. </li><li>  HyperDex - stockage de valeurs-clés distribué avec prise en charge de la recherche rapide par attributs secondaires et de la recherche par plage. </li><li>  ChainReaction - Causalité + cohérence et géo-réplication. </li><li>  Construire un système distribué sans utiliser de processus de surveillance / reconfiguration externes supplémentaires. </li></ul><br><h1>  5. Hibari </h1><br>  Hibari est un référentiel KV tolérant aux pannes distribué écrit en erlang.  Utilise la réplication de chaîne (approche de base), c'est-à-dire  atteint une cohérence stricte.  Lors des tests, Hibari affiche des performances élevées - plusieurs milliers de mises à jour par seconde sont réalisées sur des serveurs à deux unités (requêtes de 1 Ko) <br><br><h3>  5.1 Architecture </h3><br>  Un hachage cohérent est utilisé pour placer des données.  La base de stockage est constituée de blocs physiques et logiques.  La <i>brique physique</i> est un serveur avec Linux, peut-être une instance EC2 et, en général, la machine virtuelle dans son ensemble.  Une <i>brique logique</i> est une instance de stockage avec laquelle les principaux processus du cluster fonctionnent, et chaque bloc est un nœud d' <b>une</b> chaîne.  Dans l'exemple ci-dessous, le cluster est configuré avec 2 blocs logiques sur chaque bloc physique et avec une longueur de chaîne de 2. Notez que les nœuds de la chaîne sont «étalés» sur les blocs physiques pour augmenter la fiabilité. <br><br>  Le processus maître (voir la définition dans la première partie) s'appelle le <i>serveur Admin</i> . <br><br>  Les données sont stockées dans des «tables», qui sont simplement divisées en espaces de noms, chaque table est stockée dans au moins une chaîne et chaque chaîne stocke les données dans une seule table. <br><br>  Le client Hibari reçoit des mises à jour du serveur d'administration avec une liste de toutes les têtes et queues de toutes les chaînes (et toutes les tables).  Ainsi, les clients savent immédiatement à quel nœud logique envoyer la demande. <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/k1/nh/yg/k1nhygstpeqkgzv5vyuwwsjoffm.png"></div><br><br><h3>  5.2 Hachage </h3><br>  Hibari utilise une paire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="noError" id="MJXp-Span-2" style="display: inline-block;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ {T, K \}</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;{T,&nbsp;K&nbsp;\}</span></span><script type="math/tex" id="MathJax-Element-1"> \ {T, K \} </script>  pour déterminer le nom de la chaîne qui stocke la clé <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMATHI-4B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> K </script>  dans le tableau <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMATHI-54" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> T </script>  : clé <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMATHI-4B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> K </script>  mappé à l'intervalle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mn" id="MJXp-Span-11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-17"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.303ex" height="2.66ex" viewBox="0 -832 4005.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-2C" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-31" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-2C" x="1724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-31" x="2169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-2C" x="2670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-30" x="3115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432020/&amp;usg=ALkJrhh73T8S1XS-JcwxLm81LwdQrECHCg#MJMAIN-29" x="3616" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> [0,1, 1,0) </script>  (en utilisant MD5), qui est divisé en sections dont une chaîne est responsable.  Les sections peuvent être de différentes largeurs, en fonction du "poids" de la chaîne, par exemple: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/hy/hq/kthyhqgqi5bn5xthknmw4f5sjou.png"></div><br><br>  Ainsi, si certains blocs physiques sont très puissants, les chaînes situées sur celui-ci peuvent recevoir des sections plus larges (alors plus de clés tomberont dessus). <br><br><h1>  6. HyperDex </h1><br>  L'objectif de ce projet était de créer un référentiel de valeurs-clés distribué qui, contrairement à d'autres solutions populaires (BigTable, Cassandra, Dynamo), prendra en charge une recherche rapide d'attributs secondaires et pourra rapidement effectuer une recherche par plage.  Par exemple, dans les systèmes précédemment considérés, pour rechercher toutes les valeurs dans une certaine plage, vous devez passer par tous les serveurs, ce qui, évidemment, est inacceptable.  HyperDex résout ce problème en utilisant le <i>hachage hyperspace</i> . <br><br><h3>  6.1 Architecture </h3><br>  L'idée du hachage hyperespace est de construire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> n </script>  -espace dimensionnel où chaque attribut correspond à un axe de coordonnées.  Par exemple, pour les objets (prénom, nom, numéro de téléphone), l'espace peut ressembler à ceci: <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/zf/be/hu/zfbehu3mpmbsb1bwdfpofn_xywa.png"></div><br><br>  L'hyperplan gris passe à travers toutes les clés, où nom = Smith, jaune - à travers toutes les clés, où prénom = John.  L'intersection de ces avions constitue une réponse à la requête de recherche des numéros de téléphone des personnes portant le nom John et le nom Smith.  Donc, la demande de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> k </script>  retourne les attributs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> (n-k) </script>  -sous-espace dimensionnel. <br><br>  L'espace de recherche est divisé en <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> n </script>  -régions disjointes dimensionnelles, et chaque région est affectée à un seul serveur.  Un objet avec les coordonnées d'une région est stocké sur le serveur de cette région.  Ainsi, un hachage est construit entre les objets et les serveurs. <br><br>  Une requête de recherche (par plage) déterminera les régions incluses dans l'hyperplan résultant et, ainsi, réduira au minimum le nombre de serveurs interrogés. <br><br>  Il y a un problème avec cette approche - le nombre de serveurs requis croît de façon exponentielle à partir du nombre d'attributs, c'est-à-dire  si attributs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> k </script>  alors tu as besoin <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mn" id="MJXp-Span-37" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-38" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> O (2 ^ k) </script>  serveurs.  Pour résoudre ce problème, HyperDex applique une partition d'hyperespace en sous-espaces (avec une dimension inférieure) avec, respectivement, un sous-ensemble d'attributs: <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/s1/nf/tk/s1nftktukf2qd4e9ljjuzsgj_b0.png"></div><br><h3>  6.2 Réplication </h3><br>  Pour garantir une cohérence stricte, les auteurs ont développé une approche spéciale basée sur la réplication de chaîne - <i>chaînage dépendant de la valeur</i> , où chaque nœud suivant est déterminé en hachant l'attribut correspondant.  Par exemple, la clé <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">J</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">n</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">h</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.333em; margin-right: 0.333em;">"</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> ("John", "Smith") </script>  il sera d'abord haché dans l'espace clé (nous obtenons la chaîne de tête, également appelée <i>point leader</i> ), puis le hachage de <math> </math> $ inline $ "John" $ inline $   à la coordonnée sur l'axe correspondant et ainsi de suite.  (Voir l'image ci-dessous pour un exemple de mise à jour. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> u_1 </script>  ) <br><br>  Toutes les mises à jour passent par un point leader, qui commande les demandes (linéarisation). <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/qp/ab/z4/qpabz4f0rpxaybrtt5pzhegrrqk.png"></div><br><br>  Si la mise à jour entraîne un changement dans la région, la première version est d'abord écrite immédiatement après l'ancienne (voir mise à jour <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-msubsup" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-71" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> u_2 </script>  ), et après avoir reçu l'ACK de la queue, le lien vers l'ancienne version du serveur précédent sera modifié.  Aux demandes simultanées (par ex. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> u_2 </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> u_3 </script>  ) n'a pas violé le leader du point de cohérence qui ajoute le versionnement et d'autres métadonnées au serveur, s'il est reçu <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> u_3 </script>  avant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> u_2 </script>  pourrait déterminer que la commande est rompue et que vous devez attendre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">u</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> u_2 </script>  . <br><br><h1>  7. ChainReaction </h1><br>  Un modèle de convergence causale + est utilisé, qui ajoute la condition d'une convergence sans conflit à la convergence causale (causale).  Pour réaliser la convergence causale, des métadonnées sont ajoutées à chaque demande, ce qui indique les versions de toutes les clés dépendantes.  ChainReaction vous permet de faire de la géoréplication dans plusieurs centres de données et est un développement ultérieur de l'idée de CRAQ. <br><br><h3>  7.1 Architecture </h3><br>  L'architecture de FAWN est utilisée avec des modifications mineures - chaque contrôleur de domaine se compose de <i>serveurs</i> de <i>données</i> - backends (stockage de données, réplication, forme un anneau DHT) et <i>des proxys clients</i> - frontaux (envoi d'une demande à un nœud spécifique).  Chaque clé est répliquée sur R nœuds consécutifs, formant une chaîne.  Les demandes de lecture sont traitées par tail et écrites par head. <br><br><div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/xz/lv/ei/xzlveipiopeqi4enyao1b_fuehw.png"></div><br><h3>  7.2 Un centre de données </h3><br>  Nous notons une propriété importante découlant de la réplication de chaîne - si le nœud <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> k </script>  cohérent avec certaines opérations client, puis tous les nœuds précédents - aussi.  Donc, si l'opération <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> Op </script>  a été vue pour la dernière fois par nous sur le site <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> j </script>  , alors toutes les causes dépendantes (de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> Op </script>  ) les opérations de lecture ne peuvent être effectuées que sur les nœuds de la tête vers <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> j </script>  .  Dès que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> Op </script>  sera exécuté sur la queue - il n'y aura aucune restriction de lecture.  Indique les opérations d'écriture effectuées par tail dans le DC <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> d </script>  comme <b>DC-Write-Stable (d)</b> . <br><br>  Chaque client stocke une liste (métadonnées) de toutes les clés demandées par le client au format (clé, version, chainIndex), où chainIndex est la position du nœud dans la chaîne qui a répondu à la dernière demande de clé.  <b>Les métadonnées sont stockées uniquement pour les clés dont le client ne sait pas si elles sont stables en écriture DC (d) ou non</b> . <br><br><h4>  7.2.1 Opération d'écriture </h4><br>  Notez qu'une fois que l'opération est devenue DC-Write-Stable (d), aucune demande de lecture ne peut lire les versions précédentes. <br><br>  Pour chaque demande d'écriture, une liste de toutes les clés sur lesquelles des opérations de lecture ont été effectuées avant l'ajout de la dernière opération d'écriture.  Dès que le proxy client reçoit la demande, il effectue des lectures de blocage sur la queue de toutes les clés des métadonnées (nous attendons la confirmation de la disponibilité de la même version ou d'une version plus récente, en d'autres termes, nous remplissons la condition de cohérence causale).  Dès réception des confirmations, la demande d'écriture est envoyée au responsable de la chaîne correspondante. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l2/qo/k_/l2qok_yldb0_aaqjcfmzj2ap_gk.png"></div><br><br>  Une fois la nouvelle valeur stockée sur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> k </script>  nœuds de la chaîne, une notification est envoyée au client (avec l'index du dernier nœud).  Le client met à jour le chainIndex et supprime les métadonnées des clés envoyées, comme  il est devenu connu d'eux qu'ils sont DC-Write-Stable (d).  En parallèle, l'enregistrement se poursuit - <i>propagation paresseuse</i> .  Ainsi, la priorité est donnée à l'écriture des opérations sur le premier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> k </script>  nœuds.  Dès que tail stocke la nouvelle version de la clé, une notification est envoyée au client et transmise à tous les nœuds de la chaîne afin qu'ils marquent la clé comme stable. <br><br><h4>  7.2.2 Opération de lecture </h4><br>  Le proxy client envoie une demande de lecture à <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">x</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">d</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-125">1</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">x</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> index: = rand (1, chainIndex) </script>  nœud dans le circuit, tout en répartissant la charge.  En réponse, le nœud envoie la valeur et la version de cette valeur.  La réponse est envoyée au client, tandis que: <br><br><ul><li>  Si la version est stable, le nouveau chainIndex est égal à la taille de la chaîne. </li><li>  Si la version est plus récente, le nouveau chainIndex = index. </li><li>  Sinon, chainIndex ne change pas. </li></ul><br><h4>  7.2.3 Basculement de nœud </h4><br>  Elle est presque complètement identique à l'approche de base, avec quelques différences dans le fait que dans certains cas, le chainIndex sur le client devient invalide - cela est facilement déterminé lors de l'exécution des demandes (il n'y a pas de clé avec cette version) et la demande est redirigée vers la tête de la chaîne pour rechercher le nœud avec la version souhaitée. <br><br><h3>  7.3 Plusieurs ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> N </script>  ) centres de données (géo-réplication) </h3><br>  Nous prenons comme base les algorithmes d'une architecture à serveur unique et les adaptons au minimum.  Pour commencer, dans les métadonnées, au lieu des seules valeurs de version et chainIndex, nous avons besoin de vecteurs versionnés de N dimensions. <br><br>  Nous définissons Global-Write-Stable d'une manière similaire avec DC-Write-Stable (d) - l'opération d'écriture est considérée comme Global-Write-Stable si elle a été effectuée sur des queues dans tous les DC. <br><br>  Un nouveau composant apparaît dans chaque DC - <i>remote_proxy</i> , sa tâche est de recevoir / envoyer des mises à jour à partir d'autres DC. <br><br><h4>  7.3.1 Exécution d'une opération d'écriture (sur le serveur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> i </script>  ) </h4><br>  Le début est similaire à une architecture à serveur unique - nous effectuons des lectures de blocage, écrivons sur le premier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> k </script>  noeuds d'une chaîne.  À ce stade, le proxy client envoie au client un nouveau vecteur chainIndex, où les zéros sont partout, sauf pour la position <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> i </script>  - il y a un sens <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> k </script>  .  Ensuite - comme d'habitude.  Une opération supplémentaire à la toute fin - la mise à jour est envoyée à remote_proxy, qui accumule plusieurs requêtes, puis envoie tout. <br><br>  Deux problèmes se posent ici: <br><br><ul><li>  Comment garantir les dépendances entre différentes mises à jour provenant de différents DC? <br><br>  Chaque remote_proxy stocke un vecteur de version local <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> rvp </script>  les dimensions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> N </script>  , qui stocke le nombre de mises à jour envoyées et reçues et l'envoie dans chaque mise à jour.  Ainsi, lors de la réception d'une mise à jour d'un autre contrôleur de domaine, remote_proxy vérifie les compteurs, et si le compteur local est inférieur, l'opération est bloquée jusqu'à ce que la mise à jour correspondante soit reçue. </li><li>  Comment fournir des dépendances pour cette opération dans d'autres DC? <br><br>  Ceci est réalisé en utilisant un filtre Bloom.  Lors de l'exécution des opérations d'écriture / lecture à partir du proxy client, en plus des métadonnées, un filtre de bloom est également envoyé pour chaque clé (appelés filtres de réponse).  Ces filtres sont stockés dans la liste <i>AccessedObjects</i> , et lors de la demande d'opérations d'écriture / lecture, les métadonnées envoient également des filtres OU envoyés des clés (appelés filtre de dépendance).  De même, après l'opération d'écriture, les filtres correspondants sont supprimés.  Lors de l'envoi d'une opération d'écriture à un autre contrôleur de domaine, un filtre de dépendance et un filtre de réponse pour cette demande sont également envoyés. <br><br>  En outre, le contrôleur de domaine distant, après avoir reçu toutes ces informations, vérifie que si les bits définis du filtre de réponse coïncident avec les bits définis de plusieurs filtres de requête, ces opérations sont potentiellement dépendantes de manière occasionnelle.  Potentiellement - parce qu'un filtre de floraison. </li></ul><br><h4>  7.3.2 Opération de lecture </h4><br>  De manière similaire à une architecture à serveur unique, ajustée pour l'utilisation du vecteur chainIndex au lieu d'un scalaire et la possibilité de l'absence d'une clé dans le contrôleur de domaine (car les mises à jour sont asynchrones) - attendez ou redirigez la demande vers un autre contrôleur de domaine. <br><br><h4>  7.3.3 Résolution des conflits </h4><br>  Grâce aux métadonnées, les opérations liées à la causalité sont toujours effectuées dans le bon ordre (parfois vous devez bloquer le processus pour cela).  Mais les changements de concurrence dans différents pays en développement peuvent conduire à des conflits.  Pour résoudre de telles situations, Last Write Wins est utilisé, pour lequel une paire est présente dans chaque opération de mise à jour <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">e</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">s</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> (horloge, s) </script>  où <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">c</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> c </script>  - heures sur proxy, et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> s </script>  - id de DC. <br><br><h4>  7.3.4 Gestion des défaillances de nœuds </h4><br>  Similaire à l'architecture à serveur unique. <br><br><h1>  8. Tirer parti du sharding dans la conception de protocoles de réplication évolutifs </h1><br>  L'objectif de l'étude est de construire un système distribué avec des fragments et avec réplication sans utiliser de processus maître externe pour reconfigurer / surveiller le cluster. <br><br>  Dans les principales approches actuelles, les auteurs constatent les inconvénients suivants: <br><br>  Réplication: <br><br><ul><li>  Principal / Sauvegarde - conduit à une divergence dans l'état si le principal a été identifié par erreur comme ayant échoué. </li><li>  Intersection de quorum - peut entraîner une divergence d'état lors de la reconfiguration du cluster. </li></ul><br>  Cohérence stricte: <br><br><ul><li>  Les protocoles s'appuient sur des algorithmes de vote majoritaire (par exemple, Paxos) si nécessaire <math></math><img src="https://habrastorage.org/getpro/habr/formulas/612/0a9/abc/6120a9abccba4594ff53709f811603c1.svg" alt="2 $ * N + 1 $" data-tex="inline">  faire des nœuds <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> N </script>  nœuds. </li></ul><br>  Détection des défaillances de nœuds: <br><br><ul><li>  P / B et CR impliquent la présence d'une détection idéale des nœuds défaillants avec un modèle fail-stop, ce qui est inaccessible en pratique et vous devez choisir un intervalle de balayage approprié. </li><li>  ZooKeeper est soumis aux mêmes problèmes - avec un grand nombre de clients, un temps considérable (&gt; 1 seconde) leur est nécessaire pour mettre à jour la configuration. </li></ul><br>  L'approche proposée par les auteurs, appelée <i>réplication élastique</i> , est dépourvue de ces défauts et présente les caractéristiques suivantes: <br><br><ul><li>  Cohérence stricte. </li><li>  Pour résister à la chute <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> N </script>  les nœuds doivent avoir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">N</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-177">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> N + 1 </script>  noeud. </li><li>  Reconfiguration sans perte de cohérence. </li><li>  Il n'y a pas besoin de protocoles de consensus basés sur un vote majoritaire. </li></ul><br>  Plaque de résumé: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/nh/yf/alnhyf9vzquirk-ztizoplkeypa.png"></div><br><h3>  8.1 Organisation des répliques </h3><br>  Chaque fragment définit une séquence de configurations <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mtext" id="MJXp-Span-179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">l</span><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">C</span></span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-msubsup" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-196" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mtext" id="MJXp-Span-201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ mathcal {C} = C_1 :: C_2 :: C_3 \ dots </script>  par exemple, la nouvelle configuration ne contient pas de réplique déchue <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mtext" id="MJXp-Span-207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">l</span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">C</span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">l</span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">C</span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">R</span><span class="MJXp-mrow" id="MJXp-Span-231"><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0em;">é</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">s</span><span class="MJXp-mtext" id="MJXp-Span-240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">s</span><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ mathcal {C} = \ mathcal {C}: :( Répliques \ setminus R_j) </script><br><br>  Chaque élément de la séquence de configuration comprend: <br><br><ul><li>  répliques - un ensemble de répliques. </li><li>  <i>orderer</i> - id d'une réplique avec un rôle spécial (voir ci-dessous). </li></ul><br>  Chaque fragment est représenté par un ensemble de répliques (par construction - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> N </script>  ), c'est-à-dire  nous ne divisons pas les rôles de «fragment» et de «réplique». <br><br>  Chaque réplique stocke les données suivantes: <br><br><ul><li>  conf - id de la configuration à laquelle cette réplique appartient. </li><li>  orderer - quelle réplique est l'ordonnanceur de cette configuration. </li><li>  mode - mode réplique, l'un des trois: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> EN ATTENTE </script>  (toutes les répliques de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> C_1 </script>  ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> ACTIVE </script>  (toutes les répliques de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-msubsup" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-279" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> C_1 </script>  ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">U</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> IMMUTABLE </script>  . </li><li>  historique - séquence d'opérations sur les données de réplique réelles <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">o</span><span class="MJXp-msubsup" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-294" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">o</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0.111em; margin-right: 0.167em;">::</span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> op_1 :: op_2 :: \ dots </script>  (ou juste une condition). </li><li>  stable - la longueur maximale du préfixe d'historique fixé par cette réplique.  De toute évidence, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mn" id="MJXp-Span-307">0</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">e</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">r</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">e</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> 0 <= stable <= longueur (historique) </script>  . </li></ul><br>  Le principal objectif d'un réplicateur est d'envoyer des demandes au reste des répliques et de conserver le plus grand préfixe d'historique: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7_/hk/lo/7_hklowfxczcx0tjd5grugrw9a8.png"></div><br><h3>  8.2 Organisation des fragments </h3><br>  Les éclats sont combinés en anneaux appelés <i>bandes élastiques</i> .  Chaque éclat appartient à un seul anneau.  Le précurseur de chaque éclat <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> X </script>  joue un rôle spécial - il est <i>séquenceur</i> pour lui.  Le travail du séquenceur est de donner à son successeur une nouvelle configuration en cas de panne de réplique. <br><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/sc/8g/se/sc8gsegolx8iarmilhrkeftetfo.png"></div><br>  Deux conditions sont requises: <br><br><ul><li>  Chaque bande élastique possède au moins un éclat et une réplique fonctionnelle. </li><li>  Chaque bande élastique a au moins un éclat, dans lequel toutes les répliques fonctionnent. </li></ul><br>  La deuxième condition semble trop stricte, mais elle équivaut à la condition «traditionnelle» que le processus maître ne tombe jamais. <br><br><h3>  8.3 Utilisation de la réplication de chaîne </h3><br>  Comme vous l'avez peut-être deviné, les répliques sont organisées en chaîne (approche de base) - le commandeur sera à la tête, avec de légères différences: <br><br><ul><li>  En cas d'échec dans CR, le nœud est jeté hors de la chaîne (et remplacé par un nouveau), dans ER - une nouvelle chaîne est créée. </li><li>  Les demandes de lecture dans CR sont traitées par queue, dans ER, elles passent par toute la chaîne de la même manière que les demandes d'écriture. </li></ul><br><h3>  8.5 Reconfiguration en cas de panne </h3><br><ul><li>  Les répliques sont surveillées par les répliques de votre fragment et les répliques d'un fragment de séquenceur. </li><li>  Dès qu'une défaillance est détectée, les répliques envoient une commande à ce sujet. </li><li>  Sequencer envoie une nouvelle configuration (sans réplique défaillante). </li><li>  Une nouvelle réplique est créée qui synchronise son état avec la bande élastique. </li><li>  Après cela, le séquenceur envoie la nouvelle configuration avec la réplique ajoutée. </li></ul><br><h1>  Les références </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://">Hibari</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hyperdex.orgerdex.org</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HyperDex: un magasin de valeurs-clés distribué et consultable</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Réaction en chaîne</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tirer parti du sharding dans la conception de protocoles de réplication évolutifs</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432020/">https://habr.com/ru/post/fr432020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432006/index.html">L'histoire de comment je suis entré dans le sujet de la santé des femmes</a></li>
<li><a href="../fr432008/index.html">Chasing Web Standards</a></li>
<li><a href="../fr432012/index.html">Comment tester les contrats intelligents</a></li>
<li><a href="../fr432014/index.html">Kali Linux pour les débutants</a></li>
<li><a href="../fr432016/index.html">Comment la musique et le dessin m'ont appris à programmer</a></li>
<li><a href="../fr432022/index.html">Forkney it: 8 projets Go qui sont intéressants à creuser dans le code source</a></li>
<li><a href="../fr432024/index.html">Gradle 5.0 - quoi de neuf</a></li>
<li><a href="../fr432030/index.html">Le chemin vers un détecteur de mensonge sans contact, ou comment organiser un hackathon à vitesse maximale</a></li>
<li><a href="../fr432032/index.html">Nous terminons le champ de recherche Google cloué</a></li>
<li><a href="../fr432034/index.html">Le livre «L'électricité étape par étape» de Rudolf Svoren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>