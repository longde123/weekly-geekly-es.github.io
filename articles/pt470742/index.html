<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👌🏿 👩‍👩‍👧‍👦 👩‍💼 Equação de Navier-Stokes e simulação de fluidos na CUDA 🔵 🖐🏽 🥀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oi Habr. Neste artigo, trataremos da equação de Navier-Stokes para um fluido incompressível, resolveremos numericamente e faremos uma bela simulação q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Equação de Navier-Stokes e simulação de fluidos na CUDA</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470742/">  Oi Habr.  Neste artigo, trataremos da equação de Navier-Stokes para um fluido incompressível, resolveremos numericamente e faremos uma bela simulação que funciona por computação paralela na CUDA.  O objetivo principal é mostrar como você pode aplicar a matemática subjacente à equação na prática ao resolver o problema de modelagem de líquidos e gases. <br><br><img src="https://habrastorage.org/webt/mn/fv/kr/mnfvkr1fxmlapnncgvimffqg6w0.png"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Advertência</b> <div class="spoiler_text">  O artigo contém muita matemática; portanto, aqueles que estão interessados ​​no lado técnico da questão podem ir diretamente para a seção de implementação do algoritmo.  No entanto, eu ainda recomendo que você leia o artigo inteiro e tente entender o princípio da solução.  Se você tiver alguma dúvida até o final da leitura, terei o maior prazer em respondê-la nos comentários do post. <br></div></div><br>  <i>Nota: se você estiver lendo o Habr em um dispositivo móvel e não vir as fórmulas, use a versão completa do site</i> <br><h2>  Equação de Navier-Stokes para um fluido incompressível </h2><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mtext" id="MJXp-Span-3">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">l</span><span class="MJXp-mrow" id="MJXp-Span-11"><span class="MJXp-mtext" id="MJXp-Span-12">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">f</span><span class="MJXp-mtext" id="MJXp-Span-15">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">c</span><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">u</span></span></span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">r</span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mtext" id="MJXp-Span-27">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">l</span></span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-39"><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">f</span><span class="MJXp-mtext" id="MJXp-Span-43">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">c</span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">u</span></span></span><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">t</span><span class="MJXp-mtext" id="MJXp-Span-54">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">a</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mtext" id="MJXp-Span-62">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">f</span><span class="MJXp-mtext" id="MJXp-Span-65">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">c</span><span class="MJXp-mrow" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">u</span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-72"><span class="MJXp-mn" id="MJXp-Span-73">1</span><span class="MJXp-mtext" id="MJXp-Span-74">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">r</span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">o</span></span><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">a</span><span class="MJXp-mrow" id="MJXp-Span-89"><span class="MJXp-mtext" id="MJXp-Span-90">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">p</span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">u</span><span class="MJXp-mtext" id="MJXp-Span-98">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">l</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-105" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mtext" id="MJXp-Span-107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">f</span><span class="MJXp-mtext" id="MJXp-Span-110">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">c</span><span class="MJXp-mrow" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">u</span></span></span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mtext" id="MJXp-Span-118">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">f</span><span class="MJXp-mtext" id="MJXp-Span-121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">c</span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">F</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="118.663ex" height="3.021ex" viewBox="0 -987.6 51090.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="3043" y="0"></use><g transform="translate(3341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="7029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="7515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="8000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="8467" y="0"></use><g transform="translate(8918,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="1115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="1644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-69" x="2529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="2875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="3404" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-3D" x="12899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2212" x="13955" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-28" x="14734" y="0"></use><g transform="translate(15123,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="18811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-64" x="19245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="19768" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-74" x="20254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="20865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="21466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="21995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="22425" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="22723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-29" x="23253" y="0"></use><g transform="translate(23642,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2212" x="27302" y="0"></use><g transform="translate(28303,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="2188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="2889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-68" x="3341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="3917" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="32956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="33557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="34086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="34516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="34814" y="0"></use><g transform="translate(35344,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="1230" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2B" x="37299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="38550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="39150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="39973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="40573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="41103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="41532" y="0"></use><g transform="translate(41831,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-32" x="748" y="583"></use></g><g transform="translate(42814,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2B" x="46475" y="0"></use><g transform="translate(47475,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-46" x="2865" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> {\ parcial {\ bf \ vec {u}} \ over {\ t parcial}} = - ({\ bf \ vec {u}} \ cdot \ nabla) {\ bf \ vec {u}} - {1 \ over \ rho} \ nabla {\ bf p} + \ nu \ nabla ^ 2 {\ bf \ vec {u}} + {\ bf \ vec {F}} </script></p><br>  Acho que todos pelo menos uma vez ouviram falar dessa equação, alguns, talvez até analiticamente, resolvam seus casos particulares, mas em termos gerais esse problema permanece por resolver até agora.  Obviamente, não definimos o objetivo de resolver o problema do milênio neste artigo, mas ainda podemos aplicar o método iterativo a ele.  Mas, para começar, vejamos a notação nesta fórmula. <br><br>  Convencionalmente, a equação de Navier-Stokes pode ser dividida em cinco partes: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">l</span><span class="MJXp-mrow" id="MJXp-Span-136"><span class="MJXp-mtext" id="MJXp-Span-137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">f</span><span class="MJXp-mtext" id="MJXp-Span-140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">c</span><span class="MJXp-mrow" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">u</span></span></span><span class="MJXp-mtext" id="MJXp-Span-146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">s</span><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.09ex" height="2.419ex" viewBox="0 -780.1 12955.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="3043" y="0"></use><g transform="translate(3341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6D" x="7029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="7908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-69" x="8437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-73" x="8783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="9502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="10006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="10535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="10987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-69" x="11420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="11766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="12295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-74" x="12594" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ parcial {\ bf \ vec {u}} \ mais \ parcial t </script>  - denota a taxa de variação da velocidade do fluido em um ponto (a consideraremos para cada partícula em nossa simulação). </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mtext" id="MJXp-Span-164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">f</span><span class="MJXp-mtext" id="MJXp-Span-167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">c</span><span class="MJXp-mrow" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">u</span></span></span><span class="MJXp-mtext" id="MJXp-Span-173">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">t</span><span class="MJXp-mtext" id="MJXp-Span-178">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">a</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-185"><span class="MJXp-mtext" id="MJXp-Span-186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">f</span><span class="MJXp-mtext" id="MJXp-Span-189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">c</span><span class="MJXp-mrow" id="MJXp-Span-193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">u</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.484ex" height="2.66ex" viewBox="0 -832 13125 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2212" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-28" x="778" y="0"></use><g transform="translate(1168,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="4856" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-64" x="5289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="5813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-74" x="6298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="6910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="7510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="8040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="8469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="8768" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-29" x="9297" y="0"></use><g transform="translate(9687,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> - ({\ bf \ vec {u}} \ cdot \ nabla) {\ bf \ vec {u}} </script>  - o movimento do fluido no espaço. </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mrow" id="MJXp-Span-197"><span class="MJXp-mn" id="MJXp-Span-198">1</span><span class="MJXp-mtext" id="MJXp-Span-199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">r</span><span class="MJXp-mtext" id="MJXp-Span-204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">o</span></span><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">a</span><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-mtext" id="MJXp-Span-215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.187ex" height="2.419ex" viewBox="0 -780.1 9552.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="2188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="2889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-68" x="3341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="3917" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="5431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="6032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="6561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="6991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="7289" y="0"></use><g transform="translate(7819,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-70" x="1230" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> - {1 \ over \ rho} \ nabla {\ bf p} </script>  A pressão exercida sobre a partícula (aqui <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-219"><span class="MJXp-mtext" id="MJXp-Span-220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">o</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.096ex" height="2.057ex" viewBox="0 -780.1 1763.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-72" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-68" x="701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6F" x="1278" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> \ rho </script>  - coeficiente de densidade do fluido). </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-mtext" id="MJXp-Span-225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">u</span><span class="MJXp-mtext" id="MJXp-Span-228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">l</span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-235" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-236"><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">f</span><span class="MJXp-mtext" id="MJXp-Span-240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">c</span><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">u</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.47ex" height="2.78ex" viewBox="0 -935.7 7952.4 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6E" x="1673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="2803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-6C" x="3232" y="0"></use><g transform="translate(3531,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMAIN-32" x="748" y="513"></use></g><g transform="translate(4514,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-66" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-76" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-65" x="1965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-63" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/470742/&amp;usg=ALkJrhiIJFD0LrrW0gPEdPVGyuBqdilJwA#MJMATHI-75" x="2865" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ nu \ nabla ^ 2 {\ bf \ vec {u}} </script>  - viscosidade do meio (quanto maior, mais forte o líquido resiste à força aplicada à sua parte), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-mtext" id="MJXp-Span-247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ nu </script>  - coeficiente de viscosidade). </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mtext" id="MJXp-Span-251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">f</span><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">c</span><span class="MJXp-mrow" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">F</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ bf \ vec {F} </script>  - forças externas que aplicamos ao fluido (no nosso caso, a força terá um papel muito específico - refletirá as ações executadas pelo usuário. </li></ul><br>  Além disso, como consideraremos o caso de um fluido incompressível e homogêneo, temos outra equação: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mrow" id="MJXp-Span-261"><span class="MJXp-mrow" id="MJXp-Span-262"><span class="MJXp-mtext" id="MJXp-Span-263">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">a</span><span class="MJXp-mtext" id="MJXp-Span-270">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">t</span><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">f</span><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">c</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">u</span></span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-285">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> {{\ \ nabla \ cdot \ bf \ vec {u}} = 0} </script>  .  A energia no ambiente é constante, não vai a lugar nenhum, não vem de nenhum lugar. <br><br>  Será errado privar todos os leitores que não estão familiarizados com a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">análise vetorial</a> , portanto, ao mesmo tempo, e passar brevemente por todos os operadores presentes na equação (no entanto, eu recomendo fortemente lembrar qual é a derivada, o diferencial e o vetor, pois eles sustentam tudo isso. o que será discutido abaixo). <br><br>  Começamos com o operador nabla, que é esse vetor (no nosso caso, será de dois componentes, pois modelaremos o fluido no espaço bidimensional): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-286"><span class="MJXp-mtext" id="MJXp-Span-287">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">a</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-294"><span class="MJXp-mtext" id="MJXp-Span-295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">n</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">x</span></span><span class="MJXp-mrow" id="MJXp-Span-309"><span class="MJXp-mtext" id="MJXp-Span-310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">l</span><span class="MJXp-mtext" id="MJXp-Span-318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">b</span><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">x</span></span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">l</span><span class="MJXp-mtext" id="MJXp-Span-341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">e</span><span class="MJXp-mtext" id="MJXp-Span-347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">y</span></span><span class="MJXp-mtext" id="MJXp-Span-356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">d</span><span class="MJXp-mrow" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \ nabla = {\ begin {pmatrix} {\ parcial \ sob \ parcial x}, {\ parcial \ sobre \ parcial y} \ end {pmatrix}} </script></p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O operador nabla</a> é um operador diferencial de vetor e pode ser aplicado tanto a uma função escalar quanto a uma função vetorial.  No caso de um escalar, obtemos o gradiente da função (o vetor de suas derivadas parciais) e, no caso de um vetor, a soma das derivadas parciais ao longo dos eixos.  A principal característica desse operador é que, através dele, você pode expressar as principais operações da análise vetorial - <b>grad</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gradiente</a> ), <b>div</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">divergência</a> ), <b>rot</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rotor</a> ) e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mtext" id="MJXp-Span-369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">l</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-376" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> \ nabla ^ 2 </script>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Operador Laplace</a> ).  Vale a pena notar imediatamente que a expressão <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mtext" id="MJXp-Span-380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">f</span><span class="MJXp-mtext" id="MJXp-Span-383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">c</span><span class="MJXp-mrow" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">u</span></span><span class="MJXp-mtext" id="MJXp-Span-389">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">t</span><span class="MJXp-mtext" id="MJXp-Span-394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">a</span></span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-401"><span class="MJXp-mtext" id="MJXp-Span-402">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">f</span><span class="MJXp-mtext" id="MJXp-Span-405">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">c</span><span class="MJXp-mrow" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">u</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> ({\ bf \ vec {u} \ cdot \ nabla}) {\ bf \ vec {u}} </script>  <b>não equivale a</b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mtext" id="MJXp-Span-414">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">a</span><span class="MJXp-mtext" id="MJXp-Span-420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">t</span><span class="MJXp-mtext" id="MJXp-Span-425">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">f</span><span class="MJXp-mtext" id="MJXp-Span-428">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">c</span><span class="MJXp-mrow" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">u</span></span></span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-435"><span class="MJXp-mtext" id="MJXp-Span-436">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">f</span><span class="MJXp-mtext" id="MJXp-Span-439">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">c</span><span class="MJXp-mrow" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">u</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> ({\ nabla \ cdot \ bf \ vec {u}}) {\ bf \ vec {u}} </script>  - o operador nabla não possui comutatividade. <br><br>  Como veremos mais adiante, essas expressões são visivelmente simplificadas ao mudar para um espaço discreto no qual realizaremos todos os cálculos; portanto, não fique alarmado se no momento você não estiver muito claro sobre o que fazer com tudo isso.  Depois de dividir a tarefa em várias partes, resolveremos sucessivamente cada uma delas e apresentaremos tudo isso na forma da aplicação seqüencial de várias funções em nosso ambiente. <br><br><h2>  Solução numérica da equação de Navier-Stokes </h2><br>  Para representar nosso fluido no programa, precisamos obter uma representação matemática do estado de cada partícula de fluido em um ponto arbitrário no tempo.  O método mais conveniente para isso é criar um campo vetorial de partículas armazenando seu estado na forma de um plano de coordenadas: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0c1/9ec/2ad/0c19ec2ad025a0774f12af8416ab89b9.jpg" alt="imagem"><br><br>  Em cada célula da nossa matriz bidimensional, armazenaremos a velocidade das partículas por vez <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">t</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mrow" id="MJXp-Span-448"><span class="MJXp-mtext" id="MJXp-Span-449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">f</span><span class="MJXp-mtext" id="MJXp-Span-452">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">c</span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">u</span></span></span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">u</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-461"><span class="MJXp-mtext" id="MJXp-Span-462">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">f</span><span class="MJXp-mtext" id="MJXp-Span-465">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">c</span><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">t</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-475">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">f</span><span class="MJXp-mtext" id="MJXp-Span-478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">c</span><span class="MJXp-mrow" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">x</span></span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-485">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">n</span><span class="MJXp-mrow" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">x</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">y</span><span class="MJXp-mtext" id="MJXp-Span-502">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">d</span><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> t: {\ bf \ vec {u}} = u ({\ bf \ vec {x}}, t), \ bf \ vec {x} = \ begin {pmatrix} x, y \ end {pmatrix} </script>  , e a distância entre as partículas é indicada por <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-514"><span class="MJXp-mtext" id="MJXp-Span-515">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> \ delta x </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mtext" id="MJXp-Span-523">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ delta y </script>  em conformidade.  No código, será suficiente alterar o valor da velocidade a cada iteração, resolvendo um conjunto de várias equações. <br><br>  Agora, expressamos o gradiente, a divergência e o operador Laplace, levando em consideração nossa grade de coordenadas ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">i</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">j</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> i, j </script>  - índices na matriz, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mtext" id="MJXp-Span-535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">f</span><span class="MJXp-mtext" id="MJXp-Span-538">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">c</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mrow" id="MJXp-Span-543" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-546">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">x</span><span class="MJXp-mo" id="MJXp-Span-548">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">c</span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mrow" id="MJXp-Span-555" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-557" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-558">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">y</span><span class="MJXp-mo" id="MJXp-Span-560">)</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> \ bf \ vec {u} _ {(x)}, \ vec {u} _ {(y)} </script>  - retirando os componentes correspondentes do vetor): <br><div class="scrollable-table"><table><tbody><tr><td>  Operador </td><td>  Definição de </td><td>  Analógico Discreto </td></tr><tr><td>  <b>grad</b> </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-561"><span class="MJXp-mtext" id="MJXp-Span-562">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">a</span><span class="MJXp-mtext" id="MJXp-Span-568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">p</span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-573">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">n</span><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">x</span></span><span class="MJXp-mrow" id="MJXp-Span-587"><span class="MJXp-mtext" id="MJXp-Span-588">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">l</span><span class="MJXp-mtext" id="MJXp-Span-596">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">p</span><span class="MJXp-mtext" id="MJXp-Span-600">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">r</span><span class="MJXp-mtext" id="MJXp-Span-605">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">x</span></span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-615"><span class="MJXp-mtext" id="MJXp-Span-616">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">l</span><span class="MJXp-mtext" id="MJXp-Span-624">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">p</span><span class="MJXp-mtext" id="MJXp-Span-628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">r</span><span class="MJXp-mtext" id="MJXp-Span-633">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">y</span></span><span class="MJXp-mtext" id="MJXp-Span-642">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">d</span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ nabla \ bf p = \ begin {pmatrix} {\ parcial \ bf p \ over \ parcial x}, {\ parcial \ bf p \ over \ parcial y} \ end {pmatrix} </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-654"><span class="MJXp-mrow" id="MJXp-Span-655"><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-msubsup" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">i</span><span class="MJXp-mo" id="MJXp-Span-661">+</span><span class="MJXp-mn" id="MJXp-Span-662">1</span><span class="MJXp-mo" id="MJXp-Span-663">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-666"><span class="MJXp-msubsup" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-669" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">i</span><span class="MJXp-mo" id="MJXp-Span-671">−</span><span class="MJXp-mn" id="MJXp-Span-672">1</span><span class="MJXp-mo" id="MJXp-Span-673">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-675">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">e</span><span class="MJXp-mrow" id="MJXp-Span-681"><span class="MJXp-mn" id="MJXp-Span-682">2</span><span class="MJXp-mtext" id="MJXp-Span-683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-691"><span class="MJXp-mrow" id="MJXp-Span-692"><span class="MJXp-msubsup" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-695" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">i</span><span class="MJXp-mo" id="MJXp-Span-697">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">j</span><span class="MJXp-mo" id="MJXp-Span-699">+</span><span class="MJXp-mn" id="MJXp-Span-700">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-702"><span class="MJXp-msubsup" id="MJXp-Span-703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-705" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">i</span><span class="MJXp-mo" id="MJXp-Span-707">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">j</span><span class="MJXp-mo" id="MJXp-Span-709">−</span><span class="MJXp-mn" id="MJXp-Span-710">1</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-711">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">r</span><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mn" id="MJXp-Span-717">2</span><span class="MJXp-mtext" id="MJXp-Span-718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">y</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> {{p_ {i + 1, j}} - {p_ {i - 1, j}} \ sobre {2 \ delta x}}, {{p_ {i, j + 1}} - {p_ {i, j - 1}} \ over {2 \ delta y}} </script></td></tr><tr><td>  <b>div</b> </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mtext" id="MJXp-Span-726">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">a</span><span class="MJXp-mtext" id="MJXp-Span-732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">t</span><span class="MJXp-mtext" id="MJXp-Span-737">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">f</span><span class="MJXp-mtext" id="MJXp-Span-740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">c</span><span class="MJXp-mrow" id="MJXp-Span-744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">u</span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mrow" id="MJXp-Span-748"><span class="MJXp-mtext" id="MJXp-Span-749">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">l</span><span class="MJXp-mtext" id="MJXp-Span-758">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">r</span><span class="MJXp-mtext" id="MJXp-Span-763">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">x</span></span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-773"><span class="MJXp-mtext" id="MJXp-Span-774">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">l</span><span class="MJXp-mtext" id="MJXp-Span-783">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">r</span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">y</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ nabla \ cdot \ bf \ vec {u} = {{\ u parcial \ over \ parcial x} + {\ u parcial \ over \ parcial y}} </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-mrow" id="MJXp-Span-798"><span class="MJXp-mrow" id="MJXp-Span-799"><span class="MJXp-mtext" id="MJXp-Span-800">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-801">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">c</span><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mrow" id="MJXp-Span-806" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-808" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-809">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">x</span><span class="MJXp-mo" id="MJXp-Span-811">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">i</span><span class="MJXp-mo" id="MJXp-Span-813">+</span><span class="MJXp-mn" id="MJXp-Span-814">1</span><span class="MJXp-mo" id="MJXp-Span-815">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-818">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">c</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mrow" id="MJXp-Span-823" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-825" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-826">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">x</span><span class="MJXp-mo" id="MJXp-Span-828">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">i</span><span class="MJXp-mo" id="MJXp-Span-830">−</span><span class="MJXp-mn" id="MJXp-Span-831">1</span><span class="MJXp-mo" id="MJXp-Span-832">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">e</span><span class="MJXp-mrow" id="MJXp-Span-840"><span class="MJXp-mn" id="MJXp-Span-841">2</span><span class="MJXp-mtext" id="MJXp-Span-842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-850"><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mtext" id="MJXp-Span-852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">c</span><span class="MJXp-msubsup" id="MJXp-Span-856"><span class="MJXp-mrow" id="MJXp-Span-857" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-859" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-860">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">y</span><span class="MJXp-mo" id="MJXp-Span-862">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">i</span><span class="MJXp-mo" id="MJXp-Span-864">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">j</span><span class="MJXp-mo" id="MJXp-Span-866">+</span><span class="MJXp-mn" id="MJXp-Span-867">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-869">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">c</span><span class="MJXp-msubsup" id="MJXp-Span-873"><span class="MJXp-mrow" id="MJXp-Span-874" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-876" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-877">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">y</span><span class="MJXp-mo" id="MJXp-Span-879">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">i</span><span class="MJXp-mo" id="MJXp-Span-881">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">j</span><span class="MJXp-mo" id="MJXp-Span-883">−</span><span class="MJXp-mn" id="MJXp-Span-884">1</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-885">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">e</span><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mn" id="MJXp-Span-893">2</span><span class="MJXp-mtext" id="MJXp-Span-894">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">y</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> {{\ \ vec {u} _ {(x) i + 1, j} - \ vec {u} _ {(x) i - 1, j}} \ sobre {2 \ delta x}} + {{\ vec {u} _ {(y) i, j + 1} - \ vec {u} _ {(y) i, j - 1}} \ mais de {2 \ delta y}} </script></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-mtext" id="MJXp-Span-902">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">f</span><span class="MJXp-mtext" id="MJXp-Span-905">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ bf \ Delta </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mtext" id="MJXp-Span-912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">f</span><span class="MJXp-mtext" id="MJXp-Span-915">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">l</span><span class="MJXp-msubsup" id="MJXp-Span-920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-922" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">p</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-925"><span class="MJXp-mtext" id="MJXp-Span-926">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">a</span><span class="MJXp-msubsup" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-935" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">p</span><span class="MJXp-mtext" id="MJXp-Span-937">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">e</span><span class="MJXp-mtext" id="MJXp-Span-943">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">l</span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-953" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-955"><span class="MJXp-mtext" id="MJXp-Span-956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">a</span><span class="MJXp-msubsup" id="MJXp-Span-963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-965" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">p</span><span class="MJXp-mtext" id="MJXp-Span-967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">e</span><span class="MJXp-mtext" id="MJXp-Span-973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">l</span><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-983" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ bf \ nabla ^ 2p = {\ parcial ^ 2 p \ sobre \ parcial x ^ 2} + {\ parcial ^ 2 p \ sobre \ parcial y ^ 2} </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-mrow" id="MJXp-Span-985"><span class="MJXp-mrow" id="MJXp-Span-986"><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-989" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">i</span><span class="MJXp-mo" id="MJXp-Span-991">+</span><span class="MJXp-mn" id="MJXp-Span-992">1</span><span class="MJXp-mo" id="MJXp-Span-993">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-996">2</span><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-999" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">i</span><span class="MJXp-mo" id="MJXp-Span-1001">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1006" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">i</span><span class="MJXp-mo" id="MJXp-Span-1008">−</span><span class="MJXp-mn" id="MJXp-Span-1009">1</span><span class="MJXp-mo" id="MJXp-Span-1010">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1012">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">r</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1018">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">x</span><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1027" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1029"><span class="MJXp-mrow" id="MJXp-Span-1030"><span class="MJXp-msubsup" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1033" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">i</span><span class="MJXp-mo" id="MJXp-Span-1035">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">j</span><span class="MJXp-mo" id="MJXp-Span-1037">+</span><span class="MJXp-mn" id="MJXp-Span-1038">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1040">2</span><span class="MJXp-msubsup" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1043" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">i</span><span class="MJXp-mo" id="MJXp-Span-1045">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1050" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">i</span><span class="MJXp-mo" id="MJXp-Span-1052">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">j</span><span class="MJXp-mo" id="MJXp-Span-1054">−</span><span class="MJXp-mn" id="MJXp-Span-1055">1</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1056">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">r</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">y</span><span class="MJXp-msubsup" id="MJXp-Span-1069"><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1071" style="vertical-align: 0.5em;">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> {{p_ {i + 1, j} -2p_ {i, j} + p_ {i - 1, j}} \ over (\ delta x) ^ 2} + {{p_ {i, j + 1} - 2p_ {i, j} + p_ {i, j - 1}} \ over (\ delta y) ^ 2} </script></td></tr><tr><td>  <b>apodrecer</b> </td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1072"><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">f</span><span class="MJXp-mtext" id="MJXp-Span-1076">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">a</span><span class="MJXp-mtext" id="MJXp-Span-1082">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">s</span><span class="MJXp-mtext" id="MJXp-Span-1088">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">c</span><span class="MJXp-mrow" id="MJXp-Span-1092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">u</span></span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1095"><span class="MJXp-mrow" id="MJXp-Span-1096"><span class="MJXp-mtext" id="MJXp-Span-1097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">l</span><span class="MJXp-mtext" id="MJXp-Span-1105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">v</span><span class="MJXp-mtext" id="MJXp-Span-1107">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">u</span></span><span class="MJXp-mtext" id="MJXp-Span-1110">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">e</span><span class="MJXp-mtext" id="MJXp-Span-1116">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">y</span></span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1126"><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">l</span><span class="MJXp-mtext" id="MJXp-Span-1135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">c</span><span class="MJXp-mrow" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">u</span></span><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">e</span><span class="MJXp-mtext" id="MJXp-Span-1147">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">x</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ bf \ nabla \ times \ vec {u} = {{\ parcial \ v \ {u} \ sobre \ parcial y} - {\ parcial \ vec {u} \ sobre \ parcial x}} </script></td><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-mrow" id="MJXp-Span-1157"><span class="MJXp-mtext" id="MJXp-Span-1158">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">c</span><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mrow" id="MJXp-Span-1163" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1165" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1166">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">y</span><span class="MJXp-mo" id="MJXp-Span-1168">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">i</span><span class="MJXp-mo" id="MJXp-Span-1170">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">j</span><span class="MJXp-mo" id="MJXp-Span-1172">+</span><span class="MJXp-mn" id="MJXp-Span-1173">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">c</span><span class="MJXp-msubsup" id="MJXp-Span-1179"><span class="MJXp-mrow" id="MJXp-Span-1180" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1182" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1183">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">y</span><span class="MJXp-mo" id="MJXp-Span-1185">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">i</span><span class="MJXp-mo" id="MJXp-Span-1187">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">j</span><span class="MJXp-mo" id="MJXp-Span-1189">−</span><span class="MJXp-mn" id="MJXp-Span-1190">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">e</span><span class="MJXp-mn" id="MJXp-Span-1198">2</span><span class="MJXp-mtext" id="MJXp-Span-1199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">y</span></span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1207"><span class="MJXp-mtext" id="MJXp-Span-1208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">c</span><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mrow" id="MJXp-Span-1213" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1215" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1216">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">x</span><span class="MJXp-mo" id="MJXp-Span-1218">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">i</span><span class="MJXp-mo" id="MJXp-Span-1220">+</span><span class="MJXp-mn" id="MJXp-Span-1221">1</span><span class="MJXp-mo" id="MJXp-Span-1222">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">c</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mrow" id="MJXp-Span-1230" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1232" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-1233">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">x</span><span class="MJXp-mo" id="MJXp-Span-1235">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">i</span><span class="MJXp-mo" id="MJXp-Span-1237">−</span><span class="MJXp-mn" id="MJXp-Span-1238">1</span><span class="MJXp-mo" id="MJXp-Span-1239">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">e</span><span class="MJXp-mn" id="MJXp-Span-1248">2</span><span class="MJXp-mtext" id="MJXp-Span-1249">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> {\ vec {u} _ {(y) i, j + 1} - \ vec {u} _ {(y) i, j - 1} \ mais de 2 \ delta y} - {\ vec {u} _ {(x) i + 1, j} - \ vec {u} _ {(x) i - 1, j} \ mais de 2 \ delta x} </script></td></tr></tbody></table></div><br>  Podemos simplificar ainda mais as fórmulas discretas dos operadores de vetores se assumirmos que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mtext" id="MJXp-Span-1257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">x</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">y</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1273">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ delta x = \ delta y = 1 </script>  .  Essa suposição não afetará muito a precisão do algoritmo, no entanto, reduz o número de operações por iteração e geralmente torna as expressões mais agradáveis ​​aos olhos. <br><br><h3>  Movimento de partículas </h3><br>  Essas declarações funcionam apenas se pudermos encontrar as partículas mais próximas em relação à que está sendo considerada no momento.  Para anular todos os custos possíveis associados à sua localização, rastrearemos não o movimento deles, mas de <b>onde as</b> partículas vêm no início da iteração, projetando a trajetória do movimento para trás no tempo (em outras palavras, subtraia o vetor de velocidade vezes a mudança de tempo de posição atual).  Usando esta técnica para cada elemento da matriz, teremos certeza de que qualquer partícula terá "vizinhos": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/440/b06/2d6/440b062d626ccc9e818ea619d91fd033.jpg" alt="imagem"><br><br>  Colocando isso <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> q </script>  - um elemento da matriz que armazena o estado da partícula, obtemos a seguinte fórmula para calcular seu estado ao longo do tempo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mtext" id="MJXp-Span-1277">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> \ delta t </script>  (acreditamos que todos os parâmetros necessários na forma de aceleração e pressão já foram calculados): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">q</span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1287"><span class="MJXp-mrow" id="MJXp-Span-1288"><span class="MJXp-mtext" id="MJXp-Span-1289">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1290">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">c</span><span class="MJXp-mrow" id="MJXp-Span-1294"><span class="MJXp-mtext" id="MJXp-Span-1295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">t</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1302">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">t</span></span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">q</span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1313"><span class="MJXp-mrow" id="MJXp-Span-1314"><span class="MJXp-mtext" id="MJXp-Span-1315">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">f</span><span class="MJXp-mtext" id="MJXp-Span-1319">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">c</span><span class="MJXp-mrow" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1326"><span class="MJXp-mtext" id="MJXp-Span-1327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">f</span><span class="MJXp-mtext" id="MJXp-Span-1330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">c</span><span class="MJXp-mrow" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">u</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1336">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">t</span></span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">t</span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> q ({{\ \ vec {\ bf x}}, t + \ delta t}) = q ({{\ \ bf \ vec {x}} - {\ bf \ vec {u}} \ delta t}, t) </script></p><br>  Notamos imediatamente que, para pequenas quantidades <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1346"><span class="MJXp-mtext" id="MJXp-Span-1347">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> \ delta t </script>  e nunca podemos ir além dos limites da célula, portanto, é muito importante escolher o momento certo que o usuário dará às partículas. <br><br>  Para evitar a perda de precisão no caso de uma projeção no limite da célula ou no caso de coordenadas não inteiras, realizaremos a interpolação bilinear dos estados das quatro partículas mais próximas e a consideraremos como o valor verdadeiro em um ponto.  Em princípio, esse método praticamente não reduz a precisão da simulação e, ao mesmo tempo, é bastante simples de implementar, por isso vamos usá-lo. <br><br><h3>  Viscosidade </h3><br>  Cada líquido tem uma certa viscosidade, a capacidade de impedir a influência de forças externas em suas partes (mel e água serão um bom exemplo, em alguns casos, seus coeficientes de viscosidade diferem em uma ordem de magnitude).  A viscosidade afeta diretamente a aceleração adquirida pelo líquido e pode ser expressa pela fórmula abaixo, se, por questões de brevidade, omitirmos outros termos por um tempo: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1354"><span class="MJXp-mrow" id="MJXp-Span-1355"><span class="MJXp-mtext" id="MJXp-Span-1356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">l</span><span class="MJXp-mtext" id="MJXp-Span-1364">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">c</span><span class="MJXp-mrow" id="MJXp-Span-1368"><span class="MJXp-mtext" id="MJXp-Span-1369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">u</span></span><span class="MJXp-mtext" id="MJXp-Span-1373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">e</span><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">t</span></span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mtext" id="MJXp-Span-1390">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">u</span><span class="MJXp-mtext" id="MJXp-Span-1393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">l</span><span class="MJXp-msubsup" id="MJXp-Span-1398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1400" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1401">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">f</span><span class="MJXp-mtext" id="MJXp-Span-1404">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">c</span><span class="MJXp-mrow" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">u</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> {\ parcial \ vec {\ bf u} \ sobre \ parcial t} = {\ nu \ nabla ^ 2 \ bf \ vec {u}} </script></p>  .  Nesse caso, a equação iterativa para velocidade assume a seguinte forma: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">u</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1413"><span class="MJXp-mtext" id="MJXp-Span-1414">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">f</span><span class="MJXp-mtext" id="MJXp-Span-1417">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">c</span><span class="MJXp-mrow" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">t</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1426">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">t</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">u</span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1437"><span class="MJXp-mtext" id="MJXp-Span-1438">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">f</span><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">c</span><span class="MJXp-mrow" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">t</span><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1451">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">u</span><span class="MJXp-mtext" id="MJXp-Span-1454">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">t</span><span class="MJXp-mtext" id="MJXp-Span-1461">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">l</span><span class="MJXp-msubsup" id="MJXp-Span-1466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1468" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">f</span><span class="MJXp-mtext" id="MJXp-Span-1472">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">c</span><span class="MJXp-mrow" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">u</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> u ({\ bf \ vec {x}}, t + \ delta t) = u ({\ bf \ vec {x}}, t) + \ nu \ delta t \ nabla ^ 2 \ bf \ vec {u } </script></p><br>  Transformaremos levemente essa igualdade, trazendo-a para a forma <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1478"><span class="MJXp-mtext" id="MJXp-Span-1479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">A</span><span class="MJXp-mtext" id="MJXp-Span-1483">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">c</span><span class="MJXp-mrow" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">x</span></span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">c</span><span class="MJXp-mrow" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">b</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> \ bf A \ vec {x} = \ vec {b} </script>  (forma padrão de um sistema de equações lineares): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1496"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1498"><span class="MJXp-mtext" id="MJXp-Span-1499">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">I</span></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">u</span><span class="MJXp-mtext" id="MJXp-Span-1507">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">t</span><span class="MJXp-mtext" id="MJXp-Span-1514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">l</span><span class="MJXp-msubsup" id="MJXp-Span-1519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1521" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">u</span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1525"><span class="MJXp-mtext" id="MJXp-Span-1526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">f</span><span class="MJXp-mtext" id="MJXp-Span-1529">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">c</span><span class="MJXp-mrow" id="MJXp-Span-1533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">t</span><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1538">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">t</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">u</span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1550"><span class="MJXp-mtext" id="MJXp-Span-1551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">f</span><span class="MJXp-mtext" id="MJXp-Span-1554">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">c</span><span class="MJXp-mrow" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">t</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> ({\ bf I} - \ nu \ delta t \ nabla ^ 2) u ({\ bf \ vec {x}}, t + \ delta t) = {u ({\ bf \ vec {x}}, t )} </script></p><br>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1563"><span class="MJXp-mtext" id="MJXp-Span-1564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> \ bf I </script>  É a matriz de identidade.  Precisamos dessas transformações para posteriormente aplicar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o método de Jacobi</a> para resolver vários sistemas de equações semelhantes.  Também discutiremos isso mais tarde. <br><br><h3>  Forças externas </h3><br>  O passo mais simples do algoritmo é a aplicação de forças externas ao meio.  Para o usuário, isso será refletido na forma de cliques na tela com o mouse ou seu movimento.  A força externa pode ser descrita pela fórmula a seguir, que aplicamos a cada elemento da matriz ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mtext" id="MJXp-Span-1569">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">c</span><span class="MJXp-mrow" id="MJXp-Span-1573"><span class="MJXp-mtext" id="MJXp-Span-1574">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">G</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> \ vec {\ bf G} </script>  - vetor de momento <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-msubsup" id="MJXp-Span-1579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1581" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1585" style="vertical-align: -0.4em;">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> x_p, y_p </script>  - posição do mouse <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">x</span><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> x, y </script>  - coordenadas da célula atual, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> r </script>  - raio de ação, parâmetro de escala): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1592"><span class="MJXp-mtext" id="MJXp-Span-1593">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">c</span><span class="MJXp-mrow" id="MJXp-Span-1597"><span class="MJXp-mtext" id="MJXp-Span-1598">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">F</span></span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1603">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">c</span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mtext" id="MJXp-Span-1608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">G</span></span><span class="MJXp-mtext" id="MJXp-Span-1612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">t</span><span class="MJXp-mrow" id="MJXp-Span-1619"><span class="MJXp-mtext" id="MJXp-Span-1620">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">p</span></span><span class="MJXp-mtext" id="MJXp-Span-1626">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">t</span><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1633"><span class="MJXp-mrow" id="MJXp-Span-1634"><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">x</span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1640" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-msubsup" id="MJXp-Span-1641"><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1643" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">y</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1650" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-msubsup" id="MJXp-Span-1651"><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1653" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1654">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">r</span></span><span class="MJXp-mtext" id="MJXp-Span-1661">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">t</span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> \ vec {\ bf F} = \ vec {\ bf G} \ delta t {\ bf exp} \ left (- {{(x - x_p) ^ 2 + (y - y_p) ^ 2} \ sobre r} \ right) </script></p><br>  Um vetor de impulso pode ser facilmente calculado como a diferença entre a posição anterior do mouse e a atual (se houver), e aqui você ainda pode ser criativo.  É nesta parte do algoritmo que podemos introduzir a adição de cores a um líquido, sua iluminação etc.  As forças externas também podem incluir gravidade e temperatura e, embora não seja difícil implementar tais parâmetros, não os consideraremos neste artigo. <br><br><h3>  Pressão </h3><br>  A pressão na equação de Navier-Stokes é a força que impede que as partículas preencham todo o espaço disponível após aplicar qualquer força externa nelas.  Imediatamente, seu cálculo é muito difícil, mas nosso problema pode ser bastante simplificado aplicando o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">teorema da decomposição de Helmholtz</a> . <br><br>  Ligar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1668"><span class="MJXp-mtext" id="MJXp-Span-1669">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">f</span><span class="MJXp-mtext" id="MJXp-Span-1672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">c</span><span class="MJXp-mrow" id="MJXp-Span-1676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">W</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ bf \ vec {W} </script>  campo vetorial obtido após o cálculo do deslocamento, forças externas e viscosidade.  Apresentará uma divergência diferente de zero, o que contradiz a condição de incompressibilidade do líquido ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1678"><span class="MJXp-mtext" id="MJXp-Span-1679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">a</span><span class="MJXp-mtext" id="MJXp-Span-1685">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">t</span><span class="MJXp-mtext" id="MJXp-Span-1690">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">f</span><span class="MJXp-mtext" id="MJXp-Span-1693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">c</span><span class="MJXp-mrow" id="MJXp-Span-1697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">u</span></span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1700">0</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ nabla \ cdot \ bf \ vec {u} = 0 </script>  ) e, para corrigir isso, é necessário calcular a pressão.  De acordo com o teorema da decomposição de Helmholtz, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1701"><span class="MJXp-mtext" id="MJXp-Span-1702">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">f</span><span class="MJXp-mtext" id="MJXp-Span-1705">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">c</span><span class="MJXp-mrow" id="MJXp-Span-1709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">W</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ bf \ vec {W} </script>  pode ser representado como a soma de dois campos: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1711"><span class="MJXp-mtext" id="MJXp-Span-1712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">f</span><span class="MJXp-mtext" id="MJXp-Span-1715">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">c</span><span class="MJXp-mrow" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">W</span></span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1722">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">c</span><span class="MJXp-mrow" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">u</span></span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1729">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">p</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> \ bf \ vec {W} = \ vec {u} + \ na p </script></p><br>  onde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1733"><span class="MJXp-mtext" id="MJXp-Span-1734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ bf u </script>  - este é o campo vetorial que procuramos com divergência zero.  Nenhuma prova dessa igualdade será fornecida neste artigo, mas no final você pode encontrar um link com uma explicação detalhada.  Podemos aplicar o operador nabla nos dois lados da expressão para obter a seguinte fórmula para calcular o campo de pressão escalar: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1738"><span class="MJXp-mtext" id="MJXp-Span-1739">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">a</span><span class="MJXp-mtext" id="MJXp-Span-1745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">t</span><span class="MJXp-mtext" id="MJXp-Span-1750">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">f</span><span class="MJXp-mtext" id="MJXp-Span-1753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">c</span><span class="MJXp-mrow" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">W</span></span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">a</span><span class="MJXp-mtext" id="MJXp-Span-1766">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">t</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1772">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">c</span><span class="MJXp-mrow" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">u</span></span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1779">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">p</span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">a</span><span class="MJXp-mtext" id="MJXp-Span-1794">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">t</span><span class="MJXp-mtext" id="MJXp-Span-1799">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">c</span><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">u</span></span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1806">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">l</span><span class="MJXp-msubsup" id="MJXp-Span-1811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1813" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">p</span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1816">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">l</span><span class="MJXp-msubsup" id="MJXp-Span-1821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1823" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">p</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-48"> \ nabla \ cdot \ bf \ vec {W} = \ nabla \ cdot (\ vec {u} + \ nabla p) = \ nabla \ cdot \ vec {u} + \ nabla ^ 2 p = \ nabla ^ 2 p </script></p><br>  A expressão escrita acima é <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a equação de Poisson</a> para pressão.  Também podemos resolvê-lo pelo método de Jacobi acima mencionado e, assim, encontrar a última variável desconhecida na equação de Navier-Stokes.  Em princípio, os sistemas de equações lineares podem ser resolvidos de várias maneiras diferentes e sofisticadas, mas ainda vamos nos concentrar nas mais simples delas, para não sobrecarregar ainda mais este artigo. <br><br><h3>  Limite e condições iniciais </h3><br>  Qualquer equação diferencial modelada em um domínio finito requer condições iniciais ou de contorno especificadas corretamente, caso contrário, é muito provável que obtenhamos um resultado fisicamente incorreto.  As condições de contorno são estabelecidas para controlar o comportamento do fluido próximo às bordas da grade de coordenadas, e as condições iniciais especificam os parâmetros que as partículas têm no momento em que o programa é iniciado. <br><br>  As condições iniciais serão muito simples - inicialmente o fluido é estacionário (a velocidade das partículas é zero) e a pressão também é zero.  As condições de contorno serão definidas para velocidade e pressão pelas fórmulas fornecidas: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1825"><span class="MJXp-mrow" id="MJXp-Span-1826"><span class="MJXp-mtext" id="MJXp-Span-1827">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">f</span><span class="MJXp-mtext" id="MJXp-Span-1830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">c</span><span class="MJXp-msubsup" id="MJXp-Span-1834"><span class="MJXp-mrow" id="MJXp-Span-1835" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1837" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1838">0</span><span class="MJXp-mo" id="MJXp-Span-1839">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">f</span><span class="MJXp-mtext" id="MJXp-Span-1845">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">c</span><span class="MJXp-msubsup" id="MJXp-Span-1849"><span class="MJXp-mrow" id="MJXp-Span-1850" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1852" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1853">1</span><span class="MJXp-mo" id="MJXp-Span-1854">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1856">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">e</span><span class="MJXp-mn" id="MJXp-Span-1863">2</span><span class="MJXp-mtext" id="MJXp-Span-1864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">y</span></span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1872">0</span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1874"><span class="MJXp-mtext" id="MJXp-Span-1875">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">f</span><span class="MJXp-mtext" id="MJXp-Span-1878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881">c</span><span class="MJXp-msubsup" id="MJXp-Span-1882"><span class="MJXp-mrow" id="MJXp-Span-1883" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1885" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">i</span><span class="MJXp-mo" id="MJXp-Span-1887">,</span><span class="MJXp-mn" id="MJXp-Span-1888">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1890">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">f</span><span class="MJXp-mtext" id="MJXp-Span-1893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">c</span><span class="MJXp-msubsup" id="MJXp-Span-1897"><span class="MJXp-mrow" id="MJXp-Span-1898" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899">u</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">i</span><span class="MJXp-mo" id="MJXp-Span-1902">,</span><span class="MJXp-mn" id="MJXp-Span-1903">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1904">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">e</span><span class="MJXp-mn" id="MJXp-Span-1911">2</span><span class="MJXp-mtext" id="MJXp-Span-1912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">x</span></span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1920">0</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-49"> {\ bf \ vec {u} _ {0, j} + \ bf \ vec {u} _ {1, j} \ mais de 2 \ delta y} = 0, {\ bf \ vec {u} _ {i , 0} + \ bf \ vec {u} _ {i, 1} \ mais de 2 \ delta x} = 0 </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1921"><span class="MJXp-mrow" id="MJXp-Span-1922"><span class="MJXp-mtext" id="MJXp-Span-1923">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">f</span><span class="MJXp-msubsup" id="MJXp-Span-1926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1928" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1929">0</span><span class="MJXp-mo" id="MJXp-Span-1930">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1933">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">f</span><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1939">1</span><span class="MJXp-mo" id="MJXp-Span-1940">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1942">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">r</span><span class="MJXp-mtext" id="MJXp-Span-1947">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">x</span></span><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1955">0</span><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1957"><span class="MJXp-mtext" id="MJXp-Span-1958">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">f</span><span class="MJXp-msubsup" id="MJXp-Span-1961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1963" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">i</span><span class="MJXp-mo" id="MJXp-Span-1965">,</span><span class="MJXp-mn" id="MJXp-Span-1966">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1968">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">f</span><span class="MJXp-msubsup" id="MJXp-Span-1971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1973" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">i</span><span class="MJXp-mo" id="MJXp-Span-1975">,</span><span class="MJXp-mn" id="MJXp-Span-1976">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">r</span><span class="MJXp-mtext" id="MJXp-Span-1982">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">y</span></span><span class="MJXp-mo" id="MJXp-Span-1989" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1990">0</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-50"> {\ bf p_ {0, j} - \ bf p_ {1, j} \ over \ delta x} = 0, {\ bf p_ {i, 0} - \ bf p_ {i, 1} \ over \ delta y} = 0 </script></p><br>  Assim, a velocidade das partículas nas bordas será oposta à velocidade nas bordas (assim elas se repelirão a partir da borda), e a pressão é igual ao valor imediatamente próximo ao limite.  Essas operações devem ser aplicadas a todos os elementos delimitadores da matriz (por exemplo, há um tamanho de grade <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">N</span><span class="MJXp-mtext" id="MJXp-Span-1993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> N \ vezes M </script>  , aplicamos o algoritmo às células marcadas em azul na figura): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e3/23a/13d/5e323a13d065ec846d2a03d7df9484ae.jpg" alt="imagem"><br><br><h3>  Corante </h3><br>  Com o que temos agora, você já pode ter muitas coisas interessantes.  Por exemplo, para perceber a propagação do corante em um líquido.  Para fazer isso, precisamos apenas manter outro campo escalar, que seria responsável pela quantidade de tinta em cada ponto da simulação.  A fórmula para atualizar o corante é muito semelhante à velocidade e é expressa como: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2000"><span class="MJXp-mrow" id="MJXp-Span-2001"><span class="MJXp-mtext" id="MJXp-Span-2002">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">d</span><span class="MJXp-mtext" id="MJXp-Span-2011">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">e</span><span class="MJXp-mtext" id="MJXp-Span-2017">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">t</span></span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2027"><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2030">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">c</span><span class="MJXp-mrow" id="MJXp-Span-2034"><span class="MJXp-mtext" id="MJXp-Span-2035">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">u</span></span><span class="MJXp-mtext" id="MJXp-Span-2039">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">t</span><span class="MJXp-mtext" id="MJXp-Span-2044">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">a</span><span class="MJXp-mo" id="MJXp-Span-2050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">d</span></span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2053">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">a</span><span class="MJXp-mtext" id="MJXp-Span-2058">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">l</span><span class="MJXp-msubsup" id="MJXp-Span-2063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2065" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">d</span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">S</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-52"> {\ parcial d \ sobre \ parcial t} = {- (\ vec {\ bf u} \ cdot \ nabla) d} + \ gama \ nabla ^ 2d + S </script></p><br>  Na fórmula <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">S</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> S </script>  responsável por reabastecer a área com um corante (possivelmente dependendo de onde o usuário clica), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> d </script>  diretamente é a quantidade de corante no ponto e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2073"><span class="MJXp-mtext" id="MJXp-Span-2074">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> \ gama </script>  - coeficiente de difusão.  Não é difícil resolvê-lo, pois todo o trabalho básico sobre derivação de fórmulas já foi realizado e basta fazer algumas substituições.  A tinta pode ser implementada no código como uma cor no formato RGB e, nesse caso, a tarefa é reduzida a operações com vários valores reais. <br><br><h3>  Vorticidade </h3><br>  A equação de vorticidade não é uma parte direta da equação de Navier-Stokes, mas é um parâmetro importante para uma simulação plausível do movimento de um corante em um líquido.  Devido ao fato de estarmos produzindo um algoritmo em um campo discreto, bem como devido a perdas na precisão dos valores de ponto flutuante, esse efeito é perdido e, portanto, precisamos restaurá-lo aplicando força adicional a cada ponto no espaço.  O vetor dessa força é designado como <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2079"><span class="MJXp-mtext" id="MJXp-Span-2080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">f</span><span class="MJXp-mtext" id="MJXp-Span-2083">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2085">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">c</span><span class="MJXp-mrow" id="MJXp-Span-2087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ bf \ vec {T} </script>  e é determinado pelas seguintes fórmulas: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2089"><span class="MJXp-mtext" id="MJXp-Span-2090">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">f</span><span class="MJXp-mtext" id="MJXp-Span-2093">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">a</span><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2100">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">a</span><span class="MJXp-mtext" id="MJXp-Span-2106">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">s</span><span class="MJXp-mtext" id="MJXp-Span-2112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">c</span><span class="MJXp-mrow" id="MJXp-Span-2116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">u</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-57"> \ bf \ omega = \ nabla \ times \ vec {u} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2118"><span class="MJXp-mtext" id="MJXp-Span-2119">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">c</span><span class="MJXp-mrow" id="MJXp-Span-2123"><span class="MJXp-mtext" id="MJXp-Span-2124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">a</span></span><span class="MJXp-mo" id="MJXp-Span-2128" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">a</span><span class="MJXp-mrow" id="MJXp-Span-2135"><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">a</span><span class="MJXp-mrow" id="MJXp-Span-2143"><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-58"> \ vec {\ eta} = \ nabla | \ omega | </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2145"><span class="MJXp-mtext" id="MJXp-Span-2146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">f</span><span class="MJXp-mtext" id="MJXp-Span-2149">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">c</span><span class="MJXp-mrow" id="MJXp-Span-2153"><span class="MJXp-mtext" id="MJXp-Span-2154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">i</span></span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2159"><span class="MJXp-mtext" id="MJXp-Span-2160">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">c</span><span class="MJXp-mrow" id="MJXp-Span-2164"><span class="MJXp-mtext" id="MJXp-Span-2165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2167">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">a</span></span><span class="MJXp-mtext" id="MJXp-Span-2169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">e</span><span class="MJXp-mrow" id="MJXp-Span-2175"><span class="MJXp-mrow" id="MJXp-Span-2176"><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-2178">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">c</span><span class="MJXp-mrow" id="MJXp-Span-2182"><span class="MJXp-mtext" id="MJXp-Span-2183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">a</span></span><span class="MJXp-mrow" id="MJXp-Span-2187"><span class="MJXp-mo" id="MJXp-Span-2188" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-59"> \ bf \ vec {\ psi} = {\ vec {\ eta} \ sobre {| \ vec {\ eta} |}} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2189"><span class="MJXp-mtext" id="MJXp-Span-2190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192">f</span><span class="MJXp-mtext" id="MJXp-Span-2193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">c</span><span class="MJXp-mrow" id="MJXp-Span-2197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">T</span></span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">n</span><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2209">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">c</span><span class="MJXp-mrow" id="MJXp-Span-2213"><span class="MJXp-mtext" id="MJXp-Span-2214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">i</span></span><span class="MJXp-mtext" id="MJXp-Span-2218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">s</span><span class="MJXp-mtext" id="MJXp-Span-2224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">a</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-2231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-60"> \ bf \ vec {T} = \ epsilon (\ vec {\ psi} \ times \ omega) \ delta x </script></p><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2238"><span class="MJXp-mtext" id="MJXp-Span-2239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> \ omega </script>  há o resultado da aplicação do <b>rotor</b> ao vetor de velocidade (sua definição é dada no início do artigo), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2245"><span class="MJXp-mtext" id="MJXp-Span-2246">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">c</span><span class="MJXp-mtext" id="MJXp-Span-2250">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> \ vec \ eta </script>  - gradiente do campo escalar de valores absolutos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2254"><span class="MJXp-mtext" id="MJXp-Span-2255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> \ omega </script>  . <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2261"><span class="MJXp-mtext" id="MJXp-Span-2262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">c</span><span class="MJXp-mtext" id="MJXp-Span-2266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> \ vec \ psi </script>  representa um vetor normalizado <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2270"><span class="MJXp-mtext" id="MJXp-Span-2271">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2274">c</span><span class="MJXp-mtext" id="MJXp-Span-2275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ vec \ eta </script>  e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2279"><span class="MJXp-mtext" id="MJXp-Span-2280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ epsilon </script>  É uma constante que controla o tamanho dos vórtices em nosso fluido. <br><br><h3>  Método de Jacobi para resolver sistemas de equações lineares </h3><br>  Ao analisar as equações de Navier-Stokes, criamos dois sistemas de equações - um para viscosidade e outro para pressão.  Eles podem ser resolvidos por um algoritmo iterativo, que pode ser descrito pela seguinte fórmula iterativa: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2288"><span class="MJXp-msubsup" id="MJXp-Span-2289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2295"><span class="MJXp-mo" id="MJXp-Span-2296">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">k</span><span class="MJXp-mo" id="MJXp-Span-2298">+</span><span class="MJXp-mn" id="MJXp-Span-2299">1</span><span class="MJXp-mo" id="MJXp-Span-2300">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292">i</span><span class="MJXp-mo" id="MJXp-Span-2293">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2302"><span class="MJXp-mrow" id="MJXp-Span-2303"><span class="MJXp-msubsup" id="MJXp-Span-2304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2312"><span class="MJXp-mo" id="MJXp-Span-2313">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314">k</span><span class="MJXp-mo" id="MJXp-Span-2315">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">i</span><span class="MJXp-mo" id="MJXp-Span-2308">−</span><span class="MJXp-mn" id="MJXp-Span-2309">1</span><span class="MJXp-mo" id="MJXp-Span-2310">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2325"><span class="MJXp-mo" id="MJXp-Span-2326">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">k</span><span class="MJXp-mo" id="MJXp-Span-2328">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">i</span><span class="MJXp-mo" id="MJXp-Span-2321">+</span><span class="MJXp-mn" id="MJXp-Span-2322">1</span><span class="MJXp-mo" id="MJXp-Span-2323">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2338"><span class="MJXp-mo" id="MJXp-Span-2339">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2340">k</span><span class="MJXp-mo" id="MJXp-Span-2341">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">i</span><span class="MJXp-mo" id="MJXp-Span-2334">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">j</span><span class="MJXp-mo" id="MJXp-Span-2336">−</span><span class="MJXp-mn" id="MJXp-Span-2337">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2351"><span class="MJXp-mo" id="MJXp-Span-2352">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">k</span><span class="MJXp-mo" id="MJXp-Span-2354">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">i</span><span class="MJXp-mo" id="MJXp-Span-2347">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2348">j</span><span class="MJXp-mo" id="MJXp-Span-2349">+</span><span class="MJXp-mn" id="MJXp-Span-2350">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">a</span><span class="MJXp-msubsup" id="MJXp-Span-2362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2364" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">i</span><span class="MJXp-mo" id="MJXp-Span-2366">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">r</span><span class="MJXp-mtext" id="MJXp-Span-2373">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">a</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-67"> x ^ {(k + 1)} _ {i, j} = {{x ^ {(k)} _ {i-1, j} + x ^ {(k)} _ {i + 1, j} + x ^ {(k)} _ {i, j-1} + x ^ {(k)} _ {i, j + 1} + \ alpha b_ {i, j}} \ over \ beta} </script></p><br>  Para nós <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> x </script>  - elementos de matriz que representam um campo escalar ou vetorial. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> k </script>  - o número da iteração, podemos ajustá-lo para aumentar a precisão do cálculo ou vice-versa para reduzi-lo e aumentar a produtividade. <br><br>  Para calcular a viscosidade, substituímos: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2383">x</span><span class="MJXp-mo" id="MJXp-Span-2384" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">b</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2387">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">f</span><span class="MJXp-mtext" id="MJXp-Span-2390">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393">c</span><span class="MJXp-mrow" id="MJXp-Span-2394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">u</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> x = b = \ bf \ vec {u} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2396"><span class="MJXp-mtext" id="MJXp-Span-2397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2400">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402">a</span><span class="MJXp-mo" id="MJXp-Span-2403" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2404"><span class="MJXp-mn" id="MJXp-Span-2405">1</span><span class="MJXp-mtext" id="MJXp-Span-2406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">r</span><span class="MJXp-mtext" id="MJXp-Span-2411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">u</span><span class="MJXp-mtext" id="MJXp-Span-2414">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> \ alpha = {1 \ over \ nu \ delta t} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2421"><span class="MJXp-mtext" id="MJXp-Span-2422">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2425">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">a</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2428">4</span><span class="MJXp-mo" id="MJXp-Span-2429" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> \ beta = 4+ \ alpha </script>  , aqui está o parâmetro <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2436"><span class="MJXp-mtext" id="MJXp-Span-2437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2440">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> \ beta </script>  - a soma dos pesos.  Portanto, precisamos armazenar pelo menos dois campos de velocidade vetorial para ler independentemente os valores de um campo e gravá-los em outro.  Em média, para calcular o campo de velocidade pelo método Jacobi, é necessário realizar de 20 a 50 iterações, o que é bastante se realizarmos cálculos na CPU. <br><br>  Para a equação da pressão, fazemos a seguinte substituição: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443">x</span><span class="MJXp-mo" id="MJXp-Span-2444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> x = p </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447">b</span><span class="MJXp-mo" id="MJXp-Span-2448" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2449">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2450">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454">a</span><span class="MJXp-mtext" id="MJXp-Span-2455">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457">f</span><span class="MJXp-mtext" id="MJXp-Span-2458">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2460">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">t</span><span class="MJXp-mtext" id="MJXp-Span-2463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2464">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">c</span><span class="MJXp-mrow" id="MJXp-Span-2467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2468">W</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> b = \ nabla \ bf \ cdot \ vec {W} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2469"><span class="MJXp-mtext" id="MJXp-Span-2470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2476" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2478"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> \ alpha = -1 </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-mtext" id="MJXp-Span-2480">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-2485" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2486"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> \ beta = 4 </script>  .  Como resultado, obtemos o valor <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2487"><span class="MJXp-msubsup" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2490" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-2492"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495"><font style="vertical-align: inherit;"> d </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500"><font style="vertical-align: inherit;">t</font></span></font><span class="MJXp-mtext" id="MJXp-Span-2494">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2496"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> p_ {i, j} \ delta t </script>  no ponto.  Porém, como é usado apenas para calcular o gradiente subtraído do campo de velocidade, transformações adicionais podem ser omitidas.  Para o campo de pressão, é melhor executar iterações de 40 a 80, porque com números menores a discrepância se torna perceptível. <br><br><h2>  Implementação de algoritmo </h2><br>  Vamos implementar o algoritmo em C ++, também precisamos do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cuda Toolkit</a> (você pode ler como instalá-lo no site da Nvidia), bem como do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SFML</a> .  Precisamos que o CUDA paralelize o algoritmo, e o SFML será usado apenas para criar uma janela e exibir uma imagem na tela (em princípio, isso pode ser escrito em OpenGL, mas a diferença de desempenho não será significativa, mas o código aumentará em mais de 200 linhas). <br><br><h3>  Cuda toolkit </h3><br>  Primeiro, falaremos um pouco sobre como usar o Cuda Toolkit para paralelizar tarefas.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um guia mais detalhado é</a> fornecido pela própria Nvidia; portanto, aqui nos restringimos apenas ao mais necessário.  Supõe-se também que você conseguiu instalar o compilador e conseguiu criar um projeto de teste sem erros. <br><br>  Para criar uma função que é executada na GPU, primeiro você precisa declarar quantos kernels queremos usar e quantos blocos de kernels precisamos alocar.  Para isso, o Cuda Toolkit nos fornece uma estrutura especial - <b>dim3</b> , por padrão, configurando todos os seus valores de x, y, z como 1. Ao especificá-lo como argumento ao chamar a função, podemos controlar o número de kernels alocados.  Como estamos trabalhando com uma matriz bidimensional, precisamos definir apenas dois campos no construtor: <i>xey</i> : <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">threadsPerBlock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x_threads, y_threads)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">numBlocks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(size_x / x_threads, y_size / y_threads)</span></span></span></span>;</code> </pre> <br>  onde <i>size_x</i> e <i>size_y</i> são o tamanho da matriz que está sendo processada.  A assinatura e a chamada de função são as seguintes (colchetes de ângulo triplo são processados ​​pelo compilador Cuda): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> __<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deviceFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// declare deviceFunction&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(); // call from host</span></span></code> </pre> <br>  Na própria função, você pode restaurar os índices de uma matriz bidimensional através do número do bloco e do número do kernel nesse bloco, usando a seguinte fórmula: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = blockIdx.x * blockDim.x + threadIdx.x; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = blockIdx.y * blockDim.y + threadIdx.y;</code> </pre> <br>  Deve-se observar que a função executada na placa de vídeo deve ser marcada com a tag <font color="#C400AB">__global__</font> e também retornar <b>nula</b> , portanto, na maioria das vezes, os resultados do cálculo são gravados na matriz passada como argumento e pré-alocada na memória da placa de vídeo. <br><br>  As funções <b>CudaMalloc</b> e <b>CudaFree</b> são responsáveis ​​por liberar e alocar memória na placa de vídeo.  Podemos operar ponteiros para a área de memória que eles retornam, mas não podemos acessar os dados do código principal.  A maneira mais fácil de retornar os resultados do cálculo é usar <b>cudaMemcpy</b> , semelhante ao <b>memcpy</b> padrão, mas capaz de copiar dados de uma placa de vídeo para a memória principal e vice-versa. <br><br><h3>  SFML e renderização de janela </h3><br>  Armado com todo esse conhecimento, podemos finalmente começar a escrever código diretamente.  Para começar, vamos criar o arquivo <i>main.cpp</i> e colocar todo o código auxiliar para a janela renderizada lá: <br><br><div class="spoiler">  <b class="spoiler_title">main.cpp</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SFML/Graphics.hpp&gt; #include &lt;chrono&gt; #include &lt;cstdlib&gt; #include &lt;cmath&gt; //SFML REQUIRED TO LAUNCH THIS CODE #define SCALE 2 #define WINDOW_WIDTH 1280 #define WINDOW_HEIGHT 720 #define FIELD_WIDTH WINDOW_WIDTH / SCALE #define FIELD_HEIGHT WINDOW_HEIGHT / SCALE static struct Config { float velocityDiffusion; float pressure; float vorticity; float colorDiffusion; float densityDiffusion; float forceScale; float bloomIntense; int radius; bool bloomEnabled; } config; void setConfig(float vDiffusion = 0.8f, float pressure = 1.5f, float vorticity = 50.0f, float cDiffuion = 0.8f, float dDiffuion = 1.2f, float force = 1000.0f, float bloomIntense = 25000.0f, int radius = 100, bool bloom = true); void computeField(uint8_t* result, float dt, int x1pos = -1, int y1pos = -1, int x2pos = -1, int y2pos = -1, bool isPressed = false); void cudaInit(size_t xSize, size_t ySize); void cudaExit(); int main() { cudaInit(FIELD_WIDTH, FIELD_HEIGHT); srand(time(NULL)); sf::RenderWindow window(sf::VideoMode(WINDOW_WIDTH, WINDOW_HEIGHT), ""); auto start = std::chrono::system_clock::now(); auto end = std::chrono::system_clock::now(); sf::Texture texture; sf::Sprite sprite; std::vector&lt;sf::Uint8&gt; pixelBuffer(FIELD_WIDTH * FIELD_HEIGHT * 4); texture.create(FIELD_WIDTH, FIELD_HEIGHT); sf::Vector2i mpos1 = { -1, -1 }, mpos2 = { -1, -1 }; bool isPressed = false; bool isPaused = false; while (window.isOpen()) { end = std::chrono::system_clock::now(); std::chrono::duration&lt;float&gt; diff = end - start; window.setTitle("Fluid simulator " + std::to_string(int(1.0f / diff.count())) + " fps"); start = end; window.clear(sf::Color::White); sf::Event event; while (window.pollEvent(event)) { if (event.type == sf::Event::Closed) window.close(); if (event.type == sf::Event::MouseButtonPressed) { if (event.mouseButton.button == sf::Mouse::Button::Left) { mpos1 = { event.mouseButton.x, event.mouseButton.y }; mpos1 /= SCALE; isPressed = true; } else { isPaused = !isPaused; } } if (event.type == sf::Event::MouseButtonReleased) { isPressed = false; } if (event.type == sf::Event::MouseMoved) { std::swap(mpos1, mpos2); mpos2 = { event.mouseMove.x, event.mouseMove.y }; mpos2 /= SCALE; } } float dt = 0.02f; if (!isPaused) computeField(pixelBuffer.data(), dt, mpos1.x, mpos1.y, mpos2.x, mpos2.y, isPressed); texture.update(pixelBuffer.data()); sprite.setTexture(texture); sprite.setScale({ SCALE, SCALE }); window.draw(sprite); window.display(); } cudaExit(); return 0; }</span></span></span></span></code> </pre><br></div></div><br>  linha no início da função <b>principal</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;sf::Uint8&gt; pixelBuffer(FIELD_WIDTH * FIELD_HEIGHT * <span class="hljs-number"><span class="hljs-number">4</span></span>);</code> </pre> <br>  cria uma imagem RGBA na forma de uma matriz unidimensional com um comprimento constante.  Passaremos junto com outros parâmetros (posição do mouse, diferença entre os quadros) para a função <b>computeField</b> .  As últimas, assim como várias outras funções, são declaradas no <i>kernel.cu</i> e chamam o código executado na GPU.  Você pode encontrar documentação sobre qualquer uma das funções no site da SFML, nada super interessante está acontecendo no código do arquivo, por isso não vamos parar por muito tempo. <br><br><h3>  Computação GPU </h3><br>  Para começar a escrever código no gpu, primeiro crie um arquivo kernel.cu e defina várias classes auxiliares: <b>Color3f, Vec2, Config, SystemConfig</b> : <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (estruturas de dados)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Vec2</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; __device__ Vec2 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>-(Vec2 other) { Vec2 res; res.x = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x - other.x; res.y = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;y - other.y; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } __device__ Vec2 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+(Vec2 other) { Vec2 res; res.x = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x + other.x; res.y = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;y + other.y; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } __device__ Vec2 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>*(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> d) { Vec2 res; res.x = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x * d; res.y = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;y * d; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Color3f</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> R = <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> G = <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> B = <span class="hljs-number"><span class="hljs-number">0.0f</span></span>; __host__ __device__ Color3f <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+ (Color3f other) { Color3f res; res.R = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;R + other.R; res.G = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;G + other.G; res.B = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;B + other.B; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } __host__ __device__ Color3f <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>* (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> d) { Color3f res; res.R = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;R * d; res.G = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;G * d; res.B = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;B * d; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Particle</span></span></span><span class="hljs-class"> {</span></span> Vec2 u; <span class="hljs-comment"><span class="hljs-comment">// velocity Color3f color; }; static struct Config { float velocityDiffusion; float pressure; float vorticity; float colorDiffusion; float densityDiffusion; float forceScale; float bloomIntense; int radius; bool bloomEnabled; } config; static struct SystemConfig { int velocityIterations = 20; int pressureIterations = 40; int xThreads = 64; int yThreads = 1; } sConfig; void setConfig( float vDiffusion = 0.8f, float pressure = 1.5f, float vorticity = 50.0f, float cDiffuion = 0.8f, float dDiffuion = 1.2f, float force = 5000.0f, float bloomIntense = 25000.0f, int radius = 500, bool bloom = true ) { config.velocityDiffusion = vDiffusion; config.pressure = pressure; config.vorticity = vorticity; config.colorDiffusion = cDiffuion; config.densityDiffusion = dDiffuion; config.forceScale = force; config.bloomIntense = bloomIntense; config.radius = radius; config.bloomEnabled = bloom; } static const int colorArraySize = 7; Color3f colorArray[colorArraySize]; static Particle* newField; static Particle* oldField; static uint8_t* colorField; static size_t xSize, ySize; static float* pressureOld; static float* pressureNew; static float* vorticityField; static Color3f currentColor; static float elapsedTime = 0.0f; static float timeSincePress = 0.0f; static float bloomIntense; int lastXpos = -1, lastYpos = -1;</span></span></code> </pre> </div></div><br>  O atributo <font color="#C400AB">__host__ na</font> frente do nome do método significa que o código pode ser executado na CPU; <font color="#C400AB">__dispositivo__</font> , pelo contrário, obriga o compilador a coletar código na GPU.  O código declara primitivas para trabalhar com vetores de dois componentes, cor, configurações com parâmetros que podem ser alterados em tempo de execução, além de vários ponteiros estáticos para matrizes, que usaremos como buffers para cálculos. <br><br>  <b>cudaInit</b> e <b>cudaExit</b> também <b>são</b> definidos de maneira bastante trivial: <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (init)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cudaInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span><span class="hljs-function"> </span></span>{ setConfig(); colorArray[<span class="hljs-number"><span class="hljs-number">0</span></span>] = { <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">1</span></span>] = { <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">2</span></span>] = { <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">3</span></span>] = { <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">4</span></span>] = { <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">5</span></span>] = { <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span> }; colorArray[<span class="hljs-number"><span class="hljs-number">6</span></span>] = { <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.3f</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> idx = rand() % colorArraySize; currentColor = colorArray[idx]; xSize = x, ySize = y; cudaSetDevice(<span class="hljs-number"><span class="hljs-number">0</span></span>); cudaMalloc(&amp;colorField, xSize * ySize * <span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span>)); cudaMalloc(&amp;oldField, xSize * ySize * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(Particle)); cudaMalloc(&amp;newField, xSize * ySize * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(Particle)); cudaMalloc(&amp;pressureOld, xSize * ySize * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)); cudaMalloc(&amp;pressureNew, xSize * ySize * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)); cudaMalloc(&amp;vorticityField, xSize * ySize * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cudaExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ cudaFree(colorField); cudaFree(oldField); cudaFree(newField); cudaFree(pressureOld); cudaFree(pressureNew); cudaFree(vorticityField); }</code> </pre> </div></div><br>  Na função de inicialização, alocamos memória para matrizes bidimensionais, especificamos uma matriz de cores que usaremos para pintar o líquido e também definimos os valores padrão na configuração.  Em <b>cudaExit,</b> apenas <b>liberamos</b> todos os buffers.  Por mais paradoxal que pareça, para armazenar matrizes bidimensionais, é mais vantajoso usar matrizes unidimensionais, cujo acesso será realizado com a seguinte expressão: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">array</span></span>[y * size_x + x]; <span class="hljs-comment"><span class="hljs-comment">// equals to array[y][x]</span></span></code> </pre> <br>  Iniciamos a implementação do algoritmo direto com a função de deslocamento de partículas.  Os campos <i>oldField</i> e <i>newField</i> (o campo de onde os dados vêm e para onde são gravados), o tamanho da matriz, bem como o delta de tempo e o coeficiente de densidade (usado para acelerar a dissolução do corante no líquido e tornar o meio não muito sensível a ações do usuário).  A função de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">interpolação bilinear é</a> implementada de maneira clássica, calculando valores intermediários: <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (advect)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// interpolates quantity of grid cells __device__ Particle interpolate(Vec2 v, Particle* field, size_t xSize, size_t ySize) { float x1 = (int)vx; float y1 = (int)vy; float x2 = (int)vx + 1; float y2 = (int)vy + 1; Particle q1, q2, q3, q4; #define CLAMP(val, minv, maxv) min(maxv, max(minv, val)) #define SET(Q, x, y) Q = field[int(CLAMP(y, 0.0f, ySize - 1.0f)) * xSize + int(CLAMP(x, 0.0f, xSize - 1.0f))] SET(q1, x1, y1); SET(q2, x1, y2); SET(q3, x2, y1); SET(q4, x2, y2); #undef SET #undef CLAMP float t1 = (x2 - vx) / (x2 - x1); float t2 = (vx - x1) / (x2 - x1); Vec2 f1 = q1.u * t1 + q3.u * t2; Vec2 f2 = q2.u * t1 + q4.u * t2; Color3f C1 = q2.color * t1 + q4.color * t2; Color3f C2 = q2.color * t1 + q4.color * t2; float t3 = (y2 - vy) / (y2 - y1); float t4 = (vy - y1) / (y2 - y1); Particle res; res.u = f1 * t3 + f2 * t4; res.color = C1 * t3 + C2 * t4; return res; } // adds quantity to particles using bilinear interpolation __global__ void advect(Particle* newField, Particle* oldField, size_t xSize, size_t ySize, float dDiffusion, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; float decay = 1.0f / (1.0f + dDiffusion * dt); Vec2 pos = { x * 1.0f, y * 1.0f }; Particle&amp; Pold = oldField[y * xSize + x]; // find new particle tracing where it came from Particle p = interpolate(pos - Pold.u * dt, oldField, xSize, ySize); pu = pu * decay; p.color = p.color * decay; newField[y * xSize + x] = p; }</span></span></code> </pre> </div></div><br>  Decidiu-se dividir a função de difusão da viscosidade em várias partes: <b>computeDiffusion</b> é chamada a partir do código principal, que chama <b>difusa</b> e <b>computeColor um</b> número predeterminado de vezes e depois troca a matriz de onde pegamos os dados e a onde os escrevemos.  Essa é a maneira mais fácil de implementar o processamento de dados paralelos, mas estamos gastando o dobro de memória. <br><br>  Ambas as funções causam variações do método Jacobi.  O corpo de <b>jacobiColor</b> e <b>jacobiVelocity</b> verifica imediatamente se os elementos atuais não estão na borda - nesse caso, devemos defini-los de acordo com as fórmulas descritas na seção <i>Limite e condições iniciais</i> . <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (difuso)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// performs iteration of jacobi method on color grid field __device__ Color3f jacobiColor(Particle* colorField, size_t xSize, size_t ySize, Vec2 pos, Color3f B, float alpha, float beta) { Color3f xU, xD, xL, xR, res; int x = pos.x; int y = pos.y; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = colorField[int(y) * xSize + int(x)] SET(xU, x, y - 1).color; SET(xD, x, y + 1).color; SET(xL, x - 1, y).color; SET(xR, x + 1, y).color; #undef SET res = (xU + xD + xL + xR + B * alpha) * (1.0f / beta); return res; } // calculates color field diffusion __global__ void computeColor(Particle* newField, Particle* oldField, size_t xSize, size_t ySize, float cDiffusion, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; Vec2 pos = { x * 1.0f, y * 1.0f }; Color3f c = oldField[y * xSize + x].color; float alpha = cDiffusion * cDiffusion / dt; float beta = 4.0f + alpha; // perfom one iteration of jacobi method (diffuse method should be called 20-50 times per cell) newField[y * xSize + x].color = jacobiColor(oldField, xSize, ySize, pos, c, alpha, beta); } // performs iteration of jacobi method on velocity grid field __device__ Vec2 jacobiVelocity(Particle* field, size_t xSize, size_t ySize, Vec2 v, Vec2 B, float alpha, float beta) { Vec2 vU = B * -1.0f, vD = B * -1.0f, vR = B * -1.0f, vL = B * -1.0f; #define SET(U, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) U = field[int(y) * xSize + int(x)].u SET(vU, vx, vy - 1); SET(vD, vx, vy + 1); SET(vL, vx - 1, vy); SET(vR, vx + 1, vy); #undef SET v = (vU + vD + vL + vR + B * alpha) * (1.0f / beta); return v; } // calculates nonzero divergency velocity field u __global__ void diffuse(Particle* newField, Particle* oldField, size_t xSize, size_t ySize, float vDiffusion, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; Vec2 pos = { x * 1.0f, y * 1.0f }; Vec2 u = oldField[y * xSize + x].u; // perfoms one iteration of jacobi method (diffuse method should be called 20-50 times per cell) float alpha = vDiffusion * vDiffusion / dt; float beta = 4.0f + alpha; newField[y * xSize + x].u = jacobiVelocity(oldField, xSize, ySize, pos, u, alpha, beta); } // performs several iterations over velocity and color fields void computeDiffusion(dim3 numBlocks, dim3 threadsPerBlock, float dt) { // diffuse velocity and color for (int i = 0; i &lt; sConfig.velocityIterations; i++) { diffuse&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(newField, oldField, xSize, ySize, config.velocityDiffusion, dt); computeColor&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(newField, oldField, xSize, ySize, config.colorDiffusion, dt); std::swap(newField, oldField); } }</span></span></code> </pre> </div></div><br>  O uso da força externa é implementado através de uma única função - <b>applyForce</b> , que leva como argumento a posição do mouse, a cor do corante e também o raio de ação.  Com sua ajuda, podemos dar velocidade às partículas e pintá-las.  O expoente fraterno permite que você deixe a área não muito nítida e, ao mesmo tempo, bastante clara no raio especificado. <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (força)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// applies force and add color dye to the particle field __global__ void applyForce(Particle* field, size_t xSize, size_t ySize, Color3f color, Vec2 F, Vec2 pos, int r, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; float e = expf((-(powf(x - pos.x, 2) + powf(y - pos.y, 2))) / r); Vec2 uF = F * dt * e; Particle&amp; p = field[y * xSize + x]; pu = pu + uF; color = color * e + p.color; p.color.R = min(1.0f, color.R); p.color.G = min(1.0f, color.G); p.color.B = min(1.0f, color.B); }</span></span></code> </pre> </div></div><br>  O cálculo da vorticidade já é um processo mais complicado, portanto, implementado em <b>computateVorticity</b> e <b>applyVorticity</b> , também observamos que para eles é necessário definir dois operadores vetoriais como <b>curl</b> (rotor) e <b>absGradient</b> (gradiente de valores absolutos de campo).  Para especificar efeitos de vórtice adicionais, multiplicamos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> y </script>  componente do vetor gradiente em <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2503"><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> -1 </script>  e normalize-o dividindo pelo comprimento (sem esquecer de verificar se o vetor é diferente de zero): <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (vorticidade)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// computes curl of velocity field __device__ float curl(Particle* field, size_t xSize, size_t ySize, int x, int y) { Vec2 C = field[int(y) * xSize + int(x)].u; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = field[int(y) * xSize + int(x)] float x1 = -Cx, x2 = -Cx, y1 = -Cy, y2 = -Cy; SET(x1, x + 1, y).ux; SET(x2, x - 1, y).ux; SET(y1, x, y + 1).uy; SET(y2, x, y - 1).uy; #undef SET float res = ((y1 - y2) - (x1 - x2)) * 0.5f; return res; } // computes absolute value gradient of vorticity field __device__ Vec2 absGradient(float* field, size_t xSize, size_t ySize, int x, int y) { float C = field[int(y) * xSize + int(x)]; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = field[int(y) * xSize + int(x)] float x1 = C, x2 = C, y1 = C, y2 = C; SET(x1, x + 1, y); SET(x2, x - 1, y); SET(y1, x, y + 1); SET(y2, x, y - 1); #undef SET Vec2 res = { (abs(x1) - abs(x2)) * 0.5f, (abs(y1) - abs(y2)) * 0.5f }; return res; } // computes vorticity field which should be passed to applyVorticity function __global__ void computeVorticity(float* vField, Particle* field, size_t xSize, size_t ySize) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; vField[y * xSize + x] = curl(field, xSize, ySize, x, y); } // applies vorticity to velocity field __global__ void applyVorticity(Particle* newField, Particle* oldField, float* vField, size_t xSize, size_t ySize, float vorticity, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; Particle&amp; pOld = oldField[y * xSize + x]; Particle&amp; pNew = newField[y * xSize + x]; Vec2 v = absGradient(vField, xSize, ySize, x, y); vy *= -1.0f; float length = sqrtf(vx * vx + vy * vy) + 1e-5f; Vec2 vNorm = v * (1.0f / length); Vec2 vF = vNorm * vField[y * xSize + x] * vorticity; pNew = pOld; pNew.u = pNew.u + vF * dt; }</span></span></code> </pre> </div></div><br>  O próximo passo no algoritmo será o cálculo do campo de pressão escalar e sua projeção no campo de velocidade.  Para fazer isso, precisamos implementar 4 funções: <b>divergência</b> , que considerará a divergência de velocidade, <b>jacobiPressure</b> , que implementa o método Jacobi para pressão, e <b>compututePressure</b> com <b>computePressureImpl</b> , executando cálculos de campo iterativos: <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (pressão)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// performs iteration of jacobi method on pressure grid field __device__ float jacobiPressure(float* pressureField, size_t xSize, size_t ySize, int x, int y, float B, float alpha, float beta) { float C = pressureField[int(y) * xSize + int(x)]; float xU = C, xD = C, xL = C, xR = C; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = pressureField[int(y) * xSize + int(x)] SET(xU, x, y - 1); SET(xD, x, y + 1); SET(xL, x - 1, y); SET(xR, x + 1, y); #undef SET float pressure = (xU + xD + xL + xR + alpha * B) * (1.0f / beta); return pressure; } // computes divergency of velocity field __device__ float divergency(Particle* field, size_t xSize, size_t ySize, int x, int y) { Particle&amp; C = field[int(y) * xSize + int(x)]; float x1 = -1 * Cux, x2 = -1 * Cux, y1 = -1 * Cuy, y2 = -1 * Cuy; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = field[int(y) * xSize + int(x)] SET(x1, x + 1, y).ux; SET(x2, x - 1, y).ux; SET(y1, x, y + 1).uy; SET(y2, x, y - 1).uy; #undef SET return (x1 - x2 + y1 - y2) * 0.5f; } // performs iteration of jacobi method on pressure field __global__ void computePressureImpl(Particle* field, size_t xSize, size_t ySize, float* pNew, float* pOld, float pressure, float dt) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; float div = divergency(field, xSize, ySize, x, y); float alpha = -1.0f * pressure * pressure; float beta = 4.0; pNew[y * xSize + x] = jacobiPressure(pOld, xSize, ySize, x, y, div, alpha, beta); } // performs several iterations over pressure field void computePressure(dim3 numBlocks, dim3 threadsPerBlock, float dt) { for (int i = 0; i &lt; sConfig.pressureIterations; i++) { computePressureImpl&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(oldField, xSize, ySize, pressureNew, pressureOld, config.pressure, dt); std::swap(pressureOld, pressureNew); } }</span></span></code> </pre> </div></div><br>  A projeção se encaixa em duas pequenas funções - <b>projeto</b> e o <b>gradiente</b> que <b>exige</b> pressão.  Pode-se dizer o último estágio do nosso algoritmo de simulação: <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (projeto)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// computes gradient of pressure field __device__ Vec2 gradient(float* field, size_t xSize, size_t ySize, int x, int y) { float C = field[y * xSize + x]; #define SET(P, x, y) if (x &lt; xSize &amp;&amp; x &gt;= 0 &amp;&amp; y &lt; ySize &amp;&amp; y &gt;= 0) P = field[int(y) * xSize + int(x)] float x1 = C, x2 = C, y1 = C, y2 = C; SET(x1, x + 1, y); SET(x2, x - 1, y); SET(y1, x, y + 1); SET(y2, x, y - 1); #undef SET Vec2 res = { (x1 - x2) * 0.5f, (y1 - y2) * 0.5f }; return res; } // projects pressure field on velocity field __global__ void project(Particle* newField, size_t xSize, size_t ySize, float* pField) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; Vec2&amp; u = newField[y * xSize + x].u; u = u - gradient(pField, xSize, ySize, x, y); }</span></span></code> </pre> </div></div><br>  Após a projeção, podemos proceder com segurança para renderizar a imagem no buffer e em vários pós-efeitos.  A função de <b>pintura</b> copia cores do campo de partículas para a matriz RGBA.  A função <b>applyBloom</b> também foi implementada, que destaca o líquido quando o cursor é <b>colocado</b> nele e o botão do mouse é pressionado.  Por experiência, essa técnica torna a imagem mais agradável e interessante para os olhos do usuário, mas não é necessária. <br><br>  No pós-processamento, você também pode destacar locais onde o fluido tem a velocidade mais alta, mudar de cor dependendo do vetor de movimento, adicionar vários efeitos etc., mas, no nosso caso, nos limitaremos a um mínimo, porque mesmo com isso as imagens são muito fascinantes (especialmente em dinâmica) : <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (pintura)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// adds flashlight effect near the mouse position __global__ void applyBloom(uint8_t* colorField, size_t xSize, size_t ySize, int xpos, int ypos, float bloomIntense) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; int pos = 4 * (y * xSize + x); float e = expf(-(powf(x - xpos, 2) + powf(y - ypos, 2)) * (1.0f / (bloomIntense + 1e-5f))); uint8_t R = colorField[pos + 0]; uint8_t G = colorField[pos + 1]; uint8_t B = colorField[pos + 2]; uint8_t maxval = max(R, max(G, B)); colorField[pos + 0] = min(255.0f, R + maxval * e); colorField[pos + 1] = min(255.0f, G + maxval * e); colorField[pos + 2] = min(255.0f, B + maxval * e); } // fills output image with corresponding color __global__ void paint(uint8_t* colorField, Particle* field, size_t xSize, size_t ySize) { int x = blockIdx.x * blockDim.x + threadIdx.x; int y = blockIdx.y * blockDim.y + threadIdx.y; float R = field[y * xSize + x].color.R; float G = field[y * xSize + x].color.G; float B = field[y * xSize + x].color.B; colorField[4 * (y * xSize + x) + 0] = min(255.0f, 255.0f * R); colorField[4 * (y * xSize + x) + 1] = min(255.0f, 255.0f * G); colorField[4 * (y * xSize + x) + 2] = min(255.0f, 255.0f * B); colorField[4 * (y * xSize + x) + 3] = 255; }</span></span></code> </pre> </div></div><br>  E no final, ainda temos uma função principal que chamamos de <b>main.cpp</b> - <b>computeField</b> .  Ele liga todas as partes do algoritmo, chamando o código na placa de vídeo, e também copia os dados de gpu para cpu.  Ele também contém o cálculo do vetor de momento e a escolha da cor do corante, que passamos a <b>aplicar</b> a <b>força</b> : <br><br><div class="spoiler">  <b class="spoiler_title">kernel.cu (função principal)</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// main function, calls vorticity -&gt; diffusion -&gt; force -&gt; pressure -&gt; project -&gt; advect -&gt; paint -&gt; bloom void computeField(uint8_t* result, float dt, int x1pos, int y1pos, int x2pos, int y2pos, bool isPressed) { dim3 threadsPerBlock(sConfig.xThreads, sConfig.yThreads); dim3 numBlocks(xSize / threadsPerBlock.x, ySize / threadsPerBlock.y); // curls and vortisity computeVorticity&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(vorticityField, oldField, xSize, ySize); applyVorticity&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(newField, oldField, vorticityField, xSize, ySize, config.vorticity, dt); std::swap(oldField, newField); // diffuse velocity and color computeDiffusion(numBlocks, threadsPerBlock, dt); // apply force if (isPressed) { timeSincePress = 0.0f; elapsedTime += dt; // apply gradient to color int roundT = int(elapsedTime) % colorArraySize; int ceilT = int((elapsedTime) + 1) % colorArraySize; float w = elapsedTime - int(elapsedTime); currentColor = colorArray[roundT] * (1 - w) + colorArray[ceilT] * w; Vec2 F; float scale = config.forceScale; Fx = (x2pos - x1pos) * scale; Fy = (y2pos - y1pos) * scale; Vec2 pos = { x2pos * 1.0f, y2pos * 1.0f }; applyForce&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(oldField, xSize, ySize, currentColor, F, pos, config.radius, dt); } else { timeSincePress += dt; } // compute pressure computePressure(numBlocks, threadsPerBlock, dt); // project project&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(oldField, xSize, ySize, pressureOld); cudaMemset(pressureOld, 0, xSize * ySize * sizeof(float)); // advect advect&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(newField, oldField, xSize, ySize, config.densityDiffusion, dt); std::swap(newField, oldField); // paint image paint&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(colorField, oldField, xSize, ySize); // apply bloom in mouse pos if (config.bloomEnabled &amp;&amp; timeSincePress &lt; 5.0f) { applyBloom&lt;&lt;&lt;numBlocks, threadsPerBlock&gt;&gt;&gt;(colorField, xSize, ySize, x2pos, y2pos, config.bloomIntense / timeSincePress); } // copy image to cpu size_t size = xSize * ySize * 4 * sizeof(uint8_t); cudaMemcpy(result, colorField, size, cudaMemcpyDeviceToHost); cudaError_t error = cudaGetLastError(); if (error != cudaSuccess) { std::cout &lt;&lt; cudaGetErrorName(error) &lt;&lt; std::endl; } }</span></span></code> </pre> </div></div><br><h2>  Conclusão </h2><br>  Neste artigo, analisamos um algoritmo numérico para resolver a equação de Navier-Stokes e escrevemos um pequeno programa de simulação para um fluido incompressível.  Talvez não tenhamos entendido todos os meandros, mas espero que o material tenha sido interessante e útil para você, e pelo menos tenha servido como uma boa introdução ao campo da modelagem de fluidos. <br><br>  Como autor deste artigo, sinceramente aprecio quaisquer comentários e adições e tentarei responder a todas as suas perguntas neste post. <br><br><h3>  Material adicional </h3><br>  Você pode encontrar todo o código-fonte neste artigo no meu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">repositório do Github</a> .  Todas as sugestões de melhoria são bem-vindas. <br><br>  O material original que serviu de base para este artigo, você pode ler no site oficial da Nvidia.  Também apresenta exemplos da implementação de partes do algoritmo na linguagem dos shaders: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">developer.download.nvidia.com/books/HTML/gpugems/gpugems_ch38.html</a> <br><br>  A prova do teorema da decomposição de Helmholtz e uma enorme quantidade de material adicional sobre mecânica dos fluidos podem ser encontradas neste livro (em inglês, consulte a seção 1.2): <br>  <b>Chorin, AJ e JE Marsden.</b>  <b>1993. Uma Introdução Matemática à Mecânica dos Fluidos.</b>  <b>3rd ed.</b>  <b>Springer</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Canal de um YouTube de língua inglesa, criando conteúdo de qualidade relacionado à matemática e resolvendo equações diferenciais em particular (inglês). </font><font style="vertical-align: inherit;">Vídeos muito visuais que ajudam a entender a essência de muitas coisas em matemática e física: </font></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3Blue1Brown - </font></font></a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Equações diferenciais do </font></font></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">YouTube </font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">(3Blue1Brown)</font></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Também agradeço ao </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WhiteBlackGoose</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pela ajuda na preparação do material para o artigo.</font></font><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E, no final, um pequeno bônus - algumas belas capturas de tela tiradas no programa: </font></font><br><br><img src="https://habrastorage.org/webt/-9/rq/ro/-9rqro_x-ximaltntpulh3yt8vg.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stream direto (configurações padrão) </font></font></i> <br><br><img src="https://habrastorage.org/webt/1y/6m/is/1y6misuy1qeuc1uaukmmh3u7sne.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Whirlpool (grande raio no applyForce) </font></font></i> <br><br><img src="https://habrastorage.org/webt/pg/zb/ha/pgzbhaokc-vafmuar0zrzbg6de8.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wave (alta vorticidade + difusão)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Além disso, pela demanda popular, adicionei um vídeo com a simulação:</font></font><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GqoSLrKiwUQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3ww51gkFM5s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt470742/">https://habr.com/ru/post/pt470742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt470728/index.html">Azure PowerShell: Principalmente inofensivo</a></li>
<li><a href="../pt470730/index.html">Azure PowerShell: "principalmente inofensivo"</a></li>
<li><a href="../pt470732/index.html">Seleção de outono: o que você acha dos guarda-chuvas inteligentes?</a></li>
<li><a href="../pt470734/index.html">Contos da cripta (de 40 anos de trabalho do programador)</a></li>
<li><a href="../pt470736/index.html">WWDC 2019: Instrumentos personalizados e símbolos SF, bem como novas abordagens para o desenvolvimento de aplicativos iOS</a></li>
<li><a href="../pt470744/index.html">Matemática revela segredos do feedback de células vivas</a></li>
<li><a href="../pt470746/index.html">O Facebook faz da conversa a próxima interface popular</a></li>
<li><a href="../pt470750/index.html">Amazon pego pegando os melhores produtos</a></li>
<li><a href="../pt470752/index.html">Analisando Pagamentos Wechat</a></li>
<li><a href="../pt470754/index.html">RASA Chatbot: Parallels Experience</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>