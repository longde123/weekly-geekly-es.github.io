<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ» ğŸš£ğŸ¿ ğŸ•¯ï¸ EME? Cdm? DRM? CENC? IDK! Apa yang Anda butuhkan untuk membuat pemutar video Anda sendiri di browser ğŸ„ ğŸ‘©â€ğŸŒ¾ ğŸŒˆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apa arti semua singkatan ini? Apa yang diperlukan untuk mengembangkan pemutar sumber terbuka untuk menonton video dari Amazon, Sky dan platform lain d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>EME? Cdm? DRM? CENC? IDK! Apa yang Anda butuhkan untuk membuat pemutar video Anda sendiri di browser</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/426727/">  Apa arti semua singkatan ini?  Apa yang diperlukan untuk mengembangkan pemutar sumber terbuka untuk menonton video dari Amazon, Sky dan platform lain dan menonton video dari penyedia mana pun?  Sebastian Golasch berbicara tentang bagaimana proses streaming video berlangsung di konferensi HolyJS 2018 Piter.  Di bawah potongan video dan terjemahan laporannya. <br><br><img src="https://habrastorage.org/webt/et/to/7c/etto7cv1khykp68gwreip_8rfy4.jpeg"><br><br>  <i>Sebastian Golasch saat ini adalah pengembang di Deutsche Telekom.</i>  <i>Dia bekerja dengan Java dan PHP untuk waktu yang lama, dan kemudian beralih ke JS, Python, dan Rust.</i>  <i>Selama tujuh tahun terakhir, ia telah bekerja pada platform milik rumah pintar Qivicon.</i> <br><br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3Y3R_snaDDc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Sedikit tentang sejarah streaming video </h2><br>  Pertama, mari kita lihat sejarah web, karena kita telah beralih dari QuickTime ke Netflix dalam 25 tahun.  Semuanya dimulai pada tahun 90-an ketika Apple menemukan QuickTime.  Penggunaannya di Internet dimulai pada 1993-1994.  Pada saat itu, pemain dapat memutar video dengan resolusi 156 Ã— 116 piksel dan frekuensi 10 FPS, tanpa akselerasi perangkat keras (hanya menggunakan sumber daya prosesor).  Format ini difokuskan pada koneksi dial-up 9600 baud - 9600 bps, termasuk informasi overhead. <br><br>  Itu adalah waktu browser Netscape.  Video di browser tidak terlihat terlalu bagus, karena itu bukan asli web.  Untuk pemutaran, kami menggunakan perangkat lunak eksternal (QuickTime yang sama) dengan antarmuka sendiri, yang divisualisasikan di browser menggunakan tag embed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/664/455/137/664455137979de92508841f0d3ceaafa.png"><br><br>  Situasi menjadi sedikit lebih baik ketika Macromedia merilis Shockwave Player (setelah pengambilalihan Macromedia oleh Adobe, itu dikenal sebagai Adobe Flash Player).  Versi pertama dari Shockwave Player dirilis pada tahun 1997, tetapi pemutaran video hanya muncul di tahun 2002. <br><br>  Mereka menggunakan Sorenson Spark alias codec H.263.  Ini telah dioptimalkan untuk resolusi kecil dan ukuran file kecil.  Apa artinya ini?  Misalnya, video 43 detik yang digunakan untuk menguji Shockwave Player dengan berat hanya 560 KB.  Tentu saja, tidak akan terlalu menyenangkan untuk menonton film dengan kualitas ini, tetapi teknologinya sendiri menarik untuk saat itu.  Namun, seperti halnya QuickTime, agar Shockwave Player berfungsi di browser, diperlukan perangkat lunak tambahan.  Pemain ini memiliki banyak masalah keamanan, tetapi yang paling penting adalah bahwa video itu masih merupakan add-on browser. <br><br>  Pada tahun 2007, Microsoft merilis Silverlight, agak mengingatkan pada Flash.  Kami tidak akan menggali lebih dalam, tetapi semua solusi ini memiliki kesamaan - kotak hitam.  Semua pemain berfungsi sebagai add-on browser, dan Anda tidak tahu apa yang sedang terjadi di dalamnya. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84b/418/52e/84b41852efd2fb39dbea144b2e898dfe.png"><br><br>
<h2>  &lt; <code>Video/</code> &gt; elemen </h2><br>  Pada 2007, Opera mengusulkan menggunakan tag &lt; <code>Video/</code> &gt;, yaitu membuat video asli di browser.  Kami menggunakannya hari ini.  Mudah dan nyaman, dan video apa pun tidak hanya dapat dilihat, tetapi juga diunduh.  Dan bahkan jika kami tidak ingin mengizinkan pengunduhan video, kami tidak dapat melarang mengunduhnya ke browser.  Maksimumnya adalah membuat pengunduhan video lebih sulit. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cac/3be/693/cac3be693c7a3328062521d828c12c38.png"><br><br>  <code>&lt;Video/&gt;</code> adalah kebalikan dari kotak hitam, dan melihat kode sumber sangat sederhana. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca1/f23/708/ca1f237081ed5a6a9e648b65e05ea7a1.png"><br><br><h2>  DRM </h2><br>  Namun, Anda tidak bisa mengklik kanan pada video di Netflix dan memilih "Simpan Sebagai".  Alasannya adalah DRM (Digital Restrictions Management).  Ini bukan teknologi tunggal atau aplikasi tunggal yang melakukan tugas apa pun.  Ini adalah istilah umum untuk konsep seperti: <br><br><ul><li>  Otentikasi dan Enkripsi Pengguna </li><li>  Enkripsi Berbasis Konten </li><li>  Definisi hak dan penerapan pembatasan </li><li>  Umpan balik dan pembaruan </li><li>  Kontrol keluaran dan perlindungan tautan </li><li>  Pemeriksaan dan pelacakan penyusup </li><li>  Manajemen kunci dan lisensi </li></ul><br>  Untuk memahami apa itu DRM, kita perlu mempelajari ekosistemnya, yaitu untuk mengetahui perusahaan mana yang terlibat.  Ini adalah: <br><br><ul><li>  <b>Pemilik konten</b> berada di puncak ekosistem.  Misalnya, Disney, MGM atau FIFA.  Perusahaan-perusahaan ini menghasilkan konten, dan mereka memiliki hak untuk itu. </li><li>  <b>DRM Cores</b> adalah perusahaan yang menyediakan teknologi DRM (misalnya, Google, Apple, Microsoft, dll.) Saat ini, ada sekitar 7-8 teknologi DRM dari perusahaan yang berbeda. </li><li>  <b>Penyedia Layanan</b> - Mengembangkan perangkat lunak server yang mengenkripsi video. </li><li>  <b>Browser</b> yang sebenarnya adalah pemain. </li><li>  <b>Penyedia konten</b> adalah perusahaan seperti Netflix, Amazon, Sky, dll. Sebagai aturan, mereka tidak memiliki hak atas konten, mereka melisensikan dan mendistribusikannya. </li><li>  <b>Vendor chip / perangkat</b> juga terlibat dalam ekosistem, karena DRM bukan hanya teknologi perangkat lunak.  Beberapa perusahaan (terutama Cina) sedang mengembangkan chip yang menyandikan dan mendekode video. </li></ul><br>  Pernahkah Anda bertanya-tanya mengapa ketika melihat video di Netflix di browser itu tidak memiliki resolusi sangat tinggi (SD), tetapi jika Anda menonton video yang sama di Apple TV atau Android TV Box, konten yang sama diputar dalam Full HD atau dalam 4K?  DRM juga bertanggung jawab untuk ini.  Faktanya adalah bahwa produsen selalu takut bajak laut mencuri konten.  Oleh karena itu, semakin tidak aman lingkungan di mana decoding video dilakukan, semakin buruk kualitas yang ditunjukkan kepada pengguna.  Misalnya, jika decoding dilakukan secara terprogram (misalnya, di Chrome atau Firefox), video ditampilkan dalam kualitas terburuk.  Di lingkungan di mana kemampuan perangkat keras untuk mendekode digunakan (misalnya, jika Android menggunakan GPU), kemungkinan penyalinan konten ilegal kurang, dan di sini kualitas pemutaran lebih tinggi.  Akhirnya, lingkungan yang paling aman adalah perangkat keras sepenuhnya (Apple TV atau Android TV Box), di mana decoding dan pemutaran dilakukan tanpa melibatkan perangkat lunak. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f9/4fb/1bb/9f94fb1bb7c1fa9d31a02d2bf62950f0.png"><br><br>  Tetapi jika kita berbicara tentang browser, maka decoding di dalamnya hampir selalu dilakukan oleh perangkat lunak.  Browser yang berbeda menggunakan sistem yang berbeda untuk DRM.  Chrome dan Firefox menggunakan Widevine.  Perusahaan ini dimiliki oleh Google dan melisensikan aplikasi DRM mereka.  Jadi, untuk decoding, Firefox mengunduh perpustakaan DRM dari Google.  Di browser Anda dapat melihat dari mana unduhan berasal. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca9/49d/015/ca949d015734b50c36e8594b8f5a4370.png"><br><br>  Apple menggunakan sistem FairPlay sendiri, yang diciptakan kembali ketika perusahaan memperkenalkan iPhone dan iPad pertama.  Microsoft juga menggunakan pengembangannya sendiri yang disebut PlayReady, yang dibangun langsung ke Windows.  Dalam kasus lain, Widevine paling sering digunakan.  Sistem ini ada baik sebagai aplikasi dan sebagai solusi perangkat keras - chip yang memecahkan kode video. <br><br><h2>  Cdm </h2><br>  Singkatan CDM singkatan dari Modul Dekripsi Konten.  Ini adalah beberapa perangkat lunak atau perangkat keras yang dapat bekerja dalam beberapa cara: <br><br><ul><li>  Dekripsi video, setelah itu di-render di browser menggunakan tag &lt;Video /&gt;. </li><li>  Dekripsi dan dekode video, dan kemudian transfer frame mentah video untuk diputar ke browser. </li><li>  Dekripsi dan dekode video, dan kemudian transfer frame mentah video untuk diputar menggunakan GPU. </li></ul><br>  Meskipun dukungan GPU, opsi kedua paling sering digunakan (setidaknya ketika datang ke Chrome dan Firefox). <br><br><h2>  Decoding dan decoding layer di browser </h2><br>  Jadi bagaimana semuanya bekerja bersama?  Untuk memahami ini, lihat pada layer decoding dan dekripsi di browser.  Mereka dibagi menjadi: <br><br><ul><li>  Aplikasi JavaScript - memberitahu komputer video mana yang akan saya tonton. </li><li>  Browser adalah pemain yang memainkan konten video. </li><li>  Modul dekripsi konten. </li><li>  Manajemen hak digital adalah tentang decoding video (saya tidak dapat menghasilkan notasi yang lebih baik, jadi saya menyebutnya begitu). </li><li>  Runtime tepercaya. </li><li>  Dalam hal ini, dua komponen pertama adalah pemutar DRM, modul dekripsi konten adalah klien DRM, dan dua komponen terakhir adalah inti DRM. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2b/7da/87b/b2b7da87bf7b3b92ef4004f4d4b97800.png"><br><br>  Apa yang terjadi ketika Anda memutar video di browser ditunjukkan pada gambar di bawah ini.  Dia, tentu saja, agak membingungkan: ada banyak panah dan warna.  Saya akan memahaminya langkah demi langkah, menggunakan case nyata untuk membuatnya lebih jelas <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1e/982/bb7/b1e982bb7fe74fa39f08b00264987409.png"><br><br>  Kami akan menggunakan Netflix sebagai contoh.  Saya menulis aplikasi debugging. <br><br>  Saya mulai dengan di mana, saya pikir, Anda masing-masing akan mulai: Saya melihat permintaan yang dibuat Netflix ketika saya memulai video, dan saya melihat sejumlah besar rekaman. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b04/913/8d7/b049138d7a4da37f5b9b6c5e4da88bf3.png"><br><br>  Namun, jika Anda hanya menyisakan yang benar-benar diperlukan untuk memutar video, ternyata hanya ada tiga: manifes, lisensi, dan fragmen video pertama. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/381/e12/a9f/381e12a9f194014ae19501e4e9ada763.png"><br><br>  Pemain Netflix ditulis dalam JavaScript dan berisi lebih dari 76.000 baris kode, dan, tentu saja, saya tidak dapat menguraikannya sepenuhnya.  Tetapi saya ingin menunjukkan bagian-bagian utama yang diperlukan untuk memutar video yang dilindungi. <br><br>  Kami akan mulai dengan templat: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ba/205/e6f/9ba205e6f022e4a99ffa373372c99047.png"><br><br><h2>  EME </h2><br>  Tetapi sebelum kita mempelajari fungsinya, kita perlu berkenalan dengan teknologi lain - EME (Encrypted Media Extensions, ekstensi media terenkripsi).  Teknologi ini tidak melakukan dekripsi dan decoding, itu hanya API peramban.  EME berfungsi sebagai antarmuka untuk CDM, untuk KeySystem, untuk server dengan lisensi, dan untuk server tempat konten disimpan. <br><br>  Jadi mari kita mulai dengan getKeySystemConfig. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e68/179/765/e68179765d8d942b41efd0a05fb51cd4.png"><br><br>  Harus diingat bahwa itu tergantung pada penyedia, sehingga konfigurasi yang saya sajikan di sini berfungsi untuk Netflix, tetapi tidak berfungsi, katakanlah, untuk Amazon. <br><br>  Dalam konfigurasi ini, kita harus memberi tahu sistem backend tingkat runtime tepercaya yang dapat kami tawarkan.  Ini bisa berupa decoding perangkat keras yang aman atau decoding perangkat lunak yang aman.  Artinya, kami memberi tahu sistem perangkat keras dan lunak mana yang akan digunakan untuk pemutaran.  Dan itu akan menentukan kualitas konten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c0f/071/1dd/c0f0711ddf9da278d6ab4c23ff31f75c.png"><br><br>  Setelah konfigurasi dikonfigurasi, lihat membuat MediaKeySystem awal. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/99a/62b/ccb/99a62bccbf59fc6c893db5b34b3e3c91.png"><br><br>  Di sinilah interaksi dengan modul dekripsi konten dimulai.  Anda harus memberi tahu API sistem DRM dan KeySystem mana yang kami gunakan.  Dalam kasus kami, ini Widevine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e31/ff8/416/e31ff841688a7f78547c02723c31c11c.png"><br><br>  Langkah selanjutnya adalah opsional untuk semua sistem, tetapi diperlukan untuk Netflix.  Sekali lagi, kebutuhannya tergantung pada penyedia.  Kita perlu menerapkan sertifikat server ke mediaKeys kami.  Sertifikat server adalah teks biasa dalam file Netflix Cadmium.js yang dapat dengan mudah disalin.  Dan ketika kami menerapkannya pada mediaKeys, maka semua komunikasi antara server dengan lisensi dan browser kami menjadi aman berkat penggunaan sertifikat ini. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3c/601/dd1/d3c601dd109f2a67e84efe69ca76ba6a.png"><br><br>  Ketika ini selesai, kita harus beralih ke elemen asli video dan berkata: "Oke, ini adalah sistem kunci yang ingin kita gunakan, dan ini adalah tag video halo.  Biarkan kami mempersatukan Anda. " <br><br><img src="https://habrastorage.org/getpro/habr/post_images/797/6cf/3ce/7976cf3ce8dacf000547d40084d16d22.png"><br><br>  Dan inilah fungsi terakhir yang Anda perlukan untuk mengonfigurasi sistem video. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/107/ce0/fa0/107ce0fa0c047fd77218983652e0aa89.png"><br><br>  Ini adalah sesi DRM, atau MediaKeySession.  Ini hanya data yang masuk dari penyedia ke modul dekripsi yang menandatangani permintaan dengan mereka.  Data ini juga berupa teks biasa, yang tersembunyi di balik beberapa fungsi di file pemain Netflix, tempat saya menyalinnya. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed7/3a4/0a3/ed73a40a370d7744f55590fc9e23efa5.png"><br><br>  Saat kami memanggil create. Sesi pada objek mediaKeys, kami perlu memberi tahu video mana yang kami dukung.  Dalam hal ini, mp4.  Ini membawa kita kembali ke konteks pengiriman pesan dengan sistem CDM kami.  Kami juga membutuhkan Netflix untuk menerapkan sertifikat server base64 di setiap formulir, tetapi semua konfigurasi ini dalam sesi buat lagi disediakan tergantung pada sistem DRM. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b24/8ff/e27/b248ffe2709055f4eadc33eab77df455.png"><br><br>  Fungsi terakhir di sini di bawah ini - keySession.generateRequest membangun permintaan lisensi di latar belakang.  Atau CDM sedang membangun permintaan lisensi di latar belakang.  Dengan kata lain, ini adalah data biner mentah yang harus kami kirim ke server berlisensi untuk mendapatkan lisensi yang valid sebagai imbalannya. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43c/798/16e/43c79816e9006b0668d58555887017b7.png"><br><br>  Di sini cenc menarik.  Ini adalah standar enkripsi ISO yang menetapkan skema keamanan untuk video mp4.  Di WebM, ini disebut berbeda, tetapi fungsinya melakukan hal yang sama. <br><br>  handleMessage adalah antarmuka EventListener yang kami konfigurasikan.  Ketika acara ini dimunculkan oleh acara pesan di keySession, kami tahu bahwa kami siap untuk mendapatkan lisensi dari server. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ef/93b/e85/4ef93be85d1d8535408a1abed9ca9ec6.png"><br><br>  Dan dalam panggilan balik ini kami hanya mendapatkan permintaan ke server dengan lisensi yang memberikan beberapa data biner (mereka mungkin juga berbeda tergantung pada penyedia).  Kami menggunakan data ini untuk memperbarui sesi saat ini dengan menambahkan lisensi.  Yaitu, segera setelah kami menerima lisensi yang valid dari server, CDM kami tahu bahwa kami dapat memecahkan kode dan mendekripsi video. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/779/ef3/ea9/779ef3ea918671d1c4a2d2df8d9c404d.png"><br><br>  Jika kami menerapkan ini pada diagram di bawah, kami mendapatkan ini: kami ingin memutar video, dan aplikasi JavaScript mengatakan: "Halo, browser!  Saya ingin memutar videonya! â€  - kemudian menggunakan Ekstensi Media Terenkripsi dan membuat permintaan ke Fungsi Lisensi di Widevine CDM untuk lisensi.  Permintaan ini kemudian dikembalikan ke browser, dan kami dapat menukarnya dengan lisensi yang valid di server lisensi, dan kemudian kami perlu mentransfer lisensi ini kembali ke CDM.  Proses ini ditunjukkan dalam kode di atas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a98/e80/622/a98e806221a4f2533f0155c8425a36b4.png"><br><br>  Tetapi perhatikan bahwa kita belum kehilangan satu detik dari video, dan kita semua perlu melakukan ini untuk dapat memutar beberapa video di masa depan. <br><br><h2>  MSE </h2><br>  Dan teknologi lain yang perlu kita teliti adalah MSE (Media Source Extensions).  Dia bisa disebut saudara tiri EME (Encrypted Media Extensions).  Ini juga API browser, dan tidak ada hubungannya dengan DRM.  Saya melihatnya sebagai antarmuka pemrograman untuk &lt; <code>Video/</code> &gt; Src.  Dengan menggunakannya, Anda dapat membuat aliran biner dalam JavaScript dan menerapkan fragmen video ke elemen &lt; <code>Video/</code> &gt;.  Dengan demikian, berkat itu, sumber tag &lt; <code>Video/</code> &gt; menjadi dinamis. <br><br>  Jadi, kita dapat menggunakan ekstensi untuk sumber multimedia, instantiate dan mengakses video, lalu mengunduh fragmen video di bagian dan menerapkannya pada tag &lt; <code>Video/</code> &gt;. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a1/8f5/99f/0a18f599f2422bc047ad16d71f32f9af.png"><br><br>  Intinya adalah ketika Anda menonton video dua jam, Anda tidak ingin menunggu sampai video terisi penuh.  Sebagai gantinya, Anda memotongnya menjadi potongan-potongan kecil mulai dari ukuran sekitar 30 detik hingga 2 menit dan menerapkannya pada elemen &lt; <code>Video/</code> &gt; satu per satu. <br><br>  Setelah buffer MediaSource kami siap dan ditautkan ke elemen &lt; <code>Video/</code> &gt;, kami dapat menambahkan SourceBuffer.  Kita harus memberi tahu dia lagi format video dan codec mana yang kita gunakan, dan kemudian akan dibuat. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/49a/d01/b0f/49ad01b0fcb2745fd0243c9bd4cf0972.png"><br><br>  Akhirnya, kita sekarang dapat mengambil dari masing-masing fragmen dan mengirimkannya di SourceBuffer kita menggunakan metode append ke elemen &lt;Video /&gt;, menerima video yang dibuat secara dinamis.  Itu juga dapat digunakan untuk kasus penggunaan lain di mana orang dapat secara independen menggabungkan berbagai elemen video, membuat video mereka sendiri, tetapi saya tidak ingin menggali terlalu dalam. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d5/687/bc3/9d5687bc390e405b84977c99420abb4b.png"><br><br>  Jadi ini hampir langkah terakhir yang harus kita ambil.  Anda memiliki jaringan distribusi, Anda memiliki fragmen, dan kemudian browser mengirimkan fragmen terenkripsi dan terkompresi ke CDM, di mana dekripsi dan, mungkin, decoding dilakukan.  Kemudian fragmen yang didekripsi dan tidak dikompresi dikirim kembali ke browser, di mana mereka divisualisasikan dan ditampilkan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/498/2d0/8a6/4982d08a6ee484ab5de56fb3cdb6d247.png"><br><br><h2>  Terwujud </h2><br>  Tetapi ada satu hal lagi.  Bagaimana kita tahu fragmen mana yang perlu kita unduh, dari mana kita mengunduhnya, dan kapan?  Dan ini adalah bagian terakhir, permintaan yang hilang dari manifes.  Ketika kami meminta Netflix untuk manifes, itu membutuhkan banyak data.  Jika kami hanya ingin memutar video, penting bagi kami sistem DRM mana yang kami gunakan, video mana yang ingin kami tonton (Netflix ID, yang dapat disalin dari URL) dan profil.  Profil menentukan dalam resolusi apa kami menerima video, dan juga dalam bahasa apa kami menerima trek audio, dalam format apa (stereo, Dolby Digital, dll.), Apakah kami menggunakan subtitle, dll. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/daf/b78/506/dafb7850664c7b2baba6894add61a79a.png"><br><br><h2>  MPEG-DASH </h2><br>  Format manifes yang paling umum digunakan adalah MPEG-DASH.  Benar, Apple menggunakan format yang berbeda - HSL, yang tampilannya menyerupai daftar file di pemutar Winamp lama.  Tapi Widevine dan Microsoft menggunakan MPEG-DASH persis.  Ini didasarkan pada XML, dan mendefinisikan semuanya: durasi, ukuran buffer, tipe konten, ketika fragmen dimuat, fragmen untuk resolusi yang berbeda, serta bitrate switching yang adaptif.  Yang terakhir berarti bahwa jika pengguna, misalnya, menonton video dan pada saat yang sama kecepatan unduhannya menurun, pemutaran tidak berhenti, tetapi kualitas video justru memburuk.  Ini karena fakta bahwa manifes menentukan bagian yang sama untuk resolusi yang berbeda, mereka memiliki durasi yang sama dan indeks yang sama.  Oleh karena itu, jika kecepatan unduhan menurun, browser dapat dengan mudah beralih ke aliran dengan resolusi lebih rendah tanpa menjeda unduhan dan tanpa buffering data. <br><br>  Inilah bentuk manifesto dari Guardians of the Galaxy.  Di dalamnya kita dapat melihat bahwa pada kecepatan unduhan yang berbeda orang akan menerima video dengan kualitas yang berbeda, serta fakta bahwa ada trek audio untuk orang dengan gangguan pendengaran.  Itu juga merinci subtitle. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/785/a96/a6f/785a96a6fa6b13ed57bd6f5518f36fa1.png"><br><br>  Kami memiliki durasi dan indikasi waktu mulai pemutaran.  Fungsi ini digunakan, misalnya, ketika Anda mengganggu menonton dan kemudian kembali ke video lagi, mulai dari tempat Anda tinggalkan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dcc/349/b4c/dcc349b4c9b4a4eabfa26da95511185d.png"><br><br>  Ada juga ketahanan lagi, yang mengatakan: fragmen ini dapat hilang hanya jika sistem Anda memenuhi persyaratan.  Dalam hal ini, ini adalah decoding perangkat keras - Hardware Secure Codecs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a76/7c2/248/a767c224876945a69441fe4314114319.png"><br><br>  Untuk bagian video yang sama, Anda dapat menentukan sejumlah fragmen dengan resolusi berbeda. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fa/202/d19/9fa202d1922b5e6d9aabb5a22f359d49.png"><br><br>  Dan kemudian Anda mendapatkan URL untuk memuat fragmen, dan parameter rentang menunjukkan rentang nilai dalam milidetik. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/35e/325/93c/35e32593c77c1c7b242ce0141e8b6fd3.png"><br><br>  Ini bagian terakhir.  Anda juga terkadang mendapatkan manifes dari CDN.  Beberapa penyedia memiliki server terpisah untuk pengiriman fragmen, tetapi paling sering mereka berasal dari mesin yang sama dengan fungsi manifes.  Ketika kami mengunduh manifes, kami tahu fragmen mana yang perlu kami unduh, kami dapat mengirim permintaan untuk fragmen, lalu mendekripsi dan mendekode dari CDM. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/826/2e5/47d/8262e547d950d80ec737263c795ddab9.png"><br><br>  Secara umum, itu saja.  Semua yang dikatakan di atas cukup untuk mengembangkan pemain open source untuk menonton video dari Amazon, Sky dan platform lainnya dan menonton video dari hampir semua penyedia. <br><br><h2>  Nyonya </h2><br>  Netflix menganggapnya layak menambahkan enkripsi pesan ekstra antara browser dan server.  Mereka menyebutnya "Lapisan Keamanan Pesan," Lapisan Keamanan Pesan, atau MSL.  Itu tidak melakukan apa pun secara langsung dengan video, itu hanya lapisan enkripsi tambahan.  Salah satu alasan untuk menerapkan MSL adalah bahwa HTTPS tidak cukup aman.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MSL</a> , di sisi lain, adalah open source, sehingga Anda selalu dapat melihat cara kerjanya.  Di sini saya tidak akan membahas topik ini, dan jika Anda tertarik, Anda selalu dapat menemukan informasi tentang mengapa Netflix melakukan MSL di blog mereka.  GitHub memiliki dokumentasi terperinci tentang implementasi dan implementasi kerjanya di Jawa. <br><br>  Ada juga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">implementasi Python</a> yang kami tulis bersama teman-teman.  Sejauh yang saya tahu, ini adalah satu-satunya klien open source yang berfungsi untuk Netflix.  Dia bekerja dengan Kodi Media Center.  Untuk visualisasi, Anda dapat menggunakan VLC Player atau perangkat lunak lain yang sesuai. <br><br><h2>  Dan lagi "kotak hitam" </h2><br>  Jadi, Anda melihat apa yang kami butuhkan untuk mengimplementasikan semua ini, dan seberapa sering saya menyebutkan CDM - "kotak hitam" yang diunduh dari Google.  Jadi, kami kembali mengembalikan video ke "kotak hitam".  Elemen &lt;Video /&gt; yang indah sekali lagi disembunyikan dari kami.  Kami telah menambahkan perangkat lunak pihak ketiga yang membantu kami, tetapi yang pada saat yang sama ditutup dan yang tidak dapat kami kelola.  Ini dapat melakukan banyak hal yang tidak mencolok: pelacakan, analitik, mengirim data ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ef/e10/72c/7efe1072c1d1d1390451a08ba3897f33.png"><br><br>  Inilah yang dikatakan Tim Berners Lee tentang ini: <i>"Jadi, secara umum, penting untuk mempertahankan EME sebagai lingkungan online yang relatif aman di mana Anda dapat menonton film, serta yang paling nyaman dan yang menjadikannya bagian dari wacana saling terhubung umat manusia."</i> <br><br>  Tetapi ada pendapat lain tentang ini.  Khususnya, dari Electronic Frontiers Foundation, yang sebelum kedatangan DRM adalah anggota W3C.  Inilah yang mereka katakan: <i>â€œPada 2013, EFF kecewa mengetahui bahwa W3C mengambil alih proyek standardisasi EME - ekstensi media terenkripsi.</i>  <i>Faktanya, kita berbicara tentang API yang fungsinya hanya untuk memberi DRM peran utama dalam ekosistem browser.</i>  <i>Kami akan terus berjuang untuk memastikan bahwa Internet gratis dan terbuka.</i>  <i>"Kami akan terus menuntut pemerintah AS untuk mencabut undang-undang yang membuat DRM sangat beracun, dan kami akan terus berjuang di tingkat hukum global."</i> <br><br>  Sulit bagi saya untuk mengatakan bagaimana menghubungkannya dengan ini.   ,       ,      ,      .   ,     Netflix,     . ,        ,         . <br><br><blockquote>   , 24-25 ,    <b>HolyJS 2018 Moscow</b> ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Â«The Universal Serial WebÂ»</a> :     WebUSB,    USB-  .     -,    . <br><br> PS  1-      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="></a> . ,     â€”  50%   . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id426727/">https://habr.com/ru/post/id426727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id426717/index.html">Ilusi Tipuan: Ilusi Optik Visual Berbasis Peramalan Retro</a></li>
<li><a href="../id426719/index.html">Hackathon pada Ilmu Data dalam SIBUR: bagaimana itu</a></li>
<li><a href="../id426721/index.html">Menghindari Gagal Selama Pengembangan Produk: 10 Tips Dari Rookee</a></li>
<li><a href="../id426723/index.html">Microsoft dan para mitra berharap dapat membuat kapsul waktu di bulan</a></li>
<li><a href="../id426725/index.html">Bagaimana melakukan sesuatu ketika Anda tidak ingin melakukannya</a></li>
<li><a href="../id426729/index.html">TypeScript School of Magic: Generik dan Jenis Ekstensi</a></li>
<li><a href="../id426731/index.html">CSS: fitur menarik dari radius batas</a></li>
<li><a href="../id426733/index.html">Besi tidak akan gagal. Bagaimana saya menyiapkan puluhan server per hari untuk pertempuran</a></li>
<li><a href="../id426735/index.html">Selamat datang di JETHACK Hackathon</a></li>
<li><a href="../id426737/index.html">Secara singkat tentang arsitektur prosesor neuromorfik: tampilan dalam</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>