<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš« ğŸ–ï¸ ğŸ„ æˆ‘ä»¬å°†æ¸¸æˆæ‰‹æŸ„ä»PS1 / PS2è¿æ¥åˆ°Raspberry Pi ğŸ‘ŠğŸ¼ ğŸ‘©ğŸ»â€ğŸ’» ğŸ‡ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨é™¢å­é‡Œæ˜¯äº”æœˆçš„å‡æœŸã€‚ è¿™å°±æ„å‘³ç€æœ‰æ—¶é—´åƒç¾Šè‚‰ä¸²ï¼Œå–å„ç§ç”Ÿæ°´å’Œç“¶è£…é¥®æ–™ã€‚ è€Œä¸”æˆ‘èƒ¡è¯´å…«é“ã€‚ å…³äºè¿™ä¸ªé¡¹ç›®çš„æƒ³æ³•æ˜¯åœ¨æ–°çš„ä¸€å¹´ä¹‹å‰å‡ºç°çš„ã€‚ ä½†æ˜¯å¾ˆé•¿ä¸€æ®µæ—¶é—´æˆ‘éƒ½æ²¡æœ‰æ„è¯†åˆ°ã€‚ è´­ä¹°äº†ç¬¬ä¸€ä¸ªæ¸¸æˆæ‰‹æŸ„ï¼ˆåæ¥æˆ‘æ‰”æ‰äº†ï¼‰ï¼Œå¹¶è¯•å›¾å¯¹å…¶è¿›è¡Œå®¡é—®ï¼Œæˆ‘æ„è¯†åˆ°ï¼Œå°½ç®¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä½†ä»…ä»…é˜…è¯»æ‰‹å†Œè¿˜æ˜¯ä¸å¤Ÿçš„ã€‚ å¹¸è¿çš„æ˜¯ï¼Œä»Šå¹´2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬å°†æ¸¸æˆæ‰‹æŸ„ä»PS1 / PS2è¿æ¥åˆ°Raspberry Pi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403753/"> åœ¨é™¢å­é‡Œæ˜¯äº”æœˆçš„å‡æœŸã€‚ è¿™å°±æ„å‘³ç€æœ‰æ—¶é—´åƒç¾Šè‚‰ä¸²ï¼Œå–å„ç§ç”Ÿæ°´å’Œç“¶è£…é¥®æ–™ã€‚ è€Œä¸”æˆ‘èƒ¡è¯´å…«é“ã€‚ å…³äºè¿™ä¸ªé¡¹ç›®çš„æƒ³æ³•æ˜¯åœ¨æ–°çš„ä¸€å¹´ä¹‹å‰å‡ºç°çš„ã€‚ ä½†æ˜¯å¾ˆé•¿ä¸€æ®µæ—¶é—´æˆ‘éƒ½æ²¡æœ‰æ„è¯†åˆ°ã€‚ è´­ä¹°äº†ç¬¬ä¸€ä¸ªæ¸¸æˆæ‰‹æŸ„ï¼ˆåæ¥æˆ‘æ‰”æ‰äº†ï¼‰ï¼Œå¹¶è¯•å›¾å¯¹å…¶è¿›è¡Œå®¡é—®ï¼Œæˆ‘æ„è¯†åˆ°ï¼Œå°½ç®¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä½†ä»…ä»…é˜…è¯»æ‰‹å†Œè¿˜æ˜¯ä¸å¤Ÿçš„ã€‚ å¹¸è¿çš„æ˜¯ï¼Œä»Šå¹´2æœˆ23æ—¥ï¼Œæˆ‘æ”¶åˆ°äº†ç¤¼ç‰©ï¼Œä¸æ˜¯å‰ƒæ‰è¢œå­é‡Œçš„æ³¡æ²«ï¼Œè€Œæ˜¯600å¢å¸ƒã€‚ å¸Œæœ›ä¸è¦åœ¨é€Ÿå–é€šä¸Šå¦è®¤è‡ªå·±çš„ä»»ä½•äº‹æƒ…ã€‚ è´­ä¹°äº†Saleae Logicé€»è¾‘åˆ†æä»ªçš„ä¸­æ–‡å‰¯æœ¬çš„ä½ç½®ã€‚ æ„Ÿå…´è¶£çš„äººå¯ä»¥å•å‡»ä¸‹é¢çš„æŒ‰é’®ã€‚ é‚£äº›æ‡’æƒ°çš„äººå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>ç«‹å³çœ‹åˆ°ç»“æœã€‚ <br><br><img src="https://habrastorage.org/web/079/966/3bb/0799663bb6154ee49ee69e0583654ac3.jpg"><br><a name="habracut"></a><br> å°†é€»è¾‘åˆ†æä»ªæ‹§ç´§åˆ°ä¸€ä¸ªç®€å•çš„è®¾è®¡ä¹‹åï¼Œæˆ‘çœ‹åˆ°æ˜æ˜¾çš„ç‚‰æ¸£è¢«å‘é€åˆ°äº†æ¸¸æˆæ‰‹æŸ„ã€‚ <br><br> ç†è®ºçš„æ—¶åˆ»ã€‚ <br><br> äº‹å®æ˜¯æ§åˆ¶å°é€šè¿‡SPIæ¥å£ä¸æ¸¸æˆæ‰‹æŸ„é€šä¿¡ã€‚ å¹¶ä¸”è¯¥æ¥å£æœ‰è§„èŒƒçš„æ“ä½œæ¨¡å¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®¿é—®æ¸¸æˆæ‰‹æŸ„â€œ 0â€æ—¶ï¼Œåº”è¯¥æœ‰â€œæ¨¡å¼3â€ï¼Œæ­£å‘ä¼ è¾“å’Œâ€œèŠ¯ç‰‡ä½¿èƒ½â€æˆ–â€œé€‰æ‹©ä»æœºâ€çº¿è·¯ä¸Šçš„é€»è¾‘ç”µå¹³ã€‚  clkçº¿ä¸Šçš„é¢‘ç‡ä¸º250 kHzã€‚ ä½†æ˜¯æˆ‘åšäº†100 kHzï¼Œå®ƒå·¥ä½œæ­£å¸¸ã€‚ åŸåˆ™ä¸Šï¼Œæ‰€æœ‰å†…å®¹å‡åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æ˜ç¡®æè¿°ã€‚ ä»¥åŠæ¸¸æˆæ‰‹æŸ„çš„å‘½ä»¤ç³»ç»Ÿï¼Œä»¥åŠç­”æ¡ˆçš„ç¬”å½•ã€‚ åŒæ ·åœ¨Radiokoté—¨æˆ·ä¸Šï¼Œæœ‰å‡ºç‰ˆç‰©ï¼Œä½†å›¢é˜Ÿä¸­æœ‰é”™è¯¯ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œè¦è¯¢é—®æ ‡å‡†æ¸¸æˆæ‰‹æŸ„ï¼Œæ‚¨éœ€è¦ç»™å®ƒä¸€ä¸ªå‘½ä»¤ï¼š <br><br><pre><code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">0x1</span></span> <span class="hljs-number"><span class="hljs-number">0x42</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span> <span class="hljs-number"><span class="hljs-number">0x0</span></span>   , -  <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0x41</span></span> <span class="hljs-number"><span class="hljs-number">0x5a</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span></code> </pre> <br> å…¶ä¸­0x41æ˜¯æ¸¸æˆæ‰‹æŸ„çš„ç±»å‹ï¼Œæœ€å2ä¸ªå­—èŠ‚æ˜¯æŒ‰é’®çš„çŠ¶æ€ã€‚ å¯¹äºæ¨¡æ‹Ÿé‡ï¼Œä¸€åˆ‡éƒ½ç›¸ä¼¼ï¼Œåªéœ€è¦å‘è½¯ä»¶åŒ…ä¸­å†æ·»åŠ 4ä¸ªé›¶å­—èŠ‚å³å¯ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">0x1</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>   , -  <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0x73</span></span> <span class="hljs-number"><span class="hljs-number">0x5a</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0x80</span></span> <span class="hljs-number"><span class="hljs-number">0x80</span></span> <span class="hljs-number"><span class="hljs-number">0x80</span></span> <span class="hljs-number"><span class="hljs-number">0x80</span></span></code> </pre><br> è¿™é‡Œçš„0x73è¡¨ç¤ºæ¸¸æˆæ‰‹æŸ„æ˜¯æ¨¡æ‹Ÿçš„ï¼Œæœ€å4ä¸ªå­—èŠ‚æ˜¯æ¨¡æ‹Ÿçš„çŠ¶æ€ã€‚ <br><br> é‡è¦çš„æ˜¯ï¼Œæ¸¸æˆæ‰‹æŸ„å¿…é¡»åœ¨3.3 V.çš„ç”µå‹ä¸‹å·¥ä½œï¼Œè¿™æ ·æ‰èƒ½ç›´æ¥ä»Raspberry piä¸ºå…¶ä¾›ç”µã€‚ åœ¨æ ‡å‡†æ¨¡å¼ä¸‹ï¼ˆä»…æŒ‰é’®èµ·ä½œç”¨ï¼‰ï¼ŒåŠŸè€—çº¦ä¸º2 mAï¼Œåœ¨æ¨¡æ‹Ÿæ¨¡å¼ä¸‹ä¸º12 mAã€‚ ç„¶åï¼Œè¿™10 mAä¼šåœ¨æ§åˆ¶å™¨ä¸Šå¢åŠ ä¸€ä¸ªLEDã€‚ åœ¨3.3 V Raspberry piçº¿ä¸Šï¼Œå¯ä»¥æ¤å…¥é«˜è¾¾50 mAçš„è´Ÿè½½ã€‚ <br><br> å®é™…ä¸Šï¼Œè¦è¿æ¥æ¸¸æˆæ‰‹æŸ„ï¼Œæ‚¨éœ€è¦ä»»ä½•4ä¸ªGPIOç«¯å£å’Œç”µæºã€‚ ä»…6çº¿ã€‚ <br><br> æ‰€ä»¥åœ¨è¿™é‡Œã€‚ æˆ‘æ„è¯†åˆ°ï¼Œç”¨äºGPIOçš„åº“ï¼Œbcm2835ï¼ŒwireingPiä¸SPIçš„é…åˆéå¸¸å·®ã€‚ åŸåˆ™ä¸Šï¼Œä»–ä»¬ä¸çŸ¥é“å¦‚ä½•ä»¥æœ€ä½æœ‰æ•ˆä½å‘é€åŒ…ã€‚ åœ¨å…¶ä¸­ä¸€ä¸ªç å¤´ä¸Šï¼Œè¿™æ˜¯è¯šå®çš„æè¿°ï¼Œä½†åœ¨æŸä¸ªåœ°æ–¹å´å¾ˆæ·±ã€‚ ä»–ä»¬ç¡®å®ä¸èƒ½éµå®ˆæ”¿æƒã€‚ <br><br> ä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢å¤åˆ¶åŒ…æœ¬èº«ä»¥åŠä»æ¸¸æˆæ‰‹æŸ„è¯»å–æ•°æ®ã€‚ è¨€å½’æ­£ä¼ ã€‚ é‡‡å–wireingPiåº“å¹¶ç¼–å†™ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;wiringPi.h&gt; #define mosi 12 #define miso 13 #define clk 14 #define ce 5 unsigned char i, b; unsigned char cmd[9] = {0x1, 0x42, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}; int main() { wiringPiSetup () ; //  pinMode (mosi, OUTPUT); pinMode (clk, OUTPUT); pinMode (ce, OUTPUT); pinMode (miso, INPUT); digitalWrite (clk, HIGH); digitalWrite (mosi, LOW); digitalWrite (ce, HIGH); while(1) { unsigned char data[9] = {0}; digitalWrite (ce, LOW); delayMicroseconds(20); for (i = 0; i &lt; 9; i++) { for (b = 0; b &lt; 8; b++) { if (((cmd[i] &gt;&gt; b)&amp;1) == 1) { digitalWrite (mosi, HIGH); digitalWrite (clk, LOW); delayMicroseconds(5); digitalWrite (clk, HIGH); data[i] ^= digitalRead(miso) &lt;&lt; b; delayMicroseconds(5); digitalWrite (mosi, LOW); } else { digitalWrite (clk, LOW); delayMicroseconds(5); digitalWrite (clk, HIGH); data[i] ^= digitalRead(miso) &lt;&lt; b; delayMicroseconds(5); } } delayMicroseconds(40); } digitalWrite (ce, HIGH); printf("%x %x %x %x %x %x\n", data[3], data[4], data[5], data[6], data[7], data[8]); delayMicroseconds(100); } }</span></span></span></span></code> </pre><br> ä¸€åˆ‡éƒ½å¾ˆç»å…¸ï¼Œæˆ‘ä»¬å£°æ˜äº†GPIOç«¯å£ï¼Œå˜é‡å’Œå‘½ä»¤æ•°ç»„ã€‚ æ¥ä¸‹æ¥ï¼Œé…ç½®ç«¯å£æ“ä½œæ¨¡å¼ï¼Œå¹¶é‡ç½®clkï¼Œmosiå’Œceï¼ˆèŠ¯ç‰‡ä½¿èƒ½ï¼‰çº¿ã€‚ ç„¶åå½¢æˆ2ä¸ªå¾ªç¯ã€‚ åœ¨ç¬¬ä¸€ä¸ªä¸­ï¼Œå‘½ä»¤çš„å­—èŠ‚è¿›è¡Œæ’åºï¼Œåœ¨ç¬¬äºŒä¸ªä¸­ï¼Œå­—èŠ‚æœ¬èº«æŒ‰ä½æ’åºï¼Œä»¥ä¾¿æ ¹æ®ä½çš„å€¼å‘mosiè¡Œæä¾›é€»è¾‘å•å…ƒæˆ–é›¶ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬é˜…è¯»äº†ç­”æ¡ˆã€‚ å½“æˆ‘çœ‹åˆ°å®è´µçš„ç­”æ¡ˆæ—¶ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0x41</span></span> <span class="hljs-number"><span class="hljs-number">0x5a</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span> <span class="hljs-number"><span class="hljs-number">0xff</span></span></code> </pre><br> æˆ‘å·®ç‚¹è·³åˆ°å¤©èŠ±æ¿ä¸Šã€‚ è¿™æ˜¯ç¨‹åºè¾“å‡ºçš„ç¤ºä¾‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘æ­£åœ¨ä½¿ç”¨å·¦æ¨¡æ‹Ÿã€‚ <br><br><pre> <code class="cpp hljs">ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">80</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">40</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">4b</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">4b</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">4b</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">4b</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">4b</span></span> ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">1</span></span>a ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">1</span></span>a ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">1</span></span>a ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">1</span></span>a ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">1</span></span>a ff ff <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> ff <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br> å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å°†æ­¤ä»£ç é›†æˆåˆ°ä»¿çœŸå™¨ä¸­äº†ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€‰æ‹©ä»¿çœŸå™¨çš„é—®é¢˜å°±æ²¡æœ‰äº†ã€‚ ç»å¯¹æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pcsx_rearmed</a> ã€‚ å°±åƒä¸Šä¸€æ¬¡ä¸€æ ·ï¼Œæœ‰å¿…è¦æ‰¾åˆ°ä¸€ä¸ªé¦–å…ˆå¯åŠ¨çš„å‡½æ•°ï¼Œä»¥ä¾¿åœ¨å…¶ä¸­åˆå§‹åŒ–åº“ã€‚ äº‹å®è¯æ˜PsxInitå°±æ˜¯è¿™æ ·çš„åŠŸèƒ½ï¼›å®ƒä½äºr3000a.cæ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶æ¨¡æ‹Ÿä¸­å¤®å¤„ç†å™¨çš„æ“ä½œã€‚ æˆ‘å°†åº“å¤´æ–‡ä»¶æ·»åŠ åˆ°æ­¤æ–‡ä»¶ï¼Œå¹¶å£°æ˜äº†GPIOç«¯å£ã€‚ åœ¨psxInitå‡½æ•°ä¸­ï¼Œæˆ‘åˆå§‹åŒ–åº“å¹¶åœ¨GPIOç«¯å£ä¸Šè®¾ç½®åˆå§‹çº§åˆ«ã€‚ ä»¥ä¸‹æ˜¯æ­¤æ–‡ä»¶ä¸­åŒ…å«æ›´æ”¹çš„ç¬¬ä¸€è¡Œã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"r3000a.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"cdrom.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"mdec.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"gte.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;wiringPi.h&gt; #define mosi 12 #define miso 13 #define clk 14 #define ce 5 R3000Acpu *psxCpu = NULL; psxRegisters psxRegs; int psxInit() { SysPrintf(_("Running PCSX Version %s (%s).\n"), PACKAGE_VERSION, __DATE__); wiringPiSetup () ; //  pinMode (mosi, OUTPUT); pinMode (clk, OUTPUT); pinMode (ce, OUTPUT); pinMode (miso, INPUT); digitalWrite (clk, HIGH); digitalWrite (mosi, LOW); digitalWrite (ce, HIGH); #ifdef PSXREC if (Config.Cpu == CPU_INTERPRETER) { psxCpu = &amp;psxInt; } else psxCpu = &amp;psxRec; #else psxCpu = &amp;psxInt; #endif Log = 0; if (psxMemInit() == -1) return -1; return psxCpu-&gt;Init(); }</span></span></span></span></code> </pre><br> æ¥ä¸‹æ¥ï¼Œæˆ‘å¿…é¡»å¼„æ¸…æ¥šæ¨¡æ‹Ÿå™¨å¦‚ä½•æ¨¡æ‹Ÿæ¸¸æˆæ‰‹æŸ„çš„æ“ä½œã€‚ æœ‰ä¸€ä¸ªå¤´æ–‡ä»¶psemu_plugin_defs.hï¼Œä½äºincludeç›®å½•ä¸­ï¼Œæ­¤å¤„åŒ…å«ç”¨äºå­˜å‚¨å˜é‡çš„ç»“æ„ï¼Œå…¶ä¸­ï¼Œæ‰‹æŸ„çš„ç±»å‹ä¸ºæ ‡å‡†ï¼Œæ¨¡æ‹Ÿï¼ŒæŒ‰é’®çŠ¶æ€å˜é‡ï¼Œæ¨¡æ‹ŸçŠ¶æ€å˜é‡å’ŒæŒ¯åŠ¨æ§åˆ¶å˜é‡ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// controler type - fill it withe predefined values above unsigned char controllerType; // status of buttons - every controller fills this field unsigned short buttonStatus; // for analog pad fill those next 4 bytes // values are analog in range 0-255 where 127 is center position unsigned char rightJoyX, rightJoyY, leftJoyX, leftJoyY; // for mouse fill those next 2 bytes // values are in range -128 - 127 unsigned char moveX, moveY; unsigned char Vib[2]; unsigned char VibF[2]; unsigned char reserved[87]; } PadDataS;</span></span></code> </pre><br> å› æ­¤ï¼Œä¸»è¦ä»»åŠ¡æ˜¯å°†æ¥æ”¶åˆ°çš„æ•°æ®å†™å…¥è¿™äº›å˜é‡ã€‚ è¯¥æ¨¡æ‹Ÿå™¨å…·æœ‰æ’ä»¶ã€‚ åŒ…æ‹¬gamepadæ’ä»¶åœ¨å†…ï¼Œpluginsç›®å½•ä¸­æœ‰ä¸€ä¸ªdfinputå­ç›®å½•ï¼Œåœ¨è¯¥å­ç›®å½•ä¸­å¯ä»¥æ‰¾åˆ°æ‰€éœ€çš„pad.cæ–‡ä»¶ï¼Œå¯ä»¥åœ¨å…¶ä¸­è¯»å–æ¸¸æˆæ¿çš„çŠ¶æ€åŠå…¶è®¾ç½®ã€‚ è¿™æ˜¯ä»æµ‹è¯•ç¨‹åºä¸­ä¼ è¾“ä»£ç çš„åœ°æ–¹ã€‚ ç«¯å£å’Œåº“å¤´æ–‡ä»¶ä¹Ÿè¢«å£°æ˜ã€‚ å®ƒè¿˜å…·æœ‰å­˜å‚¨ç”¨äºå‘é€åˆ°æ¸¸æˆæ‰‹æŸ„çš„å‘½ä»¤ä»£ç çš„å˜é‡ã€‚ è¿™äº›å˜é‡ç”¨äºè®¿é—®æ¸¸æˆæ‰‹æŸ„çš„åŠŸèƒ½ã€‚ ä¸‹é¢æ˜¯è¿™æ®µä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdint.h&gt; #include "../include/psemu_plugin_defs.h" #include "main.h" #include &lt;wiringPi.h&gt; #define mosi 12 #define miso 13 #define clk 14 #define ce 5 unsigned char a, b; unsigned char cmd[9] = {0x1, 0x42, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}; enum { ANALOG_LEFT = 0, ANALOG_RIGHT, ANALOG_TOTAL }; enum { CMD_READ_DATA_AND_VIBRATE = 0x42, CMD_CONFIG_MODE = 0x43, CMD_SET_MODE_AND_LOCK = 0x44, CMD_QUERY_MODEL_AND_MODE = 0x45, CMD_QUERY_ACT = 0x46, // ?? CMD_QUERY_COMB = 0x47, // ?? CMD_QUERY_MODE = 0x4C, // QUERY_MODE ?? CMD_VIBRATION_TOGGLE = 0x4D, };</span></span></span></span></code> </pre><br> æˆ‘ä»¬å¯¹ç¬¬ä¸€ä¸ªå€¼42æ„Ÿå…´è¶£ã€‚åœ¨è¿™é‡Œï¼Œå½“è°ƒç”¨æ­¤å˜é‡æ—¶ï¼Œå°†æ‰§è¡Œä»£ç ã€‚ æ­¤å¤–ï¼Œåœ¨åŸå§‹æ–‡ä»¶ä¸­å®ƒä¸ºç©ºã€‚ åœ¨do_cmdå‘½ä»¤æšä¸¾å‡½æ•°ä¸­ï¼Œæˆ‘æ’å…¥äº†ä¸»è¦ä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> uint8_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_cmd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ PadDataS *pad = &amp;padstate[CurPad].pad; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pad_num = CurPad; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> data[<span class="hljs-number"><span class="hljs-number">9</span></span>] = {<span class="hljs-number"><span class="hljs-number">0</span></span>}; CmdLen = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (CurCmd) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_SET_MODE_AND_LOCK: buf = stdmode[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_QUERY_MODEL_AND_MODE: buf = stdmodel[pad_num]; buf[<span class="hljs-number"><span class="hljs-number">4</span></span>] = padstate[pad_num].PadMode; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_QUERY_ACT: buf = unk46[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_QUERY_COMB: buf = unk47[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_QUERY_MODE: buf = unk4c[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_VIBRATION_TOGGLE: buf = unk4d[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CMD_CONFIG_MODE: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (padstate[pad_num].ConfigMode) { buf = stdcfg[pad_num]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0xF3</span></span>; } <span class="hljs-comment"><span class="hljs-comment">// else FALLTHROUGH case CMD_READ_DATA_AND_VIBRATE: digitalWrite (ce, LOW); delayMicroseconds(20); for (a = 0; a &lt; 9; a++) { for (b = 0; b &lt; 8; b++) { if (((cmd[a] &gt;&gt; b)&amp;1) == 1) { digitalWrite (mosi, HIGH); digitalWrite (clk, LOW); delayMicroseconds(5); digitalWrite (clk, HIGH); data[a] ^= digitalRead(miso) &lt;&lt; b; delayMicroseconds(5); digitalWrite (mosi, LOW); } else { digitalWrite (clk, LOW); delayMicroseconds(5); digitalWrite (clk, HIGH); data[a] ^= digitalRead(miso) &lt;&lt; b; delayMicroseconds(5); } } delayMicroseconds(40); } digitalWrite (ce, HIGH); pad-&gt;buttonStatus = data[4]; pad-&gt;buttonStatus = pad-&gt;buttonStatus &lt;&lt; 8; pad-&gt;buttonStatus |= data[3]; pad-&gt;rightJoyX = data[5]; pad-&gt;rightJoyY = data[6]; pad-&gt;leftJoyX = data[7]; pad-&gt;leftJoyY = data[8]; default: buf = stdpar[pad_num]; buf[2] = pad-&gt;buttonStatus; buf[3] = pad-&gt;buttonStatus &gt;&gt; 8; if (padstate[pad_num].PadMode == 1) { buf[4] = pad-&gt;rightJoyX; buf[5] = pad-&gt;rightJoyY; buf[6] = pad-&gt;leftJoyX; buf[7] = pad-&gt;leftJoyY; } else { CmdLen = 4; } return padstate[pad_num].PadID; } }</span></span></code> </pre><br> ç„¶åï¼Œåœ¨è¯»å–å½“å‰å‘½ä»¤æ—¶ï¼Œå°†å¯¹æ¸¸æˆæ‰‹æŸ„è¿›è¡Œè½®è¯¢ï¼Œå¹¶å°†æ•°æ®å†™å…¥å˜é‡ï¼Œç„¶åä»¿çœŸå™¨æœ¬èº«å°†å…¶è·å–ã€‚ <br><br> ä»…æ­¤è€Œå·²ï¼Œä»…ç¼–è¯‘é¡¹ç›®å³å¯ã€‚ ä¸ºäº†ä½¿ç¼–è¯‘å™¨èƒ½å¤Ÿä½¿ç”¨wirigPiåº“ï¼Œæ‚¨éœ€è¦åœ¨é¡¹ç›®çš„Makefileä¸­æ’å…¥æŒ‡å‘å®ƒçš„é“¾æ¥ã€‚ ä»ä¸€å¼€å§‹å°±è¶³ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ <br><br><pre> <code class="cpp hljs"># Makefile <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> PCSX ReARMed <span class="hljs-meta"><span class="hljs-meta"># default stuff goes here, so that config can override TARGET ?= pcsx CFLAGS += -Wall -ggdb -Ifrontend -ffast-math -I/usr/</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> -I/usr/</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta">/SDL LDLIBS += -lpthread -lSDL -lpng -lwiringPi </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> DEBUG CFLAGS += -DNDEBUG -g </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> CXXFLAGS += $(CFLAGS) #DRC_DBG = 1 #PCNT = 1</span></span></code> </pre><br> è¿™å¾ˆé‡è¦ã€‚ ä¸ºäº†ä½¿ç”¨æ¨¡æ‹Ÿæ¸¸æˆæ‰‹æŸ„ï¼Œä»¿çœŸå™¨å¿…é¡»åœ¨è®¾ç½®ä¸­æŒ‡å®šä½¿ç”¨å®ƒã€‚ <br><br> æˆ‘æ²¡æœ‰å¾ˆå¤šPS1æ¸¸æˆï¼Œæˆ‘æ£€æŸ¥äº†å¤§çº¦7ä¸ªåœ°æ–¹ã€‚å®ƒåœ¨ã€Šå¤å¢“ä¸½å½±2ã€‹å’Œã€Šæ ¸æ‰“å‡»ã€‹ä¸Šä¸èµ·ä½œç”¨ï¼Œä½†è¿™å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºè¿™äº›æ¸¸æˆä¸çŸ¥é“ä»€ä¹ˆæ˜¯æ¨¡æ‹Ÿæ¸¸æˆæ‰‹æŸ„ã€‚ å¯èƒ½éœ€è¦åœ¨è®¾ç½®ä¸­é€‰æ‹©æ ‡å‡†å¹¶å°è¯•ã€‚ <br><br>  PSä»¿çœŸå™¨æœ¬èº«æœ€å¥½ä¸ä¼˜åŒ–æ ‡å¿—ç»„åˆåœ¨ä¸€èµ·ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æœ‰å¾ˆå¥½çš„æè¿°ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN403753/">https://habr.com/ru/post/zh-CN403753/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN403743/index.html">Google AIYï¼šè¯­éŸ³æ§åˆ¶å°å·¥å…·åˆ¶ä½œå·¥å…·åŒ…</a></li>
<li><a href="../zh-CN403745/index.html">RD-180æ›¿æ¢æ¯”èµ›ï¼šæ¿€æƒ…</a></li>
<li><a href="../zh-CN403747/index.html">äºšé©¬é€Šçš„äºšé©¬é€Šæ•°å­—åŠ©ç†è½¬å˜ä¸ºç§‘å­¦å®éªŒå®¤åŠ©ç†</a></li>
<li><a href="../zh-CN403749/index.html">1950å¹´çš„ç¨æ”¶å‡†å¤‡ï¼šä½¿ç”¨æ’ä»¶é¢æ¿â€œç¼–ç¨‹â€ IBM 403</a></li>
<li><a href="../zh-CN403751/index.html">æµ·æ´‹ä¸­çš„ç”Ÿå‘½ã€‚ åœ¨å½¼å¾—æ–¯å ¡ä»¥ä¸Š326ç±³å¤„ä¼šå‘ç”Ÿä»€ä¹ˆ</a></li>
<li><a href="../zh-CN403755/index.html">çº¸ç”µè„‘</a></li>
<li><a href="../zh-CN403757/index.html">é­”æœ¯æ‰‹åŠ¿æ˜¯ç”µå­å·¥ç¨‹å¸ˆçš„æŒ‘æˆ˜</a></li>
<li><a href="../zh-CN403759/index.html">ä¸­å›½ç§‘å­¦å®¶æ•™è¿‡ç¥ç»ç½‘ç»œä»¥äº†è§£äººä»¬ä»è„‘éƒ¨æ´»åŠ¨æ‰«æä¸­çœ‹åˆ°çš„å†…å®¹</a></li>
<li><a href="../zh-CN403761/index.html">æ¯”ç‰¹å¸ï¼šè®©æˆ‘ä»¬å›åˆ°å¼€å§‹å—ï¼Ÿ</a></li>
<li><a href="../zh-CN403763/index.html">åœ¨Matlabä¸­ä½¿ç”¨ä¸¤ä¸ªç‹¬ç«‹çš„è½´è¿›è¡Œç»˜å›¾</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>