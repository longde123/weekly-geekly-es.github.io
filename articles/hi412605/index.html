<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСа ЁЯМЦ ЁЯМзя╕П MERGE рдХреА рд▓рдбрд╝рд╛рдИред рдирд┐рд╖реНрдХрд░реНрд╖ рдФрд░ рдиреИрддрд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рдХреНрд░реЙрдирд┐рдХрд▓ ЁЯШм тЩЙя╕П ЁЯЫая╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рддрд┐рдмрджреНрдз рддреНрдпреМрд╣рд╛рд░ рд╕реЗ рдХреБрдЫ рд╣рдлреНрддреЗ рдкрд╣рд▓реЗ - рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдПрд╕рдХреНрдпреВрдПрд▓ 11 рдХреЗ feature freeze рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдкрд╣рд▓реЗ - рд╣реИрдХрд░реНрд╕ рдиреНрдпреВрдЬрд╝рд▓реЗрдЯрд░реНрд╕, рдмрд╛рдПрдВ рдкреИрдХреЗрдЬ рдореЗрдВ рдЪрд┐рдкрд╕реЗрдЯ рдХ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MERGE рдХреА рд▓рдбрд╝рд╛рдИред рдирд┐рд╖реНрдХрд░реНрд╖ рдФрд░ рдиреИрддрд┐рдХрддрд╛ рдХреЗ рд╕рд╛рде рдХреНрд░реЙрдирд┐рдХрд▓</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/412605/"> рдорд╣рддреНрд╡рдкреВрд░реНрдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреНрд░рддрд┐рдмрджреНрдз рддреНрдпреМрд╣рд╛рд░</a> рд╕реЗ рдХреБрдЫ рд╣рдлреНрддреЗ рдкрд╣рд▓реЗ - <b>рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдПрд╕рдХреНрдпреВрдПрд▓ 11</b> рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><code>feature freeze</code></a> рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдкрд╣рд▓реЗ - <b>рд╣реИрдХрд░реНрд╕</b> рдиреНрдпреВрдЬрд╝рд▓реЗрдЯрд░реНрд╕, рдмрд╛рдПрдВ рдкреИрдХреЗрдЬ рдореЗрдВ рдЪрд┐рдкрд╕реЗрдЯ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рддреЗ рд╣реБрдП, <b>MERGE</b> рдереНрд░рд┐рд▓рд░ рджреЗрдЦрд╛ред  рдереНрд░рд┐рд▓рд░ рдирд┐рд░реНрджреЗрд╢рдХ рдФрд░ <b>2ndQuadrant рдХреЗ</b> рд╕реАрдИрдУ <b>, <i>рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕</i></b> , рдиреЗ рдПрдХ рдкреИрдЪ рдХреЛ рдзрдХреНрдХрд╛ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬреЛ MERGE рдХрдорд╛рдВрдб рдХреЗ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЛ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рджреГрдврд╝рддрд╛ рдФрд░ рд╕рд░рд▓рддрд╛ рдХреЗ рд╕рд╛рде рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  рд░рд┐рдЧреНрд╕ 2009 рд╕реЗ рдПрдХ рдХреЙрдореЗрдбрд┐рдпрди рд╣реИрдВ, рдФрд░ рдПрдХ рдХреЙрдореЗрдбрд┐рдпрди рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдЖрдк рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдкреИрдЪ рдЕрдкреАрдпрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╡рд╣ рдХреЛрдИ рдХрдо рд╕рдореНрдорд╛рдирд┐рдд PostgreSQL рд╕рдорд┐рддрд┐рдпреЛрдВ рдФрд░ рджрд┐рдЧреНрдЧрдЬреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд░реЛрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдЬреБрдиреВрди рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдФрд░ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЙрднрд░ рд░рд╣реЗ рдереЗ, рдпрд╣ рд╕реАрдзреЗ рдЕрдкрдорд╛рди рднреА рдирд╣реАрдВ рдЖрдпрд╛ рдерд╛ - рдХрдИ рдШрд░реЗрд▓реВ рдордВрдЪреЛрдВ рдореЗрдВ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рддрдереНрдпред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреБрдЫ рддрдирд╛рд╡ рддрдм рддрдХ рдмрдирд╛ рд░рд╣рд╛ рдЬрдм рд╕рд╡рд╛рд▓ рд╕реБрд▓рдЭрд╛ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рднреА рдирд╣реАрдВ рд╣реИред <a name="habracut"></a><br><br>  рд▓реЗрдХрд┐рди рдЬреБрдиреВрди рдЬреБрдиреВрди рд╣реИрдВ (рдЙрдирдХреА рдЖрдЧреЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреА), рдФрд░ рдореИрдВ рдЗрд╕ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рджреВрд░ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рд╛рд░ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд░рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ред <br><br><img src="https://habrastorage.org/webt/t5/zc/ra/t5zcramwnjffszncwjkkkl9xt2g.jpeg"><br><h3>  рдмрд╛рд╣рд░ рдХреА рддрд░рдл </h3><br>  рдпрджрд┐ рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рд░рд▓ рд╣реИ, рддреЛ рдмрд╛рдд рдпрд╣ рд╣реИ: рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╣реА рдлрд╝реАрд▓реНрдб рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде 2 рдЯреЗрдмрд▓ рд╣реИрдВред  рдирд╛рдо рдФрд░ рдЖрдпреБ рдорд╛рди рд▓реЗрдВред  рд╣рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдореЗрдВ рдорд┐рд▓рд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рддрдп рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ рдХрд┐ рдЙрди рд╡реНрдпрдХреНрддрд┐рддреНрд╡реЛрдВ рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИ рдЬреЛ рджреЛрдиреЛрдВ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╣реИрдВред  рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╣рдо рдЕрдВрддрд┐рдо рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕рдм рдХреБрдЫ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдФрд░ рдорд┐рд▓рд╛рди рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЬрд╛рдирдХрд╛рд░реА рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВрдЧреЗред  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рднреА рдпрд╣ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рд╣реИред  рдпрд╣ <code>MERGE</code> рдмрд┐рдирд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ рдЬрдЯрд┐рд▓ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реБрдП, рдЖрдк рдЯреНрд░рд┐рдЧрд░реНрд╕ рдФрд░ рдЗрддрдиреЗ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдпрд╣ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, MERGE рдХрд╛ рдЧреИрд░-рд╡рд┐рд╣рд┐рдд рд╕рдВрд╕реНрдХрд░рдг, рдЬрд┐рд╕реЗ UPSERT (UPdate + inSERT) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред <br><br>  MERGE рдСрдкрд░реЗрдЯрд░ SQL-2003 рдорд╛рдирдХ рдореЗрдВ рд╣реИ рдФрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА SQL-2008 рдореЗрдВ рдЕрдкрдиреА рд╕рднреА рдорд╣рд┐рдорд╛ рдореЗрдВ рд╣реИред  рдЗрд╕реЗ Oracle, DB2 рдФрд░ MS SQL рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ MERGE рдХреА рдХрдореА рдЙрди рд▓реЛрдЧреЛрдВ рдХреЛ рдкрд░реЗрд╢рд╛рди рдХрд░реЗрдЧреА рдЬреЛ рдЗрди DBMSs рд╕реЗ PostgreSQL рдореЗрдВ рдЬрд╛рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВред  рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕ рдХреА рд▓рд╛рд▓рд╕рд╛ рдХреА рдЗрдЪреНрдЫрд╛ рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ, рдкрд╣рд▓реЗ рд╕реЗ рд╣реА PostgreSQL 11 рдореЗрдВ, 2ndQuadrant рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреА рдЗрдЪреНрдЫрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдФрд░ рдорд╣рддреНрд╡рд╛рдХрд╛рдВрдХреНрд╖рд╛ рдпрд╛ рдЭрдЧрдбрд╝реЗ рд╕реЗ рдирд╣реАрдВред <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, MERGE рдореЗрдВ рд╕рдореГрджреНрдз рдХреНрд╖рдорддрд╛рдПрдВ рд╣реИрдВ, рдбреЗрдЯрд╛ рдХреЛ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рд╕реЗ рдирд╣реАрдВ рд▓реЗрдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╕рдорд╛рди рд▓реЛрдЧреЛрдВ рд╕реЗред <br><br>  рдХрдорд╛рдВрдб рд╕рд┐рдВрдЯреИрдХреНрд╕ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ: <br><br><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">MERGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> tablename <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> table_reference <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (condition) <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> column1 = value1 [, column2 = value2 ...] <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> (column1 [, column2 ...]) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (value1 [, value2 ...]);</code> </pre> <br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЖрдк рдЗрд╕реЗ рдкрд╕рдВрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="hljs powershell">MERGE <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">hint</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">INTO</span></span></span></span> <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">schema</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">.</span></span></span><span class="hljs-function">] {</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">table</span></span></span></span> | view} <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">table_alias</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">USING</span></span></span></span> { subquery | <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">schema</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">.</span></span></span><span class="hljs-function">] { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">table</span></span></span></span> | view}} <span class="hljs-function"><span class="hljs-function">[</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">table_alias</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ON</span></span></span></span> ( condition ) [ <span class="hljs-type"><span class="hljs-type">merge_update_clause</span></span> ] [ <span class="hljs-type"><span class="hljs-type">merge_insert_clause</span></span> ] [ <span class="hljs-type"><span class="hljs-type">error_logging_clause</span></span> ] ;</code> </pre> <br>  рдпрд╣ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдУрд░реЗрдХрд▓ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╢рдмреНрджреЛрдВ рдореЗрдВ, рддрдм MERGE рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╣реА SQL рдХрдорд╛рдВрдб рдореЗрдВ data_source рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рдХреНрд╖реНрдп рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ target_table_name, рдЬреЛ рд╢рд░реНрддреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, INSERT, UPDATE рдпрд╛ DELETE рдХреЛ target_table_name рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, target_table_name рдПрдХ рджреГрд╢реНрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ data_source <b>рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдпрд╛ рд╡рд┐рдЪрд╛рд░реЛрдВ</b> рдХрд╛ рдПрдХ рд╕реЗрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ <b>, рдПрдХ рд╕рдмрдХреНрд╡реЗрд░реА рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ</b> ред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, <code>MERGE</code> , <code>data_source</code> рдкрд░ <code>data_source</code> рд╕рд╛рде рдПрдХ <code>left outer join</code> рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ 0 рдпрд╛ рдЕрдзрд┐рдХ рдХреИрдВрдбрд┐рдбреЗрдЯ рдЪреЗрдВрдЬ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХрд╛ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ;  рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреНрд░рдо рдореЗрдВ рдЧрдгрдирд╛ <code>WHEN</code> рдЬрд╛рддреА рд╣реИ;  рдЬреИрд╕реЗ рд╣реА рд╕реНрдерд┐рддрд┐ рд╕рдВрддреБрд╖реНрдЯ рд╣реЛрддреА рд╣реИ, рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЬрд╛рддреА рд╣реИред  <code>WHEN [NOT] MATCH THEN</code> <code>SQL</code> рдореЗрдВ рдХреАрд╡рд░реНрдб <code>WHEN [NOT] MATCH THEN</code> , рддреЛ рдпрд╣ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЖрдкрдХреЛ рдпрд╛рдж рджрд┐рд▓рд╛рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдПрдХ рдирд┐рдпрдВрддреНрд░рдг рдирд┐рд░реНрдорд╛рдг рд╣реИ рдЬреИрд╕реЗ <code>if-else</code> рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВред  <code>MERGE</code> рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ <code>UPDATE, INSERT</code> рдпрд╛ <code>DELETE</code> <code>target_table_name</code> рд╕рдВрдмрдВрдз рдореЗрдВ рд╣реИ, рдХреЗрд╡рд▓ рдкреВрд░реЗ рдХрдорд╛рдВрдб рдХрд╛ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЕрд▓рдЧ рд╣реИред <br><br>  <code>ON</code> рд╕рд╛рде рдПрдХ рдХреНрд▓реЙрдЬрд╝ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХ рдХреБрдВрдЬреА рдХреЗ рд╕рднреА рд╕реНрддрдВрднреЛрдВ рдкрд░ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛, рдпрджрд┐ рдЕрдиреНрдп рдХреЙрд▓рдо рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдХреБрдЫ рдЕрджреНрд╡рд┐рддреАрдп рд╕реВрдЪрдХрд╛рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рддрд╛рдХрд┐ рдЕрдиреНрдп рд▓реЗрдирджреЗрди рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛ рдХреЛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>[NOT] MATCHED</code> рддреБрд░рдВрдд рдЙрдореНрдореАрджрд╡рд╛рд░ рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдВред <br><br>  <code>MERGE</code> рдирд┐рд░реНрдзрд╛рд░рдХ рдХрдорд╛рдВрдб: рдЖрдк рдПрдХ рд╣реА рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдПрдХ рд╣реА MERGE рдХрдорд╛рдВрдб рдореЗрдВ рдХрдИ рдмрд╛рд░ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред <br>  рдПрдХ рдЙрджрд╛рд╣рд░рдг: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">MERGE</span></span> CustomerAccount CA <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> RecentTransactions T <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> T.CustomerId = CA.CustomerId <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> Balance = Balance + TransactionValue <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> (CustomerId, Balance) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (T.CustomerId, T.TransactionValue);</code> </pre> <br>  рдпрд╛ рдПрдХ рдЙрдкрд╢реНрд░реЗрдгреА рдХреЗ рд╕рд╛рде: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">MERGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> bonuses D <span class="hljs-keyword"><span class="hljs-keyword">USING</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id, salary, department_id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">80</span></span>) S <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (D.employee_id = S.employee_id) <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> D.bonus = D.bonus + S.salary*<span class="hljs-number"><span class="hljs-number">.01</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (S.salary &gt; <span class="hljs-number"><span class="hljs-number">8000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MATCHED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> (D.employee_id, D.bonus) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (S.employee_id, S.salary*<span class="hljs-number"><span class="hljs-number">.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> (S.salary &lt;= <span class="hljs-number"><span class="hljs-number">8000</span></span>);</code> </pre> <br>  <b>IBM DB2 рдореЗрдВ,</b> рд╕рд┐рдВрдЯреИрдХреНрд╕ рднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреИрд╕рд╛ рдХрд┐ рд╡реЗ рдХрд╣рддреЗ рд╣реИрдВ</a> , "рд╣реБрдб рдХреЗ рдиреАрдЪреЗ" рдпрд╣ рд╕рдорд╛рди рд░реВрдк рд╕реЗ <code>UPDATE FROM</code> рдирд┐рд░реНрдорд╛рдг <code>UPDATE FROM</code> рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br>  2008 рд╕реЗ, <b>MS SQL</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдВ</a> <code>MERGE</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднреА рд╣реИ</a> ред <br><br>  рд▓реЗрдХрд┐рди рдПрдХрд▓, рдорд╛рдирдХ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЗ рдкреАрдЫреЗ рднреА, рдХрд╛рдлреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рддрдВрддреНрд░ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╡рд┐рдзрд┐рдпреЛрдВ рд╕реЗ рдЪреБрдирдиреЗ рдХреА рд╕рдорд╕реНрдпрд╛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред  рдЯреАрдо рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓реЙрдХрд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рд╕рд╛рде рд▓реЗрди-рджреЗрди рдЕрд▓рдЧрд╛рд╡ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрддрд░реЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрддреНрдпрдзрд┐рдХ рдкреНрд░рддрд┐рд╕реНрдкрд░реНрдзреА рдпрд╛ рдСрдкрд░реЗрд╢рди рдХреЗ рдореЛрдб рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдФрд░, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдЬрдЯрд┐рд▓ рддрд░реНрдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдбреАрдмреАрдПрдордПрд╕ рдШрдЯрдХреЛрдВ рдХреЛ рдЫреВрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><h3>  рдпреВрдкреАрдПрд╕рдИрдЖрд░рдЯреА, рд╕реНрдпреВрдбреЛ-рдореЗрд░реЗрдЬ </h3><br>  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ DBMS рдбреЗрд╡рд▓рдкрд░реНрд╕ рд╕рдордЭреМрддрд╛ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рдереЗ, рд╕рдЪрдореБрдЪ рдорд╛рдирдХ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЛ рдкреБрди: рдкреЗрд╢ рдХрд░рдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░ рд░рд╣реЗ рдереЗред  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдкреНрд▓рд╕ рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рд╣реИред  рдЖрдк рдЙрди рддрдВрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ DBMS рдХреЗ рд▓рд┐рдП рдЬреИрд╡рд┐рдХ рд╣реИрдВ, рдЖрдк рдЙрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдорд╛рдирддреЗ рд╣реИрдВред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <b>MySQL</b> рдореЗрдВ рдПрдХ <code>REPLACE</code> рдХрдорд╛рдВрдб рд╣реИ рдЬреЛ <code>INSERT</code> рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдирдИ рдФрд░ рдкреБрд░рд╛рдиреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ <code>PRIMARY KEY</code> рдпрд╛ <code>UNIQUE</code> рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рд╕рдорд╛рди рдорд╛рди рд╣реИрдВ, рддреЛ рдирдпрд╛ рдбрд╛рд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреБрд░рд╛рдиреА рдкрдВрдХреНрддрд┐ рдХреЛ рдорд╛рд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди <code>INSERT ... ON DUPLICATE KEY UPDATE</code> рдЬрд╣рд╛рдБ <code>INSERT</code> рдФрд░ <code>UPDATE</code> рд╣реЛрддреЗ рд╣реИрдВ (рдмрдЬрд╛рдп <code>REPLACE</code> рдореЗрдВ <code>DELETE</code> )ред  рдпрд╣ <code>UPSERT</code> ред  рдФрд░ <code>INSERT IGNORE</code> , рдЬреЛ рдЯрд╛рд░рдЧреЗрдЯ рдЯреЗрдмрд▓ рдкрд░ рдХреБрдЫ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рддрд╣рдд рдПрдХ рддреНрд░реБрдЯрд┐ (рд▓реЗрдХрд┐рди рдЪреЗрддрд╛рд╡рдиреА) рдлреЗрдВрдХрдиреЗ рдХреЗ рдмрд┐рдирд╛, рдХреЗрд╡рд▓ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br><br><h3>  PG MERGE рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕ </h3><br>  PostgreSQL рд╕рдореБрджрд╛рдп рдореЗрдВ, MERGE рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд 2005 рдореЗрдВ рд╢реБрд░реВ рд╣реБрдИ рдЬрдм Jaime Casanova рдиреЗ рдкреВрдЫрд╛ рдХрд┐ <i>рдХреНрдпрд╛ рд╕рдореБрджрд╛рдп рдореЗрдВ рдХрд┐рд╕реА рдиреЗ</i> <code>MERGE</code> <i>рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛ рд╣реИ</i> ред  <i>рдкреАрдЯрд░ рдПрд╕реЗрдиреНрдЯреНрд░реМрдЯ</i> <a href="">рдиреЗ рдЪрд░реНрдЪрд╛</a> <i>рдХрд░рдиреЗ рдХрд╛</i> <a href="">рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛</a> <i>рдХрд┐ рдХреНрдпрд╛ PostgreSQL рдХреЛ MERGE рд╡рд┐рдХрд▓реНрдкреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП: MySQL рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рдорд╛рди, рдпрд╛ Oracle рд╕реЗ <code>MERGE</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рд╣рд▓реНрдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреЗрд╣рддрд░ рд╣реИред</i>  <i>рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреНрдпрд╛ рдЗрд╕ рджрд┐рд╢рд╛ рдореЗрдВ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИ?</i> <br><br>  рдПрдХ рдЫреЛрдЯреА рдЪрд░реНрдЪрд╛ рдХреЗ рдмреАрдЪ рдореЗрдВ, рдЗрд╕ рдХрдерд╛ рдХреЗ рдирд╛рдпрдХ <i>рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕</i> рд╢рдмреНрдж рдХреЗ рд╕рд╛рде рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ: <br>  <i>MERGE, OLTP рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдФрд░ DW (рдбреЗрдЯрд╛ рд╡реЗрдпрд░рд╣рд╛рдЙрд╕ - рдбреЗрдЯрд╛ рд╡реЗрдпрд░рд╣рд╛рдЙрд╕, рдпрд╛рдиреА рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди, рдЬрд╣рд╛рдБ рдЬрдЯрд┐рд▓ рдкреНрд░рд╢реНрди рд╣реИрдВ, рд▓реЗрдХрд┐рди рдмрд╣реБрдд рдкреНрд░рддрд┐рд╕реНрдкрд░реНрдзрд╛рддреНрдордХ рд╡рд╛рддрд╛рд╡рд░рдг рдФрд░ рдбреЗрдЯрд╛ рд╢рд╛рдпрдж рд╣реА рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рд╡реЗ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрдорддреМрд░ рдкрд░ рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ &lt;&gt; &lt;&gt;&gt; рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред) рд╣рдо MERGE рдХреЛ COPY FROM рдХреЗ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ред</i> <br><br>  рд╕рднреА рд╕рд╣рдордд рд╣реИрдВ: рд╣рд╛рдБ, рдЕрдЪреНрдЫрд╛ рд╣реИред  рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ, рд▓рдЧрднрдЧ рд╕рдм рдХреБрдЫ: <i>рд╕реНрдЯреАрдлрди рдлреНрд░реЙрд╕реНрдЯ</i> : <i>рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдореИрдВ рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдРрд╕рд╛ рд╡реНрдпрдХреНрддрд┐ рдирд╣реАрдВ рд╣реВрдВ рдЬреЛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдореБрдЭреЗ рдПрдХ рдкреВрд░реНрдг, рдЖрдЬреНрдЮрд╛рдХрд╛рд░реА MERGE рдорд╛рдирдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</i> <br><br>  рдмреНрд░реВрд╕ рдореЛрдореНрдЬрд┐рдпрди рдХреЗ рдкрд╛рд╕ рдПрдХ рдЕрд▓рдЧ, рдЕрдзрд┐рдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ рд╣реИ: <i>рдпрд╣ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдореЗрдВ</i> <code>MERGE</code> <i>рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ</i> <i>рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдмрд╛рдХреА рдореЗрдВ рд╣рдо рдПрдХ рддреНрд░реБрдЯрд┐ рджреЗрдВрдЧреЗ (рдФрд░ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдкреВрд░реА рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛)ред</i>  <i>рдФрд░ рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдФрд░ рд╣рдо рд╕реЛрдЪреЗрдВрдЧреЗ рдХрд┐ рдЖрдЧреЗ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИред</i> <br><br>  рд▓реЗрдХрд┐рди рдЕрднреА рддрдХ рдХреБрдЫ рдирд╣реАрдВ рд╣реЛ рд░рд╣рд╛ рд╣реИред <br><br><h3>  рдмрд░реНрдл рдЯреВрдЯ рдЪреБрдХреА рд╣реИ </h3><br>  <b>2008 рдореЗрдВ,</b> <i>рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕</i> рдиреЗ рдлрд┐рд░ рд╕реЗ MERGE рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХрд╛ рдЖрдЧреНрд░рд╣ рдХрд┐рдпрд╛ - рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реЗ рддрд░реАрдХреЗ (рддрдм рддрдХ SQL-2008 рдорд╛рдирдХ рдореЗрдВ MERGE рдХрд╛ рдПрдХ рдирдпрд╛ рд╕рдВрд╕реНрдХрд░рдг, рдЬреЛ рдЕрднреА рднреА рдорд╕реМрджрд╛ рд╣реИ, рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рджрд┐рдЦрд╛рдИ рджреЗ рд░рд╣рд╛ рд╣реИ)ред  рд╡рд╣ рдЙрд╕ рд╕рдордп рдУрд░реЗрдХрд▓, рдЖрдИрдмреАрдПрдо рдФрд░ рдПрдордПрд╕ SQL тАЛтАЛрдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдФрд░ MySQL рдФрд░ Teradata рд╕реЗ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдкреЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред  рдФрд░ рдереЛрдбрд╝реА рджреЗрд░ рдмрд╛рдж рд╡рд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕ рджрд┐рд╢рд╛ <b>рдореЗрдВ 2ndQuadrant</b> рдореЗрдВ <b>рдХрд╛рдо</b> рдХреА <b>рд╢реБрд░реБрдЖрдд рдХрд╛</b> рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддрд╛ рд╣реИред <br><br>  рдкреАрдЯрд░ рдЖрдЗрд╕реЗрдирдЯреНрд░рд╛рдЯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдкрдиреЗ рдмреНрд▓реЙрдЧ рдкрд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ</a> : <i>рдмреЗрд╢рдХ, рд░рд┐рдЧреНрд╕ рд╕рдмрд╕реЗ рдпреЛрдЧреНрдп рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИрдВ, рд╡рд╣ MERGE рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рдХрд╛рдо рдХрд╛ рдиреЗрддреГрддреНрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</i> <br><br>  рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рдкрд╣рд▓рд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдореЛрдбрд╝ рдЖрддрд╛ рд╣реИ: рдПрдХ <b>рдЫрд╛рддреНрд░</b> рд╕рдорд╕реНрдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ - <b>рдЬреАрдПрд╕рдУрд╕реА</b> рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдПрдХ рднрд╛рдЧреАрджрд╛рд░, рдпрд╛рдиреА рдХреЛрдб рдХрд╛ Google рдЧреНрд░реАрд╖реНрдордХрд╛рд▓реАрдиред  рдЙрд╕рдХрд╛ рдирд╛рдо <i>рдмреЙрдХреНрд╕реБрдЖрди Bxzhai рд╣реИ</i> - рдореИрдВ рдЕрдВрддрд┐рдо рдирд╛рдо рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдорд╛рдирддрд╛ рд╣реВрдВред  рдЬрд▓реНрдж рд╣реА рд╡рд╣ рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХрд╛рдо рд▓рдЧрднрдЧ рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИред <br><br>  рд▓реЗрдХрд┐рди рд▓рдЧрднрдЧ рдЧрд┐рдирддреА рдирд╣реАрдВ рд╣реИред  2ndQuadrant рдХреЗ <i>рдЧреНрд░реЗрдЧ рд╕реНрдорд┐рде</i> (рдпрд╛рдиреА рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕ рд╕рд╣рдпреЛрдЧреА) рд▓рд┐рдЦрддреЗ рд╣реИрдВ: <br>  <i>рддреЛ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдХреЛрдб рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдзрд╛ рджрд░реНрдЬрди рдЧрдВрднреАрд░ рдЕрдирд╕реБрд▓рдЭреЗ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВред</i>  <i>рдореИрдВ рдХреНрд╖реБрджреНрд░ рд▓реЛрдЧреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪреБрдк рд╣реВрдБред</i>  <i>рдХрдореЗрдЯреА рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреЛ рдЕрдВрддрд┐рдо рд░реВрдк рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд╕реНрдпрд╛рдПрдВ рдмрд╣реБрдд рдЧрд╣рд░реА рд╣реИрдВред</i>  <i>рдЗрд╕ рдмреАрдЪ, рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдмреЙрдХреНрд╕реБрдЖрди рд╕реЗ рдХреБрдЫ рднреА рдирд╣реАрдВ рд╕реБрдирд╛ рдЧрдпрд╛ рд╣реИред</i>  <i>рд╣рдо рдЙрд╕рдХреА рдорджрдж рдХрд░ рд╕рдХрддреЗ рдереЗ, рд▓реЗрдХрд┐рди рд╡рд╣ рдХрд╣рд╛рдВ рд╣реИ?</i>  <i>рдХрд┐рд╕рдореЗрдВ рд╣реИ рдЬрд╛рди?</i> <br><br>  <b>2014</b> рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрдереЛрдВ рдХреА рдЪрд░реНрдЪрд╛ рдлрд┐рд░ рд╕реЗ <b>рднрдбрд╝рдХреА</b> , рд▓реЗрдХрд┐рди рдлрд┐рд░ рдХреБрдЫ рдирд╣реАрдВ рд╣реБрдЖ: рдХреЛрдИ рдХреЛрдб рдирд╣реАрдВ рд╣реИред <br><br>  рдЕрдВрдд рдореЗрдВ, <b>2017 рдХреА</b> рд╢реБрд░реБрдЖрдд рдореЗрдВ <b>,</b> <i>рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕</i> рд▓рд┐рдЦрддреЗ рд╣реИрдВ: <br>  <i>рдореИрдВ <code>MERGE</code> рдХреЛ <b>PostgreSQL</b> рд╕рдВрд╕реНрдХрд░рдг <b>11</b> рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реВрдВред</i>  <i>рд╣рдо рдЙрд╕реА рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХрд╛рдо рдХрд░ рд░рд╣реЗ <code>INSERT ON CONFLICT</code> рд░реЗрдЦрд╛рдВрдХрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдХрд┐рд╕реА рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдБрдЪреЗ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛ, рдореВрд▓ рд░реВрдк рд╕реЗ рдЬреЛ рдЙрдкрд▓рдмреНрдз рд╣реИ рдЙрд╕рдХреЗ рдКрдкрд░ рд╕рд┐рдВрдЯреИрдХреНрд╕ рд▓рд╛рдЧреВ рдХрд░рдирд╛ред</i>  <i>рд▓реЗрдХрд┐рди рдореИрдВ рдЦрд░реЛрдВрдЪ рд╕реЗ рдЕрдкрдирд╛ рдХреЛрдб рд▓рд┐рдЦрддрд╛ рд╣реВрдВ, рдореИрдВ рдкрд┐рдЫрд▓реЗ рд╡рд┐рдХрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реВрдВред</i> <br><br>  рд╣рдо рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдкреАрдЯрд░ рдЬреЛрдЧреЗрдЧрди ( <b>рд╡реАрдПрдорд╡реЗрдпрд░</b> ) рдХреА, рдЬреЛ рддрдм рддрдХ рд▓рд╛рдЧреВ рд╣реЛ рдЪреБрдХрд╛ рдерд╛, рдкрд╣рд▓реЗ рд╕реЗ рд╣реА 9.5 рд╡реИрдХрд▓реНрдкрд┐рдХ <code>INSERT .. ON CONFLICT UPDATE</code> рд╕рд┐рдВрдЯреИрдХреНрд╕ рдкрд░, SQL рдорд╛рдирдХ рд╕реЗ рдЕрд▓рдЧ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА MySQL рдореЗрдВ <code>MERGE</code> рдФрд░ <code>REPLACE</code> рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╕рд╛рдЗрдорди рдХрд╛ рдХрд╛рдо рдиреАрд╕ рдХреЗ рдХрд╛рдо рдХреЗ рдЙрджреНрдЧрд╛рд░ рд╕реЗ рдорд┐рд▓рд╛ рдерд╛!  рд╣рд╛рд▓рд╛рдВрдХрд┐, <i>рд░реЙрдмрд░реНрдЯ рд╣рд╛рд╕</i> , рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рд╣рд╛рдпрдХ рд╣реИрдВ, рд╕рдВрднрд╛рд╡рд┐рдд рдХреНрд░рдорд┐рдХ рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреА рдЪреЗрддрд╛рд╡рдиреА рджреЗрддреЗ рд╣реИрдВред  рдЬреИрд╕реЗ, <code>INSERT .. ON CONFLICT UPDATE</code> рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП <code>INSERT .. ON CONFLICT UPDATE</code> , рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ MERGE рдХреЗ рдмрд┐рдирд╛, рдпрд╣ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рд╢рд╛рдВрдд рд╣реИред <br><br>  PostgreSQL <code>UPSERT</code> рд▓реЗрдЦрдХ <code>UPSERT</code> рдЦреБрдж: <br>  <i>рдореИрдВ <code>ON CONFLICT DO UPDATE</code> рдФрд░ <code>MERGE</code> рдХреЛ рдирд╣реАрдВ <code>ON CONFLICT DO UPDATE</code> ред</i>  <i>&lt;...&gt; рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдореЗрдВ рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ( <code>bulk load</code> ), рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>merge join</code> рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред</i>  <i>&lt;...&gt; рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, <code>MERGE</code> рдХреЗ рдлрд╛рдпрджреЗ рдЗрд╕ рддрдереНрдп рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдВрдЧреЗ рдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рдХрдиреЗрдХреНрд╢рди рд╡рд╣рд╛рдВ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░реЗрдВрдЧреЗ: <code>nested loop, hash, merge</code> ред</i>  <i>рдФрд░ <code>INSERT тАж ON CONFLICT</code> рдХреЛрдИ <code>INSERT тАж ON CONFLICT</code> рдирд╣реАрдВ рд╣реИрдВред</i> <br><br>  рд╣рд╛рд╕: <i>рдкреАрдЯрд░ рдХреА рддрд░рд╣, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ <code>DML</code> рдЕрдиреБрд░реЛрдз рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рдРрд╕рд╛ рдордЬрдмреВрдд рд▓реЙрдХ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИред</i>  <i>рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреЛрдИ рднреА рдкреНрд░рд╕рдиреНрди рд╣реЛрдЧрд╛ рдХрд┐ рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╣реА рд╡реНрдпрдХреНрддрд┐ <code>MERGE</code> рд╕рд╛рде рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред</i> <br><br>  рдЬрд┐рдЬреНрдЮрд╛рд╕реБ рдХреЗ рд▓рд┐рдП: рдЧреАрдЧрди <code>MERGE</code> рдФрд░ <code>MERGE</code> рдмреАрдЪ рд╕реВрдХреНрд╖реНрдорддрд╛рдУрдВ рдФрд░ <code>UPSERT</code> рдЕрдВрддрд░реЛрдВ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> (рд╣рдо рдЕрдкрдиреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдХреНрдпреВрдПрд▓ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрдЧреНрд░рд╣реАрдд рдкрддреНрд░рд╛рдЪрд╛рд░</a> рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрдЧреНрд░рд╣реАрдд</a> рдХрд░рддреЗ рд╣реИрдВ) рдХреЛ рдЕрд▓рдЧ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рд╕рд╛рдЗрдорди рдиреЗ рд╡рд┐рд░реЛрдз рдХрд┐рдпрд╛ред  рд╡рд╣ рд╣рд╛рд▓ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдХреА рдЕрдкреАрд▓ рдХрд░рддрд╛ рд╣реИред  рдЬреИрд╕реЗ, рд╕реЗрдХреНрд╢рдирд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЙрдиреНрд╣реЛрдВрдиреЗ рдпрд╣ рднреА рдХрд╣рд╛ "рдПрдХ рдирдпрд╛ рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕, рдЗрд╕рд╕реЗ рдЬреНрдпрд╛рджрд╛ рдХреБрдЫ рдирд╣реАрдВред"  рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рдмрд╣реБрдд рд╣реА рдЙрдкрдпреЛрдЧреА рдЪреАрдЬ рдирд┐рдХрд▓рд╛ред  <i>рд▓реЗрдХрд┐рди рдореИрдВ рддреБрд░рдВрдд рд╕рдм рдХреБрдЫ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рд╕реНрддрд╛рд╡ рдирд╣реАрдВ рдХрд░рддрд╛ рдЬреЛ рдХрд┐ MERGE рдореЗрдВ рд╣реИред</i>  <i>рд╣рдо рд╡рд┐рднрд╛рдЬрди рдХреЗ рд╕рд╛рде рднреА рдРрд╕рд╛ рд╣реА рдХрд░реЗрдВрдЧреЗ - рд╣рдо рд╡рд┐рдХрд╛рд╕ рдХреЛ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреЗ рд╣реИрдВред</i> <br><br>  рдФрд░ рдПрдХ рдФрд░ рддрд░реНрдХ, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ рдмрд╣реБрдд рдЖрд╢реНрд╡рд╕реНрдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ: <i>рдЕрдЪреНрдЫрд╛ред</i>  <i>рд▓реЗрдХрд┐рди рдЪрд▓реЛ рдЪреБрдирддреЗ рд╣реИрдВред</i>  <i>рдореИрдВ рдПрдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╡рд┐рдХрд▓реНрдк рд╕реБрдЭрд╛рддрд╛ рд╣реВрдВред</i>  <i><b>10 рд╕рд╛рд▓ рдЬрд▓реНрдж рд╣реА</b> <code>MERGE</code> рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдиреЗ рдХреЗ рдкрд╣рд▓реЗ рдЧрдВрднреАрд░ рдкреНрд░рдпрд╛рд╕ рд╕реЗ <b>рдЖрдПрдВрдЧреЗ</b> ред</i>  <i>рдХреНрдпрд╛ рдпрд╣ рд╕рд╣реА рд╕рдорд╛рдзрд╛рди рдХреЗ 10 рд╡рд░реНрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдХреБрдЫ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ, рдХреБрдЫ рдЙрдкрдпреЛрдЧреА рд╕рдорд╛рдзрд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рдирд╣реАрдВ рд╣реИ?</i>  <i>рдпрд╣ рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдпрд╣ рд╕рдм рдореМрдЬреВрдж рд╣реИред</i> <br><br>  рдЕрдВрдд рдореЗрдВ, рдкреИрдЪ рд╕рдореБрджрд╛рдп рдореЗрдВ рдЖрддрд╛ рд╣реИред  рдХрд┐рд╕ рддрд╛рд░реАрдЦ рдХреЛ?  рдХреГрдкрдпрд╛ рдХрд▓реНрдкрдирд╛ рдХреАрдЬрд┐рдПред  рдирд╣реАрдВ, рдЙрдиреНрд╣реЛрдВрдиреЗ рдЕрдиреБрдорд╛рди рдирд╣реАрдВ рд▓рдЧрд╛рдпрд╛: рд╕рд╛рдЗрдорди 30 рджрд┐рд╕рдВрдмрд░, 2017 рдХреЛ рдЙрдиреНрд╣реЗрдВ рднреЗрдЬрддрд╛ рд╣реИред  рдФрд░ рдпрд╣ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ WIP рдкреИрдЪ рд╣реИ, рдЕрд░реНрдерд╛рдд рд╡рд░реНрдХ рдЗрди рдкреНрд░реЛрдЧреНрд░реЗрд╕ - рд╡рд░реНрдХ рдЗрди рдкреИрдЪред <br><br>  рд╕рд╛рдЗрдорди, рдЬрдирд╡рд░реА: <br>  <i>рдкреИрдЪ рдмрд┐рдирд╛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдмрдЧ рдХреЗ рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИред</i>  <i><b>рдХреЛрдб</b> рдкреНрд▓рд╕ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдФрд░ рдкреНрд░рд▓реЗрдЦрди <b>рдХреА 1200 рд▓рд╛рдЗрдиреЗрдВ</b> ред</i>  <i>рдореИрдВ рдЙрд╕реЗ рдЗрд╕ рдХрдорд┐рдЯ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдВ, рдФрд░ рд╣рдо рдЖрд░рдПрд▓рдПрд╕ (рд░реЛ рд▓реЗрд╡рд▓ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА - рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рд╕реНрддрд░ рдкрд░ рд╕реБрд░рдХреНрд╖рд╛) рдФрд░ рд╡рд┐рднрд╛рдЬрди рд╕рдорд░реНрдерди рдХреЛ рдмрд╛рдж рдореЗрдВ рдкреВрд░рд╛ рдХрд░реЗрдВрдЧреЗред</i> <br><br><h3>  рд╕рдорд┐рддрд┐рдпреЛрдВ рдХреА рдЬрд╛рддрд┐ </h3><br>  рдпрд╣рд╛рдВ рд╣рдореЗрдВ рдЕрд▓рдЧ рд╕реЗ рдПрдХ рдХрджрдо рдЙрдард╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рдореБрджрд╛рдп рдореЗрдВ рдЖрдпреБрдХреНрдд рдХреА рднреВрдорд┐рдХрд╛ рдХреЛ рд╕рдордЭрд╛рдирд╛ рд╣реЛрдЧрд╛ред  рдЖрдпреБрдХреНрдд рдХреЗ рдХрд╛рд░реНрдп, рдЕрд░реНрдерд╛рддреН, рдЬреЛ рдЕрдЧрд▓реЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдкреИрдЪ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╢рдХреНрдд рд╣реИ, рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд░реВрдк рд╕реЗ рдмрджрд▓ рдЧрдпрд╛ рд╣реИред  рдПрдХ рдмрд╛рд░ рдЬрдм рдХреБрдЫ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдереЗ, рддреЛ рдкреНрд░рддрд┐рдмрджреНрдз рд╣реЛрдиреЗ рдХрд╛ рдЕрдзрд┐рдХрд╛рд░ рдЙрджрд╛рд░рддрд╛ рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреНрд░рд╕рд┐рджреНрдз (рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><b>рдЬреВрд▓рд┐рдпрди рдЕрд╕рд╛рдВрдЬреЗ</b></a> рдиреЗ рдХреЗрд╡рд▓ рдЫрд╣ рдкреИрдЪ рдХреЗ рд▓реЗрдЦрдХ рд╣реЛрдиреЗ рдХреЗ рдирд╛рддреЗ рдХрдорд╛рдВрдбрд░ рдХреА рдЙрдкрд╛рдзрд┐ рдкреНрд░рд╛рдкреНрдд рдХреАред  рдЕрдм рдХрдорд┐рд╢реНрдирд░ рдмрдирдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реИ, рдПрдХ рджрд░реНрдЬрди рд▓реЛрдЧреЛрдВ рдХреА рд╕реВрдЪреА рдореЗрдВ рдХреЛрдИ рдмрджрд▓рд╛рд╡ рдирд╣реАрдВ рд╣реБрдЖ рд╣реИред  рдмреЙрдпрд╕ рдореЛрдореНрджрдЬрд╛рди (рдПрдВрдЯрд░рдЯреАрдбреАрдбреАрдмреА) рдореЗрдВ 13,363 рдХрдорд┐рдЯреНрд╕ рд╣реИрдВ, рдЯреЙрдо рд▓реЗрди (рдЯреЙрдо рд▓реЗрди, <b>рдХреБрд░рдХреБрд░реЗ рдбреЗрдЯрд╛</b> ) 13127, рд░реЙрдмрд░реНрдЯ рд╣рд╛рд╕ ( <b>рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬрдмреАрдбреА</b> ) - 2074ред рд╡реИрд╕реЗ, <b>рд░реВрд╕ рд╕реЗ рдПрдХрдорд╛рддреНрд░</b> рдХрдореЗрдВрдЯ рдлреЗрдбрд░ рд╕рд┐рдЧреЗрд╡ ( <b>рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдЬ рдкреНрд░реЛрдлреЗрд╢рдирд▓</b> ) рдЕрдкрдиреЗ 383 рдХрдорд┐рдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХрд░рддрд╛ рд╣реИред ред  рд╕рд╛рдЗрдорди рд░рд┐рдЧреНрд╕ рд╕реНрд╡рдпрдВ рдХреЗ рдкрд╛рд╕ 449 рд╣реИрдВред рдореИрдВ рджреЛрд╣рд░рд╛рддрд╛ рд╣реВрдВ: рд╡рд╣, рдПрдХ рдЖрдпреБрдХреНрдд рдХреЗ рд░реВрдк рдореЗрдВ, рдЙрдирдХреЗ рдФрд░ рдЙрдирдХреЗ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЛ рдкреИрдЪ рд▓реЗрдиреЗ рдФрд░ рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдзрд┐рдХрд╛рд░ рд╣реИред  рдПрдХ рдФрд░ рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рд╢рд╛рдпрдж рд╣реА рдРрд╕рд╛ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдЕрдиреНрдп рдкреНрд░рдореБрдЦ рд▓реБрдорд┐рдиреЗрд░реА-рд╕рдорд┐рддрд┐рдпреЛрдВ рдХреА рд░рд╛рдп рдХреА рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЙрдкреЗрдХреНрд╖рд╛ред  рд╡реЗ рдПрдХ рдЖрдпреБрдХреНрдд рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рднреА рд╡рдВрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХрдо рд╕реЗ рдХрдо рд╡реЗ рдкреИрдЪ рдмреИрдХ рдХреЛ <code>revert</code> рдХрд░ рджреЗрдВрдЧреЗред <br><br><h3>  рд▓рдбрд╝рд╛рдИ рдореЗрдВ рдлреНрд░реИрдХреНрдЪрд░ </h3><br>  рдмреЗрд╢рдХ, "рдирд┐рд░рд╛рд╢рд╛рдЬрдирдХ" рдкреИрдЪ рдореЗрдВ, рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, рдЬрд▓реНрджрдмрд╛рдЬреА рдореЗрдВ, рдЙрдиреНрд╣реЗрдВ рдирдИ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдорд┐рд▓рддреА рд╣реИрдВред  рдЬрд╡рд╛рдм рдореЗрдВ рдирдП рд╕рдВрд╕реНрдХрд░рдг рд░реЛрд▓ред <br><br>  рдЬрдирд╡рд░реА рдХреЗ рдЕрдВрдд рдореЗрдВ, рдПрдХ рдирдпрд╛ рдЪрд░рд┐рддреНрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ: 2ndQuadrant <i>Pavan</i> рдХрд╛ рд╡рд┐рдХрд╛рд╕рдХ (рдЙрд╕рдХрд╛ рдирд╛рдо рд╣рд░ рдХрд┐рд╕реА рдХреЗ рдкрд╛рд╕ рд╣реИ; рдкреВрд░реА рддрд░рд╣ рд╕реЗ Pavan Deolasee)ред  рдЕрдм рд╕рдореБрджрд╛рдп рдПрдХ рдорд╣рд╛рдорд╛рд░реА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ: рдкрд╡рди рдирдП рд╕рдВрд╕реНрдХрд░рдг рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рдЖрд▓реЛрдЪрдирд╛ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╕рд╛рдЗрдорди рдПрдХ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╡рд┐рдкрдгрди рджрдмрд╛рд╡ рдХреЗ рд╕рд╛рде рдЙрдиреНрд╣реЗрдВ рддреЛрдбрд╝рддрд╛ рд╣реИред <br><br>  рд╣рд╛рд╕: <i>рдореБрдЭреЗ рдирд╣реАрдВ рд▓рдЧрддрд╛ рдХрд┐ рдпрд╣ рд╣рд░ рдЬрдЧрд╣ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рдмрд╣рд┐рд╖реНрдХрд╛рд░ рдкрд░ рдПрдХрддрд░рдлрд╛ рдирд┐рд░реНрдгрдп рд▓реЗрдиреЗ рдХреЗ рд▓рд╛рдпрдХ рд╣реИред</i>  <i>рдпрджрд┐ рд╣рдо рд╕рд╣рдордд рд╣реИрдВ рдХрд┐ рдЗрд╕ рдкреИрдЪ рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрдВрдЧреА - рддреЛ рдпрд╣ рдПрдХ рдмрд╛рдд рд╣реИред</i>  <i>рдФрд░ рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рд╣реИ рдХрд┐ рдЗрд╕ рдЕрд╡рд╕рд░ рдкрд░ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рд╕рднреА рдиреЗ рдЕрд╕рд╣рдорддрд┐ рд╡реНрдпрдХреНрдд рдХреАред</i>  <i>рдФрд░ рд╣рдордиреЗ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрди рдХрд╛рд░рдгреЛрдВ рдХреЛ рдирд╣реАрдВ рд╕реБрдирд╛ рд╣реИ рдХрд┐ рдЗрди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдмрд╛рд╣рд░ рдХреНрдпреЛрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред</i> <br><br>  рддрд░реНрдХ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: <br><br><ul><li>  рдПрдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛, рдЧрдВрднреАрд░ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ "рдХреИрд╡реЗрд▓рд░реА рд╣рдорд▓реЗ рдХреА рд╢реИрд▓реА" рдХреЗ рдШрдЯрдирд╛рдХреНрд░рдо рдореЗрдВ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред </li><li>  рд╕рдВрд╕реНрдХрд░рдг 10-11 рдореЗрдВ рдирдП рд╡рд┐рднрд╛рдЬрди рдЬреИрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди, рд╕реАрдЯреАрдИ (рдХреЙрдорди рдЯреЗрдмрд▓ рдПрдХреНрд╕рдкреНрд░реЗрд╢рди = рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд╕рд╛рде) рдпрд╛ рдЖрд░рдПрд▓рдПрд╕ (рд░реЛ рд▓реЗрд╡рд▓ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА) рдкреИрдЪ рдХреЛ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж рднреА рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рддрднреА рдЬрдм рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╢реАрд░реНрд╖ рдкрд░ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реЛред рдЙрд╕рдХреА рд╡рд╛рдВрдЫрд┐рдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ред </li></ul><br>  рджреВрд╕рд░рд╛ рдкреАрдЯрд░ рдЧреАрдЧрди рдЗрд╕реЗ рддреИрдпрд╛рд░ рдХрд░рддрд╛ рд╣реИ: <br>  <i>рдЖрдорддреМрд░ рдкрд░ рдореИрдВ <b>рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛</b> рдХреЗ <b>рд╕рдорд░реНрдерди рдкрд░</b> рдзреНрдпрд╛рди рджреЗрддрд╛ рд╣реВрдВ <b>, рдХреНрдпреЛрдВрдХрд┐ рдЕрдЧрд░ рдпрд╣ рд╣реИ, рддреЛ рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЛ рдордЬрдмреВрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдбрд┐рдЬрд╛рдЗрди рдХреЛ рд╡реИрд╕рд╛ рд╣реА рдмрдирд╛рдпрд╛ рдЬрд╛рдП рдЬреИрд╕рд╛ рдХрд┐ рдЙрд╕реЗ рдЪрд╛рд╣рд┐рдП</b> ред</i>  <i>рдФрд░ рдЕрдЧрд░ рдЗрд╕ рддрд░рд╣ рдХреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ [рдЕрд░реНрдерд╛рдд, <code>CTE</code> ] рдХреЗ рд╕рдорд░реНрдерди рдХреЗ рдХрд╛рд░рдг рд╣реЛрддреА рд╣реИрдВ, рддреЛ рдореБрдЭреЗ рдпрд╣ рд╡рд┐рдЪрд╛рд░ рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдРрд╕реА рд╣реИ рдХрд┐ рдпрд╣ рдпрд╣рд╛рдВ рдФрд░ рд╡рд╣рд╛рдВ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рдХрд╛рд░рдг рд╣реЛрдЧрд╛ред</i> <br><br>  рдЗрд╕ рдмреАрдЪ, рдШрдВрдЯреЗ X (рдЕрдВрддрд┐рдо рдХрдореЗрдЯреАрдлреЗрд╕реНрдЯ) рдЖ рд░рд╣рд╛ рд╣реИ, рдФрд░ MERGE рдкрд░ рдмрд╛рджрд▓ рдЬрдорд╛ рд╣реЛ рд░рд╣реЗ рд╣реИрдВред  рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╕рдВрд╕реНрдерд╛рдкрдХ рдкрд┐рддрд╛ рдиреЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд╛рдЗрдорди рдФрд░ рдлрд┐рд░ рдкрд╛рд╡рди рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдкреЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдореЗрдВ рдЧрдВрднреАрд░ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рддрд▓рд╛рд╢ рдХреАред  рдореБрдЭреЗ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рддрд▓рд╛рд╢ рдирд╣реАрдВ рдХрд░рдиреА рдереА, рдЙрдиреНрд╣реЛрдВрдиреЗ рд╕реНрд╡реЗрдЪреНрдЫрд╛ рд╕реЗ рдЦреБрдж рдХреЛ рдЦреЛрд▓рд╛ред <br><br><h3>  рд╕рдВрдкреНрд░рджрд╛рдп рдирд┐рдХрдЯ рд╣реИ </h3><br>  рдХрдерд╛рдирдХ рдореЗрдВ рддреЗрдЬреА рдЖ рд░рд╣реА рд╣реИред  рдЕрдкрдиреЗ рдЙрдкрдХреНрд░рдо рдХреЗ рдкреНрд░рддрд┐ рдЕрдиреНрдп рд╕рдорд┐рддрд┐рдпреЛрдВ рдХреЗ рдардВрдбреЗ рд░рд╡реИрдпреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, <b>2 рдЕрдкреНрд░реИрд▓ рдХреЛ,</b> рд╕рд╛рдЗрдорди рдиреЗ <b>рдПрд╕рдХреНрдпреВрдПрд▓: 2016</b> рдкреИрдЪ рдХреЗ <b>рдмрд╛рдж рдХрдорд╛рди</b> рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рдлрд╛рдЗрд▓реНрд╕ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдбреАрдкреЗрдЬрд╝ (рд╣реНрдпреВрдмрд░реНрдЯ рд▓реБрдмрд╛рдЪреЗрд╡рд╕реНрдХреА) рдЕрдкрдиреЗ рдмреНрд▓реЙрдЧ рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрд╕рдХреА рдШреЛрд╖рдгрд╛</a> рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрд╕реА рджрд┐рди рд╕рд╛рдЗрдорди рд╕рдм рдХреБрдЫ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рддреНрд░реБрдЯрд┐рдпреЛрдВред <br><br>  рдЕрдЧрд▓реЗ рджрд┐рди, рд╕рдорд░реНрдерди рдХреЗ <code>WITH</code> рдЬреЛрдбрд╝рдХрд░ рдлрд┐рд░ рд╕реЗ рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░реЗрдВред <br><br>  рдЬрд╡рд╛рдм рдореЗрдВ, рдЖрд░реЛрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЧрдВрднреАрд░ рд╣реИрдВред  <i>рдПрдВрдбреНрд░реЗрд╕ рдлреНрд░рд╛рдпрдВрдб</i> ( <b>рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬрдбреАрдмреА</b> ) рд▓рд┐рдЦрддреЗ рд╣реИрдВ: <br>  <i>рдкрд╛рд░реНрд╕рд░ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрдирдХрд░реНрддрд╛ рдореЗрдВ MERGE рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдиреЗ рдореБрдЭреЗ рдордЬрд╝рдмреВрддреА рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ред</i>  <i>рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЫрд┐рдкреЗ рд╣реБрдП рдЬреЛрдбрд╝ рдмрдирд╛рдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рдмреБрд░рд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИред</i>  <i>рдирд┐рд╖реНрдкрд╛рджрдХ рдХреА рдпрд╣ рд╕рдВрд░рдЪрдирд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдмрджрд▓рдиреА рдЪрд╛рд╣рд┐рдПред</i> <br><br>  рдЯреЙрдо рд▓реЗрди: <br>  <i>рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдЯреНрд░реА рдХрд╛ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрдордЬреЛрд░ рд╣реИред</i> <br><br><br><br>  <i>рдЖрдк <code>InsertStmt</code> рдлрд╝рдВрдХреНрд╢рди рдХреЛ <code>InsertStmt</code> рдХрд░рддреЗ рд╣реИрдВ, рд╡рд╣ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИ, рдпрд╣ <code>INSERT</code> рдмрд┐рд▓реНрдХреБрд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдореВрд▓ рдХреЗ рд╕рдорд╛рди рдлрд╝реАрд▓реНрдб рд╣реЛрддреЗ рд╣реИрдВред</i>  <i>рдФрд░ рд╕рднреА рдирд╣реАрдВ, рд▓реЗрдХрд┐рди рдХреБрдЫред</i>  <i>рдпрд╣ рдмреБрд░рд╛ рд╣реИ, рдЗрд╕рд╕реЗ рднреНрд░рдо рдкреИрджрд╛ рд╣реЛрддрд╛ рд╣реИред</i> <br><br>  рдЖрдЗрдП <i>рдлреЗрдбрд░ рд╕рд┐рдЧрд╛рдПрд╡</i> рдХреА рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ: <br>  <i>рдкрд╛рд░реНрд╕рд░ рдореЗрдВ, <code>MERGE</code> рд╕рдВрдмрдВрдзрд┐рдд <code>INSERT</code> рдиреЛрдбреНрд╕ рджрд┐рдЦрд╛рдИ рджрд┐рдП, рдЬреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рдПрдХ рд╕рдореВрд╣ рдХреЗ рд╕рд╛рде рд▓рдЯрдХрд╛рдП рдЧрдП рдереЗред</i>  <i>рдпрджрд┐ рдЖрдк <code>ANALIZE</code> рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЬрдирд╛ рдХреЛ <code>ANALIZE</code> , рддреЛ рдЖрдк рддреБрд░рдВрдд рдпрд╣ рдирд╣реАрдВ рд╕рдордЭ рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рдЖрдк рдирд┐рдпрдорд┐рдд <code>INSERT</code> рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдпрд╛ <code>MERGE</code> рд╕рд╛рде: рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдлрд╝реАрд▓реНрдб рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</i> <br><br><br>  рд╕рд╛рдЗрдорди, рд╢рд╛рдВрддрд┐ рд╕реЗ: <i>рдареАрдХ рд╣реИ, рд╣рдо рдЗрд╕реЗ рдмрджрд▓ рджреЗрдВрдЧреЗ рдФрд░ рдХрд▓ рдПрдХ рдирдИ рдлрд╝рд╛рдЗрд▓ рднреЗрдЬреЗрдВрдЧреЗ</i> ред <br>  Haas: <i>рдореИрдВ рдкреАрдЯрд░ рдХреЗ рд╕рд╛рде рд╕рд╣рдордд рд╣реВрдБред</i>  <i>рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЕрд╕рдлрд▓ рд╣реИред</i> <br><br>  рд╕рд╛рдЗрдорди рд╣рд╛рд░ рдирд╣реАрдВ рдорд╛рдирддрд╛ред  <b>6 рдЕрдкреНрд░реИрд▓,</b> рдЯреЙрдо рд▓реЗрди рдХреА рдЖрд▓реЛрдЪрдирд╛ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ, рдкрд╛рд░реНрд╕рд░ рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдирдпрд╛ рдкреИрдЪ рдХрд░рддрд╛ рд╣реИред <br><br><h3>  рдмрд╛рддрдЪреАрдд рдФрд░ рд╕рдорд░реНрдкрдг </h3><br>  рдмреНрд░реВрд╕ рдореЛрдореНрдЬрди <b>6 рдЕрдкреНрд░реИрд▓</b> : <br>  <i>рдореИрдВ рдпрд╣ рдиреЛрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рд▓реЛрдЧреЛрдВ рдиреЗ рдЖрдкрдХреЛ рддрддреНрдХрд╛рд▓ рдХреБрдЫ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдбрд╝реА рдореЗрд╣рдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдХрд╣рд╛ред</i>  <i>рдЙрдиреНрд╣реЛрдВрдиреЗ рдЖрдкрдХреЛ рдкреИрдЪ рд╡рд╛рдкрд╕ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ред</i>  <i>рдЖрдк рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдХрдбрд╝реА рдореЗрд╣рдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ рдЕрдкрдиреЗ рджрд┐рдорд╛рдЧ рдХреЛ рдмрджрд▓ рджреЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди - рдлрд┐рд░ рд╕реЗ - рдЙрдиреНрд╣реЛрдВрдиреЗ рдЙрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдкрд╕реЗ рдирд╣реАрдВ рдкреВрдЫрд╛ред</i> <br><br>  рд╕рд╛рдЗрдорди: <i>рдЕрдЧрд░ рдЯреЙрдо [рд▓реЗрди] рдФрд░ рдПрдВрдбреНрд░реЗрд╕ [рдлреНрд░рд╛рдпрдВрдб] рд╢реЗрд╖ рдХреБрдЫ рджрд┐рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрднреА рднреА рдорд╣рд╕реВрд╕ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдирдХреЗ рдбрд░ рдХреЛ рджреВрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдореБрдЭреЗ рдЖрдЧреЗ рдХреА рд╣рд▓рдЪрд▓ рдХреЗ рдмрд┐рдирд╛ <b>рдкреИрдЪ</b> рдХреЛ <b>рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдореЗрдВ рдЦреБрд╢реА рд╣реЛрдЧреА</b> ред</i> <br><br>  рдЯреЙрдо рд▓реЗрди: <i>рдореИрдВ рдЕрднреА рднреА рдкреИрдЪ рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕ рд▓реБрдврд╝рдХрд╛ рд╣реБрдЖ рд╣реВрдВред</i>  <i>рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рд╡рд╣ рдЕрдм рдкрд░рд┐рдкреВрд░реНрдг рдереЗ, рддреЛ рдЕрдм рд▓реЛрдЧреЛрдВ рдХреЗ рдкрд╛рд╕ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЖрд╢реНрд╡рд╕реНрдд рд╣реЛрдиреЗ рдХрд╛ рд╕рдордп рдирд╣реАрдВ рд╣реИ - рдЕрдиреНрдп рдЬрд░реВрд░реА рдорд╛рдорд▓реЛрдВ рдХреЗ рдЧрд▓реЗ рдХреЗ рд▓рд┐рдПред</i> <br><br>  рд╡рд╣ рд╕рдм рд╣реИред <br><br>  рд╕рд╛рдЗрдорди рдиреЗ рдХрд╣рд╛ рдареАрдХ рд╣реИ, рдФрд░ <code>MERGE</code> рдкрд░ рд▓рдбрд╝рд╛рдИ рдЦрддреНрдо рд╣реЛ <code>MERGE</code> рдереАред  рд╕рднреА рдкреИрдЪ рдХреЛ рд╡рд╛рдкрд╕ рдкрдВрдк рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕ рд╡рд┐рд╖рдп рдХреЛ "рд▓реЗрдЦрдХ рдХреЗ рд╕рдорд╛рдкрди рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛" рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдЕрдЧрд▓реЗ рдХрдореЗрдЯ рдореЗрдВ рд▓реЗ рдЬрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╢реЛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдкреНрд░рддрд┐рднрд╛рдЧрд┐рдпреЛрдВ рдиреЗ рд╢рд╛рдВрддрд┐ рдмрдирд╛рдП рд░рдЦреАред <br><br><img src="https://habrastorage.org/webt/ad/zw/ry/adzwryarovhxoldwxewpneljyms.jpeg"><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рд╛рд▓ рдХреЗ рд╣рдлреНрддреЛрдВ рдХреЗ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рдХреБрдЫ рддрдирд╛рд╡ рдмрдирд╛ рд╣реБрдЖ рд╣реИред <br><br><h3>  рдиреИрддрд┐рдХрддрд╛ рдХрд╛ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ </h3><br><ul><li>  рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, PostgreSQL рд╕рдореБрджрд╛рдп рдореЗрдВ рдЕрдкрд░рд┐рдкрдХреНрд╡ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЗ рд▓рд┐рдП (рд▓рдЧрднрдЧ) рд╕рдВрдШрд░реНрд╖-рдореБрдХреНрдд рд╕реНрдХреНрд░реАрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдХреГрддрд┐рдХ рдФрд░ рдФрдкрдЪрд╛рд░рд┐рдХ рддрдВрддреНрд░ рд╣реИрдВред  рднрд▓реЗ рд╣реА рд╡реЗ рдХрдВрдкрдиреА рдХреЗ рдкреНрд░рдореБрдЦ рдХреЗ рд░реИрдВрдХ рдореЗрдВ рд╕рдореНрдорд╛рдирд┐рдд рдбреЗрд╡рд▓рдкрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЪ рдХрд┐рдП рдЧрдП рд╣реЛрдВ, рдЬрд┐рдирдХреЗ рдкреЛрд╕реНрдЯрдЧреНрд░реЗрдХреНрдпреВрдПрд▓ рдХреЗ рд╡рд┐рдХрд╛рд╕ рдореЗрдВ рдпреЛрдЧрджрд╛рди рдмрд╣реБрдд рдмрдбрд╝рд╛ рд╣реИред  рдФрд░ рдЬрд┐рди рдЧреНрд░рд╛рд╣рдХреЛрдВ рдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреА рдХрдореА рд╣реИ рд╡реЗ рдирд┐рд╡реЗрд╢ рдХрд░рдиреЗ рдкрд░ рдЬреЛрд░ рджреЗ рд░рд╣реЗ рд╣реИрдВред </li><li>  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд╕рдореБрджрд╛рдп рдЕрдХреНрд╕рд░ рд╕реНрдЯрд╛рд▓реЛрдВред  рдЕрд╕рдВрджрд┐рдЧреНрдз рд░реВрдк рд╕реЗ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╡рд┐рдХрд╛рд╕ рдХреЛ рдЕрдкрдирд╛рдиреЗ рдореЗрдВ рдпрд╣ рдирд┐рд╖реНрдХреНрд░рд┐рдп рд╣реИред  рдХрднреА-рдХрднреА рддрд░реНрдХрд╣реАрди рдкреВрд░реНрдгрддрд╛рд╡рд╛рдж рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред  рдкреЛрд╕реНрдЯрдЧреНрд░реИрдЬ рдкреНрд░реЛрдлреЗрд╢рдирд▓ рдХрд╛ рдЕрдиреБрднрд╡, рдЬрд╣рд╛рдВ рдореИрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реВрдВ, рдЗрд╕рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИред  рд╣рдордиреЗ 3 рд╡рд░реНрд╖реЛрдВ рдХреЗ рд▓рд┐рдП <b>INCLUDE рд╕реВрдЪрдХрд╛рдВрдХреЛрдВ</b> рдХреЗ рдПрдХ рдмрдбрд╝реЗ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреИрдЪ рдХреЛ рдЫрд┐рджреНрд░рд┐рдд рдХрд┐рдпрд╛ред  <b>JSON / JSONB рдХреЗ</b> рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрдЪ рдХреА рдПрдХ рдЙрдкрдпреЛрдЧреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЕрднреА рднреА рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣реА рд╣реИред  рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ "рд╕рдореБрджрд╛рдп рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рд╡рд┐рдХрд╛рд╕ рджреЗрдВ" <b>рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рджреЗрдиреЗ рдХрд╛</b> рдорддрд▓рдм <b>рдирд╣реАрдВ</b> рд╣реИ <b>, рд▓реЗрдХрд┐рди рдЫрд┐рджреНрд░рдг</b> : рдЕрддрд┐рдерд┐ рдХреЛ рдЦреБрд▓реА рдмрд╛рд╣реЛрдВ рд╕реЗ рдмрдзрд╛рдИ рджреА рдЬрд╛рддреА рд╣реИ рдФрд░ рд╕рдВрдЧрд░реЛрдз рдХреЗ рд▓рд┐рдП рд░рд╡рд╛рдирд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul><br>  рдкреБрдирд╢реНрдЪ: <i>рд▓реЗрдЦрдХ рд╕реЗ рдЕрд╕реНрд╡реАрдХрд░рдг</i> : рд╣рдо рд╕рд┐рд░реНрдл рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЬреАрд╡рди рдХрд╛ рдПрдХ рдЯреБрдХрдбрд╝рд╛ рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рдереЗред  рд╕рднреА рдирд╛рдо рдорд┐рд▓рд╛рди рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╣реИрдВ :) <br>  PPS: рд╕рдореБрд░рд╛рдИ <i>рдирддрд╛рд▓рд┐рдпрд╛ рд▓реЗрд╡рд╢рд┐рдирд╛</i> ред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi412605/">https://habr.com/ru/post/hi412605/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi412591/index.html">рдЬреЗрдЯрдкреИрдХ рдХрд╛ рдирд┐рд░реНрдорд╛рдг: 29 рдордИ рд╡реЗрдиреНрдбреЗрд▓ рдореВрд░ рдХрд╛ рд╕реНрдореГрддрд┐ рджрд┐рд╡рд╕ рд╣реИ</a></li>
<li><a href="../hi412593/index.html">рдирдП рдЙрддреНрдкрд╛рдж, рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо, рдФрд░ рдСрд▓-рдП-рдП-рд╕рд░реНрд╡рд┐рд╕: рдПрдЪрдкреАрдИ рд╡реЗрдмрд┐рдирд╛рд░</a></li>
<li><a href="../hi412595/index.html">2018 рдХреНрд▓рдм рдСрдл рд░реЛрдо рд░рд┐рдкреЛрд░реНрдЯ, рдЕрдзреНрдпрд╛рдп 1.1.2: "рдлрд╛рдЗрдиреЗрдВрд╕рд┐рдВрдЧ"</a></li>
<li><a href="../hi412597/index.html">рдЬреЗрдл рдмреЗрдЬреЛрд╕ рдЪрд╛рдВрдж рдХреА рд╕рддрд╣ рдкрд░ рдПрдХ рдХреЙрд▓реЛрдиреА рдмрдирд╛рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ</a></li>
<li><a href="../hi412603/index.html">рдЕрдЬреАрдм php рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ</a></li>
<li><a href="../hi412607/index.html">рдкреНрд░рддрд┐рд╡рд░реНрддреА рд╕реЛрд▓реНрдбрд░рд┐рдВрдЧ рд╕реНрдЯреЗрд╢рди HI-END рдХреНрд▓рд╛рд╕</a></li>
<li><a href="../hi412609/index.html">рд╕реАрдПрд▓рдЖрдИрдПрди рдореЗрдВ рдЙрддреНрдкрд╛рджрдХрддрд╛ рдХреЗ рд▓рд┐рдП 10 рдпреБрдХреНрддрд┐рдпрд╛рдВ, рдПрдХ рдХреНрд░реЙрд╕-рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рд╕реА / рд╕реА ++ рдЖрдИрдбреАрдИ</a></li>
<li><a href="../hi412611/index.html">рдкреНрд░рднрд╛рд╡реА рдЦрдирди рдФрд░ рдЧреЗрдо рдереНрдпреЛрд░реА рдореЗрдВ рдХреНрдпрд╛ рд╕рдорд╛рдирддрд╛ рд╣реИ</a></li>
<li><a href="../hi412613/index.html">рдкреВрд░реНрдгрд╛рдВрдХ рдЕрдВрдХрдЧрдгрд┐рддред рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЧреЛрд▓ рдХрд░рдХреЗ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВред рднрд╛рдЧ 1</a></li>
<li><a href="../hi412615/index.html">рдкреАрдИ рдФрд░ рд╕реАрдИ рдХреЗ рдмреАрдЪ рдмреАрдЬреАрдкреА рдШреЛрд╖рдгрд╛рдУрдВ рдореЗрдВ рд░реВрдЯ рд▓рдХреНрд╖реНрдп рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>