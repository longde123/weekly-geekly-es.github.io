<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òØÔ∏è üÖæÔ∏è üìµ Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 4 üëêüèø üêû üë©üèæ‚Äçüç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eskalation von Berechtigungen 
 Links zu allen Teilen: 
 Teil 1. Erstzugriff erhalten (Erstzugriff) 
 Teil 2. Ausf√ºhrung 
 Teil 3. Befestigung (Persis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lernen Sie kontroverse Taktiken, Techniken und allgemeines Wissen (ATT @ CK). Unternehmenstaktik. Teil 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428602/"><h1>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eskalation von Berechtigungen</a> </h1><br>  <b>Links zu allen Teilen:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1. Erstzugriff erhalten (Erstzugriff)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Ausf√ºhrung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3. Befestigung (Persistenz)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 4. Eskalation von Berechtigungen</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 5. Verteidigungshinterziehung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 6. Abrufen von Anmeldeinformationen (Zugriff auf Anmeldeinformationen)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 7. Entdeckung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 8. Seitliche Bewegung</a> <br><br>  Die Eskalation von Berechtigungen ist das Ergebnis von Aktionen, mit denen ein Angreifer oder ein Schadprogramm eine h√∂here Berechtigungsstufe f√ºr das angegriffene System oder Netzwerk erhalten kann.  Techniken zur Eskalation von Berechtigungen beschreiben die Methoden, mit denen ein Gegner, der unprivilegierten Zugriff auf ein angegriffenes System erhalten hat und verschiedene ‚ÄûSchwachstellen‚Äú eines Systems verwendet, lokale Administrator-, System- oder Stammrechte erhalten kann.  Die Verwendung von Benutzerkonten mit Zugriffsrechten auf bestimmte Systeme oder Berechtigungen f√ºr bestimmte Vorg√§nge durch Angreifer kann auch als Eskalation von Berechtigungen angesehen werden. <br><a name="habracut"></a><br>  <i>Der Autor ist nicht verantwortlich f√ºr die m√∂glichen Konsequenzen der Anwendung der im Artikel aufgef√ºhrten Informationen und entschuldigt sich auch f√ºr m√∂gliche Ungenauigkeiten in einigen Formulierungen und Begriffen.</i>  <i>Die ver√∂ffentlichten Informationen sind eine kostenlose Nacherz√§hlung des Inhalts von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br>  Es ist wichtig abzubrechen, dass einige der in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ATT @ CK-</a> Matrix beschriebenen Techniken gleichzeitig in mehreren Phasen der Angriffskette enthalten sind. Beispielsweise kann das Abfangen der DLL-Suche sowohl zum Sichern des Zugriffs durch unbefugte Ausf√ºhrung einer b√∂swilligen DLL als auch zum Erh√∂hen der Berechtigungen durch Starten der DLL im Prozess verwendet werden. Arbeiten im Kontext eines privilegierten Benutzers. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Manipulation von Zugriffstoken</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Benutzer, Administrator <br>  <i>Beschreibung:</i> Angreifer k√∂nnen Zugriffstoken verwenden, um Aktionen in verschiedenen Sicherheitskontexten f√ºr Benutzer oder Systeme auszuf√ºhren und so die Erkennung b√∂swilliger Aktivit√§ten zu vermeiden.  Ein Gegner kann die Windows-API-Funktionen verwenden, um Zugriffstoken aus vorhandenen Prozessen zu kopieren (Token-Diebstahl). Dazu muss er sich im Kontext eines privilegierten Benutzers (z. B. eines Administrators) befinden.  Der Diebstahl von Zugriffstoken wird h√§ufig verwendet, um Berechtigungen von der Administratorebene auf die Systemebene zu erh√∂hen.  Ein Gegner kann auch ein Kontozugriffstoken zur Authentifizierung auf einem Remote-System verwenden, wenn dieses Konto √ºber die erforderlichen Berechtigungen auf dem Remote-System verf√ºgt. <br>  Betrachten Sie verschiedene M√∂glichkeiten, um Zugriffstoken zu missbrauchen: <br><ul><li>  Diebstahl und Identit√§tswechsel von Token.  Der Identit√§tswechsel von Token ist die F√§higkeit des Betriebssystems, Threads in einem anderen Sicherheitskontext als dem Kontext des Prozesses zu starten, zu dem dieser Thread geh√∂rt.  Mit anderen Worten, die Personifizierung von Token erm√∂glicht es Ihnen, Aktionen im Namen eines anderen Benutzers auszuf√ºhren.  Ein Gegner kann ein Zugriffstoken mithilfe der Funktion <i>DuplicateTokenEX</i> duplizieren und mit <i>ImpersonateLoggedOnUser</i> einen Thread im Kontext eines angemeldeten Benutzers <i>aufrufen</i> oder mit <i>SetThreadToken</i> einem Stream ein Zugriffstoken zuweisen. </li><li>  Erstellen Sie einen Prozess mit einem Zugriffstoken.  Ein Angreifer kann mithilfe der Funktion <i>DuplicateTokenEX</i> ein Zugriffstoken erstellen und es dann mit <i>CreateProcessWithTokenW verwenden</i> , um einen neuen Prozess zu erstellen, der im Kontext des imitierten Benutzers ausgef√ºhrt wird. </li><li>  Abrufen und Identifizieren von Zugriffstoken.  Ein Gegner mit einem Benutzernamen und einem Kennwort kann mithilfe der <i>LogonUser-</i> API-Funktion eine Anmeldesitzung erstellen, die eine Kopie des Sitzungszugriffstokens einer neuen Sitzung <i>zur√ºckgibt</i> , und dann mithilfe der <i>SetThreadToken-Funktion</i> dem Thread ein Token zuweisen.  Metasploit Meterpreter und CobaltStrike verf√ºgen √ºber Tools zum Bearbeiten von Zugriffstoken, um die Berechtigungen zu erh√∂hen. </li></ul><br>  <i>Schutzempfehlungen:</i> Um die oben genannten Taktiken vollst√§ndig nutzen zu k√∂nnen, muss ein Angreifer √ºber Systemadministratorrechte verf√ºgen. Vergessen Sie daher nicht, die Berechtigungen normaler Benutzer einzuschr√§nken.  Jeder Benutzer kann Zugriffstoken austricksen, wenn er √ºber legitime Anmeldeinformationen verf√ºgt.  Beschr√§nken Sie die M√∂glichkeit f√ºr Benutzer und Gruppen, Zugriffstoken zu erstellen: <br>  <i>Gruppenrichtlinienobjekt: Computerkonfiguration&gt; [Richtlinien]&gt; Windows-Einstellungen&gt; Sicherheitseinstellungen&gt; Lokale Richtlinien&gt; Zuweisung von Benutzerrechten: Erstellen Sie ein Token-Objekt</i> <br>  Stellen Sie au√üerdem fest, wer die Prozesstoken von lokalen Diensten oder Netzwerkdiensten ersetzen kann: <br>  <i>Gruppenrichtlinienobjekt: Computerkonfiguration&gt; [Richtlinien]&gt; Windows-Einstellungen&gt; Sicherheitseinstellungen&gt; Lokale Richtlinien&gt; Zuweisung von Benutzerrechten: Ersetzen Sie ein Token auf Prozessebene</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√Ñnderung ausf√ºhrbarer Dateien von Anwendungen "Eingabehilfen von Windows" (Eingabehilfen)</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator <br>  <i>Beschreibung:</i> Eingabehilfen (Bildschirmlupe, Bildschirmtastatur usw.) k√∂nnen mithilfe von Tastenkombinationen gestartet werden, bevor sich ein Benutzer am System anmeldet.  Ein Angreifer kann die Startdateien dieser Programme ersetzen oder die Art und Weise √§ndern, in der sie gestartet werden, und eine Befehlskonsole √∂ffnen oder eine Hintert√ºr erhalten, ohne sich anzumelden. <br><ul><li>  <i>C: \ Windows \ System32 \ sethc.exe</i> - wird durch f√ºnffaches Dr√ºcken der Umschalttaste gestartet; </li><li>  <i>C: \ Windows \ System32 \ utilman.exe</i> - wird durch Dr√ºcken der Kombination von Win + U gestartet. </li></ul><br>  In WinXP und sp√§teren Versionen k√∂nnen sethc.exe und utilman.exe beispielsweise durch cmd.exe ersetzt werden. Wenn Sie dann die gew√ºnschte Tastenkombination dr√ºcken, wird cmd.exe gestartet, bevor Windows mit Systemberechtigungen aufgerufen wird. <br>  In Vista und sp√§teren Versionen m√ºssen Sie den Registrierungsschl√ºssel √§ndern, mit dem cmd.exe oder ein anderes Programm als Debugger konfiguriert wird, z. B. f√ºr ultiman.exe.  Nach dem Bearbeiten der Registrierung und Dr√ºcken der gew√ºnschten Tastenkombination auf dem Anmeldebildschirm oder beim Herstellen einer Verbindung zum Host √ºber RDP wird cmd.exe mit Systemrechten ausgef√ºhrt. <br>  Es gibt auch Windows-Programme, mit denen diese Angriffstechnik implementiert werden kann: <br><ul><li>  <i>C: \ Windows \ System32 \ osk.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Magnify.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ Narrator.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ DisplaySwitch.exe;</i> </li><li>  <i>C: \ Windows \ System32 \ AtBroker.exe.</i> </li></ul><br>  <i>Sicherheitsempfehlungen:</i> Konfigurieren Sie den Start der obligatorischen Netzwerkauthentifizierung f√ºr Remotebenutzer, bevor Sie eine RDP-Sitzung erstellen und den Anmeldebildschirm anzeigen ( <i>standardm√§√üig in Windows Vista und h√∂her aktiviert</i> ).  Verwenden Sie das Remotedesktop-Gateway, um Verbindungen zu verwalten und die RDP-Sicherheit zu konfigurieren. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√Ñndern des AppCert-DLL-Schl√ºssels</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator, System <br>  <i>Beschreibung:</i> Im Schl√ºsselwert AppCertDLLs angegebene DLLs werden in jeden Prozess geladen, der die h√§ufig verwendeten API-Funktionen <i>aufruft</i> : <i>CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, WinExec</i> .  Der AppCertDLL-Schl√ºsselwert kann missbraucht werden, indem eine sch√§dliche DLL geladen wird und bestimmte Prozesse ausgef√ºhrt werden.  AppCertDLLs werden im folgenden Registrierungsschl√ºssel gespeichert: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager</i> . <br><br>  Schutzempfehlungen <i>:</i> Verwenden Sie alle m√∂glichen Mittel, um potenziell gef√§hrliche Software zu blockieren und unbekannte DLLs wie AppLocker und DeviceGuard herunterzuladen. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√Ñnderung des AppInit-DLL-Schl√ºssels</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator, System <br>  <i>Beschreibung:</i> Im Schl√ºsselwert AppInit_DLLs angegebene DLLs werden in jeden Prozess geladen, den user32.dll l√§dt.  In der Praxis ist dies fast jedes Programm. <br>  AppInit_DLLs wird in den folgenden Registrierungsschl√ºsseln gespeichert: <br><ul><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows;</i> </li><li>  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  Der AppInit_DLLs-Schl√ºsselwert kann missbraucht werden, um Berechtigungen zu √ºberschreiten, indem sch√§dliche DLLs geladen und bestimmte Prozesse gestartet werden.  Die AppInit_DLLs-Funktionalit√§t ist in Windows 8 und h√∂her deaktiviert, wenn Secure Boot aktiviert ist. <br><br>  <i>Schutzempfehlungen:</i> Verwenden Sie eine Betriebssystemversion, die nicht fr√ºher als Windows 8 ist, und aktivieren Sie den sicheren Start.  Verwenden Sie alle m√∂glichen Mittel, um potenziell gef√§hrliche Software zu blockieren und unbekannte DLLs wie AppLocker und DeviceGuard herunterzuladen. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Missbrauch des Anwendungskompatibilit√§ts-Subsystems (Application Shimming)</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator <br>  <i>Beschreibung:</i> <i>Microsoft Windows Application Compatibility Infrastructure / Framework wurde</i> erstellt, um die Kompatibilit√§t von Programmen mit Windows-Updates und √Ñnderungen des Betriebssystemcodes sicherzustellen.  Das Kompatibilit√§tssystem verwendet die sogenannten Shim ("Gaskets") - Bibliotheken, die als Puffer zwischen dem Programm und dem Betriebssystem fungieren.  Mithilfe des Shim-Cache ermittelt das System den Bedarf an Shim-Dichtungen (gespeichert als SDB-Datenbank).  In verschiedenen SDB-Dateien werden verschiedene Verfahren zum Abfangen, Verarbeiten und anschlie√üenden Umleiten von Anwendungscode an das Betriebssystem gespeichert.  Die Liste aller vom Installationsprogramm (sdbinst.exe) installierten Shim-Dichtungen wird standardm√§√üig gespeichert in: <br><ul><li>  <i>% WINDIR% \ AppPatch \ sysmain.sdb</i> ; </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  Benutzerdefinierte Shim-Datenbanken werden gespeichert in: <br><ul><li>  <i>% WINDIR% \ AppPatch [64] \ Custom;</i> </li><li>  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  Um den Schutz im Benutzermodus zu gew√§hrleisten, ist die M√∂glichkeit zum √Ñndern des Betriebssystemkerns mithilfe von Shim-Gaskets ausgeschlossen, und f√ºr die Installation sind Administratorrechte erforderlich.  Einige Shim-Pads k√∂nnen jedoch verwendet werden, um die Benutzerkontensteuerung (User Account Control, UAC), die DLL-Injection, die Deaktivierung der <a href="">Verhinderung der</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datenausf√ºhrung</a> und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Behandlung von Architekturausnahmen</a> sowie das Abfangen von Speicheradressen zu umgehen.  Ein Angreifer, der Shim-Gaskets verwendet, kann die Berechtigungen erh√∂hen, Backdoors installieren und den Betriebssystemschutz deaktivieren, z. B. Windows Defender. <br><br>  Schutzempfehlungen <i>:</i> Es gibt nicht viele M√∂glichkeiten, das Shiming von Anwendungen zu verhindern.  Das Deaktivieren der Anwendungskompatibilit√§t wird nicht empfohlen, um Probleme mit der Stabilit√§t des Betriebssystems zu vermeiden.  Microsoft hat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">KB3045645 ver√∂ffentlicht</a> , mit dem das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flag</a> "Auto-Elevation" in der Datei "sdbinst.exe" entfernt wird, um die Verwendung des Shim-Systems zur Umgehung der Benutzerkontensteuerung zu verhindern. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerkontensteuerung umgehen</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Benutzer, Administrator <br>  <i>Beschreibung:</i> Es gibt viele M√∂glichkeiten, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerkontensteuerung</a> zu umgehen, von denen die h√§ufigsten im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UACMe-</a> Projekt implementiert sind.  Regelm√§√üig werden neue M√∂glichkeiten zur Umgehung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerkontensteuerung</a> entdeckt, z. B. der Missbrauch der Systemanwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eventvwr.exe</a> , mit der eine Bin√§rdatei oder ein Skript mit erh√∂hten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rechten ausgef√ºhrt</a> werden kann.  Sch√§dliche Programme k√∂nnen auch in vertrauensw√ºrdige Prozesse eingebettet werden, durch die die Benutzerkontensteuerung die Eskalation von Berechtigungen erm√∂glicht, ohne einen Benutzer dazu aufzufordern. <br>  Um die Benutzerkontensteuerung mithilfe von eventvwr.exe zu umgehen, wird der Schl√ºssel in der Windows-Registrierung ge√§ndert: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ mscfile \ shell \ open \ Befehl</i> . <br>  Um die Benutzerkontensteuerung mit sdclt.exe zu umgehen, werden die Schl√ºssel in der Windows-Registrierung ge√§ndert: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Microsoft \ Windows \ CurrentVersion \ App Paths \ control.exe;</i> <i><br></i>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ exefile \ shell \ runas \ command \ isolationCommand.</i> <br><br>  <i>Schutzempfehlungen:</i> Entfernen Sie Benutzer aus der lokalen Administratorgruppe auf den gesch√ºtzten Systemen.  Aktivieren Sie nach M√∂glichkeit die h√∂chste Schutzstufe in den UAC-Einstellungen. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abfangen der DLL-Suche (Hijacking der DLL-Suchreihenfolge)</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Benutzer, Administrator, System <br>  <i>Beschreibung: Die</i> Technik besteht darin, Schwachstellen im Algorithmus auszunutzen, um von den Anwendungen die DLL-Dateien zu finden, die sie zum Arbeiten ben√∂tigen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MSA2269637</a> ).  H√§ufig ist das DLL-Suchverzeichnis das Arbeitsverzeichnis des Programms, sodass Angreifer die Quell-DLL durch eine b√∂swillige mit demselben Dateinamen ersetzen k√∂nnen. <br>  Remote-Angriffe auf DLL-Suchen k√∂nnen ausgef√ºhrt werden, wenn das Programm sein aktuelles Verzeichnis in einem Remote-Verzeichnis installiert, z. B. einer Netzwerkfreigabe.  Au√üerdem k√∂nnen Angreifer die Methode zum Suchen und Laden von DLLs direkt √§ndern, indem sie .manifest- oder .local-Dateien ersetzen, die DLL-Suchparameter beschreiben.  Wenn das angegriffene Programm mit einem hohen Ma√ü an Berechtigungen arbeitet, wird die von ihm geladene sch√§dliche DLL auch mit hohen Rechten ausgef√ºhrt.  In diesem Fall kann die Technik verwendet werden, um die Berechtigungen des Benutzers f√ºr den Administrator oder das System zu erh√∂hen. <br><br>  Schutzempfehlungen <i>:</i> Verhindern Sie das Laden von Remote-DLLs (standardm√§√üig in Windows Server 2012+ aktiviert und mit Updates f√ºr XP + und Server 2003+ verf√ºgbar).  Aktiviert den sicheren Suchmodus f√ºr DLLs, wodurch <i>Suchverzeichnisse</i> auf Verzeichnisse wie <i>% SYSTEMROOT% beschr√§nkt werden,</i> bevor eine DLL-Suche im aktuellen Anwendungsverzeichnis durchgef√ºhrt wird. <br>  Aktivieren des sicheren DLL-Suchmodus: <br>  <i>Computerkonfiguration&gt; [Richtlinien]&gt; Administrative Vorlagen&gt; MSS (Legacy): MSS: (SafeDllSearchMode) Aktivieren Sie den sicheren DLL-Suchmodus.</i> <br>  Entsprechender Registrierungsschl√ºssel: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br><br>  √úberlegen Sie, ob Sie ein gesch√ºtztes System pr√ºfen m√∂chten, um DLL-M√§ngel mithilfe von Tools wie PowerUP in PowerSploit zu beheben.  Vergessen Sie nicht, sch√§dliche und potenziell gef√§hrliche Software zu blockieren und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Empfehlungen von Microsoft zu befolgen</a> . <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abfangen der Dylib-Suche (Dylib-Hijacking)</a> </h3><br>  <i>System:</i> macOS <br>  <i>Rechte:</i> Benutzer <br>  Beschreibung: Die Technik basiert auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schwachstellen in den Suchalgorithmen der dynamischen Dylib-Bibliothek unter MacOS und OS X.</a>  Unter dem Strich wird die von der angegriffenen Anwendung geladene Dylib ermittelt und anschlie√üend die b√∂sartige Version der gleichnamigen Dylib im Arbeitsverzeichnis der Anwendung abgelegt.  Dadurch l√§dt die Anwendung dylib, das sich im Arbeitsverzeichnis des Programms befindet.  In diesem Fall wird die b√∂swillige Dylib mit den Zugriffsrechten der angegriffenen Anwendung ausgef√ºhrt. <br><br>  Sicherheitstipps <i>:</i> Verhindern Sie, dass Benutzer Dateien in Dylib-Suchverzeichnisse schreiben.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberpr√ºfen Sie</a> Schwachstellen mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dylib Hijacking Scanner</a> von Objective-See. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausbeutung f√ºr die Eskalation von Privilegien</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Rechte:</i> Benutzer <br>  <i>Beschreibung:</i> Gegner k√∂nnen die Berechtigungen im angegriffenen System mithilfe von Sicherheitsl√ºcken in der Software erh√∂hen. <br><br>  <i>Schutzempfehlungen:</i> Regelm√§√üige Software-Updates auf allen gesch√ºtzten Arbeitsstationen, Servern, Netzwerkger√§ten und anderen Ger√§ten, die mit dem gesch√ºtzten Netzwerk verbunden sind.  Analysieren Sie die Arten von Bedrohungen, Schwachstellen und Exploit-Programmen, die f√ºr die gesch√ºtzte Organisation verwendet werden k√∂nnen.  Exploit-Schutzsysteme wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Windows Defender Exploit Guard (WDEG)</a> f√ºr Windows 10 oder das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Enhanced Mitigation Experience Toolkit (EMET)</a> f√ºr fr√ºhere Windows-Versionen werden ebenfalls empfohlen. <br><br>  h3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EWM-Injektion (Extra Window Memory Injection)</a> <br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator, System <br>  <i>Beschreibung: Die</i> Technik ist der Missbrauch von zus√§tzlichem Windows-Fensterspeicher, dem sogenannten Extra Window Memory (EWM).  Die EWM-Gr√∂√üe betr√§gt 40 Byte, eignet sich zum Speichern eines 32-Bit-Zeigers und wird h√§ufig verwendet, um einen Verweis auf Prozeduren anzugeben.  Schadprogramme w√§hrend der Angriffskette k√∂nnen einen Zeiger auf Schadcode im EWM platzieren, der anschlie√üend vom infizierten Anwendungsprozess gestartet wird. <br><br>  <i>Schutzempfehlungen:</i> Da EWM-Injektionstechniken auf dem Missbrauch von Betriebssystementwicklungsfunktionen beruhen, sollten Schutzbem√ºhungen darauf gerichtet sein, den Start von Schadprogrammen und Schadwerkzeugen zu verhindern.  Es wird empfohlen, potenziell gef√§hrliche Software mithilfe von AppLocker, Whitelist-Anwendungen oder Richtlinien zur Einschr√§nkung von Software zu identifizieren und zu blockieren. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nachteile von Berechtigungen auf Dateisystemebene (Schw√§che der Dateisystemberechtigungen)</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Benutzer, Administrator <br>  <i>Beschreibung:</i> Das Wesentliche der Technik ist das Ersetzen von ausf√ºhrbaren Dateien, die automatisch von verschiedenen Prozessen gestartet werden (z. B. beim Hochfahren des Betriebssystems oder zu einem bestimmten Zeitpunkt, wenn die Rechte an den ausf√ºhrbaren Dateien falsch konfiguriert sind).  Nach dem Spoofing wird die sch√§dliche Datei mit den Prozessrechten gestartet. Wenn der Prozess also eine h√∂here Zugriffsebene hat, kann der Angreifer die Berechtigungen eskalieren.  Bei dieser Technik k√∂nnen Angreifer versuchen, die Windows-Dienst-Bin√§rdateien zu manipulieren. <br>  Eine andere Variante des Angriffs ist mit den M√§ngeln der Algorithmen bei der Arbeit selbstextrahierender Installateure verbunden.  W√§hrend des Installationsvorgangs entpacken Installationsprogramme h√§ufig verschiedene n√ºtzliche Dateien, einschlie√ülich DLL und EXE, in das Verzeichnis% TEMP%. Sie legen jedoch m√∂glicherweise nicht die entsprechenden Berechtigungen fest, um den Zugriff auf die entpackten Dateien einzuschr√§nken, wodurch Angreifer das Spoofing von Dateien durchf√ºhren k√∂nnen. Erh√∂hen Sie daher die Berechtigungen oder umgehen Sie die Kontokontrolle  Einige Installationsprogramme werden mit erweiterten Berechtigungen ausgef√ºhrt. <br><br>  <i>Schutzempfehlungen:</i> Beschr√§nken Sie die Kontoberechtigungen so, dass nur Administratoren Dienste verwalten und mit den von den Diensten verwendeten Bin√§rdateien interagieren k√∂nnen.  Deaktivieren Sie die Eskalationsoptionen f√ºr UAC-Berechtigungen f√ºr Standardbenutzer.  UAC-Einstellungen werden im folgenden Registrierungsschl√ºssel gespeichert: <br><ul><li>  <i>[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</i> . </li></ul><br>  Um Anforderungen zur Eskalation von Berechtigungen automatisch abzulehnen, m√ºssen Sie einen Schl√ºssel hinzuf√ºgen: <br><ul><li>  <i>"ConsentPromptBehaviorUser" = dword: 00000000.</i> </li></ul><br>  Um die Arbeit der Installateure zu steuern, m√ºssen Sie einen Schl√ºssel hinzuf√ºgen: <br><ul><li>  <i>"EnableInstallerDetection" = dword: 00000001</i> , f√ºr dessen Installation ein Kennwort erforderlich ist. </li></ul><br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abfangen von Windows API-Funktionsaufrufen (Hooking)</a> </h3><br>  <i>System:</i> Windows <br>  <i>Rechte:</i> Administrator, System <br>  <i>Beschreibung:</i> Windows-API-Funktionen werden normalerweise in DLLs gespeichert.  Die Technik des Hookens besteht darin, Aufrufe an API-Funktionen umzuleiten, indem: <br><ul><li>  Hook-Prozeduren - in das Betriebssystem integrierte Prozeduren, die Code ausf√ºhren, wenn verschiedene Ereignisse aufgerufen werden, z. B. Tastenanschl√§ge oder Bewegen der Maus. </li><li>  √Ñnderungen an der Adresstabelle (IAT), in der Zeiger auf API-Funktionen gespeichert sind.  Auf diese Weise k√∂nnen Sie die angegriffene Anwendung ‚Äûaustricksen‚Äú und eine b√∂swillige Funktion starten. </li><li>  Direkte Funktions√§nderung (Splei√üen), bei der die ersten 5 Bytes der Funktion ge√§ndert werden, stattdessen wird der √úbergang zu einer vom Angreifer bestimmten b√∂swilligen oder anderen Funktion eingef√ºgt. </li></ul><br>  Wie bei Injektionen k√∂nnen Angreifer mithilfe von Hooking sch√§dlichen Code ausf√ºhren, dessen Ausf√ºhrung maskieren, auf den Speicher des angegriffenen Prozesses zugreifen und die Berechtigungen erh√∂hen.  Angreifer k√∂nnen API-Aufrufe erfassen, die Parameter enthalten, die Authentifizierungsdaten enthalten.  Das Hooking wird normalerweise von Rootkits verwendet, um b√∂swillige Aktivit√§ten im System zu verbergen. <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen: Das</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abfangen von Ereignissen im Betriebssystem ist Teil des normalen Betriebs des Systems. Daher kann jede Einschr√§nkung dieser Funktionalit√§t die Stabilit√§t legitimer Anwendungen wie Antivirensoftware beeintr√§chtigen. </font><font style="vertical-align: inherit;">Die Bem√ºhungen, den Einsatz von Abfangtechniken zu verhindern, m√ºssen sich auf die fr√ºheren Phasen der Angriffskette konzentrieren. </font><font style="vertical-align: inherit;">Sie k√∂nnen b√∂swillige Hooking-Aktivit√§ten erkennen, indem Sie Aufrufe der Funktionen SetWindowsHookEx und SetWinEventHook √ºberwachen, Rootkit-Detektoren verwenden und anomales Verhalten von Prozessen analysieren.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IFEO-Injektion (Injection der Ausf√ºhrungsoptionen f√ºr Bilddateien)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, </font><font style="vertical-align: inherit;">Systembeschreibung </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mit dem IFEO-Mechanismus (Image File Execution Options) k√∂nnen Sie einen Programmdebugger anstelle eines Programms ausf√ºhren, das zuvor vom Entwickler in der Registrierung angegeben wurde:</font></font><br><ul><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Ausf√ºhrungsoptionen f√ºr Image-Dateien / [ausf√ºhrbare Datei]</font></font></i> </li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKLM \ SOFTWARE \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Ausf√ºhrungsoptionen f√ºr Image-Dateien \ [ausf√ºhrbare Datei]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wobei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ausf√ºhrbare Datei]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die ausf√ºhrbare Bin√§rdatei des Debuggers ist.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wie bei Injektionen kann der Wert </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ausf√ºhrbare Datei]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> missbraucht werden, indem beliebiger Code ausgef√ºhrt wird, um die Berechtigungen zu erh√∂hen oder im System Fu√ü zu fassen. Sch√§dliche Programme k√∂nnen IFEO verwenden, um den Schutz zu umgehen, indem sie Debugger registrieren, die verschiedene System- und Sicherheitsanwendungen umleiten und ablehnen. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen: Die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beschriebene Technik basiert auf dem Missbrauch regul√§rer Betriebssystementwicklungstools. Daher k√∂nnen Einschr√§nkungen zu Instabilit√§t legitimer Software f√ºhren, z. B. Sicherheitsanwendungen. Die Bem√ºhungen, die Verwendung von IFEO-Injektionstechniken zu verhindern, m√ºssen sich auf die fr√ºheren Stadien der Angriffskette konzentrieren. Sie k√∂nnen einen solchen Angriff erkennen, indem Sie Prozesse mit </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font><i><font style="vertical-align: inherit;">√ºberwachen</font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debug_only_this_process</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daemon starten (Daemon starten)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;</font></font></h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung: Die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Technik besteht darin, die Parameter der Systemstartdienste - Launch Daemon, die in den Plist-Dateien angegeben sind, vom Angreifer zu √§ndern. </font><font style="vertical-align: inherit;">Beim Systemstart l√§dt der Launchd-Prozess die Parameter von Diensten (Daemons) aus Plist-Dateien in den folgenden Verzeichnissen:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / System / Library / LaunchDeamons; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / Library / LaunchDeamons. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Launch Daemon kann mit Administratorrechten erstellt, aber unter dem Root-Konto ausgef√ºhrt werden, sodass ein Angreifer die Berechtigungen eskalieren kann. </font><font style="vertical-align: inherit;">Die Berechtigungen der plist-Dateien m√ºssen root sein. Das darin angegebene Skript oder Programm verf√ºgt jedoch m√∂glicherweise √ºber weniger strenge Berechtigungen. </font><font style="vertical-align: inherit;">Daher kann ein Angreifer die in plist angegebenen ausf√ºhrbaren Dateien und damit die aktuellen Systemdienste √§ndern, um das System zu sichern oder Berechtigungen zu eskalieren. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheitstipps:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beschr√§nken Sie die Benutzerrechte, damit nur autorisierte Administratoren den Startd√§mon erstellen k√∂nnen. </font><font style="vertical-align: inherit;">√úberwachen Sie mit Anwendungen wie KnockKnock, wie Plist-Dateien auf Ihrem System erstellt werden.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neue Dienste</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows- </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, </font><font style="vertical-align: inherit;">Systembeschreibung </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benennen Sie den Zugriff auf das System. Angreifer k√∂nnen neue Dienste erstellen und diese so konfigurieren, dass sie automatisch gestartet werden. </font><font style="vertical-align: inherit;">Der Dienstname kann mit betriebssystemspezifischen Namen maskiert werden. </font><font style="vertical-align: inherit;">Dienste k√∂nnen mit Administratorrechten erstellt, aber im Auftrag des Systems ausgef√ºhrt werden. </font><font style="vertical-align: inherit;">Dienste k√∂nnen √ºber die Befehlszeile mithilfe von RAS-Tools mit Interoperabilit√§t mit der Windows-API oder mithilfe von Standard-Windows- und PowerShell-Verwaltungstools erstellt werden. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheitsempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beschr√§nken Sie die Benutzerrechte zum Erstellen neuer Dienste, sodass dies nur autorisierten Administratoren m√∂glich ist. </font><font style="vertical-align: inherit;">Wenden Sie die AppLocker- und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Softwareeinschr√§nkungsrichtlinie an</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pfadabfangen</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows- </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer, Administrator, System </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung: Beim</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abfangen eines Pfads wird die ausf√ºhrbare Datei in einem Verzeichnis abgelegt, von dem aus die Anwendung sie anstelle der Zieldatei startet. </font><font style="vertical-align: inherit;">Ein Angreifer kann die folgenden Methoden anwenden:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicht vorhandene Pfade. </font><font style="vertical-align: inherit;">Die Pfade zu den ausf√ºhrbaren Dateien des Dienstes werden in den Registrierungsschl√ºsseln gespeichert und k√∂nnen einen oder mehrere Leerzeichen enthalten, z. B. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Programme \ service.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wenn der Angreifer die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ Program.exe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> im System erstellt </font><font style="vertical-align: inherit;">, wird sie von Windows gestartet, anstatt den Pfad zu verarbeiten Service-Zieldatei.</font></font></li><li>    .    PATH  <i>C:\example</i>  <i>c:\Windows\System32</i>    <i>C:\example\net.exe</i> ,     net,   <i>C:\example\net.exe</i> ,   <i>c:\Windows\System32\net.exe</i> . </li><li>    (Search order hijacking).        , Windows,  ,        ,      . ,  ¬´example.exe¬ª    cmd.exe      net use.       example.exe  net.exe       <i>c:\Windows\System32\net.exe</i> .  ,     net.com     net.exe,  Windows  net.com     ,     PATHEXT. </li></ul><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Abfangen der Dateisuchreihenfolge wird auch zum Ausf√ºhren von DLLs mithilfe der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Search Hijacking DLL-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Technik verwendet </font><font style="vertical-align: inherit;">. </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheitsempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anf√ºhrungszeichen geben Pfade an, die in Konfigurationsdateien, Skripten, der PATH-Variablen, Diensteinstellungen und Verkn√ºpfungen angegeben sind. </font><font style="vertical-align: inherit;">Beachten Sie die Suchreihenfolge der ausf√ºhrbaren Dateien und verwenden Sie nur vollst√§ndige Pfade. </font><font style="vertical-align: inherit;">Bereinigen Sie die alten Registrierungsschl√ºssel, die von der Remote-Software √ºbrig geblieben sind, sodass in der Registrierung keine Schl√ºssel mehr vorhanden sind, die auf nicht vorhandene Dateien verweisen. </font><font style="vertical-align: inherit;">Richten Sie ein Schreibverbot f√ºr Benutzer des Systems in das Stammverzeichnis C: \ und in die Windows-Systemverzeichnisse ein und beschr√§nken Sie die Schreibberechtigungen auf Verzeichnisse mit ausf√ºhrbaren Dateien.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñnderung von Plist-Dateien (Plist-√Ñnderung)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer, Administrator </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angreifer k√∂nnen plist-Dateien √§ndern und in ihnen ihren eigenen Code f√ºr die Ausf√ºhrung im Kontext eines anderen Benutzers angeben. </font><font style="vertical-align: inherit;">Die plist-Eigenschaftendateien in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden mit erh√∂hten Berechtigungen ausgef√ºhrt, und die plist aus </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">~ / Library / Preferences</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> werden mit Benutzerberechtigungen ausgef√ºhrt. </font><font style="vertical-align: inherit;">Sicherheitstipps </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Verhindern Sie, dass Plist-Dateien ge√§ndert werden, indem Sie sie schreibgesch√ºtzt machen.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñnderung von Port-Monitoren im Print Manager (Port-Monitore)</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows- </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systembeschreibung: Ein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angreifer kann die Ausf√ºhrung einer beliebigen DLL im Namen des Systems bei jedem Start von Windows unter Missbrauch der Print Manager-Einstellungen (Spoolsv.exe) organisieren. F√ºr die Interaktion mit Druckger√§ten verwendet Spoolsv.exe die sogenannten Port-Monitore. Hierbei handelt es sich um DLL-Bibliotheken, die Befehle auf niedriger Ebene verwenden, um √ºber LAN, USB, LPT oder COM-Schnittstelle an Druckger√§te gesendet zu werden. Die oben genannten DLLs werden in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C: \ windows \ system32</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gespeichert </font><font style="vertical-align: inherit;">und in der Registrierung registriert: </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Print \ Monitors</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Port Monitor kann mithilfe der AddMonitor-API oder direkt durch Bearbeiten des obigen Registrierungsschl√ºssels installiert werden. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Organisieren Sie das Blockieren potenziell gef√§hrlicher Software und verwenden Sie Tools zur Steuerung des Anwendungsstarts.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code-Injektion in einen Prozess (Prozess-Injektion), </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zehn Prozess-Injektionstechniken</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows, Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer, Administrator, System, Root </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung: Die</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prozessinjektion ist eine Methode zum Ausf√ºhren von beliebigem Code im Adressraum eines separaten lebenden Prozesses. Durch Ausf√ºhren von Code im Kontext eines anderen Prozesses k√∂nnen Sie auf den Speicher des injizierten Prozesses, auf System- / Netzwerkressourcen und m√∂glicherweise auf erh√∂hte Berechtigungen zugreifen. Prozessinjektionen k√∂nnen auch verwendet werden, um eine m√∂gliche Erkennung b√∂swilliger Aktivit√§ten durch Sicherheitsma√ünahmen zu vermeiden. Techniken zum Implementieren von Injektionen in Prozesse basieren auf dem Missbrauch verschiedener Mechanismen, die ein Multithreading der Programmausf√ºhrung im Betriebssystem sicherstellen. Im Folgenden finden Sie einige Ans√§tze zum Einf√ºgen von Code in einen Prozess.</font></font><br><br>  <b>Windows</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ DLL-Injektionen. Sie werden ausgef√ºhrt, indem der Pfad zur sch√§dlichen DLL innerhalb des Prozesses geschrieben und dann ausgef√ºhrt wird, indem ein Remote-Thread erstellt wird (Remote-Thread - ein Thread, der im virtuellen Adressraum eines anderen Prozesses ausgef√ºhrt wird). Mit anderen Worten, die Malware schreibt die DLL auf die Festplatte und verwendet dann eine Funktion wie CreateRemoteTread, die die LoadLibrary-Funktion im injizierten Prozess aufruft. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ PE-Injektionen (Portable Executeable Injection) basieren auf dem Missbrauch von Speicherausf√ºhrungsfunktionen von PE-Dateien wie DLL oder EXE. Sch√§dlicher Code wird in den Prozess geschrieben, ohne dass Dateien auf die Festplatte geschrieben werden. Anschlie√üend wird die Ausf√ºhrung mithilfe des zus√§tzlichen Codes oder durch Erstellen eines Remote-Streams aufgerufen.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Beim Hijacking der Thread-Ausf√ºhrung werden sch√§dlicher Code oder DLL-Pfade direkt in den Prozessthread eingef√ºgt. Wie bei der Process Hollowing-Technik muss der Durchfluss zuerst unterbrochen werden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Bei der Injektion in eine APC-Injektion (Asynchronous Procedure Call) wird b√∂sartiger Code in die APC-Warteschlange eines Prozessthreads eingebettet. Eine der Methoden der APC-Injektion, die als ‚ÄûEarle Bird-Injektion‚Äú bezeichnet wird, umfasst die Erstellung eines angehaltenen Prozesses, in dem b√∂sartiger Code geschrieben und √ºber APC zum Prozesseintrittspunkt gestartet werden kann. AtomBombing ist eine weitere Injection-Option, die APC verwendet, um b√∂sartigen Code aufzurufen, der zuvor in die globale Atomtabelle geschrieben wurde.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Bei TLS-Injektionen (Thread Local Storage) werden Speicherzeiger in einer ausf√ºhrbaren PE-Datei bearbeitet, um den Prozess auf sch√§dlichen Code umzuleiten. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mac und Linux</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Ä¢ Mit den Systemvariablen LD_RPELOAD, LD_LIBRARY_PATH (Linux), DYLIB_INSERT_LIBRARIES (macOS X) oder der dlfcn-Anwendungsprogrammierschnittstelle (API) kann eine Bibliothek (gemeinsam genutztes Objekt) dynamisch in einen Prozess geladen werden, von dem aus wiederum API-Aufrufe abgefangen werden k√∂nnen Prozesse ausf√ºhren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Der Ptrace-Systemaufruf kann verwendet werden, um eine Verbindung zu einem laufenden Prozess herzustellen und ihn zu √§ndern, w√§hrend er ausgef√ºhrt wird.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ / proc / [pid] / mem bietet Zugriff auf den Prozessspeicher und kann zum Lesen / Schreiben beliebiger Daten verwendet werden. Diese Methode wird jedoch aufgrund der Komplexit√§t ihrer Implementierung selten verwendet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Mit der VDSO-Erfassung (Virtual Dynamic Shared Object) k√∂nnen Sie Code einf√ºgen, w√§hrend Sie ELF-Bin√§rdateien ausf√ºhren, indem Sie die Code-Stubs von linux-vdso.so bearbeiten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sch√§dliche Programme verwenden normalerweise die Code-Injektion in einen Prozess, um auf Systemressourcen zuzugreifen. Dadurch kann ein Angreifer im System Fu√ü fassen und andere √Ñnderungen in der angegriffenen Umgebung vornehmen. Komplexere Proben k√∂nnen mehrere Prozessinjektionen durchf√ºhren, um die Erkennung zu erschweren. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methoden zum Einf√ºgen von Code in Prozesse basieren auf dem Missbrauch regul√§rer Betriebssystemfunktionen, die sich direkt auf den instabilen Betrieb legitimer Software und Sicherheitsprodukte auswirken k√∂nnen. </font><font style="vertical-align: inherit;">Die Bem√ºhungen, den Einsatz von Abfangtechniken zu verhindern, m√ºssen sich auf die fr√ºheren Phasen der Angriffskette konzentrieren. </font><font style="vertical-align: inherit;">Verwenden Sie Tools, um potenziell gef√§hrliche Software wie AppLocker zu blockieren. </font><font style="vertical-align: inherit;">Verwenden Sie Yama als vorbeugende Ma√ünahme gegen Code-Injection in ptrace und beschr√§nken Sie die Verwendung von ptrace nur auf privilegierte Benutzer. </font><font style="vertical-align: inherit;">Zus√§tzliche Sicherheitsma√ünahmen k√∂nnen die Bereitstellung von Kernel-Sicherheitsmodulen umfassen, die eine erweiterte Zugriffskontrolle und Prozessbeschr√§nkung bieten. </font><font style="vertical-align: inherit;">Zu diesen Tools geh√∂ren SELinux, grsecurity und AppArmor.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SID-Verlaufsinjektion</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, System </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Immer wenn ein Objekt von einer Dom√§ne in eine andere verschoben wird, wird eine neue SID erstellt, die zur Hauptobjekt-ID wird. Fr√ºhere SIDs werden weiterhin in der Eigenschaft sIDHistory gespeichert, wodurch sichergestellt wird, dass die Rechte, die das Objekt vor der dom√§nen√ºbergreifenden Migration hatte, erhalten bleiben. Angreifer mit Administratorrechten k√∂nnen zuvor gesammelte SIDs in den SID-Verlauf einf√ºgen, um eine Aktion f√ºr privilegiertere Zugriffsgruppen oder Konten wie Dom√§nenadministratoren auszuf√ºhren. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unter Windows Server OS Version 2003 und h√∂her ist die SID-Filterung standardm√§√üig aktiviert. Dabei werden alle SIDs mit Ausnahme einer vertrauensw√ºrdigen Dom√§ne gel√∂scht oder gefiltert. Diese Option kann jedoch absichtlich deaktiviert werden, um den dom√§nen√ºbergreifenden Zugriff zu erm√∂glichen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die wichtigsten Methoden zum Filtern der SID: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Deaktivieren von SIDHistory in den Vertrauenseinstellungen (Vertrauensstellungen) zwischen Dom√§nengesamtstrukturen mit dem folgenden Befehl: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netdom trust / domain: / EnableSIDHistory: no</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Anwendung der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SID-Filterquarant√§ne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dadurch wird sichergestellt, dass sich ein Objekt, das eine andere SID als die vertrauensw√ºrdige Dom√§ne enth√§lt, nicht bei der vertrauensw√ºrdigen Dom√§ne authentifizieren kann. Die SID-Filter-Quarant√§ne wird durch Ausf√ºhren des folgenden Befehls auf externe Vertrauensstellungen angewendet:</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Netdom Trust / Domain: / Quarant√§ne: Ja</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Verwendung der SID-Filterung zwischen Dom√§nen in derselben Gesamtstruktur wird nicht empfohlen. </font><font style="vertical-align: inherit;">Wenn die Dom√§ne in der Gesamtstruktur unzuverl√§ssig ist, sollte sie kein Mitglied der Gesamtstruktur sein. In einer solchen Situation m√ºssen Sie zuerst die vertrauensw√ºrdigen und unzuverl√§ssigen Dom√§nen in separate Gesamtstrukturen aufteilen und dann die SID-Filterung f√ºr Vertrauensstellungen zwischen Gesamtstrukturen anwenden.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geplante Aufgabe</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows- </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer, Administrator, </font><font style="vertical-align: inherit;">Systembeschreibung </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dienstprogramme wie at, schtasks und der Windows-Taskplaner k√∂nnen verwendet werden, um Programme und Skripts so zu planen, dass sie zu einem bestimmten Datum und einer bestimmten Uhrzeit ausgef√ºhrt werden. Eine Aufgabe kann auf einem Remote-System geplant werden, vorausgesetzt, RPC wird zur Authentifizierung verwendet und die Drucker- und Dateifreigabe ist aktiviert. Das Planen von Aufgaben auf einem Remote-System erfordert Administratorrechte. Ein Angreifer kann die Remotecodeausf√ºhrung verwenden, um Systemberechtigungen zu erlangen oder einen Prozess unter einem bestimmten Konto zu starten. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzerrechte einschr√§nken. </font><font style="vertical-align: inherit;">Die Verwendung von Tools wie dem PowerUP-Modul in PowerSploit, mit denen Schwachstellen bei der L√∂sung geplanter Aufgaben gefunden werden k√∂nnen. </font><font style="vertical-align: inherit;">Deaktivieren der M√∂glichkeit, Aufgaben im Namen des Systems zu starten, Deaktivieren der Option " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Serverbetreibern erlauben, Aufgaben zu planen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font><font style="vertical-align: inherit;">in der Sicherheitsrichtlinie </font><font style="vertical-align: inherit;">und Aktivieren der Einstellung " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuweisung von Benutzerrechten: Erh√∂hen der Planungspriorit√§t</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schwachstellen in den Berechtigungen f√ºr Serviceregistrierungen Schwachstellen</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Windows- </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator, </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Systembeschreibung:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wenn die Berechtigungen von Benutzern und Gruppen das √Ñndern der Werte von Schl√ºsseln erm√∂glichen, in denen die Dienstparameter in der Windows-Registrierung gespeichert sind, k√∂nnen Angreifer die Schl√ºssel, in denen die Pfade zu ausf√ºhrbaren Dateien zum Starten von Diensten gespeichert sind, direkt √§ndern oder verschiedene Verwaltungstools verwenden Dienste - sc.exe, PowerShell oder Reg. Angreifer k√∂nnen auch Parameter √§ndern, die sich auf einen Dienstfehler beziehen, z. B. FailureCommand, und einen Befehl angeben, der im Falle eines Dienstfehlers oder einer vors√§tzlichen Besch√§digung ausgef√ºhrt wird. Dienstparameter werden in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ services</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gespeichert </font><font style="vertical-align: inherit;">. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie sicher, dass Benutzer des gesch√ºtzten Systems keine Schl√ºssel in der Registrierung √§ndern k√∂nnen, in denen die Parameter der Systemkomponenten gespeichert sind. </font><font style="vertical-align: inherit;">Verwenden Sie alle m√∂glichen Mittel zum Blockieren potenziell gef√§hrlicher Software, z. B. Windows AppLocker.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid und Setgid</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setuid und Setgid sind Berechtigungsflags auf Unix-Systemen, mit denen der Benutzer ausf√ºhrbare Dateien mit den Rechten des Eigent√ºmers oder der Gruppe der ausf√ºhrbaren Datei ausf√ºhren kann. Wenn die Anwendung als root ausgef√ºhrt werden muss, kann der Benutzer anstelle eines Eintrags in der sudo-Datei das Flag Setuid oder Setgid angeben. Gegner k√∂nnen die Flags Setuid und Setgid missbrauchen, um ein Shell-Escape auszuf√ºhren (wenn eine Konsolenanwendung die in einer anderen Anwendung ge√∂ffnete Datei verwendet) oder die Sicherheitsanf√§lligkeit der Anwendung mit den Flags Setuid und Setgid ausnutzen und Code im Kontext verschiedener Benutzer ausf√ºhren. Wenn Sie die Dateiattribute mit dem Befehl ls -l anzeigen, werden die obigen Flags durch das Symbol "s" anstelle von "x" angezeigt. Das Dienstprogramm chmod kann die Flags Setuid und Setgid mit dem </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Befehl chmod 4777 [file] setzen.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chmod u + s [Datei]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schutzempfehlungen:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Halten Sie die Anzahl der Programme mit den Flags Setuid und Setgid auf ein Minimum.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Startelemente</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Administrator </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung: Ein</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Angreifer kann den veralteten, aber immer noch ausgef√ºhrten macOS Sierra-Mechanismus zum automatischen Starten von Anwendungen mithilfe von StartupItems verwenden, um den Start seines Codes mit Root-Rechten beim Start zu konfigurieren. </font><font style="vertical-align: inherit;">StartupItems ist ein Verzeichnis in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ein Befehlsskript und die Eigenschaftendatei StartupParameters.plist. </font><font style="vertical-align: inherit;">Die Skript- und Eigenschaftendatei muss sich oben in der Hierarchie befinden: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ Library / Startupitems / [MyStartupItem]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Schutzempfehlungen </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Da der StartupItems-Mechanismus veraltet ist, k√∂nnen Sie durch das Verbot des Schreibens in das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verzeichnis / Library / Startupitems /</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> das Erstellen von </font><i><font style="vertical-align: inherit;">Startelementen</font></i><font style="vertical-align: inherit;"> vermeiden.</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudo</font></font></a> </h3><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Linux, macOS </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechte:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beschreibung:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gegner k√∂nnen Sudo-Konfigurationsfehler ausnutzen, um Befehle f√ºr andere Benutzer auszuf√ºhren oder Prozesse mit h√∂heren Berechtigungen zu erzeugen. Sudo-Optionen werden in der </font><font style="vertical-align: inherit;">Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / sudoers</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gespeichert. Zum Bearbeiten dieser Datei sind erh√∂hte Berechtigungen erforderlich. In der sudoers-Datei wird beschrieben, welche Befehle Benutzer f√ºr andere Benutzer oder Gruppen ausf√ºhren k√∂nnen. Auf diese Weise k√∂nnen Benutzer die meiste Zeit mit minimalen Berechtigungen arbeiten und die Berechtigungen nur bei Bedarf erh√∂hen. In der sudoers-Datei k√∂nnen Sie jedoch Benutzer angeben, f√ºr die kein Kennwort angefordert wird: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzername ALL = (ALL) NOPASSWD: ALL</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sicherheitstipps:</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die sudoers-Datei sollte so bearbeitet werden, dass Benutzer bei der Ausf√ºhrung von sudo immer ein Kennwort eingeben. </font><font style="vertical-align: inherit;">Auditd unter Linux kann eine Warnung generieren, wenn die tats√§chlichen und effektiven Benutzer-IDs nicht √ºbereinstimmen (dies geschieht, wenn der Benutzer sudo verwendet).</font></font><br><br><h3> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sudo-Caching</font></font></a> </h3><br>  <i>System:</i> Linux, MacOS <br>  <i>Rechte:</i> Benutzer <br>  <i>Beschreibung:</i> Verschiedene Malware-Programme wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><i>OCX Proton Malware</i></a> k√∂nnen Sudo-Einstellungen missbrauchen, um Code als Root auszuf√ºhren, ohne ein Kennwort einzugeben.  Da das sudo-Toolkit f√ºr die Systemadministration erstellt wurde, verf√ºgt es √ºber einige n√ºtzliche Funktionen wie <i>timestamp_timeout.</i> Dieser Parameter speichert die Zeit in Minuten zwischen den sudo-Starts, in denen der Befehl nicht zur Eingabe des Root-Kennworts auffordert.  Sudo kann seit einiger Zeit Anmeldeinformationen zwischenspeichern.  Der Zeitstempel des letzten Starts von Sudo wird in <i>/ var / db / sudo</i> gespeichert und zur Bestimmung des angegebenen Zeitlimits verwendet.  Dar√ºber hinaus gibt es eine Variable <i>tty_tickets</i> , die jede neue Terminalsitzung isoliert verarbeitet, sodass ein Zeitlimit in einer Instanz der Konsole das Zeitlimit in einer anderen Instanz nicht beeinflusst. <br><br>  <i>Schutzempfehlungen:</i> Setzen Sie den Parameter <i>timestamp_timeout = 0</i> so, dass das System bei jeder Ausf√ºhrung von sudo ein Root-Passwort ben√∂tigt.  <i>Aktivieren Sie den</i> Parameter <i>tty_tickets</i> , um zu verhindern, dass der Angriff √ºber Befehlszeilensitzungen implementiert wird. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">G√ºltige Konten</a> </h3><br>  <i>Beschreibung:</i> Angreifer k√∂nnen die Anmeldeinformationen eines bestimmten Benutzers oder Dienstkontos mithilfe der Zugriffstechniken f√ºr Anmeldeinformationen stehlen und die Anmeldeinformationen w√§hrend des Intelligenzprozesses mithilfe von Social Engineering erfassen.  Kompromittierte Anmeldeinformationen k√∂nnen verwendet werden, um Zugriffskontrollsysteme zu umgehen und Zugriff auf Remotesysteme und externe Dienste wie VPN, OWA, Remotedesktop zu erhalten oder um erh√∂hte Berechtigungen f√ºr bestimmte Systeme und Bereiche des Netzwerks zu erhalten.  Wenn das Szenario erfolgreich ist, k√∂nnen Angreifer Malware ablehnen, um die Erkennung zu erschweren.  Au√üerdem k√∂nnen Angreifer Konten mit vordefinierten Namen und Kennw√∂rtern erstellen, um den Sicherungszugriff aufrechtzuerhalten, falls erfolglos versucht wird, andere Mittel zu verwenden. <br><br>  <i>Schutzempfehlungen:</i> Wenden Sie eine Kennwortrichtlinie an und befolgen Sie die Empfehlungen zum Entwerfen und Verwalten eines Unternehmensnetzwerks, um die Verwendung privilegierter Konten auf allen Verwaltungsebenen einzuschr√§nken.  Regelm√§√üige √úberpr√ºfungen von Dom√§nen- und lokalen Konten und deren Rechten, um diejenigen zu identifizieren, die einem Angreifer einen umfassenden Zugriff erm√∂glichen k√∂nnten.  √úberwachung der Kontoaktivit√§t mithilfe von SIEM-Systemen. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Web-Shell</a> </h3><br>  <i>System:</i> Windows, Linux, MacOS <br>  <i>Beschreibung:</i> Web Shell kann von einem Angreifer als Gateway f√ºr den Zugriff auf Ihr Netzwerk oder als redundanten Zugriff auf das angegriffene System verwendet werden, als Sicherungsmechanismus f√ºr die Sicherung im Falle der Erkennung und Blockierung der Hauptzugriffskan√§le f√ºr die angegriffene Umgebung. <br><br>  <i>Schutzempfehlungen:</i> Stellen Sie sicher, dass Ihre externen Webserver regelm√§√üig aktualisiert werden und keine bekannten Sicherheitsl√ºcken bekannt sind, durch die Angreifer eine Datei oder ein Skript bei der anschlie√üenden Ausf√ºhrung auf den Server hochladen k√∂nnen.  Stellen Sie sicher, dass die Berechtigungen von Konten und Gruppen mit Serververwaltungsrechten nicht mit den internen Netzwerkkonten √ºbereinstimmen, mit denen Sie sich beim Webserver anmelden, die Web-Shell starten oder eine Verbindung zum Webserver herstellen k√∂nnen.  Web Shell ist schwer zu erkennen, weil  Sie initiieren keine Verbindungen und ihr Serverteil kann klein und harmlos sein. Beispielsweise sieht die PHP-Version der China Chopper Web Shell wie eine Linie aus: <br>  <i>[? php <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">eval</a> ($ _POST ['password']);]</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428602/">https://habr.com/ru/post/de428602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428590/index.html">Mikrointeraktionen und Mikroaufforderungen in der Schnittstelle</a></li>
<li><a href="../de428592/index.html">Stellen Sie keine "effektiven Manager" mehr ein. Sie sind nicht nur nutzlos, sondern auch sch√§dlich</a></li>
<li><a href="../de428596/index.html">Elon Musk entlie√ü Starlink-Satelliten-Internet-Projektmanager wegen Nichteinhaltung der Fristen</a></li>
<li><a href="../de428598/index.html">Tiefe neuronale Netze f√ºr die automatische Anrufbewertung</a></li>
<li><a href="../de428600/index.html">SSDs mit Spezialeffekten oder was beim Modden fehlte - √úberpr√ºfung des HyperX FURY RGB-Laufwerks</a></li>
<li><a href="../de428604/index.html">Online Data Science Meisterschaft</a></li>
<li><a href="../de428606/index.html">"Das Verst√§ndnis der Funktionsweise des Systems erm√∂glichte viel Hacking": Roy Beniosef √ºber die Android-Entwicklung</a></li>
<li><a href="../de428608/index.html">Medienbeteiligungen einigten sich mit Yandex auf die Entfernung von Raubkopien</a></li>
<li><a href="../de428610/index.html">Das Paradox der Wartezeit, oder warum ist mein Bus immer zu sp√§t?</a></li>
<li><a href="../de428612/index.html">Funktionen h√∂herer Ordnung in JavaScript: Was ist das?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>