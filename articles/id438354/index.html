<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌐 ☢️ 🧑🏽 Vue, Storybook, TypeScript - memulai proyek baru dengan mengingat praktik terbaik ⚛️ 📗 ⚔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(awalnya diterbitkan di Medium ) 


 Saya suka menulis kode Bereaksi. Ini mungkin pengantar aneh untuk sebuah cerita tentang Vue, tetapi Anda perlu me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vue, Storybook, TypeScript - memulai proyek baru dengan mengingat praktik terbaik</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438354/"><p><img src="https://habrastorage.org/webt/3l/z_/hj/3lz_hjzvuh91eqfwdlcux6yluyy.png"></p><br><p>  <em>(awalnya diterbitkan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Medium</a> )</em> </p><br><p>  Saya suka menulis kode Bereaksi.  Ini mungkin pengantar aneh untuk sebuah cerita tentang Vue, tetapi Anda perlu memahami latar belakang saya untuk memahami mengapa saya di sini membahas Vue. </p><br><p>  Saya suka menulis kode Bereaksi dan saya benci membacanya.  JSX adalah ide yang rapi untuk merakit potongan-potongan bersama dengan cepat, Material-UI adalah solusi luar biasa untuk bootstrap UI startup Anda berikutnya, dengan menghitung CSS dari konstanta JS memungkinkan Anda untuk menjadi sangat fleksibel.  Namun membaca JSX lama Anda terasa mengerikan - bahkan dengan praktik peninjauan kode yang teliti, Anda mungkin akan menggaruk-garuk kepala Anda tidak sekali saja saat Anda mencoba untuk mencari komponen bersarang yang rumit. </p><br><p>  Saya telah mendengar banyak hal tentang Vue - anak yang tidak begitu baru di blok - dan saya akhirnya memutuskan untuk mengompol;  membawa semua bawaan mental saya React and Polymer (dan Angular, tapi jangan bicarakan itu). </p><a name="habracut"></a><br><p> Vue sangat mirip dengan Polymer, lebih dari itu penulis menamainya sebagai salah satu sumber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">inspirasi</a> .  Struktur file <code>*.vue</code> tampak seperti bagian terbaik dari Polymer dan saya langsung terjun.  Beberapa hari kemudian saya merangkak keluar dari rawa naskah, pengembangan yang didorong UI dan banyak praktik terbaik dan saya siap untuk membagikan apa yang saya temukan. </p><br><h2 id="lets-go">  Ayo pergi! </h2><br><p>  Kami akan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">npx</a> untuk menjalankan perintah.  Jika Anda belum memiliki npx, inilah cara mendapatkannya: <code>npm install -g npx</code> .  Npx adalah penyelamat ketika Anda berurusan dengan paket cli npm dan tidak ingin <code>npm install -g</code> lusinan aplikasi.  Anda juga akan membutuhkan Benang jika Anda belum memilikinya — <code>npm install -g yarn</code> akan membuat Anda mendapatkan informasi terbaru. </p><br><pre> <code class="plaintext hljs">$ npx vue create not-a-todo-app Vue CLI v3.3.0 ? Please pick a preset: Manually select features ? Check the features needed for your project: Babel, TS, PWA, Router, Vuex, CSS Pre-processors, Linter, Unit, E2E ? Use class-style component syntax? Yes ? Use Babel alongside TypeScript for auto-detected polyfills? Yes ? Use history mode for router? (Requires proper server setup for index fallback in production) Yes ? Pick a CSS pre-processor (PostCSS, Autoprefixer and CSS Modules are supported by default): Sass/SCSS ? Pick a linter / formatter config: TSLint ? Pick additional lint features: (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection)Lint on save ? Pick a unit testing solution: Jest ? Pick a E2E testing solution: Cypress ? Where do you prefer placing config for Babel, PostCSS, ESLint, etc.? In dedicated config files ? Save this as a preset for future projects? No</code> </pre> <br><p>  Vue Cli memiliki wizard yang bagus untuk memandu Anda;  untuk tutorial ini kita akan menggunakan mode manual dan mengaktifkan <strong>semua fitur</strong> .  Berlebihan?  Mungkin, tapi kami ingin melihat bagaimana Vue bekerja dengan semua yang dapat disediakan di luar kotak.  Namun, mari kita lihat opsi dan alasan bagaimana dan mengapa. </p><br><p>  Kami membutuhkan <strong>Babel</strong> dan <strong>TypeScript</strong> diaktifkan.  TS akan menjadi bahasa pilihan utama dan Babel akan mendukung penanganan kode eksternal yang memerlukan pengubahan.  Anda mungkin berpendapat bahwa TypeScript dapat mengubah kode JS juga dan memang itu yang terjadi tetapi dalam percobaan saya (terutama yang berkaitan dengan pengujian unit dan Vuetify) saya pikir itu jauh lebih baik untuk menyimpan TS untuk <code>*.ts</code> dan menggunakan Babel untuk yang lainnya. </p><br><p>  <strong>Pra-prosesor CSS</strong> akan berguna untuk Vuetify;  sementara itu hadir dengan CSS pra-minified Anda mungkin ingin menyertakan file <code>styl</code> asli untuk bekerja dengan gaya.  <strong>Linter / Formatter</strong> adalah persyaratan yang jelas untuk setiap proyek baru (Anda harus mematuhi gaya kode tunggal dan Anda dapat berterima kasih kepada saya dalam setahun ketika Anda akan membaca kode lama Anda).  Kami mengaktifkan <strong>Pengujian Unit</strong> dan <strong>Pengujian</strong> <strong>E2E -</strong> walaupun Anda mungkin tidak ingin melakukan uji kasus e2e lengkap, penting untuk mengetahui cara memperbaikinya setelah selesai dengan Vuetify. </p><br><p>  <strong>Dukungan Progressive Web App (PWA)</strong> , <strong>Router</strong> , dan <strong>Vuex</strong> tidak sepenuhnya diperlukan untuk tutorial ini dan kami tidak akan menggunakannya tetapi mengaktifkannya akan menyederhanakan hidup Anda dalam proyek nyata. </p><br><p>  <strong>Gunakan sintaks komponen gaya-kelas?</strong>  Ya  Kelas membuat kode sedikit lebih besar tetapi lebih mudah dibaca dan lebih mudah untuk dipertimbangkan;  mereka juga membuat hidup TypeScript Anda lebih mudah. </p><br><p>  <strong>Gunakan Babel bersama TypeScript untuk polyfill yang terdeteksi secara otomatis?</strong>  Ya  Kami ingin Babel dan TS untuk kasus yang akan kita bahas nanti. </p><br><p>  <strong>Gunakan mode riwayat untuk router?</strong>  Ya (tapi YMMV).  Kami tidak akan menulis backend apa pun untuk menyajikan ini dalam produksi, tetapi umumnya merupakan ide bagus untuk menggunakan API riwayat. </p><br><p>  <strong>Pilih pra-prosesor CSS (PostCSS, Autoprefixer, dan Modul CSS didukung secara default):</strong> kami hanya akan menggunakan modul CSS dalam tutorial ini, jadi Anda bebas memilih sass / less / stylus berdasarkan preferensi Anda. </p><br><p>  <strong>Pilih konfigurasi linter / formatter:</strong> TSlint adalah pilihan yang jelas karena kami ingin menggunakan TypeScript sebanyak mungkin. </p><br><p>  <strong>Pilih fitur serat tambahan:</strong> Aktifkan keduanya ( <code>a</code> ).  Linting itu bagus. </p><br><p>  <strong>Pilih solusi pengujian unit:</strong> tutorial ini berfokus pada Jest sehingga Anda harus memilihnya. </p><br><p>  <strong>Pilih solusi pengujian E2E:</strong> tutorial ini berfokus pada Cypress. </p><br><p>  <strong>Di mana Anda lebih suka menempatkan konfigurasi untuk Babel, PostCSS, ESLint, dll?</strong>  Tidakkah menurutmu itu agak aneh semua orang mencoba untuk memasukkan lebih banyak hal ke <code>package.json</code> ?  File itu hampir tidak dapat dibaca seperti sekarang.  Gunakan file konfigurasi khusus - mereka jauh lebih mudah untuk dikerjakan dan riwayat git Anda akan lebih cantik. </p><br><p>  Saatnya memverifikasi pemasangan, jalankan layanan <code>yarn serve</code> : <br><img src="https://habrastorage.org/webt/5p/ak/ty/5paktyugcycg2dzdtjt1ss1vfoi.png"></p><br><p>  Seharusnya tidak ada kesalahan di konsol dan menavigasi ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: // localhost: 8080 /</a> akan menyambut Anda dengan: <br><img src="https://habrastorage.org/webt/z4/hj/hv/z4hjhvcto1oaxdxokxi5rmuzque.png"></p><br><p>  Memverifikasi unit test berfungsi, jalankan <code>yarn test:unit</code> : <br><img src="https://habrastorage.org/webt/gd/v1/i1/gdv1i1hpoxsejeovp1bvbc4jnbg.png"></p><br><p>  Dan uji kerja e2e ( <code>yarn test:e2e --headless</code> ): <br><img src="https://habrastorage.org/webt/_p/td/ho/_ptdhoshlgew083bq7hfaapmvnu.png"></p><br><p>  Hebat!  Pindah ke UI. </p><br><h2 id="the-material-dilemma">  Dilema material </h2><br><p>  Ada beberapa pustaka Material UI untuk Vue pada tingkat fleksibilitas dan semir yang berbeda.  Tentunya ada lusinan pustaka komponen lain sehingga Anda bebas menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bootstrap Vue</a> jika Anda menginginkannya.  Tutorial ini berfokus pada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vuetify</a> karena beberapa alasan: </p><br><ul><li>  itu adalah pustaka Material yang paling banyak dibintangi di GitHub; </li><li>  itu adalah kesusahan kerajaan untuk membuatnya bekerja jadi ini adalah demo yang bagus dari semua kasus tepi yang bisa Anda kunjungi. </li></ul><br><p>  Yakin?  Lanjutkan dengan instalasi lalu: <code>vue add vuetify</code> .  Pilih opsi <strong>Konfigurasi (lanjutan)</strong> . </p><br><p>  <strong>Gunakan templat yang sudah dibuat sebelumnya?</strong>  Vuetify akan menggantikan App.vue dan HelloWorld.vue default.  Jawab ya untuk ini karena ini adalah proyek baru. </p><br><p>  <strong>Gunakan tema khusus?</strong>  Ya  Anda memerlukannya cepat atau lambat jadi mari kita konfigurasikan.  Untuk alasan yang sama jawab ya untuk <strong>Menggunakan properti khusus (variabel CSS)?</strong>  . </p><br><p>  <strong>Pilih font ikon:</strong> Ikon Material (tapi saya akan menunjukkan kepada Anda bagaimana cara memperbaikinya untuk Font Awesome juga).  <strong>Gunakan font sebagai ketergantungan?</strong>  Tidak.  Kami akan mendapatkan font dari CDN. </p><br><p>  <strong>Gunakan komponen a-la-carte?</strong>  Ya  Ini sepertinya cara termudah untuk menggunakan Vuetify. <br><img src="https://habrastorage.org/webt/w1/aa/v9/w1aav901fzrpaeqnnvluidjoufu.png"></p><br><p>  Ada banyak perubahan, tetapi yang paling penting ketika Anda menjalankan <code>yarn serve</code> sekarang Anda akan melihat gambar yang berbeda: <br><img src="https://habrastorage.org/webt/3l/z_/hj/3lz_hjzvuh91eqfwdlcux6yluyy.png"></p><br><p>  (Anda juga akan mendapatkan beberapa lusin peringatan dari linter Anda). </p><br><p>  Mari kita periksa tes unit ... <br><img src="https://habrastorage.org/webt/ov/ks/29/ovks2927ibmuxyxblnxamj_jyb8.png"></p><br><h2 id="making-vuetify-work-with-unit-and-e2e-tests">  Membuat Vuetify berfungsi dengan tes unit dan e2e </h2><br><p>  Mari kita periksa <code>./tests/unit/example.spec.ts</code> .  Tes memverifikasi <code>msg</code> menampilkan " <em>pesan baru</em> " tetapi template yang datang dengan Vuetify tidak lagi mendukung prop ini.  Dalam situasi dunia nyata Anda akan menghapus komponen HelloWorld dan pengujiannya, tetapi di sini kami memperbarui pesan untuk mencari sesuatu yang ada di dalam komponen: </p><br><pre> <code class="plaintext hljs">const msg = 'Welcome to Vuetify';</code> </pre> <br><p>  Sekarang tes lolos (verifikasi dengan <code>yarn test:unit</code> ) tetapi masih ada selusin peringatan yang serupa </p><br><pre> <code class="plaintext hljs">[Vue warn]: Unknown custom element: &lt;v-layout&gt; - did you register the component correctly? For recursive components, make sure to provide the "name" option.</code> </pre> <br><p>  Cara Vuetify berfungsi, ia menambahkan <code>./src/plugins/vuetify.ts</code> yang mengonfigurasi Vuetify sebagai bagian dari aplikasi.  File ini adalah sumber dari <code>./src/main.ts</code> .  Sayangnya <code>main.ts</code> dilewati saat Anda menjalankan tes unit. </p><br><p>  Hal pertama yang pertama, mari kita perbaiki kesalahan dan peringatan dalam <code>vuetify.ts</code> dihasilkan. </p><br><p>  Buka <code>./tsconfig.json</code> Anda dan tambahkan <code>vuetify</code> ke bagian <code>compilerOptions.types</code> : </p><br><pre> <code class="plaintext hljs"> "types": [ "webpack-env", "vuetify", "jest" ],</code> </pre> <br><p>  Ini memberitahu kompiler TypeScript dari mana mendapatkan tipe Vuetify dan kesalahan di <code>./src/plugins/vuetify.ts</code> hilang.  Mari kita perbaiki beberapa peringatan gaya untuk membersihkannya: </p><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuetify from 'vuetify/lib'; import 'vuetify/src/stylus/app.styl'; Vue.use(Vuetify, { theme: { primary: '#ee44aa', secondary: '#424242', accent: '#82B1FF', error: '#FF5252', info: '#2196F3', success: '#4CAF50', warning: '#FFC107', }, customProperties: true, iconfont: 'md', });</code> </pre> <br><p>  Sekarang kita perlu memuat Vuetify dalam konteks pengujian unit kami.  Buat file baru di <code>./tests/jest-setup.js</code> dengan konten berikut: </p><br><pre> <code class="plaintext hljs">import '@/plugins/vuetify';</code> </pre> <br><p>  dan perbarui <code>./jest.config.js</code> untuk memuatnya: </p><br><pre> <code class="plaintext hljs">module.exports = { ... setupFiles: ['./tests/jest-setup.js'], }</code> </pre> <br><p><img src="https://habrastorage.org/webt/xi/xk/-h/xixk-hz2bwqbiqo5_nlxo1ahgq8.png"></p><br><p>  Tes masih gagal tetapi dengan cara yang agak samar.  Apa yang terjadi </p><br><p>  <code>vuetify/lib</code> adalah sumber mentah Vuetify yang tidak diproses yang mencakup hal-hal seperti modul ES.  Jest menjalankan transformasi hanya untuk kode sumber Anda secara default, yang berarti mengabaikan semua yang ada di <code>node_modules</code> .  Lebih dari itu, mengingat kami memberi tahu Vue untuk menggunakan TypeScript lelucon itu tidak dikonfigurasikan ke transpile JS. </p><br><p>  Untuk memperbaikinya, kita perlu melakukan dua perubahan pada <code>./jest.config.js</code> : </p><br><pre> <code class="plaintext hljs">module.exports = { ... transform: { '^.+\\.vue$': 'vue-jest', '.+\\.(css|styl|less|sass|scss|svg|png|jpg|ttf|woff|woff2)$': 'jest-transform-stub', '^.+\\.tsx?$': 'ts-jest', '^.+\\.jsx?$': 'babel-jest', // &lt;-- (1) }, transformIgnorePatterns: [ 'node_modules/(?!(vuetify)/)', // &lt;-- (2) ], }</code> </pre> <br><p>  Dalam <strong>(1)</strong> kami memberitahu Jest untuk mengubah file <code>*.js</code> atau <code>*.jsx</code> dengan Babel (dan Babel sudah dikonfigurasi sebelumnya oleh Vue Cli), tetapi apa <strong>(2)</strong> ?  <code>transformIgnorePatterns</code> menentukan jalur yang Jest akan abaikan ketika mentransisikan kode dan, seperti yang saya sebutkan sebelumnya, standarnya mencakup <code>node_modules</code> .  Di sini kita mengganti default dengan cryptic regex <code>node_modules/(?!(vuetify)/)</code> yang berarti "abaikan setiap jalur yang dimulai dengan <code>node_modules/</code> kecuali diikuti oleh <code>vuetify</code> ": <br><img src="https://habrastorage.org/webt/7e/z_/yi/7ez_yimfw1mdrnxxm0didej0piq.png"></p><br><p>  Perhatikan bagaimana dua jalur pertama memiliki kecocokan tetapi yang ketiga tidak.  Trik ini akan berguna ketika kita akan menambahkan Storybook tetapi untuk saat ini. </p><br><p>  Menjalankan tes lagi ... <br><img src="https://habrastorage.org/webt/p9/yy/sa/p9yysa_dproyxl5wtyovsh0p6f8.png"></p><br><p>  Elemen khusus yang tidak dikenal kembali;  tetapi setidaknya itu mengkompilasi dan berjalan dengan sukses.  Vuetify dipindahkan ke dalam tetapi kita masih perlu mendaftarkan komponen secara manual.  Ada beberapa opsi tentang cara melakukan itu ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">periksa dokumen mereka untuk opsi lain</a> );  apa yang akan kami lakukan di sini adalah mengimpor komponen yang diperlukan ke dalam lingkup global Vue.  Buka lagi <code>./src/plugins/vuetify.ts</code> dan perbarui untuk: </p><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuetify, { VFlex, VLayout, VContainer, VImg } from 'vuetify/lib'; import 'vuetify/src/stylus/app.styl'; Vue.use(Vuetify, { components: { VFlex, VLayout, VContainer, VImg }, theme: { primary: '#ee44aa', secondary: '#424242', accent: '#82B1FF', error: '#FF5252', info: '#2196F3', success: '#4CAF50', warning: '#FFC107', }, customProperties: true, iconfont: 'md', });</code> </pre> <br><p>  Akhirnya, tes lulus: <br><img src="https://habrastorage.org/webt/5f/7s/n1/5f7sn17rr8sk9ei5pgib4x3kc_0.png"></p><br><p>  Tes E2E akan gagal juga ( <code>yarn test:e2e --headless</code> ), tetapi itu karena <code>./tests/e2e/specs/test.js</code> mencari string yang tidak ada lagi.  Tes E2E memutar aplikasi nyata Anda di browser nyata sehingga tidak ada kode untuk diperbaiki - Vuetify sudah diatur di aplikasi Anda.  Perbaiki <code>test.js</code> untuk mencari header baru: </p><br><pre> <code class="plaintext hljs">cy.contains('h1', 'Welcome to Vuetify')</code> </pre> <br><p>  dan itu akan menjadi hijau lagi. </p><br><p>  Mari rekap.  Kami menambahkan Vuetify, memperbaiki tes unit dan e2e untuk menangani templat baru dan memperbarui Jest untuk mengubah kode sumber Vuetify dan memuatnya.  Aplikasi kami fungsional dan kami dapat menggunakan berbagai komponen material.  Pindah ke cerita! </p><br><h2 id="storybooks">  Buku cerita </h2><br><p>  Buku cerita adalah ide yang brilian: Anda menulis kotak uji dari sudut pandang perancang: komponen kecil hingga aplikasi lengkap.  Anda dapat alasan dengan aliran data, pastikan semuanya terlihat persis seperti desainer UI Anda meletakkannya di Photoshop, uji komponen Anda secara terpisah.  Mari tambahkan dukungan buku cerita! </p><br><p>  Ada plugin buku cerita Vue tapi saya menemukan <code>sb init</code> memberikan template default yang lebih bagus sehingga kami akan menggunakannya.  Jalankan <code>npx -p @storybook/cli sb init</code> dan setelah beberapa menit Anda akan mendapatkan prompt untuk menjalankan <code>yarn storybook</code> .  Mari kita lakukan: <br><img src="https://habrastorage.org/webt/zl/nk/zp/zlnkzp3a8aoo-hvz9m_n8yu3moa.png"></p><br><p>  Mari kita tambahkan cerita baru!  Buat <code>./src/components/LoveButton.stories.ts</code> dengan konten berikut: </p><br><pre> <code class="plaintext hljs">import { storiesOf } from '@storybook/vue'; import LoveButton from './LoveButton.vue'; storiesOf('LoveButton', module) .add('default', () =&gt; ({ components: { LoveButton }, template: `&lt;love-button love="vue"/&gt;`, }));</code> </pre> <br><p>  (perhatikan bahwa Anda dapat menggunakan <code>LoveButton.stories.js</code> sini jika Anda ingin longgar dengan mengetikkan cerita Anda). </p><br><p>  TypeScript akan memperingatkan Anda tentang jenis yang hilang yang dapat Anda perbaiki dengan <code>yarn add -D @types/storybook__vue</code> . </p><br><p>  Sekarang buat <code>./src/components/LoveButton.vue</code> dengan konten berikut: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-btn</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-icon</span></span></span><span class="hljs-tag">&gt;</span></span>favorite<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-icon</span></span></span><span class="hljs-tag">&gt;</span></span> {{love}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-btn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ts"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> Vue </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'vue'</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">export</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">default</span></span></span><span class="javascript"> Vue.extend({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">props</span></span></span><span class="javascript">: [</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'love'</span></span></span><span class="javascript">], }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Storybook akan mencari <code>./stories</code> untuk cerita Anda secara default tetapi sering lebih mudah untuk menyimpan cerita lebih dekat dengan komponen Anda (seperti yang kami lakukan).  Untuk memberi tahu buku cerita tempat mencari pembaruan tersebut <code>./.storybook/config.js</code> Anda: </p><br><pre> <code class="plaintext hljs">import { configure } from '@storybook/vue'; const req = require.context('../src', true, /.stories.(j|t)s$/); function loadStories() { req.keys().forEach(filename =&gt; req(filename)); } configure(loadStories, module);</code> </pre> <br><p>  Sekarang, jalankan kembali <code>yarn storybook</code> : <br><img src="https://habrastorage.org/webt/zp/et/ow/zpetowrxhyjw0fk58backjxdtj8.png"></p><br><p>  Tidak terlalu mengasyikkan.  Konsol penuh peringatan: <br><img src="https://habrastorage.org/webt/8r/cr/kj/8rcrkj3uud0cc8kaaya3rr1lkho.png"></p><br><p>  Kita tahu apa itu sekarang.  Storybook adalah konteks "root" lain dengan entrypointnya sendiri;  itu tidak menggunakan <code>main.ts</code> dan karena itu tidak memuat Vuetify jadi kita perlu mengatakannya untuk melakukan itu.  Perbarui <code>./.storybook/config.js</code> : </p><br><pre> <code class="plaintext hljs">import { configure } from '@storybook/vue'; import '../src/plugins/vuetify'; // &lt;-- add this const req = require.context('../src', true, /.stories.(j|t)s$/); function loadStories() { req.keys().forEach(filename =&gt; req(filename)); } configure(loadStories, module);</code> </pre> <br><p>  Kami memuat konfigurasi yang ada lagi, yang memastikan Storybook menggunakan tema yang sama dengan aplikasi sebenarnya.  Sayangnya <code>yarn storybook</code> akan gagal sekarang: <br><img src="https://habrastorage.org/webt/lb/g0/nq/lbg0nq7fapzeztm7zfrzrhx8lz8.png"></p><br><p>  Storybook tidak tahu kami menggunakan TypeScript sehingga tidak dapat memuat file <code>vuetify.ts</code> .  Untuk memperbaikinya, kita perlu memperbarui konfigurasi webpack Storybook sendiri.  Buat <code>./.storybook/webpack.config.js</code> dengan konten berikut: </p><br><pre> <code class="plaintext hljs">const ForkTsCheckerWebpackPlugin = require('fork-ts-checker-webpack-plugin'); module.exports = (baseConfig, env, defaultConfig) =&gt; { defaultConfig.resolve.extensions.push('.ts', '.tsx', '.vue', '.css', '.less', '.scss', '.sass', '.html') defaultConfig.module.rules.push({ test: /\.ts$/, exclude: /node_modules/, use: [ { loader: 'ts-loader', options: { appendTsSuffixTo: [/\.vue$/], transpileOnly: true }, } ], }); defaultConfig.module.rules.push({ test: /\.less$/, loaders: [ 'style-loader', 'css-loader', 'less-loader' ] }); defaultConfig.module.rules.push({ test: /\.styl$/, loader: 'style-loader!css-loader!stylus-loader' }); defaultConfig.plugins.push(new ForkTsCheckerWebpackPlugin()) return defaultConfig; };</code> </pre> <br><p>  Ini memuat konfigurasi default, menambahkan <code>ts-loader</code> untuk file TypeScript, dan juga menambahkan dukungan untuk lebih sedikit dan styl (yang digunakan Vuetify). </p><br><p>  Peringatan masih ada di sana, karena kita perlu mendaftarkan komponen yang kita gunakan.  Mari kita gunakan komponen lokal saat ini sehingga Anda dapat melihat perbedaannya (dalam aplikasi produksi nyata jauh lebih mudah untuk mendaftarkan semuanya di <code>vuetify.ts</code> ).  Perbarui <code>./src/components/LoveButton.vue</code> : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-btn</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-icon</span></span></span><span class="hljs-tag">&gt;</span></span>favorite<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-icon</span></span></span><span class="hljs-tag">&gt;</span></span> {{love}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-btn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ts"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> Vue </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'vue'</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> { VBtn, VIcon } </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'vuetify/lib'</span></span></span><span class="javascript">; </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">// &lt;-- add this export default Vue.extend({ components: { VBtn, VIcon }, // &lt;-- and this props: ['love'], }); </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Buku cerita disegarkan saat disimpan: <br><img src="https://habrastorage.org/webt/jb/eb/yn/jbebynfkavexxg2og5kbdcvtaou.png"></p><br><p>  Secara marginal lebih baik.  Apa yang hilang  Penginstal Vuetify menambahkan font css langsung ke <code>./public/index.html</code> tetapi Storybook tidak menggunakan file itu, jadi kita perlu menambahkan font Material Ikon yang hilang.  Buat <code>./.storybook/preview-head.hmtl</code> dengan yang berikut ini (menyalin dari <code>./public/index.html</code> ): </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://fonts.googleapis.com/css?family=Material+Icons"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  (ada cara lain untuk melakukan hal yang sama, misalnya menggunakan CSS <code>@import</code> ). </p><br><p>  Anda harus memulai kembali <code>yarn storybook</code> Anda agar kembali ditampilkan dengan benar: <br><img src="https://habrastorage.org/webt/ar/pn/i2/arpni2dvklu5w-cdct4fvgtl00q.png"></p><br><p>  Jauh lebih baik tetapi masih di bawah standar: font teks salah karena Vuetify mengharapkan semua komponennya bersarang di dalam <code>v-app</code> yang menerapkan gaya halaman.  Tentunya kita tidak bisa menambahkan <code>v-app</code> ke tombol kita, jadi mari kita hiasi ceritanya.  Perbarui <code>./src/components/LoveButton.stories.ts</code> : </p><br><pre> <code class="plaintext hljs">import { storiesOf } from '@storybook/vue'; import { VApp, VContent } from 'vuetify/lib'; // &lt;-- add the import import LoveButton from './LoveButton.vue'; // add the decorator const appDecorator = () =&gt; { return { components: { VApp, VContent }, template: ` &lt;v-app&gt; &lt;div style="background-color: rgb(134, 212, 226); padding: 20px; width: 100%; height: 100%;"&gt; &lt;v-content&gt; &lt;story/&gt; &lt;/v-content&gt; &lt;/div&gt; &lt;/v-app&gt; `, }; }; storiesOf('LoveButton', module) .addDecorator(appDecorator) // &lt;-- decorate the stories .add('default', () =&gt; ({ components: { LoveButton }, template: `&lt;love-button love="vue"/&gt;`, }));</code> </pre> <br><p>  Anda harus mendaftarkan <code>VApp</code> dan <code>VContent</code> dalam lingkup global, perbarui <code>./src/plugins/vuetify.ts</code> : </p><br><pre> <code class="plaintext hljs">import Vue from 'vue'; import Vuetify, { VFlex, VLayout, VContainer, VImg, VApp, VContent } from 'vuetify/lib'; import 'vuetify/src/stylus/app.styl'; Vue.use(Vuetify, { components: { VFlex, VLayout, VContainer, VImg, VApp, VContent }, theme: { primary: '#ee44aa', secondary: '#424242', accent: '#82B1FF', error: '#FF5252', info: '#2196F3', success: '#4CAF50', warning: '#FFC107', }, customProperties: true, iconfont: 'md', });</code> </pre> <br><p>  Akhirnya, hasilnya spektakuler: <br><img src="https://habrastorage.org/webt/gv/4a/nn/gv4ann-op0rqahdnqjpuzjqlgya.png"></p><br><h2 id="adding-storybook-testing">  Menambahkan pengujian buku cerita </h2><br><p>  Akhirnya, mari pastikan cerita kita dicakup oleh unit test.  Tambahkan dependensi yang diperlukan: <code>yarn add -D @storybook/addon-storyshots jest-vue-preprocessor babel-plugin-require-context-hook</code> dan buat <code>./test/unit/storybook.spec.js</code> : </p><br><pre> <code class="plaintext hljs">import registerRequireContextHook from 'babel-plugin-require-context-hook/register'; import initStoryshots from '@storybook/addon-storyshots'; registerRequireContextHook(); initStoryshots();</code> </pre> <br><p>  Konfigurasi Storybook menggunakan <code>require.context</code> untuk mengumpulkan semua sumber;  fungsi itu disediakan oleh webpack dan kita perlu menggunakan <code>babel-plugin-require-context-hook</code> untuk menggantinya di Jest.  Ubah <code>./babel.config.js</code> Anda: </p><br><pre> <code class="plaintext hljs">module.exports = api =&gt; ({ presets: ['@vue/app'], ...(api.env('test') &amp;&amp; { plugins: ['require-context-hook'] }), });</code> </pre> <br><p>  Di sini kita menambahkan plugin need <code>require-context-hook</code> jika babel berjalan untuk pengujian unit. </p><br><p>  Akhirnya kita perlu mengizinkan Jest untuk <code>*.vue</code> file <code>*.vue</code> buku cerita.  Ingat bahwa lookahead regex di <code>./jest.config.js</code> ?  Mari kita kunjungi kembali sekarang: </p><br><pre> <code class="plaintext hljs">module.exports = { ... transformIgnorePatterns: [ 'node_modules/(?!(vuetify/|@storybook/.*\\.vue$))', ], }</code> </pre> <br><p>  Perhatikan bahwa kita tidak bisa hanya menambahkan baris kedua di sana.  Ingat bahwa ini adalah pola abaikan sehingga jika pola pertama mengabaikan segalanya kecuali Vuetify maka file buku cerita sudah diabaikan pada saat Jest sampai ke regex kedua. </p><br><p>  Tes baru berfungsi seperti yang diharapkan: <br><img src="https://habrastorage.org/webt/dn/t6/22/dnt622f3au95rkrhcfgusnkdj_e.png"></p><br><p>  Tes ini akan menjalankan semua cerita Anda dan memverifikasinya terhadap foto lokal di <code>./tests/unit/__snapshots__/</code> .  Untuk melihatnya dalam tindakan, Anda dapat menghapus <code>&lt;v-icon&gt;favorite&lt;/v-icon&gt;</code> dari komponen tombol Anda dan menjalankan kembali pengujian untuk melihatnya gagal: <br><img src="https://habrastorage.org/webt/rf/oh/09/rfoh09qhni7mvf_jzsj_dmzuf_e.png"></p><br><p>  <code>yarn test:unit -u</code> akan memperbarui foto Anda untuk tata letak tombol baru. </p><br><h2 id="recap">  Rekap </h2><br><p>  Dalam tutorial ini kami belajar cara membuat aplikasi Vue baru dengan TypeScript diaktifkan;  cara menambahkan perpustakaan Vuetify dengan komponen Material UI.  Kami memastikan unit test kami dan tes e2e bekerja seperti yang diharapkan.  Akhirnya kami menambahkan dukungan untuk buku cerita, membuat sampel cerita dan memastikan bahwa perubahan UI dicakup oleh tes unit kami. </p><br><h2 id="closing-thoughts">  Pikiran penutup </h2><br><p>  JS adalah dunia yang bergerak, hal-hal berubah terus-menerus, patters baru muncul, lama dilupakan.  Tutorial ini mungkin usang hanya dalam beberapa bulan, jadi inilah beberapa tips bermanfaat. </p><br><p>  Ketahui perangkat Anda.  Tidak apa-apa untuk menyalin-menempelkan baris dari stack overflow hingga kode Anda berfungsi, tetapi Anda <strong>harus</strong> meneliti mengapa perubahan itu berhasil nanti.  Baca dokumen dan pastikan Anda memahami apa sebenarnya perubahan itu. </p><br><p>  Jika Anda punya sesuatu untuk bekerja bahkan sebagian - buatlah komitmen.  Bahkan jika itu sedang dalam proses, Anda akan memiliki sesuatu untuk dikembalikan jika perubahan lebih lanjut Anda akan merusak sesuatu. </p><br><p>  Eksperimen!  Jika sesuatu tidak berfungsi seperti yang Anda pikirkan dan dokter mengatakan sebaliknya, bereksperimen!  Frontend world sebagian besar open-source jadi gali ke sumber pihak ketiga dan lihat apakah Anda dapat mengotak-atik instrumen Anda dari dalam untuk menambahkan debug logging. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438354/">https://habr.com/ru/post/id438354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438342/index.html">Mengapa Curang Ramah AI di Ghost Recon Wildlands</a></li>
<li><a href="../id438346/index.html">Bagaimana mereka melakukannya? Tinjauan umum tentang teknologi anonimisasi cryptocurrency</a></li>
<li><a href="../id438348/index.html">Cara belajar program pada usia 9 tahun secara mandiri</a></li>
<li><a href="../id438350/index.html">Panduan Lengkap untuk Pencarian Profesional untuk Kamera Tersembunyi dan Perangkat Spy</a></li>
<li><a href="../id438352/index.html">Video dari keturunan penjelajah "Yutu-2", meter pertamanya di permukaan bulan. Tidur dua minggu di bulan sudah berakhir</a></li>
<li><a href="../id438356/index.html">Arsitektur Bersertifikat Jalur Cepat Gudang Data (DWFT) SQL Server: Apa Artinya dan Cara Kerjanya</a></li>
<li><a href="../id438358/index.html">Mantan agen NSA memata-matai iPhone korban yang ditugaskan oleh UEA</a></li>
<li><a href="../id438362/index.html">Bagaimana kami menerjemahkan konfigurasi layanan kami dari XML ke YAML</a></li>
<li><a href="../id438364/index.html">Replikasi pengacak suara digital pertama di dunia</a></li>
<li><a href="../id438366/index.html">Namun ulasan lain tentang fitur token perangkat keras OATH di Azure Cloud MFA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>