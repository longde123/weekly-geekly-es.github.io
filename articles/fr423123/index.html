<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüè≠ üë©‚Äçüë¶ üéª Comment lancer un projet de test sur Windows 10 (Concombre + capybara + s√©l√©nium-webdriver) üë∂üèΩ üë®üèø‚Äçü§ù‚Äçüë®üèª üñïüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article est con√ßu pour vous familiariser avec l'autotest et le d√©ploiement de l'environnement dans Windows 10 et est destin√© √† ceux qui connaissent ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment lancer un projet de test sur Windows 10 (Concombre + capybara + s√©l√©nium-webdriver)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423123/">  L'article est con√ßu pour vous familiariser avec l'autotest et le d√©ploiement de l'environnement dans Windows 10 et est destin√© √† ceux qui connaissent un peu <b>Cucumber + Capybara + Selenium-webdriver</b> .  L'id√©e de l'article est n√©e en raison de diff√©rences dans l'environnement de d√©ploiement sur Windows 10 et Linux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ww/rj/s-/wwrjs-iwpbsztyvj1ocolretoz0.jpeg"></div><br>  Quelques mots sur la gemme Cucumber + Capybara + Selenium-webdriver (biblioth√®ques) qui sont n√©cessaires pour ex√©cuter et remplir les tests d'interface utilisateur avec des tests. <br><br><h4>  Concombre </h4><br>  Le concombre est un joyau qui vous permet d'√©crire des tests dans le langage humain.  Pour ce faire, utilisez la notation Gherkin, qui d√©finit la structure et les r√®gles d'√©criture des scripts.  Les d√©tails peuvent √™tre lus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/n_/ly/b2n_lym6xgyjm1tmbqlrj2ikhvs.jpeg"></div><br><h4>  Capybara </h4><br>  Capybara est un joyau qui vous permet de rechercher / cliquer / ... pour les √©l√©ments du navigateur.  C'est-√†-dire  C'est le lien entre les √©tapes Cucumber du test et le webdriver (instance du navigateur appel√©).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ici,</a> vous pouvez regarder les m√©thodes de ce joyau. <br><br><h4>  S√©l√©nium-webdriver </h4><br>  Selenium-webdriver est un outil pour automatiser les actions d'un navigateur web.  Il s'agit essentiellement de l'instance de navigateur. <br><a name="habracut"></a><br><h4>  Actions pr√©liminaires </h4><br><div class="spoiler">  <b class="spoiler_title">Description des actions pr√©liminaires</b> <div class="spoiler_text">  Pour plus de commodit√©, nous utiliserons RubyMine.  Vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©charger une version d'essai</a> pendant 30 jours. <br><br>  T√©l√©chargez Firefox et Chrome pour ex√©cuter les tests. <br><br>  T√©l√©chargez et installez Git (syst√®me de contr√¥le de version ou VCS similaire, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site officiel</a> ).  Mais Git est n√©cessaire lorsque vous avez d√©j√† un projet ou que vous souhaitez stocker votre code dans un syst√®me Git. <br></div></div><br><h4>  Commen√ßons donc </h4><br>  Nous avons d√©j√† install√© RubyMine. <br><br><ol><li>  Vous devez installer le langage Ruby lui-m√™me.  Pour ce faire, allez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et installez RubyInstaller.  J'ai choisi la derni√®re version (RubyInstaller 2.5.1-2) avec le package DevKit.  Gr√¢ce √† ce package de configuration, vous pouvez ex√©cuter des tests √† partir de la console, comme sous Linux, ainsi que g√©rer de mani√®re flexible les gemmes. </li><li>  Le package RubyInstaller est install√© et nous passons √† la configuration. <br>  Si nous voulons cr√©er un nouveau projet, ouvrez RubyMine et cr√©ez un projet vide, indiquant le Ruby install√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/nm/tf/h4nmtfigi9avbshzxmctt1go0v4.jpeg"></div></li><li>  Ensuite, nous devons cr√©er cette structure de dossiers et de fichiers en fonction de l'annotation <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kg/mv/qp/kgmvqptts6xoxwmvblc-tu0q-ca.jpeg"></div><br>  D√©crit en d√©tail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> </li><li>  Gemfile - contient une liste de gemmes utilis√©es dans le projet <br><br><div class="spoiler">  <b class="spoiler_title">Voici le contenu de notre gemfile, avec les gemmes les plus basiques pour les tests d'interface utilisateur</b> <div class="spoiler_text"><blockquote><pre><code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">source</span></span> <span class="hljs-string"><span class="hljs-string">'https://rubygems.org'</span></span> gem <span class="hljs-string"><span class="hljs-string">'cucumber'</span></span> gem <span class="hljs-string"><span class="hljs-string">'capybara'</span></span> gem <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> gem <span class="hljs-string"><span class="hljs-string">'chromedriver-helper'</span></span></code> </pre> </blockquote><br></div></div><br>  Ces 4 gemmes doivent √™tre sp√©cifi√©es dans le Gemfile. <br>  gem 'chromedriver-helper' - pilote chrome qui permet d'ex√©cuter des tests sur Chrome <br>  Avec ce gemfile, vous devez installer nos gemmes s√©lectionn√©es.  L'installation sur Windows est plus facile √† partir de l'interface RubyMine: <b>Outils -&gt; Bundler -&gt; menu Installer</b> .  Bundler est √©galement une gemme, mais sert √† contr√¥ler les gemmes.  Mais vous pouvez √©galement le faire √† partir de la ligne de commande, qui se trouve dans le menu du programme sous le nom D√©marrer l'invite de commande ... <br>  Par ailleurs, en utilisant cette ligne de commande, vous pouvez ex√©cuter des tests en contournant RubyMine. <br></li><li>  Le fichier env.rb est le fichier rb cl√© pour l'ex√©cution des tests d'interface utilisateur.  Lors de l'initialisation des variables et des fichiers de test, ce sera env.rb qui sera le tout premier.  C'est l'enregistrement du navigateur sur lequel les tests s'ex√©cuteront.  Un exemple pr√™t √† l'emploi d'env.rb o√π Chrome, Firefox est enregistr√©, ou comprenons que nous n'avons pas du tout besoin d'un navigateur pour ex√©cuter des tests. <br>  Cas o√π un navigateur n'est pas n√©cessaire - nous v√©rifions les demandes de repos, les tests d'int√©gration, bien que l'on pense que les tests Cucumber ne conviennent pas tout √† fait. <br><br><div class="spoiler">  <b class="spoiler_title">√âcriture env.rb</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'capybara/cucumber'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> Capybara.register_driver <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|app|</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ENV[<span class="hljs-string"><span class="hljs-string">'DRIVER'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:chrome</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'without_browser'</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:mechanize</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> client = Selenium::WebDriver::Remote::Http::Default.new Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:firefox</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">port:</span></span> <span class="hljs-number"><span class="hljs-number">10000</span></span> + Random.rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>), <span class="hljs-symbol"><span class="hljs-symbol">http_client:</span></span> client) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> Capybara.default_selector = <span class="hljs-symbol"><span class="hljs-symbol">:xpath</span></span></code> </pre> </blockquote><br></div></div><br>  En outre, voici le probl√®me de la version de Firefox. <br>  Si vous avez install√© Firefox version 46 ou inf√©rieure, alors pour ex√©cuter les tests correctement, vous avez besoin de la gemme 'capybara' version '2.53.4' ou inf√©rieure. <br><br>  Si la version de Firefox est sup√©rieure √† 46, alors elle fonctionne sur d'autres principes bas√©s sur le ¬´geckodriver¬ª et donc, pour ex√©cuter les tests correctement, vous devez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">installer geckodriver</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Une excursion dans les raisons pour lesquelles le geckodriver est n√©cessaire</b> <div class="spoiler_text">  Avant la version 47, le pilote d'automatisation Firefox n'√©tait qu'une extension incluse avec chaque client.  Mais cette extension a √©t√© supprim√©e en raison d'un changement de politique qui exige d√©sormais que toutes les extensions soient sign√©es par Mozilla. <br><br>  Marionette est le nouveau pilote fourni avec Firefox.  Ce pilote a son propre protocole, qui est incompatible avec le protocole Selenium / WebDriver. <br><br>  Geckodriver est un serveur d'applications qui impl√©mente le protocole Selenium / WebDriver.  Il traduit les commandes Selenium et les redirige vers le pilote Marionette. <br></div></div><br>  <b>Une nuance importante</b> , apr√®s avoir install√© "geckodriver", il est n√©cessaire de prescrire les chemins du syst√®me pour que notre "geckodriver" soit trouv√© lors de l'ex√©cution d'env.rb. <br><br><div class="spoiler">  <b class="spoiler_title">chemins syst√®me</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/na/qm/jd/naqmjdhlfa_o9xn8jqax-oqmkfk.jpeg"><br></div></div><br></li><li>  Ensuite, il ne reste plus qu'√† √©crire un test test et √† l'ex√©cuter sur Chrome, Firefox et sans navigateur :).  Par exemple, nous √©crirons quelques √©tapes pour entrer le mail mail.ru <br><br><div class="spoiler">  <b class="spoiler_title">Description des √©tapes</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>: UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">language</span></span>: ru Given(/^   "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |page| visit page <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"   c id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, field_id| find("//input[@id='#{field_id}']").<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-type"><span class="hljs-type">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"     id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, select_id| find("//select[@id='#{select_id}']/option[text()='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^    "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>| find("//input[@value='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^ (\d+) (?:|)$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |sec| sleep sec.to_i <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </blockquote><br></div></div><br></li><li>  Ainsi que le test du concombre lui-m√™me <br><br><div class="spoiler">  <b class="spoiler_title">test.feature</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs swift"># encoding: <span class="hljs-type"><span class="hljs-type">UTF</span></span>-<span class="hljs-number"><span class="hljs-number">8</span></span> # language: ru :   :       <span class="hljs-string"><span class="hljs-string">"https://mail.ru/"</span></span>    <span class="hljs-string"><span class="hljs-string">"dorian.grey.2019"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:login"</span></span>    <span class="hljs-string"><span class="hljs-string">"********"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:password"</span></span>    <span class="hljs-string"><span class="hljs-string">"@inbox.ru"</span></span>     id <span class="hljs-string"><span class="hljs-string">"mailbox:domain"</span></span>      <span class="hljs-string"><span class="hljs-string">""</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> </code> </pre> </blockquote><br></div></div><br></li><li>  Il ne reste plus qu'√† v√©rifier tous nos efforts et profiter du bon fonctionnement des tests UI (dans l'exemple 1 du test) :).  Le dernier param√®tre restant est la configuration du test.  Allez dans le menu RubyMine -&gt; Edit Configurations -&gt; Runner Options - Ici, nous s√©lectionnons simplement le pilote :) <br>  ENV ['DRIVER'] de env.rb c'est le param√®tre de lancement.  Et nous avons juste besoin de sp√©cifier "DRIVER = firefox" ou "DRIVER = chrome" dans les options du Runner. <br></li></ol><br>  Nous lan√ßons <br><br><img src="https://habrastorage.org/webt/fy/dg/7i/fydg7ieltbsbgugy2teio6e6btu.jpeg"><br><br>  C'est tout, des tests de concombre r√©ussis pour vous! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr423123/">https://habr.com/ru/post/fr423123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr423109/index.html">Ce qu'Apple a pr√©sent√© et ce qu'en pensent les d√©veloppeurs iOS</a></li>
<li><a href="../fr423115/index.html">Effets am√©lior√©s avec le mode de fusion des couches d'arri√®re-plan CSS</a></li>
<li><a href="../fr423117/index.html">Vivre plus longtemps ou vieillir plus lentement: une approche technologique de la vieillesse</a></li>
<li><a href="../fr423119/index.html">Machine d'arcade DIY TTL ... en 2018</a></li>
<li><a href="../fr423121/index.html">Brainfuck de bas niveau</a></li>
<li><a href="../fr423125/index.html">Applications de partage g√©ographique</a></li>
<li><a href="../fr423127/index.html">Pluton est consid√©r√© comme une plan√®te</a></li>
<li><a href="../fr423129/index.html">Mythes et excuses qui vous emp√™chent d'apprendre l'anglais</a></li>
<li><a href="../fr423131/index.html">TL; DR du livre ¬´L'art des sciences et de l'ing√©nierie¬ª, de Richard Hamming</a></li>
<li><a href="../fr423133/index.html">Interface proactive: refonte de la page de recherche de suicide de Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>