<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ç üññüèæ ü§∫ Pilotes tiers dangereux sur votre syst√®me ou pilotes LOLD üî™ ü§¥üèø üë®üèº‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saviez-vous qu'un pilote compl√®tement l√©gitime peut donner √† un attaquant la possibilit√© de s'inscrire dans votre syst√®me pendant une longue p√©riode, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pilotes tiers dangereux sur votre syst√®me ou pilotes LOLD</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/"><p><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br><p>  Saviez-vous qu'un pilote compl√®tement l√©gitime peut donner √† un attaquant la possibilit√© de s'inscrire dans votre syst√®me pendant une longue p√©riode, en restant √† l'int√©rieur m√™me apr√®s sa r√©installation?  Ou transformer votre ordinateur en brique?  Par exemple, certains pilotes inoffensifs apparemment fiables (sign√©s) sont accessoirement des outils pour remplacer le BIOS.  Apr√®s une telle attaque, seul le programmeur enregistrera. </p><br><p>  Sous Windows, il existe des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">applications / scripts / biblioth√®ques de</a> confiance avec des <del>  int√©ressant </del>  fonctionnalit√©s dangereuses telles que l'ex√©cution de code arbitraire, le t√©l√©chargement de fichiers, le contournement de l'UAC, etc.  Si de telles fonctionnalit√©s suppl√©mentaires sont trouv√©es dans un composant du noyau, cela devient encore plus int√©ressant. </p><a name="habracut"></a><br><p>  √Ä partir de Windows Vista x64, la strat√©gie DSE (Driver Signature Enforcement) s'applique - tous les pilotes de niveau noyau doivent √™tre sign√©s.  Si un attaquant (avec des droits d'utilisateur / administrateur) apr√®s avoir p√©n√©tr√© le syst√®me veut obtenir le niveau d'acc√®s maximal (installer le rootkit du noyau / bootkit / SMM-rootkit / BIOS-rootkit), il devra d'une mani√®re ou d'une autre contourner l'exigence de signature pour le pilote.  La possibilit√© d'appeler certaines fonctions ou instructions du mode noyau en mode noyau peut donner √† un attaquant un outil pour √©lever ses privil√®ges, divulguer des informations ou provoquer un d√©ni de service.  Nous appelons cette fonctionnalit√© une fonctionnalit√© √† double usage (dans certains cas, cela peut √™tre appel√© des vuln√©rabilit√©s ou des backdoors, cependant, la discussion sur la d√©finition correcte d√©passe le cadre de cet article). </p><br><h2 id="sposoby-obhoda-dse">  <strong>Solutions de contournement DSE</strong> </h2><br><p>  Voyons quelles options un attaquant a g√©n√©ralement pour contourner DSE (vous devez en quelque sorte p√©n√©trer ring0).  Le tableau ci-dessous r√©sume les moyens de contourner DSE avec leurs avantages et leurs inconv√©nients (pour l'attaquant et les agents de s√©curit√©, veuillez en prendre note).  Il convient de noter que ces informations s'appliquent √† Windows x64, √† commencer par Vista. </p><br><div class="scrollable-table"><table><thead><tr><th>  Fa√ßon </th><th>  Les avantages </th><th>  Inconv√©nients </th></tr></thead><tbody><tr><td>  D√©finition des donn√©es de configuration de d√©marrage (mode test) </td><td>  Simplicit√© </td><td><ul><li>  Cela ne fonctionne pas pour toutes les applications. </li><li>  Un filigrane appara√Æt sur le bureau </li><li>  Red√©marrage requis </li></ul></td></tr><tr><td>  Utilisation d'une cl√© priv√©e compromise </td><td>  Possibilit√© d'installer n'importe quel pilote </td><td><ul><li>  Si une fuite est d√©tect√©e, le certificat est ajout√© √† la liste de r√©vocation de certificats (CRL) </li></ul></td></tr><tr><td>  Utilisation de la vuln√©rabilit√© dans l'impl√©mentation du contr√¥le DSE </td><td>  Non d√©tect√© par les syst√®mes antivirus et de s√©curit√© Windows </td><td><ul><li>  Difficult√© √† trouver de telles vuln√©rabilit√©s </li><li>  D√©pend de la version du syst√®me d'exploitation </li></ul></td></tr><tr><td>  Modification des m√©canismes de v√©rification des pilotes (bootmgr, winload.exe, winresume.exe, ci.dll) </td><td>  Possibilit√© d'installer n'importe quel pilote sans v√©rification OC </td><td><ul><li>  Complexit√© des modifications </li><li>  N√©cessite un moyen de contourner le d√©marrage s√©curis√© (si activ√©) </li><li>  Red√©marrage requis </li><li>  D√©pend de la version du syst√®me d'exploitation </li><li>  Autres contr√¥les de fichiers </li></ul></td></tr><tr><td>  Utilisation d'un pilote sign√© avec vuln√©rabilit√© </td><td>  Difficult√© de d√©tection d'attaque </td><td><ul><li>  Difficult√© √† trouver de telles vuln√©rabilit√©s </li><li>  Verrou de s√©curit√© de d√©tection </li></ul></td></tr><tr><td>  Utilisation d'un pilote sign√© avec une fonctionnalit√© √† double usage </td><td>  Non d√©tect√© par les syst√®mes antivirus et de s√©curit√© Windows </td><td><ul><li>  La complexit√© de la recherche (pour un attaquant) d'un pilote avec la fonctionnalit√© √† double usage requise </li></ul></td></tr></tbody></table></div><br><p>  Comme vous pouvez le voir dans le tableau, un pilote sign√© avec des fonctionnalit√©s √† double usage est le moyen le plus attractif de contourner DSE pour un attaquant. </p><br><h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya">  <strong>Fonctionnalit√© dangereuse ou √† double usage</strong> </h2><br><p>  Examinons des exemples de capacit√©s malveillantes qu'un attaquant appara√Æt en pr√©sence d'un pilote avec des fonctions √† double usage dangereuses. </p><br><ul><li> Escalade de privil√®ges au niveau administrateur / SYST√àME.  M√©moire physique en lecture / √©criture requise.  Cette attaque peut √™tre effectu√©e, par exemple, en utilisant le pilote ASMMAP d'ASUS.  Pour ce faire, lisez la m√©moire physique et trouvez la structure EPROCESS (c'est un √©l√©ment d'une liste cha√Æn√©e), puis parcourez la liste √† la recherche du processus dont nous voulons augmenter le niveau de privil√®ge, ainsi que certains processus bien connus avec le niveau SYSTEM (par exemple, lsass, wininit).  Copiez ensuite la valeur du champ Token de la structure de processus syst√®me dans la structure du processus cible.  Une description plus d√©taill√©e de l'attaque est donn√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </li><li>  D√©sactiver SMEP.  Pour ce faire, vous devez √©crire dans le registre de contr√¥le cr4 (plus pr√©cis√©ment, r√©initialiser son 20e bit).  Par exemple, le pilote bandainamcoonline.sys d√©sactive non seulement SMEP, mais ex√©cute √©galement le code en fonction du pointeur qui lui est transmis par l'utilisateur.  Pour ceux qui sont int√©ress√©s, il y a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article</a> avec une description d√©taill√©e du pilote. </li><li><p>  Ex√©cution de code arbitraire en mode noyau.  M√©moire physique en lecture / √©criture et MSR requis.  Il s'agit de remplacer l'adresse (situ√©e dans l'un des MSR), √† laquelle la transition sera effectu√©e lors d'un appel syst√®me, √† l'adresse de l'emplacement du code de l'attaquant.  Vous trouverez ici plus d'informations √† ce sujet.  PatchGuard interf√©rera en cours de route, mais vous pouvez le d√©couvrir si vous le souhaitez. </p><br><blockquote>  √âtant donn√© que le pilote et PatchGuard s'ex√©cutent tous deux dans Ring 0, rien n'emp√™che le pilote de d√©sactiver les v√©rifications PatchGuard (jusqu'√† ce que, bien s√ªr, jusqu'√† ce que Microsoft √©coute Intel et d√©passe le mod√®le avec deux anneaux de protection).  Les d√©veloppeurs du noyau chez Microsoft sont bien conscients de ce fait et effectuent diverses actions pour masquer l'emplacement de ce code, obscurcir ses actions et les structures internes utilis√©es.  En d'autres termes, en raison de l'impossibilit√© de vous emp√™cher de modifier le code PatchGuard, ils font de leur mieux pour le cacher. <br><br>  - <em>Blunden B. L'arsenal Rootkit: √©vasion et √©vasion dans les coins sombres du syst√®me.</em> </blockquote><br><div class="spoiler">  <b class="spoiler_title">L'original</b> <div class="spoiler_text"><blockquote>  √âtant donn√© que le code du pilote et le code PatchGuard s'ex√©cutent tous les deux dans Ring 0, rien n'emp√™che un KMD de d√©sactiver les v√©rifications PatchGuard (sauf, bien s√ªr, que Microsoft s'inspire d'Intel et d√©passe le mod√®le de privil√®ge √† deux anneaux).  Les ing√©nieurs du noyau chez Microsoft sont parfaitement conscients de ce fait et effectuent toutes sortes d'acrobaties de programmation pour masquer o√π r√©side le code, ce qu'il fait et les structures de donn√©es internes qu'il manipule.  En d'autres termes, ils ne peuvent pas vous emp√™cher de modifier le code PatchGuard, ils vont donc essayer comme l'enfer de le cacher. <br><br>  - <em>Blunden B. L'arsenal Rootkit: √©vasion et √©vasion dans les coins sombres du syst√®me.</em> </blockquote><br></div></div><br></li></ul><br><ul><li>  Entr√©e BIOS.  Un exemple dans la nature est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lojax</a> .  Les attaquants ont pris le bien connu RwDrv.sys et l'ont utilis√© √† leurs propres fins: ils ont lu le BIOS, modifi√© et r√©√©crit.  La r√©installation de Windows n'aidera pas ici, car le code malveillant se trouve dans le firmware sur SPI-flash.  Si l'√©crasement du BIOS √©choue (ou est sp√©cialement √©cras√©), il sera √©galement d√©sagr√©able.  Dans tous les cas, vous devrez conduire apr√®s le programmeur pour corriger les cons√©quences g√™nantes. </li><li>  Appelez le gestionnaire SMI.  Tout d'abord, tous les BIOS ne sont pas sans d√©fense contre le code en mode ring0: il existe diff√©rents m√©canismes de protection en lecture / √©criture, il peut donc y avoir une situation o√π vous devez descendre plus bas - en mode SMM (le plus privil√©gi√©).  Une fa√ßon d'y arriver √† partir du mode noyau est de tirer le gestionnaire SMI (assez souvent il y en a des vuln√©rables).  Pour appeler le gestionnaire SMI, vous devez pouvoir √©crire sur le port d'E / S, et cela ne peut √™tre fait qu'avec les privil√®ges ring0.  Autrement dit, un pilote ayant la capacit√© d'√©crire sur des ports d'E / S est capable de d√©tecter un gestionnaire SMI vuln√©rable qui peut permettre √† un attaquant d'ex√©cuter du code en mode SMM.  Dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple, l'</a> auteur utilise le pilote RwDrv.sys. </li><li>  Informations sur le syst√®me.  Lecture de la m√©moire du noyau (via la lecture de la m√©moire physique), lecture du BIOS, informations sur les param√®tres syst√®me, les p√©riph√©riques connect√©s et les m√©canismes de protection activ√©s / d√©sactiv√©s (via la lecture de MSR, les registres de contr√¥le, l'acc√®s aux ports d'entr√©e / sortie), dans certains cas, un hyperviseur connu peut √™tre d√©tect√© ( comme VirtualBox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">via MSR</a> ).  Pour cette t√¢che, m√™me un pilote qui ne sait que lire, pas n√©cessairement √©crire, convient le plus souvent.  Par exemple, RamCaptureDriver64.sys de Belkasoft convient √† la lecture de la m√©moire physique. </li></ul><br><p>  Si nous analysons divers articles et notes sur CVE, nous pouvons distinguer une classification de potentiellement dangereux lors de l'acc√®s aux fonctions ring3 dans les pilotes.  Le tableau ci-dessous r√©pertorie les fonctions dangereuses et les sources d'informations les concernant. </p><br><div class="scrollable-table"><table><thead><tr><th>  Fonctions dangereuses identifi√©es </th><th>  Sources d'informations sur les pratiques de s√©curit√© </th></tr></thead><tbody><tr><td>  Lecture / √©criture des registres MSR </td><td>  CVE-2018-10711, CVE-2018-18535, CVE-2018-19323, CVE-2007-5633, CVE-2007-5761 </td></tr><tr><td>  Ports d'E / S en lecture / √©criture </td><td>  CVE-2018-10712, CVE-2018-18536, CVE-2018-19322 </td></tr><tr><td>  Lecture / √©criture de la m√©moire physique </td><td>  CVE-2018-16712, CVE-2018-10710, CVE-2017-15302, CVE-2017-15303, CVE-2018-19321 </td></tr><tr><td>  Lecture / √©criture des registres de contr√¥le </td><td>  CVE-2018-10709, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Eset - Exploitation Windows en 2016</a> </td></tr><tr><td>  Acc√®s aux compteurs de performances / d'horloge </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Leif Uhsadel, Andy Georges, Ingrid Verbauwhed - Exploiter les compteurs de performances mat√©rielles</a> </td></tr><tr><td>  Registre des indicateurs de lecture / √©criture </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wojtczuk R., Rutkowska J. Apr√®s le lapin blanc: attaques logicielles contre la technologie Intel VT-d</a> </td></tr><tr><td>  Instructions d'acc√®s au cache </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©tection des attaques par canal lat√©ral bas√©e sur le cache via la technologie de surveillance du cache Intel et les compteurs de performances mat√©rielles</a> </td></tr></tbody></table></div><br><p>  Et ce n'est pas toute la liste des fonctions dangereuses possibles.  Vous pouvez √©galement parler de lecture / √©criture de la m√©moire virtuelle du noyau, lecture / √©criture de MMIO, acc√®s aux p√©riph√©riques PCI, etc. </p><br><p>  Les trois premi√®res fonctions pr√©sentent le plus grand int√©r√™t, ainsi que le plus grand danger (et les plus susceptibles de trouver un pilote avec de telles fonctions): lecture / √©criture des registres MSR, lecture / √©criture des ports d'E / S, lecture / √©criture de la m√©moire physique.  En utilisant des registres de contr√¥le, vous pouvez contourner certains m√©canismes de protection, l'√©criture dans le registre des drapeaux vous permet d'activer les ports d'entr√©e / sortie en lecture / √©criture dans ring3 (√† propos, il est mentionn√© dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article sur Habr√©), le succ√®s des attaques sur les canaux tiers (en acc√©dant au cache, en surveillant les compteurs performances / cycles) est tr√®s peu probable. </p><br><p>  En cours de cr√©ation de ce mat√©riel lors de la conf√©rence DEFCON 27 √† Las Vegas, les chercheurs Jesse Michael et Mickey Shkatov ont pr√©sent√© le travail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Sortez du noyau si vous ne pouvez pas conduire¬ª</a> , qui traite √©galement de ce probl√®me, et nous vous recommandons d'√©tudier ce mat√©riel pour compl√©ter l'image.  Les sc√©narios d'utilisation de ces pilotes sont tr√®s simples et clairs, et des exemples de sections de code responsables des fonctionnalit√©s les plus critiques sont pr√©sent√©s.  Et fournit √©galement du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code</a> pour travailler et trouver des pilotes similaires. </p><br><p>  D'une mani√®re g√©n√©rale, il convient de noter que ce sujet pr√©occupe depuis longtemps les chercheurs en s√©curit√©.  En 2018, le chercheur Alexander Matrosov dans son article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Qu'est-ce qui rend les pilotes de syst√®me d'exploitation dangereux pour le BIOS?"</a>  soulev√© cette question et d√©montr√© combien il est simple d'exploiter le BIOS. </p><br><h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya">  <strong>Pilotes √† double fonction</strong> </h2><br><p>  Vous trouverez ci-dessous les repr√©sentants les plus c√©l√®bres des pilotes dot√©s de fonctions √† double usage. </p><br><ul><li><p>  RwDrv.sys est un pilote tr√®s populaire (fourni avec l'utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RWeverything</a> ).  Lit et √©crit la m√©moire physique, les ports d'E / S, le MSR et les registres de contr√¥le.  Il a √©t√© utilis√© √† plusieurs reprises dans divers PoC, puis dans le rootkit Lojax mentionn√© pr√©c√©demment.  Une <a href="">interface est</a> √©crite <a href="">pour cela</a> en C ++, et elle est √©galement utilis√©e en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chipsec</a> . </p><br></li><li><p>  cpuz / gpuz </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" data-twitter-extracted-i1582099034987583726="true"><p lang="en" dir="ltr">  Faire du fuzz [V] HW IO?  Consultez GPU-Z.sys (sign√©).  Wraps in / out / MmMapIoSpace / wrmsr / etc via IOCTLs :) - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://t.co/VwCYsm97rr</a> </p>  - Kostya Kortchinsky (@ crypt0ad) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">30 janvier 2015</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>  Lit et √©crit la m√©moire physique, les ports et MSR.  Plusieurs utilitaires PoC l'utilisent ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ). </p><br></li><li><p>  pcdsrvc_x64 - pilote de Dell, pour plus d'informations, contactez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article.  Vous permet de lire / √©crire de la m√©moire physique dans les ports d'E / S. </p><br></li><li><p>  AsIO64.sys <br><img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="image"><br>  Il offre la possibilit√© de lire / √©crire la m√©moire physique et les ports d'E / S, et est √©galement livr√© avec une DLL pratique pour effectuer ces demandes. </p><br></li><li><p>  Asmmap64.sys est un autre pilote d'ASUS qui vous permet de lire / √©crire de la m√©moire physique, des ports d'E / S et MSR.  Ce serait particuli√®rement agr√©able pour un attaquant, car l'acc√®s au pilote peut se faire depuis un utilisateur r√©gulier sans droits d'administrateur.  Les personnes curieuses peuvent se tourner vers la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">source</a> . </p><br></li><li><p>  ntiolib_x64.sys / winio64.sys - pilotes de MSI, ils sont d√©crits en d√©tail dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> mentionn√© pr√©c√©demment.  En utilisant ntiolib_x64.sys, vous pouvez lire / √©crire de la m√©moire physique, des ports d'E / S et MSR, winio64.sys fournit toutes ces fonctions sauf MSR. </p><br></li></ul><br><p>  Habituellement, les fonctions dangereuses d√©crites sont reconnues comme des vuln√©rabilit√©s si le pilote est accessible √† l'utilisateur sans droits d'administrateur (ACL incorrect) ou lorsqu'il permet d'ex√©cuter directement du code arbitraire (comme dans bandainamcoonline.sys).  Dans d'autres cas, ce ne sont que des fonctionnalit√©s, et puisque l'utilisateur a des droits d'administrateur, il peut utiliser toutes les fonctions du pilote et c'est la norme. </p><br><p>  Si vous pensez qu'il n'y a pas plus d'une douzaine de ces pilotes, vous vous trompez grandement.  Vous pouvez voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette s√©lection de</a> pilotes int√©ressants.  Cette liste contient des pilotes ASUS, AVAST, Razer, LG, American Megatrends et d'autres soci√©t√©s bien connues.  Il y en a donc beaucoup, il suffit de chercher.  Ils repr√©sentent donc une r√©elle menace. </p><br><p>  Cette menace est √©galement comprise par les employ√©s de Microsoft.  Et ils seront reconnaissants des informations sur ces pilotes;) <br><img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="image"></p><br><h2 id="rekomendacii">  <strong>Recommandations</strong> </h2><br><p>  Pour les utilisateurs: </p><br><ul><li>  Vous ne devez pas vous asseoir inutilement sous le compte administrateur et d√©sactiver l'UAC (bien qu'il ne soit pas difficile de le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">contourner</a> ). </li><li>  Vous pouvez installer le d√©tecteur en essayant d'installer des pilotes (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ). </li><li>  S'il est n√©cessaire d'utiliser des utilitaires avec de tels pilotes (diagnostic, pour la mise √† jour du BIOS, etc.), supprimez les pilotes apr√®s utilisation. </li><li>  Configurez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Device Guard</a> (si vous √™tes un heureux propri√©taire de Windows 10).  En utilisant cette technologie, vous pouvez cr√©er votre propre politique d'int√©grit√© du code et ajouter des listes blanches de programmes et de certificats.  Par exemple, ajoutez √† la strat√©gie l'exigence selon laquelle tout pilote en mode noyau doit avoir une signature Microsoft WHQL.  Dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article, vous pouvez mieux vous familiariser avec la configuration de Device Guard √† cet effet. </li></ul><br><p>  Les fabricants feraient mieux de ne pas signer de tels pilotes.  Si l'utilisateur doit mettre √† jour le BIOS, v√©rifier le syst√®me pour les vuln√©rabilit√©s (bonjour, chipsec), mesurer les performances ou effectuer d'autres manipulations qui n√©cessitent l'installation de tels pilotes, il peut tr√®s bien passer en mode test, faire tout cela, puis quitter.  L'utilisabilit√© diminuera alors, mais la s√©curit√© augmentera. </p><br><h2 id="vyvody">  <strong>Conclusions</strong> </h2><br><p>  Si quelque chose est sign√©, vous ne pouvez pas lui faire confiance de toute fa√ßon.  Premi√®rement, vous pouvez signer quelque chose comme √ßa, et deuxi√®mement, un attaquant peut profiter de celui-ci sign√© (m√™me s'il s'agit d'un fabricant de confiance). </p><br><p>  Les sp√©cialistes de la s√©curit√© des informations ne doivent pas exclure du mod√®le de menace les situations o√π un attaquant a besoin d'un pilote dot√© de fonctionnalit√©s dangereuses pour effectuer une attaque.  Il y a suffisamment de tels pilotes, c'est assez simple √† faire.  Si l'attaque n'est pas effectu√©e avec un pilote pop tel que RwEverything, mais avec un pilote moins connu, il sera encore plus difficile de le d√©tecter.  Vous devez donc √™tre en alerte, surveiller ces choses et ne pas permettre √† chaque pilote de d√©marrer dans le syst√®me. </p><br><p>  Auteur: Elizaveta Khomenko </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468691/">https://habr.com/ru/post/fr468691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468677/index.html">L'annonce du smartphone Xiaomi Mi Mix Alpha</a></li>
<li><a href="../fr468679/index.html">L'ABC de la s√©curit√© dans Kubernetes: authentification, autorisation, audit</a></li>
<li><a href="../fr468683/index.html">Th√©orie et pratique de la normalisation des services Docker</a></li>
<li><a href="../fr468687/index.html">Nous analysons les nouvelles initiatives de la Banque centrale pour r√©guler le march√© boursier: 3 groupes d'investisseurs, restrictions pour les d√©butants</a></li>
<li><a href="../fr468689/index.html">Enregistrer votre entreprise informatique √† Singapour: que dois-je faire?</a></li>
<li><a href="../fr468693/index.html">Comment l'automatisation d√©truit les employ√©s de Walmart</a></li>
<li><a href="../fr468695/index.html">Mon premier hack: un site qui vous permet de d√©finir n'importe quel mot de passe utilisateur</a></li>
<li><a href="../fr468697/index.html">DB & DWH MeetUp # 5 √† Raiffeisenbank</a></li>
<li><a href="../fr468705/index.html">Appel vid√©o dans le navigateur sur PeerJS. D√©marrage rapide</a></li>
<li><a href="../fr468707/index.html">Open PostgreSQL Meetup Enregistrement et diffusion d'enregistrement UPD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>