<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛄️ 🏊 👼🏿 AWC推出Firecracker-Linux的微虚拟化 👩🏾‍🤝‍👨🏿 ⏮️ 😓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在近日在拉斯维加斯举行的AWS re：Invent 2018大会上， Firecracker宣布了发布，这是一种基于Linux KVM的新型开源虚拟化技术。 作者承诺，“您可以在一秒钟内在非虚拟化环境中运行轻量级微型虚拟机（microVM），以安全性和工作负载隔离以及容器的形式，以有效利用资源的形式...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>AWC推出Firecracker-Linux的微虚拟化</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/431192/"><img src="https://habrastorage.org/webt/u3/id/kt/u3idktbg-oinefp_lamb-ahpbuw.png"><br><br> 在近日在拉斯维加斯举行的AWS re：Invent 2018大会上， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Firecracker</a>宣布<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了</a>发布，这是一种基于Linux KVM的新型开源虚拟化技术。 作者承诺，“您可以在一秒钟内在非虚拟化环境中运行轻量级微型虚拟机（microVM），以安全性和工作负载隔离以及容器的形式，以有效利用资源的形式，获得传统VM的优势。” <a name="habracut"></a><br><br><h2> 背景知识 </h2><br>  Firecracker由Amazon Web Services员​​工开发，他们致力于改善服务使用者（例如AWS Lambda（于2014年推出，今天已经可以说无服务器模型<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">继续</a>存在）和AWS Fargate（一年前出现）之类的服务的资源消耗和整体寿命。 ） <br><br> 该项目基于Chromium OS的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>crosvm</b></a> ，它来自Google的开源开发， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>该</b></a>开发用Rust编写，负责使用设备虚拟化（但不模拟真实硬件）启动操作系统。 因此，Firecracker代码也用<b>Rust语言</b>编写，其作者承诺将其更正返回给父项目的代码库，尽管这些项目本身在目的上存在很大差异。 <br><br>  Firecracker的首个公开发行版本（ <a href="">0.1.0</a> ）于今年3月发布，而最新的最新<a href="">发行版本</a> （ <a href="">0.11.0</a> ）就在几天前。 我在Internet上发布Firecracker之后不久就开始撰写本文，当时该项目在GitHub上拥有76星，而在发布时，这一数字已超过500。 <br><br><img src="https://habrastorage.org/webt/dv/lw/rp/dvlwrphawgnggwibwo-_l-0kp4g.jpeg"><br><br><h2> 爆竹功能 </h2><br>  Firecracker的主要组件是虚拟机监视器（VMM），它使用Linux KVM创建和运行所谓的microVM。 作者称他们的产品“是QEMU的基于云的替代产品”（由Kata Containers使用），“仅用于安全有效地启动容器”。 <br><br> 这是运行上述microVM的主机系统的示例： <br><br><img src="https://habrastorage.org/webt/an/fy/l7/anfyl7ot_k4kifx8lzjdbao_tiu.png"><br><br> 开发人员努力追求极简主义，包括仅在产品中包含最必要的东西，从而确保最低的内存成本，同时减少潜在漏洞的可能性。 在Firecracker中， <b>仅</b>模拟了<b>4种设备</b> ：virtio-net，virtio-block，串行控制台以及带有1个按钮的键盘，用于停止microVM的操作。 作为主机和来宾操作系统，当前支持基于<b>Linux内核版本4.14</b> <i>（去年11月<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发布</a> ）</i>及更高<b>版本的</b>操作系统，开发人员当前的计划是支持Linux内核的最后两个稳定分支。 在硬件方面，到目前为止，仅支持英特尔处理器，但AMD和ARM已列入议程。 <br><br> 爆竹本身由单个VMM进程组成，该进程在启动时使端点（RESTful）API在主机上可用。  API本身以OpenAPI格式<a href="">描述</a> ，尤其允许您使用指定的参数（内核映像，根文件系统，引导参数）启动microVM并停止它，配置虚拟机（vCPU数量，RAM，CPU模板），添加到网络接口，磁盘（表示为块设备，读写模式和只读模式可用）为日志和度量配置系统。 <br><br>  Firecracker的主要优点是安全（专注于多租户计算，几个隔离级别），高性能（可<b>在125 ms</b>内启动microVM，作者承诺明年将改善这一数字），最小的开销（每个microVM消耗约5兆字节）内存）。 什么使该项目更加重要-它已经在“战斗中”进行了测试，并提供了许多AWS服务（包括提到的Lambda和Fargate）的工作。 <br><br><h3> 安全细节 </h3><br> 爆竹的主要功能（其重点在于确保高级别的安全性）包括以下内容： <br><br><ol><li> 简单的访客模型（仅为所有访客提供最少的访客-请参阅上面有关4种设备的信息）。 </li><li> 使用cgroups和seccomp BPF以及一组有限的允许的系统调用隔离Firecracker进程。 </li><li>  Firecracker进程的静态链接可在与主机环境隔离的情况下启动它。 </li></ol><br><h2> 鞭炮演示 </h2><br>  AWS博客<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">展示了</a>如何尝试使用微型VM。 为此，只需创建一个i3.metal实例并向其中上传3个文件（ <code>firecracker</code>可执行文件，根FS映像，Linux内核）： <br><br><img src="https://habrastorage.org/webt/8j/8g/ls/8j8gls7xduigh5_fr2qv-bridvg.png"><br><br> 之后-为/ dev / kvm设置必要的权限： <br><br><pre> <code class="bash hljs">$ sudo setfacl -mu:<span class="hljs-variable"><span class="hljs-variable">${USER}</span></span>:rw /dev/kvm</code> </pre> <br> 设置第一台访客计算机的配置： <br><br><pre> <code class="bash hljs">$ curl --unix-socket /tmp/firecracker.sock -i \ -X PUT <span class="hljs-string"><span class="hljs-string">"http://localhost/machine-config"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{ \"vcpu_count\": 1, \"mem_size_mib\": 512 }"</span></span></code> </pre> <br>  ...然后是她的核心： <br><br><pre> <code class="bash hljs">$ curl --unix-socket /tmp/firecracker.sock -i \ -X PUT <span class="hljs-string"><span class="hljs-string">"http://localhost/boot-source"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{ \"kernel_image_path\": \"./hello-vmlinux.bin\", \"boot_args\": \"console=ttyS0 reboot=k panic=1 pci=off\" }"</span></span></code> </pre> <br>  ...和根FS： <br><br><pre> <code class="bash hljs">$ curl --unix-socket /tmp/firecracker.sock -i \ -X PUT <span class="hljs-string"><span class="hljs-string">"http://localhost/drives/rootfs"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">"{ \"drive_id\": \"rootfs\", \"path_on_host\": \"./hello-rootfs.ext4\", \"is_root_device\": true, \"is_read_only\": false }"</span></span></code> </pre> <br> 实际启动访客仍然需要： <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># curl --unix-socket /tmp/firecracker.sock -i \ -X PUT "http://localhost/actions" \ -H "accept: application/json" \ -H "Content-Type: application/json" \ -d "{ \"action_type\": \"InstanceStart\" }"</span></span></code> </pre> <br> 结果： <br><br><img src="https://habrastorage.org/webt/gs/sf/9r/gssf9rbraow5jfuzfzus_padlou.png"><br><br><h2> 那其他集装箱项目呢？ </h2><br> 尽管Firecracker的作者承诺它将“与流行的容器运行时集成”，但是当他们询问该项目是否可以与Kubernetes，Docker或Kata容器一起使用时，这是他们的<a href="">回答</a> ： <br><br><blockquote>  <i>“还没有。</i>  <i>我们正在将Firecracker开发为一个开源项目，因为它为启动容器提供了截然不同的安全性方法。</i>  <i>我们希望其他为容器创建开源技术的社区会发现它有用。</i>  <i>“我们正在努力确保Firecracker无缝集成到容器生态系统中-目标是在未来实现无缝集成，并在隔离容器工作负载方面具有更大的灵活性。”</i> </blockquote><br><h2> 聚苯乙烯 </h2><br> 另请参阅我们的博客： <br><br><ul><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetes中的Docker和其他可执行容器环境</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">过去，现在和未来</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Red Hat用Podman代替Docker</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CRI-O-Docker的替代品，用于在Kubernetes中启动容器</a> ”； </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">亚马逊上的Kubernetes（EKS）已公开可用。</a> ” </li><li>  “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Awless是一个强大的替代CLI实用程序，用于处理AWS服务</a> 。” </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN431192/">https://habr.com/ru/post/zh-CN431192/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN431180/index.html">服务器上的Ext JS</a></li>
<li><a href="../zh-CN431184/index.html">使用Mesh Connex技术的WIFI多跳网状网络</a></li>
<li><a href="../zh-CN431186/index.html">按类型设计：如何使无效状态在C＃中无法表达</a></li>
<li><a href="../zh-CN431188/index.html">在俄罗斯阻止互联网的技术方面。 挑战与前景</a></li>
<li><a href="../zh-CN431190/index.html">如何在不与SEO达成协议的情况下评估SEO公司的水平</a></li>
<li><a href="../zh-CN431194/index.html">温暖的管铁杆。 DotNext 2018莫斯科怎么样</a></li>
<li><a href="../zh-CN431196/index.html">Yandex.Taxi如何使用机器学习预测汽车交付时间</a></li>
<li><a href="../zh-CN431198/index.html">调度员如何工作</a></li>
<li><a href="../zh-CN431200/index.html">戈多：关于定期使用静态代码分析器的问题</a></li>
<li><a href="../zh-CN431202/index.html">Debian和Devuan联手sysvinit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>