<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì§ ü§¥üèæ üßíüèº Menggunakan Tempat Asli Apple üõÖ üè∞ üë©üèø‚Äçü§ù‚Äçüë®üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beberapa tahun yang lalu saya mengerjakan proyek yang seharusnya memiliki fitur serupa dengan Snapchat dan pada saat yang sama menjadi aplikasi mirip ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menggunakan Tempat Asli Apple</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462465/"><img width="300" align="right" src="https://habrastorage.org/webt/wg/mk/7p/wgmk7pk9kfkatujkomconugqpg8.png" alt="gambar">  Beberapa tahun yang lalu saya mengerjakan proyek yang seharusnya memiliki fitur serupa dengan Snapchat dan pada saat yang sama menjadi aplikasi mirip Instagram yang bertema sempit.  Proyek ini dikembangkan hanya untuk satu platform - iOS.  Secara alami, selama pengembangan fitur utama - menerbitkan foto, klien tiba-tiba ingin menambahkan kemampuan untuk menandai tempat di mana foto itu diambil.  Dalam kebanyakan kasus, banyak yang langsung mengingat Places API dari Google dan Facebook, tetapi klien tidak senang dengan kenyataan bahwa solusi ini memiliki batasan tertentu.  Oleh karena itu, setelah ulasan tambahan, alternatif lain dari Apple ditemukan - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CLPlacemark</a> , yang gratis, dan dalam dokumentasi pada waktu itu tidak disebutkan batasan untuk penggunaan sehari-hari.  Karena pengembangan untuk platform lain pada awalnya tidak direncanakan sama sekali, ini sepertinya pilihan yang sangat cocok. <br><a name="habracut"></a><br>  Dokumentasi Apple menunjukkan bahwa CLPlacemark dapat memberikan banyak detail tentang poin tersebut, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CLGeocoder</a> juga memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">metode</a> yang memungkinkan Anda untuk dengan mudah mengembalikan array CLPlacemark dengan data yang diperlukan berdasarkan nama lokasi.  Ternyata, semuanya bekerja tidak begitu cerah. <br><br>  Kode sumbernya terlihat seperti ini: <br><br><pre><code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CoreLocation let geocoder = CLGeocoder() func findPlace(name: String) { geocoder.geocodeAddressString(name) { placemarks, error in print(placemarks) } } findPlace(name: ‚ÄúNew‚Äù)</code> </pre> <br>  Dalam skenario sederhana ini, geocoder selalu mengembalikan array CLPlacemark, tetapi tangkapannya adalah array ini tidak pernah mengandung lebih dari satu elemen.  Akibatnya, di seluruh layar, tempat daftar besar penempatan diharapkan seperti: New York, New Zeland, New Balance Store, dll., Saya hanya menerima satu elemen yang tidak selalu relevan dengan apa yang saya masukkan. <br><br>  Setelah beberapa perjuangan yang gagal dengan CLGeocoder, kolega saya mengatakan kepada saya: "Dan Anda tidak berpikir untuk mencoba melihat, mungkin MapKit memiliki peluang yang sama?"  Ternyata, MapKit memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MKLocalSearch</a> , di mana kita bisa mendapatkan larik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MKPlacemark</a> , yang diwarisi dari CLPlacemark.  Sirkuit tampak cukup berfungsi, jadi saya mulai mencoba pendekatan ini: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MapKit let request = MKLocalSearchRequest() var localSearch: MKLocalSearch? func findPlace(name: String) { request.naturalLanguageQuery = text localSearch = MKLocalSearch(request: request) localSearch?.start { (searchResponse, _) in guard let items = searchResponse?.mapItems else { return } print(items) } } findPlace(name: ‚ÄúNew)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Hasil</b> <div class="spoiler_text"><img width="300" src="https://habrastorage.org/webt/ca/lz/7l/calz7lugmo8zxu97zizbenvnqbi.jpeg"></div></div><br>  Dalam hal ini, saya menerima array dengan 10 elemen CLPlacemark sebagai respons.  Hasil ini tampaknya lebih dapat diterima, karena sebagai hasilnya, daftar yang cukup disediakan.  Namun jauh dari biasanya, ketika Anda mulai memasukkan nama salah satu institusi yang berada di dekatnya, itu langsung menunjukkan hasil yang diinginkan.  Misalnya, Domino's Pizza ada di sebelah saya.  Saya ingin itu ketika saya memasukkan permintaan seperti itu dalam satu baris, pertama-tama saya harus mendapatkan perusahaan sedekat mungkin dengan saya. <br><br>  Saya mulai belajar atas dasar apa array terbentuk, dan bagaimana bisa ditingkatkan.  Saya telah mengidentifikasi beberapa hal yang dapat memengaruhi pemilihan parameter: <br><br><ol><li>  Alamat IP dari mana permintaan dibuat untuk Apple.  Ketika VPN dihidupkan, objek dalam hasil sudah lebih dekat ke lokasi server VPN. </li><li>  Lokasi pengguna saat ini.  Jika koordinat pengguna saat ini dikirim ke permintaan, hasilnya akan jauh lebih akurat. </li><li>  Bahasa sistem perangkat. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Contoh VPN</b> <div class="spoiler_text"><img width="300" src="https://habrastorage.org/webt/t1/zt/os/t1ztoss0yanftclwrzckdemegda.jpeg"></div></div><br><div class="spoiler">  <b class="spoiler_title">Contoh VPN</b> <div class="spoiler_text">  <b>New york</b> <br><img width="300" src="https://habrastorage.org/webt/c_/yj/bp/c_yjbpjus2nwmag4dm33cbotuai.jpeg"><br>  <b>Toronto</b> <br><img width="300" src="https://habrastorage.org/webt/qv/by/rf/qvbyrf2bv3xlwjgf7f7dbn6d--i.jpeg"><br>  <b>Kyiv</b> <br><img width="300" src="https://habrastorage.org/webt/br/7-/uj/br7-uj3dnanlwpoxfu5edxigfb4.jpeg"><br>  <b>London</b> <br><img width="300" src="https://habrastorage.org/webt/vt/4i/yt/vt4iyt0qhs0bcltjduaf53gz3pk.jpeg"><br>  <b>Frankfurt</b> <br><img width="300" src="https://habrastorage.org/webt/he/8x/hd/he8xhd7wg_er5xusctuvya1w138.jpeg"><br></div></div><br>  Ada kemungkinan bahwa ada faktor-faktor lain yang dapat mempengaruhi hasil pencarian, tetapi ini sudah cukup bagi saya untuk mencapai hasil yang diinginkan. <br><br>  Kursus pengembangan selanjutnya adalah penggunaan lokasi perangkat saat ini. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UIKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MapKit <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CoreLocation final class ViewController: UIViewController, CLLocationManagerDelegate { private let locationManager = CLLocationManager() private let request = MKLocalSearch.Request() private var localSearch: MKLocalSearch? private var region = MKCoordinateRegion() override func viewDidLoad() { super.viewDidLoad() if CLLocationManager.locationServicesEnabled() { locationManager.delegate = self locationManager.desiredAccuracy = kCLLocationAccuracyBest locationManager.requestWhenInUseAuthorization() locationManager.startUpdatingLocation() } } func searchPlace(_ place: String) { localSearch?.cancel() request.naturalLanguageQuery = place request.region = region localSearch = MKLocalSearch(request: request) localSearch?.start { [weak self] response, error in let mapItems = response.mapItems <span class="hljs-comment"><span class="hljs-comment">//     MKMapItem } } // MARK: - CLLocationManagerDelegate func locationManager(_ manager: CLLocationManager, didUpdateLocations locations: [CLLocation]) { guard let lastLocation = locations.last else { return } let span = MKCoordinateSpan(latitudeDelta: 0.5, longitudeDelta: 0.5) region = MKCoordinateRegion(center: lastLocation.coordinate, span: span) } }</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Hasil</b> <div class="spoiler_text">  Lokasi perangkat saat ini - Madrid, penyedia Internet Vodafone ES <br><img width="300" src="https://habrastorage.org/webt/rb/fp/5u/rbfp5uei98rnxz9iqfcso_nm2-y.jpeg"></div></div><br>  Dalam metode delagate didUpdateLocations, kami membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MKCoordinateSpan</a> .  Jika saya memahami dokumentasi Apple dengan benar, maka semakin rendah nilai yang kami tetapkan Delta lintang / bujur, semakin sempit (dan lebih akurat) wilayah kami saat ini akan ditunjukkan, karena itu adalah semacam zoom pada koordinat kami saat ini di MapKit. <br>  Setelah itu, memang, prioritas ekstradisi berubah dan menunjukkan kepada saya terutama tempat-tempat yang di sebelah saya. <br><br>  Tetap hanya untuk membuat nama-nama dalam daftar lebih indah.  Karena terkadang, beberapa properti CLPlacemark mungkin memiliki nama yang sama, pada akhirnya itu tidak akan terlihat sangat bagus: New York, New York, NY.  Untuk melakukan ini, Anda perlu membuat Struktur terpisah, yang akan membentuk nama yang indah dalam daftar. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MapKit struct Placemark { let location: String init(item: MKMapItem) { var locationString: String = "" if let name = item.name { locationString += "\(name)" } if let locality = item.placemark.locality, locality != item.name { locationString += ", \(locality)" } if let administrativeArea = item.placemark.administrativeArea, administrativeArea != item.placemark.locality { locationString += ", \(administrativeArea)" } if let country = item.placemark.country, country != item.name { locationString += ", \(country)" } location = locationString } }</code> </pre><br>  Kemudian, sudah menanggapi pencarian, kita dapat dengan mudah memetakan CLPlacemark ke dalam struktur yang dibuat dan meneruskannya ke daftar. <br><br><pre> <code class="swift hljs">localSearch?.start { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] searchResponse, error <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> items = searchResponse?.mapItems <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-comment"><span class="hljs-comment">//  CLPlacemark    let placemarks = items.map { Placemark(item: $0) } }</span></span></code> </pre><br>  Sekarang hasilnya terlihat lebih elegan dan sudah dapat digunakan dalam proyek untuk menandai lokasi yang dikunjungi. <br><br>  Salah satu kelemahan utama adalah bahwa Anda dapat menggunakan solusi ini hanya jika proyek dipertajam untuk iOS / Mac OS.  Jika proyek ini melibatkan pengembangan untuk platform lain, saya akan merekomendasikan menggunakan solusi dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Google</a> atau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Facebook</a> .  Juga, tidak semua lokasi ditentukan secara ideal di semua wilayah. <br><br>  Anda dapat melihat kode akhir proyek di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id462465/">https://habr.com/ru/post/id462465/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id462453/index.html">Integrasi cepat dengan 1C: Enterprise</a></li>
<li><a href="../id462455/index.html">Kehidupan Rahasia Pengukir Laser</a></li>
<li><a href="../id462457/index.html">4 rilis Maltego. Prinsip kerja dan peluang</a></li>
<li><a href="../id462459/index.html">Menambahkan Perangkat ZigBee ke Homebridge Menggunakan CC2531</a></li>
<li><a href="../id462461/index.html">GOES-17 Hasil Investigasi Kecelakaan</a></li>
<li><a href="../id462467/index.html">Frontend Weekly Digest (29 Juli - 4 Agustus 2019)</a></li>
<li><a href="../id462469/index.html">Beberapa Pertimbangan untuk Komputasi Bersamaan dalam R untuk Tugas "Perusahaan"</a></li>
<li><a href="../id462471/index.html">Pemecahan masalah dengan pwnable.kr 16 - uaf. Gunakan setelah kerentanan gratis</a></li>
<li><a href="../id462473/index.html">Kami sedang mengembangkan lingkungan untuk bekerja dengan layanan microser. Bagian 1 menginstal Kubernetes HA pada bare metal (Debian)</a></li>
<li><a href="../id462475/index.html">Alexey Savvateev: Bagaimana cara memerangi korupsi dengan bantuan matematika (Hadiah Nobel Ekonomi untuk 2016)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>