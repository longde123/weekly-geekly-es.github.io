<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçú üè£ üñåÔ∏è Modernizaci√≥n de GHIDRA. Cargador para ron Sega Mega Drive üí™ üôãüèª ü§∑üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saludos, camaradas. No he o√≠do hablar del GHIDRA a√∫n no de c√≥digo GHIDRA , probablemente solo un ingeniero inverso sordo / ciego / tonto / sin Interne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modernizaci√≥n de GHIDRA. Cargador para ron Sega Mega Drive</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444562/"><p><img src="https://habrastorage.org/webt/_v/rj/sh/_vrjshbx1kl_9rudbdgaly0wd8c.png"></p><br><p> Saludos, camaradas.  No he o√≠do hablar del <code>GHIDRA</code> a√∫n no de c√≥digo <code>GHIDRA</code> , probablemente solo un ingeniero inverso sordo / ciego / tonto / sin Internet.  Sus capacidades listas para usar son incre√≠bles: descompiladores para todos los procesadores compatibles, simple adici√≥n de nuevas arquitecturas (con descompilaci√≥n activa inmediata debido a la conversi√≥n competente a IR), un mont√≥n de scripts que simplifican la vida, la posibilidad de <code>Undo</code> / <code>Redo</code> ... Y esto es solo una parte muy peque√±a de todas las caracter√≠sticas proporcionadas.  Decir que me impresion√≥ es no decir casi nada. <a name="habracut"></a></p><br><p>  Entonces, en este art√≠culo, me gustar√≠a contarles c√≥mo escrib√≠ mi primer m√≥dulo para <code>GHIDRA</code> , un cargador de ron para juegos para <code>Sega Mega Drive / Genesis</code> .  Para escribirlo necesitaba ... ¬°solo un par de horas!  Vamos </p><br><div class="spoiler">  <b class="spoiler_title">¬øPero qu√© hay de la IDA?</b> <div class="spoiler_text"><p>  Pas√© algunos d√≠as entendiendo el proceso de escribir descargadores para la <code>IDA</code> .  Entonces parec√≠a que era la versi√≥n <code>6.5</code> , pero en aquellos d√≠as hab√≠a muchos problemas con la documentaci√≥n del SDK. </p></div></div><br><h2 id="podgotavlivaem-sredu-razrabotki">  Preparamos el entorno de desarrollo. </h2><br><p>  <code>GHIDRA</code> desarrolladores de <code>GHIDRA</code> pensaron en casi todo ( <em>Ilfak</em> , ¬ød√≥nde has estado antes?).  Y, para simplificar la implementaci√≥n de la nueva funcionalidad, desarrollaron un complemento para <code>Eclipse</code> : <code>GhidraDev</code> , que en realidad " <em>ayuda</em> " a escribir c√≥digo.  El complemento est√° integrado en el entorno de desarrollo y le permite crear plantillas de proyecto para scripts, cargadores, m√≥dulos de procesador y extensiones para ellos, as√≠ como exportar m√≥dulos (seg√∫n tengo entendido, esto es alg√∫n tipo de exportaci√≥n de datos de un proyecto) con unos pocos clics. </p><br><p>  Para instalar el complemento, descargue <code>Eclipse</code> para <code>Java</code> , haga clic en <code>Help</code> -&gt; <code>Install New Software...</code> , luego haga clic en el bot√≥n <code>Add</code> y abra el cuadro de di√°logo de selecci√≥n de archivo con el complemento usando el bot√≥n <code>Archive...</code>  El archivo con <code>GhidraDev</code> se encuentra en el <code>$(GHIDRA)/Extensions/Eclipse/GhidraDev</code> .  Selecci√≥nelo, haga clic en el bot√≥n <code>Add</code> . </p><br><p><img src="https://habrastorage.org/webt/iq/ox/e3/iqoxe3k8b5www3rqb6i0cy_xadg.png"></p><br><p>  En la lista que aparece, ponga un <code>Ghidra</code> a <code>Ghidra</code> , haga clic en <code>Next &gt;</code> , acepte los acuerdos, haga clic en <code>Install Anyway</code> (porque el complemento no tiene una firma) y reinicie <code>Eclipse</code> . </p><br><p><img src="https://habrastorage.org/webt/h_/5h/_a/h_5h_auzh5po7rvzaaywyvzxz9o.png"></p><br><p>  En total, aparecer√° un nuevo elemento de <code>GhidraDev</code> en el <code>GhidraDev</code> IDE para la creaci√≥n y distribuci√≥n conveniente de sus proyectos (por supuesto, tambi√©n puede crear a trav√©s del asistente habitual para nuevos proyectos de <code>Eclipse</code> ).  Adem√°s, tenemos la oportunidad de depurar el complemento o script desarrollado. </p><br><p><img src="https://habrastorage.org/webt/ka/3m/tg/ka3mtgmipvkbbmib3bilgamwe44.png"></p><br><div class="spoiler">  <b class="spoiler_title">¬øY d√≥nde est√° el depurador de aplicaciones?</b> <div class="spoiler_text"><p>  Lo que realmente enfurece la situaci√≥n con <code>GHIDRA</code> son los jodidos art√≠culos de publicidad ronca que contienen casi el mismo material, lo que, adem√°s, no es cierto.  Un ejemplo?  S√≠, por favor: </p><br><blockquote>  La versi√≥n actual de la herramienta es 9.0.  y la herramienta tiene opciones para incluir funcionalidades adicionales como Criptoan√°lisis, interacci√≥n con OllyDbg, el depurador de Ghidra. </blockquote><p>  ¬øY d√≥nde est√° todo esto?  No! </p><br><p>  El segundo punto: apertura.  De hecho, est√° casi all√≠, pero es pr√°cticamente inexistente.  La <code>GHIDRA</code> contiene c√≥digos fuente para componentes que se escribieron en <code>Java</code> , pero si <code>Gradle</code> scripts de <code>Gradle</code> , puede ver que hay dependencias en un mont√≥n de proyectos externos de los secretos. <del>  laboratorios </del>  Repositorios de la <code>NSA</code> . <br>  Al momento de escribir, no hay <code>SLEIGH</code> descompilador y <code>SLEIGH</code> (esta es una utilidad para compilar descripciones de m√≥dulos de procesador y conversiones a IR). </p><br><p>  Bueno, bueno, estoy distra√≠do por algo. </p></div></div><br><p>  Entonces, creemos un nuevo proyecto en <code>Eclipse</code> . </p><br><h2 id="sozdayom-proekt-zagruzchika">  Crear un proyecto de cargador </h2><br><p>  <code>GhidraDev</code> -&gt; <code>New</code> -&gt; <code>Ghidra Module Project...</code> </p><br><p>  Indicamos el nombre del proyecto (tenemos en cuenta que las palabras del tipo <code>Loader</code> se pegar√°n a los nombres de los archivos, y para no obtener algo como <code>sega_loaderLoader.java</code> , los <code>sega_loaderLoader.java</code> en consecuencia). </p><br><p><img src="https://habrastorage.org/webt/ok/iq/kx/okiqkxnztehs89bnjh3wzen848w.png"></p><br><p>  Haga clic en <code>Next &gt;</code> .  Aqu√≠ ponemos daws delante de las categor√≠as que necesitamos.  En mi caso, esto es solo un <code>Loader</code> .  Haga clic en <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/3g/-c/_6/3g-c_6t4e10co47udy8txa7udiq.png"></p><br><p>  Aqu√≠ indicamos la ruta al directorio con <code></code> .  Haga clic en <code>Next &gt;</code> . </p><br><p><img src="https://habrastorage.org/webt/9p/j6/kc/9pj6kcva-wqfiggwzf3itwssqm8.png"></p><br><p>  <code>GHIDRA</code> permite escribir scripts en python (a trav√©s de <code>Jython</code> ).  Escribir√© en <code>Java</code> , as√≠ que no pongo un daw.  Presiono <code>Finish</code> . </p><br><p><img src="https://habrastorage.org/webt/_d/dr/z5/_ddrz5hnlfc0g-fnztl248er0tw.png"></p><br><h2 id="pishem-kod">  Escribir un c√≥digo </h2><br><p>  El √°rbol del proyecto vac√≠o se ve impresionante: </p><br><p><img src="https://habrastorage.org/webt/mn/vf/fx/mnvffx-jubdk6uqdcpw5njysqfe.png"></p><br><p>  Todos los archivos con c√≥digo <code>java</code> est√°n en la rama <code>/src/main/java</code> : </p><br><p><img src="https://habrastorage.org/webt/xz/sx/6_/xzsx6_dw-avgpgufemblxrnbutm.png"></p><br><h3 id="getname">  getName () </h3><br><p>  Para comenzar, elija un nombre para el gestor de arranque.  El m√©todo <code>getName()</code> devuelve: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Sega Mega Drive / Genesis Loader"</span></span>; }</code> </pre> <br><h3 id="findsupportedloadspecs">  findSupportedLoadSpecs () </h3><br><p>  El m√©todo <code>findSupportedLoadSpecs()</code> decide (en base a los datos contenidos en el archivo binario) qu√© m√≥dulo de procesador debe usarse para el desmontaje (as√≠ como en el <code>IDA</code> ).  En la terminolog√≠a de <code>GHIDRA</code> esto se llama <code>Compiler Language</code> .  Incluye: procesador, endianness, bitness y compilador (si se conoce). </p><br><p>  Este m√©todo devuelve una lista de arquitecturas e idiomas compatibles.  Si los datos est√°n en el formato incorrecto, simplemente devolvemos una lista vac√≠a. </p><br><p>  Entonces, en el caso de <code>Sega Mega Drive</code> , la palabra " <code>SEGA</code> " suele estar presente en el desplazamiento <code>0x100</code> encabezado (esto no es un requisito previo, pero se cumple en el 99% de los casos).  Debe verificar si esta l√≠nea est√° en el archivo importado.  Para hacer esto, el <code>ByteProvider provider</code> se <code>ByteProvider provider</code> <code>findSupportedLoadSpecs()</code> , con la que trabajaremos con el archivo. </p><br><p>  Creamos un objeto <code>BinaryReader</code> , para la conveniencia de leer datos de un archivo: </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  El argumento <code>false</code> en este caso indica el uso de <code>Big Endian</code> al leer.  Ahora leamos la l√≠nea.  Para hacer esto, use el <code>readAsciiString(offset, size)</code> del objeto <code>reader</code> : </p><br><pre> <code class="java hljs">reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))</code> </pre> <br><p>  Si <code>equals()</code> devuelve <code>true</code> , entonces estamos tratando con ron Segov, y en la lista <code>List&lt;LoadSpec&gt; loadSpecs = new ArrayList&lt;&gt;();</code>  ser√° posible agregar Motorola <code>m68k</code> .  Para hacer esto, cree un nuevo objeto de tipo <code>LoadSpec</code> , <code>LoadSpec</code> constructor acepte un objeto de cargador (en este caso, <code>this</code> ), <code>ImageBase</code> , en el que se cargar√° la ROM, un objeto de tipo <code>LanguageCompilerSpecPair</code> y una bandera: este <code>LoadSpec</code> entre los dem√°s en la lista (s√≠, en la lista puede haber m√°s de una <code>LoadSpec</code> ). </p><br><p>  El formato del constructor para <code>LanguageCompilerSpecPair</code> siguiente: </p><br><ol><li>  El primer argumento es <code>languageID</code> , una cadena de la forma " <em>ProcessorName: Endianness: Bits: ExactCpu</em> ".  En mi caso, deber√≠a ser la l√≠nea " <em>68000: BE: 32: MC68020</em> " (desafortunadamente, el <code>MC68000</code> no est√° incluido en la entrega, pero esto no es un problema).  <code>ExactCpu</code> puede ser <code>default</code> </li><li>  El segundo argumento, <code>compilerSpecID</code> , para encontrar lo que necesita especificar aqu√≠, se puede encontrar en el directorio con las descripciones del procesador <code></code> ( <code>$(GHIDRA)/Ghidra/Processors/68000/data/languages</code> ) en el archivo <code>68000.opinion</code> .  Vemos que aqu√≠ solo se indica el <code>default</code> .  En realidad, lo indicamos </li></ol><br><p>  Como resultado, tenemos el siguiente c√≥digo (como puede ver, nada complicado hasta ahora): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Collection&lt;LoadSpec&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findSupportedLoadSpecs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ List&lt;LoadSpec&gt; loadSpecs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.readAsciiString(<span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>).equals(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(<span class="hljs-string"><span class="hljs-string">"SEGA"</span></span>))) { loadSpecs.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoadSpec(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LanguageCompilerSpecPair(<span class="hljs-string"><span class="hljs-string">"68000:BE:32:MC68020"</span></span>, <span class="hljs-string"><span class="hljs-string">"default"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadSpecs; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">La diferencia entre IDA y GHIDRA en t√©rminos de m√≥dulos</b> <div class="spoiler_text"><p>  Hay una diferencia, y todav√≠a es muy fuerte.  En <code>GHIDRA</code> puede escribir un proyecto que comprenda diferentes arquitecturas, diferentes formatos de datos, sea un cargador, un m√≥dulo de procesador, la expansi√≥n de la funcionalidad del descompilador y otras ventajas. </p><br><p>  En <code>IDA</code> , este es un proyecto separado para cada tipo de complemento. </p><br><p>  ¬øCu√°nto m√°s conveniente?  En mi opini√≥n, en <code>GHIDRA</code> , ¬°a veces! </p></div></div><br><h3 id="load">  carga () </h3><br><p>  En este m√©todo, crearemos segmentos, procesaremos datos de entrada, crearemos c√≥digo y etiquetas previamente conocidas.  Para hacer esto, los siguientes objetos se env√≠an para ayudarnos en la entrada: </p><br><ol><li>  <code>ByteProvider provider</code> : ya lo conocemos.  Trabajando con datos de archivos binarios </li><li>  <code>LoadSpec loadSpec</code> : especificaci√≥n de la arquitectura que fue seleccionada durante la fase de importaci√≥n del archivo usando el m√©todo <code>findSupportedLoadSpecs</code> .  Es necesario si, por ejemplo, podemos trabajar con varios formatos de datos en un m√≥dulo.  Conveniente </li><li>  <code>List&lt;Option&gt; options</code> : lista de opciones (incluida la personalizada).  Todav√≠a no he aprendido a trabajar con ellos. </li><li>  <code>Program program</code> : el objeto principal que proporciona acceso a toda la funcionalidad necesaria: listado, espacio de direcciones, segmentos, etiquetas, creaci√≥n de matrices, etc. </li><li>  <code>TaskMonitor monitor</code> y <code>TaskMonitor monitor</code> : rara vez tenemos que trabajar directamente con ellos (por lo general, simplemente pasando estos objetos a m√©todos ya preparados) </li><li>  <code>MessageLog log</code> : registrador en s√≠ </li></ol><br><p>  Entonces, para empezar, <code>GHIDRA</code> algunos objetos que simplificar√°n nuestro trabajo con <code>GHIDRA</code> entidades de <code>GHIDRA</code> y los datos existentes.  Por supuesto, definitivamente necesitaremos <code>BinaryReader</code> : </p><br><pre> <code class="java hljs">BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p>  Siguiente  Ser√° muy √∫til para nosotros y simplificar√° casi todo el objeto de la clase <code>FlatProgramAPI</code> (ver√° m√°s adelante qu√© puede hacer con √©l): </p><br><pre> <code class="java hljs">FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor);</code> </pre> <br><h4 id="zagolovok-roma">  Rumbo </h4><br><p>  Para empezar, determinaremos cu√°l es el t√≠tulo de un ron Sega ordinario.  En los primeros <code>0x100</code> bytes hay una tabla de 64 punteros DWORD a vectores, por ejemplo: <code>Reset</code> , <code>Trap</code> , <code>DivideByZero</code> , <code>VBLANK</code> y otros. </p><br><p>  Luego viene la estructura con el nombre de los roman√≠es, las regiones, las direcciones del principio y el final de los bloques <code>ROM</code> y <code>RAM</code> , la casilla de verificaci√≥n (el campo se marca a petici√≥n de los desarrolladores, y no el prefijo) y otra informaci√≥n. </p><br><p>  <code>java</code> clases de <code>java</code> para trabajar con estas estructuras, as√≠ como para implementar los tipos de datos que se agregar√°n a la lista de estructuras. </p><br><h4 id="vectorstable">  VectoresTabla </h4><br><p>  Creamos una nueva clase <code>VectorsTable</code> y, atenci√≥n, indicamos que implementa la interfaz <code>StructConverter</code> .  En esta clase almacenaremos las direcciones de los vectores (para uso futuro) y sus nombres. </p><br><p><img src="https://habrastorage.org/webt/au/3c/m-/au3cm-qdnrviqcgqtn_asztwbao.png"></p><br><p>  Declaramos una lista de nombres de vectores y su n√∫mero: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_SIZE = <span class="hljs-number"><span class="hljs-number">0x100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VECTORS_COUNT = VECTORS_SIZE / <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] VECTOR_NAMES = { <span class="hljs-string"><span class="hljs-string">"SSP"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reset"</span></span>, <span class="hljs-string"><span class="hljs-string">"BusErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"AdrErr"</span></span>, <span class="hljs-string"><span class="hljs-string">"InvOpCode"</span></span>, <span class="hljs-string"><span class="hljs-string">"DivBy0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Check"</span></span>, <span class="hljs-string"><span class="hljs-string">"TrapV"</span></span>, <span class="hljs-string"><span class="hljs-string">"GPF"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trace"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv4"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadInt"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv13"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv16"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv17"</span></span>, <span class="hljs-string"><span class="hljs-string">"BadIRQ"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ1"</span></span>, <span class="hljs-string"><span class="hljs-string">"EXT"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ3"</span></span>, <span class="hljs-string"><span class="hljs-string">"HBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ5"</span></span>, <span class="hljs-string"><span class="hljs-string">"VBLANK"</span></span>, <span class="hljs-string"><span class="hljs-string">"IRQ7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap1"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap2"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap3"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap4"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap5"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap6"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap7"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap8"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap9"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap10"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap11"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap12"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap13"</span></span>,<span class="hljs-string"><span class="hljs-string">"Trap14"</span></span>, <span class="hljs-string"><span class="hljs-string">"Trap15"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv30"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv31"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv32"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv33"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv34"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv35"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv36"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv37"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv38"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv39"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3A"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3B"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3C"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3D"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3E"</span></span>, <span class="hljs-string"><span class="hljs-string">"Reserv3F"</span></span> };</code> </pre> <br><p>  Creamos una clase separada para almacenar la direcci√≥n y el nombre del vector: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address address; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Address address, String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.address = address; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> address; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } }</code> </pre> <br><p>  La lista de vectores se almacenar√° en la matriz de <code>vectors</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> VectorFunc[] vectors;</code> </pre> <br><p>  El constructor de <code>VectorsTable</code> aceptar√°: </p><br><ol><li>  <code>FlatProgramAPI fpa</code> para convertir direcciones <code>long</code> al tipo de datos de <code>Address</code> de Hydra (de hecho, este tipo de datos complementa el valor num√©rico simple de la direcci√≥n al vincularla a otro chip: el espacio de direcciones) </li><li>  <code>BinaryReader reader</code> - yardas de lectura </li></ol><br><p>  El objeto <code>toAddr()</code> tiene un m√©todo <code>toAddr()</code> , y el <code>reader</code> tiene <code>setPointerIndex()</code> y <code>readNextUnsignedInt()</code> .  En principio, no se requiere nada m√°s.  Obtenemos el c√≥digo: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; VECTORS_COUNT) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0</span></span>); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc[VECTORS_COUNT]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { vectors[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorFunc(fpa.toAddr(reader.readNextUnsignedInt()), VECTOR_NAMES[i]); } }</code> </pre> <br><p>  El m√©todo <code>toDataType()</code> , que debemos anular para implementar la estructura, debe devolver un objeto <code>Structure</code> en el que se deben declarar los nombres de los campos de estructura, sus tama√±os y comentarios en cada campo (puede usar <code>null</code> ): </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"VectorsTable"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; VECTORS_COUNT; ++i) { s.add(POINTER, <span class="hljs-number"><span class="hljs-number">4</span></span>, VECTOR_NAMES[i], <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br><p>  Bueno, implementemos m√©todos para obtener cada uno de los vectores, o la lista completa (un mont√≥n de c√≥digo repetitivo): </p><br><div class="spoiler">  <b class="spoiler_title">Otros m√©todos</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> VectorFunc[] getVectors() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSSP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBusErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">2</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdrErr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">3</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInvOpCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">4</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDivBy0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">5</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrapV</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">7</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">9</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">10</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">11</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">13</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">12</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">14</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">13</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">14</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">15</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">17</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">16</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">18</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">17</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">19</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">18</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">19</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">21</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">20</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">22</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">21</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">23</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">22</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv17</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">23</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBadIRQ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">24</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">26</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">25</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getEXT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">27</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">26</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">27</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">29</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">28</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">30</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">29</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVBLANK</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">30</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIRQ7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">31</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">33</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">32</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">34</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">33</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">35</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">34</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">36</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">35</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">37</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">36</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">38</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">37</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">39</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">38</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap7</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">39</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap8</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">40</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap9</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">42</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">41</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap10</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">43</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">42</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">43</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap12</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">45</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">44</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap13</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">45</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap14</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">46</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrap15</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">48</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">47</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv30</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">49</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">48</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv31</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">50</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">49</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv32</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">51</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">50</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv33</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">52</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">51</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv34</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">53</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">52</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv35</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">54</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">53</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv36</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">55</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">54</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv37</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">56</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">55</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv38</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">57</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">56</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv39</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">58</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">57</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3A</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">59</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">58</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3B</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">59</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3C</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">61</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">60</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3D</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">62</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">61</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3E</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">63</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">62</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> VectorFunc </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReserv3F</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vectors.length &lt; <span class="hljs-number"><span class="hljs-number">64</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vectors[<span class="hljs-number"><span class="hljs-number">63</span></span>]; }</code> </pre> </div></div><br><h4 id="gameheader">  Gameheader </h4><br><p>  Haremos lo mismo y crearemos una clase <code>GameHeader</code> que implemente la interfaz <code>StructConverter</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Estructura de encabezado de ron de juego</b> <div class="spoiler_text"><table><thead><tr><th>  Iniciar desplazamiento </th><th>  Fin de desplazamiento </th><th>  Descripci√≥n </th></tr></thead><tbody><tr><td>  $ 100 </td><td>  $ 10F </td><td>  Nombre de la consola (generalmente 'SEGA MEGA DRIVE' o 'SEGA GENESIS') </td></tr><tr><td>  $ 110 </td><td>  $ 11F </td><td>  Fecha de lanzamiento (generalmente '¬© XXXX AAAA.MMM' donde XXXX es el c√≥digo de la compa√±√≠a, AAAA es el a√±o y MMM - mes) </td></tr><tr><td>  $ 120 </td><td>  $ 14F </td><td>  Nombre nacional </td></tr><tr><td>  $ 150 </td><td>  $ 17F </td><td>  Nombre internacional </td></tr><tr><td>  $ 180 </td><td>  $ 18D </td><td>  Versi√≥n ('XX YYYYYYYYYYYY' donde XX es el tipo de juego y YY el c√≥digo del juego) </td></tr><tr><td>  $ 18E </td><td>  $ 18F </td><td>  Suma de comprobaci√≥n </td></tr><tr><td>  $ 190 </td><td>  $ 19F </td><td>  Soporte de E / S </td></tr><tr><td>  $ 1A0 </td><td>  $ 1A3 </td><td>  Inicio ROM </td></tr><tr><td>  $ 1A4 </td><td>  $ 1A7 </td><td>  ROM final </td></tr><tr><td>  $ 1A8 </td><td>  $ 1AB </td><td>  Inicio de RAM (generalmente $ 00FF0000) </td></tr><tr><td>  $ 1AC </td><td>  $ 1AF </td><td>  Fin de RAM (generalmente $ 00FFFFFF) </td></tr><tr><td>  $ 1B0 </td><td>  $ 1B2 </td><td>  'RA' y $ F8 habilita SRAM </td></tr><tr><td>  $ 1B3 </td><td>  ---- </td><td>  sin usar ($ 20) </td></tr><tr><td>  $ 1B4 </td><td>  $ 1B7 </td><td>  Inicio de SRAM (predeterminado $ 00200000) </td></tr><tr><td>  $ 1B8 </td><td>  $ 1BB </td><td>  Fin de SRAM (predeterminado $ 0020FFFF) </td></tr><tr><td>  $ 1BC </td><td>  $ 1FF </td><td>  Notas (sin usar) </td></tr></tbody></table></div></div><br><p>  Configuramos los campos, verificamos una longitud suficiente de los datos de entrada, usamos los dos nuevos m√©todos para <code>readNextByteArray()</code> , <code>readNextUnsignedShort()</code> del objeto <code>reader</code> para leer datos y crear una estructura.  El c√≥digo resultante es el siguiente: </p><br><div class="spoiler">  <b class="spoiler_title">Gameheader</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> sega; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.BinaryReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.app.util.bin.StructConverter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.flatapi.FlatProgramAPI; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.address.Address; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.DataType; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.Structure; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ghidra.program.model.data.StructureDataType; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StructConverter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] consoleName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] releaseDate = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] domesticName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] internationalName = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] version = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> checksum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] ioSupport = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address romStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, romEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address ramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] sramCode = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> unused = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Address sramStart = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, sramEnd = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] notes = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FlatProgramAPI fpa; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fpa = fpa; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader.length() &lt; <span class="hljs-number"><span class="hljs-number">0x200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } reader.setPointerIndex(<span class="hljs-number"><span class="hljs-number">0x100</span></span>); consoleName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); releaseDate = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); domesticName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); internationalName = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x30</span></span>); version = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x0E</span></span>); checksum = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>) reader.readNextUnsignedShort(); ioSupport = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x10</span></span>); romStart = fpa.toAddr(reader.readNextUnsignedInt()); romEnd = fpa.toAddr(reader.readNextUnsignedInt()); ramStart = fpa.toAddr(reader.readNextUnsignedInt()); ramEnd = fpa.toAddr(reader.readNextUnsignedInt()); sramCode = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x03</span></span>); unused = reader.readNextByte(); sramStart = fpa.toAddr(reader.readNextUnsignedInt()); sramEnd = fpa.toAddr(reader.readNextUnsignedInt()); notes = reader.readNextByteArray(<span class="hljs-number"><span class="hljs-number">0x44</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toDataType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Structure s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StructureDataType(<span class="hljs-string"><span class="hljs-string">"GameHeader"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ConsoleName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"ReleaseDate"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"DomesticName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x30</span></span>, <span class="hljs-string"><span class="hljs-string">"InternationalName"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-string"><span class="hljs-string">"Version"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(WORD, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-string"><span class="hljs-string">"Checksum"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-string"><span class="hljs-string">"IoSupport"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RomEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"RamEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x03</span></span>, <span class="hljs-string"><span class="hljs-string">"SramCode"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(BYTE, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-string"><span class="hljs-string">"Unused"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramStart"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(POINTER, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-string"><span class="hljs-string">"SramEnd"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); s.add(STRING, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-string"><span class="hljs-string">"Notes"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getConsoleName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> consoleName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getReleaseDate() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> releaseDate; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getDomesticName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domesticName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getInternationalName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> internationalName; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getVersion() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> version; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChecksum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> checksum; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getIoSupport() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioSupport; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRomEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> romEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRamEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ramEnd; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getSramCode() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUnused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> unused; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramStart; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Address </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSramEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramEnd; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasSRAM</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramCode == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sramCode[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'R'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; sramCode[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xF8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getNotes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> notes; } }</code> </pre> </div></div><br><p>  Crear objetos para el encabezado: </p><br><pre> <code class="java hljs">vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader);</code> </pre> <br><h4 id="segmenty">  Segmentos </h4><br><p>  Sega tiene un mapa bien conocido de regiones de memoria, que, quiz√°s, no dar√© aqu√≠ en forma de tabla, pero solo dar√© el c√≥digo que se usa para crear los segmentos. </p><br><p>  Entonces, el objeto de la clase <code>FlatProgramAPI</code> tiene un m√©todo <code>createMemoryBlock()</code> , con el cual es conveniente crear regiones de memoria.  En la entrada, toma los siguientes argumentos: </p><br><ol><li>  <code>name</code> : nombre de la regi√≥n </li><li>  <code>address</code> : direcci√≥n de inicio de la regi√≥n </li><li>  <code>stream</code> : un objeto de tipo <code>InputStream</code> que ser√° la base de los datos en la regi√≥n de memoria.  Si especifica <code>null</code> , se crear√° una regi√≥n no inicializada (por ejemplo, para <code>68K RAM</code> o <code>Z80 RAM</code> necesitaremos solo eso </li><li>  <code>size</code> : tama√±o de la regi√≥n creada </li><li>  <code>isOverlay</code> : acepta <code>true</code> o <code>false</code> , e indica que la regi√≥n de memoria est√° superpuesta.  Donde se necesita adem√°s de ejecutables </li></ol><br><p>  En la salida, <code>createMemoryBlock()</code> devuelve un objeto de tipo <code>MemoryBlock</code> , al que opcionalmente puede establecer banderas de derechos de acceso ( <code>Read</code> , <code>Write</code> , <code>Execute</code> ). </p><br><p>  Como resultado, obtenemos una funci√≥n de la siguiente forma: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createSegment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, InputStream stream, String name, Address address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> read, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> write, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> execute)</span></span></span><span class="hljs-function"> </span></span>{ MemoryBlock block = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { block = fpa.createMemoryBlock(name, address, stream, size, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); block.setRead(read); block.setWrite(read); block.setExecute(execute); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"Error creating %s segment"</span></span>, name)); } }</code> </pre> <br><p>  Aqu√≠ tambi√©n llamamos al m√©todo de <code>error</code> est√°tico de la clase <code>Msg</code> para mostrar un mensaje de error. </p><br><p>  Un segmento que contiene ron de juego puede tener un tama√±o m√°ximo de <code>0x3FFFFF</code> (todo lo dem√°s ya pertenecer√° a otras regiones).  Vamos a crearlo: </p><br><pre> <code class="java hljs">InputStream romStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0</span></span>); createSegment(fpa, romStream, <span class="hljs-string"><span class="hljs-string">"ROM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x000000</span></span>), Math.min(romStream.available(), <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre> <br><p>    <code>InputStream</code>    ,    0. </p><br><p>       ,     ( <code>SegaCD</code>  <code>Sega32X</code> ).        <code>OptionDialog</code> . , <code>showYesNoDialogWithNoAsDefaultButton()</code>      <code>YES</code>  <code>NO</code>   -  <code>NO</code> . </p><br><p>    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega CD segment?"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (romStream.available() &gt; <span class="hljs-number"><span class="hljs-number">0x3FFFFF</span></span>) { InputStream epaStream = provider.getInputStream(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>); createSegment(fpa, epaStream, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"EPA"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x400000</span></span>), <span class="hljs-number"><span class="hljs-number">0x400000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OptionDialog.YES_OPTION == OptionDialog.showYesNoDialogWithNoAsDefaultButton(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Question"</span></span>, <span class="hljs-string"><span class="hljs-string">"Create Sega 32X segment?"</span></span>)) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"32X"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x800000</span></span>), <span class="hljs-number"><span class="hljs-number">0x200000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre> <br><p>      : </p><br><pre> <code class="java hljs">createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z80"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA00000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS1"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SYS2"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z802"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Z803"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"FDC"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-number"><span class="hljs-number">0x100</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"TMSS"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"VDP"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"RAM"</span></span>, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xFF0000</span></span>), <span class="hljs-number"><span class="hljs-number">0x10000</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (header.hasSRAM()) { Address sramStart = header.getSramStart(); Address sramEnd = header.getSramEnd(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sramStart.getOffset() &gt;= <span class="hljs-number"><span class="hljs-number">0x200000</span></span> &amp;&amp; sramEnd.getOffset() &lt;= <span class="hljs-number"><span class="hljs-number">0x20FFFF</span></span> &amp;&amp; sramStart.getOffset() &lt; sramEnd.getOffset()) { createSegment(fpa, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"SRAM"</span></span>, sramStart, sramEnd.getOffset() - sramStart.getOffset() + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } }</code> </pre> <br><h4 id="massivy-metki-i-konkretnye-adresa"> ,     </h4><br><p>       <code>CreateArrayCmd</code> .   ,     : </p><br><ol><li> <code>address</code> : ,      </li><li> <code>numElements</code> :    </li><li> <code>dataType</code> :       </li><li> <code>elementSize</code> :    </li></ol><br><p>        <code>applyTo(program)</code> ,   . </p><br><p>        ,    ,  <code>BYTE</code> , <code>WORD</code> , <code>DWORD</code>  .  ,    <code>FlatProgramAPI</code>   <code>createByte()</code> , <code>createWord()</code> , <code>createDword()</code>  .. </p><br><p>  ,    ,       (,     <code>VDP</code> ).  ,    : </p><br><ol><li>    <code>Program</code>   <code>getSymbolTable()</code> ,       ,   .. </li><li>      <code>createLabel()</code> ,     ,    .      , ,     <code>SourceType.IMPORTED</code>      </li></ol><br><p>          ,   : </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedByteArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, ByteDataType.dataType, ByteDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createByte(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create byte. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedWordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, WordDataType.dataType, WordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create word. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedDwordArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FlatProgramAPI fpa, Program program, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numElements)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numElements &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { CreateArrayCmd arrayCmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateArrayCmd(address, numElements, DWordDataType.dataType, DWordDataType.dataType.getLength()); arrayCmd.applyTo(program); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { fpa.createDWord(address); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Cannot create dword. "</span></span> + e.getMessage()); } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, String.format(<span class="hljs-string"><span class="hljs-string">"%s : Error creating array %s"</span></span>, getName(), name)); } }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="java hljs">createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA04000</span></span>), <span class="hljs-string"><span class="hljs-string">"Z80_YM2612"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_PCBVER"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10002</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10004</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10006</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10008</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1000E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10010</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10012</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT1_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10014</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10016</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA10018</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_CT2_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001A</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_RX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001C</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_TX"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA1001E</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_EXT_SMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_RAMMODE"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11100</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80BUS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA11200</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_Z80RES"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA12000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_FDC"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA13000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TIME"</span></span>, <span class="hljs-number"><span class="hljs-number">0x100</span></span>); createNamedDwordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xA14000</span></span>), <span class="hljs-string"><span class="hljs-string">"IO_TMSS"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00000</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00002</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__DATA"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00004</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00006</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CTRL"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00008</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000A</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP__CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000C</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP___CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedWordArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC0000E</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP____CNTR"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); createNamedByteArray(fpa, program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0xC00011</span></span>), <span class="hljs-string"><span class="hljs-string">"VDP_PSG"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </div></div><br><h4 id="primenenie-struktur-zagolovka">    </h4><br><p>           <code>createData()</code>  <code>DataUtilities</code> .       : </p><br><ol><li> <code>program</code> :   <code>Program</code> </li><li> <code>address</code> : ,      </li><li> <code>dataType</code> :   </li><li> <code>dataLength</code> :  .   <code>-1</code>    </li><li> <code>stackPointers</code> :  <code>true</code> ,  -     .  <code>false</code> </li><li> <code>clearDataMode</code> :          ,     (,     ) </li></ol><br><p>    : ..      (,  ),         .      <code>FlatProgramAPI</code>    <code>createFunction()</code> ,       . </p><br><p>                 : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markVectorsTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0</span></span>), vectors.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (VectorFunc func : vectors.getVectors()) { fpa.createFunction(func.getAddress(), func.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000000"</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">markHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataUtilities.createData(program, fpa.toAddr(<span class="hljs-number"><span class="hljs-number">0x100</span></span>), header.toDataType(), -<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, ClearDataMode.CLEAR_ALL_UNDEFINED_CONFLICT_DATA); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (CodeUnitInsertionException e) { Msg.error(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Vectors mark conflict at 0x000100"</span></span>); } }</code> </pre> <br><h3 id="zavershaem-metod-load">   load() </h3><br><p>         <code>load()</code>    <code>setMessage()</code>   <code>TaskMonitor</code> ,     . </p><br><pre> <code class="java hljs">monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName()));</code> </pre> <br><p>     ,     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, LoadSpec loadSpec, List&lt;Option&gt; options, Program program, MemoryConflictHandler handler, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException, IOException </span></span>{ monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Start loading"</span></span>, getName())); BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program, monitor); vectors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> VectorsTable(fpa, reader); header = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameHeader(fpa, reader); createSegments(fpa, provider, program, monitor); markVectorsTable(program, fpa); markHeader(program, fpa); monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s : Loading done"</span></span>, getName())); }</code> </pre> <br><h3 id="getdefaultoptions-i-validateoptions"> getDefaultOptions  validateOptions </h3><br><p>       ,      </p><br><h2 id="otlazhivaem-rezultaty-nashih-trudov">     </h2><br><p>        <code>Run</code> -&gt; <code>Debug As</code> -&gt; <code>1 Ghidra</code> .   . </p><br><p><img src="https://habrastorage.org/webt/fv/ua/ya/fvuaya-gohpzkoiiflp6v28eily.png"></p><br><h2 id="eksport-distributiva-i-ustanovka-v-ghidra">      GHIDRA </h2><br><p>     ,   -    .       <code>Eclipse</code>   <code>extension.properties</code> ,   : </p><br><pre> <code class="java hljs">description=Loader <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Sega Mega Drive / Genesis ROMs author=Dr. MefistO createdOn=<span class="hljs-number"><span class="hljs-number">20.03</span></span>.2019</code> </pre> <br><p>       <code>GhidraDev</code> -&gt; <code>Export</code> -&gt; <code>Ghidra Module Extension...</code>      : </p><br><p><img src="https://habrastorage.org/webt/4p/d-/4x/4pd-4xgokfhzsbfwdccrnzguqb0.png"></p><br><p><img src="https://habrastorage.org/webt/t2/gs/j3/t2gsj3lpwgtn-lueej69ostsil4.png"></p><br><p><img src="https://habrastorage.org/webt/z3/kn/ik/z3knik478dyvau73nau8j-rhiik.png"></p><br><p>      <code>dist</code>    zip- (-  <code>ghidra_9.0_PUBLIC_20190320_Sega.zip</code> )       <code>GHIDRA</code> . </p><br><p>     .  <code></code> ,  <code>File</code> -&gt; <code>Install Extensions...</code> ,     ,     . ... </p><br><p><img src="https://habrastorage.org/webt/ky/tk/uh/kytkuhf_3pciliw9ihhgthadbrs.png"></p><br><p><img src="https://habrastorage.org/webt/qj/bz/gf/qjbzgfycyjaeghezz_w1rehayo0.png"></p><br><h2 id="ishodniki-i-prochee">    </h2><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github-</a> ,   . </p><br><p>     :   <code>IDA</code>  <code>GHIDRA</code>       .   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444562/">https://habr.com/ru/post/444562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444552/index.html">TDMS Fairway. Trabaja con experiencia</a></li>
<li><a href="../444554/index.html">La API RESTful JSON m√°s simple en Elixir</a></li>
<li><a href="../444556/index.html">El color de la luna y el sol desde el espacio en los valores de RGB y temperatura de color.</a></li>
<li><a href="../444558/index.html">¬øQu√© hay de nuevo en CUBA 7?</a></li>
<li><a href="../444560/index.html">Te invitamos a la conferencia "Nubes. Tendencias de la moda ‚Äù26 de marzo de 2019</a></li>
<li><a href="../444564/index.html">Desarrollo de productos digitales con modelos mentales</a></li>
<li><a href="../444566/index.html">Sikorsky realiz√≥ una demostraci√≥n de un helic√≥ptero no tripulado con un hombre a bordo</a></li>
<li><a href="../444568/index.html">Los 10 errores principales de los proyectos de C ++ encontrados en 2018</a></li>
<li><a href="../444570/index.html">Los 10 errores principales en proyectos de C ++ para 2018</a></li>
<li><a href="../444572/index.html">LED parpadeante</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>