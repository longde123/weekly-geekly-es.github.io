<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí≠ üëåüèº üöò Introduzir an√°lise est√°tica no processo, n√£o basta procurar bugs com ele üôáüèº ü§µ üñºÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artigo √© uma tradu√ß√£o autorizada da postagem original . A tradu√ß√£o foi feita com a ajuda gentil dos caras do PVS-Studio. Obrigado pessoal! 

 O q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduzir an√°lise est√°tica no processo, n√£o basta procurar bugs com ele</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440610/"> <i>Este artigo √© uma tradu√ß√£o autorizada da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">postagem original</a> .</i>  <i>A tradu√ß√£o foi feita com a ajuda gentil dos caras do PVS-Studio.</i>  <i>Obrigado pessoal!</i> <br><br>  O que me incentivou a escrever este artigo √© uma quantidade significativa de materiais sobre an√°lise est√°tica, que vem surgindo cada vez mais.  Primeiro, este √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">blog do PVS-Studio</a> , que se promove ativamente no Habr postando an√°lises de erros, encontradas por sua ferramenta em projetos de c√≥digo aberto.  O PVS-Studio implementou recentemente o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">suporte a Java</a> e, √© claro, os desenvolvedores do IntelliJ IDEA, cujo analisador embutido √© provavelmente o mais avan√ßado para Java atualmente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√£o puderam ficar de fora</a> . <br><br>  Ao ler essas resenhas, sinto que estamos falando de um elixir m√°gico: clique no bot√£o e aqui est√° - a lista de defeitos bem na frente dos seus olhos.  Parece que, √† medida que os analisadores se tornam mais avan√ßados, mais e mais bugs ser√£o encontrados e os produtos verificados por esses rob√¥s se tornar√£o cada vez melhores sem nenhum esfor√ßo de nossa parte. <br><br>  Bem, mas n√£o h√° elixires m√°gicos.  Eu gostaria de falar sobre o que geralmente n√£o √© falado em posts como "aqui est√£o as coisas que o nosso rob√¥ pode encontrar": o que os analisadores n√£o conseguem fazer, qual √© a verdadeira parte e o lugar deles no processo de entrega de software e como implementar a an√°lise corretamente. <br><br><img src="https://habrastorage.org/webt/ey/2o/ta/ey2otantl8aitotp4_lojjuscn4.png" width="500"><br>  <i>Catraca (fonte: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> ).</i> <br><a name="habracut"></a><br><h2>  O que os analisadores est√°ticos nunca ser√£o capazes de fazer </h2><br>  Qual √© a an√°lise do c√≥digo fonte do ponto de vista pr√°tico?  Pegamos os arquivos de origem e obtemos algumas informa√ß√µes sobre a qualidade do sistema em um curto espa√ßo de tempo (muito mais curto que uma execu√ß√£o de testes).  A limita√ß√£o principal e matematicamente intranspon√≠vel √© que dessa forma podemos responder apenas a um subconjunto muito limitado de perguntas sobre o sistema analisado. <br><br>  O exemplo mais famoso de uma tarefa, n√£o solucion√°vel usando a an√°lise est√°tica, √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">problema de parada</a> : este √© um teorema, que prova que n√£o se pode elaborar um algoritmo geral, que definiria se um programa com um determinado c√≥digo-fonte repetia para sempre ou era conclu√≠do. o tempo final.  A extens√£o desse teorema √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">teorema de Rice</a> , afirmando que, para qualquer propriedade n√£o trivial de fun√ß√µes comput√°veis, a quest√£o de determinar se um determinado programa calcula uma fun√ß√£o com essa propriedade √© uma tarefa algoritmicamente insol√∫vel.  Por exemplo, voc√™ n√£o pode escrever um analisador, que determina com base no c√≥digo-fonte se o programa analisado √© uma implementa√ß√£o de um algoritmo espec√≠fico, por exemplo, um que calcula o quadrado de um n√∫mero inteiro. <br><br>  Assim, a funcionalidade dos analisadores est√°ticos tem limita√ß√µes intranspon√≠veis.  O analisador est√°tico nunca ser√° capaz de detectar todos os casos de, por exemplo, erro "exce√ß√£o de ponteiro nulo" em idiomas sem a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">seguran√ßa nula</a> .  Ou detecte todas as ocorr√™ncias de "atributo n√£o encontrado" em idiomas digitados dinamicamente.  Tudo o que o analisador est√°tico mais perfeito pode fazer √© capturar casos espec√≠ficos.  O n√∫mero deles entre todos os poss√≠veis problemas com o seu c√≥digo fonte, sem exageros, √© uma gota no oceano. <br><br><h2>  A an√°lise est√°tica n√£o √© uma pesquisa de erros </h2><br>  Aqui est√° uma conclus√£o que se segue: a an√°lise est√°tica n√£o √© a maneira de diminuir o n√∫mero de defeitos em um programa.  Atrevo-me a reivindicar o seguinte: sendo aplicado pela primeira vez ao seu projeto, ele encontrar√° lugares "divertidos" no c√≥digo, mas provavelmente n√£o encontrar√° defeitos que afetem a qualidade do seu programa. <br><br>  Exemplos de defeitos encontrados automaticamente pelos analisadores s√£o impressionantes, mas n√£o devemos esquecer que esses exemplos foram encontrados ao escanear um enorme conjunto de bases de c√≥digo contra o conjunto de regras relativamente simples.  Da mesma forma, os hackers, tendo a oportunidade de tentar v√°rias senhas simples em um grande n√∫mero de contas, acabam encontrando as contas com uma senha simples. <br><br>  Isso significa que n√£o √© necess√°rio aplicar a an√°lise est√°tica?  Claro que n√£o!  Ele deve ser aplicado pelo mesmo motivo em que voc√™ pode querer verificar todas as novas senhas na lista de parada de senhas n√£o seguras. <br><br><h2>  A an√°lise est√°tica √© mais do que procurar bugs </h2><br>  De fato, as tarefas que podem ser resolvidas pela an√°lise na pr√°tica s√£o muito mais amplas.  Porque, de um modo geral, a an√°lise est√°tica representa qualquer verifica√ß√£o do c√≥digo fonte, realizada antes da execu√ß√£o.  Aqui est√£o algumas coisas que voc√™ pode fazer: <br><br><ul><li> Uma verifica√ß√£o do estilo de codifica√ß√£o no sentido mais amplo desta palavra.  Ele inclui uma verifica√ß√£o de formata√ß√£o e uma pesquisa de uso de par√™nteses vazios / desnecess√°rios, configura√ß√£o de valores limite para m√©tricas, como v√°rias linhas / complexidade ciclom√°tica de um m√©todo e assim por diante - tudo isso que complica a legibilidade e a manuten√ß√£o do c√≥digo.  Em Java, o Checkstyle representa uma ferramenta com essa funcionalidade, em Python - <code>flake8</code> .  Esses programas s√£o geralmente chamados de "linters". </li><li>  N√£o apenas o c√≥digo execut√°vel pode ser analisado.  Recursos como arquivos JSON, YAML, XML e <code>.properties</code> podem (e devem!) Ser verificados automaticamente quanto √† validade.  O motivo disso √© que √© melhor descobrir que, digamos, a estrutura JSON est√° quebrada devido √†s cota√ß√µes n√£o emparelhadas no est√°gio inicial da verifica√ß√£o autom√°tica de uma solicita√ß√£o pull do que durante a execu√ß√£o de testes ou em tempo de execu√ß√£o, n√£o √© isso?  Existem algumas ferramentas relevantes, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">YAMLlint</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JSONLint</a> e <code>xmllint</code> . </li><li>  A compila√ß√£o (ou an√°lise de linguagens de programa√ß√£o din√¢micas) tamb√©m √© um tipo de an√°lise est√°tica.  Geralmente, os compiladores podem emitir avisos que sinalizam sobre problemas com a qualidade do c√≥digo-fonte e n√£o devem ser ignorados. </li><li>  √Äs vezes, a compila√ß√£o √© aplicada n√£o apenas ao c√≥digo execut√°vel.  Por exemplo, se voc√™ possui documenta√ß√£o no formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AsciiDoctor</a> , no processo de compila√ß√£o em HTML / PDF, o AsciiDoctor ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">plug-in Maven</a> ) pode emitir avisos, por exemplo, em links internos quebrados.  Esse √© um motivo significativo para n√£o aceitar uma solicita√ß√£o de recebimento com altera√ß√µes na documenta√ß√£o. </li><li>  A verifica√ß√£o ortogr√°fica tamb√©m √© um tipo de an√°lise est√°tica.  O utilit√°rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aspell</a> √© capaz de verificar a ortografia n√£o apenas na documenta√ß√£o, mas tamb√©m no c√≥digo-fonte dos programas (coment√°rios e literais) em v√°rias linguagens de programa√ß√£o, incluindo C / C ++, Java e Python.  Erro de ortografia na interface do usu√°rio ou na documenta√ß√£o tamb√©m √© um defeito! </li><li>  Na verdade, os testes de configura√ß√£o representam uma forma de an√°lise est√°tica, pois eles n√£o executam o c√≥digo-fonte durante o processo de execu√ß√£o, mesmo que os testes de configura√ß√£o sejam executados como testes de unidade <code>pytest</code> . </li></ul><br>  Como podemos ver, a pesquisa de bugs tem o papel menos significativo nesta lista e tudo o mais est√° dispon√≠vel ao usar ferramentas gratuitas de c√≥digo aberto. <br><br>  Qual desses tipos de an√°lise est√°tica deve ser usado no seu projeto?  Claro, quanto mais, melhor!  O importante aqui √© uma implementa√ß√£o adequada, que ser√° discutida mais adiante. <br><br><h2>  Um pipeline de entrega como filtro de v√°rios est√°gios e an√°lise est√°tica como seu primeiro est√°gio </h2><br>  Um pipeline com um fluxo de altera√ß√µes (come√ßando das altera√ß√µes do c√≥digo-fonte at√© a entrega na produ√ß√£o) √© uma met√°fora cl√°ssica da integra√ß√£o cont√≠nua.  A sequ√™ncia padr√£o de est√°gios deste pipeline √© a seguinte: <br><br><ol><li>  an√°lise est√°tica </li><li>  compila√ß√£o </li><li>  testes de unidade </li><li>  testes de integra√ß√£o </li><li>  Testes de interface do usu√°rio </li><li>  verifica√ß√£o manual </li></ol><br>  As altera√ß√µes rejeitadas no N-√©simo est√°gio do pipeline n√£o s√£o passadas no est√°gio N + 1. <br><br>  Por que n√£o e de outra forma?  Na parte do pipeline, que lida com testes, os testadores reconhecem a bem conhecida pir√¢mide de teste: <br><br><img src="https://habrastorage.org/webt/hr/41/ut/hr41utwuuzfwoe_3pkr6xm7rcwo.png" width="400"><br>  <i>Pir√¢mide de teste.</i>  <i>Fonte: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o artigo</a> de Martin Fowler.</i> <br><br>  No final desta pir√¢mide, existem testes mais f√°ceis de escrever, que s√£o executados mais rapidamente e n√£o tendem a produzir falsos positivos.  Portanto, deve haver mais deles, eles devem cobrir a maior parte do c√≥digo e devem ser executados primeiro.  No topo da pir√¢mide, a situa√ß√£o √© bastante oposta; portanto, o n√∫mero de testes de integra√ß√£o e interface do usu√°rio deve ser reduzido ao m√≠nimo necess√°rio.  As pessoas nesta cadeia s√£o os recursos mais caros, lentos e n√£o confi√°veis; portanto, elas est√£o localizadas no final e s√≥ funcionam se as etapas anteriores n√£o detectaram nenhum defeito.  Nas partes n√£o relacionadas ao teste, o pipeline √© constru√≠do com os mesmos princ√≠pios! <br><br>  Eu gostaria de sugerir a analogia na forma de um sistema de v√°rios est√°gios de filtragem de √°gua.  √Ågua suja (altera√ß√µes com defeitos) √© fornecida na entrada e, como sa√≠da, precisamos obter √°gua limpa, que n√£o conter√° todas as contamina√ß√µes indesejadas. <br><br><img src="https://habrastorage.org/webt/nf/2n/gi/nf2ngidmm_2_aaiye4c52ol0fr0.jpeg" width="400"><br>  <i>Filtro de v√°rios est√°gios.</i>  <i>Fonte: <a href="">Wikimedia Commons</a></i> <br><br>  Como voc√™ deve saber, os filtros de purifica√ß√£o s√£o projetados para que cada est√°gio subsequente possa remover part√≠culas contaminantes de tamanho menor.  Os est√°gios de entrada da purifica√ß√£o aproximada t√™m maior rendimento e menor custo.  Em nossa analogia, isso significa que os port√µes de qualidade de entrada t√™m maior desempenho, exigem menos esfor√ßo para iniciar e t√™m menos custos operacionais.  O papel da an√°lise est√°tica, que (como agora entendemos) √© capaz de eliminar apenas os defeitos mais s√©rios, √© o papel do filtro do dep√≥sito como o primeiro est√°gio dos purificadores de v√°rios est√°gios. <br><br>  A an√°lise est√°tica n√£o melhora a qualidade do produto final por si s√≥, o mesmo que o "po√ßo" n√£o torna a √°gua pot√°vel.  No entanto, em conjunto com outros elementos do pipeline, sua import√¢ncia √© √≥bvia.  Mesmo que em um filtro de v√°rios est√°gios, os est√°gios de sa√≠da possam remover potencialmente tudo o que os de entrada podem - estamos cientes das consequ√™ncias que se seguir√£o ao tentar sobreviver apenas com est√°gios de purifica√ß√£o fina, sem est√°gios de entrada. <br><br>  O objetivo do "po√ßo" √© descarregar as etapas subsequentes da captura de defeitos muito graves.  Por exemplo, uma pessoa que executa uma revis√£o de c√≥digo n√£o deve se distrair com a viola√ß√£o incorreta de c√≥digo e de c√≥digo de c√≥digo formatado incorretamente (como par√™nteses redundantes ou ramifica√ß√£o aninhada muito profundamente).  Erros como o NPE devem ser detectados pelos testes de unidade, mas, se antes disso, o analisador indicar que um erro deve aparecer inevitavelmente - isso acelerar√° significativamente sua corre√ß√£o. <br><br>  Suponho que agora esteja claro por que a an√°lise est√°tica n√£o melhora a qualidade do produto quando aplicada ocasionalmente e deve ser aplicada continuamente para filtrar altera√ß√µes com defeitos graves.  A quest√£o de saber se a aplica√ß√£o de um analisador est√°tico melhora a qualidade do seu produto equivale aproximadamente √† pergunta "se tirarmos √°gua de lagoas sujas, sua qualidade de bebida ser√° melhorada quando passarmos por uma peneira?" <br><br><h2>  Introdu√ß√£o em um projeto herdado </h2><br>  Uma quest√£o pr√°tica importante: como implementar a an√°lise est√°tica no processo de integra√ß√£o cont√≠nua, como uma "porta da qualidade"?  No caso de testes automatizados, tudo fica claro: h√° um conjunto de testes, uma falha em qualquer um deles √© uma raz√£o suficiente para acreditar que uma constru√ß√£o n√£o passou por um port√£o de qualidade.  Uma tentativa de configurar o port√£o da mesma maneira pelos resultados da an√°lise est√°tica falha: h√° muitos avisos de an√°lise no c√≥digo legado, voc√™ n√£o deseja ignor√°-los todos; por outro lado, √© imposs√≠vel interromper a entrega do produto apenas porque existem avisos do analisador. <br><br>  Para qualquer projeto, o analisador emite um grande n√∫mero de avisos sendo aplicados pela primeira vez.  A maioria dos avisos n√£o tem nada a ver com o bom funcionamento do produto.  Ser√° imposs√≠vel consertar todos eles e muitos deles n√£o precisam ser consertados.  No final, sabemos que nosso produto realmente funciona mesmo antes da introdu√ß√£o da an√°lise est√°tica! <br><br>  Como resultado, muitos desenvolvedores se limitam ao uso ocasional de an√°lise est√°tica ou apenas no modo informativo, que envolve a obten√ß√£o de um relat√≥rio do analisador ao criar um projeto.  Isso √© equivalente √† aus√™ncia de qualquer an√°lise, porque, se j√° temos muitos avisos, o surgimento de outro (por mais grave) permanece despercebido ao alterar o c√≥digo. <br><br>  Aqui est√£o as formas conhecidas de introdu√ß√£o dos port√µes de qualidade: <br><br><ul><li>  Definir o limite do n√∫mero total de avisos ou do n√∫mero de avisos, dividido pelo n√∫mero de linhas de c√≥digo.  Funciona mal, pois essa porta permite altera√ß√µes com novos defeitos at√© que seu limite seja excedido. </li><li>  A marca√ß√£o de todos os avisos antigos no c√≥digo √© ignorada em um determinado momento e cria falhas quando novos avisos aparecem.  Essa funcionalidade pode ser fornecida pelo PVS-Studio e algumas outras ferramentas, por exemplo, Codacy.  N√£o trabalhei com o PVS-Studio.  Quanto √† minha experi√™ncia com o Codacy, o principal problema deles √© que a distin√ß√£o entre um erro antigo e um novo √© um algoritmo complicado e nem sempre funciona, principalmente se os arquivos mudam significativamente ou s√£o renomeados.  Que eu saiba, o Codacy pode ignorar novos avisos em uma solicita√ß√£o de recebimento e, ao mesmo tempo, impedir uma solicita√ß√£o de recebimento devido a avisos, n√£o relacionados a altera√ß√µes no c√≥digo deste PR. </li><li>  Na minha opini√£o, a solu√ß√£o mais eficaz √© o m√©todo de "catraca" descrito no livro " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entrega cont√≠nua</a> ".  A id√©ia b√°sica √© que o n√∫mero de avisos de an√°lise est√°tica seja uma propriedade de cada release e somente essas altera√ß√µes sejam permitidas, o que n√£o aumenta o n√∫mero total de avisos. </li></ul><br><h2>  Catraca </h2><br>  Funciona da seguinte maneira: <br><br><ol><li>  Na fase inicial, uma entrada sobre v√°rios avisos encontrados pelos analisadores de c√≥digo √© adicionada aos metadados do release.  Portanto, ao criar a ramifica√ß√£o principal, n√£o apenas a "release 7.0.2" √© gravada em seu gerenciador de reposit√≥rio, mas a "release 7.0.2, contendo 100500 Checkstyle-warnings".  Se voc√™ estiver usando o gerenciador de reposit√≥rios avan√ßado (como o Artifactory), √© f√°cil manter esses metadados sobre o seu lan√ßamento. </li><li>  Ao criar, cada solicita√ß√£o pull compara o n√∫mero de avisos resultantes com seu n√∫mero em uma libera√ß√£o atual.  Se um PR levar a um crescimento desse n√∫mero, o c√≥digo n√£o passar√° pela qualidade da an√°lise est√°tica.  Se o n√∫mero de avisos for reduzido ou n√£o for alterado - ele ser√° aprovado. </li><li>  Durante a pr√≥xima vers√£o, o n√∫mero recalculado ser√° gravado nos metadados novamente. </li></ol><br>  Assim, lenta mas seguramente, o n√∫mero de avisos estar√° convergindo para zero.  Obviamente, o sistema pode ser enganado introduzindo um novo aviso e corrigindo o de outra pessoa.  Isso √© normal, porque, a longo prazo, d√° o resultado: os avisos s√£o corrigidos, geralmente n√£o um por um, mas por grupos de um determinado tipo, e todos os avisos facilmente resolvidos s√£o resolvidos rapidamente. <br><br>  Este gr√°fico mostra o n√∫mero total de avisos do Checkstyle por seis meses dessa "catraca" em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um dos nossos projetos OpenSource</a> .  O n√∫mero de avisos foi reduzido significativamente e ocorreu naturalmente, paralelamente ao desenvolvimento do produto! <br><br><img src="https://habrastorage.org/webt/ye/wa/u5/yewau5w494aa0vpkaevdydizoqm.png" width="500"><br><br>  Eu aplico a vers√£o modificada deste m√©todo.  Eu conto os avisos separadamente para diferentes m√≥dulos de projeto e ferramentas de an√°lise.  O arquivo YAML com metadados sobre a constru√ß√£o, formado ao faz√™-lo, tem a seguinte apar√™ncia: <br><br><pre> <code class="plaintext hljs">celesta-sql: checkstyle: 434 spotbugs: 45 celesta-core: checkstyle: 206 spotbugs: 13 celesta-maven-plugin: checkstyle: 19 spotbugs: 0 celesta-unit: checkstyle: 0 spotbugs: 0</code> </pre><br>  Em qualquer sistema avan√ßado de CI, uma "catraca" pode ser implementada para qualquer ferramenta de an√°lise est√°tica, sem depender de plug-ins e ferramentas de terceiros.  Cada um dos analisadores emite seu relat√≥rio em um formato simples de texto ou XML, que ser√° analisado facilmente.  A √∫nica coisa a fazer depois √© escrever a l√≥gica necess√°ria em um script de IC.  Voc√™ pode espiar e ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> como ele √© implementado em nossos projetos de origem baseados em Jenkins e Artifactory.  Ambos os exemplos dependem da biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ratchetlib</a> : o m√©todo <code>countWarnings()</code> da maneira usual conta as tags xml nos arquivos gerados pelo Checkstyle e Spotbugs, e <code>compareWarningMaps()</code> implementa essa pr√≥pria catraca, <code>compareWarningMaps()</code> um erro no caso, se o n√∫mero de avisos em qualquer um dos as categorias est√£o aumentando. <br><br>  Uma maneira interessante de implementa√ß√£o de "catraca" √© poss√≠vel para analisar a ortografia dos coment√°rios, literais de texto e documenta√ß√£o usando o aspell.  Como voc√™ deve saber, ao verificar a ortografia, nem todas as palavras desconhecidas no dicion√°rio padr√£o est√£o incorretas, elas podem ser adicionadas ao dicion√°rio personalizado.  Se voc√™ tornar um dicion√°rio personalizado parte do projeto de c√≥digo-fonte, a porta de qualidade para ortografia poder√° ser formulada da seguinte maneira: executar o aspell com o dicion√°rio padr√£o e personalizado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√£o deve</a> encontrar nenhum erro de ortografia. <br><br><h2>  A import√¢ncia de corrigir a vers√£o do analisador </h2><br>  Em conclus√£o, √© necess√°rio observar o seguinte: qualquer maneira que voc√™ escolher para introduzir a an√°lise em seu pipeline de entrega, a vers√£o do analisador deve ser corrigida.  Se voc√™ deixar o analisador se atualizar espontaneamente, ao criar outra solicita√ß√£o de recebimento, poder√£o surgir novos defeitos, que n√£o est√£o relacionados ao c√≥digo alterado, mas ao fato de que o novo analisador √© capaz de detectar mais defeitos.  Isso interromper√° seu processo de verifica√ß√£o de solicita√ß√£o de recebimento.  A atualiza√ß√£o do analisador deve ser uma a√ß√£o consciente.  De qualquer forma, a fixa√ß√£o r√≠gida da vers√£o de cada componente de constru√ß√£o √© um requisito geral e um assunto para outro t√≥pico. <br><br><h2>  Conclus√µes </h2><br><ul><li>  A an√°lise est√°tica n√£o encontrar√° bugs e n√£o melhorar√° a qualidade do seu produto como resultado de uma √∫nica execu√ß√£o.  Somente sua execu√ß√£o cont√≠nua no processo de entrega produzir√° um efeito positivo. </li><li>  A ca√ßa a insetos n√£o √© o principal objetivo da an√°lise.  A grande maioria dos recursos √∫teis est√° dispon√≠vel nas ferramentas de c√≥digo-fonte aberto. </li><li>  Introduzir portas de qualidade pelos resultados da an√°lise est√°tica no primeiro est√°gio do pipeline de entrega, usando o "catraca" para o c√≥digo legado. </li></ul><br><h2>  Refer√™ncias </h2><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Entrega cont√≠nua</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alexey Kudryavtsev: An√°lise do programa: voc√™ √© um bom desenvolvedor?</a>  Relate sobre diferentes m√©todos de an√°lise de c√≥digo, n√£o apenas est√°tico! </li></ol><br><br><hr><br><h2>  Trechos da discuss√£o do artigo original </h2><br><br>  <b>Evgeniy Ryzhkov</b> <br><br>  Ivan, obrigado pelo artigo e por nos ajudar a fazer nosso trabalho, que √© popularizar a tecnologia da an√°lise de c√≥digo est√°tico.  Voc√™ est√° absolutamente certo de que os artigos do blog PVS-Studio, no caso de mentes imaturas, podem afet√°-los e levar a conclus√µes como "Vou verificar o c√≥digo apenas uma vez, corrigir os erros e isso funcionar√°".  Essa √© a minha dor pessoal, que n√£o sei superar h√° j√° v√°rios anos.  O fato √© que os artigos sobre o projeto verificam: <br><br><ol><li>  Causar efeito uau nas pessoas.  As pessoas gostam de ler como os desenvolvedores de empresas como Google, Epic Games, Microsoft e outras empresas √†s vezes falham.  As pessoas gostam de pensar que algu√©m pode estar errado, at√© os l√≠deres da ind√∫stria cometem erros.  As pessoas gostam de ler esses artigos. </li><li>  Al√©m disso, os autores podem escrever artigos sobre o fluxo, sem ter que pensar muito.  Claro, n√£o quero ofender nossos colegas que escrevem esses artigos.  Mas chegar a cada momento com um novo artigo √© muito mais dif√≠cil do que escrever um artigo sobre uma verifica√ß√£o do projeto (uma d√∫zia de bugs, algumas piadas, misture com fotos de unic√≥rnios). </li></ol><br>  Voc√™ escreveu um artigo muito bom.  Eu tamb√©m tenho alguns artigos sobre esse t√≥pico.  Ent√£o, tenha outros colegas.  Al√©m disso, visito v√°rias empresas com um relat√≥rio sobre o tema "Filosofia da an√°lise est√°tica de c√≥digo", no qual falo sobre o processo em si, mas n√£o sobre erros espec√≠ficos. <br><br>  Mas n√£o √© poss√≠vel escrever 10 artigos sobre o processo.  Bem, para promover nosso produto, precisamos escrever muito regularmente.  Gostaria de comentar mais alguns pontos do artigo com um coment√°rio separado para facilitar a discuss√£o. <br><br>  Este pequeno <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> √© sobre ‚ÄúFilosofia da an√°lise de c√≥digo est√°tico‚Äù, que √© o meu t√≥pico ao visitar diferentes empresas. <br><br>  <b>Ivan Ponomarev</b> <br>  Evgeniy, muito obrigado pela revis√£o informativa sobre o artigo!  Sim, voc√™ recebeu minha preocupa√ß√£o no post sobre o impacto nas "mentes imaturas" absolutamente corretamente! <br><br>  N√£o h√° ningu√©m para culpar aqui, pois os autores dos artigos / relat√≥rios sobre <i>analisadores</i> n√£o pretendem fazer artigos / relat√≥rios sobre a <i>an√°lise</i> .  Mas, depois de algumas postagens recentes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Andrey2008</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">lany</a> , decidi que n√£o poderia mais ficar em sil√™ncio. <br><br>  <b>Evgeniy Ryzhkov</b> <br>  Ivan, como escrevi acima, comentarei tr√™s pontos do artigo.  Significa que eu concordo com os que n√£o comento. <br><br>  1. <i>A sequ√™ncia padr√£o de est√°gios deste pipeline √© a seguinte ...</i> <br><br>  N√£o concordo que o primeiro passo seja a an√°lise est√°tica e apenas o segundo √© a compila√ß√£o.  Acredito que, em m√©dia, a verifica√ß√£o de compila√ß√£o √© mais r√°pida e l√≥gica do que uma execu√ß√£o imediata de an√°lise est√°tica "mais pesada".  Podemos discutir se voc√™ pensa o contr√°rio. <br><br>  2. <i>N√£o trabalhei com o PVS-Studio.</i>  <i>Quanto √† minha experi√™ncia com o Codacy, o principal problema deles √© que a distin√ß√£o entre um erro antigo e um novo √© um algoritmo complicado e nem sempre funciona, principalmente se os arquivos mudam significativamente ou s√£o renomeados.</i> <br><br>  No PVS-Studio, isso √© extremamente √∫til.  Esse √© um dos principais recursos do produto, que, infelizmente, √© dif√≠cil de ser descrito nos artigos, por isso as pessoas n√£o est√£o muito familiarizadas com ele.  Reunimos informa√ß√µes sobre os erros existentes em uma base.  E n√£o apenas ‚Äúo nome do arquivo e a linha‚Äù, mas tamb√©m informa√ß√µes adicionais (marca de hash de tr√™s linhas - atual, anterior, seguinte), para que, em caso de altera√ß√£o do fragmento de c√≥digo, ainda possamos encontr√°-lo.  Portanto, ao fazer pequenas modifica√ß√µes, ainda entendemos que √© um erro antigo.  E o analisador n√£o se queixa.  Agora, algu√©m pode dizer: "Bem, e se o c√≥digo mudou muito, ent√£o isso n√£o funcionou, e voc√™ reclama disso como se fosse o rec√©m-escrito?"  Sim  N√≥s reclamamos.  Mas, na verdade, esse √© um novo c√≥digo.  Se o c√≥digo mudou muito, agora √© um novo c√≥digo, e n√£o o antigo. <br><br>  Gra√ßas a esse recurso, participamos pessoalmente da implementa√ß√£o do projeto com 10 milh√µes de linhas de c√≥digo C ++, que s√£o todos os dias "tocadas" por v√°rios desenvolvedores.  Tudo correu sem problemas.  Portanto, recomendamos o uso desse recurso do PVS-Studio para qualquer pessoa que introduz a an√°lise est√°tica em seu processo.  A op√ß√£o de corrigir o n√∫mero de avisos de acordo com um release parece ser menos agrad√°vel para mim. <br><br>  3. <i>Qualquer que seja a maneira que voc√™ opte por introduzir sua an√°lise de entrega, a vers√£o do analisador deve ser corrigida</i> <br><br>  Eu n√£o posso concordar com isso.  Um advers√°rio definitivo de tal abordagem.  Eu recomendo atualizar o analisador no modo autom√°tico.  √Ä medida que adicionamos novos diagn√≥sticos e aprimoramos os antigos.  Porque  Primeiro, voc√™ receber√° avisos de novos erros reais.  Em segundo lugar, alguns falsos positivos antigos podem desaparecer se os superarmos. <br><br>  N√£o atualizar o analisador √© o mesmo que n√£o atualizar bancos de dados de antiv√≠rus ("e se eles come√ßarem a notificar sobre v√≠rus").  N√£o discutiremos aqui a verdadeira utilidade do software antiv√≠rus como um todo. <br><br>  Se ap√≥s a atualiza√ß√£o da vers√£o do analisador voc√™ tiver muitos novos avisos, suprima-os, como escrevi acima, por meio dessa fun√ß√£o.  Mas n√£o para atualizar a vers√£o ... Como regra, esses clientes (com certeza existem alguns) n√£o atualizam a vers√£o do analisador h√° anos.  N√£o h√° tempo para isso.  PAGAM pela renova√ß√£o da licen√ßa, mas n√£o usam as novas vers√µes.  Porque  Porque uma vez eles decidiram fixar uma vers√£o.  O produto hoje e nos tr√™s anos atr√°s √© noite e dia.  Acontece que "eu comprarei o ingresso, mas n√£o chegar√°". <br><br>  <b>Ivan Ponomarev</b> <br><br>  1. Aqui voc√™ est√° certo.  Estou pronto para concordar com um compilador / analisador no in√≠cio e isso deve ser alterado no artigo!  Por exemplo, os not√≥rios <code>spotbugs</code> n√£o conseguem agir de maneira diferente, pois analisam o <code>spotbugs</code> compilado.  H√° casos ex√≥ticos, por exemplo, no pipeline de manuais Ansible, √© melhor definir a an√°lise est√°tica antes da an√°lise, porque √© mais leve l√°.  Mas este √© o ex√≥tico em si) <br><br>  2. <i>A op√ß√£o de corrigir o n√∫mero de avisos de acordo com um release parece ser menos agrad√°vel para mim ...</i> - bem, sim, √© menos agrad√°vel, menos t√©cnico, mas muito pr√°tico :-) O principal √© que √© um m√©todo geral, pelo qual posso implementar efetivamente a an√°lise est√°tica em qualquer lugar, mesmo no projeto mais assustador, com qualquer base de c√≥digo e qualquer analisador (n√£o necessariamente o seu), usando scripts Groovy ou bash no CI.  A prop√≥sito, agora estamos contando os avisos separadamente para diferentes m√≥dulos e ferramentas do projeto, mas se os dividirmos de maneira mais granulativa (para arquivos), ser√° muito mais pr√≥ximo do m√©todo de compara√ß√£o de novos / antigos.  Mas nos sentimos assim e eu gostei dessa catraca porque estimula os desenvolvedores a monitorar o n√∫mero total de avisos e diminuir lentamente esse n√∫mero.  Se tiv√©ssemos o m√©todo dos antigos / novos, isso motivaria os desenvolvedores a monitorar a curva do n√∫mero de avisos?  - provavelmente sim, pode ser, n√£o. <br><br>  Quanto ao ponto 3, aqui est√° um exemplo real da minha experi√™ncia.  Veja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este commit</a> .  De onde veio?  Definimos linters no script TravisCI.  Eles trabalharam l√° como port√µes de qualidade.  Mas de repente, quando uma nova vers√£o do Ansible-lint, que estava encontrando mais avisos, algumas compila√ß√µes de solicita√ß√µes pull come√ßaram a falhar devido a avisos no c√≥digo, que n√£o haviam sido alterados !!!  No final, o processo foi interrompido e as solicita√ß√µes de recebimento urgentes foram mescladas sem passar por port√µes de qualidade. <br><br>  Ningu√©m diz que n√£o √© necess√°rio atualizar os analisadores.  Claro que sim!  Como todos os outros componentes de constru√ß√£o.  Mas deve ser um processo consciente, refletido no c√≥digo fonte.  E toda vez que as a√ß√µes dependerem das circunst√¢ncias (corrigimos os avisos detectados novamente ou apenas redefinimos a "catraca") <br><br>  <b>Evgeniy Ryzhkov</b> <br>  Quando me perguntam: ‚ÄúExiste a capacidade de verificar cada commit no PVS-Studio?‚Äù, Respondo que sim, existe.  E ent√£o adicione: "S√≥ por Deus, n√£o falhe na constru√ß√£o se o PVS-Studio encontrar alguma coisa!"  Porque, caso contr√°rio, mais cedo ou mais tarde, o PVS-Studio ser√° percebido como algo perturbador.  E h√° situa√ß√µes em que √â NECESS√ÅRIO confirmar rapidamente, em vez de lutar com as ferramentas, que n√£o deixam a confirma√ß√£o passar. <br><br>  Minha opini√£o √© ruim para falhar a compila√ß√£o neste caso.  √â bom enviar mensagens aos autores do c√≥digo do problema. <br><br>  <b>Ivan Ponomarev</b> <br>  Minha opini√£o √© que n√£o existe algo como "precisamos nos comprometer rapidamente".  Tudo isso √© apenas um processo ruim.  Um bom processo gera velocidade, n√£o porque quebramos as portas de um processo / qualidade, quando precisamos ‚Äúfaz√™-lo rapidamente‚Äù. <br><br>  Isso n√£o contradiz o fato de que podemos fazer isso sem falhar na constru√ß√£o de algumas classes de resultados de an√°lises est√°ticas.  Significa apenas que o port√£o est√° configurado da maneira que certos tipos de descobertas s√£o ignoradas e, para outras descobertas, temos toler√¢ncia zero. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Minha confirma√ß√£o favorita no t√≥pico "rapidamente".</a> <br><br>  <b>Evgeniy Ryzhkov</b> <br>  Sou um advers√°rio definitivo da abordagem para usar a vers√£o antiga do analisador.  E se um usu√°rio encontrasse um bug nessa vers√£o?  Ele escreve para um desenvolvedor de ferramentas e um desenvolvedor de ferramentas at√© o corrige.  Mas na nova vers√£o.  Ningu√©m suportar√° a vers√£o antiga para alguns clientes.  Se n√£o estamos falando de contratos no valor de milh√µes de d√≥lares. <br><br>  <b>Ivan Ponomarev</b> <br>  Evgeniy, n√£o estamos falando sobre isso.  Ningu√©m diz que devemos mant√™-los velhos.  Trata-se de corrigir vers√µes de depend√™ncias de componentes de compila√ß√£o para suas atualiza√ß√µes controladas - √© uma disciplina comum, aplica-se a tudo, incluindo bibliotecas e ferramentas. <br><br>  <b>Evgeniy Ryzhkov</b> <br>  Eu entendo como "isso deve ser feito em teoria".  Mas vejo apenas duas escolhas feitas pelos clientes.  Atenha-se ao novo ou ao antigo.  Portanto, QUASE quase n√£o temos essas situa√ß√µes em que "temos disciplina e ficamos para tr√°s da vers√£o atual em dois lan√ßamentos".  N√£o √© importante para mim dizer agora que √© bom ou ruim.  Eu apenas digo o que vejo. <br><br>  <b>Ivan Ponomarev</b> <br>  Eu entendi.  De qualquer forma, tudo depende fortemente de quais ferramentas / processos seus clientes possuem e de como os utilizam.  Por exemplo, n√£o sei nada sobre como tudo funciona no mundo C ++. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440610/">https://habr.com/ru/post/pt440610/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440600/index.html">Quantos nomes de dom√≠nio .com n√£o s√£o usados?</a></li>
<li><a href="../pt440602/index.html">Dunning com Kruger, S√≥crates e os c√≠rculos do conhecimento</a></li>
<li><a href="../pt440604/index.html">M√°quinas de contabilidade, IBM 1403 e por que 132 colunas s√£o o padr√£o para impressoras</a></li>
<li><a href="../pt440606/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel 286 (de 11 a 17 de fevereiro)</a></li>
<li><a href="../pt440608/index.html">A tarefa de classificar atrav√©s dos olhos de um estudante: determinar a presen√ßa de um carro no estacionamento por quadros de uma c√¢mera de vigil√¢ncia</a></li>
<li><a href="../pt440612/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 5. Conectando dispositivos CISCO e modos IOS</a></li>
<li><a href="../pt440614/index.html">Quest√µes de seguran√ßa rodovi√°ria, ordenadas por pontos</a></li>
<li><a href="../pt440616/index.html">NASA compra mais dois assentos na Soyuz, testa o RS-25 e n√£o abandona a esta√ß√£o pr√≥xima √† Terra</a></li>
<li><a href="../pt440618/index.html">Julia e otimiza√ß√£o</a></li>
<li><a href="../pt440620/index.html">Dotfile Madness</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>