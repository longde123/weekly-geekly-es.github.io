<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèº ‚è© ‚¨ÜÔ∏è Inwieweit √§hneln die Daten f√ºr das Modelltraining (nicht) einer Testprobe? üïò üî¢ ü§öüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Stellen Sie sich ein Szenario vor, in dem Ihr maschinelles Lernmodell m√∂glicherweise wertlos ist. 

 Es gibt ein Sprichwort: "Vergleichen Sie √Ñpfel ni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inwieweit √§hneln die Daten f√ºr das Modelltraining (nicht) einer Testprobe?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422185/">  Stellen Sie sich ein Szenario vor, in dem Ihr maschinelles Lernmodell m√∂glicherweise wertlos ist. <br><br>  Es gibt ein Sprichwort: <i>"Vergleichen Sie √Ñpfel nicht mit Orangen</i> . <i>"</i>  Aber was ist, wenn Sie einen Satz √Ñpfel mit Orangen mit einem anderen vergleichen m√ºssen, die Verteilung der Fr√ºchte in beiden S√§tzen jedoch unterschiedlich ist?  K√∂nnen Sie mit Daten arbeiten?  Und wie wirst du es machen? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/0y/oi/lt0yoiaq5fua0l1gfpguoigfxfa.png"></div><a name="habracut"></a><br>  In realen F√§llen ist diese Situation h√§ufig.  Bei der Entwicklung von Modellen f√ºr maschinelles Lernen sehen wir uns mit einer Situation konfrontiert, in der unser Modell mit einem Trainingssatz gut funktioniert, die Qualit√§t des Modells jedoch bei Testdaten stark abnimmt. <br><br>  Und hier geht es nicht um Umschulung.  Nehmen wir an, wir haben ein Modell erstellt, das bei der Kreuzvalidierung ein hervorragendes Ergebnis liefert, beim Test jedoch ein schlechtes Ergebnis zeigt.  Im Testmuster gibt es also Informationen, die wir nicht ber√ºcksichtigen. <br><br>  Stellen Sie sich eine Situation vor, in der wir das Kundenverhalten in einem Gesch√§ft vorhersagen.  Wenn die Trainings- und Testmuster wie im Bild unten aussehen, ist dies ein klares Problem: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vk/ki/j2/vkkij2n5rlshttroh8mqfse-zf4.png"></div><br>  <i>In diesem Beispiel wird das Modell anhand von Daten trainiert, deren Durchschnittswert des Attributs "Kundenalter" niedriger ist als der Durchschnittswert eines √§hnlichen Attributs im Test.</i>  <i>W√§hrend des Lernprozesses hat das Modell die gr√∂√üeren Werte des Attributs "Alter" nie "gesehen".</i>  <i>Wenn das Alter ein wichtiges Merkmal f√ºr das Modell ist, sollte man keine guten Ergebnisse f√ºr die Testprobe erwarten.</i> <br><br>  In diesem Text werden wir √ºber ‚Äûnaive‚Äú Ans√§tze sprechen, mit denen wir solche Ph√§nomene identifizieren und versuchen k√∂nnen, sie zu beseitigen. <br><br><h3>  Kovariante Verschiebung </h3><br>  Lassen Sie uns dieses Konzept genauer definieren.  <b>Kovarianz</b> bezieht sich auf die Werte der Merkmale, und <b>Kovarianzverschiebung</b> bezieht sich auf eine Situation, in der die Verteilung der Werte der Merkmale in den Trainings- und Testproben unterschiedliche Merkmale (Parameter) aufweist. <br><br>  Bei realen Problemen mit einer gro√üen Anzahl von Variablen ist die kovariante Verschiebung schwer zu erkennen.  Der Artikel beschreibt die Methode zur Identifizierung sowie zur Ber√ºcksichtigung der kovarianten Verschiebung der Daten. <br><br><img src="https://habrastorage.org/webt/no/ta/lj/notaljh1r3c8nimkt45_lp3yyco.png"><br><br><h3>  Hauptidee </h3><br>  <i>Wenn sich die Daten verschieben, k√∂nnen wir beim Mischen der beiden Stichproben einen Klassifizierer erstellen, der bestimmen kann, ob das Objekt zu einer Trainings- oder Teststichprobe geh√∂rt.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/v-/42/pwv-42li1_tl9jqyghnph6czcsg.png"></div><br>  Lassen Sie uns verstehen, warum dies so ist.  Kehren wir zu dem Beispiel mit Kunden zur√ºck, bei dem das Alter ein ‚Äûverschobenes‚Äú Zeichen f√ºr die Schulungs- und Testmuster war.  Wenn wir einen Klassifikator (zum Beispiel basierend auf einem zuf√§lligen Wald) nehmen und versuchen, die gemischte Stichprobe in Training und Test zu unterteilen, ist das Alter ein sehr wichtiges Zeichen f√ºr eine solche Klassifizierung. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/29/wf/j129wfqmbguam_2axs1h6liyt4e.png"></div><br><h3>  Implementierung </h3><br>  Versuchen wir, die beschriebene Idee auf einen realen Datensatz anzuwenden.  Verwenden Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datensatz</a> des Kaggle-Wettbewerbs. <br><br><h4>  Schritt 1: Datenaufbereitung </h4><br>  Zun√§chst folgen wir einer Reihe von Standardschritten: Reinigen, L√ºcken ausf√ºllen, Etikettencodierung f√ºr kategoriale Zeichen durchf√ºhren.  F√ºr das betreffende Dataset war kein Schritt erforderlich. √úberspringen Sie daher die Beschreibung. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-comment"><span class="hljs-comment">#  train  test train = pd.read_csv('train.csv',low_memory=True) test = pd.read_csv('test.csv',low_memory=True)</span></span></code> </pre> <br><h4>  Schritt 2: Hinzuf√ºgen eines Datenquellenindikators </h4><br>  Es ist notwendig, beiden Teilen des Datensatzes einen neuen Indikator hinzuzuf√ºgen - Training und Test.  F√ºr das Trainingsmuster mit dem Wert "1" bzw. f√ºr den Test "0". <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,   test,   train test['is_train'] = 0 train['is_train'] = 1</span></span></code> </pre><br><h4>  Schritt 3: Kombinieren der Lern- und Testbeispiele </h4><br>  Jetzt m√ºssen Sie die beiden Datens√§tze kombinieren.  Da der Trainingsdatensatz eine Spalte mit den Zielwerten 'Ziel' enth√§lt, die nicht im Testdatensatz enthalten ist, muss diese Spalte gel√∂scht werden. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  train, test df_combine = pd.concat([train, test], axis=0, ignore_index=True) #  target df_combine = df_combine.drop('target', axis =1) y = df_combine['is_train'].values #  x = df_combine.drop('is_train', axis=1).values #  tst, trn = test.values, train.values</span></span></code> </pre><br><h4>  Schritt 4: Erstellen und Testen des Klassifikators </h4><br>  F√ºr Klassifizierungszwecke verwenden wir den Random Forest Classifier, den wir konfigurieren, um die Beschriftungen der Datenquelle im kombinierten Datensatz vorherzusagen.  Sie k√∂nnen jeden anderen Klassifikator verwenden. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np rfc = RandomForestClassifier(n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">5</span></span>, min_samples_leaf = <span class="hljs-number"><span class="hljs-number">5</span></span>) predictions = np.zeros(y.shape) <span class="hljs-comment"><span class="hljs-comment">#    </span></span></code> </pre><br>  Wir verwenden eine geschichtete randomisierte Aufteilung von 4 Falten.  Auf diese Weise behalten wir das Verh√§ltnis der 'is_train'-Labels in jeder Falte wie in der urspr√ºnglichen kombinierten Stichprobe bei.  F√ºr jede Partition trainieren wir den Klassifikator f√ºr den Gro√üteil der Partition und sagen die Klassenbezeichnung f√ºr den kleineren zur√ºckgestellten Teil voraus. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StratifiedKFold, cross_val_score skf = StratifiedKFold(n_splits=<span class="hljs-number"><span class="hljs-number">4</span></span>, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fold, (train_idx, test_idx) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(skf.split(x, y)): X_train, X_test = x[train_idx], x[test_idx] y_train, y_test = y[train_idx], y[test_idx] rfc.fit(X_train, y_train) probs = rfc.predict_proba(X_test)[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   predictions[test_idx] = probs</span></span></code> </pre><br><h4>  Schritt 5: Interpretieren Sie die Ergebnisse </h4><br>  Wir berechnen den Wert der ROC AUC-Metrik f√ºr unseren Klassifikator.  Basierend auf diesem Wert schlie√üen wir, wie gut unser Klassifikator eine kovariante Verschiebung der Daten zeigt. <br><br>  <i>Wenn der Klassifikator c die Objekte gut in die Trainings- und Testdatens√§tze unterteilt, sollte der Wert der ROC-AUC-Metrik deutlich gr√∂√üer als 0,5 sein, idealerweise nahe bei 1. Dieses Bild zeigt eine starke kovariante Verschiebung der Daten.</i> <br><br>  Finden Sie den Wert von ROC AUC: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> roc_auc_score print(<span class="hljs-string"><span class="hljs-string">'ROC-AUC:'</span></span>, roc_auc_score(y_true=y, y_score=predictions)) <span class="hljs-comment"><span class="hljs-comment"># ROC-AUC: 0.49974692698385287</span></span></code> </pre><br>  Der resultierende Wert liegt nahe bei 0,5.  Dies bedeutet, dass unser Qualit√§tsklassifizierer mit einem Zufallstag-Pr√§diktor identisch ist.  Es gibt keine Hinweise auf eine kovariante Verschiebung der Daten. <br><br>  Da der Datensatz von Kaggle stammt, ist das Ergebnis ziemlich vorhersehbar.  Wie bei anderen Wettbewerben f√ºr maschinelles Lernen werden die Daten sorgf√§ltig √ºberpr√ºft, um sicherzustellen, dass es keine Verschiebungen gibt. <br><br>  Dieser Ansatz kann jedoch auch auf andere datenwissenschaftliche Probleme angewendet werden, um das Vorhandensein einer kovarianten Verschiebung kurz vor Beginn der L√∂sung zu √ºberpr√ºfen. <br><br><h2>  Weitere Schritte </h2><br>  Entweder beobachten wir eine kovariante Verschiebung oder nicht.  Was tun, um die Qualit√§t des Modells im Test zu verbessern? <br><br><ol><li>  Entfernen Sie voreingenommene Funktionen </li><li>  Verwenden Sie Objektbedeutungsgewichte basierend auf Dichtekoeffizientensch√§tzungen </li></ol><br><h3>  Entfernen voreingenommener Funktionen: </h3><br>  <i><b>Hinweis: Die</b> Methode ist anwendbar, wenn die Daten kovariant verschoben sind.</i> <br><br><ul><li>  Extrahieren Sie die Wichtigkeit von Attributen aus dem Random Forest Classifier, den wir zuvor erstellt und trainiert haben. </li><li>  Die wichtigsten Anzeichen sind genau diejenigen, die voreingenommen sind und eine Verschiebung der Daten verursachen. </li><li>  Beginnen Sie mit dem Wichtigsten, l√∂schen Sie auf einer Basis, erstellen Sie das Zielmodell und √ºberpr√ºfen Sie dessen Qualit√§t.  Sammeln Sie alle Zeichen, bei denen die Qualit√§t des Modells nicht abnimmt. </li><li>  Verwerfen Sie die gesammelten Merkmale aus den Daten und erstellen Sie das endg√ºltige Modell. </li></ul><br><img src="https://habrastorage.org/webt/oa/ga/08/oaga08t43dtyoazhcor8bk3mb8w.png"><br>  <i>Mit diesem Algorithmus k√∂nnen Sie Zeichen aus dem roten Korb im Diagramm entfernen.</i> <br><br><h3>  Verwenden von Objektbedeutungsgewichten basierend auf Dichtekoeffizientensch√§tzungen </h3><br>  <i><b>Hinweis: Die</b> Methode ist unabh√§ngig davon anwendbar, ob die Daten kovariant verschoben sind.</i> <br><br>  Schauen wir uns die Vorhersagen an, die wir im vorherigen Abschnitt erhalten haben.  F√ºr jedes Objekt enth√§lt die Vorhersage die Wahrscheinlichkeit, dass dieses Objekt zum Trainingssatz f√ºr unseren Klassifikator geh√∂rt. <br><br><pre> <code class="python hljs">predictions[:<span class="hljs-number"><span class="hljs-number">10</span></span>] <span class="hljs-comment"><span class="hljs-comment">#array([0.39743827 ...</span></span></code> </pre><br>  Zum Beispiel glaubt unser Random Forest Classifier f√ºr das erste Objekt, dass es mit einer Wahrscheinlichkeit von 0,397 zum Trainingssatz geh√∂rt.  Nennen Sie diesen Wert <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.681ex" height="2.66ex" viewBox="0 -832 3307 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-5A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-75" x="1864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-67" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-29" x="2917" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> P (Zug) </script>  .  Oder wir k√∂nnen sagen, dass die Wahrscheinlichkeit der Zugeh√∂rigkeit zu Testdaten 0,603 betr√§gt.  Ebenso nennen wir Wahrscheinlichkeit <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.205ex" height="2.66ex" viewBox="0 -832 3532.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-54" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-65" x="1845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-73" x="2312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-74" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-29" x="3143" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> P (Test) </script>  . <br><br>  Nun ein kleiner Trick: F√ºr jedes Objekt des Trainingsdatensatzes berechnen wir den Koeffizienten <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.792ex" height="2.66ex" viewBox="0 -832 11105.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-3D" x="994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-66" x="2300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-72" x="2851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-61" x="3302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-63" x="3832" y="0"></use><g transform="translate(4265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-54" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-65" x="1845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-73" x="2312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-74" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-29" x="3143" y="0"></use></g><g transform="translate(7798,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-5A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-75" x="1864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-67" x="2437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMAIN-29" x="2917" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> w = \ frac {P (Test)} {P (Zug)} </script>  . <br><br>  Koeffizient <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.455ex" viewBox="0 -520.7 716.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-77" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> w </script>  Gibt an, wie nahe ein Objekt aus dem Trainingssatz daran liegt, Daten zu testen.  Die Hauptidee: <br><br>  <i>Wir k√∂nnen verwenden</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.664ex" height="1.455ex" viewBox="0 -520.7 716.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/422185/&amp;usg=ALkJrhhWPQno5kRCGZaZAfEZVGznBl812g#MJMATHI-77" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> w </script></i>   <i>wie Gewichte in einem der Modelle, um das Gewicht der Beobachtungen zu erh√∂hen, die der Testprobe √§hnlich sehen.</i>  <i>Intuitiv ist dies sinnvoll, da unser Modell datenorientierter sein wird als in einer Testsuite.</i> <br><br>  Diese Gewichte k√∂nnen mit dem Code berechnet werden: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)) predictions_train = predictions[:len(trn)] weights = (<span class="hljs-number"><span class="hljs-number">1.</span></span>/predictions_train) - <span class="hljs-number"><span class="hljs-number">1.</span></span> weights /= np.mean(weights) <span class="hljs-comment"><span class="hljs-comment">#  plt.xlabel('  w') plt.ylabel(' ') sns.distplot(weights, kde=False)</span></span></code> </pre><br>  Die erhaltenen Koeffizienten k√∂nnen beispielsweise wie folgt auf das Modell √ºbertragen werden: <br><br><pre> <code class="python hljs">rfc = RandomForestClassifier(n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>,max_depth=<span class="hljs-number"><span class="hljs-number">5</span></span>) m.fit(X_train, y_train, sample_weight=weights)</code> </pre><br><br><img src="https://habrastorage.org/webt/_z/nw/rn/_znwrn70amqpw4xosahu1hgj6oa.png"><br><br>  Ein paar Worte zum resultierenden Histogramm: <br><br><ul><li>  Gr√∂√üere Gewichtswerte entsprechen Beobachtungen, die der Testprobe √§hnlicher sind. </li><li>  Fast 70% der Objekte aus dem Trainingssatz haben ein Gewicht nahe 1 und befinden sich daher in einem Unterraum, der dem Trainingssatz und dem Testsatz gleicherma√üen √§hnlich ist.  Dies entspricht dem zuvor berechneten AUC-Wert. </li></ul><br><h2>  Fazit </h2><br>  Wir hoffen, dass dieser Beitrag Ihnen dabei hilft, die ‚Äûkovariante Verschiebung‚Äú der Daten zu identifizieren und zu bek√§mpfen. <br><br><h2>  Referenzen </h2><br>  [1] Shimodaira, H. (2000).  Verbesserung der pr√§diktiven Inferenz unter kovariater Verschiebung durch Gewichtung der Log-Likelihood-Funktion.  Journal of Statistical Planning and Inference, 90, 227-244. <br>  [2] Bickel, S. et al.  (2009).  Diskriminatives Lernen unter Covariate Shift.  Journal of Machine Learning Research, 10, 2137‚Äì2155 <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">github.com/erlendd/covariate-shift-adaption</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link zum verwendeten Datensatz</a> <br><br>  PS Der Laptop mit dem Code aus dem Artikel kann hier angesehen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422185/">https://habr.com/ru/post/de422185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422175/index.html">Umweltverschmutzung verringert die kognitiven F√§higkeiten des Menschen</a></li>
<li><a href="../de422177/index.html">Warum ist Arduino so langsam und was kann man dagegen tun?</a></li>
<li><a href="../de422179/index.html">Von den Wolken zur Erde: So erstellen Sie Kubernetes in Produktionsqualit√§t in jeder Umgebung</a></li>
<li><a href="../de422181/index.html">So sammeln Sie Unternehmensdienste auf einer Online-Plattform: der Geschichte von MegaFon. Business</a></li>
<li><a href="../de422183/index.html">Und was, k√∂nnte es billiger sein?</a></li>
<li><a href="../de422187/index.html">Sberseasons: wie ich diesen Sommer verbracht habe</a></li>
<li><a href="../de422189/index.html">Die Wahrheit √ºber die Implementierung des Intranet-Portals</a></li>
<li><a href="../de422191/index.html">Wie ich eine profitable Android-Texterkennungsanwendung erstellt habe</a></li>
<li><a href="../de422195/index.html">Die Verwendung von ACS im Bergbau</a></li>
<li><a href="../de422197/index.html">Wir sagen ein Wort √ºber die Staffel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>