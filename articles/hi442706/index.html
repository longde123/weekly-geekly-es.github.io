<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП╗тАНЁЯдЭтАНЁЯСиЁЯП╜ ЁЯП┤ тЪбя╕П MySQL - рдПрдХ рдХреНрд╡реЗрд░реА рдореЗрдВ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ ЁЯСиЁЯП┐тАНЁЯН│ ЁЯЦРя╕П тЭДя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЕрдХреНрд╕рд░ рд╡реЗ рдкреВрдЫрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ MySQL рдореЗрдВ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ (рд╡рд┐рдВрдбреЛ) рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдПрдирд╛рд▓реЙрдЧ рд╣реИрдВред рдиреЛрдЯред рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдИ рдПрдирд╛рд▓реЙрдЧ рдирд╣реАрдВ рдереЗ, рд▓реЗрдХрд┐рди рд▓реЗрдЦ рдЕрднреА рднреА MyS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MySQL - рдПрдХ рдХреНрд╡реЗрд░реА рдореЗрдВ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442706/">  рдЕрдХреНрд╕рд░ рд╡реЗ рдкреВрдЫрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ MySQL рдореЗрдВ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ (рд╡рд┐рдВрдбреЛ) рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдПрдирд╛рд▓реЙрдЧ рд╣реИрдВред  <b>рдиреЛрдЯред</b>  <i>рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдИ рдПрдирд╛рд▓реЙрдЧ рдирд╣реАрдВ рдереЗ, рд▓реЗрдХрд┐рди рд▓реЗрдЦ рдЕрднреА рднреА MySQL рдХреЗ рд▓рд┐рдП рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореВрд▓ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЕрдХрд╛рджрдорд┐рдХ рд░реБрдЪрд┐ рд╣реИред</i> <br><br>  рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реНрд╡-рдХрдиреЗрдХреНрдЯрд┐рдВрдЧ рдХреНрд╡реЗрд░реА, рдЬрдЯрд┐рд▓ рдЙрдкрд╢реНрд░реЗрдгреА, рдФрд░ рдЕрдзрд┐рдХ рдЕрдХреНрд╕рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЗрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рдорд╛рдзрд╛рди рдЕрдкреНрд░рднрд╛рд╡реА рд╣реИрдВред <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ MySQL рдореЗрдВ рдХреЛрдИ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдирд╣реАрдВ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдХреБрдЫ рдХрд╛рд░реНрдп рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдпрд╛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ MySQL рдЯреВрд▓ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ SQL рдХреНрд╡реЗрд░реА рдХреЗ рдЕрдВрджрд░ рдЪрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп DBMS рддрдВрддреНрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреВрдард╛, рдЕрдкреНрд░рд╛рдкреНрдп рд╣реИред  рд╣рдо рдХреНрд╡реЗрд░реА рдХреЗ рдЕрдВрджрд░ рдПрдХ рдЪрд░ рдШреЛрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рдореВрд▓реНрдп рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд▓рд┐рдП рдЪрдпрди рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреБрд░реЛрдз рдореЗрдВ рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХреНрд░рдо рдФрд░, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЪрд░ рдХреЛ рдорд╛рди рдЕрд╕рд╛рдЗрди рдХрд░рдиреЗ рдХрд╛ рдХреНрд░рдо рдХрд╕реНрдЯрдо рдЫрдБрдЯрд╛рдИ рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ! <br><br>  рдЪреЗрддрд╛рд╡рдиреАред  рд▓реЗрдЦ рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ рдЪрдпрди рдЦрдВрдб рдореЗрдВ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, MySQL рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рдЗрд╕ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЖрджреЗрд╢ рдХреА рдХреЛрдИ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдкреБрд╖реНрдЯрд┐ рдирд╣реАрдВ рд╣реИред  рд╕рд░реНрд╡рд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╕реНрдерд┐рд░рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдбрдореА CASE рдпрд╛ IF рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h2>  рдкреБрдирд░рд╛рд╡рд░реНрддрди рдПрдирд╛рд▓реЙрдЧ </h2><br>  рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬреЛ рдПрдХ рдлрд╛рдЗрдмреЛрдиреИрдЪрд┐ рдЕрдиреБрдХреНрд░рдо рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ (рдлрд╛рдЗрдмреЛрдиреИрдЪрд┐ рдЕрдиреБрдХреНрд░рдо рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рд╢рдмреНрдж рдкрд┐рдЫрд▓реЗ рджреЛ рдХреЗ рдпреЛрдЧ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рдФрд░ рдкрд╣рд▓реЗ 2 рдПрдХ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИрдВ): <br><a name="habracut"></a><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(X=<span class="hljs-number"><span class="hljs-number">1</span></span>, Fn_1, Fn_2) F <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @I := @I + @J Fn_1, @J := @I + @J Fn_2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> dummy <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)a, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> dummy <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)b, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @I := <span class="hljs-number"><span class="hljs-number">1</span></span>, @J := <span class="hljs-number"><span class="hljs-number">1</span></span>)IJ )T, <span class="hljs-comment"><span class="hljs-comment">/* ,     1 */</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> X <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>)X;</code> </pre> <br>  рдпрд╣ рдХреНрд╡реЗрд░реА 18 рдлрд╛рдЗрдмреЛрдиреИрдЪрд┐ рд╕рдВрдЦреНрдпрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ, рдкрд╣рд▓реЗ рджреЛ рдХреА рдЧрд┐рдирддреА рдирд╣реАрдВ: <br><br><pre> <code class="plaintext hljs">2,3,5,8,13,21,34,55,89,144,233,377,610,987,1597,2584,4181,6765</code> </pre> <br>  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред <br><br>  5) 6) рд▓рд╛рдЗрдиреЛрдВ рдореЗрдВ 9 рд░рд┐рдХреЙрд░реНрдб рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВред  рдпрд╣рд╛рдВ рдХреБрдЫ рднреА рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИред <br><br>  рд▓рд╛рдЗрди 7 рдореЗрдВ) рд╣рдо рджреЛ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ @I, @J рдШреЛрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ 1 рдЕрд╕рд╛рдЗрди рдХрд░рддреЗ рд╣реИрдВред <br><br>  рд▓рд╛рдЗрди 3 рдкрд░), рдирд┐рдореНрди рд╣реЛрддрд╛ рд╣реИ: рдкрд╣рд▓рд╛, рдЪрд░ @I рдХреЛ рджреЛ рдЪрд░ рдХрд╛ рдпреЛрдЧ рд╕реМрдВрдкрд╛ рдЧрдпрд╛ рд╣реИред  рддрдм рд╣рдо рд╡реИрд░рд┐рдПрдмрд▓ @J рдХреЛ рд╕рдорд╛рди рдЕрд╕рд╛рдЗрди рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕ рддрдереНрдп рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП рдХрд┐ @I рдХрд╛ рдореВрд▓реНрдп рдкрд╣рд▓реЗ рд╣реА рдмрджрд▓ рдЪреБрдХрд╛ рд╣реИред <br><br>  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, SELECT рдореЗрдВ рдЧрдгрдирд╛ рдмрд╛рдПрдВ рд╕реЗ рджрд╛рдПрдВ рдХреА рдЬрд╛рддреА рд╣реИ - рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рднреА рджреЗрдЦреЗрдВред <br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЪрд░ рдХрд╛ рдкрд░рд┐рд╡рд░реНрддрди рд╣рдорд╛рд░реЗ рдкреНрд░рддреНрдпреЗрдХ 9 рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд  рдкреНрд░рддреНрдпреЗрдХ рдирдИ рдкрдВрдХреНрддрд┐ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рддреЗ рд╕рдордп, рдЪрд░ @I рдФрд░ @J рдореЗрдВ рдкрд┐рдЫрд▓реА рдкрдВрдХреНрддрд┐ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдХреЗ рдЧрдгрдирд╛ рдХрд┐рдП рдЧрдП рдорд╛рди рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗред <br><br>  рдЕрдиреНрдп DBMS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ <u>рдкреБрдирд░рд╛рд╡рд░реНрддреА рдкреНрд░рд╢реНрди</u> рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ <u>!</u> <br><br>  <b>рдиреЛрдЯ:</b> <br>  <i>рдЪрд░ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдЙрдкрд╡рд░реНрдЧ (рд▓рд╛рдЗрди 7) рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЕрдЧрд░ рд╣рдо SELECT рдХреНрд▓реЙрдЬ рдореЗрдВ рдПрдХ рдЪрд░ рдШреЛрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗрд╡рд▓ 1 рдмрд╛рд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧрд╛)ред</i>  <i>рдПрдХ рдЪрд░ рдХрд╛ рдкреНрд░рдХрд╛рд░ рдЙрд╕ рдореВрд▓реНрдп рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ рдЖрд░рдВрднреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред</i>  <i>рдпрд╣ рдкреНрд░рдХрд╛рд░ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред</i>  <i>рдпрджрд┐ рдЖрдк рд╡реИрд░рд┐рдПрдмрд▓ рдХреЛ NULL рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдХрд╛ рдкреНрд░рдХрд╛рд░ BLOB рд╣реЛрдЧрд╛ред</i> <br><br>  рдХреНрд░рдо рдЬрд┐рд╕рдореЗрдВ SELECT рдореЗрдВ рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХрд╕реНрдЯрдо рдЫрдБрдЯрд╛рдИ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рджрд┐рдП рдЧрдП рдХреНрд░рдо рдореЗрдВ рд▓рд╛рдЗрди рдирдВрдмрд░рд┐рдВрдЧ рдХрд╛ рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> val, @I:=@I+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Num</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> val <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>)a, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @I := <span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> val;</code> </pre><br><pre> <code class="plaintext hljs">Val Num 10 1 20 2 30 3 50 4</code> </pre> <br><h2>  рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдПрдирд╛рд▓реЙрдЧ </h2><br>  рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВред  рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рдлрд╝реАрд▓реНрдб NULL рдирд╣реАрдВ рд╣реИрдВ, рдФрд░ рдПрдХ рдлрд╝реАрд▓реНрдб рдкрд░ рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдФрд░ рдкрд╛рд░реНрдЯреАрд╢рди (рдкрд╛рд░реНрдЯреАрд╢рди рдмрд╛рдп) рд╣реЛрддреЗ рд╣реИрдВред  NULL рдорд╛рди рдФрд░ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдЙрджрд╛рд╣рд░рдг рдЕрдзрд┐рдХ рдмреЛрдЭрд┐рд▓ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ, рд▓реЗрдХрд┐рди рд╕рд╛рд░ рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛ред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, TestTable рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рдПрдБ: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> TestTable( <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, order_id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNIQUE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> );</code> </pre><br>  рдЬрд╣рд╛рдБ <br>  group_id - рд╕рдореВрд╣ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ (рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдлрд╝рдВрдХреНрд╢рди рд╡рд┐рдВрдбреЛ рдХрд╛ рдПрдирд╛рд▓реЙрдЧ); <br>  order_id - рдЫрдБрдЯрд╛рдИ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреВрдард╛ рдХреНрд╖реЗрддреНрд░; <br>  рдореВрд▓реНрдп рдХреБрдЫ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдореВрд▓реНрдп рд╣реИред <br><br>  рдкрд░реАрдХреНрд╖рдг рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рд╣рдорд╛рд░реА рддрд╛рд▓рд┐рдХрд╛ рднрд░реЗрдВ: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> TestTable(order_id, <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> order_id, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> )T;</code> </pre> <br>  рдХреБрдЫ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреЗ рдЙрджрд╛рд╣рд░рдгред <br><br><h3>  1) ROW_NUMBER () OVER (ORDER BY order_id) </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, @I:=@I+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RowNum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @I:=<span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> order_id;</code> </pre> <br> <code>group_id order_id value RowNum <br> 1 1 1 1 <br> 1 2 2 2 <br> 1 3 2 3 <br> 2 4 1 4 <br> 2 5 2 5 <br> 2 6 3 6 <br> 3 7 1 7 <br> 3 8 2 8 <br> 4 9 1 9 <br> 3 11 2 10 <br></code> <br><h3>  2) ROW_NUMBER () OVER (рд╡рд┐рднрд╛рдЬрди group_id ORDER BY рдСрд░реНрдбрд░_рдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛) </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">RowNum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @I:=@I+<span class="hljs-number"><span class="hljs-number">1</span></span>, @I:=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">RowNum</span></span>, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @I:=<span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id )T;</code> </pre> <br> <code>group_id order_id value RowNum <br> 1 1 1 1 <br> 1 2 2 2 <br> 1 3 2 3 <br> 2 4 1 1 <br> 2 5 2 2 <br> 2 6 3 3 <br> 3 7 1 1 <br> 3 8 2 2 <br> 3 11 2 3 <br> 4 9 1 1 <br></code> <br><h3>  3) SUM (рдорд╛рди) OVER (рд╡рд┐рднрд╛рдЬрди group_id ORDER BY рдСрд░реНрдбрд░_рдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛) </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, RunningTotal <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @I:=@I+<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, @I:=<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) RunningTotal, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @I:=<span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id )T;</code> </pre> <br> <code>group_id order_id value RunningTotal <br> 1 1 1 1 <br> 1 2 2 3 <br> 1 3 2 5 <br> 2 4 1 1 <br> 2 5 2 3 <br> 2 6 3 6 <br> 3 7 1 1 <br> 3 8 2 3 <br> 3 11 2 5 <br> 4 9 1 1 <br></code> <br><h3>  4) LAG (рдорд╛рди) OVER (рд╡рд┐рднрд╛рдЬрди group_id ORDER BY рдСрд░реНрдбрд░_рдЖрдИрдбреА рджреНрд╡рд╛рд░рд╛) </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, LAG <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) LAG, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span> := <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span>:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id )T;</code> </pre> <br> <code>group_id order_id value LAG <br> 1 1 1 NULL <br> 1 2 2 1 <br> 1 3 2 2 <br> 2 4 1 NULL <br> 2 5 2 1 <br> 2 6 3 2 <br> 3 7 1 NULL <br> 3 8 2 1 <br> 3 11 2 2 <br> 4 9 1 NULL <br></code> <br>  LEAD рдХреЗ рд▓рд┐рдП, рд╕рдм рдХреБрдЫ рдПрдХ рдЬреИрд╕рд╛ рд╣реИ, рдХреЗрд╡рд▓ рдЖрдкрдХреЛ рдХреНрд░рдо-рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛ ORDER рдХреЛ рдХреНрд░рдордмрджреНрдз рд░реВрдк рд╕реЗ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЖрджреЗрд╢_D DESC <br><br>  COUNT, MIN, MAX рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╕рдм рдХреБрдЫ рдХреБрдЫ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рддрдХ рд╣рдо рд╕рдореВрд╣ (рд╡рд┐рдВрдбреЛ) рдореЗрдВ рд╕рднреА рд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рддрдм рддрдХ рд╣рдо рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдореВрд▓реНрдп рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛ рдкрд╛рдПрдВрдЧреЗред  рдПрдордПрд╕ рдПрд╕рдХреНрдпреВрдПрд▓, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрди рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдВрдбреЛ "рд╕реНрдкреВрд▓" (рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫрд┐рдкреА рд╣реБрдИ рдмрдлрд░ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╡рд┐рдВрдбреЛ рдкрдВрдХреНрддрд┐рдпрд╛рдВ рдбрд╛рд▓рддрд╛ рд╣реИ), MySQL рдореЗрдВ рдРрд╕реА рдХреЛрдИ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИред  рд▓реЗрдХрд┐рди рд╣рдо рдХрд┐рд╕реА рджрд┐рдП рдЧрдП рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдВрдбреЛ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдкрдВрдХреНрддрд┐ рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдореВрд▓реНрдп рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╛рдиреА, рдкреВрд░реА рд╡рд┐рдВрдбреЛ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж), рдФрд░ рдлрд┐рд░, рд░рд┐рд╡рд░реНрд╕ рдСрд░реНрдбрд░ рдореЗрдВ рд╡рд┐рдВрдбреЛ рдореЗрдВ рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд╕реЙрд░реНрдЯ рдХрд░рддреЗ рд╣реБрдП, рдкреВрд░реЗ рд╡рд┐рдВрдбреЛ рдореЗрдВ рдЧрдгрдирд╛ рдореВрд▓реНрдп рдбрд╛рд▓рддреЗ рд╣реИрдВред <br><br>  рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рджреЛ рдЫрдВрдЯрдиреА рдЪрд╛рд╣рд┐рдПред  рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо рдЫрдБрдЯрд╛рдИ рдЙрд╕реА рддрд░рд╣ рдмрдиреА рд░рд╣реЗ рдЬреИрд╕реЗ рдКрдкрд░ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ, рд╣рдо рдкрд╣рд▓реЗ рдлрд╝реАрд▓реНрдб group_id ASC, order_id DESC, рдлрд┐рд░ рдлрд╝реАрд▓реНрдб group_id ASC, order_id ASC рджреНрд╡рд╛рд░рд╛ рдХреНрд░рдордмрджреНрдз рдХрд░рддреЗ рд╣реИрдВред <br><br><h3>  5) COUNT (*) OVER (рд╡рд┐рднрд╛рдЬрди by group_id) </h3><br>  рдкрд╣рд▓реЗ рдкреНрд░рдХрд╛рд░ рдореЗрдВ, рд╣рдо рдмрд╕ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рд╕рдВрдЦреНрдпрд╛ рджреЗрддреЗ рд╣реИрдВред  рджреВрд╕рд░реЗ рдореЗрдВ, рд╣рдо рд╡рд┐рдВрдбреЛ рдХреА рд╕рднреА рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рд╡рд┐рдВрдбреЛ рдореЗрдВ рд▓рд╛рдЗрдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛрдЧреАред <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, Cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @MaxRowNum, @MaxRowNum := RowNumDesc) Cnt, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @I:=@I+<span class="hljs-number"><span class="hljs-number">1</span></span>, @I:=<span class="hljs-number"><span class="hljs-number">1</span></span>) RowNumDesc, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @I:=<span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> <span class="hljs-comment"><span class="hljs-comment">/* */</span></span> )T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @MaxRowNum:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id <span class="hljs-comment"><span class="hljs-comment">/* */</span></span> )T;</code> </pre> <br> <code>group_id order_id value Cnt <br> 1 1 1 3 <br> 1 2 2 3 <br> 1 3 2 3 <br> 2 4 1 3 <br> 2 5 2 3 <br> 2 6 3 3 <br> 3 7 1 3 <br> 3 8 2 3 <br> 3 11 2 3 <br> 4 9 1 1 <br></code> <br>  рдЕрдзрд┐рдХрддрдо рдФрд░ рдиреНрдпреВрдирддрдо рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЧрдгрдирд╛ рд╕рд╛рджреГрд╢реНрдп рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рддреА рд╣реИред  рдореИрдВ рдХреЗрд╡рд▓ MAX рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреВрдВрдЧрд╛: <br><br><h3>  6) MAX (рдорд╛рди) OVER (рд╡рд┐рднрд╛рдЬрди by group_id) </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, MaxVal <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @MaxVal, @MaxVal := MaxVal) MaxVal, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">GREATEST</span></span>(@MaxVal, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>), @MaxVal:=<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) MaxVal, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @MaxVal:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> )T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @MaxVal:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id )T;</code> </pre> <br> <code>group_id order_id value MaxVal <br> 1 1 1 2 <br> 1 2 2 2 <br> 1 3 2 2 <br> 2 4 1 3 <br> 2 5 2 3 <br> 2 6 3 3 <br> 3 7 1 2 <br> 3 8 2 2 <br> 3 11 2 2 <br> 4 9 1 1 <br></code> <br><h3>  7) COUNT (DISTINCT рдореВрд▓реНрдп) OVER (рдкрд╛рд░реНрдЯреА рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛ рднрд╛рдЧ) </h3><br>  рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдЬреЛ рдПрдордПрд╕ SQL тАЛтАЛрд╕рд░реНрд╡рд░ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреА рдЧрдгрдирд╛ рдЖрд░рдПрдХреЗ рд╕реЗ рдореИрдХреНрд╕ рд▓реЗрдиреЗ рдкрд░ рдПрдХ рдЙрдкрд╢рдо рдХреЗ рд╕рд╛рде рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рд╣рдо рдпрд╣рд╛рдВ рднреА рд╡рд╣реА рдХрд░реЗрдВрдЧреЗред  рдкрд╣рд▓реЗ рдкреНрд░рдХрд╛рд░ рдореЗрдВ, рд╣рдо RANK () OVER (PARTITION BY group_id ORDER BY value DESC) рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ, рдлрд┐рд░ рджреВрд╕рд░реЗ рдХреНрд░рдо рдореЗрдВ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдВрдбреЛ рдореЗрдВ рд╕рднреА рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрддрдо рдореВрд▓реНрдп рдбрд╛рд▓рддреЗ рд╣реИрдВ: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, Cnt <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span> := <span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>) Cnt, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> T.*, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@last_group_id = <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>(@<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>:=@<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>) , @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>, @last_group_id := <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span> := <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">last_value</span></span>:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>:=<span class="hljs-number"><span class="hljs-number">0</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span>, order_id <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> )T,(<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @last_group_id:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, @<span class="hljs-keyword"><span class="hljs-keyword">Rank</span></span>:=<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>)I <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, order_id )T;</code> </pre> <br> <code>group_id order_id value Cnt <br> 1 1 1 2 <br> 1 2 2 2 <br> 1 3 2 2 <br> 2 4 1 3 <br> 2 5 2 3 <br> 2 6 3 3 <br> 3 7 1 2 <br> 3 8 2 2 <br> 3 11 2 2 <br> 4 9 1 1 <br></code> <br><h2>  рдЙрддреНрдкрд╛рджрдХрддрд╛ </h2><br>  рдЗрд╕рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╕реНрд╡-рдЬреБрдбрд╝рдиреЗ рдФрд░ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд╡реЗрд░реА рдореЗрдВ рд▓рд╛рдЗрди рдирдВрдмрд░рд┐рдВрдЧ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреА рддреБрд▓рдирд╛ рдХрд░рддреЗ рд╣реИрдВред <br><br><h4>  1) рд╕реЗрд▓реНрдл-рдХрдиреЗрдХреНрдЯрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдХреНрд▓рд╛рд╕рд┐рдХ рддрд░реАрдХрд╛ </h4><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COUNT</span></span>(*)N, T1.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T1 <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> TestTable T2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> T1.order_id &gt;= T2.order_id <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> T1.order_id;</code> </pre> <br>  рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ 10000 рд░рд┐рдХреЙрд░реНрдб рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдЯреЗрд╕реНрдЯрдЯреЗрдмрд▓ рдХрд╛ рдЙрддреНрдкрд╛рджрди рд╣реЛрддрд╛ рд╣реИ: <br><br>  рдЕрд╡рдзрд┐ / рд▓рд╛рдо <br>  16.084 рд╕реЗрдХрдВрдб / 0.016 рд╕реЗрдХрдВрдб <br><br><h4>  2) рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛: </h4><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @N:=@N+<span class="hljs-number"><span class="hljs-number">1</span></span> N, T1.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable T1, (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> @N := <span class="hljs-number"><span class="hljs-number">0</span></span>)M <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> T1.order_id;</code> </pre> <br>  рдпрд╣ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ: <br><br>  рдЕрд╡рдзрд┐ / рд▓рд╛рдо <br>  0.016 рд╕реЗрдХрдВрдб / 0.015 рд╕реЗрдХрдВрдб <br><br>  рдкрд░рд┐рдгрд╛рдо рдЕрдкрдиреЗ рд▓рд┐рдП рдмреЛрд▓рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╕рдордЭрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧрдгрдирд╛ рдХрд┐рдП рдЧрдП рдорд╛рдиреЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдмреЗрд╣рддрд░ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕реЙрд░реНрдЯрд┐рдВрдЧ рдФрд░ рдЧрдгрдирд╛ рд╕рднреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реЛрдЧреА, рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рдЕрдВрдд рдореЗрдВ рд╣рдореЗрдВ рдЙрдирдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рдЖрдЗрдП рдРрд╕реЗ рдХрд╛рд░реНрдп рдХреЗ рдЙрджрд╛рд╣рд░рдг рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: <br><br>  <b>рдкреНрд░рддреНрдпреЗрдХ Group_id рдорд╛рди рдХреЗ рд▓рд┐рдП TestTable рддрд╛рд▓рд┐рдХрд╛ рд╕реЗ рдкрд╣рд▓реЗ 2 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ, рдСрд░реНрдбрд░_рдб рджреНрд╡рд╛рд░рд╛ рд╕реЙрд░реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ред</b> <br><br>  рдпрд╣рд╛рдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдгрд╛рддреНрдордХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде DBMS рдореЗрдВ рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рдХреИрд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>, order_id, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> *, ROW_NUMBER()<span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> order_id) <span class="hljs-keyword"><span class="hljs-keyword">RowNum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable )T <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RowNum</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, MySQL рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬрд╝рд░ рдЙрди рдирд┐рдпрдореЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рдЬрд┐рдирдХреЗ рджреНрд╡рд╛рд░рд╛ рд╣рдо рд░реЛрд╡рдирдо рдХреНрд╖реЗрддреНрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВред  рдЙрд╕реЗ рд╕рднреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдирдВрдмрд░ рджреЗрдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА рдЖрд╡рд╢реНрдпрдХ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рдЕрдм рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ 1 рдорд┐рд▓рд┐рдпрди рд░рд┐рдХреЙрд░реНрдб рдФрд░ 20 рдЕрджреНрд╡рд┐рддреАрдп group_id рдорд╛рди рд╣реИрдВред  рдпрд╛рдиреА  40 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, MySQL рдПрдХ рд▓рд╛рдЦ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП RowNum рдорд╛рди рдХреА рдЧрдгрдирд╛ рдХрд░реЗрдЧрд╛!  MySQL рдореЗрдВ рдПрдХрд▓ рдХреНрд╡реЗрд░реА рдХреЗ рд╕рд╛рде рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдХреЛрдИ рд╕реБрдВрджрд░ рд╕рдорд╛рдзрд╛рди рдирд╣реАрдВ рд╣реИред  рд▓реЗрдХрд┐рди рдЖрдк рдкрд╣рд▓реЗ рдЕрджреНрд╡рд┐рддреАрдп group_id рдорд╛рдиреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable;</code> </pre> <br>  рдлрд┐рд░, рдХрд┐рд╕реА рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдлреЙрд░реНрдо рдХреА рдПрдХ рдХреНрд╡реЗрд░реА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> order_id <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> order_id <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL тАж <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TestTable <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_id</span></span>=<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> order_id <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br>  рдПрдХ рд▓рд╛рдЦ рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд░реЛрд╡рдирдо рдХреА рдЧрдгрдирд╛ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ 20 рдЖрд╕рд╛рди рдкреНрд░рд╢реНрди рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рдХрд╛рдо рдХрд░реЗрдВрдЧреЗред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi442706/">https://habr.com/ru/post/hi442706/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi442696/index.html">рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдПрд╕: рдЗрдВрдЯрд░рдиреЗрдЯ рдХреА рдЪреАрдЬреЗрдВ рдФрд░ рд░рд┐рдкреЛрд░реНрдЯ InoThings ++ 2019 рдкрд░</a></li>
<li><a href="../hi442698/index.html">рд╡рд┐рдВрдбреЛрдЬ рд╕реНрдЯреЛрд░ рдХреЗ рд▓рд┐рдП рдорд╛рд╕реНрдХреЛ рдореЗрдЯреНрд░реЛ рдЖрд╡реЗрджрди</a></li>
<li><a href="../hi442700/index.html">рдХреНрдпрд╛ рдореЛрдмрд╛рдЗрд▓ рд╕реМрд░ рдКрд░реНрдЬрд╛ рд╕рдВрдпрдВрддреНрд░реЛрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреЗ рд▓рд╛рдпрдХ рд╣реИ?</a></li>
<li><a href="../hi442702/index.html">MIPT рдореЗрдВ Tinkoff.ru рдХреА рдореИрдЬрд┐рд╕реНрдЯреНрд░реЗрдЯрд┐рд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi442704/index.html">рдбрд┐рдЬрд╛рдЗрди, рд╡рд┐рдХрд╛рд╕ рдЪрдХреНрд░ рдФрд░ рдкрд░реАрдХреНрд╖рдг</a></li>
<li><a href="../hi442708/index.html">рдЦрдирд┐рдХреЛрдВ рдХрд╛ рд░рд╛рдЬрд╕реНрд╡ рдХреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ?</a></li>
<li><a href="../hi442710/index.html">Google IoT рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреА рд╕рдореАрдХреНрд╖рд╛</a></li>
<li><a href="../hi442714/index.html">рдЬреИрд╕реЗ рджреЛрд╖</a></li>
<li><a href="../hi442716/index.html">footcloths</a></li>
<li><a href="../hi442718/index.html">Google рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдЪреАрди рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдЗрдВрдЬрди рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдХрд╛рдо рдЬрд╛рд░реА рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>