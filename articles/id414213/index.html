<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ‘§ â– ğŸ™‡ğŸ¾ Satu, Dua, Tiga! Chatbot dari Google Sheets menggunakan contoh game PvP untuk Alice ğŸ˜ ğŸ•·ï¸ ğŸ†–</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muncul, Alice memikat pengguna dengan sintesis pidato dan bot obrolan yang berkualitas tinggi secara tak terduga Hari ini, ia diharapkan memiliki kete...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Satu, Dua, Tiga! Chatbot dari Google Sheets menggunakan contoh game PvP untuk Alice</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414213/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/je/rg/em/jergemafxw-e_63-gibe4edxyie.png"></div><br>  Muncul, Alice memikat pengguna dengan sintesis pidato dan bot obrolan yang berkualitas tinggi secara tak terduga  Hari ini, ia diharapkan memiliki keterampilan yang berguna dan permainan yang menarik dengan backend yang dapat mempertimbangkan konteks pengguna dan menerapkan berbagai skenario.  Artikel ini membahas penciptaan keterampilan berdasarkan Google Sheets, alat yang akrab bagi banyak orang dengan potensi besar untuk chatbots kecil. <br><br>  Bermain dengan orang sungguhan bisa lebih menarik daripada bermain dengan karakter virtual, jadi sebagai contoh kita akan mengembangkan game multipemain untuk Alice. <br><a name="habracut"></a><br><h2>  Satu!  Dialog </h2><br>  Permainan dimulai dengan aturan.  Saya datang dengan ini: masing-masing dari dua pemain pertama menempatkan harta dan perangkap di belakang tiga pintu, dan kemudian membuka pintu salah satu dari lawan.  Buka harta - dapatkan koin lawan, buka perangkap - berikan koin kepadanya.  Jumlah koin, dari 1 hingga 3, ditentukan oleh pemain itu sendiri.  Di belakang pintu yang tersisa adalah kotak Pandora, pembukaan yang Anda dapat menemukan / kehilangan jumlah koin acak.  Anda bisa bermain dengan Alice dan melawan pengguna lain. <br><br>  Antarmuka Alice diselesaikan dalam bentuk dialog, dan semua interaksi game harus diimplementasikan melalui pesan.  Pemrosesan setiap pesan oleh server game diwakili oleh langkah-langkah berikut: <br><br><ol><li>  mengembalikan konteks pengguna; </li><li>  interpretasi permintaan dalam konteks yang dipulihkan; </li><li>  membentuk pesan respons; </li><li>  Menyimpan konteks pengguna yang diubah. </li></ol><br><h3>  Pulihkan dan simpan konteks pengguna </h3><br>  Konteks pengguna termasuk statusnya dalam game, termasuk hasil sebelumnya, langkah di dalam skrip dan lawan saat ini, serta nama pengguna dan informasi lain yang diperlukan untuk logika game. <br><br>  Dalam setiap permintaan, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sesuai dengan protokol</a> , Alice melewati ID pengguna.  Ini cukup untuk menyimpan dan kemudian mengembalikan konteksnya. <br><br>  Sebagai gudang data, ambil Google Sheets.  Keuntungan objektif dari solusi ini termasuk penggunaan gratis, visibilitas dan kemudahan penggunaan.  Editor skrip bawaan memungkinkan Anda untuk mendeskripsikan logika gim dalam Apps Script (berdasarkan JavaScript), merujuk ke tabel API, dan menerbitkannya sebagai aplikasi web. <br><br>  Setelah membuat tabel dengan header yang diperlukan, Anda bisa pergi ke editor skrip: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jd/rh/bo/jdrhbosnzge_mq5ms5h0oqnsnqo.png"></div><br>  Logika gim ini dapat dijelaskan dalam proyek di Apps Script, mengaturnya sebagai kumpulan file gs, dan melanjutkan ke publikasi: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nk/w0/kn/nkw0kn0ghmmskohgbtk_nefgc3o.png"></div><br>  Saat menerbitkan, Anda harus menentukan ketersediaan aplikasi untuk pengguna anonim: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g1/sw/fq/g1swfqcp998ufhh96b6lvqb64x0.png"></div><br>  Pada output, Anda akan mendapatkan URL aplikasi web yang diterbitkan.  Fungsi doGet () dan doPost () dalam skrip akan memproses permintaan dari tipe yang sesuai untuk menerima dan menyimpan konteks pengguna. <br><br>  Di bawah ini adalah diagram bekerja dengan tabel API untuk manipulasi data: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  var sheet = SpreadsheetApp.openById("&lt;id &gt;").getSheetByName("&lt; &gt;"); //  var range = sheet.getRange(&lt; &gt;); //   var values = range.getValues(); //    range.setValues(&lt; &gt;);</span></span></code> </pre> <br><h3>  Menafsirkan permintaan dalam konteks yang dipulihkan </h3><br>  Dalam kasus umum, interpretasi yang benar dari permintaan teks membutuhkan penggunaan algoritma NLU yang cerdas.  Dan meskipun algoritma tersebut tersedia dalam alat sederhana seperti yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saya jelaskan oleh Aimylogic</a> , dalam hal ini saya memutuskan untuk meninggalkan pemrosesan bahasa alami demi kesederhanaan. <br><br>  Dalam permainan yang diusulkan, interaksi pemain dengan Alice terbatas pada selusin kemungkinan status dan dapat direduksi menjadi serangkaian niat kecil.  Untuk kesederhanaan, saya selalu menawarkan pemain tiga tindakan yang mungkin: kirim "Satu," "Dua," atau "Tiga."  Untuk permintaan lain, Alice meminta untuk mengklarifikasi tindakan. <br><br>  Skenario dalam kasus ini adalah kode Apps Script berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     switch(user.state){ case "start": //       switch(utterance){ case â€œ1ï¸âƒ£ â€: case â€œ2ï¸âƒ£ â€: case â€œ3ï¸âƒ£ â€: //     default: //     } break; //    default: //      }</span></span></code> </pre><br>  Untuk pengguna, interaksi yang diselesaikan dengan demikian direpresentasikan sebagai pilihan salah satu dari tiga opsi, yang artinya didefinisikan dengan jelas dalam setiap jawaban Alice.  Opsi-opsi itu sendiri diwakili oleh tombol â€œOneâ€, â€œTwoâ€, â€œThreeâ€, yang secara signifikan mempercepat gameplay. <br><br><h3>  Pembuatan pesan respons </h3><br>  Jawaban Alice terdiri dari beberapa bagian, yang masing-masing perlu dibentuk, termasuk: <br><br><ul><li>  teks untuk ditampilkan di layar; </li><li>  teks untuk sintesis pidato; </li><li>  set tombol petunjuk. </li></ul><br>  Baru-baru ini, saya merumuskan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">konsep dialog MUDAH</a> , menjelaskan prinsip-prinsip merancang antarmuka percakapan, termasuk untuk Alice.  Format respons Alice memungkinkan prinsip-prinsip ini diterapkan. <br><br>  Jadi pemisahan teks yang ditampilkan dan diucapkan memungkinkan Anda untuk membuat jawaban lebih singkat dan alami.  Anda tidak dapat memaksa Alice untuk mensintesis teks panjang yang sudah dikenal pengguna, serta menggunakan emoji di teks pesan dan nama tombol. <br><br>  Tombol petunjuk menerapkan prinsip inisiatif: Alice selalu menunjukkan dan menyarankan tindakan yang mungkin untuk melanjutkan dialog.  Dalam skenario permainan yang diusulkan, daftar tombol tidak tergantung pada konteks dan ditambahkan ke setiap pesan. <br><br>  Jadi, kami memiliki Google Table dengan data pengguna yang disimpan dan diambil melalui URL aplikasi web.  Aplikasi ini ditulis dalam Apps Script, itu menginterpretasikan tindakan pengguna sesuai dengan konteksnya dan menghasilkan data untuk pesan respons. <br><br>  Masih terhubung ke Alice ... <br><br><h2>  Dua!  Integrasi </h2><br>  Yandex.Dialogs memungkinkan pengembang untuk menambah keterampilan mereka ke Alice.  Menghubungkan keterampilan bermuara pada tiga hal utama: <br><br><ul><li>  aktivasi; </li><li>  desain; </li><li>  kait web. </li></ul><br><h3>  Aktivasi dan desain </h3><br>  Untuk aktivasi, penting untuk memilih frasa yang dikenali Alice dengan baik, yang memenuhi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">persyaratan formal</a> Yandex.  Jika ada angka dalam nama aktivasi, secara terpisah periksa aktivasi saat memasukkan dari keyboard dan suara. <br><br>  Desain keterampilan termasuk nama, deskripsi, ikon, kategori, dll. <br>  Perlu dipertimbangkan bahwa dalam daftar keterampilan dalam katalog hanya ikon dan frasa aktivasi yang ditampilkan, dan pencarian dalam katalog dilakukan terutama sesuai dengan deskripsi. <br><br><h3>  Mendapatkan kait web </h3><br>  Kait web adalah alamat tempat Alice akan mengirim pesan ke keahlian Anda dan menunggu respons JSON dalam format yang dijelaskan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/za/zy/4t/zazy4tve59hnchb4quwuokqv6ju.png"></div><br><br>  Aplikasi web yang dibuat pada Apps Script mengembalikan respons dalam bentuk halaman html secara default, tetapi dengan menggunakan ContentService, ia dapat dipaksa untuk mengembalikan JSON juga: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ContentService.createTextOutput(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">JSON</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml">)) .setMimeType(ContentService.MimeType.JSON);</span></span></code> </pre> <br>  Namun, saat menggunakan ContentService, Google mengalihkan permintaan pengguna ke URL sementara, yang Yandex.Dialogs tidak siap untuknya.  Oleh karena itu, alamat aplikasi web sebagai pengait web tidak cocok. <br><br>  Ada layanan gratis yang menawarkan kait web yang cocok untuk Alice, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">seperti Zenbot</a> .  Di Zenbot, untuk game yang diusulkan, Anda dapat menulis skrip pendek yang mengakses aplikasi web Google dan mengembalikan respons bersama dengan tombol.  Ngomong-ngomong, dengan cara ini game bisa diintegrasikan tidak hanya dengan Alice, tetapi juga dengan saluran lain. <br><br>  Di bawah ini adalah contoh skrip yang menyediakan permainan "Satu, Dua, Tiga!"  di bot Telegram @RazDvaTriBot: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pattern</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Text"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">var</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Utterance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://script.google.com/macros/s/&lt;id -&gt;/exec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">var</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Result"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userId"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$req_telegram_chat"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utterance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Utterance"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"channel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"telegram"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">get</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">var</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Answer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'javascript: $Result.text'</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Answer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sample</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sample</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">context</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Untuk fleksibilitas yang lebih besar dalam memproses permintaan, Anda dapat menulis server Anda sendiri menggunakan, misalnya, Google App Engine.  Alat ini juga bisa digunakan secara gratis. <br><br>  Setelah membuat proyek di Google App Engine, antarmuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cloud Shell</a> memungkinkan Anda untuk menulis kode server pada satu halaman web dan menyebarkannya ke URL form yang diinginkan https: // &lt;project id&gt; .appspot.com, yang akan menjadi alamat hook web. <br><br>  Operasi server terdiri dari langkah-langkah berikut: <br><br><ol><li>  menerima data permintaan dari Alice; </li><li>  interaksi dengan aplikasi web game; </li><li>  mengirimkan respons dalam format Alice. </li></ol><br><h4>  Terima / kirim data Alice </h4><br>  Dari Alice, penting untuk mendapatkan pengidentifikasi sesi, pengguna, pesan, serta teks permintaan.  Di bawah ini adalah contoh dalam PHP: <br><br><pre> <code class="php hljs"> $data = json_decode(file_get_contents(<span class="hljs-string"><span class="hljs-string">"php://input"</span></span>)); $session_id = $data-&gt;session-&gt;session_id; $user_id = $data-&gt;session-&gt;user_id; $utterance = $data-&gt;request-&gt;original_utterance; $messageId = $data-&gt;session-&gt;message_id;</code> </pre><br>  Sebagai jawaban, tombol dan teks petunjuk dikembalikan ke permainan untuk tampilan dan pengucapan: <br><br><pre> <code class="php hljs"> $button1 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1ï¸âƒ£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $button2 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'2ï¸âƒ£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $button3 = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'3ï¸âƒ£ '</span></span>, <span class="hljs-string"><span class="hljs-string">'hide'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $yaButtons = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($button1, $button2, $button3); $yaResponse = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'text'</span></span> =&gt; $text, <span class="hljs-string"><span class="hljs-string">'tts'</span></span> =&gt; $tts, <span class="hljs-string"><span class="hljs-string">'buttons'</span></span> =&gt; $yaButtons, <span class="hljs-string"><span class="hljs-string">'end_session'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); $yaSession = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'session_id'</span></span> =&gt; $session_id, <span class="hljs-string"><span class="hljs-string">'message_id'</span></span> =&gt; $messageId, <span class="hljs-string"><span class="hljs-string">'user_id'</span></span> =&gt; $user_id); $yaResult = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'response'</span></span> =&gt; $yaResponse, <span class="hljs-string"><span class="hljs-string">'session'</span></span> =&gt; $yaSession, <span class="hljs-string"><span class="hljs-string">'version'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'1.0'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> json_encode($yaResult);</code> </pre><br><h2>  Tiga!  Sinkronkan </h2><br>  Mengirim / menerima data dari aplikasi web membutuhkan waktu, dan Alice ingin memberikan jawaban kepada pengguna, sehingga masalah sinkronisasi mengganggu masalah tersebut. <br><br>  Biasanya, untuk proyek-proyek besar, Google Sheets tidak cocok sebagai backend untuk keterampilan Alice: waktu respons meningkat dengan sejumlah besar permintaan paralel.  Namun demikian, ada rekomendasi untuk mengoptimalkan chatbot, yang memungkinkan untuk membuat proyek kecil layak dalam sistem dialog interaktif real-time. <br><br>  Timeout protokol sinkron Alice - 1,5 detik per respons.  Jika server tidak punya waktu untuk memberikan jawaban selama waktu ini, pengguna melihat pesan sedih dalam semangat "Maaf, &lt;nama dialog&gt; tidak merespons".  Sistem tidak menawarkan petunjuk apa pun yang harus dilakukan selanjutnya. <br><br>  Untuk menghindari situasi seperti itu, Anda dapat dan harus mempercepat layanan, serta melacak dan memproses waktu habis.  Operasi yang paling panjang selama pengoperasian skrip game adalah membaca dan menulis data tabel.  Oleh karena itu, pertama, jumlah operasi ini harus diminimalkan, dan kedua, diinginkan untuk memparalelkannya. <br><br>  Baca data tabel cukup sekali.  Setelah menjalankan logika, skrip siap untuk memberikan jawaban kepada pengguna segera, sebelum akhir rekaman hasil. <br><br>  Waktu terbatas harus diizinkan untuk menerima respons - misalnya, 1100 ms: <br><br><pre> <code class="php hljs"> $request_params = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'userId'</span></span> =&gt; $user_id, <span class="hljs-string"><span class="hljs-string">'utterance'</span></span> =&gt; $utterance, <span class="hljs-string"><span class="hljs-string">'channel'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'alice'</span></span> ); $get_params = http_build_query($request_params); $ctx = stream_context_create(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>=&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'timeout'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1.1</span></span> ) )); $answer = file_get_contents(<span class="hljs-string"><span class="hljs-string">'https://script.google.com/macros/s/&lt;id -&gt;/exec?'</span></span>. $get_params, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, $ctx);</code> </pre><br>  Jika respons diterima oleh permintaan GET tepat waktu, kami dapat mengirimkannya kepada pengguna dan memulai penyimpanan hasil dengan permintaan POST di latar belakang.  Jika tidak, kami memberikan pengguna sebuah tulisan rintisan teks dengan tombol untuk melanjutkan, dan mengabaikan hasil skrip sehingga pengguna dapat mengulangi permintaannya dalam konteks saat ini. <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($answer === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { $text = <span class="hljs-string"><span class="hljs-string">' ,   .'</span></span>; $tts = <span class="hljs-string"><span class="hljs-string">',   .'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $answer = json_decode($answer); $text = $answer-&gt;text; $tts = $answer-&gt;tts; <span class="hljs-comment"><span class="hljs-comment">//   $data2store = $answer-&gt;data; $postdata = json_encode(array( 'data' =&gt; $data2store )); $opts = array('http' =&gt; array( 'method' =&gt; 'POST', 'header' =&gt; 'Content-Type: application/json', 'content' =&gt; $postdata, 'timeout' =&gt; 0.1 ) ); $context = stream_context_create($opts); file_get_contents("https://script.google.com/macros/s/&lt;id -&gt;/exec", false, $context); }</span></span></code> </pre><br><img src="https://habrastorage.org/webt/a1/ez/od/a1ezodgm9tqdt2gudd7vfes9bn0.png" width="320" align="right"><br>  Dalam gim multipemain untuk Alice, tugas sinkronisasi harus diselesaikan antara server gim dan Yandex, dan di antara para pemain.  Jika seorang pemain ingin bermain melawan pengguna lain, permainan itu sendiri memilih lawan - dari mereka yang ingin bermain baru-baru ini.  Pengguna harus mengkonfirmasi kesediaan mereka untuk bermain satu sama lain agar game dapat dimulai. <br><br>  Saat ini, keterampilan tidak dapat memulai mengirim pesan ke pengguna Alice.  Oleh karena itu, skrip permainan menyediakan untuk memeriksa kesiapan lawan dan menit yang dialokasikan untuk putaran permainan.  Jika lawan menunda permainan, pengguna diminta untuk menunggunya: "Tunggu lawan sedikit lagi?"  Dengan menyetujui untuk menunggu, pengguna memulai pemeriksaan lain.  Jika menit pertandingan berakhir, pertandingan berakhir. <br><br><h2>  Kesimpulan </h2><br>  Keuntungan Google Sheets sebagai backend untuk bot obrolan, kecuali gratis, mencakup fakta bahwa itu adalah alat debugging selama pengembangan, dan setelah itu menjadi konsol administrator keterampilan dengan semua kelezatan mengedit kolaboratif dari perangkat apa pun.  Oleh karena penundaan dalam operasi simultan dari sejumlah besar pengguna. <br><br clear="right">  Saya harap artikel ini membantu penggemar dan pengembang untuk dengan cepat menciptakan keterampilan yang berguna untuk Alice atau saluran lainnya.  Game yang diusulkan tersedia di toko keterampilan Yandex.Dialog yang disebut â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">One, Two, Three!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Game multi pemain</a> . " <br><br>  Bersamaan dengan alat untuk tujuan umum, ada solusi khusus untuk pengembangan bot obrolan.  Saya mengundang pembaca untuk mengambil bagian dalam survei kecil tentang layanan yang saya tahu di bidang ini.  Daftar ini tidak termasuk semua produk yang ada - Saya akan berterima kasih atas komentar dengan nama dan ulasan singkat jika Anda menggunakan alat lain. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id414213/">https://habr.com/ru/post/id414213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id414201/index.html">Divine Code (kode TUHAN)</a></li>
<li><a href="../id414203/index.html">Scam atau tidak scam? Kami memeriksa ICO dengan lima metode</a></li>
<li><a href="../id414207/index.html">Masalah inovator, atau mengapa Anda perlu beralih ke pengalaman orang lain</a></li>
<li><a href="../id414209/index.html">IGNG - Algoritma Incremental Neural Gas Bertambah</a></li>
<li><a href="../id414211/index.html">Pengembangan server TELNET berbasis W5500 dan ATMEGA8</a></li>
<li><a href="../id414215/index.html">Blok Kustom dalam Keripik (Silicon IP): Cara Kerja</a></li>
<li><a href="../id414217/index.html">Vertex smartphone lokal: pertama dalam kualitas, pertama dalam chip, pertama dalam desain</a></li>
<li><a href="../id414219/index.html">Pengalaman menggunakan energi surya di wilayah Moskow: untuk, melawan, dan siapa yang membutuhkannya</a></li>
<li><a href="../id414221/index.html">Parsing dan bekerja dengan Codable di Swift 4</a></li>
<li><a href="../id414223/index.html">C #: kompatibilitas ke belakang dan kelebihan beban</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>