<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คฒ๐ป ๐ ๐ ุฃูุถู ุงูููุงุฑุณุงุช ูุญุงููุงุช Kubernetes: ุงูุดููุงุช ุงูุตุญูุฉ ๐ ๐พ โ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL ุ ุฏ 


- ูุชุญููู ุฏุฑุฌุฉ ุนุงููุฉ ูู ุงูููุงุญุธุฉ ูู ุงูุญุงููุงุช ูุงูุฎุฏูุงุช ุงููุฌูุฑูุฉ ูุงููุฌูุงุช ูุงูููุงููุณ ุงูุฃูููุฉ ููุณุช ูุงููุฉ. 
- ูู ุฃุฌู ุงูุชุนุงูู ุจุดูู ุฃุณุฑุน ูุฒูุงุฏุฉ ุชุญูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฃูุถู ุงูููุงุฑุณุงุช ูุญุงููุงุช Kubernetes: ุงูุดููุงุช ุงูุตุญูุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/467155/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/et/w4/sa/etw4sacz-ttuiwcyyvxx1utukq4.jpeg"></p><br><p style=";text-align:right;direction:rtl">  <strong>TL ุ ุฏ</strong> </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชุญููู ุฏุฑุฌุฉ ุนุงููุฉ ูู ุงูููุงุญุธุฉ ูู ุงูุญุงููุงุช ูุงูุฎุฏูุงุช ุงููุฌูุฑูุฉ ูุงููุฌูุงุช ูุงูููุงููุณ ุงูุฃูููุฉ ููุณุช ูุงููุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุงูุชุนุงูู ุจุดูู ุฃุณุฑุน ูุฒูุงุฏุฉ ุชุญูู ุงูุฃุฎุทุงุก ุ ูุฌุจ ุฃู ุชุทุจู ุงูุชุทุจููุงุช ูุจุฏุฃ ูุงุจููุฉ ุงูููุงุญุธุฉ ุงูุนุงููุฉ (HOP). </li><li style=";text-align:right;direction:rtl">  ุนูู ูุณุชูู ุงูุชุทุจูู ุ ูุชุทูุจ NRA: ุชุณุฌูู ููุงุณุจ ุ ููุฑุงูุจุฉ ุฏูููุฉ ุ ูุงููุญูุตุงุช ุงูุตุญูุฉ ุ ูุชุชุจุน ุงูุฃุฏุงุก / ุงูุงูุชูุงู. </li><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู <em>ุงูุฌุงูุฒูุฉ</em> Probe ูุงูุดููุงุช <em>luberProbe</em> Kubernetes ูุนูุตุฑ <em>HOP</em> . <a name="habracut"></a></li></ul><br><h3 id="chto-takoe-shablon-proverki-rabotosposobnosti" style=";text-align:right;direction:rtl">  ูุง ูู ูุงูุจ ุงูุชุญูู ูู ุงูุตุญุฉุ </h3><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุชุตููู ุชุทุจูู ููู ููุบุงูุฉ ููุชููุฑ ููุบุงูุฉ ุ ูู ุงูููู ููุบุงูุฉ ุงูุชูููุฑ ูู ุดูุก ูุซู ุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ.  ูุนุชุจุฑ ุงูุชุทุจูู ูุชุณุงูุญ ูุน ุงูุฃุฎุทุงุก ุฅุฐุง ุชูุช ุงุณุชุนุงุฏุชู ุจุณุฑุนุฉ ุจุนุฏ ุงููุดู.  ูุณุชุฎุฏู ุงูุชุทุจูู ุงูุณุญุงุจู ุงููููุฐุฌู ุจููุฉ microservice - ุนูุฏ ูุถุน ูู ูููู ูู ุญุงููุฉ ูููุตูุฉ.  ูููุชุฃูุฏ ูู ุฃู ุงูุชุทุจูู ุนูู k8s ูููู ุงููุตูู ุฅููู ุจุดูู ูุจูุฑ ุ ุนูุฏ ุชุตููู ูุฌููุนุฉ ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุงุชุจุงุน ุฃููุงุท ูุนููุฉ.  ูู ุจูููุง ูู ูุงูุจ ุงูุชุญูู ูู ุงูุตุญุฉ.  ูุญุฏุฏ ููููุฉ ููุงู ุงูุชุทุจูู ุจุงูุฅุจูุงุบ ุนู k8s ุญูู ุฃุฏุงุฆู.  ูุฐู ููุณุช ููุท ูุนูููุงุช ุญูู ูุง ุฅุฐุง ูุงู ุฌุฑุงุจ ูุนูู ุ ูููู ุฃูุถุง ุญูู ููููุฉ ูุจูู ุงูุทูุจุงุช ูุงูุฑุฏ ุนูููุง.  ูููุง ุนุฑูุช Kubernetes ุนู ุฃุฏุงุก ุฌุฑุงุจ ุ ูุงููุฑุงุฑุงุช ุงูุฃูุซุฑ ุฐูุงุก ุงูุชู ุชุชุฎุฐูุง ุญูู ุชูุฌูู ุญุฑูุฉ ุงููุฑูุฑ ูููุงุฒูุฉ ุงูุชุญููู.  ูุจุงูุชุงูู ุ ูุฅู ูุจุฏุฃ ูุฑุงูุจุฉ ุนุงููุฉ ููุชุทุจูู ูู ุงูููุช ุงูููุงุณุจ ููุฑุฏ ุนูู ุงูุงุณุชูุณุงุฑุงุช. </p><br><h3 id="princip-vysokoy-nablyudaemosti-nor" style=";text-align:right;direction:rtl">  ูุจุฏุฃ ุงูููุงุญุธุฉ ุงูุนุงููุฉ (NRA) </h3><br><p style=";text-align:right;direction:rtl"> ูุจุฏุฃ ูุงุจููุฉ ุงูููุงุญุธุฉ ุงูุนุงููุฉ ูู ุฃุญุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจุงุฏุฆ ุชุตููู ุงูุชุทุจููุงุช ูู ุญุงููุงุช</a> .  ูู ุจููุฉ ุงูุฎุฏูุงุช ุงููุตุบุฑุฉ ุ ูุง ุชูุชู ุงูุฎุฏูุงุช ุจููููุฉ ูุนุงูุฌุฉ ุทูุจูุง (ููู ูุญู ูู ุฐูู) ุ ูููู ูู ุงูููู ููููุฉ ุงูุญุตูู ุนูู ุฅุฌุงุจุงุช ูู ุชููู ุงูุฎุฏูุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ููุตุงุฏูุฉ ูุณุชุฎุฏู ุ ุชุฑุณู ุญุงููุฉ ูุงุญุฏุฉ ุทูุจ HTTP ุขุฎุฑ ุ ูู ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ ุจุชูุณูู ูุนูู - ูุฐุง ูู ุดูุก.  ูููู ูู PythonJS ุฃูุถูุง ุงูุชุนุงูู ูุน ุงูุทูุจ ุ ููููู ู Python Flask ุงูุงุณุชุฌุงุจุฉ.  ุชุดุจู ุญุงููุงุช ุจุนุถูุง ุงูุจุนุถ ุงูุตูุงุฏูู ุงูุณูุฏุงุก ุฐุงุช ุงููุญุชูู ุงููุฎูู.  ููุน ุฐูู ุ ูุชุทูุจ ูุจุฏุฃ NRA ูู ูู ุฎุฏูุฉ ุงููุดู ุนู ุงูุนุฏูุฏ ูู ููุงุท ุงูููุงูุฉ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุงูุชู ุชูุถุญ ูุฏู ููุงุกุชูุง ุ ููุฐูู ุญุงูุฉ ุงูุงุณุชุนุฏุงุฏ ูุงูุชุณุงูุญ ูุน ุงูุฎุทุฃ.  ูุทูุจ Kubernetes ูู ูุฐู ุงูููุงููุณ ุงูุชูููุฑ ูู ุงูุฎุทูุงุช ุงูุชุงููุฉ ููุชูุฌูู ูููุงุฒูุฉ ุงูุชุญููู. </p><br><p style=";text-align:right;direction:rtl">  ูุณุฌู ุชุทุจูู ุงูุณุญุงุจ ุงููุตูู ุฌูุฏูุง ุงูุฃุญุฏุงุซ ุงูุฑุฆูุณูุฉ ุงูุฎุงุตุฉ ุจู ุจุงุณุชุฎุฏุงู ุชุฏููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงูููุงุณูุฉ STDERR ู STDOUT.  ุจุนุฏ ุฐูู ุ ูุชู ุชุดุบูู ุฎุฏูุฉ ูุณุงุนุฏุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ filebeat ุฃู logstash ุฃู fluentd ุ ูุชูุตูู ุงูุณุฌูุงุช ุฅูู ูุธุงู ูุฑุงูุจุฉ ูุฑูุฒู (ุนูู ุณุจูู ุงููุซุงู Prometheus) ููุธุงู ุฌูุน ุงูุณุฌูุงุช (ELK software suite).  ููุถุญ ุงูุฑุณู ุงูุจูุงูู ุฃุฏูุงู ููููุฉ ุนูู ุงูุชุทุจูู ุงูุณุญุงุจู ููููุง ููุงูุจ ุงูุชุญูู ูู ุงูุตุญุฉ ููุจุฏุฃ ุงููุฑุงูุจุฉ ุงูุนููุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/tz/v1/oi/tzv1oixhe3wj4xdwlc08w9roo0k.jpeg"></p><br><h3 id="kak-primenit-shablon-proverki-rabotosposobnosti-v-kubernetes" style=";text-align:right;direction:rtl">  ููููุฉ ุชุทุจูู Health Check Pattern ูู Kubernetesุ </h3><br><p style=";text-align:right;direction:rtl">  ูู ุฎุงุฑุฌ ุงูุตูุฏูู ุ ุชุฑุงูุจ k8s ุญุงูุฉ ุงููุฑูู ุจุงุณุชุฎุฏุงู ูุงุญุฏุฉ ูู ูุญุฏุงุช ุงูุชุญูู (ุนูููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุดุฑ</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ReplicaSets</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DaemonSets</a> ุ ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">StatefulSets</a> ุ ููุง ุฅูู ุฐูู).  ุจุนุฏ ุงูุชุดุงู ุฃู ุงูุณููุฑุฉ ูุฏ ุณูุทุช ูุณุจุจ ูุง ุ ุชุญุงูู ูุญุฏุฉ ุงูุชุญูู ุฅุนุงุฏุฉ ุชุดุบูููุง ุฃู ููููุง ุฅูู ุนูุฏุฉ ุฃุฎุฑู.  ููุน ุฐูู ุ ูุฏ ูุจูุบ pod ุฃูู ููุฏ ุงูุชุดุบูู ุ ูู ุญูู ุฃูู ูู ุญุฏ ุฐุงุชู ูุง ูุนูู.  ุฅููู ูุซุงู: ุชุทุจููู ูุณุชุฎุฏู Apache ูุฎุงุฏู ููุจ ุ ููุช ุจุชุซุจูุช ุงููููู ุนูู ุนุฏุฉ ูุฑูู ูู ุงููุชูุฉ.  ูุธุฑูุง ูุฃู ุงูููุชุจุฉ ูู ูุชู ุชูููููุง ุจุดูู ุตุญูุญ ุ ูุฅู ุฌููุน ุทูุจุงุช ุงูุชุทุจูู ุชุณุชุฌูุจ ุจุงูููุฏ 500 (ุฎุทุฃ ุฎุงุฏู ุฏุงุฎูู).  ุนูุฏ ุงูุชุญูู ูู ุงูุชุณููู ุ ูุนุทู ุงูุชุญูู ูู ุญุงูุฉ ุงููุฑูู ูุชูุฌุฉ ูุงุฌุญุฉ ุ ููุน ุฐูู ุ ูููุฑ ุงูุนููุงุก ุจุดูู ูุฎุชูู.  ูุตููุง ูุฐุง ุงููููู ุบูุฑ ุงููุฑุบูุจ ููู ุนูู ุงููุญู ุงูุชุงูู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/zw/w-/fi/zww-fiwvktahptnfb2izazwzs6u.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุงูุฎุงุต ุจูุง ุ ูุฌุฑู k8s ูุญุตูุง <em>ุตุญููุง</em> .  ูู ูุฐุง ุงูููุน ูู ุงููุญุต ุ ูุชุญูู kubelet ุจุงุณุชูุฑุงุฑ ูู ุญุงูุฉ ุงูุนูููุฉ ูู ุงูุญุงููุฉ.  ุจูุฌุฑุฏ ุฃู ูููู ุฃู ุงูุนูููุฉ ูุฏ ุงุฑุชูุนุช ุ ูุฅูู ุณูุนูุฏ ุชุดุบูููุง.  ุฅุฐุง ุชู ุงูุชุฎูุต ูู ุงูุฎุทุฃ ุจูุฌุฑุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู ุ ูุชู ุชุตููู ุงูุจุฑูุงูุฌ ูุฅููุงู ุชุดุบููู ุนูุฏ ูุฌูุฏ ุฃู ุฎุทุฃ ุ ุซู ุงุชุจุงุน NRA ู Health Check Template ุ ูููู ุงููุญุต ุงูุตุญู ููุนูููุฉ ูุงููุงู.  ุฅูู ูุฃูุฑ ูุคุณู ุฃูู ูุง ูุชู ุฅุฒุงูุฉ ุฌููุน ุงูุฃุฎุทุงุก ุนู ุทุฑูู ุฅุนุงุฏุฉ ุงูุชุดุบูู.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชููุฑ k8s ุทุฑููุชูู ุฃุนูู ูุงุณุชูุดุงู ุฃุฎุทุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">pod</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">livenessProbe</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ReadinessProbe</a> . </p><br><h3 id="livenessprobe" style=";text-align:right;direction:rtl">  LivenessProbe </h3><br><p style=";text-align:right;direction:rtl">  ุฃุซูุงุก <strong>livenessProbe ุ</strong> ููุฌุฑู kubelet ุซูุงุซุฉ ุฃููุงุน ูู ุงูุงุฎุชุจุงุฑุงุช: ูุง ููุชุดู ููุท ูุง ุฅุฐุง ูุงู ุฌุฑุงุจ pod ูุนูู ุ ูููู ูุง ุฅุฐุง ูุงู ุฌุงูุฒูุง ูุชููู ุงูุทูุจุงุช ูุงูุฑุฏ ุนูููุง ุจุดูู ูุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุนููู ุทูุจ HTTP ุฅูู ุฌุฑุงุจ.  ูุฌุจ ุฃู ุชุญุชูู ุงูุงุณุชุฌุงุจุฉ ุนูู ุฑูุฒ ุงุณุชุฌุงุจุฉ HTTP ูู ุงููุทุงู ูู 200 ุฅูู 399. ูููุฐุง ุ ุชุดูุฑ ุฃููุงุฏ 5xx ู 4xx ุฅูู ูุฌูุฏ ูุดููุฉ ูู ุงูุฌุฑุงุจ ุ ุญุชู ุฅุฐุง ูุงูุช ุงูุนูููุฉ ููุฏ ุงูุชุดุบูู. </li><li style=";text-align:right;direction:rtl">  ููุชุญูู ูู ุงูุจุฑุงูุฌ ุบูุฑ ุงููุฑุชุจุทุฉ ุจุฎุฏูุงุช HTTP (ุนูู ุณุจูู ุงููุซุงู ุ ุฎุงุฏู ุจุฑูุฏ Postfix) ุ ููุฒูู ุฅูุดุงุก ุงุชุตุงู TCP. </li><li style=";text-align:right;direction:rtl">  ุชูููุฐ ุฃูุฑ ุชุนุณูู ูููุฑูุฉ (ุฏุงุฎูููุง).  ูุนุชุจุฑ ุงูุชุญูู ูุงุฌุญูุง ุฅุฐุง ูุงู ุฑูุฒ ุฎุฑูุฌ ุงูุฃูุฑ 0. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุนูู ููููุฉ ุนูู ูุฐุง.  ูุญุชูู ุชุนุฑูู pod ุงูุชุงูู ุนูู ุชุทุจูู NodeJS ูุนุทู ุฎุทุฃ 500 ูุทูุจุงุช HTTP. ููุชุฃูุฏ ูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ ุจุนุฏ ุชููู ูุฐุง ุงูุฎุทุฃ ุ ูุณุชุฎุฏู ุงููุนููุฉ livenessProbe: </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">apiVersion: v1 kind: Pod metadata: name: node500 spec: containers: - image: magalix/node500 name: node500 ports: - containerPort: 3000 protocol: TCP livenessProbe: httpGet: path: / port: 3000 initialDelaySeconds: 5</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุง ูุฎุชูู ูุฐุง ุนู ุฃู ุชุนุฑูู <code>.spec.containers.livenessProbe</code> ุ ููููุง ูุถูู ูุงุฆููุง <code>.spec.containers.livenessProbe</code> .  ุชูุจู ุงููุนููุฉ <code>httpGet</code> ุงููุณุงุฑ ุญูุซ ูุชู ุฅุฑุณุงู ุทูุจ HTTP GET (ูู ูุซุงููุง ุ ูุฐุง ูู <code>/</code> ุ ูููู ูู ุณููุงุฑูููุงุช ุงููุนุฑูุฉ ูุฏ ูููู ููุงู ุฃูุถูุง ุดูุก ูุซู <code>/api/v1/status</code> ).  ูุง ุฒุงู livenessProbe ููุจู ุงููุนููุฉ <code>initialDelaySeconds</code> ุ ูุงูุชู <code>initialDelaySeconds</code> ุนูููุฉ ุงูุชุญูู ูู ุงูุตุญุฉ ูุงูุชุธุงุฑ ุนุฏุฏ ูุญุฏุฏ ูู ุงูุซูุงูู.  ููุงู ุญุงุฌุฉ ุฅูู ุงูุชุฃุฎูุฑ ูุฃู ุงูุญุงููุฉ ุชุญุชุงุฌ ุฅูู ููุช ููุจุฏุก ุ ูุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูููุง ุ ูู ุชููู ูุชุงุญุฉ ููุชุฑุฉ ูู ุงูููุช. </p><br><p style=";text-align:right;direction:rtl">  ูุชุทุจูู ูุฐุง ุงูุฅุนุฏุงุฏ ุนูู ูุชูุฉ ุ ุงุณุชุฎุฏู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubectl apply -f pod.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุจุถุน ุซูุงู ุ ููููู ุงูุชุญูู ูู ูุญุชููุงุช pod ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubectl describe pods node500</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุนุซูุฑ ุนูู ูุง ููู ูู ููุงูุฉ ุงูุฅุฎุฑุงุฌ. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ุจุฏุฃุช livenessProbe ุทูุจ HTTP GET ุ ููุฏ ุฃุญุฏุซุช ุงูุญุงููุฉ ุฎุทุฃ 500 (ุงูุฐู ุชูุช ุจุฑูุฌุชู ูู) ุ ูุฃุนุฏ kubelet ุฅุนุงุฏุฉ ุชุดุบููู. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ููุชููุง ุจููููุฉ ุจุฑูุฌุฉ ุชุทุจูู NideJS ุ ูุฅููู app.js ู Dockerfile ุงููุฐูู ุชู ุงุณุชุฎุฏุงูููุง: </p><br><p style=";text-align:right;direction:rtl">  app.js </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">var http = require('http'); var server = http.createServer(function(req, res) { res.writeHead(500, { "Content-type": "text/plain" }); res.end("We have run into an error\n"); }); server.listen(3000, function() { console.log('Server is running at 3000') })</code> </pre> <br><p style=";text-align:right;direction:rtl">  Dockerfile </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">FROM node COPY app.js / EXPOSE 3000 ENTRYPOINT [ "node","/app.js" ]</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุงูุงูุชุจุงู ุฅูู ูุฐุง: ูู ุชุนูุฏ livenessProbe ุชุดุบูู ุงูุญุงููุฉ ุฅูุง ูู ุญุงูุฉ ุญุฏูุซ ุนุทู.  ุฅุฐุง ูู ุชุนูู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุนูู ุฅุตูุงุญ ุงูุฎุทุฃ ุงูุฐู ูุชุนุงุฑุถ ูุน ุชุดุบูู ุงูุญุงููุฉ ุ ููู ุชุชููู kubelet ูู ุงุชุฎุงุฐ ุงูุชุฏุงุจูุฑ ุงููุงุฒูุฉ ูููุถุงุก ุนูู ุงูุนุทู. </p><br><h3 id="readinessprobe" style=";text-align:right;direction:rtl">  readinessProbe </h3><br><p style=";text-align:right;direction:rtl">  ูุนูู readinessProbe ุจุดูู ูุดุงุจู ูู livenessProbes (ุทูุจุงุช GET ูุงุชุตุงูุงุช TCP ูุชูููุฐ ุงูุฃูุงูุฑ) ุ ุจุงุณุชุซูุงุก ุฅุฌุฑุงุกุงุช ุชุญุฑู ุงูุฎูู ูุฅุตูุงุญู.  ูุง ูุชู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ ุงูุชู ูุชู ุชุณุฌูู ุงููุดู ูููุง ุ ูููููุง ูุนุฒููุฉ ุนู ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ.  ุชุฎูู ุฃู ุฅุญุฏู ุงูุนุจูุงุช ุชููู ุจุงููุซูุฑ ูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุฃู ุชุญุช ุงูุญูู ุงูุซููู ุ ููุง ูุฒูุฏ ูู ููุช ุงูุงุณุชุฌุงุจุฉ ููุทูุจุงุช.  ูู ุญุงูุฉ livenessProbe ุ ูุชู ุชุดุบูู ูุญุต ุชููุฑ ุงูุงุณุชุฌุงุจุฉ (ุนุจุฑ ูุนููุฉ ูุญุต timeoutSeconds) ุ ูุจุนุฏ ุฐูู ุชููู kubelet ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ.  ุนูุฏ ุจุฏุก ุชุดุบููู ุ ุชุจุฏุฃ ุงูุญุงููุฉ ูู ุฃุฏุงุก ููุงู ูุซููุฉ ุงูุงุณุชุฎุฏุงู ููููุงุฑุฏ ูุฅุนุงุฏุฉ ุชุดุบูููุง ูุฑุฉ ุฃุฎุฑู.  ูุฐุง ูููู ุฃู ูููู ุญุงุณูุง ููุชุทุจููุงุช ุงูุชู ุชูุชู ุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุงูุณูุงุฑุฉ ูู ุงูุทุฑูู ูู ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู ุ ูุชู ุชุฃุฎูุฑ ุงูุงุณุชุฌุงุจุฉ - ูุชุนุทู ุงูุณูุงุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ููุชุจ ุชุนุฑูู ุงูุฌุงูุฒูุฉ ุงูุฐู ูุญุฏุฏ ููุช ุงูุงุณุชุฌุงุจุฉ ูุทูุจ GET ููุฏุฉ ูุง ุชุฒูุฏ ุนู ุซุงููุชูู ุ ูุณูู ูุณุชุฌูุจ ุงูุชุทุจูู ูุทูุจ GET ูู 5 ุซูุงูู.  ูุฌุจ ุฃู ูุจุฏู ููู pod.yaml ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: Pod metadata: name: nodedelayed spec: containers: - image: afakharany/node_delayed name: nodedelayed ports: - containerPort: 3000 protocol: TCP readinessProbe: httpGet: path: / port: 3000 timeoutSeconds: 2</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชูุณูุน ุฌุฑุงุจ ูุน kubectl: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubectl apply -f pod.yaml</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชุธุฑ ุจุถุน ุซูุงู ุ ุซู ุงูุธุฑ ุฅูู ููููุฉ ุนูู ุงูุฌุงูุฒูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kubectl describe pods nodedelayed</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ููุงูุฉ ุงูุงุณุชูุชุงุฌ ุ ููููู ุฃู ุชุฑู ุฃู ุจุนุถ ุงูุฃุญุฏุงุซ ุชุดุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ูู ููู kubectl ุจุฅุนุงุฏุฉ ุชุดุบูู ุจุฑูุงูุฌ pod ุนูุฏูุง ุชุฌุงูุฒ ููุช ุงููุณุญ 2 ุซุงููุฉ.  ุจุฏูุง ูู ุฐูู ุ ุฃูุบู ุงูุทูุจ.  ูุชู ุฅุนุงุฏุฉ ุชูุฌูู ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ุฅูู ุงููุฑูู ุงูุฃุฎุฑู ุงูุนุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุงุญุธุฉ: ุงูุขู ูุจุนุฏ ุฅุฒุงูุฉ ุงูุญูู ุงูุฒุงุฆุฏ ูู ุงูุญุงูุธุฉ ุ ูุฑุณู kubectl ุงูุทูุจุงุช ุฅููู ูุฑุฉ ุฃุฎุฑู: ูู ุชุนุฏ ุงูุฑุฏูุฏ ุนูู ุทูุจ GET ุชุชุฃุฎุฑ. </p><br><p style=";text-align:right;direction:rtl">  ููููุงุฑูุฉ: ูููุง ููู ููู app.js ุงููุนุฏู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">var http = require('http'); var server = http.createServer(function(req, res) { const sleep = (milliseconds) =&gt; { return new Promise(resolve =&gt; setTimeout(resolve, milliseconds)) } sleep(5000).then(() =&gt; { res.writeHead(200, { "Content-type": "text/plain" }); res.end("Hello\n"); }) }); server.listen(3000, function() { console.log('Server is running at 3000') })</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>TL ุ ุฏ</strong> <br>  ูุจู ุธููุฑ ุงูุชุทุจููุงุช ุงูุณุญุงุจูุฉ ุ ูุงูุช ุงูุณุฌูุงุช ูู ุงููุณููุฉ ุงูุฑุฆูุณูุฉ ููุฑุงูุจุฉ ุญุงูุฉ ุงูุชุทุจููุงุช ูุงูุชุญูู ูููุง.  ููุน ุฐูู ุ ูู ููู ููุงู ุฃู ูุณููุฉ ูุงุชุฎุงุฐ ุฃู ุฎุทูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง.  ุงูุณุฌูุงุช ูููุฏุฉ ุงูููู ุ ูุฌุจ ุฌูุนูุง ูุฅุฑุณุงููุง ุฅูู ูุธุงู ุชุฌููุน ุงูุณุฌู ูุชุญููู ุญุงูุงุช ุงูุทูุงุฑุฆ ูุงุชุฎุงุฐ ุงููุฑุงุฑุงุช.  [ <em>ูู ูุฐุง ูููู ุงูููุงู ุจู ุฏูู ุงุณุชุฎุฏุงู ุงูุชุทุจููุงุช ุงูุณุญุงุจูุฉ monit ุ ุนูู ุณุจูู ุงููุซุงู ุ ูููู ูุน k8s ุฃุตุจุญ ุฃุณูู ุจูุซูุฑ :) - Ed.</em>  ] </p><br><p style=";text-align:right;direction:rtl">  ุงูููู ุ ูุฌุจ ุฅุฌุฑุงุก ุงูุชุตุญูุญุงุช ูู ุงูููุช ุงููุนูู ุชูุฑูุจูุง ุ ูุฐูู ูุฌุจ ุฃูุง ุชููู ุงูุชุทุจููุงุช ูุฑุจุนุงุช ุณูุฏุงุก.  ูุง ุ ูุฌุจ ุนูููู ุฅุธูุงุฑ ููุงุท ุงูููุงูุฉ ุงูุชู ุชุณูุญ ูุฃูุธูุฉ ุงููุฑุงูุจุฉ ุจุทูุจ ูุฌูุน ุจูุงูุงุช ูููุฉ ุนู ุญุงูุฉ ุงูุนูููุงุช ุญุชู ูุชููููุง ูู ุงูุงุณุชุฌุงุจุฉ ุนูู ุงูููุฑ ุฅุฐุง ูุฒู ุงูุฃูุฑ.  ูุฐุง ูุณูู ูุงูุจ Health Check Design ุ ุงูุฐู ูุชุจุน ูุจุฏุฃ ุงููุฑุงูุจุฉ ุงูุนููุง (NRA). </p><br><p style=";text-align:right;direction:rtl">  ุชูุฏู Kubernetes ุงูุชุฑุงุถููุง ููุนูู ูู ุงููุญูุตุงุช ุงูุตุญูุฉ: ุงูุฌุงูุฒูุฉ ู livenessProbe.  ููุงููุง ูุณุชุฎุฏู ููุณ ุฃููุงุน ุงูุงุฎุชุจุงุฑุงุช (ุทูุจุงุช HTTP GET ุ ุงุชุตุงูุงุช TCP ุ ูุชูููุฐ ุงูุฃูุงูุฑ).  ุฃููุง ุชุฎุชูู ูู ุงููุฑุงุฑุงุช ุงูุชู ูุชู ุงุชุฎุงุฐูุง ุงุณุชุฌุงุจุฉ ูููุดุงูู ูู ุงููุฑูู.  ุชููู livenessProbe ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูุญุงููุฉ ุนูู ุฃูู ุฃูุง ูุญุฏุซ ุงูุฎุทุฃ ูุฑุฉ ุฃุฎุฑู ุ ูุฃู ูุนุฒู ReadinessProbe ุงูุญุงูุธุฉ ูู ุญุฑูุฉ ุงููุฑูุฑ ุงููุงุฑุฏุฉ ุญุชู ูุชู ุญู ุณุจุจ ุงููุดููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุชุถูู ุงูุชุตููู ุงูููุงุณุจ ููุชุทุจูู ููุง ุงูููุนูู ูู ุงูุชุญูู ูุฃูููุง ูุฌูุนุงู ุจูุงูุงุช ูุงููุฉ ุ ุฎุงุตุฉู ุนูุฏ ุฅูุดุงุก ุงุณุชุซูุงุก.  ูุฌุจ ุฃู ููุธูุฑ ุฃูุถูุง ููุงุท ููุงูุฉ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุถุฑูุฑูุฉ ุงูุชู ุชููู ููุงููุณ ุงูุญุงูุฉ ุงูุตุญูุฉ ุงููููุฉ ุฅูู ูุธุงู ุงููุฑุงูุจุฉ (ูุชุณูู ุฃูุถูุง ุจุฑูููุซููุณ). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar467155/">https://habr.com/ru/post/ar467155/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar467145/index.html">ููุณ ููุท ุงูุชุฏุงูู: ููููุฉ ุงุณุชุฎุฏุงู ุงูุจูุฑุตุฉ ูุจุฏูู ูููุฏุงุฆุน ุงููุตุฑููุฉ ููุณุจ ุงูุฏุฎู</a></li>
<li><a href="../ar467147/index.html">ูุฌูุงุช ุฌูุงุนูุฉ: ููุงูุญ ุฑุฏ ุงููุนู ุนูู ุชุฌุฑุจุฉ ุงูุณููุงุช ุงูุฃุฎูุฑุฉ</a></li>
<li><a href="../ar467149/index.html">ุงูุขุซุงุฑ: 1992 ูู ุงูุตุญุงูุฉ ุงูููุจููุชุฑ</a></li>
<li><a href="../ar467151/index.html">ูุนุงูุฌุฉ ุงูุงุนุชุฑุงุถุงุช: ุณูุณุชุบุฑู ุงูุชุญููู ุงูุซุงุจุช ุฌุฒุกูุง ูู ููุช ุงูุนูู</a></li>
<li><a href="../ar467153/index.html">ุงูุนูู ุจุงุณุชุฎุฏุงู ุงูุงุนุชุฑุงุถุงุช: ุณูุฃุฎุฐ ุงูุชุญููู ุงูุซุงุจุช ุฌุฒุกูุง ูู ููุช ุงูุนูู</a></li>
<li><a href="../ar467161/index.html">ุชุทุจูู ููุจ ุนูู Kotlin + Spring Boot + Vue.js</a></li>
<li><a href="../ar467163/index.html">ููู ุชูุงุฌุฑ ุฅูู ุงูุณุญุงุจุฉ ุฎูุงู ุณุงุนุชูู ุจูุถู Kubernetes ูุงูุฃุชูุชุฉ</a></li>
<li><a href="../ar467165/index.html">ุนูู ุฎุทู ุญุฑูุฉ Scala ุงูุฑูุณูุฉ. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar467169/index.html">ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ ูู ุงุฎุชุจุงุฑ ุฃูุซุฑ ูู 200000 ุณุทุฑ ูู ููุฏ ุงูุจููุฉ ุงูุชุญุชูุฉ</a></li>
<li><a href="../ar467171/index.html">ูุง ุชุนููุชู ุนู ุทุฑูู ุงุฎุชุจุงุฑ 200000 ุณุทุฑ ูู ุฑูุฒ ุงูุจููุฉ ุงูุชุญุชูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>