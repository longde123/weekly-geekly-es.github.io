<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧘🏽 🙏🏼 👆🏻 Wenn Sie eine schöne GUI wollen, aber GPU nicht 🔡 🤽🏻 🛌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In der Regel benötigen funktionierende Dienstprogramme keine vernünftige Benutzeroberfläche mit Schaltflächen, Listen, Fenstern, Mausunterstützung und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wenn Sie eine schöne GUI wollen, aber GPU nicht</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468485/">  In der Regel benötigen funktionierende Dienstprogramme keine vernünftige Benutzeroberfläche mit Schaltflächen, Listen, Fenstern, Mausunterstützung und anderen kleinen Dingen. Der größte Teil der funktionierenden Wunschliste kann in Skripten gepackt und manchmal mit dem Parameter --help ausgeführt werden. Dies ist unter dem Gesichtspunkt der Konfiguration sogar noch korrekter und Skalierung.  Alles wird schlimmer, wenn nicht nur das Entwicklungsteam, sondern auch Dritte beginnen, die Tools zu verwenden.  Und sie sind nicht immer bereit, sich mit den harmonischen Gedanken zu befassen, die in den Codezeilen niedergelegt sind.  Und dann muss man die Benutzeroberfläche durcheinander bringen, und die Entwickler bekommen sie normalerweise einfach, quadratisch, funktional und völlig langweilig.  Vor einiger Zeit arbeitete ich an einem kleinen Lüftungs- / Heizungs- / Kamerasteuerungssystem und auch an „was der Onkel in einem gelben Helm sich einfallen lässt“ für eine Tiefgarage. <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/la/mh/qc/lamhqcsmhwd6aqcypqlumod45ry.png"></div><br><a name="habracut"></a><br>  (Hier ist ein Bild aus dem UI-System, aber der Entwickler hat darum gebeten, es zu entfernen. Wenn Sie nicht über Spaziergänge auf dem Rechenfeld lesen möchten, klicken Sie auf den Github am Ende des Artikels.) <br><br>  Das System wurde auf dem chinesischen SoC ohne Namen aufgebaut, für den der Hersteller beschlossen hat, das SDL-Framework der ersten Version zu portieren.  Die internen Tools und Skripte wurden so fertiggestellt, dass sie sich in ein gewichtiges und „schönes“ Layout mit Registerkarten, Listen, Popups, Schatten, Farbverläufen, Transparenz und anderen Extras verwandelten. <br><br>  Um all die Schönheiten zu verwirklichen, wurde Nanogui ausgewählt, einfach und unprätentiös und gleichzeitig "mächtig", was alles brauchte.  Es war genau auf dem Papier, aber die <s>Schluchten</s> vergaßen OpenGL.  Fast vollständig implementierte UI-Steuerungssysteme liefen auf Hardware, und dort gab es einen schwarzen Bildschirm, alle OpenGL3-Initialisierungen verliefen fehlerfrei, Puffer wurden gesetzt und Shader wurden kompiliert, aber kein ... schwarzer Bildschirm, in welchem ​​Winkel nicht. <br><br>  Zuerst sündigten sie an meinen krummen Händen, dann an den Händen des Antokha-Entwicklers, der für den Treiber und die Hardware verantwortlich ist, dann starteten sie ein Testbeispiel für ein Dreiecks-Rendering aus dem SoC SDK, und wieder werden der schwarze Bildschirm, die Dokumentation und die Beispiele normalerweise zuletzt gelesen. <br><br>  Mein Kollege und ich dachten etwas falsch und gingen zuerst zum chinesischen Forum. Nachdem wir noch keine klaren Antworten für den Entwickler gefunden hatten, war die Antwort enttäuschend, es gab keine OpenGL-Implementierung und höchstwahrscheinlich auch nicht, da die Leitung eingestellt wurde. <br>  - Aber was ist mit dem SDL-Framework?  - Wir haben gefragt <br>  - Wir zeichnen Pixel für Pixel in den Videospeicher.  - Unsere chinesischen Freunde haben uns geantwortet. <br><br>  An diesem Tag sah ich die traurigen Augen eines Programmierers, der berechnet, wie viel LoC er an / dev / null senden wird.  Das Werfen einer vorgefertigten Lösung war jedoch sehr enttäuschend <s>(im Internet gibt es alles).</s> Es stellt sich heraus, dass Sie ohne OpenGL in Nanogui auf einem Software-Render leben können. <br><br>  Es ist nur möglich, sehr langsam zu leben, auf einem großen PC einige Sekunden pro Frame, nach dem chinesischen Wunder der Technik sind es bereits etwa 20 bis 25 Sekunden zum Zeichnen.  Dann beschlossen sie, nicht die gesamte Benutzeroberfläche auf einmal zu rendern, sondern nur die erforderlichen (geänderten) Teile der Widgets, aber selbst in diesem Modus dauerte es bei all den Hacks und Optimierungen mehr als 10 Sekunden pro Frame, was nicht möglich war ... <br><br>  Nachdem wir einige SDK-Beispiele geraucht hatten, stellten wir fest, dass das Kopieren von vorgefertigten Texturen in den Videospeicher „sofort“ erfolgt (im Vergleich zu natürlich 10 Sekunden). Wenn Sie mehrere dieser Texturen nacheinander kopieren, dauert es ungefähr 1 ms bis 512 x 512 ohne Transparenz und 2 ms für dasselbe mit Transparenz Die Zeit wächst nichtlinear katastrophal, was sich als Folge der begrenzten Menge an Videospeicherpuffer herausstellte, deren Überlauf dazu führte, dass der Puffer geleert und gerendert wurde, was sich auf dem Bildschirm befand (nicht meins, es war bereits vorhanden), d. h.  Für eine nicht vollständig tote Schnittstelle können wir nicht mehr als 50-100 Texturen pro Frame kopieren und nicht sofort, sondern erst, nachdem der Videotreiber darauf gewartet hat, die Daten aus dem Puffer zu entnehmen. <br><br>  Die nächste Iteration war das Rendern des Widgets in seine eigene Textur im Stream, und zum Zeitpunkt der Erstellung der Textur wurde das Widget ungefähr ähnlich wie das Endergebnis gezeichnet, nur auf quadratische Weise, um alle Arten von Linien zu zeichnen. Formen konnten sofort kostenlos im Videospeicher gespeichert werden. <br><br>  Fast das Wunder des chinesischen Denkens „ohne“ GPU besiegt, kann man die 20 FPS immer noch nicht als anständiges Ergebnis bezeichnen. Nachdem ich das Projekt fast abgeschlossen hatte, bat ich den Kunden um Erlaubnis, einige der Erfahrungen in Open Source zu sammeln.  Die erste SDL ist derzeit nicht sehr in Mode, daher wurde beschlossen, das Nanogui-Rendering im Softwaremodus auf SDL2 zu verwenden und auf den Github zu setzen.  Vielleicht braucht jemand :) <br><br>  Nachdem% habruiser% den Artikel bis zum Ende gelesen hat, hat er das Recht zu fragen, warum es notwendig war, diesen Code zu blockieren <br>  für abgerundete Ecken und Schatten?  Erstens ist es schön, zweitens "dieser Onkel in einem gelben Helm" hat bereits für die Entwicklung des Systems bezahlt und die abgerundeten Ecken dort sind leider (oder zum Glück) in der Aufgabenliste gelandet. Es bleibt, sie mit einem Farbverlauf zu versehen und einige Schatten hinzuzufügen. <br><br>  Dies war der ursprüngliche Sommer 2017 im sonnigen Sotschi. <br><br>  <b>So rendert OpenGL</b> <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/07/fn/gp/07fngpg0alfxkwm_uyaasgepssa.png"></div><br><br>  <b>So wird Software auf einem PC gerendert</b> <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/ni/sg/a2/nisga2_fzvja7pmnfci5qja-xqk.png"></div><br><br>  <b>Referenzen</b> : <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Original Wjakob / Nanogui</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NanoVG-Software rendern</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">NanoGUI + SDL + Software rendern</a> <br><br>  PS Glauben Sie nicht, dass die <s>chinesischen</s> Entwickler über das Vorhandensein von OpenGL im System sprechen, überprüfen Sie die Leistung aller Komponenten, um zu wissen, wie :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468485/">https://habr.com/ru/post/de468485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468463/index.html">Verbessern der Zabbix + PostgreSQL-Leistung durch Partitionierung und Indizierung</a></li>
<li><a href="../de468465/index.html">Ansicht des Anwalts: Wie können IT-Unternehmen einen Vertrag mit einem giftigen Regierungskunden kündigen?</a></li>
<li><a href="../de468471/index.html">Übersicht über AngularConnect 2019. Teil 1</a></li>
<li><a href="../de468479/index.html">„Die Leute denken, dass frei wertlos ist. Es schien mir, dass ich sie überzeugen konnte “- Yuri Yartsev über die Russol-Schule</a></li>
<li><a href="../de468481/index.html">Wie S7 als erste in Russland Flugtickets online verkaufte</a></li>
<li><a href="../de468487/index.html">Was kann passieren (typische Angriffsvektoren)</a></li>
<li><a href="../de468489/index.html">HTTP Request Schmuggel - neue Ansätze</a></li>
<li><a href="../de468491/index.html">Hurras karmischer Fluch</a></li>
<li><a href="../de468493/index.html">Die Struktur der Luftaufnahme des Data Science-Projekts</a></li>
<li><a href="../de468497/index.html">Zeitgesteuerter 3-Minuten-Bürst-Timer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>