<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òùüèæ üå≤ üîë C√≥mo minimizar los errores al integrarse con servicios externos: la experiencia de un corredor en l√≠nea ‚è∏Ô∏è üç¥ üíÜüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante un a√±o y medio, integramos API con veinte servicios externos. Las primeras cinco integraciones pasaron por el dolor y las l√°grimas: cometimos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo minimizar los errores al integrarse con servicios externos: la experiencia de un corredor en l√≠nea</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441152/">  Durante un a√±o y medio, integramos API con veinte servicios externos.  Las primeras cinco integraciones pasaron por el dolor y las l√°grimas: cometimos todos los errores posibles.  Reescribieron el c√≥digo varias veces, se separaron de los socios justo antes del lanzamiento, porque no pod√≠an ponerse de acuerdo sobre las mejoras.  Tiempo perdido y dinero. <br><br>  Pero con cada nueva integraci√≥n, encontramos soluciones para problemas recurrentes.  Como resultado, hicimos la √∫ltima integraci√≥n cuatro veces m√°s r√°pida que la primera.  Lo que ahora hacemos de manera diferente: lea el art√≠culo. <br><a name="habracut"></a><br>  Para que comprenda mejor los detalles de nuestras integraciones, describiremos brevemente lo que hacemos.  Estamos desarrollando un corredor en l√≠nea.  Principio de trabajo: el usuario llega al sitio, completa el cuestionario, lo transferimos a las organizaciones de microfinanzas (IMF) y recibimos la aprobaci√≥n o el rechazo de un pr√©stamo.  El usuario selecciona una oferta adecuada y recibe dinero.  Para que esto funcione en l√≠nea, nos integramos con las IMF a trav√©s de API. <br><br><h2>  Evaluar la preparaci√≥n de los socios para la integraci√≥n mediante una lista de verificaci√≥n y especificaciones </h2><br>  Analizaremos dos escenarios: cuando un socio potencial ya tiene una API para aceptar aplicaciones, y cuando no.  Ambos escenarios sugieren que el socio desea integrarse con nosotros y est√° listo para pasar tiempo en esto. <br><br><h3>  El socio no tiene API: enviamos la especificaci√≥n </h3><br>  <b>Anteriormente,</b> le explicamos al socio, verbalmente o por correspondencia, lo que necesit√°bamos para la integraci√≥n, y el socio basado en estas explicaciones hizo una API para aceptar aplicaciones con Finspin.  No acordamos los requisitos para los modelos, objetos, campos del cuestionario y las reglas para su validaci√≥n.  Describi√≥ r√°pidamente el prop√≥sito de los m√©todos y las posibles respuestas.  El resultado result√≥ estar infinitamente lejos de lo esperado, porque nuestra comprensi√≥n de la API era muy diferente de la asociaci√≥n.  Tuve que rehacer todo. <br><br>  <b>Ahora</b>  Escribimos nuestra especificaci√≥n: un archivo YAML que se puede abrir en Swagger.  En la especificaci√≥n, describimos la API m√°s adecuada para integrar Finspin con las IMF: campos de cuestionarios y reglas para su validaci√≥n, formatos y tipos de solicitudes con respuestas, nombres de m√©todos, posibles errores y estados.  Registramos el estado del estado de la solicitud que planeamos recibir, por ejemplo: "aceptado para procesamiento", "puntuaci√≥n en progreso", "pr√©stamo denegado", "aprobaci√≥n", etc. <br><br>  Enviamos la especificaci√≥n al socio, y √©l decide si puede proporcionar dicha API.  Si no puede, observa puntos problem√°ticos en la especificaci√≥n, por ejemplo, no todos los estados de la aplicaci√≥n est√°n listos para ser transferidos a la API o no hay suficientes campos en el cuestionario.  Y ya estamos discutiendo puntos espec√≠ficos, no entidades abstractas.  El socio no pierde el tiempo escribiendo su documentaci√≥n, sino que ajusta la nuestra. <br><br>  Pasamos dos d√≠as creando la especificaci√≥n, pero ahora estamos ahorrando decenas de horas en aprobaciones y mejoras a la API.  Adem√°s, con la ayuda de las especificaciones, filtramos r√°pidamente a los socios que no est√°n listos para la integraci√≥n.  En las primeras etapas, queda claro que nuestros procesos de procesamiento de solicitudes en l√≠nea son muy diferentes: no es rentable integrarlos. <br><br><h3>  El socio tiene una API: ejecuta la lista de verificaci√≥n </h3><br>  Sol√≠amos obtener las especificaciones de un socio y hacer preguntas sobre la marcha.  A menudo se olvidaron de aclarar algo importante, y luego este importante surgi√≥ en las etapas finales de desarrollo y prueba, cuando se volvi√≥ especialmente costoso arreglarlo y reescribirlo.  De alguna manera, al final de la integraci√≥n con un socio, result√≥ que transferir√≠a el estado de los pr√©stamos a trav√©s de API con un retraso de varios d√≠as.  Para nosotros, esto es inaceptable.  La sociedad tuvo que ser abandonada. <br><br>  <b>Ahora</b>  Hemos escrito una lista de verificaci√≥n para evaluar la API y los procesos que sirve.  La lista de verificaci√≥n recopil√≥ preguntas que deben ser respondidas.  Primero, nuestro gerente busca respuestas en la especificaci√≥n.  Si no se encuentra, dirige las preguntas al socio. <br><br>  La lista de verificaci√≥n ayuda a encontrar cuellos de botella antes del inicio del desarrollo, y no despu√©s, cuando tiene que editar el c√≥digo y los clientes sufren debido al mal servicio. <br><br>  Reabastecemos constantemente la lista de verificaci√≥n cuando nos enfrentamos a nuevas situaciones.  Cuanto m√°s detallada sea la lista de verificaci√≥n, menor ser√° el riesgo de omitir errores en el desarrollo. <br><br><img src="https://habrastorage.org/webt/sa/u7/m4/sau7m4kwc3-mzhxwaq37w1pu1pm.png" width="600"><br>  <i>Fragmento de lista de verificaci√≥n de API</i> <br><br><h2>  Glosario de T√©rminos </h2><br>  <b>Anteriormente,</b> nos parec√≠a que en el campo de los pr√©stamos en l√≠nea todos entienden los t√©rminos profesionales de la misma manera, no puede haber discrepancias.  La pr√°ctica ha demostrado que est√°bamos equivocados. <br><br>  Por ejemplo, con una IMF, interpretamos a los clientes primarios y repetidos de manera diferente.  Para nosotros, el cliente principal es el cliente cuyo perfil ingres√≥ por primera vez a la base de datos de MFI a trav√©s de Finspin, y el cliente habitual ya estaba en la base de datos.  El socio consider√≥ a los clientes que repiten por el n√∫mero de pr√©stamos emitidos: repiti√≥ recibi√≥ dos pr√©stamos y obtuvo un tercero.  Tal confusi√≥n terminol√≥gica podr√≠a conducir a inconsistencias en las conciliaciones financieras. <br><br>  <b>Ahora</b> usamos un peque√±o glosario de t√©rminos por el cual verificamos con los socios.  Como regla, es suficiente aclarar cinco o seis t√©rminos b√°sicos para sincronizar ideas sobre integraci√≥n y evaluar las perspectivas de colaboraci√≥n. <br><br>  Una vez que un glosario de t√©rminos nos ha ayudado a evitar una integraci√≥n desventajosa.  Nuestra interpretaci√≥n de "aprobaci√≥n" fue muy diferente de la del afiliado.  La "aprobaci√≥n" del socio incluy√≥ muchos aspectos diferentes que requer√≠an procesamiento manual.  Nos esforzamos por lograr la m√°xima automatizaci√≥n, por lo que inmediatamente nos negamos a cooperar. <br><br><img src="https://habrastorage.org/webt/zf/8s/8i/zf8s8i52-w3mfjcqncaxcelxlpq.png" width="800"><br>  <i>Aclarar el t√©rmino "aprobaci√≥n"</i> <br><br><h2>  Primero negocios, luego desarrollo </h2><br>  <b>Sol√≠a</b> haber casos en los que comenzamos a trabajar con un socio potencial con una especificaci√≥n.  Nuestro gerente recibi√≥ la especificaci√≥n, la estudi√≥ cuidadosamente, aclar√≥ con los detalles del socio para la integraci√≥n, discuti√≥ los problemas en disputa con los desarrolladores.  Y luego lleg√≥ un mensaje del liderazgo: "Fin, la integraci√≥n se cancela, no est√°bamos de acuerdo con las condiciones".  Los empleados perdieron el tiempo. <br><br><img src="https://habrastorage.org/webt/1p/at/bg/1patbgwgpcliihybxvmuvj1-uo0.png" width="800"><br>  <i>Cuando cambias de opini√≥n y el trabajo est√° hecho</i> <br><br>  <b>Ahora</b> la regla de hierro <b>est√°</b> vigente: el gerente comienza a estudiar la especificaci√≥n solo cuando recibe una decisi√≥n clara sobre la integraci√≥n de la administraci√≥n. <br><br><h2>  Disponibilidad para la integraci√≥n: URL, detalles, entorno </h2><br>  <b>Anteriormente, la</b> primera llamada a la API del socio ocurri√≥ durante la prueba de nuestra aplicaci√≥n, desde servidores de desarrollo.  A menudo, las primeras solicitudes reciben errores en la etapa de configuraci√≥n de la conexi√≥n: no se puede conectar al servidor o simplemente se agota el tiempo de espera.  Razones m√°s populares: <br><br><ul><li>  Nombres de m√©todos incorrectos (sellados o confusos) </li><li>  Dominio inv√°lido </li><li>  detalles de conexi√≥n err√≥neos, </li><li>  No agregamos la IP de nuestros servidores a la lista blanca. </li></ul><br>  Se necesitaron horas para solucionar estos errores menores, porque se sucedieron uno tras otro: hasta que solucione uno, no ver√° el siguiente. <br><br>  <b>Ahora</b> , antes de llevar la tarea al plan de desarrollo, aclaramos todas las caracter√≠sticas de acceso a la API con una peque√±a lista de verificaci√≥n.  La lista de verificaci√≥n enumera los puntos que deben aclararse, por ejemplo: <br><br><ul><li>  restricciones en la carga del servicio, </li><li>  el n√∫mero de solicitudes por unidad de tiempo </li><li>  detalles de conexi√≥n </li><li>  lista blanca por direcciones ip, </li><li>  Validaci√≥n de certificado SSL </li><li>  requisitos de encriptaci√≥n del tr√°fico, </li><li>  encabezados especiales en solicitudes </li><li>  la presencia de un servidor de prueba con API o la capacidad de enviar solicitudes de prueba al servidor de combate </li></ul><br>  Si hay una API de prueba, definitivamente descubriremos cu√°l es la diferencia al acceder al servidor de batalla y al servidor de prueba.  Tenemos en cuenta las diferencias al crear solicitudes de nuestra aplicaci√≥n a socios en entornos de desarrollo y producci√≥n.  Dichas medidas nos ayudan a comprender si los sistemas est√°n listos para nuestras necesidades o si se necesitan ajustes adicionales. <br><br><img src="https://habrastorage.org/webt/bw/jz/f1/bwjzf19losfdd62xwajd3ww6ris.png" width="800"><br><br><h2>  Env√≠o manual de solicitudes a la API </h2><br>  <b>Antes,</b> escribimos de inmediato el c√≥digo de acuerdo con las especificaciones del socio, elaboramos las especificaciones, revisamos, probamos.  Y en la etapa de las pruebas de integraci√≥n, result√≥ que no todo lo escrito en la especificaci√≥n corresponde a la realidad, comenzando desde el formato de las solicitudes, terminando con el proceso de pasar la aplicaci√≥n. <br><br>  Por ejemplo, de acuerdo con la especificaci√≥n, al acceder a un determinado m√©todo, esperamos una respuesta en un cierto formato en la respuesta, colgamos el procesamiento para la validez de la respuesta recibida, vamos a las pruebas y de repente obtenemos una matriz en la respuesta.  Descubrimos los motivos de los desarrolladores del socio.  Se refieren a documentaci√≥n obsoleta.  Una vez m√°s, un c√≠rculo de mejoras, revisiones y pruebas. <br><br>  <b>Ahora</b> , tan pronto como recibimos la documentaci√≥n y los detalles de la conexi√≥n, ejecutamos el proceso a trav√©s del cliente API.  Por lo general, el probador carga la especificaci√≥n a Postman y simula el proceso comercial completo de enviar una solicitud de pr√©stamo, verifica los casos m√°s populares con diferentes conjuntos de datos para la solicitud.  Es decir, hace manualmente lo que har√° la aplicaci√≥n. <br><br>  En la etapa de una ejecuci√≥n manual, se revela el 80% de las imprecisiones en la documentaci√≥n.  Describimos los errores y pasamos al socio.  El socio elimina las imprecisiones en el hogar o finaliza la especificaci√≥n.  Como resultado, para cuando comienza el trabajo en el c√≥digo, los desarrolladores reciben documentaci√≥n de trabajo. <br><br>  Discrepancias m√°s populares: <br><br><ul><li>  formato de solicitud incorrecto, promete aceptar json, result√≥ que necesitaba datos de formulario; </li><li>  Errores en los nombres de los campos que se transmitir√°n en la solicitud; </li><li>  errores en formatos de campo; </li><li>  las reglas de validaci√≥n de campo no se especifican o se indican incorrectamente; </li><li>  algunos campos pueden olvidarse por completo; </li><li>  falta o es diferente de la descripci√≥n real del formato de respuesta del m√©todo; </li><li>  marcas err√≥neas sobre los campos obligatorios: pueden aparecer "asteriscos" donde el campo no es obligatorio, y viceversa; </li><li>  a menudo no se documentan todos los estados y estados en los que puede estar el objeto; </li><li>  discrepancias entre los estados esperados y recibidos de los objetos.  Por ejemplo, en alg√∫n momento, esperamos que la aplicaci√≥n est√© en estado X y, de hecho, seg√∫n la API, obtenemos Y. </li></ul><br><h2>  Receta para la felicidad: evitar errores de integraci√≥n de API </h2><br>  Escriba una especificaci√≥n para la integraci√≥n con su servicio.  Pasamos dos d√≠as desarrollando la especificaci√≥n en YAML, pero ahora estamos ahorrando decenas de horas en mejoras y aprobaciones. <br><br>  Si el socio env√≠a su especificaci√≥n, verif√≠quela en la lista de verificaci√≥n.  En la lista de verificaci√≥n, recopile preguntas a las que debe recibir respuestas.  No conf√≠es en la experiencia y la memoria, a√∫n te falta algo. <br><br>  Tenga un glosario de t√©rminos para evitar confusiones con su pareja.  Nuestra experiencia ha demostrado que las diferencias pueden ser incluso obvias. <br><br>  No lleve la tarea al desarrollo hasta que reciba la aprobaci√≥n de principios de la gesti√≥n de integraci√≥n con un socio.  La idea es obvia, pero nos ayuda a evitar el trabajo innecesario. <br><br>  Abra una lista de verificaci√≥n para aclarar los detalles espec√≠ficos de acceso a la API del socio: detalles de conexi√≥n, lista blanca, validaci√≥n de certificados SSL, requisitos de cifrado de tr√°fico, etc. Verifique la lista de verificaci√≥n lo antes posible para evitar el deslizamiento en las etapas finales. <br><br>  Obtuve una especificaci√≥n: no se apresure a escribir c√≥digo de inmediato.  Primero, ejecute manualmente el proceso a trav√©s de un cliente API, por ejemplo, a trav√©s de Postman.  Por lo tanto, encontrar√° errores en la especificaci√≥n en una etapa temprana y con peque√±os recursos.  Y lo ser√°n. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/441152/">https://habr.com/ru/post/441152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441140/index.html">Desarrollo de WebAssembly: rastrillo real y ejemplos</a></li>
<li><a href="../441142/index.html">12 puntos de crecimiento de conversi√≥n o contenido que realmente vende</a></li>
<li><a href="../441146/index.html">Redes inal√°mbricas industriales: ¬øcu√°l elegir?</a></li>
<li><a href="../441148/index.html">C√≥mo manejar los errores correctamente: el silencio no siempre es bueno</a></li>
<li><a href="../441150/index.html">Primera introducci√≥n al protocolo HTTP escribiendo el servidor web Java m√°s simple</a></li>
<li><a href="../441154/index.html">Once perlas ocultas de Java 11</a></li>
<li><a href="../441158/index.html">C√≥mo la √©tica se convirti√≥ en el problema m√°s costoso de Silicon Valley, y la filosof√≠a se convirti√≥ en su soluci√≥n m√°s pr√°ctica</a></li>
<li><a href="../441160/index.html">C√≥mo aprender a determinar cu√°ndo decir no</a></li>
<li><a href="../441166/index.html">Obtenemos la contrase√±a maestra del administrador de contrase√±as bloqueadas 1 Contrase√±a 4</a></li>
<li><a href="../441168/index.html">Canales de datos QUIC: primeros pasos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>