<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â™£ï¸ â¸ï¸ ğŸŠ Friday JS: quine yang memainkan tic-tac-toe ğŸ¡ ğŸ™…ğŸ½ ğŸ‘‡ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya menyapa semua orang di bagian tradisional saya yang penuh dengan kegilaan Lovecraftian. 

 Dalam proses penulisan salah satu artikel sebelumnya (...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Friday JS: quine yang memainkan tic-tac-toe</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435732/"> Saya menyapa semua orang di bagian tradisional saya yang penuh dengan kegilaan Lovecraftian. <br><br>  Dalam proses penulisan salah satu artikel sebelumnya (jangan lihat, itu tidak terlalu baik), saya memikirkan fakta bahwa quine ... Ya, untuk berjaga-jaga, saya ingatkan Anda: quine adalah program yang menampilkan teksnya sendiri, dan melakukannya "dengan jujur" ( tanpa melihat, misalnya, teks ini di file di hard drive Anda).  Secara umum, puzomerka berarti tradisional programmer. <br><br>  Jadi, saya memikirkan fakta bahwa quine, pada prinsipnya, dapat membawa muatan sewenang-wenang.  Yaitu, melakukan hal lain selain fungsi utamanya.  Dan sebagai pembuktian konsep, saya memutuskan untuk menulis quine yang memainkan tic-tac-toe.  Dan menulis.  Detail kotor di bawah potongan. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/310/2e0/e41/3102e0e41c87371ea771188ab03d4c13.jpg" alt="gambar"><br><a name="habracut"></a><br>  "Tapi bagaimana dia bisa melakukan hal lain selain menampilkan teksnya?"  - mungkin Anda bertanya.  Dan mudah.  Selain output, program ini juga memiliki input.  Jika program menampilkan teksnya tanpa input - maka itu quine.  Jika program melakukan hal lain ketika input tersedia, siapakah kita untuk mengutuknya? <br><br>  Mungkin saya akan segera mengeluarkan kartu di atas meja.  <a href="">Berikut ini tautan ke kreasi saya.</a>  Ada tiga entitas dalam file dengan referensi: <br><br><ol><li>  Fungsi quine adalah apa yang saya bicarakan. </li><li>  Fungsi evalAndCall adalah pembantu. </li><li>  Kelas permainan - bahkan lebih banyak pembantu </li></ol><br>  Pertama, kita akan berbicara tentang cara bekerja dengan fungsi quine, dan kemudian cara kerjanya. <br><br><h3>  Bagaimana cara bekerja dengannya </h3><br>  Di awal fungsi quine, Anda dapat melihat yang berikut: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/* |1|2|3| |4|x|6| |7|8|9| !  - ,     -. ,   .     ,    ,     .             ,    . :   - 0   - 0  - 0 */</span></span></code> </pre> <br>  Komentar di bagian paling awal dari fungsi adalah antarmuka pengguna.  Melalui itu, fungsi akan berkomunikasi dengan mereka yang menggunakannya untuk permainan.  Pada awalnya, saya berpikir untuk melakukannya melalui konsol, tetapi kemudian saya memutuskan bahwa akan lebih benar untuk menjaga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fungsinya</a> tetap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bersih</a> . <br><br>  Mari kita periksa apakah fungsinya benar-benar quine.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Di sini,</a> untuk kenyamanan, saya memposting (hampir) halaman HTML kosong dengan skrip quine.js terlampir.  Membuka alat pengembang, Anda dapat mengarahkan kode berikut secara non-selektif di sana: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> quineText = quine(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> evaluatedQuine = <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"("</span></span> + quineText + <span class="hljs-string"><span class="hljs-string">")"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ,     eval       //  undefined,   const evaluatedQuineText = evaluatedQuine(); quineText == evaluatedQuineText; // true</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Bore mod</b> <div class="spoiler_text">  Sebenarnya, tentu saja, kami hanya memeriksa bahwa fungsi quine mengembalikan teks quine, dan bukan bahwa itu sendiri adalah quine.  Dan lebih tepatnya - kami hanya memeriksa bahwa fungsi quine mengembalikan teks fungsi, yang dalam kasus kami berfungsi seperti quine.  Tidak ada jaminan bahwa di dalam tidak mengandung sesuatu seperti: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() &lt; <span class="hljs-number"><span class="hljs-number">0.99</span></span>){ beAGoodQuine(); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ haltAndCatchFire(); }</code> </pre><br></div></div><br>  Sekarang kita bisa mencoba bermain dengannya.  Katakanlah kita melakukan langkah pertama ke sudut kiri atas bidang. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quineText = quine(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br>  Sekarang "antarmuka pengguna" adalah sebagai berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/* |o|x|3| |4|x|6| |7|8|9| !  - ,     -. ,   .     ,    ,     .             ,    . :   - 0   - 0  - 0 */</span></span></code> </pre><br>  Quine memperhitungkan langkah kami dan membuat respons di bidang tengah atas.  By the way, fungsi yang dihasilkan juga disebut quine - tanpa argumen, itu akan mengembalikan teks barunya, dan bukan teks dari fungsi aslinya.  Kita dapat memainkan seluruh permainan, tetapi untuk kenyamanan kita akan menggunakan fungsi tambahan evalAndCall. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quineText = quine(); <span class="hljs-comment"><span class="hljs-comment">//         ,    . /* |1|2|3| |4|x|6| |7|8|9| */ quineText = evalAndCall(quineText, 1) /* |x|o|3| |4|x|6| |7|8|9| */ quineText = evalAndCall(quineText, 3) /* |x|o|o| |4|x|6| |7|8|x|     .    ,   0    */ quineText = evalAndCall(quineText, 0) /* |1|2|3| |4|x|6| |7|8|9| :   - 0   - 1  - 0 */</span></span></code> </pre><br>  Voila!  Quine memainkan, menang, dan bahkan skor.  Anda bisa bermain dengannya lebih lama, tetapi untuk kenyamanan yang lebih besar, saya sarankan menggunakan kelas Game, yang dengannya saya menguji sendiri game tersebut.  Saya pikir jika Anda membaca sampai titik ini, saya tidak perlu menjelaskan bagaimana cara menggunakannya. <br><br><h3>  Bagaimana cara kerjanya </h3><br>  Secara umum, tugas itu terdiri dari dua bagian: menulis, jika mungkin, fungsi singkat dari permainan tic-tac-toe, kemudian mendorongnya ke dalam quine.  Mari kita mulai dengan tic-tac-toe. <br><br>  Inti dari "kecerdasan buatan" ada pada garis 66-90 dan siluetnya menyerupai tupai yang keras kepala: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rules = { <span class="hljs-string"><span class="hljs-string">"o___x____"</span></span>: <span class="hljs-string"><span class="hljs-string">"ox__x__!_"</span></span>, <span class="hljs-string"><span class="hljs-string">"ox__x__o_"</span></span>: <span class="hljs-string"><span class="hljs-string">"ox!_x_xo_"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxo_x_xo_"</span></span>: <span class="hljs-string"><span class="hljs-string">"oxo!xxxo_"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxooxxxo_"</span></span>: <span class="hljs-string"><span class="hljs-string">"oxooxxxoxd"</span></span>, <span class="hljs-string"><span class="hljs-string">"_o__x____"</span></span>: <span class="hljs-string"><span class="hljs-string">"xo__x___!"</span></span>, <span class="hljs-string"><span class="hljs-string">"xo__x___o"</span></span>: <span class="hljs-string"><span class="hljs-string">"xo_xx!!_o"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> next = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">field, move</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!~<span class="hljs-string"><span class="hljs-string">"!_"</span></span>.indexOf(field[--move])){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } field[move] = <span class="hljs-string"><span class="hljs-string">"o"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> win = field.indexOf(<span class="hljs-string"><span class="hljs-string">"!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(~win){ field[win] = <span class="hljs-string"><span class="hljs-string">"x"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [...field, <span class="hljs-string"><span class="hljs-string">"w"</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; n++){ field = field.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, i</span></span></span><span class="hljs-function">) =&gt;</span></span> field[[<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>][i]]); rules[field.join(<span class="hljs-string"><span class="hljs-string">""</span></span>)] &amp;&amp; (field = rules[field.join(<span class="hljs-string"><span class="hljs-string">""</span></span>)].split(<span class="hljs-string"><span class="hljs-string">""</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> field; }</code> </pre> <br>  Kode ini terlihat agak dikaburkan karena saya tertarik membuatnya sesingkat mungkin.  Esensinya adalah sebagai berikut: keadaan lapangan - array sembilan elemen - dan jumlah sel tempat pemain-orang bergerak (selanjutnya memeriksa validitas gerakan ini), memasuki fungsi berikutnya.  Setiap elemen bidang dapat berupa salib, nol, garis bawah (sel kosong) atau tanda seru (sel kosong untuk meletakkan tanda silang pada kesempatan pertama).  Jika ada tanda seru di lapangan, kami segera bergerak di sana dan menang.  Jika tidak, kami merekatkan array menjadi string dan mencari aturan terkait di objek aturan.  Untuk menghemat ruang, aturannya akurat untuk rotasi, oleh karena itu, untuk mencari, bidang tersebut diputar empat kali.  Ketika aturan yang diinginkan ditemukan, keadaan bidang digantikan oleh nilai aturan, dipecah menjadi karakter.  Selanjutnya, fungsi berikutnya mengembalikan keadaan baru bidang tersebut.  Pada saat yang sama, karakter kesepuluh tambahan dapat bergabung: "w" - jika AI menang, "d" - jika ada hasil seri. <br><br>  Berkat tanda seru, "petunjuk" dan rotasi lapangan, dan juga, tentu saja, karena fakta bahwa AI bergerak terlebih dahulu, strategi optimal dijelaskan hanya dalam 6 aturan. <br><br>  Menggunakan fungsi berikutnya, fungsi quine memproses input dan menulis beberapa bidang ke objek magicHash.  Dan di sini kita dengan lancar beralih ke bagian kedua: bagaimana komponen "quayne" bekerja.  Semua sihir ada di objek magicHash dan properti magicString. <br><br>  Baris magicString, seperti yang dapat Anda lihat dengan mudah, berisi teks program yang hampir sepenuhnya digandakan.  Namun, seperti yang diketahui oleh semua orang yang pernah mencoba menulis quine, Anda tidak dapat memasukkan teks yang sepenuhnya lengkap ke dalamnya - karena dengan demikian teks tersebut harus benar-benar berisi dirinya sendiri, yang tidak mungkin untuk string dengan panjang terbatas.  Oleh karena itu, selain teks "biasa", teks ini juga berisi urutan wildcard "ajaib" yang dibatasi di kedua sisi oleh karakter "$". <br><br>  Ketika saatnya tiba X dan kita harus mengembalikan teks fungsi, kita hanya mengambil magicString dan mengganti urutan wildcard di dalamnya dengan properti yang sesuai dari objek magicHash.  Properti ini bisa statis (backtick), berubah saat runtime (bidang) atau bahkan ditambahkan saat runtime (pesan) - itu tidak masalah.  Adalah penting bahwa untuk setiap bagian kode yang "bermasalah" yang tidak dapat hanya diduplikasi dalam satu baris, kita memiliki properti "ajaib" dari objek magicHash.  Yang terakhir menggantikan magicString sendiri.  Yang terakhir - karena kalau tidak akan ada urutan wildcard tambahan yang juga akan diganti. <br><br><h3>  Ringkasan </h3><br>  Saya memeriksa dari pengalaman saya sendiri bahwa Anda dapat memasukkan apa saja ke dalam quine.  Pada prinsipnya, jika Anda repot-repot, Anda dapat membuat generator quine - fungsi yang mengubah fungsi murni lainnya menjadi quine dan memungkinkan Anda untuk menyimpan keadaan sewenang-wenang yang dapat diakses oleh fungsi murni di atas.  Namun, margin naskah ini terlalu sempit ... <br><br>  Secara umum, saya tidak berpura-pura dengan kebaruan khusus dari "penemuan" saya.  Para fungsionaris hardcore pasti telah membaca teks ini dengan senyum keunggulan.  Tetapi menarik bagi saya untuk mengambilnya dengan tangan saya sendiri, untuk menempatkan, dengan kata lain, jari ke luka.  Dan saya harap Anda tertarik membacanya. <br><br>  Selamat tinggal, cewek dan cowok.  Sampai jumpa lagi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id435732/">https://habr.com/ru/post/id435732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id435720/index.html">Pengembangan Adblock Radio</a></li>
<li><a href="../id435722/index.html">NB-IoT, Internet Sempit Band of Things. Mode Hemat Daya dan Perintah Kontrol</a></li>
<li><a href="../id435724/index.html">Menahan sifat buruk imperatif</a></li>
<li><a href="../id435728/index.html">[Jumat] Kisah bagaimana penjualan IT mencoba menjual kayu bakar, atau di belakang panggung satu tender</a></li>
<li><a href="../id435730/index.html">Kulitnya pecah</a></li>
<li><a href="../id435734/index.html">Bagaimana tidak tertipu dengan melakukan fisika</a></li>
<li><a href="../id435738/index.html">Teknik proyek DIY. Bagian satu</a></li>
<li><a href="../id435740/index.html">Pendaftaran dibuka di GraphQL Meetup di St. Petersburg</a></li>
<li><a href="../id435742/index.html">Manajemen Sumber Daya di Zimbra Collaboration Suite</a></li>
<li><a href="../id435744/index.html">Fintech digest: Bank Rusia akan dapat memblokir situs, volume pinjaman P2P turun, crypto di Eropa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>