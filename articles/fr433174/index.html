<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸ³ ğŸ•¡ ğŸ§ Tous les correctifs ne sont pas Ã©galement utiles. ğŸ‘©ğŸ½â€ğŸ’¼ ğŸ§—ğŸ¼ ğŸ›€ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article poursuit la discussion sur les amÃ©liorations de performances qui pourraient se rÃ©aliser sans les diffÃ©rents mais. La partie prÃ©cÃ©dente sur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tous les correctifs ne sont pas Ã©galement utiles.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433174/"><p> Cet article poursuit la discussion sur les amÃ©liorations de performances qui pourraient se rÃ©aliser sans les diffÃ©rents mais.  La partie prÃ©cÃ©dente sur <code>StringBuilder</code> est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  Nous examinons ici quelques Â«amÃ©liorationsÂ» rejetÃ©es en raison d'un manque de comprÃ©hension des subtilitÃ©s de la spÃ©cification du langage, des cas d'angle non Ã©vidents et d'autres raisons.  C'est parti! </p><a name="habracut"></a><br><h4 id="kogda-nichto-ne-predveschaet-bedy">  Quand rien n'annonce des ennuis </h4><br><p>  Je pense que chacun de nous a travaillÃ© avec les mÃ©thodes <code>Collections.emptySet()</code> / <code>Collections.emptyList()</code> .  Ce sont des mÃ©thodes trÃ¨s utiles qui vous permettent de renvoyer une collection immuable vide sans crÃ©er de nouvel objet.  En regardant Ã  l'intÃ©rieur de la classe <code>EmptyList</code> nous allons voir ceci: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmptyList</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">E</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Iterator&lt;E&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> emptyIterator(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Object[] toArray() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } }</code> </pre> <br><p>  Vous voyez un fort potentiel d'amÃ©lioration?  La mÃ©thode <code>EmptyList.iterator()</code> renvoie un itÃ©rateur vide de la prÃ©sence, pourquoi ne pas faire la mÃªme feinte avec vos oreilles pour le tableau retournÃ© par la mÃ©thode <code>toArray()</code> ? </p><br><div class="spoiler">  <b class="spoiler_title">Il y en a un, mais c'est la documentation</b> <div class="spoiler_text"><blockquote>  Le tableau retournÃ© sera "sÃ»r" dans la mesure oÃ¹ aucune rÃ©fÃ©rence ne sera conservÃ©e dans cette liste.  (En d'autres termes, cette mÃ©thode doit allouer un nouveau tableau mÃªme si cette liste est sauvegardÃ©e par un tableau).  L'appelant est ainsi libre de modifier le tableau retournÃ©. </blockquote><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">http://mail.openjdk.java.net/pipermail/core-libs-dev/2017-September/049170.html</a> <br>  <a href="" rel="nofollow">http://hg.openjdk.java.net/jdk/jdk12/file/ffac5eabbf28/src/java.base/share/classes/java/util/List.java#l185</a> </p></div></div><br><p>  En d'autres termes, la mÃ©thode doit toujours renvoyer un <strong>nouveau</strong> tableau. </p><br><p>  Vous direz: "Il est immuable! Qu'est-ce qui peut mal tourner!?" </p><br><p>  Seuls des experts expÃ©rimentÃ©s peuvent rÃ©pondre Ã  cette question: </p><br><blockquote>  - Qui est responsable? <br>  - Experts responsables Paul Sandoz et Tagir Valeev </blockquote><br><div class="spoiler">  <b class="spoiler_title">La rÃ©ponse des experts</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">http://mail.openjdk.java.net/pipermail/core-libs-dev/2017-September/049171.html</a> </p><br><blockquote>  Notez Ã©galement que cela modifie le comportement visible.  E. g.  quelqu'un peut se synchroniser sur l'objet tableau renvoyÃ© par l'appel toArray, donc cette modification peut provoquer un <strong>partage de verrou</strong> indÃ©sirable. <br><br>  Une fois, j'ai suggÃ©rÃ© une amÃ©lioration similaire: renvoyer EMPTY_LIST de Arrays.asList () lorsque le tableau fourni a une longueur nulle.  Il a Ã©tÃ© refusÃ© pour la mÃªme raison [1]. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">http://mail.openjdk.java.net/pipermail/core-libs-dev/2015-September/035197.html</a> <br><br>  Au fait, il est probablement raisonnable pour Arrays.asList de vÃ©rifier la longueur du tableau comme: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">List&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">asList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T... a)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(a.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Collections.emptyList(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(a); }</code> </pre> <br><br>  Cela semble raisonnable, non?  Pourquoi crÃ©er une nouvelle liste pour un tableau vide si vous pouvez en prendre un tout prÃªt gratuitement? <br>  Il y a une raison de ne pas le faire.  Pour le moment, Arrays.asList ne spÃ©cifie aucune contrainte sur l'identitÃ© de la liste renvoyÃ©e.  L'ajout de la micro-optimisation changera cela.  C'est un cas de bord et un cas d'utilisation douteux aussi, mais Ã©tant donnÃ© que je laisserais les choses telles quelles. </blockquote></div></div><br><p>  Cette dÃ©claration va probablement vous dÃ©router: </p><br><blockquote>  E. g.  quelqu'un peut se synchroniser sur l'objet tableau renvoyÃ© par l'appel toArray, donc cette modification peut provoquer un partage de verrou indÃ©sirable. </blockquote><p>  Vous direz: "Qui dans leur bon sens sera synchronisÃ© sur la baie (!) RenvoyÃ© (!!!) de la collection!?" </p><br><p>  Cela ne semble pas trÃ¨s crÃ©dible, mais le langage offre une telle opportunitÃ©, ce qui signifie qu'il est possible qu'un certain utilisateur le fasse (ou l'ait dÃ©jÃ  fait).  Ensuite, le changement proposÃ© modifiera au mieux le comportement du code, et au pire, il entraÃ®nera une panne de synchronisation (allez plus tard, rattrapez-le).  Le risque est tellement injustifiÃ© et le gain escomptÃ© est si insignifiant qu'il vaut mieux tout laisser tel quel. </p><br><p>  En gÃ©nÃ©ral, la possibilitÃ© de synchroniser sur n'importe quel objet, kmk, Ã©tait l'erreur des dÃ©veloppeurs de langage.  PremiÃ¨rement, l'en-tÃªte de chaque objet contient une structure responsable de la synchronisation, et deuxiÃ¨mement, nous nous trouvons dans la situation dÃ©crite ci-dessus lorsqu'un objet apparemment immuable ne peut pas Ãªtre retournÃ© plusieurs fois, car il peut Ãªtre synchronisÃ© sur lui. </p><br><p>  La morale de cette fable est la suivante: la spÃ©cification et la compatibilitÃ© descendante sont des vaches sacrÃ©es de Java.  N'essayez mÃªme pas de les empiÃ©ter: le gardien tire sans prÃ©venir. </p><br><h4 id="staraeshsya-staraeshsya">  Essayer, essayer ... </h4><br><p>  Il existe plusieurs classes basÃ©es sur des tableaux dans le JDK Ã  la fois, et toutes implÃ©mentent les mÃ©thodes <code>List.indexOf()</code> et <code>List.lastIndexOf()</code> : </p><br><ul><li>  java.util.ArrayList </li><li>  java.util.Arrays $ ArrayList </li><li>  java.util.Vector </li><li>  java.util.concurrent.CopyOnWriteArrayList </li></ul><br><p>  Le code de ces mÃ©thodes dans ces classes est rÃ©pÃ©tÃ© presque un Ã  un.  De nombreuses applications et frameworks proposent Ã©galement leurs solutions pour le mÃªme problÃ¨me: </p><br><ul><li>  <a href="" rel="nofollow">org.hibernate.bytecode.enhance.internal.tracker.SimpleFieldTracker</a> </li><li>  <a href="" rel="nofollow">com.intellij.util.ArrayUtil</a> </li><li>  <a href="" rel="nofollow">com.intellij.util.ArrayUtilRt</a> </li><li>  <a href="" rel="nofollow">org.springframework.oxm.jibx.JibxMarshaller</a> </li></ul><br><p>  En consÃ©quence, nous avons du code erronÃ© qui doit Ãªtre compilÃ© (parfois parfois plusieurs fois), qui a lieu dans ReserverCodeCache, qui doit Ãªtre testÃ©, et qui se promÃ¨ne simplement de classe en classe avec presque aucun changement. </p><br><p>  Les dÃ©veloppeurs, Ã  leur tour, aiment beaucoup Ã©crire quelque chose comme </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = Arrays.asList(array).indexOf(obj); <span class="hljs-comment"><span class="hljs-comment">//  boolean contains = Arrays.asList(array).contains(obj); //    boolean contains = Arrays.stream(names).anyMatch(nm -&gt; nm.equals(name));</span></span></code> </pre> <br><p>  Je voudrais introduire des mÃ©thodes utilitaires gÃ©nÃ©ralisÃ©es dans le JDK et les utiliser partout, comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">suggÃ©rÃ©</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Le patch est</a> aussi simple que deux sous: </p><br><p>  1) les implÃ©mentations de <code>List.indexOf()</code> et <code>List.lastIndexOf()</code> dÃ©placent vers <code>java.util.Arrays</code> <br>  2) Ã  la place, <code>Arrays.indexOf()</code> et <code>Arrays.lastIndexOf()</code> sont appelÃ©s, respectivement </p><br><p>  Il semblerait que ce qui pourrait mal tourner?  Le gain de cette approche est [apparemment] Ã©vident.  Mais l'article concerne les Ã©checs, alors pensez Ã  ce qui pourrait mal tourner. </p><br><blockquote>  - Qui est responsable? <br>  - Experts responsables Martin Buchholz et Paul Sandoz </blockquote><br><div class="spoiler">  <b class="spoiler_title">Ã€ mon humble avis, un peu tendu, mais nÃ©anmoins</b> <div class="spoiler_text"><p>  Martin Buchholz: </p><br><blockquote>  Sergey, je suis en quelque sorte en train de maintenir toutes ces classes de collection, et j'ai parfois voulu Ã©galement avoir des mÃ©thodes indexOf dans Array.java.  Mais: <br><br>  Les tableaux sont gÃ©nÃ©ralement dÃ©conseillÃ©s.  Toutes les nouvelles mÃ©thodes statiques sur les tableaux (ou, lÃ  oÃ¹ je le souhaite, sur l'objet tableau lui-mÃªme! NÃ©cessite un changement de langage java!) Rencontreront une rÃ©sistance. <br><br>  Nous en sommes venus Ã  regretter de prendre en charge les valeurs null dans les collections, donc les classes de collection plus rÃ©centes comme ArrayDeque ne les prennent pas en charge. <br><br>  Une autre variante que les utilisateurs pourraient souhaiter est le type de comparaison d'Ã©galitÃ© Ã  utiliser. <br><br>  Nous en sommes venus Ã  regretter d'avoir ArrayList avec un index de dÃ©part basÃ© sur zÃ©ro - il aurait Ã©tÃ© prÃ©fÃ©rable d'avoir le comportement de tableau circulaire d'ArrayDeque dÃ¨s le premier jour. <br><br>  Le code de recherche des tranches de tableau est trÃ¨s petit, vous n'Ã©conomisez donc pas beaucoup.  Il est facile de faire une erreur au coup par coup, mais cela est Ã©galement vrai pour une API de tableaux. </blockquote><p>  Paul Sandoz: </p><br><blockquote>  Je n'irais pas jusqu'Ã  dire que les tableaux sont dÃ©couragÃ©s, je le tournerais positivement comme "Ã  utiliser avec soin" car ils sont Ã©pineux, par exemple toujours modifiables. Ils pourraient certainement Ãªtre amÃ©liorÃ©s. Je serais trÃ¨s heureux de voir des tableaux implÃ©menter un tableau commun 'interface ish, nous pourrions Ãªtre en mesure de faire des progrÃ¨s aprÃ¨s les types de valeur sÃ©diment. <br><br>  Tout nouvel ajout Ã  Arrays se heurterait Ã  une certaine rÃ©sistance, du moins pour moi :-) Il n'ajoute jamais qu'une ou deux mÃ©thodes, beaucoup d'autres veulent Ã©galement venir pour le trajet (toutes les primitives plus les variantes de gamme).  Donc, toute nouvelle fonctionnalitÃ© doit Ãªtre suffisamment bÃ©nÃ©fique et dans ce cas, je ne pense pas que les avantages soient suffisamment forts (comme une Ã©ventuelle pression de cache du code de rÃ©duction). </blockquote><p>  Paul. </p></div></div><br><p>  Correspondance: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">http://mail.openjdk.java.net/pipermail/core-libs-dev/2018-March/051968.html</a> </p><br><p>  La morale de cette fable est la suivante: votre ingÃ©nieux patch peut Ãªtre abattu pour examen simplement parce qu'il n'y verra aucune valeur particuliÃ¨re.  Eh bien, oui, il y a du code en double, mais cela ne dÃ©range personne, alors laissez-le vivre. </p><br><h4 id="uluchsheniya-dlya-arraylist-a-ih-est-u-menya">  Des amÃ©liorations pour ArrayList?  Je les ai </h4><br><p><del>  Cyclomoteur </del>  le patch n'est pas le mien, je vais le poster pour que vous y rÃ©flÃ©chissiez.  La proposition elle-mÃªme a Ã©tÃ© exprimÃ©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici</a> et elle semble trÃ¨s attrayante.  Voyez par vous-mÃªme: </p><br><div class="spoiler">  <b class="spoiler_title">Changement proposÃ©</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Lien</a> </p></div></div><br><p>  A l'oeil nu, la proposition est trÃ¨s, trÃ¨s logique.  Vous pouvez mesurer les performances Ã  l'aide d'un simple <a href="" rel="nofollow">benchmark</a> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayListBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Benchmark) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Data</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Param</span></span>({<span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-string"><span class="hljs-string">"10000"</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; ArrayList&lt;Integer&gt; arrayRandom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;Integer&gt;(size); <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span>(Level.Invocation) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initArrayList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); rand.setSeed(System.currentTimeMillis()); <span class="hljs-comment"><span class="hljs-comment">// Populate the ArrayList with size-5 elements for (int i = 0; i &lt; size - 5; i++) { Integer r = rand.nextInt() % 256; arrayRandom.add(r); } } } @Benchmark public ArrayList construct_new_array_list(Data d) { ArrayList al = new ArrayList(d.arrayRandom); // once a new ArrayList is created add a new element al.add(new Integer(900)); return al; } }</span></span></code> </pre> <br><p>  RÃ©sumÃ©: </p><br><pre> <code class="plaintext hljs">Benchmark (size) Mode Cnt Score Error Units  construct_new_array_list 10 thrpt 25 388.212 Â± 23.110 ops/s construct_new_array_list 100 thrpt 25 90.208 Â± 7.995 ops/s construct_new_array_list 1000 thrpt 25 23.289 Â± 1.687 ops/s construct_new_array_list 10000 thrpt 25 7.659 Â± 0.560 ops/s  construct_new_array_list 10 thrpt 25 562.678 Â± 37.370 ops/s construct_new_array_list 100 thrpt 25 119.791 Â± 13.232 ops/s construct_new_array_list 1000 thrpt 25 33.811 Â± 3.812 ops/s construct_new_array_list 10000 thrpt 25 10.889 Â± 0.564 ops/s</code> </pre> <br><p>  Pas mal du tout pour un changement aussi simple.  L'essentiel est qu'il ne semble pas y avoir de prise.  CrÃ©ez honnÃªtement un tableau, copiez honnÃªtement les donnÃ©es et n'oubliez pas la taille.  Maintenant, ils doivent dÃ©finitivement accepter le patch! </p><br><div class="spoiler">  <b class="spoiler_title">Mais c'Ã©tait lÃ </b> <div class="spoiler_text"><p>  Martin Buchholz: </p><br><blockquote>  Il ne fait aucun doute que nous pouvons optimiser le cas d'ArrayList -&gt; ArrayList, mais qu'en est-il de toutes les autres implÃ©mentations de Collection?  ArrayDeque et CopyOnWriteArrayList me viennent Ã  l'esprit. <br>  ArrayList est une classe populaire Ã  utiliser pour faire des copies de collections.  OÃ¹ vous arrÃªtez-vous? <br><br>  Une sous-classe pathologique d'ArrayList pourrait dÃ©cider de ne pas stocker d'Ã©lÃ©ments dans le tableau de support, avec une rupture qui s'ensuit. <br><br>  La solution bÃ©nie au problÃ¨me de copie de liste est probablement List.copyOf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html#copyOf(java .util.Collection</a> ) qui pourrait faire l'optimisation que vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">espÃ©rez</a> . </blockquote><p>  Alan Bateman </p><br><blockquote>  ArrayList n'est pas final, il est donc possible que quelqu'un l'ait Ã©tendu pour utiliser autre chose que elementData.  Il pourrait Ãªtre plus sÃ»r d'utiliser l'identitÃ© de classe plutÃ´t que instanceof. </blockquote></div></div><br><p>  Rien ne m'interdit de me dissocier d' <code>ArrayList</code> et de stocker des donnÃ©es dans une liste chaÃ®nÃ©e.  Ensuite, <code>c instanceof ArrayList</code> retournera la vÃ©ritÃ©, nous arriverons dans la zone de copie et tomberons en toute sÃ©curitÃ©. </p><br><p>  La morale de cette fable est la suivante: un <em>Ã©ventuel</em> changement de comportement peut Ãªtre la cause de l'Ã©chec.  En d'autres termes, il faut garder Ã  l'esprit la probabilitÃ© d'un changement, mÃªme le plus absurde, s'il est permis par le langage.  Et oui, cela aurait pu fonctionner si <code>ArrayList</code> avait dÃ©clarÃ© la <code>final</code> depuis le dÃ©but. </p><br><h4 id="snova-specifikaciya">  SpÃ©cifications Ã  nouveau </h4><br><p>  Lors du dÃ©bogage de mon application, je suis accidentellement tombÃ© dans les tripes de Spring et j'ai trouvÃ© le <a href="" rel="nofollow">code</a> suivant: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//      paramTypes for (Constructor&lt;?&gt; candidate : candidates) { Class&lt;?&gt;[] paramTypes = candidate.getParameterTypes(); if (constructorToUse != null &amp;&amp; argsToUse != null &amp;&amp; argsToUse.length &gt; paramTypes.length) { // Already found greedy constructor that can be satisfied -&gt; // do not look any further, there are only less greedy constructors left. break; } if (paramTypes.length &lt; minNrOfArgs) { continue; }</span></span></code> </pre> <br><p>  Heureusement, en entrant dans <code>java.lang.reflect.Constructor.getParameterTypes()</code> j'ai fait dÃ©filer le code un peu plus bas et en ai trouvÃ© un magnifique: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Class&lt;?&gt;[] getParameterTypes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parameterTypes.clone(); } <span class="hljs-comment"><span class="hljs-comment">/** * {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritDoc</span></span></span><span class="hljs-comment">} * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@since</span></span></span><span class="hljs-comment"> 1.8 */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParameterCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parameterTypes.length; }</code> </pre> <br><p>  Tu vois, oui?  Si nous devons trouver le nombre d'arguments constructeur / mÃ©thode, il suffit d'appeler <code>java.lang.reflect.Method.getParameterCount()</code> et de ne pas copier le tableau.  VÃ©rifiez si le jeu en vaut la chandelle dans le cas le plus simple, dans lequel la mÃ©thode n'a pas de paramÃ¨tres: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Thread) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(TimeUnit.NANOSECONDS) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MethodToStringBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Method method; <span class="hljs-meta"><span class="hljs-meta">@Setup</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ method = getClass().getMethod(<span class="hljs-string"><span class="hljs-string">"toString"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParameterCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> method.getParameterCount(); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParameterTypes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> method.getParameterTypes().length; } }</code> </pre> <br><p>  Sur ma machine et avec JDK 11, cela se prÃ©sente comme suit: </p><br><pre> <code class="plaintext hljs">Benchmark Mode Cnt Score Error Units getParameterCount avgt 25 2,528 Â± 0,085 ns/op getParameterCount:Â·gc.alloc.rate avgt 25 â‰ˆ 10â»â´ MB/sec getParameterCount:Â·gc.alloc.rate.norm avgt 25 â‰ˆ 10â»â· B/op getParameterCount:Â·gc.count avgt 25 â‰ˆ 0 counts getParameterTypes avgt 25 7,299 Â± 0,410 ns/op getParameterTypes:Â·gc.alloc.rate avgt 25 1999,454 Â± 89,929 MB/sec getParameterTypes:Â·gc.alloc.rate.norm avgt 25 16,000 Â± 0,001 B/op getParameterTypes:Â·gc.churn.G1_Eden_Space avgt 25 2003,360 Â± 91,537 MB/sec getParameterTypes:Â·gc.churn.G1_Eden_Space.norm avgt 25 16,030 Â± 0,045 B/op getParameterTypes:Â·gc.churn.G1_Old_Gen avgt 25 0,004 Â± 0,001 MB/sec getParameterTypes:Â·gc.churn.G1_Old_Gen.norm avgt 25 â‰ˆ 10â»âµ B/op getParameterTypes:Â·gc.count avgt 25 2380,000 counts getParameterTypes:Â·gc.time avgt 25 1325,000 ms</code> </pre> <br><p>  Que pouvons-nous y faire?  Nous pouvons rechercher l'utilisation de l'antipattern <code>Method.getParameterTypes().length</code> dans le JDK (au moins dans <code>java.base</code> ) et le remplacer lÃ  oÃ¹ cela a du sens: </p><br><p> <code>java.lang.invoke.MethodHandleProxies</code> </p> <br><p><img src="https://habrastorage.org/webt/l_/3j/h1/l_3jh1hu3swdedxqktlxboz0tu0.png"></p><br><p> <code>java.util.concurrent.ForkJoinTask</code> </p> <br><p><img src="https://habrastorage.org/webt/0o/rt/q7/0ortq71mnf3-bwsa4wyi-jmzf5y.png"></p><br><p> <code>java.lang.reflect.Executable</code> </p> <br><p><img src="https://habrastorage.org/webt/sm/_h/pm/sm_hpm8eahlmqavobjqg9gejvse.png"></p><br><p> <code>sun.reflect.annotation.AnnotationType</code> </p> <br><p><img src="https://habrastorage.org/webt/yw/bv/il/ywbvil_doi3fzy6uzkpcm42g6zu.png"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Le patch a</a> Ã©tÃ© envoyÃ© avec une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">lettre de motivation</a> . </p><br><p>  Du coup, il s'est avÃ©rÃ© que, depuis plusieurs annÃ©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">, la tÃ¢che Ã©tait similaire,</a> et mÃªme des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">changements y Ã©taient</a> prÃ©parÃ©s.  Les commentaires ont notÃ© une augmentation des performances assez dÃ©cente pour de tels changements simples.  Cependant, eux et mon patch sont nettoyÃ©s jusqu'Ã  prÃ©sent et restent immobiles.  Pourquoi?  Probablement parce que les dÃ©veloppeurs sont trop occupÃ©s par des choses plus nÃ©cessaires et qu'ils n'y mettent bÃªtement pas la main. </p><br><p>  La morale de cette fable est la suivante: vos changements ingÃ©nieux peuvent geler simplement par manque de travailleurs. </p><br><p>  Mais ce n'est pas la fin!  Au cours de la discussion sur la rationalitÃ© du remplacement dÃ©crit dans d'autres projets, des camarades plus expÃ©rimentÃ©s ont avancÃ© une contre-proposition: peut-Ãªtre que vous ne devriez pas faire le remplacement de <code>Method.getParameterTypes().length -&gt; Method.getParameterCount()</code> avec vos mains, mais confier cela au compilateur?  Est-ce possible et sera-t-il "lÃ©gal"? </p><br><p>  Essayons de vÃ©rifier en utilisant le test: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">arrayClone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object[] objects = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[<span class="hljs-number"><span class="hljs-number">3</span></span>]; objects[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">"azaza"</span></span>; objects[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">365</span></span>; objects[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">9876L</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Object[] clone = objects.clone(); assertEquals(objects.length, clone.length); assertSame(objects[<span class="hljs-number"><span class="hljs-number">0</span></span>], clone[<span class="hljs-number"><span class="hljs-number">0</span></span>]); assertSame(objects[<span class="hljs-number"><span class="hljs-number">1</span></span>], clone[<span class="hljs-number"><span class="hljs-number">1</span></span>]); assertSame(objects[<span class="hljs-number"><span class="hljs-number">2</span></span>], clone[<span class="hljs-number"><span class="hljs-number">2</span></span>]); }</code> </pre> <br><p>  qui passe, et qui montre que si le tableau clonÃ© ne quitte pas la portÃ©e, alors il peut Ãªtre supprimÃ©, car l'accÃ¨s Ã  n'importe quel Ã©lÃ©ment depuis ses cellules ou le champ de <code>length</code> peut Ãªtre obtenu Ã  partir de l'original. </p><br><p>  Le JDK peut-il faire cela?  Nous vÃ©rifions: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@State</span></span>(Scope.Thread) <span class="hljs-meta"><span class="hljs-meta">@BenchmarkMode</span></span>(Mode.AverageTime) <span class="hljs-meta"><span class="hljs-meta">@OutputTimeUnit</span></span>(TimeUnit.NANOSECONDS) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayAllocationEliminationBenchmark</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">baseline</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[length].length; } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">baselineClone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[length].clone().length; } }</code> </pre> <br><p>  Sortie pour JDK 13: </p><br><pre> <code class="plaintext hljs">Benchmark Mode Cnt Score Error Units baseline avgt 50 6,135 Â± 0,140 ns/op baseline:Â·gc.alloc.rate.norm avgt 50 56,000 Â± 0,001 B/op clone avgt 50 18,359 Â± 0,619 ns/op clone:Â·gc.alloc.rate.norm avgt 50 112,000 Â± 0,001 B/op</code> </pre> <br><p>  Il s'avÃ¨re que openjdk ne sait pas lancer de <code>new int[length]</code> , contrairement au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Graal</a> , hehe: </p><br><pre> <code class="plaintext hljs">Benchmark Mode Cnt Score Error Units baseline avgt 25 2,470 Â± 0,156 ns/op baseline:Â·gc.alloc.rate.norm avgt 25 0,005 Â± 0,008 B/op lone avgt 25 13,086 Â± 1,059 ns/op lone:Â·gc.alloc.rate.norm avgt 25 112,113 Â± 0,115 B/op</code> </pre> <br><p>  Il s'avÃ¨re que vous pouvez modifier un peu le compilateur d'optimisation openjdk afin qu'il puisse faire ce que le Graal peut faire.  Ã‰tant donnÃ© que non seulement tout le monde peut entrer dans une annonce positive dans le code VM et dÃ©poser quelque chose de significatif, je me suis limitÃ© Ã  une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">lettre</a> dans laquelle j'exprimais mes observations. </p><br><p>  Il s'est avÃ©rÃ©, et il y a plusieurs subtilitÃ©s.  Vladimir Ivanov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">indique</a> que: </p><br><blockquote>  Ã‰tant donnÃ© qu'il n'y a aucun moyen de dÃ©velopper / rÃ©duire les tableaux Java, <br>  La transformation "cloned_array.length =&gt; original_array.length" est correcte <br>  indÃ©pendamment du fait que la variante clonÃ©e s'Ã©chappe ou non. <br><br>  De plus, la transformation est dÃ©jÃ  lÃ : <br><br>  <a href="" rel="nofollow">http://hg.openjdk.java.net/jdk/jdk/file/tip/src/hotspot/share/opto/memnode.cpp#l2388</a> <br><br>  Je n'ai pas examinÃ© les rÃ©fÃ©rences que vous avez mentionnÃ©es, mais il semble que <br>  L'accÃ¨s cloned_array.length n'est pas la raison pour laquelle le tableau clonÃ© est toujours <br>  lÃ . <br><br>  Concernant vos autres idÃ©es, rediriger les accÃ¨s de l'instance clonÃ©e vers <br>  l'original est problÃ©matique (dans le cas gÃ©nÃ©ral) car le compilateur doit prouver <br>  il n'y a eu aucun changement dans les deux versions et les accÃ¨s indexÃ©s rendent mÃªme <br>  plus dur.  Et les points de sÃ©curitÃ© causent Ã©galement des problÃ¨mes (pour la rematÃ©rialisation). <br><br>  Mais je conviens qu'il serait intÃ©ressant de couvrir (au moins) des cas simples de <br>  copie dÃ©fensive. </blockquote><p>  Autrement dit, frapper un clone semble Ãªtre possible et pas particuliÃ¨rement difficile.  Mais avec la conversion </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[arrayLength].length;</code> </pre> <br><p>  -&gt; </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len = arrayLength;</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">des difficultÃ©s</a> surviennent: </p><br><blockquote>  Nous n'Ã©liminons pas les allocations de tableaux qui n'ont pas une longueur connue <br>  car ils peuvent provoquer une exception NegativeArraySize.  Dans ce cas, nous <br>  devrait Ãªtre en mesure de prouver que la longueur est positive. <br><br>  Quoi qu'il en soit - j'ai un patch presque terminÃ© qui remplace le tableau inutilisÃ© <br>  allocations avec un gardien appropriÃ©. </blockquote><p>  En d'autres termes, vous ne pouvez pas simplement prendre et supprimer la crÃ©ation d'un tableau, car selon la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">spÃ©cification, l'</a> exÃ©cution <em>doit</em> lever une <code>NegativeArraySizeException</code> et nous ne pouvons rien y faire: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">arrayWithNwgativeSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> newLen = -<span class="hljs-number"><span class="hljs-number">3</span></span>; length = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[newLen].length; <span class="hljs-comment"><span class="hljs-comment">//  new Object[newLen]  fail(); } catch (NegativeArraySizeException e) { assert length == 0; } }</span></span></code> </pre> <br><p>  Pourquoi le Graal a-t-il pu?  Je pense que la raison en est que la valeur du champ de <code>length</code> dans le benchmark ci-dessus Ã©tait constante et toujours Ã©gale Ã  10, ce qui a permis au profileur de conclure que la vÃ©rification d'une valeur nÃ©gative n'est pas nÃ©cessaire, ce qui signifie qu'elle peut Ãªtre supprimÃ©e avec la crÃ©ation du tableau lui-mÃªme.  Correct dans les commentaires si j'ai fait une erreur. </p><br><p>  C'est tout pour aujourd'hui :) Ajoutez vos exemples dans les commentaires, nous comprendrons. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr433174/">https://habr.com/ru/post/fr433174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr433158/index.html">Parodies musicales de SUSE sur Kubernetes, Linus Torvalds et autres</a></li>
<li><a href="../fr433164/index.html">Rapide et furieux: Forza Horizon 4 accÃ©lÃ¨re avec les shaders de fenÃªtre</a></li>
<li><a href="../fr433166/index.html">PrÃ©dire le temps de solution de ticket Ã  l'aide du Machine Learning</a></li>
<li><a href="../fr433168/index.html">Pourquoi un programmeur fait-il un stage en cuisine - une conversation avec Dodo Pizza sur le gemba, .NET et l'ouverture</a></li>
<li><a href="../fr433172/index.html">Nous attachons le multijoueur au jeu mobile "Make words from words" sur iOS et Android, Ã©crit en C ++</a></li>
<li><a href="../fr433178/index.html">Comment nous avons restaurÃ© un fichier .wav endommagÃ©</a></li>
<li><a href="../fr433180/index.html">RÃ©solution des problÃ¨mes de type de donnÃ©es dans Ruby ou Fiabilisation des donnÃ©es</a></li>
<li><a href="../fr433182/index.html">Est-il possible de former un agent pour la nÃ©gociation en bourse avec des renforts? ImplÃ©mentation du langage R</a></li>
<li><a href="../fr433184/index.html">ASP.NET Core 2.2 est sorti. Quoi de neuf (2 sur 3)</a></li>
<li><a href="../fr433186/index.html">Il ne suffit pas de compter les polygones pour optimiser les modÃ¨les 3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>