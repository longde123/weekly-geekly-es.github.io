<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíØ üî≥ üßúüèΩ CMS sans t√™te. Pourquoi j'√©cris le mien üß† ‚û°Ô∏è ‚öΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! 

 Ce r√©cent article m'a incit√© √† √©crire cette publication (je l'ai vue hier). 

 Racontez les principales fonctionnalit√©s de Headless...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CMS sans t√™te. Pourquoi j'√©cris le mien</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448982/"> Bonjour √† tous! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ce r√©cent article</a> m'a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">incit√©</a> √† √©crire cette publication (je l'ai vue hier). <br><br>  Racontez les principales fonctionnalit√©s de Headless / content-first / api-first, etc.  Je ne serai pas CMS, le mat√©riel est plein et probablement beaucoup connaissent d√©j√† cette tendance.  Et je veux vous dire pourquoi et comment j'√©cris mon syst√®me, pourquoi je ne pouvais pas choisir parmi les syst√®mes existants, ce que je pense des autres syst√®mes que j'ai rencontr√©s auparavant et quelles perspectives je vois pour tout cela.  La fiction sera volumineuse (pour le mat√©riel dans deux ans), mais j'essaierai d'√©crire plus int√©ressant et utile.  Peu importe, s'il vous pla√Æt, sous le chat. <br><a name="habracut"></a><br>  En g√©n√©ral, l'histoire est vraiment longue et je vais essayer de la raconter en premier.  Soit pour clarifier quelles sont les vraies raisons de cr√©er votre propre moteur, soit tout simplement parce que sans cela, il sera difficile sur le terrain d'expliquer pourquoi je le fais de cette fa√ßon, et non d'une mani√®re ou d'une autre. <br><br>  Mais pour commencer, je vais n√©anmoins bri√®vement √©crire les principaux crit√®res de s√©lection pour le CMS sans t√™te moderne, pourquoi je ne pouvais toujours pas choisir une solution toute faite pour moi.  <i>Juste pour que les gens ne s'arr√™tent pas pour lire beaucoup de h√™tres, ne comprenant pas ce qui finira par √™tre dit.</i> <br><br>  En bref: je voulais que tout soit au m√™me endroit: √† la fois l'arri√®re et l'avant (et non ni ceci ni cela), et l'API GraphQL, et que la base de donn√©es soit g√©r√©e et bien plus encore, y compris le bouton ¬´Make Beautiful¬ª.  Je n'ai pas trouv√© √ßa.  Moi non plus, je ne l'ai pas encore fait, mais dans l'ensemble, cela s'est av√©r√© beaucoup, et surtout, cela me permet de faire de vrais projets. <br><br>  Et donc, mon approche peut difficilement √™tre qualifi√©e de scientifique et justifi√©e.  Le fait est que j'√©cris g√©n√©ralement tr√®s souvent quelque chose qui m'appartient.  J'aime programmer ici.  Et il y a deux ans (et avant cela encore 8 ans), je me suis assis sur le MODX CMF (sous lequel j'ai aussi invent√© beaucoup de mes b√©quilles).  Et pendant trois ans, nous avons lanc√© un projet assez important, dans le cadre duquel, il me semblait, je pouvais utiliser MODX.  Mais il s'est av√©r√© que je ne pouvais pas ... La principale raison √©tait que c'√©tait une startup sans aucune exigence technique, avec un tas d'id√©es qui changeaient et se compl√©taient chaque jour (et plusieurs fois par jour).  Et maintenant, chaque fois que sous une nouvelle id√©e, il √©tait n√©cessaire d'ajouter une nouvelle entit√©, d'enregistrer / modifier des champs pour ceux existants, de cr√©er / supprimer / modifier des relations entre ces entit√©s (respectivement, avec un changement dans la structure de la base de donn√©es), j'ai √† un moment donn√© Il a fallu plusieurs heures pour changer ces entit√©s.  En effet, outre le fait qu'il fallait enregistrer ces changements dans le sch√©ma, il fallait changer la base de donn√©es (presque manuellement), mettre √† jour l'API, r√©√©crire le code du programme, etc., etc.  En cons√©quence, le front a d√ª √™tre mis √† jour dans tout cela.  En cons√©quence, j'ai d√©cid√© que nous devrions chercher quelque chose de nouveau, plus pratique, qui simplifierait en quelque sorte tout cela.  Je pr√©ciserai √† nouveau qu'√† l'√©poque j'√©tais un backend php, alors ne soyez pas surpris et ne riez pas que j'ai commenc√© √† d√©couvrir diff√©rents constructeurs frontaux, moins de processeurs, npm, etc.  etc.  Mais quoi qu'il en soit, peu √† peu dans notre projet un front est apparu sur react + less, une API sur GraphQL, et un serveur sur express. <br><br>  Mais tout n'√©tait pas aussi rose qu'il semblerait √† beaucoup maintenant.  Permettez-moi de vous rappeler que c'√©tait il y a plus de deux ans.  Si vous √™tes sur le Web JS moderne depuis moins de deux ans, je vous conseille de lire cet article: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">N raisons d'utiliser l'appli Create React</a> (habr).  Trop paresseux, bref: avec l'av√®nement des react-scripts, vous ne pouvez plus vous soucier de la configuration de webpack, etc.  Tout cela passe en arri√®re-plan.  Les gars gentils ont d√©j√† configur√© le webpack de sorte que la plupart des projets de r√©action sont presque garantis de travailler dessus, et le d√©veloppeur final s'est concentr√© directement sur la programmation du produit final, plut√¥t que de configurer un tas de d√©pendances, de chargeurs, etc.  Mais c'est plus tard.  Et avant cela, je devais juste configurer ce webpack, suivre la mise √† jour du tas de tout ce qui volait avec lui pour rattraper son retard, etc.  etc.  Mais ce n'est qu'une partie du travail, seulement essentiellement le front.  Et vous avez √©galement besoin d'un serveur.  Et vous avez √©galement besoin d'une API.  Et vous avez √©galement besoin de SSR (rendu c√¥t√© serveur), que, par ailleurs, react-script ne fournit toujours pas, √† ma connaissance.  En g√©n√©ral, tout √©tait beaucoup plus compliqu√© √† l'√©poque que maintenant, il n'y en avait pas beaucoup, et tout le monde se d√©battait du mieux qu'il pouvait.  Et comment ai-je b√©quill√© alors ... <br><br>  Imaginez: <br><br><ul><li>  Configuration native du webpack s√©par√©ment pour l'avant et le serveur. </li><li>  Propre impl√©mentation de SSR, de sorte que async fonctionne normalement avec react-server, et que les styles imm√©diatement pr√™ts arrivent et soient index√©s normalement, et les statuts de serveur pour les pages non trouv√©es ont √©t√© donn√©s. </li><li>  Pas de redux.  Eh bien, je n'ai pas aim√© redux tout de suite.  J'ai aim√© l'id√©e d'utiliser mon flux de r√©action natif (m√™me si j'ai d√ª le r√©√©crire un peu pour moi). </li><li>  Sch√©mas et r√©solveurs GraphQL prescrits manuellement, sans d√©ploiement automatique de la base de donn√©es (le serveur API a √©t√© utilis√© comme interm√©diaire pour un site MODX). </li><li>  Pas de r√©actif-apollo / apollo-client, etc.  Tout est √©crit ind√©pendamment avec des requ√™tes via fetch, des r√©f√©rentiels dans un navigateur bas√© sur un flux personnalis√©. </li></ul><br>  En cons√©quence: jusqu'√† pr√©sent, l'une des premi√®res versions de celui-ci a un projet avec une fr√©quentation de 500+, et dans la saison (hiver) 1000-1700 √©tudiants uniques par jour.  Disponibilit√© 2 mois.  En effet, j'ai red√©marr√© manuellement le serveur apr√®s une mise √† jour pr√©ventive du logiciel.  Et avant ce red√©marrage, la disponibilit√© √©tait encore de 6 mois et plus.  Mais le plus int√©ressant est la consommation de m√©moire.  Il y a actuellement pr√®s de 700 m√©gaoctets de processus js.  Oui, oui, je ris avec toi ici aussi :) Bien s√ªr, c'est beaucoup.  Et avant cela, j'ai fait un peu de pr√©vention et am√©lior√© cet indicateur.  Auparavant, il y avait un total de 1000M + par processus ... N√©anmoins, cela fonctionnait et √©tait tout √† fait tol√©rable.  Et avant que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Google ne modifie les algorithmes de PageSpeed ‚Äã‚ÄãInsights</a> en novembre, le site avait une mesure de performance 97/100.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Preuve</a> <br><br>  Une conclusion interm√©diaire bas√©e sur ce projet bas√© sur un syst√®me qui s'est d√©velopp√© sans ce projet (le projet a √©t√© laiss√© de c√¥t√©): <br><br>  <b>Avantages</b> <br><br><ol><li>  L'API du projet est devenue plus flexible gr√¢ce √† l'utilisation de GraphQL, et le nombre de demandes de serveur a √©t√© consid√©rablement r√©duit. </li><li>  Le projet a acc√®s √† un grand nombre de composants sur npm. </li><li>  La gestion de projet est devenue plus transparente gr√¢ce √† l'utilisation des d√©pendances, git, etc. </li><li>  Les scripts et les styles dispers√©s sont certainement plus agr√©ables qu'un tas de scripts s√©par√©s sur les anciens sites, lorsque vous ne savez pas ce que vous pouvez supprimer de ce zoo sans cons√©quences (et vous voyez souvent plusieurs versions d'un bogue sur un site). </li><li>  Le site est devenu plus interactif, les pages fonctionnent sans red√©marrage, le retour aux pages pr√©c√©demment consult√©es ne n√©cessite pas d'appels r√©p√©t√©s au serveur. </li><li>  L'√©dition des donn√©es a lieu directement sur la page, sur le principe de "√©diter ce que vous voyez et o√π vous voyez", sans panneau d'administration s√©par√©. </li></ol><br>  <b>Inconv√©nients (principalement pour le d√©veloppeur)</b> <br><br><ol><li>  Tout est tr√®s compliqu√©.  Vraiment.  Il est tout simplement irr√©aliste de connecter un d√©veloppeur tiers au projet.  Je pouvais moi-m√™me √† peine comprendre quoi et comment cela fonctionne et d'o√π mes jambes poussent.  Si vous regardez la page 3 des avantages, o√π il est dit √† propos de la transparence, alors la transparence est seulement en ce que si vous accrochez quelque chose quelque part, vous pouvez imm√©diatement voir ce qui est cass√© (les scripts ne se construisent pas, etc.), mais en validant et en diff√©rant Vous pouvez trouver o√π cela a accroch√©.  Eh bien, si vous avez r√©ussi √† ajouter quelque chose de nouveau et que cela fonctionne, au moins vous comprenez clairement que, oui, tout s'est bien pass√©.  Mais dans l‚Äôensemble, c‚Äôest toujours un enfer infernal. </li><li>  Difficult√©s de mise en cache.  Plus tard, j'ai d√©couvert apollo-client pour moi.  Et avant cela, comme je l'ai dit, j'ai √©crit mes stockages bas√©s sur les flux.  En raison de ces stockages, il √©tait possible d'obtenir les donn√©es n√©cessaires pour le rendu √† partir de diff√©rents composants, mais le volume de cache c√¥t√© client √©tait tr√®s important (chaque ensemble d'entit√©s typiques avait son propre r√©f√©rentiel).  En cons√©quence, il √©tait difficile de v√©rifier si l'objet avait √©t√© demand√© plus t√¥t ou non (c'est-√†-dire, cela vaut-il la peine de faire une demande au serveur pour le trouver), si toutes les donn√©es associ√©es sont disponibles, etc. </li><li>  Difficult√©s avec les sch√©mas, la structure de la base de donn√©es et les r√©solveurs (fonctions API pour recevoir / modifier des donn√©es).  Comme je l'ai dit, j'ai √©crit des sch√©mas manuellement, et des r√©solveurs aussi.  Dans quoi, dans les r√©solveurs, j'ai essay√© de fournir la mise en cache et le traitement des demandes imbriqu√©es et d'autres subtilit√©s.  √Ä ce moment, j'ai d√ª aller tr√®s loin dans l'essence et le code du programme GraphQL.  L'avantage est que je comprends g√©n√©ralement assez bien comment GraphQL fonctionne, quels sont ses avantages et ses inconv√©nients, et comment mieux le cuisiner.  L'inconv√©nient est que, bien s√ªr, vous ne pouvez pas √©crire toutes ces commodit√©s et petits pains √©crits par des commandes comme apollo en un.  Du coup, quand j'ai d√©couvert apollo, bien s√ªr, j'ai commenc√© √† utiliser leurs composants avec grand plaisir (mais surtout √† l'avant, je vais vous expliquer pourquoi ci-dessous). </li></ol><br>  En g√©n√©ral, ce projet utilisant des technologies obsol√®tes est personnellement le mien √† 100%, donc je peux me permettre de l'abandonner jusqu'√† des temps meilleurs.  Mais il y a d'autres projets pour lesquels j'ai d√ª aller plus loin et d√©velopper la plateforme.  Et plusieurs fois, j'ai d√ª tout r√©√©crire √† partir de z√©ro.  De plus, je parlerai plus en d√©tail des t√¢ches individuelles que j'ai rencontr√©es et des solutions que j'ai d√©velopp√©es et appliqu√©es en cons√©quence. <br><br>  <b>Sch√©ma d'abord.</b>  <b>D'abord le circuit, puis tout le reste</b> <br><br>  Un site (interface web, client l√©ger, etc.) est tout l'affichage d'informations (enfin, la gestion de l'information, si elle est autoris√©e et la fonctionnalit√© le permet).  Mais d'abord, tout de m√™me, une base de donn√©es (tables, colonnes, etc.).  Ayant rencontr√© plusieurs approches diff√©rentes pour travailler avec la base de donn√©es sur mon chemin, j'ai le plus appr√©ci√© l'approche Schema-first.  Autrement dit, vous d√©crivez le sch√©ma des entit√©s et des types de donn√©es (manuellement ou via l'interface), d√©ployez le sch√©ma et vous appliquez imm√©diatement les modifications d√©crites √† la base de donn√©es (les tables / colonnes sont cr√©√©es / supprim√©es, ainsi que les relations entre elles).  Selon l'impl√©mentation, vous g√©n√©rerez √©galement toutes les fonctions de r√©solveur n√©cessaires √† la gestion de ces donn√©es.  Surtout dans cette direction, j'ai aim√© le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prisma.io</a> . <br><br>  Avec votre permission, puisque m√™me sur le hub je n'ai pas vu un seul article sur le prisme, j'attirerai un peu l'attention sur eux, car le projet est vraiment tr√®s int√©ressant, et sans eux je n'aurais pas maintenant une telle plateforme qui me rendait si heureux .  En fait, c'est pourquoi j'ai appel√© ma plateforme prisma-cms, car prisma.io y joue un tr√®s grand r√¥le. <br><br>  En fait, prisma.io est un projet SaaS, mais avec une grosse mise en garde: ils mettent presque tout ce qu'ils font sur un github.  Autrement dit, vous pouvez utiliser leurs serveurs pour un prix tr√®s raisonnable (et configurer votre propre base de donn√©es et API pour vous-m√™me en quelques minutes), ou vous pouvez tout d√©ployer enti√®rement √† la maison.  Dans ce cas, le prisme doit √™tre logiquement divis√© en deux parties distinctes importantes: <br><br><ol><li>  Prisma-server, c'est-√†-dire le serveur sur lequel tourne √©galement la base de donn√©es. </li><li>  Prisma-client.  C'est essentiellement aussi un serveur, mais par rapport √† la source de donn√©es (prisma-server) c'est un client. </li></ol><br>  Maintenant, je vais essayer d'expliquer cette situation confuse.  En g√©n√©ral, l'essence du prisme est qu'en utilisant un seul point de terminaison API, vous pouvez travailler avec diff√©rentes sources de donn√©es.  Oui, ici, tout le monde dira qu'ils ont tous cr√©√© GraphQL et que le prisme n'est pas n√©cessaire ici.  En g√©n√©ral, tout le monde aura raison, mais il y a un point grave: GraphQL ne d√©finit que les principes et le travail global, mais en soi, il ne fournit pas de travail avec les sources de donn√©es finales de la bo√Æte.  Il dit: "Vous pouvez cr√©er une API pour d√©crire les demandes que les utilisateurs peuvent envoyer, mais la fa√ßon dont vous g√©rez ces demandes est √† vous de d√©ranger."  Et le prisme utilise √©galement, bien s√ªr, GraphQL (√† propos, et beaucoup d'autres choses, y compris divers produits apollo).  Mais le prisme plus √† cela ne fait que travailler avec la base de donn√©es.  Autrement dit, d√©crivant le sch√©ma et son d√©ploiement, les tables et colonnes n√©cessaires (ainsi que les relations entre elles) seront imm√©diatement cr√©√©es dans la base de donn√©es sp√©cifi√©e, et g√©n√©reront imm√©diatement toutes les fonctions CRUD n√©cessaires.  Autrement dit, avec un prisme, vous n'obtenez pas seulement un serveur GraphQL, mais une API de travail √† part enti√®re qui vous permet imm√©diatement de travailler avec la base de donn√©es.  Ainsi, Prisma-server fournit une base de donn√©es et une interaction avec elle, et prisma-client vous permet d'√©crire vos r√©solveurs et d'envoyer des requ√™tes √† prisma-server (ou ailleurs, m√™me pour quelques prisma-servers).  Et il s'av√®re que vous ne pouvez d√©ployer prisma-client que par vous-m√™me (et SaaS prisma.io sera utilis√© comme prisma-server), et vous pouvez d√©ployer prisma-server par vous-m√™me, et en g√©n√©ral en aucun cas d√©pendre d'un prisme, c'est tout le v√¥tre. <br><br>  Ici, j'ai choisi un prisme pour moi, comme base de ma plate-forme.  Mais j'ai d√ª le faire tourner pour obtenir une plate-forme compl√®te. <br><br><h4>  1. Sch√©mas de fusion </h4><br>  √Ä cette √©poque, le prisme n'√©tait pas en mesure de combiner les circuits.  Autrement dit, la t√¢che est la suivante: <br><br>  Vous avez un mod√®le utilisateur d√©crit dans un module <br><br><pre><code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique }</code> </pre> <br>  et dans un autre module <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Dans le cadre d'un projet, vous souhaitez combiner ces deux sch√©mas automatiquement pour obtenir la sortie <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Mais alors ce prisme ne pouvait pas faire.  Il s'est av√©r√© impl√©menter cela en utilisant la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">biblioth√®que merge-graphql-schemas</a> . <br><br><h4>  Travailler avec un serveur prismatique arbitraire. </h4><br>  Dans le prisme, la configuration est √©crite dans un fichier de configuration sp√©cial.  Si vous souhaitez modifier l'adresse du serveur √† prismes utilis√©, vous devez modifier le fichier.  Une bagatelle, pas agr√©able.  Je voulais rendre l'URL possible √† sp√©cifier dans la commande, par exemple endpoint = http: // endpoint-address yarn deploy (yarn start).  Cela a √©t√© tu√© pendant plusieurs jours ... Mais maintenant, vous pouvez utiliser un projet de prisme pour un nombre illimit√© de points de terminaison.  Soit dit en passant, jusqu'√† pr√©sent, prisma-cms fonctionne facilement, m√™me avec une base de donn√©es locale, m√™me avec des serveurs √† prisme SaaS. <br><br><h4>  Modules / Plugins </h4><br>  Ce n'√©tait g√©n√©ralement pas suffisant.  Comme je l'ai dit, la t√¢che principale du prisme est de fournir du travail avec diverses bases de donn√©es.  Et ils font un excellent travail.  D√©j√†, ils prennent en charge le travail avec MySQL, PostgreSQL, Amazon RDS et MongoDB, plusieurs autres types de sources en cours de route.  Mais ils ne fournissent aucune infrastructure modulaire.  Il n'y a jusqu'√† pr√©sent aucun march√© ou quelque chose comme √ßa.  Il n'y a que quelques blancs typiques.  Mais vous ne pouvez pas choisir deux ou trois de plusieurs blancs et installer sur un seul projet.  Nous devrons en choisir un.  Je voulais qu'il soit possible d'installer un nombre diff√©rent de modules sur le projet final, et que lors du d√©ploiement des circuits et des r√©solveurs, ils se r√©jouissent et obtiennent un projet unique avec la fonctionnalit√© totale.  Et bien qu'il n'y ait pas encore d'interface graphique, il existe d√©j√† plus de deux douzaines de modules et composants fonctionnels qui peuvent √™tre combin√©s sur le projet final.  Ici, je vais imm√©diatement d√©cider un peu des d√©finitions personnelles: un module est ce qui est install√© √† l'arri√®re (extension de la base de donn√©es et de l'API), et un composant est ce qui est install√© √† l'avant (pour ajouter divers √©l√©ments d'interface).  Jusqu'√† pr√©sent, il n'y a pas d'interface graphique pour connecter les modules, mais ce n'est pas difficile pour moi d'√©crire de cette fa√ßon (ce n'est pas souvent fait): <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(options = {}) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mergeModules([ LogModule, MailModule, UploadModule, SocietyModule, EthereumModule, WebrtcModule, UserModule, RouterModule, ]); }</code> </pre><br>  Apr√®s avoir ajout√© de nouveaux modules, il suffit de refaire un d√©ploiement avec une seule commande et c'est tout, nous avons d√©j√† de nouvelles tables / colonnes et des fonctionnalit√©s augment√©es. <br><br><h4>  5 frontaux, sensibles aux changements dans le backend </h4><br>  Ce n'√©tait pas suffisant du tout.  Cela sera suivi d'une digression.  Le fait est que tous les CMS API-first que j'ai vus disent "Nous sommes g√©niaux de fournir l'API, et vous vissez le devant que vous voulez."  C'est ce qu'ils "vissent tout ce que vous aimez" signifie en fait "d√©rangez comme vous le souhaitez."  Exactement la m√™me chose que les cadres d'interface utilisateur disent, "regardez quels boutons sympas nous sommes et faites tout cela, et confondez-vous avec le backend vous-m√™me".  √áa tuait toujours.  Je voulais juste trouver un CMS complet √©crit en javascript, en utilisant GraphQL et en fournissant √† la fois l'arri√®re et l'avant.  Mais je n'en ai pas trouv√© un comme √ßa.  Je voulais vraiment que les changements d'API soient imm√©diatement per√ßus √† l'avant.  Et pour cela, plusieurs sous-√©tapes ont √©t√© r√©alis√©es: <br><br><h4>  5.1 G√©n√©ration de fragments d'API </h4><br>  A l'avant, des fragments du fichier de sch√©ma sont enregistr√©s dans les requ√™tes.  Lorsque l'API est reconstruite sur le serveur, un nouveau fichier JS avec des fragments d'API est √©galement g√©n√©r√©.  Et dans les demandes, c'est √©crit comme ceci: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { UserNoNestingFragment, EthAccountNoNestingFragment, NotificationTypeNoNestingFragment, BatchPayloadNoNestingFragment, } = queryFragments; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userFragment = <span class="hljs-string"><span class="hljs-string">` fragment user on User { ...UserNoNesting EthAccounts{ ...EthAccountNoNesting } NotificationTypes{ ...NotificationTypeNoNesting } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${UserNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${EthAccountNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${NotificationTypeNoNestingFragment}</span></span></span><span class="hljs-string"> `</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> usersConnection = <span class="hljs-string"><span class="hljs-string">` query usersConnection ( $where: UserWhereInput $orderBy: UserOrderByInput $skip: Int $after: String $before: String $first: Int $last: Int ){ objectsConnection: usersConnection ( where: $where orderBy: $orderBy skip: $skip after: $after before: $before first: $first last: $last ){ aggregate{ count } edges{ node{ ...user } } } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${userFragment}</span></span></span><span class="hljs-string"> `</span></span>;</code> </pre><br><h4>  5.2 Un contexte pour tous les composants </h4><br>  React 16.3 introduit une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvelle API de contexte</a> .  Je l'ai fait pour que dans les composants enfants √† n'importe quel niveau, il soit possible d'acc√©der √† un seul contexte sans r√©pertorier les types pr√©c√©demment souhait√©s √† partir du contexte, mais simplement en indiquant statique contextType = PrismaCmsContext et en obtenant tous les charmes via ce contexte -&gt; (y compris le client API, le sch√©ma , demandes, etc.). <br><br><h4>  5.3 filtres dynamiques </h4><br>  Je voulais aussi vraiment.  GraphQL vous permet de cr√©er des requ√™tes complexes avec une structure imbriqu√©e.  Je voulais aussi que les filtres soient dynamiques, form√©s √† partir du sch√©ma API et nous permettent de cr√©er des conditions imbriqu√©es.  Voici ce qui s'est pass√©: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YOCF3ttK2Mg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  5.4 G√©n√©rateur de site Web </h4><br>  Et enfin, ce qui me manquait, c'√©tait un √©diteur de site externe, c'est-√†-dire un concepteur.  Je voulais que le serveur n'ait qu'un minimum d'actions √† effectuer, et toute la conception finale devrait √™tre faite √† l'avant (y compris la configuration du routage, la g√©n√©ration des s√©lections, etc.).  C'est un sujet pour un article s√©par√©, car entre autres, j'ai √©galement √©crit mon √©diteur wysiwyg crutchy sur pure contentEditable, et il y a beaucoup de subtilit√©s.  Si je retrouve mes droits et qui sera int√©ress√©, j'√©crirai un article s√©par√©. <br><br>  Enfin, une courte vid√©o de d√©monstration du designer en action.  Toujours assez brut, mais j'aime √ßa. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4j9ePxDhHGU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Je vais terminer l√†-dessus.  Je n'ai pas encore √©crit grand-chose, ce que j'aimerais √©crire, mais tant de choses se sont pass√©es.  Je me ferai un plaisir de commenter. <br><br>  PS: tous les codes source, y compris les codes source du site lui-m√™me, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sont ici</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448982/">https://habr.com/ru/post/fr448982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448968/index.html">PHP asynchrone. Pourquoi?</a></li>
<li><a href="../fr448970/index.html">Authentification √† deux facteurs pour SSH</a></li>
<li><a href="../fr448974/index.html">Approche sans serveur pour le d√©veloppement rapide d'un service vid√©o fonctionnel</a></li>
<li><a href="../fr448976/index.html">Les √©v√©nements du printemps de Gamedev au HSE</a></li>
<li><a href="../fr448980/index.html">Notre premier d√©jeuner ensemble: pourquoi et comment nous passons notre journ√©e de test</a></li>
<li><a href="../fr448986/index.html">R√©tro-ing√©nierie 3D avec num√©risation 3D</a></li>
<li><a href="../fr448988/index.html">Les SSD de Kingston sont devenus plus spacieux, maintenant presque le m√™me co√ªt - nous rencontrons la s√©rie A400-R</a></li>
<li><a href="../fr448992/index.html">Hachage polyvalent et parfait</a></li>
<li><a href="../fr448994/index.html">Est-il si difficile de d√©marrer le chemin d'un recruteur informatique?</a></li>
<li><a href="../fr448996/index.html">Cr√©ation d'une politique de mot de passe sous Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>