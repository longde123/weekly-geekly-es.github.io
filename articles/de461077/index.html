<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëêüèø üßõüèΩ üóìÔ∏è Wie werden Pentester gekocht? Eingangstests f√ºr Praktikanten im Bereich digitale Sicherheit ‚úãüèæ üë©üèΩ‚Äçü§ù‚Äçüë©üèª üî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Summer of Hack 2019 in der digitalen Sicherheit ist bereits in vollem Gange, was bedeutet, dass es Zeit ist zu erz√§hlen, wie wir Leute rekrutiert ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie werden Pentester gekocht? Eingangstests f√ºr Praktikanten im Bereich digitale Sicherheit</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/461077/">  <b>Der Summer of Hack 2019</b> in der digitalen Sicherheit ist bereits in vollem Gange, was bedeutet, dass es Zeit ist zu erz√§hlen, wie wir Leute rekrutiert haben. <br><br><img src="https://habrastorage.org/webt/iv/ef/ud/ivefudzwssbwskpfaxaxkczsxvu.jpeg"><br><br>  Unter dem Schnitt, umfangreiches und interessantes Material dar√ºber, wie wir junge Spezialisten f√ºr unser Praktikum ‚ÄûSummer of Hack 2019‚Äú und speziell f√ºr das Department of Security Audit ausw√§hlen. <br><br>  √úberlegen Sie, was ein Pentester unserer Meinung nach wissen sollte, um seine Arbeit erfolgreich zu erledigen. <br><br>  Lassen Sie uns eine Reihe schwieriger Aufgaben analysieren, die wir den Jungs gefoltert haben, auch im Auftrag einer von ihnen. <br><a name="habracut"></a><br>  Der vielleicht interessanteste Teil der Auswahl f√ºr ein Praktikum in der Sicherheits√ºberpr√ºfungsabteilung war unser Profil.  Jedes Jahr versammeln wir uns als ganze Abteilung und diskutieren, welche F√§higkeiten unserer Meinung nach f√ºr einen modernen Spezialisten auf dem Gebiet der praktischen Sicherheit gefragt sind, erinnern uns an die interessantesten Aufgaben, die wir in diesem Jahr l√∂sen mussten, und schreiben Wissensbereiche auf, ohne die es schwierig ist, sich einen erfolgreichen Pr√ºfer vorzustellen.  Wenn alle Witze gescherzt und die Geschichten erz√§hlt werden, bleibt das Endergebnis eine Reihe von Ideen. <br><br>  In diesem Jahr haben wir uns an folgenden Anforderungen orientiert: <br><br><ul><li>  Grundkenntnisse der Ger√§te-Webanwendungen und Angriffe auf diese; </li><li>  Grundkenntnisse √ºber browserbasierte Schutz- und Zugriffskontrollmechanismen (ja, die gleiche SOP und CORS, wo ohne sie); </li><li>  Grundlegende F√§higkeiten zum Lesen von Code und die F√§higkeit, Logik dahinter zu erkennen; </li><li>  Verst√§ndnis der Funktionsweise von Computernetzwerken und deren Routing; </li><li>  Erfahrung mit Linux-√§hnlichen Systemen; </li><li>  Die F√§higkeit, keine Angst vor ungewohnter Technologie zu haben.  Die F√§higkeit, die empfangenen Informationen zu googeln und zu systematisieren; </li><li> Und eine Prise Android (obwohl nicht notwendig, aber das ist unsere kleine Laune). </li></ul><br>  Nachdem Fragen entwickelt wurden.  Teilweise haben wir sie aus den Fragen ausgeliehen, die wir bei den Interviews gestellt haben, aber mehr als die H√§lfte war speziell f√ºr diesen Fragebogen vorbereitet.  Unsere Experten verbrachten ihre pers√∂nliche Zeit damit, Verkehrsdumps vorzubereiten und zu diskutieren, wie die Frage besser formuliert werden kann und welche Sicherheitsl√ºcken ‚Äûzu spezifisch sind, warum Auszubildende qu√§len‚Äú.  F√ºr diesen Eifer k√∂nnen wir nicht anders, als unseren Hut abzunehmen (nat√ºrlich wei√ü). <br><br>  Die Analyse jeder Frage besteht aus zwei Teilen.  Der erste Teil ist die Antwort eines unserer Auszubildenden - Danila <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">Korgik_0 Leontyeva</a> (er ist der Autor der Ver√∂ffentlichung), und der zweite Teil sind die Kommentare von Spezialisten, die den Fragebogen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">√ºberh√§uft haben</a> . <br><br><hr><br>  <i>Hallo Habr!</i> <i><br><br></i>  <i>Zun√§chst ein kleiner lyrischer Exkurs.</i> <i><br></i>  <i>Genauer gesagt: ‚ÄûWie habe ich von Summ3r 0f h4ck erfahren?‚Äú.</i> <i><br></i>  <i>Die Ank√ºndigung des Praktikums h√∂rte ich aus einer Rede von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Denis Rybin</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ilya Bulatov</a> auf der RuCTF2019-Konferenz.</i> <i><br><br></i>  <i>Buchst√§blich nach 4 Tagen wurde auf habr ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beitrag</a> √ºber die Er√∂ffnung eines Praktikums ver√∂ffentlicht.</i> <i><br><br></i>  <i>Und am Abend desselben Tages er√∂ffnete ich die Aufgabe in der Sicherheits√ºberpr√ºfungsabteilung und vertiefte mich in die Arbeit.</i>  <i>Heute werde ich dem Leser mitteilen, mit welchen Schwierigkeiten ich konfrontiert war und welche L√∂sungsoption ich anbieten k√∂nnte.</i> <br><br><hr><br><h1>  <strong><font color="#cc0000">Nr. 1.</font></strong>  <strong><font color="#cc0000">PHP-Quellcode</font></strong> </h1><br>  Untersuche den Code.  Beschreiben Sie, welche Fehler Sie sehen und wie Sie sie beheben w√ºrden. <br><br><img src="https://habrastorage.org/webt/ne/0x/ku/ne0xkuq_5uz955i1rypa8or5spk.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Jobanalyse</b> <div class="spoiler_text">  4. Zeile - Verwenden Sie den MD5-Hash. <br>  Problem - md5 kann mit Hashcat in angemessener Zeit brutalisiert werden. <br>  Wie zu beheben? <br><br>  Verwendung von "ressourcenintensiveren" Hashing-Algorithmen. <br>  In diesem Fall m√ºssen Sie die Benutzer-Cookies vollst√§ndig ablehnen und die gesamte Logik an phpsession binden. <br><br>  5. Zeile - PostgreSQL-Injektionen. <br>  Wie zu beheben? <br>  Vorbereitete Anweisung verwenden. <br>  Implementierung einer vorbereiteten Anweisung zur √úberpr√ºfung der Anmeldung <br><br><pre><code class="plaintext hljs">$query = "SELECT username FROM login WHERE username=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($username)); $username = $stmt-&gt;fetchColumn(); if($username == FALSE) { die(" !"); }</code> </pre> <br>  11 Zeile - eine Reihe von erfolglosen Entscheidungen. <br><br><ol><li>  Zu lange Sitzungsdauer.  Ein ganzes Jahr ist viel.  Wenn das Cookie erfolgreich entf√ºhrt wurde, kann der Angreifer lange auf das Benutzerkonto zugreifen. </li><li>  Fehlende httpOnly-Flagge.  Bei TRUE kann auf Cookies nur √ºber das HTTP-Protokoll zugegriffen werden.  Das hei√üt, Cookies sind in diesem Fall f√ºr Skriptsprachen wie JavaScript nicht verf√ºgbar. </li><li>  Kein Cookie-Hashing. </li><li>  Fehlende Einstellung des sicheren Flags.  Das sichere Flag gibt an, dass ein Cookie vom Client √ºber eine sichere HTTPS-Verbindung gesendet werden soll.  Bei TRUE wird das Cookie vom Client nur dann an den Server gesendet, wenn eine sichere Verbindung hergestellt wurde. </li></ol><br>  Wie zu beheben? <br>  Standardm√§√üig betr√§gt die Sitzungslebensdauer in PHP nur 24 Minuten. Lassen Sie uns dies implementieren. <br>  Setzen Sie das sichere Flag httpOnly. <br><br>  In diesem Fall sollten Sie das seltsame Benutzer-Cookie ablehnen und die gesamte Logik an phpsession binden. <br><br>  18 Zeile - XSS (English Cross-Site Scripting - "Intersite Scripting"). <br>  Wie zu beheben?  Konvertieren Sie alle m√∂glichen Zeichen in die entsprechenden HTML-Entit√§ten. <br><br><pre> <code class="plaintext hljs">$query = htmlentities($query, ENT_QUOTES, "UTF-8");</code> </pre> <br>  Wir werden die Codierung explizit angeben, um zu vermeiden, dass UTF-7 ersetzt wird. <br><br><pre> <code class="plaintext hljs">header("Content-Type: text/html; charset=utf-8");</code> </pre> <br>  Zeile 20 - Fehler des Authentifizierungssystems und des Sitzungsspeichers. <br><br>  Problem - Wenn Sie die in base64 codierte Benutzer-ID im Cookie-Benutzer festlegen, k√∂nnen Sie sich bei seinem Konto anmelden! <br><br>  Wie zu beheben?  Bei der Autorisierung des Benutzers zeichnen wir die Sitzung in der Datenbank auf und bei der Installation der Sitzung √ºberpr√ºfen wir, ob sie in der Datenbank vorhanden ist. <br><br><pre> <code class="plaintext hljs"> $query = "SELECT sessions FROM login WHERE sessions=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($_COOKIE["user"])); $session = $stmt-&gt;fetchColumn(); if($session == TRUE) { do_login($_COOKIE["user"]); }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expertenkommentar D:</b> <div class="spoiler_text"><blockquote>  Die erste Frage, mit der der Fragebogen zuk√ºnftige Praktikanten traf, betraf die wichtigsten und allgemein bekannten Web-Schwachstellen.  Die einzige Schwierigkeit hierbei ist die Notwendigkeit, sie im Quellcode in PHP zu sehen.  Niemand hat sich jedoch die Aufgabe gestellt, "Fehler zu verbergen". <br><br>  Hier ist eine Liste der Schwachstellen, die in dieser Liste in der Reihenfolge ihrer Erkennungsh√§ufigkeit erkannt werden k√∂nnen: <br><br>  <b>Das Hashing von Passw√∂rtern mit dem MD5-Algorithmus wurde</b> sogar von Kandidaten bemerkt, die weit vom Internet entfernt waren.  Es gab jedoch auch interessante Nuancen, zum Beispiel verwendeten viele Kandidaten sehr falsche Begriffe und versuchten, die Probleme in eigenen Worten zu beschreiben.  "Algorithmus-Schwachstellen", "Einwegfunktionen", "das Vorhandensein von Kollisionen" und andere seltsame Wendungen gingen in den Kampf. Bei n√§herer Betrachtung stellen sich heraus, dass sie nichts weiter als eine Reihe gro√üer W√∂rter sind, die das Wesentliche nicht offenbaren.  Nat√ºrlich gingen wir hier zu einem Treffen und fanden keine Schuld an den Menschen, die sich gerade darauf vorbereiten, den Weg zum Erlernen der Weisheit der Informationssicherheit einzuschlagen.  Um eine "Aufrechnung" zu erhalten, h√§tte die Erw√§hnung der Bedrohung ausgereicht, dass im Falle einer Gef√§hrdung der Datenbank die md5-Hashes vom Angreifer in einer akzeptablen Zeit aussortiert und die Passw√∂rter (oder gleichwertige Zeichenfolgen) in klarer Form empfangen werden k√∂nnen.  Und nat√ºrlich erw√§hnten viele den Mangel an Salz und roher Gewalt aufgrund der Verwendung von Regenbogentischen.  Wir haben solche Kommentare auch positiv aufgenommen, insbesondere wenn der Befragte erkl√§rte, warum dies eine Bedrohung darstellt. <br><br>  <b>M√∂gliche SQL-Injection.</b>  Es ist schwer, etwas hinzuzuf√ºgen.  Beim Aufruf der Datenbank werden Benutzereingaben von Login und Passwort direkt mit der Anfrage verkn√ºpft.  Wenn es unwahrscheinlich ist, dass Sie den Kennwortwert zu diesem Zeitpunkt manipulieren k√∂nnen (ein Hash wird daraus entnommen), ist es f√ºr einen potenziellen Angreifer nicht schwierig, eine Injektion in den Benutzernamen einzuf√ºhren. <br><br>  <b>Ausgabe unn√∂tiger Debug-Informationen, die zu einem XSS-Angriff f√ºhren.</b>  Durch sorgf√§ltiges Lesen der Liste k√∂nnte man auf den Echoaufruf achten, der die generierte Anforderung an die Datenbank in HTML-Kommentaren auf der Seite anzeigt.  Nat√ºrlich ist eine solche Schlussfolgerung zus√§tzlicher Informationen auf der Seite v√∂llig optional und wird vom Entwickler nach Durchf√ºhrung der Tests h√∂chstwahrscheinlich einfach vergessen.  Solche zus√§tzlichen Informationen sind f√ºr den Angreifer sehr n√ºtzlich und erm√∂glichen ein viel besseres Verst√§ndnis der Funktionsweise der Anwendung.  Dies ist jedoch leider nur die halbe Miete.  Tatsache ist, dass ein Angreifer den Inhalt der Abfragevariablen manipulieren kann und sein Inhalt nicht gefiltert oder maskiert werden kann, bevor er dem Benutzer angezeigt wird - es liegt ein potenzieller XSS-Angriff vor.  Es kann sich jedoch herausstellen, dass seine Ausnutzung aufgrund der schlecht lokalisierten Strtoupper-Funktion immer noch Kopfschmerzen bereitet.  Der vom Angreifer injizierte Vektor wird in Gro√übuchstaben geschrieben. Wenn dies f√ºr HTML-Tags kein Problem darstellt, ist Javascript durch einen solchen Aufruf sehr beleidigt.  Dies kann einfach √ºber die Browserkonsole √ºberpr√ºft werden. <br><br><img src="https://habrastorage.org/webt/cg/ev/oy/cgevoykot6pzht0mx5ppeqyxwne.png"><br><br>  Zumindest muss sich der Angreifer anscheinend den sogenannten "skriptlosen Angriffen" oder ausgefeilten Techniken zuwenden, um die Filterung zu umgehen (in diesem Fall w√ºrde JSFUCK dies tun), sodass die Tatsache eines Sicherheitsrisikos dies nicht aufhebt. <br><br>  <b>Ein Fehler in der Logik des Sitzungsverwaltungsmechanismus</b> war der interessanteste Teil der Aufgabe.  Seine Entdeckung erforderte nicht nur das zeilenweise Lesen der Quelle, sondern auch das Verstehen der Logik der gesamten Auflistung.  Man konnte f√ºhlen, dass etwas nicht stimmte, wenn man die Einstellung eines Cookies bemerkte, das die base64-codierte Benutzer-ID im Remember-Me-Block enthielt.  Eine weitere Analyse der Logik dieses Mechanismus f√ºhrt uns zu dem Gedanken: "Es stellt sich heraus, dass sich ein Angreifer, der die ID kennt oder durchl√§uft, bei jedem Konto anmelden kann, ohne einen Benutzernamen und ein Passwort einzugeben ?!".  Ja, tats√§chlich kann ein Angreifer unabh√§ngig einen Cookie-Benutzer auf seiner Seite generieren und ihm einen beliebigen ID-Wert zuweisen, der von base64 codiert wird.  Das Senden einer Anfrage mit einem solchen Cookie ohne Benutzername und Passwort w√ºrde die Funktion do_login ausl√∂sen und sich bei einem anderen Konto anmelden. <br><br>  Die Erw√§hnung dieser 4 Schwachstellen in der Antwort der Kandidaten hatte direkten Einfluss auf ihre Punktzahl. <br><br>  Viel hing jedoch von der Qualit√§t der Antwort ab.  Erw√§hnung von M√∂glichkeiten zur Behebung der Situation, Anmerkungen zu zus√§tzlichen Faktoren, die die Durchf√ºhrbarkeit eines Angriffs beeinflussen, die Verwendung der richtigen Begriffe und die F√§higkeit, Ihre Gedanken zu strukturieren, Kommentare zu zus√§tzlichen Schw√§chen oder potenziellen Bedrohungen - all dies hat unser Herz erw√§rmt und zu einer Erh√∂hung der endg√ºltigen Bewertung gef√ºhrt. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Nr. 2.</font></strong>  <strong><font color="#cc0000">Jwt</font></strong> </h1><br>  Bei der Suche nach einer Webanwendung haben Sie festgestellt, dass die Anwendung ein JWT-Token als Berechtigung verwendet. <br><br>  Welche Sicherheitsbedenken sehen Sie, welche Art von √úberpr√ºfungen w√ºrden Sie durchf√ºhren? <br><br>  JWT-Token: <br><br><pre> <code class="plaintext hljs">eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6InNla2EiL CJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiRmFsc2UiLCJwYX Nzd29yZCI6IjFkMDBjYUgifQ.F7Y1mCAmg5-QFok-rkpLdwe8prCyiKsCyJ-3Z5f7luI</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Jobanalyse</b> <div class="spoiler_text">  Dan JSON Web Tokens (JWT). <br>  Seine Struktur -&gt; [base64url (HEADER)]. [Base64url (PAYLOAD)]. [Base64url (SIGNATURE)] <br>  [base64url (HEADER)] = eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0 <br>  base64url decode -&gt; {"alg": "None", "typ": "JWT"} <br>  Man kann sofort feststellen, dass der Signaturalgorithmus ("alg": "None") der Signatur nicht verwendet wird.  Einige JWT-Bibliotheken unterst√ºtzen den "none" -Algorithmus, dh den Signaturalgorithmus, nicht.  Wenn der Alg-Header "none" ist, f√ºhrt die Serverseite keine Signatur√ºberpr√ºfung durch. <br>  Das hei√üt, Sie k√∂nnen beliebige Nutzdaten in base64url schreiben, und die Signatur wird nicht √ºberpr√ºft. <br>  Dadurch k√∂nnen wir einen Benutzer mit Administratorrechten erstellen. <br><br>  Die Tatsache, dass der Nutzlastteil keine Header wie aud (definiert die Empf√§nger, f√ºr die das JWT-Token bestimmt ist) und exp (die Lebensdauer des Tokens) verwendet, vereinfacht unser Leben. <br><br>  Gesch√§tzte Nutzlast <br>  eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImhhY2siLCJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiVHJ1ZSIsInBhc3N3b3JkIjoiaGFjayJ9 <br><br>  base64url decode payload -&gt; {"sub": "1234567890", "name": "hack", "iat": 1516239022, "role": "Nobody", "isAdmin": "True", "password": "hack" ¬ª} <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expertenkommentar D:</b> <div class="spoiler_text"><blockquote>  In der Arbeit des Auditors muss er sich h√§ufig mit neuen Technologien auseinandersetzen, und die F√§higkeit, diese zu verstehen, ist sehr wichtig.  Wir haben diese Frage in den Fragebogen aufgenommen und sind davon ausgegangen, dass die meisten Kandidaten bis auf den Namen kaum von der Technologie der JWT-Token geh√∂rt haben.  Daher zielte diese Frage zun√§chst auf die F√§higkeit ab, Informationen aus √∂ffentlichen Quellen zu suchen und zu analysieren.  Infolgedessen k√∂nnte eine Person, die auf Anfrage von "JWT" ‚Äã‚Äãund "JWT-Schwachstelle" die Herausgabe von Google verpasst hat, zu folgenden Schlussfolgerungen kommen: <br><br>  1. Dieses Token verf√ºgt nicht √ºber einen Signaturalgorithmus, sodass ein Angreifer alle Felder innerhalb des Tokens √§ndern kann, was vom Konzept der JWT-Token nicht angenommen wird. <br><br>  2. Felder im Token enthalten das Kennwort des Benutzers im Klartext. Das Speichern solcher Informationen im Token ist mindestens eine schlechte Praxis.  In den meisten F√§llen k√∂nnen Sie eine solche Entscheidung ablehnen und dadurch Ihr Sicherheitsniveau erh√∂hen. <br><br>  3. Angesichts des Fehlens einer Signatur und unserer F√§higkeit, die Felder im Token zu √§ndern, ist es logisch anzunehmen, dass das √Ñndern des Werts von isAdmin unsere Berechtigungen auf Administratorrechte erh√∂hen kann. <br><br>  4. Eine weitere interessante Idee, die nur wenige in ihrer Antwort erw√§hnt haben, betrifft die Tatsache, dass Benutzereingaben in die Felder eines JWT-Tokens √ºbertragen werden k√∂nnen.  In einer normalen Situation kann ein Angreifer die Daten im Token in keiner Weise beeinflussen, was bedeutet, dass Entwickler die Einf√ºhrung zus√§tzlicher √úberpr√ºfungen im Code der Handler h√§ufig vernachl√§ssigen k√∂nnen.  Dies bringt die einfache Idee auf den Punkt: Versuchen wir jedoch, klassische Angriffe nicht √ºber GET / POST-Parameter, sondern √ºber Token-Felder durchzuf√ºhren.  Dies kann zu einem unerwartet guten Ergebnis f√ºhren.  Ein solch kreativer Ansatz mit der richtigen Begr√ºndung unseres Handelns wurde von uns bei der Bewertung dieses und anderer Probleme sehr gesch√§tzt. <br><br>  Viele Kandidaten haben in ihren Antworten kurz nacherz√§hlt, wie das JWT-Token aufgebaut ist und wo es verwendet wird. Es war f√ºr uns interessant zu lesen, und dennoch haben wir zun√§chst die Aspekte der Antwort in Bezug auf die Sicherheit bewertet. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Nummer 3.</font></strong>  <strong><font color="#cc0000">CORS / CSRF / IDOR / ???</font></strong> </h1><br><br>  In der Webanwendung wird das Benutzerkennwort mithilfe der folgenden Anforderung ge√§ndert (siehe Option 1).  Welche potenziellen Sicherheitsbedrohungen sehen Sie?  Welche Kontrollen w√ºrden Sie durchf√ºhren?  Wird sich die Situation bei folgendem Verhalten √§ndern (siehe Option 2)?  Erkl√§ren Sie Ihre Antwort. <br><img src="https://habrastorage.org/webt/mr/b-/se/mrb-seaadzkgqbmqvsq-zcqflyo.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Jobanalyse</b> <div class="spoiler_text">  <b>Variante 1.</b> <br>  "Welche potenziellen Sicherheitsbedrohungen sehen Sie?" <br><br>  1) Fehlende Zugangskontrolle. <br>  Wenn der Benutzer - eine Nummer, an die die Kennwort√§nderungsanforderung gesendet wird - nicht √ºberpr√ºft wird, kann das Kennwort f√ºr jeden registrierten Benutzer im System ge√§ndert werden. <br>  Wie zu beheben?  - √úbereinstimmende JSESSION aus der Datenbank und der angeforderten ID-Shnik. <br><br>  2) Die F√§higkeit, CSRF-Angriffe durchzuf√ºhren <br>  Wir locken einen autorisierten Benutzer zu einem von uns kontrollierten Host und nach einer Anfrage an example.com im Namen des Opfers, um das Passwort zu √§ndern. <br>  Wie zu beheben?  - Hinzuf√ºgen eines CSRF-Tokens. <br><br>  <b>Option 2</b> <br>  "Welche potenziellen Sicherheitsbedrohungen sehen Sie?" <br>  Ein Fehler in der CORS-Richtlinie. <br>  Es wird empfohlen, den Header Access-Control-Allow-Origin auf die Whitelist zu setzen. <br><br>  Wie zu beheben?  - - <br><br>  1) √Ñndern der .htaccess-Datei <br><br><pre> <code class="plaintext hljs">&lt;ifmodule mod_headers.c&gt; Header always set Access-Control-Allow-Origin: "https://whitelist.domain.ru" Header always set Access-Control-Allow-Methods "PUT" &lt;/ifmodule&gt;</code> </pre><br>  2) PHP <br><br><pre> <code class="plaintext hljs">&lt;?php header('Access-Control-Allow-Origin: ‚Äúhttps://whitelist.domain.ru‚Äù); header('Access-Control-Allow-Methods: PUT'); ?&gt;</code> </pre><br>  "Wird sich die Situation mit dem folgenden Verhalten √§ndern?" <br><br>  Ja  Da im zweiten Fall eine PUT-Anforderung verwendet wird, ist dies wichtig, da die Verwendung einer PUT-Anforderung die CORS-Anforderung ‚Äûschwierig‚Äú macht, was uns wiederum die M√∂glichkeit eines CSRF-Angriffs und das Fehlen eines Headers wie Access-Control-Allow-Credentials: true vollst√§ndig entzieht die M√∂glichkeit, mit anderen http-Headern und Benutzer-Cookies zu senden. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expertenkommentar I:</b> <div class="spoiler_text"><blockquote>  Betrachten wir der Reihe nach die Hauptprobleme, die bei den gegebenen Abfragen sichtbar sind: <br><br>  1) Da die numerische Kennung des Benutzers "10012" in der Anforderung beobachtet wird, besteht der erste Schritt darin, zu √ºberpr√ºfen, ob es m√∂glich ist, das Kennwort f√ºr einen anderen Benutzer zu √§ndern.  Kann es ausreichen <b>, die ID eines anderen anzugeben</b> ? <br>  Sicherheitsl√ºcken der IDOR-Klasse sind relativ einfach auszunutzen und weisen h√§ufig eine hohe Kritikalit√§t auf. <br><br>  2) Die Anforderung zum √Ñndern des Kennworts erfolgt √ºber die POST-Methode, das CSRF-Token wird nicht beachtet und der Inhaltstyp lautet "text / plain".  Es besteht die M√∂glichkeit <b>, eine solche Anfrage vorzut√§uschen.</b> <br><br>  Um das Passwort des Opfers zu √§ndern, reicht es daher aus, dass der Angreifer ihn davon √ºberzeugt, nur den "b√∂swilligen" Link zu besuchen. <br><br>  3) In den Antwortheadern zeigt der Server <b>die Version der verwendeten Software an</b> .  Dies kann auf einmal als Sicherheitsl√ºcke bezeichnet werden. Es ist jedoch besser, solche Banner auszublenden. Angreifer k√∂nnen leicht bekannte 1-Tages-Exploits finden, und der Wert der verwendeten Software vereinfacht die Planung weiterer Angriffe erheblich. <br><br>  4) Wir w√ºrden uns sehr √ºber den Satz "Was passiert, wenn wir <b>das Datenformat von JSON auf XML √§ndern</b> ?" <br><br>  Tatsache ist, dass moderne Frameworks intelligent und alles fressend sind und Daten in verschiedenen Formaten verarbeiten k√∂nnen.  Und beim Parsen von XML ist h√§ufig eine gef√§hrliche XXE-Sicherheitsanf√§lligkeit zul√§ssig.  Mit seiner Hilfe kann der Eindringling in das interne Netzwerk "gehen", Konfigurationsdateien vom Server lesen und gelegentlich RCE ausf√ºhren. <br><br>  5) Ich wollte auch eine Bemerkung wie "Warum <b>wird das Wissen des Alten</b> beim √Ñndern des Passworts <b>nicht √ºberpr√ºft</b> ?" <br><br>  F√ºr "Variante Nr. 2" gibt es eine "Falle" - hier werden CORS-Header verwendet, und der Inhaltstyp der Anforderung ist bereits auf "application / json" gesetzt. <br><br>  Der Fehler, den die √ºberwiegende Mehrheit der Kandidaten gemacht hat, ist die Antwort auf das Formular "- Das ist das Sternchen in Allow-Origin, was bedeutet, dass Sie Anfragen von jeder Site aus senden k√∂nnen!" <br><br>  Nein, geht nicht.  Erstens fehlt der Header Allow-Credentials: True. Dies bedeutet, dass der Browser die Anforderung "mit Cookies" ausf√ºhren sollte, damit die Anforderung ohne Sitzung anonym bleibt.  Und zweitens w√ºrde der Browser selbst dann, wenn ein solcher Header vorhanden w√§re, das Senden von Cookies verbieten - nur wegen des "Sternchens".  Ihre Kombination ist verboten und der Browser wird ignoriert. <br></blockquote></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Nummer 4.</font></strong>  <strong><font color="#cc0000">Netzwerk-Dump</font></strong> </h1><br>  Stellen Sie sich vor, Sie sind in das interne Netzwerk des Unternehmens eingetreten und haben den Datenverkehr abgefangen, dessen Speicherauszug unten angeh√§ngt ist.  Beschreiben Sie, welche Angriffe Sie mit welchen Tools ausf√ºhren m√∂chten. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Speicherauszug</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">yadi.sk/d/qkLcfwSCzdxcwg</a> <br><br><div class="spoiler">  <b class="spoiler_title">Jobanalyse</b> <div class="spoiler_text">  1) LLMNR-Spoofing &lt; <br>  Ein Angreifer im lokalen Subnetz kann Broadcast-Nachrichten abh√∂ren und darauf antworten und behaupten, der angeforderte Hostname sei seine eigene IP-Adresse. <br>  Dies f√ºhrt dazu, dass der anfordernde Client-Computer mit dem Computer des Angreifers verbunden ist und je nach Protokoll m√∂glicherweise versucht, sich zu authentifizieren. <br><br>  Die verwendeten Dienstprogramme sind Intercepter-NG, ein Projekt auf githab VindicateTool. <br><br>  2) HSRP-Missbrauch. <br>  Problematisch - Wenn der Parameter "preempt" auf 1 gesetzt ist, hat der Angreifer aufgrund der h√∂heren Priorit√§t die M√∂glichkeit, andere Router zu "verdr√§ngen".  Nach dem Senden von HSRP an den Multicast wird der gesteuerte Router zum Hauptrouter (Active Router) im Netzwerk, und der gesamte Datenverkehr wird durch ihn geleitet.  Tats√§chlich kamen wir zur Implementierung von Mitm-Angriffen. <br><br>  F√ºr diesen Angriffsvektor m√ºssen wir die Gruppe und das Passwort kennen. <br>  Aus dem uns gegebenen Verkehrsdump erkennen wir die Gruppe (es ist - 3) und das Passwort.  Das Passwort in unserem Fall ist Standard - Cisco. <br><br>  Verwendete Dienstprogramme sind Yersinia, Scapy. <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Kommentar von Experte X:</b> <div class="spoiler_text"><blockquote>  Ziel der Frage war es, die Vertrautheit des Auszubildenden mit modernen (und nicht so) Techniken zur Durchf√ºhrung von MitM-Angriffen zu ermitteln.  Schauen wir uns m√∂gliche Szenarien an, die auf einem vorhandenen Verkehrsdump basieren: <br><br>  <b>1) ARP-Spoofing</b> <br>  ARP-Spoofing ist der √§lteste und einfachste Weg, MitM-Angriffe zu implementieren.  Es besteht darin, eine kostenlose ARP-Anfrage an Host A zu senden. <br><br>  Die IP-Adresse von Host B ist die IP-Adresse, und unsere MAC-Adresse ist die MAC-Adresse.  Mit einer solchen Anforderung k√∂nnen Sie die ARP-Tabelle auf Host A √§ndern und sie dazu zwingen, Anforderungen an unser Ger√§t zu senden, wenn Sie versuchen, Host B zu kontaktieren. Host B ist normalerweise das Standard-Gateway. <br><br>  Empfohlene Tools: Bettercap, Arpspoof <br><br>  <b>2) LLMNR, NBNS-Spoofing</b> <br>  Link-Local Multicast Name Resolution und NetBIOS Name Service sind die Protokolle, die zum Aufl√∂sen von Hostnamen im lokalen Netzwerk verwendet werden.  Im Gegensatz zum DNS-Protokoll gibt es keinen dedizierten Server, auf dem alle Informationen gespeichert sind. Stattdessen wird die Anforderung an alle Hosts im Netzwerk gesendet. Wenn der Hostname in der Anforderung mit dem Hostnamen des Ger√§ts √ºbereinstimmt, wird eine Antwort gesendet. <br><br>  Wie in der Antwort richtig vermerkt, kann der Angreifer auf solche Anfragen antworten, indem er seine IP-Adresse in der Antwort sendet. Dies f√ºhrt dazu, dass das Opfer in Zukunft das Ger√§t des Angreifers anstelle des Ger√§ts kontaktiert, dessen Hostname in der Anfrage enthalten ist.  Dar√ºber hinaus kann der Angreifer vom Opfer eine NTLM-Authentifizierung anfordern, wodurch das Ger√§t des Opfers einen NTLM-Hash sendet, der f√ºr Brute Force weiter verwendet werden kann. <br><br>  Empfohlene Tools: Responder <br><br>  <b>3) WPAD-Spoofing</b> <br>  WPAD-Spoofing kann auf einen Sonderfall von LLMNR- und NBNS-Spoofing zur√ºckgef√ºhrt werden.  Das Auto Proxy Auto Discovery-Protokoll wird verwendet, um einen HTTP-Proxyserver automatisch zu konfigurieren. <br><br>  Das Ger√§t sendet eine LLMNR / NBNS-Anforderung mit dem wpad-Hostnamen, empf√§ngt die entsprechende IP-Adresse und versucht, √ºber HTTP auf die Datei wpad.dat zuzugreifen, in der Informationen zu den Proxyeinstellungen gespeichert sind. <br><br>  Infolgedessen kann der Angreifer LLMNR / NBNS-Spoofing durchf√ºhren und dem Opfer seine Datei wpad.dat zur Verf√ºgung stellen. Infolgedessen wird der gesamte HTTP- und HTTPS-Verkehr durch den Angreifer geleitet. <br><br>  Empfohlene Tools: Responder, mitm6 <br><br>  <b>4) Router-Werbung</b> <br>  Wie Sie dem Speicherauszug entnehmen k√∂nnen, gibt es im Netzwerk Ger√§te mit aktiviertem IPv6.  W√§hrend Sie sich im Netzwerk befinden, k√∂nnen Sie versuchen, Nachrichten an die IPv6-Router-Ank√ºndigung des Opfers zu senden, um das Standard-Gateway oder den DNS-Server zu √§ndern. <br><br>  RA-Nachrichten (Router Advertisement) sind Teil des SLAAC-Mechanismus (Stateless Address Autoconfiguration), der erforderlich ist, um IPv6-Adressen in einem Netzwerk automatisch zu erhalten, ohne einen DHCPv6-Server zu verwenden oder in Verbindung damit.  Dies wird erreicht, indem regelm√§√üig Multicast-RA-Nachrichten an den Router gesendet werden, die die Standard-Gateway-Adresse, das Netzwerkpr√§fix, die DNS-Serveradresse und das Dom√§nenpr√§fix enthalten. <br><br>  Empfohlene Tools: Rohpaket <br><br>  <b>5) DHCP-Spoofing</b> <br>  In einem Speicherauszug werden DHCP-Erkennungsanforderungen von demselben Ger√§t in einigen Intervallen wiederholt.  Sie k√∂nnen Schlussfolgerungen zum Fehlen eines DHCP-Servers in diesem Netzwerk ziehen und auf die n√§chste Erkennungsanforderung antworten, indem Sie das Opfer als Standard-Gateway zum Ger√§t angeben. <br><br>  Empfohlene Werkzeuge: Yersinia <br><br>  <b>6) HSRP-Spoofing</b> <br>  Au√üerdem k√∂nnen HSRP-Pakete im Speicherauszug angezeigt werden.  Das Hot Standby Router Protocol kann die Verf√ºgbarkeit von Routern erh√∂hen, die als Standardgateway fungieren.          IP-,     -.   Hello -        ,           .           HSRP, ,      ,      HSRP         . <br><br>  : Yersinia <br><br> <b>7) STP-</b> <br> Spanning Tree Protocol      L2-  .    BPDU-,           ,     .          BPDU-,   ,   ,    ,    ,         ,   ,   ,     STP,    ,    . <br><br>  : Yersinia <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ5. NGINX config</font></strong> </h1><br><br>    - nginx.  ,       ? <br><br> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pastebin.com/nYp7uVbB</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   nginx,          : <br> 1)  86 ,   http  X-Managed      secured,  nginx     /management/ <br> 2)        API  70  105 . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  J:</b> <div class="spoiler_text"><blockquote>        ,          .   nginx    ,     web-,       nginx    web-  /.           nginx ,  , ,     . <br><br> ,     ,   ,            .      ,         . ,    ,     . <br><br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gixy</a> . <br><br> Gixy  4    : <br><br> <b>1) Alias travesal:</b> <br><br>   80     : <br><br><pre> <code class="plaintext hljs">location /static { alias /prod_static/; }</code> </pre><br>     - ,    .  : //host/static../etc/passwd.   -     alias:     ,   /static,   /prod_static/,       : /prod_static/../etc/passwd,      /etc/passwd.    alias traversal  <a href=""></a> <br><br> <b>2) Http Splitting (CRLF injection)</b> <br>    nginx  ,   ,        .       HTTP-. <br> : <a href="https://github.com/yandex/gixy/blob/master/docs/ru/plugins/">github.com/yandex/gixy/blob/master/docs/ru/plugins/httpsplitting.md</a> <br><br> <b>3)   -   </b> <br>   75      ¬´rigin¬ª   .    , -       , ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">production.host.evil.com</a> . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/origins.md</a> <br><br> <b>4)     add_header</b> <br>  nginx  :      add_header,       , ,    ,  .      CSP      . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/addheaderredefinition.md</a> <br><hr><br>  ,   gixy,          .       : <br><br> 1)   17     <b>default_type   text/html.</b>     :   ,     ,  nginx    Content-Type,    default_type.   ,         Content-Type: text/html.            HTML-  ,   , , XSS-   . <br><br> <b>2)    POST-</b> <br>  29-30   ,           .  ,   ‚Äú‚Äù POST-.       . !       SSRF  ,     ,   ,     , . <br><br> <b>3)   php-fpm</b> <br>   48  ,  FastCGI-    unix ,    9000.  ,    ,   .   ,      PHP-. <br><br> <b>4) ‚Äú‚Äù CSP</b> <br>  production.host  Content-Security-Policy,    Javascript,    . <br><br> <b>5) ‚Äú‚Äù CORS</b> <br>   76-77   CORS,          ,       cookie  . <br><br> 6)     ,   86   <b>  </b>  .       secured     /managed. <br><br> 7)      ,    ,        ,    -. ,   ,  ,    /user/{userid}  IDOR. <br><br>   ,       ,    ,     . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ6. Linux Permissions</font></strong> </h1><br>     Linux      ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">  ~ ()  Debian <br> C              ( ,      /etc/passwd). <br> ,      ftp  ,     ~. <br><br> : <br> * root@server:~# ls ~ftp <br> * welcome.msg <br>      : <br> * root@server:~# cat ~ftp/welcome.msg <br> * Welcome, archive user %U@%R! <br>   ,    :      : <br> * root@amorale:~# echo ~ftp <br> * /srv/ftp <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>    ,        : <br><br><ul><li>       </li><li>  ACL      </li><li>    </li><li>      </li><li>  capabilities </li></ul><br>   ,      ,   : <br> ‚Äú ,   root‚Äù   . <br><br>      ,     <code>Linux/Unix</code> . <br>    ,        ‚Äú ‚Äù ‚Äî           . <br>   ,     ,    <code>funky_test.txt</code>      <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br> ,    Linux/Unix   : <br><br><ul><li>  - ‚Äî    ‚Äúrwx‚Äù  alice </li><li>   ‚Äî    ‚Äúrw‚Äù   interns </li><li>    ‚Äî    ‚Äúrx‚Äù  others </li></ul><br>          <code>read, write, execute</code> . <br><br> ,     ‚Äî       ,      : <br><br><ul><li>    ,      read </li><li>    ,      read </li><li>     read </li></ul><br>  ,       <code>read</code>            .      ,      execute  . <br><br>            ,    . <br><br>          , ,    .      : <br><br> 1.          ,       ls. <br><br> 2.      ‚Äî <code>POSIX Access Control Lists</code> . <br><br><h4>    c   . </h4><br><h6>  1 </h6><br> ,   <code>alice</code>     <code>interns</code> .      <code>funny_test.txt</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami alice $ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied $</code> </pre><br><h5>  2 </h5><br>   ‚Äî   <code>funky_test.txt</code>  604.    <code>bob</code> ,    <code>interns</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami bob $ id uid=1002(bob) gid=1003(bob) groups=1003(bob),1002(interns) $ ls -la funky_test.txt -rw----r-- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied</code> </pre><br><h5>  </h5><br>    <code>alice</code>       ,  .  , <code>permission_denied</code>    : <br><br><pre> <code class="plaintext hljs">$ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ chmod 777 funky_test.txt $ ls -la funky_test.txt -rwxrwxrwx 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt secret_pass</code> </pre><br>      bob    . <br><br><h5>  Warum so </h5><br>    ,          ¬´  ¬ª,  : <br><br><ul><li>  ID      <code>effective UID</code> ‚Äî      </li><li>  GID        <code>effective GID</code> ‚Äî      </li><li>      others. </li></ul><br><h5>   </h5><br>  ,      ‚Äî   ,       ‚Äú‚Äù    ,        ,    , : <br><br><ul><li>    ,   ,          <code>others</code>     </li><li>   ,     ,   <code>others</code>     </li></ul><br>           . <br><br><h4> POSIX Access Control Lists </h4><br>      ‚Äî         /.   ,     ACL,  ,       ‚Äú <code>+</code> ‚Äù <br><br>      POSIX ACLs,    ‚Äî     ,            .      ACL,        . <br><br><h5>  Beispiel </h5><br>   .        <code>alice</code>   <code>funky_test.txt</code>  ,   <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br>      ACL.  <code>getfacl</code> , ,    ACL,   ,     <code>ls</code> . <br><br><pre> <code class="plaintext hljs">$ getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx group::rw- other::rx</code> </pre><br>   , ACL        .  ,     bob  : <br><br><pre> <code class="plaintext hljs">setfacl -mu:bob:rwx funky_test.txt</code> </pre><br>       ‚Äú <code>+</code> ‚Äù   <br><br><pre> <code class="plaintext hljs">ls -l funky_test.txt -rwxrwxr-x+ 1 alice interns 12  4 13:00 funky_test.txt</code> </pre><br>     : <br><br><pre> <code class="plaintext hljs">getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx user:bob:rwx group::rw- mask::rwx other::rx</code> </pre><br>  ACL     .  : <br><br><ol><li>     .      <code>effective UID</code>  <code>effective GID</code>  ‚Äî  .        ,       ACL,       .  ,     ,   ,  ,         ,    . </li><li>   ACL  <code>mask</code> ,      ACL    <code>owner, group, others</code> </li></ol><br><h5>   </h5><br>  ,         ,  ,     ‚Äî      . <br><br>   ,  ACL,     , : <br><br><ul><li>        ACL,     ; </li><li>   ,         ACL,     . </li></ul><br></blockquote></div></div><br><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ7. Network Dump II</font></strong> </h1><br>            .  ,        ,   ,       . <br><br>  : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">yadi.sk/d/e3gNme4MBo6tFQ</a> <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text">   ‚Äî      . <br>      ,     . <br>   ,     . <br><br><img src="https://habrastorage.org/webt/2t/zn/ip/2tznipywtpqwalr5drvxxr4z0sw.png"><br><br>   ,     SMB-,  ,    ,       .       SMB object list (File -&gt; Export objects -&gt; SMB‚Ä¶ ). <br><br>    ‚Äî     . <br><br><img src="https://habrastorage.org/webt/fe/rt/xy/fertxyt0du3kv3qwcmivz1m6opg.png"><br> <i>(  SMB object list)</i> <br><br><img src="https://habrastorage.org/webt/xo/yd/t-/xoydt-qmcbddrx1lkoqmpplyslg.png"><br> <i>(NotTruePass.jpg)</i> <br><br>     . <br><br>        ‚Äú‚Äù    TCP-‚Ä¶     .    .  :( <br><br>    ,        .    . <br><br><img src="https://habrastorage.org/webt/fd/ch/fc/fdchfcsbkrwxmx08ltr_1qnoozg.png"><br> <i>(  desktop.ini)</i> <br><br>     ‚Äú‚Äù     . ,      NTLM,   ,  ,  NTLM      ‚ÄúPass-the-hash‚Äù.               ¬´-¬ª. <br><br>     ‚Äú‚Äù    : <br><br><pre> <code class="plaintext hljs">1)User - 1 Account: IEUser Domain: WIN7 Host: WIN7 hex dump session key - 49 0c 38 3e f8 eb 63 88 79 0f 62 84 09 84 d2 dc 2) User - 2 Account: winwin Domain: WIN7 Host: WIN7 hex dump session key - 8d f6 1b 35 79 a3 78 d3 2e 81 09 f1 95 4f 71 0a 3) User - 3 Account: 192.192.192.29 Domain: WIN7 Host: WIN7 hex dump session key - c3 19 e0 21 1b e2 63 c6 03 9e e7 38 1b 56 f0 d1</code> </pre><br>            .       MSEDGEWIN10. <br><br>    ‚Äî     : <br><br> 1) SMB Relay. <br>           . <br>      ,   MITM- <br> (.             ). <br><br>      ‚Äî        ,      ,  . <br>      .       ,       . <br><br>    ,  ,  ,     . <br><br> 2) NTLM Relay. <br>         ,  NTLM-. <br><br>         ,   NTLM-. <br><br>          . <br>     ,     ,  ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  K:</b> <div class="spoiler_text"><blockquote>   ,  ,    : <br><br><ol><li>    (    ) </li><li>        ‚Äî / </li><li>      ,       </li></ol><br>       ,        : <br><br><ol><li>     </li><li>     </li><li>     </li></ol><br>     Wireshark,    <code>Protocol Hierarchy Statistics</code>  <code>Conversations</code> . <br><br> <code>Protocol Hierarchy Statistics</code> ‚Äî           . <br><br><img src="https://habrastorage.org/webt/_3/sy/co/_3sycoln1juvmnzbdlzrug24fgq.png"><br><br> Conversations ‚Äî   ,         . <br><br><img src="https://habrastorage.org/webt/31/xp/r7/31xpr7rmhyghnrctn3acyznwa9w.png"><br><br><img src="https://habrastorage.org/webt/rw/21/_d/rw21_dwv4digkin6kodypnfpl2w.png"><br><br>       : <br><br><ol><li>    (60%) ‚Äî  TCP, ,  , SMB.   Protocol hierarchy  SMB  40%,        TCP,     ,     20%      SMB. </li><li>      192.192.192.128  192.192.192.129.   SMB      . </li></ol><br> <b>  </b> <br><br>    . <br><br>        ‚Äî     SMB. <br><br>        ,    ‚Äî     wireshark ‚Äî  <code>ExportObject</code> . <br>              <code>tcp stream</code> .     ,     ,    <code>tcp stream</code> ,            .           ,      . <br><br>    , ,     ,     ,     .  ,         . <br><br> <b>  .</b> <br>     SMB       . <br><br>    NTLM-     ‚Äúntlmssp‚Äù.    <code>info</code> ,  3    : <br><br><img src="https://habrastorage.org/webt/mm/gn/pj/mmgnpjekpvddsd1f6vdx5ih8hec.png"><br><br> ,        . <br><br><img src="https://habrastorage.org/webt/rk/ix/7m/rkix7mvmxaaxs09m0vvazlblvco.png"><br><br><img src="https://habrastorage.org/webt/tx/zc/hc/txzchc1u7ufdzoqkjxtnrnsvfd0.png"><br><br><img src="https://habrastorage.org/webt/pd/hg/vd/pdhgvdcc_obs9smchhmwidqmawy.png"><br><br>          Net-NTLMv2-,  : <br><br><ul><li> challenge  </li><li> response  </li><li>   </li></ul><br>  <code>Net-NTLMv2</code>       <code>hashcat</code> . <br><br> ,        <code>WIN7\winwin</code>  <code>WIN7\192.192.192.129</code> ‚Äî      ,          .    <code>WIN7\IEUser</code> ‚Äî ,       ,  ,  ,   ,  SMB. <br><br>  <code>Net-NTLM</code>   ,   ,    Wireshark.    ,  PCredz (https://github.com/lgandx/PCredz) <br><br><img src="https://habrastorage.org/webt/jd/gn/zj/jdgnzjzb6pgscawu43bxtf5wc0y.png"><br><br>     <code>IEUser</code> (   )     hashcat. <br><br><img src="https://habrastorage.org/webt/ky/i6/gf/kyi6gfki84pqjj4fgjximusk9qa.png"><br><br> <b>     ,      .</b> <br><br>        6,   ,   <code>SMB/NTLM</code> , <code>DNS</code> . <br><br> ,      ,    <code>NT</code>  <code>LM</code>  <code>NTLMv1 (Net-NTLMv1)</code> , <code>NTLMv2 (Net-NTLMv2)</code> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     </a> ). <br><br> -    <code>NT</code>  <code>LM</code>  <code>NTLM</code> ,         <code>NTLM</code>  <code>NTLMv1</code>  <code>NTLMv2</code> . ,           .    . <br><br>     ,  <code>NTLMv1/NTLMv2</code> ‚Äî    challenge-response .        ,    . <br><br>  NT  LM ‚Äî   ‚Äú  ‚Äù ‚Äî        . <br><br>      : <br><br><ul><li> PassTheHash ‚Äî ,        ,     .  Aber.     ,  <code>NT</code> .  PassTheHash  NTLMv2  ‚Äî   .        ,      ‚Äú‚Äù  ,       ,    . </li><li> NTLM Relay ‚Äî ,        ,     NTLM.      ,    . </li><li> Spoofing,     Windows: LLMNR, NetBios </li><li>     : MS17-010,    /  ,   . </li></ul><br> <b></b> <br><br>     : <br><br><ul><li>    ( ) </li><li>       </li><li>       ,           </li><li>            eternalBlue </li><li>  NTLM relay </li><li>   NTLM relay    ‚Äî   SMB </li><li>       </li><li>   ,     (ARP-spoofing,  DNS   )  </li></ul><br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ8. SSH Pivoting Tricks</font></strong> </h1><br><img src="https://habrastorage.org/webt/ui/gy/a1/uigya1oqcd1poeuc6whph79ehzw.png"><br>      (10.0.10.0/24),      SSH  Linux- (10.0.20.5)    (10.0.20.0/24).   ,         .     ,         ,     //  Linux-. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> ,    ,   : <br>    <br> nmap      <br><br>    ? <br><br> : <br><br> 1)  ping. <br>  -&gt; ping -b 10.0.20.255 <br>  ping  ,     ,    . <br>    ,               . <br>           . <br> ,     CentOS 7. <br>        . <br><br><img src="https://habrastorage.org/webt/7y/vu/rn/7yvurntbjwgei1q8rr6yth0kjww.png"><br> <i>(  )</i> <br><br>    ,           .  :( <br><br><img src="https://habrastorage.org/webt/nd/r1/jc/ndr1jchof8-_rzbgh-ru1xg7vh0.png"><br><br> 2)   ARP-  . <br>  -&gt; <br>  Debian ‚Äî arp-scan --interface=/* */ 10.0.0.0/16 <br>  Linux      arp,    ( Debian) -   ,      arp-scan. <br> arp-scan,   ,      ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">  KryaKrya:</b> <div class="spoiler_text"><blockquote>       ,           ,  ,      Pivoting.      ,      ,   ,          ,      ,          . <br><br> ,       ping    ,  ARP- (arp -a),    (route).   ,     netcat (nc -h),  ,      (nc -vnz 10.0.20.3 0-1000).    ,      ,        , , ,   ,   -     bash,   python      . <br><br>     ‚Äî    SSH-,   SOCKS-  SSH,          . <br> ssh -D 1337 user@10.0.20.5 -f -N <br><br>            .     nmap  SOCKS-   proxychains    . <br><br> proxychains nmap 10.0.20.0/24 <br> nmap 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br>     nmap       - SOCKS-.     SYN- ( nmap    )  SOCKS-,  SOCKS-    TCP-   ,  SYN-      ,    SYN,    SYN ACK.      CONNECT- (-sT),  nmap      SOCKS-. <br><br> nmap -sT 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br> ,    -  ,         ,        . ,       Linux-,   nmap  -sT  ,     ,     ,      ,    ,    ,        . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ9. Android SSL pinning bypass</font></strong> </h1><br>      Android.  ,        HTTPS. <br><br> 1) ,           HTTP . <br><br> 2)  ,      SSL-pinning,        ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> ¬´,           HTTP-.¬ª <br><br>        . <br>        proxy host   wifi. <br><br>  Android     ,  ,      . <br><br>  ‚Äî    (  )   ‚Äî   ( ,  ). <br>  ,      MITM,   Android 6.0,      ,     . <br><br>       6.0,         . <br><br> ¬´ ,      SSL-pinning,        ?¬ª <br><br>  ,    SSL-pinning. <br><br> SSL-pinning ‚Äî   ,    ,   ¬´¬ª      . <br><br>        HTTPS-,   ,  ¬´¬ª.      ,       . <br><br>   ,      MITM-,    . <br><br>   ,      ,     ,       . <br><br>   ‚Äî  Frida. <br> Frida ‚Äî    Dinamic Instrumentation Toolkit,    ,         . <br> , Frida        Javascript. <br>       Frida     ,    , ,  ¬´True¬ª  ¬´False¬ª,     . <br><br>     Frida: <br><br> 1.      ,      .      -. <br><br> 2.      Frida.        Root. <br><br>      . <br>  APK-           .  ,       ,      . <br>      .     apk  META-INF    . <br><br> ‚Äú‚Äù APK-. <br>       APK   smali   Java,     ,     . <br>     ,    ,     . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">  I:</b> <div class="spoiler_text"><blockquote> ,     MITM HTTPS       . <br><br>      ,       Proxy   WiFi.      ProxyDroid,    iptables  . <br><br> ,      Root ,         , ? <br><br>    SSL-Pinning,    , ,  ‚ÄúFrida+Objection‚Äù. ,           :) <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000">‚Ññ10.    ?</font></strong> </h1><br>          ,       . <br><br>    ‚Äú ‚Äù. ,      ,  dns-rebinding. <br><br>     .  Vielen Dank f√ºr Ihre Aufmerksamkeit! <br><br><hr><br> <b>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Digital Security</a></b> <br><br>    ,       . <br>       3  (  -      ).      0  5        2.5,   3.1337. <br><br>      .  ,     50 .        ,          ‚Äú <i>   </i> ‚Äù   -   ) <br><br>         .      29 ,     43.5.         24%    . <br><br>    : <br><br><img src="https://habrastorage.org/webt/fn/iq/fb/fniqfb7brnsnuqx08am8vx7xmtq.png"><br><br> ,         ,       ,    ,     ,              .    ,       ,     .         . <br><br>  ,     , ,  ,                  . <br><br> ,  ,          : <br><br><img src="https://habrastorage.org/webt/wn/z_/p9/wnz_p90qafczlytjrpuddurwkbc.jpeg"><br><br>          (  !),    ,          ,   ,         ‚Äú ‚Äù. <br><br>             -     ,        ,        . ,        ,   Summer of Hack 2019. <br><br>     ,                 .                    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461077/">https://habr.com/ru/post/de461077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461067/index.html">Die 65 wichtigsten SQL-Fragen aus Vorstellungsgespr√§chen, auf die Sie 2019 vorbereitet sein sollten. Teil I.</a></li>
<li><a href="../de461069/index.html">Nobel-IP-Au√üenkameras: Tests, Technologien und Funktionen von Ivideon-Video√ºberwachungssystemen</a></li>
<li><a href="../de461071/index.html">Optimierung von Datenbankabfragen am Beispiel eines B2B-Service f√ºr Builder</a></li>
<li><a href="../de461073/index.html">Wir verbinden Online-Karten mit dem Navigator auf dem Smartphone. Teil 3 - OverpassTurbo</a></li>
<li><a href="../de461075/index.html">Business Intelligence. IT-Objekte, Komponenten, Tools</a></li>
<li><a href="../de461079/index.html">Stadt ohne Stau</a></li>
<li><a href="../de461081/index.html">Der Tag, an dem Dodo aufgeh√∂rt hat. Asynchrones Skript</a></li>
<li><a href="../de461083/index.html">Schreiben von Software mit der Funktionalit√§t von Client-Server-Dienstprogrammen Windows, Teil 02</a></li>
<li><a href="../de461085/index.html">Wechseln Sie die Sprache in der Android App</a></li>
<li><a href="../de461087/index.html">Dungeons und H√∂hlen f√ºr mein Spiel generieren</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>