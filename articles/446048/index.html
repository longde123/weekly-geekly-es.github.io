<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÇ üêå ü§±üèΩ La uni√≥n de Arduino y el procesador cl√°sico. üë©üèª‚Äç‚öñÔ∏è üï¥üèº üåØ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las retrocomputadoras vienen en diversos grados de meticulosidad. Algunos est√°n contentos con la emulaci√≥n. Otros prefieren FPGA, porque resulta que n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La uni√≥n de Arduino y el procesador cl√°sico.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446048/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ol/8r/yr/ol8ryrltwjene6e2frje_pacnti.jpeg"></div><br>  Las retrocomputadoras vienen en diversos grados de meticulosidad.  Algunos est√°n contentos con la emulaci√≥n.  Otros prefieren FPGA, porque resulta que no es emulaci√≥n, sino recreaci√≥n.  Finalmente, sirva el tercer procesador. <br><br>  ¬°Pero el procesador necesita mucho para funcionar!  Nuevamente, el dilema: ¬øtomar chips reales de los mismos a√±os, o poner todo en el FPGA, dejando el procesador afuera?  Sin embargo, ¬øpor qu√© es necesario FPGA?  ¬°Viva la uni√≥n del Arduino y el procesador cl√°sico! <a name="habracut"></a><br><br>  Dale a tu Arduino un "segundo cerebro" y hazlo m√°s inteligente. <br><br>  Un verdadero microprocesador de ocho bits ejecuta programas, mientras que un Arduino emula ROM, RAM y perif√©ricos simples. <br><br>  Dise√±e perif√©ricos virtuales en Arduino IDE y ejecute el c√≥digo del ensamblador en el microprocesador.  No es necesario ensamblar circuitos complejos y flashear ROM paralelas. <br><br>  Microprocesadores compatibles: 6502, 6809 y Z80 (18581), otros est√°n en camino. <br><br>  Una pantalla con un microprocesador no interfiere con la conexi√≥n de otras pantallas: con pantallas LCD, tarjetas de memoria, etc. <br><br>  Adem√°s del lenguaje de autoensamblaje, puede intentar ejecutar alg√∫n c√≥digo cl√°sico en el microprocesador. <br><br>  Es cierto que el microprocesador funcionar√° a una frecuencia muy baja, aproximadamente 95 kHz, su valor exacto depende de la optimizaci√≥n del c√≥digo de emulaci√≥n perif√©rica. <br><br>  La distribuci√≥n del espacio de direcciones se establece mediante programaci√≥n en un boceto.  El microprocesador se puede asignar de 4 a 6 kB de 8 kB de RAM disponible en el Arduino Mega.  ROM puede asignar m√°s de 200 kB de los 256 disponibles. <br><br>  El puerto serie Arduino Mega puede emular UART. <br><br>  Los circuitos, los dibujos de la placa, los archivos Gerber est√°n disponibles en CC-BY-SA 4.0 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Al mismo tiempo, hay un requisito para adjuntar el archivo README.md, porque contiene la siguiente advertencia: <br><blockquote>  ¬°No conecte el escudo hasta que se cargue el boceto de emulaci√≥n perif√©rica!  De lo contrario, es posible acortar las l√≠neas de salida del microprocesador. </blockquote>  S√≠, y en el boceto en s√≠, algo debe rehacerse cuidadosamente por la misma raz√≥n. <br><br>  El esquema del dispositivo en 6502: <br><br><img src="https://habrastorage.org/webt/e0/n8/6k/e0n86kpozlcttklifjihnl51quo.png"><br><br>  El esquema del dispositivo en 6809: <br><br><img src="https://habrastorage.org/webt/qf/yi/kx/qfyikx1tktdjuad0hocivlpsolw.png"><br><br>  Esquema del dispositivo en el Z80: <br><br><img src="https://habrastorage.org/webt/ct/uh/qs/ctuhqskjmmp1rvxrhs8abcoqvne.png"><br><br>  Ya puedes ejecutar: <br><br>  En un dispositivo con 6502 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Apple I, Woz Monitor + ROM con BASIC</a> <br><br>  En un dispositivo con 6809: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un an√°logo de una computadora hecha en casa Simon6809 del mismo desarrollador, un monitor de entrenamiento con ensamblador y desensamblador</a> <br><br>  En un dispositivo con Z80, hasta ahora solo una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">prueba de eco del puerto serie</a> , lo que le permite verificar el rendimiento del 8251 virtual (KR580VV51A). <br><br>  Firmware para emular perif√©ricos: bajo la licencia MIT. <br><br>  Breves descripciones del principio de acci√≥n: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Al dispositivo 6502</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Al dispositivo en 6809</a> <br><br>  Al dispositivo en el Z80 - en preparaci√≥n. <br><br>  El desarrollador est√° tratando de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vender</a> dispositivos, pero con entrega solo en los Estados Unidos.  No hay una raz√≥n particular para comprar, ya que el esquema es muy simple, puede repetirlo en un pedazo de la placa en una hora. <br><br>  Se planea desarrollar tableros similares en RCA1802, 68008, 8085 (182185), 8088 (181088).  Acerca de K1801BM1 no se dice, pero puede arrojar esa idea al autor. <br><br>  Archivos: <br><br>  Al dispositivo en 6502: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instrucciones de montaje</a> , <a href="">serigraf√≠a</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diagrama</a> <br><br>  Al dispositivo en 6809: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instrucciones de montaje</a> , <a href="">serigraf√≠a</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diagrama</a> <br><br>  Al dispositivo en Z80: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instrucciones de montaje</a> , <a href="">serigraf√≠a</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">diagrama</a> <br><br>  Considere la interacci√≥n del Arduino y el dispositivo 6502. El Arduino cambia peri√≥dicamente el nivel en la entrada del microprocesador, dise√±ado para suministrar pulsos de reloj, de cero a uno y viceversa.  En cada ciclo, verifica lo que sucede en las l√≠neas de control y el bus de direcciones y, seg√∫n la situaci√≥n, lee la informaci√≥n del bus de datos o la env√≠a all√≠.  Arduino tambi√©n puede controlar las l√≠neas IRQ y NMI, causando interrupciones.  La figura muestra los tipos de datos y las direcciones de su transmisi√≥n: <br><br><img src="https://habrastorage.org/webt/tr/in/je/trinjeibi9cwwrngfq628lm4yns.png"><br><br>  La correspondencia de los puertos Arduino y las salidas del microprocesador se configura en el boceto: <br><br><pre><code class="plaintext hljs">/* Digital Pin Assignments */ #define DATA_OUT PORTL #define DATA_IN PINL #define ADDR_H PINC #define ADDR_L PINA #define ADDR ((unsigned int) (ADDR_H &lt;&lt; 8 | ADDR_L)) #define uP_RESET_N 38 #define uP_RW_N 40 #define uP_RDY 39 #define uP_SO_N 41 #define uP_IRQ_N 50 #define uP_NMI_N 51 #define uP_E 52 #define uP_GPIO 53</code> </pre> <br>  Dividiremos cada medida en los siguientes eventos: <br><br>  CLK cambia el estado de uno a cero (disminuci√≥n) <br>  CLK est√° en un estado de cero <br>  CLK cambia el estado de uno a cero (aumento) <br>  CLK est√° en estado unitario <br>  CLK vuelve a cambiar el estado de uno a cero ... <br><br>  ¬øQu√© sucede durante los momentos de transici√≥n estatal? <br><br>  6502 recibe pulsos de reloj en la entrada CLK0, los almacena en el b√∫fer y los env√≠a a dos salidas: CLK1 y CLK2.  Aunque todos los eventos en el microprocesador est√°n vinculados a CLK1, suponemos que el retraso es peque√±o y est√°n vinculados a CLK0, la l√≠nea a lo largo de la cual el microprocesador recibe pulsos de reloj de Arduino.  Y llame a la se√±al solo CLK. <br><br><img src="https://habrastorage.org/webt/9i/kq/hc/9ikqhcytwd4sjg6rwjnvmohgkvi.png"><br><br>  1. CLK cambia el estado de uno a cero. <br><br>  2. El microprocesador env√≠a una nueva direcci√≥n al bus de direcciones y una se√±al de conmutaci√≥n entre lectura y escritura en la salida R / W.  Pero a√∫n no est√° listo para el intercambio de datos. <br><br>  3. CLK entra en estado de unidad, y esto significa que el intercambio de datos ha comenzado.  Si se trata de una operaci√≥n de lectura, el microprocesador transfiere las salidas del bus de datos al estado de entrada y recibe datos, y si la operaci√≥n de escritura, los transfiere al estado de salida y env√≠a datos.  Y la se√±al R / W cambia el dispositivo externo al modo de escritura o lectura, lo contrario del estado correspondiente del microprocesador. <br><br>  4. CLK va a cero.  Ahora, ni el microprocesador ni los dispositivos de entrada-salida env√≠an nada al bus de datos.  El microprocesador puede configurar la l√≠nea del bus de datos y el pin R / W a un nuevo estado. <br><br>  Una explicaci√≥n simple, comprensible para el ni√±o.  Quien nunca piensa en estas "intrigas detr√°s de escena", si solo programara microcontroladores.  Incluso en ensamblador. <br><br>  Si necesita conectar su dispositivo perif√©rico, debe tener tiempo para preparar los datos antes de que la unidad (tiempo de preparaci√≥n) aparezca en la l√≠nea CLK, y mientras la unidad est√© all√≠, no la cambie.  Si el dispositivo perif√©rico no tiene tiempo para preparar los datos mientras CLK es cero, o lo cambia cuando la unidad est√° all√≠, se preguntar√° durante mucho tiempo por qu√© su c√≥digo no funciona.  Dado que la frecuencia de reloj del microprocesador es de diez a quince veces menor que la frecuencia nominal, es f√°cil cumplir con este requisito.  Pero es necesario. <br><br>  Por lo tanto, debe "ense√±ar" a Arduino para generar pulsos de reloj, verificar continuamente lo que sucede en la direcci√≥n y las l√≠neas R / W e interactuar con el bus de datos en consecuencia.  Para hacer esto, el boceto utiliza la interrupci√≥n del temporizador timer1, que genera pulsos con una frecuencia de 95 kHz.  Arduino funciona mucho m√°s r√°pido que el microprocesador y, por lo tanto, entre sus relojes, logra leer y preparar todo.  Es importante asegurarse de que despu√©s de modificar el boceto, esta condici√≥n contin√∫e cumpli√©ndose. <br><br>  Aqu√≠ hay un extracto del boceto, que muestra c√≥mo el CLK va de cero a uno, y qu√© sucede a continuaci√≥n: <br><br><pre> <code class="plaintext hljs">//////////////////////////////////////////////////////////////////// // Processor Control Loop //////////////////////////////////////////////////////////////////// // This is where the action is. // it reads processor control signals and acts accordingly. // ISR(TIMER1_COMPA_vect) { // Drive CLK high CLK_E_HIGH; // Let's capture the ADDR bus uP_ADDR = ADDR; if (STATE_RW_N) ////////////////////////////////////////////////////////////////// // HIGH = READ transaction { // uP wants to read so Arduino to drive databus to uP: DATA_DIR = DIR_OUT; // Check what device uP_ADDR corresponds to: // ROM? if ( (ROM_START &lt;= uP_ADDR) &amp;&amp; (uP_ADDR &lt;= ROM_END) ) DATA_OUT = pgm_read_byte_near(rom_bin + (uP_ADDR - ROM_START)); else if ( (BASIC_START &lt;= uP_ADDR) &amp;&amp; (uP_ADDR &lt;= BASIC_END) ) DATA_OUT = pgm_read_byte_near(basic_bin + (uP_ADDR - BASIC_START)); else // RAM? if ( (uP_ADDR &lt;= RAM_END) &amp;&amp; (RAM_START &lt;= uP_ADDR) ) DATA_OUT = RAM[uP_ADDR - RAM_START]; else // 6821? if ( KBD &lt;=uP_ADDR &amp;&amp; uP_ADDR &lt;= DSPCR ) { // KBD? if (uP_ADDR == KBD) { ... // handle KBD register } else // KBDCR? if (uP_ADDR == KBDCR) { ... // handle KBDCR register } else // DSP? if (uP_ADDR == DSP) { ... // handle DSP register } else // DSPCR? if (uP_ADDR == DSPCR) { ... // handle DSPCR register } } } else ////////////////////////////////////////////////////////////////// // R/W = LOW = WRITE { // RAM? if ( (uP_ADDR &lt;= RAM_END) &amp;&amp; (RAM_START &lt;= uP_ADDR) ) RAM[uP_ADDR - RAM_START] = DATA_IN; else // 6821? if ( KBD &lt;=uP_ADDR &amp;&amp; uP_ADDR &lt;= DSPCR ) { // KBD? if (uP_ADDR == KBD) { ... // handle KBD register } else // KBDCR? if (uP_ADDR == KBDCR) { ... // handle KBDCR register } else // DSP? if (uP_ADDR == DSP) { ... // handle DSP register } else // DSPCR? if (uP_ADDR == DSPCR) { ... // handle DSPCR register } } } //////////////////////////////////////////////////////////////// // We are done with this cycle. // one full cycle complete clock_cycle_count ++; // start next cycle CLK_E_LOW; // If Arduino was driving the bus, no need anymore. // natural delay for DATA Hold time after CLK goes low (t_HR) DATA_DIR = DIR_IN; }</code> </pre> <br>  La asignaci√≥n del espacio de direcciones se puede hacer de cualquier manera, en un boceto no modificado es lo mismo que en Apple 1 con 256 bytes de ROM, 8 kilobytes de ROM para BASIC, 4 kilobytes de RAM y 6821 dispositivo de entrada-salida. <br><br><pre> <code class="plaintext hljs">// MEMORY LAYOUT // 4K MEMORY #define RAM_START 0x0000 #define RAM_END 0x0FFF byte RAM[RAM_END-RAM_START+1]; // ROMs (Monitor + Basic) #define ROM_START 0xFF00 #define ROM_END 0xFFFF #define BASIC_START 0xE000 #define BASIC_END 0xEFFF //////////////////////////////////////////////////////////////////// // Woz Monitor Code //////////////////////////////////////////////////////////////////// // PROGMEM const unsigned char rom_bin[] = { 0xd8, 0x58, 0xa0, 0x7f, 0x8c, 0x12, 0xd0, 0xa9, 0xa7, 0x8d, 0x11, 0xd0, ... 0x00, 0xff, 0x00, 0x00 }; // BASIC ROM starts at E000 PROGMEM const unsigned char basic_bin[] = { 0x4C, 0xB0, 0xE2, 0xAD, 0x11, 0xD0, 0x10, 0xFB, ... 0xE0, 0x80, 0xD0, 0x01, 0x88, 0x4C, 0x0C, 0xE0 };</code> </pre> <br>  RAM es emulada por la matriz de bytes RAM [RAM_END-RAM_START + 1].  Se necesitan dos palabras clave PROGMEM para que el contenido de las ROM emuladas se almacene en la memoria flash del microcontrolador. <br><br>  El 6821 est√° emulado lo suficiente para que el teclado virtual y la pantalla funcionen a trav√©s del "terminal".  Monitor Woz y trabajo BASIC, que es lo que buscaba el autor. <br><br>  Para emular cualquier dispositivo perif√©rico, debe leer cuidadosamente su hoja de datos y averiguar qu√© registros tiene y para qu√© sirven.  La conveniencia de la emulaci√≥n radica en la flexibilidad con la que puede hacer an√°logos de software de la periferia. <br><br>  Los dispositivos de E / S se encuentran en el espacio de direcciones del microprocesador; se accede a ellos de la misma manera que las celdas de memoria.  Para utilizar los perif√©ricos de "hierro", como una pantalla LCD, una tarjeta de memoria, salida de sonido, debe asignar un lugar en el espacio de direcciones. <br><br>  Referencias <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.6502.org</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.callapple.org/soft/ap1/emul.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">skilldrick.github.io/easy6502</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">searle.hostei.com/grant/6502/Simple6502.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wilsonminesco.com/6502primer</a> <br>  SB-Assembler: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.sbprojects.net/sbasm</a> <br><br>  Vaya a 6809, contiene: <br><br>  Dos bater√≠as de ocho bits A y B, que se pueden combinar en una bater√≠a de seis bits <br>  Dos √≠ndices de pila de 16 bits <br>  Direccionamiento relativo al contador de instrucciones <br>  Sumar o restar autom√°ticamente 1 o 2 <br>  Multiplicaci√≥n de dos n√∫meros sin signo de ocho d√≠gitos <br>  Aritm√©tica de 16 bits <br>  Transferencia e intercambio de datos entre todos los registros. <br>  Escribir y leer todos los registros y cualquier combinaci√≥n de ellos. <br><br>  El microprocesador 6809E (externo) necesita un reloj externo, mientras que el 6809 tiene uno interno.  En Hitachi, se les llama, respectivamente, 6309E y 6309, difieren de las habituales en que operan en forma de 32 bits dentro de la operaci√≥n, pero es posible cambiar al modo de compatibilidad con la versi√≥n cl√°sica. <br><br>  En realidad, todo el proyecto RetroShield comenz√≥ porque el autor quer√≠a actualizar su computadora casera Simon6809 y nombrar el resultado Simon6809 Turbo.  Pero result√≥ que los chips l√≥gicos est√°ndar para todo lo que quer√≠a implementar all√≠ requerir√≠an mucho.  Por lo tanto, el autor formul√≥ la idea de RetroShield por primera vez en relaci√≥n con 6809, y solo entonces pens√≥: "¬øy si lo mismo con otros procesadores hacen lo mismo?". <br><br>  El dispositivo, por supuesto, utiliza el 6809E, que requiere un reloj externo, para que pueda sincronizar su trabajo desde el exterior.  Las l√≠neas E y Q para ambos procesadores tienen el mismo nombre, solo 6809 tienen salidas y 6809E tienen entradas. <br><br>  Arduino interact√∫a con 6809 de la misma manera que con 6502, pero tiene dos entradas de reloj: E y Q, y tres entradas de interrupci√≥n: IRQ, FIRQ y NMI. <br><br><img src="https://habrastorage.org/webt/0i/uk/dn/0iukdn25vkrhbsvd8spjlhr-s3q.png"><br><br>  Esta vez, la correspondencia entre los puertos Arduino y los pines del microprocesador se configura de la siguiente manera: <br><br><pre> <code class="plaintext hljs">/* Digital Pin Assignments */ #define DATA_OUT PORTL #define DATA_IN PINL #define ADDR_H PINC #define ADDR_L PINA #define ADDR ((unsigned int) (ADDR_H &lt;&lt; 8 | ADDR_L)) #define uP_RESET_N 38 #define uP_E 52 #define uP_Q 53 #define uP_RW_N 40 #define uP_FIRQ_N 41 #define uP_IRQ_N 50 #define uP_NMI_N 51 #define uP_GPIO 39</code> </pre> <br>  Como se puede ver en los gr√°ficos, la se√±al Q se desplaza en relaci√≥n con E en un cuarto del per√≠odo: <br><br>  Apenas prestaremos atenci√≥n a Q, ya que todos los eventos est√°n vinculados a E. Y todo sucede as√≠: <br><br><img src="https://habrastorage.org/webt/ao/hj/qv/aohjqvkk89mbouy7_njtjqbz3ku.png"><br><br><ol><li>  E cambia a cero.  El procesador establece una nueva direcci√≥n en el bus de direcciones y cambia el estado de la l√≠nea R / W. </li><li>  E cambia a uno, el procesador se prepara para el intercambio de datos. </li><li>  No importa lo que le pase al bus de datos siempre que E sea uno, lo principal es que los datos requeridos est√°n presentes all√≠ en el momento en que E vuelve a cero. </li><li>  Al leer datos, el dispositivo de E / S debe suministrar los datos requeridos al bus de datos antes de que la l√≠nea E pase de uno a cero (el n√∫mero 17 en el c√≠rculo muestra el retraso m√≠nimo). </li><li>  Al grabar, el dispositivo de E / S debe corregir los datos en alg√∫n registro en la forma en que estaban en el momento en que E pas√≥ de uno a cero.  El procesador proporcionar√° estos datos en el bus incluso antes, en el momento de la transici√≥n de Q a uno (el n√∫mero 20 en el c√≠rculo). </li><li>  Despu√©s de la transici√≥n de E a cero, todo se repite. </li></ol><br>  Todo lo dicho anteriormente sobre 6502 sobre la necesidad de un dispositivo perif√©rico (incluido uno virtual) para desarrollar todas las se√±ales a tiempo se refiere a 6809. <br><br>  Generaci√≥n de las se√±ales E y Q, como en el caso de 6502, con la √∫nica diferencia de que hay dos se√±ales, y deben cambiarse de acuerdo con los gr√°ficos.  Y as√≠, una subrutina llamada a la interrupci√≥n realiza la entrada o salida de datos en los momentos requeridos. <br><br>  El espacio de direcciones en el boceto no modificado se distribuye de la misma manera que en la computadora <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Simon6809 casera</a> : <br><br><pre> <code class="plaintext hljs">// MEMORY #define RAM_START 0x0000 #define RAM_END 0x0FFF #define ROM_START 0xE000 #define ROM_END 0xFFFF byte RAM[RAM_END-RAM_START+1]; //////////////////////////////////////////////////////////////////// // Monitor Code //////////////////////////////////////////////////////////////////// // static const unsigned char PROGMEM const unsigned char simon09_bin[] = { 0x1a, 0xff, 0x4f, 0x1f, 0x8b, 0x0f, 0x36, 0x7f, 0x01, 0xa5, 0x10, 0xce, ... 0x00, 0x09, 0x00, 0x0c, 0x00, 0x0f, 0xe0, 0x00 };</code> </pre> <br>  La RAM y la ROM se almacenan en matrices de la misma manera que en la variante 6502, con la √∫nica diferencia de que solo hay una matriz con datos de ROM. <br><br>  A los dispositivos de E / S tambi√©n se les asignan porciones del espacio de direcciones, y pueden ser virtuales o reales.  Como Simon6809 es una m√°quina moderna basada en una base elemental vintage, intercambia datos a trav√©s de FTDI desde la PC en la que se ejecuta el "terminal".  Aqu√≠ se emula. <br><br>  Referencias <br><br>  Mucha informaci√≥n sobre 6809 en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">p√°gina de Arto</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Art√≠culo de Wikipedia sobre 6809</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sistemas SWTPc 6809</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Art√≠culo de Wikipedia sobre el sistema operativo FLEX</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446048/">https://habr.com/ru/post/446048/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446036/index.html">Oracle Application Express. Aplicaciones y paginas</a></li>
<li><a href="../446038/index.html">Una breve gu√≠a sobre la creaci√≥n de or√°culos, dioses del autom√≥vil y errores de segundo orden</a></li>
<li><a href="../446040/index.html">Full Stack Confession: profesi√≥n, religi√≥n, sue√±os</a></li>
<li><a href="../446042/index.html">DJI Mavic 2 Pro despu√©s de seis meses de uso</a></li>
<li><a href="../446046/index.html">La expansi√≥n del universo es la mayor falacia en la historia de la ciencia.</a></li>
<li><a href="../446050/index.html">Aleteo Keys! ¬øPara que son?</a></li>
<li><a href="../446052/index.html">Creando la voz y el tono de su producto</a></li>
<li><a href="../446054/index.html">Copia de seguridad lista: destruyendo mitos de vacaciones</a></li>
<li><a href="../446056/index.html">Una manera simple de hablar con su sitio web</a></li>
<li><a href="../446058/index.html">C√≥mo construir SDN - Ocho herramientas de c√≥digo abierto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>