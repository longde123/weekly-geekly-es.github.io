<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍💻 📓 👩🏿‍🤝‍👨🏼 如果您使用Alpine Linux，为什么要用显微镜钉钉子？ 😈 👩🏽‍🤝‍👨🏻 ☑️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在我作为数字设计的系统工程师的心声中，我经常不得不处理复杂的软件产品和体系结构设计。 这导致渴望最小化和简化即将到来的一切，并导致仅仅做自己的工作的人为决定的喜悦  ，无需注册和短信  。 


 因此我遇到了Alpine Linux。 





 您可能由于以下原因而喜欢此发行版： 


- 如...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如果您使用Alpine Linux，为什么要用显微镜钉钉子？</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/415279/"><p> 在我作为数字设计的系统工程师的心声中，我经常不得不处理复杂的软件产品和体系结构设计。 这导致渴望最小化和简化即将到来的一切，并导致仅仅做自己的工作的人为决定的喜悦 <del>  ，无需注册和短信 </del>  。 </p><br><p> 因此我遇到了Alpine Linux。 </p><br><p><img src="https://habrastorage.org/webt/8-/xb/-u/8-xb-uslnbk0hptvhrnaauiityo.jpeg" alt="意外的窗口"></p><br><p> 您可能由于以下原因而喜欢此发行版： </p><br><ul><li> 如果您喜欢极简主义和定向工具来完成任务，而没有不必要的哨声和装饰； </li><li> 如果您发现现有的“主流”发行版有点（？）膨胀且多余； </li><li> 如果要以简单的方式解决现有问题。 </li></ul><br><p> 我所说的“主流”是指CentOS-Debian-Ubuntu三人组（当然，世界并没有就此结束），请原谅所有相信这些出色发行版的人。 当在感知的边界上定期使用它们时，就会产生一个敏锐的想法-“也许会更容易吗？” </p><a name="habracut"></a><br><h1 id="ono-nam-deystvitelno-nado"> 我们真的需要吗？ </h1><br><p>  <em>$ holywar模式禁用</em> <br> 实际上，对于您的小任务的解决方案，所有这些都是必需的： </p><br><ul><li><p> 精彩系统。 一个初始化系统（一点也不完全）可能会给人穿梭控制系统的印象吗？ </p><div class="spoiler">  <b class="spoiler_title">嫩嫩！</b> <div class="spoiler_text"> 没有人说您不知道如何管理它，但是它的迅猛发展可能会开始令人恐惧，并且概念的数量显然超过了最低要求。 所有这些对于执行简单任务和很少重启服务器真的必要吗？ </div></div><br></li><li><p> 日志/审计子系统建立在类似journald-&gt; rsyslogd + auditd这样的堆上？ </p><br><div class="spoiler">  <b class="spoiler_title">这无疑很棒！</b> <div class="spoiler_text"><p> 可以猜测为什么要用这种方式完成，但是对于我的简单任务而言，真的需要这样一条链吗？ </p></div></div><br></li><li><p> 在systemd和crond中重复执行定期任务执行功能？ </p><div class="spoiler">  <b class="spoiler_title">哦，克朗！</b> <div class="spoiler_text"> 我真的很想念他的经典机制吗？ 也许其语法可能并不十分明显，但sd中的计时器是否如此明显？ </div></div><br></li><li><p> 几种网络管理子系统以不同组合共存：经典联网/联网/ NetworkManager？ </p><div class="spoiler">  <b class="spoiler_title">您需要大量管理网络！</b> <div class="spoiler_text">是的，这种结合是在服务器系统上实现的，并具有适合各种口味的多个管理界面。 尽管不是，但我们还要在此处添加netplan，它可以“解决”所列子系统的配置问题。 您是要启动服务还是由于重新配置网络接口而经常更改轨道？ </div></div><br></li><li><p> 像调优和防火墙这样的服务？ </p><div class="spoiler">  <b class="spoiler_title">没有他们怎么办？</b> <div class="spoiler_text"> 您的任务需要它们吗？ 原则上，将防火墙视为逃避iptables语法的一种尝试，但这样做的结果是，您会理解另一种语法，而不是一种语法，并且对firewall-cmd命令的大小感到困惑。 您是否真的需要基本系统中的python解释器及其进程？ 不，我喜欢python，但在这种情况下不适合。 </div></div><br></li><li><p> 本地邮件服务。 确定要使用它吗？ </p><br></li></ul><br><p> 由于我们记住了极简主义，因此我们可以在其<em>最小化</em>安装中非常粗略地比较领先的发行版： </p><br><ul><li> 磁盘空间和软件包数量方面的冗余领导者是Ubuntu 18.04（ <strong>2.8 GB</strong>磁盘空间， <strong>342个</strong>软件包，31个活动的systemd服务，输入时有15个进程）。 这里最大程度地表示了systemd系列-systemd，联网，时间同步，已解析，已登录，有dbus。 </li><li>  CentOS 7.5.1804在磁盘和数据包数量方面丢失，但在可能是冗余服务（1.1 GB磁盘空间，299个数据包， <strong>34个</strong>活动的系统服务，进入时有<strong>19个</strong>进程）中处于领先地位，包括NetworkManager，firewalld，tuned，postfix，polkitd，已审核，已记录日记+ rsyslogd，dbus）。 </li><li>  Debian 9.4.0非常努力地避免膨胀：940 MB，334个软件包，25个活动的systemd服务，登录时的14个进程。 当然，这里也有systemd（以及日志记录，时间同步和随附的dbus），但对网络管理没有太多狂热。 </li></ul><br><p>  <em>holywar：无法将模式更改为“ disable”：权限被拒绝</em> </p><br><h1 id="hochetsya-strannogo"> 我想要一个奇怪的 </h1><br><p> 您可以（尝试）手动摆脱上述内容的一部分，但是突然间一切都已经为我们发明了吗？ 理想情况下，我想从通用服务器操作系统的发行版中看到： </p><br><ul><li> 奇怪的是，引导程序将引导我们到达内核。 </li><li>  OS内核本身（在这种情况下为Linux）； </li><li> 就绪后内核将启动的初始化系统。 为了简单起见，最好离斧头不远。 </li><li> 初始化系统将启动的最小过程集。 好吧，例如： <br><ul><li> 最终设备初始化和其他内核参数的定义； </li><li> 提供日志记录（文本杂志可以吗？好吧，请）； </li><li> 网络配置（很好，控制层更少）； </li><li> 时间同步（ntpd / chronyd）； </li><li> 几个本地控制台； </li><li> 可选-定期执行任务（破产）； </li><li> 可选-远程访问系统（sshd）； </li><li> 保存和还原防火墙配置会很好。 </li></ul></li></ul><br><p> 就是这样，其余的由程序包管理器决定。 更少的可执行代码和配置-更少的bug，更少的bug-更少的bug。 该系统也正在运行并可以通过网络访问。 这个主意看起来不错，现在让我们看看<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Alpine Linux发行版</a>离它有多近。 </p><br><h1 id="pro-alpine"> 关于高山 </h1><br><p> 有什么魅力可以吸引Alpine，尤其是在CentOS之后？ 绝望的极简主义！ <br> 好吧，当然， <em>也不</em>需要认证“ <em>Linux Systemd Certified Voldemort</em> ”。 </p><br><p> 作者做了什么： </p><br><ul><li> 减少了使用的基本组件数量； </li><li> 我们选择了更小，更透明的模块； </li><li> 简化了系统配置过程。 </li></ul><br><p> 即： </p><br><ul><li> 使用setup-alpine控制台实用程序极其简洁的安装过程； </li><li>  syslinux项目中的Extlinux被用作加载程序； </li><li> 一个小的mkinitfs构建工具，用于创建启动时使用的临时文件系统； </li><li>  Openrc初始化系统，定义了服务，运行级别和少量脚本之间的依赖关系； </li><li> 用更轻量级的musl libc代替标准的GNU libc库； </li><li> 代替GNU coreutils软件包的是，有些标准版本的标准系统实用程序在某种程度上被截断了，但是它是busybox软件包的一部分，您可能在嵌入式解决方案中很熟悉。 </li><li> 默认情况下，ash shell用作busybox的一部分。 当然，如果有必要的话，没有人会烦恼 <del>  ，好，系统化 </del>  ; </li><li> 本地apk程序包管理器和专有程序包分发基础结构。 </li></ul><br><p> 此外，作者还实施了一些旨在提高基本系统安全级别的措施： </p><br><ul><li><del> 我们应用了grsecurity / PaX内核补丁（观点虽然有所不同，但仍然有效）； </del> 不再了，感谢同事的评论。 就在6月26日， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发布了3.8.0版</a> 。 </li><li> 使用减少了利用许多可能的漏洞的可能性的模式收集软件包。 </li></ul><br><p> 结果，我们获得了一个配备有许多其他保护机制的系统，这使我们能够解决现有问题，并且占用约<strong>130 MB的空间</strong> 。 在正在运行的系统上，安装了41个软件包并且正在运行13个用户进程，您可以打开ssh。 </p><br><p> 仅此而已。 仍然可以添加您需要的内容（并使iptables具有在启动时恢复配置的功能）。 </p><br><h1 id="priotkroem-kryshku"> 轻轻打开盖子 </h1><br><p> 请注意-熟悉Linux时，Alpine可以作为培训场派上用场！ 从主观上来说，了解组件的逻辑要比尝试涵盖CentOS或Ubuntu的要容易得多： </p><br><ul><li> 我们已安装系统的引导程序很简单，其配置分为12行： </li></ul><br><p><img src="https://habrastorage.org/webt/6r/1z/xr/6r1zxrlsvjzko_vd1ou_dcwi0vw.png" alt="引导程序配置"></p><br><ul><li> 是的，并且在/ boot不太拥挤： </li></ul><br><p><img src="https://habrastorage.org/webt/fa/rj/xx/farjxxhlgwxblqhfwkfkr-3es5a.png" alt="ls /引导输出"></p><br><ul><li> 这是没有精美墙纸的启动引导程序： </li></ul><br><p><img src="https://habrastorage.org/webt/af/r4/qt/afr4qtlbw2ixxbq4_kh7oqygzum.png" alt="运行引导程序"></p><br><ul><li> 内核启动，选择initramfs，执行其自己的初始化步骤并调用init命令（实际上，busybox也附带了该命令）。 初始化使用文件/ etc / inittab： </li></ul><br><p><img src="https://habrastorage.org/webt/fy/a9/ib/fya9ibwro80f1kvfqvc814otfby.png" alt="/ etc / inittab的内容"></p><br><ul><li> 在此明确说明了初始化系统需要启动的内容： <br><ul><li> 运行6个getty进程，在6个虚拟控制台上等待本地用户登录。 </li><li> 运行openrc初始化系统以交替实现所需的初始化级别（openrc不使用经典的初始化级别0-6，而是使用其自己的sysinit级别/组-引导-默认值）。 </li></ul></li></ul><br><p> 此外，系统状态取决于openrc的配置，即： </p><br><ul><li> 在/etc/conf.d目录文件中定义的变量； </li><li> 运行位于/etc/init.d目录中的脚本； </li><li> 将启动脚本绑定到“初始化组”： </li></ul><br><p><img src="https://habrastorage.org/webt/a8/pd/vr/a8pdvrblpuowg0igaecv1vndhto.png" alt="恶魔及其等级绑定"></p><br><p> 仍然需要阅读启动脚本并在考虑启动级别和依赖性的情况下对其进行处理。 <br> 使用syslog示例（/etc/init.d/syslog），我们可以看到openrc启动脚本的外观。 </p><br><p> 如您所见，这些并不总是属于您不喜欢的鞋袋： </p><br><p><img src="https://habrastorage.org/webt/qk/rh/32/qkrh32aqdjl0i35mx_5tjfihi6s.png" alt="Openrc配置文件示例"></p><br><p> 执行脚本时使用的变量在相应的文件/etc/conf.d/syslog中定义。 在我们的例子中，变量SYSLOGD_OPTS =“-Z”在文件中定义。 <br> 请注意，脚本以声明方式定义了此服务的依赖项。 </p><br><p> 老实说，Openrc会以给定顺序遍历启动脚本，达到“默认”级别-这就是工作系统！ </p><br><h1 id="demony-pod-kryshkoy"> 引擎盖下的恶魔 </h1><br><p>  openrc启动脚本中到底隐藏了什么？ 奇怪的是-下面列出了一组任务和恶魔。 </p><br><ul><li><p> 首先，在sysinit级别： </p><br><ul><li>  dmesg-设置来自内核的消息的日志记录级别； </li><li>  devfs-安装和配置/ dev； </li><li>  mdev-设备管理器启动； </li><li>  hwdrivers-基于来自/ sys和/ dev的信息加载设备模块； </li></ul><br></li><li><p> 接下来是启动级别： </p><br><ul><li>  modules-装入内核模块，其列表在/ etc / modules中定义； </li><li>  hwclock-实时硬件时钟已配置； </li><li>  sysctl-设置我们在/etc/sysctl.conf中定义的内核参数； </li><li>  swap-交换分区已连接； </li><li>  bootmisc-临时目录已清除； </li><li>  urandom-配置了一个随机数生成器； </li><li>  keymaps-键盘布局已初始化； </li><li>  hostname-设置机器的名称，该名称在/ etc / hostname中定义； </li><li> 网络-使用/ etc / network / interfaces中的信息搜索和初始化接口； </li><li>  syslog-从busybox启动日志记录守护进程； </li></ul><br></li><li><p> 最后，默认级别： </p><br><ul><li>  chrony-NTP服务启动； </li><li>  crond-启动计划任务执行服务； </li><li>  acpid-电源事件跟踪服务启动； </li><li>  sshd-远程访问服务启动。 </li></ul><br></li></ul><br><p> 完成这些步骤之后，万岁，系统就可以开始使用！ 不要忘记init.d文件中指定的上述服务的依赖性： </p><br><ul><li>  sysfs-挂载/ sys; </li><li>  fsck-检查并修复文件系统； </li><li>  root-安装用于写入/读取的根系统； </li><li>  localmount-挂载/ etc / fstab中列出的所有文件系统； </li><li>  klogd-记录内核事件。 </li></ul><br><p> 我们打开getty等待我们的本地控制台之一，输入登录名，然后将密码传递给登录过程并访问正在运行的ash shell（启动后，文件/etc/profile、/etc/profile.d/*和〜的内容） /.profile来准备用户环境）。 </p><br><p> 万岁，没有其他实体（在某些情况下无疑是有用的，例如PAM）-我们就在系统中！ </p><br><p> 仍然需要使用apk软件包管理器，并查找完成任务所需的软件包。  （他们在那里吗？您可以通过<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Web门户</a>对此进行评估）。 </p><br><h1 id="a-esche"> 还有 </h1><br><ul><li> 该发行版的作者制作了自己的iptables附加组件，称为“ Alpine Wall”。 并且它不会作为系统中的独立进程而不断挂起； </li><li> 对于那些想通过Web界面管理服务器的人，已经准备了Alpine Configuration Framework软件包。 没有PHP或Perl，但是有Lua； </li><li> 对于那些想要台式机的人来说，可以安装图形环境（尽管一开始可能会很痛苦）。 </li><li> 对于特殊的鉴赏家，可以在内存中“安装” Alpine，并将配置存储在外部存储器中（请参阅<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">lbu</a>工具的说明）。 </li></ul><br><h1 id="itog"> 总结 </h1><br><p>  Alpine发行版并不完美，但其简洁性给我留下了深刻的印象，尤其是在容器的角色方面（只有6个进程-init，4 * getty，syslogd）。 对我来说，最小的服务器操作系统应该看起来像（请原谅，CentOS！）。 </p><br><p> 此外，它非常适合用作培训平台的角色，该平台使您可以看到现代分发工具包的组成，而无需立即陷入任何服务的深渊，并在适用于所有场合的出色的多级可配置工具中重复复制功能。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN415279/">https://habr.com/ru/post/zh-CN415279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN415269/index.html">JS的工作原理：抽象语法树，解析及其优化</a></li>
<li><a href="../zh-CN415271/index.html">甘特图如何简化项目管理</a></li>
<li><a href="../zh-CN415273/index.html">学习编程基础</a></li>
<li><a href="../zh-CN415275/index.html">《 C＃7和.NET Core》一书。 面向专业人员的跨平台开发。 第三版</a></li>
<li><a href="../zh-CN415277/index.html">ARKit 2.0的新功能</a></li>
<li><a href="../zh-CN415283/index.html">OWASP TOP 10项目：简介</a></li>
<li><a href="../zh-CN415285/index.html">MBLT DEV 2018：第一位演讲者和最新的早鸟票</a></li>
<li><a href="../zh-CN415287/index.html">时空量的属性分类（防空）</a></li>
<li><a href="../zh-CN415289/index.html">人群测试，或在哪里可以获得测试第一工作的经验</a></li>
<li><a href="../zh-CN415291/index.html">收音机：基于Atmega328-P和RDA5807M的FM收音机</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>