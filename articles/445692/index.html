<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦋 💆🏽 🦖 Descripción general de las características de PlayCanvas para crear aplicaciones Web VR 💡 🚴🏻 💅🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PlayCanvas es una plataforma visual para desarrollar aplicaciones web interactivas. Todo lo que se desarrolla utilizando PlayCanvas se basa en las cap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Descripción general de las características de PlayCanvas para crear aplicaciones Web VR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445692/"><img src="https://habrastorage.org/webt/mu/fu/yq/mufuyqm46wxnzg_gaz5wyehcajs.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PlayCanvas</a> es una plataforma visual para desarrollar aplicaciones web interactivas.  Todo lo que se desarrolla utilizando PlayCanvas se basa en las capacidades de HTML5.  PlayCanvas es una aplicación web, lo que significa que no necesita instalar programas especiales y puede acceder a su proyecto desde cualquier dispositivo en cualquier parte del mundo a través de Internet.  Todos los proyectos que cree se pueden colocar en la red con solo un clic. <br><a name="habracut"></a><br><h2>  Flujo de trabajo en PlayCanvas </h2><br><img src="https://habrastorage.org/webt/ws/oo/di/wsoodieak3-adlz0md5-wl_ojlc.png"><br><br>  Todo en PlayCanvas comienza con un editor visual. <br><br>  En el lado izquierdo de la pantalla hay una sección de la jerarquía de entidades.  Le permite crear entidades vacías y predefinidas, como cámaras, luces, primitivas, audio, interfaces, sistemas de partículas o modelos.  Cualquier entidad agregada a la jerarquía ingresa automáticamente a la escena. <br><br>  En el centro de la pantalla está el editor de escenas.  Aquí puede cambiar la disposición de las entidades, seleccionarlas para editarlas y simplemente ver cómo se verá la escena de su aplicación. <br><br>  En la parte inferior del editor de escenas se encuentra la sección de activos.  Los activos son todos los archivos y otros elementos que se pueden agregar a sus entidades.  Hay varios tipos de activos en PlayCanvas: carpeta, css, cubemap, HTML, JSON, material, script, sombreador y texto.  Todos ellos tienen diferentes propósitos. <br><br>  Y finalmente, en el lado derecho de la pantalla hay una sección de las propiedades de la entidad.  Una entidad tiene propiedades básicas: ubicación, rotación, escala, nombre, etiquetas, configuraciones de componentes agregados.  Las propiedades cambian según la entidad que se agrega.  Por ejemplo, si agregamos un cubo, tendrá las siguientes propiedades: tipo, material, configuración de sombra, capas y grupos. <br><br>  El proceso general de desarrollo de aplicaciones y juegos en PlayCanvas es aproximadamente el siguiente: <br><br><ol><li>  Agregamos los activos necesarios.  Por ejemplo: modelos, materiales, audio, video. </li><li>  Creamos el ambiente de nuestra escena.  Por ejemplo: ciudad, casa, paisaje. </li><li>  Añadir elementos interactivos.  Por ejemplo: un jugador y sus enemigos. </li><li>  Agregue lógica de aplicación usando scripts. </li><li>  Publicar un juego o aplicación en línea. </li></ol><br><h2>  PlayCanvas y JavaScript </h2><br><img src="https://habrastorage.org/webt/ba/ho/_t/baho_trfpv1_buk71c4wj8gfzqi.png"><br><br>  Para agregar lógica a nuestro juego o aplicación en PlayCanvas hay un componente especial: un script.  Las secuencias de comandos pueden ser globales, en cuyo caso deben agregarse a la entidad raíz de la jerarquía de escenas.  Los scripts locales se agregan directamente a la entidad dentro de la jerarquía (por ejemplo, al modelo del personaje del juego).  Todos los scripts deben estar escritos en JavaScript desde  Después de todo, escribimos juegos en el navegador.  Los amantes de ES6, lamentablemente, estarán decepcionados porque  PlayCanvas todavía usa ES5, y cuando intentas escribir algún tipo de diseño desde ES6, el linter incorporado comenzará a maldecir.  En general, la anatomía del guión es la siguiente plantilla: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> NewScript = pc.createScript(<span class="hljs-string"><span class="hljs-string">'newScript'</span></span>); NewScript.attributes.add(<span class="hljs-string"><span class="hljs-string">'someString'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'string'</span></span>, <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-string"><span class="hljs-string">'any'</span></span>, <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'Some string'</span></span> }); NewScript.prototype.initialize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.startPosition = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.entity.getPosition(); }; NewScript.prototype.update = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dt</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.entity.setLocalPosition(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.newPosition); }; NewScript.prototype.calcaulateNewPosition = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.newPosition = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.startPosition.dot(pc.Vec3.ZERO) };</code> </pre> <br>  Aquí creamos un nuevo script.  Obtiene dos métodos principales: inicializar: se llamará cuando la entidad se agregue a la escena.  Actualización: se llama a cada marco de renderizado.  El parámetro dt en la actualización es el tiempo delta:% del segundo para el que se dibujó el último fotograma.  Esto se ilustra bien con el siguiente ejemplo: necesita rotar un objeto en un segundo 360 grados.  Escribimos el siguiente código: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.entity.rotate(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span> * dt, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br>  Finalmente, el último método <i>calcaulateNewPosition</i> es un método personalizado y puede usarse para estructurar código. <br><br>  También en el código existe la posibilidad de agregar un nuevo atributo <i>someString</i> .  Este diseño le permite definir parámetros que se pueden especificar más a través de la interfaz del editor.  Para agregar un script a la entidad seleccionada y haga clic en el botón <b>"Analizar"</b> .  Si el script tenía una construcción con atributos, aparecerá un campo especial para completar el valor.  Este valor anulará el valor predeterminado.  PlayCanvas admite muchos tipos diferentes de atributos para un script.  Puedes leer más sobre esto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . <br><br>  Los scripts pueden editarse tanto en el editor incorporado como en su máquina local en un IDE conveniente para usted.  Pero en el segundo caso, debe jugar con la configuración, porque necesita elevar el servidor emparejado con PlayCanvas. <br><br>  Bueno, ahora que hemos cubierto las características principales de PlayCanvas, podemos hablar sobre cómo crear escenas de realidad virtual en PlayCanvas. <br><br><h2>  VR fuera de la caja </h2><br><img src="https://habrastorage.org/webt/ih/qs/rb/ihqsrbmkce9ju7q-dzb93z8c7oa.png"><br><br>  PlayCanvas te permite crear una escena de realidad virtual fuera de la caja.  Para hacer esto, seleccione la opción adecuada (VR Starter Kit) al crear un nuevo proyecto.  Entonces, veamos qué nos ofrece el PlayCanvas predeterminado (spoiler: no tantos como nos gustaría). <br><br>  Al ejecutar la escena, verás tres cubos frente a ti.  Cuando los mires (control de la mirada), se abrirá una barra de progreso, que hará que el cubo sea transparente.  Sin controladores ni controles WASD para PC.  En esencia, esta administración le permite crear una pequeña aplicación para cartones, porque de forma predeterminada existe soporte para eventos táctiles. <br><br>  El código de nuestro kit de inicio VR, de hecho, no está muy bien estructurado y algunas de sus partes están directamente vinculadas a la lógica de esta escena.  Es decir, para hacer algo diferente, tiene que descubrir cómo funciona todo y adaptarse a sus necesidades.  No hay una API que le permita conectar cualquier funcionalidad por separado. <br><br>  Ahora intentemos revisar los archivos del kit de inicio para averiguar de qué es responsable y cómo puede usarlo para sus propios fines. <br><br><ul><li>  <b>look-camera.js</b> .  Aquí está la lógica responsable de emparejar la pantalla VR y la cámara.  Además, usando mouse-controller.js o touch-controller.js podemos transmitir tono y guiñada para controlar la cámara desde una PC o teléfono móvil. </li><li>  <b>selector-camera.js</b> .  Este archivo tiene una lógica oculta para implementar el control de la mirada.  Cada elemento que está disponible para la interacción debe agregarse a través de la cámara selector: agregar evento.  Además, su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AABB</a> debe calcularse manualmente. También aquí puede encontrar la lógica del rayo (ray \ raycaster).  PlayCanvas tiene un objeto especial this._ray = new pc.Ray ();  que sabe cómo encontrar intersecciones con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BoundingBox</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BoundingSphere</a> . </li><li>  <b>web-vr-ui.js</b> .  Solo agrega una interfaz de inicio de sesión VR.  Francamente, esto no es muy elegante.  Todos los estilos y HTML están directamente en este script.  Aparentemente, esto se debe al hecho de que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pantalla 2D</a> para interfaces tiene sus propias limitaciones, y el botón debe estar estrictamente en la esquina inferior derecha. </li><li>  <b>box.js.</b>  Aquí encontraremos toda la lógica asociada con el cubo: gestión de la barra de progreso, etc. </li></ul><br>  Como puede ver en lo anterior, no hay mucho en lo que confiar en el kit inicial de VR.  Todo lo que se puede hacer es una aplicación de cartón y esto, en mi opinión, no es muy interesante, porque los cartones son un tipo de juguete que no da una idea de la experiencia normal de usar VR.  Realmente puedes sumergirte en la realidad virtual con Oculus Go, Oculus Rift o HTC Vive. <br><br>  Ahora hablemos sobre cómo podemos agregar soporte de controlador a nuestra aplicación. <br><br><h2>  Controladores VR </h2><br><img src="https://habrastorage.org/webt/tu/ev/9f/tuev9fuqge3rucidyes50bkmaeo.png"><br><br>  Sería bueno si PlayCanvas adaptara su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">almacenamiento</a> para que fuera posible conectar varios elementos conectados con la lógica necesaria a la aplicación con un solo botón.  Pero hoy esto no se puede hacer, así que tratemos de hacerlo de manera diferente.  Para no escribir toda la lógica para comparar la posición de los controladores, podemos usar las soluciones existentes.  Hay un gran ejemplo de un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">laboratorio web VR</a> .  Hay muchas cosas interesantes, pero el código ... el mismo diablo se romperá la pierna.  También hay una pequeña escena de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Controladores con seguimiento de realidad virtual</a> , solo una escena básica con dos controladores.  Aquí es lo mismo y es adecuado para tomar elementos prestados en su proyecto. <br><br>  Abra la escena VR Tracked Controllers para editar.  Primero necesitamos transferir el controlador: <br><br><ol><li>  Seleccionamos el controlador, en la sección de propiedades encontramos el modelo, hacemos clic en él, lo incorporamos como un activo. </li><li>  En la configuración habrá un botón Descargar, en el que hacemos clic y descargamos el modelo y las texturas. </li><li>  Descomprima los activos y cárguelos en su aplicación.  Para hacer esto, simplemente arrástrelos a la ventana de Activos, que se encuentra debajo.  Necesita transferir todo: un modelo en formato JSON y todas las texturas. </li><li>  El modelo aparecerá en nuestra lista de activos.  Arrástrelo al escenario.  Y aquí ella ya está allí.  Llamémoslo controlador izquierdo. </li></ol><br>  Ahora necesitamos agregar el material: <br><br><ol><li>  Cree un nuevo material haciendo clic en el botón <b>"+"</b> en el panel de activos.  Nombre del material Material del controlador. </li><li>  Ahora necesitamos abrir el proyecto fuente y encontrar el material del controlador rastreado allí y copiar todas las configuraciones en nuestro material, incluidos mapas (mapas) normales, emisivos, especulares y difusos. </li></ol><br>  Ahora puede copiar el controlador utilizando el botón Duplicar especial en el panel de jerarquía y nombrar el segundo controlador Controlador derecho. <br><br>  Eso es todo, los controladores en nuestro escenario.  Pero hasta ahora estos son solo dos modelos y para que todo funcione necesitamos transferir los scripts.  Veamos con más detalle qué se necesita allí y cómo funciona: <br><br><ul><li>  <b>vr-gamepad-manager.js</b> : esencialmente contiene toda la lógica necesaria para que sus controladores obtengan la posición y la rotación del controlador real.  Aquí, se implementa la lógica de codo falso para cascos 3-dof como Oculus Go, Gear VR o Daydream.  _updatePadToHandMappings aquí es responsable de localizar los controladores y asignarlos a nuestros controladores.  Toda la lógica de hacer coincidir el controlador real y virtual está en la función _poseToWorld.  De hecho, aquí los datos se toman de la API de WebXR a través de la instancia del controlador en sí mismo: padPose.position, padPose.poseRotation.  La lógica a continuación es responsable de los matices asociados con los diferentes tipos de dispositivos.  El script en sí debe ser global (es decir, agregado a la raíz de la jerarquía). </li><li>  <b>input-vr.js</b> : es responsable de registrar nuestros controladores y trabajar con botones.  De hecho, simplemente determina la presión del botón y envía el número del botón presionado.  Esto no es muy conveniente, ya que diferentes dispositivos pueden tener botones diferentes y una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API GamePad</a> , y no es un hecho que el primer botón en Oculus Go sea un disparador para el controlador HTC Vive.  Por lo tanto, tienes que cavar manualmente.  Este script debe estar conectado al elemento controlador. </li></ul><br>  Si todo se hace correctamente, puede ingresar a la realidad virtual y agitar sus controladores.  No está mal, aunque el proceso de integración de la funcionalidad necesaria es bastante incómodo y tedioso. <br><br><h2>  Total </h2><br>  PlayCanvas es un excelente motor que puede usar para crear juegos o aplicaciones WebGL.  Pero, debo admitir que está mal adaptado para WebVR.  Parece que el objetivo era demostrar lo que PlayCanvas puede hacer para fomentar el interés público.  Pero esta dirección, aparentemente, no ha recibido desarrollo.  Por lo tanto, puede crear un juego o aplicación de realidad virtual, pero tendrá que copiar mucho y comprender el código complicado que se creó solo para demostración (Web VR Lab). <br><br>  En el siguiente artículo, me gustaría llevar a cabo una pequeña lección sobre cómo crear un control de teletransporte, de modo que tengamos algún tipo de al menos un pequeño conjunto que le permita iniciar un juego o aplicación Web VR.  ¡Gracias a todos por su atención! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/445692/">https://habr.com/ru/post/445692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445678/index.html">4. Check Point Getting Started R80.20. Instalación e inicialización</a></li>
<li><a href="../445680/index.html">Nueva característica en Git 3: cierres</a></li>
<li><a href="../445682/index.html">PVS-Studio para Java se envía a la ruta. La siguiente parada es Elasticsearch</a></li>
<li><a href="../445684/index.html">UPS monobloque vs modular</a></li>
<li><a href="../445686/index.html">Desarrollo de aplicaciones para un PDA antiguo (Cybiko Xtreme) en 2019</a></li>
<li><a href="../445696/index.html">Cómo se crean los robots que pueden ir a donde estamos</a></li>
<li><a href="../445698/index.html">Licencia de NanoCAD</a></li>
<li><a href="../445700/index.html">"33 palabras sobre diseño": quién y por qué hace una película sobre diseño en Rusia</a></li>
<li><a href="../445702/index.html">SlowPochta: mensajero de entrega injustificada de mensajes con tiempo de reenvío indefinido</a></li>
<li><a href="../445704/index.html">Citymobil: una guía para nuevas empresas para aumentar la estabilidad en medio del crecimiento. Parte 2. ¿Cuáles son los tipos de accidentes?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>