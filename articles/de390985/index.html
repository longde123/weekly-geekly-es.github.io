<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐓 💢 🧗🏼 ATmega16 + DS18B20 + LED + Matlab / Simulink = AR 👱 🚑 🤙🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich dachte daran, irgendwie mit den DS18B20- Sensoren herumzuspielen . Ja, nicht nur um die Temperaturwerte zu erhalten (was jeder tun kann), sondern ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ATmega16 + DS18B20 + LED + Matlab / Simulink = AR</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390985/"><img align="left" src="https://habrastorage.org/files/e2a/4a8/d70/e2a4a8d7092845e082baee85d185ebd2.bmp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich dachte daran, irgendwie mit den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18B20-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sensoren </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">herumzuspielen</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ja, nicht nur um die Temperaturwerte zu erhalten (was jeder tun kann), sondern auch um sie irgendwie zu visualisieren. </font><font style="vertical-align: inherit;">Es gab eine einfache Idee. </font><font style="vertical-align: inherit;">Wir setzen die Webcam. </font><font style="vertical-align: inherit;">Wir zünden das Licht auf einem geraden Rahmen an, auf einem ungeraden löschen wir es. </font><font style="vertical-align: inherit;">Subtrahieren Sie das Bild - nur der Blitz bleibt übrig. </font><font style="vertical-align: inherit;">Darauf suchen wir nach der Position des Sensors, der physisch an der LED im Raum befestigt ist. </font><font style="vertical-align: inherit;">Und dann die mathematische Verarbeitung. </font><font style="vertical-align: inherit;">Nun, das alles in Simulinka. </font><font style="vertical-align: inherit;">Unter katom wird beschrieben, wie man schöne Bilder erhält. </font><font style="vertical-align: inherit;">Und für diejenigen, die nicht verstehen wollen, empfehle ich, die Experimente am Ende des Artikels zu betrachten.</font></font><br>
<a name="habracut"></a><br>
<br clear="left">
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schaltung</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Schaltung ist extrem einfach. </font><font style="vertical-align: inherit;">Das Herz ist der ATmega16. </font><font style="vertical-align: inherit;">Alle DS18B20-Sensoren hängen an einem Pin (in meinem Fall an PB0 des PORTB-Ports). </font><font style="vertical-align: inherit;">Der Pin selbst wird über einen 4,7-kΩ-Widerstand auf die Versorgungsspannung gezogen. </font><font style="vertical-align: inherit;">Das Schema ist skalierbar. </font><font style="vertical-align: inherit;">Das Bild ist anklickbar.</font></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/1d6/87f/7dd/1d687f7ddbbc4e29858d20b4ceebcfe7.bmp"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle LEDs sind über Abschlusswiderstände mit dem PORTA-Port verbunden. </font><font style="vertical-align: inherit;">Ein graues Polygon bedeutet, dass diese LED physisch mit dem DS18B20 verbunden ist. </font><font style="vertical-align: inherit;">Der Rücksetzstift wird durch einen 10 kΩ-Widerstand hochgezogen, um ein versehentliches Zurücksetzen aufgrund von Interferenzen zu vermeiden. </font><font style="vertical-align: inherit;">Der Mikrocontroller wird mit 16 MHz Quarz getaktet. </font><font style="vertical-align: inherit;">Schließen Sie die Schlussfolgerungen so nah wie möglich an. </font><font style="vertical-align: inherit;">Ladetanks werden intern verwendet. </font><font style="vertical-align: inherit;">Über Sicherung konfiguriert. </font><font style="vertical-align: inherit;">ICP-Konnektoren (zum Hochladen der Firmware) und UART für "Kommunikation" getrennt ausgeben. </font><font style="vertical-align: inherit;">Kapazitäten C1 (Elektrolyt 10 μF) und C2 (Keramik 100 nF). </font><font style="vertical-align: inherit;">Stellen Sie das Gerät so nah wie möglich an die Stromanschlüsse des Mikrocontrollers. </font><font style="vertical-align: inherit;">Wird verwendet, um versehentliche Entladungen während der Lastübertragung zu vermeiden.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Schaltungsanordnung</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/20a/9b3/6fa/20a9b36fade242d9b70e10be068168ad.jpg"></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was ist ein graues Polygon?</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/d61/bca/b30/d61bcab30e4041e6977ff8d55687d58a.jpg"></div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware + Arbeitsalgorithmus</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Firmware wurde in C in </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atmel Studio 7</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IDE geschrieben. </font><font style="vertical-align: inherit;">Quellen werden auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub veröffentlicht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Der Code ist maximal dokumentiert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Projekt ist in mehrere Abstraktionsebenen unterteilt:</font></font><br>
<ul>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die niedrigste Ebene, maximale Bindung an Hardware. </font><font style="vertical-align: inherit;">Arbeiten Sie mit der Peripherie des Mikrocontrollers.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Middleware</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist der Mittelweg zwischen Hardware und Treibern. </font><font style="vertical-align: inherit;">Zum Beispiel die Implementierung des 1-Wire-Protokolls.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Treiber</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Fahrerebene. </font><font style="vertical-align: inherit;">Zum Beispiel mit dem DS18B20-Chip arbeiten.</font></font></li>
<li><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anwendung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die höchste Abstraktionsebene. </font><font style="vertical-align: inherit;">Zum Beispiel Empfangen und Senden von Temperatur über UART.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein kurzer Blick durch die Hauptfunktion. </font><font style="vertical-align: inherit;">Zuerst kommt die Tabelle der ROM-Adressen. </font><font style="vertical-align: inherit;">Es ist erforderlich, dass sich die Adresse des Sensors, der physisch mit der Null-LED verbunden ist (hängt an der PA0 des PORTA-Anschlusses), in der Nullposition usw. befindet. </font><font style="vertical-align: inherit;">Um ROM zu erhalten, gibt es eine </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sendROMToUART-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Funktion </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie müssen sich nur daran erinnern, dass sich der Sensor nur am Bus befinden muss, da sonst ein Adresskonflikt auftritt.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haupt</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">
</span></span>{	
	<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ROM[][<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T)] = <span class="hljs-comment"><span class="hljs-comment">/* ROM array */</span></span><font></font>
	{<font></font>
		{<span class="hljs-number"><span class="hljs-number">0x26</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x15</span></span>, <span class="hljs-number"><span class="hljs-number">0x89</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 0</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x71</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xC0</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 1</span></span>
		{<span class="hljs-number"><span class="hljs-number">0xA5</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xCB</span></span>, <span class="hljs-number"><span class="hljs-number">0xCE</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 2</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x41</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xAC</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 3</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4B</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x0D</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}, <span class="hljs-comment"><span class="hljs-comment">// 4</span></span>
		{<span class="hljs-number"><span class="hljs-number">0x86</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x4A</span></span>, <span class="hljs-number"><span class="hljs-number">0xF6</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0x28</span></span>}  <span class="hljs-comment"><span class="hljs-comment">// 5</span></span><font></font>
	};<font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span><font></font>
	<font></font>
	initUART(MYUBRR); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of UART with appropriate baudrate */</span></span>
	initTimer0(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of Timer/counter0 */</span></span>
	initLED(nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of LEDs */</span></span><font></font>
	<font></font>
	{ <span class="hljs-comment"><span class="hljs-comment">/* DS18B20s initialization */</span></span>
		<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> nDevices = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM) / <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ROM_T); <span class="hljs-comment"><span class="hljs-comment">/* Number of DS18B20 devices */</span></span>
		ROM_T *pROM = (ROM_T *)&amp;ROM; <span class="hljs-comment"><span class="hljs-comment">/* Pointer to ROM array */</span></span><font></font>
		<font></font>
		initDQ(); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DQ pin */</span></span><font></font>
		<font></font>
		<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (nDevices--) <span class="hljs-comment"><span class="hljs-comment">/* For all DS18B20 */</span></span>
			initDS18B20(pROM++, RESOLUTION_11BIT); <span class="hljs-comment"><span class="hljs-comment">/* Initialization of DS18B20 with appropriate resolution */</span></span><font></font>
	}<font></font>
	<font></font>
	sei(); <span class="hljs-comment"><span class="hljs-comment">/* Global enable interrupts */</span></span><font></font>
	<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Infinite loop */</span></span><font></font>
	{<font></font>
		sendTemperatureToUART((ROM_T *)&amp;ROM, nDevices); <span class="hljs-comment"><span class="hljs-comment">/* Execute function routine */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes erfolgt die Initialisierung der Peripheriegeräte und des DS-ok selbst mit der entsprechenden Auflösung. </font><font style="vertical-align: inherit;">Die Temperaturabtastperiode hängt davon ab. </font><font style="vertical-align: inherit;">Für 11 Bits sind dies 375 ms. </font><font style="vertical-align: inherit;">In einer Endlosschleife liest das Programm kontinuierlich die Temperatur von jedem Sensor und sendet sie über UART. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Arbeit mit LEDs basiert auf Interrupts. </font><font style="vertical-align: inherit;">Bei UART wird die LED-ID zweimal hintereinander in einem geraden und ungeraden Frame angezeigt. </font><font style="vertical-align: inherit;">Beim ersten Mal leuchtet die LED auf. </font><font style="vertical-align: inherit;">Der Timer erlischt nach einer bestimmten Zeit (in meinem Fall 15 ms). </font><font style="vertical-align: inherit;">Das zweite Mal wird einfach ignoriert. </font><font style="vertical-align: inherit;">Der Timer ist im CTC-Modus so konfiguriert, dass alle 1 ms ein Interrupt auftritt.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* Current ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> ledID_prev = <span class="hljs-number"><span class="hljs-number">255</span></span>;  <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID value */</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Flash duration value */</span></span><font></font>
<font></font>
ISR(USART_RXC_vect) <span class="hljs-comment"><span class="hljs-comment">/* UART interrupt handler */</span></span><font></font>
{<font></font>
	ledID = UDR; <span class="hljs-comment"><span class="hljs-comment">/* Assign ledID to receive via UART value */</span></span>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ledID != ledID_prev) <span class="hljs-comment"><span class="hljs-comment">/* If current ledID equal to previous value */</span></span><font></font>
	{<font></font>
		turnOnLED(ledID); <span class="hljs-comment"><span class="hljs-comment">/* Turn on the ledID LED */</span></span>
		timer0Start(); <span class="hljs-comment"><span class="hljs-comment">/* Start Timer0 */</span></span>
		ledID_prev = ledID; <span class="hljs-comment"><span class="hljs-comment">/* Previous ledID assign to current */</span></span>
		duration = FLASH_DURATION; <span class="hljs-comment"><span class="hljs-comment">/* Update LED flash duration */</span></span><font></font>
	}<font></font>
}<font></font>
<font></font>
ISR(TIMER0_COMP_vect) <span class="hljs-comment"><span class="hljs-comment">/* Timer0 compare interrupt handler */</span></span><font></font>
{<font></font>
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (--duration == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* Decrement Duration value each 1ms and if it reach to 0 */</span></span><font></font>
	{<font></font>
		timer0Stop(); <span class="hljs-comment"><span class="hljs-comment">/* Stop Timer0 */</span></span>
		turnOffAllLED(); <span class="hljs-comment"><span class="hljs-comment">/* Turn off all LEDs */</span></span>
		timer0Clear(); <span class="hljs-comment"><span class="hljs-comment">/* Clear Timer0 counter register */</span></span><font></font>
	}<font></font>
}<font></font>
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zeitkritischen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abschnitte des Codes, bei denen es sich um 1-Draht-Signale handelt, werden in ein </font><b><font style="vertical-align: inherit;">ATOMIC_BLOCK-</font></b><font style="vertical-align: inherit;"> Konstrukt eingeschlossen. </font><font style="vertical-align: inherit;">Alle Grundeinstellungen werden in </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">global.h vorgenommen</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">UART arbeitet mit einer Geschwindigkeit von 250.000. Schnell und fehlerfrei für 16-MHz-Quarz. </font><font style="vertical-align: inherit;">Der DS18B20-Treiber verfügt über die für dieses Projekt erforderliche Mindestfunktionalität. </font><font style="vertical-align: inherit;">Der Rest - siehe Code. </font><font style="vertical-align: inherit;">Es wird Fragen geben - fragen Sie, seien Sie nicht schüchtern. </font><font style="vertical-align: inherit;">Ich möchte Sie auch an die Einstellungen der Sicherungen erinnern. </font><font style="vertical-align: inherit;">Es ist notwendig, die Taktfähigkeit des externen Quarzes in ihnen einzustellen, andernfalls wird sie vom internen Generator stammen (und sie liegt bei maximal 8 MHz und ist nicht sehr stabil). </font><font style="vertical-align: inherit;">Nun, programmieren Sie das CKOPT-Bit, sonst startet Quarz über 8 MHz nicht. </font><font style="vertical-align: inherit;">Ich habe </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">High Fuse = 0xD9</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Low Fuse = 0xFF</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulink-Modell + Operationsalgorithmus</font></font></h1><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matlab R2015b</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Version </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Simulink</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , zusätzlich zu der eingebauten Bibliothek, hauptsächlich verwendet , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computer Vision System Toolbox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bild Aquisition Toolbox</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Das gesamte Modell und die zugehörigen Dateien werden auf </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hochgeladen </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Nachfolgend finden Sie eine detaillierte Beschreibung mit veranschaulichenden Beispielen. </font><font style="vertical-align: inherit;">Alle Bilder sind anklickbar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebCamTemp-Modul</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/f1d/b35/8bb/f1db358bbf3f4bb4b9b31dc3724daf27.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die gelben Blöcke zeigen COM-Port-Blöcke an. Sender, Empfänger und Konfigurator getrennt. Die Porteinstellungen müssen genau mit dem Mikrocontroller übereinstimmen (Geschwindigkeit, Parität, Anzahl der Bits usw.). Der Empfänger empfängt Temperatur, es in ein eindimensionales Array der Größe Gruppierung </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[n 1]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Typ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">int16</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , wobei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - die Anzahl DS18B20 (I 6) aufweist </font><font style="vertical-align: inherit;">. Jedes Element dieses Arrays wird weiter durch </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 geteilt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dies geht aus dem </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datenblatt auf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Seite 6 hervor. Der Sender sendet den aktuellen Zählerwert an den </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zähler</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Es leuchtet nur eine bestimmte LED. Ticking von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bis </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Periode 2 Proben. </font><font style="vertical-align: inherit;">Die Blöcke, die für die Anzeige / Speicherung des Videostreams verantwortlich sind, sind blau gruppiert. </font><font style="vertical-align: inherit;">Grüne Blöcke zum Empfangen von Videoinformationen. </font><font style="vertical-align: inherit;">Eigentlich die Webcam selbst. </font><font style="vertical-align: inherit;">Es gibt viele Einstellungen, die je nach Hersteller unterschiedlich sind. </font><font style="vertical-align: inherit;">Das Bild wird in Grautönen angezeigt. </font><font style="vertical-align: inherit;">So interessant. </font><font style="vertical-align: inherit;">Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diff-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">macht den Unterschied zwischen dem vorherigen und dem aktuellen Frame. </font><font style="vertical-align: inherit;">Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ungerade Downsample-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">hebt nur den beleuchteten Unterschied hervor - keine leuchtende LED, aber nicht umgekehrt. </font><font style="vertical-align: inherit;">Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Downsample-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">überspringt </font><b><font style="vertical-align: inherit;">sogar</font></b><font style="vertical-align: inherit;"> nur Frames, bei denen die LED nicht </font><b><font style="vertical-align: inherit;">leuchtet</font></b><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img diff</font></font></b><div class="spoiler_text"> ,  —  .        (  ).    ,       .    0.25.<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/tbpDALqIc0g%3Ffeature%3Doembed&amp;usg=ALkJrhg2mAfgg2ySoxXF-4K5feGFDuLR3g" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Img grau</font></font></b><div class="spoiler_text"> ,  — ,     .      ,    .    .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/ATGUUmG77eo%3Ffeature%3Doembed&amp;usg=ALkJrhjEJYAssqzbwQG8weCoGqZfJmIRsQ" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Bildratenanzeige</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zeigt die aktuellen FPS an. </font><font style="vertical-align: inherit;">Die gesamte Verarbeitung erfolgt in den Block- </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LEDs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir werden es wie folgt betrachten.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED-Modul</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/636/73d/92d/63673d92d053459c9c0c226edded2d13.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Violett gruppierte Blöcke zum Erhalten von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2D-Gaußschen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir brauchen zwei: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interferenz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opazität</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie unterscheiden sich im Sigma. </font><font style="vertical-align: inherit;">Ihr Zentrum befindet sich am Maximalpunkt (an dem die LED leuchtet). </font><font style="vertical-align: inherit;">Die Koordinaten befinden sich im Block </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maximum</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Anstatt solche Gaußschen ständig zu erzeugen (und der Exponent ist eine sehr zeitaufwändige mathematische Operation), wurde beschlossen, sie auszuschneiden. </font><font style="vertical-align: inherit;">Zu diesem </font><b><font style="vertical-align: inherit;">Zweck werden</font></b><font style="vertical-align: inherit;"> in der m-Datei zwei </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Int</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Op</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit 2-mal größeren Größen mit der Mitte in der Mitte </font><font style="vertical-align: inherit;">generiert </font><font style="vertical-align: inherit;">, von denen die erforderlichen einfach mit den Blöcken </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crop Interference</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crop Opacity</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zugeschnitten werden </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeitsbeispiel</font></font></b><div class="spoiler_text">  —   .   —         .   —      .   —     .     0.25.<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/wGYyoVUJ8nQ%3Ffeature%3Doembed&amp;usg=ALkJrhjqVlDatttDlQnPhFTciWrM896V9Q" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Speicherblöcke sind grün eingekreist. Ihr Zweck ist es, die Koordinaten und Gaußschen Werte für jede LED zu speichern. Wir werden im Folgenden näher darauf eingehen. Der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Farbblock </font><font style="vertical-align: inherit;">dient zum Erstellen einer Temperaturverteilung und einer Farbkarte. Wird auch unten diskutiert. Signalzusammensetzungseinheit </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compositing</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mischungen der beiden Bilder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf folgende Weise:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/84a/62d/3d6/84a62d3d604b42c5b0923eb74d8d58d4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Block </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> einfügen fügt dem Bild formatierten Text (in diesem Fall Temperatur) hinzu. </font><font style="vertical-align: inherit;">Akzeptiert </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variablen und Koordinaten im Format </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[XY]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sie können die Schriftart und ihre Größe auswählen. </font><font style="vertical-align: inherit;">Die Blöcke innerhalb des roten Rechtecks ​​implementieren </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">den Algorithmus für den gleitenden Durchschnitt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Übergänge werden weniger nervös, was die Nerven schont und das Auge erfreut.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beispiel</font></font></b><div class="spoiler_text"> ,  —    8- .            (  )     .<br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/Z8NgbGUZS50%3Ffeature%3Doembed&amp;usg=ALkJrhhAti1UxecqJexOVIRLu6eoLlkyyw" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speichermodule</font></font></h2><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicherinterferenz</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicheropazität</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> speichern 2D-Gauß-Sätze, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicherpunkte</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Koordinaten für jede LED.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicherstörungen und Speicheropazität</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/06d/f15/23e/06df1523e1d245f7b824b151f7dfa0e3.bmp"></a>   .   <b>Address</b>       .   .     .  <b>Delay</b>  <b>LEDs</b>     (  ,    ).      .  <b>Enable</b>  .   ,      (  <b>Maximum</b>  <b>Threshold</b>  <b>LEDs</b>).    —    .       .      <b>[H W n]</b>,  <b>HxW</b> —  -,   <b>n</b> —  /.<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speicher pts</font></font></b><div class="spoiler_text"><a href=""><img align="left" src="https://habrastorage.org/files/f25/02b/441/f2502b4415bd4badad2de75142a84044.bmp"></a>     .           .   <b>Permute Matrix</b>    ,     <b>[Y X]</b>,   <b>[X Y]</b>.<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul färben</font></font></h2><br>
<a href=""><img align="left" src="https://habrastorage.org/files/ff4/661/f73/ff4661f7313342bc87aab6257d405ee9.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grün - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deckkraftverarbeitung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fassen Sie das Eingabearray in der dritten Dimension zusammen. Wir normalisieren es auf das Maximum. Multiplizieren Sie mit dem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verstärkungswert</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (von 0 bis 1) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Insgesamt haben wir ein Array mit überlagerten Gaußschen und maximaler </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verstärkung</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wird als </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Faktor</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zum Mischen von Bildern verwendet. Rot - erhält eine Farbkarte der Temperaturen. Hier ein bisschen andere Mathematik, alle die gleichen Gaußschen. Es wird durch Formel </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2) beschrieben</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Grob gesagt ist die Temperatur an einem beliebigen Punkt der gewichtete Durchschnitt aller Sensoren. Der Einfluss jedes Sensors in einem prozentualen Verhältnis ist jedoch proportional zum Wert des darin enthaltenen Gaußschen. Die Summe aller wird als 100% angenommen.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/87a/e2d/4a3/87ae2d4a31ba4759bb9cf4d093fff846.gif"></div><br>
<a href=""><img align="left" src="https://habrastorage.org/files/c51/f48/e29/c51f48e29b614eb28a0134f517ee49e8.bmp"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es bleibt zu überlegen, wie sich die Temperaturverteilung in eine Farbkarte verwandelt. </font><font style="vertical-align: inherit;">Was blau eingekreist ist, verwandelt eine bestimmte Temperatur in einen Wert zwischen 0 und 1. In der roten Zone </font><font style="vertical-align: inherit;">berechnet der </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prelookup-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">den Index, nach dem der Wert von Rot, Grün und Blau gesucht wird. </font><font style="vertical-align: inherit;">Das Farbarray enthält 64 Werte. </font><font style="vertical-align: inherit;">Zwischenprodukte werden durch Interpolation berechnet. </font><font style="vertical-align: inherit;">Von den Funktionen gibt es zwei Modi: relativ und absolut. </font><font style="vertical-align: inherit;">An der relativ kältesten und heißesten Stelle entsprechen das Minimum und das Maximum des Eingabearrays. </font><font style="vertical-align: inherit;">In absoluten Zahlen gibt es einige konstante Werte. </font><font style="vertical-align: inherit;">Im ersten Fall ist es bequemer, das Temperaturverteilungsprofil zu betrachten. </font><font style="vertical-align: inherit;">In der anderen ändert sich absolut.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m Datei</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird zu Beginn vor der Simulation ausgeführt und führt Variablen in den Arbeitsbereich ein.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code</font></font></b><div class="spoiler_text"><pre><code class="matlab hljs">H = <span class="hljs-number"><span class="hljs-number">480</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Height of image</span></span>
W = <span class="hljs-number"><span class="hljs-number">640</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Width of image</span></span>
minT = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Min temperature</span></span>
maxT = <span class="hljs-number"><span class="hljs-number">25</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Max temperature</span></span>
sigmaInt = <span class="hljs-number"><span class="hljs-number">40</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma interference</span></span>
sigmaOp = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Sigma opacity</span></span>
gain = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Gain value</span></span>
T = <span class="hljs-number"><span class="hljs-number">0.3</span></span>; <span class="hljs-comment"><span class="hljs-comment">% Threshold value</span></span>
nAvr = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-comment"><span class="hljs-comment">% number of means</span></span>
<span class="hljs-comment"><span class="hljs-comment">% ------------------------------------------------------</span></span>
[M,N] = <span class="hljs-built_in"><span class="hljs-built_in">meshgrid</span></span>(-W:W, -H:H); <span class="hljs-comment"><span class="hljs-comment">% Meshgrid function</span></span><font></font>
<font></font>
R = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(M.^<span class="hljs-number"><span class="hljs-number">2</span></span> + N.^<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Distance from the center</span></span><font></font>
<font></font>
Int = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaInt); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for interference</span></span>
Op = normpdf(R, <span class="hljs-number"><span class="hljs-number">0</span></span>, sigmaOp); <span class="hljs-comment"><span class="hljs-comment">% 2D gaussian for opacity</span></span><font></font>
<font></font>
Int = Int/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Int)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of interference gaussian</span></span>
Op = Op/<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(Op)); <span class="hljs-comment"><span class="hljs-comment">% Normalization of opacity gaussian</span></span><font></font>
<font></font>
clear M N R sigmaInt sigmaOp <span class="hljs-comment"><span class="hljs-comment">% Delete unused variables from memory</span></span><font></font>
<font></font>
load(<span class="hljs-string"><span class="hljs-string">'MyColormaps'</span></span>,<span class="hljs-string"><span class="hljs-string">'mycmap'</span></span>); <span class="hljs-comment"><span class="hljs-comment">% Load colormap</span></span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es enthält die wichtigsten Steuervariablen, darunter:</font></font><br>
<ul>
<li><b>H</b> —    .</li>
<li><b>W</b> —    .</li>
<li><b>minT</b> —   .</li>
<li><b>maxT</b> —   .</li>
<li><b>sigmaInt</b> —   Interference.</li>
<li><b>sigmaOp</b> —   Opacity.</li>
<li><b>gain</b> —   Factor.</li>
<li><b>T</b> —    .</li>
<li><b>nAvr</b> —     .</li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> müssen mit dem Strom im WebCamera-Block übereinstimmen. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">minT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maxT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beeinflussen die Farbkarte im absoluten Temperaturmodus. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T wird</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von 0 auf 1 gesetzt. Manchmal sind der COM-Anschluss und die Webcam nicht synchron. </font><font style="vertical-align: inherit;">Die Phase des Differenzbildes kann sich um 180 ° ändern. </font><font style="vertical-align: inherit;">Und wo es ein Maximum geben sollte, gibt es ein Minimum. </font><font style="vertical-align: inherit;">Und das System kann eine beliebige Koordinate wählen, die nicht der Realität entspricht. </font><font style="vertical-align: inherit;">Hierfür gibt es ein Schwellensystem. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nAvr ist die</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Anzahl der Durchschnittswerte im gleitenden Durchschnitt. </font><font style="vertical-align: inherit;">Je größer es ist, desto glatter werden die Übergänge, aber die Relevanz geht verloren (eine Zeitverschiebung erscheint). </font><font style="vertical-align: inherit;">Um die Wirkung der verbleibenden Variablen zu verstehen, kann man ohne anschauliche Beispiele nicht verstehen.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SigmaInt-Effekt</font></font></b><div class="spoiler_text"> <img src="https://habrastorage.org/files/dd4/52e/fa0/dd452efa07f74879864a7da50c880f39.gif">      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>.  <img src="https://habrastorage.org/files/5de/994/dd0/5de994dd0e834600b8fff948ae13eb07.gif">       ,   , .   —    .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/cZV_ayNrWgE%3Ffeature%3Doembed&amp;usg=ALkJrhjFOFA_wnwhj8zwZxkcY9BLvkJisA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SigmaOp-Effekt</font></font></b><div class="spoiler_text">     .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/S8R4A9AKFZU%3Ffeature%3Doembed&amp;usg=ALkJrhh9C458d7elwnM6q0B1C9z9Mt_iFA" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Effekt erzielen</font></font></b><div class="spoiler_text">-   .    «»  « »  .<br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/mvKfUSIw3rI%3Ffeature%3Doembed&amp;usg=ALkJrhiJeSJ-tBlpsEIzYrQZ-h4_u99K2g" frameborder="0" allowfullscreen=""></iframe><br>
</div></div><br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experimente</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Folgende sind einige Experimente.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fenster öffnen</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sensoren sind am Fenster am Bett verstreut. </font><font style="vertical-align: inherit;">Das Fenster öffnet und schließt sich nach einer Weile. </font><font style="vertical-align: inherit;">Ein gutes Beispiel für den Unterschied zwischen dem relativen (links) und dem absoluten (rechts) Modus. </font><font style="vertical-align: inherit;">Bei der ersten Methode ist es zweckmäßig, die Verteilung und bei der zweiten die Verteilung der Kälte oder die Wiederherstellung der Wärme zu berücksichtigen.</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/AlDT9XyCSeo%3Ffeature%3Doembed&amp;usg=ALkJrhhYwNjaw3ovPhBrQThb_ATZgLuQNw" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windowsill</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sensoren befinden sich entlang der Fensterbank. </font><font style="vertical-align: inherit;">Das Fenster öffnet sich - das Profil ändert sich. </font><font style="vertical-align: inherit;">Die kältesten und wärmsten Zonen sind deutlich sichtbar.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/OX8_0pjPLZg%3Ffeature%3Doembed&amp;usg=ALkJrhgaLlUiDJwdsQh07O8twDe25MdP8g" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ist es oben wärmer?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie sagen, dass die Oberseite wärmer ist. </font><font style="vertical-align: inherit;">Dieses Experiment ist eine vollständige Bestätigung dafür. </font><font style="vertical-align: inherit;">In der 10. Sekunde öffnet sich das Fenster, in der 30. - es schließt sich.</font></font><br>
<br>
<iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/pUDan07bd-E%3Ffeature%3Doembed&amp;usg=ALkJrhiANqntYnCQLdhx-f-O3UbMblbSgQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein solches Schema ersetzt keine vollwertige Wärmebildkamera. </font><font style="vertical-align: inherit;">Aber er kann die Ausbreitung der Luftmassen nicht sehen. </font><font style="vertical-align: inherit;">Und zu einem Preis ist dieses Design unvergleichlich niedriger. </font><font style="vertical-align: inherit;">Sie können eine andere Farbkarte verwenden. </font><font style="vertical-align: inherit;">Sie können andere Funktionen anstelle von Gaußschen übernehmen. </font><font style="vertical-align: inherit;">Sie können sogar die Baugesetze ändern. </font><font style="vertical-align: inherit;">Oder schreiben Sie OpenCV + QT neu, um Geschwindigkeit und Komfort zu gewährleisten. </font><font style="vertical-align: inherit;">Aber das habe ich mir vorgestellt - ich habe es erreicht. </font><font style="vertical-align: inherit;">Nur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum Spaß</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de390985/">https://habr.com/ru/post/de390985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de390975/index.html">Прогнозы на 2016 год: три основных тенденции полупроводниковой отрасли</a></li>
<li><a href="../de390977/index.html">Sony News auf der MWC 2016: Xperia X, Xperia X Performance und Xperia XA</a></li>
<li><a href="../de390979/index.html">Lenovo Ideacentre Stick 300: Klein Ja</a></li>
<li><a href="../de390981/index.html">Wie Motorika Zahnersatz für Kinder herstellt</a></li>
<li><a href="../de390983/index.html">Wölfe und Schafe, Zombies und Hummerfallen: Ein kurzes Wörterbuch des Stock Slang</a></li>
<li><a href="../de390987/index.html">Sony kaufte ein Video eines russischen Künstlers und blockierte es (wieder) auf YouTube.</a></li>
<li><a href="../de390989/index.html">Fairphone 2 Modular Phone jetzt verfügbar</a></li>
<li><a href="../de390993/index.html">Das Schmetterlingsauge wurde zum Modell für Graphenrektene mit Rekordlichtabsorption</a></li>
<li><a href="../de390995/index.html">MasterCard bereitet Kundenüberprüfungsoptionen mithilfe von Selfies, Sprachtönen und Herzfrequenz vor</a></li>
<li><a href="../de390997/index.html">9 Drohnen, die keine Registrierung benötigen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>