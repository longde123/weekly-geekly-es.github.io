<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📗 🔋 👎🏻 Erstellen eines RPM-Pakets für Rosa Linux in der Praxis 👩🏽‍🤝‍👨🏿 📑 🏺</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wenn Sie das Linux-Betriebssystem schon lange verwenden und sogar ein wenig über Programmierung wissen, müssen Sie das Programm möglicherweise früher ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen eines RPM-Pakets für Rosa Linux in der Praxis</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464993/"><p>  Wenn Sie das Linux-Betriebssystem schon lange verwenden und sogar ein wenig über Programmierung wissen, müssen Sie das Programm möglicherweise früher oder später aus dem Quellcode kompilieren.  Möglicherweise befindet sich das gewünschte Programm nicht in den Distributions-Repositorys.  Oder das Programm hat eine alte Version in diesen Repositorys, und Sie benötigen die neueste.  Oder Sie haben ein neues Programm erstellt und möchten es mit anderen Benutzern teilen. <br></p><br><p>  Natürlich können Sie das Programm gemäß den Anweisungen installieren, die mit dem Quellcode geliefert wurden.  Dann müssen Sie die Programmdateien manuell verwalten und ihre Abhängigkeiten überwachen.  Es ist viel besser, ein Paket mit dem Programm zu erstellen und den im Betriebssystem integrierten Anwendungsmanager zu verwenden. <br></p><br><p>  Ich hoffe, dieser Artikel hilft Ihnen dabei, schnell herauszufinden, wie Sie ein RPM-Paket für <em>Rosa Linux</em> oder eine andere Distribution erstellen, die den RPM-Paketmanager (Mandriva, RedHat) verwendet.  Oder sag mir wenigstens, wo ich nach Informationen suchen soll. <br></p><br><p>  Hier werde ich anhand eines einfachen Beispiels zeigen, wie RPM-Pakete auf meinem lokalen Computer erstellt werden.  Wir werden das <em>xkb-switch-</em> Programm im <em>Rosa Linux-</em> Betriebssystem <em>erstellen</em> .  Wir werden den Quellcode des Programms von <em>GitHub übernehmen</em> . <br></p><br><br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Der Artikel ist in viele kurze Teile unterteilt, sodass sich das Inhaltsverzeichnis unter dem Spoiler befindet</b> <div class="spoiler_text"><h2>  Inhaltsverzeichnis </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein bisschen über Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein bisschen über xkb-switch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einrichten, Finalisieren, Überprüfen des Programms</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Überprüfen des Quellcodes ohne Ihr Profil auf GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Überprüfung beim Speichern des Projekts in Ihrem GitHub-Profil</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Patches erstellen</a> </li></ul><br></li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bereiten Sie den "Arbeitsplatz" vor, um ein Paket zu erstellen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beginnen wir mit der Erstellung einer Spezifikationsdatei</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein bisschen über die Syntax von Spezifikationsdateien</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spec-Datei-Header</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellenvorbereitung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusammenstellung</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datei packen</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Was ist RPMLint?</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Arten von RPM-Paketen für Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Unser Ergebnis</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wenn Sie das Paket in Teile teilen müssen</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fügen Sie einige Makros hinzu</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ändern Sie den Titel ein wenig</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bibliothekspakete definieren</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Definieren Sie Dateien für Pakete</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zusätzliche Probleme lösen</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fazit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptteams</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nützliche Befehle zum Erstellen eines Pakets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Überprüfen Sie das fertige Paket</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nützliche Links (Hauptquellen)</a> </li></ul><br></div></div><br><br><a name="foreword"></a><br><h2>  Ein bisschen über Rosa Linux </h2><br><p>  <em>Rosa Linux</em> ist eine Distribution, die von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">russischen Entwicklern</a> erstellt und unterstützt wird.  Es basiert auf <em>Mandriva</em> , aber mit einigen Funktionen.  Ich verwende die 32-Bit-Version von <em>Rosa Fresh R8</em> , die 2014 veröffentlicht wurde.  Jetzt wird die <em>R8-</em> Version von Entwicklern nicht mehr unterstützt (Repositorys dafür werden nicht aktualisiert), aber sie funktioniert gut auf meinem Laptop, sodass ich keine neue Version installieren möchte. <br></p><br><p> <em>Rosa Fresh R8</em> Verwendet den <em>KDE4-</em> Desktop.  Alle Versionen des Distributionspakets verwenden <code>urpm</code> und <code>urpm</code> Manager, um Pakete mit Anwendungen zu verwalten. Die entsprechenden Befehle lauten <code>rpm</code> , <code>urpmi</code> , <code>urpme</code> , <code>urpmq</code> , <code>urpmf</code> . <br></p><br><p>  Die Prinzipien zur Erstellung von Softwarepaketen werden normalerweise selten innerhalb derselben Linux-Distributionsfamilie geändert.  Daher sollte das, was in diesem Artikel beschrieben wird, in allen Versionen von <em>Rosa-</em> Distributionen funktionieren. <br></p><br><p>  Das <em>Erstellen von</em> Paketen unter Rosa Linux ist etwas einfacher als bei einigen anderen <em>RPM-</em> basierten Distributionen.  Einige Punkte sind automatisiert und müssen nicht konfiguriert werden. <br></p><br><br><a name="foreword-xkb-switch"></a><br><h2>  Ein bisschen über xkb-switch </h2><br><p>  Mir hat die Idee gefallen, das Plugin für den Vim-Texteditor <em>xkbswitch zu verwenden</em> , über den es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Artikel über Habré gibt</a> .  Beim Verlassen des Eingabemodus wird das Tastaturlayout automatisch auf Englisch umgeschaltet und umgekehrt - auf den, auf dem der Text zuletzt eingegeben wurde -, wenn Sie den Eingabemodus erneut aufrufen.  Damit dieses Plugin funktioniert, benötigen Sie das Programm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">xkb-switch</a> , mit dem Sie das Tastaturlayout über die Befehlszeile und über Plugins für den <em>Vim-</em> Editor <em>ändern können</em> .  Dieses Programm befand sich nicht in den <em>Rosa Linux R8-</em> Repositorys (und höchstwahrscheinlich wird es niemand hinzufügen, da die Distribution bereits alt ist und das Programm <em>xkb-switch</em> nicht sehr beliebt ist). <br></p><br><br><a name="test_program"></a><br><h2>  Einrichten, Finalisieren, Überprüfen des Programms </h2><br><p>  Oft ist es notwendig, die Kompilierung des Programms so zu konfigurieren, dass sie in einer bestimmten Distribution oder sogar für ein bestimmtes System korrekt funktioniert.  Es kommt vor, dass ein Programm mit anderen Optionen oder mit der Unterstützung eines speziellen Treibers erstellt werden muss.  Oder vielleicht möchten Sie Fehler im Programmcode beheben oder einfach überprüfen, ob es funktioniert.  Zu diesem Zweck ist es besser, den Quellcode vor dem Erstellen des RPM-Pakets auf Ihren Computer zu kopieren, ihn zu kompilieren und die Funktionsweise des kompilierten Programms zu überprüfen. <br></p><br><p>  Wenn Sie sicher sind, dass Sie die Projektdateien nicht ändern müssen, können Sie den ursprünglichen Quellcode von der Projektwebsite verwenden und sofort mit der Erstellung des Pakets fortfahren.  Wenn Sie jedoch die Kompilierungseinstellungen ändern müssen, ist es normalerweise viel einfacher, die Datei im Quellordner (das sogenannte <em>Makefile</em> ) zu ändern, als sich dann mit den Kompilierungsbefehlsoptionen und dem internen Makrogerät für die Spezifikationsdatei zu befassen. <br></p><br><br><a name="test_program-local"></a><br><h3>  Überprüfen des Quellcodes ohne Ihr Profil auf GitHub </h3><br><p>  Wenn Sie mit dem Quellcode oder den Einstellungen für die Projektkompilierung arbeiten möchten, aber kein eigenes Profil auf GitHub haben oder es nicht verwenden möchten, können Sie den Quellcode einfach herunterladen und entpacken.  In unserem Fall könnte es so aussehen (ich verwende den Ordner <code>~/Projects/cpp</code> für <em>C ++ -</em> Quellcode): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Dadurch wird der Ordner <code>~/Projects/cpp/xkb-switch</code> , der den Quellcode enthält.  Anstatt <code>git</code> Sie das Archiv natürlich mit dem Programm herunterladen und entpacken. <br></p><br><p>  Aus der Datei <code>README.md</code> im Projektordner lässt sich leicht <code>cmake</code> dass das Dienstprogramm <code>cmake</code> zum Erstellen des Programms verwendet wird.  Wenn Sie die Kompilierungseinstellungen ändern müssen, befinden sie sich in unserem Fall in der Datei <code>CMakeLists.txt</code> .  Und wir versuchen nur, das Programm zu kompilieren und zu überprüfen, ob es funktioniert.  Welche Befehle Sie dafür verwenden müssen, wird in dieselbe <code>README.md</code> Datei im Stammverzeichnis des Projekts geschrieben. <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> xkb-switch mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make ./xkb-switch <span class="hljs-comment"><span class="hljs-comment">#         ./xkb-switch -l #       ./xkb-switch -s ru #       (  )</span></span></code> </pre><br><br><p>  Danach müssen Sie den <code>build</code> Ordner aus dem Projekt löschen oder löschen und den Quellcode in das Archiv packen, um das geänderte Projekt verwenden zu können.  Es könnte so aussehen: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/xkb-switch rm -rf ./build <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp zip -r xkb-switch.zip xkb-switch</code> </pre><br><br><p>  Die Datei <code>xkb-switch.zip</code> dann zum Erstellen des Pakets verwendet werden. <br></p><br><br><a name="test_program-github"></a><br><h3>  Überprüfung beim Speichern des Projekts in Ihrem GitHub-Profil </h3><br><p>  Ich gehe davon aus, dass jeder, der diesen Abschnitt liest, zumindest ein wenig mit der Arbeit mit <em>Git</em> vertraut ist und bereits ein Profil auf <em>GitHub erstellt hat</em> .  Ich denke, diese Methode ist die beste, daher impliziert der Rest des Artikels, dass sie verwendet wird, sofern nicht anders angegeben. <br></p><br><p>  Zuerst müssen Sie das ursprüngliche Projekt in Ihren <em>GitHub einteilen</em> .  Danach klonen wir wie in der vorherigen Methode das Projekt auf unseren Computer, jedoch aus unserem Repository (in meinem Fall lautet der Benutzername <em>alexandersolovyov</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/alexandersolovyov/xkb-switch.git</code> </pre><br><br><p>  Um Änderungen hinzuzufügen, ist es besser, einen neuen Zweig zu verwenden.  Auf Wunsch können dann verschiedene Versionen des Programms verwendet werden.  Außerdem können dem Projektautor mithilfe von Pull-Requests Änderungen vorgeschlagen werden.  Wenn Sie beispielsweise die Datei <code>CMakeLists.txt</code> ein wenig reparieren <code>CMakeLists.txt</code> , müssen Sie zuvor einen neuen Zweig erstellen mit: <br></p><br><br><pre> <code class="bash hljs">git branch cmake_corrections</code> </pre><br><br><p>  Nachdem die Änderungen vorgenommen, überprüft und dem Zweig hinzugefügt wurden (mit <code>git commit -am " "</code> ), können Sie Ihrem GitHub einen neuen Zweig hinzufügen: <br></p><br><br><pre> <code class="bash hljs">git push origin cmake_corrections</code> </pre><br><br><p>  Danach können Sie bei Bedarf eine Pull-Anfrage stellen. <br></p><br><p>  Sie können einen Link zum ursprünglichen Repository erstellen: <br></p><br><br><pre> <code class="bash hljs">git remote add ierton https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Aktualisieren Sie anschließend den Hauptzweig Ihres Repositorys so, dass er mit dem Original übereinstimmt: <br></p><br><br><pre> <code class="bash hljs">git pull ierton master</code> </pre><br><br><p>  Der Programmcode, der dem korrigierten Zweig entspricht, kann beim Erstellen der Drehzahl verwendet werden.  Dazu müssen Sie die Adresse des Archivs im Formular in der Spezifikationsdatei angeben: <br></p><br><br><pre> <code class="plaintext hljs">Source0: https://github.com/-/-/archive/---.zip</code> </pre><br><br><p>  Dies ist jedoch nicht der Fall, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wie der specblog-Benutzer aufgefordert</a> hat.  Es ist besser, Ihre Änderungen in Form von Patches zu übermitteln.  Dazu müssen Sie Patch-Dateien aus den Änderungen in Ihrem Zweig erstellen und in den <code>~/rpmbuild/SOURCES/</code> kopieren, um das Paket zu erstellen ( <code>~/rpmbuild/SOURCES/</code> ).  Dann müssen Sie sie in der Spezifikationsdatei angeben.  Wir werden dies etwas später betrachten, aber wenn Sie möchten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">können Sie es hier lesen</a> .  Wenn Sie nicht wissen, wie man Patches erstellt, können Sie unter dem Spoiler nachsehen. <br></p><br><br><a name="test_program-github-patches"></a><br><div class="spoiler">  <b class="spoiler_title">So erstellen Sie Patches mit git</b> <div class="spoiler_text"><h4>  Patches erstellen </h4><br><p>  <em>Patches</em> , sie sind <em>Patches</em> - dies sind Dateien, in denen Änderungen im Quellcode des Programms aufgezeichnet werden.  Sie werden als Alternative zu den Befehlen <code>git pull</code> und <code>git push</code> für die Kommunikation zwischen lokalen Code-Repositorys verwendet, wenn es nicht bequem ist, Änderungen aus einem Remote-Repository abzurufen, oder wenn der Änderungsverlauf des Projekts und die Prinzipien der Arbeit damit so sind, dass es besser ist, Patches zu verwenden. <br></p><br><br><p>  Stellen wir uns vor, wir müssen Änderungen an der Datei <code>CMakeLists.txt</code> .  Zuerst müssen Sie alles wie oben beschrieben tun: Der Hauptzweig in unserem GitHub-Repository sollte dem Hauptzweig des ursprünglichen Projekts entsprechen, und für Ihre Änderungen müssen Sie den Zweig <em>cmake_corrections verwenden</em> .  Dann müssen Sie zu diesem Zweig gehen, die erforderlichen Änderungen vornehmen und sie mithilfe von Commits in <em>Git</em> speichern. <br></p><br><p>  Jetzt müssen Sie die Änderungen als Patch-Dateien im Ordner <code>~/rpmbuild/SOURCES</code> (wenn Sie Rosa Linux nicht verwenden, kann der Pfad zum Ordner <code>~/rpmbuild/SOURCES</code> unterschiedlich sein).  Zum Beispiel dies (ich meine, wir befinden uns im Projektordner - zum Beispiel <code>~/Projects/cpp/xkb-switch</code> - und im Zweig <code>cmake_corrections</code> ): <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES origin/master</code> </pre><br><p>  Der Befehl <code>git format-patch</code> erstellt für jedes Commit eine <code>git format-patch</code> Datei.  In diesem Formular werden Patches erstellt, die mit dem durch das letzte Argument angegebenen Commit beginnen und mit dem letzten Commit des aktuellen Zweigs enden.  Sie können ein Commit auf folgende Weise angeben: am Anfang des Hashs mit dem <em>HEAD-</em> Zeiger oder dem Namen des Zweigs, der nun das gewünschte Commit angibt.  Die Hauptsache ist, dass eines der Commits, die sichtbar sind, wenn das <code>git log</code> ausgeführt wird, als Start genommen wird.  Das heißt, Sie können keine Patches aus einem Commit erstellen, das sich in einem anderen Zweig befindet. <br></p><br><p>  Und Sie können sich erinnern (oder sehen), wie viele Commits wir vom Hauptzweig zurückverzweigt haben, und Patches für eine bestimmte Anzahl von Commits zurück erstellen.  Wenn wir beispielsweise zwei Commits ausführen würden, wäre der Befehl: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES -2</code> </pre><br><p>  Hier wird die Anzahl der Commits mit <code>-2</code> .  Sie können anstelle dieser Zahl eine beliebige Anzahl von ihnen angeben. <br></p><br><p>  Sie können den Bereich der Commits angeben, aus denen Patches erstellt werden sollen, indem Sie zwei Punkte zwischen die Links zu den anfänglichen und endgültigen Commits setzen: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES master..cmake_corrections</code> </pre><br><p>  Der Name jeder Patch-Datei besteht aus einer Seriennummer und der ersten Zeile eines Commit-Kommentars.  Daher ist es besser, jede Datei umzubenennen, damit die Beschreibung des Patches kurz und klar sein Wesen beschreibt.  Zum Beispiel so: <br></p><br><pre> <code class="bash hljs">mv 0001-Return-memory-allocated-by-XkbRf-getNamesProp()-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-tmp.patch 001-Fix-memory-leak.patch</code> </pre><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Namenskonvention für Patches im Artikel über die Syntax der Spezifikationsdatei</a> empfiehlt, vor der Beschreibung jeder Patch-Datei <em>package_name-version-rosa-</em> hinzuzufügen.  Möglicherweise empfiehlt sich dies, wenn Sie Patches per E-Mail senden, jedoch nicht zum Erstellen von Paketen.  Wir erstellen Pakete auf unserem Computer. Es ist daher besser, den Ordner <code>~/rpmbuild/SOURCES</code> jedes Mal zu leeren, bevor Sie <code>~/rpmbuild/SOURCES</code> Paket mit einem anderen Programm oder einem neuen Versionspaket erstellen. <br></p><br><p>  Wenn Sie nun den Haupt-Repository-Zweig ( <em>Master</em> ) so aktualisieren müssen, dass er mit dem Original übereinstimmt, muss der Änderungszweig ( <em>cmake_corrections</em> ) anschließend mit dem <code>git rebase</code> aktualisiert werden.  Wie das geht, können Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier sehen</a> .  Danach müssen die Patches neu erstellt werden. <br></p><br></div></div><br><br><a name="prepare"></a><br><h2>  Bereiten Sie den "Arbeitsplatz" vor, um ein Paket zu erstellen </h2><br><p>  Zuerst müssen Sie eine Verzeichnisstruktur erstellen.  Die gesamte Montage erfolgt im Ordner <code>rpmbuild</code> im <code>rpmbuild</code> Ordner des <code>rpmbuild</code> .  Erstellen Sie die anfängliche Verzeichnisstruktur und wechseln Sie in den Ordner für die Spezifikationsdateien: <br></p><br><br><pre> <code class="bash hljs">mkdir -p ~/rpmbuild/SPECS &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/SPECS</code> </pre><br><br><p>  Für Rosa Linux reicht dies aus: Die verbleibenden Ordner werden automatisch erstellt. <br></p><br><p>  Eine andere Distribution verwendet möglicherweise einen anderen Dateispeicherort, um das Paket zu erstellen.  Möglicherweise müssen Sie die gesamte Ordnerhierarchie manuell erstellen.  Suchen Sie nach Informationen für Ihre Distribution, wenn Sie Rosa Linux nicht verwenden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dies könnte</a> beispielsweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in Red Hat so aussehen</a> . <br></p><br><p>  Wenn das Paket mit Fehlern erstellt wurde, <code>rpmbuild</code> nicht alle mit dem Befehl <code>rpmbuild</code> erstellten Dateien gelöscht - genau wie bei einer erfolgreichen Erstellung.  Wir werden viele Male versuchen, das Paket zu sammeln, und die nach dem letzten Mal verbleibenden Dateien werden stören.  Daher ist es besser, ein einfaches Skript zu erstellen, mit dessen Hilfe sie schnell entfernt werden können.  Erstellen Sie eine cleanup.sh-Datei und legen Sie sie im <code>~/rpmbuild/SPECS</code> .  Hier sind die Inhalte: <br></p><br><br><pre> <code class="bash hljs">!<span class="hljs-comment"><span class="hljs-comment">#/bin/sh rm -rf ~/rpmbuild/BUILD/* rm -rf ~/rpmbuild/BUILDROOT/* rm -rf ~/rpmbuild/RPMS/* rm -rf ~/rpmbuild/SRPMS/*</span></span></code> </pre><br><br><p>  Natürlich ist es besser, mit dem <code>chmod u+x cleanup.sh</code> Ausführungsrechte dafür <code>chmod u+x cleanup.sh</code> . <br></p><br><p>  Wenn Sie ein Paket aus Dateien sammeln möchten, die sich auf dem lokalen Computer befinden - wenn Sie <em>GitHub</em> nicht verwenden und Änderungen an den Projektdateien vorgenommen haben oder wenn Sie ein Paket aus Ihrem eigenen Programm erstellen möchten, das nur auf Ihrem Computer gespeichert ist -, müssen Sie das Projekt in ein Archiv packen ( B. <code>.zip</code> , <code>.tar</code> oder <code>.tar.gz</code> ) und legen Sie es im Ordner <code>SOURCES</code> .  Zum Beispiel so: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/ zip -r xkb-switch.zip xkb-switch mkdir -p ~/rpmbuild/SOURCES cp xkb-switch.zip ~/rpmbuild/SOURCES/</code> </pre><br><br><p>  Wenn Sie nach dem Erstellen des Programms eine andere oder dieselbe, aber unterschiedliche Version erstellen möchten, müssen Sie alle Dateien aus dem Ordner <code>~/rpmbuild/SOURCES</code> löschen und anschließend Ihr Archiv dort kopieren (wenn Sie es nicht von <em>GitHub</em> herunterladen) und Patch-Dateien (falls verwendet).  Andernfalls wird die Archivdatei höchstwahrscheinlich nicht von <em>GitHub</em> heruntergeladen (warum - siehe später), und es ist auch schwierig herauszufinden, welche Patch-Datei zu welchem ​​Programm gehört. <br></p><br><br><a name="specfile_start"></a><br><h2>  Beginnen wir mit der Erstellung einer Spezifikationsdatei </h2><br><p>  Die Basis für die Erstellung eines RPM-Pakets ist die sogenannte <em>Speck-Datei</em> .  Diese Datei enthält die Anweisungen für das Programm <code>rpmbuild</code> (bzw. <code>rpmbuild</code> das zum <code>rpmbuild</code> des Pakets erforderlich ist. <br></p><br><p>  Erstellen Sie die Datei <code>xkb-switch.spec</code> im <code>~/rpmbuild/SPECS/</code> .  Der einfachste Weg, um zu beginnen, ist mit einer Vorlage, die auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Template Spec Files zu</a> finden ist. <br></p><br><p>  Aus der <code>README</code> auf der <em>xkb-switch-</em> Projektseite <em>ist</em> bekannt, dass das Programm mit dem Dienstprogramm <code>cmake</code> kompiliert wird.  Daher wählen wir die Spezifikationsdatei <strong>für ein mit CMake erstelltes Programm aus</strong> und kopieren die gesamte Vorlage in unsere Spezifikationsdatei.  Um unser RPM-Paket richtig zusammenzustellen, muss diese Vorlage natürlich stark geändert werden, was wir auch tun werden. <br></p><br><br><a name="specfile_syntax"></a><br><h2>  Ein bisschen über die Syntax von Spezifikationsdateien </h2><br><ul><li>  Mit der Syntax der Spezifikationsdatei können Sie Kommentare im Bash-Stil hinzufügen. <br></li><li>  Sie können Leerzeichen als Leerzeichen zwischen den Werten in derselben Zeile verwenden, um das Erscheinungsbild gerader Spalten zu erstellen. In der Dokumentation wird jedoch dringend empfohlen, ein Tabulatorzeichen zu verwenden (ein oder zwei Zeichen, solange die Spalten gerade bleiben).  <strong>Hinweis:</strong> In allen Codebeispielen in diesem Artikel werden nur Leerzeichen verwendet. Es ist daher besser, nicht den gesamten Text von hier in Ihre Spezifikationsdatei zu kopieren, sondern ihn selbst zu drucken. <br></li><li>  Optionsfelder bestehen aus einem speziellen Optionsnamen mit einem Doppelpunkt und dem nächsten Wert über Tabulatoren (oder Leerzeichen).  Der Fall von Zeichen in Feldnamen spielt keine Rolle.  Zum Beispiel: <br><pre> <code class="plaintext hljs"> Name: xkb-switch</code> </pre><br></li><li>  Wenn dem Wort das <code>%</code> -Symbol vorangestellt ist (z. B. <code>%description</code> ), ist dies ein spezielles Schlüsselwort.  Dies kann ein Befehls-, Makro- oder Skriptaufruf sein.  Danach können die verwendeten Parameter angegeben werden.  Und es gibt Schlüsselwörter, die den Beginn eines Befehls- oder Optionsblocks angeben.  Dann können Parameter daneben angegeben werden, und in den nächsten Zeilen sollten Befehle oder eine Liste von Optionen stehen, die ich im vorherigen Absatz beschrieben habe.  Nach einem solchen Block sollte eine leere Zeile übrig bleiben. <br></li><li>  Um den Wert einer Konstante zu verwenden, müssen Sie an einer <code>%{_}</code> eine Konstruktion der Form <code>%{_}</code> einfügen.  Sein Wert kann vordefiniert sein oder durch eine Option (z. B. <code>Name: xkb-switch</code> ) oder mithilfe des Schlüsselworts <code>%define</code> .  Alle diese Konstanten werden auch als Makros betrachtet.  Ihre Verwendung wird nachstehend ausführlicher erörtert. <br></li></ul><br><br><a name="specfile_header"></a><br><h2>  Spec-Datei-Header </h2><br><p>  In der Spezifikationsdatei wird der Header immer zuerst geschrieben.  Dies ist eine Liste von Optionen, die für das Haupt-RPM-Paket gelten.  Wenn das Paket fertig ist, werden fast alle diese Informationen angezeigt, wenn die Beschreibung angezeigt wird.  Die einzelnen Zeilen geben Folgendes an: <br></p><br><br>  <b>Zusammenfassung:</b> <br>  Eine kurze Beschreibung des Pakets.  Ich habe die Beschreibung in der Datei <code>README.md</code> im <em>xkb-switch-</em> Projekt ausspioniert: <code>Query and change XKB layout state</code> . <br><br>  <b>Name:</b> <br>  Der Name des Pakets.  In unserem Fall ist dies ein <code>xkb-switch</code> . <br><br>  <b>Version:</b> <br>  Programmversion.  Um dies herauszufinden, schauen Sie sich am besten die Datei <code>CMakeLists.txt</code> im Projektstammordner an.  Natürlich müssen Sie die Datei aus der Kopie des Projekts entnehmen, das für die Montage verwendet wird.  Wenn Sie das ursprüngliche Projekt verwenden, können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie die Datei direkt auf der GitHub-Seite öffnen</a> .  Wie Sie sehen können, besteht die Version aus <code>MAJOR_VERSION</code> , <code>MINOR_VERSION</code> und <code>RELEASE_VERSION</code> .  Ich habe das Programm Version <code>1.6.0</code> . <br><br>  <b>Veröffentlichung:</b> <br>  Die Versionsnummer des Pakets selbst.  Zeigt an, wann ein Paket mit einem Programm derselben Version zusammengestellt wird.  In unserem Fall ist dies "1", da noch nie jemand ein Programm dieser Version zusammengestellt hat.  Wenn wir im Idealfall bereits versucht haben, das Paket zu erstellen und die Assembly das Ende erreicht hat (auch wenn Fehler aufgetreten sind), müssen Sie diese Zahl nach jedem neuen Versuch um 1 erhöhen und gleichzeitig die alten gesammelten Pakete nicht aus den <code>rpmbuild/RPMS</code> und <code>rpmbuild/SRPMS</code> : Als nächstes werden neue Pakete mit einer neuen Build-Nummer erstellt.  Möglicherweise sollte dies durchgeführt werden, wenn Sie einen speziellen Server für die Montage verwenden.  Wir benutzen unseren Computer und werden stattdessen die Ordner bereinigen.  Wenn sich ein Paket mit einem Programm dieser Version bereits in den Repositorys der Linux-Distribution befindet, Sie jedoch mit anderen Einstellungen kompilieren, ist es besser, die Versionsnummer 1 höher als dieses Paket anzugeben. <br><br>  <b>Lizenz:</b> <br>  Der Kurzname der Lizenz, unter der das Programm vertrieben wird.  Nach den Regeln von Rosa Linux können Sie nur Pakete mit einer Lizenz erstellen, die eine kostenlose Verteilung ermöglicht.  Aus der Datei <code>README.md</code> können Sie <code>README.md</code> , dass die Lizenz <em>GNU GPLv3 ist</em> .  Also schreiben wir: <code>GPLv3+</code> . <br><br>  <b>Gruppe:</b> <br>  Die Gruppe oder Kategorie, zu der das Programm gehört.  Mithilfe dieser Gruppen werden Programme im Anwendungsstartmenü und im Fensterprogramm-Manager („Software hinzufügen oder entfernen“) sortiert.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Liste der Gruppen für Rosa Linux finden Sie hier</a> .  Ich denke, <code>Development\X11</code> ist das Beste für uns, da das Programm mit X11 zusammenhängt und hauptsächlich zum Erstellen von Skripten und Plugins für Vim benötigt wird. <br><br>  <b>URL:</b> <br>  Internetadresse, unter der Sie den Originalquellcode des Programms herunterladen können.  Dies wird beim Anzeigen von RPM-Paketinformationen angegeben.  Dieser Artikel ist optional, wir geben jedoch Folgendes an: <code>https://github.com/ierton/xkb-switch</code> <br><br>  <b>Quelle0:</b> <br>  Der Name der Archivdatei, die den Quellcode enthält, oder die Internetadresse, unter der sie heruntergeladen werden kann.  Wenn Sie im Internet eine Adresse angeben, wird die Datei beim ersten Erstellen nach <code>~/rpmbuild/SOURCES/</code> heruntergeladen.  Wenn eine solche Datei bereits vorhanden ist, wird sie nicht mehr heruntergeladen, <code>rpmbuild</code> Programm <code>rpmbuild</code> nur den am Ende dieser URL angegebenen Dateinamen.  Sie können nur den Dateinamen angeben, dieser muss jedoch manuell im Ordner <code>~/rpmbuild/SOURCES/</code> werden.  Es ist besser, die Adresse Ihrer Kopie des Projekts auf GitHub anzugeben.  Ich habe die Datei <code>https://github.com/alexandersolovyov/xkb-switch/archive/master.zip</code> .  Sie können mehrere verschiedene Quellen angeben, um die Quellen aus mehreren Archiven mithilfe einer Speck-Datei zu sammeln.  Im Namen der Option zum Hinzufügen jedes nachfolgenden Archivs sollte sich dann die Anzahl erhöhen ( <code>Source1</code> , <code>Source2</code> usw.).  Diese Dateiadressen sind beim Anzeigen von RPM-Paketinformationen nicht sichtbar. <br><br>  <b>Patch0:</b> <br>  Diese Option befindet sich nicht in der Vorlagendatei.  Dies kann nützlich sein, wenn Sie Ihre Änderungen in Form von Patches in die Projektdateien des Programms übertragen möchten.  Bei der Option <code>Source0</code> muss jede Datei in einer separaten Zeile angegeben werden, und die Zahl am Ende des Optionsnamens muss jedes Mal erhöht werden.  Die Patch-Dateien sollten sich im Ordner <code>~/rpmbuild/SOURCES</code> (neben dem heruntergeladenen <code>~/rpmbuild/SOURCES</code> ) befinden.  Der Name jeder Datei muss ohne Pfad dazu geschrieben werden.  Es ist nicht erforderlich, alle Patch-Dateien hier anzugeben. Es können nur diejenigen verwendet werden, die Sie anwenden möchten. <br><br>  <b>BuildRequires:</b> <br>  Zum Erstellen des Programms erforderliche Pakete.  Die Vorlage <code>cmake</code> .  Die Datei <code>CMakeLists.txt</code> gibt an, dass die Mindestversion von CMake für die Assembly nicht niedriger als <em>2,6 sein</em> sollte. <code>cmake &gt;= 2.6</code> Sie daher besser <code>cmake &gt;= 2.6</code> .  Mit der separaten Option <code>BuildRequires:</code> können Sie weitere Pakete hinzufügen, die jeweils in einer separaten Zeile stehen.  Die Liste der für die Assemblierung erforderlichen Pakete finden Sie, indem Sie die <code>README</code> des Projekts lesen und die Datei <code>CMakeLists.txt</code> (insbesondere die Funktionen <code>FIND_PACKAGE</code> , <code>TARGET_LINK_LIBRARY</code> , <code>FIND_PROGRAM</code> ) <code>TARGET_LINK_LIBRARY</code> <code>FIND_PROGRAM</code> .  Dann müssen Sie den richtigen Paketnamen in den Repositorys mit dem Befehl <code>urpmq -a __</code> .  In unserem Fall enthält die Kompilierungseinstellungsdatei ( <code>CMakeLists.txt</code> ) bereits Zeilen, die prüfen, ob die erforderlichen Pakete im System vorhanden sind.  Es ist jedoch besser, auch hier die gesamte Liste anzugeben: <br><pre> <code class="plaintext hljs"># CMake  2.6   BuildRequires: cmake &gt;= 2.6 #  C/C++ BuildRequires: gcc #    libxkbfile BuildRequires: libxkbfile-devel #   X11   libxkbfile, #  libx11-devel   . #    man: BuildRequires: xz</code> </pre><br><br>  <b>Benötigt :, Bietet:</b> <br>  Diese Optionen sind nicht im Beispiel enthalten, können aber manchmal nützlich sein.  Sie stellen Abhängigkeiten zwischen Paketen her.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Option </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt die </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Funktionen an,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die von dem zu erstellenden Paket bereitgestellt werden. Dies kann der Name der Sprachdatei - </font><font style="vertical-align: inherit;">Header </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder Dynamic Link Library - </font><font style="vertical-align: inherit;">Namen oder eine besondere Funktion. Eine Option </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt an, </font><font style="vertical-align: inherit;">von der </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gelegenheit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> andere Pakete abhängig Build - </font><font style="vertical-align: inherit;">Pakete. Package Manager ( </font></font><code>rpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>urpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, oder andere , </font><font style="vertical-align: inherit;">die Distribution verwenden), wenn für Abhängigkeiten suchen , </font><font style="vertical-align: inherit;">diese Suche nach </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Möglichkeiten</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eher als Paketname. Daher ist </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es besser, die Version der bereitgestellten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opportunity</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> anzugeben </font><font style="vertical-align: inherit;">und für </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">welche Versionen der bereitgestellten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opportunities</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geeignet sind. Die Version ist durch Zeichen gekennzeichnet </font></font><code>&gt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>&lt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">von Räumen umgeben. Normalerweise werden zuerst alle Optionen angezeigt </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dann - </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein Feature-Name pro Zeile - wie für </font></font><code>BuildRequires:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In der Regel werden beim Erstellen von Paketen unter Rosa Linux Abhängigkeiten automatisch erkannt, und diese Optionen müssen selten angegeben werden. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoReq:, AutoProv:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wenn Sie ein Programm auswählen , </font><font style="vertical-align: inherit;">die in einer Sprache geschrieben ist , </font><font style="vertical-align: inherit;">mit dem der Manager </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> neu sind, oder das ist proprietär und Abhängigkeiten werden nicht automatisch richtig definiert sind </font><font style="vertical-align: inherit;">, können Sie die </font><font style="vertical-align: inherit;">automatische Erkennung deaktivieren </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opportunities</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (mit </font></font><code>AutoProv: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) und / oder </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abhängigkeit</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (mit Hilfe </font></font><code>AutoReq: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% Beschreibung</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Block ist nicht mehr Teil des Headers, sondern ihm zugeordnet. </font><font style="vertical-align: inherit;">Er wird dem RPM-Paket eine vollständige Beschreibung des Programms hinzufügen. </font><font style="vertical-align: inherit;">Danach sollte eine leere Zeile verbleiben. </font><font style="vertical-align: inherit;">Die Beschreibung kann wie folgt sein:</font></font><br><pre> <code class="plaintext hljs">%description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zeilen aus der Vorlage beginnen mit </font></font><code>%files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und </font></font><code>%find_lang</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">werden nur benötigt, wenn Sie eine Anwendung mit Unterstützung für mehrere Sprachen erstellen. Löschen Sie sie daher.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Weiter nach dem Trennlinienkommentar, gefolgt von Befehlen und Makros, die vor dem Packen der Dateien ausgefüllt werden müssen. </font><font style="vertical-align: inherit;">Alle diese Befehle sind in Blöcke unterteilt, die mit speziellen Schlüsselwörtern definiert werden.</font></font></p><br><br><a name="prep"></a><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Quellenvorbereitung </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der erste ist ein Block </font></font><code>%prep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, der die Befehle angibt, die für die Kompilierung vorbereitet werden sollen. </font><font style="vertical-align: inherit;">Darin befindet sich ein Makrobefehl </font></font><code>%setup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Sie führt ein Skript aus, das Folgendes ausführt:</font></font></p><br><br><ul><li>       ,      <code>SourceX:</code>    (  —  <code>Source0:</code> ).         ,    . <br></li><li>      <code>~/rpmbuild/SOURCES/</code> . <br></li><li>      <code>~/rpmbuild/BUILD/</code> . <br></li><li>      . <br></li></ul><br><br><p>   <code>-q</code> ,       . </p><br><p>     ,     <code>%prep</code> : </p><br><br><pre> <code class="bash hljs">rpmbuild -bp ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>rpmbuild</code> .       ,      <code>rpm</code>    : <code>rpmbuild</code>    ,      .           (   <code>root</code>    <code>sudo</code> ).    <code>rpmbuild</code>  ,  <code>man rpmbuild</code> .      ,       ,   , —  ,          <code>rpmbuild</code> . <br></p><br><p>      : <code>xkb-switch-1.6.0: No such file or directory</code> .    ,          <code>~/rpmbuild/BUILD/xkb-switch-1.6.0</code> ,  .   <br></p><br><br><pre> <code class="bash hljs">ls ~/rpmbuild/BUILD/</code> </pre><br><br><p> ,     <code>xkb-switch-master</code> .     <code>%setup</code>    <code>-n</code> .    <code>%prep</code>  -   : <br></p><br><br><pre> <code class="bash hljs">%prep %setup -q -n xkb-switch-master</code> </pre><br><br><p>    <code>~/rpmbuild/SPECS/cleanup.sh</code> ,    <code>BUILD</code> ,     ,   <code>%prep</code> .  ,     <code>exit 0</code> .  ,     . <br></p><br><p>          ,         .       <code>%prep</code> .       ,    ,      : <br></p><br><pre> <code class="plaintext hljs">%apply_patches</code> </pre><br><p>       <code>rpmbuild -bp xkb-switch.spec</code> .    —    . <br></p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  Maximum RPM</a> . <br></p><br><p>    . <br></p><br><br><a name="build"></a><br><h2>  Zusammenstellung </h2><br><p>      <code>%build</code> .   <code>README</code>  ,     <code>cmake ..</code>  <code>make</code> ,     -   .  :           ,     .    ,        <code>%build</code> : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bc ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>exit 0</code> :    . <br></p><br><p> ,         .     shell (  bash  zsh,     ).  <code>rpmbuild</code>      ,           .    shell    - —        . (    .) <br></p><br><p>     -  , ,  ,     <code>%build</code>  shell  . <br></p><br><p>     ,    ,   .      <code>cmake</code> , , ,        <code>%cmake</code>      -  ,      ,    .         (   — <code>CMakeLists.txt</code> ).             ,    . <br></p><br><br><a name="install"></a><br><h2>  Installation </h2><br><p> , <em></em> .   <code>%install</code>   ,               ,     ,    <code>~/rpmbuild/BUILDROOT/__-buildroot/</code> . <br></p><br><p>  <code>__</code>    ,     <code>Name:</code>   -,   ( <code>Version:</code>  -),   ( <code>Release:</code>  -),  ,     . <br></p><br><p>   <code>README</code>  ,     <code>make install</code> ,    <code>build</code>   .  - - <code>%makeinstall_std -C build</code>    ,   .       ( ,   ): <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bi ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>      ,       RPM.   -   ,     . <br></p><br><br><a name="packing"></a><br><h2>   </h2><br><p>         ,      -  .     ,     <code>~/rpmbild/BUILDROOT/</code> . ( , ,     <code>tree</code> ,  -      Linux.)  ,       ,       <code>.debug</code> .    , ,    :        . <br></p><br><p>  ,       ,   <code>%files</code>  -.   ,     ,      .  . <br></p><br><p>       <code>%files</code>  -.  ,    .   Rosa Linux       <code>%prep</code> (  -   ).   ,   ,     ,  ,        —   .          - (,    ,     ). <br></p><br><p>   <code>%files</code>    ,      RPM. ,     : <br></p><br><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz</code> </pre><br><br><p>         -.   , ,     <code>/usr/lib/rpm/macros</code> .  , <code>%{_bindir}</code>     , <code>%{_libdir}</code> —   ,  <code>%{_mandir}</code> —    man.   <code>%{name}</code>  <code>%{version}</code>    <code>Name:</code>  <code>Version:</code>   -. <br></p><br><p>     : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p> …   2   1 .    <code>rpmlint</code> ,      .  ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> Rpmlint Errors</a>  ,   : <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: Inkohärente-Version-im-Name (Badness: 50) 1`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehler: Die Version im Bibliothekspaketnamen ist nicht korrekt angegeben. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: ausführbares Paket in der Bibliothek (Badness: 1) / usr / bin / xkb-switch`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehler: Das Bibliothekspaket enthält eine ausführbare Datei. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: W: Entwicklungsdatei-in-Nicht-Entwicklungspaket / usr / lib / libxkbswitch.so`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Warnung, dass eine </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklungspaketdatei</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) in einem Paket gefunden wurde, das nicht für die Entwicklung vorgesehen war.</font></font><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alles klar? </font></font> Ich glaube nicht.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schauen wir uns genauer an, was hier passiert. </font></font><br></p><br><br><a name="packing-rpmlint"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Was ist RPMLint? </font></font></h3><br><p>     Rosa Linux  <code>rpmbuild</code>   <code>rpmlint</code> ,    .  <code>rpmlint</code>    ,   ,      .   ,     Rosa Linux (  ,     <code>rpmlint</code> )     . <br></p><br><p>     ,     ,      .       <code>~/rpmbuild/RPMS/_/</code>         <code>rpmlint -i __</code> . <br></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Übrigens, wenn Sie ein vorgefertigtes RPM-Paket von der Website eines Projekts heruntergeladen haben, können Sie vor der Installation eines solchen Pakets mit demselben Befehl überprüfen, wie es für Rosa Linux korrekt erstellt wurde </font></font><code>rpmlint -i __</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br></p><br><br><a name="packing-package_types"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arten von RPM-Paketen für Rosa Linux </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pakete für Rosa Linux sind in 6 Typen unterteilt. </font><font style="vertical-align: inherit;">Im Idealfall sollte jedes zusammengebaute Paket nur einem dieser Typen entsprechen.</font></font><br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ausführbares Paket</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es ist binär. </font><font style="vertical-align: inherit;">Es enthält nur eine Binärdatei oder ein Skript, die direkt zur Ausführung bestimmt sind. </font><font style="vertical-align: inherit;">Die Dateien dieser Pakete werden meistens in einem Ordner </font></font><code>/bin/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder in </font><font style="vertical-align: inherit;">installiert </font></font><code>/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kann auch Links enthalten - für die Möglichkeit, das Programm unter verschiedenen Namen aufzurufen. </font><font style="vertical-align: inherit;">Der Name des Pakets entspricht dem Namen des Programms. </font><font style="vertical-align: inherit;">Solche Pakete sind oft bibliotheksabhängig.</font></font><br><br>  <b>Die Bibliothek</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es enthält kompilierte Dateien der dynamisch verbundenen ("gemeinsam genutzten", "gemeinsam genutzten") Bibliothek, die von Programmen verwendet wird. Normalerweise ist dies die Bibliotheksdatei selbst, deren Name mit der Version endet, und ein Link zu dieser Datei, deren Name mit der ersten Versionsnummer endet. Zum Beispiel kann die Bibliothek </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0.2 - </font><font style="vertical-align: inherit;">Version wird es Datei , </font></font><code>libxkbfile.so.1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um es und Link </font></font><code>libxkbfile.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Der Name des Bibliothekspakets, anhand dessen es im Repository des Installationsprogramms erkannt wird, endet mit der ersten Versionsnummer und beginnt mit dem Präfix </font></font><code>lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Die Bibliothek hat den </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">richtigen Namen -</font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dies liegt an der Tatsache, dass sich die erste Versionsnummer normalerweise nur bei inkompatiblen Bibliotheksänderungen ändert. Daher können mehrere Pakete mit einer Bibliothek unterschiedlicher Versionen installiert werden, wenn einige Programme die alte Version der Bibliothek und andere eine neuere Version verwenden. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket für Entwickler</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateien, die zum Kompilieren von Programmen erforderlich sind, die die Bibliothek verwenden, aber für die Arbeit vorgefertigter Programme nicht erforderlich sind. Bei einfachen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++ -</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Programmen </font><font style="vertical-align: inherit;">ist dies ein Link zur Bibliotheksdatei, jedoch ohne Versionen im Namen (zum Beispiel </font></font><code>libxkbfile.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) sowie Header-Dateien (mit der Erweiterung </font></font><code>.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Name des Pakets endet mit </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, zum Beispiel: </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Während der Installation hängt es immer von der entsprechenden Bibliothek ab. Zum Beispiel </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hängt </font><font style="vertical-align: inherit;">das Paket </font><font style="vertical-align: inherit;">von ab</font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellcode</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rosa Linux-Repositorys verfügen über RPM-Pakete, die den Quellcode für einige Programme enthalten - meist nur für diejenigen, die </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wirklich neu erstellt werden müssen</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Die Namen dieser Pakete enden mit </font></font><code>-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oder </font></font><code>-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(zum Beispiel </font></font><code>apache-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erstellt ein solches Paket immer automatisch und legt es ab </font></font><code>~/rpmbuild/SRPMS/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debugging-Symbole</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dies sind Informationen, die zum Debuggen eines fertigen Programms verwendet werden können. Es verknüpft Speicherorte in kompilierten Dateien mit dem Quellcode. Solche Pakete werden </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">automatisch </font><font style="vertical-align: inherit;">vom Team erstellt </font><font style="vertical-align: inherit;">, ihrem Namen wird eine Endung zugewiesen </font></font><code>-debuginfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ich habe solche Pakete nicht in Rosa Linux-Repositorys gefunden.</font></font><br><br>  <b>Die Dokumentation</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rosa Linux-Repositorys enthalten Dokumentationspakete für verschiedene Programme und Bibliotheken. </font><font style="vertical-align: inherit;">Ich kenne (vorerst) die Funktionen zum Erstellen solcher Pakete nicht. </font><font style="vertical-align: inherit;">Ihre Namen in der Regel enden in </font></font><code>doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: zum Beispiel </font></font><code>libx11-doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>java-1.7.0-openjdk-javadoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Übrigens sind fast alle im Stil von Websites erstellt. Um sie anzuzeigen, öffnen Sie am besten einen Browser, gehen Sie zur Adresse </font></font><code>file:///usr/share/doc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und wählen Sie den gewünschten Ordner und die gewünschte Datei aus.</font></font><br><br><br><br><a name="packing-result"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unser Ergebnis </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jetzt ist alles klarer geworden. </font></font><br></p><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unser Paket </font></font><code>xkb-switch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enthält eine Datei </font></font><code>libxkbswitch.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, die gemäß den Regeln in einem </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket für die Entwicklung enthalten sein muss</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Daher gab eine Meldung , </font><font style="vertical-align: inherit;">dass die Datei nicht in einem Paket für die </font><font style="vertical-align: inherit;">Entwicklung zu entwickeln , </font><font style="vertical-align: inherit;">ist: </font></font><code>xkb-switch.i586: W: devel-file-in-non-devel-package /usr/lib/libxkbswitch.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br></li><li>     <em></em> ,      <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> .       ,       .  : <code>xkb-switch.i586: E: executable-in-library-package (Badness: 1) /usr/bin/xkb-switch</code> . <br></li><li>    ,          (1).   : <code>xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1</code> . <br></li></ul><br><br><p> ,  <code>rpmlint</code> ,     .          .   <em>xkb-switch</em> ,      <code>libxkbswitch.so.1.6.0</code>       ,        <em>Vim</em> .            <em>xkb-switch</em> ,          <em>C</em>  <em>C++</em> .  RPM-    . <br></p><br><p>       -: <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-   xkb-switch</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Summary: Query and change XKB layout state Name: xkb-switch Version: 1.6.0 Release: 1 License: GPLv3+ Group: Development/X11 URL: https://github.com/ierton/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley. %files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="subpackaging"></a><br><h2>       </h2><br><p>        — ,         .    ,  ,       <code>xkb-switch</code>  3 : <em></em> , <em></em>   <em></em> . : <br></p><br><br><ul><li>  <em></em>     <code>/usr/bin/xkb-switch</code>    <code>/usr/share/man/man1/xkb-switch.1.xz</code> , <br></li><li>  <em></em> —  <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <em> </em> — <code>/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       -.  ,   , <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  - Maximum RPM</a> .     <a href=""> -  libxkbfile</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   Rosa Linux</a> . <br></p><br><p>    . <br></p><br><br><a name="subpackaging-macros"></a><br><h3>    </h3><br><p>        —   <a href="">-  libxkbfile</a> .     -  : <br></p><br><br><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch</code> </pre><br><br><p>    <code>%define</code>  .        ,    (     ) —   ,       .     ,    <code>%{major}</code>   <code>1</code> ,      . <br></p><br><p>  <code>%mklibname</code>   «lib»,     ,      —   (  ).     <code>%{libname}</code>  <em>«lib» + «xkbswitch» + (  %{major}) =</em> <code>libxkbswitch1</code> —   . <br></p><br><p>  <code>-d</code>  <code>%mklibname</code>   <code>-devel</code> .    <code>%{develname}</code>  <code>libxkbswitch-devel</code> —    . <br></p><br><br><a name="subpackaging-change_header"></a><br><h3>    </h3><br><p>     <code>Version:</code>   <br></p><br><br><pre> <code class="plaintext hljs">Version: %{major}.6.0</code> </pre><br><br><p>  ,           -. <br></p><br><p>      -       .      .      : <br></p><br><pre> <code class="plaintext hljs">Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><a name="subpackaging-packages"></a><br><h3>    </h3><br><p>     <em>-</em>     . <em>-</em>   , -      (    <em>rpm</em> ).       <code>%package</code> .        -.     ,    -.          <code>Version</code> , <code>Summary</code> , <code>Group</code> .      <code>Provides</code>  <code>Requires</code>   <em></em>  <em></em> ,     .  <code>Name</code>   :    ,     <code>%package</code> . <br></p><br><p>      .     <code>%description</code>       —   ,     <code>%package</code> . <br></p><br><p>  Rosa Linux   -   <code>%description</code>  -.    <code>libxkbswitch1</code> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'.</code> </pre><br><br><p>  <code>-n</code>    <code>%package</code>  <code>%description</code> ,       .    -        ,    <code>xkb-switch-libxkbswitch1</code> .       <code>libxkbswitch1</code> .           . <br></p><br><p>    <em> </em> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'.</code> </pre><br><br><a name="subpackaging-files"></a><br><h3>     </h3><br><p>   ,      .     <code>%files</code> . <br></p><br><p>      ,     ,    <code>%package</code> , <code>%description</code>  <code>%files</code> .  ,    <code>%description</code>  -    .   ,      ,    — <code>xkb-switch</code> . <br></p><br><p>  -  Rosa Linux     <code>%files</code>   ,    <code>%prep</code> .       : <br></p><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_mandir}/%{name}.1.xz %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %files -n %{develname} %{_libdir}/libxkbswitch.so</code> </pre><br><br><p>    , : <br></p><br><br><ul><li>   <code>xkb-switch</code>   <code>~/usr/bin/xkb-switch</code>  <code>~/usr/share/man/man1/xkb-switch.1</code> , <br></li><li>   <code>libxkbswitch1</code>   <code>~/usr/lib/libxkbswitch.so.1</code>  <code>~/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <code>libxkbswitch-devel</code>   <code>~/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       <code>cleanup.sh</code>       <code>rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> .    3 : <br></p><br><br><pre> <code class="plaintext hljs">libxkbswitch1.i586: W: no-documentation libxkbswitch-devel.i586: W: no-documentation libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> </pre><br><br><p>   ,       .   ,     .     .  Versuchen wir es herauszufinden. <br></p><br><br><a name="subpackaging-problems"></a><br><h3>    </h3><br><p> ,      ,  ,        <code>README.md</code> .     <code>%files</code>      —    <code>%doc</code> : <br></p><br><br><pre> <code class="plaintext hljs">%doc README.md</code> </pre><br><br><p>      .    <code>%doc</code> —    .        <code>~/rpmbuild/BUILD/xkb-switdh-master/README.md</code> . <br></p><br><p>       : <code>libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> .  ,    <code>libxkbswitch-devel</code>    <code>libxkbswitch</code>  . <br></p><br><p>    <code>rpm -qp  --</code>       .            : <br></p><br><pre> <code class="bash hljs">[user@pc ~] $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/RPMS/i586/ [user@pc ~/rpmbuild/RPMS/i586] $ ls libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-debuginfo-1.6.0-1-rosa2014.1.i586.rpm [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch.so.1 libxkbswitch1 = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libxkbswitch) libxkbswitch-devel = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libX11) devel(libgcc_s) devel(libstdc++) devel(libxkbfile) rpmlib(PayloadIsXz) &lt;= 5.2-1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libc.so.6 libc.so.6(GLIBC_2.0) libc.so.6(GLIBC_2.1.3) libgcc_s.so.1 libgcc_s.so.1(GCC_3.0) libstdc++.so.6 libstdc++.so.6(CXXABI_1.3) libstdc++.so.6(GLIBCXX_3.4) libstdc++.so.6(GLIBCXX_3.4.11) libstdc++.so.6(GLIBCXX_3.4.20) libstdc++.so.6(GLIBCXX_3.4.9) libxkbswitch.so.1 rpmlib(PayloadIsXz) &lt;= 5.2-1</code> </pre><br><br><p>  ,    <code>libxkbswitch1</code>   <code>libxkbswitch.so.1</code>  <code>libxkbswitch1</code> .  <code>xkb-switch</code>   <code>libxkbswitch.so.1</code> ,     <code>libxkbswitch-devel</code>    <code>libxkbswitch1</code> .   ,     <code>%package</code>  <code>libxkbswitch-devel</code> .      : <br></p><br><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version}</code> </pre><br><br><p>        , …       .     <code>libxkbswitch-devel</code>  ,  ,    .     ,         ,  <code>rpmbuild</code>      . <br></p><br><p> -,     (  <code>README.md</code>    ), —  : <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-    </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch # Main package. Automaticaly requires libxkbswitch and libxkbswitch-devel Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley. # libxkbswitch %package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'. # libxkbswitch-devel %package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version} %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'. # xkb-switch %files %{_bindir}/%{name} %{_mandir}/man1/%{name}.1.xz # libxkbswitch1 %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %doc README.md # libxkbswitch-devel %files -n %{develname} %{_libdir}/libxkbswitch.so %doc README.md #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="summary"></a><br><h2>  Fazit </h2><br><p>  ,      RPM    <em>Rosa Linux</em> (       ).       ,   -. ,       — ,   ,   <em>rpmrc</em> ,      <em>ABF</em>   , —         . <br></p><br><p>        —    ,      -,         - , —     . <br></p><br><br><a name="commands"></a><br><h2>   </h2><br><br><a name="commands-build"></a><br><h3>     </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bp specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Training</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% prep). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bc specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kompilation</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% build) und alle vorherigen Aktionen. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bi specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">psevdoustanovku</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% installieren) und alle vorherigen Aktionen. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -ba specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pakete vollständig </font><b><font style="vertical-align: inherit;">erstellen</font></b><font style="vertical-align: inherit;"> .</font></font><br><br><br><br><a name="commands-package"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie das fertige Paket </font></font></h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmlint -i package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Allgemeine Überprüfung - wie gut das Paket erstellt wurde. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp --provides package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie, welche "Funktionen" vom Paket bereitgestellt werden. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp - Erfordert package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überprüfen Sie, von welchen "Funktionen" anderer Pakete dieses Paket abhängt. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpl package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Liste der im Paket enthaltenen Dateien. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpi package-file-name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informationen zum Paket (aus dem "Header" der Spezifikationsdatei oder aus dem </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% package-</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Block </font><font style="vertical-align: inherit;">).</font></font><br><br><br><br><p>          ,    <code>p</code> .    ,     Rosa Linux,   .     <code>urpmq</code> ,   <code>rpm -q</code> . , <code>urpmq -l _</code>    ,  <code>urpmq --requires _</code>   . <br></p><br><br><a name="links"></a><br><h2>   ( ) </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Building RPMs — Quick Start</a> —         RPM  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> RPM</a> —    ,   ,       .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RPM:  spec </a> —    -  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maximum RPM</a> —        <code>rpm</code>   RPM-  RedHat Linux.         ,      Rosa Linux.    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Template Spec Files</a> —   <code>.spec</code> .  ,      -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Automatic Build Farm (ABF)</a> —      Rosa Linux.             ,   ,     ,    <code>.spec</code> .     -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rpmlint Errors</a> —    ,   <code>rpmlint</code> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Packaging Group</a> —    Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   Rosa Linux</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Git — </a> —      <em>Git</em> . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de464993/">https://habr.com/ru/post/de464993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de464981/index.html">Google liefert Argumente, um die Nachverfolgung von Nutzern zu rechtfertigen. Dem Unternehmen wird Unaufrichtigkeit und Manipulation vorgeworfen</a></li>
<li><a href="../de464985/index.html">Das Internet der Dinge (IoT) wird die Welt verändern. Zukunft des IoT</a></li>
<li><a href="../de464987/index.html">Repositories in Kubernetes: OpenEBS gegen Rook (Ceph) gegen Rancher Longhorn gegen StorageOS gegen Robin gegen Portworx gegen Linstor</a></li>
<li><a href="../de464989/index.html">Extravaganter Kontext</a></li>
<li><a href="../de464991/index.html">Projekte, die nicht gestartet sind</a></li>
<li><a href="../de464995/index.html">Wrap-Sequenzen in Swift</a></li>
<li><a href="../de464997/index.html">Über die Entwicklung von VR-Technologien: Wo sie eingesetzt werden, warum VR-Geschäft und welche Geräte</a></li>
<li><a href="../de464999/index.html">Wie sich die Besonderheiten der Arbeit mit Anwendungsservern am OpenLiberty-Beispiel ändern</a></li>
<li><a href="../de465001/index.html">Amazon Prime Day 2019 - Unterstützt von AWS</a></li>
<li><a href="../de465003/index.html">Interessen für das ARPG-Genre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>