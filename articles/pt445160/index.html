<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÅ ‚è© ‚úäüèΩ Desenvolvemos firmware de pedal para aprender a tocar balalaica ‚õìÔ∏è ‚ÜïÔ∏è üò°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eu realmente amo tutoriais em v√≠deo. Por alguma raz√£o, eu pessoalmente percebo as informa√ß√µes do texto muito, muito mal. Mas h√° coisas em que n√£o h√° m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvemos firmware de pedal para aprender a tocar balalaica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445160/"> Eu realmente amo tutoriais em v√≠deo.  Por alguma raz√£o, eu pessoalmente percebo as informa√ß√µes do texto muito, muito mal.  Mas h√° coisas em que n√£o h√° muita informa√ß√£o no papel.  Pegue, por exemplo, as li√ß√µes de tocar balalaica: no YouTube, h√° discuss√µes maravilhosas sobre como tocar essa ou aquela melodia (quem estiver interessado, estamos procurando por "Sergey Vorontsov"), mas √© dif√≠cil repetir e memorizar a sequ√™ncia do v√≠deo em streaming.  √â necess√°rio escrever no papel (a julgar pelos coment√°rios das li√ß√µes, alguns o fazem) ou comprar materiais adicionais (mas n√£o sou ganancioso, mas caseiro). <br><br><img src="https://habrastorage.org/webt/g5/_m/ax/g5_maxwworsrjbxqh3n08jytdj4.png"><br><br>  Em geral, no meu caso de balalaica, e com muitos outros, tenho que ir assim: olhei para o fragmento, parei, repeti v√°rias vezes atr√°s do autor e continuei assistindo.  Se algo n√£o est√° claro - rebobinado, olhou mais de perto.  Mas como encerrar tudo se suas m√£os est√£o ocupadas?  Al√©m disso, no meu caso, eles est√£o ocupados, se n√£o com um enorme acorde√£o de bot√£o, mas ainda assim alguns, mas com uma balalaica.  Ent√£o, voc√™ precisa trabalhar com as pernas. <br><a name="habracut"></a><br>  Muitos anos atr√°s, quando toda a humanidade progressista usava teclados PS / 2, eles nos trouxeram dezenas de teclados USB para o projeto.  Obviamente, n√≥s os conectamos a uma m√°quina, pressionamos Ctrl em uma delas, Alt na segunda e Del na terceira.  O efeito foi alcan√ßado.  Desde ent√£o, sei que os teclados USB funcionam completamente em paralelo, para que voc√™ possa conectar outro para ajudar o principal, que enviar√° alguns c√≥digos. <br><br>  Ent√£o nasceu a id√©ia de fazer um pedal que finge ser um teclado e envia c√≥digos de controle para o jogador.  Como jogador, inicialmente escolhi o VLC Player, pois ele possui bot√µes de controle bem documentados, mas depois os c√≥digos que eu selecionei tinham exatamente o mesmo objetivo ao assistir v√≠deos no YouTube no modo de tela cheia.  Isso √© bom porque, com v√°rias visualiza√ß√µes on-line, para as impress√µes do an√∫ncio, algo parece cair na mente do autor.  Assistir ao download n√£o seria t√£o √©tico. <br><br>  Ent√£o, come√ßamos a projetar o dispositivo. <br><br><h2>  L√≥gica de trabalho </h2><br>  No come√ßo, eu queria fazer v√°rios pedais, cada um para sua pr√≥pria fun√ß√£o.  Inicialmente, contei 3-4 dessas fun√ß√µes: ligado, desligado, vento l√°, vento de volta.  Mas ent√£o eu descobri quanto pl√°stico seria necess√°rio, mais - como eu entenderia os pedais por toque e fiquei triste.  Portanto, decidiu-se revisar radicalmente toda a l√≥gica.  Quais recursos s√£o necess√°rios?  Start-stop, mas geralmente fica na mesma tecla, geralmente em um espa√ßo.  E rebobinando.  O VLC Player tem "Shift + Left".  YouTube, como se viu, tamb√©m.  E, se voc√™ pensa assim, n√£o h√° mais fun√ß√µes. <br><br>  √ìtimo!  Vamos fazer com que o pedal use brevemente a fun√ß√£o "Start-Stop" e, longamente, pela fun√ß√£o "Rewind". <br><br>  No futuro, voc√™ pode expandir a funcionalidade.  Voc√™ pode treinar o pedal para reconhecer o c√≥digo morse.  Minha esposa, tendo aprendido sobre a id√©ia, sugeriu os impulsos de controle de codifica√ß√£o usando elementos das dan√ßas irlandesas ... Em geral, voc√™ pode expandir a funcionalidade como quiser.  Mas uma coisa √© clara: um pedal √© suficiente.  Bem, agora faremos o reconhecimento de prensas longas e curtas. <br><br><h2>  A mec√¢nica </h2><br>  Para quem anda em casa de chinelos, existe uma solu√ß√£o muito simples (eu achei no site do Thingiverse).  Pegamos um bot√£o com um di√¢metro superior a um cent√≠metro, aparafusamos em qualquer objeto em forma de caixa, pegamos um pedal.  O problema √© que eu n√£o gosto de chinelos, ent√£o essa op√ß√£o n√£o me agrada pessoalmente.  Preciso de uma superf√≠cie maior para que o p√© n√£o doa. <br><br>  Pedais em grandes quantidades s√£o vendidos no Ali Express. Voc√™ deve procurar a palavra Foot Switch.  Os pre√ßos l√° come√ßam em 30 rublos, mas a esse pre√ßo, o custo de entrega pode ser de cerca de quatrocentos rublos.  Ap√≥s a pesquisa, descobri que √© perfeitamente poss√≠vel encontrar um pedal para o qual a soma "pre√ßo mais entrega" ser√° de 150 rublos.  Mas voc√™ ter√° que esperar uma m√©dia de alguns meses (estive esperando aqui recentemente por um cart√£o SD por todos os tr√™s meses). <br><br>  Ent√£o eu segui o caminho mais r√°pido: fiz um pedal em uma impressora 3D.  A experi√™ncia pessoal (e todas as op√ß√µes com o Thingiverse) mostra que o eixo deve ser met√°lico; caso contr√°rio, tudo quebrar√° rapidamente.  Peguei o parafuso da mob√≠lia M6x60 que tinha com a porca presa a ele, bem como o bot√£o (PSW-13), que ficava nas pe√ßas de r√°dio vizinhas, e os circulei o mais pl√°stico poss√≠vel.  √â assim que os materiais de origem se parecem: <br><br><img src="https://habrastorage.org/webt/fx/h9/fl/fxh9fljxy-gcfvlvf5s2ovu5sis.jpeg"><br><br>  Aqui est√£o eles, inseridos na metade inferior.  Como voc√™ pode ver, a principal caracter√≠stica do projeto s√£o as paredes, com pelo menos quatro mil√≠metros de espessura.  Com esses par√¢metros, at√© mesmo um prototypper gentil se torna bastante dur√°vel.  O bot√£o √© instalado sem uma porca, pois qualquer vazio embaixo dele levar√° √† quebra do pl√°stico e ele se mant√©m muito bem. <br><br><img src="https://habrastorage.org/webt/xn/6h/zq/xn6hzqfjerkxrderg2kvpnad30o.jpeg"><br><br>  Aqui est√° uma vers√£o quase compilada: <br><br><img src="https://habrastorage.org/webt/qs/ya/gb/qsyagb0p-qbpgmwwc78tvtj7vcc.jpeg"><br><br>  E aqui est√° o conjunto do pedal: <br><br><img src="https://habrastorage.org/webt/fc/as/fu/fcasfu9dy0rvteff4oyskczhvq0.jpeg"><br><br>  Em princ√≠pio, anexarei os arquivos STL, mas a solu√ß√£o n√£o foi perfeita.  No entanto, qualquer um pode repeti-lo (se encontrar o parafuso M6x60 com a porca correspondente e o bot√£o PSW-13).  Chega pela primeira vez, e ent√£o - voc√™ pode carimbar mec√¢nica e encomendar com a ALI. <br><br><h2>  Dispositivo USB </h2><br>  Embora eu esteja promovendo ativamente o PSoC ultimamente, us√°-lo nos pedais √© um desperd√≠cio in√©dito.  Considero a melhor solu√ß√£o uma placa de ensaio baseada no STM32F103C8T6, que agora pode ser encomendada no ALI Express por cerca de 120 rublos (incluindo entrega). <br><br><img src="https://habrastorage.org/webt/db/ku/er/dbkuerxaai9tfg8t6bjymx2s9xc.jpeg"><br><br>  Obviamente, podemos especular que existem placas mais baratas baseadas no AVR, mas a diferen√ßa de pre√ßo n√£o √© significativa l√°, e o STM32 tem um tempo de desenvolvimento significativamente menor devido √† depura√ß√£o via JTAG.  Uma hora (mesmo em casa) - tamb√©m custa algo.  Portanto, de acordo com o crit√©rio total ‚Äúpre√ßo do dispositivo + custos de m√£o-de-obra‚Äù, o STM32F103 √© a melhor op√ß√£o para esta tarefa.  Al√©m disso, tenho uma meia d√∫zia de modelos guardados para esse caso, portanto o tempo de espera da entrega agora √© igual a zero para mim. <br><br>  Naveguei na net para teclados USB prontos com base nesse chip.  Eu encontrei um artigo sobre Habr como fazer um mouse USB.  Mas eu preciso de um teclado.  No t√≥pico teclados, encontrei muitas dicas inteligentes nos f√≥runs (mas queria algo pronto) e alguns projetos complexos, por√©m prontos, no GitHub (mas queria algo claro).  Mas quem procura sempre encontrar√°.  Aqui est√° um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo maravilhoso,</a> no qual h√° tudo o que √© necess√°rio (embora exista um no c√≥digo, n√£o tenho medo dessa palavra que n√£o seja russa, um potencial DeadLock, mas escreverei meu pr√≥prio c√≥digo).  O principal √© que todas as etapas est√£o claramente descritas, como obter um teclado USB a partir de um ‚Äúpeixe‚Äù pronto feito no Cube MX.  A √∫nica coisa que o autor n√£o fez n√£o foi publicar os c√≥digos de chave.  Adicione-os aqui: <br><br><img src="https://habrastorage.org/webt/ij/0b/kw/ij0bkwmzj94ve2cqynqsn25ms3y.jpeg"><br><br>  O ponto principal √© que, na vers√£o moderna do Cube MX, os nomes de arquivos, fun√ß√µes e at√© constantes s√£o um pouco diferentes dos especificados nesse artigo, mas, por analogia, tudo √© encontrado rapidamente.  Eu poderia escrever uma nova vers√£o do texto, mas onde est√° a garantia de que os desenvolvedores n√£o mudar√£o tudo novamente?  Eles gostam de fazer isso.  Em geral, voc√™ pode ver os an√°logos no meu exemplo. <br><br>  Ent√£o  Criei um projeto b√°sico no Cube MX, fiz todas as altera√ß√µes recomendadas pelo artigo mencionado acima.  O que vem a seguir?  Em seguida, adicione uma descri√ß√£o da porta do bot√£o.  Eu escolhi o PB12 (apenas porque o contato correspondente est√° localizado no canto da t√°bua de p√£o).  Como eu sempre trabalho com ferro na biblioteca mcucpp de Konstantin Chizhov, removemos a defini√ß√£o de macro ‚Äú-C99‚Äù nas propriedades do projeto, renomeamos <b>main.c</b> para <b>main.cpp</b> e adicionamos a declara√ß√£o: <br><br><pre><code class="plaintext hljs">typedef Mcucpp::IO::Pb12 pedal1;</code> </pre> <br>  Adicionamos a inicializa√ß√£o da porta √† fun√ß√£o <b>main ()</b> (ativando o rel√≥gio da porta, definindo a dire√ß√£o da perna, ativando o suspender): <br><br><pre> <code class="plaintext hljs">pedal1::ConfigPort::Enable(); pedal1::SetDirRead(); pedal1::SetPullUp (pedal1::Port::PullUp);</code> </pre><br>  Na verdade, tudo √© inicializado.  Decidi construir o corpo principal √† imagem do processo Verilog.  N√£o sei por que, s√≥ queria.  O processo √© geralmente chamado de pulsos de clock.  Eu decidi que os ticks do sistema s√£o perfeitamente considerados como ticks.  Portanto, a fun√ß√£o regular do manipulador de <b>ticks</b> do sistema no arquivo <b>stm32f1xx_it.c foi</b> adicionada da seguinte maneira: <br><br><img src="https://habrastorage.org/webt/-h/qy/rk/-hqyrk8ex2a6vmby9pa16sqgwdi.png"><br><br><div class="spoiler">  <b class="spoiler_title">Mesmo texto:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">void SysTick_Handler(void) { /* USER CODE BEGIN SysTick_IRQn 0 */ /* USER CODE END SysTick_IRQn 0 */ HAL_IncTick(); HAL_SYSTICK_IRQHandler(); /* USER CODE BEGIN SysTick_IRQn 1 */ TickProcess(); /* USER CODE END SysTick_IRQn 1 */ }</code> </pre><br></div></div><br>  Coloquei a <b>pr√≥pria</b> fun√ß√£o <b>TickProcess ()</b> em <b>principal.</b>  <b>cpp</b> .  Primeiro, considere-o na √≠ntegra, depois em partes. <br><br><div class="spoiler">  <b class="spoiler_title">Aqui est√° a fun√ß√£o completa:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">uint8_t report [8] = {0,0,0,0,0,0,0,0}; uint32_t* pReport = (uint32_t*)report; extern "C" void TickProcess() { //      20!!! static const int shortTime = 700; //      static const int longTime = 2000; //    static int localTick = 0; static int tickDuringButton = 0; static bool bButtonStatePrev; bool bButtonState = pedal1::IsSet(); //     if ((!bButtonState) &amp;&amp; bButtonStatePrev) { tickDuringButton = 0; } //     if (bButtonState &amp;&amp; (!bButtonStatePrev)) { //       //  ,  50  () if ((tickDuringButton &gt;100)&amp;&amp;(tickDuringButton &lt; shortTime)) { //    report [2] = 0x2C; } } //    if ((!bButtonState) &amp;&amp; (!bButtonStatePrev)) { if ((tickDuringButton == shortTime)||(tickDuringButton &gt; longTime)) { //  Shift+ report [0] = 2; // Shift report [2] = 0x50; //  } } //    bButtonStatePrev = bButtonState; tickDuringButton += 1; if (localTick++ % 20 == 0) { USBD_HID_SendReport (&amp;hUsbDeviceFS,report,sizeof(report)); pReport [0] = 0; pReport [1] = 0; } }</code> </pre><br></div></div><br>  A primeira tarefa implementada nesse manipulador √© simples.  A cada 20 milissegundos, enviamos um relat√≥rio contendo informa√ß√µes sobre os bot√µes pressionados (se n√£o houver bot√µes, enviamos de qualquer maneira, apenas com zeros).  Como a fun√ß√£o √© chamada a cada milissegundo, o relat√≥rio deve ser enviado para uma de suas vinte chamadas.  Para fazer isso, h√° uma vari√°vel no in√≠cio da fun√ß√£o: <br><br><pre> <code class="plaintext hljs"> static int localTick = 0;</code> </pre><br>  e o c√≥digo no final (enviamos os dados, ap√≥s o que apagamos o buffer para come√ßar a enviar zeros a partir da pr√≥xima sess√£o): <br><br><pre> <code class="plaintext hljs"> if (localTick++ % 20 == 0) { USBD_HID_SendReport (&amp;hUsbDeviceFS,report,sizeof(report)); pReport [0] = 0; pReport [1] = 0; }</code> </pre><br>  A segunda tarefa √© mais complicada.  Ele rastreia a natureza de pressionar o pedal e preenche o relat√≥rio para envio posterior.  Por que eu disse que a ideologia √© como Verilog?  Porque eu sempre pego diferen√ßas nesse idioma: eu tenho uma vari√°vel na qual o estado atual do bot√£o √© colocado: <br><br><pre> <code class="plaintext hljs"> bool bButtonState = pedal1::IsSet();</code> </pre><br>  e existe uma vari√°vel na qual seu estado anterior √© armazenado (como lembramos, o estado anterior √© o estado do bot√£o durante o processamento de interrup√ß√£o anterior do temporizador de 1 ms): <br><br><pre> <code class="plaintext hljs"> static bool bButtonStatePrev;</code> </pre><br>  O bot√£o pressionado fornece o valor <b>falso</b> , o bot√£o pressionado - <b>verdadeiro</b> .  Assim, sempre podemos concluir sobre o estado din√¢mico do bot√£o: <br><br><div class="scrollable-table"><table><tbody><tr><th>  bButtonState </th><th>  bButtonStatePrev </th><th>  Condi√ß√£o </th></tr><tr><td>  verdade </td><td>  verdade </td><td>  Lan√ßado h√° muito tempo </td></tr><tr><td>  verdade </td><td>  falsa </td><td>  Lan√ßado na medida anterior </td></tr><tr><td>  falsa </td><td>  verdade </td><td>  Pressionado na medida anterior </td></tr><tr><td>  falsa </td><td>  falsa </td><td>  Press√£o longa </td></tr></tbody></table></div><br>  N√≥s introduzimos duas constantes.  Um define o tempo curto de impress√£o.  Se a impressora durar menos de 700 ms, ser√° de curta dura√ß√£o.  O segundo define o hor√°rio em que a repeti√ß√£o autom√°tica est√° ativada.  Se logo ap√≥s setecentos milissegundos voc√™ come√ßar a enviar o c√≥digo da chave, o player come√ßar√° a enrolar muito abruptamente.  Isso √© identificado empiricamente.  Portanto, a l√≥gica do trabalho √© a seguinte: ap√≥s 700 ms, um √∫nico c√≥digo ‚ÄúShift + Esquerda‚Äù √© enviado, ap√≥s o qual o usu√°rio tem a oportunidade de soltar o pedal.  Se o pedal continuar pressionado, a partir do segundo segundo o envio constante desse c√≥digo j√° come√ßa at√© que o pedal seja liberado. <br><br><pre> <code class="plaintext hljs"> const int shortTime = 700; //      const int longTime = 2000; //   </code> </pre><br>  O tempo durante o qual o bot√£o √© pressionado √© armazenado em uma vari√°vel: <br><br><pre> <code class="plaintext hljs"> static int tickDuringButton = 0;</code> </pre><br>  Se o bot√£o acabou de ser pressionado, zeramos essa vari√°vel, come√ßando a medir um novo per√≠odo de tempo: <br><br><pre> <code class="plaintext hljs"> //     if ((!bButtonState) &amp;&amp; bButtonStatePrev) { tickDuringButton = 0; }</code> </pre><br>  Se o bot√£o acabou de ser liberado, verificamos a hora em que ele foi pressionado.  Se apenas um pouco (agora diz "menos de 100 ms") - isso √© uma conversa.  Isso n√£o conta.  Ignore esse clique.  Se n√£o fizermos nada al√©m da dura√ß√£o da press√£o curta, a press√£o longa ser√° processada abaixo.  Se, em pouco tempo, criarmos um relat√≥rio no buffer com um espa√ßo (que ser√° enviado quando chegar a hora): <br><br><pre> <code class="plaintext hljs"> //     if (bButtonState &amp;&amp; (!bButtonStatePrev)) { //       //  ,  100  () if ((tickDuringButton &gt;100)&amp;&amp;(tickDuringButton &lt; shortTime)) { //    report [2] = 0x2C; } }</code> </pre><br>  Se o bot√£o for pressionado por um longo tempo, enviamos "Shift + Left" em dois casos: <br><br><ul><li>  o bot√£o √© mantido exatamente 700 ms (pacote √∫nico); </li><li>  o bot√£o √© mantido por mais de 2 segundos (enviando cada relat√≥rio subsequente at√© que o bot√£o seja liberado). </li></ul><br><pre> <code class="plaintext hljs"> //    if ((!bButtonState) &amp;&amp; (!bButtonStatePrev)) { if ((tickDuringButton == shortTime)||(tickDuringButton &gt; longTime)) { //  Shift+ report [0] = 2; // Shift report [2] = 0x50; //  } }</code> </pre><br>  Isso, de fato, √© tudo.  Esse c√≥digo n√£o √© mais diferente do ‚Äúpeixe‚Äù que o Cube MX criou para n√≥s.  Montamos, flash ... N√£o, √© imposs√≠vel sem erros (aqui est√£o todos pegos, mas n√£o pude ficar sem eles inicialmente), identificamos em 10 minutos via depura√ß√£o JTAG (ol√° para AVR), costuramos, estamos felizes ... <br><br><h2>  Projeto alternativo </h2><br>  Em geral, essas coisas s√£o √∫teis sem uma balalaica (ou outra visualiza√ß√£o de tutoriais em v√≠deo).  Em particular, gosto de ler as not√≠cias, deitada na cama, com um laptop no est√¥mago.  Para rolar o texto, voc√™ deve manter a m√£o direita dobrada o tempo todo, o que causa dor no cotovelo.  Por isso, h√° muito que sonhei com um grande bot√£o vermelho que poderia rolar as p√°ginas sem dobrar meu bra√ßo.  Na verdade, ele pode ser fabricado com os mesmos componentes do pedal, substituindo o parafuso da mob√≠lia por uma pequena quantidade de cola quente.  Total: bot√£o PSW13, placa de ensaio STM32F103C8T6, pl√°stico para impressora 3D, adesivo termofus√≠vel.  Bem, no "firmware", substitu√≠ os c√≥digos por "PgDn" por uma breve press√£o e "Up" por uma longa. <br><br><img src="https://habrastorage.org/webt/t-/pk/ll/t-pkllvtvpapghfjaulfjgzevcw.jpeg"><br><br><img src="https://habrastorage.org/webt/ma/rc/qa/marcqa0tmbl5iypd5sb3al1zvlw.png"><br><br><h2>  Conclus√£o </h2><br>  Voc√™ pode usar as pernas para controlar a exibi√ß√£o de tutoriais em v√≠deo quando as m√£os est√£o ocupadas.  Para fazer isso, apenas um pedal que simula a opera√ß√£o do teclado USB.  Um pedal pode enviar v√°rios c√≥digos de teclas, selecionando-os com base em diferentes tipos de teclas.  O artigo considera um pedal que analisa dois tipos (press√£o curta e longa). <br><br>  A mec√¢nica pode ser encontrada no Ali Express sob a palavra Foot Switch ou pode ser impressa em uma impressora 3D.  Como eletr√¥nica, a placa de ensaio STM32F103C8T6 pode ser usada.  O "firmware" √© feito em menos de uma hora, com base no "peixe" criado pelo Cube MX do fabricante dos controladores STM32.  O c√≥digo adicional ocupa v√°rias telas de texto (para uma resolu√ß√£o de 2K - uma tela). <br><br>  Em geral, todo o dispositivo (mec√¢nica + ‚Äúfirmware‚Äù) foi completamente projetado em uma noite, al√©m de levar cerca de quatro horas para imprimir mec√¢nica em uma impressora 3D. <br><br>  Os arquivos STL prontos para impress√£o em pedal podem ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">baixados aqui</a> (√© desej√°vel abaixar o elemento Top em 0,4 mm para evitar um grande n√∫mero de suportes: a superf√≠cie acabou ligeiramente arredondada, abaixando o modelo, tornaremos a pe√ßa impressa plana). <br><br>  Os arquivos STL do "grande bot√£o vermelho" podem ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">baixados aqui</a> . <br><br>  Os arquivos de origem prontos para o projeto e o arquivo HEX para o firmware podem ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">baixados aqui</a> . <br><br>  A data de publica√ß√£o deste artigo n√£o foi escolhida por acaso.  O conselho decidiu que √© melhor publicar um artigo sobre essas coisas em um site s√©rio naquele dia.  Mas, de fato, se voc√™ olhar para os v√≠deos encontrados nas frases "Alexey Arkhipovsky", "Dmitry Kalinin", "Cranberry Show", "Alexey Kodenko", fica claro que a balalaica acad√™mica √© como uma montadora.  L√° e ali, combinam simplicidade absoluta e poder expressivo fren√©tico.  E pela frase "Sergey Vorontsov", voc√™ pode entender como aprender a usar essa ferramenta. <br><br><h2>  Adi√ß√£o </h2><br>  Ap√≥s 8 meses de opera√ß√£o, o bot√£o PSW-13 come√ßou a funcionar uma vez em muitos, e apenas com uma press√£o muito forte.  Ao tentar substituir, ficou um detalhe muito interessante.  O novo bot√£o, comprado ao mesmo tempo que o anterior, possui uma reserva de energia completamente diferente e funciona em uma posi√ß√£o completamente diferente.  Como resultado, ela estava sempre pressionada no meu pedal.  Eu tive que moer com um dremel.  Quem repetir√° minha mec√¢nica - tenha em mente.  Pode ser necess√°rio modificar o bot√£o com um arquivo ou vice-versa - esculpir uma fita isolante para aument√°-lo.  A repetibilidade da parte pl√°stica deste bot√£o n√£o foi muito grande.  Mas, em geral - ap√≥s essa revis√£o, tudo funciona novamente. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445160/">https://habr.com/ru/post/pt445160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445150/index.html">Upwork est√° registrado na Federa√ß√£o Russa</a></li>
<li><a href="../pt445152/index.html">O que mais pode ser feito na pesquisa? Relat√≥rio Yandex</a></li>
<li><a href="../pt445154/index.html">Eventos digitais em Moscou de 25 a 31 de mar√ßo</a></li>
<li><a href="../pt445156/index.html">Nebulizador compacto Glenmark: uma coisa √∫til na vida cotidiana</a></li>
<li><a href="../pt445158/index.html">Orienta√ß√£o ideal para pe√ßas e configura√ß√£o de suporte na impressora 3D</a></li>
<li><a href="../pt445162/index.html">Terraform Provider Selectel</a></li>
<li><a href="../pt445164/index.html">Desempenho equilibrado do site. Parte 5: Usabilidade</a></li>
<li><a href="../pt445166/index.html">Tudo o que voc√™ precisa saber sobre hifeniza√ß√£o autom√°tica de CSS</a></li>
<li><a href="../pt445168/index.html">Um curr√≠culo ideal que ser√° recebido por um recrutador e empregador</a></li>
<li><a href="../pt445170/index.html">Tr√™s grandes mentiras sobre JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>