<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💭 👨🏻‍🏫 👸🏿 SD卡USB适配器的剖析和克隆 💈 🚯 ✌🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="...或者如何通过快速的micro-SD卡为您的DIY项目提供MIPS或轻量级ARM。 
 对所有受尊敬的社区来说都是美好的一天。 我想继续讲一下关于盒装设备的故事，也就是关于她如何设法将微型SD卡连接到USB 2端口的故事。 

 整个问题的根源在于，USB 2不仅有一个处理器模块，而且没有QSP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SD卡USB适配器的剖析和克隆</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403199/"><div style="text-align:center;"><img src="https://habrastorage.org/files/f54/e21/451/f54e21451bfa4ed38bb087e1641cdf12.jpg"></div><br>  ...或者如何通过快速的micro-SD卡为您的DIY项目提供MIPS或轻量级ARM。 <br> 对所有受尊敬的社区来说都是美好的一天。 我想继续讲一下关于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">盒装设备的</a>故事，也就是关于她如何设法将微型SD卡连接到USB 2端口的故事。 <br><a name="habracut"></a><br> 整个问题的根源在于，USB 2不仅有一个处理器模块，而且没有QSPI（QuadSPI）或卡接口。 这个可悲的事实与SD卡有什么关系？ 很简单，任何SD卡在其连接的物理基础上都具有SPI（串行外围设备）接口。 经典的SPI使用一条物理线来发送和接收串行数据。 简单且经济，无论是金钱还是毫安。 但是，众所周知，缺点是优点的延续，对于SPI来说，它们主要变成了相对较低的数据交换速率。 为了解决这个问题，发明了一种带有SD卡的四位数据交换模式，它与QSPI协议密切相关。 使用此模式时，主机控制器和卡首先在单位模式下就交换参数达成一致，然后在它们不使用一条线进行接收和发送，而是使用四条线来接收和发送所有内容时切换到四位模式（另外还有一条用于指示命令）。 <br><br> 如果设备不直接支持四位协议，但仍需要快速更换，该怎么办？ 显而易见的答案是为该项目提供“快速接口”桥-“四位SD卡”。 <br><br> 为了解决此问题，购买了两个USB-SD适配器并进行了准备（未使用活体解剖-我们不是怪物）。 在对烙铁和吹风机进行预热之前，进行了非常重要的检查，以查看Debian处理器模块是否看到为其提供的适配器哨子。 测试取得了巨大成功，欢迎来到手术室。 购买的哨子如下所示： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/899/740/5e7/8997405e7cdc4981aac38d2aad8b1c35.jpg"></div><br> 像这样： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a70/962/4bf/a709624bf49a44a1ac3ab97c63049c1c.jpg"></div><br> 拆开外壳后，就可以从印刷电路板的两侧进行印刷了。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/140/a2f/164/140a2f16457b41a6be2902e9dca08a5d.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2d9/48f/33d/2d948f33d59f4afc8fff7b97ebcb5a7e.png"></div><br> 电路很简单，它的基础是IC GL823F-具有命令系统8051和屏蔽存储器的微控制器，配备了USB 2硬件接口单元，显然质量不是很高（为什么我要说-我看不到模拟部分和晶体振荡器的确切偏置电阻器，这意味着根据内部校准的发生器从接收到的信号中恢复频率）。 可以工作，但不能使用HiFi，不可以。 其他所有东西都是一个最小的车身套件：阻断电容器，上拉和限流电阻器，LED和连接器，这都是工程设计。 <br><br> 我们用吹风机吹干组件，然后检查印刷电路板。 在许多方面，该板都是双面镀孔的。 在显微镜下对电路板进行了短暂检查，绘制了连接图并与GL相关IC的数据表进行了比较之后，我们恢复了电路图。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d96/74e/a6e/d9674ea6ed584e8aa5566554642f4f18.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/454/79e/797/45479e797ffd47a5966944d5a3e4b88d.jpg"></div><br> 在这里，我们现在开始看到一个小麻烦。 到底是什么 我们的盒子由3.3V的保证电压供电，GL823上的电路需要5伏特。 好吧，根据需要-她已经习惯了，因为USB给了她很多。  Micro SD本身由3.3V供电，因此内置的LDO稳定器已添加到GL823中。 因此存在一个问题-如果电路由3.3V供电，是否可以工作？ 如果LDO设法不降低太多电压，则可以，但并非所有LDO都同样有用。 数据表提供了一些提示-馈送SD卡的输出称为PMOS。 这个缩写不能不让人高兴-可以假定使用了HighSide PMOS电路，其中控制元件两端的压降非常小。 但是，所有这一切都是推理，唯一具有决定性意义的论据是经验，他是犯错误的儿子。 <br><br> 那么我们将提供什么样的体验？ 让我们尝试使用两个开关电压为IC供电-5 V USB或3.3 V，由单独的稳定器获得。 现在我们有足够的知识来绘制示意图。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fb7/4bc/a0b/fb74bca0b27545c192d85f552f89d9f9.gif"></div><br> 电路上组件的编号有些奇怪，原因是印刷电路板制造商订购了多级测试电路，并增加了多个测试电路，并且所有组件都具有编号功能。 在准备本文时，我根据照片带来了电路图，事实证明发生了什么。 <br><br> 我们在图中看到了什么？ 显然，核心是GL823F。  micro-SD连接器显然已连接到它。 唯一需要注意的是-连接器上的针脚9是插槽中卡的滑动触点，当卡就位时，它会短路接地。  C7-C10-电源电路上的隔离电容器。 如果要稍微提高抗噪能力，则可以通过铁氧体扼流圈连接引脚2和16 DD1。  R4限制通过HL1的电流，如果插槽中没有卡，R5将GPIO线拉至一根。  DA2，C11和C12构成一个3.3V线性稳压器。 <br><br> 由于在绘制电路的那一刻，一方面，尚不清楚会消耗多少电流，另一方面，使用一些在录制时消耗了400mA电流的USB闪存驱动器（它不会用手指指着）有不愉快的经历，因此决定添加R6。 通常，这是一种标准技术-电路中线性LDO的消耗量很大（此处的关键词为LowDropout），在输入处放置一个功率增加的低阻电阻器，并在其上而不是稳定器上散发一部分热量。 但是，经验表明，不需要R6，并且您仍会在主板照片中看到它。 <br><br>  XS4只是为了进行实验而设计-在5至3.3伏之间切换功率DD1。  XS2是标准的USBB连接器，因此您可以将其放在自己的面前，而不必爬到桌子下与PC相连的空闲USB端口。 <br><br> 这是在跟踪，软件制造和安装之后发生的事情： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f54/e21/451/f54e21451bfa4ed38bb087e1641cdf12.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d3d/efa/490/d3defa4908c8471181c4c5a177f66a5a.jpg"></div><br> 如您所见，电路板的底部完全简单明了，而顶部则没有那么复杂。 <br><br> 我不会延迟绘图的结束，我会立即说，经验表明，可以使用3.3 V电源为GL823F供电，切换XS4不会影响除功耗（非电流）以外的任何影响。 <br><br> 为了确保所制作的板正常工作，我们同时测量了三种不同的micro-SD卡的记录速度和消耗的电流。 摄影比赛选手-在摄影棚里！ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5d0/b44/93f/5d0b4493fa7b4383bf2209d97733a56f.jpg"></div><br> 使用这种组合的电池充电电流-电压-量表来进行电流消耗的评估（测量已完成的操作，无法说出我的舌头）。 坦白地说，他还传输USB数据令人惊讶。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ccb/1ec/e7f/ccb1ece7f12d4f14b50c78a014df4dfc.jpg"></div><br> 我们仅使用了消耗电流的指示，这可以说是仪器的分压价格为0.01A，加上至少1位最低有效数字单位的采样误差仍为0.01A。 因此，该表仅显示指示范围，在此范围之间消耗电流的数字跳变。 但是，我希望对于那些有兴趣在决策中应用GL823的人来说，仍然有可能评估最高消耗标准。 <br><br> 除了测试所制作的电路板以外，为了提高客观性，还使用另一个SD卡读取器进行了一些控制测量。 这是一个： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bb6/65a/79d/bb665a79dcfa41269e29baf219bb7977.jpg"></div><br> 这个样品还没有准备好，我从我女儿那里借了5分钟，如果我把它拿掉了，他们马上就把我拿走了。 可以肯定的是-它的芯片不属于GL823系列，后者的成员能够使用SD标准进行尽可能多的工作，而多标准对他们来说太难了。 <br><br> 读取和写入速度的测量方法是最简单的：将相同的大小为1,058,268 kB的文件写入和读取测试卡。 进行控制实验（在另一台读取器上）仅是为了以一个或另一个十进制顺序排除系统错误，未处理其上的数据，我只是确信，大约消耗的时间和电流要比上一阶段获得的时间和电流要好。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3c9/44d/ea0/3c944dea089342df93633cb585f542fa.png"></div><br> 如果要在项目中应用上述电路，则在估算功耗时，请纠正以下事实：供电电流来自5伏的USB电压，而GL823由3.3伏电压供电，且差值为5-3.3 = 1.7（这是50 3.3的百分比）在DA2上丢失了。 当使用3.3伏的集中式电源（我希望是脉冲式）供电时，我们可以节省很多钱。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN403199/">https://habr.com/ru/post/zh-CN403199/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN403185/index.html">优步如何操纵人</a></li>
<li><a href="../zh-CN403189/index.html">如何疯狂对待。 1.1-药物治疗：基础知识和精神分裂症</a></li>
<li><a href="../zh-CN403191/index.html">登录ROS程序</a></li>
<li><a href="../zh-CN403193/index.html">我们如何进行音频表演和展示厅</a></li>
<li><a href="../zh-CN403197/index.html">为什么物理学家如此担心黑洞中信息消失的悖论</a></li>
<li><a href="../zh-CN403201/index.html">殖民地 第9章：意外攻击</a></li>
<li><a href="../zh-CN403203/index.html">真空技术展览会2017</a></li>
<li><a href="../zh-CN403209/index.html">如何在欧洲开设银行：为Polybius住所选择一个国家</a></li>
<li><a href="../zh-CN403213/index.html">爱好+业务或如何让自己成为客户的鞋子</a></li>
<li><a href="../zh-CN403215/index.html">您不能再借用Uber</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>