<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💺 📡 😿 使用BAM调制的CPLD上的LED面板的DIY控制器 🐼 🤘🏼 💓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前段时间，他参加了关于矩阵LED手表的DIY项目的讨论。 
 令我惊讶的是，步长为5毫米的古老单色8x8 LED矩阵被用作显示设备。 此外，还为它们繁育了复杂的印刷电路板，并做出了柔和的动态指示。 而这是一个现成的全彩64x32 LED面板（间距为3 mm）很早就以10到20美元的价格上市了。 这样...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用BAM调制的CPLD上的LED面板的DIY控制器</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409743/"> 前段时间，他参加了关于矩阵LED手表的DIY项目的讨论。 <br> 令我惊讶的是，步长为5毫米的古老单色8x8 LED矩阵被用作显示设备。 此外，还为它们繁育了复杂的印刷电路板，并做出了柔和的动态指示。 而这是一个现成的全彩64x32 LED面板（间距为3 mm）很早就以10到20美元的价格上市了。 这样的面板的总体种类非常大，像素间距为2至10 mm，几乎任何尺寸。 <br><a name="habracut"></a><br> 同时，在DIY设计中使用这种面板非常困难-现成的控制器要花很多钱，而且没有普通的API。 要在DIY中常用的微控制器上快速扫描面板是非常困难的。 此外，必须高精度地保持时间间隔-否则会出现明显的亮度不均。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Adafruit</a>有很好的解决方案，但它们都非常昂贵且复杂。 <br><br> 经过一番思考，这个想法浮出水面-为什么不制造一种非常便宜的电路板，该电路板将成为像arduino这样的普通便士板和LED面板之间的桥梁？ 经过几个月的大惊小怪，有些事情诞生了。 <br><br> 本文介绍了控制器的第二个改进版本。 <br><cut><br><h2> 挑战赛 </h2><br> 作为一项基本任务，我希望能够控制总尺寸至少为64x64的面板，同时能够至少在Highcolor（RGB565）下工作，同时保持可接受的屏幕刷新率（至少50Hz）。 在控制器的第一个版本中，基本任务已被完全实现，但是出现了通过另一种很有前途的方法来执行任务的想法，第二个版本由此诞生。 <br><br><h2> 典型LED面板设计的基本说明 </h2><br> 输入HUB75界面： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2d/yn/gt/2dyngtqqelfmxsb9iseipe2c29u.jpeg"></div><br> 在每个颜色输入处，都有一串HC595类型的寄存器（但用于LED的特殊16通道版本）。 有太多的寄存器足以容纳面板的宽度。 粉碎，并行引导和输出许可对于所有寄存器都是通用的。 输入ABCDE-这是系列的选择-转至常规解码器。 <br><br> 工作原理： <br><br><ul><li> 将数据设置为RGB输入，单击CLK按钮。 重复直到加载整个行 </li><li> 关闭输出OE = 1（这样就不会产生干扰） </li><li> 给解码器加载的行号 </li><li> 单击并行加载LAT-将行数据传输到输出寄存器 <br> 使能输出OE = 0 </li><li> 对下一行重复 </li></ul><br> 这是经典的动态指示。 显然，使用这种方法在一个这样的周期中，我们只能打开/关闭每个特定的LED。 <br><br> 为了获得经典PWM的亮度等级，必须将此类循环重复N-1次，其中N是亮度等级的数量（RGB888为256）。 而且鉴于它仍然在闪烁-所有这些必须非常非常快地完成。 <br><br> 有一种解决方法-位角调制（BAM）。 在这种情况下，每个周期的辉光时间与显示位的权重成正比。 也就是说，对于RGB888，您只需要8个显示周期。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>稍微详细<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一点</a> 。 <br><br> 控制器的第一个版本使用经典的PWM，它对扫描周期数施加了严格的限制。 在第二个版本中，实施了BAM，从而极大地提高了速度。 <br><br><h2> 实作 </h2><br> 很明显，传统的微控制器仅拉小面板-大面板根本没有足够的速度。 因此，CPLD或FPGA在这里是必不可少的-在物理上不可能在低成本微控制器上产生数十MB / s。 <br><br> 作为存储器，非常有趣的FIFO存储器Averlogic AL422B在IXBT论坛上向我推荐了该存储器，该存储器具有大约400 KB的存储器，并且可以在高达50MHz的频率下运行。 <br><br> 考虑到我的主要要求是最大程度地降低组件成本，以便自制制造商可以使用制成的围巾，因此选择了带有64个宏单元的Altera EPM3064-CPLD。 同时，如此少量的宏单元不允许制作可动态配置的板-必须将配置直接编译到CPLD中。 <br><br>  →结果电路就<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a> <br><br> 详细资料： <br><br><ul><li>  CPLD EPM3064ATC44-10-阿里的价格大约是每打$ 13-15 </li><li>  FIFO RAM AL422B-Ali的价格约为每打$ 15 </li><li>  50MHz晶体振荡器。 该板可用于DIP14 / DIP8 / 7050机箱的安装。 阿里的价格大约是每打6-7美元 </li><li> 采用SOT223封装的3.3V稳压器。 芯片和浸入式价格-每个40r </li><li>  IDC-10MS连接器。 切片和浸洗的价格-3 p /件 </li><li>  IDC-16MS连接器。 切片和浸洗的价格-8转/片 </li><li>  IDC-14MS连接器。 切片和浸洗的价格-7 r /件 </li><li> 电容器1微法拉0805-8件约1 r /件 </li><li> 电容器0.1uF 0805-约1 r /件 </li><li> 电阻10k 0805-一分钱 </li></ul><br> 得到的详细总数为1.5 + 1.5 + 0.7 = $ 3.7和40 + 3 + 8 + 7 + 8 * 1 +1 = 67 p。 总计在5美元以内-一分钱。 <br><br>  →原始的木板图像在<a href="">这里</a> <br><br>  →准备的Gerber <a href="">文件可订购</a> <br><br> 评估板已准备好用于第一个没有RE控制的版本。 要将其与第二个版本一起使用，必须在AL422B的端子23和24之间切下跳线，并将电线从EPM3064的端子28（带到端子块）连接到AL422B的端子24。 <br><br> 焊接电路板时，请勿忘记在电路板背面焊接电源跳线。 <br><br><img src="https://habrastorage.org/webt/y6/hy/i6/y6hyi6obrqqyyybfvractvmtuqy.jpeg"><br><br><img src="https://habrastorage.org/webt/u1/n1/jr/u1n1jr2zzs7sqfwpzxji2xpg2pg.jpeg"><br><br><h2> 计算方式 </h2><br> 所需参数的计算非常复杂。 <br><br> 事实是，在控制器中并行执行两个过程-加载下一行的数据/指示已经加载的行。 <br><br> 进程同时开始，但在不同时间结束，因此更快的进程会等待更长的进程的完成。 <br><br>  →制作了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Excel数位板</a>进行计算 <br><br> 源数据： <br><br><ul><li>  CRYSTAL_FRQ（MHz）-发生器频率（50 MHz） </li><li>  PIXEL_COUNT-下载栏中的像素数。 在切换部分中有更多详细信息。 </li><li>  RGB_INPUTS-在所使用面板的HUB75E界面中使用的RGB输入数量。  1或2 </li><li>  BYTES_PER_PIXEL-每个像素字节。 在我们的情况下，始终为3-RGB888 </li><li>  SCAN_LINES-使用的面板中的扫描线数。  8/16/32 </li></ul><br> 所选参数： <br><br><ul><li>  PRE_DELAY-从LAT信号到OE开启的延迟，以刻度为单位 </li><li> 预分频器-主计数器的预分频器。 也就是说，如果价格表为8，当前位的权重为4，则OE将打开8 * 4 = 32个周期 </li><li>  POST_DELAY-从关闭OE到下一个LAT信号的最小延迟，以刻度为单位 </li></ul><br> 例如，我们有一个32x32面板，其中包含8条扫描线和2个RGB输入。 这样的面板有两个HUB75E连接器，也就是说，实际上是两个32x16面板。 我们将这些面板串联连接，也就是说，从逻辑上讲，该面板看起来像64x16。 <br><br>  PRE_DELAY和POST_DELAY是输出使能（OE）之前和之后的消隐间隔，以便多路复用器可以切换输出和打开/关闭键。 没有它们，就会存在从燃烧像素到相邻行的“技巧”。 通过实验为特定面板选择值。 通常15个小节就足够了（按小节设置）。 <br><br> 这就提出了选择预分频器的问题-如何选择它。 <br><br> 低的预分频值会缩短帧显示时间，但会降低整体亮度。 预分频器的高值会增加帧的显示时间，即枚举时会闪烁屏幕。 <br><br> 让我们尝试PRESCALER = 1 <br><br> 我们得到： <br><br>  OE_EFFICIENCY-8.3％，即面板将仅工作于最大可能亮度的8.3％ <br>  FRAMES_PER_SECOND-2034 fps-但图片的刷新率非常高-超过2000 fps。 <br><br> 亮度损失已经非常大。 <br><br> 让我们尝试PRESCALER = 16 <br><br> 我们得到： <br><br>  OE_EFFICIENCY-72.9％，即面板将以可能的最大亮度的72.9％工作 <br>  FRAMES_PER_SECOND-1117-图片的刷新率非常好-超过1000 fps。 <br> 好吧，这很正常-效率超过50％是非常正常的，并且帧速率非常好。 <br><br> 一般的经验法则是PRESCALER大约比产品PIXEL_COUNT * RGB_INPUTS小8倍 <br><br> 好吧，继续计数和检查。 <br><br><h2> 切换LED面板 </h2><br> 所有面板均串联连接。 连接图：首先从右到左，然后从下到上。 也就是说，首先我们将水平线串联起来，然后将底行的输出从底端连接到第二行的入口，依此类推。 到第一行。 <br><br> 控制器紧贴右下面板。 <br><br> 有具有两个输入和两个输出连接器的面板。 这样的面板本质上仅是两个面板垂直的机械组装。 转换为两个独立的面板。 <br><br> 组装后，我们需要计算以像素为单位的链的总长度-为此，我们要查看-链中有多少个总面板，然后将此数字乘以面板的宽度（以像素为单位）。 然后，需要在CPLD配置期间将此数字驱动到PIXEL_COUNT值中，并将其驱动到时序计算器中。 <br><br><h2>  FPGA固件 </h2><br> 所有必需的文件都在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github上</a> 。 您需要直接通过文件夹下载。 <br><br> 注册后，您必须从Altera网站下载并安装<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Quartus II 13.0sp1</a> 。 您需要下载完全与此版本-较新的版本不再支持MAX3000系列。 无需破坏它-Web版（免费）版本就足够了。 下载时，请确保选中MAX3000和Programmer支持框。 以防万一，我警告您-包裹很大，大约有两场演出。 您还将需要Altera USB Blaster-Ali的正常价格约为3美元。 <br><br> 打开al422_bam.qpf项目。 在左侧，打开文件选项卡，然后打开文件al422_bam.v-这是主项目文件。 在其中您需要配置参数： <br><br> 一个面板上有多少个RGB输入-在具有HUB75输入的面板上可以有1个或2个RGB输入。 为了准确找出以这种方式可以输入的数量-我们垂直获取面板中的像素数。 将其除以扫描线的数量（例如，在面板名称中表示为8S）。 除以输入连接器的数量（1或2）。 例如-我有一个32x32面板，8S扫描和两个输入连接器-32/8/2 = 2-这意味着两个RGB输入。 <br><br><pre><code class="hljs powershell">`define RGB_outs <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br> 面板上有多少条扫描线-由于支持HUB75E标准，因此最高可以达到32倍。 扫描行数通常在面板名称中分别为8S / 16S / 32S。 <br><br> 仅一行必须取消注释： <br><br><pre> <code class="hljs powershell">`define SCAN_x8 <span class="hljs-number"><span class="hljs-number">1</span></span> //`define SCAN_x16 <span class="hljs-number"><span class="hljs-number">1</span></span> //`define SCAN_x32 <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br> 链中水平像素的总数。 在整个面板链中都考虑像素-请参见“切换LED面板”部分 <br><br><pre> <code class="hljs powershell">`define PIXEL_COUNT <span class="hljs-number"><span class="hljs-number">64</span></span></code> </pre><br> 输出信号的相位。 最典型的配置是这样的：OE处于低电平活动状态（已删除注释），CLK正在前端运行（注释已打开），LAT处于高电平处于活动状态（注释已打开）。 各种奇怪的选择都是可能的。 通过实验或通过移除电路并搜索使用过的芯片的数据表，找出您只有哪一个。 <br><br><pre> <code class="hljs powershell">//`define LED_LAT_ACTIVE_LOW <span class="hljs-number"><span class="hljs-number">1</span></span> `define LED_OE_ACTIVE_LOW <span class="hljs-number"><span class="hljs-number">1</span></span> //`define LED_CLK_ON_FALL <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  OE信号相对于主计数器的LAT和预分频器的前后延迟。 见上文。 <br><br><pre> <code class="hljs powershell">`define OE_PRESCALER <span class="hljs-number"><span class="hljs-number">16</span></span> `define OE_PREDELAY <span class="hljs-number"><span class="hljs-number">31</span></span> `define OE_POSTDELAY <span class="hljs-number"><span class="hljs-number">31</span></span></code> </pre><br> 全部，按ctrl-L-项目已编译。 如果您未在任何地方拧紧它，将会有几个警告，但应该没有错误。 接下来，我们将焊接好的板子钩在USB Blaster上，并给该板子通电。 在Quartus中，转到工具-程序员。 在“硬件设置”中选择“ USB-blaster”，然后单击“启动”。 就是这样，CPLD已编程。 <br><br><h2> 单片机部分 </h2><br> 通常，输出到控制器的数据非常简单-我们重置写地址，然后顺序发出数据字节，并用WCLK信号对其进行抚摸。 看来，即使是平庸的arduinka也足以应付工作。 但是有两个问题： <br><br>  a）需要很多内存。 即使是在RGB888模式下的小型32x32面板，也需要3kBytes的内存用于屏幕缓冲区。 基于Arduino的普通Atmega328仅包含2 KB的RAM。 当然，您可以使用基于Atmega2560的Mega板，其中包含多达8 kB的RAM，但是对于普通尺寸的面板来说，这还不够用-RGB565模式下的128x64面板需要16kB的内存。 <br><br>  b）在使用AL422B的过程中，出现了任何地方都未记录的故障-以小于2MB / s的速度写入数据时，地址计数器无法正常工作，并且“不在此处”写入数据。 也许这是我党的一个小故障。 也许不是。 但是必须避免这种故障。 鉴于AVR8的工作频率为16 MHz，几乎不可能以所需的速度从中获取数据。 <br><br> 提议的解决方案是基于32位STM32F103C8T6控制器的廉价围巾。 一条围巾的价格大约是阿里每条2.5美元，买一打时大约是1.7美元，这比Arduino Nano还要便宜。 同时，我们获得了功能强大的32位微控制器，工作频率为72 MHz，具有20 kB的RAM和64 kB的闪存（与Nano上的2kB / 8kB Atmega328相比）。 <br><br> 同时，此类板卡已在Arduino环境中成功编程。 关于这一点， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">时钟</a>上有一篇不错的文章，所以我不会重复。 通常，按照文章中所述进行所有操作。 <br><br> 在arduino环境中，选择通用STM32F103C，变体STM32F103C8板。 数据通过DMA，因此您可以使用任何优化选项。 <br><br> 切换发生如下： <br><br> 牢牢地钉在图书馆里： <br>  A0..A7→DI0..DI7 AL422B <br>  B0→WCLK AL422B <br>  B1→WRST AL422B <br><br> 在草图中分配给控制器： <br>  B10→我们AL422B <br><br> 普通线： <br>  G→地 <br><br> 好吧，不要忘记从面板向相应的控制器引脚提供5V / GND电源。 <br><br> 从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">电路中</a>取出控制器上连接器的引脚。 <br><br><img src="https://habrastorage.org/webt/nh/p7/_y/nhp7_ygm9hqmkawess06ypt1oy4.jpeg"><br><br><h2> 软件部分 </h2><br> 由于任务是使所有内容尽可能简单和负担得起，因此所有软件都是针对Arduino环境制作的，并被设计为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LED_PANEL</a>库。 <br><br>  LED-PANEL库积极使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Adafruit GFX</a>库，因此需要安装它。 <br><br> 我强烈建议不要将LED_PANEL库放在库目录中，而是将其保留在草图文件夹中。 事实是，有很多铁绑定的参数，如果要将工作转移到更“胖”的微控制器上，则必须在代码本身中进行很多更改。 <br><br> 初始化大致采用以下形式： <br><br><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"LED_PANEL.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> width 32 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> height 32 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> bpp 3 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> scan_lines 8 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RGB_inputs 2 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> we_out_pin PB10 LED_PANEL led_panel = LED_PANEL(width, height, bpp, scan_lines, RGB_inputs, we_out_pin);</span></span></code> </pre><br> 也就是说，我们创建LED_PANEL类的实例，并为其指定参数： <br><br>  width-面板的总宽度，以像素为单位（总计） <br>  height-面板的总高度，以像素为单位（总计） <br>  bpp-每个像素字节，对于RGB888为3。  BAM版本仅适用于RGB888 <br>  scan_lines-扫描线数为8/16/32。 它必须对应于闪烁到控制器中的模式。 <br>  RGB_inputs-HUB75连接器中RGB输入的数量为1/2。 它必须对应于闪烁到控制器中的模式。 <br>  we_out_pin-WE输出挂钩的引脚 <br><br> 请注意，在初始化期间，仅指定了WE引脚。 由于所有其他引脚都与使用的定时器和DMA通道绑定在一起，因此所有其他引脚都严格地注册在代码中，并且更改它们将对代码进行重大更改。 <br><br> 在设置部分启动和清除屏幕： <br><br><pre> <code class="hljs css"> <span class="hljs-selector-tag"><span class="hljs-selector-tag">led_panel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.begin</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">led_panel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.clear</span></span>();</code> </pre><br> 开始将必要的引脚初始化为输出，连接计时器和DMA <br> 清除清除缓冲区 <br><br> 对于绘图，您可以使用Adafruit GFX库的所有标准过程-从最简单的drawPixel到文本输出。 要输出绘制到缓冲区的程序，请使用： <br><br><pre> <code class="hljs pgsql">led_panel.<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>();</code> </pre><br>  show以这种形式启动通过DMA到控制器的数据传输并立即返回控制。 在led_pa​​nel.OutIsFree（）函数的帮助下确定传输是否已结束-如果说为true，则传输已结束。 有一个功能-如果您在传输尚未完成时致电show-它将被忽略。 <br><br><pre> <code class="hljs pgsql">led_panel.<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre><br> 与show（）类似，但如果调用show（false），并且传输尚未完成，则该过程将等待传输完成，然后开始新的传输并返回控件： <br><br><pre> <code class="hljs pgsql">led_panel.<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre><br> 类似于show（false），但如果调用show（true），则在新的传输开始之后，该过程在传输完成之前不会返回控制权。 <br><br> 一般来说，仅此而已。 <br><br><img src="https://habrastorage.org/webt/pn/-a/of/pn-aofhwnhuuzszuk_mcf9upqje.jpeg"><br><br> 关于软件的一些注意事项： <br><br>  a）当使用ExpandColor函数从RGB565（库使用）重新计算颜色时，引入了伽玛校正。 在所有其他情况下，都使用线性传递函数，即亮度与该值成正比。 <br>  b）软件允许您将多个LED控制器连接到一个微控制器板上。 为此，将数据总线，RST和CLK线并行发送到控制器。 通过WE线选择所需的控制器。 在软件中，您需要为每个控制器创建一个单独的LED_PANEL类实例，并且每个实例在初始化期间必须具有不同的WE行（最后一个参数）。 <br><br><h2> 要做 </h2><br>  -处理相邻行中的花朵“拾取”。 面板本身的接线看上去很差（按键杂乱），但是您需要检查一下。 刚到一个新面板-我会检查； <br>  -制作新版的电路板-带有已经离婚的RE并增加5V的输出电平转换器； <br>  -创建META_LED_PANEL类，该类将允许将多个LED_PANEL组合到一个虚拟屏幕中-这将使创建具有多个控制器的超大屏幕成为可能； <br>  -将来，请使用功能更强大的CPLD系列产品，例如CycloneIV。 这将在保持低成本的同时极大地扩展可能性（对于中国人而言，EP4CE6E22的成本约为5美元，而宏单元的数量增加了100倍，内部存储器约为32 kB）。 但是有一天我会做的。 如果我想。 由于这种发展需要太多时间。 </cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN409743/">https://habr.com/ru/post/zh-CN409743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN409731/index.html">Hashflare获利能力审查。 我六个月的经验</a></li>
<li><a href="../zh-CN409733/index.html">需要更快的数据和更清洁的地球？ 开始开发小行星</a></li>
<li><a href="../zh-CN409735/index.html">共识层错觉</a></li>
<li><a href="../zh-CN409739/index.html">彭博社：Telegram计划在ICO期间获得超过10亿美元的收益</a></li>
<li><a href="../zh-CN409741/index.html">白宫有兴趣发射猎鹰重型</a></li>
<li><a href="../zh-CN409745/index.html">这位AI专家声称他设法理解了Voynich手稿所用的语言</a></li>
<li><a href="../zh-CN409747/index.html">AttnGAN神经网络不仅使用句子而且还使用单词的向量空间来绘制零件中的对象</a></li>
<li><a href="../zh-CN409749/index.html">热解锅炉在家里，还是气价的时候都没关系</a></li>
<li><a href="../zh-CN409751/index.html">AudioFilkina信：蓝牙音乐-不是为了炒作，而是为了好</a></li>
<li><a href="../zh-CN409753/index.html">联合国可能完成大规模随机试验以减少全球变暖</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>