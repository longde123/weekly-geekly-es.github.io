<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ­ ğŸ¯ â†ªï¸ åˆ†è§£UICollectionViewCell ğŸ’€ ğŸˆšï¸ ğŸ§™ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨è§‚çœ‹äº†Keynote WWDC 2019å¹¶äº†è§£äº†SwiftUIä¹‹å ï¼Œæˆ‘æ‰“ç®—æ¨æµ‹å¦‚ä½•ä»¥å£°æ˜æ€§çš„æ–¹å¼å¡«å†™ç›˜å­å’Œæ”¶è—å“ï¼Œ SwiftUIæ—¨åœ¨ç”¨ä»£ç å£°æ˜æ€§åœ°æè¿°UIã€‚ ä¾‹å¦‚ï¼Œåƒè¿™æ ·ï¼š 


enum Builder { static func widgets(objects: Objects) -> [...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åˆ†è§£UICollectionViewCell</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455421/"><p> åœ¨è§‚çœ‹äº†Keynote WWDC 2019å¹¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†è§£äº†SwiftUIä¹‹å</a> ï¼Œæˆ‘æ‰“ç®—æ¨æµ‹å¦‚ä½•ä»¥å£°æ˜æ€§çš„æ–¹å¼å¡«å†™ç›˜å­å’Œæ”¶è—å“ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SwiftUI</a>æ—¨åœ¨ç”¨ä»£ç å£°æ˜æ€§åœ°æè¿°UIã€‚ ä¾‹å¦‚ï¼Œåƒè¿™æ ·ï¼š </p><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Builder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(objects: Objects)</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Widget</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> header = [ <span class="hljs-type"><span class="hljs-type">Spacing</span></span>(height: <span class="hljs-number"><span class="hljs-number">25</span></span>).widget, <span class="hljs-type"><span class="hljs-type">Header</span></span>(string: <span class="hljs-string"><span class="hljs-string">" "</span></span>).widget, <span class="hljs-type"><span class="hljs-type">Spacing</span></span>(height: <span class="hljs-number"><span class="hljs-number">10</span></span>, separator: .bottom).widget ] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> body = objects .flatMap({ (object: <span class="hljs-type"><span class="hljs-type">Object</span></span>) -&gt; [<span class="hljs-type"><span class="hljs-type">Widgets</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-type"><span class="hljs-type">Title</span></span>(object: object).widget, <span class="hljs-type"><span class="hljs-type">Spacing</span></span>(height: <span class="hljs-number"><span class="hljs-number">1</span></span>, separator: .bottom).widget ] }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> header + body } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> objects: [<span class="hljs-type"><span class="hljs-type">Object</span></span>] = ... <span class="hljs-type"><span class="hljs-type">Builder</span></span> .widgets(objects: objects) .bind(to: collectionView)</code> </pre> <br><p> åœ¨é›†åˆä¸­ï¼Œå‘ˆç°æ–¹å¼å¦‚ä¸‹ï¼š <a name="habracut"></a></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/el/r0/bp/elr0bpuqgbgcm5unfprets9_woc.png" alt="å›¾ç‰‡"></div><p></p><br><h1 id="vvedenie"> å¼•è¨€ </h1><br><p> å¦‚æ‚¨æ‰€çŸ¥ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æƒå¨äººå£«è¡¨ç¤º</a> ï¼šå…¸å‹çš„iOSå¼€å‘äººå‘˜å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ä½¿ç”¨å¹³æ¿ç”µè„‘ã€‚ å¦‚æœæˆ‘ä»¬å‡è®¾é¡¹ç›®çš„å¼€å‘äººå‘˜éå¸¸ç¼ºä¹ï¼Œè€Œå¹³æ¿ç”µè„‘ä¹Ÿä¸æ˜¯é‚£ä¹ˆç®€å•ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„æ—¶é—´ç»å¯¹æ²¡æœ‰å‰©ä¸‹ã€‚ è¿™éœ€è¦åšäº›äº‹æƒ…ã€‚å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯ç»†èƒåˆ†è§£ã€‚ </p><br><p> ç»†èƒåˆ†è§£æ˜¯æŒ‡ç”¨å‡ ä¸ªè¾ƒå°çš„ç»†èƒä»£æ›¿ä¸€ä¸ªç»†èƒã€‚ æ›´æ¢åï¼Œå¤–è§‚ä¸Šä»€ä¹ˆéƒ½ä¸ä¼šæ”¹å˜ã€‚ ä¾‹å¦‚ï¼Œè¯·è€ƒè™‘æ¥è‡ªVKæ–°é—»æºï¼ˆé€‚ç”¨äºiOSï¼‰çš„å¸–å­ã€‚ ä¸€ä¸ªå¸–å­å¯ä»¥è¡¨ç¤ºä¸ºå•ä¸ªå•å…ƒæ ¼ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºä¸€ç»„å•å…ƒæ ¼- <strong>åŸºæœ¬ä½“</strong> ã€‚ </p><br><p> åˆ†è§£ç»†èƒå¹¶ä¸æ€»æ˜¯æœ‰æ•ˆã€‚ å¾ˆéš¾å°†ä¸€ä¸ªå•å…ƒåˆ†è§£ä¸ºåœ¨å„ä¸ªä¾§é¢éƒ½å…·æœ‰é˜´å½±æˆ–å››èˆäº”å…¥çš„åŸºå…ƒã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸå§‹å•å…ƒå°†æ˜¯åŸå§‹çš„ã€‚ </p><br><h1 id="plyusy-i-minusy"> åˆ©å¼Š </h1><br><p> ä½¿ç”¨å•å…ƒæ ¼çš„åˆ†è§£ï¼Œè¡¨/é›†åˆå¼€å§‹ç”±é€šå¸¸å°†è¢«é‡ç”¨çš„åŸºå…ƒç»„æˆï¼šå…·æœ‰æ–‡æœ¬çš„åŸºå…ƒï¼Œå…·æœ‰å›¾ç‰‡çš„åŸºå…ƒï¼Œå…·æœ‰èƒŒæ™¯çš„åŸºå…ƒç­‰ã€‚ ä¸å…·æœ‰å¤§é‡çŠ¶æ€çš„å¤æ‚å•å…ƒæ ¼ç›¸æ¯”ï¼Œå•ä¸ªåŸºå…ƒé«˜åº¦çš„è®¡ç®—è¦ç®€å•å¾—å¤šï¼Œå¹¶ä¸”æ•ˆç‡æ›´é«˜ã€‚ å¦‚æœéœ€è¦ï¼Œå¯ä»¥è®¡ç®—å›¾å…ƒçš„åŠ¨æ€é«˜åº¦ï¼Œç”šè‡³å¯ä»¥åœ¨èƒŒæ™¯ä¸­ç»˜åˆ¶å®ƒçš„é«˜åº¦ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡<code>CTFramesetter</code>æ–‡æœ¬ï¼‰ã€‚ </p><br><p> å¦ä¸€æ–¹é¢ï¼Œå¤„ç†æ•°æ®å˜å¾—æ›´åŠ å¤æ‚ã€‚ æ¯ä¸ªåŸè¯­éƒ½éœ€è¦æ•°æ®ï¼Œå¹¶ä¸”æ ¹æ®åŸè¯­çš„<code>IndexPath</code>å°†å¾ˆéš¾ç¡®å®šå®ƒå±äºå“ªä¸ªå®é™…å•å…ƒã€‚ æˆ‘ä»¬å°†ä¸å¾—ä¸å¼•å…¥æ–°çš„æŠ½è±¡å±‚æˆ–ä»¥æŸç§æ–¹å¼è§£å†³è¿™äº›é—®é¢˜ã€‚ </p><br><p> æ‚¨å¯ä»¥é•¿æ—¶é—´è®¨è®ºè¿™é¡¹è®¡åˆ’çš„åˆ©å¼Šï¼Œä½†æœ€å¥½å°è¯•æè¿°ç»†èƒåˆ†è§£çš„æ–¹æ³•ã€‚ </p><br><h1 id="vybiraem-instrumenty"> é€‰æ‹©å·¥å…· </h1><br><p> ç”±äº<code>UITableView</code>æœ‰é™ï¼Œå¹¶ä¸”å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬çš„æ¿å—ç›¸å½“å¤æ‚ï¼Œå› æ­¤åˆé€‚çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨<code>UICollectionView</code> ã€‚ å…³äº<code>UICollectionView</code> ï¼Œå°†åœ¨æœ¬å‡ºç‰ˆç‰©ä¸­è¿›è¡Œè®¨è®ºã€‚ </p><br><p> ä½¿ç”¨<code>UICollectionView</code>é‡åˆ°åŸºæœ¬<code>UICollectionViewFlowLayout</code>æ— æ³•å½¢æˆé›†åˆå…ƒç´ çš„æ‰€éœ€æ’åˆ—çš„æƒ…å†µï¼ˆæˆ‘ä»¬ä¸è€ƒè™‘æ–°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>UICollectionViewCompositionalLayout</code></a> ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸ä¼šå†³å®šæ‰¾åˆ°ä¸€äº›å¼€æºçš„<code>UICollectionViewLayout</code> ã€‚ ä½†æ˜¯ï¼Œå³ä½¿åœ¨ç°æˆçš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰åˆé€‚çš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚åœ¨å¤§å‹åœ¨çº¿å•†åº—æˆ–ç¤¾äº¤ç½‘ç»œçš„åŠ¨æ€ä¸»é¡µçš„æƒ…å†µä¸‹ã€‚ æˆ‘ä»¬å‡è®¾æœ€åçš„æƒ…å†µï¼Œå› æ­¤æˆ‘ä»¬å°†åˆ›å»ºè‡ªå·±çš„é€šç”¨<code>UICollectionViewLayout</code> ã€‚ </p><br><p> é™¤äº†é€‰æ‹©å¸ƒå±€çš„å›°éš¾ä¹‹å¤–ï¼Œæ‚¨è¿˜éœ€è¦ç¡®å®šé›†åˆå°†å¦‚ä½•æ¥æ”¶æ•°æ®ã€‚ é™¤äº†é€šå¸¸çš„æ–¹æ³•ï¼ˆå¯¹è±¡ï¼ˆé€šå¸¸æ˜¯<code>UIViewController</code> ï¼‰ç¬¦åˆ<code>UICollectionViewDataSource</code>åè®®å¹¶ä¸ºé›†åˆæä¾›æ•°æ®ï¼‰å¤–ï¼Œæ•°æ®é©±åŠ¨æ¡†æ¶çš„ä½¿ç”¨æ­£å˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚ è¿™ç§æ–¹æ³•çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ°å‡º</a>ä»£è¡¨æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CollectionKit</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IGListKit</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxDataSources</a>ç­‰ã€‚ ä½¿ç”¨æ­¤ç±»æ¡†æ¶ç®€åŒ–äº†é›†åˆçš„å·¥ä½œï¼Œå¹¶æä¾›äº†å¯¹æ•°æ®æ›´æ”¹è¿›è¡ŒåŠ¨ç”»å¤„ç†çš„åŠŸèƒ½ï¼Œå› ä¸º æ¡†æ¶ä¸­å·²ç»å­˜åœ¨å·®å¼‚ç®—æ³•ã€‚ å‡ºäºå‘å¸ƒç›®çš„ï¼Œå°†é€‰æ‹©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxDataSources</a>æ¡†æ¶ã€‚ </p><br><h1 id="vidzhet-i-ego-svoystva"> å°éƒ¨ä»¶åŠå…¶å±æ€§ </h1><br><p> æˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªä¸­é—´æ•°æ®ç»“æ„ï¼Œå¹¶å°†å…¶ç§°ä¸º<strong>å°éƒ¨ä»¶</strong> ã€‚ æˆ‘ä»¬æè¿°äº†å°éƒ¨ä»¶åº”å…·æœ‰çš„ä¸»è¦å±æ€§ï¼š </p><br><ol><li> å°éƒ¨ä»¶å¿…é¡»ç¬¦åˆä½¿ç”¨æ•°æ®é©±åŠ¨æ¡†æ¶çš„å¿…è¦åè®®ã€‚ æ­¤ç±»åè®®é€šå¸¸åŒ…å«å…³è”çš„å€¼ï¼ˆä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxDataSources</a>ä¸­çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IdentifiableType</a> ï¼‰ </li><li> åº”è¯¥å¯ä»¥å°†ä¸åŒå›¾å…ƒçš„çª—å£å°éƒ¨ä»¶ç»„è£…æˆä¸€ä¸ªæ•°ç»„ã€‚ ä¸ºæ­¤ï¼Œå°éƒ¨ä»¶ä¸åº”å…·æœ‰å…³è”çš„å€¼ã€‚ ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç±»å‹æ“¦é™¤æœºåˆ¶æˆ–ç±»ä¼¼çš„æœºåˆ¶ã€‚ </li><li> å°éƒ¨ä»¶åº”è¯¥èƒ½å¤Ÿè®¡ç®—åŸºå…ƒçš„å¤§å°ã€‚ ç„¶åï¼Œåœ¨å½¢æˆ<code>UICollectionViewLayout</code> ï¼Œä»…ä¿ç•™æ ¹æ®é¢„å®šä¹‰è§„åˆ™æ­£ç¡®å®šä½å›¾å…ƒçš„æ—¶é—´ã€‚ </li><li> å°éƒ¨ä»¶å¿…é¡»æ˜¯<code>UICollectionViewCell</code>çš„å·¥å‚ã€‚ å› æ­¤ï¼Œä»<code>UICollectionViewDataSource</code>çš„å®ç°ä¸­<code>UICollectionViewDataSource</code>å°†åˆ é™¤æ‰€æœ‰ç”¨äºåˆ›å»ºå•å…ƒæ ¼çš„é€»è¾‘ï¼Œå‰©ä¸‹çš„å°±æ˜¯ï¼š <br><pre> <code class="plaintext hljs">let cell = widget.widgetCell(collectionView: collectionView, indexPath: indexPath) return cell</code> </pre> </li></ol><br><h1 id="realizaciya-vidzheta"> å°éƒ¨ä»¶å®ç° </h1><br><p> ä¸ºäº†èƒ½å¤Ÿå°†çª—å£å°éƒ¨ä»¶ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxDataSources</a>æ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¿…é¡»ç¬¦åˆ</a> <code>Equatable</code>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>IdentifiableType</code></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åè®®</a> ã€‚ ç”±äºçª—å£å°éƒ¨ä»¶è¡¨ç¤ºä¸€ä¸ªåŸè¯­ï¼Œå› æ­¤å¦‚æœçª—å£å°éƒ¨ä»¶æ ‡è¯†è‡ªå·±ç¬¦åˆ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>IdentifiableType</code></a>åè®®ï¼Œå°±è¶³ä»¥ç”¨äºå‘å¸ƒç›®çš„ã€‚ å®é™…ä¸Šï¼Œè¿™å°†å½±å“ä»¥ä¸‹äº‹å®ï¼šå½“çª—å£å°éƒ¨ä»¶å‘ç”Ÿæ›´æ”¹æ—¶ï¼ŒåŸè¯­å°†ä¸ä¼šé‡æ–°åŠ è½½ï¼Œè€Œæ˜¯ä¼šåˆ é™¤å¹¶æ’å…¥ã€‚ ä¸ºæ­¤ï¼Œè¯·å¼•å…¥æ–°çš„<code>WidgetIdentifiable</code>åè®®ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetIdentifiable</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IdentifiableType</span></span></span><span class="hljs-class"> </span></span>{ } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetIdentifiable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> identity: <span class="hljs-type"><span class="hljs-type">Self</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> } }</code> </pre> <br><p> ä¸ºäº†ç¬¦åˆ<code>WidgetIdentifiable</code> ï¼Œçª—å£å°éƒ¨ä»¶éœ€è¦ç¬¦åˆ<code>Hashable</code>åè®®ã€‚  <code>Hashable</code>æ§ä»¶å°†ä»å¯¹è±¡ä¸­è·å–æ•°æ®ä»¥ç¬¦åˆåè®®ï¼Œè¯¥å¯¹è±¡å°†æè¿°ç‰¹å®šçš„åŸè¯­ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<code>AnyHashable</code>æ¥â€œæ“¦é™¤â€å¯¹è±¡ç±»å‹çª—å£å°éƒ¨ä»¶ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Widget</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetIdentifiable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> underlying: <span class="hljs-type"><span class="hljs-type">AnyHashable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(<span class="hljs-number"><span class="hljs-number">_</span></span> underlying: <span class="hljs-type"><span class="hljs-type">AnyHashable</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.underlying = underlying } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Widget</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.underlying.hash(into: &amp;hasher) } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> ==</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lhs: Widget, rhs: Widget)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs.underlying == rhs.underlying } }</code> </pre> <br><p> åœ¨æ­¤é˜¶æ®µï¼Œå°†æ‰§è¡Œå°éƒ¨ä»¶çš„å‰ä¸¤ä¸ªå±æ€§ã€‚ é€šè¿‡åœ¨æ•°ç»„ä¸­æ”¶é›†å…·æœ‰ä¸åŒç±»å‹å¯¹è±¡çš„å‡ ä¸ªå°éƒ¨ä»¶ï¼Œè¿™å¹¶ä¸éš¾æ£€æŸ¥ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> widgets = [<span class="hljs-type"><span class="hljs-type">Widget</span></span>(<span class="hljs-string"><span class="hljs-string">"Hello world"</span></span>), <span class="hljs-type"><span class="hljs-type">Widget</span></span>(<span class="hljs-number"><span class="hljs-number">100500</span></span>)]</code> </pre> <br><p> ä¸ºäº†å®ç°å…¶ä½™å±æ€§ï¼Œæˆ‘ä»¬å¼•å…¥äº†æ–°åè®®<code>WidgetPresentable</code> </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetPresentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(collectionView: UICollectionView, indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UICollectionViewCell</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(containerWidth: CGFloat)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">CGSize</span></span> }</code> </pre> <br><p> ç”Ÿæˆå•å…ƒæ ¼çš„å±æ€§æ—¶ï¼Œå°†åœ¨<code>UICollectionViewLayout</code>ä½¿ç”¨<code>widgetSize(containerWidth:)</code>å‡½æ•°ï¼Œå¹¶ä½¿ç”¨<code>widgetCell(collectionView:indexPath:)</code> -è·å–å•å…ƒæ ¼ã€‚ </p><br><p> å¦‚æœå°éƒ¨ä»¶<code>WidgetPresentable</code>åè®®ï¼Œåˆ™å°éƒ¨ä»¶å°†æ»¡è¶³å‘å¸ƒå¼€å§‹æ—¶æŒ‡ç¤ºçš„æ‰€æœ‰å±æ€§ã€‚ ä½†æ˜¯ï¼Œå¿…é¡»å°†å°éƒ¨ä»¶AnyHashableä¸­åŒ…å«çš„å¯¹è±¡æ›¿æ¢ä¸º<code>WidgetPresentable</code>å’Œ<code>WidgetHashable</code> ï¼Œå…¶ä¸­<code>WidgetHashable</code>å°†ä¸å…·æœ‰å…³è”å€¼ï¼ˆå¦‚<code>Hashable</code>çš„æƒ…å†µï¼‰ï¼Œå¹¶ä¸”å°éƒ¨ä»¶å†…éƒ¨çš„å¯¹è±¡ç±»å‹å°†ä¿æŒâ€œæ“¦é™¤â€ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetHashable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> any: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> }</code> </pre> <br><p> åœ¨æœ€ç»ˆç‰ˆæœ¬ä¸­ï¼Œå°éƒ¨ä»¶å°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Widget</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetIdentifiable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> underlying: <span class="hljs-type"><span class="hljs-type">WidgetHashable</span></span> &amp; <span class="hljs-type"><span class="hljs-type">WidgetPresentable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(<span class="hljs-number"><span class="hljs-number">_</span></span> underlying: <span class="hljs-type"><span class="hljs-type">WidgetHashable</span></span> &amp; <span class="hljs-type"><span class="hljs-type">WidgetPresentable</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.underlying = underlying } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Widget</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.underlying.widgetHash(into: &amp;hasher) } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> ==</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lhs: Widget, rhs: Widget)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs.underlying.widgetEqual(rhs.underlying) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Widget</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetPresentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(collectionView: UICollectionView, indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UICollectionViewCell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> underlying.widgetCell(collectionView: collectionView, indexPath: indexPath) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(containerWidth: CGFloat)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">CGSize</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> underlying.widgetSize(containerWidth: containerWidth) } }</code> </pre> <br><h1 id="obekt-primitiva"> åŸå§‹å¯¹è±¡ </h1><br><p> è®©æˆ‘ä»¬å°è¯•ç»„è£…æœ€ç®€å•çš„å›¾å…ƒï¼Œå®ƒæ˜¯ç»™å®šé«˜åº¦çš„ç¼©è¿›ã€‚ </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spacing</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> height: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpacingView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIView</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> constraint = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.heightAnchor.constraint(equalToConstant: <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(frame: .zero) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.constraint.isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spacing</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetHashable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetEqual</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> any: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> spacing = any <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">Spacing</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> == spacing } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.hash(into: &amp;hasher) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Spacing</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WidgetPresentable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(collectionView: UICollectionView, indexPath: IndexPath)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UICollectionViewCell</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell: <span class="hljs-type"><span class="hljs-type">WidgetCell</span></span>&lt;<span class="hljs-type"><span class="hljs-type">SpacingView</span></span>&gt; = collectionView.cellDequeueSafely(indexPath: indexPath) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cell.view == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { cell.view = <span class="hljs-type"><span class="hljs-type">SpacingView</span></span>() } cell.view?.constraint.constant = height <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">widgetSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(containerWidth: CGFloat)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">CGSize</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">CGSize</span></span>(width: containerWidth, height: height) } }</code> </pre> <br><p>  <code>WidgetCell&lt;T&gt;</code>åªæ˜¯<code>UICollectionViewCell</code>çš„å­ç±»ï¼Œå®ƒæ¥å—<code>UIView</code>å¹¶å°†å…¶æ·»åŠ ä¸ºå­è§†å›¾ã€‚  <code>cellDequeueSafely(indexPath:)</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœè¯¥é›†åˆä¸­çš„æŸä¸ªå•å…ƒæ ¼å…ˆå‰æœªæ³¨å†Œï¼Œåˆ™åœ¨é‡ç”¨ä¹‹å‰åœ¨è¯¥é›†åˆä¸­æ³¨å†Œä¸€ä¸ªå•å…ƒæ ¼ã€‚  <code>Spacing</code>å°†æŒ‰ç…§å‡ºç‰ˆç‰©å¼€å¤´æ‰€è¿°çš„æ–¹å¼ä½¿ç”¨ã€‚ </p><br><p> æ”¶åˆ°å°éƒ¨ä»¶æ•°ç»„åï¼Œå®ƒä»…ä¿ç•™ç»‘å®šåˆ°<code>observerWidgets</code> ï¼š </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> <span class="hljs-type"><span class="hljs-type">DataSource</span></span> = <span class="hljs-type"><span class="hljs-type">RxCollectionViewSectionedAnimatedDataSource</span></span>&lt;<span class="hljs-type"><span class="hljs-type">WidgetSection</span></span>&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-built_in"><span class="hljs-built_in">lazy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataSource: <span class="hljs-type"><span class="hljs-type">DataSource</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.makeDataSource() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> observerWidgets: (<span class="hljs-type"><span class="hljs-type">Observable</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Widgets</span></span>&gt;) -&gt; <span class="hljs-type"><span class="hljs-type">Disposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> collectionView.rx.items(dataSource: dataSource) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeDataSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">DataSource</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">DataSource</span></span>(configureCell: { (<span class="hljs-number"><span class="hljs-number">_</span></span>, collectionView: <span class="hljs-type"><span class="hljs-type">UICollectionView</span></span>, indexPath: <span class="hljs-type"><span class="hljs-type">IndexPath</span></span>, widget: <span class="hljs-type"><span class="hljs-type">Widget</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = widget.widgetCell(collectionView: collectionView, indexPath: indexPath) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cell }) } }</code> </pre> <br><h1 id="rezultaty"> ç»“æœ </h1><br><p> æœ€åï¼Œæˆ‘æƒ³å±•ç¤ºè¯¥é›†åˆçš„çœŸå®å·¥ä½œï¼Œè¯¥é›†åˆå®Œå…¨åŸºäºå°éƒ¨ä»¶æ„å»ºã€‚ </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_t/od/tz/_todtzto-dqfqf1nwto9pik694c.gif" alt="å›¾ç‰‡"></div><br><p> å¦‚æ‚¨æ‰€è§ï¼Œ <code>UICollectionViewCell</code>çš„åˆ†è§£<code>UICollectionViewCell</code>å¯è¡Œçš„ï¼Œå¹¶ä¸”åœ¨é€‚å½“çš„æƒ…å†µä¸‹å¯ä»¥ç®€åŒ–å¼€å‘äººå‘˜çš„å·¥ä½œã€‚ </p><br><h1 id="zamechaniya"> å¤‡æ³¨ </h1><br><p> è¯¥å‡ºç‰ˆç‰©ä¸­ç»™å‡ºçš„ä»£ç å·²éå¸¸ç®€åŒ–ï¼Œä¸åº”è¿›è¡Œç¼–è¯‘ã€‚ ç›®çš„æ˜¯æè¿°æ–¹æ³•ï¼Œè€Œä¸æ˜¯æä¾›ç»ŸåŒ…è§£å†³æ–¹æ¡ˆã€‚ </p><br><p>  <code>WidgetPresentable</code>åè®®å¯ä»¥ä½¿ç”¨å…¶ä»–ä¼˜åŒ–å¸ƒå±€çš„åŠŸèƒ½è¿›è¡Œæ‰©å±•ï¼Œä¾‹å¦‚ï¼Œ <code>widgetSizeEstimated(containerWidth:)</code>æˆ–<code>widgetSizePredefined(containerWidth:)</code> ï¼Œå®ƒä»¬åˆ†åˆ«è¿”å›ä¼°è®¡çš„å¤§å°å’Œå›ºå®šçš„å¤§å°ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿å¯¹äºè¦æ±‚è‹›åˆ»çš„è®¡ç®—ï¼Œä¾‹å¦‚å¯¹äº<code>systemLayoutSizeFitting(_:)</code> ï¼Œ <code>widgetSize(containerWidth:)</code>å‡½æ•°ä¹Ÿåº”è¿”å›åŸè¯­çš„å¤§å°ã€‚ è¿™æ ·çš„è®¡ç®—å¯ä»¥é€šè¿‡<code>Dictionary</code> ï¼Œ <code>NSCache</code>ç­‰è¿›è¡Œç¼“å­˜ã€‚ </p><br><p> å¦‚æ‚¨æ‰€çŸ¥ï¼Œ <code>UICollectionView</code>ä½¿ç”¨çš„æ‰€æœ‰å•å…ƒæ ¼ç±»å‹<code>UICollectionView</code>å¿…é¡»åœ¨é›†åˆä¸­é¢„å…ˆæ³¨å†Œã€‚ ä½†æ˜¯ï¼Œä¸ºäº†åœ¨ä¸åŒçš„å±å¹•/é›†åˆä¹‹é—´é‡ç”¨å°éƒ¨ä»¶å¹¶ä¸”ä¸é¢„å…ˆæ³¨å†Œæ‰€æœ‰å•å…ƒæ ¼æ ‡è¯†ç¬¦/ç±»å‹ï¼Œæ‚¨éœ€è¦è·å¾—ä¸€ç§æœºåˆ¶ï¼Œè¯¥æœºåˆ¶å°†åœ¨æ¯ä¸ªé›†åˆä¸­é¦–æ¬¡ä½¿ç”¨å•å…ƒæ ¼ä¹‹å‰ç«‹å³å¯¹å…¶è¿›è¡Œæ³¨å†Œã€‚ åœ¨å‡ºç‰ˆç‰©ä¸­ï¼Œ <code>cellDequeueSafely(indexPath:)</code>ä½¿ç”¨äº†å‡½æ•°<code>cellDequeueSafely(indexPath:)</code> ã€‚ </p><br><p> é›†åˆä¸­ä¸èƒ½æœ‰é¡µçœ‰æˆ–é¡µè„šã€‚ åŸå§‹å…ƒç´ å°†ä»£æ›¿å®ƒä»¬ã€‚ åœ¨ç›®å‰çš„æ–¹æ³•ä¸­ï¼Œè¡¥å……å“çš„å­˜åœ¨ä¸ä¼šå¸¦æ¥ä»»ä½•ç‰¹åˆ«çš„å¥½å¤„ã€‚ é€šå¸¸ï¼Œå½“æ•°æ®æ•°ç»„ä¸¥æ ¼å¯¹åº”äºå•å…ƒæ ¼æ•°é‡å¹¶ä¸”éœ€è¦åœ¨å•å…ƒæ ¼ä¹‹å‰ï¼Œä¹‹åæˆ–ä¹‹é—´æ˜¾ç¤ºå…¶ä»–è§†å›¾æ—¶ï¼Œæ‰ä½¿ç”¨å®ƒä»¬ã€‚ åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¾…åŠ©è§†å›¾çš„æ•°æ®ä¹Ÿå¯ä»¥æ·»åŠ åˆ°å°éƒ¨ä»¶æ•°ç»„ä¸­å¹¶ç»˜åˆ¶ä¸ºåŸè¯­ã€‚ </p><br><p> åœ¨åŒä¸€é›†åˆä¸­ï¼Œå¯ä»¥æ‰¾åˆ°å…·æœ‰ç›¸åŒå¯¹è±¡çš„å°éƒ¨ä»¶ã€‚ ä¾‹å¦‚ï¼Œåœ¨é›†åˆçš„å¼€å¤´å’Œç»“å°¾ä½¿ç”¨ç›¸åŒçš„<code>Spacing</code> ã€‚ è¿™äº›éå”¯ä¸€å¯¹è±¡çš„å­˜åœ¨å°†å¯¼è‡´ä»¥ä¸‹äº‹å®ï¼šé›†åˆä¸­çš„åŠ¨ç”»æ¶ˆå¤±äº†ã€‚ è¦ä½¿æ­¤ç±»å¯¹è±¡å”¯ä¸€ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„<code>AnyHashable</code>æ ‡ç­¾ï¼Œåˆ›å»ºå¯¹è±¡çš„<code>#file</code>å’Œ<code>#line</code>ç­‰ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN455421/">https://habr.com/ru/post/zh-CN455421/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN455407/index.html">ç”µåŠ¨æ±½è½¦å’Œç‡ƒæ²¹æ±½è½¦çš„é”€å”®é«˜å³°</a></li>
<li><a href="../zh-CN455409/index.html">å‘åå…¼å®¹</a></li>
<li><a href="../zh-CN455411/index.html">æ‰©éŸ³å™¨è¿›è¡Œäº†æŠ€æœ¯æ›´æ–°...ç½‘ç»œåç§°</a></li>
<li><a href="../zh-CN455413/index.html">å°†Pocketå˜æˆæ–°é—»æº</a></li>
<li><a href="../zh-CN455419/index.html">Apple Beta Aliveï¼šåœ¨å‘å¸ƒä¼šä¸Šæœªé€éœ²Trivia</a></li>
<li><a href="../zh-CN455425/index.html">é€šè¿‡USBè°ƒåˆ¶è§£è°ƒå™¨åœ¨Mikrotik hEX Så’ŒJuniper SRXä¹‹é—´åˆ›å»ºIPSec GREéš§é“</a></li>
<li><a href="../zh-CN455427/index.html">æˆ‘ä»¬å¦‚ä½•å­¦ä¼šé¢„æµ‹ç”¨æˆ·çš„è¯·æ±‚å¹¶åŠ å¿«æœç´¢ç»“æœçš„è´Ÿè·</a></li>
<li><a href="../zh-CN455429/index.html">ã€Šæ¯ç­æˆ˜å£«ã€‹å¦‚ä½•ç™»ä¸Šè¶…çº§ä»»å¤©å ‚</a></li>
<li><a href="../zh-CN455439/index.html">ç§‘å­¦å®¶åˆ›å»ºçš„æ–°ç®—æ³•ä½¿æ‚¨å¯ä»¥ä¸çœŸå®çš„äººåˆ›å»ºè¿‘ä¹å®Œç¾çš„â€œäº¤è°ˆå¤´â€</a></li>
<li><a href="../zh-CN455441/index.html">6æœˆ21æ—¥ï¼Œè«æ–¯ç§‘ï¼ŒDeworkacy-AnalyzeIT MeetUpï¼ƒ2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>