<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèº üë¶ üë©üèø‚Äçüî¨ 10 raz√µes para n√£o usar o k8s üßùüèø ‚è´ üë®üèø‚Äçü§ù‚Äçüë®üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hoje falaremos sobre o Kubernetes, sobre o rake que pode ser coletado em seu uso pr√°tico e sobre os desenvolvimentos que ajudaram o autor e que tamb√©m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>10 raz√µes para n√£o usar o k8s</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/416161/">  Hoje falaremos sobre o Kubernetes, sobre o rake que pode ser coletado em seu uso pr√°tico e sobre os desenvolvimentos que ajudaram o autor e que tamb√©m devem ajud√°-lo.  Vamos tentar provar isso sem k8s no mundo moderno em qualquer lugar.  Para os oponentes dos k8s, tamb√©m fornecemos excelentes raz√µes pelas quais voc√™ n√£o deve mudar para ele.  Ou seja, na hist√≥ria, n√£o apenas defenderemos Kubernetes, mas tamb√©m o repreenderemos.  Daqui em nome veio isso <b>[n√£o]</b> . <br><br>  Este artigo √© baseado em uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">apresenta√ß√£o de Ivan Glushkov</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">gli</a> ) na confer√™ncia do DevOops 2017. Os dois √∫ltimos locais de trabalho de Ivan estavam de alguma forma relacionados ao Kubernetes: ele trabalhou em infracommands nos Postmates e na Machine Zone, e eles afetam Kubernetes com muita for√ßa.  Al√©m disso, condutas Ivan Podcast <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevZen</a> .  Apresenta√ß√£o adicional ser√° em nome de Ivan. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiCKL2SrDM0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/e73/367/d94e733670c1ae7bbe1c151ccf60e272.jpg"><br>  Primeiro, vou abordar brevemente a √°rea por que √© √∫til e importante para muitos, por que esse hype surge.  Ent√£o, vou falar sobre a nossa experi√™ncia no uso da tecnologia.  Bem, ent√£o as conclus√µes. <br><br>  Neste artigo, todos os slides s√£o inseridos como imagens, mas √†s vezes voc√™ deseja copiar algo.  Por exemplo, haver√° exemplos com configura√ß√µes.  Os slides em PDF podem ser baixados <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  N√£o direi estritamente a todos: n√£o deixe de usar o Kubernetes.  Existem pr√≥s e contras, portanto, se voc√™ procurar por contras, encontrar√°-os.  Voc√™ tem uma escolha, olha apenas para os profissionais, apenas contras e geralmente olha tudo junto.  <i>Simon Cat</i> me ajudar√° com os profissionais, e o gato preto atravessar√° a rua quando houver um sinal de menos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97c/277/591/97c277591363787b210e31421d9eb501.jpg"><br><br>  Ent√£o, por que esse hype aconteceu, por que a tecnologia X √© melhor que a Y. Kubernetes √© exatamente o mesmo sistema e h√° muito mais que um.  H√° Puppet, Chef, Ansible, Bash + SSH, Terraform.  Meu SSH favorito est√° me ajudando agora, por que devo ir a algum lugar.  Acredito que existem muitos crit√©rios, mas destaquei os mais importantes. <br><br>  O tempo entre o commit e o lan√ßamento √© muito bom, e os caras do Express 42 s√£o grandes especialistas nisso.  Automa√ß√£o de montagem, automa√ß√£o de todo o pipeline √© uma coisa muito boa, voc√™ n√£o pode elogi√°-lo, ele realmente ajuda.  Integra√ß√£o Cont√≠nua, Implanta√ß√£o Cont√≠nua.  E, claro, quanto esfor√ßo voc√™ gastar√° em fazer tudo.  Tudo pode ser escrito no Assembler, como eu disse, tamb√©m um sistema de implanta√ß√£o, mas n√£o adiciona conveni√™ncia. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0cb/5b1/1f3/0cb5b11f3753ddffff21dead2a80bba4.jpg"><br><br>  N√£o vou contar uma breve introdu√ß√£o ao Kubernetes, voc√™ sabe o que √©.  Vou tocar nessas √°reas um pouco mais. <br><br>  Por que tudo isso √© t√£o importante para os desenvolvedores?  A repetibilidade √© importante para eles, isto √©, se eles escreverem algum tipo de aplicativo, executarem um teste, funcionar√° para voc√™, para o seu vizinho e para a produ√ß√£o. <br><br>  O segundo √© um ambiente padronizado: se voc√™ estudou o Kubernetes e foi a uma empresa vizinha onde o Kubernetes est√°, tudo ser√° o mesmo.  A simplifica√ß√£o do procedimento de teste e a Integra√ß√£o Cont√≠nua n√£o √© um resultado direto do uso do Kubernetes, mas ainda simplifica a tarefa, tornando tudo mais conveniente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/047/e62/d3c/047e62d3c96acd1e8ed0bea5993adf70.jpg"><br><br>  Para desenvolvedores de vers√µes, h√° muitas outras vantagens.  Em primeiro lugar, √© uma infraestrutura imut√°vel. <br><br>  Em segundo lugar, a infraestrutura √© como um c√≥digo armazenado em algum lugar.  Em terceiro lugar, idempot√™ncia, a capacidade de adicionar um release com um bot√£o.  As revers√µes de libera√ß√£o ocorrem muito rapidamente e a introspec√ß√£o do sistema √© bastante conveniente.  Obviamente, tudo isso pode ser feito no seu sistema, escrito no joelho, mas voc√™ nem sempre pode fazer isso corretamente, e o Kubernetes j√° o implementou. <br><br>  O que o Kubernetes n√£o √© e o que n√£o permite fazer?  Existem muitos conceitos errados a esse respeito.  Vamos come√ßar com os cont√™ineres.  Kubernetes corre em cima deles.  Os cont√™ineres n√£o s√£o m√°quinas virtuais leves, mas uma entidade completamente diferente.  Eles s√£o f√°ceis de explicar com a ajuda desse conceito, mas na verdade est√£o errados.  O conceito √© completamente diferente, deve ser entendido e aceito. <br>  Em segundo lugar, o Kubernetes n√£o torna o aplicativo mais seguro.  N√£o o torna escalon√°vel automaticamente. <br><br>  Voc√™ precisa se esfor√ßar para iniciar o Kubernetes, n√£o ser√° para que "pressione um bot√£o e tudo funcione automaticamente".  Vai doer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/beb/626/51f/beb62651f13a2e1e872350536858fe2b.jpg"><br>  Nossa experi√™ncia.  Queremos que voc√™ e todos os outros n√£o quebrem nada.  Para fazer isso, voc√™ precisa procurar mais ao redor - e aqui est√° o nosso lado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02b/4c4/3fa/02b4c43faa4c6e7bfe3b4fd34214a665.jpg"><br><br>  Primeiro, o Kubernetes n√£o vai sozinho.  Ao criar uma estrutura que gerencie totalmente as libera√ß√µes e implanta√ß√µes, voc√™ deve entender que o Kubernetes √© um dado e devem existir 100. Para criar tudo isso, voc√™ precisa estudar muito.  Os iniciantes que entrar√£o no seu sistema tamb√©m estudar√£o essa pilha, uma enorme quantidade de informa√ß√µes. <br><br>  Kubernetes n√£o √© o √∫nico bloco importante, existem muitos outros blocos importantes, sem os quais o sistema n√£o funcionar√°.  Ou seja, voc√™ precisa se preocupar muito com a toler√¢ncia a falhas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ee/0cf/53c/9ee0cf53c72788abe1387798688d15fc.jpg"><br><br>  Por isso, Kubernetes √© um sinal de menos.  O sistema √© complexo, voc√™ precisa cuidar de muito. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1e/fab/d4a/e1efabd4a53300ebfe5fa481df8c2be0.jpg"><br><br>  Mas h√° vantagens.  Se uma pessoa estudou Kubernetes em uma empresa, em outra, seu cabelo n√£o fica arrepiado devido ao sistema de libera√ß√£o.  Com o tempo, quando o Kubernetes ocupar mais espa√ßo, a transi√ß√£o de pessoas e treinamento ser√° mais f√°cil.  E para isso - uma vantagem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/345/6ba/696/3456ba696d61adad878c461a1af7b63c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/887/47b/dba/88747bdbaa057840b0969fce42ae96fc.jpg"><br><br>  N√≥s usamos Helm.  Este sistema, constru√≠do sobre o Kubernetes, se assemelha a um gerenciador de pacotes.  Voc√™ pode clicar no bot√£o, dizer que deseja instalar o * Wine * no seu sistema.  Pode ser instalado no Kubernetes.  Funciona, baixa automaticamente, inicia e tudo funcionar√°.  Ele permite que voc√™ trabalhe com plug-ins, arquitetura cliente-servidor.  Se voc√™ trabalha com ele, recomendamos que voc√™ execute um Tiller no espa√ßo para nome.  Isso isola o espa√ßo para nome um do outro e quebrar um n√£o quebra o outro. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27f/c3a/648/27fc3a64838b9035c96d4fcd312eea4a.jpg"><br><br>  De fato, o sistema √© muito complexo.  Um sistema, que deve ser uma abstra√ß√£o de um n√≠vel superior, mais simples e mais compreens√≠vel, n√£o facilita muito o entendimento.  Por este menos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27d/ed4/e42/27ded4e428d4a6d2da19ab86dcc42c58.jpg"><br><br>  Vamos comparar as configura√ß√µes.  Provavelmente, voc√™ tamb√©m ter√° algumas configura√ß√µes se executar o sistema em produ√ß√£o.  N√≥s temos nosso pr√≥prio sistema chamado BOOMer.  N√£o sei por que a chamamos assim.  √â composto por Puppet, Chef, Ansible, Terraform e tudo mais, h√° uma garrafa grande. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a3/0d8/87c/3a30d887c8d5b95dfa76678c92d9dc7e.jpg"><br><br>  Vamos ver como isso funciona.  Aqui est√° um exemplo de uma configura√ß√£o real que est√° atualmente trabalhando na produ√ß√£o.  O que vemos aqui? <br><br>  Primeiro, vemos onde iniciar o aplicativo, em segundo lugar, o que precisa ser iniciado e, em terceiro lugar, como ele deve ser preparado para o lan√ßamento.  Em uma garrafa, os conceitos j√° est√£o misturados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddb/5c6/642/ddb5c6642f4c6209497dc19589d3412e.jpg"><br><br>  Se olharmos mais adiante, porque adicionamos heran√ßa para fazer configura√ß√µes mais complexas, devemos examinar o que est√° na configura√ß√£o comum a que estamos nos referindo.  Al√©m disso, adicionamos configura√ß√£o de rede, direitos de acesso, planejamento de carga.  Tudo isso em uma configura√ß√£o necess√°ria para executar uma aplica√ß√£o real na produ√ß√£o, misturamos v√°rios conceitos em um s√≥ lugar. <br><br>  Isso √© muito dif√≠cil, √© muito errado e √© uma grande vantagem para o Kubernetes, porque nele voc√™ simplesmente determina o que executar.  A configura√ß√£o da rede foi realizada durante a instala√ß√£o do Kubernetes, todo o provisionamento foi resolvido usando a janela de encaixe - voc√™ tinha encapsulamento, todos os problemas foram de alguma forma separados e, nesse caso, a configura√ß√£o possui apenas o seu aplicativo e h√° uma vantagem para isso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/833/70d/c7c/83370dc7c28d637804be907acbca63b2.jpg"><br><br>  Vamos dar uma olhada.  Aqui temos apenas uma aplica√ß√£o.  Para que a implanta√ß√£o funcione, voc√™ precisa de muito mais para trabalhar.  Primeiro, voc√™ precisa definir servi√ßos.  Como os segredos, ConfigMap, acesso ao Load Balancer nos chegam. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15c/8fe/4c5/15c8fe4c5e384cec97bfd9e3640adfd6.jpg"><br><br>  N√£o esque√ßa que voc√™ possui v√°rios ambientes.  H√° Stage / Prod / Dev.  Tudo isso junto n√£o √© um pequeno peda√ßo que mostrei, mas um enorme conjunto de configura√ß√µes, o que √© realmente dif√≠cil.  Por este menos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eaf/6a0/5f8/eaf6a05f8ddf546c84938d0647fdf9f4.jpg"><br><br>  Modelo de leme para compara√ß√£o.  Ele repete completamente os modelos do Kubernetes; se houver algum arquivo no Kubernetes com a defini√ß√£o de implanta√ß√£o, o mesmo estar√° no Helm.  Em vez de valores espec√≠ficos para o ambiente, voc√™ tem modelos que s√£o substitu√≠dos por valores. <br>  Voc√™ tem um modelo separado, valores separados que devem ser substitu√≠dos neste modelo. <br><br>  Obviamente, voc√™ precisa definir adicionalmente a infraestrutura diferente do Helm, apesar de ter muitos arquivos de configura√ß√£o no Kubernetes e arrast√°-lo e solt√°-lo no Helm.  Tudo isso √© muito dif√≠cil, pelo qual um sinal de menos. <br><br>  Um sistema que deveria simplificar realmente complica.  Para mim, este √© um sinal de menos.  Precisa adicionar outra coisa ou n√£o usar <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4a/c56/38f/e4ac5638f52ff34104c198c038817869.jpg"><br><br>  Vamos aprofundar, n√£o somos suficientemente profundos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/baa/73a/b45/baa73ab45fa3f3c3dbc985a7cdad5395.jpg"><br><br>  Primeiro, como trabalhamos com clusters.  Li o artigo do Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Borg, Omega e Kubernetes",</a> que defende fortemente o conceito de que voc√™ precisa ter um cluster grande.  Tamb√©m fui a favor dessa ideia, mas, no final, a deixamos.  Como resultado de nossas disputas, usamos quatro grupos diferentes. <br><br>  O primeiro cluster e2e a testar o pr√≥prio Kubernetes e testar scripts que implementam o ambiente, plug-ins etc.  O segundo, √© claro, prod e palco.  Estes s√£o conceitos padr√£o.  Em terceiro lugar, este √© o administrador, no qual todo o resto √© carregado - em particular, temos CI l√°, e parece que, por causa disso, esse cluster sempre ser√° o maior. <br><br>  Existem muitos testes: por commit, por mesclagem, todo mundo faz um monte de commit, ent√£o os clusters s√£o enormes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe6/e2c/284/fe6e2c284169e1782c3c9009e8802d5c.jpg"><br><br>  Tentamos examinar o CoreOS, mas n√£o o usamos.  Eles t√™m TF ou CloudFormation dentro, e ambos muito mal nos permitem entender o que est√° dentro do estado.  Por esse motivo, h√° problemas durante a atualiza√ß√£o.  Quando voc√™ deseja atualizar as configura√ß√µes do seu Kubernetes, por exemplo, sua vers√£o, voc√™ pode encontrar o fato de que a atualiza√ß√£o n√£o funciona dessa maneira, na seq√º√™ncia errada.  Este √© um grande problema de estabilidade.  Este √© um sinal de menos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e41/d3d/694/e41d3d694030f44c6f6e12dc40c2b70c.jpg"><br><br>  Em segundo lugar, quando voc√™ usa o Kubernetes, precisa baixar imagens de algum lugar.  Pode ser uma fonte interna, reposit√≥rio ou externo.  Se interno, h√° problemas.  Eu recomendo usar o Docker Distribution porque √© est√°vel, foi feito pelo Docker.  Mas o pre√ßo do suporte ainda √© alto.  Para que ele funcione, voc√™ precisa torn√°-lo tolerante a falhas, porque este √© o √∫nico local em que seus aplicativos obt√™m dados para trabalhar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f2/aba/dc6/2f2abadc6444a9da754baf98667356a1.jpg"><br><br>  Imagine que, no momento crucial, quando voc√™ encontrou um bug na produ√ß√£o, seu reposit√≥rio caiu - voc√™ n√£o pode atualizar o aplicativo.  Voc√™ deve torn√°-lo tolerante a falhas e com todos os poss√≠veis problemas que podem ser apenas. <br><br>  Em segundo lugar, se a massa de equipes, cada uma com sua pr√≥pria imagem, elas se acumulam muito e muito rapidamente.  Voc√™ pode matar sua distribui√ß√£o do Docker.  √â necess√°rio fazer a limpeza, excluir imagens, criar informa√ß√µes para os usu√°rios, quando e o que voc√™ limpar√°. <br><br>  Em terceiro lugar, com imagens grandes, digamos, se voc√™ tiver um mon√≥lito, o tamanho da imagem ser√° muito grande.  Imagine que voc√™ precisa liberar 30 n√≥s.  2 gigabytes por 30 n√≥s - calcule qual fluxo, com que velocidade √© baixado para todos os n√≥s.  Gostaria que ele pressionasse um bot√£o e imediatamente se tornasse verde.  Mas n√£o, voc√™ deve primeiro esperar at√© que seja baixado.  √â necess√°rio, de alguma forma, acelerar esse download, e tudo funciona a partir de um ponto. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/246/bf7/15e/246bf715ec55bbf04e96fa43708c5ce4.jpg"><br><br>  Com reposit√≥rios externos, h√° os mesmos problemas com o coletor de lixo, mas na maioria das vezes isso √© feito automaticamente.  N√≥s usamos o Quay.  No caso de reposit√≥rios externos, esses s√£o servi√ßos de terceiros nos quais a maioria das imagens √© p√∫blica.  Para que n√£o houvesse imagens p√∫blicas, √© necess√°rio fornecer acesso.  Precisamos de segredos, direitos de acesso a imagens, tudo isso √© especialmente configurado.  Obviamente, isso pode ser automatizado, mas no caso de um lan√ßamento local de Cuba no seu sistema, voc√™ ainda precisa configur√°-lo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a44/cf1/249/a44cf1249b766da256cb73c181a48921.jpg"><br><br>  Para instalar o Kubernetes, usamos o kops.  Este √© um sistema muito bom, somos usu√°rios iniciais do momento em que ainda n√£o haviam gravado no blog.  Ele n√£o suporta totalmente o CoreOS, funciona bem com o Debian, sabe como configurar automaticamente os n√≥s mestres do Kubernetes, trabalha com complementos e tem a capacidade de fazer zero tempo de inatividade durante as atualiza√ß√µes do Kubernetes. <br>  Todos esses recursos est√£o prontos para o uso, para os quais uma vantagem grande e ousada.  √ìtimo sistema! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/214/cf0/a98/214cf0a98d020ffb9ab512ac9812ed4c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba4/e64/80c/ba4e6480c2e0f047f086d77663ef2530.jpg"><br><br>  Nos links, voc√™ pode encontrar muitas op√ß√µes para configurar uma rede no Kubernetes.  Existem realmente muitos deles, todos t√™m suas pr√≥prias vantagens e desvantagens.  O Kops suporta apenas parte dessas op√ß√µes.  √â claro que voc√™ pode configur√°-lo para funcionar atrav√©s da CNI, mas √© melhor usar os mais populares e padr√£o.  Eles s√£o testados pela comunidade e provavelmente s√£o est√°veis. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc5/ee7/1a1/fc5ee71a1919828d439cba33caf0c931.jpg"><br><br>  Decidimos usar o Calico.  Funcionou bem do zero, sem muitos problemas, usa BGP, encapsulamento mais r√°pido, suporta IP-in-IP, permite trabalhar com v√°rias nuvens, para n√≥s isso √© uma grande vantagem. <br>  A boa integra√ß√£o com o Kubernetes, usando r√≥tulos, delimita o tr√°fego.  Pois isso √© uma vantagem. <br><br>  Eu n√£o esperava que o Calico chegasse ao estado quando estava ligado, e tudo funciona sem problemas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b08/4fd/d69/b084fdd6914fc0a4838610f5ff1db1ee.jpg"><br><br>  Alta disponibilidade, como eu disse, fazemos atrav√©s do kops, voc√™ pode usar 5-7-9 n√≥s, usamos tr√™s.  Estamos no etcd v2, por causa de um bug, eles n√£o foram atualizados na v3.  Teoricamente, isso acelerar√° alguns processos.  N√£o sei, duvido. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b6/668/228/6b6668228d189d4ecdb487c0c370352c.jpg"><br><br>  Um momento complicado, temos um cluster especial para experimentar scripts, rolando automaticamente pelo IC.  Acreditamos que temos prote√ß√£o contra a√ß√µes completamente erradas, mas para algumas vers√µes especiais e complexas, no caso de tirarmos instant√¢neos de todos os discos, n√£o fazemos backups todos os dias. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/070/a54/74d/070a5474df7ad0e10fd3119454a2c1f1.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/70a/040/729/70a040729046c706ca8309f7b43a8d56.jpg"><br><br>  Autoriza√ß√£o √© uma quest√£o eterna.  N√≥s da Kubernetes usamos RBAC, acesso baseado em fun√ß√£o.  √â muito melhor que o ABAC e, se voc√™ o configurou, entendeu o que quero dizer.  Veja as configura√ß√µes - surpreenda-se. <br>  Usamos o Dex, um provedor OpenID que bombeia todas as informa√ß√µes de alguma fonte de dados. <br>  E para fazer login no Kubernetes, existem duas maneiras.  √â necess√°rio registrar-se de alguma forma no .kube / config para onde ir e o que ele pode fazer.  √â necess√°rio obter de alguma forma essa configura√ß√£o.  Ou o usu√°rio acessa a interface do usu√°rio, onde faz login, recebe configura√ß√µes, copia-as para / config e funciona.  Isso n√£o √© muito conveniente.  Passamos gradualmente ao fato de que uma pessoa entra no console, clica no bot√£o, efetua login, as configura√ß√µes s√£o geradas automaticamente a partir dele e empilhadas no lugar certo.  Muito mais conveniente, decidimos agir dessa maneira. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02a/038/827/02a03882785c1106981d333d1a270ce0.jpg"><br><br>  Como fonte de dados, usamos o Active Directory.  O Kubernetes permite enviar informa√ß√µes sobre o grupo por toda a estrutura de autoriza√ß√£o, que se traduz em namespace e fun√ß√µes.  Assim, distinguimos imediatamente entre onde uma pessoa pode ir, onde ela n√£o tem o direito de ir e o que ela pode liberar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/800/6bc/cce/8006bccce4c652ce9bf32fba1cea7c42.jpg"><br><br>  Na maioria das vezes, as pessoas precisam acessar a AWS.  Se voc√™ n√£o possui o Kubernetes, h√° uma m√°quina executando o aplicativo.  Parece que tudo que voc√™ precisa √© obter os logs, v√™-los e √© isso.  Isso √© conveniente quando uma pessoa pode ir ao seu carro e ver como o aplicativo funciona.  Do ponto de vista do Kubernetes, tudo funciona em cont√™ineres.  Existe um comando `kubectl exec` - entre no cont√™iner no aplicativo e veja o que acontece l√°.  Portanto, n√£o h√° necessidade de ir para inst√¢ncias da AWS.  Negamos o acesso a todos, exceto o infracommand. <br><br>  Al√©m disso, proibimos as chaves de administrador de longa dura√ß√£o, a entrada atrav√©s de fun√ß√µes.  Se √© poss√≠vel usar o papel de administrador - eu sou o administrador.  Al√©m disso, adicionamos rota√ß√£o de teclas.  √â conveniente configur√°-lo atrav√©s do comando awsudo, este √© um projeto no github, eu recomendo, pois permite que voc√™ trabalhe como em uma equipe do sudo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/12f/a6f/a66/12fa6fa666e726aae4fd03408b3be964.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bbf/7f6/d0f/bbf7f6d0f0ea69595e1fab50b7f37645.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4da/414/371/4da414371e537acb4ed1aa16d69b92ff.jpg"><br><br>  Quotas.  Uma coisa muito boa no Kubernetes, trabalhar imediatamente.  Voc√™ limita qualquer espa√ßo de nome, digamos, pelo n√∫mero de objetos, mem√≥ria ou CPU que voc√™ pode consumir.  Eu acredito que isso √© importante e √∫til para todos.  Ainda n√£o atingimos a mem√≥ria e a CPU, usamos apenas o n√∫mero de objetos, mas adicionaremos tudo isso. <br><br>  Grande e gordo, permite que voc√™ fa√ßa muitas coisas complicadas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/be9/487/2b3be9487f65110ea6a0c3189db27ac3.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e72/e9e/4ff/e72e9e4ff8f7bedeab64808e7a6d26c1.jpg"><br><br>  Dimensionamento.  Voc√™ n√£o pode misturar a escala dentro do Kubernetes e fora do Kubernetes.  Dentro do Kubernetes, o pr√≥prio dimensionamento √© feito.  Pode aumentar os pods automaticamente quando h√° uma grande carga. <br><br>  Aqui estou falando sobre o dimensionamento de inst√¢ncias do Kubernetes.  Isso pode ser feito usando o AWS Autoscaler, este √© um projeto do github.  Quando voc√™ adiciona um novo pod e ele n√£o pode ser iniciado porque carece de recursos em todas as inst√¢ncias, o AWS Autoscaler pode adicionar n√≥s automaticamente.  Ele permite que voc√™ trabalhe em inst√¢ncias Spot, ainda n√£o o adicionamos, mas faremos isso, permite economizar muito. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a50/031/93c/a5003193c50ccb5cd288a42f6cd4af1e.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/58f/07c/a0f/58f07ca0f60354e68e3034323da3d2fb.jpg"><br><br>  Quando voc√™ tem muitos usu√°rios e aplicativos, precisa monitor√°-los de alguma forma.  Geralmente isso √© telemetria, logs, alguns gr√°ficos bonitos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88c/0b7/92c/88c0b792c38e79845e7d5c305cd21f20.jpg"><br><br>  Por raz√µes hist√≥ricas, t√≠nhamos o Sensu, que n√£o era muito adequado para o Kubernetes.  Era necess√°rio um projeto mais orientado √† m√©trica.  Analisamos toda a pilha TICK, especialmente o InfluxDB.  Boa interface do usu√°rio, linguagem semelhante ao SQL, mas n√£o h√° recursos suficientes.  Mudamos para Prometeu. <br><br>  Ele √© bom  Boa linguagem de consulta, bons alertas e tudo pronto para uso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/953/9ba/908/9539ba90827a17261f0c53d114064ae4.jpg"><br><br>  Para enviar telemetria, usamos o Cernan.  Este √© o nosso pr√≥prio projeto escrito em Rust.  Este √© o √∫nico projeto da Rust que trabalha em nossa produ√ß√£o h√° um ano.  Possui v√°rios conceitos: existe um conceito de fonte de dados, voc√™ configura v√°rias fontes.  Voc√™ configura onde os dados ser√£o mesclados.  Temos uma configura√ß√£o de filtros, ou seja, os dados em fluxo podem ser processados ‚Äã‚Äãde alguma forma.  Voc√™ pode converter logs em m√©tricas, m√©tricas em logs, o que quiser. <br>  Apesar de voc√™ ter v√°rias entradas, v√°rias conclus√µes e mostrar que para onde vai, existe algo como um grande sistema gr√°fico, √© bastante conveniente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d26/ae0/763/d26ae0763c1e43c636d09ec1ee5f0d7a.jpg"><br><br>  Agora estamos migrando da pilha atual Statsd / Cernan / Wavefront para o Kubernetes.  Teoricamente, o Prometheus deseja coletar dados dos aplicativos por si s√≥, portanto, √© necess√°rio adicionar o ponto de extremidade a todos os aplicativos, dos quais ser√£o obtidas m√©tricas.  Cernan √© o link de transmiss√£o, deve funcionar em qualquer lugar.  Existem duas possibilidades: voc√™ pode executar o Kubernetes em cada inst√¢ncia, usando o conceito Sidecar, quando outro cont√™iner trabalha no seu campo de dados que envia dados.  Fazemos isso e aquilo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77d/dd8/1dd/77ddd81ddd96e121117aa7dfaf5b96f6.jpg"><br>  No momento, todos os logs s√£o enviados para stdout / stderr.  Todas as aplica√ß√µes s√£o projetadas para isso, portanto, um dos requisitos cr√≠ticos √© que n√£o deixemos este sistema.  O Cernan envia dados para o ElasticSearch, eventos de todo o sistema Kubernetes s√£o enviados para l√° usando o Heapster.  Este √© um sistema muito bom, eu recomendo. <br><br>  Depois disso, voc√™ pode ver todos os logs em um √∫nico local, por exemplo, no console.  N√≥s usamos Kibana.  H√° um maravilhoso produto Stern, apenas para os registros.  Ele permite que voc√™ assista, pinte diferentes vagens em cores diferentes, saiba como ver quando uma delas morreu e a outra foi reiniciada.  Recolhe automaticamente todos os logs.  Um projeto ideal, eu recomendo, √© um Kubernetes mais gordo, est√° tudo bem aqui. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed4/b9b/c19/ed4b9bc1996cbadf00189e8be2630d27.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca7/b8a/b64/ca7b8ab64354e2a5361023d2c0bca95d.jpg"><br><br>  Segredos  Usamos S3 e KMS.  Estamos pensando em mudar para o Vault ou segredos no pr√≥prio Kubernetes.  Eles estavam em 1,7 no estado alfa, mas algo precisa ser feito com isso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/429/3b2/6cb/4293b26cbfe90b1f84adb88696686acb.jpg"><br><br>  Chegamos √† parte interessante.  O desenvolvimento do Kubernetes geralmente n√£o √© muito considerado.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diz basicamente: "O Kubernetes √© um sistema ideal, est√° tudo bem, vamos seguir em frente". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas, de fato, o queijo gr√°tis √© apenas uma ratoeira, e para desenvolvedores em Kubernetes √© um inferno. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e96/fb8/480/e96fb8480a76e63a05e4148dfd76ebbf.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o do ponto de vista de que tudo est√° ruim, mas do fato de que voc√™ precisa encarar as coisas de maneira um pouco diferente. Eu comparo o desenvolvimento no Kubernetes com a programa√ß√£o funcional: at√© voc√™ toc√°-lo, voc√™ pensa em seu estilo imperativo, est√° tudo bem. Para se desenvolver no funcionalismo, voc√™ precisa virar ligeiramente a cabe√ßa para o outro lado - a mesma coisa aqui.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode desenvolv√™-lo, pode faz√™-lo bem, mas precisa encar√°-lo de maneira diferente. Primeiro, lide com o conceito Docker Way. Isso n√£o √© t√£o dif√≠cil, mas √© bastante problem√°tico compreend√™-lo completamente. A maioria dos desenvolvedores est√° acostumada a acessar sua m√°quina local, remota ou virtual via SSH, dizendo: "Deixe-me consertar algo aqui, podshaman". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ diz a ele que Kubernetes n√£o far√° isso porque voc√™ leu apenas a infraestrutura. Quando voc√™ quiser atualizar o aplicativo, fa√ßa uma nova imagem que funcione, e a antiga, por favor, n√£o toque, ela simplesmente morrer√°. Eu, pessoalmente, trabalhei na introdu√ß√£o do Kubernetes em diferentes equipes e vejo horror aos olhos das pessoas quando elas entendem que ter√£o que abandonar completamente todos os velhos h√°bitos, criar novos, algum novo sistema, o que √© muito dif√≠cil.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, voc√™ ter√° que fazer muitas escolhas: digamos, quando voc√™ faz algumas altera√ß√µes, se o desenvolvimento for local, voc√™ precisa compromet√™-lo com o reposit√≥rio de alguma forma, ent√£o o reposit√≥rio de pipeline executa os testes e diz: "Oh, h√° um erro de digita√ß√£o em uma palavra", voc√™ precisa de tudo fa√ßa localmente. Monte a pasta de alguma forma, entre, atualize o sistema, pelo menos compile-a. Se a execu√ß√£o local de testes for inconveniente, ele poder√° confirmar no IC pelo menos para verificar algumas a√ß√µes locais e envi√°-las ao CI para verifica√ß√£o. Essas escolhas s√£o bastante complicadas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â especialmente dif√≠cil quando voc√™ tem um aplicativo ramificado que consiste em cem servi√ßos e, para que um deles funcione, voc√™ precisa garantir que todos os outros trabalhem lado a lado. Voc√™ precisa emular o ambiente ou, de alguma forma, executar localmente. Toda essa escolha n√£o √© trivial, o desenvolvedor precisa pensar muito sobre isso. Isso cria uma atitude negativa em rela√ß√£o ao Kubernetes. √â claro que ele √© bom - mas √© ruim, porque voc√™ precisa pensar muito e mudar seus h√°bitos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portanto, aqui tr√™s gatos gordos correram pela estrada.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ef/b3f/144/8efb3f1441675d73b9c02d58775457d2.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/55e/ad5/82b/55ead582ba97c9d9b828801f8972c9d8.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando olhamos para o Kubernetes, tentamos entender, talvez existam alguns sistemas convenientes para o desenvolvimento. Em particular, existe o Deis, com certeza voc√™ j√° ouviu tudo sobre isso. √â muito f√°cil de usar e verificamos, de fato, que todos os projetos simples mudam muito facilmente para o Deis. Mas o problema √© que projetos mais complexos podem n√£o mudar para o Deis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como eu disse, mudamos para Helm Charts. Mas o √∫nico problema que estamos vendo agora √© que √© necess√°ria muita documenta√ß√£o boa. Precisamos de algumas instru√ß√µes, algumas perguntas frequentes, para que uma pessoa possa iniciar rapidamente, copiar as configura√ß√µes atuais, colar suas pr√≥prias, alterar os nomes para que tudo esteja correto. Tamb√©m √© importante entender isso com anteced√™ncia, e voc√™ precisa fazer tudo. Listei kits de ferramentas comuns para desenvolvimento aqui. N√£o vou falar sobre tudo isso, exceto o minicube. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a85/fb3/a6e/a85fb3a6e8be12bee7fb87dc32d9c91f.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Minikube √© um sistema muito bom, no sentido de que √© bom, mas √© ruim. Ele permite que voc√™ execute o Kubernetes localmente, permite ver tudo no seu laptop, n√£o precisa ir a lugar nenhum no SSH e assim por diante.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu trabalho no MacOS, tenho um Mac, respectivamente, para executar um aplicativo local, preciso executar a janela de encaixe localmente. Isso n√£o pode ser feito. No final, voc√™ precisa executar o virtualbox ou o xhyve. As duas coisas s√£o, de fato, emula√ß√µes no topo do meu sistema operacional. Usamos o xhyve, mas recomendamos o uso do VirtualBox, j√° que existem muitos bugs, eles precisam ser contornados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas a id√©ia de que existe virtualiza√ß√£o e, dentro da virtualiza√ß√£o, outro n√≠vel de abstra√ß√£o para virtualiza√ß√£o √© lan√ßada, √© algum tipo de rid√≠culo, ilus√≥rio. Em geral, √© bom que de alguma forma funcione, mas seria melhor se fosse conclu√≠do.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb1/6e9/c9a/bb16e9c9a54a30c0d90b081709a5aa0c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffd/c4b/98e/ffdc4b98efbf7546fbbf1da8ff70d82d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O IC n√£o est√° diretamente relacionado ao Kubernetes, mas √© um sistema muito importante, especialmente se voc√™ tiver o Kubernetes, se o integrar, poder√° obter resultados muito bons. Usamos o Concourse for CI, com uma funcionalidade muito rica, voc√™ pode criar gr√°ficos assustadores, do que, onde, como come√ßa, do que depende. Mas os desenvolvedores do Concourse s√£o muito estranhos sobre o seu produto. Por exemplo, ao mudar de uma vers√£o para outra, eles quebraram a compatibilidade com vers√µes anteriores e n√£o reescreveram a maioria dos plugins. Al√©m disso, a documenta√ß√£o n√£o foi conclu√≠da e, quando tentamos fazer algo, nada funcionou.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, existe pouca documenta√ß√£o em todos os ICs, voc√™ precisa ler o c√≥digo e, em geral, abandonamos o Concourse. Mudamos para o Drone.io - √© pequeno, muito leve, √°gil, a funcionalidade √© muito menor, mas com mais frequ√™ncia √© suficiente. Sim, seria conveniente ter gr√°ficos de depend√™ncia grandes e pesados, mas voc√™ tamb√©m pode trabalhar em pequenos. Tamb√©m um pouco de documenta√ß√£o, lemos o c√≥digo, mas est√° tudo bem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada est√°gio do pipeline funciona em seu pr√≥prio cont√™iner de docker, o que facilita muito a mudan√ßa para o Kubernetes. Se voc√™ possui um aplicativo que √© executado em uma m√°quina real, para adicion√°-lo ao CI, use o cont√™iner de docker e, depois disso, a mudan√ßa para o Kubernetes √© simples. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuramos a libera√ß√£o autom√°tica do cluster admin / stage, enquanto temos medo de adicionar a configura√ß√£o ao cluster de produ√ß√£o. Al√©m disso, existe um sistema de plugins.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffd/c4b/98e/ffdc4b98efbf7546fbbf1da8ff70d82d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este √© um exemplo de uma configura√ß√£o simples do Drone. Retirado do sistema de trabalho finalizado, neste caso, existem cinco etapas no pipeline, cada etapa faz algo: coleta, testes e assim por diante. Com esse conjunto de recursos que est√° no Drone, acho que √© uma coisa boa. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/47c/8d7/033/47c8d70338233420ee9d3806e89f4c3d.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5be/0bf/cc3/5be0bfcc32dfa4c8d34c7d2eb3e5b906.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Discutimos muito sobre quantos clusters ter: um ou mais. Quando surgiu a ideia de v√°rios clusters, come√ßamos a trabalhar mais nessa dire√ß√£o, criamos alguns scripts, configuramos v√°rios outros cubos para os nossos Kubernetes. Depois disso, eles acessaram o Google e pediram conselhos, todos fizeram isso, talvez algo precise ser corrigido.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Google concordou que a ideia de um √∫nico cluster n√£o √© aplic√°vel no Kubernetes. Existem muitas imperfei√ß√µes, em particular, que trabalham com geolocaliza√ß√µes. Acontece que a id√©ia √© verdadeira, mas √© muito cedo para falar sobre isso. Talvez mais tarde. Enquanto o Service Mesh pode ajudar. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f1/edd/a5a/4f1edda5a7ce5e102dc5fc238ab8c07d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, se voc√™ quiser ver como nosso sistema funciona, preste aten√ß√£o na Geod√©sica. Este √© um produto semelhante ao que fazemos. √â de c√≥digo aberto, uma escolha muito semelhante de conceito de design. Estamos pensando em nos unir e possivelmente us√°-los. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/790/8e7/e00/7908e7e000fafe3c0506e500b54fde9a.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sim, em nossa pr√°tica de trabalhar com o Kubernetes tamb√©m existem problemas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° um problema com nomes locais, com certificados. H√° um problema com o download de imagens grandes e seu trabalho, possivelmente relacionado ao sistema de arquivos, ainda n√£o cavamos l√°. J√° existem tr√™s maneiras diferentes de instalar as extens√µes do Kubernetes. Trabalhamos nesse projeto h√° menos de um ano e j√° temos tr√™s maneiras diferentes: os an√©is anuais est√£o crescendo. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a9/3a7/f62/2a93a7f624007d3333fb0b56c3ab62ad.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos ser como todos os contras. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o, acho que uma das principais desvantagens √© a grande quantidade de informa√ß√µes a serem estudadas, n√£o apenas novas tecnologias, mas tamb√©m novos conceitos e h√°bitos. √â como aprender um novo idioma: em princ√≠pio, n√£o √© dif√≠cil, mas √© dif√≠cil virar a cabe√ßa um pouco para todos os usu√°rios. Se voc√™ n√£o trabalhou com conceitos semelhantes antes, √© dif√≠cil mudar para o Kubernetes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Kubernetes ser√° apenas uma pequena parte do seu sistema. Todo mundo pensa que instalar√° o Kubernetes e tudo funcionar√° imediatamente. N√£o, este √© um pequeno cubo e haver√° muitos desses cubos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geralmente, alguns aplicativos s√£o dif√≠ceis de executar no Kubernetes - e √© melhor n√£o execut√°-los. Tamb√©m arquivos de configura√ß√£o muito pesados ‚Äã‚Äãe grandes e, nos conceitos sobre o Kubernetes, eles s√£o ainda mais complicados. Todas as solu√ß√µes atuais s√£o brutas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todos esses contras s√£o, obviamente, nojentos. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a9/3a7/f62/2a93a7f624007d3333fb0b56c3ab62ad.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compromissos e uma transi√ß√£o dif√≠cil criam uma imagem negativa do Kubernetes, e eu n√£o sei como lidar com isso. N√£o conseguimos vencer muito, h√° pessoas que odeiam todo o movimento, n√£o querem e n√£o entendem suas vantagens.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para executar o Minikube, seu sistema precisar√° trabalhar duro para que tudo funcione. Como voc√™ pode ver, existem muitas desvantagens, e aqueles que n√£o querem trabalhar com o Kubernetes t√™m seus pr√≥prios motivos. Se voc√™ n√£o quiser ouvir sobre os profissionais, feche os olhos e os ouvidos, pois eles ir√£o al√©m. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/649/ba0/08e/649ba008e1c2a9ade9c10060a70bc7cc.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A primeira vantagem √© que, com o tempo, os iniciantes ter√£o que aprender menos. Muitas vezes acontece que quando um rec√©m-chegado entra no sistema, ele come√ßa a arrancar todo o cabelo, porque nos primeiros 1-2 meses ele tenta descobrir como liberar tudo, se o sistema √© grande e dura muito, muitos an√©is anuais crescem. Kubernetes facilita as coisas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em segundo lugar, o Kubernetes n√£o faz isso sozinho, mas permite que voc√™ fa√ßa um curto ciclo de libera√ß√£o. Um CI criado de consolida√ß√£o, o CI criou uma imagem, aumentou automaticamente, voc√™ pressionou um bot√£o e tudo entrou em produ√ß√£o. Isso reduz bastante o tempo de libera√ß√£o.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A seguir est√° a divis√£o do c√≥digo. Nosso sistema e a maioria de seus sistemas coletam configura√ß√µes de diferentes n√≠veis em um √∫nico local, ou seja, voc√™ possui um c√≥digo de infraestrutura, um c√≥digo comercial e todas as l√≥gicas s√£o misturadas em um √∫nico local. No Kubernetes, isso n√£o estar√° pronto para uso, escolher o conceito certo ajuda a evitar isso com anteced√™ncia. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma comunidade grande e muito ativa, o que significa um grande n√∫mero de mudan√ßas. A maior parte do que mencionei nos √∫ltimos dois anos se tornou t√£o est√°vel que pode ser liberada na produ√ß√£o. Talvez alguns deles tenham aparecido antes, mas n√£o eram muito est√°veis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considero uma grande vantagem que, em um lugar, voc√™ possa ver os logs do aplicativo e do Kubernetes trabalhando com seu aplicativo, o que √© inestim√°vel. E n√£o h√° acesso aos n√≥s. Quando removemos o acesso aos n√≥s dos usu√°rios, isso imediatamente eliminou uma grande classe de problemas. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f7/686/e3a/4f7686e3a040bdf9ff0640e5f4a2bcb2.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A segunda parte das vantagens √© um pouco mais conceitual. A maioria da comunidade Kubernetes v√™ a parte da tecnologia. Mas vimos a parte do gerenciamento conceitual. Depois de mudar para o Kubernetes, e se estiver configurado corretamente, o infracommand (ou back-end - n√£o sei como voc√™ o chama corretamente) n√£o ser√° mais necess√°rio para liberar aplicativos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O usu√°rio deseja descarregar o aplicativo, ele n√£o vir√° solicit√°-lo, mas basta iniciar um novo pod, existe um comando para isso. A equipe de infraestrutura n√£o √© necess√°ria para investigar problemas. Basta olhar para os logs, nosso conjunto de designs n√£o √© t√£o grande, existe uma lista pela qual √© muito f√°cil encontrar o problema. Sim, √†s vezes √© necess√°rio suporte se o problema estiver no Kubernetes, por exemplo, mas com mais freq√º√™ncia o problema est√° nos aplicativos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adicionamos or√ßamento de erro. Este √© o seguinte conceito: cada equipe possui estat√≠sticas sobre quantos problemas est√£o ocorrendo na produ√ß√£o. Se houver muitos problemas, a equipe corta os lan√ßamentos at√© levar algum tempo. Isso √© bom porque a equipe monitorar√° seriamente que seus lan√ßamentos s√£o muito est√°veis. Precisa de novas funcionalidades - libere. Deseja liberar √†s duas da manh√£ - por favor. Se ap√≥s os lan√ßamentos voc√™ tiver apenas ‚Äúnove‚Äù no SLA - fa√ßa o que quiser, tudo estar√° est√°vel, voc√™ poder√° fazer qualquer coisa. No entanto, se a situa√ß√£o for pior, provavelmente n√£o teremos permiss√£o para liberar nada al√©m de corre√ß√µes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso √© conveniente tanto para a estabilidade do sistema quanto para o clima dentro da equipe. </font><font style="vertical-align: inherit;">Deixamos de ser a "Pol√≠cia Moral", impedindo-nos de liber√°-la tarde da noite. </font><font style="vertical-align: inherit;">Fa√ßa o que quiser enquanto tiver um bom or√ßamento de erros. </font><font style="vertical-align: inherit;">Isso reduz muito o estresse dentro da empresa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode usar o </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href=""><font style="vertical-align: inherit;">mail</font></a><font style="vertical-align: inherit;"> ou o tweet </font><font style="vertical-align: inherit;">para entrar em contato comigo </font><font style="vertical-align: inherit;">: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@gliush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E no final, existem muitos links para voc√™, voc√™ pode baixar e ver tudo:</font></font><br><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede nativa de cont√™iner - Compara√ß√£o</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrega cont√≠nua por Jez Humble, David Farley.</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cont√™ineres n√£o s√£o VMs</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Distribui√ß√£o do Docker (registro de imagem)</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quay - Registro de imagens como servi√ßo</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcd-operator - Gerente do cluster etcd no topo do Kubernetes</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dex - OIDC (OpenID Connect Identity) e o provedor OAuth 2.0 com conectores conect√°veis</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awsudo - utilit√°rio sudo-like para gerenciar credenciais da AWS</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Autoscaling-related components for Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Simon's cat</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Helm: Kubernetes package manager</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Geodesic: framework to create your own cloud platform</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Calico: Configuring IP-in-IP</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sensu: Open-core monitoring system</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InfluxDB: Scalable datastore for metrics, events, and real-time analytics</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cernan: Telemetry and logging aggregation server</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Prometheus: Open Source monitoring solution</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Heapster: Compute Resource Usage Analysis and Monitoring of Container Clusters</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Stern: Multi pod and container log tailing for Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Minikube: tool to run Kubernetes locally</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Docker machine driver fox xhyve native OS X Hypervisor</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Drone: Continuous Delivery platform built on Docker, written in Go</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Borg, Omega and Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Container-Native Networking ‚Äî Comparison</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bug in minikube when working with xhyve driver.</a> <br></li></ol><br><blockquote>  Minuto de publicidade.  Se voc√™ gostou deste relat√≥rio da confer√™ncia <b>DevOops</b> - observe que em 14 de outubro o novo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevOops 2018</a> ser√° realizado em S√£o Petersburgo, haver√° muitas coisas interessantes em seu programa.  O site j√° tem os primeiros oradores e relat√≥rios. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416161/">https://habr.com/ru/post/pt416161/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416151/index.html">Bal√£o sem dimens√£o. An√°lise utilit√°ria de dimens√£o m√°gica</a></li>
<li><a href="../pt416153/index.html">Os avi√µes se tornar√£o mais confi√°veis? Fabricantes de aeronaves apresentam rob√¥s √†s empresas</a></li>
<li><a href="../pt416155/index.html">WebSockets em Angular: crie um Servi√ßo Angular para trabalhar com soquetes da Web</a></li>
<li><a href="../pt416157/index.html">Nos bra√ßos de Python (somente mulheres)</a></li>
<li><a href="../pt416159/index.html">Como fomos encarregados de comparar um ouri√ßo</a></li>
<li><a href="../pt416163/index.html">Aprenda o OpenGL. Li√ß√£o 5.6 - Mapeamento de paralaxe</a></li>
<li><a href="../pt416167/index.html">Peter Norwig: Aprenda Programa√ß√£o em ... 10 Anos</a></li>
<li><a href="../pt416169/index.html">Contentores para adultos (parte 01): um guia pr√°tico de terminologia</a></li>
<li><a href="../pt416171/index.html">Testes de UI codificados do Visual Studio: teoria e pr√°tica da aplica√ß√£o em nossa empresa</a></li>
<li><a href="../pt416175/index.html">Resultados da competi√ß√£o de jovens desenvolvedores de aplicativos AR Epson Moverio BT-300</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>