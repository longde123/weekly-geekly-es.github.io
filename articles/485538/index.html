<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóø ü§úüèª üë®üèΩ‚Äç‚öïÔ∏è Zabbix: supervisa todo en una fila (en el ejemplo de Redis) üë®üèΩ‚Äçü§ù‚Äçüë®üèº üéÖ ü§∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Zabbix es un gran producto para administradores de grandes sistemas de software y hardware. Es tan bueno que puede ser utilizado no solo por grandes e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zabbix: supervisa todo en una fila (en el ejemplo de Redis)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485538/"><p> <a href="https://www.zabbix.com/ru/" rel="nofollow">Zabbix</a> es un gran producto para administradores de grandes sistemas de software y hardware.  Es tan bueno que puede ser utilizado no solo por grandes empresas, sino tambi√©n por medianas y peque√±as empresas, e incluso en un proyecto <code>pet</code> .  En general, tengo poca experiencia con Zabbix y puedo recomendarlo para su uso. </p><br><p>  Es cierto que no puedo decir que entiendo la " <em>filosof√≠a de Zabbix</em> ".  A pesar de la extensa documentaci√≥n detallada en ruso, fue dif√≠cil para m√≠ sumergirme en el mundo de Zabbix: tuve la sensaci√≥n de que los desarrolladores y yo llam√°bamos a las mismas cosas por diferentes nombres.  Quiz√°s porque Zabbix fue creado por administradores para administradores, pero todav√≠a soy m√°s un desarrollador y un usuario. </p><br><p>  Sin embargo, para ejecutar Zabbix y monitorear los par√°metros principales de los sistemas inform√°ticos (procesador, memoria, etc.), las habilidades de un usuario habitual de Linux son suficientes.  Hay una gran cantidad de complementos de desarrolladores externos que ampl√≠an las capacidades de Zabbix.  Para mis necesidades, necesitaba configurar el monitoreo del servidor Redis.  Rebusqu√© un poco en el c√≥digo de los complementos disponibles y, usando su ejemplo, descubr√≠ que la arquitectura de Zabbix le permite simplemente conectar cualquier par√°metro del sistema de informaci√≥n que pueda expresarse en forma num√©rica al monitoreo. </p><br><p>  Under the cat: un ejemplo de un complemento de Zabbix con mi explicaci√≥n de la terminolog√≠a de Zabbix.  Para algunos, este ejemplo parecer√° ingenuo, pero para algunos ser√° m√°s f√°cil sentirse c√≥modo con los conceptos.  En cualquier caso, Zabbix <a href="http://irinagold.pro/na-kogo-pohozh-slon-pritcha/" rel="nofollow">es lo suficientemente grande como</a> para sentirlo desde diferentes √°ngulos. </p><a name="habracut"></a><br><h1 id="bazovye-ponyatiya">  Conceptos basicos </h1><br><p>  Brevemente sobre algunos de los conceptos que se usan en Zabbix: <em>agentes</em> , <em>elementos</em> , <em>disparadores</em> , <em>acciones</em> , <em>notificaciones</em> , <em>plantillas</em> . </p><br><h2 id="server-i-agenty">  Servidor y Agentes </h2><br><p>  Desde el punto de vista del usuario, Zabbix se divide en dos grandes partes: servidor y agentes.  El servidor est√° ubicado en una m√°quina, que recopila y almacena datos estad√≠sticos, y los agentes en esas m√°quinas de las que se recopilan datos: </p><br><p><img src="https://habrastorage.org/webt/22/cc/y2/22ccy2szuqjhs0eprqqxkn29-2e.png" alt="Servidor y agentes de Zabbix"></p><br><h2 id="parametry-monitoringa">  Opciones de monitoreo </h2><br><p>  Cualquier cantidad que se puede expresar en forma num√©rica o de cadena se llama en la terminolog√≠a de Zabbix, un elemento de datos (elemento).  Cada elemento est√° asociado con una <a href="https://www.zabbix.com/documentation/current/ru/manual/config/items/item/key" rel="nofollow">clave</a> √∫nica (nombre).  Aqu√≠ hay ejemplos de elementos de datos: </p><br><ul><li>  <strong>system.cpu.load [percpu, avg1]</strong> : 0.1167 </li><li>  <strong>system.uname</strong> : "Linux supru 4.15.0-50-generic # 54-Ubuntu SMP lun 6 de mayo 18:46:08 UTC 2019 x86_64" </li></ul><br><p>  Los valores de estos elementos de datos (par√°metros de monitoreo) se adjuntan al tiempo; el historial de valores de par√°metros se almacena en la base de datos del servidor. </p><br><h2 id="sobytiya">  Eventos </h2><br><p>  Cuando ocurre un evento en Zabbix, se dispara un disparador.  Por ejemplo </p><br><ul><li>  <strong>{system.cpu.load [percpu, avg1] .avg (5m)}&gt; 10</strong> - el valor promedio del par√°metro en los √∫ltimos 5 minutos ha excedido "10" </li><li>  <strong>{system.uname.diff (0)}&gt; 0</strong> : el valor actual del par√°metro no es igual al valor anterior </li></ul><br><p>  De hecho, los desencadenantes son f√≥rmulas en las que los par√°metros de monitoreo (actuales y guardados) act√∫an como variables, y que producen <code>true</code> / <code>false</code> en la salida. </p><br><h2 id="deystviya-i-opovescheniya">  Acciones y Alertas </h2><br><p>  En caso de un evento (disparador), el servidor puede realizar una acci√≥n.  Por ejemplo, env√≠e una alerta por correo electr√≥nico a una direcci√≥n determinada (" <em>Problema: no se puede acceder al host durante 5 minutos</em> ").  Adem√°s, se puede realizar una acci√≥n si el disparador vuelve a su estado original (" <em>Resuelto: el host no se</em> puede alcanzar <em>durante 5 minutos</em> ").  Todos los eventos (cambio de activaci√≥n) se registran en el lado del servidor. </p><br><h2 id="shablony">  Patrones </h2><br><p>  Zabbix hace posible configurar reglas de monitoreo para un host individual, as√≠ como crear una plantilla de regla (plantilla) que se puede aplicar a varios hosts: </p><br><p><img src="https://habrastorage.org/webt/4t/yt/qw/4tytqw7tog1do4nsqoizzxjbglw.png" alt="plantillas de zabbix"></p><br><p>  El ejemplo muestra que la plantilla "Servicio de plantilla de aplicaci√≥n SSH" describe una aplicaci√≥n (Aplicaciones), un par√°metro de monitoreo (Elementos), un disparador (Disparadores).  Tambi√©n est√°n disponibles descripciones para gr√°ficos, pantallas, reglas de descubrimiento y scripts web. </p><br><h1 id="postanovka-zadachi-dlya-plagina">  Establecer la tarea para el complemento </h1><br><h2 id="nachalnoe-polozhenie">  Posici√≥n inicial </h2><br><p>  El propio Zabbix ofrece su <a href="https://www.zabbix.com/ru/integrations/redis" rel="nofollow">propio complemento</a> para monitorear el estado de Redis, pero en mi versi√≥n del servidor (4.2.8) no pude usarlo (complemento para la versi√≥n 4.4 y superior).  Tambi√©n se ofrecen <a href="https://www.zabbix.com/ru/integrations/redis" rel="nofollow">soluciones de terceros</a> (aproximadamente una docena de opciones para varias versiones de Zabbix, solo est√°n las tres primeras en la imagen): </p><br><p><img src="https://habrastorage.org/webt/bv/pt/tk/bvpttkxf9lkxqn2thcnwwacutyw.png" alt="Complementos de redis para zabbix"></p><br><p>  Cada uno de ellos ten√≠a sus propias ventajas y desventajas, ten√≠a que mirar hacia adentro para elegir.  Lo mejor, en mi opini√≥n, fue el <a href="https://github.com/Shakeeljaveed/zabbix-redis-userparamaters" rel="nofollow">complemento Shakeeljaveed / zabbix-redis-userparamaters</a> , que constaba de dos archivos: </p><br><ul><li>  README.md </li><li>  redis-userparameter.conf </li></ul><br><p>  Tuve que trabajar un poco "bol√≠grafos", pero en su ejemplo se hizo un poco m√°s claro c√≥mo los datos del agente van al servidor.  A sugerencia del autor <a href="https://github.com/Shakeeljaveed" rel="nofollow">Javeed Shakeel,</a> la corona restableci√≥ <a href="https://github.com/Shakeeljaveed" rel="nofollow">el</a> estado <a href="https://github.com/Shakeeljaveed" rel="nofollow">de Redis</a> cada 2 minutos en el <code>/tmp/redismetric</code> : </p><br><pre> <code class="plaintext hljs">*/2 * * * * /usr/bin/redis-cli info &gt; /tmp/redismetric</code> </pre> <br><p>  Y luego cada par√°metro de monitoreo fue extra√≠do por el agente del <code>/tmp/redismetric</code> usando las herramientas del sistema operativo en s√≠.  Las instrucciones para esto se colocaron en la configuraci√≥n del agente Zabbix <code>/etc/zabbix/zabbix_agent.conf.d/userparameter_redis.conf</code> .  Por ejemplo, as√≠ es como se ve la instrucci√≥n para recuperar el par√°metro <code>used_memory</code> (uso de memoria por parte del servidor Redis): </p><br><pre> <code class="plaintext hljs">UserParameter=used_memory,grep -w 'used_memory' /tmp/redismetric | cut -d: -f2</code> </pre> <br><p>  Es decir, en el <code>/tmp/redismetric</code> con la salida de <code>redis-cli INFO</code> , la cadena ( <code>grep -w ...</code> ) busca la cadena ( <code>grep -w ...</code> ) </p><br><pre> <code class="plaintext hljs">used_memory:7153216</code> </pre> <br><p>  que luego se divide en columnas mediante el separador ":" ( <code>cut -d: -f2</code> ).  En la salida, el agente recibe el n√∫mero <code>7153216</code> y lo asigna al par√°metro <code>used_memory</code> . </p><br><p>  Queda por configurar el servidor a trav√©s de la interfaz basada en la web para que env√≠e peri√≥dicamente solicitudes al agente para recibir datos utilizando el par√°metro <code>used_memory</code> , despu√©s de lo cual los datos comienzan a <code>used_memory</code> en el servidor, almacenados en la base de datos, puede usarlos para crear gr√°ficos y crear activadores que respondan a los cambios a este par√°metro. </p><br><h2 id="cel">  Prop√≥sito </h2><br><p>  La tarea de monitorear el estado de cualquier sistema no es solo la recopilaci√≥n de estad√≠sticas, sino tambi√©n una advertencia sobre la ocurrencia de situaciones que requieren intervenci√≥n humana.  Como trabajo con Redis como un usuario muy novato, tuve que buscar informaci√≥n sobre a qu√© par√°metros de "salud" prestar atenci√≥n y qu√© significan.  El art√≠culo m√°s valioso fue " <a href="https://scalegrid.io/blog/6-crucial-redis-monitoring-metrics/" rel="nofollow">6 m√©tricas de monitoreo de Redis cruciales que debe observar</a> ".  Despu√©s de analizarlo, llegu√© a la conclusi√≥n de que "para la felicidad completa" necesito recopilar datos para detectar los siguientes eventos: </p><br><ul><li>  Fragmentaci√≥n de memoria: used_memory_rss / used_memory&gt; 1.5 </li><li>  Bajo √≠ndice de aciertos de cach√©: (keyspace_hits) / (keyspace_hits + keyspace_misses) &lt;0.8 </li><li>  Conexiones rechazadas: rechazadas_conexiones&gt; 0 </li><li>  Claves desalojadas: evicted_keys&gt; 0 </li></ul><br><p>  Tambi√©n quer√≠a recopilar estad√≠sticas sobre par√°metros adicionales (versi√≥n de Redis, tiempo de actividad, etc.).  En general, teniendo una idea general de c√≥mo el agente recopila los datos y los transmite al servidor, la lista de deseos puede ser muy limitada.  Como resultado, obtuvimos una lista de par√°metros para el monitoreo desde 12 posiciones. </p><br><h1 id="sozdanie-sobstvennogo-plagina">  Crea tu propio complemento </h1><br><h2 id="parametry-monitoringa-1">  Opciones de monitoreo </h2><br><p>  El complemento que analic√© asumi√≥ la ejecuci√≥n de un comando separado para obtener un par√°metro separado (elemento de datos, elemento): </p><br><pre> <code class="plaintext hljs">grep -w 'used_memory' /tmp/redismetric | cut -d: -f2</code> </pre> <br><p>  Es decir, para obtener datos sobre 12 par√°metros, el agente tendr√° que ejecutar varios conjuntos de comandos 12 veces.  ¬øY si necesito monitorear par√°metros que son dif√≠ciles de extraer por una cadena de comandos y necesito escribir un script de shell separado o un programa completo?  Para tal "Lista de deseos", Zabbix ofrece una variante con elementos de datos dependientes.  Su esencia es que, en el lado del agente, el script forma un conjunto de datos (por ejemplo, en formato JSON), que se transmite al servidor como un par√°metro de cadena.  Luego, en el lado del servidor, los datos recibidos se analizan y los par√°metros elementales individuales se extraen de ellos. </p><br><h3 id="osnovnoy-element-dannyh">  Elemento de datos principal </h3><br><p>  Describ√≠ el principal <code>redis.info</code> datos <code>redis.info</code> tipo de cadena con un per√≠odo de actualizaci√≥n de 1 minuto, sin guardar el historial de cambios: </p><br><p><img src="https://habrastorage.org/webt/hz/_m/tn/hz_mtnfj7n2uqzbssnnsdhtpgq4.png" alt="art√≠culo base"></p><br><p>  Presumiblemente, el siguiente JSON deber√≠a generarse en el lado del agente: </p><br><pre> <code class="plaintext hljs">{ "version": "4.0.9", "uptime": 1897336, "used_memory": 1054943416, "used_memory_rss": 1138159616, "keyspace_hits": 75810274, "keyspace_misses": 13545949, "connected_clients": 15, "rdb_last_save_time": 1580126954, "total_connections_received": 1258614, "rejected_connections": 0, "expired_keys": 60270, "evicted_keys": 0 }</code> </pre> <br><p>  despu√©s de lo cual este texto debe <code>redis.info</code> al servidor como un <code>redis.info</code> datos <code>redis.info</code> , pero no guardarse, sino que sirve como base para otros elementos de datos (par√°metros de monitoreo). </p><br><h3 id="zavisimyy-element-dannyh">  Elemento de datos dependiente </h3><br><p>  El par√°metro de prueba <code>redis.info.version</code> depende de <code>redis.info</code> y almacena sus valores en la base de datos durante 90 d√≠as.  La frecuencia del monitoreo de par√°metros depende del elemento base ( <code>redis.info</code> ): </p><br><p><img src="https://habrastorage.org/webt/eu/3u/jy/eu3ujyhzzyful-jrh8ceyqxsoz4.png" alt="elemento dependiente (base)"></p><br><p>  El <code>redis.info.version</code> par√°metro <code>redis.info.version</code> se recupera del valor redis.info utilizando las instrucciones JSONPath: </p><br><p><img src="https://habrastorage.org/webt/pn/3j/ad/pn3jad7k78sxnpq7pl1ubne9btk.png" alt="elemento dependiente (preproceso)"></p><br><p>  Un esquema similar describe los elementos de datos dependientes restantes (par√°metros de monitoreo), que se transmiten en forma de JSON.  Aqu√≠ hay un ejemplo de la descripci√≥n del par√°metro num√©rico <code>redis.info.used_memory</code> : </p><br><p><img src="https://habrastorage.org/webt/rh/_t/d8/rh_td8dczrfqa2ejsihinaobiho.png" alt="elemento de n√∫mero dependiente (base)"></p><br><p>  Todo es bastante transparente, con la excepci√≥n de las <code>Units</code> y <code>Trend storage period</code> .  No entend√≠ el segundo punto, lo dej√© por defecto y las unidades de medida se explican en la <a href="https://www.zabbix.com/documentation/current/ru/manual/appendix/suffixes" rel="nofollow">documentaci√≥n</a> .  En este caso, el valor de <code>redis.info.used_memory</code> se mide en bytes y se minimiza a kilo / mega / giga /...- bytes en la interfaz web. </p><br><p>  La f√≥rmula para extraer un valor de JSON es: <code>JSONPath = $.used_memory</code> </p><br><h3 id="vychislyaemyy-element-dannyh">  Elemento de datos calculados </h3><br><p>  Para calcular la fragmentaci√≥n de la memoria, se utiliza la relaci√≥n <code>used_memory_rss</code> / <code>used_memory</code> y, sobre la base de esto, se determina un disparador que se activa cuando la relaci√≥n excede 1.5.  Zabbix tiene un tipo de elemento de datos calculado: </p><br><p><img src="https://habrastorage.org/webt/iy/sd/4g/iysd4g2bqofdmwrvp9cpbguzvzo.png" alt="art√≠culo calc"></p><br><p>  El valor del par√°metro <code>redis.info.used_memory_ratio</code> calcula cada minuto en funci√≥n de los √∫ltimos valores de otros dos par√°metros ( <code>redis.info.used_memory_rss</code> y <code>redis.info.used_memory</code> ), se almacena en la base de datos durante 90 d√≠as, etc. </p><br><h2 id="triggery">  Disparadores </h2><br><p>  Aqu√≠ hay un ejemplo de un disparador que se dispara cuando la memoria est√° demasiado fragmentada: </p><br><p><img src="https://habrastorage.org/webt/bl/81/oj/bl81ojowbfvanebjn9nefzoh29w.png"></p><br><p>  Nada inusual, excepto el formato de expresi√≥n utilizado en la f√≥rmula de cambio de estado del disparador.  Zabbix tiene un constructor de formularios, puede usarlo o consultar la <a href="https://www.zabbix.com/documentation/current/ru/manual/config/triggers/expression" rel="nofollow">documentaci√≥n</a> / ejemplos (la lista de disparadores est√° disponible a trav√©s de la interfaz web en " <em>Configuraci√≥n / Plantillas / $ {TemplateName} / Triggers</em> "). </p><br><p>  Un activador puede basarse en cualquier elemento de datos (elemento), independientemente de su tipo (principal, dependiente, calculado). </p><br><h2 id="nastroyka-agenta">  Configuraci√≥n del agente </h2><br><h3 id="generaciya-jsona">  Generaci√≥n JSON </h3><br><p>  Para obtener los valores de los par√°metros de monitoreo y la formaci√≥n de JSON, uso este script de shell: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash ## =========================================================================== # Script to generate Redis monitoring data in JSON format # for 'zabbix-agent'. ## =========================================================================== # collect working variables/data BIN_REDIS=$(whereis -b redis-cli | cut -d" " -f2) # /usr/bin/redis-cli DATA_INFO=$(${BIN_REDIS} INFO | tr -d '\r') # get info and remove trailing '\r' from output ## # Extract stats and save it into env. vars. ## # find lines with 'grep', cut second field after ":" and put it into env. variable: ITEM_VERSION=$(grep "^redis_version:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_UPTIME=$(grep "^uptime_in_seconds:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_USED_MEMORY=$(grep "^used_memory:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_USED_MEMORY_RSS=$(grep "^used_memory_rss:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_KEYSPACE_HITS=$(grep "^keyspace_hits:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_KEYSPACE_MISSES=$(grep "^keyspace_misses:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_CONNECTED_CLIENTS=$(grep "^connected_clients:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_RDB_LAST_SAVE_TIME=$(grep "^rdb_last_save_time:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_TOTAL_CONNECTIONS_RECEIVED=$(grep "^total_connections_received:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_REJECTED_CONNECTIONS=$(grep "^rejected_connections:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_EXPIRED_KEYS=$(grep "^expired_keys:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) ITEM_EVICTED_KEYS=$(grep "^evicted_keys:" &lt;&lt;&lt;"${DATA_INFO}" | cut -d: -f2) # compose output JSON for Zabbix server: echo -n "{" echo -n "\"version\": \"${ITEM_VERSION}\"," echo -n "\"uptime\": ${ITEM_UPTIME}," echo -n "\"used_memory\": ${ITEM_USED_MEMORY}," echo -n "\"used_memory_rss\": ${ITEM_USED_MEMORY_RSS}," echo -n "\"keyspace_hits\": ${ITEM_KEYSPACE_HITS}," echo -n "\"keyspace_misses\": ${ITEM_KEYSPACE_MISSES}," echo -n "\"connected_clients\": ${ITEM_CONNECTED_CLIENTS}," echo -n "\"rdb_last_save_time\": ${ITEM_RDB_LAST_SAVE_TIME}," echo -n "\"total_connections_received\": ${ITEM_TOTAL_CONNECTIONS_RECEIVED}," echo -n "\"rejected_connections\": ${ITEM_REJECTED_CONNECTIONS}," echo -n "\"expired_keys\": ${ITEM_EXPIRED_KEYS}," echo -n "\"evicted_keys\": ${ITEM_EVICTED_KEYS}" echo -n "}"</span></span></code> </pre> <br><p>  <code>/var/lib/zabbix/user_parameter/redis/get_info.sh</code> este script en el archivo <code>/var/lib/zabbix/user_parameter/redis/get_info.sh</code> en el servidor con Redis, en el que el agente Zabbix ya est√° instalado.  El usuario con el que se <code>zabbix</code> agente Zabbix (generalmente <code>zabbix</code> ) debe tener permiso para ejecutar el archivo <code>get_info.sh</code> . </p><br><h2 id="fayl-userparameter_xxxconf">  Archivo <code>userparameter_XXX.conf</code> </h2><br><p>  En el lado del agente, los par√°metros de supervisi√≥n adicionales se <code>userparameter_*.conf</code> en los <code>userparameter_*.conf</code> en el directorio <code>userparameter_*.conf</code> .  Por lo tanto, para que el agente descubra c√≥mo necesita recopilar datos sobre el par√°metro <code>redis.info</code> , cre√© el archivo <code>/etc/zabbix/zabbix_agentd.d/userparameter_redis.conf</code> con el siguiente contenido: </p><br><pre> <code class="plaintext hljs">UserParameter=redis.info,/var/lib/zabbix/user_parameter/redis/get_info.sh</code> </pre> <br><p>  Es decir, para obtener datos sobre el par√°metro <code>redis.info</code> agente debe ejecutar el script <code>/var/lib/zabbix/user_parameter/redis/get_info.sh</code> y transferir el resultado de la ejecuci√≥n al servidor. </p><br><p>  Despu√©s de reiniciar el agente Zabbix ( <code>sudo service zabbix-agent restart</code> ), es posible recopilar datos para el par√°metro <code>redis.info</code> y enviarlos al servidor. </p><br><h1 id="rezyume">  Resumen </h1><br><p>  Entender Zabbix vino a m√≠ (y todav√≠a viene) bastante dif√≠cil.  Sin embargo, lo considero una gran herramienta, especialmente despu√©s de que se me abri√≥ la simplicidad de agregar mis propios par√°metros de monitoreo (elementos de datos).  En general, es suficiente agregar un archivo al servidor con el agente ( <code>userparameter_XXX.conf</code> ) con un comando de shell para recopilar datos y configurar el servidor Zabbix para recibir estos datos a trav√©s de la interfaz web.  Y eso es todo: puede acumular datos, crear gr√°ficos, analizar cambios y crear un activador que responda a estos cambios. </p><br><p>  El c√≥digo de la plantilla, el archivo <code>userparameter_redis.conf</code> y el script <code>get_info.sh</code> se pueden ver en el <a href="https://github.com/flancer32/zabbix_plugin_redis/tree/habr" rel="nofollow">proyecto flancer32 / zabbix_plugin_redis</a> . </p><br><p>  Gracias a todos los que leyeron hasta el final, y especialmente a aquellos que encontraron algo √∫til para ellos en la publicaci√≥n. </p></div></div><p>Source: <a href="https://habr.com/ru/post/485538/">https://habr.com/ru/post/485538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../485528/index.html">C√≥mo concluir un proyecto de desarrollo de software de la manera correcta</a></li>
<li><a href="../485530/index.html">Aprendizaje Guiado</a></li>
<li><a href="../485532/index.html">Gu√≠a de entrevista para aquellos programadores que no los entienden</a></li>
<li><a href="../485534/index.html">HighLoad ++, Mikhail Makurov (Intersvyaz): experiencia en la creaci√≥n de un servicio Zabbix de respaldo y agrupado</a></li>
<li><a href="../485536/index.html">¬øEs posible hackear un avi√≥n - 2</a></li>
<li><a href="../485542/index.html">Agregar gr√°ficos a Notion</a></li>
<li><a href="../485544/index.html">El ajedrez como sistema din√°mico.</a></li>
<li><a href="../485546/index.html">Se acerca el apocalipsis</a></li>
<li><a href="../485548/index.html">SwiftUI en los estantes</a></li>
<li><a href="../485550/index.html">¬øHay vida m√°s all√° de la circunvalaci√≥n de Mosc√∫? C√≥mo buscamos y preparamos desarrolladores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>