<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🚀 🍅 🆒 Pemantauan Sistem Terdistribusi - Pengalaman Google (terjemahan bab buku Google SRE) 🤵 🚶 🦓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SRE (Site Reliability Engineering) - pendekatan untuk memastikan ketersediaan proyek web. Ini dianggap sebagai kerangka kerja untuk DevOps dan memberi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemantauan Sistem Terdistribusi - Pengalaman Google (terjemahan bab buku Google SRE)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484246/"><img src="https://habrastorage.org/webt/rj/u4/8s/rju48s3gqxozu32f2esipgkpc6c.png"><br><br>  SRE (Site Reliability Engineering) - pendekatan untuk memastikan ketersediaan proyek web.  Ini dianggap sebagai kerangka kerja untuk DevOps dan memberitahu cara untuk berhasil dalam menerapkan praktik-praktik DevOps.  Artikel ini adalah terjemahan dari <a href="https://landing.google.com/sre/book/chapters/monitoring-distributed-systems.html">Bab 6 Pemantauan Sistem Terdistribusi</a> dari buku <a href="https://landing.google.com/sre/book.html">Rekayasa Keandalan Situs</a> Google.  Saya menyiapkan terjemahan ini sendiri dan mengandalkan pengalaman saya sendiri dalam memahami proses pemantauan.  Di saluran telegram <a href="https://t.me/monitorim_it/28">@monitorim_it</a> dan <a href="https://medium.com/%40antonkasimov/%25D1%2586%25D0%25B5%25D0%25BB%25D0%25B8-%25D1%2583%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BD%25D1%258F-%25D0%25BE%25D0%25B1%25D1%2581%25D0%25BB%25D1%2583%25D0%25B6%25D0%25B8%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F-%25D0%25BE%25D0%25BF%25D1%258B%25D1%2582-google-630008918e9f%3Fsource%3Dfriends_link%255E_%255Eamp%255E_%255Esk%3D0b7f6ab888298580001b027434c53c56">blog di Medium,</a> saya juga menerbitkan tautan ke terjemahan bab 4 buku yang sama tentang tujuan tingkat layanan. <br><br>  Terjemahan oleh kucing.  Selamat membaca! <br><a name="habracut"></a><br>  Tim SRE Google memiliki prinsip dasar dan praktik terbaik untuk menciptakan sistem pemantauan dan pemberitahuan yang berhasil.  Bab ini memberikan rekomendasi tentang masalah apa yang mungkin dihadapi pengunjung halaman web dan bagaimana menyelesaikan masalah yang membuat halaman web sulit ditampilkan. <br><br><h1>  Definisi </h1><br>  Tidak ada kosakata tunggal yang digunakan untuk membahas topik yang terkait dengan pemantauan.  Bahkan di Google, istilah di bawah ini tidak umum digunakan, tetapi kami akan mencantumkan interpretasi yang paling umum. <br><br><h3>  Pemantauan </h3><br>  Pengumpulan, pemrosesan, agregasi dan tampilan data kuantitatif secara real time tentang sistem: jumlah permintaan dan jenis permintaan, jumlah kesalahan dan jenis kesalahan, waktu pemrosesan permintaan dan waktu server. <br><br><h3>  Pemantauan kotak putih </h3><br>  Pemantauan berdasarkan metrik yang ditampilkan oleh komponen internal sistem, termasuk log, profil metrik mesin virtual Java, atau HTTP handler yang menghasilkan statistik internal. <br><br><h3>  Pemantauan kotak hitam </h3><br>  Menguji perilaku aplikasi dari sudut pandang pengguna. <br><br><h3>  Dasbor (dasbor) </h3><br>  Antarmuka (biasanya web) yang menyediakan ikhtisar indikator kesehatan utama untuk layanan.  Dasbor mungkin memiliki filter, kemampuan untuk memilih indikator untuk ditampilkan, dll. Antarmuka dibuat untuk mengidentifikasi indikator yang paling penting bagi pengguna.  Informasi untuk staf dukungan teknis juga dapat ditampilkan di dasbor: antrian permintaan, daftar kesalahan prioritas tinggi, insinyur yang ditugaskan untuk bidang tanggung jawab tertentu. <br><br><h3>  Peringatan (pemberitahuan) </h3><br>  Pemberitahuan yang dirancang untuk diterima oleh seseorang melalui email atau dengan cara lain, yang dapat dimulai sebagai akibat dari kesalahan atau peningkatan dalam antrian permintaan.  Pemberitahuan diklasifikasikan sebagai: tiket, peringatan email dan pesan kurir. <br><br><h3>  Penyebab root </h3><br>  Cacat perangkat lunak atau faktor manusia yang seharusnya tidak terjadi lagi ketika dihilangkan.  Masalahnya dapat memiliki beberapa alasan utama: otomatisasi proses yang tidak mencukupi, cacat perangkat lunak, studi logika aplikasi yang tidak mencukupi.  Masing-masing faktor ini dapat menjadi akar penyebab, dan masing-masing faktor tersebut harus dihilangkan. <br><br><h3>  Simpul dan mesin </h3><br>  Istilah yang dapat dipertukarkan untuk menunjukkan satu instance aplikasi yang berjalan pada server fisik, mesin virtual, atau wadah.  Mungkin ada beberapa layanan pada satu mesin.  Layanan mungkin: <br><br><ul><li>  terkait satu sama lain: misalnya, server cache dan server web; </li><li>  layanan yang tidak terkait pada satu perangkat keras: misalnya, repositori kode dan panduan untuk sistem konfigurasi, seperti <a href="https://puppetlabs.com/puppet/puppet-open-source">Wayang</a> atau <a href="https://www.chef.io/chef/">Chef</a> . </li></ul><br><h3>  Dorong </h3><br>  Setiap perubahan pada konfigurasi perangkat lunak. <br><br><h1>  Mengapa pemantauan dibutuhkan </h1><br>  Ada beberapa alasan mengapa aplikasi harus dipantau: <br><br><h3>  Analisis Tren Panjang </h3><br>  Seberapa besar database dan seberapa cepat pertumbuhannya?  Bagaimana jumlah pengguna harian berubah? <br><br><h3>  Perbandingan kinerja </h3><br>  Apakah Acme Bucket of Bytes 2.72 kueri lebih cepat dari Ajax DB 3.14?  Seberapa jauh lebih baik permintaan di-cache setelah munculnya simpul tambahan?  Apakah situs menjadi lebih lambat dibandingkan minggu lalu? <br><br><h3>  Peringatan (pemberitahuan) </h3><br>  Ada yang rusak dan seseorang harus memperbaikinya.  Atau sesuatu akan segera hancur dan seseorang harus memeriksanya segera. <br><br><h3>  Buat Dashboard </h3><br>  Dasbor harus menjawab pertanyaan dasar dan memasukkan beberapa <a href="https://landing.google.com/sre/sre-book/chapters/monitoring-distributed-systems/">"4 sinyal emas"</a> - latensi, lalu lintas, kesalahan, dan muat (saturasi). <br><br><h3>  Melakukan analisis retrospektif (debugging) </h3><br>  Penundaan pemrosesan permintaan telah meningkat, dan apa lagi yang terjadi pada waktu yang bersamaan? <br>  Sistem pemantauan bermanfaat sebagai sumber data untuk sistem intelijen bisnis dan untuk menyederhanakan analisis insiden keamanan.  Karena buku ini berfokus pada bidang teknik di mana SRE memiliki keahlian, kami tidak akan membahas teknik pemantauan di sini. <br><br>  Pemantauan dan peringatan membiarkan sistem memberi tahu kapan ia rusak atau akan rusak.  Ketika sistem tidak dapat secara otomatis mengembalikan sendiri, kami ingin lansiran dianalisis oleh seseorang, untuk menentukan apakah masalah tersebut relevan, untuk menghilangkan dan menentukan akar masalahnya.  Jika Anda tidak mengaudit komponen sistem, Anda tidak akan pernah menerima peringatan hanya karena "sesuatu tampaknya sedikit aneh." <br><br>  Muatan peringatan manusia adalah penggunaan waktu karyawan yang agak mahal.  Jika seorang karyawan bekerja, peringatan akan mengganggu alur kerja.  Jika karyawan di rumah, pemberitahuan mengganggu waktu pribadi dan, mungkin, tidur.  Ketika peringatan muncul terlalu sering, karyawan dengan cepat memindai, menunda, atau mengabaikan peringatan masuk.  Dari waktu ke waktu, mereka mengabaikan peringatan nyata, yang ditutupi oleh peristiwa kebisingan.  Gangguan layanan dapat bertahan lama, karena gangguan kebisingan mengganggu diagnosis cepat dan pemecahan masalah.  Sistem peringatan yang efisien memiliki rasio sinyal terhadap kebisingan yang baik. <br><br><h1>  Menentukan harapan yang masuk akal dari sistem pemantauan </h1><br>  Menyiapkan pemantauan aplikasi yang kompleks itu sendiri merupakan tugas rekayasa yang sulit.  Bahkan dengan infrastruktur alat yang signifikan untuk mengumpulkan, menampilkan dan mengingatkan, tim Google SRE dengan 10-12 anggota biasanya mencakup satu atau dua orang yang tujuan utamanya adalah menciptakan dan memelihara sistem pemantauan.  Jumlah ini menurun dari waktu ke waktu karena kami menggeneralisasi dan memusatkan infrastruktur pemantauan, tetapi setiap tim SRE biasanya memiliki setidaknya satu staf pemantauan.  Saya harus mengatakan bahwa meskipun cukup menarik untuk menonton dasbor sistem pemantauan, tim SRE dengan hati-hati menghindari situasi yang mengharuskan seseorang untuk melihat layar untuk memantau masalah. <br><br>  Secara umum, Google beralih ke sistem pemantauan yang sederhana dan cepat dengan alat yang optimal untuk analisis pasca-faktum.  Kami menghindari sistem "magis" yang mencoba memprediksi ambang batas atau secara otomatis mendeteksi akar permasalahan.  Sensor yang mendeteksi konten yang tidak pantas dalam permintaan pengguna akhir adalah satu-satunya contoh tandingan;  selama sensor-sensor ini tetap sederhana, mereka dapat dengan cepat mengidentifikasi penyebab anomali yang serius.  Format lain untuk menggunakan data pemantauan, seperti perencanaan kapasitas atau perkiraan lalu lintas, lebih menantang.  Pengamatan yang dilakukan dalam waktu yang sangat lama (berbulan-bulan atau bertahun-tahun) dengan laju pengambilan sampel yang rendah (jam atau hari) akan mengungkapkan tren jangka panjang. <br><br>  Tim Google SRE telah bekerja dengan berbagai keberhasilan dengan hierarki ketergantungan yang kompleks.  Kami jarang menggunakan aturan seperti "jika saya mengetahui bahwa basis data sudah mulai bekerja lambat, saya mendapat pemberitahuan tentang basis data yang melambat, jika tidak saya akan mendapat peringatan tentang situs yang berjalan lambat."  Aturan berbasis ketergantungan biasanya berlaku untuk bagian yang tidak berubah-ubah dari sistem kami, seperti sistem untuk memfilter lalu lintas pengguna ke pusat data.  Misalnya, "jika pemfilteran lalu lintas ke pusat data dikonfigurasi, jangan peringatkan saya tentang keterlambatan dalam memproses permintaan pengguna" - ini adalah satu aturan umum untuk pemberitahuan dari pusat data.  Beberapa tim di Google mendukung hierarki dependensi yang kompleks karena infrastruktur kami memiliki tingkat refactoring terus menerus yang konstan. <br><br>  Beberapa ide yang dijelaskan dalam bab ini masih relevan: selalu ada peluang untuk bergerak lebih cepat dari gejala ke akar masalah, terutama dalam sistem yang terus berubah.  Oleh karena itu, meskipun bab ini menguraikan beberapa tujuan untuk sistem pemantauan dan cara-cara untuk mencapai tujuan-tujuan ini, penting bahwa sistem pemantauan itu sederhana dan dapat dipahami oleh semua orang di tim. <br><br>  Demikian juga, untuk mempertahankan tingkat kebisingan yang rendah dan tingkat sinyal yang tinggi, pendekatan untuk memantau objek yang peringatannya dibuat harus sangat sederhana dan dapat diandalkan.  Aturan yang menghasilkan peringatan bagi orang-orang harus mudah dipahami dan menghadirkan masalah yang jelas. <br><br><h1>  Gejala vs. Penyebab </h1><br>  Sistem pemantauan Anda harus menjawab dua pertanyaan: "apa yang rusak" dan "mengapa rusak". <br>  "Apa yang rusak" berbicara tentang gejala, dan "mengapa itu rusak" dari penyebabnya.  Tabel di bawah ini menunjukkan contoh bundel tersebut. <br><div class="scrollable-table"><table><tbody><tr><td align="center">  <b>Gejala</b> </td><td align="center">  <b>Alasan</b> </td></tr><tr><td>  Mendapatkan Kesalahan HTTP 500 atau 404 </td><td>  Server database menolak koneksi </td></tr><tr><td>  Respons server lambat </td><td>  Penggunaan CPU yang tinggi atau kerusakan kabel Ethernet </td></tr><tr><td>  Pengguna Antartika tidak menerima gif kucing </td><td>  CDN Anda membenci ilmuwan dan kucing, sehingga beberapa alamat IP dimasukkan dalam daftar hitam </td></tr><tr><td>  Konten pribadi tersedia di mana-mana </td><td>  Menggulirkan rilis perangkat lunak baru membuat firewall melupakan semua ACL dan membiarkan semua orang berturut-turut </td></tr></tbody></table></div><br>  "Apa" dan "mengapa" adalah beberapa blok bangunan terpenting untuk menciptakan sistem pemantauan yang baik dengan sinyal maksimum dan kebisingan minimum. <br><br><h3>  Black-box vs White-box </h3><br>  Kami menggabungkan pemantauan Kotak Putih yang luas dengan pemantauan Kotak Hitam sederhana untuk metrik kritis.  Cara termudah untuk membandingkan Black-box dengan White-box adalah bahwa Black-box berorientasi pada gejala dan reaktif daripada pemantauan proaktif: "sistem tidak berfungsi saat ini."  Kotak putih tergantung pada kemampuan verifikasi sistem internal: log peristiwa atau server web.  Dengan demikian, Kotak Putih memungkinkan Anda untuk mendeteksi masalah di masa depan, kegagalan fungsi yang terlihat seperti pengiriman ulang permintaan, dll. <br><br>  Harap dicatat bahwa dalam sistem multilayer, gejala di bidang tanggung jawab satu insinyur adalah gejala di bidang tanggung jawab insinyur lain.  Sebagai contoh, kinerja basis data telah menurun.  Pembacaan basis data yang lambat adalah gejala SRE pada basis data yang mendeteksi mereka.  Namun, untuk SRE front-end, yang mengamati situs web yang lambat, alasan untuk pembacaan database yang lambat adalah karena pengoperasian database yang lambat.  Oleh karena itu, pemantauan White-box terkadang terfokus pada gejala, dan kadang-kadang pada alasan, tergantung pada seberapa luas itu. <br><br>  Saat mengumpulkan telemetri, pemantauan White-box diperlukan untuk debugging.  Jika server web merespons permintaan basis data secara perlahan, Anda perlu mengetahui seberapa cepat server web berinteraksi dengan basis data dan seberapa cepat ia merespons.  Jika tidak, Anda tidak dapat membedakan server database lambat dari masalah jaringan antara server web dan database. <br><br>  Pemantauan kotak hitam memiliki keuntungan utama saat mengirim peringatan: Anda memulai pemberitahuan kepada penerima ketika masalahnya sudah mengarah ke gejala nyata.  Di sisi lain, untuk masalah Kotak Hitam yang belum muncul, tetapi akan datang, pemantauan tidak berguna. <br><br><h1>  Empat sinyal emas </h1><br>  Empat sinyal pemantauan emas adalah latensi, lalu lintas, kesalahan, dan saturasi.  Jika Anda hanya dapat mengukur empat metrik dalam sistem pengguna, fokuslah pada keempat metrik ini. <br><br><h3>  Tunda </h3><br>  Waktu yang dibutuhkan untuk memproses permintaan.  Penting untuk membedakan antara penundaan permintaan yang berhasil dan yang tidak berhasil.  Misalnya, kesalahan HTTP 500 yang disebabkan oleh hilangnya koneksi ke database atau backend lainnya dapat didiagnosis dengan sangat cepat, namun, kesalahan HTTP 500 dapat menunjukkan permintaan yang gagal.  Mengidentifikasi efek kesalahan 500 pada keterlambatan keseluruhan dapat menyebabkan kesimpulan yang salah.  Di sisi lain, kesalahan lambat bahkan merupakan kesalahan cepat!  Karena itu, penting untuk melacak penundaan dengan kesalahan, dan tidak hanya memfilter kesalahan. <br><br><h3>  Lalu lintas </h3><br>  Jumlah permintaan ke sistem Anda diukur dalam metrik sistem tingkat tinggi.  Untuk layanan web, dimensi ini biasanya mewakili jumlah permintaan HTTP per detik, dipisahkan oleh sifat permintaan (misalnya, konten statis atau dinamis).  Untuk sistem audio streaming, pengukuran ini dapat dikonsentrasikan pada kecepatan I / O jaringan atau jumlah sesi simultan.  Untuk sistem penyimpanan nilai kunci, pengukuran semacam itu bisa berupa transaksi atau hasil pencarian per detik. <br><br><h3>  Kesalahan </h3><br>  Ini adalah frekuensi permintaan yang gagal yang secara eksplisit (misalnya, HTTP 500), secara implisit (misalnya, HTTP 200, tetapi dalam kombinasi dengan konten yang salah), atau kebijakan (misalnya, "Jika Anda mencatat respons dalam satu detik, salah satu detik adalah kesalahan").  Jika kode respons protokol HTTP tidak cukup untuk mengungkapkan semua kondisi kegagalan, protokol sekunder (internal) mungkin diperlukan untuk mendeteksi kegagalan parsial.  Memantau semua permintaan yang salah seperti itu mungkin tidak informatif, sementara pengujian sistem ujung-ke-ujung akan membantu Anda menemukan bahwa Anda memproses konten yang salah. <br><br><h3>  Kejenuhan </h3><br>  Metrik menunjukkan seberapa besar layanan Anda digunakan.  Ini adalah ukuran pemantauan sistem yang mengidentifikasi sumber daya yang paling terbatas (misalnya, dalam sistem dengan memori terbatas, ini menunjukkan memori, dalam sistem dengan batasan I / O, jumlah I / O ditampilkan).  Perhatikan bahwa banyak sistem menurunkan kinerja sebelum mencapai pemanfaatan 100%, jadi memiliki tujuan untuk penggunaan adalah penting. <br><br>  Dalam sistem yang kompleks, saturasi dapat dilengkapi dengan mengukur beban pada tingkat yang lebih tinggi: dapatkah layanan Anda menangani dua lalu lintas dengan baik, memproses hanya 10% lebih banyak lalu lintas, atau memproses lebih sedikit lalu lintas daripada saat ini?  Untuk layanan sederhana yang tidak memiliki parameter yang mengubah kompleksitas permintaan (misalnya, "Beri saya apa-apa" atau "Saya perlu bilangan bulat tunggal yang unik") yang jarang mengubah konfigurasi mereka, nilai statis uji beban mungkin memadai. dibahas dalam paragraf sebelumnya, sebagian besar layanan harus menggunakan sinyal tidak langsung, seperti pemanfaatan CPU atau bandwidth jaringan, yang memiliki batas atas yang diketahui.  Peningkatan latensi sering merupakan indikator utama saturasi.  Mengukur waktu respons persentil ke-99 dalam jendela kecil (misalnya, satu menit) dapat memberikan sinyal saturasi yang sangat awal. <br><br>  Akhirnya, saturasi juga dikaitkan dengan prediksi saturasi yang akan datang, misalnya: "Sepertinya database Anda akan mengisi hard drive Anda dalam 4 jam." <br><br>  Jika Anda mengukur keempat sinyal emas dan ketika masalah muncul dengan salah satu metrik (atau, dalam kasus saturasi, hampir menjadi masalah), beri tahu orang tersebut, layanan Anda akan lebih atau kurang dipantau. <br><br><h1>  Kecemasan tentang ekor (atau instrumentasi dan kinerja) </h1><br>  Saat membuat sistem pemantauan dari awal, tergoda untuk mengembangkan sistem berdasarkan nilai rata-rata: latensi rata-rata, pemanfaatan CPU rata-rata node, atau rata-rata hunian basis data.  Bahaya dari dua contoh terakhir jelas: prosesor dan basis data dibuang dengan cara yang sangat tidak terduga.  Hal yang sama berlaku untuk penundaan.  Jika Anda menjalankan layanan web dengan penundaan rata-rata 100 ms pada 1000 permintaan per detik, 1% dari permintaan mungkin memakan waktu 5 detik.  Jika pengguna bergantung pada beberapa layanan web ini, persentil ke-99 dari satu backend dapat dengan mudah menjadi waktu respons antarmuka median. <br><br>  Cara paling sederhana untuk membedakan antara rata-rata lambat dan "ekor" kueri yang sangat lambat adalah dengan mengumpulkan dimensi kueri yang dinyatakan dalam statistik (alat yang cocok untuk menampilkan histogram) daripada penundaan aktual: berapa banyak permintaan yang dilayani oleh layanan, yang memakan waktu antara 0 ms dan 10 ms, antara 10 ms dan 30 ms, antara 30 ms dan 100 ms, antara 100 ms dan 300 ms, dll. Memperluas batas histogram kira-kira secara eksponensial (dengan koefisien perkiraan 3) seringkali merupakan cara sederhana untuk memvisualisasikan distribusi kueri. <br><br><h1>  Memilih Level Detailing yang Tepat untuk Pengukuran </h1><br>  Elemen-elemen yang berbeda dari sistem harus diukur dengan berbagai tingkat detail.  Sebagai contoh: <br><br><ul><li>  Pemantauan pemanfaatan beban CPU pada interval waktu tertentu tidak akan menunjukkan outlier jangka panjang yang menghasilkan latensi tinggi. </li><li>  Di sisi lain, untuk layanan web yang berfokus pada tidak lebih dari 9 jam downtime per tahun (99,9% dari uptime tahunan), memeriksa respons HTTP sebesar 200 lebih dari sekali atau dua kali satu menit mungkin akan sering tidak perlu. </li><li>  Demikian pula, memeriksa ruang hard disk kosong untuk ketersediaan 99,9% lebih dari sekali setiap 1-2 menit mungkin tidak perlu. </li></ul><br>  Jaga bagaimana Anda menyusun granularitas dimensi.  Frekuensi mengumpulkan beban CPU sekali dalam satu detik dapat memberikan data yang menarik, tetapi pengukuran yang sering tersebut bisa sangat mahal untuk dikumpulkan, disimpan, dan dianalisis.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika tujuan pemantauan memerlukan granularitas tinggi dan tidak memerlukan laju reaksi yang tinggi, Anda dapat mengurangi biaya ini dengan menyiapkan pengumpulan metrik di server, lalu menyiapkan sistem eksternal untuk mengumpulkan dan mengagregasi metrik ini. </font><font style="vertical-align: inherit;">Anda bisa:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ukur pemanfaatan CPU setiap detik. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Potong detail hingga 5%. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Metrik agregat setiap menit. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Strategi ini akan memungkinkan data dikumpulkan dengan granularitas tinggi tanpa mengalami analisis tinggi dan overhead penyimpanan. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sesederhana mungkin, tetapi tidak mudah </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengenakan persyaratan yang berbeda satu sama lain dapat menyebabkan sistem pemantauan yang sangat kompleks. </font><font style="vertical-align: inherit;">Misalnya, sistem Anda mungkin memiliki elemen rumit berikut:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lansiran menurut nilai ambang yang berbeda untuk keterlambatan dalam memproses permintaan, dalam persentil yang berbeda, untuk semua jenis indikator yang berbeda. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menulis kode tambahan untuk mendeteksi dan mengidentifikasi kemungkinan penyebabnya. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buat dasbor terkait untuk setiap kemungkinan penyebab masalah. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber komplikasi potensial tidak pernah berakhir. </font><font style="vertical-align: inherit;">Seperti semua sistem perangkat lunak, pemantauan dapat menjadi sangat rumit sehingga menjadi rapuh dan sulit untuk diubah dan dipelihara. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena itu, rancang sistem pemantauan Anda untuk menyederhanakannya sebanyak mungkin. </font><font style="vertical-align: inherit;">Saat memilih apa yang akan dilacak, ingat yang berikut:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aturan yang paling sering menangkap insiden nyata harus sesederhana mungkin, dapat diprediksi dan dapat diandalkan. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Konfigurasi untuk pengumpulan data, agregasi, dan peringatan yang jarang dilakukan (misalnya, kurang dari seperempat untuk beberapa perintah SRE) harus dihapus. </font></font></li><li> ,  ,     -      - ,    . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di Google, pengumpulan dasar dan agregasi indikator, dikombinasikan dengan peringatan dan dasbor, berfungsi dengan baik sebagai sistem yang relatif otonom (Faktanya, sistem pemantauan Google dibagi menjadi beberapa subsistem, tetapi biasanya orang tahu tentang semua aspek dari subsistem ini). Mungkin tergoda untuk menggabungkan pemantauan dengan metode lain untuk memeriksa sistem yang kompleks: profil sistem terperinci, debugging proses, pelacakan detail tentang pengecualian atau kegagalan, pengujian beban, pengumpulan dan analisis log, atau pengecekan lalu lintas. Sementara sebagian besar dari hal-hal ini memiliki fitur umum dengan pemantauan dasar, menggabungkannya bersama-sama akan menghasilkan terlalu banyak hasil dalam menciptakan sistem yang kompleks dan rapuh. Seperti banyak aspek lain dari pengembangan perangkat lunak, dukungan untuk berbagai sistem jelas, sederhana,poin integrasi yang digabungkan secara longgar adalah strategi yang lebih baik (misalnya, menggunakan API web untuk mengambil data ringkasan dalam format yang dapat tetap konstan selama periode waktu yang lama).</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menghubungkan prinsip bersama </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prinsip-prinsip yang dibahas dalam bab ini dapat diintegrasikan ke dalam filosofi pemantauan dan peringatan yang didukung dan dihormati oleh tim SRE Google. </font><font style="vertical-align: inherit;">Mengikuti filosofi pemantauan ini diinginkan, ini merupakan titik awal yang baik untuk membuat atau merevisi metodologi peringatan dan dapat membantu mengajukan pertanyaan yang tepat untuk layanan operasi terlepas dari ukuran organisasi Anda atau kompleksitas layanan atau sistem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat membuat aturan pemantauan dan peringatan dengan mengajukan pertanyaan berikut, Anda dapat menghindari kesalahan positif dan peringatan yang tidak perlu:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apakah aturan ini mendeteksi keadaan yang tidak terdeteksi dari sistem yang mendesak, menyerukan tindakan dan pasti mempengaruhi pengguna? </font></font></li><li>      , ,   ?               ? </li><li>    ,     ?   ,      , , -       ,     ? </li><li>          ?           ?     ?          ? </li><li>        ,      ? </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pertanyaan-pertanyaan ini mencerminkan filosofi dasar peringatan dan sistem peringatan: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap kali peringatan tiba, saya harus segera merespons. </font><font style="vertical-align: inherit;">Saya bisa bereaksi beberapa kali sehari sebelum merasa lelah.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Setiap peringatan harus relevan. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap respons terhadap peringatan harus memerlukan intervensi manusia. </font><font style="vertical-align: inherit;">Jika lansiran dapat diproses secara otomatis, peringatan itu seharusnya tidak datang.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lansiran harus tentang masalah atau peristiwa baru yang tidak ada sebelumnya. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pendekatan ini menghapus perbedaan-perbedaan tertentu: jika notifikasi memenuhi empat kondisi sebelumnya, tidak masalah apakah notifikasi dikirim dari sistem pemantauan White-box atau Black-Box. </font><font style="vertical-align: inherit;">Pendekatan ini juga memperkuat perbedaan-perbedaan tertentu: lebih baik menghabiskan lebih banyak upaya untuk mengidentifikasi gejala daripada penyebabnya; </font><font style="vertical-align: inherit;">ketika datang ke alasan, Anda hanya perlu khawatir tentang alasan yang tak terhindarkan.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemantauan jangka panjang </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam lingkungan produktif saat ini, sistem pemantauan melacak sistem produktif yang terus berkembang dengan arsitektur perangkat lunak yang berubah, karakteristik muatan, dan kinerja target. Lansiran yang saat ini sulit diotomatisasi dapat menjadi kejadian yang sering, bahkan mungkin layak untuk diselesaikan. Pada titik ini, seseorang harus menemukan dan menghilangkan akar penyebab masalah; jika izin seperti itu tidak memungkinkan, respons terhadap notifikasi memerlukan otomatisasi penuh.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penting bahwa keputusan pemantauan dibuat dengan tujuan jangka panjang dalam pikiran. </font><font style="vertical-align: inherit;">Setiap peringatan yang dilakukan hari ini mengalihkan perhatian seseorang dari perbaikan sistem besok, sehingga sering kali ada penurunan ketersediaan atau produktivitas sistem produktif pada saat yang diperlukan untuk meningkatkan sistem pemantauan dalam jangka panjang. </font><font style="vertical-align: inherit;">Mari kita lihat dua contoh yang menggambarkan fenomena ini.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bigtable SRE: Alert History </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Infrastruktur internal Google biasanya disediakan dan diukur berdasarkan tingkat layanan (SLO). Bertahun-tahun yang lalu, layanan SLO Bigtable didasarkan pada kinerja rata-rata dari transaksi sintetis yang mensimulasikan klien yang bekerja. Karena masalah dalam Bigtable dan pada tingkat yang lebih rendah dari tumpukan penyimpanan data, kinerja rata-rata adalah karena ekor "besar": 5% permintaan terburuk seringkali jauh lebih lambat daripada yang lain.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pemberitahuan email dikirim saat mereka mendekati ambang SLO, dan peringatan ke messenger dikirim ketika SLO terlampaui. Kedua jenis lansiran dikirimkan cukup sering, menghabiskan waktu rekayasa yang tidak dapat diterima: tim menghabiskan banyak waktu untuk memilah lansiran untuk menemukan beberapa yang benar-benar relevan. Kami sering melewatkan masalah yang benar-benar memengaruhi pengguna, karena hanya beberapa lansiran yang khusus untuk masalah ini. Banyak peringatan tidak mendesak karena masalah yang dapat dipahami dalam infrastruktur dan bekerja dengan cara standar, atau tidak diproses sama sekali.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk memperbaiki situasi, tim mengambil pendekatan tiga cabang: sambil melakukan upaya besar untuk meningkatkan kinerja Bigtable, kami sementara menetapkan persentil ke-75 sebagai target SLO kami untuk menunda respons terhadap permintaan. </font><font style="vertical-align: inherit;">Kami juga mematikan peringatan email, karena ada begitu banyak dari mereka yang tidak mungkin menghabiskan waktu untuk mendiagnosisnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Strategi ini memungkinkan kami mengambil istirahat untuk mulai memperbaiki masalah jangka panjang di Bigtable dan tingkat yang lebih rendah dari tumpukan penyimpanan data, daripada terus-menerus memperbaiki masalah taktis. </font><font style="vertical-align: inherit;">Insinyur benar-benar bisa melakukan pekerjaan ketika mereka tidak terus-menerus diserang oleh peringatan. </font><font style="vertical-align: inherit;">Pada akhirnya, penundaan sementara dalam memproses pemberitahuan memungkinkan kami untuk meningkatkan kualitas layanan.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gmail: respons yang dapat diprediksi, algoritme dari orang-orang </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada awalnya, Gmail dibangun di atas sistem kontrol proses Workqueue yang dimodifikasi, yang dibuat untuk mengelompokkan fragmen indeks pencarian proses. Workqueue diadaptasi untuk proses yang berumur panjang dan selanjutnya diterapkan ke Gmail, tetapi beberapa kesalahan dalam kode scheduler buram ternyata sangat sulit untuk disembuhkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada saat itu, pemantauan Gmail disusun sedemikian rupa sehingga peringatan dipicu ketika tugas individu dibatalkan menggunakan Workqueue. Pendekatan ini tidak ideal, karena bahkan pada waktu itu Gmail melakukan ribuan tugas, yang masing-masing diberikan kepada sebagian kecil dari pengguna kami. Kami memastikan bahwa pengguna Gmail memiliki antarmuka pengguna yang baik, tetapi mengetahui begitu banyak peringatan tidak dapat dicapai.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mengatasi masalah ini, Gmail SRE menciptakan alat yang membantu men-debug penjadwal sebaik mungkin untuk meminimalkan dampak pada pengguna. Tim melakukan beberapa diskusi tentang apakah hanya perlu mengotomatiskan seluruh siklus dari mendeteksi masalah hingga menyelesaikannya sampai solusi jangka panjang ditemukan, tetapi beberapa dari mereka khawatir bahwa solusi seperti itu akan menunda koreksi masalah yang sebenarnya.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketegangan ini biasa terjadi di tim dan sering mencerminkan kurangnya kepercayaan diri dalam disiplin diri: sementara beberapa anggota tim ingin memberikan waktu untuk perbaikan yang benar, yang lain khawatir bahwa perbaikan terakhir akan dilupakan dan perbaikan sementara akan berlangsung selamanya. Masalah ini patut mendapat perhatian, karena terlalu mudah untuk memperbaiki masalah sementara, daripada harus memperbaiki situasi secara berkelanjutan. Manajer dan staf teknis memainkan peran kunci dalam menerapkan perbaikan jangka panjang, mendukung dan memprioritaskan perbaikan jangka panjang yang potensial, bahkan ketika "rasa sakit" reda awal.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lansiran berulang reguler dan respons algoritmik harus menjadi tanda bahaya. </font><font style="vertical-align: inherit;">Keengganan tim Anda untuk mengotomatiskan peringatan tersebut berarti bahwa tim tersebut kurang percaya diri bahwa mereka dapat mempercayai algoritme. </font><font style="vertical-align: inherit;">Ini adalah masalah serius yang perlu ditangani.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dalam jangka panjang </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tema umum menghubungkan contoh Bigtable dan Gmail: persaingan antara ketersediaan jangka pendek dan jangka panjang. </font><font style="vertical-align: inherit;">Seringkali, upaya yang kuat dapat membantu sistem yang rapuh mencapai ketersediaan tinggi, tetapi jalur ini biasanya berumur pendek, penuh dengan kelelahan tim dan ketergantungan pada sejumlah kecil anggota tim yang sangat heroik ini.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penurunan ketersediaan jangka pendek yang terkendali sering kali merupakan tugas yang menyakitkan tetapi secara strategis penting bagi stabilitas sistem jangka panjang. Penting untuk tidak mempertimbangkan setiap peringatan secara terpisah, tetapi untuk mempertimbangkan apakah tingkat peringatan secara keseluruhan mengarah pada sistem yang sehat dan dapat diakses dengan tim yang layak dan prognosis yang menguntungkan. Kami menganalisis statistik frekuensi peringatan (biasanya dinyatakan sebagai insiden shift, ketika sebuah insiden dapat terdiri dari beberapa insiden terkait) dalam laporan triwulanan dengan manajemen, yang memungkinkan pembuat keputusan untuk secara konstan menyajikan beban pada sistem peringatan dan keadaan umum tim.</font></font><br><br><h1>  Kesimpulan </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jalan menuju pemantauan dan peringatan yang sehat sederhana dan mudah. Ini berfokus pada gejala masalah yang dikeluarkan peringatan, dan memantau penyebabnya berfungsi sebagai bantuan untuk debug masalah. Memantau gejala semakin mudah, semakin tinggi Anda berada di tumpukan yang Anda kontrol, meskipun pemantauan beban basis data dan kinerja harus dilakukan langsung di atasnya. Pemberitahuan email memiliki manfaat yang sangat terbatas dan cenderung mudah menjadi bising; alih-alih, Anda harus menggunakan dasbor yang memantau semua masalah saat ini yang diemailkan. Dasbor juga dapat dipasangkan dengan log peristiwa untuk menganalisis korelasi historis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam jangka panjang, penting untuk mencapai pergantian lansiran yang sukses tentang gejala dan masalah nyata yang tak terhindarkan, menyesuaikan tujuan untuk memastikan bahwa pemantauan mendukung diagnosis cepat. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terima kasih telah membaca terjemahan sampai akhir. </font><font style="vertical-align: inherit;">Berlangganan saluran telegram saya tentang pemantauan </font></font><a href="https://t.me/monitorim_it"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@monitorim_it</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font></font><a href="https://medium.com/%40antonkasimov"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">blog di Medium</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484246/">https://habr.com/ru/post/id484246/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484224/index.html">Sortasi LSD Bitwise (Radix Sort)</a></li>
<li><a href="../id484236/index.html">Hantu di awan: detail peretasan banyak perusahaan</a></li>
<li><a href="../id484238/index.html">Pembelajaran mesin menghadapi masalah matematika yang belum terselesaikan</a></li>
<li><a href="../id484240/index.html">Menjadi pembicara di Positive Hack Days 10. Call For Papers Begins</a></li>
<li><a href="../id484244/index.html">Paul Graham pada Java dan Bahasa Pemrograman Peretas (2001)</a></li>
<li><a href="../id484248/index.html">Paul Graham: Tes Ketergantungan (The Island Test, 2006)</a></li>
<li><a href="../id484250/index.html">Paul Graham: Tentang Netralitas Politik dan Kemandirian Berpikir (Dua Jenis Moderat)</a></li>
<li><a href="../id484252/index.html">Antiquities: 20 tahun teknologi komputer dalam publikasi media</a></li>
<li><a href="../id484254/index.html">Bagaimana cara: infografis atau infografis?</a></li>
<li><a href="../id484270/index.html">Mari kita selesaikan sejumlah uang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>