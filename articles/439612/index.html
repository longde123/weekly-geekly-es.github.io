<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòë üç≠ üì£ JavaScript robusto: persiguiendo un mito üëÉüèæ ü¶â ü•§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JavaScript a menudo se llama el "lenguaje m√°s popular", pero parece que nadie habla del desarrollo de JS como "el m√°s seguro", y la cantidad de proble...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScript robusto: persiguiendo un mito</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/439612/">  JavaScript a menudo se llama el "lenguaje m√°s popular", pero parece que nadie habla del desarrollo de JS como "el m√°s seguro", y la cantidad de problemas al acecho en el ecosistema es grande.  ¬øC√≥mo sortearlos de manera efectiva? <br><br><img src="https://habrastorage.org/webt/pu/ak/kc/puakkce57lpd32kkdbinlj8ydoy.jpeg"><br><br>  <b>Ilya Klimov</b> pens√≥ en esto cuando el error fue muy costoso (literalmente), y como resultado hizo una presentaci√≥n en HolyJS.  Y dado que las opiniones de la audiencia resultaron ser excelentes, ahora hemos preparado una versi√≥n de texto de este informe para Habr.  Debajo del corte, tanto texto como video. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/o9zh5EHrpQA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Hola a todos  Mi nombre es Ilya Klimov, soy de Jarkov, Ucrania.  Tengo mi propia empresa de outsourcing peque√±a, de hasta diez personas.  Hacemos todo por lo que se paga dinero ... en el sentido, programamos en JavaScript en todos los sectores.  Hoy, hablando de JavaScript confiable, quiero compartir mis mejores pr√°cticas en alg√∫n lugar durante el a√±o pasado, ya que este tema comenz√≥ a molestarme bastante en serio. <br><br>  Quienes trabajan en outsourcing comprender√°n el contenido de la siguiente diapositiva: <br><br><img src="https://habrastorage.org/webt/ku/mi/7u/kumi7ucbxrai_oqdxwhwtqj84jk.png"><br><br>  Todo lo que hablaremos, por supuesto, no tiene nada que ver con la realidad.  Como dicen en South Park, todos los personajes est√°n mimados y son miserables.  Naturalmente, aquellos lugares donde hay una sospecha de violaci√≥n de la NDA se acordaron con representantes de los clientes. <br><br>  Nada afect√≥ mis pensamientos sobre la fiabilidad y similares como la base de mi propia empresa.  Cuando comienzas tu propia compa√±√≠a, de repente resulta que puedes ser un programador genial, puedes tener muchachos geniales, pero a veces suceden cosas incre√≠bles, un par de cosas imposibles y completamente locas. <br><br>  Tengo un proyecto educativo Ninja JavaScript.  A veces hago promesas.  A veces incluso los sigo.  Promet√≠ en 2017, como parte de un proyecto educativo, grabar un video sobre Kubernetes.  Me di cuenta de que hab√≠a hecho esta promesa y ser√≠a bueno cumplirla el 31 de diciembre.  Y me sent√© a grabar ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠ est√° el resultado</a> ). <br><br>  Como me gusta grabar videos lo m√°s cerca posible de la realidad, aprovech√© ejemplos de un proyecto real.  Como resultado, en el cl√∫ster de demostraci√≥n, implement√© una cosa que tom√≥ √≥rdenes reales de producci√≥n real y las puse en una base de datos de Kubernetes separada en mi cl√∫ster de demostraci√≥n. <br><br>  Como era el 31 de diciembre, parte de las √≥rdenes desaparecieron.  Desestimado por estacionalidad: todos fueron a tomar el t√©.  Cuando el cliente se despert√≥ alrededor del 12 al 13 de enero, el costo total del video fue de aproximadamente $ 500,000. Todav√≠a no he tenido una producci√≥n tan costosa. <br><br><img src="https://habrastorage.org/webt/lx/dd/rt/lxddrthxihl5_vzoqeadrnlrf60.png"><br><br>  Ejemplo n√∫mero dos: otro cl√∫ster de Kubernetes.  Infraestructura del ecosistema de nueva moda como un c√≥digo: todo lo que pueda se describe mediante c√≥digo y configuraciones, Kubernetes se contrae program√°ticamente desde los shells de JavaScript, etc.  Genial, a todos les gusta.  Un peque√±o cambio en el procedimiento de implementaci√≥n, y llega un momento en el que necesita implementar un nuevo cl√∫ster.  Surge la siguiente situaci√≥n: <br><br><pre><code class="plaintext hljs">const config = { // ‚Ä¶ mysql: process.env.MYSQL_URI || 'mysql://localhost:3306/foo' // ... }</code> </pre> <br>  Muchos de ustedes probablemente tambi√©n tengan esta l√≠nea de c√≥digo en sus configuraciones.  Es decir, tomamos la configuraci√≥n de la variable mysql o tomamos la base de datos local. <br><br>  Debido a un error tipogr√°fico en el sistema de implementaci√≥n, result√≥ que el sistema se configur√≥ nuevamente como producci√≥n, pero la base de datos MySQL utiliz√≥ una base de datos de prueba, local, que era para pruebas.  Esta vez se gast√≥ menos dinero, solo $ 300,000. Afortunadamente, esta no era mi empresa, sino el lugar donde trabajaba como consultor comprometido. <br><br><img src="https://habrastorage.org/webt/iv/r3/v8/ivr3v8a9frcey26kfj4czqpd4um.png"><br><br>  Puede pensar que todo esto no le concierne como front-end, porque habl√© sobre DevOps (por cierto, admiro el nombre de la conferencia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DevOops</a> , describe la esencia perfectamente).  Pero te contar√© sobre otra situaci√≥n. <br><br>  Hay un sistema que controla las epidemias veterinarias en Etiop√≠a, desarrollado bajo los auspicios de la ONU.  Contiene uno de los elementos de la interfaz cuando se trata de una persona, y √©l ingresa manualmente las coordenadas: cu√°ndo y d√≥nde hubo brotes de una determinada enfermedad. <br><br>  Hay un brote de fiebre aftosa regular (no soy fuerte en las enfermedades de las vacas), y el operador presiona accidentalmente el bot√≥n "agregar" dos veces, dejando los campos vac√≠os.  Como tenemos JavaScript, y JavaScript y los tipos son muy buenos, los campos vac√≠os de latitud y longitud con alegr√≠a conducen a coordenadas cero. <br><br>  No, no enviamos al m√©dico lejos al oc√©ano, pero result√≥ que todo esto se calcul√≥ previamente desde el punto de vista de la agrupaci√≥n para mostrar en el mapa, generar informes, an√°lisis, analizar la ubicaci√≥n de las personas en el backend.  Estamos tratando de unir los puntos de estallido. <br><br>  Como resultado, el sistema se paraliza durante el d√≠a, ya que el backend est√° tratando de calcular el cl√∫ster con la inclusi√≥n de este punto, todos los datos se vuelven irrelevantes, las √≥rdenes completamente irresponsables de la serie "drive 400 kilometros" llegan a los m√©dicos.  400 kil√≥metros en Etiop√≠a es un placer dudoso. <br><br>  La p√©rdida total estimada es de aproximadamente un mill√≥n de d√≥lares.  En el informe sobre esta situaci√≥n estaba escrito "Fuimos v√≠ctimas de un conjunto desafortunado de circunstancias".  ¬°Pero sabemos que el punto es JavaScript! <br><br><img src="https://habrastorage.org/webt/95/kt/wn/95ktwn6hubs5azwja9vopnkwydc.png"><br><br>  Y el √∫ltimo ejemplo.  Desafortunadamente, aunque esta historia fue hace mucho tiempo, todav√≠a no puedo nombrar la compa√±√≠a.  Pero esta es una compa√±√≠a que tiene su propia aerol√≠nea, sus propios hoteles, etc.  Ella trabaja muy interactivamente con las empresas, es decir, les proporciona una interfaz separada para reservar boletos, etc. <br><br>  Una vez que ocurri√≥ un accidente absurdo, llega una orden para reservar boletos de Nueva York a Los √Ångeles por un monto de 999,999 piezas.  El sistema de la compa√±√≠a compr√≥ felizmente todos los vuelos de su propia aerol√≠nea, descubri√≥ que no hab√≠a suficientes asientos y envi√≥ los datos al sistema internacional de reservas para compensar la escasez.  El sistema de reserva internacional, al ver una solicitud de aproximadamente 950,000 boletos, desconect√≥ felizmente a esta aerol√≠nea de su sistema. <br><br>  Dado que el cierre es un evento fuera de lo com√∫n, el problema se resolvi√≥ en siete minutos.  Sin embargo, en estos siete minutos, el costo de las multas que tuvieron que pagar fue de solo $ 100,000. <br><br><img src="https://habrastorage.org/webt/my/_b/eg/my_beg6zrauwag69rbbangiojgw.png"><br><br>  Afortunadamente, todo esto sucedi√≥ en m√°s de un a√±o.  Pero estos casos me hicieron pensar en problemas de fiabilidad y hacer dos preguntas originales en ruso: ¬øqui√©n tiene la culpa y qu√© hacer al respecto? <br><br><h2>  Por qu√© sucede esto: la juventud del ecosistema </h2><br>  Si analiza muchas historias, encontrar√° que hay m√°s historias sobre problemas similares con JavaScript que con otro lenguaje de programaci√≥n.  Esta no es mi impresi√≥n subjetiva, sino los resultados del an√°lisis inteligente de las noticias en Hacker News.  Por un lado, esta es una fuente hipster y subjetiva, pero, por otro lado, es bastante dif√≠cil encontrar una fuente sensata por fakap en el campo de la programaci√≥n. <br><br>  Adem√°s, hace un a√±o realic√© una competencia donde ten√≠a que resolver problemas algor√≠tmicos todos los d√≠as.  Como estaba aburrido, los resolv√≠ en JavaScript usando programaci√≥n funcional.  Escrib√≠ una funci√≥n completamente pura, y en el Chrome actual, funcion√≥ correctamente 1197 veces, y 3 veces produjo un resultado diferente.  Fue solo un peque√±o error en el optimizador TurboFan, que acaba de ingresar al Chrome principal. <br><br>  Por supuesto, se solucion√≥, pero usted comprende: esto significa, por ejemplo, que si sus pruebas unitarias pasaron una vez, esto no significa en absoluto que funcionar√°n en el sistema.  Es decir, ejecutamos c√≥digo aproximadamente 1197 veces, luego vino el optimizador y dijo: ‚Äú¬°Guau!  Caracter√≠stica caliente!  Optimic√©moslo ".  Y en el proceso de optimizaci√≥n llev√≥ al resultado incorrecto. <br><br>  En otras palabras, podemos llamar a la juventud del ecosistema una de las primeras razones por las que esto sucede.  JavaScript es una industria bastante joven precisamente en el campo de la programaci√≥n seria, en los casos en que giran millones, donde el costo de un error se mide entre cinco y seis caracteres. <br><br>  Durante mucho tiempo, JavaScript fue percibido como un juguete.  Debido a esto (no porque no nos lo tomemos en serio), todav√≠a tenemos problemas con la falta de herramientas. <br><br>  Por lo tanto, para abordar esta raz√≥n, que es el principio fundamental fundamental de todo lo que hablar√© hoy, trat√© de formular las reglas de confiabilidad que podr√≠a imponer en mi empresa o transferir como consultor a otros.  Como dice el refr√°n, "la regla n√∫mero uno es no hablar de confiabilidad".  Pero m√°s en serio, entonces ... <br><br><h2>  Regla de confiabilidad n. ¬∞ 1: todo lo que se puede automatizar debe automatizarse </h2><br>  Incluyendo, por cierto, y la correcci√≥n ortogr√°fica: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text">  Regla de confiabilidad n. ¬∞ 1: todo lo que se puede automatizar debe automatizarse </div></div><br>  Todo comienza con las cosas m√°s simples.  Parece que todos han estado escribiendo Prettier durante mucho tiempo.  Pero solo en 2018, esto que todos usamos, bueno y s√≥lido, aprendi√≥ a trabajar con git add -p cuando agregamos parcialmente archivos al repositorio de git, y queremos formatear bien el c√≥digo, por ejemplo, antes de enviarlo al repositorio principal.  La utilidad realinstaged bastante conocida, que le permite verificar solo aquellos archivos que han sido modificados, tiene exactamente el mismo problema. <br><br><img src="https://habrastorage.org/webt/w4/oh/q_/w4ohq_h-hjm5l_hna1d616e86ne.png"><br><br>  Continuar jugando Captain Evidence: ESLint.  No preguntar√© qui√©n lo usa aqu√≠, porque no tiene sentido que toda la audiencia levante la mano (bueno, eso espero y no quiero decepcionarme).  Mejor levante la mano, ya que tienen sus propias reglas escritas personalizadas en ESLint. <br><br>  Dichas reglas son una de las formas muy poderosas de automatizar el desorden que ocurre en los proyectos donde las personas escriben en el nivel junior y similares. <br><br>  Todos queremos un cierto nivel de aislamiento, pero tarde o temprano surge una situaci√≥n: ‚ÄúMira, este ayudante Vasya vendi√≥ muy cerca en el directorio de su componente.  No lo sacar√© en com√∫n, entonces lo har√© ‚Äù.  La palabra m√°gica es "m√°s tarde".  Esto lleva al hecho de que no comienzan a aparecer dependencias verticales en el proyecto (cuando los elementos superiores conectan a los inferiores, los inferiores nunca trepan detr√°s de los superiores), pero el componente A depende del componente B, que se encuentra en una rama completamente diferente.  Como resultado, el componente A no se transporta tan f√°cilmente a otros componentes. <br><br>  Por cierto, expreso mi respeto por Alfa-Bank, tienen una biblioteca de componentes muy bien escrita en React, es un placer usarla precisamente en t√©rminos de dise√±o de la calidad del c√≥digo. <br><br>  La regla banal de ESLint, que realiza un seguimiento de d√≥nde importa las entidades, le permite aumentar significativamente la calidad del c√≥digo y guardar el modelo mental durante la revisi√≥n del c√≥digo. <br><br>  Ya estoy desde el punto de vista del mundo de los front-end de edad.  Recientemente, en la regi√≥n de Kharkov, una compa√±√≠a grande y seria, PricewaterhouseCoopers, ha completado un estudio, y la edad promedio del proveedor es de 24 a 25 a√±os.  Ya es dif√≠cil para m√≠ pensar en todo esto, quiero centrarme en la l√≥gica empresarial durante una revisi√≥n de solicitud de extracci√≥n.  Por lo tanto, me complace escribir las reglas de ESLint para no pensar en tales cosas. <br><br>  Parece que puede ajustar las reglas habituales para esto, pero la realidad generalmente molesta mucho m√°s, porque resulta que se necesitan algunos selectores de Redux desde el componente de reacci√≥n (desafortunadamente, todav√≠a est√° vivo).  Y estos selectores est√°n en alg√∫n lugar en una jerarqu√≠a completamente diferente, as√≠ que "../../../ ..". <br><br>  O, peor a√∫n, el alias de paquete web, que rompe aproximadamente el 20% de otras herramientas, porque no todos entienden c√≥mo trabajar con √©l.  Por ejemplo, mi amado Flow. <br><br>  Por lo tanto, la pr√≥xima vez antes de querer gru√±ir en un junior (y el programador tiene un pasatiempo favorito), piense si de alguna manera puede automatizar esto para no cometer errores en el futuro.  En un mundo ideal, por supuesto, escribir√°s instrucciones que nadie leer√° de todos modos.  Aqu√≠ est√°n los oradores de HolyJS, especialistas talentosos con gran experiencia, pero cuando se propuso elaborar las instrucciones para los oradores en un mitin interno, dijeron "s√≠, no lo leer√°n".  ¬°Y estas son las personas para tomar un ejemplo! <br><br>  Lo √∫ltimo del banalismo, y pasar al esta√±o.  Estas son herramientas para ejecutar ganchos de precompromiso.  Usamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">husky</a> , y no pude evitar insertar esta hermosa foto de husky, pero puedes usar otra cosa. <br><br><img src="https://habrastorage.org/webt/ko/88/la/ko88la3d2ueau_frtyqrgaxxwia.jpeg"><br><br>  Si crees que todo esto es muy simple, como dicen, espera mi cerveza, pronto descubriremos que todo es m√°s complicado de lo que piensas.  Algunos puntos m√°s: <br><br><h2>  Escribiendo </h2><br>  Si no est√° escribiendo TypeScript, es posible que desee pensarlo.  No me gusta TypeScript, tradicionalmente flujo de alto flujo, pero hablaremos de esto m√°s adelante, pero aqu√≠ desde la etapa promocionar√© la soluci√≥n convencional con disgusto. <br><br>  Por qu√©  El comit√© del programa TC39 recientemente tuvo una gran discusi√≥n sobre hacia d√≥nde va generalmente el idioma.  Llegaron a una conclusi√≥n muy divertida: en TC39 siempre hay un "cisne, c√°ncer y lucio", que arrastran la lengua en diferentes direcciones, pero hay una cosa que todos quieren y siempre es el rendimiento. <br><br>  TC39 extraoficialmente, en una discusi√≥n interna, emiti√≥ esta diatriba: "Siempre haremos JavaScript para que siga siendo productivo, y aquellos a quienes no les guste tomar√°n un lenguaje que se compila en JavaScript". <br><br>  TypeScript es una muy buena alternativa al ecosistema adulto.  No puedo dejar de mencionar mi amor por GraphQL.  Es realmente bueno, desafortunadamente, nadie permitir√° que se implemente en una gran cantidad de proyectos existentes donde ya tenemos que trabajar. <br><br><img src="https://habrastorage.org/webt/nd/rw/6w/ndrw6w8uthgi8ypqykbofmf7ez4.png"><br><br>  Ya hubo informes sobre GraphQL en la conferencia, por lo tanto, solo hay un golpe espec√≠fico para la cuesti√≥n de la confiabilidad: si usa, por ejemplo, Express GraphQL, cada vez que adem√°s de un resolutor espec√≠fico puede colgar ciertos validadores que le permiten ajustar los requisitos de valor en comparaci√≥n con tipos est√°ndar de GraphQL. <br><br>  Por ejemplo, me gustar√≠a que el monto de la transferencia entre dos representantes de algunos bancos sea positivo.  Porque a m√°s tardar ayer, la ventana emergente en mi banca por Internet anunci√≥ alegremente que ten√≠a -2 mensajes no le√≠dos del banco.  Y es como un banco l√≠der en mi pa√≠s. <br><br>  En cuanto a estos validadores, que imponen un rigor adicional: usarlos es una buena y buena idea, simplemente no los use como sugiere, por ejemplo, GraphQL.  Te encuentras muy apegado a GraphQL como plataforma.  Al mismo tiempo, la validaci√≥n que usted hace es necesaria en dos lugares al mismo tiempo: en el frontend antes de enviar y recibir datos, y en el backend. <br><br>  Regularmente tengo que explicarle al cliente por qu√© tomamos JavaScript y no el lenguaje X como back-end. Adem√°s, el lenguaje X suele ser alg√∫n tipo de PHP, y no hermoso Go y similares.  Debo explicar que podemos reutilizar el c√≥digo de la manera m√°s eficiente posible, incluso entre el cliente y el servidor, debido al hecho de que est√°n escritos en el mismo lenguaje de programaci√≥n.  Desafortunadamente, como muestra la pr√°ctica, a menudo esta tesis sigue siendo solo una frase en la conferencia y no encuentra encarnaci√≥n en la vida real. <br><br><h2>  Contratos </h2><br>  Ya he hablado sobre la juventud del ecosistema.  La programaci√≥n por contrato ha existido por m√°s de 25 a√±os como un enfoque principal.  Si escribe en TypeScript, tome io-ts, si escribe en Flow, como yo, tome el contrato escrito, y obtendr√° una cosa muy importante: la capacidad de describir contratos de tiempo de ejecuci√≥n de los cuales derivar tipos est√°ticos. <br><br><img src="https://habrastorage.org/webt/jl/fg/bj/jlfgbj0bbassazt6sztrtulh4qq.png"><br><br>  No hay peor para un programador que tener m√°s de una fuente de verdad.  Conozco personas que perdieron cantidades de cinco d√≠gitos en d√≥lares simplemente porque su tipo se describe en un lenguaje con tipeo est√°tico (usaron TypeScript; bueno, por supuesto, esto es solo una coincidencia) y el tipo de tiempo de ejecuci√≥n (parece haber usado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tcomb</a> ) Un poco diferente. <br><br>  Por lo tanto, el error no se detect√≥ en tiempo de compilaci√≥n, simplemente porque ¬øpor qu√© verificarlo?  No hubo pruebas unitarias para ello, porque fuimos verificados por un tipificador est√°tico.  No tiene sentido probar cosas que han sido verificadas por la capa a continuaci√≥n, todos recuerdan la jerarqu√≠a de prueba. <br><br>  Debido al hecho de que la sincronizaci√≥n entre estos dos contratos se rompi√≥ con el tiempo, un d√≠a se realiz√≥ una transferencia incorrecta a la direcci√≥n que se dirigi√≥ a la direcci√≥n incorrecta.  Como era una criptomoneda, es imposible revertir una transacci√≥n un poco m√°s que en principio.  Nadie volver√° a bifurcar el aire por tu bien.  Por lo tanto, los contratos y las interacciones en la programaci√≥n de contratos son las primeras cosas que debe comenzar a hacer ma√±ana. <br><br><h2>  Por qu√© sucede esto: aislamiento </h2><br>  El siguiente problema es el aislamiento.  Es multifac√©tico y multifac√©tico.  Cuando trabajaba para un hotel y una compa√±√≠a de viajes a√©reos, ten√≠an una aplicaci√≥n en Angular 1. Eso fue hace mucho tiempo, as√≠ que es excusable.  Un equipo de 80 personas trabaj√≥ en esta aplicaci√≥n.  Todo estaba cubierto de pruebas.  todo estuvo bien hasta que un buen d√≠a hice mi funci√≥n, no la congel√© y descubr√≠ que, durante las pruebas, romp√≠ lugares absolutamente incre√≠bles en el sistema que ni siquiera toqu√©. <br><br>  Result√≥ que tengo problemas con la creatividad.  Result√≥ que accidentalmente llam√© al servicio exactamente igual que otro servicio que exist√≠a en el sistema.  Como se trataba de Angular 1, y el sistema de servicio no estaba estrictamente escrito, pero se escrib√≠a de forma secuencial, Angular comenz√≥ a deslizar mi servicio con bastante calma en lugares completamente diferentes e, ir√≥nicamente, coincidieron un par de m√©todos para nombrar. <br><br>  Esto, por supuesto, no fue una coincidencia: usted comprende que si dos servicios reciben el mismo nombre, es probable que hagan lo mismo, m√°s o menos.  Era un servicio relacionado con el c√°lculo de descuentos.  Solo un m√≥dulo estaba ocupado calculando descuentos para clientes corporativos, y el segundo m√≥dulo con mi nombre estaba relacionado con el c√°lculo de descuentos en acciones. <br><br>  Obviamente, cuando la aplicaci√≥n es aserrada por 80 personas, esto significa que es grande.  La divisi√≥n de c√≥digo se implement√≥ en la aplicaci√≥n, y esto significa que la secuencia de conexi√≥n de los m√≥dulos depend√≠a directamente del viaje del usuario en el sitio.  Para hacerlo a√∫n m√°s interesante, sucedi√≥ que ni una sola prueba de extremo a extremo que prob√≥ el comportamiento y el paso del usuario por el sitio, es decir, un escenario empresarial espec√≠fico, detect√≥ este error.  Porque parece que nadie tendr√° que ponerse en contacto con ambos m√≥dulos de descuento al mismo tiempo.  Es cierto que esto paraliz√≥ por completo el trabajo de los administradores del sitio, pero con quienes no sucede. <br><br>  El problema de aislamiento est√° muy bien ilustrado por el logotipo de uno de los proyectos que resuelve parcialmente este problema.  Esta es Lerna <br><br><img src="https://habrastorage.org/webt/jz/nn/op/jznnopsczu0lbelfdl7o7py3hdu.png"><br><br>  Lerna es una excelente herramienta para administrar m√∫ltiples paquetes npm en un repositorio.  Cuando tienes un martillo en tus manos, todo se vuelve sospechosamente como un clavo.  Cuando tienes un sistema similar a Unix con la filosof√≠a correcta, todo se vuelve sospechosamente como un archivo.  Todo el mundo sabe que en los sistemas Unix todo es un archivo.  Hay sistemas donde se lleva al m√°s alto grado (casi dije "hasta el punto de lo absurdo"), como el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Plan 9</a> . <br><br>  Conozco organizaciones que, despu√©s de sintonizarse para garantizar la confiabilidad de una aplicaci√≥n gigante, se les ocurri√≥ una idea simple: todo es un paquete. <br><br><img src="https://habrastorage.org/webt/kj/xn/wb/kjxnwb2hkwnuqpxrpfjwmjysdde.png"><br><br>  Cuando saca alg√∫n elemento de funcionalidad, ya sea un componente u otra cosa, en un paquete separado, autom√°ticamente proporciona una capa de aislamiento.  Solo porque normalmente no puede llegar a otro desde un paquete.  Y tambi√©n porque el sistema de trabajar con paquetes que se recopilan en un √∫nico repositorio a trav√©s de npm-link o Yarn Workspaces es tan horrible e impredecible en t√©rminos de c√≥mo est√° organizado internamente que ni siquiera puede recurrir a un hack y conectar alg√∫n tipo de presentar a trav√©s de "node_modules algo", simplemente porque diferentes personas tienen todo en una estructura diferente.  Esto depende especialmente de la versi√≥n de Yarn.  All√≠, en una de las versiones, cambiaron por completo el mecanismo de c√≥mo Yarn Workspaces organiza el trabajo con paquetes. <br><br>  El segundo ejemplo de aislamiento para mostrar que el problema es multifac√©tico es el paquete que estoy tratando de usar en todas partes ahora, esto est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enganchado a cls</a> .  Es posible que conozca otro paquete que implementa lo mismo: este es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el almacenamiento local de continuaci√≥n</a> .  Resuelve un problema muy importante que, por ejemplo, los desarrolladores en PHP no enfrentan. <br><br>  Se trata de aislar cada solicitud espec√≠fica.  En PHP, tenemos, en promedio, en un hospital, todas las solicitudes est√°n aisladas, interactuando entre ellas solo si no usa perversiones como Shared Memory, no podemos, todo est√° bien, tranquilo, hermoso.  En esencia, cls-hook agrega lo mismo, permiti√©ndole crear contextos de ejecuci√≥n, poner variables locales en ellos y luego, lo m√°s importante, destruir autom√°ticamente estos contextos para que no contin√∫en consumiendo su memoria. <br><br>  cls-hooked   async_hooks,   node.js     ,         ,         .     ,      . <br><br>       ,  ,       node-. <br><br><h2>   #2:   ¬´¬ª     </h2><br>   ,     ,       .    ,  JavaScript ‚Äî  ,         .  grep-. <br><br>  Que es esto    vim.  ,      -     Language Server,     -  ‚Äî ,  , grep. ,    ,    .  grep-  ,             grep.  ,   ,  . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sequelize</a> .    ORM    .      user.getProjects().   ,    getProjects?    . <br><br><img src="https://habrastorage.org/webt/6l/fd/lr/6lfdlr9jixqedmscjsbh-0oow9k.png"><br><br>  ,         Sequelize,    ,       hasMany, belongsToMany.      ,     ,     ,          .      ,       . <br><br>      code review,       ,       .        .   ‚Äî     ,        . <br><br>       ,      : ¬´merge request  20  ‚Äî 30 , merge request  5000  ‚Äî looks good to me¬ª.   ,   . <br><br>     JavaScript Ninja  , , ,    junior-,          .    ¬´    react  redux¬ª,   8000  , 10 000 ¬ª    ,    ,    ¬´  ¬ª.  ,   ,   ¬´  ¬ª,    ,   merge request      . <br><br> ,  ,   merge request ,        ,      Linux.    ,      ,   -.       ,       git.  ,        .      ,  ,       .       . <br><br>        -    .       .    -     ,          ,   -                 . <br><br>  ,   .   Microsoft Surface     Linux,      .       ,                ,   .         -     . <br><br><h2>   :  </h2><br><img src="https://habrastorage.org/webt/5j/ll/p6/5jllp6invsz_lu02znea6kcsutu.png"><br><br>     ¬´   ¬ª,   ¬´  ¬ª.  ,          React.        React, Fiber ‚Äî  . <br><br>  ,  Fiber         (      OCaml)  JavaScript,       .    ,          .   ,   ‚Äî   ,    proposal,      JavaScript. Scheduler ‚Äî  proposal stage 0. <br><br>    ,  React  ,    -  .     , :  ,    DOM.       ‚Äî   .   ,    . <br><br><img src="https://habrastorage.org/webt/ow/x8/sg/owx8sgozgwsoqtfq7xwu9sfj0cs.png"><br><br>     ‚Äî Vue.js.     Vue?  ,    .    Vue,    ,  , . <br><br>    Vue       React. ,    Vue,      ,    React. <br><br>    . Vue  ,   state,  ,   state  ,           .   ,       . Vue      . <br><br>   .    ,   ,    Web Components  c  ,     ,           .    : ,    pop-up,   ,    ,      - .    ‚Äî . <br><br>  Vue     ‚Äî scoped slots.  ,        - .    scoped slot ‚Äî    ,      .         .  React        Render Proper: , .  Vue        ,         -. <br><br>        -,     Vue   .    Vue : ,   child-,   ,  scoped slots,  forceUpdate.    , child  .        . <br><br>  React         .   , , shouldComponentUpdate(),    .  Vue     ,    ,    , ,    .       .     Vue.   , -   . <br><br><img src="https://habrastorage.org/webt/9s/rz/j8/9srzj89ltostquesk9tsfal2lhu.png"><br><br>   ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jest</a> .     Facebook.              JavaScript: , , .     .      ,   . <br><br>   ,        ECMAScript 2015  .      ,       if,    require. Require   ,   . ,  ,    ,         . Jest    Babel   Require    . <br><br>            NGS-  Node,   proposal,     .        JavaScript    :   Require,   .    .    ,  Jest c NGS- ,       ,      .        ,   . <br><br>  ,        ,       -  .  ,     Inversion of Control   - Dependency Injection-. <br><br><h2> IoC/DI </h2><br> ,   ,       . Angular     IoC/DI.  React   ‚Ä¶ , ,  React  Vue?    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dan.church</a> ,   evan.church  . <br><br>  ,  ,    React      Dependency Injection,      -       .   Vue    inject  provide.            . <br><br>   ,      ,   .  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NestJS</a> .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">InversifyJS</a> .      TypeScript, , ,        JavaScript.      ,       . <br><br><img src="https://habrastorage.org/webt/h1/vv/vo/h1vvvodkm_2eaql6jpp3gvkucom.png"><br><br>   Typescript,    Inversify.    ,    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">inject</a> (TYPES.Weapon) katana: Weapon.   ,     ,    TYPES.Weapon   Weapon?  ‚Äî . <br><br>  ,     ,     ,  TypeScript ( Flow     )     ,    inject   dependency injection   runtime,       . <br><br>   ¬´ ¬ª?     Weapon   ,    , TypeScript   ,       .    TypeScript   ,    first-class citizen  JavaScript,    .      ,  ,   runtime         ,   katana    Weapon.   . <br><br>  - C++,    ,   ,  RTTI: run-time type information,        ,   .  C#  Java  reflection,     .  TypeScript,      ¬´    ¬ª, ,        RTTI. <br><br>   .   .  Vue  Vue 3  TypeScript,  ,   Vue    TypeScript ,    Microsoft: ¬´ ,      TypeScript,   ?¬ª ,    Vue, :      props,     this. ,    props   ,   this,   .   TypeScript      ,  . . <br><br>  Microsoft ,     :   Vue  ,   Angular,       .      ,     TypeScript.   React,       ,   . <br><br>    ,    .   ,      Dart,   mirrors,  ,  Flutter.     mirrors,  ,            ,          . <br><br>        Inversify,   Babel-,    ,    ,  ,   runtime-,  ,    . <br><br>     :          .     .   ,      ,   ,    .       ,  V8       . <br><br> V8     ,         .  ,   ,     V8,      ,   ,   .      ,    V8  ,      TypeScript. <br><br>          .   ,    ,     . <br><br><h2>   #3:     ¬´¬ª ,  ¬´¬ª </h2><br>      ¬´¬ª  ¬´¬ª ,   , ¬´¬ª ‚Äî  ,   .        ,       Vue,       . -  , -  props'    . <br><br>     .   typed-css-modules?    :   CSS,     CSS Modules,        . <br><br><img src="https://habrastorage.org/webt/18/h9/fq/18h9fqupckf_zd2eiolcp5hp2iq.png"><br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">typed-css-modules</a> ,      ,     css-,    . <br><br>       12    ,   CSS-     , .   11  12       undefined,   CSS- ,    ,         ,   ,   undefined, . <br><br><img src="https://habrastorage.org/webt/ye/6z/ce/ye6zceducqaloagkziotyb0imj8.png"><br><br> Yeoman   ,         ,           ,       .      ,    ,   .       Angular CLI,   Blueprints (,     Angular,      GDG SPB  ,   ,     ). <br><br><br><img src="https://habrastorage.org/webt/tw/jg/do/twjgdowdxvmve9mg3atzsjybwyu.png"><br><br>        Anguar   ,     ,   .                  . <br><br>   ,  ¬´¬ª   ,  ¬´¬ª ‚Äî  ,  .   ,  ¬´¬ª    ‚Äî  .       , ,   ,      ,  ,         ,       . <br><br>  ,     ‚Äî  .      junior',      ,      , ,        . ,  , React-       . <br><br>      , ,         ,      - ESLInt,  - ,    ,       . <br><br>    ,   ,   .     ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NestJS</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Sails.js</a> . <br><br><img src="https://habrastorage.org/webt/nf/2i/lb/nf2ilb8j60ed9k2dcamrhrplpfo.png"><br><br>  ,     ,      ,    ,  ,     -  -.      Sails    ORM,    . Waterline ‚Äî   ,   .    ,     Sails.js    .    blueprint ,         .     ,  ,      . <br><br><img src="https://habrastorage.org/webt/nt/ub/pg/ntubpgyvn13wei3p33cghdvswn0.png"><br><br>       Nest,     ‚Äî    ,     .    Dependency Injection,     ,      middleweight   . <br><br>        .  ,    ,     ,  ,     ,     : ¬´    -     ?¬ª <br><br>     Angular,  ‚Äî ,           ,       dependency injection,   ,   . <br><br>    - Vue (,       ),  ,      Vue   .        Vue,      -    ,    ‚Äî  Nest.  ,   ,   ,   ,  TypeScript. <br><br><img src="https://habrastorage.org/webt/ea/ua/3b/eaua3b85i-gqubkacbxmnezw1li.png"><br><br><h2>  :  </h2><br>    ,      JavaScript.        ,   ,    ,  ,       ,      . <br><br>  ‚Äî  ,        ,    ,    ,   ,    : -   .      -  ,     ‚Äî   . <br><br><img src="https://habrastorage.org/webt/tj/xo/lb/tjxolbyxbbbo3wkoc1uatgymvum.png"><br><br>   Grafana,   ,     ‚Äî  .   ,     -     ,    .       speech recognition API  Microsoft,   ,   ,    20  .    , ,   ,     -. <br><br><img src="https://habrastorage.org/webt/x9/ei/qi/x9eiqij5bshqlbginz5mhljvvs8.png"><br><br>   : CI/CD.   GitLab,    ,    .   GitLab,   ,   JavaScript-friendly environment    ,   ,       . <br><br>      . ,       ,         ‚Ä¶  ,  -. <br><br><img src="https://habrastorage.org/webt/mh/em/4t/mhem4twe6k_mqbnbzr56yak2cjw.png"><br><br> Blue/Green deployment:     -    ,   ,      .     , ,     ! <br><br><h2>      </h2><br><ul><li>  JavaScript  ,       ,    .      , ,        ,    JavaScript     GitHub.   ‚Äî   , ,  ,    . </li><li>   JavaScript   ,      (    ,     ).      ¬´  ,   ¬ª.          ,    .   DI     ,  ¬´    ?¬ª </li><li>           ,     .  TypeScript, Flow,    Rizen ‚Äî    ,      runtime exception,     ,   . <br><br>    ,   ‚Äî      -,           . </li></ul><br><blockquote>       HolyJS,  :    HolyJS  <b>24-25   </b> .   ‚Äî ,   ( MobX)    (   Chrome DevTools).      ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439612/">https://habr.com/ru/post/439612/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439602/index.html">La √©tica en el espacio digital: las reglas b√°sicas de las relaciones digitales internacionales</a></li>
<li><a href="../439604/index.html">¬øC√≥mo se organiza el c√≥digo de barras?</a></li>
<li><a href="../439606/index.html">Producci√≥n piloto de electr√≥nica por un precio m√≠nimo.</a></li>
<li><a href="../439608/index.html">Religi√≥n moderna: ¬øqu√© le dan Google, Facebook, Amazon y Apple a las personas?</a></li>
<li><a href="../439610/index.html">Como en mi veh√≠culo el√©ctrico Chevrolet Bolt, bajo garant√≠a, se reemplazaron dos m√≥dulos de bater√≠a y el tercero bajo monitoreo</a></li>
<li><a href="../439614/index.html">C√≥mo distinguir una buena reparaci√≥n de una mala, o c√≥mo en SRG hicimos una biblioteca Java multiproceso del analizador Tomit</a></li>
<li><a href="../439616/index.html">El resumen de proyectos de TI interesantes en Kickstarter No. 7</a></li>
<li><a href="../439618/index.html">PHP para principiantes. Conexi√≥n de archivo</a></li>
<li><a href="../439620/index.html">Comprensi√≥n de la asincron√≠a en JavaScript [Traducci√≥n de Sukhjinder Arora]</a></li>
<li><a href="../439624/index.html">¬øPor qu√© almacenar datos en √≥rbita?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>