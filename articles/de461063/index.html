<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👐🏽 👨🏻‍⚖️ 👩🏾‍🏫 Interaktion von R mit Datenbanken am Beispiel von Microsoft SQL Server und anderen DBMS 🙅🏿 🧑🏿‍🤝‍🧑🏼 👩🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Da der Löwenanteil der Geschäftsinformationen in Datenbanken gespeichert ist. In welcher Programmiersprache Sie auch schreiben, Sie müssen verschieden...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interaktion von R mit Datenbanken am Beispiel von Microsoft SQL Server und anderen DBMS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461063/"><p>  Da der Löwenanteil der Geschäftsinformationen in Datenbanken gespeichert ist.  In welcher Programmiersprache Sie auch schreiben, Sie müssen verschiedene Aktionen mit ihnen ausführen. </p><br><p>  In diesem Artikel werde ich über zwei Schnittstellen für die Arbeit mit Datenbanken in R sprechen. Die meisten Beispiele zeigen die Arbeit mit Microsoft SQL Server. Alle Codebeispiele funktionieren jedoch mit anderen Datenbanken, z. B. MySQL, PostgreSQL, SQLite, ClickHouse , Google BigQuery usw. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/925/a23/786/925a23786a89917d9a314a793545cbb1.jpg" alt="Bild"></p><a name="habracut"></a><br><h1 id="soderzhanie">  Inhalt </h1><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Software erforderlich</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DBI-Paket</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Liste der grundlegenden DBI-Funktionen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datenbankkonnektivität</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel für die Verbindung mit Microsoft SQL Server mithilfe des odbc-Pakets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel für die Verbindung mit Microsoft SQL Server mithilfe des RMSSQL-Pakets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">So verbergen Sie Datenbankkennwörter in R-Skripten</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tabellen erstellen und in die Datenbank schreiben</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daten aus einem DBMS lesen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Datenmanipulation in DBMS (DML)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Transaktionen im DBMS</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RODBC-Paket</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hauptmerkmale des RODBC-Pakets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein Beispiel für die Arbeit mit RODBC</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Transaktion</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fazit</a> </li></ul><br><h1 id="trebuemoe-programmnoe-obespechenie">  Software erforderlich </h1><br><p>  Um alle im Artikel beschriebenen Beispiele für die Arbeit mit dem DBMS zu wiederholen, benötigen Sie die folgende kostenlose Software: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sprache R</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RStudio-</a> Entwicklungsumgebung; </li><li>  Datenbankverwaltungssystem zur Auswahl: <br>  3.1.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microsoft SQL Server</a> <br>  3.2.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MySQL</a> <br>  3.3.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PostgreSQL</a> </li></ol><br><h1 id="paket-dbi">  DBI-Paket </h1><br><p> Das <code>DBI</code> Paket ist die beliebteste und bequemste Möglichkeit, mit Datenbanken in R zu interagieren. </p><br><p>  <code>DBI</code> bietet Ihnen eine Reihe von Funktionen, mit denen Sie Datenbanken verwalten können.  Um jedoch eine Verbindung zu Datenbanken herzustellen, müssen Sie zusätzliche Pakete installieren, die Treiber für verschiedene Datenbankverwaltungssysteme (DBMS) sind. </p><br><h3 id="spisok-osnovnyh-funkciy-dbi">  Liste der grundlegenden DBI-Funktionen </h3><br><ul><li>  <code>dbConnect</code> - Verbindung zur Datenbank; </li><li>  <code>dbWriteTable</code> - schreibt eine Tabelle in die Datenbank; </li><li>  <code>dbReadTable</code> - Laden einer Tabelle aus einer Datenbank; </li><li>  <code>dbGetQuery</code> - Laden des Ergebnisses der Abfrageausführung; </li><li>  <code>dbSendQuery</code> - Senden einer Abfrage an die Datenbank; </li><li>  <code>dbFetch</code> - Elemente aus einer Ergebnismenge extrahieren; </li><li>  <code>dbExecute</code> - Ausführung von Anforderungen zum Aktualisieren / Löschen / Einfügen von Daten in Tabellen; </li><li>  <code>dbGetInfo</code> - Anforderungsinformationen zum Ergebnis der Anforderung oder Verbindung; </li><li>  <code>dbListFields</code> - Anforderung einer Liste von Tabellenfeldern; </li><li>  <code>dbListTables</code> - eine Liste von Datenbanktabellen abfragen; </li><li>  <code>dbExistsTable</code> - Überprüfen <code>dbExistsTable</code> ob eine Tabelle in der Datenbank vorhanden ist. </li><li>  <code>dbRemoveTable</code> - Löscht eine Tabelle aus der Datenbank. </li><li>  <code>dbDisconnect</code> - Verbindung zur Datenbank trennen. </li></ul><br><h3 id="podklyuchenie-k-bazam-dannyh">  Datenbankkonnektivität </h3><br><p>  Um mit Datenbanken zu interagieren, müssen Sie zuerst eine Verbindung zu ihnen herstellen.  Abhängig von dem DBMS, mit dem Sie arbeiten möchten, benötigen Sie ein zusätzliches Paket. Nachfolgend finden Sie eine Liste der am häufigsten verwendeten. </p><br><ul><li>  <code>odbc</code> - Treiber für die Verbindung über die ODBC-Schnittstelle; </li><li>  <code>RSQLite</code> - Treiber für SQLite; </li><li>  <code>RMySQL</code> / <code>RMariaDB</code> - Treiber für MySQL und MariaDB; </li><li>  <code>RPostgreSQL</code> - Treiber für PosrtgreSQL; </li><li>  <code>bigrquery</code> - Treiber für Google BigQuery; </li><li>  <code>RClickhouse</code> / <code>clickhouse</code> - Treiber für ClickHouse; </li><li>  <code>RMSSQL</code> - Treiber für Microsoft SQL Server (MS SQL) ist <em>zum Zeitpunkt des Schreibens nur auf GitHub vorhanden</em> . </li></ul><br><p>  Das <code>DBI</code> Paket wird mit dem Basis-R-Paket geliefert, aber Pakete, die Datenbanktreiber sind, müssen mit dem Befehl <code>install.packages(" ")</code> Treibername <code>install.packages(" ")</code> installiert werden. </p><br><p>  Um Pakete von GitHub zu installieren, benötigen Sie außerdem ein zusätzliches Paket - <code>devtools</code> .  Beispielsweise wird das <code>RMSSQL</code> Paket derzeit nicht im Haupt-R-Paket-Repository veröffentlicht. Verwenden Sie den folgenden Code, um es zu installieren: </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><h4 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-odbc">  Ein Beispiel für die Verbindung mit Microsoft SQL Server mithilfe des odbc-Pakets </h4><br><p>  Bevor ein Paket in einer R-Sitzung verwendet werden kann, muss es zunächst über die <code>library(" ")</code> . </p><br><p>  Nicht ohne Grund habe ich Microsoft SQL Server als Haupt-DBMS ausgewählt, das die meisten Beispiele in diesem Artikel enthält.  Tatsache ist, dass dies eine ziemlich beliebte Datenbank ist, aber gleichzeitig noch keinen Treiber für die Verbindung von R auf CRAN veröffentlicht hat. </p><br><p>  Glücklicherweise verfügt SQL Server wie fast jede andere Datenbank über eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ODBC-</a> Schnittstelle (English Open Database Connectivity) für die Verbindung.  Es gibt eine Reihe von Paketen für die Verbindung zum DBMS über die ODBC-Schnittstelle in R.  Zuerst werden wir uns die Verbindung über das <code>odbc</code> Paket <code>odbc</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Einfache Datenbankverbindung über die ODBC-Schnittstelle</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   odbc install.packages("odbc") #   library(odbc) #   MS SQL con &lt;- dbConnect(drv = odbc(), Driver = "SQL Server", Server = "localhost", Database = "mybase", UID = "my_username", PWD = "my_password", Port = 1433)</code> </pre> </div></div><br><p>  In der Funktion <code>dbConnect()</code> müssen Sie die Funktion, die der Treiber für die Verbindung zum DBMS ( <code>odbc()</code> ) ist, als erstes Argument an <em>drv übergeben</em> .  Solche Funktionen werden normalerweise als DBMS bezeichnet und werden mit Paketen geliefert, die Treiber für <code>DBI</code> . </p><br><p>  Als nächstes müssen Sie die Verbindungsparameter auflisten.  Um über ODBC eine Verbindung zu MS SQL herzustellen, müssen Sie die folgenden Parameter angeben: </p><br><ul><li>  Treiber - Name des ODBC-Treibers; </li><li>  Server - IP-Adresse des SQL Servers; </li><li>  Datenbank - Der Name der Datenbank, zu der eine Verbindung hergestellt werden soll. </li><li>  UID - Datenbankbenutzername; </li><li>  PWD - Passwort; </li><li>  Port - Der Port, zu dem mit SQL Server eine Verbindung hergestellt werden soll. Der Standardport ist 1433. </li></ul><br><p>  Ein ODBC-Treiber für die Verbindung mit Microsoft SQL Server ist in Windows enthalten, kann jedoch einen anderen Namen haben.  Sie können die Liste der installierten Treiber im ODBC-Datenquellenadministrator anzeigen.  Sie können den Datenquellenadministrator in Windows 10 folgendermaßen starten: </p><br><ul><li>  32-Bit-Version: <code>%systemdrive%\Windows\SysWoW64\Odbcad32.exe</code> </li><li>  64-Bit-Version: <code>%systemdrive%\Windows\System32\Odbcad32.exe</code> </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c6c/816/934/c6c816934a70e2386a4547d7626d515f.png"></p><br><p>  Mit der Funktion <code>odbcListDrivers()</code> können Sie auch eine Liste aller auf Ihrem PC installierten Treiber <code>odbcListDrivers()</code> . </p><br><pre> <code class="plaintext hljs"> name attribute value &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 SQL Server APILevel 2 2 SQL Server ConnectFunctions YYY 3 SQL Server CPTimeout 60 4 SQL Server DriverODBCVer 03.50 5 SQL Server FileUsage 0 6 SQL Server SQLLevel 1 7 SQL Server UsageCount 1 8 MySQL ODBC 5.3 ANSI Driver UsageCount 1 9 MySQL ODBC 5.3 Unicode Driver UsageCount 1 10 Simba ODBC Driver for Google BigQuery Description Simba ODBC Driver for Google BigQuery2.0 # ... with 50 more rows</code> </pre> <br><p>  Sie können ODBC-Treiber für andere DBMS unter den folgenden Links herunterladen: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MySQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PostgreSQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Bigquery</a> </li></ul><br><p>  Bei verschiedenen DBMS kann der Name der Verbindungsparameter unterschiedlich sein, z. B.: </p><br><ul><li>  PostgreSQL / MySQL / MariaDB - Benutzer, Passwort, Host, Port, Datenbankname; </li><li>  GoogleBigQuery - Projekt, Datensatz; </li><li>  ClickHouse - Benutzer, Passwort, Datenbank, Port, Host; </li></ul><br><p>  Mit dem ODBC-Datenquellenadministrator können Sie den Assistenten ausführen, um eine ODBC-Datenquelle zu erstellen.  Öffnen Sie dazu einfach den Administrator, wechseln Sie zur Registerkarte "Benutzerdefinierter DSN" und klicken Sie auf die Schaltfläche "Hinzufügen ...". </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9ae/e92/ba3/9aee92ba30bdc8de811623aae1fb58fa.png"></p><br><p>  Wenn Sie eine Datenquelle mit einem Administrator erstellen, geben Sie ihr den Namen DSN (Data Source Name). </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b03/a0c/a7c/b03a0ca7c90fa0d5bddccb53575563a3.png"></p><br><p>  Im obigen Beispiel haben wir eine Datenquelle mit dem DSN "my_test_source" erstellt.  Jetzt können wir diese Quelle verwenden, um eine Verbindung zu Microsoft SQL Server herzustellen, und keine anderen Verbindungsparameter im Code angeben. </p><br><div class="spoiler">  <b class="spoiler_title">Verbindung zur Datenbank über die ODBC-Schnittstelle über DSN</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password")</code> </pre> </div></div><br><p>  Mit der Funktion <code>odbcListDataSources()</code> können Sie die Namen aller auf Ihrem PC erstellten ODBC-Datenquellen <code>odbcListDataSources()</code> . </p><br><pre> <code class="plaintext hljs"> name description &lt;chr&gt; &lt;chr&gt; 1 BQ Simba ODBC Driver for Google BigQuery 2 BQ_main Simba ODBC Driver for Google BigQuery 3 BQ ODBC Simba ODBC Driver for Google BigQuery 4 OLX Simba ODBC Driver for Google BigQuery 5 Multicharts Simba ODBC Driver for Google BigQuery 6 PostgreSQL35W PostgreSQL Unicode(x64) 7 hillel_bq Simba ODBC Driver for Google BigQuery 8 blog_bq Simba ODBC Driver for Google BigQuery 9 MyClientMSSQL SQL Server 10 local_mssql SQL Server 11 MSSQL_localhost SQL Server 12 my_test_source SQL Server 13 Google BigQuery Simba ODBC Driver for Google BigQuery</code> </pre> <br><h3 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-rmssql">  Ein Beispiel für die Verbindung mit Microsoft SQL Server mithilfe des RMSSQL-Pakets </h3><br><p>  <code>RMSSQL</code> nicht auf CRAN veröffentlicht, daher können Sie es mit dem <code>devtools</code> Paket von GitHub installieren. </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Verbindungsbeispiel mit DBI RMSSQL-Treiber</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    library(RJDBC) library(RMSSQL) library(DBI) #  RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase")</code> </pre> </div></div><br><p>  In den meisten Fällen stellen Sie auf diese Weise eine Verbindung her, wenn Sie das <code>DBI</code> Paket für die Arbeit mit Datenbanken verwenden.  Das heißt,  Installieren Sie eines der erforderlichen Treiberpakete, und übergeben Sie die Funktion <code>dbConnect</code> als Wert des Argumentes <em>drv</em> , der Treiberfunktion für die Verbindung mit dem von Ihnen benötigten DBMS. </p><br><div class="spoiler">  <b class="spoiler_title">Ein Beispiel für die Verbindung zu MySQL, PostgreSQL, SQLite und BigQuery</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   MySQL library(RMySQL) con &lt;- dbConnect(MySQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   SQLite library(RSQLite) # connection or create base con &lt;- dbConnect(drv = SQLite(), "localhost.db") #   Google BigQuery library(bigrquery) con &lt;- dbConnect(drv = bigquery(), project = "my_proj_id", dataset = "dataset_name")</code> </pre> </div></div><br><h3 id="kak-skryt-paroli-ot-bazy-dannyh-v-r-skriptah">  So verbergen Sie Datenbankkennwörter in R-Skripten </h3><br><p>  Oben habe ich einige Beispiele angegeben, mit denen eine Verbindung zu einer beliebigen Datenbank hergestellt werden kann, die jedoch ein Minus enthält. In dieser Form werden alle Datenbankzugriffe, einschließlich Kennwörter, als Text in den Skripten selbst gespeichert. </p><br><p>  Wenn alle Ihre Skripte ausschließlich lokal auf Ihrem PC bereitgestellt und ausgeführt werden und gleichzeitig durch ein Kennwort geschützt sind, liegt höchstwahrscheinlich kein Problem vor.  Wenn Sie jedoch mit jemandem auf demselben Server arbeiten, ist das Speichern von Kennwörtern aus den Datenbanken im Text Ihrer Skripte nicht die beste Lösung. </p><br><p>  Jedes Betriebssystem verfügt über ein Dienstprogramm zum Verwalten von Anmeldeinformationen.  Unter Windows ist dies beispielsweise der Anmeldeinformations-Manager.  Sie können das Kennwort, mit dem Sie über das <code>keyring</code> eine Verbindung zur Datenbank herstellen, zu diesem Repository hinzufügen.  Das Paket ist plattformübergreifend und das obige Beispiel funktioniert unter jedem Betriebssystem, zumindest unter Windows, MacOS und Linux. </p><br><pre> <code class="plaintext hljs"># install.packages("keyring") #   library(keyring) library(RMSSQL) #   key_set_with_value(service = "mssql", username = "my_username", password = "my_password") #   RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = key_get("mssql", "my_username"), dbname = "mybase")</code> </pre> <br><p>  Das heißt,  Mit der Funktion <code>key_set_with_value()</code> fügen Sie dem Speicher für Anmeldeinformationen ein Kennwort hinzu, und mit <code>key_get()</code> es an. Nur der Benutzer, der es dem Geschäft hinzugefügt hat, kann ein Kennwort anfordern.  Mit dem <code>keyring</code> Sie Kennwörter nicht nur aus Datenbanken, sondern auch aus beliebigen Diensten sowie Autorisierungstoken speichern, wenn Sie mit der API arbeiten. </p><br><h3 id="sozdanie-tablic-i-zapis-v-bazu-dannyh">  Tabellen erstellen und in die Datenbank schreiben </h3><br><p>  Das Schreiben in die Datenbank wird von der Funktion <code>dbWriteTable()</code> . </p><br><p>  Argumente für die Funktion <code>dbWriteTable()</code> : </p><br><p>  <em>Erforderliche Argumente sind fett gedruckt, Kursivschrift ist optional</em> </p><br><ul><li>  <strong>conn</strong> - DBMS-Verbindungsobjekt, das mit der Funktion <code>dbConnect</code> ; </li><li>  <strong>name</strong> - der Name der Tabelle im DBMS, in die die Daten geschrieben werden; </li><li>  <strong>value</strong> - eine Tabelle (ein Objekt der Klasse data.frame / data.table / tibble_frame) in R, deren Daten in das DBMS geschrieben werden; </li><li>  <em>row.names</em> - Fügt der Tabelle eine row_names-Spalte mit Zeilennummern hinzu, <em>standardmäßig FALSE</em> . </li><li>  <em>überschreiben</em> - Überschreibt die Tabelle, wenn die Tabelle mit dem im Argument name angegebenen <em>Namen</em> bereits im DBMS vorhanden ist. <em>Der Standardwert ist FALSE</em> . </li><li>  <em>append</em> - Hängt Daten an, wenn eine Tabelle mit dem im Argument name angegebenen <em>Namen</em> bereits im DBMS vorhanden ist. <em>Der Standardwert ist FALSE</em> . </li><li>  <em>field.types</em> - Akzeptiert einen benannten Vektor und legt den Datentyp in jedem Feld beim Schreiben in das DBMS fest. Der <em>Standardwert ist NULL</em> . </li><li>  <em>temporär</em> - Ermöglicht das Erstellen temporärer Tabellen im DBMS, die verfügbar sind, bis die Verbindung zur Datenbank getrennt wird. <em>Der Standardwert ist FALSE</em> . </li></ul><br><div class="spoiler">  <b class="spoiler_title">Ein Beispiel für das Schreiben von Daten in ein DBMS über DBI</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #     DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     iris,         R  iris dbWriteTable(conn = con, name = "iris", value = iris) #     dbDisconnect(con)</code> </pre> </div></div><br><p>  Verwenden Sie zum <code>dbListTables()</code> Tabellen in der Datenbank die Funktion <code>dbListTables()</code> , um Tabellen zu löschen. <code>dbRemoveTable()</code> </p><br><div class="spoiler">  <b class="spoiler_title">Beispiel für das Abfragen einer Tabellenliste und das Löschen einer Tabelle aus einem DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #    dbListTables(con) #   iris dbRemoveTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="chtenie-dannyh-iz-subd">  Daten aus einem DBMS lesen </h3><br><p>  Mit <code>DBI</code> Sie entweder ganze Tabellen oder das Ergebnis der Ausführung Ihrer SQL-Abfrage abfragen.  Die Funktionen <code>dbReadTable()</code> und <code>dbGetQuery()</code> werden verwendet, um diese Operationen auszuführen. </p><br><div class="spoiler">  <b class="spoiler_title">Beispiel für die Abfrage einer Iris-Tabelle aus einem DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   iris   iris dbiris &lt;- dbReadTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Ein Beispiel für das Laden des SQL-Ausführungsergebnisses aus einem DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     setosa &lt;- dbGetQuery(con, "SELECT * FROM iris WHERE Species = 'setosa'") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="manipulirovanie-dannymi-v-subd-dml">  Datenmanipulation in DBMS (DML) </h3><br><p>  Die <code>dbGetQuery()</code> Funktion <code>dbGetQuery()</code> wird ausschließlich zum Abfragen von Datenproben (SELECT) verwendet. </p><br><p>  Für Datenmanipulationsvorgänge wie UPDATE, INSERT, DELETE ist die Funktion <code>dbExecute()</code> in <code>DBI</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Beispielcode zum Bearbeiten von Daten in einem DBMS</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   (INSERT) dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   (UPDATE) dbExecute(con, "UPDATE iris SET [Species] = 'old_value' WHERE row_names = 51") #     (DELETE) dbExecute(con, "DELETE FROM iris WHERE row_names = 51") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="tranzakcii-v-subd">  Transaktionen im DBMS </h3><br><blockquote>  Eine Transaktion ist eine sequentielle Lese- und Schreiboperation.  Das Ende einer Transaktion kann entweder das Speichern von Änderungen (Festschreiben, Festschreiben) oder das Abbrechen von Änderungen (Rollback, Rollback) sein.  In Bezug auf die Datenbank besteht eine Transaktion aus einer Reihe von Abfragen, die als einzelne Abfrage behandelt werden. </blockquote><p>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zitat aus dem Artikel "Transaktionen und die Mechanismen ihrer Kontrolle"</a></em> </p><br><p>  Eine Transaktion kapselt mehrere SQL-Anweisungen in einer Elementareinheit.  In <code>DBI</code> Start einer Transaktion mit <code>dbBegin()</code> initiiert und dann entweder mit <code>dbCommit()</code> bestätigt oder mit <code>dbCommit()</code> abgebrochen.  In jedem Fall garantiert das DBMS Folgendes: Entweder alle oder keine der Anweisungen werden auf die Daten angewendet. </p><br><p>  <em>Fügen Sie</em> während der Transaktion beispielsweise 51 Zeilen zur Iris-Tabelle hinzu, ändern <em>Sie</em> dann den Wert für <em>Sepal.Width</em> in 5 Zeilen und löschen Sie 43 Zeilen aus der Tabelle. </p><br><div class="spoiler">  <b class="spoiler_title">Beispiel für einen Transaktionscode</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbCommit(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5 8.0 1.4 0.2 setosa # 2 51 7 3.2 4.7 1.4 versicolor # 3 51 5 3.3 1.7 0.3 new_values</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Beispiel für einen Transaktionsstornierungscode</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbRollback(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor</code> </pre> </div></div><br><h1 id="paket-rodbc">  RODBC-Paket </h1><br><p>  Das <code>RODBC</code> Paket bietet eine eigenständige Schnittstelle zum Verbinden und Arbeiten mit einem DBMS über eine ODBC-Schnittstelle. </p><br><p>  <code>RODBC</code> nicht <code>DBI</code> kompatibel, d.h.  Sie können das mit <code>RODBC</code> erstellte <code>RODBC</code> in den vom <code>DBI</code> Paket bereitgestellten Funktionen verwenden. </p><br><h3 id="osnovnye-funkcii-paketa-rodbc">  Hauptmerkmale des RODBC-Pakets </h3><br><ul><li>  <code>odbcConnect</code> - Verbindung zum DBMS über DSN; </li><li>  <code>odbcDriverConnect</code> - Verbindung zur Datenbank über die Verbindungszeichenfolge; </li><li>  <code>sqlQuery</code> - Senden einer Abfrage an das DBMS und <code>sqlQuery</code> des Ergebnisses der Ausführung.  Unterstützt Abfragen aller Art: SELECT, UPDATE, INSERT, DELETE. </li><li>  <code>sqlFetch</code> - <code>sqlFetch</code> die gesamte Tabelle aus dem DBMS ab. </li><li>  <code>sqlTables</code> - <code>sqlTables</code> eine Liste der Tabellen in der Datenbank ab. </li><li>  <code>sqlSave</code> - Erstellen Sie eine neue Tabelle in der Datenbank oder fügen Sie einer vorhandenen Tabelle neue Daten hinzu. </li><li>  <code>sqlUpdate</code> - Aktualisieren von Daten in einer Tabelle, die bereits im DBMS vorhanden ist; </li><li>  <code>sqlDrop</code> - Löscht eine Tabelle in einem DBMS. </li><li>  <code>odbcClose</code> - <code>odbcClose</code> eine Verbindung zu einem DBMS. </li></ul><br><h3 id="primer-raboty-s-rodbc">  Ein Beispiel für die Arbeit mit RODBC </h3><br><p>  Aus meiner Sicht ist <code>RODBC</code> weniger funktional als <code>DBI</code> , verfügt jedoch über alle erforderlichen Funktionen für die Arbeit mit einem DBMS. </p><br><div class="spoiler">  <b class="spoiler_title">Ein Beispiel für die Interaktion mit einem DBMS über RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   con_string &lt;- odbcDriverConnect(connection = "Driver=SQL Server;Server=localhost;Database=mybase;UID=my_username;PWD=my_password;Port=1433") #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #     iris sqlSave(con_dsn, dat = iris, tablename = "iris", append = TRUE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #   sqlDrop(con_dsn, sqtable = "iris") #     odbcCloseAll()</code> </pre> </div></div><br><h1 id="tranzakcionnost">  Transaktion </h1><br><p>  Standardmäßig ist die Transaktionsfähigkeit in <code>RODBC</code> .  Das Transaktionsmanagement wird von zwei Funktionen ausgeführt. </p><br><ul><li>  <code>odbcSetAutoCommit</code> - <code>odbcSetAutoCommit</code> zwischen dem normalen und dem transaktionalen DBMS-Betriebsmodus. </li><li>  <code>odbcEndTran</code> - Bestätigen oder stornieren Sie eine Transaktion. </li></ul><br><p>  Das Ein- und Ausschalten des Transaktionsmodus erfolgt durch die Funktion <code>odbcSetAutoCommit</code> mit dem Argument <em>autoCommit</em> . </p><br><div class="spoiler">  <b class="spoiler_title">Beispiel für die Arbeit im Transaktionsmodus in RODBC</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #    odbcSetAutoCommit(con_dsn, autoCommit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #   odbcEndTran(con_dsn, commit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   odbcEndTran(con_dsn, commit = TRUE) #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     odbcClose(con_dsn)</code> </pre> </div></div><br><h1 id="zaklyuchenie">  Fazit </h1><br><p>  Die beiden im Artikel beschriebenen Methoden zum Arbeiten mit Datenbanken in den Sprachen R, <code>DBI</code> und <code>RODBC</code> sind recht universell und funktionieren mit fast jedem DBMS. </p><br><p>  Der einzige Unterschied im Betrieb zwischen verschiedenen DBMS ist der Verbindungsprozess.  Für die meisten gängigen DBMS gibt es separate Pakete, die Treiber sind.  Für den Rest des DBMS muss die Verbindung über die ODBC-Schnittstelle mithilfe von <code>odbc</code> oder <code>RODBC</code> .  Alle anderen Manipulationen, unabhängig von dem von Ihnen gewählten DBMS, bleiben unverändert.  Eine Ausnahme ist das Senden von SQL-Abfragen, abhängig vom SQL-Dialekt, der von dem DBMS unterstützt wird, mit dem Sie arbeiten. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de461063/">https://habr.com/ru/post/de461063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461053/index.html">Wir verbinden Online-Karten mit dem Navigator auf dem Smartphone. Teil 2 - Vektorkarten</a></li>
<li><a href="../de461055/index.html">Rekko Challenge 2019: wie es war</a></li>
<li><a href="../de461057/index.html">Telegrammkanäle zur Spieleentwicklung</a></li>
<li><a href="../de461059/index.html">Schreiben einer Android-App für Filmfans - Teil 1 (Prototyping)</a></li>
<li><a href="../de461061/index.html">Magnesiumlegierungen, Zwillingsgrenzen und Entmischung</a></li>
<li><a href="../de461067/index.html">Die 65 wichtigsten SQL-Fragen aus Vorstellungsgesprächen, auf die Sie 2019 vorbereitet sein sollten. Teil I.</a></li>
<li><a href="../de461069/index.html">Nobel-IP-Außenkameras: Tests, Technologien und Funktionen von Ivideon-Videoüberwachungssystemen</a></li>
<li><a href="../de461071/index.html">Optimierung von Datenbankabfragen am Beispiel eines B2B-Service für Builder</a></li>
<li><a href="../de461073/index.html">Wir verbinden Online-Karten mit dem Navigator auf dem Smartphone. Teil 3 - OverpassTurbo</a></li>
<li><a href="../de461075/index.html">Business Intelligence. IT-Objekte, Komponenten, Tools</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>