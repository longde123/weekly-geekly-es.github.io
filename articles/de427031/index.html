<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔟 👩🏿‍🎨 👩🏻‍🤝‍👨🏼 Automatisierung mit Codeception + Gherkin + PageObject für die Kleinsten 🤰🏼 👩‍🌾 ⏪</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nachdem ich kein einziges konkretes Beispiel für die Gherkin-Implementierung mit dem Seitenobjekt- Entwurfsmuster für Codeception im Internet gefunden...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisierung mit Codeception + Gherkin + PageObject für die Kleinsten</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427031/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/m3/sr/fwm3srs7ha0clnqekm-lbexd5sk.jpeg"></div><br>  Nachdem ich kein einziges konkretes Beispiel für die Gherkin-Implementierung mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Seitenobjekt-</a> Entwurfsmuster für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Codeception</a> im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Internet gefunden hatte</a> , dachte ich, dass es nicht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unangebracht</a> wäre, dem Internet von unserer eigenen Implementierung dieses Musters zu erzählen. <br><br>  Dieser Artikel richtet sich eher an Personen, die bereits ein wenig mit Codeception oder ähnlichen Frameworks vertraut sind, aber noch nicht wissen, wie sie Test Object verwenden können, um Tests lesbarer zu machen, ihre Unterstützung zu vereinfachen und die Menge an zusätzlichem Code zu reduzieren.  Trotzdem habe ich versucht, Schritt für Schritt alle wichtigen Punkte der Zusammenstellung des Automatisierungsprojekts von Grund auf zu erläutern. <br><a name="habracut"></a><br>  Mit der Seitenobjektvorlage können Sie die Arbeit mit Seitenelementen kapseln, wodurch Sie die Codemenge reduzieren und die Unterstützung vereinfachen können.  Alle Änderungen in der Benutzeroberfläche sind einfach und schnell zu implementieren. Aktualisieren Sie einfach die Seitenobjektklasse, die diese Seite beschreibt.  Ein weiterer wichtiger Vorteil dieses Architekturansatzes besteht darin, dass Sie das HTML-Testskript nicht mit Details überladen können, wodurch es verständlicher und einfacher zu verstehen ist. <br><br>  So sieht der Test ohne Verwendung von Page Object aus <br><br><img src="https://habrastorage.org/webt/8d/9v/qn/8d9vqnqtthsneoqsml5zqziabkc.png"><br><br>  Seitenobjekt verwenden <br><br><img src="https://habrastorage.org/webt/qa/zx/vj/qazxvjdq7qt6h24uxlpwpwmpuxo.png"><br><br>  Ich werde mich nicht mit der Installation der Basisumgebung befassen, sondern meine ersten Daten angeben: <br><br><ul><li>  Ubuntu bionischer Biber </li><li>  PHP 7.1.19-1 </li><li>  Composer - Abhängigkeitsverwaltungsmanager für PHP, global installiert </li><li>  PhpStorm - Entwicklungsumgebung </li></ul><br>  Um die Tests durchzuführen, benötigen wir außerdem: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Chromedriver 2.41</a> (der Link kann nicht nur herunterladen, sondern auch sehen, welcher Treiber zu Ihrer Chrome-Version passt) </li><li>  Chrome 67.0.3396.99 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Selenium-Server-Standalone-3.14.0</a> (Artikel zur Installation von Selenium auf Ubuntu) </li></ul><br><h4>  Erweitern Sie Codeception </h4><br>  Fahren Sie mit der Installation von Codeception fort: <br><br>  Wir öffnen im Terminal das Verzeichnis, in dem wir das Projekt sammeln, oder erstellen ein Verzeichnis für das Projekt und gehen dorthin: <br><br><pre><code class="bash hljs">mkdir ProjectTutorial <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ProjectTutorial</code> </pre> <br>  Installieren Sie das Codeception-Framework und seine Abhängigkeiten: <br><br><pre> <code class="bash hljs">composer require codeception/codeception --dev</code> </pre> <br><img src="https://habrastorage.org/webt/er/gc/df/ergcdf-_mg38pirctf7z0af7pt8.png"><br><br>  Die Installationsdatei für die Datei composer.json im Projekt sieht folgendermaßen aus: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"require"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"php"</span></span>: <span class="hljs-string"><span class="hljs-string">"&gt;=5.6.0 &lt;8.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"facebook/webdriver"</span></span>: <span class="hljs-string"><span class="hljs-string">"&gt;=1.1.3 &lt;2.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"behat/gherkin"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.4.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"codeception/phpunit-wrapper"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.0.9|^7.0.6"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"require-dev"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"codeception/codeception"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"codeception/base"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.5"</span></span> } }</code> </pre> <br>  Erweitern Sie das Projekt: <br><br><pre> <code class="bash hljs">php vendor/bin/codecept bootstrap</code> </pre> <br><img src="https://habrastorage.org/webt/5c/dy/td/5cdytd9w9s0ycaz8q65nbohmtvg.png"><br><br>  Weitere Informationen zur Installation des Projekts finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Dokumentation</a> . <br><br>  Zu diesem Zeitpunkt werden in unserem Projekt drei Testreihen erstellt.  Standardmäßig unterteilt Codeception sie in Akzeptanz, Funktion und Einheit.  Für diese Sets generiert Codeception außerdem drei yml-Dateien.  In ihnen geben wir alle notwendigen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konfigurationen an</a> , verbinden die Module und Eigenschaften, um unsere Tests durchzuführen. <br><br>  Diese Lektion basiert auf dem Beispiel des Abnahmetests, daher werde ich die Einstellungen in Acceptance.suite.yml angeben. <br><br>  Öffnen Sie unser Projekt in PHP Storm (oder einer anderen bevorzugten Entwicklungsumgebung) und gehen Sie zu <b>Acceptance.suite.yml</b> (standardmäßig befindet es sich im Ordner tests / accept.suite.yml). <br>  Wir schreiben die minimal notwendigen Abhängigkeiten auf und achten immer auf die Formatierung.  Die Module sind durch ein "-" gekennzeichnet und müssen sich auf derselben Ebene befinden. Andernfalls treten beim Teststart Fehler auf. <br><br>  Es stellt sich heraus: <br><br><pre> <code class="hljs pgsql">actor: AcceptanceTester modules: enabled: - WebDriver: url: <span class="hljs-string"><span class="hljs-string">'http://yandex.ru/'</span></span> //    ,        browser: <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> - \Helper\Acceptance //          gherkin: contexts: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: - AcceptanceTester</code> </pre> <br>  Und noch etwas Vorarbeit: <br><br>  Erstellen Sie ein separates Verzeichnis im Projektstamm (ich habe lib). <br>  Erstellen Sie in diesem Verzeichnis die ausführbare Datei run.sh, in der Selenium und Chrome Driver ausgeführt werden. <br><br>  Wir setzen hier Selenium und Chrome Driver und schreiben den Befehl run in run.sh: <br><br><pre> <code class="actionscript hljs">java -jar -Dwebdriver.chrome.driver=chromedriver_241 selenium-server-standalone<span class="hljs-number"><span class="hljs-number">-3.14</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>.jar</code> </pre> <br>  Wie es im Projekt aussieht: <br><br><img src="https://habrastorage.org/webt/cy/qn/pq/cyqnpqzz2puwryeomp2spafekfs.png"><br><br>  Wir kehren zur Konsole zurück und ändern die Zugriffsrechte: <br><br><pre> <code class="bash hljs">chmod +x ./run.sh</code> </pre> <br>  <i>(Hinweis. Die Namen der im Verzeichnis liegenden Treiber müssen genau mit den im Startbefehl angegebenen übereinstimmen.)</i> <br><br>  Sie können Selenium und Webdriver jetzt starten, um nicht darauf zurückzukommen.  Öffnen Sie dazu eine neue Registerkarte "Terminal", wechseln Sie in das Verzeichnis, in dem sich die Datei "run.sh" befindet, und schreiben Sie den Startbefehl: <br><br><pre> <code class="bash hljs">~/AutomationProjects/ProjectTutorial/lib$ ./run.sh</code> </pre> <br>  Stellen Sie sicher, dass der Server ausgeführt wird: <br><br><img src="https://habrastorage.org/webt/ux/uh/3c/uxuh3cft4npzg-3dtg81kylvvx8.png"><br><br>  Wir lassen es in einem laufenden Zustand.  Damit sind die Vorarbeiten abgeschlossen. <br><br><h4>  Schreiben eines Testskripts </h4><br>  Wir erstellen eine Feature-Datei für unseren Testfall.  Zu diesem Zweck wird in Codeception ein spezieller Befehl bereitgestellt. Führen Sie ihn in der Konsole aus: <br><br><pre> <code class="bash hljs">cept g:feature acceptance check</code> </pre> <br>  <i>(Hinweis "check" - der Name meines Tests)</i> <br><br>  Wir sehen die neue Datei check.feature im Akzeptanzordner. <br><br><img src="https://habrastorage.org/webt/rc/u4/78/rcu478xuheqd4kcdyogaqmudqu0.png"><br><br>  Wir brauchen den Standardinhalt nicht, wir löschen ihn sofort und schreiben unseren Test. <br><br>  Vergessen Sie nicht, das Skript mit #language: ru zu starten, damit der Sammler das kyrillische Alphabet erkennt. <br>  Wir schreiben ein kurzes Skript in russischer Sprache.  Ich erinnere Sie daran, dass jeder Satz mit den Schlüsselwörtern beginnen sollte: "Wann", "Dann", "Und", das Symbol "*" usw. <br><br>  Für mein Beispiel habe ich die Yandex-Website genommen, Sie können jede nehmen. <br><br><img src="https://habrastorage.org/webt/os/ov/tc/osovtc_rsa3drmoxchalhqsu1bu.png"><br><br>  Um zu sehen, welche Schritte der Test enthält, führen wir unser Skript im Terminal aus: <br><br><pre> <code class="bash hljs">cept dry-run acceptance check.feature</code> </pre> <br><img src="https://habrastorage.org/webt/tf/y8/b2/tfy8b2ochm_yqbp1mkpbnk-uwmo.png"><br><br>  Die Schritte des Skripts werden in der Konsole angezeigt, ihre Implementierung ist jedoch noch nicht verfügbar. <br><br>  Anschließend führen wir einen Befehl aus, der automatisch Vorlagen für die Implementierung unserer Methoden generiert: <br><br><pre> <code class="bash hljs">cept gherkin:snippets acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/a0/q6/_e/a0q6_efw3x0szqgsrx_6xwcxnhy.png"><br><br>  Alle Namen aus dem Skript, die in Anführungszeichen standen, werden durch Variablen ersetzt: arg. <br>  Wir kopieren sie vom Terminal und fügen sie in die Datei <b>AcceptanceTester.php ein</b> , in der die Methoden für die Arbeit mit Seitenelementen liegen. <br><br><img src="https://habrastorage.org/webt/ac/za/s3/aczas3m2n_53nrhw9abnefwgrww.png"><br><br>  Benennen Sie die Methoden in lesbare um, entsprechend ihrer Essenz (optional), und schreiben Sie ihre Implementierung. <br><br><img src="https://habrastorage.org/webt/u_/h9/pk/u_h9pkwslb6m31rcsldym5ckns8.png"><br><br>  Alles ist einfach, aber noch einfacher, wenn Sie in einer intelligenten Entwicklungsumgebung wie Storm arbeiten, die selbst die erforderlichen Befehle aus der Bibliothek anfordert: <br><br><img src="https://habrastorage.org/webt/ky/jp/1q/kyjp1qqvw3mhuwhjlfpnews6nhy.png"><br><br>  Wir entfernen den Überschuss und schreiben die Methoden: <br><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@When</span></span></span><span class="hljs-comment">      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_beingOnMainPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($page)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;amOnPage(<span class="hljs-string"><span class="hljs-string">'/'</span></span>); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :element */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_seeElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($element)</span></span></span><span class="hljs-function"> </span></span>{ this-&gt;seeElement($element); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :button */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_clickOnButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($button)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;click($button); } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    :field  :text */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_fillField</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($field, $text)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;fillField($field, $text); }</code> </pre> <br>  Mal sehen, was passiert ist.  Wir starten ein Team, das uns zeigt, welche Methoden (Schritt) wir jetzt implementieren. <br><br><pre> <code class="bash hljs">cept gherkin:steps acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/in/fr/sa/infrsa44-bbn5w7dv5npl76seu0.png"><br><br>  Erfolg! <br><br>  Die Schritte in der Feature-Datei werden jedoch immer noch nicht als Methoden erkannt. <br><br><img src="https://habrastorage.org/webt/sc/ng/dv/scngdvuysz8lx3uvma099_ttcwg.png"><br><br>  Damit Storm versteht, was mit den Schritten zu tun ist, führen wir einen Trick mit der Implementierung der Kontextschnittstelle aus dem Namespace Gherkin Context aus. <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> Behat\Behat\Context { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Context</span></span></span><span class="hljs-class"> </span></span>{} }</code> </pre> <br>  Wickeln Sie unsere AcceptanceTester-Klasse in einen Namespace und erben Sie von Context <br><br><pre> <code class="hljs tex">implements <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Behat</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Behat</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Context</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Context</span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/webt/g9/er/es/g9eresucfntsxrvvcg_p_w3b66o.png"><br><br>  Jetzt sind alle Schritte der Feature-Datei an ihre Implementierung gebunden: <br><br><img src="https://habrastorage.org/webt/fa/ja/jw/fajajwdnqmw5fepmypnohmhqgqa.png"><br><br>  Damit Webdriver versteht, worauf zu klicken ist und wo gesucht werden muss, müssen Sie die lesbaren Elementnamen und Seitenadressen durch die entsprechenden Locators und URLs ersetzen, die als Argumente in die Methoden fallen. <br><br>  Dann bekommen wir einen Test des Formulars: <br><br><img src="https://habrastorage.org/webt/dq/zi/vp/dqzivp0x5a7kgc7li0ltr_xnhtu.png"><br><br>  Und du kannst rennen: <br><br><pre> <code class="bash hljs">cept run acceptance</code> </pre> <br><img src="https://habrastorage.org/webt/ao/pu/ql/aopuqlvrkj5hdenn2nj-a326xri.png"><br><br>  Bestanden <br><br>  <i>ca.</i>  Wenn das Laden der Seitenelemente lange dauert, können Sie die Wartezeit zur gewünschten Methode hinzufügen: <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;waitForElementVisible($element);</code> </pre> <br>  Wir kehren zu unserem Testszenario zurück.  Wir sind verärgert darüber, dass die gesamte Lesbarkeit des Tests verloren geht, da anstelle der eindeutigen Namen der Elemente und Seiten HTML-Elemente und URLs angezeigt werden. <br><br>  Wenn wir dies beheben möchten, ist es Zeit, mit der Implementierung des Seitenobjektmusters fortzufahren. <br><br><h4>  Gehen Sie zu Seitenobjekt </h4><br>  Erstellen Sie im Verzeichnis _support das Seitenverzeichnis, in das wir unsere Klassenseiten einfügen: <br><br><pre> <code class="bash hljs">php vendor/bin/codecept generate:pageobject MainPage</code> </pre> <br>  Das erste Seitenobjekt ist die Hauptseite von Yandex. Nennen wir es MainPage. Wir werden die Klasse gleich nennen: <br><br><img src="https://habrastorage.org/webt/nj/ri/fr/njrifrqvws-yerkevm6jvcqefgi.png"><br><br>  Hier deklarieren wir statische Felder und Methoden, damit sie aufgerufen werden können, ohne ein Objekt zu erstellen. <br><br>  Da wir in den Konfigurationen von Acceptance.suite.yml bereits die URL der Startseite angegeben haben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">yandex.ru</a> , reicht es für die Hauptseite aus, diese anzugeben <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $URL = <span class="hljs-string"><span class="hljs-string">'/'</span></span>;</code> </pre> <br>  Als nächstes kommt eine Reihe von Seitenelementen.  Wir beschreiben Locators für verschiedene Elemente und geben ihnen klare und eindeutige Namen. <br><br>  Jetzt müssen Sie die Methode getElement hinzufügen, die den Locator mit dem Namen des Elements aus dem Array zurückgibt. <br><br>  Als Ergebnis haben wir: <br><br><pre> <code class="hljs powershell">&lt;?php //location: tests/_support/Page/MainPage.php namespace Page; /**   */ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainPage</span></span></span></span> { public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-variable"><span class="hljs-variable">$URL</span></span> = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-variable"><span class="hljs-variable">$elements</span></span> = array( <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@id='wd-wrapper-_afisha']"</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@data-statlog='afisha.title.link']"</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"//*[@class='weather__icon weather__icon_ovc']|//*[@class='weather__icon weather__icon_skc_d']"</span></span>, ); public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$name</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self::<span class="hljs-variable"><span class="hljs-variable">$elements</span></span>[<span class="hljs-variable"><span class="hljs-variable">$name</span></span>]; } }</code> </pre> <br>  Fügen Sie einige Seitenklassen hinzu: <br><br>  / ** Poster * / <br><br><img src="https://habrastorage.org/webt/ti/dw/pw/tidwpwbnw2jedklmo6tq8x83hey.png"><br><br>  / ** Poster - Suchergebnisse * / <br><br><img src="https://habrastorage.org/webt/b9/wf/zn/b9wfznt94mctpp1pognnwfn5u6i.png"><br><br>  Wir kehren zur Klasse <b>AcceptanceTester.php zurück</b> , in der wir unsere Methoden geschrieben haben. <br>  Erstellen wir darin ein Array von PageObject-Klassen, in denen wir den Seiten die Namen zuweisen und ihre Klassennamen im Namespace angeben: <br><br><pre> <code class="hljs php"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $pages = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">" "</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\MainPage"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\AfishaPage"</span></span>, <span class="hljs-string"><span class="hljs-string">" -  "</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"\Page\AfishaResult"</span></span> );</code> </pre> <br>  Jedes neue PageObject wird auf ähnliche Weise zu diesem Array hinzugefügt. <br><br>  Als Nächstes müssen wir das Feld currentPage erstellen, in dem der Link zum PageObject der aktuellen Seite gespeichert wird: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">private</span></span> <span class="hljs-variable"><span class="hljs-variable">$currentPage</span></span>;</code> </pre> <br>  Jetzt schreiben wir eine Methode. Wenn sie aufgerufen wird, können wir currentPage abrufen und die benötigte PageObject-Klasse initialisieren. <br><br>  Es ist logisch, einen solchen Schritt mit der Methode "Wenn der Benutzer zur Seite" Seitenname "navigiert" auszuführen.  Dann würde der einfachste Weg, die PageObject-Klasse ohne Prüfungen zu initialisieren, folgendermaßen aussehen: <br><br><pre> <code class="hljs powershell">/** * @When     :page */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_beingOn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$page</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { //   pageObject <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pages[<span class="hljs-variable"><span class="hljs-variable">$page</span></span>]; }</code> </pre> <br>  Jetzt schreiben wir die Methode getPageElement, mit der wir das Element bzw. seinen Locator von der aktuellen Seite abrufen können: <br><br><pre> <code class="hljs powershell">private <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPageElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$elementName</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { //         <span class="hljs-variable"><span class="hljs-variable">$curPage</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-variable"><span class="hljs-variable">$curPage::getElement</span></span>(<span class="hljs-variable"><span class="hljs-variable">$elementName</span></span>); }</code> </pre> <br><img src="https://habrastorage.org/webt/s-/ox/3i/s-ox3ijtg-riak5czcm-wb-lgfi.png"><br><br>  Bei bereits implementierten Methoden müssen die Argumente, die wir am Anfang direkt aus dem Feature-Text erhalten haben, durch Elemente von PageObject ersetzt werden, d. H. <br><br><pre> <code class="hljs perl">$arg</code> </pre> <br>  wird die Form annehmen <br><br><pre> <code class="hljs perl">getPageElement($arg))</code> </pre> <br>  Dann nehmen unsere Methoden die Form an: <br><br><pre> <code class="hljs powershell">/** * @When     :page */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_beingOnMainPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$page</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { //      pageObject <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pages[<span class="hljs-variable"><span class="hljs-variable">$page</span></span>]; <span class="hljs-variable"><span class="hljs-variable">$curPage</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;amOnPage(<span class="hljs-variable"><span class="hljs-variable">$curPage::</span></span><span class="hljs-variable"><span class="hljs-variable">$URL</span></span>); } /** * @Then    :element */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_seeElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$element</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;waitForElementVisible(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$element</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;seeElement(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$element</span></span>)); } /** * @Then    :button */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_clickOnButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$button</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;click(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$button</span></span>)); } /** * @Then    :field  :text */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_fillField</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$field</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$text</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;fillField(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>), <span class="hljs-variable"><span class="hljs-variable">$text</span></span>); } /** * @Then      :field */ public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_deleteText</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-variable"><span class="hljs-function"><span class="hljs-params"><span class="hljs-variable">$field</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;clearField(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getPageElement(<span class="hljs-variable"><span class="hljs-variable">$field</span></span>)); }</code> </pre><br>  Eine weitere Methode zum Anzeigen von Suchergebnissen durch Drücken der Eingabetaste wurde hinzugefügt: <br><br><pre> <code class="hljs php"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@Then</span></span></span><span class="hljs-comment">    ENTER */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step_keyboardButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pressKey(<span class="hljs-string"><span class="hljs-string">'//input'</span></span>,WebDriverKeys::ENTER); }</code> </pre> <br>  Der letzte Schritt ist, wenn alle erforderlichen Methoden und PageObjects beschrieben sind, müssen Sie den Test selbst umgestalten.  Fügen Sie die Schritte hinzu, mit denen PageObject beim Aufrufen einer neuen Seite initialisiert wird.  Wir haben diesen "* Benutzer ging zur Seite: Seite". <br><br>  Aus Gründen der Klarheit werde ich noch einige Schritte hinzufügen.  Das Ergebnis ist dieser Test: <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#language: ru :     :   .    .   .      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">  </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     ENTER      </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" -  "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"   "</span></span></span><span class="hljs-meta">       </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">     </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">" "</span></span></span><span class="hljs-meta">  </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">""</span></span></span><span class="hljs-meta">     ENTER</span></span></code> </pre><br>  Ein solches Testszenario ist für jeden Außenstehenden verständlich und lesbar. <br><br>  Starten Sie! <br><br>  Um ein detaillierteres Laufergebnis anzuzeigen, können Sie den Befehl verwenden <br><br><pre> <code class="bash hljs">cept run acceptance --debug</code> </pre> <br>  Wir schauen uns das Ergebnis an: <br><br><img src="https://habrastorage.org/webt/hj/qe/si/hjqesizorxxs8ekelolrqjoetkm.png"><br><br>  Mithilfe des Seitenobjektmusters können Sie daher alle Seitenelemente von Testskripten trennen und in einem separaten Verzeichnis speichern. <br><br>  Das Projekt selbst finden Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/Remneva/ProjectTutorial</a> <br><br>  Als beginnender Automatisierungsingenieur bin ich Ihnen dankbar, wenn Sie Ihre Ideen teilen und mir vielleicht sagen, wie ich die Projektstruktur so logisch wie möglich transformieren und vereinfachen kann. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427031/">https://habr.com/ru/post/de427031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427019/index.html">Data Halloween - eine Konferenz über die Möglichkeiten von Data Science für Unternehmen</a></li>
<li><a href="../de427021/index.html">Chrome 70 unterstützt [Funktionsliste] und AV1 - warum ist die Codec-Unterstützung so wichtig?</a></li>
<li><a href="../de427025/index.html">Fünf Steine ​​im Blockchain-Garten</a></li>
<li><a href="../de427027/index.html">Wo in der IT arbeiten, Ausgabe 2: SKB Kontur</a></li>
<li><a href="../de427029/index.html">Diagnose der Seneszenz</a></li>
<li><a href="../de427037/index.html">Sozialer Beweis</a></li>
<li><a href="../de427039/index.html">Voltmeter für Batterien: ein Taschengerät für ein Smartphone mit Krokodilen</a></li>
<li><a href="../de427041/index.html">Freitag. Bullshit Programmer 3.0</a></li>
<li><a href="../de427047/index.html">Schatz, wir töten Freitextinhalte</a></li>
<li><a href="../de427053/index.html">Freitag Hilfe: 5 Tools für einen Anfänger PHP-Entwickler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>