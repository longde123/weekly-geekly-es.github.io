<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤽🏽 👩🏻‍🚀 🤚🏼 Criando o VirtualBox para Windows 🌐 👨🏿‍🚒 🏇🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introdução 
 É um fato bem conhecido para muitos usuários da versão Windows do VirtualBox (a partir de agora, VB ; não deve ser confundido com o Visua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando o VirtualBox para Windows</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447300/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2f6/4c2/1ba/2f64c21bac5d7f0c050e7442bd08960e.png"></div><br><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Introdução </h4><br>  É um fato bem conhecido para muitos usuários da versão Windows do VirtualBox (a partir de agora, <em>VB</em> ; não deve ser confundido com o Visual Basic) que, começando com 4.3.14, os desenvolvedores adicionaram o chamado "reforço" projetado para evitar injeções maliciosas no VB.  Embora as intenções fossem boas, a implementação causou numerosos conflitos com produtos totalmente legítimos, como antivírus, módulos criptográficos e até algumas atualizações do próprio Windows, e quando esse conflito ocorre, o VB simplesmente para de funcionar.  Os usuários precisam esperar pelo menos um mês até que a nova versão do VB seja lançada com as exclusões apropriadas adicionadas.  O pior é que o aplicativo ou atualização conflitante deve ser desinstalado ou o próprio VB deve ser rebaixado para a versão 4.3.12, que foi a mais recente sem proteção.  Inúmeras solicitações para adicionar uma lista de exclusão controlada pelo usuário ou uma opção para desativar o fortalecimento são deixadas sem resposta.  A única resposta dos desenvolvedores soa como "se você não quiser, construa a partir do código-fonte".  Bem, parece que vamos precisar. <br><br>  Embora as instruções de compilação sejam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descritas</a> no Wiki oficial do projeto, elas estão incompletas e um pouco desatualizadas, enquanto o procedimento de compilação geralmente falha com vagas mensagens de erro.  Então, quando, no final, o fiz funcionar, pensei que valeria a pena documentar em detalhes todos os detalhes em um artigo separado.  Esta instrução está sendo atualizada periodicamente e, no momento, está adaptada para a criação do VB versão 6.0.4.  No entanto, se você precisar de informações sobre a criação de versões anteriores do VB ou de bibliotecas auxiliares, sempre poderá obtê-lo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">histórico de alterações</a> . <br><br><a name="habracut"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Sumário </h4><blockquote>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Declaração do Problema</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Uma palavra de advertência</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Preparação do ambiente de construção</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Peculiaridades de Instalação de Aplicativos</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toques Finais</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando o VirtualBox</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Epílogo</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alterações</a> <br></blockquote><br><a name="task"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Declaração do Problema </h4><br>  No começo, eu queria simplificá-lo, apenas reconstruindo os componentes binários e copiando-os na parte superior da versão instalada na distribuição oficial.  No entanto, isso parece estar longe de ser simples, porque a instalação depende de alguma API obscura do sistema e requer instalação de drivers e registro de componentes COM.  Eu me perguntava se era viável aprender como tudo isso funcionava e escrever um script para automatizar essas tarefas, mas, após algumas considerações, decidi aumentar e construir uma distribuição completa que fosse o mais próxima possível da oficial, apenas sem endurecimento. <br><br>  Devo dizer que essa tarefa se mostrou muito difícil e não consegui cumpri-la em 100%.  O que eu encontrei foram as Adições de Convidados, fornecidas para Windows (32 e 64 bits), OS / 2, Linux e alguns outros sistemas * NIX.  Os comentários no Makefile correspondente mencionam que todos eles são construídos em máquinas remotas diferentes, e eu definitivamente não estava ansioso para gerenciar uma fábrica de construção.  Portanto, minha solução final foi criar tudo a partir dos códigos-fonte, exceto os Additions, mas levar a imagem ISO oficial com eles e colocar na minha distribuição como está.  Não verifiquei se as adições têm o mesmo mecanismo de proteção, mas mesmo que nunca tenham ouvido alguma reclamação. <br><br><a name="warnings"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Uma palavra de aviso </h4><br><h5>  • Considerações de segurança </h5><br>  O endurecimento não foi adicionado por capricho, era uma solução para fechar uma vulnerabilidade no VB.  Infelizmente, a Oracle se recusa a fornecer a descrição detalhada do problema, mesmo que ele tenha sido corrigido há muitos anos.  Geralmente, ele tem algo a ver com o mecanismo de injeção de DLL no Windows que, no caso do VB, pode levar à elevação de privilégios não autorizados no computador host, e existem explorações de trabalho para esta vulnerabilidade.  Portanto, esteja avisado se você decidir usar a versão menos rígida de qualquer maneira. <br><br><h5>  • assinatura de drivers </h5><br>  A partir do Vista, nas versões de 64 bits do Windows, os usuários não podem mais carregar drivers arbitrários.  Os drivers devem ser assinados por um certificado com uma cadeia de certificados cruzados que vá até a CA raiz da Microsoft (e no Windows 10 com a Inicialização segura ativada, os drivers devem ser assinados pela própria Microsoft).  Antes de iniciar a jornada de construção do VB, você precisa decidir como resolver esse problema.  Você pode gastar algum dinheiro e comprar seu próprio certificado ou tentar entrar em contato com empresas terceirizadas que fornecem serviços de assinatura para projetos de código aberto (se eles concordarem em assinar drivers vulneráveis) ou definir seu Windows no modo de teste que permite carregar drivers assinado com um certificado de teste gerado localmente. <br><br>  No artigo, vou sugerir principalmente o último cenário, mas mencionarei como o procedimento muda se você tiver um certificado comercial "completo". <br><br><a name="environment"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Preparação do ambiente de construção </h4><br>  O guia oficial recomenda usar o Windows 7 a 10 como um sistema de compilação.  Fiz todo o trabalho no Windows 7 SP1 x64 e não acho que a versão do sistema operacional afete muito o procedimento.  Lembre-se de que a máquina (real ou virtual) que você usará para criar o VB deve ter conexão com a Internet. <br><br>  O ambiente de compilação requer várias ferramentas.  Se algum programa tiver uma versão portátil, prefiro usá-lo em vez de usar o instalador. <br><br>  Agora, os seguintes programas podem ser obtidos apenas como distribuições instaláveis ​​(pelo menos oficialmente).  Para o Visual Studio e SDK / WDK, é importante seguir a ordem de instalação conforme especificado abaixo.  Depois de terminar, recomendo executar o Windows Update e buscar as atualizações mais recentes para todos os produtos da Microsoft. <br><ul><li>  <b>Visual Studio 2010 Professional</b> <br>  Você precisa exatamente da versão 2010 e ela deve ser profissional ou superior.  A versão 2010 Express não possui ATL, necessária para criar a API COM, usada por todos os front-ends para comunicação.  Tentei mudar para o VS 2013 ou 2015 Community Edition para que não fosse um requisito ter um programa pago (que nem é mais vendido), mas falhou até agora. </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows SDK v7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Visual Studio 2010 SP1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atualização do compilador do Visual C ++ 2010 SP1 para SDK 7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Kit de Desenvolvimento de Driver do Windows (WDK) v7.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows SDK v8.1</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Activeperl</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ActivePython 2.7</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cygwin</a></b> </li></ul><br>  Os outros programas são baixados como arquivos portáteis ou códigos-fonte: <br><ul><li>  <b><a href="">Qt 5.6.3</a></b> (código fonte) </li><li>  <b>MinGW-w64 4.5.4</b> : <ul><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Versão de 32 bits</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Versão de 64 bits</a></b> </li></ul></li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SDL v1.2.x</a></b> (biblioteca de desenvolvimento para Visual C ++) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cURL</a></b> (código fonte) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenSSL 1.1.1</a></b> (código fonte) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">gSOAP 2.8.x</a></b> (versão 2.8.41 ou superior é recomendada) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">libvpx 1.7.0</a></b> (código fonte; versões mais recentes não suportam o VS 2010) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">libopus 1.3</a></b> (código fonte) </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MiKTeX Portable</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NASM</a></b> <br>  Eu recomendo usar a versão portátil de 64 bits. </li><li> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WiX</a></b> <br>  Eu recomendo usar o arquivo portátil (nomeado como <code>wix311-binaries.zip</code> ). </li></ul><br>  Você também precisará dos seguintes arquivos: <br><ul><li>  <b><a href="">DocBook XML DTD 4.5</a></b> </li><li>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Folhas de estilo DocBook XSL 1.69.1</a></b> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Para que você quer tudo isso?</b> <div class="spoiler_text">  Se você não quiser criar exatamente o mesmo pacote que eu, poderá se livrar de algumas das ferramentas mencionadas acima.  Então, aqui vou dar alguns detalhes para sua finalidade no processo de compilação. <br><br><ul><li>  <b>SDK 8.1</b> <br>  A compilação real é realizada usando o SDK 7.1, mas você precisará do programa SignTool da 8.1, porque a versão 7.1 não pode executar a assinatura dupla SHA-1 / SHA-256.  Se você tiver o SDK 8.1 instalado em outro lugar, basta copiar o <code>signtool.exe</code> com todas as suas dependências e especificar o caminho no arquivo <code>LocalConfig.kmk</code> (veja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">abaixo</a> ). </li><li>  <b>WiX</b> <br>  Essa é a estrutura para criar pacotes MSI.  Embora a distribuição final do VB seja um EXE, ela contém dois arquivos MSI, portanto, você precisa do WiX para construí-los.  No entanto, se você pretender criar apenas os arquivos binários do VB sem empacotá-los, poderá fazê-lo sem o WiX. </li><li>  <b>Sdl</b> <br>  Essa biblioteca é usada para um <code>VBoxSDL.exe</code> simplista adicional de front-end, que pode ser usado em vez do <code>VirtualBox.exe</code> .  Em teoria, se você não precisar desse componente, poderá executar a compilação sem ter SDL, mas eu não tentei isso. </li><li>  <b>gSOAP</b> <br>  Essa biblioteca é usada para criar o <code>VBoxWebSrv.exe</code> , serviço de gerenciamento remoto do VB.  Se você não possui o gSOAP, esse componente será ignorado silenciosamente durante a compilação. </li><li>  <b>libvpx</b> , <b>libopus</b> <br>  Estes são os codecs de vídeo e áudio usados ​​para gravar a tela da VM.  Se você não os tiver, a compilação ainda será concluída com êxito e o VB ainda terá todas as opções para captura de vídeo, mas essas opções serão ignoradas (mesmo que a animação da captura seja reproduzida, nenhuma gravação real será salva) . </li><li>  <b>Cygwin</b> <br>  Necessário para construir a libvpx. </li><li>  <b>MiKTeX</b> <br>  O MiKTeX é usado para compilar a documentação em PDF ( <code>doc\UserManual.pdf</code> ).  Sem esse programa, o PDF será omitido silenciosamente da construção e embalagem. </li><li>  <b>NASM</b> <br>  O assembler usado durante a construção do OpenSSL.  Você pode construí-lo também sem usar o assembler, mas eu ainda recomendo usá-lo para gerar um código mais otimizado. </li></ul></div></div><br>  Aqui está o resumo de todas as ferramentas e bibliotecas que estou usando, incluindo suas versões exatas (sempre que possível) e os caminhos de instalação que escolhi no meu sistema de compilação.  A designação " <code>{x32|x64}</code> " é usada para locais separados de instalação das versões de 32 e 64 bits. <table><tbody><tr><th>  Programa / ferramenta </th><th>  Versão </th><th>  Caminho da instalação </th></tr><tr><td>  Visual studio </td><td>  Profissional de 2010 </td><td> <code>C:\Program Files (x86)\Microsoft Visual Studio 10.0\</code> </td> </tr><tr><td>  SDK </td><td>  7.1 </td><td> <code>C:\Program Files\Microsoft SDKs\Windows\v7.1\</code> </td> </tr><tr><td>  SDK </td><td>  8.1 </td><td> <code>C:\Programs\DevKits\8.1\</code> </td> </tr><tr><td>  Wdk </td><td>  7.1.0 </td><td> <code>C:\WinDDK\7600.16385.1\</code> </td> </tr><tr><td>  Activeperl </td><td>  5.26.1 Build 2601 x64 </td><td> <code>C:\Programs\Perl\</code> </td> </tr><tr><td>  ActivePython </td><td>  2.7.14.2717 x64 </td><td> <code>C:\Programs\Python\</code> </td> </tr><tr><td>  WiX </td><td>  3.11.1.2318 </td><td> <code>C:\Programs\WiX\</code> </td> </tr><tr><td>  Qt </td><td>  5.6.3 </td><td> <code>C:\Programs\Qt\5.6.3-{x32|x64}\</code> </td> </tr><tr><td>  MinGW-32 </td><td>  4.5.4 </td><td> <code>C:\Programs\mingw32\</code> </td> </tr><tr><td>  MinGW-64 </td><td>  4.5.4 </td><td> <code>C:\Programs\mingw64\</code> </td> </tr><tr><td>  Cygwin </td><td>  - </td><td> <code>C:\Programs\cygwin64\</code> </td> </tr><tr><td>  Sdl </td><td>  1.2.15 </td><td> <code>C:\Programs\SDL\{x32|x64}\</code> </td> </tr><tr><td>  cURL </td><td>  7.64.1 </td><td> <code>C:\Programs\curl\{x32|x64}\</code> </td> </tr><tr><td>  Openssl </td><td>  1.1.1b </td><td> <code>C:\Programs\OpenSSL\{x32|x64}\</code> </td> </tr><tr><td>  gSOAP </td><td>  2.8.82 </td><td> <code>C:\Programs\gSOAP\</code> </td> </tr><tr><td>  libvpx </td><td>  1.7.0 </td><td> <code>C:\Programs\libvpx\</code> </td> </tr><tr><td>  libopus </td><td>  1.3 </td><td> <code>C:\Programs\libopus\</code> </td> </tr><tr><td>  MiKTeX Portable </td><td>  2.9.6942 </td><td> <code>C:\Programs\MiKTeX\</code> </td> </tr><tr><td>  NASM </td><td>  2.14.02 x64 </td><td> <code>C:\Programs\nasm\</code> </td> </tr><tr><td>  DocBook XML DTD </td><td>  4.5 </td><td> <code>C:\Programs\DocBook\xml\</code> </td> </tr><tr><td>  Folhas de estilo DocBook XSL </td><td>  1.69.1 </td><td> <code>C:\Programs\DocBook\xsl\</code> </td> </tr></tbody></table><a name="environment-inst"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Peculiaridades de Instalação de Aplicativos </h4><br>  Aqui, forneço algumas instruções sobre a instalação de algumas das ferramentas mencionadas acima, onde o procedimento não é óbvio ou requer ações adicionais. <br><br><h5>  • Windows SDK v7.1 </h5>  A instalação deste SDK provavelmente falhará porque inclui as versões desatualizadas das bibliotecas do compilador e do tempo de execução.  Depois de instalar o VS 2010, há versões mais novas das presentes no sistema, portanto, as mais antigas não são instaladas e o instalador principal considera um erro crítico.  Para contornar esse problema, desmarque as caixas de seleção correspondentes ou, antes da instalação do SDK, desinstale os pacotes denominados <i>"Microsoft Visual C ++ 2010 &lt;arch&gt; Redistributable"</i> , <i>"Microsoft Visual C ++ 2010 &lt;arch&gt; Runtime"</i> , <i>"Microsoft Compiladores Visual C ++ ... ”</i>  Deixe o SDK instalar as versões mais antigas e execute o Windows Update para obter as versões disponíveis mais recentes. <br><br>  Ao instalar o SDK, verifique as amostras do programa (Windows Native Code Development -&gt; Samples): elas contêm alguns scripts usados ​​pelas regras de criação do VB.  Sem eles, você não poderá criar os pacotes MSI. <br><br><h5>  • Windows SDK v8.1 </h5>  Você só precisa instalar o componente "Windows Software Development Kit". <br><br><h5>  • WDK v7.1 </h5>  Você só precisa instalar o componente "Build Ambientes". <br><br><h5>  • Qt 5.6.3 </h5>  A partir do Qt 5.7.0, para construí-lo, você precisa do Visual Studio 2012 ou posterior, por isso estamos presos ao 5.6.x. <br>  Como não há compilações oficiais para o Visual Studio 2010, teremos que construir o Qt a partir do código-fonte. <br><br><ol><li>  Descompacte o arquivo de código-fonte Qt em <code>C:\Programs\Qt\</code> e renomeie o diretório <code>qt-everywhere-opensource-src-5.6.3</code> para <code>5.6.3-src</code> . </li><li>  Ao lado, crie um diretório <code>build-x32</code> onde a compilação ocorrerá. </li><li>  Abra o console e execute os seguintes comandos para preparar o ambiente: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\Qt\build-x32 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTVER=<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTDIR=C:\Programs\Qt\<span class="hljs-variable"><span class="hljs-variable">%QTVER%</span></span>-x32 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%QTDIR%</span></span>\bin;<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QMAKESPEC=win32-msvc2010</code> </pre>  O comando <code>color</code> é opcional, ele se livra da cor verde que foi definida pelo script <code>SetEnv.Cmd</code> . </li><li>  Agora precisamos executar o script <code>configure.bat</code> partir da <code>5.6.3-src</code> .  O VB não usa grande parte do que o Qt inclui, portanto, podemos reduzir significativamente o tempo de compilação desativando vários componentes, mas observe que algumas opções são cruciais para o VB.  Particularmente, descobri que: <ul><li>  O OpenGL ES 2 não é suportado (ao criar o VB, o compilador falha ao encontrar alguns arquivos de cabeçalho). </li><li>  O suporte ao FreeType deve estar ativado (caso contrário, o plugin <code>qoffscreen</code> não será criado e é necessário para o VB). </li></ul>  Esta é a linha de comando completa com a qual acabei: <pre> <code class="dos hljs">..\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-src\configure.bat -prefix c:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x32 -mp -opensource -confirm-license -nomake tests -nomake examples -no-compile-examples -release -shared -pch -no-ltcg -accessibility -no-sql-sqlite -opengl desktop -no-openvg -no-nis -no-iconv -no-evdev -no-mtdev -no-inotify -no-eventfd -largefile -no-system-proxies -qt-zlib -qt-pcre -no-icu -qt-libpng -qt-libjpeg -qt-freetype -no-fontconfig -qt-harfbuzz -no-angle -incredibuild-xge -no-plugin-manifests -qmake -qreal double -rtti -strip -no-ssl -no-openssl -no-libproxy -no-dbus -no-audio-backend -no-wmf-backend -no-qml-debug -no-direct2d -directwrite -no-style-fusion -native-gestures -skip qt3d -skip qtactiveqt -skip qtandroidextras -skip qtcanvas3d -skip qtconnectivity -skip qtdeclarative -skip qtdoc -skip qtenginio -skip qtgraphicaleffects -skip qtlocation -skip qtmacextras -skip qtmultimedia -skip qtquickcontrols -skip qtquickcontrols2 -skip qtscript -skip qtsensors -skip qtserialbus -skip qtserialport -skip qtwayland -skip qtwebchannel -skip qtwebengine -skip qtwebsockets -skip qtwebview -skip qtx11extras -skip qtxmlpatterns</code> </pre> </li><li>  O caminho de instalação do Qt especificado aqui (na opção <code>-prefix</code> ) é codificado nos arquivos de código-fonte intermediários pelo script configure, para que os arquivos binários também se lembrem dele.  Qualquer aplicativo baseado em Qt criado usando esta biblioteca procurará primeiro os plug-ins necessários nesse caminho e, somente se não puderem ser encontrados, ele usará seu próprio local atual.  Na maioria dos casos, isso é bom, mas suponha que no computador em que o nosso VB esteja instalado, haja outra compilação do Qt localizada em <code>c:\Programs\Qt\5.6.3-x32</code> , mas compilada com opções diferentes ou por um compilador diferente?  Em seguida, o VB tentará carregar esses plugins (incompatíveis) e travará. <br>  Existem duas maneiras possíveis de evitar esse problema.  Primeiro, adicione à instalação um arquivo adicional chamado <code>qt.conf</code> com o seguinte texto: <pre> <code class="plaintext hljs">[Paths] Plugins=.</code> </pre>  A outra é corrigir o caminho de instalação salvo antes da criação do Qt, para que ele aponte para o diretório do aplicativo.  Decidi seguir pela última maneira, não gostei da idéia de ter arquivos adicionais para o que a distribuição Oracle VB possuía.  Você precisa abrir o arquivo <code>C:\Programs\Qt\build-x32\qtbase\src\corelib\global\qconfig.cpp</code> criado pelo script configure, localize a seguinte linha: <pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> qt_configure_prefix_path_str [<span class="hljs-number"><span class="hljs-number">512</span></span> + <span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-string"><span class="hljs-string">"qt_prfxpath=c:/Programs/Qt/5.6.3-x32"</span></span>;</code> </pre>  e substitua o caminho por um único ponto, para que esta linha fique assim: <pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> qt_configure_prefix_path_str [<span class="hljs-number"><span class="hljs-number">512</span></span> + <span class="hljs-number"><span class="hljs-number">12</span></span>] = <span class="hljs-string"><span class="hljs-string">"qt_prfxpath=."</span></span>;</code> </pre>  Essa alteração afetará apenas o comportamento do tempo de execução do VB.  A etapa de instalação do Qt em si usará o caminho original, porque agora está armazenado nos Makefiles que não modificamos. </li><li>  Em seguida, execute a construção usando o comando <code>nmake</code> </li><li>  E instale a biblioteca construída usando o <code>nmake install</code> </li></ol><br>  Agora abra uma nova janela do console e faça o mesmo para a versão de 64 bits.  Você precisará substituir "x32" por "x64" em todos os caminhos, e os comandos de preparação do ambiente terão a seguinte aparência: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\Qt\build-x64 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\Qt\build-x64 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTVER=<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QTDIR=C:\Programs\Qt\<span class="hljs-variable"><span class="hljs-variable">%QTVER%</span></span>-x64 <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%QTDIR%</span></span>\bin;<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> QMAKESPEC=win32-msvc2010</code> </pre> <br>  Após concluir a instalação, os diretórios <code>build-x32</code> , <code>build-x64</code> e <code>5.6.3-src</code> podem ser excluídos. <br><br><h5>  • MinGW </h5>  Simplesmente descompacte os arquivos de 32 e 64 bits nos respectivos diretórios de instalação. <br><br><h5>  • Cygwin </h5>  Durante a instalação, você precisa escolher os pacotes <code>make</code> e <code>yasm</code> . <br><br><h5>  • SDL </h5><ol><li>  Descompacte o arquivo SDL duas vezes em caminhos separados: <code>C:\Programs\SDL\x32\</code> e <code>C:\Programs\SDL\x64\</code> . </li><li>  Mova todo o conteúdo do subdiretório <code>C:\Programs\SDL\x64\lib\x64\</code> para o diretório pai (ou seja, em <code>C:\Programs\SDL\x64\lib\</code> ) e exclua os subdiretórios <code>C:\Programs\SDL\x64\lib\x86</code> e <code>x64</code> . </li><li>  Faça o mesmo para a versão de 32 bits: mova o conteúdo de <code>C:\Programs\SDL\x32\lib\x86\</code> para <code>C:\Programs\SDL\x32\lib\</code> e exclua <code>C:\Programs\SDL\x64\lib\x86</code> e <code>x64</code> . </li></ol><br><h5>  • NASM </h5>  Descompacte o archive <code>nasm-2.14.02-win64.zip</code> em <code>C:\Programs\</code> e renomeie o diretório resultante <code>nasm-2.14.02</code> como <code>nasm</code> . <br><br><h5>  • OpenSSL </h5><ol><li>  Descompacte o arquivo OpenSSL em <code>C:\Programs\OpenSSL\</code> duas vezes, renomeando as cópias do diretório <code>openssl-1.1.1b</code> como <code>openssl-1.1.1b-x32</code> e <code>openssl-1.1.1b-x64</code> . </li><li>  Abra o console, construa e instale a versão de 32 bits executando: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span>;C:\Programs\nasm <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\OpenSSL\openssl-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>b-x32\ perl Configure VC-WIN32 no-shared --prefix=C:\Programs\OpenSSL\x32 --openssldir=C:\Programs\OpenSSL\x32\ssl nmake nmake test nmake install</code> </pre>  Se a etapa de configuração emitir um aviso assustador sobre um compilador ausente, desconsidere esta mensagem, está mentindo escandalosamente. <br>  Se você não quiser usar o NASM, pule o comando com a modificação <code>PATH</code> e, para o script <code>Configure</code> especifique o parâmetro adicional <code>no-asm</code> . </li><li>  Agora abra uma nova janela do console e faça o mesmo para a versão de 64 bits: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-built_in"><span class="hljs-built_in">PATH</span></span>=<span class="hljs-variable"><span class="hljs-variable">%PATH%</span></span>;C:\Programs\nasm <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\OpenSSL\openssl-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>b-x64\ perl Configure VC-WIN64A no-shared --prefix=C:\Programs\OpenSSL\x64 --openssldir=C:\Programs\OpenSSL\x64\ssl nmake nmake test nmake install</code> </pre>  Desativar o NASM é o mesmo que em 32 bits. </li><li>  Agora você pode excluir os diretórios <code>C:\Programs\OpenSSL\openssl-1.1.1b-x32</code> e <code>openssl-1.1.1b-x64</code> . </li></ol><br><h5>  • cURL </h5><ol><li>  Descompacte o arquivo cURL em <code>C:\Programs\curl\</code> e renomeie o subdiretório resultante <code>curl-7.64.1</code> para <code>curl-7.64.1-x32</code> . </li><li>  Abra o arquivo <code>C:\Programs\curl\curl-7.64.1-x32\winbuild\MakefileBuild.vc</code> em um editor de texto e procure o seguinte bloco de código (ao redor das linhas No.61 a 69): <pre> <code class="plaintext hljs">!IF "$(VC)"=="6" CC_NODEBUG = $(CC) /O2 /DNDEBUG CC_DEBUG = $(CC) /Od /Gm /Zi /D_DEBUG /GZ CFLAGS = /I. /I../lib /I../include /nologo /W4 /wd4127 /GX /DWIN32 /YX /FD /c /DBUILDING_LIBCURL !ELSE CC_NODEBUG = $(CC) /O2 /DNDEBUG CC_DEBUG = $(CC) /Od /D_DEBUG /RTC1 /Z7 /LDd CFLAGS = /I. /I ../lib /I../include /nologo /W4 /wd4127 /EHsc /DWIN32 /FD /c /DBUILDING_LIBCURL !ENDIF</code> </pre>  Após essas linhas, adicione a nova diretiva: <pre> <code class="plaintext hljs">CFLAGS = $(CFLAGS) /DCURL_DISABLE_LDAP</code> </pre>  Caso contrário, a construção do VB falhará com erros de link. </li><li>  Agora abra o arquivo <code>C:\Programs\curl\curl-7.64.1-x32\winbuild\gen_resp_file.bat</code> e, após a primeira linha ( <code>@echo OFF</code> ), insira este comando: <pre> <code class="plaintext hljs">cd .</code> </pre>  Ele não faz nada, exceto redefinir o código <code>ERRORLEVEL</code> .  O script é tão simples que é possível concluir sem executar nenhum comando que altere o código de erro.  Portanto, se esse código for diferente de zero antes de iniciar o script, ele manterá seu valor na saída do script, e o <code>nmake</code> pensaria que foi o script que retornou esse código de erro e encerrou a compilação com falha.  A adição desse <code>cd</code> falso corrige o problema. </li><li>  Agora faça uma cópia completa do <code>curl-7.64.1-x32</code> sob o nome <code>curl-7.64.1-x64</code> . </li><li>  Abra o console, construa a versão de 32 bits e copie os arquivos que precisamos: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\curl\curl-<span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">64</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>-x32\winbuild <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\curl\x32 nmake /f Makefile.vc <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span>=static WITH_SSL=static DEBUG=no MACHINE=x86 SSL_PATH=C:\Programs\OpenSSL\x32 ENABLE_SSPI=no ENABLE_WINSSL=no ENABLE_IDN=no <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x86-release-static-ssl-static-ipv6\lib\libcurl_a.lib ..\..\x32\libcurl.lib <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /E ..\builds\libcurl-vc-x86-release-static-ssl-static-ipv6\include\curl ..\..\x32\include\curl\</code> </pre> </li><li>  Abra outra janela do console e construa a versão de 64 bits: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\curl\curl-<span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">64</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>-x64\winbuild <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\curl\x64 nmake /f Makefile.vc <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span>=static WITH_SSL=static DEBUG=no MACHINE=x64 SSL_PATH=C:\Programs\OpenSSL\x64 ENABLE_SSPI=no ENABLE_WINSSL=no ENABLE_IDN=no <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\lib\libcurl_a.lib ..\..\x64\libcurl.lib <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /E ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\include\curl ..\..\x64\include\curl\ <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ..\builds\libcurl-vc-x64-release-static-ssl-static-ipv6\bin\curl.exe ..\..\x64\curl.exe</code> </pre>  Observe que, além do que fizemos na versão de 32 bits, também <code>curl.exe</code> o arquivo <code>curl.exe</code> .  Nós o usaremos mais tarde, para baixar a imagem de adições de convidados. </li><li>  Os diretórios <code>C:\Programs\curl\curl-7.64.1-x32</code> e <code>curl-7.64.1-x64</code> não são mais necessários e podem ser removidos. </li></ol><br><h5>  Libvpx </h5><ol><li>  Descompacte o arquivo libvpx em <code>C:\Programs\libvpx-build\</code> . </li><li>  Inicie o terminal Cygwin, a compilação será realizada lá.  Nossa plataforma de destino é o Visual Studio 2010;  o sistema de compilação oferece suporte apenas parcialmente: ele tentará executar a compilação real usando o <code>msbuild.exe</code> mas não funciona por algum motivo;  Não consegui descobrir o porquê.  Em vez disso, podemos simplesmente executar o próprio Visual Studio e usá-lo para criar o projeto.  Felizmente, ele pode ser usado na linha de comando, portanto, não é necessário iniciar o IDE real (embora você possa, se desejar, nesse caso, você precisará modificar a variável <code>PATH</code> e adicionar o caminho <code>C:\Programs\cygwin64\bin</code> , ou de qualquer outra forma, permita que o VS encontre o <code>yasm.exe</code> localizado lá e necessário para a compilação).  Portanto, para executar a construção de ambas as arquiteturas, execute os seguintes comandos no terminal Cygwin: <pre> <code class="bash hljs">mkdir -p /cygdrive/c/Programs/libvpx-build/build32 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /cygdrive/c/Programs/libvpx-build/build32 ../libvpx-1.7.0/configure --target=x86-win32-vs10 --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-install-bins --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-examples --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-tools --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-docs --prefix=../../libvpx make <span class="hljs-string"><span class="hljs-string">"/cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/devenv.com"</span></span> vpx.sln /Project vpx.vcxproj /Rebuild <span class="hljs-string"><span class="hljs-string">"Release|Win32"</span></span> make install mkdir -p /cygdrive/c/Programs/libvpx-build/build64 <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /cygdrive/c/Programs/libvpx-build/build64 ../libvpx-1.7.0/configure --target=x86_64-win64-vs10 --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-install-bins --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-examples --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-tools --<span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-docs --prefix=../../libvpx make <span class="hljs-string"><span class="hljs-string">"/cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/Common7/IDE/devenv.com"</span></span> vpx.sln /Project vpx.vcxproj /Rebuild <span class="hljs-string"><span class="hljs-string">"Release|x64"</span></span> make install</code> </pre> </li><li>  Feche o Cygwin, não precisaremos mais dele.  O diretório <code>C:\Programs\libvpx-build</code> pode ser removido. </li></ol><br><h5>  Libopus </h5><ol><li>  Descompacte o arquivo opus em <code>C:\Programs\libopus-build\</code> , vá para o subdiretório <code>opus-1.3\win32\VS2015</code> . </li><li>  Este projeto foi desenvolvido para a versão mais recente do Visual Studio, portanto, precisamos modificá-lo para compilá-lo em nossa versão 2010. Você pode fazê-lo usando o IDE ou um editor de texto sem formatação.  Eu escolhi o último.  Abra o arquivo <code>opus.vcxproj</code> e faça o seguinte: <ol><li>  Encontre todas as linhas que contêm o texto <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PlatformToolset</span></span></span><span class="hljs-tag">&gt;</span></span>v140<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PlatformToolset</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  e substitua a <code>v140</code> pela <code>v100</code> .  Se você estiver usando o IDE, esta é a opção de configuração "Platrofm Toolset" localizada na página Propriedades de configuração -&gt; Geral.  Não se esqueça dos seletores de configuração e plataforma na parte superior da caixa de diálogo. </li><li>  Em seguida, procure este bloco de código: <pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemDefinitionGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ClCompile</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  e adicione uma nova tag dentro dela: <pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugInformationFormat</span></span></span><span class="hljs-tag">&gt;</span></span>ProgramDatabase<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DebugInformationFormat</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  No IDE, você pode fazer isso abrindo a página Propriedades de configuração -&gt; C / C ++ -&gt; Geral e definindo "Debug Information Format" em "ProgramDatabase (/ Zi)".  Na verdade, você pode configurá-lo com qualquer outro valor válido, não precisamos do banco de dados de depuração, mas com um valor inválido, o projeto falhará ao criar. </li></ol></li><li>  Agora vamos criar a versão Release para ambas as plataformas (usando o VS IDE ou a linha de comando) e copie a biblioteca <code>opus.lib</code> e o subdiretório <code>include\</code> no caminho de destino: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\libopus-build\opus-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>\win32\VS2015 <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\libopus\lib\x64 <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> C:\Programs\libopus\lib\Win32 <span class="hljs-built_in"><span class="hljs-built_in">xcopy</span></span> /EC:\Programs\libopus-build\opus-<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>\include C:\Programs\libopus\include\ "C:\Program Files (x86)\Microsoft Visual Studio <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\Common7\IDE\devenv.com" opus.sln /Project opus.vcxproj /Rebuild "Release|x64" <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> x64\Release\opus.lib C:\Programs\libopus\lib\x64\ "C:\Program Files (x86)\Microsoft Visual Studio <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\Common7\IDE\devenv.com" opus.sln /Project opus.vcxproj /Rebuild "Release|Win32" <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> Win32\Release\opus.lib C:\Programs\libopus\lib\Win32\</code> </pre> </li><li>  O diretório <code>C:\Programs\libopus-build</code> pode ser removido. </li></ol><br><h5>  • gSOAP </h5>  Abra o arquivo <code>gsoap-2.8\gsoap</code> , vá para o subdiretório <code>gsoap-2.8\gsoap</code> e descompacte seu conteúdo em <code>C:\Programs\gSOAP\</code> .  O OpenSSL 1.1.x requer o gSOAP versão 2.8.41 ou superior.  Se, por algum motivo, você quiser usar uma versão mais antiga, precisará aplicar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">patch</a> criado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mattias Ellert</a> .  A aplicação de um patch pode ser feita manualmente (o formato é fácil: abra os arquivos mencionados, exclua as linhas marcadas com menos, adicione linhas marcadas com mais; o resto é contexto) ou obtenha a ferramenta de <code>patch</code> portada para Windows e use-a. <br><br><h5>  • MiKTeX </h5><ol><li>  Descompacte o arquivo em <code>C:\Programs\MiKTeX\</code> . </li><li>  Abra o console e instale módulos adicionais: <pre> <code class="dos hljs">"C:\Programs\MiKTeX\texmfs\install\miktex\bin\mpm.exe" --verbose --install=koma-script --install=ucs --install=tabulary --install=url --install=fancybox --install=fancyvrb --install=bera --install=charter --install=mptopdf</code> </pre> </li></ol><br><h5>  • DocBook </h5>  Para XML DTD, você precisa criar um diretório e descompactar o conteúdo do arquivo.  Para folhas de estilo XSL, todo o conteúdo já está em um único diretório, portanto, é necessário extrair isso e renomeá-lo posteriormente. <br><br><a name="final-touches"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png">  Toques finais </h4><br>  O ambiente de construção está quase pronto, são necessárias mais algumas etapas.  Faça o download do arquivo de código-fonte do VirtualBox (se ainda não o tiver feito) e descompacte-o no local em que você deseja trabalhar.  Eu escolhi <code>C:\Devel\</code> para esse fim, coloquei os códigos-fonte descompactados e renomeei o subdiretório para <code>VirtualBox-src</code> . <br><br><h5>  Adicionando certificados </h5><br>  Se você não possui um certificado pago, recomendo que você crie pelo menos um certificado pessoal autoassinado: é mais fácil fazer o Windows carregar drivers autoassinados do que os não assinados.  Para fazer isso, abra o console com privilégios elevados e execute os seguintes comandos que adicionam dois certificados (SHA-1 e SHA-256) e os importam para seu armazenamento pessoal: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> makecert.exe -a sha1 -r -pe -ss my -n "CN=Roga and Kopyta Ltd" C:\Devel\testcert_1.cer makecert.exe -a sha256 -r -pe -ss my -n "CN=Roga and Kopyta Ltd" C:\Devel\testcert_256.cer certmgr.exe -add C:\Devel\testcert_1.cer -s -r localMachine root certmgr.exe -add C:\Devel\testcert_256.cer -s -r localMachine root</code> </pre>  Você pode, é claro, escolher seu próprio nome para os certificados, em vez de "Roga and Kopyta Ltd", e o caminho para armazenar os arquivos.  Agora precisamos obter as impressões digitais dos certificados gerados.  Abra o console de gerenciamento de Certificados (executando <code>certmgr.msc</code> ) e navegue até o armazenamento Pessoal.  Você verá os dois novos certificados denominados "Roga e Kopyta Ltd" lá.  Clique duas vezes no primeiro;  na caixa de diálogo exibida, vá para a guia <i>Detalhes</i> .  O campo "Algoritmo de assinatura" contém o nome do algoritmo: sha256RSA ou sha1RSA.  Role para baixo até o campo "Impressão digital", que contém a sequência de números hexadecimais.  Copie esse valor completo e anote-o em algum lugar.  Faça o mesmo para o segundo certificado;  não esqueça de marcar qual impressão digital era para o SHA-1 e qual era para o SHA-256. <br><br><h5>  • Construindo xmllint </h5><br>  Uma das etapas de compilação precisará do programa <code>xmllint</code> .  Eu não o coloquei na lista de requisitos de compilação porque suas fontes estão agrupadas no arquivo VirtualBox.  Mas você ainda precisará construí-lo, porque as regras de compilação do VB não o fazem.  Eu escolhi <code>C:\Programs\xmllint</code> como diretório de destino. <ol><li>  Copie o diretório <code>C:\Devel\VirtualBox-src\src\libs\libxml2-2.9.4</code> em <code>C:\Programs\</code> para garantir que sua compilação não afete o VB de nenhuma maneira. </li><li>  Abra o console e execute os seguintes comandos: <pre> <code class="dos hljs">"C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Programs\libxml2-<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>\win32 cscript.exe configure.js cruntime=/MT prefix=C:\Programs\xmllint iconv=no nmake /f Makefile.msvc nmake /f Makefile.msvc install</code> </pre> </li><li>  Remova o diretório <code>C:\Programs\libxml2-2.9.4</code> . </li></ol><br><h5>  • Modificações de arquivos VB </h5><br>  Antes de iniciar a compilação, também precisamos trazer algumas alterações no código-fonte do VB.  O conjunto completo deles é apresentado aqui como um arquivo de patch para download que pode ser aplicado manualmente ou usando a ferramenta de <code>patch</code> (que você precisa baixar separadamente): <br><br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>Vbox_build.patch</b></a> <br><br>  Se não houver problemas ao aplicar o patch, você pode pular para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">próxima etapa</a> .  No entanto, se você tiver alguns problemas e precisar de mais informações sobre alterações específicas, ou se simplesmente quiser entender o que está sendo alterado e o motivo, poderá continuar e ler os detalhes fornecidos abaixo.  Observe que as alterações vêm aqui em uma ordem diferente em comparação ao arquivo de correção.  Os caminhos para os arquivos são especificados em relação ao diretório de código-fonte do VB <code>C:\Devel\VirtualBox-src</code> . <ol><li>  Arquivo <code>configure.vbs</code> : <ul><li>  A linha de código: <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathVC &amp; <span class="hljs-string"><span class="hljs-string">"/bin/cl.exe"</span></span>), <span class="hljs-literal"><span class="hljs-literal">True</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span></code> </pre>  é substituído por: <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathVC &amp; <span class="hljs-string"><span class="hljs-string">"/bin/cl.exe"</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" /?"</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span></code> </pre>  Essa linha executa a verificação do compilador, mas esquece que o <code>cl.exe</code> sem nenhum argumento retorna um erro e, portanto, é considerado um compilador inválido.  Adicionando o " <code>/?</code>  "O argumento torna a saída da ajuda e a saída com o código não de erro 0. </li><li>  Agora vamos pular para a função <code>CheckForMinGW32Sub</code> .  Como o nome indica, ele verifica a validade do MinGW de 32 bits.  No entanto, ele foi projetado para a versão 3.3.3, enquanto estou usando o 4.5.4, que possui uma estrutura de arquivo / diretório diferente, então substituí toda a função pelo código a seguir (que é basicamente apenas uma cópia do <code>CheckForMinGWw64Sub</code> adaptada para o Variante de 32 bits): <pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> CheckForMinGW32Sub(strPathMingW32, strPathW32API) g_strSubOutput = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> strPathW32API = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> strPathW32API = strPathMingW32 LogPrint <span class="hljs-string"><span class="hljs-string">"trying: strPathMingW32="</span></span> &amp;strPathMingW32 &amp; <span class="hljs-string"><span class="hljs-string">" strPathW32API="</span></span> &amp; strPathW32API <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/gcc.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/ld.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/objdump.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/dllwrap.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/dlltool.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"bin/as.exe"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"include/bfd.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"lib32/libgcc_s.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/dllcrt1.o"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/dllcrt2.o"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/libmsvcrt.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/lib/libmsvcr100.a"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/_mingw.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/stdint.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFileExists(strPathMingW32, <span class="hljs-string"><span class="hljs-string">"i686-w64-mingw32/include/windows.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Shell(DosSlashes(strPathMingW32 &amp; <span class="hljs-string"><span class="hljs-string">"/bin/gcc.exe"</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" -dumpversion"</span></span>, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> offVer, iMajor, iMinor, iPatch, strVer <span class="hljs-comment"><span class="hljs-comment">' extract the version. strVer = Trim(Replace(Replace(g_strShellOutput, vbCr, ""), vbLf, "")) if (Mid(strVer, 2, 1) = ".") _ And (Mid(strVer, 4, 1) = ".") then iMajor = Int(Left(strVer, 1)) ' Is Int() the right thing here? I want atoi()!!! iMinor = Int(Mid(strVer, 3, 1)) iPatch = Int(Mid(strVer, 5)) else LogPrint "Malformed version: '" &amp; strVer &amp; "'" strVer = "" end if if strVer &lt;&gt; "" then if (iMajor = 4) And (iMinor &gt;= 4) then CheckForMinGW32Sub = True g_strSubOutput = strVer else LogPrint "MinGW32 version '" &amp; iMajor &amp; "." &amp; iMinor &amp; "." &amp; iPatch &amp; "' is not supported (or configure.vbs failed to parse it correctly)." end if else LogPrint "Couldn't locate the GCC version in the output!" end if else LogPrint "Failed to run gcc.exe!" end if end if end function</span></span></code> </pre> </li><li>  Nossa próxima função é <code>CheckForCurlSub</code> , e o bloco de código a ser editado é: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathCurl, <span class="hljs-string"><span class="hljs-string">"include/curl/curl.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.dll"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.lib"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _</code> </pre>  Ele verifica a validade do libcurl, mas requer uma versão vinculada dinamicamente e falha se nenhum arquivo DLL puder ser encontrado.  Estamos usando a versão vinculada estaticamente, portanto, infelizmente, a verificação da DLL precisa ser executada e nos deixar: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> LogFileExists(strPathCurl, <span class="hljs-string"><span class="hljs-string">"include/curl/curl.h"</span></span>) _ <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> LogFindFile(strPathCurl, <span class="hljs-string"><span class="hljs-string">"libcurl.lib"</span></span>) &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> _</code> </pre> </li><li>  Agora entre na função <code>CheckForPython</code> onde a variável <code>VBOX_BLD_PYTHON</code> é gerada: <pre> <code class="vbscript hljs"> CfgPrint <span class="hljs-string"><span class="hljs-string">"VBOX_BLD_PYTHON := "</span></span> &amp; strPathPython &amp; <span class="hljs-string"><span class="hljs-string">"\python.exe"</span></span></code> </pre>  A barra invertida na frente do <code>python.exe</code> deve ser substituída pela anterior: <code>"/python.exe"</code> (sem essa correção, algumas verificações durante o processo de compilação falharão; não notei outros efeitos negativos, mas é mais bonito sem mensagens de falha e, em qualquer caso, melhor prevenir do que remediar). </li><li>  A versão do Windows do script de configuração não suporta libvpx e libopus, então eu as adicionei.  Obviamente, a maneira mais simples era apenas codificar os caminhos para as bibliotecas, mas eu preferia implementá-lo como todos os demais componentes, passando o caminho na linha de comando e verificações de validade adequadas.  O código principal para isso consiste nas duas funções de verificação: <pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">'' ' Checks for libvpx sub CheckForVpx(strOptVpx) dim strPathVpx, str strVpx = "libvpx" PrintHdr strVpx if strOptVpx = "" then MsgError "Invalid path specified!" exit sub end if if g_strTargetArch = "amd64" then strVsBuildArch = "x64" else strVsBuildArch = "Win32" end if strLibPathVpx = "lib/" &amp; strVsBuildArch &amp; "/vpxmd.lib" strPathVpx = "" if LogFileExists(strOptVpx, "include/vpx/vpx_encoder.h") _ And LogFileExists(strOptVpx, strLibPathVpx) _ then strPathVpx = UnixSlashes(PathAbs(strOptVpx)) CfgPrint "SDK_VBOX_VPX_INCS := " &amp; strPathVpx &amp; "/include" CfgPrint "SDK_VBOX_VPX_LIBS := " &amp; strPathVpx &amp; "/" &amp; strLibPathVpx else MsgError "Can't locate " &amp; strVpx &amp; ". " _ &amp; "Please consult the configure.log and the build requirements." exit sub end if PrintResult strVpx, strPathVpx end sub '' ' Checks for libopus sub CheckForOpus(strOptOpus) dim strPathOpus, str strOpus = "libopus" PrintHdr strOpus if strOptOpus = "" then MsgError "Invalid path specified!" exit sub end if if g_strTargetArch = "amd64" then strVsBuildArch = "x64" else strVsBuildArch = "Win32" end if strLibPathOpus = "lib/" &amp; strVsBuildArch &amp; "/opus.lib" strPathOpus = "" if LogFileExists(strOptOpus, "include/opus.h") _ And LogFileExists(strOptOpus, strLibPathOpus) _ then strPathOpus = UnixSlashes(PathAbs(strOptOpus)) CfgPrint "SDK_VBOX_OPUS_INCS := " &amp; strPathOpus &amp; "/include" CfgPrint "SDK_VBOX_OPUS_LIBS := " &amp; strPathOpus &amp; "/" &amp; strLibPathOpus else MsgError "Can't locate " &amp; strOpus &amp; ". " _ &amp; "Please consult the configure.log and the build requirements." exit sub end if PrintResult strOpus, strPathOpus end sub</span></span></code> </pre>  O <code>usage</code> função é usado para imprimir a lista de argumentos da linha de comando;  anexamos nossos dois novos argumentos aqui: <pre> <code class="vbscript hljs"> Print <span class="hljs-string"><span class="hljs-string">" --with-libvpx=PATH "</span></span> Print <span class="hljs-string"><span class="hljs-string">" --with-libopus=PATH "</span></span></code> </pre>  No início da função <code>Main</code> variáveis ​​são definidas para armazenar caminhos para os componentes, precisamos adicionar dois novos lá: <pre> <code class="vbscript hljs"> strOptVpx = <span class="hljs-string"><span class="hljs-string">""</span></span> strOptOpus = <span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre>  Um pouco mais abaixo, segue o bloco de <code>select-case</code> que processa os argumentos e preenche as variáveis;  adicionando nossa contribuição: <pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"--with-libvpx"</span></span> strOptVpx = strPath <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"--with-libopus"</span></span> strOptOpus = strPath</code> </pre>  E, finalmente, quase no final do arquivo existe a cadeia de todas essas chamadas de função de verificação, é aqui que adicionamos a chamada de nossas duas novas funções: <pre> <code class="vbscript hljs"> CheckForVpx strOptVpx CheckForOpus strOptOpus</code> </pre> </li></ul></li><li>  O próximo arquivo é <code>src\VBox\Runtime\Makefile.kmk</code> .  Precisamos encontrar as definições das variáveis <code>VBoxRT_LIBS.win</code> e <code>VBoxRT-x86_LIBS.win</code> e adicionar duas novas bibliotecas a elas, <code>bcrypt.lib</code> e <code>bcrypt.lib</code> .  Portanto, o seguinte código: <pre> <code class="plaintext hljs">VBoxRT_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL)_LIB)/delayimp.lib</code> </pre>  se transforma em: <pre> <code class="plaintext hljs">VBoxRT_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL)_LIB)/delayimp.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB)/crypt32.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB)/bcrypt.lib</code> </pre>  (não perca a barra invertida após <code>delayimp.lib</code> !);  e, respectivamente, este bloco: <pre> <code class="plaintext hljs">VBoxRT-x86_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL_STEM)X86_LIB)/delayimp.lib</code> </pre>  torna-se: <pre> <code class="plaintext hljs">VBoxRT-x86_LIBS.win = \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/vccomsup.lib \ $(PATH_SDK_$(VBOX_WINDDK)_LIB.x86)/wbemuuid.lib \ $(PATH_TOOL_$(VBOX_VCC_TOOL_STEM)X86_LIB)/delayimp.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB.x86)/crypt32.lib \ $(PATH_SDK_$(VBOX_WINPSDK)_LIB.x86)/bcrypt.lib</code> </pre>  Essa alteração é necessária para vincular com êxito o <code>VBoxRT.dll</code> .  Não tenho 100% de certeza do motivo, a versão do Oracle não depende do tempo de carregamento do <code>crypt32.dll</code> , é carregada em tempo de execução, portanto, o arquivo LIB não deve ser necessário.  No entanto, sem ele, o vinculador não consegue encontrar algumas funções e falha.  Suspeito que possa estar relacionado às opções de compilação do OpenSSL, mas não verifiquei isso, adicionar a dependência é mais fácil.  E a segunda dependência, <code>bcrypt.dll</code> , é um requisito para o novo OpenSSL 1.1.1. </li><li>  Se você possui o gSOAP da versão 2.8.79 ou superior, edite o arquivo <code>src\VBox\Runtime\r3\win\VBoxRT-openssl-1.1plus.def</code> e adicione as seguintes linhas à lista de exportações: <pre> <code class="plaintext hljs"> OpenSSL_version_num DH_generate_parameters_ex DH_new ASN1_STRING_get0_data</code> </pre>  Esta lista define quais funções são exportadas pela biblioteca <code>VBoxRT.dll</code> (que contém o OpenSSL dentro).  Quando a ferramenta <code>VBoxWebSrv.exe</code> está sendo vinculada, dependendo da versão do gSOAP, ela pode exigir funções adicionais do OpenSSL.  Como estão ausentes na lista de exportações, o vinculador adiciona o próprio OpenSSL e imediatamente reclama de <code>VBoxRT</code> conflitos entre esse OpenSSL externo e sua própria cópia já incorporada ao <code>VBoxRT</code> .  A adição das exportações mencionadas corrige o problema. </li><li>  Como mencionei no começo, não construo as adições de convidados, mas preciso ter sua imagem ISO como parte da distribuição.  As regras de compilação foram projetadas para esse cenário, mas esperam que a imagem ISO pronta apareça magicamente no lugar certo e na hora certa.  Adicionei essa mágica ao arquivo <code>src\VBox\Makefile.kmk</code> .  Procure o seguinte código: <pre> <code class="plaintext hljs"> ifdef VBOX_WITH_ADDITIONS include $(PATH_SUB_CURRENT)/Additions/Makefile.kmk endif</code> </pre>  e logo abaixo segue a regra para o download automático do arquivo de imagem: <pre> <code class="plaintext hljs"> ifndef VBOX_WITHOUT_ADDITIONS_ISO $(VBOX_PATH_ADDITIONS_ISO)/VBoxGuestAdditions.iso: $(QUIET)$(MKDIR) -p $(@D) $(VBOX_RETRY) $(TOOL_CURL_FETCH) http://download.virtualbox.org/virtualbox/$(VBOX_VERSION_STRING_RAW)/VBoxGuestAdditions_$(VBOX_VERSION_STRING_RAW).iso -o $@ endif</code> </pre>  Se você editar os arquivos manualmente, em vez de aplicar o patch, observe que os comandos da regra devem começar com o caractere de tabulação. </li><li>  Antes da versão 6.0, a documentação era um dos subsistemas criados com êxito sem nenhuma alteração.  Não sei o que havia de errado nisso, mas foi redesenhado significativamente de tal maneira que não funciona mais no meu sistema de compilação.  Não tenho idéia de como o próprio Oracle constrói a documentação (talvez em um sistema * NIX), mas para mim as regras de construção continuavam perdendo barras nos caminhos ou adicionando um excesso delas e, como resultado, não conseguiram encontrar os arquivos de destino. devido a incompatibilidades nos arquivos de catálogo.  Finalmente consegui combinar algumas mudanças que permitiram construir a documentação sem erros.  Primeiro, um dos diretórios de destino estava ausente, portanto, alguns dos arquivos intermediários não puderam ser criados.  Esse problema foi corrigido no arquivo <code>doc\manual\Makefile.kmk</code> , dentro do seguinte bloco de código: <pre> <code class="plaintext hljs">define def_vbox_refentry_to_user_sect1 $$(VBOX_PATH_MANUAL_OUTBASE)/$(1)/user_$(2): $(3) \ $$(VBOX_PATH_MANUAL_SRC)/docbook-refentry-to-manual-sect1.xsl \ $$(VBOX_XML_CATALOG) $$(VBOX_XML_CATALOG_DOCBOOK) $$(VBOX_XML_CATALOG_MANUAL) \ $$(VBOX_VERSION_STAMP) | $$(dir $$@) $$(call MSG_TOOL,xsltproc $$(notdir $$(filter %.xsl,$$^)),,$$(filter %.xml,$$^),$$@) $$(QUIET)$$(RM) -f "$$@" $$(QUIET)$$(call VBOX_XSLTPROC_WITH_CAT) --output $$@ $$(VBOX_PATH_MANUAL_SRC)/docbook-refentry-to-manual-sect1.xsl $$&lt; endef</code> </pre>  Logo após o <code>$$(RM)</code> , adicionei um comando para criar o diretório ausente: <pre> <code class="plaintext hljs"> $$(QUIET)$$(MKDIR) -p "$$(@D)"</code> </pre> <br>  Quanto às barras, as correções estão localizadas no arquivo <code>doc\manual\Config.kmk</code> .  Não consegui encontrar uma solução "normal" para isso, mas há uma solução alternativa boa o suficiente para fins práticos, o que implica duplicar as regras de substituição de caminho para caminhos incorretos.  Primeiro, abaixo da linha: <pre> <code class="plaintext hljs"> VBOX_FILE_URL_MAYBE_SLASH = $(if $(eq $(KBUILD_HOST),win),/,)</code> </pre> I've created two new variables which basically contain the same paths as their origins, but with triple slash after the disk letter instead of a single slash: <pre> <code class="plaintext hljs"> VBOX_PATH_MANUAL_SRC_SLASHED = $(subst :/,:///,$(VBOX_PATH_MANUAL_SRC)) VBOX_PATH_MANUAL_OUTBASE_SLASHED = $(subst :/,:///,$(VBOX_PATH_MANUAL_OUTBASE))</code> </pre> A little bit below that, there is a rule for creating the catalog file: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG): $(MAKEFILE_CURRENT) | $$(dir $$@) $(call MSG_L1,Creating catalog $@) $(QUIET)$(APPEND) -tn "$@" \ '&lt;?xml version="1.0"?&gt;' \ '&lt;!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd"&gt;' \ '&lt;catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog"&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/ENTITIES DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/DTD DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateURI uriStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ '&lt;/catalog&gt;'</code> </pre> For each line which contains the variable <code>VBOX_PATH_MANUAL_SRC</code> or <code>VBOX_PATH_MANUAL_OUTBASE</code> (except for the line with the <code>file://</code> prefix), I've appended the copy of the whole line, but with the variable replaced with its triple-slash counterpart. The result looks like this: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG): $(MAKEFILE_CURRENT) | $$(dir $$@) $(call MSG_L1,Creating catalog $@) $(QUIET)$(APPEND) -tn "$@" \ '&lt;?xml version="1.0"?&gt;' \ '&lt;!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd"&gt;' \ '&lt;catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog"&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/ENTITIES DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegatePublic publicIdStartString="-//OASIS/DTD DocBook XML" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateURI uriStartString="http://www.oasis-open.org/docbook/" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_DOCBOOK)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateSystem systemIdStartString="$(VBOX_PATH_MANUAL_SRC_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_SRC_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ ' &lt;delegateURI uriStartString="$(VBOX_PATH_MANUAL_OUTBASE_SLASHED)" catalog="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_XML_CATALOG_MANUAL)"/&gt;' \ '&lt;/catalog&gt;'</code> </pre> Even further down, there is another rule for creating an auxiliary catalog file; the starting line is: <pre> <code class="plaintext hljs"> $(VBOX_XML_CATALOG_MANUAL): $(MAKEFILE_CURRENT) | $$(dir $$@)</code> </pre> Here I'm doing the same operation as above. In addition, in the beginning of the generated file there are several lines defining the entries in the <code>common/</code> subdirectory: <pre> <code class="plaintext hljs"> ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-accessibility-en.xml" uri="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-support-en.xml" uri="file://$(VBOX_FILE_URL_MAYBE_SLASH)$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \</code> </pre> With these we have the opposite problem: triple slash after the <code>file</code> is replaced with a single slash. I worked this around by getting rid of the <code>file</code> protocol altogether and replacing those URIs with direct file system paths in the target address (the <code>uri</code> attribute). The result for these lines looks like this (including the aforementioned fix): <pre> <code class="plaintext hljs"> ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-accessibility-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC_SLASHED)/common/oracle-accessibility-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-accessibility-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC)/common/oracle-support-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \ ' &lt;system systemId="$(VBOX_PATH_MANUAL_SRC_SLASHED)/common/oracle-support-en.xml" uri="$(VBOX_PATH_MANUAL_SRC)/en_US/oracle-support-en.xml"/&gt;' \</code> </pre> </li><li> When VB is built with signing, most of its binaries receive the integrity check flag (the linker option <code>/IntegrityCheck</code> ) which forces Windows to check digital signatures and forbids launching applications which are signed incorrectly. If you have a valid paid certificate that's not a problem; however with a self-signed certificate VB will refuse to start, even if Windows is booted in the test mode. I've modified the file <code>Config.kmk</code> in such a way that this flag is only added when you have a full-grown certificate (the criterion of that is presence of a cross-certificate in <code>LocalConfig.kmk</code> ; see <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">below</a> ). The changes look like this: <ul><li> A new variable <code>VBOX_INTEGRITY_CHECK</code> is added, which contains the desired value of the option: <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE) VBOX_INTEGRITY_CHECK := /IntegrityCheck else VBOX_INTEGRITY_CHECK := /IntegrityCheck:NO endif</code> </pre> </li><li> Below that there is the <code>editbin</code> call: <pre> <code class="plaintext hljs"> $(VBOX_VCC_EDITBIN) /LargeAddressAware /DynamicBase /NxCompat /Release /IntegrityCheck \ /Version:$(VBOX_VERSION_MAJOR)0$(VBOX_VERSION_MINOR).$(VBOX_VERSION_BUILD) \ "$@"</code> </pre> Here I've replaced the unconditional <code>/IntegrityCheck</code> with the new variable <code>$(VBOX_INTEGRITY_CHECK)</code> . </li><li> Next, look for the blocks of the following kinds: <pre> <code class="plaintext hljs">ifdef VBOX_SIGNING_MODE TEMPLATE_XXXXXX_LDFLAGS += -IntegrityCheck endif</code> </pre> or <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_WITH_HARDENING) TEMPLATE_XXXXXX_LDFLAGS += -IntegrityCheck endif</code> </pre> where « <code>XXXXXX</code> » stands for various component names. There are 6 such blocks in total, 3 of each kind. Here I've modified the condition by adding a check for cross-certificate. The first line then turns into, respectively: <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE)</code> </pre> or <pre> <code class="plaintext hljs">if defined(VBOX_SIGNING_MODE) &amp;&amp; defined(VBOX_CROSS_CERTIFICATE_FILE) &amp;&amp; defined(VBOX_WITH_HARDENING)</code> </pre> </li></ul></li><li> Two more files modified by me do not take immediate part in building of VB: <code>src\VBox\Installer\win\Scripts\PackDriversForSubmission.cmd</code> and <code>UnpackBlessedDrivers.cmd</code> . These auxiliary scripts can be used if you intend to send the drivers into Microsoft for Windows 10 signing. The first script prepares a CAB archive for sending; the second one unpacks the resultant ZIP archive with the signed drivers and verifies the signatures. In the packing script all I did was just fixing several typos. In the unpacking script I added ability to specify path to the <code>signtool</code> program, and got rid of the <code>unzip</code> tool by replacing it with a small Perl script. The signing procedure is described below. If you don't plan to get the Microsoft signature you can simply ignore all these changes in the scripts. </li></ol><br><a name="final-touches-localconfig"></a><h5> • VB build configuration file </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora precisamos criar o arquivo </font></font><code>LocalConfig.kmk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no diretório de fontes VB e escrever lá todos os caminhos e construir parâmetros. </font><font style="vertical-align: inherit;">Você pode usar o seguinte texto como modelo:</font></font><pre> <code class="plaintext hljs">VBOX_WITH_HARDENING := VBOX_PATH_WIX := C:\Programs\WiX VBOX_GSOAP_INSTALLED := 1 VBOX_PATH_GSOAP := C:\Programs\gSOAP VBOX_WITH_COMBINED_PACKAGE := 1 VBOX_WITH_QT_PAYLOAD := 1 VBOX_WITH_QTGUI_V5 := 1 VBOX_SIGNING_MODE := release VBOX_CERTIFICATE_SUBJECT_NAME := Roga and Kopyta Ltd VBOX_CERTIFICATE_FINGERPRINT := XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX VBOX_CERTIFICATE_SHA2_SUBJECT_NAME := Roga and Kopyta Ltd VBOX_CERTIFICATE_SHA2_FINGERPRINT := XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX VBOX_TSA_URL := http://timestamp.digicert.com VBOX_TSA_SHA2_URL := http://timestamp.digicert.com VBOX_TSA_URL_ARGS := /t "$(VBOX_TSA_URL)" VBOX_TSA_SHA2_URL_ARGS := /tr "$(VBOX_TSA_SHA2_URL)" /td sha256 VBOX_CROSS_CERTIFICATE_FILE := VBOX_CROSS_CERTIFICATE_FILE_ARGS := VBOX_CROSS_CERTIFICATE_SHA2_FILE := VBOX_CROSS_CERTIFICATE_SHA2_FILE_ARGS := VBOX_PATH_SIGN_TOOLS := C:\Programs\DevKits\8.1\bin\x64 VBOX_PATH_SELFSIGN := C:\WinDDK\7600.16385.1\bin\selfsign VBOX_PATH_WISUMINFO := "C:\Program Files\Microsoft SDKs\Windows\v7.1\Samples\sysmgmt\msi\scripts\WiSumInf.vbs" VBOX_PATH_WISUBSTG := "C:\Program Files\Microsoft SDKs\Windows\v7.1\Samples\sysmgmt\msi\scripts\WiSubStg.vbs" VBOX_WITH_DOCS := 1 VBOX_WITH_DOCS_CHM := 1 VBOX_WITH_DOCS_PACKING := 1 VBOX_WITH_ADDITIONS := VBOX_WITH_ADDITIONS_PACKING := 1 VBOX_HAVE_XMLLINT := 1 VBOX_XMLLINT := C:\Programs\xmllint\bin\xmllint.exe VBOX_PATH_DOCBOOK := C:/Programs/DocBook/xsl VBOX_PATH_DOCBOOK_DTD := C:/Programs/DocBook/xml VBOX_PATH_HTML_HELP_WORKSHOP := "C:\Program Files (x86)\HTML Help Workshop" VBOX_PDFLATEX := C:\Programs\MiKTeX\texmfs\install\miktex\bin\pdflatex.exe VBOX_PDFLATEX_CMD := $(VBOX_PDFLATEX) -halt-on-error -interaction batchmode TOOL_CURL_FETCH := C:\Programs\curl\x64\curl.exe PATH_TOOL_NASM := C:/Programs/nasm VBOX_INSTALLER_LANGUAGES := en_US VBOX_WITH_TESTCASES := VBOX_WITH_VALIDATIONKIT := VBOX_WITH_VBOX_IMG := 1 VBOX_WITH_RECORDING := 1 VBOX_WITH_AUDIO_RECORDING := 1 SDK_VBOX_VPX := 1 VBOX_WITH_LIBVPX := 1 SDK_VBOX_OPUS := 1 VBOX_WITH_LIBOPUS := 1 VBOX_BUILD_PUBLISHER := _OSE</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Você precisará editar este modelo: </font></font><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As variáveis </font></font><code>VBOX_CERTIFICATE_SUBJECT_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>VBOX_CERTIFICATE_SHA2_SUBJECT_NAME</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devem conter os nomes dos certificados SHA-1 e SHA-256, respectivamente.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As variáveis </font></font><code>VBOX_CERTIFICATE_FINGERPRINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>VBOX_CERTIFICATE_SHA2_FINGERPRINT</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">devem conter as impressões digitais desses certificados; </font><font style="vertical-align: inherit;">você os copiou anteriormente do console de gerenciamento de certificados.</font></font></li><li> If you have a paid certificate you should delete the lines defining the variables <code>VBOX_CROSS_CERTIFICATE_FILE_ARGS</code> and <code>VBOX_CROSS_CERTIFICATE_SHA2_FILE_ARGS</code> , then in the variables <code>VBOX_CROSS_CERTIFICATE_FILE</code> and <code>VBOX_CROSS_CERTIFICATE_SHA2_FILE</code> (without « <code>_ARGS</code> ») put the full path to the cross-certificate (without it the drivers will not be accepted). You can download it from the web site of the company that issued the certificate, or <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">from Microsoft</a> . </li><li> You can fine-tune the signing process using various additional variables and macros to redefine the certificate storage, timestamp server, or even construct a full command line for the <code>signtool</code> program. You can take a look into the file <code>Config.kmk</code> below the comment «Code Signing», there you'll find which variables are defined and how they are used. </li><li> If you've installed some of the programs into paths different from mine, you need to fix those paths in the template. It's strongly recommended to keep the path style for each variable (forward/backward slashes), sometimes it's critical for successful build. </li><li> Fox WiX you need to specify the path to its binaries. With the portable version, it is just the directory where you unpacked it; if you used the installer, the binaries will be located in the subdirectory <code>bin</code> . Please, note, that the path must not contain spaces! If it does you have to convert it into the 8.3 format (you can use <code>dir /x</code> for that). Unfortunately, enclosing the path in quotes does not work with this variable. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A variável </font></font><code>VBOX_BUILD_PUBLISHER</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">especifica o sufixo da marca no número da versão. </font><font style="vertical-align: inherit;">Por padrão, é "_OSE" (ou seja, a versão completa do produto é "6.0.4_OSE"). </font><font style="vertical-align: inherit;">Você pode especificar qualquer outro sufixo aqui ou configurá-lo como vazio para se livrar dele completamente. </font><font style="vertical-align: inherit;">Mas se você excluir a variável completamente, ela usará o padrão "_OSE".</font></font></li></ul><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O restante das variáveis ​​é usado principalmente para declarar quais componentes devem ser construídos. </font><font style="vertical-align: inherit;">E, é claro, a declaração principal está no topo: desligue o endurecimento.</font></font><br><br><a name="build-vb"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Criando virtualbox </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente, agora podemos começar a criar o VirtualBox. </font><font style="vertical-align: inherit;">Se você normalmente prefere construir para diferentes plataformas em paralelo, você terá que ficar sem ela por enquanto ou usar duas cópias separadas da árvore de origem, porque o VB tem um arquivo de configuração comum que é gerado antes da construção e contém dados dependentes da plataforma. </font><font style="vertical-align: inherit;">Não seria bom para o compilador lançá-lo de repente do ambiente de compilação de 64 bits para o de 32 bits no meio do processo de compilação. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você precisar de assinaturas de drivers compatíveis com o Windows 10, consulte as informações fornecidas após a descrição do procedimento principal.</font></font><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos começar com a versão de 64 bits. </font><font style="vertical-align: inherit;">Abra o console e execute os seguintes comandos:</font></font><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Devel\VirtualBox-src "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x64 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> BUILD_TARGET_ARCH=amd64 cscript configure.vbs --with-DDK=C:\WinDDK\<span class="hljs-number"><span class="hljs-number">7600</span></span>.<span class="hljs-number"><span class="hljs-number">16385</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> --with-MinGW-w64=C:\Programs\mingw64 --with-MinGW32=C:\Programs\mingw32 --with-libSDL=C:\Programs\SDL\x64 --with-openssl=C:\Programs\OpenSSL\x64 --with-openssl32=C:\Programs\OpenSSL\x32 --with-libcurl=C:\Programs\curl\x64 --with-libcurl32=C:\Programs\curl\x32 --with-Qt5=C:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x64 --with-libvpx=C:\Programs\libvpx --with-libopus=C:\Programs\libopus --with-python=C:/Programs/Python env.bat kmk kmk C:/Devel/VirtualBox-src/out/win.x86/release/obj/Installer/VirtualBox-<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>_OSE-r128164-MultiArch_amd64.msi</code> </pre> The <code>configure.vbs</code> script verifies the environment and generates configuration files ( <code>AutoConfig.kmk</code> and <code>env.bat</code> ). The first <code>kmk</code> command builds the binaries and collect them into <code>out\win.amd64\bin\</code> . And the last command packs them all into the intermediate MSI package. Important notes: <ul><li> You must use forward slashes in the last command. With backslashes, <code>kmk</code> would fail to find the build rules. </li><li> Even though we are building the 64-bit version, the target package is located in <code>out\win.x86\…</code> , because the final stage of the build will be performed from the 32-bit build environment. </li><li> If you've changed the branding suffix you need to change the name of the target package by replacing the «_OSE» with what you specified in the variable <code>VBOX_BUILD_PUBLISHER</code> . </li><li> The revision number in the MSI package name (128164) can be found in the file <code>Config.kmk</code> inside the <code>VBOX_SVN_REV_FALLBACK</code> variable definition. Please, note, that this value may be different from revisions of the official distribution (for instance, the version 6.0.4 has release number 128413). Unfortunately, I have no idea why. </li></ul></li><li> Now we need to build the 32-bit version and pack everything together. For that, open a new console window, and run the following commands: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d C:\Devel\VirtualBox-src "C:\Program Files\Microsoft SDKs\Windows\v7.<span class="hljs-number"><span class="hljs-number">1</span></span>\Bin\SetEnv.<span class="hljs-built_in"><span class="hljs-built_in">Cmd</span></span>" /Release /x86 /win7 <span class="hljs-built_in"><span class="hljs-built_in">COLOR</span></span> <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> BUILD_TARGET_ARCH=x86 cscript configure.vbs --with-DDK=C:\WinDDK\<span class="hljs-number"><span class="hljs-number">7600</span></span>.<span class="hljs-number"><span class="hljs-number">16385</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> --with-MinGW-w64=C:\Programs\mingw64 --with-MinGW32=C:\Programs\mingw32 --with-libSDL=C:\Programs\SDL\x32 --with-openssl=C:\Programs\OpenSSL\x32 --with-libcurl=C:\Programs\curl\x32 --with-Qt5=C:\Programs\Qt\<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>-x32 --with-libvpx=C:\Programs\libvpx --with-libopus=C:\Programs\libopus --with-python=C:/Programs/Python env.bat kmk kmk C:/Devel/VirtualBox-src/out/win.x86/release/bin/VirtualBox-<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span>_OSE-r128164-MultiArch.exe</code> </pre> Same as with the 64-bit, you need to replace the «_OSE» suffix with what you have. <br> Notice how in the last command we are building an <code>EXE</code> , and not an <code>MSI</code> . This is the final installer which will cause the 32-bit package to be built automatically, from dependencies. </li><li> Even if you have a paid certificate you will find that you cannot install this distribution into Windows 10 booted with Secure Boot enabled. This OS has stricter requirements, and the drivers must be signed by none other than Microsoft themselves. The procedure is explained in details on various Internet resources and is unrelated to this article, so I'm not going to go deep into this topic. Instead I'll outline the main steps you need to take for integrating this task with the VB build procedure. <ul><li> The main requirement here is that you must have not just a normal code signing certificate, but an EV one (Extended Validation). Also you need to register an account at <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hardware Dev Center</a> and add your certificate there. </li><li> Now, during building the 64-bit version of VB, just after you've got all binary components (that is, after the first <code>kmk</code> run which was without arguments), you need to create a CAB archive with the drivers. There is a batch script template for that; the build system modifies it according to the current task and puts it into <code>out\win.amd64\release\repack\</code> . Go into this path and run the following command: <pre> <code class="dos hljs">PackDriversForSubmission.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> -x</code> </pre> When the script finishes, the file <code>VBoxDrivers-6.0.4r128164-amd64.cab</code> will appear in the same directory. </li><li> You need to sign this CAB archive with your EV certificate. Then go to the Microsoft Hardware Dev Center, create a new submission, upload your signed archive, select the desired target OS version (make sure it's 64-bit) and send the submission. </li><li> It will take several minutes to process, after which you will have a ZIP archive where all the drivers have been signed by Microsoft in addition to your signature, and all the CAT files generated anew. Download this archive and place it somewhere so that the build system had access to it. </li><li> Unpack the archive and put all the files from the subdirectories directly into <code>out\win.amd64\release\bin\</code> overwriting the existing files. You can do it either manually or using another script from the same path <code>out\win.amd64\release\repack\</code> by running the following commands: <pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _MY_SIGNTOOL=C:\Programs\DevKits\<span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>\bin\x64\signtool.exe UnpackBlessedDrivers.<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> -n -i <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>\to\signed.zip</code> </pre> Of course, you need to put here the correct paths to <code>signtool.exe</code> and the ZIP archive. </li><li> Now you can run the second <code>kmk</code> command which packs all the components into an MSI installer. If you were doing all this in the same console window, don't forget to switch back to the base directory of the VB project. </li><li> Finally, proceed with building of the 32-bit version of VB, and perform all the same additional steps: after the first <code>kmk</code> switch to <code>out\win.x86\release\repack\</code> , create the CAB archive, sign it, send to Microsoft (now choosing the 32-bit OS version), replace the drivers with their counter-signed versions, and run the final <code>kmk</code> for building the complete VB distribution. </li></ul></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se nenhum de nós estragou tudo, toda essa longa cadeia deve oferecer a você um novo e brilhante instalador do VirtualBox que difere do Oracle apenas pelo seu ícone, a imagem About e, é claro, a profunda falta de proteção. Não é difícil substituir também o ícone e a imagem, mas não vou entrar neste tópico aqui. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por conveniência, criei um </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">único arquivo em lote</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que automatiza a compilação completa do VB. Você pode usá-lo se precisar criar o instalador completo regularmente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apenas mais algumas palavras sobre a instalação da distribuição resultante, se você estiver usando um certificado autoassinado. </font><font style="vertical-align: inherit;">Como foi descoberto subitamente, no Windows 8/10 não é suficiente inicializar no modo de teste, a instalação ainda falha, alegando que as assinaturas do driver são inválidas. </font><font style="vertical-align: inherit;">Você pode solucionar esse problema adicionando os certificados ao armazenamento raiz da CA:</font></font><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abra a caixa de diálogo Propriedades do instalador do VB clicando com o botão direito do mouse e selecionando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Propriedades</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , depois mude para a </font><font style="vertical-align: inherit;">guia </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assinaturas digitais</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Você encontrará duas assinaturas lá, ambas nomeadas "Roga e Kopyta Ltd", uma é sha1, a outra sha256. </font><font style="vertical-align: inherit;">Selecione o primeiro, clique em </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detalhes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outra caixa de diálogo é exibida, na qual você precisa clicar no botão </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exibir certificado</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li> One more dialog, click <i>Install Certificate</i> . </li><li> In the Import wizard, select the location «Local Machine», click <i>Next</i> . After UAC confirmation (if needed), there's the certificate store selection. Select «Place all certificates in the following store», then click <i>Browse</i> and choose the store named «Trusted Root Certification Authorities». Then <i>Next</i> , <i>Finish</i> . You're done, the certificate is installed. </li><li> Close all the dialogs but the very first one, select the second signature (sha256) and repeat the steps 2 to 4 for it too. </li><li> Close all the dialogs, run the installer. Now it should work fine. </li></ol><br><a name="afterword"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"> Epilogue </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando terminei de escrever o artigo, fiquei surpreso com seu volume. No começo, eu estava planejando entrar em muitos detalhes sobre as razões para escolher esta ou aquela maneira de resolver cada problema, explicar qual é exatamente o problema e quais soluções alternativas podem ser aplicáveis. Mas muito em breve ficou claro que, se carregado com todos esses detalhes, o texto seria monstruosamente enorme. Tenho que me desculpar pelas receitas parecidas com "apenas faça isso e não faça perguntas". Eu tenho uma forte antipatia por eles, mas simplesmente não consegui encontrar outra maneira. Ocasionalmente, eu ainda tentava descrever o que estava acontecendo, para suavizar a impressão.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma grande quantidade de detalhes sobre o sistema de compilação VB teve que permanecer nos bastidores; pois ambos me senti relutante em inchar o texto e, às vezes, estava com preguiça de procurar uma abordagem diferente e mais eficiente para resolver um problema. Afinal, meu principal objetivo, inicialmente, era conseguir uma versão funcional da versão atual do VirtualBox. O 4.3.12 já estava desatualizado nessa época, mas não corria o risco de atualizar uma das minhas ferramentas mais ativamente usadas para a versão mais avançada, que poderia simplesmente parar de funcionar a qualquer momento. Embora, de tempos em tempos, eu volte e, tendo encontrado algo novo, adicione-o a este artigo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que este artigo encontre seu público. Se você estiver interessado em ver e analisar o resultado final, mas não quiser configurar toda a pilha de programas, poderá obter minha versão da distribuição aqui:</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versão 6.0.4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Todos os drivers (e outros arquivos) são assinados com um certificado autoassinado não confiável; portanto, para instalar isso na versão de 64 bits do Windows, você precisará reiniciar o modo de teste. </font><font style="vertical-align: inherit;">Se você tiver alguma dúvida, sugestão, recomendação, sinta-se à vontade para me escrever aqui nos comentários ou através de mensagens pessoais. </font><font style="vertical-align: inherit;">Que o Código Aberto esteja com você!</font></font><br><br><a name="history"></a><h4><img src="https://habrastorage.org/getpro/habr/post_images/1c4/b9c/64d/1c4b9c64d7dc3f83417ee1cbbd24820a.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alterações </font></font></h4><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivo</font></font></b> <div class="spoiler_text"><h5> • Russian article published, 21.01.2016 </h5><ol><li> VirtualBox 5.0.12. </li></ol><br><h5> • Update of 24.05.2016 </h5><ol><li> The article is updated for VB 5.0.20, one of the main changes being SHA-1/SHA-256 dual-signing. </li><li> Added disabling of forced signature checks if self-signed certificates are used. </li><li> Added information about workaround for installation failure of the self-signed distribution. </li><li> Library versions were updated. </li><li> Disabled some unused components for speeding up the build process. </li><li> Minor fixes and improvements. </li></ol><br><h5> • Update of 29.07.2016 </h5><ol><li> The article is updated for VB 5.1.2; the most important change is upgrading to Qt5. The differences from VB 5.0.x procedure are specified where applicable. </li><li> Library versions were updated. </li><li> The full build batch was updated to check error codes after each operation. </li><li> Minor fixes and improvements. </li></ol><br><h5> • Update of 15.09.2016 </h5><ol><li> The article is updated for VB 5.1.6. </li><li> Library versions were updated. </li><li> Added NASM for building OpenSSL. </li><li> Added OpenSSL into cURL; this fixes the broken function of checking for updates and downloading the Extension Pack. </li><li> The full build batch now reads the VB version automatically. </li><li> Various minor fixes and improvements. </li></ol><br><h5> • Update of 30.11.2016 </h5><ol><li> The article is updated for VB 5.1.10. </li><li> Library versions were updated; particularly OpenSSL was upgraded to version 1.1.x. </li><li> Fixed some installation errors: <ul><li> path to the Qt plugins now points to the installation directory; </li><li> added forgotten OpenSSL libraries to the 32-bit components of the 64-bit VB version. </li></ul></li><li> The article no longer contains information about building older VB versions. If needed, the previous versions of it are available in the <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub project</a> . </li></ol><br><h5> • Update of 2.12.2016 </h5><ol><li> Switched to using statically linked OpenSSL. </li></ol><br><h5> • Update of 20.06.2017 </h5><ol><li> The article is updated for VB 5.1.22. </li><li> cURL, OpenSSL, and gSOAP were updated; adapted the build instructions for cURL, gSOAP and VB. </li></ol><br><h5> • Update of 1.12.2017 </h5><ol><li> The article is updated for VB 5.2.2. </li><li> Switched from MinGW-32 3.3.3 to 4.5.4. </li><li> Qt, cURL, OpenSSL, gSOAP, and some build tools were updated; adapted the build instructions for cURL, gSOAP and VB. </li><li> Switched to using local archives of DocBook XML/XSL instead of online versions. </li><li> Using cURL program instead of wget for downloading the Guest Additions ISO image. </li><li> Various minor fixes and improvements. </li></ol><br><h5> • Update of 4.12.2017 </h5><ol><li> The libxml version was fixed in the build instructions. </li></ol><br><h5> • Update of 4.09.2018 </h5><ol><li> The article is updated for VB 5.2.18. </li><li> cURL, OpenSSL, gSOAP and some build tools were updated; adapted the build instructions for cURL. </li></ol><br><h5> • Update of 12.12.2018 </h5><ol><li> The article is updated for VB 5.2.22. </li><li> Enabled screen recording functionality which is disabled in OSE version by default; added libraries libopus and libvpx for encoding. </li><li> cURL, OpenSSL, and gSOAP were updated. </li><li> The full set of VirtualBox source code changes is now published as a single patch file for easier application. </li></ol></div></div><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> • Atualização de 25/01/2019 </font></font></h5><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O artigo é atualizado para o VB 6.0.2. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Construção aprimorada de desativação de adições de convidados. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cURL e gSOAP foram atualizados; </font><font style="vertical-align: inherit;">As folhas de estilo DocBook XSL foram rebaixadas para a versão 1.69.1 (a documentação é mais adequada para essa versão).</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O lote de compilação completo foi dividido do texto do artigo em um arquivo para download. </font></font></li></ol><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> • Atualização de 08/04/2019 </font></font></h5><ol><li> The article has been translated into English for the first time. Also numerous minor changes were introduced into the Russian version. </li><li> Added information about drivers signing for Windows 10. </li><li> The article is updated for VB 6.0.4. </li><li> cURL, OpenSSL, gSOAP, and some tools were updated. </li><li> The full build batch no longer has to be placed at the specific path. Also, it now contains the basic template for automated Windows 10 drivers signing. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt447300/">https://habr.com/ru/post/pt447300/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt447288/index.html">Top 5 stablecoins. Tudo o que você precisa saber</a></li>
<li><a href="../pt447290/index.html">Passeios de médico, passeios</a></li>
<li><a href="../pt447292/index.html">14 novos produtos no Visual Studio 2019</a></li>
<li><a href="../pt447294/index.html">Live Share agora incluído no Visual Studio 2019</a></li>
<li><a href="../pt447298/index.html">Gestão do conhecimento através de modelos de competência</a></li>
<li><a href="../pt447302/index.html">Sistema operacional de fim de semana</a></li>
<li><a href="../pt447304/index.html">Avaricious não paga duas vezes - configuramos memória na plataforma AMD B450 e obtemos desempenho gratuito</a></li>
<li><a href="../pt447306/index.html">Transformador de Tesla em uma placa de uma polegada quadrada</a></li>
<li><a href="../pt447308/index.html">Design instantâneo</a></li>
<li><a href="../pt447310/index.html">Como passamos do desenvolvimento web para o desenvolvimento de jogos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>