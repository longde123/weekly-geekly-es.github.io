<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶ñ ‚úíÔ∏è üç¥ JS battle: comment j'ai √©crit mon eval () ü•ó üñºÔ∏è üíú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous pouvez vous souvenir d' Alexander Korotayev dans la version navigateur des ¬´H√©ros de la puissance et de la magie¬ª: le d√©cryptage de son rapport √†...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JS battle: comment j'ai √©crit mon eval ()</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/436586/">  Vous pouvez vous souvenir d' <b>Alexander Korotayev</b> dans la version navigateur des ¬´H√©ros de la puissance et de la magie¬ª: le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©cryptage de</a> son rapport √† son sujet a recueilli une √©norme quantit√© de vues sur Habr√©.  Et maintenant, il a fait un jeu ax√© sur les programmeurs: vous devez y jouer avec un code JS. <br><br>  Cette fois, le d√©veloppement n'a pas pris des semaines, mais des semaines, mais sans d√©fis int√©ressants de toute fa√ßon, il n'a pas pu le faire.  Comment rendre le jeu pratique m√™me pour les d√©veloppeurs qui n'ont pas encore touch√© JavaScript?  Comment vous prot√©ger des moyens simples de d√©jouer un jeu? <br><br><img src="https://habrastorage.org/webt/to/1i/n0/to1in00dneigddmemqzjqonebuy.png"><br><br>  En cons√©quence, Alexander a de nouveau fait un rapport sur HolyJS, et nous (les organisateurs de la conf√©rence) avons √† nouveau pr√©par√© une version texte pour Habr. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TJ7TGk5WJ5k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Mon nom est Alexander Korotaev, je travaille chez Tinkoff.ru, je suis engag√© dans le front-end.  De plus, en tant que membre de la communaut√© front-end Spb, j'aide √† organiser les mitaps.  Je fais le podcast Drinkcast, nous invitons des personnes int√©ressantes et discutons de divers sujets. <br><br>  Quelle est l'essence du jouet?  Tout d'abord, vous devez choisir une unit√© parmi celles propos√©es, c'est un tel syst√®me RPG: chaque unit√© a ses propres forces et faiblesses.  Vous voyez quelles unit√©s l'ennemi a choisies, et choisissez pour vous venger.  Ensuite, vous devez √©crire en JavaScript un script pour le comportement de votre arm√©e - en d'autres termes, le script "ce que chaque unit√© doit faire sur le champ de bataille". <br><br>  Cela se fait en mode d√©bogage: en fait, vous d√©bitez le code, puis les deux adversaires poussent leur code, et la bataille entre les deux c√¥t√©s commence. <br><br>  Ainsi, vous pouvez voir comment deux scripts, deux logiques, deux algorithmes s'affrontent.  J'ai toujours voulu faire quelque chose comme √ßa, et maintenant c'est enfin impl√©ment√©. <br><br>  En action, tout ressemble √† ceci: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LfgaRFnmkhk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Et √† quoi ressemblait le travail?  Beaucoup de travail a √©t√© consacr√© √† la documentation.  Lorsque le joueur s'assoit devant l'ordinateur portable, il voit la documentation, dans laquelle tout est d√©crit assez en d√©tail. <br><br>  Il m'a fallu beaucoup de temps pour sa mise en page, sa r√©vision et son interrogation aupr√®s des gens pour savoir si elle √©tait claire.  En cons√©quence, cela s'est av√©r√© clairement pour sishnikov, javists et autres d√©veloppeurs qui ne connaissent rien de JS.  Vous pouvez m√™me promouvoir JavaScript avec ce jouet: "Ce n'est pas effrayant, voyez comment vous pouvez √©crire dessus, m√™me quelque chose d'amusant se produit." <br><br><img src="https://habrastorage.org/webt/c3/9b/cf/c39bcfhakno9pvemjsm5rfj1_jo.png"><br><br>  Nous avons organis√© un grand tournoi dans notre entreprise, auquel pratiquement tous les programmeurs auxquels nous avons particip√©. <br><br>  De la technologie, j'ai utilis√© le moteur de jeu le plus populaire du monde de JS - Phaser.  L'√©diteur Ace le plus grand et le plus utilis√©.  Il s'agit d'un √©diteur sur le web, tr√®s similaire √† Sublime ou VSCode, il peut √™tre int√©gr√© dans une page web.  J'ai √©galement utilis√© RxJS pour travailler avec des interactions asynchrones de diff√©rents utilisateurs et Preact pour rendre le html.  Parmi les technologies natives, il a surtout travaill√© avec les travailleurs et le websocket. <br><br><img src="https://habrastorage.org/webt/hr/7e/hj/hr7ehjcuxfyljukymq0yeiwsvou.png"><br><br><hr><br><h2>  Jeux pour programmeurs </h2><br>  Quels sont les jeux pour les programmeurs en g√©n√©ral?  √Ä mon avis, ce sont des jeux o√π vous devez coder, puis obtenir un r√©sultat amusant qui peut √™tre compar√© √† quelqu'un, c'est une bataille.  Parmi ces jeux en ligne disponibles, je connais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Elevator Saga"</a> - vous √©crivez des scripts pour les ascenseurs en fonction de certains param√®tres.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Screeps¬ª</a> - sur la biologie, les mol√©cules, √©crivez des scripts pour elles. <br><br>  Il y a aussi des jouets qui sont parfois √† des conf√©rences.  Le plus populaire d'entre eux est ¬´Code in the Dark¬ª, nous l'avons √©galement pr√©sent√© aujourd'hui.  Au fait, ¬´Code in the dark¬ª m'a inspir√© √† certains √©gards. <br><br><img src="https://habrastorage.org/webt/di/ri/xp/dirixpaaxzsners2q5wbecnqf_i.png"><br><br>  Pourquoi cela at-il √©t√© fait?  J'ai eu la t√¢che dont vous avez besoin pour trouver quelque chose de cool avec un stand √† la conf√©rence, quelque chose d'inhabituel.  Non pas qu'il y ait des eychars avec des questionnaires.  Il est clair que tout le monde veut attirer l'attention et recueillir des contacts.  Nous avons d√©cid√© d'aller plus loin et avons trouv√© quelque chose de cool et amusant pour les programmeurs.  J'ai r√©alis√© que les programmeurs veulent se battre, rivaliser et nous devons leur donner une telle opportunit√©.  Il faut cr√©er un stand sur lequel ils viendront et coderont. <br><br>  Gamification  Nous l'avons fait non seulement parmi les programmeurs en exercice, mais aussi parmi les √©tudiants.  Nous avons organis√© de tels matchs dans les instituts le jour de la carri√®re.  Nous devions en quelque sorte voir quel genre de gars il y avait, qui nous convenait ou non.  Nous avons utilis√© la gamification pour attirer les gens dans le processus, pour voir comment ils agissent, ce qu'ils font.  Ils ont jou√© et ont √©t√© distraits, mais cela nous a donn√© des informations.  Certains ont pouss√© du code sans m√™me l'ex√©cuter une seule fois, et il √©tait imm√©diatement √©vident qu'il √©tait trop t√¥t pour le d√©veloppement. <br><br><img src="https://habrastorage.org/webt/zy/j7/-d/zyj7-dtcxgbzsnlm6eiakic1pri.png"><br><br>  √Ä quoi cela ressemblait dans la premi√®re version.  C'√©tait un √©cran principal et deux ordinateurs portables pour les joueurs.  Tout cela a contact√© le serveur, le serveur a stock√© l'√©tat et l'a fouill√© entre tous les clients connect√©s.  Chaque √©cran √©tait un client connect√©.  Les ordinateurs portables des joueurs √©taient des √©crans interactifs √† partir desquels cet √©tat pouvait √™tre chang√©.  Les √©crans sont attach√©s de mani√®re rigide √† un serveur. <br><br><h2>  Manque de temps </h2><br>  La premi√®re histoire que j'ai rencontr√©e dans ce d√©veloppement est l'histoire que j'ai eu tr√®s peu de temps.  Litt√©ralement en cinq minutes une id√©e est venue, en cinq secondes un nom a √©t√© invent√© quand il a √©t√© n√©cessaire de cr√©er un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©f√©rentiel</a> sur GitHub.  Je pouvais tout d√©penser quatre heures le soir, les √©loigner m√™me de ma femme.  En cons√©quence, il ne me restait que trois semaines avant la conf√©rence pour r√©aliser cela au moins d'une mani√®re ou d'une autre.  Tout a commenc√© de sorte qu'il √©tait juste n√©cessaire de trouver une id√©e dans le cadre d'un brainstorming, en cinq minutes l'id√©e est n√©e: ¬´√âcrivons une sorte d'intelligence artificielle pour RPG en JS¬ª.  C'est cool, amusant, je peux l'impl√©menter. <br><br><img src="https://habrastorage.org/webt/un/tq/kh/untqkhyleylozw4th97etc8grc0.png"><br><br>  Dans la premi√®re impl√©mentation, l'√©cran avait un √©diteur de code et un √©cran de bataille, sur lesquels se d√©roulait la bataille elle-m√™me.  Phaser, Ace Editor et pure Node.js ont √©t√© utilis√©s comme serveur sans framework.  Ce que j'ai regrett√© plus tard, cependant, mais rien de sp√©cial n'√©tait requis du serveur. <br><br><img src="https://habrastorage.org/webt/_g/lz/uz/_glzuzkixm5rkvgffsvxc6i0txi.png"><br><br>  J'ai r√©ussi √† r√©aliser alors Renderer, qui a peint la bataille elle-m√™me.  La partie la plus difficile √©tait le bac √† sable pour le code JS, c'est-√†-dire un bac √† sable dans lequel tout √©tait cens√© √™tre ex√©cut√© de mani√®re isol√©e pour chaque joueur.  Il y avait √©galement un partage d'√©tat qui provenait du serveur.  Les joueurs ont en quelque sorte chang√© d'√©tat, l'ont jet√© sur le serveur, le serveur a envoy√© le reste aux sockets Web.  Le serveur √©tait une source de v√©rit√© et tous les clients connect√©s faisaient confiance √† ce qui provenait du serveur. <br><br><h2>  Sandbox </h2><br>  Qu'est-ce qui est si difficile √† mettre en ≈ìuvre un bac √† sable?  Le fait est que le bac √† sable est le monde entier pour le code dans lequel le code doit exister.  Autrement dit, vous cr√©ez pour lui environ le m√™me monde qu'autour, mais uniquement compos√© de quelques conventions, √† partir d'une API avec laquelle vous pouvez interagir.  Comment impl√©menter cela sur JS?  Il semble que JS ne soit pas capable de cela, il est si plein de trous et gratuit qu'il ne fonctionnera tout simplement pas pour enfermer compl√®tement le code utilisateur dans une bo√Æte sans utiliser une machine virtuelle distincte avec un syst√®me d'exploitation distinct. <br><br><img src="https://habrastorage.org/webt/gb/ok/yi/gbokyimz5h1piufn5yfoudov554.png"><br><br>  Que doit faire le bac √† sable? <br><br>  Tout d'abord, comme je l'ai dit, isolez le code.  Ce doit √™tre un monde dont on ne peut sortir. <br><br>  De plus, l'API de gestion d'unit√© doit y √™tre lanc√©e.  Les joueurs doivent interagir avec le champ de bataille, d√©placer des unit√©s, les diriger, leur donner un vecteur d'attaque. <br>  Et toutes les actions des unit√©s sont asynchrones, c'est-√†-dire qu'elles devraient en quelque sorte fonctionner avec du code asynchrone. <br><br><img src="https://habrastorage.org/webt/or/q1/y1/orq1y1fcofatt5oz2qieinaixay.png"><br><br>  Qu'est-ce que je voulais dire √† propos de l'asynchronie?  Le fait est que dans JS, il est essentiellement mis en ≈ìuvre √† l'aide de promesses.  Tout est clair pour tout le monde ici, les promesses sont une bonne chose, elles fonctionnent parfaitement, nous avons presque toujours √©t√© avec nous.  Pendant de nombreuses ann√©es, tout le monde sait comment travailler avec eux, mais ce jouet n'√©tait pas uniquement destin√© aux javascripts.  Imaginez si je commen√ßais √† expliquer aux Javists comment √©crire un code de bataille en utilisant des promesses?  Comment faire alors-alors-alors, pourquoi parfois ce n'est pas n√©cessaire ... Que faire des conditions ou des boucles? <br><br><img src="https://habrastorage.org/webt/z2/qn/ir/z2qnirhdy_puuuliwdnfu0sxalg.png"><br><br>  Vous pouvez, bien s√ªr, emprunter la meilleure voie et prendre la syntaxe async / wait.  [Diapositive 8:57] Mais pouvez-vous √©galement imaginer comment les programmeurs non javascript peuvent expliquer que vous devez mettre en attente avant presque chaque ligne?  Par cons√©quent, la meilleure fa√ßon de travailler avec l'asynchronie est de ne pas l'utiliser du tout. <br><br><img src="https://habrastorage.org/webt/vm/yd/bi/vmydbi-ocp9npyl56wzqv-rnr4e.png"><br><br>  Cr√©ez le code le plus synchrone et l'API la plus simple, semblable √† presque tous les langages de programmation.  Nous fabriquons un jouet non seulement pour les personnes qui √©crivent en JS, nous voulons le rendre accessible √† tous ceux qui savent coder. <br><br><img src="https://habrastorage.org/webt/ng/et/2d/nget2dl8vrmwwi3y608ztrpn2pk.png"><br><br>  Nous devons tous en quelque sorte commencer.  L'utilisateur √©crit le code, et nous devons l'ex√©cuter, d√©placer les unit√©s sur la carte.  La premi√®re chose qui me vient √† l'esprit est que nous avons besoin de eval () plus la d√©claration non recommand√©e avec, qui n'est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pas recommand√©e pour une utilisation sur MDN</a> .  Cela fonctionnera, mais il y a des probl√®mes. <br><br><img src="https://habrastorage.org/webt/ca/18/5a/ca185aygesba1t6wuxfymhvkghi.png"><br><br>  Par exemple, nous avons du code qui d√©truit compl√®tement notre id√©e enti√®re, ce qui nous emp√™che de faire quoi que ce soit d'autre.  C'est du code qui bloque l'ex√©cution.  Quelque chose doit √™tre fait pour que l'utilisateur ne puisse pas bloquer l'application.  Par exemple, une boucle sans fin peut tout casser.  Si alert () et prompt () peuvent encore √™tre red√©finis, nous ne pouvons pas du tout red√©finir une boucle infinie. <br><br><h2>  eval () est mauvais </h2><br>  Nous arrivons donc au point o√π eval () est mauvais.  Ce n'est pas pour rien qu'ils l'appellent le mal, car c'est une fonction insidieuse qui int√®gre en fait tout ce qui est le plus libre et ouvert qui soit dans JS, et nous laisse compl√®tement sans d√©fense.  Avec une fonction simple, nous faisons un √©norme trou dans notre application. <br><br><img src="https://habrastorage.org/webt/-e/1s/yv/-e1syve2mujeqy_vpnr3obdk7sk.png"><br><br>  Mais si je vous dis, <i>[dans la voix de Steve Jobs]</i> que nous avons r√©invent√© eval ()? <br><br>  Nous avons fait eval () sur d'autres technologies, cela fonctionne presque de la m√™me mani√®re que le m√™me eval () que nous avons d√©j√†.  En fait, j'ai une fonction eval () dans mon code, mais impl√©ment√©e √† l'aide de Workers, de l'instruction with et du proxy. <br><br><img src="https://habrastorage.org/webt/wf/gj/ox/wfgjoxy3qrjkfnrnpvq-o06xr8k.png"><br><br>  Pourquoi les travailleurs?  Le fait est qu'ils cr√©ent un thread d'ex√©cution distinct, c'est-√†-dire que JS est un thread unique, mais gr√¢ce aux travailleurs, nous pouvons obtenir un autre thread.  Cela nous donne de nombreux avantages.  Par exemple, dans les m√™mes boucles sans fin, nous pouvons interrompre le thread cr√©√© par le biais de worker √† partir du thread principal, c'est peut-√™tre la principale raison pour laquelle j'ai utilis√© des travailleurs.  Si le travailleur a r√©ussi √† travailler plus vite qu'en une seconde, on le consid√®re comme r√©ussi, on obtient son r√©sultat.  Sinon, nous le coupons.  En fait, le code utilisateur pour une raison quelconque n'a pas fonctionn√©, des erreurs √©tranges se sont produites ou il a √©t√© ralenti en raison d'une boucle infinie.  Beaucoup aujourd'hui ont essay√© d'√©crire alors que (vrai), j'ai averti que cela ne fonctionnerait pas. <br><br><img src="https://habrastorage.org/webt/ee/en/va/eeenvauyaknpsa7hizr52fvkcwk.png"><br><br>  Pour √©crire notre travailleur, nous avons juste besoin de transmettre le script au constructeur du travailleur, qui sera t√©l√©charg√© via http.  Dans le script, nous devons cr√©er un gestionnaire de messages √† partir du thread principal.  En utilisant la fonction postMessage () √† l'int√©rieur de worker, nous pouvons router les messages vers le thread principal.  De cette fa√ßon, nous faisons la communication entre les deux fils.  Une API simple assez pratique, mais il manque quelque chose, √† savoir le code utilisateur que nous devons ex√©cuter dans ce travailleur.  Nous ne g√©n√©rerons pas √† chaque fois un fichier de script sur le serveur et le transmettrons au travailleur. <br><br><img src="https://habrastorage.org/webt/u2/4h/ia/u24hian_cjbwwi-06mtfn6qldmo.png"><br><br>  J'ai trouv√© un moyen d'utiliser URL.createObjectURL ().  Nous faisons un bloc et le nourrissons au travailleur src.  Ainsi, il d√©charge notre code directement de la ligne.  Soit dit en passant, cela fonctionne avec tous les objets dans le DOM qui ont src - image fonctionne comme ceci, par exemple, et m√™me dans un iframe, vous pouvez charger du HTML simplement en le g√©n√©rant √† partir d'une cha√Æne.  Assez cool et flexible, je pense.  Nous pouvons √©galement g√©rer le travailleur en lui passant simplement notre objet sp√©cialement g√©n√©r√© √† partir de l'URL.  Nous pouvons √©galement y mettre fin et cela fonctionne d√©j√† selon nos besoins, et nous avons cr√©√© le premier bac √† sable. <br><br><img src="https://habrastorage.org/webt/mq/kp/mk/mqkpmkw8-ufofb05g8qb94-mzm4.png"><br><br>  Les interactions asynchrones vont plus loin, car tout travail avec des travailleurs est asynchrone.  Nous avons envoy√© un message et nous ne pouvons pas attendre le message suivant de mani√®re synchrone, le travailleur ne nous renvoie que l'instance et nous pouvons nous abonner aux messages.  Nous interceptons le message √† l'aide de RxJS, nous cr√©ons deux threads: l'un pour un message r√©ussi du travailleur, le second pour l'ach√®vement par timeout.  Deux threads que nous contr√¥lons ensuite avec leur fusion. <br><br><img src="https://habrastorage.org/webt/-x/mt/ny/-xmtnyqc5ytkd6w2zkzdeqfgsws.png"><br><br>  RxJS a des op√©rateurs qui nous permettent de travailler avec des threads.  En fait, c'est comme lodash pour les op√©rations synchrones.  Nous pouvons indiquer une fonction et ne pas penser √† la fa√ßon dont elle est impl√©ment√©e √† l'int√©rieur, cela nous soulage d'un mal de t√™te.  Nous devons commencer √† penser dans les threads, l'op√©rateur de fusion fusionne nos threads, r√©pond √† tout message.  Il r√©pondra √† la fois au d√©lai d'expiration et au message.  Nous n'avons besoin que du tout premier message, respectivement, apr√®s le premier message que nous terminons travailleur.  En cas d'erreur, imprimez cette erreur; en cas de succ√®s, nous r√©solvons. <br><br><img src="https://habrastorage.org/webt/l0/fj/lr/l0fjlrbzawogdkbhwkwkci-1osi.png"><br><br>  Tout est assez simple ici.  Notre code devient d√©claratif, la complexit√© de l'asynchronie va quelque part.  L'essentiel est d'apprendre ces op√©rateurs. <br><br><img src="https://habrastorage.org/webt/mi/oc/ev/miocevejr1in0eyfg30wqmozb10.png"><br><br>  C'est ainsi que nous travaillons avec l'API Unit.  Je voulais que l'API Unit soit aussi simple que possible.  En parlant de JS, beaucoup de gens pensent que c'est difficile, il faut grimper quelque part, apprendre quelque chose.  Et je voulais le rendre aussi simple que possible: tout dans le domaine global, il n'y a que la port√©e de l'API Unit, rien de plus.  Tout pour la gestion des unit√©s, m√™me la saisie semi-automatique. <br><br><img src="https://habrastorage.org/webt/nl/-c/v8/nl-cv8_2s_3134omu8mqeanuiis.png"><br><br>  [Diapositive 15:20] La solution sugg√®re que tout cela peut √™tre pouss√© dans le tr√®s interdit avec d√©claration.  Comprenons pourquoi c'est interdit. <br><br>  Le fait est qu'avec a ses probl√®mes.  Par exemple, avec, malheureusement, fuit en dehors de la port√©e que nous y avons jet√©e, car il essaie de regarder plus profond√©ment que l'API Unit et regarde dans la port√©e globale. <br><br><img src="https://habrastorage.org/webt/tt/hw/gg/tthwggh1janwscz0t9poham_x44.png"><br>  Ici, le dernier exemple est particuli√®rement cool, car m√™me un quatre peut √™tre dangereux pour notre code, car toutes ces fonctions peuvent √™tre effectu√©es par le code utilisateur.  L'utilisateur peut tout faire.  C'est un jeu pour les programmeurs, et ils aiment explorer les probl√®mes et les moyens de pirater quelque chose. <br><br><img src="https://habrastorage.org/webt/b4/e0/hb/b4e0hbfhxr1l7xn51miw-qk8bzk.png"><br><br>  Comme je l'ai dit, les √©tendues sont tr√®s fuyantes, donc une √©tendue globale est toujours disponible.  Quel que soit le nombre d'√©tendues que nous d√©limitons sur notre code personnalis√©, quel que soit le nombre d'√©tendues que nous enveloppons, l'√©tendue globale sera toujours visible.  Et tout cela gr√¢ce √†. <br><br>  En fait, il n'isole rien, il nous ajoute juste une nouvelle couche d'abstraction, une nouvelle port√©e globale.  Mais nous pouvons changer ce comportement avec Proxy. <br><br><img src="https://habrastorage.org/webt/zz/ed/qq/zzedqqwgeq-gxquunu4_ypeatak.png"><br><br>  Le fait est que Proxy s'occupe de tous nos appels √† l'objet qui sont mandat√©s via la nouvelle API, et nous pouvons contr√¥ler le comportement des nouvelles demandes de donn√©es dans cet objet. <br><br><img src="https://habrastorage.org/webt/1u/lh/xa/1ulhxahfzy_yahdczgj7jbmacaw.png"><br><br>  En fait, avec des ≈ìuvres tout simplement.  Lorsque nous lui fournissons une sorte de variable, il v√©rifie sous le capot si cette variable est dans l'objet (c'est-√†-dire qu'elle ex√©cute l'op√©rateur in), et si c'est le cas, elle l'ex√©cute dans l'objet, et sinon, elle s'ex√©cute dans la port√©e sup√©rieure, dans Notre cas est mondial.  C'est assez simple ici.  La principale chose que le proxy nous aide est que nous pouvons remplacer ce comportement. <br><br><img src="https://habrastorage.org/webt/c0/jg/ie/c0jgie64g9zgd4fukgnjadkj2g4.png"><br><br>  Il existe des crochets dans Proxy.  Une chose merveilleuse qui nous permet de proxy toutes les demandes √† l'objet.  Nous pouvons changer le comportement de la demande d'attribut, changer le comportement de la t√¢che d'attribut et, surtout, nous pouvons changer le comportement de ceci dans l'op√©rateur.  Il y a un hame√ßon, auquel on ne peut retourner que vrai.  Ainsi, nous prenons et trompons compl√®tement notre d√©claration with, ce qui rend notre API beaucoup plus s√©curis√©e qu'auparavant. <br><br><img src="https://habrastorage.org/webt/4w/-n/vy/4w-nvyhnsledhvcyl0tetw33hvq.png"><br><br>  Si nous essayons d'ex√©cuter eval (), il demandera d'abord si cet eval () est dans unitApi, ils r√©pondront ¬´oui¬ª et obtiendront ¬´undefined n'est pas une fonction¬ª.  Cela semble √™tre la premi√®re fois que je suis satisfait de cette erreur!  Cette erreur est exactement ce que nous aurions d√ª recevoir.  Nous l'avons pris et avons dit √† l'utilisateur: "D√©sol√©, oubliez tout ce que vous saviez sur l'objet fen√™tre, ce n'est plus."  Nous avons d√©j√† laiss√© certains des probl√®mes, mais ce n‚Äôest pas tout. <br><br><img src="https://habrastorage.org/webt/fo/yw/a2/foywa2mzbpbijvc3ndgpq-9tpxw.png"><br><br>  Le fait est que l'instruction with est tout de m√™me de JS, JS est dynamique et un peu bizarre.  Ce qui est √©trange, c'est que tout ne fonctionne pas comme nous le souhaiterions, sans examiner les sp√©cifications.  Le fait est qu'avec fonctionne √©galement avec les propri√©t√©s du prototype.  Autrement dit, nous pouvons ringard lui nourrir un tableau, ex√©cuter ce code obscur.  Toutes les fonctions de tableau sont disponibles comme globales dans cette port√©e, ce qui semble un peu √©trange. <br><br><img src="https://habrastorage.org/webt/ih/2g/yr/ih2gyrz7isyixyvx7bswlamgvbe.png"><br><br>  Ce n'est pas important pour nous, il est important pour nous que l'utilisateur puisse ex√©cuter valueOf () et obtenir tout notre sandbox.  Prenez et ramassez directement, voyez ce qu'il contient.  Je ne le voulais pas non plus, donc une chose int√©ressante a √©t√© introduite dans la sp√©cification: Symbol.unscopables.  Autrement dit, dans la nouvelle sp√©cification pour les symboles, Symbol.unscopables a √©t√© introduit sp√©cifiquement pour l'instruction with, ce qui est interdit.  Parce qu'ils croient que quelqu'un d'autre l'utilise.  Par exemple, moi! <br><br><img src="https://habrastorage.org/webt/fv/9o/ns/fv9ons58tbtnrnc5rp7biuexgfk.png"><br><br>  Ainsi, nous allons faire un autre intercepteur, o√π nous v√©rifierons sp√©cifiquement si ce symbole est dans la liste de tous les attributs non extensibles.  Sinon, retournez-le, mais si oui, alors d√©sol√©, nous ne reviendrons pas.  Nous ne l'utilisons pas non plus.  Et donc, avec nous ne pouvons m√™me pas obtenir un prototype de notre bac √† sable. <br><br><img src="https://habrastorage.org/webt/07/5h/tt/075httw1dt0ekhe37frcstztzri.png"><br><br>  Nous avons toujours l'environnement Worker.  C'est quelque chose qui se bloque dans une zone globale et qui est toujours accessible.  Le fait est que si vous remplacez simplement cela, il sera disponible dans le prototype.  Presque tout peut √™tre retir√© via le prototype de JS.  √âtonnamment, toutes ces m√©thodes sont toujours disponibles via le prototype. <br><br><img src="https://habrastorage.org/webt/po/mt/fl/pomtflwlmxujubh-l8qzqqn2drg.png"><br><br>  Je devais juste prendre et nettoyer tout √ßa.  Nous passons en revue toutes les cl√©s et nettoyons tout. <br><br><img src="https://habrastorage.org/webt/zg/9k/at/zg9katqtaothaqjip6trmosdig0.png"><br><br>  Et puis nous laissons un petit ≈ìuf de P√¢ques √† l'utilisateur, qui essaie toujours d'appeler cela.  Nous prenons la fonction habituelle, l'essentiel n'est pas la fonction fl√®che, qui a une port√©e, et changeons sa port√©e en notre objet, dans lequel nous laissons un petit ≈ìuf de P√¢ques pour un utilisateur particuli√®rement curieux qui veut afficher ceci ou lui-m√™me dans la console.  Je pense que les ≈ìufs de P√¢ques sont merveilleux et devraient √™tre laiss√©s dans le code. <br><br><img src="https://habrastorage.org/webt/_s/7r/fq/_s7rfqdggfjikj2rjm7rcmhwja8.png"><br><br>  Il s'av√®re en outre qu'ils ne sont rest√©s qu'avec notre API d'unit√©.  Nous avons tout bloqu√© compl√®tement - en fait, nous avons laiss√© une liste blanche.  Nous devons ajouter les API utiles et n√©cessaires.  Par exemple, l'API Math, qui a une fonction al√©atoire utile que de nombreuses personnes utilisent lors de l'√©criture de code pour les unit√©s. <br><br>  Nous avons √©galement besoin d'une console et de nombreuses autres fonctions utilitaires qui n'ont aucune fonction destructrice.  Nous cr√©ons une liste de temps pour nos API.  ,       blacklist,       ,     . <br><br><img src="https://habrastorage.org/webt/nz/mc/0o/nzmc0or7a_svlqdlhcdg36_bzi8.png"><br><br>  whitelist,     try-catch   .           ,     . <br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br>    ,     Worker       .  ,        worker,    ,    ¬´   ,    ¬ª   .       ,       JavaScript       ,  . <br><br>  ,    , -   .      ,     .      ,         webpack   . <br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br>      patchMethod(),     ,     postMessage().    postMessage()   console log, error, warn, info.        ,    .  ,       &lt;div&gt;,      ,    ,      ,     ,        . <br><br><img src="https://habrastorage.org/webt/nf/oq/yw/nfoqywkngugbgug6i5wwv_tpuhy.png"><br><br>     ,      .      : -   -  ‚Äî   ,     ,  -     . , ,    promises.   ,        actions,       . <br><br><img src="https://habrastorage.org/webt/jl/np/2f/jlnp2fcxsgtmghti8wzt4iwzbki.png"><br><br>          actions.   ,     real-time ?   ,  real-time    workers    ,        worker,       .       - ,    .    ,    , .   ,      ,   .        . <br><br><img src="https://habrastorage.org/webt/lk/zb/xp/lkzbxpal1f_bkmcq1pyk5sto8ey.png"><br><br>     workers,       .  workers ,           .      ,   .  ,     ,    (   ,  ),            .  :    ‚Äî . <br><hr><br><h2>  Math.random() </h2><br>   ,   ,         ,     .      Math.random(). <br><br>     ,   ,      ,                   .   ,  Math.random()     - . <br><br><img src="https://habrastorage.org/webt/g5/xs/zj/g5xszjwvqxhjxp4slm1hfmdfct4.png"><br><br>  ,     ,        (   ), JS   ,        .         . <br><br><img src="https://habrastorage.org/webt/ds/ic/sy/dsicsy7ra1vb8fuzq6xkry7y9zg.png"><br><br>   ,              ,  ,          .       ,    - . <br><br>            ,      . ,        random(),     . <br><br><img src="https://habrastorage.org/webt/cp/ew/ou/cpewoullokdb8p903gddmmgguj8.png"><br><br>  ,  random()     ‚Äî  ¬´ ¬ª      ,      .    ,    -  ,     random() ,       .    -    ,     .   ,          ,  random()    . <br><br><img src="https://habrastorage.org/webt/hu/tp/ot/hutpotesuqtwdc_p7yqelekwpjk.png"><br><br>       .    ,   ,   random()  .   - seed          (  ,        ,   ). <br><br><img src="https://habrastorage.org/webt/of/xs/da/ofxsdamysx7gcyfjgctqw1o72o0.png"><br>     ,     .            ,      random().                  ,  random()     -. <br><br>  <a href=""></a>  ,    worker,    ,   JS  .  ¬´¬ª ‚Äî     .   .     ,    JS .    random()  unit API.       ,    worker. <br><hr><br><br><h2> State sharing: RxJS,    </h2><br>  Nous avons donc compris ce que nous avons avec le client.  Parlons maintenant du partage de l'√âtat, pourquoi cela est n√©cessaire et comment il a √©t√© organis√©.  Nous avons l'√©tat stock√© sur le serveur, le serveur doit le t√¢tonner avec les clients connect√©s.  [Diapositive 28:48] <br><br>  Nous avons quatre r√¥les de clients diff√©rents qui peuvent se connecter au serveur: ¬´utilisateur gauche¬ª, ¬´utilisateur droit¬ª, un visualiseur qui regarde l'√©cran principal et un administrateur qui peut tout faire. <br><br>  L'√©cran de gauche ne peut pas changer l'√©tat du bon joueur, le spectateur ne peut rien changer et l'administrateur peut tout faire. <br><br><img src="https://habrastorage.org/webt/qo/nw/xz/qonwxz54aiudwbywh6msiilucss.png"><br><br>  Pourquoi √©tait-ce un probl√®me?  Tout est arrang√© simplement.  Tout client connect√© peut lancer une session, le serveur l'accepte et la fusionne avec state, qui se trouve √† l'int√©rieur du serveur, puis la distribue √† tous les clients.  Il t√¢tonne pour tous les changements qui lui viennent.  Il fallait en quelque sorte le filtrer. <br><br><img src="https://habrastorage.org/webt/th/ol/vu/tholvuuygb9shbr5-de-aemuxs8.png"><br><br>  Tout d'abord, je dirai pourquoi le serveur a √©galement RxJS.  Toutes les interactions avec deux ou plusieurs utilisateurs connect√©s deviennent asynchrones.  Il faut attendre les r√©sultats des deux utilisateurs.  Par exemple, les deux utilisateurs ont cliqu√© sur le bouton "Terminer", vous devez attendre que les deux cliquent, puis effectuer l'action.  C'√©tait assez simple sur RxJS de cette fa√ßon: <br><br><img src="https://habrastorage.org/webt/xa/dp/6z/xadp6zds6_xaucjyb7hdrpskcmu.png"><br><br>  Nous fonctionnons √† nouveau avec des threads, il y a un flux depuis le socket, qui est appel√© socket.  Pour cr√©er un thread qui ne surveille que le joueur de gauche, nous prenons et filtrons simplement les messages de cette prise par le joueur de gauche (et de m√™me avec le droit).  Ensuite, nous pouvons les combiner en utilisant l'op√©rateur forkJoin (), qui fonctionne comme Promise.all () et est son analogue.  Nous attendons ces deux actions et appelons la m√©thode setState (), qui d√©finit notre √©tat sur ¬´pr√™t¬ª.  Il s'av√®re que nous attendons les deux joueurs et changeons l'√©tat du serveur.  Sur RxJS, cela sort aussi d√©claratif que possible, c'est pourquoi je l'ai utilis√©. <br><br>  Il reste un probl√®me avec le fait que les joueurs peuvent changer d'√©tat entre eux.  Il faut leur interdire de le faire.  Pourtant, ce sont des programmeurs, il y avait des pr√©c√©dents que quelqu'un essayait.  Cr√©ons pour eux des classes distinctes h√©rit√©es du client. <br><br><img src="https://habrastorage.org/webt/jz/9-/6v/jz9-6vskw2b3lqcf3fxasd2w4kq.png"><br><br>  Ils auront la logique de base de la communication du joueur avec le serveur, et dans chaque classe particuli√®re, il y aura sa logique personnalis√©e pour filtrer les donn√©es. <br><br>  Le client est en fait un pool de connexions, des connexions avec des clients. <br><br><img src="https://habrastorage.org/webt/sc/qz/kl/scqzklyflx8hylw3stj7drudpdy.png"><br><br>  Il les stocke simplement et il a le flux onUnsafeMessage, qui est compl√®tement dangereux: il ne peut pas lui faire confiance, ce ne sont que des messages bruts de l'utilisateur qu'il re√ßoit.  Nous √©crivons ces messages bruts dans le flux. <br><br>  De plus, lors de la mise en ≈ìuvre d'un lecteur sp√©cifique, nous prenons ceci surUnsafeMessage et le filtrons. <br><br><img src="https://habrastorage.org/webt/yn/z0/1k/ynz01kbib00wt83k_5jwx5ix3ku.png"><br><br>  Nous devons filtrer uniquement les donn√©es que nous pouvons obtenir de ce joueur, en qui nous pouvons avoir confiance.  Le joueur de gauche ne peut changer que l'√©tat du joueur de gauche, respectivement, nous prenons de toutes les donn√©es qu'il pourrait envoyer, uniquement l'√©tat du joueur de gauche.  Si vous ne l'avez pas envoy√©, d'accord.  Si envoy√© - nous prenons.  Ainsi, √† partir de messages compl√®tement dangereux, nous obtenons des messages s√ªrs auxquels nous pouvons faire confiance lorsque nous travaillons dans la pi√®ce. <br><br><img src="https://habrastorage.org/webt/g3/-a/dg/g3-adglwnncvagey8nojzmksixw.png"><br><br>  Nous avons des salles de jeux qui r√©unissent les joueurs.  √Ä l'int√©rieur de la salle, nous pouvons √©crire les fonctions m√™mes qui peuvent changer d'√©tat directement, simplement en souscrivant √† ces flux, auxquels nous pouvons d√©j√† faire confiance.  Nous avons r√©sum√© un tas de ch√®ques.  Nous avons effectu√© les v√©rifications en fonction des r√¥les et les avons appel√©s classes distinctes.  Nous avons divis√© le code de telle mani√®re qu'√† l'int√©rieur du contr√¥leur, o√π les fonctions importantes de changement d'√©tat sont ex√©cut√©es, le code est devenu aussi simple et d√©claratif que possible. <br><br>  RxJS est √©galement utilis√© sur le client, il est connect√© √† la prise au verso, √©met des √©v√©nements et les redirige de toutes les mani√®res. <br><br>  Dans ce cas, je voudrais faire un exemple lorsque je dois changer l'arm√©e de l'adversaire droit. <br><br><img src="https://habrastorage.org/webt/qf/u8/oy/qfu8oy7syyrcekd2z424rxuhplw.png"><br><br>  Pour y souscrire, nous cr√©ons un flux √† partir de la m√™me socket et le filtrons.  Nous nous assurons que c'est vraiment le bon joueur, et prenons un message de lui sur ce qu'est son arm√©e.  S'il n'y a pas un tel message, le flux ne renverra rien, il n'y aura pas un seul message, il restera silencieux jusqu'√† ce que le joueur change d'arm√©e.  Nous r√©solvons imm√©diatement de mani√®re d√©clarative le probl√®me du filtrage des √©v√©nements, nous ne l'avons pas ringard. <br><br>  Et quand quelque chose est d√©j√† venu du flux, nous appelons la fonction setState ().  C'est assez simple, l'approche m√™me qui nous permet de tout faire de mani√®re transparente et d√©clarative.  La chose m√™me pour laquelle j'ai pris le projet RxJS et en quoi cela m'a beaucoup aid√©. <br><br><img src="https://habrastorage.org/webt/gy/p9/qc/gyp9qchh3hadurc4_vmg0vjj1u4.png"><br><br>  Je cr√©e des flux que j'ai clairement nomm√©s, avec lesquels je comprends comment travailler, tout est d√©claratif, les fonctions n√©cessaires sont appel√©es, il n'y a pas de probl√®me avec beaucoup d'√©v√©nements if et de filtrage, tout cela est fait par RxJS. <br><br><h2>  Histoire: du solo au multijoueur </h2><br><br>  Donc, la premi√®re version de mon jouet a √©t√© √©crite.  On peut dire que c'√©tait un seul joueur, car seulement deux joueurs pouvaient y jouer, le nombre de clients connect√©s √©tait fixe.  Nous avions un joueur de gauche, un joueur de droite et l'√©cran derri√®re, le tout connect√© directement au serveur.  Tout √©tait enduit dur, mais en trois semaines, cela a √©t√© fait. <br><br>  J'ai re√ßu une nouvelle offre: √©tendre le jouet √† tous les programmeurs de l'entreprise afin qu'ils puissent l'ouvrir et le jouer sur leurs ordinateurs.  Pour que nous obtenions une liste de leaders, multijoueurs afin qu'ils puissent jouer ensemble.  Puis j'ai r√©alis√© que j'avais beaucoup de refactoring. <br><br><img src="https://habrastorage.org/webt/qy/vs/-k/qyvs-khwziiaiv8xyfsnvcrlark.png"><br><br>  Ce ne fut pas si difficile.  J'ai simplement combin√© toutes les entit√©s que j'avais dans des pi√®ces s√©par√©es.  J'ai eu l'essence de "Room", qui pouvait combiner tous les r√¥les.  Ce ne sont plus les joueurs eux-m√™mes qui communiquent directement avec le serveur, mais les salles.  Les chambres ont d√©j√† envoy√© des requ√™tes par proxy directement au serveur, rempla√ßant l'√©tat, et l'√©tat est devenu distinct pour chaque chambre. <br><br><img src="https://habrastorage.org/webt/cc/au/tt/ccautts_bfhkftuja4joqqeg9vm.png"><br><br>  J'ai tout pris et r√©√©crit, ajout√© une liste de leaders, nous avons d√©cern√© les meilleurs prix.  Il fallait juste avoir un grand nombre d'utilisateurs, il √©tait d√©j√† impossible de suivre tout le monde, il fallait √©crire quelque chose o√π collecter toutes les donn√©es. <br><br><h2>  JS Gamedev et ses probl√®mes </h2><br><br>  Ainsi, je me suis familiaris√© plus s√©rieusement avec le JS-gamedev.  Je me suis dandin√© sur le dernier projet pendant environ trois ans, me reposant p√©riodiquement.  Et ici, j'ai eu les deux fois pendant trois semaines.  Chaque jour, je m'asseyais et faisais quelque chose le soir. <br><br>  Quels sont les probl√®mes de d√©veloppement de jeux sur JS?  Tout est diff√©rent de nos applications d'entreprise, o√π il n'est pas difficile d'√©crire quelque chose √† partir de z√©ro.  De plus, beaucoup de choses sont m√™me les bienvenues: nous ferons notre propre truc, nous souviendrons des histoires avec NPM et nous laisserons vous-m√™me. <br><br><img src="https://habrastorage.org/webt/f6/6l/zc/f66lzct-hy9vzyyixqvuplcd2qk.png"><br><br>  Il est impossible de le faire dans JS Gamedev, car toutes les technologies d'affichage des graphiques sont si bas qu'il est √©conomiquement peu rentable d'√©crire quelque chose dessus.  Si je prenais ce jouet et commen√ßais √† l'√©crire √† partir de z√©ro sur WebGL, je m'asseyais √©galement derri√®re lui pendant environ six mois, essayant juste de d√©couvrir quelques bugs √©tranges.  Le moteur de jeu le plus populaire Phaser m'a enlev√© ces probl√®mes ... <br><br><img src="https://habrastorage.org/webt/x1/zs/aa/x1zsaafnaxys0r9tssldvcper38.png"><br><br>  ... et m'en a ajout√© de nouveaux: 5 m√©gaoctets dans un bundle.  Et rien ne pouvait √™tre fait √† ce sujet; il ne sait pas du tout ce qu'est le tremblement des arbres.  De plus, seule la derni√®re version de Phaser peut fonctionner avec le pack Web et les bundles.  Avant cela, Phaser n'√©tait connect√© que dans la balise html du script, c'√©tait √©trange pour moi. <br><br>  Je viens de toutes sortes de scripts webpacks, et dans le d√©veloppement de jeux JS, presque rien ne peut le faire.  Tous les modules ont un typage extr√™mement m√©diocre ou ne l'ont pas du tout, ou ne savent pas comment utiliser le webpack, il a fallu trouver des moyens de le boucler.  Il s'est av√©r√© que m√™me Ace Editor dans sa forme pure ne fonctionne pas du tout avec webpack.  Pour commencer √† travailler, vous devez t√©l√©charger un package s√©par√© o√π il est d√©j√† envelopp√© (accolade). <br><br>  C'√©tait √† peu pr√®s la m√™me chose avec Phaser, mais dans la nouvelle version, ils l'ont fait plus ou moins normalement.  J'ai continu√© √† √©crire sur Phaser et j'ai trouv√© comment faire en sorte que tout fonctionne avec webpack comme nous le faisions auparavant: √† la fois la frappe et les tests pouvaient √™tre associ√©s √† tout cela.  J'ai trouv√© que vous pouvez prendre <a href="">PixiJS</a> s√©par√©ment, qui est un rendu de webpack, et y trouver de nombreux modules pr√™ts √† fonctionner avec. <br><br><img src="https://habrastorage.org/webt/cz/cf/o7/czcfo7ib3-d7n3w-l1rpzxfo8cw.png"><br><br>  PixiJS est une excellente biblioth√®que qui peut √™tre rendue sur WebGL ou sur Canvas.  De plus, vous pouvez m√™me √©crire du code comme pour Canvas, et il sera rendu dans WebGL.  Cette biblioth√®que peut rendre 2D tr√®s rapidement.  L'essentiel est de savoir comment cela fonctionne avec la m√©moire, afin de ne pas tomber dans une position lorsque la m√©moire est termin√©e. <br><br>  Je recommande s√©par√©ment le r√©f√©rentiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">awesome-pixijs</a> sur GitHub, o√π vous pouvez trouver diff√©rents modules.  J'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">surtout</a> aim√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">React-pixi</a> .  Nous pouvons simplement ignorer la r√©solution de probl√®mes avec la vue lorsque nous √©crivons des fonctions imp√©ratives directement dans le contr√¥leur pour dessiner des formes g√©om√©triques, des sprites, des animations, etc.  Nous pouvons tous annoter dans JSX.  Nous venons du monde JSX avec notre application m√©tier et pouvons les utiliser plus avant.  C'est pour cela que j'aime l'abstraction.  React-pixi nous donne cette abstraction famili√®re. <br><br>  Je vous conseille √©galement de prendre tween.js - le m√™me c√©l√®bre moteur d'animation de Phaser, qui vous permet de faire des animations d√©claratives qui sont quelque peu similaires aux animations CSS: nous faisons une transition entre les √©tats, et tween.js d√©cide pour nous exactement comment d√©placer l'objet. <br><br><h2>  Types de joueurs: qui ils sont et comment se lier d'amiti√© avec eux </h2><br>  J'ai rencontr√© diff√©rents joueurs et je voudrais √©galement vous parler du test du jouet.  J'ai rassembl√© des coll√®gues dans une pi√®ce ferm√©e et je ne les ai pas laiss√©s sortir jusqu'√† la fin du match.  Malheureusement, tout le monde n'a pas pu terminer le jeu, car au tout d√©but, j'avais beaucoup de bugs.  Heureusement, j'ai commenc√© les tests d√®s qu'au moins un prototype fonctionnel est apparu.  Honn√™tement, le premier test a √©chou√© car quelques joueurs n'ont rien commenc√©.  C'√©tait dommage, mais √ßa m'a donn√© un coup de pied qui m'a permis d'avancer. <br><br>  Lorsque votre jouet est pr√™t, vous pouvez tr√®s bien √™tre re√ßu, ou avec une fourche et des torches.  Tout le monde attend une sorte de fan des jeux, attendant le bonheur que vous leur donnerez.  Et vous leur donnez quelque chose qui ne fonctionne pas du tout, m√™me si cela semble fonctionner pour vous.  Lorsque vous avez un jouet en ligne, il y a encore plus de tels bugs. <br><br>  En cons√©quence, les personnes les plus agr√©ables que j'ai rencontr√©es sont des ¬´chercheurs¬ª qui trouvent toujours plus dans votre jouet qu'ils ne le sont vraiment.  Ils peuvent agr√©ablement le compl√©ter avec toutes sortes de petites choses, vous invitant √† ajouter quelque chose.  Mais, malheureusement, la communication avec ces personnes n'a pas donn√© la chose importante - la stabilit√© du jouet. <br><br>  Il y a des joueurs ordinaires qui viennent uniquement pour le plaisir du fan.  Parfois, ils ne remarquent m√™me pas les insectes, les glissant d'une mani√®re ou d'une autre sur leur chemin vers le plaisir. <br><br>  Les collecteurs de bogues sont une autre cat√©gorie, pour laquelle presque tout ne fonctionne pas.  Vous devez √™tre amis avec de telles personnes, bien qu'elles parlent beaucoup de n√©gativit√©.  Nous devons nouer d'√©tranges relations avec eux: ils vous font du mal et vous essayez de leur retirer quelque chose d'utile, ¬´asseyons-nous devant votre ordinateur et voyons¬ª.  Vous devez travailler avec eux, car ce sont ces personnes qui rendront votre jeu de qualit√©. <br><br>  Vous devez tester uniquement sur des personnes vivantes.  Votre ≈ìil est flou et les tests montreront certainement ce qui est cach√©.  Vous d√©veloppez un jouet et plongez plus profond√©ment, en sciant certaines fonctionnalit√©s, mais elles peuvent m√™me ne pas √™tre n√©cessaires.  Vous allez directement √† vos consommateurs, leur montrez et regardez comment ils jouent, sur quelles touches ils appuient.  Cela vous incite √† faire exactement ce dont vous avez besoin.  Vous voyez que certaines personnes appuient constamment sur Ctrl + S, car elles sont habitu√©es √† enregistrer le code - enfin, au moins faire fonctionner le code sur Ctrl + S, le joueur se sentira plus √† l'aise.  Vous devez cr√©er un environnement confortable pour le joueur, pour cela, vous devez l'aimer et le suivre. <br><br>  La r√®gle 80/20 fonctionne: vous faites une d√©mo 20% du temps √† partir du d√©veloppement complet du jeu, et pour le joueur, cela ressemble √† un jeu termin√© √† 80%.  La perception fonctionne pour que les m√©canismes de base soient pr√™ts, tout bouge et fonctionne, ce qui signifie que le jeu est presque pr√™t et que le d√©veloppeur le terminera bient√¥t.  Mais en r√©alit√©, le d√©veloppeur a encore une sortie de 80%.  Comme je l'ai dit, j'ai d√ª longtemps travailler sur la documentation pour qu'elle soit compr√©hensible par tous.  Je l'ai montr√© √† beaucoup de gens qui ont parl√© de leurs commentaires, je les ai filtr√©s, essayant de comprendre l'essence des d√©clarations.  Et il m'a fallu beaucoup de temps pour rechercher des bogues. <br><br>  Donc, dans le d√©veloppement de jeux, je ne pouvais que vous conseiller de faire des d√©mos: elles ravissent tout le monde, ne n√©cessitent pas beaucoup de temps, et personne n'attend vraiment quoi que ce soit des d√©mos.  Terminer les jeux est un processus ennuyeux, mais commencer est super. <br><br>  Enfin, je vous laisse des liens: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©p√¥t avec un jeu et des instructions pour le lancement</a> (je serai heureux de regrouper les demandes si vous trouvez des bugs) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Phaser</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">awesome-pixijs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Serveur de jeu multijoueur Colyseus</a> (j'ai √©crit moi-m√™me multijoueur, puis j'ai vu un serveur fini avec des chambres) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√âditeur Ace</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation de ce rapport</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conf√©rences en langue russe auxquelles vous pouvez soumettre un rapport</a> </li></ul><br><blockquote>  <b>HolyJS 2019 Piter</b> , une conf√©rence pour les d√©veloppeurs JavaScript, se tiendra du 24 au 25 mai √† Saint-P√©tersbourg.  Les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premiers intervenants</a> sont d√©j√† apparus sur le site. <br>  Vous pouvez √©galement demander un rapport, l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">appel √† communications est</a> ouvert jusqu'au 11 mars. <br>  Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">prix des</a> billets augmentera le 1er f√©vrier. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436586/">https://habr.com/ru/post/fr436586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436568/index.html">Propre plate-forme vid√©o ou comment utiliser beaucoup de ressources informatiques. Partie 1</a></li>
<li><a href="../fr436570/index.html">Exorcisme programmeur</a></li>
<li><a href="../fr436572/index.html">Concours de projet de cybers√©curit√© Skolkovo Cybersecurity Challenge 2019</a></li>
<li><a href="../fr436578/index.html">Prix ‚Äã‚Äãde la s√©curit√© personnelle pour les administrateurs de grandes soci√©t√©s informatiques par an</a></li>
<li><a href="../fr436584/index.html">Loi sur la gestion des runets - mise en ≈ìuvre des dispositions et domaines de responsabilit√©</a></li>
<li><a href="../fr436588/index.html">MegaSlerm √† Moscou d√©but juin: premi√®re annonce et remises</a></li>
<li><a href="../fr436590/index.html">Conseils pour un client fonctionnel. Appuyez sur Œî pour lire</a></li>
<li><a href="../fr436592/index.html">Backend dans VueJS Single File Components</a></li>
<li><a href="../fr436594/index.html">Au revoir Chevy Volt: Histoires et l√©gendes de l'hybride rechargeable</a></li>
<li><a href="../fr436596/index.html">Les d√©veloppeurs full-stack sont en fait bloqu√©s √† mi-niveau. √âpargnez-vous de la souffrance - ne suivez pas cette voie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>