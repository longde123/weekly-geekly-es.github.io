<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìò üë®üèæ‚Äç‚úàÔ∏è ü¶ä BLACK HAT USA Konferenz. Wie ein Hollywood-Hacker √úberwachungskameras einsetzt. Teil 1 üÖæÔ∏è üß¶ üë¥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich bin Greg Heffner, und dies ist ein Gespr√§ch dar√ºber, wie ein Hollywood-Hacker √úberwachungskameras einsetzt. Einige von Ihnen wissen vielleicht ode...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BLACK HAT USA Konferenz. Wie ein Hollywood-Hacker √úberwachungskameras einsetzt. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/427367/"> Ich bin Greg Heffner, und dies ist ein Gespr√§ch dar√ºber, wie ein Hollywood-Hacker √úberwachungskameras einsetzt.  Einige von Ihnen wissen vielleicht oder auch nicht, dass bei der Erstver√∂ffentlichung meiner Arbeit zu diesem Thema ein Artikel im Reuters-Internetportal erschien. <br><br><img src="https://habrastorage.org/webt/i4/rf/hx/i4rfhxxkmocn8xisdvkdrguweii.jpeg"><br><br>  F√ºr mich als Redner war es wirklich toll.  Das Problem war jedoch, dass in dem Artikel betont wurde, dass ich f√ºr eine bestimmte Institution mit einem dreistelligen Namen gearbeitet habe, √ºber den es in letzter Zeit nur sehr wenige Notizen in der Presse gab.  Au√üerdem gingen sie so weit, dass sie behaupteten, ich h√§tte bei BlackHat meine Arbeit f√ºr diese Drei-Buchstaben-Agentur vorgestellt.  Diese Ver√∂ffentlichung f√ºhrte zu einigen sehr interessanten Telefonanrufen meines fr√ºheren Arbeitgebers. <br><br>  Gl√ºcklicherweise haben wir Leute, die meine Anrufe beantworten, also haben sie sie angeschrien, nicht mich, aber ich musste die Leute immer noch beruhigen und am Ende konnte ich den ehemaligen Arbeitgeber davon √ºberzeugen, dass manchmal Leute auch im Internet sind falsch. <br><br>  Um ganz klar zu sein, werde ich erkl√§ren, dass es im heutigen Gespr√§ch nicht um eine Arbeit geht, die ich jemals f√ºr ehemalige Arbeitgeber geleistet habe, sondern darum, was ich f√ºr meinen derzeitigen Arbeitgeber tue.  Ich arbeite als Vollzeit-Schwachstellenanalysator f√ºr Tactical Network Solutions, unterrichte auch Schulungen zu eingebetteten Ger√§ten und besch√§ftige mich von Zeit zu Zeit mit dem Hacken von drahtlosen Ger√§ten. <br><br>  Heute werde ich √ºber die Sicherheit von √úberwachungskameras oder vielmehr √ºber das Fehlen dieser Sicherheit sprechen.  Anfang der Vergangenheit, 2011, begann ich mich mit dem Thema Sicherheit der Firmware von Kameras zu befassen, die mit dem √úberwachungsnetzwerk verbunden sind, und entdeckte viele interessante Dinge. <br><br>  Ich werde die "Zero Day" -Drohung beiseite legen und dar√ºber sprechen, wenn ich dazu komme. Zuerst werde ich Ihnen zeigen, wie ich im Stil eines echten Hollywood-Hackers die von mir entdeckten Schwachstellen ausnutzen kann. <a name="habracut"></a><br><br>  Als ich anfing, √úberwachungskameras zu studieren, und ich muss sagen, dass ich viele eingebaute Ger√§te studiert habe, aber keine Kameras, wollte ich mit etwas Einfachem beginnen, das mir sicherlich einen Sieg garantieren w√ºrde.  Ich habe mich f√ºr D-Link entschieden, weil sie nie entt√§uschen. <br><br><img src="https://habrastorage.org/webt/q7/3e/mg/q73emg7hxxrcxw-54gyva8_x7lm.jpeg"><br><br>  Ich habe mich f√ºr die DCS-7410 entschieden, deren Preis bei rund 900 US-Dollar liegt. Dies ist eine der teuersten wetterfesten D-Link-√úberwachungskameras f√ºr den Au√üen- und Nachtbetrieb.  Wie die anderen Kameras, √ºber die wir heute sprechen werden, verf√ºgt sie √ºber eine Verwaltungsschnittstelle und unterst√ºtzt den Zugriff auf den Videostream √ºber das Internet auf einen Webserver. Die Stromversorgung erfolgt √ºber ein Netzwerk (PoE).  Dies macht es zu einem sehr attraktiven Ziel f√ºr einen Angreifer. <br><br>  Insbesondere verwendet diese Kamera Lighttpd II, einen Open-Source-Webserver, der bei eingebetteten Ger√§ten nicht h√§ufig verwendet wird.  Die Entwickler haben eine vern√ºnftige Konfiguration und Regeln erstellt, die den Zugriff auf das beschr√§nken, was √ºber den Webserver erreicht werden kann. <br><br>  Auf der n√§chsten Folie sehen Sie, dass Sie √ºber Administratorrechte verf√ºgen m√ºssen, wenn Sie etwas im Administratorverzeichnis cgi / admin abrufen m√∂chten.  Wenn Sie etwas in das Videoverzeichnis aufnehmen m√∂chten, k√∂nnen Sie ein beliebiger Benutzer sein, m√ºssen jedoch autorisiert sein.  Sie haben Eintr√§ge und Anmelderegeln f√ºr jedes einzelne Verzeichnis in der Weboberfl√§che, mit Ausnahme des Verzeichnisses cgi-bin. <br><br><img src="https://habrastorage.org/webt/0s/9n/_m/0s9n_mc6kkwgmih0nvfh9wm6kau.jpeg"><br><br><img src="https://habrastorage.org/webt/kp/tn/3u/kptn3ugjtfshhp-mg_hxwl6kerk.jpeg"><br><br>  Die meisten Kamera-CGI-Skripte befinden sich im CGI-gesch√ºtzten Verzeichnis.  Ein unsicheres cgi-bin-Verzeichnis enth√§lt nur eine Datei, rtpd.cgi. Hierbei handelt es sich um ein Bash-Shell-Skript, mit dem das Transportprotokoll der RTP-Kamera in Echtzeit gestartet und gestoppt wird. <br><br><img src="https://habrastorage.org/webt/zz/by/o_/zzbyo_ebtddfagw6jpwuqilckky.jpeg"><br><br>  Das Skript rtpd.cgi weist jedoch einen schwerwiegenden Fehler auf.  Es analysiert die Abfrageparameter, indem alle kaufm√§nnischen Und-Zeichen in der Zeichenfolge $ QUERY_STRING durch Leerzeichen ersetzt werden, und erh√§lt dann das Ergebnis mit der Funktion eval: <br><br><img src="https://habrastorage.org/webt/ck/ev/ox/ckevoxngnwan-_0hf6yyiyysab0.jpeg"><br><br>  Wenn Sie also nur die Kamera anhalten m√∂chten, senden Sie einfach eine Anfrage: rtpd.cgi? Action = stop.  Bei bestimmungsgem√§√üer Verwendung √§ndert die folgende HTTP-Anforderung den Namen? Aktion, deren Wert auf die Position "Start" gesetzt wird: <br><br><pre><code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?action=start</code> </pre> <br>  Da die Daten in $ query_string von der eval-Methode blind ausgef√ºhrt werden, kann ein Angreifer jeden Befehl ausf√ºhren, indem er ihn einfach als Teil der http GET-Parameter angibt: <br><br><pre> <code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?reboot</code> </pre> <br>  Auf diese Weise kann der Hacker die Kamera neu starten.  Es war tats√§chlich schwierig f√ºr mich, diese Sicherheitsanf√§lligkeit zu kategorisieren, da es sich nicht einmal um eine Injektion von Befehlen handelt, wir nichts eingeben, sondern einfach zulassen, dass das Programm mit anderen Parametern ausgef√ºhrt wird.  Ich habe diese Sicherheitsanf√§lligkeit "Ron Burgund" genannt, weil sie buchst√§blich alles tut, was Sie in die Abfragezeichenfolge eingeben. <br><br><img src="https://habrastorage.org/webt/ef/5_/yl/ef5_ylb-0jr20nngw8uqftcnjbo.jpeg"><br><br>  Ein Angreifer kann diese Sicherheitsanf√§lligkeit verwenden, um ein normales Kamera-Administratorkennwort vom NVRAM zu erhalten.  Der folgende Befehl wird nach dem Neustart vom Kamera-Startskript ausgef√ºhrt und sendet Ihrem Browser eine Antwort dieser Art: <br><br><img src="https://habrastorage.org/webt/wx/48/og/wx48ogrv2omgwfklhlt9ytd-9lu.jpeg"><br><br>  Jetzt haben Sie nicht nur Root-Zugriff, sondern werden nach Erhalt des Passworts auch Administrator, sodass Sie mit der Kamera und den Videos alles machen k√∂nnen. <br><br>  Wie sich herausstellt, liebt D-Link, wie viele Hersteller, die Wiederverwendung von Code durch die Installation derselben Firmware, und dies ist bei vielen ihrer Produkte der Fall.  Dies betrifft jedoch nicht nur D-Link-Produkte, da Trendnet und einige andere "Nicht-Marken" -Hersteller solcher Ger√§te eine √§hnliche Vorgehensweise anwenden.  Die Wiederverwendung von Code ist mittlerweile weit verbreitet, sowohl bei Herstellern derselben Marke als auch zwischen verschiedenen Marken.  Diese Sicherheitsanf√§lligkeit ist in der Firmware vieler Kameramodelle enthalten, die in der Shodan Dork-Ressource f√ºr Schwachstellensammlungen f√ºr Computer indiziert sind. <br><br><img src="https://habrastorage.org/webt/yq/hr/x3/yqhrx3jj2aexfxgsfde9ggqsity.jpeg"><br><br>  Diese Sicherheitsanf√§lligkeit scheint einigen Leuten bekannt zu sein, und dies liegt wahrscheinlich daran, dass Core Security nach meiner Rede zu diesem Thema den Sicherheitsanf√§lligkeitsindex CVE-2013-1599 f√ºr diese Produkte festgelegt hat, der darauf hinweist, dass er nur in D-Link-Ger√§ten vorhanden ist, ohne einen zu erw√§hnen von einem anderen Hersteller, der dieselbe Firmware in seinen Ger√§ten verwendet.  Selbst wenn einer der Hersteller diesen Fehler in der neuen Firmware-Version korrigiert, bleiben die meisten Ger√§te weitere 3 Jahre anf√§llig, da normalerweise niemand die Firmware rechtzeitig aktualisiert und einige nicht wissen, um was es sich handelt.  Wie ich bereits sagte, sind D-Link-Produkte eines der g√ºnstigsten Angriffsziele. Schauen wir uns also Kameras von renommierteren Herstellern wie Cisco mit dem Modell PVC 2300 an. Dies ist eine IP-Kamera der Business-Klasse der Mittelklasse im Wert von 500 US-Dollar. <br><br><img src="https://habrastorage.org/webt/an/xc/gb/anxcgbta5vml8jvdwwrjkcj1bki.jpeg"><br><br>  Derzeit verf√ºgt es auch √ºber einen Webserver und bietet eine Authentifizierung mithilfe einer Kennwortdatei im HTTP-Format. <br><br><img src="https://habrastorage.org/webt/yo/oj/w4/yoojw4gf_hxahsfnot12iafr8yw.jpeg"><br><br>  Die meisten Benutzer sind mit diesem System vertraut. Sie installieren Ihre HTTP-Kennwortdatei oder genauer gesagt einen Link zu einer zentralisierten Kennwortdatei in einem Verzeichnis, das Sie mit einem Kennwort sch√ºtzen m√∂chten.  Wenn Sie sich die Firmware ansehen, enthielt die Weboberfl√§che jedes Verzeichnisses eine .htpasswd-Kennwortdatei, mit Ausnahme eines Verzeichnisses, oamp, das sich unter / usr / local / www / oamp befindet. <br><br><img src="https://habrastorage.org/webt/5y/9_/5t/5y9_5t4aajko9fpfqyrgo8rxukq.jpeg"><br><br>  Anstelle einer Kennwortdatei enthielt sie eine Reihe von XML-Dateien, die als Links zur Bin√§rdatei oamp.cgi dienten.  Mal sehen, was dieses CGI macht.  Es stellt sich heraus, dass es eine Art Mini-API implementiert, die v√∂llig unabh√§ngig von allem anderen ist, was in der Weboberfl√§che ausgef√ºhrt wird. <br><br><img src="https://habrastorage.org/webt/du/hp/ze/duhpze4khdkjnwkpxcq71egk1fa.jpeg"><br><br>  Er erwartet, dass Sie nach bestimmten Aktionen gefragt werden, darunter das Herunterladen der Konfigurationsdatei, das Aktualisieren der Konfigurationsdatei, das Herunterladen der Firmware-Aktualisierungsdatei, das Aktualisieren der Firmware und vieles mehr.  Die Entwickler waren nicht so dumm. Bevor Sie Ihre Anfrage ausf√ºhren, pr√ºft oamp.cgi, ob Sie die richtige g√ºltige Sitzungs-ID haben. <br><br><img src="https://habrastorage.org/webt/-y/w-/tc/-yw-tczrcu1suqe5m7nhkbckry0.jpeg"><br><br>  Wenn Sie keine g√ºltige Sitzungskennung haben, k√∂nnen Sie nur ein Login eingeben. <br><br><img src="https://habrastorage.org/webt/h4/-f/db/h4-fdbh_byljwbfst90cnc0fa1w.jpeg"><br><br>  Dies ist an sich interessant, da sie eine Authentifizierungspr√ºfung implementiert haben, die an keiner anderen Stelle in der Schnittstelle verwendet wird.  Ich begann zu verstehen, wie sie die Eingabe steuern, dh die Anmeldung.  Sie verlassen sich auf Ihren Benutzernamen und Ihr Passwort und keine √úberraschungen mehr. <br><br><img src="https://habrastorage.org/webt/cc/of/dh/ccofdh7-rzwu3cslr4rzawektjm.jpeg"><br><br><img src="https://habrastorage.org/webt/xl/zw/ms/xlzwmsxf0zvnpzunpu4sgncnrc4.jpeg"><br><br>  Und dann rufen sie die Funktion PRO_GetStr zweimal auf, und ich habe keine Ahnung, was sie bewirken.  Aber ich wei√ü, dass der erste Aufruf dieser Funktion zwei Zeilen enth√§lt - OAMP und den Benutzernamen L1_usr, und der zweite Aufruf - zwei weitere Zeilen, OAMP und das Kennwort L1_pwd. <br><br><img src="https://habrastorage.org/webt/n1/ym/om/n1ymomdakif9vlzheuwya5mjfty.jpeg"><br><br><img src="https://habrastorage.org/webt/78/fy/t9/78fyt9djqavicl7cicsxnd-zrw4.jpeg"><br><br>  Dann wird der erste Wert f√ºr Benutzer L1 zur√ºckgegeben und mit dem Benutzernamen Benutzer L1_usr verglichen, der w√§hrend der Authentifizierung angegeben wurde, und der zweite Wert der Zeichenfolge wird ebenfalls zur√ºckgegeben - Kennwort Kennwort L1_usr, das mit dem Kennwort verglichen wird, das der Benutzer bei der Anmeldung eingegeben hat. <br><br><img src="https://habrastorage.org/webt/jw/-p/jv/jw-pjvidwi9ol_sb5fiv1zxv6kc.jpeg"><br><br><img src="https://habrastorage.org/webt/zo/ah/py/zoahpyuevenlfpkgkozbbdc7nle.jpeg"><br><br>  Vermutlich bieten dieser L1-Benutzername und dieses Kennwort unabh√§ngig von den verwendeten Werten die richtige Anmeldung f√ºr diese OAMP-Schnittstelle.  Der einzige andere Ort, den ich in der Firmware finden konnte und der wirklich mit dem Benutzernamen und dem Passwort des Benutzers verkn√ºpft ist, ist in der Konfigurationsdatei. <br><br><img src="https://habrastorage.org/webt/mm/pb/k5/mmpbk5f98z45lefbabw5x0l7jt8.jpeg"><br><br>  Diese Werte sind in Ger√§ten fest codiert, die w√§hrend des Betriebs die Konfigurationsdatei des OAMP-Abschnitts verwenden.  Sie sehen, dass der L1-Benutzeranmeldewert in der Zeile L1_admin und der Benutzerkennwortwert in der Zeile L1_51 festgelegt ist. <br><br>  Und dies ist ein echtes Problem, da all diese OAMP-Schnittstelle und diese fest codierten Konten vollst√§ndig undokumentiert sind, sodass niemand wei√ü, dass sie vorhanden sind, au√üer denjenigen, die sich die M√ºhe gemacht haben, in die Firmware zu schauen.  Nat√ºrlich wird der Administrator dies niemals tun. <br><br>  Aber selbst wenn er davon erfahren hat, kann er diese Werte nicht √§ndern, da diese Kamera keine Administratoroberfl√§che enth√§lt.  Das Problem bei fest codierten geheimen Passw√∂rtern besteht darin, dass sie dank der Verwendung von Hintert√ºren f√ºr kurze Zeit geheim bleiben. <br><br>  Daher k√∂nnen wir diese Backdoor-Konten verwenden, um uns anzumelden und eine Sitzungs-ID zu erhalten.  Nachdem wir diese Sitzungs-ID zusammen mit unseren Anforderungen senden k√∂nnen, k√∂nnen wir auch alle anderen von oamp.cgi unterst√ºtzten Aktionen aufrufen, einschlie√ülich des Herunterladens der Einstellungskonfigurationsdatei. <br><br><img src="https://habrastorage.org/webt/an/w3/i1/anw3i17pq_cvs9ojuxuxrizzcqe.jpeg"><br><br><img src="https://habrastorage.org/webt/9a/_a/lp/9a_alpxed7vbjf9v1qx4pc9arqu.jpeg"><br><br>  Das Problem ist, dass, wenn Sie versuchen, es mit Base64 zu entschl√ºsseln, dies nicht funktioniert, Sie nur eine Menge M√ºll bekommen.  Dies ist der Fall, wenn Base64 nicht Base64 ist. <br><br><img src="https://habrastorage.org/webt/g2/ty/mb/g2tymbmqw_ivhqvpxtvkzlnkr28.jpeg"><br><br>  Der Grund daf√ºr wird offensichtlich, wenn Sie sich den endg√ºltigen Base64-Code in der Bin√§rdatei der PVC-2300-Firmware selbst ansehen. Hier wird die Basis f√ºr die Codierung erstellt, es wird jedoch eine nicht standardm√§√üige Base64-Schl√ºsselzeichenfolge verwendet, die bei der Analyse der Verschl√ºsselung und Entschl√ºsselung von Code 64 ermittelt wurde Mit Python ist es sehr einfach, eine Schl√ºsselzeichenfolge in einem Python Base64-Modul in eine benutzerdefinierte Schl√ºsselzeichenfolge zu √§ndern, wie auf der Folie gezeigt. <br><br><img src="https://habrastorage.org/webt/1j/lo/fb/1jlofb--8fxiriwhad4abpwuxju.jpeg"><br><br>  Mit ein paar Python-Zeichenfolgen k√∂nnen wir die Konfigurationsdatei einfach entschl√ºsseln und in einfachen Text umwandeln, wodurch wir Anmeldeoptionen unter der Anmeldung des Administrators erhalten. <br><br><img src="https://habrastorage.org/webt/dd/a6/wm/dda6wmvvhgydwz8vxdu7utsslim.jpeg"><br><br>  Nachdem wir die Kontrolle √ºber die Kamera erlangt haben, k√∂nnen wir den Serverraum sehen.  Das Problem ist, dass das Anzeigen von Serverr√§umen die ersten 10 Sekunden wirklich erfasst, aber dann wird es eine ziemlich langweilige Aufgabe. <br><br><img src="https://habrastorage.org/webt/v9/sn/yq/v9snyqmqg0robtcbe86hp6iwe6o.jpeg"><br><br>  Daher kehrte ich zum Code zur√ºck und begann, die M√∂glichkeit des Herunterladens von Firmware zu untersuchen.  Dies ist tats√§chlich sehr interessant, da Sie anstelle des Herunterladens der Firmware-Datei von der offiziellen Website auf das Ger√§t Ihre eigene URL angeben k√∂nnen. Das Ger√§t wird an diese Adresse gehen und die angeblich als Firmware geltende URL herunterladen. <br><br><img src="https://habrastorage.org/webt/bs/u1/gj/bsu1gjoyhq5ieybllbrxcjsd4ig.jpeg"><br><br>  Die Funktion system2 generiert einfach einen Befehl aus der Formatzeichenfolge und der URL, bevor die libc-Systemfunktion aufgerufen wird, mit der ein Angreifer √ºber den Parameter url beliebige Shell-Befehle eingeben kann.  Der Befehl des Angreifers wird mit Superuser-Rechten ausgef√ºhrt. Da die √úberpr√ºfung anhand des URL-Werts erfolgt, ist es sehr einfach, ihn mit dem folgenden Skript zu umgehen: <br><br><pre> <code class="hljs ruby">$ wget --header=‚Äù<span class="hljs-symbol"><span class="hljs-symbol">sessionID:</span></span> <span class="hljs-number"><span class="hljs-number">57592414</span></span>‚Äù <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/oamp</span></span><span class="hljs-regexp"><span class="hljs-regexp">/System.xml?action=loadFirmware&amp;url=https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/127.0.0.1:6 5534/</span></span>;reboot;</code> </pre> <br>  Danach wird der Computer unter dieser URL neu gestartet und Sie k√∂nnen einen beliebigen Befehl ausf√ºhren. <br><br><img src="https://habrastorage.org/webt/1r/wj/j5/1rwjj5ih0d0j1fybyteeg7mdnyw.jpeg"><br><br>  Diese Sicherheitsanf√§lligkeit wurde auf allen Firmware-Versionen von zwei Modellen von Cisco-√úberwachungskameras getestet - PVC-2300 und WVC-2300, einer √§hnlichen Kamera mit zwei Antennen.  Zum Zeitpunkt dieses Schreibens hat Shodan mehr als 500 √∂ffentliche und potenziell gef√§hrdete IP-Kameras gezeigt, die Hotels, Serverr√§umen und Ingenieurb√ºros geh√∂ren, die Ger√§te f√ºr die Internationale Raumstation entwickeln. <br><br>  Daher sch√ºtzen D-Link und Cisco √úberwachungskameras nicht ordnungsgem√§√ü, obwohl Sie wissen, dass diese Kameras nicht das Hauptprodukt sind.  Schauen wir uns daher Marken an, die sich speziell auf die Entwicklung und Herstellung von √úberwachungskameras spezialisiert haben.  Ich habe mich f√ºr IQ Invision entschieden, das teure hochaufl√∂sende Kameras wie die IQ 832n herstellt und mehr als 1000 US-Dollar pro St√ºck kostet, was √ºberhaupt nicht billig ist. <br><br><img src="https://habrastorage.org/webt/od/4n/47/od4n470mrojtlam7vrbiqpaagcw.jpeg"><br><br>  Der Hauptgrund f√ºr mein Interesse ist, dass dies die Leute sind, die Kameras in dem Gesch√§ftskomplex installieren, in dem ich arbeite. Es gab also pers√∂nliche Gr√ºnde daf√ºr.  Was bekommen Sie mit einer professionellen √úberwachungskamera f√ºr tausend Dollar? <br>  Standardm√§√üig liefern diese Kameras ein nicht authentifiziertes Videobild, und keine der umfangreichen Studien zur Kamerainstallation konnte diese Standardeinstellung √§ndern.  W√§hrend die Verwaltungsschnittstelle kennwortgesch√ºtzt ist, bietet die Benutzeroberfl√§che Zugriff auf alle Kameraressourcen ohne Authentifizierung, wodurch ein weites Angriffsfeld entsteht. <br><br><img src="https://habrastorage.org/webt/mn/gr/mn/mngrmndqcnufl90nrnj_lfhpvse.jpeg"><br><br>  Die Authentifizierungseinstellungen des Administrators k√∂nnen vom Administrator ge√§ndert werden. Versuchen Sie jedoch zu erraten, wie viele Administratoren ihre Kameras mit dem Internet verbunden haben, ohne die Standardeinstellungen zu √§ndern - fast alles.  Die meisten Administratoren in unserem Komplex waren jedoch klug genug, um diese Einstellungen zu √§ndern, und ich begann zu √ºberlegen, was ich sonst noch ohne Authentifizierung tun k√∂nnte.  Es stellte sich heraus, dass ich frei auf die Seite zugreifen kann. <br><br><img src="https://habrastorage.org/webt/qo/m2/xc/qom2xc4tfzyzncf5bienr4e4a5m.jpeg"><br><br>  Es enth√§lt eine ganze Reihe von Kameraeinstellungen, z. B. Fokuseinstellungen, die nicht so interessant sind wie Benutzernamen und Kennw√∂rter.  Interessanter war der Code hinter dieser oidtable.cgi-Seite.  Wenn Sie diese Bin√§rdatei zerlegen, sehen Sie, dass die Seite nur einen Parameter akzeptiert, grep, der zum Filtern der an die Seite oidtable.cgi zur√ºckgegebenen Ergebnisse verwendet wird. <br><br><img src="https://habrastorage.org/webt/xq/xa/bw/xqxabwwpfodp1lbutwkjhnh0iws.jpeg"><br><br>  Nachdem √ºberpr√ºft wurde, ob der angegebene Parameterwert weniger als 32 Zeichen lang ist, platziert oidtable.cgi diesen Wert in der Befehlszeile und √ºbergibt ihn an popen: <br><br><img src="https://habrastorage.org/webt/7o/6t/gx/7o6tgx98hkegmfygblszjdmtqbm.jpeg"><br><br><img src="https://habrastorage.org/webt/i6/0a/4s/i60a4smzvkzi1hsop0lam0rcv9i.jpeg"><br><br>  Was ich sah, lie√ü mich die ‚ÄûGesichtspalme‚Äú portr√§tieren und veranlasste mich, einige Teams zu injizieren. <br><br><img src="https://habrastorage.org/webt/k2/2g/c3/k22gc3orqjsproq9bgagtpbwntk.jpeg"><br><br>  Sie sehen, dass ich hier, genau wie im Fall von D-Link, den PS-Befehl ausf√ºhren und die Ausgabe an meinen Browser zur√ºcksenden kann.  Somit kann ich ohne Authentifizierung leicht beliebige Shell-Befehle eingeben, die als root ausgef√ºhrt werden.  Die Prozesslisten zeigen, dass Netcat bereits in diesen Kameras installiert ist und Strich-E-Striche eingeben kann. Daher bin ich sicher, dass die meisten Leute hier interessantere Befehle zum Ausf√ºhren finden k√∂nnen als die Prozessliste.  Mein Hauptziel war es jedoch, in das Admin-Panel zu gelangen, und ich fand heraus, wie es geht. <br><br>  16:30 min <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BLACK HAT USA Konferenz.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wie ein Hollywood-Hacker √úberwachungskameras einsetzt.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/B8DjTcANBx0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vielen Dank f√ºr Ihren Aufenthalt bei uns.  Gef√§llt dir unser Artikel?  M√∂chten Sie weitere interessante Materialien sehen?  Unterst√ºtzen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder Ihren Freunden empfehlen, einen <b>Rabatt von 30% f√ºr Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir f√ºr Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit √ºber VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s von $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verf√ºgbar). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s bis Dezember kostenlos,</b> wenn Sie f√ºr einen Zeitraum von sechs Monaten bezahlen, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> bestellen. <br><br>  <b>Dell R730xd 2 mal g√ºnstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgeb√§udes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern f√ºr 9.000 Euro f√ºr einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427367/">https://habr.com/ru/post/de427367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427357/index.html">Shader in Unity schreiben. GrabPass, PerRendererData</a></li>
<li><a href="../de427359/index.html">Wie ECS, C # Job System und SRP die Architektur √§ndern</a></li>
<li><a href="../de427361/index.html">Funktionen der Fensterfilterung auf FPGA</a></li>
<li><a href="../de427363/index.html">Implementierung von LoRaWAN in einem landwirtschaftlichen Unternehmen. Alles √ºber Konstruktion, Einf√ºhrung und L√∂sungen</a></li>
<li><a href="../de427365/index.html">Bericht von RedSlerm √ºber die √úberwachung (Monit, Zabbix)</a></li>
<li><a href="../de427369/index.html">BLACK HAT USA Konferenz. Wie ein Hollywood-Hacker √úberwachungskameras einsetzt. Teil 2</a></li>
<li><a href="../de427371/index.html">Videokurs "Grundlagen der Arbeit mit BPMN-Notationen." Kostenlos</a></li>
<li><a href="../de427373/index.html">Firefox kann mit dem integrierten kostenpflichtigen VPN-Add-On monetarisiert werden</a></li>
<li><a href="../de427377/index.html">Einfacher CI / CD-Systemadministrator</a></li>
<li><a href="../de427379/index.html">Junior Senior: Snom D715 IP-Telefon Bewertung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>