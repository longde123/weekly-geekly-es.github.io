<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>游빅 游댛 鮫勇 Simulacros, trozos y esp칤as en el marco de Spock 游땞 游댝 餃勇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spock proporciona 3 herramientas poderosas (pero diferentes en esencia) que simplifican las pruebas de escritura: Mock, Stub y Spy. 



 Muy a menudo,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Simulacros, trozos y esp칤as en el marco de Spock</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/haulmont/blog/435488/"><p>  Spock proporciona 3 herramientas poderosas (pero diferentes en esencia) que simplifican las pruebas de escritura: Mock, Stub y Spy. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mp/b1/16/mpb116loygy7rcfeicuihzm8oym.jpeg"></div><br><p>  Muy a menudo, el c칩digo que necesita ser probado necesita interactuar con m칩dulos externos llamados dependencias (el art칤culo original usa el t칠rmino colaboradores, que no es muy com칰n en el entorno en ruso). </p><br><p>  Las pruebas unitarias se dise침an con mayor frecuencia para probar una sola clase aislada utilizando varias variantes de mok: Mock, Stub y Spy.  Por lo tanto, las pruebas ser치n m치s confiables y menos propensas a romperse a medida que evoluciona el c칩digo de dependencia. </p><br><p>  Tales pruebas aisladas son menos propensas a problemas al cambiar los detalles internos de la implementaci칩n de dependencia. </p><br><p>  <em>De un traductor:</em> cada vez que uso Spock Framework para escribir pruebas, siento que puedo cometer un error al elegir una forma de reemplazar las dependencias.  Este art칤culo tiene la hoja de trucos m치s corta posible para elegir un mecanismo para crear mokas. </p><a name="habracut"></a><br><h2 id="tldr">  TL; DR </h2><br><h3 id="mocks">  Simulacros </h3><br><p>  Use Mock para: </p><br><ul><li>  verificaciones de contratos entre c칩digo de prueba y dependencias </li><li>  comprobar que los m칠todos de dependencia se llaman la cantidad correcta de veces </li><li>  validaci칩n de par치metros con los que se llama el c칩digo de dependencia </li></ul><br><h3 id="stubs">  Trozos </h3><br><p>  Use Stub para: </p><br><ul><li>  proporcionar resultados de llamadas predefinidos </li><li>  realizar acciones predefinidas esperadas de dependencias, como lanzar excepciones </li></ul><br><h3 id="spies">  Esp칤as </h3><br><p>  Miedo esp칤as.  Como dice la documentaci칩n de Spock: </p><br><blockquote>  Pi칠nselo dos veces antes de usar este mecanismo.  Quiz치s deber칤a redise침ar su soluci칩n y reorganizar su c칩digo. </blockquote><p>  Pero sucede que hay situaciones en las que tenemos que trabajar con c칩digo heredado.  El c칩digo heredado puede ser dif칤cil o incluso imposible de probar con mobs y trozos.  En este caso, solo hay una soluci칩n: usar Spy. </p><br><p>  Es mejor tener el c칩digo heredado cubierto con pruebas usando Spy que no tener pruebas heredadas. </p><br><p>  Usa Spy para: </p><br><ul><li>  prueba de c칩digo heredado que no puede ser probado por otros m칠todos </li><li>  comprobar que los m칠todos de dependencia se llaman la cantidad correcta de veces </li><li>  validaci칩n de par치metros pasados </li><li>  proporcionando una respuesta de dependencia predefinida </li><li>  realizar acciones predefinidas en respuesta a llamadas a m칠todos de dependencia </li></ul><br><h2 id="mocks-1">  Simulacros </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zi/3q/vj/zi3qvjii7ug7tkq4bczo5f-jo7u.jpeg"></div><br><p> Todo el poder de moxas se manifiesta cuando la tarea de una prueba unitaria es verificar el contrato entre el c칩digo probado y las dependencias.  Veamos el siguiente ejemplo, donde tenemos un controlador <code>FooController</code> que usa <code>FooService</code> como una dependencia, y pruebe esta funcionalidad con mobs. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  En este escenario, queremos escribir una prueba que pruebe: </p><br><ul><li>  contrato entre <code>FooController</code> y <code>FooService</code> </li><li>  <code>FooService.doSomething(name)</code> se llama la cantidad correcta de veces </li><li>  <code>FooService.doSomething(name)</code> con el par치metro correcto </li></ul><br><p>  Echa un vistazo a la prueba: </p><br><p> <code>MockSpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MockSpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Mock FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">"  "</span></span> def fooService = Mock(FooService) and: <span class="hljs-string"><span class="hljs-string">"    "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"         "</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) and: <span class="hljs-string"><span class="hljs-string">"  ''    - 'null'"</span></span> response.text == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>.toString() } }</code> </pre> <br><p>  La prueba anterior crea una simulaci칩n de servicio: </p><br><pre> <code class="java hljs">def fooService = Mock(FooService)</code> </pre> <br><p>  La prueba tambi칠n comprueba que <code>FooService.doSomething(name)</code> se llama una vez, y el par치metro que se le pasa coincide con la cadena <code>"Sally"</code> . </p><br><pre> <code class="java hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>)</code> </pre> <br><p>  El c칩digo anterior resuelve 4 problemas importantes: </p><br><ul><li>  crea simulacro para <code>FooService</code> </li><li>  verifica que <code>FooService.doSomething(String name)</code> se llame exactamente una vez con el par치metro <code>String</code> y el valor <code>"Sally"</code> </li><li>  a칤sla el c칩digo de prueba, reemplazando la implementaci칩n de dependencia </li></ul><br><h2 id="stubs-1">  Trozos </h2><br><p>  쮼l c칩digo probado utiliza dependencias?  쮼l prop칩sito de las pruebas es asegurar que el c칩digo bajo prueba funcione correctamente cuando interact칰a con las dependencias?  쯉on los resultados de las llamadas a los m칠todos de dependencia valores de entrada para el c칩digo bajo prueba? </p><br><p>  Si el comportamiento del c칩digo probado cambia seg칰n el comportamiento de las dependencias, entonces debe usar stubs (Stub). </p><br><p>  Veamos el siguiente ejemplo con <code>FooController</code> y <code>FooService</code> y pruebe la funcionalidad del controlador usando stubs. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  C칩digo de prueba: </p><br><p> <code>StubSpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StubSpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Stub FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">"  "</span></span> def fooService = Stub(FooService) { doSomething(_) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"Stub did something"</span></span> } and: <span class="hljs-string"><span class="hljs-string">"    "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"   "</span></span> <span class="hljs-comment"><span class="hljs-comment">// 1 * fooService.doSomething() //        response.text == "Stub did something" } }</span></span></code> </pre> <br><p>  Puede crear un trozo como este: </p><br><pre> <code class="java hljs">def fooService = Stub(FooService) { doSomething(_) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"Stub did something"</span></span> }</code> </pre> <br><p>  El c칩digo anterior resuelve 4 problemas importantes: </p><br><ul><li>  crea un trozo de <code>FooService</code> </li><li>  se asegura de que <code>FooService.doSomething(String name)</code> devolver치 la cadena <code>"Stub did something"</code> independientemente del par치metro pasado (por lo que utilizamos el car치cter <code>_</code> ) </li><li>  a칤sla el c칩digo probado, reemplazando la implementaci칩n de dependencia con un trozo </li></ul><br><h2 id="spies-1">  Esp칤as </h2><br><p>  Por favor no lea esta secci칩n. </p><br><p>  No mires </p><br><p>  Salta al siguiente. </p><br><p>  쯊odav칤a leyendo?  Bueno entonces, est치 bien, tratemos con Spy. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b9/sj/lk/b9sjlk13izmu8rbtb4yv4zncwvm.jpeg"></div><br><p>  No uses Spy.  Como dice la documentaci칩n de Spock: </p><br><blockquote>  Pi칠nselo dos veces antes de usar este mecanismo.  Quiz치s deber칤a redise침ar su soluci칩n y reorganizar su c칩digo. </blockquote><p>  En este caso, hay situaciones en las que tenemos que trabajar con c칩digo heredado.  El c칩digo heredado no se puede probar con mobs o stubs.  En este caso, el esp칤a sigue siendo la 칰nica opci칩n viable. </p><br><p>  Los esp칤as son diferentes de los mokas o trozos porque no funcionan como trozos. </p><br><p>  Cuando una dependencia se reemplaza con un mok o stub, se crea un objeto de prueba y no se ejecuta el c칩digo fuente real de la dependencia. </p><br><p>  El esp칤a, por otro lado, ejecutar치 el c칩digo fuente principal de la dependencia para la cual se cre칩 el esp칤a, pero el esp칤a le permitir치 cambiar lo que devuelve el esp칤a y verificar las llamadas a los m칠todos, al igual que los mokas y los trozos.  (De ah칤 el nombre Spy). </p><br><p>  Veamos el siguiente ejemplo de <code>FooController</code> , que usa <code>FooService</code> , y luego pruebe la funcionalidad con un esp칤a. </p><br><p> <code>FooController.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FooService fooService def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ render fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) } }</code> </pre> <br><p> <code>FooService.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> groovy.transform.CompileStatic <span class="hljs-meta"><span class="hljs-meta">@CompileStatic</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">"Hi ${name}, FooService did something"</span></span> } }</code> </pre> <br><p>  C칩digo de prueba: </p><br><p> <code>SpySpec.groovy</code> </p> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.mycompany.myapp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> grails.testing.web.controllers.ControllerUnitTest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spock.lang.Specification <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpySpec</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Specification</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControllerUnitTest</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooController</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-string"><span class="hljs-string">"Spy FooService"</span></span>() { given: <span class="hljs-string"><span class="hljs-string">" -"</span></span> def fooService = Spy(FooService) and: <span class="hljs-string"><span class="hljs-string">"   "</span></span> controller.fooService = fooService when: <span class="hljs-string"><span class="hljs-string">"  "</span></span> controller.doSomething() then: <span class="hljs-string"><span class="hljs-string">"     "</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span> and: <span class="hljs-string"><span class="hljs-string">'     '</span></span> response.text == <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span> } }</code> </pre> <br><p>  Crear una instancia de esp칤a es bastante simple: </p><br><pre> <code class="java hljs">def fooService = Spy(FooService)</code> </pre> <br><p>  En el c칩digo anterior, el esp칤a nos permite verificar la llamada a <code>FooService.doSomething(name)</code> , la cantidad de llamadas y los valores de los par치metros.  Adem치s, el esp칤a cambia la implementaci칩n del m칠todo para devolver un valor diferente. </p><br><pre> <code class="java hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> * fooService.doSomething(<span class="hljs-string"><span class="hljs-string">"Sally"</span></span>) &gt;&gt; <span class="hljs-string"><span class="hljs-string">"A Spy can modify implementation"</span></span></code> </pre> <br><p>  El c칩digo anterior resuelve 4 problemas importantes: </p><br><ul><li>  crea una instancia de esp칤a para <code>FooService</code> </li><li>  comprueba la interacci칩n de dependencia </li><li>  comprueba c칩mo funciona la aplicaci칩n de acuerdo con ciertos resultados de llamadas al m칠todo de dependencia </li><li>  a칤sla el c칩digo probado, reemplazando la implementaci칩n de dependencia con un trozo </li></ul><br><h2 id="faq">  FAQ </h2><br><p>  <strong>쯈u칠 opci칩n usar: Mock, Stub o Spy?</strong> </p><br><p>  Esta es una pregunta que enfrentan muchos desarrolladores.  Estas preguntas frecuentes pueden ayudar si no est치 seguro de qu칠 enfoque usar. </p><br><p>  <strong>P:</strong> 쮼l prop칩sito de probar la verificaci칩n del contrato entre el c칩digo probado y las dependencias? </p><br><p>  <strong>A:</strong> Si respondi칩 S칤, use Mock </p><br><p>  <strong>P:</strong> 쮼l prop칩sito de las pruebas es asegurarse de que el c칩digo que se prueba funciona correctamente cuando interact칰a con las dependencias? </p><br><p>  <strong>R:</strong> Si respondi칩 S칤, use Stub </p><br><p>  <strong>P:</strong> 쯃os resultados de llamar a los m칠todos de dependencia introducen valores para el c칩digo bajo prueba? </p><br><p>  <strong>R:</strong> Si respondi칩 S칤, use Stub </p><br><p>  <strong>P:</strong> 쯊rabaja con c칩digo heredado, que es muy dif칤cil de probar y no le quedan opciones? </p><br><p>  <strong>A:</strong> Intenta usar Spy </p><br><h2 id="kod-primerov">  Ejemplo de c칩digo </h2><br><p>  Puede encontrar el c칩digo para todos los ejemplos en este art칤culo en: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/ddelponte/mock-stub-spy</a> </p><br><h2 id="poleznye-ssylki">  Enlaces utiles </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://spockframework.org/spock/docs/1.1/all_in_one.html#_interaction_based_testing</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://martinfowler.com/bliki/UnitTest.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://martinfowler.com/articles/mocksArentStubs.html</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es435488/">https://habr.com/ru/post/es435488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es435470/index.html">Tutorial de React, Parte 8: Trabajo continuo en una aplicaci칩n TODO, Introducci칩n de propiedades de componentes</a></li>
<li><a href="../es435476/index.html">Mkcert: certificados HTTPS v치lidos para localhost</a></li>
<li><a href="../es435480/index.html">Microsoft y Kroger le dar치n a Amazon una pelea en el campo ... el comercio de alimentos</a></li>
<li><a href="../es435482/index.html">Zircon destacado: vDSO (objeto virtual din치mico compartido)</a></li>
<li><a href="../es435484/index.html">Fuzzing style 1989</a></li>
<li><a href="../es435490/index.html">Cambios de impuestos de Google en 2019</a></li>
<li><a href="../es435494/index.html">Servidor cliente sin interrupciones</a></li>
<li><a href="../es435496/index.html">Tesla demand칩 por un accidente en el que murieron el conductor y el pasajero del Modelo S</a></li>
<li><a href="../es435498/index.html">vCloud Director Extender: migraci칩n</a></li>
<li><a href="../es435500/index.html">Guantes biom칠tricos en automovilismo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>