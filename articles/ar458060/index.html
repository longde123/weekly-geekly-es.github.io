<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ต๐ฝ ๐จ๐พโ๐ ๐ด ุฎูู ุชุธููู ุงูุนุดุจ ูู ูุญุฑู ุงููุญุฏุฉ ๐ง๐ผ ๐คฑ ๐จ๐ผโโ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุณููุถุญ ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ููููุฉ ูุชุงุจุฉ ุชุธููู ููุฏุณู ูุฅูุดุงุก ุดูุฑุงุช ูู ุงูุนุดุจ ูู ููู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ ูุงุณุชุฎุฏุงู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ููุชุญูู ูู ูุซุงูุฉ ุงูุนุดุจ. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฎูู ุชุธููู ุงูุนุดุจ ูู ูุญุฑู ุงููุญุฏุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458060/" style=";text-align:right;direction:rtl"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  ุณููุถุญ ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ููููุฉ ูุชุงุจุฉ ุชุธููู ููุฏุณู ูุฅูุดุงุก ุดูุฑุงุช ูู ุงูุนุดุจ ูู ููู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ ูุงุณุชุฎุฏุงู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ููุชุญูู ูู ูุซุงูุฉ ุงูุนุดุจ. <br><br>  ุชูุถุญ ุงูููุงูุฉ ุนูููุฉ ุฎุทูุฉ ุจุฎุทูุฉ ููุชุงุจุฉ ุชุธููู ุงูุนุดุจ ูู ุงููุญุฏุฉ.  ูุณุชูุจู ุงูุชุธููู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ ุ ููู ูู ููุฉ ููุดุจูุฉ ุชููุฏ ุดูุฑุฉ ูู ุงูุนุดุจ ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุธููู ุงูููุฏุณู</a> .  ูู ุฃุฌู ุงูุงูุชูุงู ูุงููุงูุนูุฉ ุ ุณูููู ูุฑูุด ุงูุนุดุจ <strong>ุญุฌู</strong> <strong>ูุฏูุฑุงู ุนุดูุงุฆูุงู</strong> ุ ููุง ุณุชุชุฃุซุฑ <strong>ุจุงูุฑูุงุญ</strong> .  ููุชุญูู ูู ูุซุงูุฉ ุงูุนุดุจ ุ ูุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก</a> ููุตู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ.  ุงูุนุดุจ ุณูู ุชููู ูุงุฏุฑุฉ ุนูู <strong>ูููู</strong> <strong>ูุชููู</strong> ุงูุธูุงู. <br><br>  ุชู ูุดุฑ <strong>ุงููุดุฑูุน ุงูููุงุฆู</strong> ูู ููุงูุฉ ุงูููุงู.  ูุญุชูู ููู ุงูุชุธููู ุงูุฐู ุชู ุฅูุดุงุคู ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุชุนูููุงุช ุงูุชู ุชุฌุนู ุงูููู ุฃุณูู. <br><a name="habracut"></a><br><h3 style=";text-align:right;direction:rtl">  ูุชุทูุจุงุช </h3><br>  ูุฅููุงู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ ุณุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุนูููุฉ ุญูู ูุญุฑู ุงููุญุฏุฉ ูููููุง ุฃููููุง ูุจูุงุก ุฌููุฉ ูุธูุงู ุชุธููู. <br><br>  <a href="">ูู ุจุชูุฒูู ูุณูุฏุฉ ุงููุดุฑูุน (.zip)</a> . <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุงูุนูู </h2><br>  ูู ุจุชูุฒูู ูุณูุฏุฉ ุงููุดุฑูุน ูุงูุชุญู ูู ูุญุฑุฑ ุงููุญุฏุฉ.  ุงูุชุญ ุงููุดูุฏ <code>Main</code> ุ ุซู ุงูุชุญ ุชุธููู <code>Grass</code> ูู ูุญุฑุฑ ุงูููุฏ. <br><br>  ูุญุชูู ูุฐุง ุงูููู ุนูู ุชุธููู ููุชุฌ ุงูููู ุงูุฃุจูุถ ุ ููุฐูู ุจุนุถ ุงููุธุงุฆู ุงูุชู ุณูุณุชุฎุฏููุง ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู.  ุณุชูุงุญุธ ุฃู ูุฐู ุงููุธุงุฆู ุฌูุจูุง ุฅูู ุฌูุจ ูุน ุชุธููู ููุฉ ุงูุฑุฃุณ ูุชู ุชุถููููุง ูู ูุชูุฉ <code>CGINCLUDE</code> ุงูููุฌูุฏุฉ <em>ุฎุงุฑุฌ</em> <code>SubShader</code> .  ุณูุชู <strong>ุชุถููู</strong> ุงูููุฏ ุงูููุฌูุฏ ูู ูุฐู ุงููุชูุฉ <strong>ุชููุงุฆููุง ูู ุฌููุน ุนูููุงุช ุงููุฑูุฑ</strong> ูู ุงูุชุธููู ุ  ุณูููู ูุฐุง ูููุฏูุง ูู ููุช ูุงุญู ูุฃู ุชุธููููุง ุณูููู ูู ุนุฏุฉ ุชูุฑูุฑุงุช. <br><br>  ุณูุจุฏุฃ ุจูุชุงุจุฉ <strong>ุชุธููู ููุฏุณู</strong> ูููุฏ ูุซูุซุงุช ูู ูู ููุฉ ุนูู ุณุทุญ ุดุจูุชูุง. <br><br><h2 style=";text-align:right;direction:rtl">  1. ุชุธููู ููุฏุณู </h2><br>  ุงูุชุธููู ุงูููุฏุณู ุฌุฒุก ุงุฎุชูุงุฑู ูู ุฎุท ุฃูุงุจูุจ ุงูุชูุฏูู.  ูุชู ุชูููุฐูุง <strong>ุจุนุฏ</strong> ุงูุชุธููู ููุฉ ุงูุฑุฃุณ (ุฃู ุชุธููู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ุฅุฐุง ุชู ุงุณุชุฎุฏุงู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก) ููุจู ุฃู ุชุชู ูุนุงูุฌุฉ ุงูุฑุคูุณ ูุชุธููู ุงูุชุฌุฒุฆุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ef7/c01/458/ef7c01458cadf7cd0cf46695d7114f96.jpg"></div><br>  <i>ุฎุท ุฃูุงุจูุจ ุฑุณููุงุช Direct3D 11. ูุงุญุธ ุฃูู ูู ูุฐุง ุงูุฑุณู ุงูุชุฎุทูุทู ูุณูู ุชุธููู ุงูุฌุฒุก <em>ุจูุณู ุชุธููู ุจูุณู</em> .</i> <br><br>  ูุชููู ุงูุชุธููู ุงูููุฏุณู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏุงุฆูุฉ</a> ูุงุญุฏุฉ ุนูุฏ ุงูุฅุฏุฎุงู ููููู ุฃู ูููุฏ ุตูุฑูุง ุฃู ูุงุญุฏูุง ุฃู ุฃูุซุฑ ูู ุงูุจุฏุงุฆู.  ุณูุจุฏุฃ ุจูุชุงุจุฉ ุชุธููู ููุฏุณู ูุชููู <strong>ุฑุฃุณูุง</strong> (ุฃู <em>ููุทุฉ</em> ) ุนูุฏ ุงูุฅุฏุฎุงู ุ ููุบุฐู <strong>ูุซูุซูุง ูุงุญุฏูุง</strong> ููุซู ุดูุฑุฉ ูู ุงูุนุดุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add inside the CGINCLUDE block. struct geometryOutput { float4 pos : SV_POSITION; }; [maxvertexcount(3)] void geo(triangle float4 IN[3] : SV_POSITION, inout TriangleStream&lt;geometryOutput&gt; triStream) { } โฆ // Add inside the SubShader Pass, just below the #pragma fragment frag line. #pragma geometry geo</span></span></code> </pre> <br>  ุชุนูู ุงูููุฏ ุฃุนูุงู ุนู ุชุธููู ููุฏุณู ูุณูู <code>geo</code> ูุน ูุนููุชูู.  ุงูุฃูู ุ <code>triangle float4 IN[3]</code> ุ ูุดูุฑ ุฅูู ุฃูู ุณูู ูุณุชุบุฑู ูุซูุซูุง ูุงุญุฏูุง (ูุชููู ูู ุซูุงุซ ููุงุท) ููุฏุฎูุงุช.  ูุงูุซุงูู ุ ูุซู <code>TriangleStream</code> ุ ูููู ุจุฅุนุฏุงุฏ ุชุธููู ูุฅุฎุฑุงุฌ ุฏูู ูู ุงููุซูุซุงุช ุจุญูุซ ูุณุชุฎุฏู ูู ููุฉ ุจููุฉ <code>geometryOutput</code> ููุฅุฎุฑุงุฌ ูููู ุจูุงูุงุชู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูููุง ุฃุนูุงู ุฃู ุงูุชุธููู ุณูุญุตู ุนูู ููุฉ ูุงุญุฏุฉ ูููุชุฌ ุดูุฑุฉ ูู ุงูุนุดุจ.</b>  <b class="spoiler_title">ููุงุฐุง ุฅุฐู ูุญุตู ุนูู ูุซูุซุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุณูููู ุฃูู ุชูููุฉ ูุงุชุฎุงุฐ <code></code> ููุฏุฎูุงุช.  ููููู ุงูููุงู ุจุฐูู ุนูู ุงููุญู ุงูุชุงูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">geo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(point vertexOutput IN[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">], inout TriangleStream&lt;geometryOutput&gt; triStream)</span></span></span></span></code> </pre> <br>  ููุน ุฐูู ุ ูุธุฑูุง ูุฃู ุดุจูุชูุง ุงููุงุฑุฏุฉ (ูู ูุฐู ุงูุญุงูุฉ <code>GrassPlane10x10</code> ุ ูุงูููุฌูุฏุฉ ูู ูุฌูุฏ <code>Mesh</code> ) ููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทูุจูููุฌูุง ูุซูุซ</a> ุ ูุฅู ูุฐุง ุณูุชุณุจุจ ูู ุนุฏู ุชุทุงุจู ุจูู ุทูุจูููุฌูุง ุงูุดุจูุงุช ุงููุงุฑุฏุฉ ูุงูุจุฏุงุฆูุฉ ุงููุทููุจุฉ ููุฅุฏุฎุงู.  ุนูู ุงูุฑุบู ูู ุฃู ูุฐุง <strong>ูุณููุญ ุจู</strong> ูู DirectX HLSL ุ ุฅูุง ุฃูู ุบูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณููุญ ุจู ูู OpenGL</a> ุ ูุฐูู ุณูุชู ุนุฑุถ ุฎุทุฃ. </div></div><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุถูู ุงููุนููุฉ ุงูุฃุฎูุฑุฉ ุจูู ุฃููุงุณ ูุฑุจุนุฉ ุฃุนูู ุฅุนูุงู ุงูุฏุงูุฉ: <code>[maxvertexcount(3)]</code> .  ูุฎุจุฑ GPU ุฃููุง ุณูู ูุฎุฑุฌ (ูููู ููุณ <strong>ูุทููุจูุง</strong> ูู ุฐูู) <em>ุฃูุซุฑ ูู</em> 3 ุฑุคูุณ.  ูุฌุนู ุฃูุถูุง <code>SubShader</code> ูุณุชุฎุฏู <code>SubShader</code> ููุฏุณููุง ุจุฅุนูุงูู ุฏุงุฎู <code>Pass</code> . <br><br>  ูุฏููุง ุชุธููู ููุฏุณู ูุง ุชูุนู ุฃู ุดูุก ุญุชู ุงูุขู.  ูุฑุณู ูุซูุซ ุ ุฃุถู ุงูููุฏ ุงูุชุงูู ุฏุงุฎู ุงูุชุธููู ุงูููุฏุณู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">geometryOutput o; o.pos = float4(<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); triStream.Append(o); o.pos = float4(<span class="hljs-number"><span class="hljs-number">-0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); triStream.Append(o); o.pos = float4(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); triStream.Append(o);</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0db/534/ac1/0db534ac10c125955829fd53b9923cd7.gif"></div><br>  ุฃุนุทู ูุฐุง ูุชุงุฆุฌ ุบุฑูุจุฉ ุฌุฏุง.  ุนูุฏ ุชุญุฑูู ุงููุงููุฑุง ุ ูุตุจุญ ูู ุงููุงุถุญ ุฃู ุงููุซูุซ ูุชู ุชูุฏููู ูู <strong>ูุณุงุญุฉ ุงูุดุงุดุฉ</strong> .  ูุฐุง ููุทูู: ูุธุฑูุง ูุฃู ุงูุชุธููู ุงูููุฏุณู ูุชู ุชูููุฐู ูุจุงุดุฑุฉู ูุจู ูุนุงูุฌุฉ ุงูููู ุ ูุฅูู ูุณุชุจุนุฏ ูู ุชุธููู ุงูุฑุฃุณ ูุณุคูููุฉ ุนุฑุถ ุงูููู ูู <strong>ูุณุงุญุฉ ุงูุงูุชุทุงุน</strong> .  ุณูู ูููู ุจุชุบููุฑ ุงูููุฏ ุงูุฎุงุต ุจูุง ููุนูุณ ูุฐุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Update the return call in the vertex shader. //return UnityObjectToClipPos(vertex); return vertex; โฆ // Update each assignment of o.pos in the geometry shader. o.pos = UnityObjectToClipPos(float4(0.5, 0, 0, 1)); โฆ o.pos = UnityObjectToClipPos(float4(-0.5, 0, 0, 1)); โฆ o.pos = UnityObjectToClipPos(float4(0, 1, 0, 1));</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/221/912/b3e/221912b3e6bc0581126a0f415b6e79c5.png"></div><br>  ุงูุขู ูุชู ุชูุฏูู ุงููุซูุซ ูุฏููุง ุจุดูู ุตุญูุญ ูู ุงูุนุงูู.  ููุน ุฐูู ุ ูุจุฏู ุฃู ูุชู ุฅูุดุงุก ูุงุญุฏ ููุท.  ูู ุงููุงูุน ุ ูุชู <em>ุฑุณู</em> ูุซูุซ ูุงุญุฏ ููู ููุฉ ูู ุดุจูุชูุง ุ ููู ุงูููุงุถุน ุงููุฎุตุตุฉ ูุฑุคูุณ ุงููุซูุซ <strong>ุซุงุจุชุฉ</strong> - ูุง ุชุชุบูุฑ ููู ููุฉ ูุงุฑุฏุฉ.  ูุฐูู ุ ุชูุฌุฏ ูู ุงููุซูุซุงุช ูุงุญุฏุฉ ููู ุงูุฃุฎุฑู. <br><br>  ุณูููู ุจุฅุตูุงุญ ุฐูู ุนู ุทุฑูู ุฌุนู ููุงุถุน ุงูุฐุฑูุฉ ุงูุตุงุฏุฑุฉ <strong>ุชุฎุงูููุง</strong> ุจุงููุณุจุฉ ุฅูู ุงูููุทุฉ ุงููุงุฑุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the top of the geometry shader. float3 pos = IN[0]; โฆ // Update each assignment of o.pos. o.pos = UnityObjectToClipPos(pos + float3(0.5, 0, 0)); โฆ o.pos = UnityObjectToClipPos(pos + float3(-0.5, 0, 0)); โฆ o.pos = UnityObjectToClipPos(pos + float3(0, 1, 0));</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6b2/ac4/84c/6b2ac484c5a033b18e88400e10191779.png"></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุฐุง ูุง ุชูุดุฆ ุจุนุถ ุงูููู ูุซูุซูุงุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/cab/447/d9c/cab447d9c4c82d8208a28e7cee2f7807.png"></div><br>  ุนูู ุงูุฑุบู ูู ุฃููุง ูุฑุฑูุง ุฃู ุงูุจุฏุงุฆู ุงููุงุฏู ุณูููู <strong>ูุซูุซูุง</strong> ุ ุฅูุง ุฃู ุดูุฑุฉ ุงูุนุดุจ ุชูุชูู ููุท ูู <strong>ุฅุญุฏู</strong> ููุงุท ุงููุซูุซ ุ ูุชุฌุงููุฉ ุงูุขุฎุฑูู.  ุจุงูุทุจุน ุ ูููููุง ููู ุดูุฑุฉ ูู ุงูุนุดุจ ูู ุฌููุน ุงูููุงุท ุงูุซูุงุซุฉ ุงููุงุฑุฏุฉ ุ ูููู ูุฐุง ุณูุคุฏู ุฅูู ุญูููุฉ ุฃู ุงููุซูุซุงุช ุงููุฌุงูุฑุฉ ุชูุดุฆ ุจุดูู ููุฑุท ุดูุฑุงุช ูู ุงูุนุดุจ ููู ุจุนุถูุง ุงูุจุนุถ. <br><br>  ุฃู ููููู ุญู ูุฐู ุงููุดููุฉ ุนู ุทุฑูู ุฃุฎุฐ ุงูุดุจูุงุช ุงูุชู ุชุญุชูู ุนูู ููุน ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุท</a> ุงูุทูุจูููุฌูุง ูุดุจูุงุช ูุงุฑุฏุฉ ูู ุงูุชุธููู ุงูููุฏุณู. </div></div><br>  ูุชู ุฑุณู ุงููุซูุซุงุช ุงูุขู ุจุดูู ุตุญูุญ ุ ูุชูุน ูุงุนุฏุชูุง ูู ุฐุฑูุฉ ุงูุจุนุงุซูุง.  ูุจู ุงูุงูุชูุงู ุ ุงุฌุนู ูุงุฆู <code>GrassPlane</code> <strong>ุบูุฑ ูุดุท</strong> ูู ุงููุดูุฏ ุ ูุฌุนู ูุงุฆู <code>GrassBall</code> <strong>ูุดุทูุง</strong> .  ูุฑูุฏ ุฅูุดุงุก ุงูุนุดุจ ุจุดูู ุตุญูุญ ุนูู ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃุณุทุญ ุ ูุฐูู ูู ุงูููู ุงุฎุชุจุงุฑู ุนูู ุดุจูุงุช ุฐุงุช ุฃุดูุงู ูุฎุชููุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/19b/f67/8fb/19bf678fbb6ce3c03956dbdf068004f0.png"></div><br>  ูู ุญูู ุฃู ุฌููุน ุงููุซูุซุงุช ุชูุจุนุซ ูู ุงุชุฌุงู ูุงุญุฏ ุ ูููุณ ุงูุฎุงุฑุฌ ูู ุณุทุญ ุงููุฑุฉ.  ูุญู ูุฐู ุงููุดููุฉ ุ ุณูููู ุจุฅูุดุงุก ุดูุฑุงุช ูู ุงูุนุดุจ ูู <strong>ูุณุงุญุฉ ุงูุธู</strong> . <br><br><h2 style=";text-align:right;direction:rtl">  2. ูุณุงุญุฉ ุงูุธู </h2><br>  ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ููุฏ ุฅูุดุงุก ุดูุฑุงุช ูู ุงูุนุดุจ ูู ุฎูุงู ุชุญุฏูุฏ ุนุฑุถ ูุทูู ูุงูุญูุงุก ูุฏูุฑุงู ูุฎุชูููู ุ ุฏูู ูุฑุงุนุงุฉ ุฒุงููุฉ ุงูุณุทุญ ุงูุชู ุชูุจุนุซ ูููุง ุดูุฑุฉ ุงูุนุดุจ.  ุจุจุณุงุทุฉ ุ ูุญุฏุฏ ุดูุฑุฉ ูู ุงูุนุดุจ ูู ูุณุงุญุฉ <strong>ููุถุนูุฉ ููุฑุฃุณ ุงูุชู ุชูุจุนุซ ูููุง</strong> ุ ุซู ูุญูููุง ุจุญูุซ ุชููู <strong>ููุถุนูุฉ ููุดุจูุฉ</strong> .  ูุฐุง ุงููุถุงุก ูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุงุญุฉ ุงูุธู</a> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/3fd/8f7/c39/3fd8f7c394bf4eb18cb988aceafe342b.png"></div><br>  <i>ูู ุงููุถุงุก ุงูููุงุณู ุ ูุชู ุชุนุฑูู ูุญุงูุฑ <strong>X</strong> ู <strong>Y</strong> ู <strong>Z</strong> ุจุงููุณุจุฉ ุฅูู ุงููุถุน ุงูุทุจูุนู ูููุถุน ุงูุณุทุญ (ูู ุญุงูุชูุง ุ ุงูุฑุคูุณ).</i> <br><br>  ูุซู ุฃู ูุณุงุญุฉ ุฃุฎุฑู ุ ูููููุง ุชุญุฏูุฏ ูุณุงุญุฉ ุงูุธู ูู ููุฉ ุงูุฑุฃุณ ุจุซูุงุซุฉ ูุชุฌูุงุช: <strong>ุงููููู</strong> ุ <strong>ููุฃูุงู</strong> <strong>ูููุฃุนูู</strong> .  ุจุงุณุชุฎุฏุงู ูุฐู ุงููุชุฌูุงุช ุ ูููููุง ุฅูุดุงุก ูุตูููุฉ ูุชุญููู ุดูุฑุฉ ุงูุนุดุจ ูู ุงูุธู ุฅูู ุงููุถุงุก ุงููุญูู. <br><br>  ููููู ุงููุตูู ุฅูู ุงููุชุฌูุงุช ุจุดูู <strong>ุตุญูุญ</strong> <strong>ูุฃุนูู</strong> ุนู ุทุฑูู ุฅุถุงูุฉ ุจูุงูุงุช ููุฉ ุฅุฏุฎุงู ุฌุฏูุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the CGINCLUDE block. struct vertexInput { float4 vertex : POSITION; float3 normal : NORMAL; float4 tangent : TANGENT; }; struct vertexOutput { float4 vertex : SV_POSITION; float3 normal : NORMAL; float4 tangent : TANGENT; }; โฆ // Modify the vertex shader. vertexOutput vert(vertexInput v) { vertexOutput o; o.vertex = v.vertex; o.normal = v.normal; o.tangent = v.tangent; return o; } โฆ // Modify the input for the geometry shader. Note that the SV_POSITION semantic is removed. void geo(triangle vertexOutput IN[3], inout TriangleStream&lt;geometryOutput&gt; triStream) โฆ // Modify the existing line declaring pos. float3 pos = IN[0].vertex;</span></span></code> </pre> <br>  ูููู ุญุณุงุจ ุงููุชุฌู ุงูุซุงูุซ ุนู ุทุฑูู ุฃุฎุฐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุชุฌ ุงููุชุฌู</a> ุจูู ุงุซููู ุขุฎุฑูู.  ุฅุฑุฌุงุน ููุชุฌ ูุชุฌู ูุชุฌู <strong>ุนููุฏู</strong> ุฅูู ูุชุฌููู ูุงุฑุฏุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Place in the geometry shader, below the line declaring float3 pos. float3 vNormal = IN[0].normal; float4 vTangent = IN[0].tangent; float3 vBinormal = cross(vNormal, vTangent) * vTangent.w;</span></span></code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุฐุง ูุชู ุถุฑุจ ูุงุชุฌ ุงููุชุฌู ุจุฅุญุฏุงุซูุงุช ุงูููุงุณุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุนูุฏ ุชุตุฏูุฑ ุดุจูุฉ ูู ูุญุฑุฑ ุซูุงุซู ุงูุฃุจุนุงุฏ ุ ุนุงุฏุฉู ูุง ุชุญุชูู ุนูู ููุงุท ุซูุงุฆูุฉ (ุชุณูู ุฃูุถูุง <em>ุงูุธูุงู ุจููุทุชูู</em> ) ูุฎุฒูุฉ ุจุงููุนู ูู ุจูุงูุงุช ุงูุดุจูุฉ.  ุจุฏูุงู ูู ุงุณุชูุฑุงุฏ ูุฐู ุงูุฃุดูุงู ุงูุซูุงุฆูุฉ ุ ุชุฃุฎุฐ ุงููุญุฏุฉ ุจุจุณุงุทุฉ ุงุชุฌุงู ูู ุซูุงุฆู ุงูุงุชุฌุงู ูุชุนููููุง ุฅูู ุฅุญุฏุงุซูุงุช ุงูุธู.  ูุชูุญ ูู ุฐูู ุญูุธ ุงูุฐุงูุฑุฉ ุ ูุน ุชูููุฑ ุงููุฏุฑุฉ ูู ููุณ ุงูููุช ุนูู ุฅุนุงุฏุฉ ุฅูุดุงุก ุงููุนูุงุฑ ุงูุตุญูุญ.  ูููู ุงูุงุทูุงุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุนูู ููุงูุดุฉ ุชูุตูููุฉ ููุฐุง ุงูููุถูุน. </div></div><br>  ุจุนุฏ ูู ุงููุชุฌูุงุช ุงูุซูุงุซุฉ ุ ูููููุง ุฅูุดุงุก ูุตูููุฉ ููุชุญูู ุจูู ุงูููุงุณ ูุงููุณุงุญุงุช ุงููุญููุฉ.  ุณูููู ุจุถุฑุจ ูู ููุฉ ูู ุดูุฑุฉ ุงูุนุดุจ ูู ูุฐู ุงููุตูููุฉ ูุจู ุชูุฑูุฑูุง ุฅูู <code>UnityObjectToClipPos</code> ุ ูุงูุชู ุชุชููุน ููุฉ ูู ุงููุถุงุก ุงููุญูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the lines declaring the three vectors. float3x3 tangentToLocal = float3x3( vTangent.x, vBinormal.x, vNormal.x, vTangent.y, vBinormal.y, vNormal.y, vTangent.z, vBinormal.z, vNormal.z );</span></span></code> </pre> <br>  ูุจู ุงุณุชุฎุฏุงู ุงููุตูููุฉ ุ ูููู ุฑูุฒ ุฅุฎุฑุงุฌ ููุฉ ุงูุฑุฃุณ ุฅูู ุงููุธููุฉ ุญุชู ูุง ููุชุจ ููุณ ุณุทูุฑ ุงูุดูุฑุฉ ูุฑุงุฑูุง ูุชูุฑุงุฑูุง.  ููุฐุง ูุง ูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจุฏุฃ DRY</a> ุ ุฃู <strong>ูุง ุชูุฑุฑ ููุณู</strong> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the CGINCLUDE block. geometryOutput VertexOutput(float3 pos) { geometryOutput o; o.pos = UnityObjectToClipPos(pos); return o; } โฆ // Remove the following from the geometry shader. //geometryOutput o; //o.pos = UnityObjectToClipPos(pos + float3(0.5, 0, 0)); //triStream.Append(o); //o.pos = UnityObjectToClipPos(pos + float3(-0.5, 0, 0)); //triStream.Append(o); //o.pos = UnityObjectToClipPos(pos + float3(0, 1, 0)); //triStream.Append(o); // ...and replace it with the code below. triStream.Append(VertexOutput(pos + float3(0.5, 0, 0))); triStream.Append(VertexOutput(pos + float3(-0.5, 0, 0))); triStream.Append(VertexOutput(pos + float3(0, 1, 0)));</span></span></code> </pre> <br>  ุฃุฎูุฑูุง ุ ูููู ุจุถุฑุจ ุฑุคูุณ <code>tangentToLocal</code> ุจูุตูููุฉ <code>tangentToLocal</code> ุ <code>tangentToLocal</code> ุจุดูู ุตุญูุญ ูุน ุงูุนุงุฏู ูููุทุฉ ุงูุฅุฏุฎุงู ุงูุฎุงุตุฉ ุจูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)))); triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(<span class="hljs-number"><span class="hljs-number">-0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)))); triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))));</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c95/3f8/286/c953f828675a9d4e202c0c9349d37f9d.png" alt="ุตูุฑุฉ"></div><br>  ูุฐุง ุฃุดุจู ูุง ูุญุชุงุฌู ุ ูููู ููุณ ุตุญูุญูุง ุชูุงููุง.  ุงููุดููุฉ ููุง ูู ุฃููุง ูู ุงูุจุฏุงูุฉ ูููุง ุจุชุนููู ุงูุงุชุฌุงู "ูุฃุนูู" (ููุฃุนูู) ูููุญูุฑ <strong>Y</strong> ุ  ููุน ุฐูู ุ ูู ุงููุถุงุก ุงูููุงุณู ุ ููุฌุฏ ุงุชุฌุงู ุงูุงุฑุชูุงุน ุนุงุฏุฉู ุนูู ุทูู ุงููุญูุฑ <strong>Z.</strong>  ุงูุขู ุณูููู ุจุฅุฌุฑุงุก ูุฐู ุงูุชุบููุฑุงุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Modify the position of the third vertex being emitted. triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(0, 0, 1))));</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/0cf/f51/ddb/0cff51ddbea12280cb78a1db9ada1786.png"></div><br><h2 style=";text-align:right;direction:rtl">  3. ุธููุฑ ุงูุนุดุจ </h2><br>  ูุฌุนู ูุซูุซุงุช ุชุจุฏู ููุฃููุง ุดูุฑุงุช ุงูุนุดุจ ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุฃููุงู ูุฃุดูุงู ูุฎุชููุฉ.  ูุจุฏุฃ ุจุฅุถุงูุฉ <strong>ุงูุชุฏุฑุฌ ุงููุฒููู</strong> ูู ุฃุนูู ุดูุฑุฉ ุงูุนุดุจ. <br><br><h3 style=";text-align:right;direction:rtl">  3.1 ููู ุงูุชุฏุฑุฌ </h3><br>  ูุฏููุง ูู ุงูุณูุงุญ ููููุงู ุจุชุนููู ููููู - ูู ุงูุฃุนูู ูุงูุฃุณูู ุ ูุฃู ููููุจ ุจูู ูุฐูู ุงูููููู ุฅูู ูุงุนุฏุฉ ุดูุฑุฉ ุงูุนุดุจ.  ูุชู ุชุนุฑูู ูุฐู ุงูุฃููุงู ุจุงููุนู ูู ููู ุงูุชุธููู ูู <code>_TopColor</code> ู <code>_BottomColor</code> .  ูุฃุฎุฐ ุงูุนููุงุช ุงูููุงุณุจุฉ ุ ุชุญุชุงุฌ ุฅูู ุชูุฑูุฑ <strong>ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ</strong> ูุชุธููู ุดุธูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the geometryOutput struct. float2 uv : TEXCOORD0; โฆ // Modify the VertexOutput function signature. geometryOutput VertexOutput(float3 pos, float2 uv) โฆ // Add to VertexOutput, just below the line assigning o.pos. o.uv = uv; โฆ // Modify the existing lines in the geometry shader. triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(0.5, 0, 0)), float2(0, 0))); triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(-0.5, 0, 0)), float2(1, 0))); triStream.Append(VertexOutput(pos + mul(tangentToLocal, float3(0, 0, 1)), float2(0.5, 1)));</span></span></code> </pre> <br>  ุฃูุดุฃูุง ุฅุญุฏุงุซูุงุช ููุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูุดูุฑุฉ ูู ุงูุนุดุจ ุนูู ุดูู ูุซูุซ ุ ููุน ุฑุฃุณุง ุงููุงุนุฏุฉ ูู ุฃุณูู ุงููุณุงุฑ ูุงููููู ุ ูููุฌุฏ ุฑุฃุณ ุงูุญุงูุฉ ูู ุงููุณุท ูู ุงูุฃุนูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/165/e39/932/165e399323aaa07e7c4cee728c0c9988.png"></div><br>  <i>ุฅุญุฏุงุซูุงุช ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูู ุงูููู ุงูุซูุงุซุฉ ูุฑูุด ุงูุนุดุจ.</i>  <i>ุนูู ุงูุฑุบู ูู ุฃููุง ูุฑุณู ุดูุฑุงุช ุงูุนุดุจ ุจุชุฏุฑุฌ ุจุณูุท ุ ุฅูุง ุฃู ูุฌูุฏ ุชุฑุชูุจ ููุงุซู ููุฃูุณุฌุฉ ูุชูุญ ูู ุชุฑุงูุจ ุงูููุงู.</i> <br><br>  ุงูุขู ุ ูููููุง <code>lerp</code> ุงูุฃููุงู ุงูุนูููุฉ ูุงูุณูููุฉ ูู ุดุธูุฉ ุงููุทุนุฉ ุจุงุณุชุฎุฏุงู ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ููู ุซู <code>lerp</code> ูุน <code>lerp</code> .  ุณูู ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุชุนุฏูู ูุนููุงุช ุชุธููู ุงูุฃุฌุฒุงุก ุ ูุฌุนู <code>geometryOutput</code> <code>float4</code> ูุฅุฏุฎุงู ุ ูููุณ ููุท ููุถุน <code>float4</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Modify the function signature of the fragment shader. float4 frag (geometryOutput i, fixed facing : VFACE) : SV_Target โฆ // Replace the existing return call. return float4(1, 1, 1, 1); return lerp(_BottomColor, _TopColor, i.uv.y);</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/596/510/51f/59651051f474907a88740e83bc9d4532.png"></div><br><h3 style=";text-align:right;direction:rtl">  3.2 ุงุชุฌุงู ุดูุฑุฉ ุนุดูุงุฆู </h3><br>  ูุฎูู ุชููุจ ูุฅุนุทุงุก ุงูุนุดุจ ูุธุฑุฉ ุฃูุซุฑ ุทุจูุนูุฉ ุ ุณูุฌุนู ูู ุดูุฑุฉ ูู ุงูุนุดุจ ุชุจุฏู ูู ุงุชุฌุงู ุนุดูุงุฆู.  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุตูููุฉ ุฏูุฑุงู ุชุฏูุฑ ูุตู ุงูุนุดุจ ุจูููุฉ ุนุดูุงุฆูุฉ ุญูู ูุญูุฑูุง <strong>ุงูุฃุนูู</strong> . <br><br>  ููุงู ูุธููุชุงู ูู ููู ุงูุชุธููู ุณูุณุงุนุฏุงููุง ุนูู ุงูููุงู ุจุฐูู: <code>rand</code> ุ ุงูุฐู ูููุฏ ุฑูููุง ุนุดูุงุฆููุง ูู ุงููุฏุฎูุงุช ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ุ ู <code>AngleAxis3x3</code> ุ ุงูุฐู ูุณุชูุจู ุงูุฒุงููุฉ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงูุฑุงุฏูุงู</a> ) ููุนูุฏ ูุตูููุฉ ุชุฏูุฑ ูุฐู ุงููููุฉ ุญูู ุงููุญูุฑ ุงููุญุฏุฏ.  ุชุนูู ุงููุธููุฉ ุงูุฃุฎูุฑุฉ ุชูุงููุง ูุซู ูุธููุฉ C # <code>AngleAxis3x3</code> ุชูุฑุฌุน <code>AngleAxis3x3</code> ููุท ูุตูููุฉ ูููุณุช quaternion). <br><br>  ุชุฑุฌุน ุงูุฏุงูุฉ <code>rand</code> ุฑููุงู ูู ุงููุทุงู 0 ... 1 ุ  ูููู ุจุถุฑุจู ูู <strong>2 Pi</strong> ููุญุตูู ุนูู ูุฌููุนุฉ ูุงููุฉ ูู ุงูููู ุงูุฒุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring the tangentToLocal matrix. float3x3 facingRotationMatrix = AngleAxis3x3(rand(pos) * UNITY_TWO_PI, float3(0, 0, 1));</span></span></code> </pre> <br>  ูุญู ูุณุชุฎุฏู ูููู <code>pos</code> ุงููุงุฑุฏ ูุจุฐูุฑ ูุฏูุฑุงู ุนุดูุงุฆู.  ูุชูุฌุฉ ููุฐุง ุ ุณูููู ููู ูุตู ูู ุงูุนุดุจ ุฏูุฑุชู ุงูุฎุงุตุฉ ุ ุซุงุจุช ูู ูู ุฅุทุงุฑ. <br><br>  ูููู ุชุทุจูู ุงูุฏูุฑุงู ุนูู ุดูุฑุฉ ุงูุญุดุงุฆุด <code>tangentToLocal</code> ุจูุตูููุฉ <code>tangentToLocal</code> ุชู ุฅูุดุงุคูุง.  ูุงุญุธ ุฃู ูุตูููุฉ ุงูุถุฑุจ <strong>ููุณุช</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุจุงุฏููุฉ</a> ุ  ุชุฑุชูุจ ุงููุนุงููุงุช <strong>ููู</strong> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring facingRotationMatrix. float3x3 transformationMatrix = mul(tangentToLocal, facingRotationMatrix); โฆ // Replace the multiplication matrix operand with our new transformationMatrix. triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(0.5, 0, 0)), float2(0, 0))); triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(-0.5, 0, 0)), float2(1, 0))); triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(0, 0, 1)), float2(0.5, 1)));</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/09f/c2f/e80/09fc2fe8028b51f78989954e65812cd3.png"></div><br><h3 style=";text-align:right;direction:rtl">  3.3 ุงูุงูุญูุงุก ุฅูู ุงูุฃูุงู ุนุดูุงุฆู </h3><br>  ุฅุฐุง ูุงูุช ุฌููุน ุดูุฑุงุช ุงูุนุดุจ ูุญุงุฐุงุฉ ุชูุงููุง ุ ูุณุชุธูุฑ ุจููุณ ุงูุดูู.  ูุฏ ูููู ูุฐุง ููุงุณุจูุง ููุนุดุจ ุงูุฐู ุชู ุฅุนุฏุงุฏู ุฌูุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุฑูุฌ ูุฒุฎุฑูุฉ ุ ูููู ูู ุงูุทุจูุนุฉ ูุง ุชููู ุงูุนุดุจ ูู ูุฐุง ุงููุจูู.  ุณูููู ุจุฅูุดุงุก ูุตูููุฉ ุฌุฏูุฏุฉ ูุชุฏููุฑ ุงูุนุดุจ ุนูู ุทูู ุงููุญูุฑ <strong>X</strong> ุ ููุฐูู ุฎุงุตูุฉ ููุชุญูู ูู ูุฐุง ุงูุฏูุฑุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as a new property. _BendRotationRandom("Bend Rotation Random", Range(0, 1)) = 0.2 โฆ // Add to the CGINCLUDE block. float _BendRotationRandom; โฆ // Add to the geometry shader, below the line declaring facingRotationMatrix. float3x3 bendRotationMatrix = AngleAxis3x3(rand(pos.zzx) * _BendRotationRandom * UNITY_PI * 0.5, float3(-1, 0, 0));</span></span></code> </pre> <br>  ูุฑุฉ ุฃุฎุฑู ูุณุชุฎุฏู ููุถุน ุดูุฑุฉ ุงูุนุดุจ ูุจุฐูุฑ ุนุดูุงุฆูุฉ ุ ูุฐู ุงููุฑุฉ ุนู ุทุฑูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุณ</a> ูุฅูุดุงุก ุจุฐุฑุฉ ูุฑูุฏุฉ ูู ููุนูุง.  ุณูููู ุฃูุถูุง ุจุถุฑุจ <code>UNITY_PI</code> ุจููุฏุงุฑ <strong>0.5</strong> ุ  ูุฐุง ุณูุนุทููุง ูุงุตู ุนุดูุงุฆู ูู 0 ... 90 ุฏุฑุฌุฉ. <br><br>  ูุทุจู ูุฐู ุงููุตูููุฉ ูุฑุฉ ุฃุฎุฑู ูู ุฎูุงู ุงูุชูุงูุจ ุ ููุถุฑุจ ูู ุดูุก ุจุงูุชุฑุชูุจ ุงูุตุญูุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Modify the existing line. float3x3 transformationMatrix = mul(mul(tangentToLocal, facingRotationMatrix), bendRotationMatrix);</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/49c/122/534/49c122534d7298c0f9c646501a708daa.gif"></div><br><h3 style=";text-align:right;direction:rtl">  3.4 ุงูุนุฑุถ ูุงูุงุฑุชูุงุน </h3><br>  ุจูููุง ููุชุตุฑ ุญุฌู ุดูุฑุฉ ุงูุนุดุจ ุนูู ุนุฑุถ ูุญุฏุฉ ูุงุญุฏุฉ ูุงุฑุชูุงุน 1 ูุญุฏุฉ.  ุณูุถูู ุฎุตุงุฆุต ููุชุญูู ูู ุงูุญุฌู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฎุตุงุฆุต ูุฅุถุงูุฉ ุฃุดูุงู ุนุดูุงุฆูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as new properties. _BladeWidth("Blade Width", Float) = 0.05 _BladeWidthRandom("Blade Width Random", Float) = 0.02 _BladeHeight("Blade Height", Float) = 0.5 _BladeHeightRandom("Blade Height Random", Float) = 0.3 โฆ // Add to the CGINCLUDE block. float _BladeHeight; float _BladeHeightRandom; float _BladeWidth; float _BladeWidthRandom; โฆ // Add to the geometry shader, above the triStream.Append calls. float height = (rand(pos.zyx) * 2 - 1) * _BladeHeightRandom + _BladeHeight; float width = (rand(pos.xzy) * 2 - 1) * _BladeWidthRandom + _BladeWidth; โฆ // Modify the existing positions with our new height and width. triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(width, 0, 0)), float2(0, 0))); triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(-width, 0, 0)), float2(1, 0))); triStream.Append(VertexOutput(pos + mul(transformationMatrix, float3(0, 0, height)), float2(0.5, 1)));</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/35b/22e/f34/35b22ef34945a576100a152a0e25eec5.png"></div><br>  ุฃุตุจุญุช ุงููุซูุซุงุช ุงูุขู ุฃุดุจู ุจุดูุฑุงุช ุงูุญุดุงุฆุด ุ ูููููุง ุฃูุถูุง ููููุฉ ุฌุฏูุง.  ุจุจุณุงุทุฉ ุ ูุง ุชูุฌุฏ ููู ูุงููุฉ ูู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ ูุฅูุดุงุก ุงูุทุจุงุน ุจุญูู ูุซูู ุงูููู. <br><br>  ุฃุญุฏ ุงูุญููู ูู ุฅูุดุงุก ุดุจูุฉ ุฌุฏูุฏุฉ ุฃูุซุฑ ูุซุงูุฉ ุ ุฅูุง ุจุงุณุชุฎุฏุงู C # ุฃู ูู ูุญุฑุฑ ุซูุงุซู ุงูุฃุจุนุงุฏ.  ุณูู ูุนูู ูุฐุง ุ ููู ูู ูุณูุญ ููุง ุจุงูุชุญูู ุฏููุงูููููุง ูู ูุซุงูุฉ ุงูุนุดุจ.  ุจุฏูุงู ูู ุฐูู ุ ุณูููู ุจุชูุณูู ุงูุดุจูุฉ ุงููุงุฑุฏุฉ ุจุงุณุชุฎุฏุงู <strong>ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก</strong> . <br><br><h2 style=";text-align:right;direction:rtl">  4. ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก </h2><br>  <strong>ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก</strong> ูู ูุฑุญูุฉ ุงุฎุชูุงุฑูุฉ ูุฎุท ุฃูุงุจูุจ ุงูุชูุฏูู ุ ูุชู ุชูููุฐูุง ุจุนุฏ ุชุธููู ุงูุฑุฃุณ ููุจู ุงูุชุธููู ุงูููุฏุณู (ุฅู ูุฌุฏ).  ูุชุชูุซู ูููุชูุง ูู ุชูุณูู ุณุทุญ ูุงุฑุฏ ูุงุญุฏ ุฅูู ุงูุนุฏูุฏ ูู ุงูุนูุงุตุฑ ุงูุจุฏุงุฆูุฉ.  ูุชู ุชุทุจูู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ูู ุฎุทูุชูู ููุจุฑูุฌุฉ: ุชุธููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงููุฌุงู</a> . <br><br>  ุจุงููุณุจุฉ ูุชุธููู ุงูุณุทุญ ุ ูุฏู Unity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุทุจูู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ุงููุถูู</a> .  ููุน ุฐูู ุ ูุธุฑูุง ูุฃููุง <strong>ูุง ูุณุชุฎุฏู</strong> ุงูุชุธููู ุงูุณุทุญู ุ ูุณูุชุนูู ุนูููุง ุชุทุจูู ุชุธููู ุงููุทุงู ูุงููุฌุงู ุงูุฎุงุตุฉ ุจูุง.  ูู ูุฐู ุงูููุงูุฉ ุ ูู ุฃูุงูุด ุชุทุจูู <code>CustomTessellation.cginc</code> ุจุงููุณููุณุงุก ุจุงูุชูุตูู ุ ููุญู ุจุจุณุงุทุฉ ูุณุชุฎุฏู ููู <code>CustomTessellation.cginc</code> ุงูููุฌูุฏ.  ูุฐุง ุงูููู ููุชุจุณ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู Catlike Coding</a> ุ ูุงูุฐู ูุนุฏ ูุตุฏุฑูุง ููุชุงุฒูุง ูููุนูููุงุช ุนู ุชูููุฐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุบุทูุฉ</a> ุจุงููุณููุณุงุก ูู Unity. <br><br>  ุฅุฐุง ูููุง ุจุชุถููู ูุงุฆู <code>TessellationExample</code> ูู ุงููุดูุฏ ุ ูุณูู ูุฑู ุฃูู ูุญุชูู ุจุงููุนู ุนูู ููุงุฏ ุชููุฐ ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก.  ุชุบููุฑ ุฎุงุตูุฉ <strong>Tessellation Uniform</strong> ููุถุญ ุชุฃุซูุฑ ุงูุชูุณูู ุงููุฑุนู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2d8/8a7/f01/2d88a7f01e3a7462ffd0c8f20953b5ca.gif"></div><br>  ูููุฐ ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ูู ุชุธููู ุงูุนุดุจ ููุชุญูู ูู ูุซุงูุฉ ุงูุทุงุฆุฑุฉ ุ ูุจุงูุชุงูู ููุชุญูู ูู ุนุฏุฏ ูู ุดูุฑุงุช ุงูุนุดุจ ุงููุชููุฏุฉ.  ุชุญุชุงุฌ ุฃููุงู ุฅูู ุฅุถุงูุฉ ููู <code>CustomTessellation.cginc</code> .  ุณูู ูุดูุฑ ุฅูููุง ูู ุฎูุงู ุทุฑูููุง <em>ุงููุณุจู</em> ุฅูู ุงูุชุธููู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add inside the CGINCLUDE block, below the other #include statements. #include "Shaders/CustomTessellation.cginc"</span></span></code> </pre> <br>  ุฅุฐุง ููุช ุจูุชุญ <code>CustomTessellation.cginc</code> ุ ูุณุชูุงุญุธ ุฃู <code>vertexOutput</code> ู <code>vertexOutput</code> ุ ููุฐูู ุชุธููู vertex ุ ูุนุฑููุฉ ุจุงููุนู ูู ุฐูู.  ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุนุฑูููู ูู ุชุธููู ุงูุนุดุจ ูุฏููุง ุ  ูููู ุญุฐููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*struct vertexInput { float4 vertex : POSITION; float3 normal : NORMAL; float4 tangent : TANGENT; }; struct vertexOutput { float4 vertex : SV_POSITION; float3 normal : NORMAL; float4 tangent : TANGENT; }; vertexOutput vert(vertexInput v) { vertexOutput o; o.vertex = v.vertex; o.normal = v.normal; o.tangent = v.tangent; return o; }*/</span></span></code> </pre> <br>  ูุงุญุธ ุฃู ุชุธููู ููุฉ ุงูุฑุฃุณ ูู <code>CustomTessellation.cginc</code> ุจุจุณุงุทุฉ ุงููุฏุฎูุงุช ูุจุงุดุฑุฉ ุฅูู ูุฑุญูุฉ <code>CustomTessellation.cginc</code> ุจุงููุณููุณุงุก ุ  <code>vertexOutput</code> ูุธููุฉ <code>vertexOutput</code> ุ ูุงูุชู ุชุณูู ุฏุงุฎู ุชุธููู ุงููุฌุงู ุ ูููุฉ ุฅูุดุงุก ุจููุฉ <code>vertexOutput</code> . <br><br>  ุงูุขู ูููููุง ุฅุถุงูุฉ ุชุธููู <strong>shell</strong> <strong>ูุงููุฌุงู</strong> ุฅูู ุชุธููู ุงูุนุดุจ.  ุณูุถูู ุฃูุถูุง ุฎุงุตูุฉ <code>_TessellationUniform</code> ุฌุฏูุฏุฉ ููุชุญูู ูู ุญุฌู ุงููุญุฏุฉ - ุชู ุฅุนูุงู ุงููุชุบูุฑ ุงููุทุงุจู ููุฐู ุงูุฎุงุตูุฉ ูู <code>CustomTessellation.cginc</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as a new property. _TessellationUniform("Tessellation Uniform", Range(1, 64)) = 1 โฆ // Add below the other #pragma statements in the SubShader Pass. #pragma hull hull #pragma domain domain</span></span></code> </pre> <br>  ุงูุขู ุชุบููุฑ ุฎุงุตูุฉ <strong>Tessellation Uniform</strong> ูุชูุญ ููุง ุงูุชุญูู ูู ูุซุงูุฉ ุงูุนุดุจ.  ููุฏ ูุฌุฏุช ุฃูู ูุชู ุงูุญุตูู ุนูู ูุชุงุฆุฌ ุฌูุฏุฉ ุจูููุฉ <strong>5</strong> . <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/280/d93/c14/280d93c1420a9744bd56f2d2496f96ab.gif"></div><br><h2 style=";text-align:right;direction:rtl">  5. ุงูุฑูุญ </h2><br>  ูููุฐ ุงูุฑูุญ ุนู ุทุฑูู ุฃุฎุฐ ุนููุงุช ูู <strong>ุชุดููู ุงููููุณ</strong> .  ุณูุจุฏู ูุฐุง ุงููููุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฎุฑูุทุฉ ุนุงุฏูุฉ</a> ุ ููุท ุจู ุณุชูุฌุฏ ููุงุชุงู ููุท ุจุฏูุงู ูู ุซูุงุซ ูููุงุช.  ุณูู ูุณุชุฎุฏู ูุงุชูู ุงูููุงุชูู ูู ุงุชุฌุงูุงุช ุงูุฑูุงุญ ุนูู ุทูู <strong>X</strong> ู <strong>Y.</strong> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/a58/aaa/687/a58aaa68742934ff1bddf1cbaf9564f5.png"></div><br>  ูุจู ุฃุฎุฐ ุนููุงุช ูู ูุณูุฌ ุงูุฑูุงุญ ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ุชูุณูู ููุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ.  ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุงููุณูุฌ ุงููุนููุฉ ููุดุจูุฉ ุ ูุทุจู ููุถุน ุงูููุทุฉ ุงููุงุฑุฏุฉ.  ุจูุถู ูุฐุง ุ ุฅุฐุง ูุงู ููุงู ุงูุนุฏูุฏ ูู ุงูุดุจูุงุช ุงูุนุดุจูุฉ ูู ุงูุนุงูู ุ ุณูุชู ุฅูุดุงุก ุงูููู ุจุฃููู ุฌุฒุก ูู ูุธุงู ุงูุฑูุงุญ ููุณู.  ููุง ูุณุชุฎุฏู <code>_Time</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุฏูุฌ ูู shader</a> <code>_Time</code> ูุชูุฑูุฑ ูุณูุฌ ุงูุฑูุงุญ ุนูู ุทูู ุณุทุญ ุงูุนุดุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as new properties. _WindDistortionMap("Wind Distortion Map", 2D) = "white" {} _WindFrequency("Wind Frequency", Vector) = (0.05, 0.05, 0, 0) โฆ // Add to the CGINCLUDE block. sampler2D _WindDistortionMap; float4 _WindDistortionMap_ST; float2 _WindFrequency; โฆ // Add to the geometry shader, just above the line declaring the transformationMatrix. float2 uv = pos.xz * _WindDistortionMap_ST.xy + _WindDistortionMap_ST.zw + _WindFrequency * _Time.y;</span></span></code> </pre> <br>  ูุญู ูุทุจู ูููุงุณ ูุฅุฒุงุญุฉ <code>_WindDistortionMap</code> ุนูู ุงูููุถุน ุ ุซู <code>_Time.y</code> ุฅูู <code>_Time.y</code> ุ ูุญุฌูุจ ุฅูู <code>_WindFrequency</code> .  ุงูุขู ุณูู ูุณุชุฎุฏู ูุฐู ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูุฃุฎุฐ ุนููุงุช ูู ุงููุณูุฌ ูุฅูุดุงุก ุฎุงุตูุฉ ููุชุญูู ูู ููุฉ ุงูุฑูุงุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as a new property. _WindStrength("Wind Strength", Float) = 1 โฆ // Add to the CGINCLUDE block. float _WindStrength; โฆ // Add below the line declaring float2 uv. float2 windSample = (tex2Dlod(_WindDistortionMap, float4(uv, 0, 0)).xy * 2 - 1) * _WindStrength;</span></span></code> </pre> <br>  ูุงุญุธ ุฃููุง ูููู ุจููุงุณ ุงููููุฉ ุงูุชู ุชู ุฃุฎุฐ ุนููุงุช ูููุง ูู ุงููุณูุฌ ูู ุงููุงุตู ุงูุฒููู 0 ... 1 ุฅูู ุงููุงุตู -1 ... 1.  ุจุนุฏ ุฐูู ุ ูููููุง ุฅูุดุงุก ูุชุฌู ุทุจูุนู ูุฏู ุนูู ุงุชุฌุงู ุงูุฑูุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring float2 windSample. float3 wind = normalize(float3(windSample.x, windSample.y, 0));</span></span></code> </pre> <br>  ุงูุขู ูููููุง ุฅูุดุงุก ูุตูููุฉ ููุชุฏููุฑ ุญูู ูุฐุง ุงููุชุฌู ูุถุฑุจู ุจูุงุณุทุฉ <code>transformationMatrix</code> ุจูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring float3 wind. float3x3 windRotation = AngleAxis3x3(UNITY_PI * windSample, wind); โฆ // Modify the existing line. float3x3 transformationMatrix = mul(mul(mul(tangentToLocal, windRotation), facingRotationMatrix), bendRotationMatrix);</span></span></code> </pre> <br>  ุฃุฎูุฑูุง ุ ูููู ุจููู ูุณูุฌ <code>Wind</code> (ุงูููุฌูุฏ ูู ุฌุฐุฑ ุงููุดุฑูุน) ุฅูู ุญูู <strong>Wind Distortion Map</strong> ูู ุงููุงุฏุฉ ุงูุนุดุจูุฉ ูู ูุญุฑุฑ Unity.  ููุฏ ูููุง ุฃูุถูุง ุจุชุนููู ุงููุนููุฉ <strong>Tiling</strong> ูููุณูุฌ ุนูู <code>0.01, 0.01</code> . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  ุฅุฐุง ูู ููู ุงูุนุดุจ ูุชุญุฑููุง ูู ูุงูุฐุฉ <strong>Scene</strong> ุ ูุงููุฑ ููู <strong>Toggle skybox ุ ุงูุถุจุงุจ ุ ููุฎุชูู ุชุฃุซูุฑุงุช ุงููุคุซุฑุงุช ุงูุฃุฎุฑู</strong> ูุชูููู ุงูููุงุฏ ุงููุชุญุฑูุฉ. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ูุณุงูุฉ ุจุนูุฏุฉ ุ ุชุจุฏู ุงูุนุดุจ ุตุญูุญุฉ ุ ููู ุฅุฐุง ูุธุฑูุง ุนู ูุซุจ ุฅูู ุดูุฑุฉ ุงูุนุดุจ ุ ูุงุญุธูุง ุฃู ุดูุฑุฉ ุงูุนุดุจ ุจุฃููููุง ุชุฏูุฑ ุ ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ุงููุงุนุฏุฉ ูู ุชุนุฏ ูุชุตูุฉ ุจุงูุฃุฑุถ. </font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6e9/148/51e/6e914851e888c448c30080a7abefae33.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุชุนุฏ ูุงุนุฏุฉ ุดูุฑุฉ ุงูุนุดุจ ูุชุตูุฉ ุจุงูุฃุฑุถ ุ ูููููุง ุชุชูุงุทุน ูุนูุง (ููุง ูู ููุถุญ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูููู ุงูุฃุญูุฑ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) ุ ูุชุนูู ููู ูุณุชูู ุณุทุญ ุงูุฃุฑุถ (ุงููุดุงุฑ ุฅููู </font><font style="vertical-align: inherit;">ุจุงูุฎุท </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฎุถุฑ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ูุตูุญ ุฐูู ูู ุฎูุงู ุชุญุฏูุฏ ูุตูููุฉ ุชุญููู ุซุงููุฉ ุ ูุงูุชู ุชูุทุจู ููุท ุนูู ุฑุฃุณูู ูู ุงููุงุนุฏุฉ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงููุตูููุฉ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุดููุช ุงููุตูููุฉ </font></font><code>windRotation</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>bendRotationMatrix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฐูู ุจูุถู ุงูุชู ูุชู ุฅุฑูุงู ูุงุนุฏุฉ ุนูู ุณุทุญ ุงูุนุดุจ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring float3x3 transformationMatrix. float3x3 transformationMatrixFacing = mul(tangentToLocal, facingRotationMatrix); โฆ // Modify the existing lines outputting the base vertex positions. triStream.Append(VertexOutput(pos + mul(transformationMatrixFacing, float3(width, 0, 0)), float2(0, 0))); triStream.Append(VertexOutput(pos + mul(transformationMatrixFacing, float3(-width, 0, 0)), float2(1, 0)));</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. ุงูุญูุงุก ุดูุฑุงุช ุงูุนุดุจ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูุชู ุชุญุฏูุฏ ุดูุฑุงุช ุงูุนุดุจ ุงููุฑุฏูุฉ ุจูุงุณุทุฉ ูุซูุซ ูุงุญุฏ. ุนูู ูุณุงูุงุช ูุจูุฑุฉ ุ ูุฐู ููุณุช ูุดููุฉ ุ ูููู ุจุงููุฑุจ ูู ุดูุฑุฉ ุงูุนุดุจ ุชุจุฏู ุฌุงูุฏุฉ ูููุฏุณูุฉ ููุบุงูุฉ ุ ุจุฏูุงู ูู ุงูุนุถููุฉ ูุงูุญูููุฉ. ุณูุตูุญ ุฐูู ูู ุฎูุงู ุจูุงุก ุดูุฑุงุช ูู ุงูุนุดุจ ูู ุนุฏุฉ ูุซูุซุงุช ูุซูููุง ุนูู ุทูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุญูู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุชู ุชูุณูู ูู ุดูุฑุฉ ูู ุงูุนุดุจ ุฅูู ุนุฏุฉ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุทุงุนุงุช</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุณูููู ููู ููุทุน ุดูู ูุณุชุทูู ููุชููู ูู ูุซูุซูู ุ ุจุงุณุชุซูุงุก ุงูุฌุฒุก ุงูุนููู - ุณูููู ูุซูุซูุง ูุงุญุฏูุง ูุฏู ุนูู ุทุฑู ุดูุฑุฉ ุงูุนุดุจ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุงูุขู ุ ูููุง ุจุฑุณู ุซูุงุซุฉ ุฑุคูุณ ููุท ุ ูุฎูู ูุซูุซ ูุงุญุฏ. ููู ุ ุฅุฐู ุ ุฅุฐุง ูุงู ููุงู ูุฒูุฏ ูู ุงูููู ุ ูู ูุนุฑู ุงูุชุธููู ุงูููุฏุณู ุฃู ูููุง ููุถู ููุดูู ูุซูุซุงุชุ ุงูุฌูุงุจ ูู ุจููุฉ ุงูุจูุงูุงุช</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุฑูุท ุงููุซูุซ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุชูุชู ุงูููู ุงูุซูุงุซุฉ ุงูุฃููู ูุชุดูู ูุซูุซูุง ุ ูุชุดูู ูู ููุฉ ุฌุฏูุฏุฉ ูุซูุซูุง ูุน ุงูุงุซููู ุงูุณุงุจูุชูู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/871/8ec/676/8718ec676d7efd819718bd25d5b27b54.gif"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดูุฑุฉ ูููุณูุฉ ูู ุงูุนุดุจ ุ ููุซูุฉ ูุดุฑูุท ูุซูุซ ูุฎูู ุฑุฃุณูุง ูุงุญุฏูุง ูู ูู ูุฑุฉ. ุจุนุฏ ุงูููู ุงูุซูุงุซุฉ ุงูุฃููู ุ ุชุดูู ูู ููุฉ ุฌุฏูุฏุฉ ูุซูุซูุง ุฌุฏูุฏูุง ุจู ุงูููุชุงู ุงูุณุงุจูุชุงู.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฐุง ููุณ ููุท ุฃูุซุฑ ูุนุงููุฉ ูู ุญูุซ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุ ููููู ูุณูุญ ูู ุฃูุถูุง ุจุฅูุดุงุก ุชุณูุณูุงุช ุงููุซูุซุงุช ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู ุจุณูููุฉ ูุณุฑุนุฉ. ุฅุฐุง ุฃุฑุฏูุง ุฅูุดุงุก ุนุฏุฉ ุฎุทูุท ูู ุงููุซูุซุงุช ุ ููููููุง ุงุณุชุฏุนุงุก </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">RestartStrip</font></a><font style="vertical-align: inherit;"> ููุญุตูู ุนูู </font></font><code>TriangleStream</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุธููุฉ </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุจู ุฃู ูุจุฏุฃ ูู ุฑุณู ุงููุฒูุฏ ูู ุงูููู ูู ุงูุชุธููู ุงูููุฏุณู ุ ูุญุชุงุฌ ุฅูู ุฒูุงุฏุชูุง </font><font style="vertical-align: inherit;">. ุณูุณุชุฎุฏู ุงูุชุตููู </font><font style="vertical-align: inherit;">ููุณูุงุญ ููุคูู ุงูุชุธููู ุจุงูุชุญูู ูู ุนุฏุฏ ุงููุทุงุนุงุช ูุญุณุงุจ ุนุฏุฏ ุงูุฑุคูุณ ุงููุนุฑูุถุฉ ููู.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>maxvertexcount</code><font style="vertical-align: inherit;"></font><code>#define</code><font style="vertical-align: inherit;"></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the CGINCLUDE block. #define BLADE_SEGMENTS 3 โฆ // Modify the existing line defining the maxvertexcount. [maxvertexcount(BLADE_SEGMENTS * 2 + 1)]</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุจุฏุงูุฉ ุ ูููุง ุจุชุนููู ุนุฏุฏ ุงูุฃุฌุฒุงุก ุนูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุญุฏูุซูุง </font></font><code>maxvertexcount</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุณุงุจ ุนุฏุฏ ุงูููู ุจูุงุกู ุนูู ุนุฏุฏ ุงููุทุงุนุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅูุดุงุก ุดูุฑุฉ ูุฌุฒุฃุฉ ูู ุงูุนุดุจ ุ ูุณุชุฎุฏู ุฏูุฑุฉ </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ููู ุงูุชูุฑุงุฑ ูู ุงูุญููุฉ ุฅุถุงูุฉ ุนูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชูู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณุงุฑ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุญุงูุฉ ุ ูุถูู ููุฉ ุงูุฑุฃุณ ุงูุฃุฎูุฑุฉ ุนูู ุทุฑู ุดูุฑุฉ ุงูุนุดุจ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ุงูููุงู ุจุฐูู ุ ุณูููู ูู ุงููููุฏ ููู ุฌุฒุก ูู ููุถุน ุงูุญูุณุจุฉ ูุฑุคูุณ ุดูุฑุงุช ุงูุนุดุจ ูู ุงูุดูุฑุฉ ุฅูู ุงููุธููุฉ ุ ูุฃููุง ุณูุณุชุฎุฏู ูุฐุง ุงูุฑูุฒ ุนุฏุฉ ูุฑุงุช ุฏุงุฎู ุงูุญููุฉ ูุฎุงุฑุฌูุง. ุฃุถู </font></font><code>CGINCLUDE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุงูู </font><font style="vertical-align: inherit;">ุฅูู ุงููุชูุฉ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">geometryOutput </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GenerateGrassVertex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float3 vertexPosition, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, float2 uv, float3x3 transformMatrix)</span></span></span><span class="hljs-function"> </span></span>{ float3 tangentPoint = float3(width, <span class="hljs-number"><span class="hljs-number">0</span></span>, height); float3 localPosition = vertexPosition + mul(transformMatrix, tangentPoint); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> VertexOutput(localPosition, uv); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู ูุฐู ุงููุธููุฉ ุจููุณ ุงูููุงู ูุฃููุง ุชุชุฌุงูุฒ ุงูุญุฌุฌ ุงูุชู ูุฑุฑูุง ุจูุง ุณุงุจููุง </font></font><code>VertexOutput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูููุฏ ุฑุคูุณ ุดูุฑุฉ ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ุงูุญุตูู ุนูู ุงูููุถุน ูุงูุงุฑุชูุงุน ูุงูุนุฑุถ ุ ูุฅูู ูุญูู ุจุดูู ุตุญูุญ ููุฉ ุงูุฑุฃุณ ุจุงุณุชุฎุฏุงู ุงููุตูููุฉ ุงููุฑุณูุฉ ููุนูู ูู ุชูุณูู ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ. </font><font style="vertical-align: inherit;">ุณูููู ุจุชุญุฏูุซ ุงูููุฏ ุงูููุฌูุฏ ุญุชู ุชุนูู ุงููุธููุฉ ุจุดูู ุตุญูุญ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Update the existing code outputting the vertices. triStream.Append(GenerateGrassVertex(pos, width, 0, float2(0, 0), transformationMatrixFacing)); triStream.Append(GenerateGrassVertex(pos, -width, 0, float2(1, 0), transformationMatrixFacing)); triStream.Append(GenerateGrassVertex(pos, 0, height, float2(0.5, 1), transformationMatrix));</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏุฃุช ุงููุธููุฉ ุชุนูู ุจุดูู ุตุญูุญ ุ ููุญู ุนูู ุงุณุชุนุฏุงุฏ ูููู ุฑูุฒ ุชูููุฏ ููุฉ ุงูุฑุฃุณ ุฅูู ุงูุญููุฉ </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุฃุถู ูุง </font></font><code>float width</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู </font><font style="vertical-align: inherit;">ุชุญุช ุงูุฎุท </font><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; BLADE_SEGMENTS; i++) { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = i / (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)BLADE_SEGMENTS; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนูู ุนู ุฏูุฑุฉ ุณูุชู ุชุดุบูููุง ูุฑุฉ ูุงุญุฏุฉ ููู ุดูุฑุฉ ูู ูุทุนุฉ ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ุฏุงุฎู ุงูุญููุฉ ุ ุฃุถู ูุชุบูุฑูุง </font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูููู ูุฐุง ุงููุชุบูุฑ ุจุชุฎุฒูู ูููุฉ ูู ุงููุทุงู 0 ... 1 ุ ููุง ูุดูุฑ ุฅูู ูุฏู ุชุญุฑููุง ุนูู ุทูู ุดูุฑุฉ ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูุฐู ุงููููุฉ ูุญุณุงุจ ุนุฑุถ ูุงุฑุชูุงุน ุงููุทุนุฉ ูู ูู ุชูุฑุงุฑ ููุญููุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring float t. float segmentHeight = height * t; float segmentWidth = width * (1 - t);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏ ุชุญุฑูู ุดูุฑุฉ ุงูุนุดุจ ุ ูุฒุฏุงุฏ ุงูุงุฑุชูุงุน ูููุฎูุถ โโุงูุนุฑุถ. </font><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุฅุถุงูุฉ ููุงููุงุช ุฅูู ุงูุญููุฉ </font></font><code>GenerateGrassVertex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅุถุงูุฉ ุฑุคูุณ ุฅูู ุชูุงุฑ ุงููุซูุซุงุช. </font><font style="vertical-align: inherit;">ุณูุถูู ุฃูุถูุง ููุงููุฉ ูุงุญุฏุฉ </font></font><code>GenerateGrassVertex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุงุฑุฌ ุงูุญููุฉ ูุฅูุดุงุก ุทุฑู ุดูุฑุฉ ุงูุนุดุจ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the line declaring float segmentWidth. float3x3 transformMatrix = i == 0 ? transformationMatrixFacing : transformationMatrix; triStream.Append(GenerateGrassVertex(pos, segmentWidth, segmentHeight, float2(0, t), transformMatrix)); triStream.Append(GenerateGrassVertex(pos, -segmentWidth, segmentHeight, float2(1, t), transformMatrix)); โฆ // Add just below the loop to insert the vertex at the tip of the blade. triStream.Append(GenerateGrassVertex(pos, 0, height, float2(0.5, 1), transformationMatrix)); โฆ // Remove the existing calls to triStream.Append. //triStream.Append(GenerateGrassVertex(pos, width, 0, float2(0, 0), transformationMatrixFacing)); //triStream.Append(GenerateGrassVertex(pos, -width, 0, float2(1, 0), transformationMatrixFacing)); //triStream.Append(GenerateGrassVertex(pos, 0, height, float2(0.5, 1), transformationMatrix));</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃููู ูุธุฑุฉ ุนูู ุงูุณุทุฑ ุงููุฎุตุต ููุฅุนูุงู </font></font><code>float3x3 transformMatrix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ููุง ูุฎุชุงุฑ ูุงุญุฏูุง ูู ูุตูููุงุช ุงูุชุญููู: ูุฃุฎุฐ </font></font><code>transformationMatrixFacing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑุคูุณ ุงูููู </font></font><code>transformationMatrix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ุงููุฑุงุญู ุงูุฃุฎุฑู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/02b/211/61c/02b21161cd4afc0cca35ae71ffe2570e.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุงูุขู ุชูุณูู ุดูุฑุงุช ุงูุญุดุงุฆุด ุฅูู ุนุฏุฉ ูุทุงุนุงุช ุ ููู ุณุทุญ ุงูุดูุฑุฉ ูุง ูุฒุงู ูุณุทุญูุง - ูู ุชุดุงุฑู ุงููุซูุซุงุช ุงูุฌุฏูุฏุฉ ุจุนุฏ. </font><font style="vertical-align: inherit;">ุณูู ูููู ุจุฅุถุงูุฉ ุดูุฑุฉ ูู ุงูุนุดุจ ุงูุญูุงุกุ ูุชุญููู ุงููููู ูู ููุฉ ุงูุฑุฃุณ ูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูY</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฃููุงู ุ ูุญุชุงุฌ ุฅูู ุชุนุฏูู ุงููุธููุฉ </font></font><code>GenerateGrassVertex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุชุญุตู ุนูู ุฅุฒุงุญุฉ ูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุงูุชู ุณูู ูุณูููุง </font></font><code>forward</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Update the function signature of GenerateGrassVertex. geometryOutput GenerateGrassVertex(float3 vertexPosition, float width, float height, float forward, float2 uv, float3x3 transformMatrix) โฆ // Modify the Y coordinate assignment of tangentPoint. float3 tangentPoint = float3(width, forward, height);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุณุงุจ ุฅุฒุงุญุฉ ูู ููุฉ ุ ูุฅููุง ูุณุชุจุฏู </font></font><code>pow</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููููุฉ </font><font style="vertical-align: inherit;">ูู ุงููุธููุฉ </font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุจุนุฏ ุงููุตูู </font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ุงูุณูุทุฉ ุ ุณูููู ุชุฃุซูุฑูุง ุนูู ุงูุฅุฒุงุญุฉ ุงูุฃูุงููุฉ </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุบูุฑ ุฎุทู</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุญููู ุดูุฑุฉ ุงูุนุดุจ ุฅูู ููุญูู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add as new properties. _BladeForward("Blade Forward Amount", Float) = 0.38 _BladeCurve("Blade Curvature Amount", Range(1, 4)) = 2 โฆ // Add to the CGINCLUDE block. float _BladeForward; float _BladeCurve; โฆ // Add inside the geometry shader, below the line declaring float width. float forward = rand(pos.yyz) * _BladeForward; โฆ // Add inside the loop, below the line declaring segmentWidth. float segmentForward = pow(t, _BladeCurve) * forward; โฆ // Modify the GenerateGrassVertex calls inside the loop. triStream.Append(GenerateGrassVertex(pos, segmentWidth, segmentHeight, segmentForward, float2(0, t), transformMatrix)); triStream.Append(GenerateGrassVertex(pos, -segmentWidth, segmentHeight, segmentForward, float2(1, t), transformMatrix)); โฆ // Modify the GenerateGrassVertex calls outside the loop. triStream.Append(GenerateGrassVertex(pos, 0, height, forward, float2(0.5, 1), transformationMatrix));</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ุฌุฒุก ูุจูุฑ ูู ุงูุดูุฑุฉ ุ ููู ูู ุงูุนูู ูุชู ุจุดูู ูุดุงุจู ููุง ุชู ุงูููุงู ุจู ูุนุฑุถ ูุงุฑุชูุงุน ุดูุฑุฉ ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ูุน ุงูุฎูุงุถ ุงูููู </font></font><code>_BladeForward</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>_BladeCurve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุตููุง ุนูู ูุฑูุฌ ุฌูุฏ ุงูุฅุนุฏุงุฏ ุ ูุงูููู ุงูุฃูุจุฑ ุณุชููุญ ุงูุชุฃุซูุฑ ุงููุนุงูุณ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c1f/cbc/e43/c1fcbce43fa5e1c1be319dc1f5190f3d.png"></div><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. ุงูุฅุถุงุกุฉ ูุงูุธูุงู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฎุทูุฉ ููุงุฆูุฉ ูุฅุชูุงู ุชุธููู ุฃุถููุง ุงููุฏุฑุฉ ุนูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฌุงูู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชููู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุธูุงู. </font><font style="vertical-align: inherit;">ุณูุถูู ุฃูุถูุง ุฅุถุงุกุฉ ุจุณูุทุฉ ูู ุงููุตุฏุฑ ุงูุฑุฆูุณู ููุถูุก ุงูุงุชุฌุงูู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.1 ุตุจ ุงูุธูุงู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฅููุงุก ุงูุธูุงู ูู ุงููุญุฏุฉ ุ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุชูุฑูุฑุฉ ุซุงููุฉ ุฅูู ุงูุชุธููู. ุณูุชู ุงุณุชุฎุฏุงู ูุฐุง ุงูููุทุน ูู ุฎูุงู ูุตุงุฏุฑ ุงูุฅุถุงุกุฉ ุงูุชู ุชูุดุฆ ุงูุธู ูู ุงููุดูุฏ ูุชุฌุนู ุนูู ุงูุนุดุจ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฎุฑูุทุฉ ุงูุธู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฎุงุตุฉ ุจูู </font><font style="vertical-align: inherit;">. ูุฐุง ูุนูู ุฃูู ูุฌุจ ุฅุทูุงู ุงูุชุธููู ุงูููุฏุณู ูู ููุฑ ุงูุธู ุ ุจุญูุซ ุชุชููู ุดูุฑุงุช ุงูุนุดุจ ูู ุงูุธูุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุงูุชุธููู ุงูููุฏุณู ููุชูุจ ุฏุงุฎู ุงููุชู </font></font><code>CGINCLUDE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููููููุง ุงุณุชุฎุฏุงูู ูู ุฃู ููุฑ ููููู. ูู ุจุฅูุดุงุก ุชูุฑูุฑุฉ ุซุงููุฉ ุชุณุชุฎุฏู ููุณ ุงูุชุธูููุงุช ูุซู ุงูุฃููู ุ ุจุงุณุชุซูุงุก ุงูุชุธููู ุงูุฌุฒุฆู - ุณูุญุฏุฏ ูุฑูุฑูุง ุฌุฏูุฏูุง ุณููุชุจ ููู ูุงูุฑู ูุนุงูุฌ ุงูุฅุฎุฑุงุฌ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add below the existing Pass. Pass { Tags { "LightMode" = "ShadowCaster" } CGPROGRAM #pragma vertex vert #pragma geometry geo #pragma fragment frag #pragma hull hull #pragma domain domain #pragma target 4.6 #pragma multi_compile_shadowcaster float4 frag(geometryOutput i) : SV_Target { SHADOW_CASTER_FRAGMENT(i) } ENDCG }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฅูุดุงุก ุดุธูุฉ ุดุธูุฉ ุฌุฏูุฏุฉ ุ ููุงู ุจุนุถ ุงูุงุฎุชูุงูุงุช ุงููููุฉ ูู ูุฐุง ุงูููุทุน. </font><font style="vertical-align: inherit;">ุงูุชุณููุฉ </font></font><code>LightMode</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูููุฉ </font></font><code>ShadowCaster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูููุณ </font></font><code>ForwardBase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุชููู ุงููุญุฏุฉุ ุฃู ูุฐู ุงูููุฑุฉ ููุจุบู ุฃู ุชุณุชุฎุฏู ูุชูุฏูู ุงููุงุฆู ูู ุฎุฑูุทุฉ ุงูุธู. </font><font style="vertical-align: inherit;">ููุงู ุฃูุถุง ุชูุฌูู ูุจู ุงููุนุงูุฌ ููุง </font></font><code>multi_compile_shadowcaster</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุถูู ุฃู ุงูุชุธููู ูุฌูุน ูู ุงูุฎูุงุฑุงุช ุงูุถุฑูุฑูุฉ ุงููุทููุจุฉ ูุฅููุงุก ุงูุธูุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุฌุนู ูุงุฆู ุงููุนุจุฉ </font></font><code>Fence</code> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุดุทูุง</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุดูุฏ ุ </font><font style="vertical-align: inherit;">ุญุชู ูุญุตู ุนูู ุณุทุญ ูููู ูุฑูุด ุงูุนุดุจ ุฃู ุชููู ุจุธูุงูู ุนููู.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c57/640/6cf/c576406cf284fe41e4b04d8af264d96e.png"></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.2 ุงูุญุตูู ุนูู ุงูุธูุงู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุฃู ุชููู ุงููุญุฏุฉ ุจุฅุธูุงุฑ ุฎุฑูุทุฉ ุงูุธู ูู ูุฌูุฉ ูุธุฑ ูุตุฏุฑ ุงูุถูุก ูุฅูุดุงุก ุงูุธู ุ ูุฅููุง ุชุทูู ููุฑูุง "ูุฌูุน" ุงูุธูุงู ูู ูุณูุฌ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุงุญุฉ ุงูุดุงุดุฉ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฃุฎุฐ ุนููุงุช ูู ูุฐุง ุงููููุณ ุ ุณูุญุชุงุฌ ุฅูู ุญุณุงุจ ููุงุถุน ุงูููู ูู ูุณุงุญุฉ ุงูุดุงุดุฉ ูููููุง ุฅูู ุชุธููู ุงูุฃุฌุฒุงุก.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the geometryOutput struct. unityShadowCoord4 _ShadowCoord : TEXCOORD1; โฆ // Add to the VertexOutput function, just above the return call. o._ShadowCoord = ComputeScreenPos(o.pos);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุชุธููู ุงูุฌุฒุฆู ููููุฑ ุ </font></font><code>ForwardBase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ุงุณุชุฎุฏุงู ูุงูุฑู ููุญุตูู ุนูู ูููุฉ </font></font><code>float</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุดูุฑ ุฅูู ูุง ุฅุฐุง ูุงู ุงูุณุทุญ ูู ุงูุธูุงู ุฃู ูุง. </font><font style="vertical-align: inherit;">ูุฐู ุงููููุฉ ูู ุงููุทุงู 0 ... 1 ุ ุญูุซ 0 ุนุจุงุฑุฉ ุนู ุชุธููู ูุงูู ุ 1 ูู ุฅุถุงุกุฉ ูุงููุฉ.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ูุณูู ุชูุณูู ุงูุฃุดุนุฉ ููู ุงูุจููุณุฌูุฉ ูู ูุณุงุญุฉ ุงูุดุงุดุฉ _ShadowCoordุ </font><font style="vertical-align: inherit;">ูุฐุง ูุง ูุชูุงูู ูุน ุงุตุทูุงุญุงุช ุงูุชุณููุฉ ุงูุณุงุจูุฉ.</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl">    Unity           (       ).          <code>SHADOW_ATTENUATION</code> .         <code>Autolight.cginc</code> ,  ,       . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SHADOW_ATTENUATION(a) unitySampleShadow(a._ShadowCoord)</span></span></code> </pre> <br>              -    ,            . </div></div><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the ForwardBase pass's fragment shader, replacing the existing return call. return SHADOW_ATTENUATION(i); //return lerp(_BottomColor, _TopColor, i.uv.y);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ูุญุชุงุฌ ุฅูู ุชูููู ุงูุชุธููู ุจุดูู ุตุญูุญ ูุชููู ุงูุธูุงู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุณูุถูู </font></font><code>ForwardBase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชูุฌูููุง ูุจู ุงููุนุงูุฌุฉ </font><font style="vertical-align: inherit;">ุฅูู ุงูุชูุฑูุฑุฉ </font><font style="vertical-align: inherit;">ุจุญูุซ ูุฌูุน ูู ุฎูุงุฑุงุช ุงูุชุธููู ุงููุงุฒูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the ForwardBase pass's preprocessor directives, below #pragma target 4.6. #pragma multi_compile_fwdbase</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/90a/491/468/90a491468a1ad129d35bea03b0b51898.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุชูุฑูุจ ุงููุงููุฑุง ุ ูููููุง ููุงุญุธุฉ ุงููุทุน ุงูุฃุซุฑูุฉ ุนูู ุณุทุญ ุดูุฑุงุช ุงูุนุดุจ ุ </font><font style="vertical-align: inherit;">ุฅููุง ูุงุฌูุฉ ุนู ุญูููุฉ ุฃู ุดูุฑุงุช ุงูุนุดุจ ุงููุฑุฏูุฉ ุชููู ุจุธูุงููุง ุนูู ููุณูุง. </font><font style="vertical-align: inherit;">ูููููุง ุฅุตูุงุญ ุฐูู ุนู ุทุฑูู ุชุทุจูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุจุฉ ุฎุทูุฉ</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู ุชุญุฑูู ููุงุถุน ุงูููู ูู ูุณุงุญุฉ ุงูุงูุชุทุงุน ููููุงู ุจุนูุฏูุง ุนู ุงูุดุงุดุฉ. </font><font style="vertical-align: inherit;">ุณูุณุชุฎุฏู ูุงูุฑู ุงููุญุฏุฉ ููุฐุง ูุณูุฏุฑุฌู ูู ุงูุชุตููู </font></font><code>#if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุญูุซ ูุชู ุชูููุฐ ุงูุนูููุฉ ููุท ูู ูุณุงุฑ ุงูุธู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add at the end of the VertexOutput function, just above the return call. #if UNITY_PASS_SHADOWCASTER // Applying the bias prevents artifacts from appearing on the surface. o.pos = UnityApplyLinearShadowBias(o.pos); #endif</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dca/ec0/d88/dcaec0d88eea1893b6a07eb45724a0b6.gif"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุฏ ุชุทุจูู ุฅุฒุงุญุฉ ุงูุธู ุงูุฎุทูุฉ ุ ุชุฎุชูู ุงููุทุน ุงูุฃุซุฑูุฉ ููุธูุงู ุนูู ุดูู ุฎุทูุท ูู ุณุทุญ ุงููุซูุซุงุช.</font></font></i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฐุง ุชูุฌุฏ ูุทุน ุฃุซุฑูุฉ ุนูู ุทูู ุญูุงู ุดูุฑุงุช ุงูุนุดุจ ุงููุธููุฉุ</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/08a/12e/af1/08a12eaf1af17fc9b35de7d07a64afca.png"></div><br>      (multisample anti-aliasing <strong>MSAA</strong> ) Unity <em> </em>     ,        .        ,  . <br><br>    โ  ,    ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  Unity</a> .      (     );     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    Unity</a> . </div></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.3 ุงูุฅุถุงุกุฉ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ุจุชูููุฐ ุงูุฅุถุงุกุฉ ุจุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุญุณุงุจ ุงูุฅุถุงุกุฉ ุจุณูุทุฉ ููุดุชุฑูุฉ ููุบุงูุฉ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/404/3ae/452/4043ae452046c0b4b405aa88afe8d2b7.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... ุญูุซ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุทุจูุนู ุนูู ุงูุณุทุญ ุ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงูุงุชุฌุงู ุงูุทุจูุนู ูููุตุฏุฑ ุงูุฑุฆูุณู ููุฅุถุงุกุฉ ุงูุงุชุฌุงู ุ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฃูุง</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฅุถุงุกุฉ ุงููุญุณูุจุฉ. </font><font style="vertical-align: inherit;">ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุทุจู ุฅุถุงุกุฉ ุบูุฑ ูุจุงุดุฑุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุช ุงูุญุงูู ุ ูุง ูุชู ุชุนููู ุงูุญุงูุงุช ุงูุทุจูุนูุฉ ุฅูู ุฑุคูุณ ุดูุฑุงุช ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ููุง ูู ุงูุญุงู ูุน ููุงุถุน ุงูุฐุฑูุฉ ุ ูููู ุฃููุงู ุจุญุณุงุจ ุงูููู ุงูุทุจูุนูุฉ ูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุงุญุฉ ุงูุธู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููู ุซู ุชุญููููุง ุฅูู ูุญููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏูุง ูููู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blade Curvature Amount</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุชู ุชูุฌูู ูู ุดูุฑุงุช ุงูุนุดุจ ูู ูุณุงุญุฉ ุงูุธู ูู ุงุชุฌุงู ูุงุญุฏ: ูุจุงุดุฑุฉ ููุงุจู ุงููุญูุฑ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูุฃูู ููุฑ ูุญููุง ุ ูููู ุจุญุณุงุจ ุงููุนุฏู ุงูุทุจูุนู ุ ูุน ุงูุชุฑุงุถ ุนุฏู ูุฌูุฏ ุงูุญูุงุก.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the GenerateGrassVertex function, belowing the line declaring tangentPoint. float3 tangentNormal = float3(0, -1, 0); float3 localNormal = mul(transformMatrix, tangentNormal);</span></span></code> </pre> <br> <code>tangentNormal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ุงููุนุฑููุฉ ุนูู ุฃููุง ูุจุงุดุฑุฉ ููุงุจู ุงููุญูุฑ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุต</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุชู ุชุญููููุง ุจููุณ ุงููุตูููุฉ ุงูุชู ุงุณุชุฎุฏููุงูุง ูุชุญููู ููุงุท ุงูุธู ุฅูู ูุณุงุญุฉ ูุญููุฉ. </font><font style="vertical-align: inherit;">ุงูุขู ูููููุง ููููุง ุฅูู ูุธููุฉ </font></font><code>VertexOutput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ููู ุซู ุฅูู ูููู </font></font><code>geometryOutput</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Modify the return call in GenerateGrassVertex. return VertexOutput(localPosition, uv, localNormal); โฆ // Add to the geometryOutput struct. float3 normal : NORMAL; โฆ // Modify the existing function signature. geometryOutput VertexOutput(float3 pos, float2 uv, float3 normal) โฆ // Add to the VertexOutput function to pass the normal through to the fragment shader. o.normal = UnityObjectToWorldNormal(normal);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃูู ูุจู ุงูุงุณุชูุชุงุฌ ุ ูููู ุจุชุญููู ุงูุทุจูุนู ุฅูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุถุงุก ุงูุนุงููู</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ </font><font style="vertical-align: inherit;">ุงููุญุฏุฉ ุชููู ุฅูู ุชุธููู ุงุชุฌุงู ุงููุตุฏุฑ ุงูุฑุฆูุณู ููุถูุก ุงูุงุชุฌุงู ูู ุงููุถุงุก ุงูุนุงููู ุ ูุฐูู ูุฐุง ุงูุชุญูู ุถุฑูุฑู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ูููููุง ุชุตูุฑ ุงูุญุงูุงุช ุงูุทุจูุนูุฉ ูู ุฌุฒุก ุงูุชุธููู </font></font><code>ForwardBase</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุชุญูู ูู ูุชูุฌุฉ ุนูููุง.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the ForwardBase fragment shader. float3 normal = facing &gt; 0 ? i.normal : -i.normal; return float4(normal * 0.5 + 0.5, 1); // Remove the existing return call. //return SHADOW_ATTENUATION(i);</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฐ </font></font><code>Cull</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชุนููู ูููุฉ </font><font style="vertical-align: inherit;">ูู ุชุธููููุง </font></font><code>Off</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุชู ุชูุฏูู ููุง ุงูุฌุงูุจูู ูู ุดูุฑุฉ ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ููู ูุชู ุชูุฌูู ุงููุถุน ุงูุทุจูุนู ูู ุงูุงุชุฌุงู ุงูุตุญูุญ ุ ูุณุชุฎุฏู ูุนููุฉ ูุณุงุนุฏุฉ </font></font><code>VFACE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถููุงูุง ุฅูู ุชุธููู ุงูุฃุฌุฒุงุก. </font><font style="vertical-align: inherit;">ุณุชูุฑุฌุน </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุณูุทุฉ </font></font><code>fixed facing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูููุง </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฌุจูุง</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง ุนุฑุถูุง ุงููุฌู ุงูุฃูุงูู ููุณุทุญ </font><font style="vertical-align: inherit;">ูุฑูู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุงูุจ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง ูุงู ุนูุณ ุฐูู. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ูุฐุง ูู ุงูููุฏ ุฃุนูุงู ูููุจ ุงููุถุน ุงูุทุจูุนู ุฅุฐุง ูุฒู ุงูุฃูุฑ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/e1b/8ca/965/e1b8ca965ed8e80b539a9773d1adeb0c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูุฏูุง ูููู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏุงุฑ Blade Curvature</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃูุจุฑ ูู 1 ุ ุณูุชู ุชุจุฏูู ููุถุน </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูููุงุณู </font><font style="vertical-align: inherit;">ููู </font><font style="vertical-align: inherit;">ุฑุฃุณ ูู </font><font style="vertical-align: inherit;">ุฎูุงู ุงููููุฉ ุงูุชู </font></font><code>forward</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชู ุชูุฑูุฑูุง ุฅูู ุงููุธููุฉ </font></font><code>GenerateGrassVertex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุณูู ูุณุชุฎุฏู ูุฐู ุงููููุฉ ูุชูุณูุน ูุทุงู ุงููุญูุฑ </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงูุชูุงุณุจ </font><font style="vertical-align: inherit;">.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Modify the existing line in GenerateGrassVertex. float3 tangentNormal = normalize(float3(0, -1, forward));</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุฎูุฑูุง ุ ุฃุถู ุงูููุฏ ุฅูู ุดุธูุฉ ุงููุทุนุฉ ูุชุฌูุน ุงูุธูุงู ูุงูุฅุถุงุกุฉ ุงูุงุชุฌุงููุฉ ูุงูุฅุถุงุกุฉ ุงููุญูุทุฉ. </font><font style="vertical-align: inherit;">ุฃูุตู ุจุฏุฑุงุณุฉ ูุนูููุงุช ุฃูุซุฑ ุชูุตููุงู ุญูู ุชูููุฐ ุงูุฅุถุงุกุฉ ุงููุฎุตุตุฉ ูู ุงูุชุธููู ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูููู ุนูู shaders toon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Add to the ForwardBase fragment shader, below the line declaring float3 normal. float shadow = SHADOW_ATTENUATION(i); float NdotL = saturate(saturate(dot(normal, _WorldSpaceLightPos0)) + _TranslucentGain) * shadow; float3 ambient = ShadeSH9(float4(normal, 1)); float4 lightIntensity = NdotL * _LightColor0 + float4(ambient, 1); float4 col = lerp(_BottomColor, _TopColor * lightIntensity, i.uv.y); return col; // Remove the existing return call. //return float4(normal * 0.5 + 0.5, 1);</span></span></code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/c14/894/d14/c14894d14edc336b770f4b94bedd3708.png"></div><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ ูุบุทู ุงูุนุดุจ ูุณุงุญุฉ ุตุบูุฑุฉ ูู 10x10 ูุญุฏุฉ. </font><font style="vertical-align: inherit;">ููู ูุบุทู ุงูุชุธููู ุงููุณุงุญุงุช ุงูููุชูุญุฉ ุงููุจูุฑุฉ ูุน ุงูุญูุงุธ ุนูู ุงูุฃุฏุงุก ุงูุนุงูู ุ ูุฌุจ ุชูุฏูู ุชุญุณููุงุช. </font><font style="vertical-align: inherit;">ููููู ุชุทุจูู ุงูุชุบุทูุฉ ุจุงููุณููุณุงุก ุนูู ุฃุณุงุณ ุงููุณุงูุฉ ุจุญูุซ ูุชู ุชูููู ุนุฏุฏ ุฃูู ูู ุดูุฑุงุช ุงูุนุดุจ ุจุนูุฏูุง ุนู ุงููุงููุฑุง. </font><font style="vertical-align: inherit;">ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุนูู ูุณุงูุงุช ุทูููุฉ ุ ุจุฏูุงู ูู ุดูุฑุงุช ุงูุนุดุจ ุงููุฑุฏูุฉ ุ ูููู ุฑุณู ูุฌููุนุงุช ูู ุดูุฑุงุช ุงูุนุดุจ ุจุงุณุชุฎุฏุงู ุฑุจุงุนู ุงูุฒูุงูุง ูุน ูุณูุฌ ูุชุฑุงูุจ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/5a7/a05/e86/5a7a05e8690c152f9196bb3c94fada19.png"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูุฌ ุนุดุจ ูุถูู ูู ุญุฒูุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุตูู ุงูููุญุฏุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุญุฑู Unity. </font><font style="vertical-align: inherit;">ูุชู ุฑุณู ุงูุนุฏูุฏ ูู ุดูุฑุงุช ุงูุนุดุจ ุนูู ุฑุจุงุนู ุงูุฒูุงูุง ุ ููุง ูููู ูู ุนุฏุฏ ุงููุซูุซุงุช ูู ุงููุดูุฏ. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃููุง ูุง ูุณุชุทูุน ุฃุตูุงู ุงุณุชุฎุฏุงู ุงูุชุธููู ุงูููุฏุณู ูุน ุงูุชุธููู ุงูุณุทุญู ุ ูุชุญุณูู ุฃู ุชูุณูุน ูุธููุฉ ุงูุฅุถุงุกุฉ ูุงูุชุธููู ุ ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ุงุณุชุฎุฏุงู ูููุฐุฌ ุงูุฅุถุงุกุฉ Unity ุงูููุงุณู ุ ููููู ุฏุฑุงุณุฉ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูุฏุน GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุงูุฐู ููุถุญ ุญู ุงููุดููุฉ ุนู ุทุฑูู ุงูุชุฃุฎุฑ ูู ุงูุชูุฏูู ูุงูุชุนุจุฆุฉ ุงููุฏููุฉ ูุฎุฒุงุฆู G-buffer. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุดุงุฏุฑ ุดูุฑุฉ ุงููุตุฏุฑ ูู ูุณุชูุฏุน ุฌูุซุจ</font></font></a> <br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุถุงูุฉ: ุงูุชุนุงูู </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฏูู ุงูุชุดุบูู ุงููุชุฏุงุฎู ุ ูุฏ ุชุจุฏู ุงูุชุฃุซูุฑุงุช ุงูุฑุณูููุฉ ุซุงุจุชุฉ ุฃู ูุงูุฏุฉ ููุงุนุจูู. </font><font style="vertical-align: inherit;">ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุทููู ุฌุฏูุง ุจุงููุนู ุ ูุฐูู ูู ุฃูู ุจุฅุถุงูุฉ ูุณู ุนู ุชูุงุนู ุงููุงุฆูุงุช ุงูุนุงูููุฉ ุจุงูุนุดุจ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏ ูุชุถูู ุงูุชุทุจูู ุงูุณุงุฐุฌ ููุฃุนุดุงุจ ุงูุชูุงุนููุฉ ุนูุตุฑูู: ุดูุก ูู ุนุงูู ุงููุนุจุฉ ููููู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู ุงูุจูุงูุงุช</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู ุงูุชุธููู ูุฅุฎุจุงุฑู ุนู ุฃู ุฌุฒุก ูู ุงูุนุดุจ ูุฌุฑู ุงูุชูุงุนู ูุนู ุ ูุฑูุฒ ูู ุงูุชุธููู </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูุณูุฑ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฐู ุงูุจูุงูุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุนุฑุถ ูุซุงู ุนูู ููููุฉ ุชูููุฐ ุฐูู ุจุงููุงุก </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูููู ุชูููููุง ููุนูู ูุน ุงูุนุดุจ. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฑุณู ุงูุชููุฌุงุช ูู ุงูููุงู ุงูุฐู ุชูุฌุฏ ููู ุงูุดุฎุตูุฉ ุ ููููู ุชุญููู ุดูุฑุฉ ุงูุนุดุจ ููุญุงูุงุฉ ุชุฃุซูุฑุงุช ุงูุฎุทูุงุช.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar458060/">https://habr.com/ru/post/ar458060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar458046/index.html">ูุฑูุฉ ุงูุบุด ุงูุฏุฑุฌ</a></li>
<li><a href="../ar458048/index.html">ุชูููุถ ูุฃุฏุงุฉ ูุฏูุฑ</a></li>
<li><a href="../ar458050/index.html">ููู ูุงู ููุจููุณ 2019 ุจูุชุฑ (ูููููุง ุนู ููุจููุณ ุงูููุจู)</a></li>
<li><a href="../ar458052/index.html">AMA ูุน ูุจุฑ 10. ุงูุนุฏุฏ ุงูุฃุฎูุฑ *</a></li>
<li><a href="../ar458056/index.html">ุงูููุงุจูุฉ ุงููุจูุฑุฉ ูุน ูุงุฑุชู ูููุจูุงู: "ูุนุฑูุฉ ูุณุชูุจู ุฃูุธูุฉ ุงูุจูุงูุงุช ุงูููุฒุนุฉ"</a></li>
<li><a href="../ar458062/index.html">ุจุฑูุงูุฌ UserGate Platform</a></li>
<li><a href="../ar458064/index.html">PVS-Studio in the Clouds - ุชุดุบูู ุงูุชุญููู ุนูู Travis CI</a></li>
<li><a href="../ar458068/index.html">PVS- ุณุชูุฏูู ูุจุฑูุงูุฌ Visual Studio</a></li>
<li><a href="../ar458070/index.html">PVS- ุณุชูุฏูู ูุจุฑูุงูุฌ Visual Studio</a></li>
<li><a href="../ar458072/index.html">ูุฐูุจ ุจุฑูุงูุฌ PVS-Studio ุฅูู ุงูุณุญุจ - ุชุญููู ุงูุฅุทูุงู ุนูู Travis CI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>