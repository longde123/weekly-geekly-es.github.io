<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵 🎡 👩🏼‍🤝‍👨🏻 Pengembangan chatbot (laravel + botman) 🤵🏿 ⛸️ 🌷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selamat datang! Saya, sebagai pengembang tumpukan penuh junior, menemui banyak masalah ketika mencoba menulis bot menggunakan laravel dan botman. Pert...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengembangan chatbot (laravel + botman)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456240/"><p>  Selamat datang!  Saya, sebagai pengembang tumpukan penuh junior, menemui banyak masalah ketika mencoba menulis bot menggunakan laravel dan botman.  Pertama, saya tidak tahu banyak bahasa Inggris, tetapi ada sangat sedikit artikel tentang hal ini dalam bahasa Rusia, dan mereka yang tidak membantu saya memecahkan masalah saya.  Artikel ini akan memberi tahu dan menunjukkan cara mengembangkan chatbot di laravel + botman untuk telegram.  Saya sendiri mengembangkan bot (komersial) untuk viber dan telegram.  Sebagai pengembang telegram, saya paling suka. </p><br><p><img src="https://habrastorage.org/webt/lt/zr/fm/ltzrfmykbxry39tsl6ni82onor8.png" alt="gambar"></p><br><p> Saya tidak akan menunjukkan cara menginstal laravel dan mengkonfigurasi server agar berfungsi.  Jika Anda belum pernah melakukan ini, maka akan lebih mudah untuk menginstal openserver, komposer (manajer paket untuk php) dibangun ke dalamnya dan server lokal untuk laravel sudah dikonfigurasi.  Anda hanya perlu menulis beberapa kode dalam .htaccess.  Itulah tepatnya yang saya kerjakan di rumah.  Dalam artikel ini saya akan menunjukkan salah satu cara untuk mengembangkan bot obrolan, mengkonfigurasi bot untuk bekerja di telegram, dan juga, pada akhirnya, saya akan meninggalkan tautan ke artikel yang bermanfaat tentang laravel'e dan botman'e. </p><br><h2>  Desain / Persiapan </h2><br><p>  Saya mengusulkan pengembangan bot, seperti semua pengembang normal, dengan mendesain, menetapkan tugas, dan menjelaskan cara kerja laravel.  Sebelum itu saya akan mengatakan bahwa saya menulis kode di phpStrom.  Anda dapat menulis di IDE lain, tetapi saya menggunakannya. </p><br><p>  Laravel mengimplementasikan pola MVC (Model View Controller).  Ini tidak berarti bahwa Anda hanya perlu menulis di bawah MVC, Anda dapat menulis apa pun, tetapi lebih baik menggunakan kelebihan yang disediakan kerangka kerja.  Jika Anda terbiasa dengan MVC, tetapi belum menggunakannya seperti saya, maka pengembangan dengan laravel adalah cara terbaik untuk mengkonsolidasikan pengetahuan. </p><a name="habracut"></a><br><h3>  Apa yang harus dilakukan bot kami: </h3><br><ul><li>  Minta nama pengguna untuk pengguna </li><li>  Tanyakan apakah pengguna menyukai cuaca atau tidak. </li><li>  Juga tuliskan jawabannya di database </li><li>  Ucapkan selamat tinggal dan kirim gambar </li></ul><br><p>  Sedikit tentang MVC.  Saat mengakses perangkat lunak kami, melalui perintah (url URL), kami harus menerima perintah dan proses ini, memahami apa yang dibutuhkan pengguna.  Ada rute untuk ini, yang disebut rute.  Rute menentukan Pengontrol mana yang harus digunakan, pada gilirannya pengontrol, jika perlu, mengakses database melalui model.  Model menghubungi basis data dan mengembalikan hasil yang kita butuhkan.  Di bot, tampilan tidak diperlukan, karena  semua pekerjaan melewati antarmuka messenger.  Jadi, setelah menerima data dari model, pengontrol memberikan data tampilan ini, dalam kasus kami ini adalah templat blade (digunakan oleh laravel).  Data dapat dikirim ke halaman php biasa, tetapi lebih baik melakukannya melalui templat blade.  Kami menggunakan antarmuka messenger, maka kami akan segera mengirim data ke sana. </p><br><h2>  Pengembangan </h2><br><p>  Untuk membuat proyek, cukup masukkan perintah berikut ke konsol </p><br><p><code>composer create-project --prefer-dist botman/studio botelegram</code> </p> <br><p>  Titik masuk akan menjadi "/ mulai".  Ada beberapa implementasi rute di botman.  Karena  kita akan mengakses rute melalui bot di telegram, maka kita perlu "botman.php". </p><br><p><img src="https://habrastorage.org/webt/hs/mw/tj/hsmwtj9-twdd9ktlk6ve5py4iwq.png" alt="gambar"></p><br><p>  Di dalamnya kita perlu menulis baris berikutnya </p><br><pre> <code class="php hljs">$botman-&gt;hears(<span class="hljs-string"><span class="hljs-string">'/start'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $bot )</span></span></span><span class="hljs-function"> </span></span>{ $bot-&gt;startConversation ( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> mainConversation ); } );</code> </pre> <br><p>  Telegram itu sendiri menawarkan untuk mulai bekerja dengan bot melalui perintah "mulai", dan jika demikian, kita dapat memfasilitasi interaksi dengan bot dengan menetapkan titik masuk awal sebagai "/ mulai" dan segera mulai bekerja dengannya. </p><br><p>  Menggunakan $ bot-&gt; startConversation (mainConversation baru);  kami menunjukkan controller mana yang akan bertanggung jawab atas pekerjaan tersebut.  Selain itu, kami akan mendaftarkan penggunaan controller kami, untuk ini kami perlu menambahkan kode ini di file path: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Conversations</span></span>\<span class="hljs-title"><span class="hljs-title">mainConversation</span></span>;</code> </pre> <br><p>  Mari kita lanjutkan.  Kita perlu membuat database dan pengontrolnya sendiri.  Maksud saya Anda menggunakan openserver.  Basis data dapat dibuat melalui konsol atau menggunakan phpMyAdmin, yang dibangun ke dalam openserver. </p><br><p>  Sekarang beberapa konfigurasi.  Kita perlu memasukkan data database ke file konfigurasi laravel.  Itu terletak di direktori root proyek dan disebut .env </p><br><p><img src="https://habrastorage.org/webt/ya/j9/al/yaj9algdv_3ugct8rqt-ua2fy1a.png" alt="gambar"></p><br><p>  Temukan garis yang terkait dengan database </p><br><pre> <code class="plaintext hljs">DB_CONNECTION=mysql DB_HOST=127.0.0.1 DB_PORT=3306 DB_DATABASE=botelegram DB_USERNAME=root DB_PASSWORD=</code> </pre> <br><p>  Di sini kami hanya tertarik pada nama basis data, nama pengguna dan kata sandi.  Jika Anda menggunakan openserver, Anda dapat menulis dengan nama root, dan membiarkan kata sandi kosong, nama basis data tergantung pada Anda. </p><br><p>  Sekarang aplikasi kita memiliki akses ke database.  Hal selanjutnya yang perlu kita lakukan adalah membuat model dan migrasi.  Kami menulis di konsol: </p><br><p> <code>php artisan make:model messengerUser -m</code> </p> <br><p>  Bendera -m akan membuat migrasi untuk database dan mengaitkannya dengan model kami.  Mari siapkan migrasi kami segera agar tidak kembali lagi. </p><br><p>  Lebih baik tidak melakukan ini, tetapi agar tidak membuat banyak file, kami menulis semua data dalam satu tabel. <br>  Kami membutuhkan: </p><br><ul><li>  id obrolan </li><li>  Nama pengguna </li><li>  Cuaca bagus atau tidak </li></ul><br><p>  Ini cukup untuk menunjukkan kemampuan dasar botman.  Buka migrasi yang baru dibuat, yang terletak di basis data / migrasi / creation_create_messanger_users_table.php </p><br><p><img src="https://habrastorage.org/webt/dz/kq/sv/dzkqsvxyblhrqhm62erj_cd2xao.png" alt="gambar"></p><br><p>  Selesaikan metode dalam migrasi ini, seharusnya terlihat seperti ini: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Schema::create(<span class="hljs-string"><span class="hljs-string">'messenger_users'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Blueprint $table)</span></span></span><span class="hljs-function"> </span></span>{ $table-&gt;increments(<span class="hljs-string"><span class="hljs-string">'id'</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">"id_chat"</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">"name"</span></span>); $table-&gt;string(<span class="hljs-string"><span class="hljs-string">'response'</span></span>); $table-&gt;timestamps(); }); }</code> </pre> <br><p>  Sekarang kita perlu memulai migrasi agar tabel kita ada di database.  Di konsol Anda harus mendaftar: </p><br><p> <code>php artisan migrate</code> </p> <br><p>  Petunjuk: jika selama proses pengembangan Anda perlu mengubah bidang dalam tabel, tetapi ada data dalam tabel, dan jika Anda tidak membutuhkannya, maka Anda dapat memperbarui tabel menggunakan <code>php artisan migrate:refresh</code> command. </p><br><p>  Hasil: </p><br><p><img src="https://habrastorage.org/webt/2k/wy/5e/2kwy5ennah0pz8us1oyljum6ftw.png" alt="gambar"></p><br><p>  laravel melakukan 3 migrasi, tetapi kami hanya tertarik pada migrasi ke-3 sejak itu  Di sinilah kami akan merekam data kami. </p><br><p>  Saatnya membuat controller, hubungkan model kita ke sana dan tulis logikanya. </p><br><p>  Secara umum, lebih baik membuat semua file melalui konsol, tetapi karena kami menggunakan botman, dan saya sudah terbiasa, kami akan membuat pengontrol secara manual.  Dalam botman, pengontrol disebut percakapan, mungkin ada perbedaan yang signifikan di antara mereka, tetapi saya tidak mengerti ini - tidak perlu.  Di folder aplikasi / Percakapan, buat file bernama mainConversation.php. </p><br><p>  Di layar Anda melihat konfigurasi percakapan yang minimal </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">Conversations</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Conversations</span></span>\<span class="hljs-title"><span class="hljs-title">Conversation</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mainConversation</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br><p>  Kelas Anda harus memiliki metode menjalankan publik, itu adalah titik masuk untuk controller. </p><br><p>  Hubungkan model kami ke controller: </p><br><p> <code>use app\messengerUser;</code> <br>  Mari kita menulis logika awal.  Metode jalankan akan menjalankan metode pribadi yang menanyakan nama pengguna, menulis id dan namanya ke id_chat dan nama tabel kami. </p><br><p>  Untuk memulai, tulis: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>\<span class="hljs-title"><span class="hljs-title">messengerUser</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">database</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Attachments</span></span>\<span class="hljs-title"><span class="hljs-title">Image</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Conversations</span></span>\<span class="hljs-title"><span class="hljs-title">Conversation</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Incoming</span></span>\<span class="hljs-title"><span class="hljs-title">Answer</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">BotManAnswer</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Outgoing</span></span>\<span class="hljs-title"><span class="hljs-title">Actions</span></span>\<span class="hljs-title"><span class="hljs-title">Button</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Outgoing</span></span>\<span class="hljs-title"><span class="hljs-title">OutgoingMessage</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">BotMan</span></span>\<span class="hljs-title"><span class="hljs-title">Messages</span></span>\<span class="hljs-title"><span class="hljs-title">Outgoing</span></span>\<span class="hljs-title"><span class="hljs-title">Question</span></span> <span class="hljs-title"><span class="hljs-title">as</span></span> <span class="hljs-title"><span class="hljs-title">BotManQuestion</span></span>;</code> </pre> <br><p>  yang akan memungkinkan kami untuk menggunakan metode botman </p><br><p>  Dan sekarang kita akan membuat perubahan pada controller kita: </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mainConversation</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $response = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;setName(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $question = BotManQuestion::create(<span class="hljs-string"><span class="hljs-string">"!   ?"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ask( $question, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( BotManAnswer $answer )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $answer-&gt;getText () != <span class="hljs-string"><span class="hljs-string">''</span></span> ){ array_push (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response, $answer-&gt;getText()); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;askWeather (); } }); } }</code> </pre> <br><p>  jalankan () mulai metode yang kita butuhkan, itu adalah setName ().  Sudah di setName () kami meminta nama pengguna, menulis nama ke array, kemudian menjalankan metode berikutnya, yang akan menanyakan pengguna tentang cuaca. </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">askWeather</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $question = BotManQuestion::create(<span class="hljs-string"><span class="hljs-string">"    ?"</span></span>); $question-&gt;addButtons( [ Button::create(<span class="hljs-string"><span class="hljs-string">''</span></span>)-&gt;value(<span class="hljs-number"><span class="hljs-number">1</span></span>), Button::create(<span class="hljs-string"><span class="hljs-string">''</span></span>)-&gt;value(<span class="hljs-number"><span class="hljs-number">2</span></span>) ]); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ask($question, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BotManAnswer $answer)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      ,       array_push ($this-&gt;response, $answer); $this-&gt;exit(); }); }</span></span></code> </pre> <br><p>  askWeather () memiliki struktur yang serupa, tetapi di sini kami menggunakan tombol untuk membatasi pilihan pengguna dan membuat hidup kami lebih mudah.  Tombol menghapus banyak kesalahan yang bisa dibuat pengguna.  Di sini kami juga membuat pertanyaan, dengan bantuan addButtons () kami melampirkan tombol pada pertanyaan, dan kemudian kami memanggil pertanyaan ini dan memproses jawabannya, dan juga pergi ke metode terakhir. </p><br><p>  Metode exit () akan menulis semua data ke database (dapat diambil dalam metode terpisah), mengucapkan selamat tinggal kepada pengguna, dan juga mengirimnya gambar. </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> database(); $db-&gt;id_chat = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;bot-&gt;getUser()-&gt;getId(); $db-&gt;name = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $db-&gt;response = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;response[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $db-&gt;save(); $attachment = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(<span class="hljs-string"><span class="hljs-string">'https://gykov.ru/projects/botelegram.png'</span></span>); $message = OutgoingMessage::create(<span class="hljs-string"><span class="hljs-string">'  !'</span></span>) -&gt;withAttachment($attachment); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;bot-&gt;reply($message); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre><br><p>  Menggunakan OutgoingMessage :: create ('See you again!') -&gt; withAttachment ($ attachment), kami membuat pesan baru dan melampirkan gambar padanya.  Secara umum, semua file publik yang harus dilihat pengguna ditempatkan di folder publik, tetapi di bot terakhir saya ada masalah dengan ini dan saya harus meletakkannya di folder terpisah di server (tidak terkait dengan proyek).  Di sini saya melakukan hal yang sama. </p><br><p>  Logika bot kami sudah siap.  Untuk mengujinya, cukup buka situs melalui openserver, tetapi sebelum itu, Anda perlu membuat file .htiaccess dengan konten berikut </p><br><pre> <code class="plaintext hljs">&lt;IfModule mod_rewrite.c&gt; RewriteEngine On RewriteRule ^(.*)$ public/$1 [L] &lt;/IfModule&gt;</code> </pre> <br><p>  File tersebut harus di root situs.  Sekarang semua permintaan akan ditransfer ke folder publik.  Beginilah cara laravel bekerja.  Kami membuka situs dan menguji bot, jangan lupa bahwa pertama Anda harus memasukkan "/ mulai". </p><br><p>  Setelah memastikan bahwa semuanya berfungsi, Anda dapat melampirkannya ke telegram.  Untuk melakukan ini, buat bot baru di @botfather, salin kunci bot ke akhir file .env.  Ini terlihat seperti ini: </p><br><p> <code>TELEGRAM_KEY=key_bot</code> </p> <br><p>  Sekarang kita perlu memasukkan driver untuk proyek gabungan dari logika dan bot telegram kita.  Ini dilakukan hanya dengan satu perintah di konsol: </p><br><p> <code>composer require botman/driver-telegram</code> </p> <br><p>  Anda juga harus mendaftarkan bot di laravel. </p><br><p> <code>php artisan botman:telegram:register</code> </p> <br><p>  Kami akan diminta untuk memasukkan alamat di mana bot kami akan tersedia. </p><br><p><img src="https://habrastorage.org/webt/7t/pg/uv/7tpguvu21qjnqlotwj3nbkmy6c8.png" alt="gambar"></p><br><p>  Jika Anda mengembangkan bot di server, maka tambahkan saja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https: // url_site / botman</a> setelah bot ini, Anda dapat mengujinya di messenger itu sendiri.  Tetapi berhati-hatilah, laravel membutuhkan pengaturan server khusus, dan kemungkinan besar Anda harus mengonfigurasinya sendiri.  Saya akan meninggalkan tautan tentang cara mengkonfigurasi server di akhir artikel. </p><br><p>  Mungkin itu saja.  Jika Anda membaca sampai akhir, maka selamat, sekarang Anda dapat mengembangkan bot obrolan untuk laravel menggunakan botman.  Jika Anda memiliki pertanyaan, dengan senang hati saya akan menjawab di komentar, serta tautan yang dijanjikan: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sumber di github</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dokumentasi botman</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengaturan server</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artikel yang saya buat bot pertama saya</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">En artikel tentang botman</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id456240/">https://habr.com/ru/post/id456240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id456230/index.html">Iobroker mencari petualangan di game realitas</a></li>
<li><a href="../id456232/index.html">Panduan: Memperbarui Antarmuka dengan Anggota Default di C # 8.0</a></li>
<li><a href="../id456234/index.html">Mengapa Cisco tidak membeli Splunk atau berbicara tentang cara kerja platform Cisco untuk berburu ancaman</a></li>
<li><a href="../id456236/index.html">Peter - Insider Dev Tour: Konferensi Orang Dalam untuk Pengembang dari Microsoft</a></li>
<li><a href="../id456238/index.html">Tutorial: Perbarui antarmuka dengan anggota antarmuka default di C # 8.0</a></li>
<li><a href="../id456242/index.html">Sedikit lagi tentang multitasking dalam mikrokontroler</a></li>
<li><a href="../id456246/index.html">Elemen nol</a></li>
<li><a href="../id456248/index.html">Bagaimana saya menangkap: sebelum gaya untuk elemen fokus</a></li>
<li><a href="../id456250/index.html">Lokalisasi aplikasi dan dukungan RTL. Laporkan Yandex.Taxi</a></li>
<li><a href="../id456256/index.html">Panduan Arsitektur Aplikasi Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>