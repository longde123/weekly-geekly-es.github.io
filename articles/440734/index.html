<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßù üôÜüèº üå•Ô∏è Sesi√≥n abierta a la vista en Spring Boot: The Phantom Menace üëÅ‚Äçüó® üë∞üèº ü§≥üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Todos aqu√≠ tienen raz√≥n, cada uno a su manera y, por lo tanto, todos aqu√≠ est√°n equivocados. 
 "El cuento de los tres" (A. y B. Strugatsky) 

 Si usa ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sesi√≥n abierta a la vista en Spring Boot: The Phantom Menace</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440734/"><blockquote> Todos aqu√≠ tienen raz√≥n, cada uno a su manera y, por lo tanto, todos aqu√≠ est√°n equivocados. <br>  <strong>"El cuento de los tres" (A. y B. Strugatsky)</strong> </blockquote><p>  Si usa Spring Data JPA, luego de actualizar a Spring Boot 2, cuando inicie la aplicaci√≥n, puede notar una nueva advertencia en el registro: </p><br><blockquote>  spring.jpa.open-in-view est√° habilitado de forma predeterminada.  Por lo tanto, las consultas de la base de datos se pueden realizar durante la representaci√≥n de la vista.  Configure expl√≠citamente spring.jpa.open-in-view para deshabilitar esta advertencia. </blockquote><p>  En este art√≠culo intentar√© explicar qu√© significa, qui√©n tiene la culpa y qu√© hacer. </p><br><p> Para generar una aplicaci√≥n completa en Spring Boot, solo se <code>@SpringBootApplication</code> una anotaci√≥n <code>@SpringBootApplication</code> .  Para hacer esto posible, el marco utiliza una gran cantidad de configuraciones autom√°ticas y configuraciones predeterminadas.  Adem√°s, para trabajar fuera de la caja, los desarrolladores de Spring Boot tuvieron que elegir algunos conceptos de desarrollo de aplicaciones entre varias opciones alternativas para cada uno, de modo que el usuario no necesitara seleccionarlos expl√≠citamente.  Por un lado, esto es bueno para un inicio r√°pido y un desarrollo f√°cil, pero por otro lado, despu√©s de un tiempo puede resultar que alg√∫n concepto / paradigma / configuraci√≥n predeterminado no sea adecuado para el proyecto, y se tendr√° que hacer mucho trabajo para abandonarlo.  Uno de estos conceptos es el modo <strong>Open Session In View (OSIV)</strong> , que se incluye por defecto en Spring Boot. </p><a name="habracut"></a><br><p>  En este modo, la sesi√≥n de Hibernate se mantiene abierta todo el tiempo que se procesa la solicitud HTTP, incluida la etapa de creaci√≥n de la Vista (recurso JSON o p√°gina HTML).  Esto hace posible cargar datos de forma perezosa en la capa de presentaci√≥n despu√©s de confirmar una transacci√≥n en la capa de l√≥gica de negocios.  Por ejemplo, solicitamos la entidad <code>Article</code> de la base de datos.  El art√≠culo debe mostrarse junto con los comentarios.  OSIV le permite simplemente llamar al m√©todo de entidad <code>getComments()</code> al representar HTML, y los comentarios se cargar√°n en una solicitud por separado.  Cuando el modo OSIV est√° desactivado, obtendremos una <code>LazyInitializationException</code> , porque la sesi√≥n ya est√° cerrada y la entidad del <code>Article</code> ya no es administrada por Hibernate.  La mayor√≠a de los desarrolladores de Hibernate han encontrado una <code>LazyInitializationException</code> ;  OSIV le permite evitarlo cargando datos seg√∫n sea necesario en cualquier etapa del procesamiento de la solicitud HTTP. </p><br><p>  OSIV en Spring Boot se implementa utilizando la <code>OpenEntityManagerInViewInterceptor</code> solicitud web <code>OpenEntityManagerInViewInterceptor</code> .  A diferencia de Spring puro, aqu√≠ est√° habilitado por defecto. </p><br><p>  OSIV se considera antipatr√≥n.  Lo mejor de todo, el lado perjudicial de su art√≠culo fue explicado por Vlad Mihalcea, uno de los desarrolladores de Hibernate: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">The Open Session In View Anti-Pattern</a> .  Puntos clave: </p><br><ul><li>  Las consultas de bases de datos sin una transacci√≥n funcionan en modo de confirmaci√≥n autom√°tica, carg√°ndolas en gran medida. </li><li>  No hay separaci√≥n de responsabilidades, cualquier capa de aplicaci√≥n puede generar consultas SQL, lo que dificulta las pruebas. </li><li>  Hay un problema n + 1 cuando cada colecci√≥n relacionada con una entidad se carga en una solicitud separada. </li><li>  Las conexiones largas a la base de datos nuevamente aumentan la carga y reducen el rendimiento. </li></ul><br><p>  Estos son problemas bastante desagradables del modo OSIV y, al parecer, fuertes argumentos para no usarlo.  Sin embargo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en una solicitud para deshabilitarlo de manera predeterminada</a> , los desarrolladores de Spring Boot tambi√©n presentaron buenas razones por las cuales OSIV deber√≠a habilitarse para nuevos proyectos: </p><br><ul><li>  Compatibilidad con versiones anteriores.  Las aplicaciones existentes al actualizar a Spring Boot 2 pueden encontrar errores y errores debido a OSIV deshabilitado.  Para evitar esto, solo necesita establecer el valor √∫nico <code>spring.jpa.open-in-view</code> , pero esto tambi√©n dificulta el cambio a la nueva versi√≥n. </li><li>  La facilidad de uso para principiantes y un inicio r√°pido son importantes para Spring Boot.  Si OSIV est√° desactivado, puede que no est√© claro para los principiantes por qu√© algo tan intuitivamente esperado como recibir una colecci√≥n de elementos relacionados al acceder a un m√©todo de entidad no funciona.  En cambio, el usuario recibir√° una <code>LazyInitializationException</code> , esto ralentizar√° su camino hacia una aplicaci√≥n en ejecuci√≥n. </li><li>  OSIV le permite aumentar la simplicidad del c√≥digo, la usabilidad y la velocidad de desarrollo. </li><li>  Es dif√≠cil encontrar ejemplos simples de c√≥mo se debe construir una aplicaci√≥n sin OSIV. </li><li>  Sin OSIV, la capa de l√≥gica de negocios necesita saber c√≥mo se presentar√°n los datos en la interfaz de usuario, es decir, qu√© DTO necesitar√° o qu√© datos relacionados deben cargarse junto con la entidad ra√≠z.  Esto es nuevamente la ausencia de una divisi√≥n de responsabilidad. </li></ul><br><p>  Entonces, podemos distinguir dos puntos de vista sobre este problema.  Desde el punto de vista del arquitecto de la base de datos (DBA), Open Session In View es ciertamente inaceptable, ya que la interacci√≥n de la aplicaci√≥n con la base de datos no est√° organizada de manera √≥ptima y crea una mayor carga.  Pero a menudo utilizamos soluciones menos √≥ptimas para la velocidad, la facilidad de desarrollo y la facilidad de herramientas de aprendizaje: escribimos en lenguajes administrados, usamos formatos de datos de texto para la interacci√≥n de la red, etc.  Desde la posici√≥n de un desarrollador de framework, para simplificar el desarrollo y el inicio r√°pido de los principiantes, OSIV le permite reducir la carga cognitiva, la cantidad de conceptos necesarios para comenzar a desarrollar la aplicaci√≥n.  Si el desarrollador eligi√≥ JPA, ya estuvo de acuerdo con una cierta degradaci√≥n del rendimiento a cambio de la conveniencia del desarrollo.  JPA ayuda a hacer amigos los objetos y los modelos de datos relacionales.  Cuando trabajamos en el estilo de objeto para obtener elementos relacionados, simplemente recurrimos al m√©todo de entidad (incluso si est√° en la capa de presentaci√≥n), es simple, l√≥gico e intuitivamente esperado, aunque esta simplicidad es enga√±osa. </p><br><p>  Hay muchos ejemplos y tutoriales para trabajar en la sesi√≥n abierta. En el modo Ver, la arquitectura en su conjunto es clara: la capa de servicio solicita una entidad JPA, la capa de presentaci√≥n la serializa directamente en JSON, a trav√©s de un DTO intermedio, o utiliza los datos de esta para representar una p√°gina HTML. </p><br><p>  Menos claro es c√≥mo trabajar sin OSIV.  Uno de los desarrolladores de Spring en la solicitud mencionada se queja de esto, dicen muchos gritos sobre el antipatr√≥n, pero no hay ejemplos simples de c√≥mo vivir sin √©l.  En esta realizaci√≥n, las entidades se pueden usar solo para escribir y para leer, varios DTO, separados para cada conjunto de datos en la interfaz de usuario, que se asignan directamente desde la base de datos.  O consultas SQL personalizadas que describen la uni√≥n de las colecciones relacionadas necesarias para una consulta web en particular.  Es decir, m√°s repetitivo y una descripci√≥n de las necesidades de la interfaz de usuario en la capa de l√≥gica de negocios.  Con OSIV deshabilitado, la abstracci√≥n JPA comienza a fluir, la aplicaci√≥n describe m√°s detalles t√©cnicos de la interacci√≥n con la base de datos. </p><br><p>  Por lo tanto, el desarrollo con OSIV es m√°s simple.  Pero el problema es que si en el futuro desea abandonarlo, tendr√° que rehacer mucho, el concepto de trabajar con la base de datos en el proyecto estableciendo una propiedad no se puede cambiar.  Es posible que deba rehacer toda la arquitectura de la aplicaci√≥n.  Sin embargo, abandonar OSIV puede ser una optimizaci√≥n prematura, que ralentizar√° la velocidad de desarrollo, que puede ser cr√≠tica para un inicio, por ejemplo.  Puede usar OSIV y optimizar las consultas de la base de datos solo en los lugares m√°s lentos.  Por ejemplo, las colecciones de entidades que consultan son las que m√°s sufren el problema n + 1, cuando cada entidad extrae varias consultas de colecciones relacionadas. </p><br><p>  Entonces, si quieres hacerlo bien, debes desarrollar sin OSIV.  Pero si la velocidad de desarrollo y la simplicidad del c√≥digo son importantes, puede usar este modo, resignado a alguna p√©rdida de rendimiento. </p><br><p>  Lo principal es que este problema de rendimiento no se convierte en una gran deuda t√©cnica despu√©s de unos a√±os.  Es doblemente peligroso cuando los desarrolladores no sospechan que esta deuda se est√° acumulando en ellos, porque Spring Boot silenciosamente eligi√≥ el concepto de Open Session In View para ellos.  Por lo tanto, es excelente que, como resultado de la solicitud mencionada anteriormente, se haya decidido mostrar en el registro una advertencia sobre el modo utilizado, que cit√© al comienzo del art√≠culo. </p><br><p>  Espero que la advertencia y este art√≠culo sobre √©l ayuden a los desarrolladores a tomar una decisi√≥n m√°s informada: usar el concepto de Open Session In View en una aplicaci√≥n en Spring Boot.  He citado y discutido los principales argumentos a favor y en contra, y tambi√©n aconsejo leer la discusi√≥n original.  Este problema muestra que una gran cantidad de configuraciones autom√°ticas y valores predeterminados en Spring / Spring Boot pueden ser peligrosos para los desarrolladores desatentos. </p><br><p>  ¬øUtiliza OSIV en las aplicaciones Spring Boot?  Si no, ¬øc√≥mo est√° organizada la arquitectura para la interacci√≥n de la capa de presentaci√≥n con la base de datos?  ¬øQu√© t√©cnicas y / o bibliotecas se utilizan para esto? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/440734/">https://habr.com/ru/post/440734/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../440722/index.html">Una peque√±a pr√°ctica de programaci√≥n funcional en Swift para principiantes</a></li>
<li><a href="../440724/index.html">Selecci√≥n: 4 servicios √∫tiles para potenciales inmigrantes a los EE. UU., Europa y otros pa√≠ses</a></li>
<li><a href="../440726/index.html">El juego de los arquetipos: c√≥mo funciona la narraci√≥n de historias para marcas tecnol√≥gicas</a></li>
<li><a href="../440728/index.html">Desarrollo m√≥vil: de la idea a la estimaci√≥n de costos</a></li>
<li><a href="../440732/index.html">Actualice una placa de depuraci√≥n con un procesador Baikal-T1: agregue una tarjeta SD</a></li>
<li><a href="../440736/index.html">Arruino la vida de los desarrolladores con mis revisiones de c√≥digo y lo siento</a></li>
<li><a href="../440740/index.html">Seminario web abierto "Viaje del cliente: qu√© tr√°fico y hacia d√≥nde conducir"</a></li>
<li><a href="../440742/index.html">P√°ginas AMP y Turbo: Pros, contras y resultados de implementaci√≥n</a></li>
<li><a href="../440744/index.html">PHP para principiantes. Manejo de errores</a></li>
<li><a href="../440746/index.html">Ciclos tecnol√≥gicos de gesti√≥n del conocimiento de Gartner utilizando estudios de casos en KnowledgeConf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>