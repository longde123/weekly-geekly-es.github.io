<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíµ üå•Ô∏è üßëüèª Pervers√µes curiosas do mundo da TI - 4 üéÅ üàπ üì≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O site Daily WTF coleciona hist√≥rias engra√ßadas, selvagens e / ou tristes do mundo da TI h√° 15 anos. Traduzi v√°rias hist√≥rias que me pareciam interess...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pervers√µes curiosas do mundo da TI - 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446714/"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="imagem"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O</a> site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Daily WTF</a> coleciona hist√≥rias engra√ßadas, selvagens e / ou tristes do mundo da TI h√° 15 anos.  Traduzi v√°rias hist√≥rias que me pareciam interessantes.  Todos os nomes e nomes de empresas foram alterados.  Edi√ß√µes anteriores podem ser encontradas sob o r√≥tulo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pervers√µes curiosas</a> ". <br><br><h2>  A primeira hist√≥ria.  Fim <s>do</s> m√™s </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[Original]</a> <br><br>  Se voc√™ perguntar a um engenheiro de projeto se √© seguro atravessar uma ponte, ele ficar√° feliz em lhe dizer qu√£o confi√°veis ‚Äã‚Äãs√£o as pontes, como a matem√°tica funciona nelas, at√© onde chegamos em quest√µes de seguran√ßa da constru√ß√£o.  Depois de conversar com ele, voc√™ ter√° a impress√£o de que nem uma √∫nica ponte na Terra se desintegrar√°.  Mas se voc√™ perguntar ao engenheiro de desenvolvimento de software sobre os bancos, provavelmente ficar√° horrorizado e com uma probabilidade 50/50 de se convencer de investir todo o dinheiro em bitcoin.  Os bancos s√£o not√≥rios por suas m√°s decis√µes ao criar software - n√£o porque essas decis√µes s√£o repugnantes, mas porque a maioria das pessoas sup√µe que os bancos s√£o mais precisos e cuidadosos com a seguran√ßa. <br><br>  <b>Kato</b> trabalha no Inibank, onde um produto comercial chamado T24 √© usado como o n√∫cleo do sistema banc√°rio.  O sistema T24 √© usado por centenas de bancos em todo o mundo.  Pode ser personalizado para uma ampla gama de solu√ß√µes banc√°rias.  Como na maioria dos pacotes personalizados.  Existem programadores especializados em escrever c√≥digo para ele e consultores que ajudam os bancos com grandes atualiza√ß√µes. <br><a name="habracut"></a><br>  A equipe do Inibank estava ocupada, ent√£o o banco convidou um consultor para participar de um projeto especial.  No final do dia √∫til, o banco conduziu o processo de conclus√£o, necess√°rio para que todo o dinheiro v√° para onde foi direcionado, todos os dados de sa√≠da necess√°rios sejam recalculados e todos os relat√≥rios necess√°rios sejam executados.  Nos bancos, esse processo tamb√©m altera a data do sistema para o pr√≥ximo dia √∫til.  √â por isso que quando voc√™ realiza opera√ß√µes banc√°rias online no domingo, nenhuma transa√ß√£o come√ßa a ser processada at√© segunda-feira de manh√£.  O consultor teve que criar um novo relat√≥rio que seria executado durante o processo de conclus√£o e incluiu processamento adicional se a data corresponder ao final do m√™s. <br><br>  Kato mostrou ao novo consultor como o banco configura relat√≥rios de final do dia.  ‚ÄúVeja, temos vari√°veis ‚Äã‚Äãglobais para o dia √∫til anterior, para hoje e para o pr√≥ximo dia √∫til.  Eles t√™m o formato YYMMDD para facilitar o trabalho ". <br><br>  ‚ÄúSim, sim, entendi.  Eu entendi.  Em que formato eles est√£o? <br><br>  "... Uhh ... eu posso apenas assumir que este √© o ano, m√™s e dia." <br><br>  ‚ÄúSim, sim, tudo bem.  √ìtimo.  Ent√£o eu vou trabalhar. <br><br>  Ap√≥s essa conversa, Kato teve um mau pressentimento sobre isso.  mas ele tentou se livrar dele.  O consultor disse que tudo est√° configurado e pronto.  Ele sabe exatamente o que est√° fazendo, certo?  Kato jogou isso fora de sua cabe√ßa e parou de se preocupar at√© o momento da revis√£o do c√≥digo chegar e ele encontrou uma p√©rola: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  Explique brevemente o que acontece aqui: <br><br><ol><li>  Aproveite o pr√≥ximo dia √∫til e altere o dia para 01 para obter o primeiro dia do m√™s. </li><li>  Alteramos essa data subtraindo 1 dia no calend√°rio da Espanha. </li><li>  Pegamos a data do servidor e a convertemos para o formato AAAAMMDD, chamando o comando Date tr√™s vezes. </li><li>  Se a data calculada na etapa 2 for igual √† data calculada na etapa 3, inicie o processo. </li></ol><br>  Bem, na verdade ... funciona.  Para a maior parte.  A menos que, por algum motivo, o final do dia n√£o aconte√ßa ap√≥s a meia-noite do pen√∫ltimo dia do m√™s - e isso n√£o √© t√£o raro.  Nesse caso, o c√≥digo pensar√° erroneamente que este √© o √∫ltimo dia do m√™s e come√ßar√° a criar o relat√≥rio.  O que combina bem com outro problema: se a mesma coisa acontecer no √∫ltimo dia do m√™s, a cria√ß√£o do relat√≥rio n√£o come√ßar√° por engano.  E o melhor bug: se o √∫ltimo dia do m√™s for domingo, o calend√°rio do servidor nunca ser√° instalado nele, porque ele ignora os dias n√£o √∫teis. <br><br>  Por falar em dias n√£o √∫teis: como o Inibank est√° localizado nos EUA, n√£o h√° raz√£o para usar o calend√°rio da Espanha.  Sim, os meses e as semanas ser√£o os mesmos, mas no calend√°rio do software em espanhol voc√™ precisar√° especificar feriados nos EUA, caso contr√°rio, o programa continuar√° funcionando.  Por fim, como se tudo isso n√£o bastasse, a chamada tripla Data significa que pode haver discord√¢ncias ao iniciar exatamente √† meia-noite: o valor do m√™s √© solicitado antes da meia-noite e no dia seguinte. <br><br>  Kato adicionou um coment√°rio, sugerindo uma maneira de alterar o c√≥digo: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Cinco minutos depois, o consultor foi at√© sua mesa.  "O que essa edi√ß√£o significa?" <br><br>  Kato n√£o estava disposto a discutir naquele momento.  - Seu c√≥digo est√° quebrado, amigo.  Tudo isso n√£o √© necess√°rio. " <br><br>  ‚ÄúEntendo, entendo.  Na verdade, esse √© apenas um procedimento operacional padr√£o para o nosso setor.  Bem, tudo bem. " <br><br>  Kato duvidava muito disso, mas simplesmente deu de ombros.  ‚ÄúEnt√£o a ind√∫stria est√° errada.  Eu expliquei tudo no coment√°rio ". <br><br>  Sim.  Sim, eu li.  Mas vou ler de novo.  E ele desapareceu t√£o de repente quanto apareceu. <br><br>  Edi√ß√µes foram feitas, Kato aprovou o c√≥digo e o consultor desapareceu na neblina. <br><br>  √Äs vezes, deitado na cama √† noite, Kato se perguntava: o consultor realmente entendeu o que havia feito de errado ou apenas concordou em olhar, recebeu seu cheque e continuou escrevendo em algum lugar um c√≥digo terr√≠vel por um pre√ßo duas vezes maior que o sal√°rio de Kato?  Nos bancos em que n√£o h√° funcion√°rios que possam verificar o c√≥digo. <br><br>  Mas n√£o invista todo o dinheiro em bitcoin.  √â ainda pior l√°. <br><br><h2>  A segunda hist√≥ria.  Como isso √© feito </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[Original]</a> <br><br>  As pessoas gostam de comer cachorro-quente at√© descobrir como cozinham.  A maioria n√£o pergunta, porque n√£o quer saber e continua comendo cachorro-quente.  Ao desenvolver software, √†s vezes <em>precisamos</em> perguntar.  N√£o apenas para resolver problemas, mas tamb√©m porque alguns programadores t√™m medo de que o software em seus carros, viajando pela estrada a uma velocidade de 100 km / h, seja montado a partir de fitas e paus.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toda a nossa ind√∫stria se sai mal com suas tarefas</a> . <br><br>  <strong>Brett</strong> trabalhou como analista de sistemas no MedStitute Medical Research Center.  O MedStitute usou um software propriet√°rio chamado MedTech para armazenar e analisar dados.  M√©dicos e pesquisadores gostaram dos resultados da MedTech, mas a colega Brett Tyree sabia como eles foram criados. <br><br>  O software n√£o teve acesso ao back-end e todo o processo de desenvolvimento ocorreu na GUI do "mouse program√°vel".  Essa interface parecia ter sido escrita por uma pessoa que estudou programa√ß√£o em sites de copiar e colar dos anos 90, examinou dez minutos <em>do Jurassic Park</em> e procurou respostas para o StackOverflow at√© que algo pudesse ser compilado.  A "linguagem de programa√ß√£o" tamb√©m mostrou um n√≠vel semelhante de reflex√£o na filosofia do design.  Cada um <em>deve</em> ter um <code>else</code> .  Alguns m√≥dulos usavam valores booleanos, outros retornavam cadeias vazias para indicar valores falsos.  A partir da documenta√ß√£o, n√£o ficou claro em qual situa√ß√£o um ou outro aconteceu.  De fato, cada <code>if</code> transformou em tr√™s declara√ß√µes. <br><br>  Brett precisava iniciar um novo estudo.  Foi baseado em um conjunto simples de estat√≠sticas e pacientes agrupados usando uma vari√°vel aleat√≥ria.  Brett procurou na lista uma vari√°vel que pudesse ser randomizada, mas n√£o achou necess√°ria.  Ele sugeriu que cometeu um erro e voltou algumas telas para verificar o nome dela, copiando-o para uma pesquisa.  Brett retornou √† lista de vari√°veis ‚Äã‚Äãaleat√≥rias.  Ela n√£o estava l√°.  Ele olhou mais de perto a lista e notou que a lista de vari√°veis ‚Äã‚Äãaleat√≥rias continha dados de campos de m√∫ltipla escolha.  O campo que ele precisava para randomizar foi baseado em um campo calculado. <br><br>  Brett sabia que Tyree estava trabalhando em outro projeto que aleatoriamente por campo computado, ent√£o ele entrou em contato com ele no Slack.  ‚ÄúComo voc√™ codificou essa vari√°vel aleat√≥ria?  A Medtech impede que isso aconte√ßa? <br><br>  "Estou falando de confer√™ncia, ligo para voc√™ mais tarde", escreveu Tyree. <br><br>  Alguns minutos depois, Tyree ligou para Brett. <br><br>  ‚ÄúVoc√™ precisa come√ßar com dois campos.  Vamos dizer.  vamos cham√°-los de <code>$variable_choice</code> , ou seja, uma pergunta de m√∫ltipla escolha e <code>$variable_calced</code> , ou seja, seu campo calculado.  Quando voc√™ deseja criar uma vari√°vel que executa a sele√ß√£o aleat√≥ria com base em um campo calculado, voc√™ diz √† Medtech que essa vari√°vel aleat√≥ria √© baseada em <code>$variable_choice</code> .  Ent√£o voc√™ exclui <code>$variable_choice</code> e renomeia <code>$variable_calced</code> para <code>$variable_choice</code> ‚Äù <br><br>  ‚ÄúPare, o sistema permite que voc√™ fa√ßa isso, mas n√£o permite que voc√™ randomize os campos calculados de nenhuma outra maneira?  E ela n√£o verifica? <br><br>  "Espero que nada mude, e ela n√£o come√ßa a verificar isso at√© a conclus√£o do meu projeto", respondeu Tyree. <br><br>  ‚ÄúEste estudo deve ocorrer em dez anos.  E sua conclus√£o bem-sucedida depende se os desenvolvedores consideram esse truque um bug? ‚Äù <br><br>  ‚ÄúConsegui encontrar apenas uma solu√ß√£o desse tipo.  Deixe-me saber se voc√™ encontrar algo melhor. <br><br>  Brett n√£o satisfez tal invas√£o e voltou a estudar a documenta√ß√£o.  Ele encontrou uma solu√ß√£o ‚Äúmelhor‚Äù: voc√™ pode criar um campo de m√∫ltipla escolha somente leitura com o √∫nico valor padr√£o - o valor do campo calculado.  Infelizmente, o usu√°rio pode inadvertidamente alterar a lista, respondendo a uma pergunta de m√∫ltipla escolha <em>antes de</em> calcular o valor do campo calculado. <br><br>  No final, a √∫nica coisa que restava para Brett era fazer uma pausa, ir ao refeit√≥rio e comprar alguns cachorros-quentes. <br><br><h2>  A terceira hist√≥ria.  Portabilidade e hardware </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Muitas luas atr√°s, quando os PCs tinham caixas de metal pesado e pl√°stico, <b>Matt</b> e seu colega foram convidados a avaliar o pacote de software para a opera√ß√£o do departamento de vendas que estava por vir.  Infelizmente, ele e seu colega trabalharam em escrit√≥rios diferentes na mesma cidade.  Naquela √©poca, ainda n√£o existiam ferramentas eficazes de colabora√ß√£o on-line; portanto, Matt regularmente precisava viajar para outro escrit√≥rio, levando um PC com ele.  Isso significava que cada vez que era necess√°rio desconectar os cabos perif√©ricos do gabinete 473, carregar o computador pelos corredores e descer as escadas, pegar um √¥nibus para chegar a outro escrit√≥rio, no qual ele fazia tudo isso na ordem inversa.  √Äs vezes, a organiza√ß√£o incorreta do trabalho obrigava esse casal a trabalhar nos finais de semana, o que significa que eles carregam m√°quinas de trabalho para casa. <br><br>  No processo, o disco r√≠gido de 20 MB no computador de Matt transbordou.  De seu escrit√≥rio, ele enviou uma solicita√ß√£o ao departamento de TI.  Para atender a solicita√ß√£o, foi designado o t√©cnico de Gary, que depois de algum tempo apareceu no cubo de Matt, segurando um novo disco r√≠gido e uma chave de fenda.  Gary enviou Matt para um caf√© para se concentrar em seu "paciente".  Ap√≥s uma pequena cirurgia, o PC de Matt ligou e trabalhou com um grande disco r√≠gido. <br><br>  Um dia antes do prazo final do projeto, Matt quase completou sua parte do trabalho.  Ele tinha apenas que fazer algumas adi√ß√µes ao seu relat√≥rio, copi√°-lo para disquetes e envi√°-lo ao departamento de vendas.  Devolvendo o PC ao cubo e conectando os fios, ele ligou a energia e ouviu um estalo.  O PC estava morto e n√£o mostrava sinais de vida. <br><br>  Ap√≥s uma liga√ß√£o de p√¢nico para o departamento de TI, Gary apareceu novamente em seu escrit√≥rio com uma chave de fenda.  Abrindo a caixa do PC, ele imediatamente gritou: ‚ÄúEspere um minuto!  Voc√™ arrastou um computador para algum lugar? <br><br>  Matt fez uma careta.  Bem, sim.  Essa √© a coisa? <br><br>  Sim, claro!  Voc√™ n√£o deveria ter feito isso! Gary come√ßou a xingar.  "O disco r√≠gido come√ßou a sair e colocou em curto tudo o que havia dentro!" <br><br>  Matt se inclinou sobre Gary para ver por si mesmo o interior do computador.  Ele imediatamente notou que o novo disco r√≠gido estava "fixo" na fita. <br><br>  ‚ÄúPare!  Que <i>voc√™</i> n√£o deveria ter feito isso!  Matt apontou para um peda√ßo de fita adesiva.  "Devo entrar em contato com seu supervisor por precau√ß√£o?" <br><br>  O rosto de Gary franziu o cenho.  "Eles n√£o me d√£o as fixa√ß√µes necess√°rias! <br><br>  "Ent√£o encontre quem os tem!" <br><br>  Dado o prazo iminente, com a permiss√£o do chefe, Matt transferiu sua inscri√ß√£o ainda mais.  Quase imediatamente, a fita adesiva foi substitu√≠da por hardware genu√≠no.  Ele nunca entendeu <i>por que</i> os funcion√°rios do departamento de TI n√£o tinham acesso ao equipamento necess√°rio;  ele sugeriu que era uma id√©ia brilhante de algum idiota economizar dinheiro.  Matt s√≥ conseguia adivinhar que outras improvisa√ß√µes desesperadas faziam a infraestrutura de TI funcionar e quanto tempo elas passariam despercebidas se o PC dele n√£o quebrasse. <br><br><h2>  A quarta hist√≥ria.  √â assim que o PL / SQL afeta seu c√©rebro. </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[Original]</a> <br><br>  O eterno campe√£o entre as decis√µes mais estranhas e sem sucesso permanecer√° para sempre o <em>Oracle</em> .  Hoje, olhamos para um pequeno c√≥digo PL / SQL. <br><br>  PL / SQL √© uma linguagem estranha, uma mistura de linguagem SQL e linguagem processual (processual) (linguagem) com orienta√ß√£o a objetos colada ao lado.  A sintaxe √© soberbamente capaz de criar a impress√£o de que foi desenvolvida na d√©cada de 1970, e cada nova fun√ß√£o ou mudan√ßa de linguagem continua essa tradi√ß√£o. <br><br>  A estrutura de cada m√≥dulo de c√≥digo PL / SQL √© baseada em <em>bloco</em> .  Cada bloco √© um espa√ßo para nome independente.  Em suma, sua anatomia √© assim: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  Se voc√™ estiver gravando um procedimento armazenado ou um manipulador de eventos, substitua a palavra-chave <code>DECLARE</code> por <code>CREATE [OR REPLACE]</code> .  Voc√™ tamb√©m pode aninhar blocos dentro de outros blocos, com bastante frequ√™ncia pode ver o c√≥digo estruturado desta maneira: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  Sim, muito rapidamente come√ßa a ficar confuso.  E sim, se voc√™ deseja fornecer pelo menos uma manipula√ß√£o de erros aproximadamente estruturada, <em>deve</em> come√ßar a colocar blocos um no outro. <br><br>  O idioma e o banco de dados t√™m outros recursos divertidos.  Antes da vers√£o 12c, eles n√£o tinham um tipo de coluna <code>IDENTITY</code> .  Nas vers√µes anteriores, era necess√°rio usar o objeto <code>SEQUENCE</code> e escrever procedimentos ou manipuladores de eventos que executam numera√ß√£o autom√°tica for√ßada.  Normalmente, o operador <code>SELECT INTO‚Ä¶</code> foi usado para atribuir um valor a uma vari√°vel.  B√¥nus: o Oracle SQL <em>sempre</em> exige que uma tabela seja especificada na instru√ß√£o <code>FROM</code> , portanto, voc√™ deve usar uma tabela <code>dual</code> inventada, como esta: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> neste contexto indica a linha para a qual estamos numerando automaticamente.  Nas vers√µes mais antigas do Oracle, essa era a maneira "usual" de criar colunas com numera√ß√£o autom√°tica.  <strong>Benoit</strong> descobriu outra maneira ligeiramente menos comum de fazer a mesma opera√ß√£o: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  Muita coisa est√° acontecendo aqui.  Primeiro, observe que a se√ß√£o <code>DECLARE</code> cont√©m a instru√ß√£o <code>CURSOR</code> .  Os cursores permitem percorrer os registros.  Eles s√£o muito caros e, no mundo Oracle, √© um recurso que precisa ser liberado. <br><br>  Este manipulador de eventos (gatilho) usa um bloco aninhado sem motivo.  Ele tamb√©m usa a vari√°vel adicional <code>pl_error_id</code> , que pode ser dispensada. <br><br>  Mas a parte realmente estranha √© o bloco <code>IF get_seq%NOTFOUND</code> .  Tudo √© bem simples: verifica a condi√ß√£o de o cursor n√£o retornar uma string.  Para este cursor, isso n√£o pode acontecer nem <em>teoricamente</em> , portanto as opera√ß√µes internas nunca s√£o executadas.  Uma sequ√™ncia sempre retorna um valor.  E isso √© <em>bom</em> , dado o c√≥digo que vai al√©m. <br><br>  <code>raise_application_error</code> √© um an√°logo do throw no Oracle.  Essa instru√ß√£o aumenta a pilha de blocos execut√°veis ‚Äã‚Äãat√© encontrar a se√ß√£o <code>EXCEPTIONS</code> para lidar com o erro.  Observe que fechamos o cursor <em>ap√≥s</em> esta declara√ß√£o - ou seja, <em>nunca</em> fechamos o cursor.  Os cursores, como mencionado acima, s√£o caros e o Oracle apenas permite que um n√∫mero limitado deles seja usado. <br><br>  Aqui vemos um exemplo estranho de como um desenvolvedor tenta se defender contra um erro que n√£o pode acontecer, de uma maneira que levar√° a novos erros ao longo do tempo. <br><br><h2>  A quinta hist√≥ria.  Logins com criptografia dupla </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[Original]</a> <br><br>  Criar autentica√ß√£o para a API da Web √© uma tarefa <em>dif√≠cil</em> , mas possui <em>muitas</em> solu√ß√µes bem estabelecidas.  O mais dif√≠cil √© realmente escolher uma das v√°rias op√ß√µes, ap√≥s as quais basta adicionar um componente. <br><br>  Quando implementado corretamente, o sistema n√£o depende do tipo de cliente.  Eu posso acessar o servi√ßo atrav√©s de um navegador, em um cliente grosso ou atrav√©s de cURL.  Se implementado incorretamente, voc√™ obt√©m o que aconteceu com <strong>Amira</strong> . <br><br>  Ela resolveu o problema de extrair as estat√≠sticas de que precisava do back-end, mas n√£o conseguiu descobrir o m√©todo de autentica√ß√£o.  Portanto, ela estudou o c√≥digo front-end para entender como ele executa a autentica√ß√£o: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  Por um lado, posso assumir que esse c√≥digo √© muito antigo, dado o <code>document.loginForm</code> usado para intera√ß√µes com elementos DOM.  Por outro lado, o <code>JSEncrypt</code> foi lan√ßado pela primeira vez em 2013, o que nos d√° a faixa et√°ria m√°xima. <br><br>  Passamos os par√¢metros de acesso ao back-end enviando o formul√°rio, que, de acordo com o desenvolvedor do c√≥digo, exigia limpeza - todos os <code>&amp;</code> <code>+</code> na senha s√£o substitu√≠dos, mas ... isso n√£o √© necess√°rio, porque o formul√°rio deve atender √† solicita√ß√£o <code>POST</code> e, al√©m disso, <em>criptografamos os dados</em> . <br><br>  Aqui est√° o que eu penso.  O c√≥digo <em>√© realmente</em> muito antigo.  O desenvolvedor o copiou de uma postagem no StackOverflow por volta de 2005, que n√£o usava criptografia e <code>POST</code> formul√°rios via <code>POST</code> .  Ano ap√≥s ano, pequenas altera√ß√µes foram adicionadas a ele.  mas o mecanismo subjacente nunca mudou. <br><br>  Amira verificou o hist√≥rico e descobriu que a criptografia n√£o era usada na vers√£o anterior.      <code>challenge</code> ,    MD5,     <em></em>  ,     ,       . <br><br>     :   ,     ,         ,     ,    cURL      -.          ,    <em>    SSL/TLS</em> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt446714/">https://habr.com/ru/post/pt446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt446702/index.html">E outro fone de ouvido estranho - para dormir</a></li>
<li><a href="../pt446706/index.html">Consultas paralelas no PostgreSQL</a></li>
<li><a href="../pt446708/index.html">Compara√ß√£o de sistemas de comunica√ß√£o espacial</a></li>
<li><a href="../pt446710/index.html">Quatro hist√≥rias reais de trabalho com arquitetura de microsservi√ßos - relat√≥rio da mitap do Backend United 3: Kholodets</a></li>
<li><a href="../pt446712/index.html">O HTTPS nem sempre √© t√£o seguro quanto parece. Vulnerabilidades encontradas em 5,5% dos sites HTTPS</a></li>
<li><a href="../pt446716/index.html">Consci√™ncia e Argumento do Ju√≠zo Final</a></li>
<li><a href="../pt446718/index.html">Revis√£o dos relat√≥rios mais interessantes do CodeFest 2019: vers√£o do True Engineering</a></li>
<li><a href="../pt446722/index.html">O teste mostrar√°: como se preparar para a implementa√ß√£o do Cisco ISE e entender quais recursos do sistema voc√™ precisa</a></li>
<li><a href="../pt446724/index.html">Como os desenvolvedores de iOS est√£o buscando melhorar a computa√ß√£o em nuvem</a></li>
<li><a href="../pt446726/index.html">Aprendizagem Profunda em Computa√ß√£o √ìtica de Fluxo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>