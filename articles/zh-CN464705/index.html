<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔄 🏳️ 🚽 用Python编写API（使用Flask和RapidAPI） 🔪 🔝 🙈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="如果您正在阅读本文，您可能已经熟悉使用API​​（应用程序编程接口）打开的可能性。 

 通过向您的应用程序添加许多开放的API之一，您可以扩展此应用程序的功能或用必要的数据进行补充。 但是，如果您开发了想要与社区共享的独特功能，该怎么办？ 

 答案很简单：您需要创建自己的API 。 

 尽管起...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>用Python编写API（使用Flask和RapidAPI）</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/464705/"><img src="https://habrastorage.org/getpro/habr/post_images/ba3/254/0ba/ba32540bab550e3f4f1f33db01f28d00.jpg"><br><br> 如果您正在阅读本文，您可能已经熟悉使用API​​（应用程序编程接口）打开的可能性。 <br><br> 通过向您的应用程序添加许多开放的API之一，您可以扩展此应用程序的功能或用必要的数据进行补充。 但是，如果您开发了想要与社区共享的独特功能，该怎么办？ <br><a name="habracut"></a><br> 答案很简单：您需要<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">创建自己的API</a> 。 <br><br> 尽管起初看起来似乎是一项艰巨的任务，但实际上一切都很简单。 我们将向您展示如何使用Python执行此操作。 <br><br><h3> 您需要开始什么 </h3><br> 要开发API，您需要： <br><br><ul><li>  Python 3 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flask-</a>用于创建Web应用程序的简单易用的框架； </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flask-RESTful</a>是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flask</a>的扩展，允许您以最少的配置快速开发REST API。 </li></ul><br> 通过以下命令执行安装： <br><br><pre><code class="python hljs">pip install flask-restful</code> </pre> <br><blockquote>  <b>推荐给初学者的免费密集编程：</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C＃中的Telegram机器人开发</a> -8月26日至28日。  <i>免费密集型软件，可让您了解助手机器人的工作方式，使用Telegram API的功能以及其他细微差别。</i>  <i>最好的三个参加者将从Skillbox那里获得30,000卢布</i> 。 <br></blockquote>  <b>开始之前</b> <br><br> 我们将开发具有基本<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CRUID功能</a>的RESTful API。 <br><br> 为了完全理解该问题，让我们看一下上面提到的两个术语。 <br><br>  <b>什么是REST？</b> <br><br>  REST API（代表性状态传输）是一种使用HTTP请求交换数据的API。 <br><br>  REST API必须满足某些条件： <br><br><ul><li> 客户端-服务器体系结构：客户端与用户界面交互，服务器与后端和数据仓库交互。 客户端和服务器是独立的，它们中的任何一个都可以相互替换。 </li><li> 无状态-服务器上没有存储任何客户端数据。 会话状态存储在客户端。 </li><li> 可缓存性-客户端可以缓存服务器响应以提高整体性能。 </li></ul><br>  <b>什么是CRUD？</b> <br><br>  <b>CRUD</b>是一种编程概念，描述了四个基本操作（创建，读取，更新和删除）。 <br><br> 在REST API中，请求类型和请求方法负责诸如发布，获取，放置，删除之类的操作。 <br><br> 现在我们已经弄清楚了基本术语，您可以开始创建API。 <br><br><h3> 发展历程 </h3><br> 让我们创建一个关于人工智能的报价存储库。 人工智能是当今发展最快的技术之一，Python是使用AI的流行工具。 <br><br> 借助此API，Python开发人员可以快速获取有关AI的信息并受到新开发的启发。 如果开发人员对此主题有宝贵的想法，则可以将其添加到存储库中。 <br><br> 让我们从导入必要的模块并配置Flask开始： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask_restful <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Api, Resource, reqparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random app = Flask(__name__) api = Api(app)</code> </pre> <br> 在此片段中，Flask，Api和Resource是我们需要的类。 <br><br>  Reqparse是一个Flask-RESTful请求解析接口...您还将需要一个随机模块来显示随机报价。 <br><br> 现在，我们将创建一个AI报价存储库。 <br><br> 每个回购条目将包含： <br><br><ul><li> 数字身份证 </li><li> 报价作者的姓名； </li><li> 报价。 </li></ul><br> 由于这只是培训的示例，因此我们将所有条目保存在Python列表中。 在实际的应用程序中，我们很可能会改用数据库。 <br><br><pre> <code class="python hljs">ai_quotes = [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Kevin Kelly"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"The business plans of the next 10,000 startups are easy to forecast: "</span></span> + <span class="hljs-string"><span class="hljs-string">"Take X and add AI."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Stephen Hawking"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"The development of full artificial intelligence could "</span></span> + <span class="hljs-string"><span class="hljs-string">"spell the end of the human race… "</span></span> + <span class="hljs-string"><span class="hljs-string">"It would take off on its own, and re-design "</span></span> + <span class="hljs-string"><span class="hljs-string">"itself at an ever increasing rate. "</span></span> + <span class="hljs-string"><span class="hljs-string">"Humans, who are limited by slow biological evolution, "</span></span> + <span class="hljs-string"><span class="hljs-string">"couldn't compete, and would be superseded."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Claude Shannon"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"I visualize a time when we will be to robots what "</span></span> + <span class="hljs-string"><span class="hljs-string">"dogs are to humans, "</span></span> + <span class="hljs-string"><span class="hljs-string">"and I'm rooting for the machines."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Elon Musk"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"The pace of progress in artificial intelligence "</span></span> + <span class="hljs-string"><span class="hljs-string">"(I'm not referring to narrow AI) "</span></span> + <span class="hljs-string"><span class="hljs-string">"is incredibly fast. Unless you have direct "</span></span> + <span class="hljs-string"><span class="hljs-string">"exposure to groups like Deepmind, "</span></span> + <span class="hljs-string"><span class="hljs-string">"you have no idea how fast — it is growing "</span></span> + <span class="hljs-string"><span class="hljs-string">"at a pace close to exponential. "</span></span> + <span class="hljs-string"><span class="hljs-string">"The risk of something seriously dangerous "</span></span> + <span class="hljs-string"><span class="hljs-string">"happening is in the five-year timeframe."</span></span> + <span class="hljs-string"><span class="hljs-string">"10 years at most."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Geoffrey Hinton"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"I have always been convinced that the only way "</span></span> + <span class="hljs-string"><span class="hljs-string">"to get artificial intelligence to work "</span></span> + <span class="hljs-string"><span class="hljs-string">"is to do the computation in a way similar to the human brain. "</span></span> + <span class="hljs-string"><span class="hljs-string">"That is the goal I have been pursuing. We are making progress, "</span></span> + <span class="hljs-string"><span class="hljs-string">"though we still have lots to learn about "</span></span> + <span class="hljs-string"><span class="hljs-string">"how the brain actually works."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Pedro Domingos"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"People worry that computers will "</span></span> + <span class="hljs-string"><span class="hljs-string">"get too smart and take over the world, "</span></span> + <span class="hljs-string"><span class="hljs-string">"but the real problem is that they're too stupid "</span></span> + <span class="hljs-string"><span class="hljs-string">"and they've already taken over the world."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Alan Turing"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"It seems probable that once the machine thinking "</span></span> + <span class="hljs-string"><span class="hljs-string">"method had started, it would not take long "</span></span> + <span class="hljs-string"><span class="hljs-string">"to outstrip our feeble powers… "</span></span> + <span class="hljs-string"><span class="hljs-string">"They would be able to converse "</span></span> + <span class="hljs-string"><span class="hljs-string">"with each other to sharpen their wits. "</span></span> + <span class="hljs-string"><span class="hljs-string">"At some stage therefore, we should "</span></span> + <span class="hljs-string"><span class="hljs-string">"have to expect the machines to take control."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ray Kurzweil"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"Artificial intelligence will reach "</span></span> + <span class="hljs-string"><span class="hljs-string">"human levels by around 2029. "</span></span> + <span class="hljs-string"><span class="hljs-string">"Follow that out further to, say, 2045, "</span></span> + <span class="hljs-string"><span class="hljs-string">"we will have multiplied the intelligence, "</span></span> + <span class="hljs-string"><span class="hljs-string">"the human biological machine intelligence "</span></span> + <span class="hljs-string"><span class="hljs-string">"of our civilization a billion-fold."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Sebastian Thrun"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"Nobody phrases it this way, but I think "</span></span> + <span class="hljs-string"><span class="hljs-string">"that artificial intelligence "</span></span> + <span class="hljs-string"><span class="hljs-string">"is almost a humanities discipline. It's really an attempt "</span></span> + <span class="hljs-string"><span class="hljs-string">"to understand human intelligence and human cognition."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"Andrew Ng"</span></span>, <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: <span class="hljs-string"><span class="hljs-string">"We're making this analogy that AI is the new electricity."</span></span> + <span class="hljs-string"><span class="hljs-string">"Electricity transformed industries: agriculture, "</span></span> + <span class="hljs-string"><span class="hljs-string">"transportation, communication, manufacturing."</span></span> } ]</code> </pre> <br> 现在，我们需要创建一个资源类Quote，这将确定我们API端点的操作。 在类中必须声明四个方法：get，post，put，delete。 <br><br>  <b>让我们从GET方法开始。</b> <br><br> 通过指定其ID可以获取特定的报价，如果未指定ID，则可以使用随机报价。 <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quote</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Resource)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, id=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> id == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.choice(ai_quotes), <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> quote <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ai_quotes: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(quote[<span class="hljs-string"><span class="hljs-string">"id"</span></span>] == id): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quote, <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Quote not found"</span></span>, <span class="hljs-number"><span class="hljs-number">404</span></span></code> </pre> <br> 如果ID包含默认值，即GET方法，则GET方法返回随机报价。 调用该方法时，未设置ID。 <br><br> 如果已指定，则该方法将在引号中搜索并找到包含指定ID的引号。 如果未找到任何内容，则显示消息“找不到报价，404”。 <br><br> 请记住：如果请求成功，则该方法返回的HTTP状态为200，如果未找到该记录，则返回404。 <br><br> 现在让我们创建一个POST方法，以向存储库添加新的报价 <br><br> 键入时，它将收到每个新报价的标识符。 另外，POST将使用reqparse解析将在请求正文中使用的参数（作者和引文）。 <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">post</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, id)</span></span></span><span class="hljs-function">:</span></span> parser = reqparse.RequestParser() parser.add_argument(<span class="hljs-string"><span class="hljs-string">"author"</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">"quote"</span></span>) params = parser.parse_args() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> quote <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ai_quotes: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(id == quote[<span class="hljs-string"><span class="hljs-string">"id"</span></span>]): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">f"Quote with id </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string"> already exists"</span></span>, <span class="hljs-number"><span class="hljs-number">400</span></span> quote = { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: int(id), <span class="hljs-string"><span class="hljs-string">"author"</span></span>: params[<span class="hljs-string"><span class="hljs-string">"author"</span></span>], <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: params[<span class="hljs-string"><span class="hljs-string">"quote"</span></span>] } ai_quotes.append(quote) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quote, <span class="hljs-number"><span class="hljs-number">201</span></span></code> </pre> <br> 在上面的代码中，POST方法接受了报价ID。 然后，使用reqparse，他从查询中获得了作者和报价，并将它们存储在params字典中。 <br><br> 如果已经存在具有指定ID的报价，则该方法将显示相应的消息和代码400。 <br><br> 如果尚未创建具有指定ID的报价，则该方法将创建具有指定ID和作者以及其他参数的新记录。 然后，他将一个条目添加到ai_quotes列表中，并返回一个带有新引号的条目以及代码201。 <br><br> 现在创建一个PUT方法来修改存储库中的现有报价。 <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, id)</span></span></span><span class="hljs-function">:</span></span> parser = reqparse.RequestParser() parser.add_argument(<span class="hljs-string"><span class="hljs-string">"author"</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">"quote"</span></span>) params = parser.parse_args() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> quote <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ai_quotes: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(id == quote[<span class="hljs-string"><span class="hljs-string">"id"</span></span>]): quote[<span class="hljs-string"><span class="hljs-string">"author"</span></span>] = params[<span class="hljs-string"><span class="hljs-string">"author"</span></span>] quote[<span class="hljs-string"><span class="hljs-string">"quote"</span></span>] = params[<span class="hljs-string"><span class="hljs-string">"quote"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quote, <span class="hljs-number"><span class="hljs-number">200</span></span> quote = { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: id, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: params[<span class="hljs-string"><span class="hljs-string">"author"</span></span>], <span class="hljs-string"><span class="hljs-string">"quote"</span></span>: params[<span class="hljs-string"><span class="hljs-string">"quote"</span></span>] } ai_quotes.append(quote) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quote, <span class="hljs-number"><span class="hljs-number">201</span></span></code> </pre> <br> 与前面的示例类似，PUT方法采用ID和输入并使用reqparse解析报价参数。 <br><br> 如果存在具有指定ID的引用，则该方法将使用新参数对其进行更新，然后显示带有代码200的更新的引用。如果没有具有指定ID的引用，则将使用代码201创建新记录。 <br><br> 最后，让我们创建一个DELETE方法来删除不再鼓舞人心的报价。 <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, id)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> ai_quotes ai_quotes = [qoute <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> qoute <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ai_quotes <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> qoute[<span class="hljs-string"><span class="hljs-string">"id"</span></span>] != id] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">f"Quote with id </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{id}</span></span></span><span class="hljs-string"> is deleted."</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span></code> </pre> <br> 此方法在您键入时获取报价ID，并使用通用列表更新ai_quotes列表。 <br><br> 现在我们已经创建了所有方法，我们所要做的就是将资源添加到API，设置路径并运行Flask。 <br><br><pre> <code class="python hljs">api.add_resource(Quote, <span class="hljs-string"><span class="hljs-string">"/ai-quotes"</span></span>, <span class="hljs-string"><span class="hljs-string">"/ai-quotes/"</span></span>, <span class="hljs-string"><span class="hljs-string">"/ai-quotes/&lt;int:id&gt;"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: app.run(debug=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> 我们的REST API服务已准备就绪！ <br><br> 接下来，我们可以使用以下命令在控制台中运行代码，以将代码保存在app.py文件中： <br><br><pre> <code class="python hljs">python3 app.py</code> </pre> <br> 如果一切顺利，那么我们将得到以下内容： <br><br>  <i>*调试模式：打开</i> <i><br></i>  <i>*运行于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">127.0.0.1：5000</a> /（按CTRL + C退出）</i> <i><br></i>  <i>*用统计重启</i> <i><br></i>  <i>*调试器处于活动状态！</i> <i><br></i>  <i>*调试器PIN：XXXXXXX</i> <br><br>  <b>测试API</b> <br><br> 创建API后，需要对其进行测试。 <br><br> 可以使用curl控制台实用程序或Insomnia REST客户端或通过将API发布到Rapid API来完成此操作。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07d/0ba/ac3/07d0baac377bd2cd2667b7c457740e64.png"><br><br>  <b>发布我们的API</b> <br><br>  RapidAPI是世界上最大的市场，拥有10,000多个API（以及大约100万开发人员）。 <br><br>  RapidAPI不仅提供用于与第三方API一起使用的单一接口，而且还使您能够快速轻松地发布自己的API。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">为此</a> ，您首先需要将其发布在网络上的某些服务器上。 在我们的例子中，我们将使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Heroku</a> 。 与他一起工作不会造成任何困难（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">您可以在此处了解有关他的更多信息</a> ）。 <br><br>  <b>如何在Heroku上发布API</b> <br><br>  <i><b>1.安装Heroku。</b></i> <br><br> 第一步是注册并安装Heroku命令行界面（CLI）。 这适用于Ubuntu 16+。 <br><br>  <i>sudo snap install heroku --classic</i> <br><br> 然后登录： <br><br>  <i>heroku登录</i> <br><br>  <i><b>2.添加必要的文件。</b></i> <br><br> 现在，我们需要将要发布的文件添加到应用程序的文件夹中： <br><br><ul><li>  requirements.txt以及所需的Python模块列表； </li><li>  Procfile，指示必须执行哪些命令才能启动应用程序； </li><li>  .gitignore-排除服务器上不需要的文件。 </li></ul><br>  requirements.txt文件将包含以下几行： <br><br><ul><li> 烧瓶 </li><li> 烧瓶静止 </li><li> 古尼康 </li></ul><br> 请注意：由于我们需要在服务器上运行应用程序，因此我们在列表中添加了gunicorn（Python WSGI HTTP Server）。 <br><br>  Procfile将包含： <br><br>  <i>网站：gunicorn app：app</i> <br><br>  .gitignore的内容： <br><br><pre> <code class="1c hljs">*.pyc __pycache__/</code> </pre> <br> 现在已经创建了文件，让我们初始化git repo并提交： <br><br><pre> <code class="plaintext hljs">git init git add git commit -m "First API commit"</code> </pre> <br>  <i><b>3.创建一个新的Heroku应用程序。</b></i> <br><br><pre> <code class="plaintext hljs">heroku create</code> </pre> <br> 我们将master分支发送到远程Heroku存储库： <br><br><pre> <code class="plaintext hljs">git push heroku master</code> </pre> <br> 现在，您可以使用以下命令打开API服务： <br><br><pre> <code class="plaintext hljs">heroku ps:scale web=1 heroku open</code> </pre><br> 该API将在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">your-random-heroku-name.herokuapp.com/ai-quotes上提供</a> 。 <br><br>  <b>如何将Python API添加到RapidAPI市场</b> <br><br> 在Heroku上发布API服务后，您可以将其添加到Rapid API。 这是有关此主题的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">详细文档</a> 。 <br><br>  <i><b>1.创建一个RapidAPI帐户。</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f3a/35d/013/f3a35d01372d9c998e7508a59b9a7d69.png"><br><br> 注册一个免费帐户-可以使用Facebook，Google，GitHub来完成。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4be/9c2/c7d/4be9c2c7da982571aa16f7e715784409.png"><br><br>  <i><b>2.将API添加到控制面板。</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b38/733/cc5/b38733cc584694eabd37b360a44d42ea.png"><br><br>  <i><b>3.接下来，输入有关您的API的常规信息。</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/414/804/fd7/414804fd7b343aeb691fed695f16e392.png"><br><br>  <i><b>4.单击“添加API”后，将出现一个新页面，您可以在其中输入有关我们API的信息。</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b39/9dd/c4d/b399ddc4d329fab9e95cf77f34dbd583.png"><br><br>  <i><b>5.现在，您可以手动输入API端点，也可以使用OpenAPI下载<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">swagger文件</a> 。</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f7/1e6/950/3f71e695060c691e115bc4c54b9f08d8.png"><br><br> 好了，现在我们需要在“端点”页面上设置API的端点。 在我们的例子中，端点对应于CRUD概念（获取，发布，放置，删除）。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/42a/c79/eb7/42ac79eb7ba7699e71d93bf79030d0b6.png"><br><br> 接下来，您需要创建GET AI Quote端点，该端点显示一个随机引号（如果ID为默认值）或指定ID的引号。 <br><br> 要创建端点，请单击“创建端点”按钮。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a7b/82b/ef1/a7b82bef117a91a931584c6c07c63a89.png"><br><br> 对所有其他API端点重复此过程。 仅此而已！ 恭喜，您已经发布了API！ <br><br> 如果一切顺利，API页面将如下所示： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/83e/14e/200/83e14e2002bd3a6b85148557c79cb050.png"><br><br><h3> 结论 </h3><br> 在本文中，我们探讨了在Python中创建自己的RESTful API服务的过程，以及将API发布到Heroku云并将其添加到RapidAPI目录的过程。 <br><br> 但是在测试版本中，仅显示了API开发的基本原理-未考虑安全性，容错性和可伸缩性等细微差别。 <br><br> 在开发真实的API时，必须考虑所有这些因素。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN464705/">https://habr.com/ru/post/zh-CN464705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN464687/index.html">如果您想拯救世界，就不能选择素食主义</a></li>
<li><a href="../zh-CN464689/index.html">Panda Frontend Meetup＃22内容：插件，复杂数据，测试，声明性Angular</a></li>
<li><a href="../zh-CN464691/index.html">对峙网络战的结果，或者PT专家安全中心如何跟踪攻击者</a></li>
<li><a href="../zh-CN464695/index.html">解释机器学习模型。 第一部分</a></li>
<li><a href="../zh-CN464701/index.html">有效的启动站点：客户，合作伙伴和投资者如何喜欢一个站点</a></li>
<li><a href="../zh-CN464709/index.html">活着还活着：勒索软件病毒在2019年</a></li>
<li><a href="../zh-CN464711/index.html">牙仙在这里不起作用：鳄鱼及其史前祖先的牙釉质结构</a></li>
<li><a href="../zh-CN464715/index.html">可视化大图，最小图</a></li>
<li><a href="../zh-CN464717/index.html">自由守望者</a></li>
<li><a href="../zh-CN464719/index.html">组织目标管理：目标和工程师（第3部分）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>