<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤵 👊 😗 Aprendizaje profundo para determinar el estilo y el género de las pinturas. 💈 😗 💠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! 


 Hoy quiero hablar sobre la segunda parte del proyecto de servicio para la identificación y clasificación de obras de arte. Permíteme re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizaje profundo para determinar el estilo y el género de las pinturas.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/422357/"><p>  Hola Habr! </p><br><p>  Hoy quiero hablar sobre la segunda parte del proyecto de servicio para la identificación y clasificación de obras de arte.  Permíteme recordarte que resolvimos dos tareas principales: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">buscar una imagen en la base de datos de una fotografía tomada por un teléfono móvil;</a> </li><li>  determinación del estilo y género de una imagen que no está en la base de datos. </li></ol><br><p>  Hoy consideraremos el uso de una red neuronal convolucional para clasificar imágenes por estilo y género. </p><br><img src="https://habrastorage.org/webt/r3/ef/sj/r3efsjaeruoyzjzbsxzcprq7owk.jpeg"><br><p>  ¿Ayuda a Dasha a entender el arte contemporáneo? </p><a name="habracut"></a><br><h2>  Determinando el estilo de las pinturas </h2><br><p> De casi 250,000 pinturas en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">base de datos de Arthive, a</a> menos del 20% se le asigna un género, estilo o técnica, a menudo las clases que se muestran en la base de datos no corresponden a los valores verdaderos, muchas clases que contienen muy pocas imágenes.  Parece que incluso hay clases que contienen unidades de imágenes.  Aparentemente, algunos autores consideran necesario crear un nombre para su propio estilo. <br><br>  En total, se asignaron alrededor de 75 estilos en la base de datos, sin embargo, para nuestro trabajo, el cliente seleccionó 27 estilos obligatorios (a los que posteriormente se agregó otro), que el sistema debe reconocer. <br><br>  Para ellos, la distribución del relleno resultó ser muy desigual. </p><br><table><thead><tr><th>  Estilo </th><th>  cantidad </th><th>  Estilo </th><th>  cantidad </th></tr></thead><tbody><tr><td>  Realismo </td><td>  19594 </td><td>  Primitivismo </td><td>  1234 </td></tr><tr><td>  Impresionismo </td><td>  15864 </td><td>  Art Decó </td><td>  1092 </td></tr><tr><td>  Romanticismo </td><td>  8963 </td><td>  Renacimiento del norte </td><td>  921 </td></tr><tr><td>  Barroco </td><td>  7726 </td><td>  Cubismo </td><td>  902 </td></tr><tr><td>  Moderno </td><td>  4882 </td><td>  Academicismo </td><td>  707 </td></tr><tr><td>  Surrealismo </td><td>  4793 </td><td>  Gótico </td><td>  608 </td></tr><tr><td>  Renacimiento </td><td>  4709 </td><td>  Modernismo </td><td>  539 </td></tr><tr><td>  Expresionismo </td><td>  4329 </td><td>  Realismo socialista </td><td>  481 </td></tr><tr><td>  Simbolismo </td><td>  4321 </td><td>  Arte pop </td><td>  475 </td></tr><tr><td>  Postimpresionismo </td><td>  3951 </td><td>  Puntillismo </td><td>  275 </td></tr><tr><td>  Arte abstracto </td><td>  3664 </td><td>  Fauvismo </td><td>  217 </td></tr><tr><td>  Ukiyo-e </td><td>  3136 </td><td>  Vanguardia </td><td>  174 </td></tr><tr><td>  Clasicismo </td><td>  1730 </td><td>  Hiperrealismo </td><td>  13 </td></tr><tr><td>  Rococó </td><td>  1600 </td><td>  Fantasía </td><td>  8 </td></tr><tr><td></td><td></td><td>  <strong><em>Total</em></strong> </td><td>  96908 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Todos los estilos</b> <div class="spoiler_text"><table><thead><tr><th>  Estilo </th><th>  cantidad </th><th>  Estilo </th><th>  cantidad </th><th>  Estilo </th><th>  cantidad </th></tr></thead><tbody><tr><td>  <strong>Realismo</strong> </td><td>  19594 </td><td>  <strong>Arte pop</strong> </td><td>  475 </td><td>  Decorativismo </td><td>  66 </td></tr><tr><td>  <strong>Impresionismo</strong> </td><td>  15864 </td><td>  Biedermeier </td><td>  471 </td><td>  Minimalismo </td><td>  66 </td></tr><tr><td>  <strong>Romanticismo</strong> </td><td>  8963 </td><td>  Realismo fantástico </td><td>  386 </td><td>  Sentimentalismo </td><td>  66 </td></tr><tr><td>  <strong>Barroco</strong> </td><td>  7726 </td><td>  Expresionismo abstracto </td><td>  358 </td><td>  Cloisonismo </td><td>  60 60 </td></tr><tr><td>  <strong>Moderno</strong> </td><td>  4882 </td><td>  Nabis </td><td>  339 </td><td>  Pintura metafísica </td><td>  56 </td></tr><tr><td>  <strong>Surrealismo</strong> </td><td>  4793 </td><td>  <strong>Puntillismo</strong> </td><td>  275 </td><td>  Machiaioli </td><td>  52 </td></tr><tr><td>  <strong>Renacimiento</strong> </td><td>  4709 </td><td>  Suprematismo </td><td>  273 </td><td>  Orfismo </td><td>  51 </td></tr><tr><td>  <strong>Expresionismo</strong> </td><td>  4329 </td><td>  Prerrafaelitas </td><td>  252 </td><td>  Dada </td><td>  50 </td></tr><tr><td>  <strong>Simbolismo</strong> </td><td>  4321 </td><td>  Realismo mágico </td><td>  248 </td><td>  Neoimpresionismo </td><td>  49 </td></tr><tr><td>  <strong>Postimpresionismo</strong> </td><td>  3951 </td><td>  Renacimiento temprano </td><td>  232 </td><td>  Luminismo </td><td>  41 </td></tr><tr><td>  <strong>Arte abstracto</strong> </td><td>  3664 </td><td>  Neoexpresionismo </td><td>  230 </td><td>  Proto-renacimiento </td><td>  39 </td></tr><tr><td>  La edad de oro de Holanda </td><td>  3292 </td><td>  <strong>Fauvismo</strong> </td><td>  217 </td><td>  Plantanismo </td><td>  37 </td></tr><tr><td>  <strong>Ukiyo-e</strong> </td><td>  3136 </td><td>  Posmodernismo </td><td>  192 </td><td>  Tenebrizm </td><td>  35 </td></tr><tr><td>  <strong>Clasicismo</strong> </td><td>  1730 </td><td>  <strong>Vanguardia</strong> </td><td>  174 </td><td>  Impresionismo abstracto </td><td>  34 </td></tr><tr><td>  <strong>Rococó</strong> </td><td>  1600 </td><td>  Arte contemporáneo </td><td>  149 </td><td>  Conceptualismo </td><td>  29 </td></tr><tr><td>  <strong>Primitivismo</strong> </td><td>  1234 </td><td>  Precisión </td><td>  138 </td><td>  Japonismo </td><td>  24 </td></tr><tr><td>  <strong>Art Decó</strong> </td><td>  1092 </td><td>  Cubofuturismo </td><td>  108 </td><td>  Posmoderna </td><td>  24 </td></tr><tr><td>  <strong>Renacimiento del norte</strong> </td><td>  921 </td><td>  Constructivismo </td><td>  104 </td><td>  Luchismo </td><td>  24 </td></tr><tr><td>  <strong>Cubismo</strong> </td><td>  902 </td><td>  Tonalismo </td><td>  103 </td><td>  Bizantino </td><td>  20 </td></tr><tr><td>  <strong>Academicismo</strong> </td><td>  707 </td><td>  Orfismo </td><td>  94 </td><td>  Realismo romantico </td><td>  19 </td></tr><tr><td>  <strong>Gótico</strong> </td><td>  608 </td><td>  Regionalismo </td><td>  93 </td><td>  <strong>Hiperrealismo</strong> </td><td>  13 </td></tr><tr><td>  Neoclasicismo </td><td>  601 </td><td>  Realismo analítico </td><td>  89 </td><td>  Verismo </td><td>  11 </td></tr><tr><td>  Manierismo </td><td>  544 </td><td>  Naturalismo </td><td>  73 </td><td>  Neo-primitivismo </td><td>  10 </td></tr><tr><td>  <strong>Modernismo</strong> </td><td>  539 </td><td>  Neo-modernismo </td><td>  70 </td><td>  <strong>Fantasía</strong> </td><td>  8 </td></tr><tr><td>  <strong>Realismo socialista</strong> </td><td>  481 </td><td>  Futurismo </td><td>  67 </td><td>  Metarealismo </td><td>  7 7 </td></tr><tr><td></td><td></td><td></td><td></td><td>  <strong><em>Total</em></strong> </td><td>  106284 </td></tr></tbody></table><br></div></div><br><p>  Nos enfrentamos a la tarea de clasificar imágenes, pero no podemos seleccionar ninguna característica simple manualmente.  Por lo tanto, utilizaremos el aprendizaje automático profundo, en el que características tan complejas se identifican automáticamente en el proceso de aprendizaje. </p><br><br><h1>  Transferencia de aprendizaje </h1><br><p>  Considere la red de inicio v3. </p><br><br><img src="https://habrastorage.org/webt/f3/pe/md/f3pemdvtfg6ryjjok5v1tr3ae6m.png" alt="Arquitectura general con salidas intermedias."><br><br><p>  En su arquitectura (y en cualquier otra red profunda), dos componentes principales se pueden distinguir condicionalmente: Feature Extractor y Predictor. <br><br>  Feature Extractor asigna la imagen de color de entrada en un espacio de características multidimensional (mapa de características multicanal).  El mapa de características almacena información espacial, es decir, es un tensor tridimensional con dimensiones para el ancho, la altura y el número de canales de características; la agrupación final aún no se ha aplicado aquí, lo que eliminará por completo la información sobre la posición relativa de las características en la imagen original.  La red Inception v3 Feature Extractor recibe 299 imágenes de entrada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.973ex" height="1.455ex" viewBox="0 -520.7 2571.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-73" x="2102" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ veces </script>  299 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.973ex" height="1.455ex" viewBox="0 -520.7 2571.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-73" x="2102" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ veces </script>  3, y en la salida forma un mapa de signos de tamaño 17 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.973ex" height="1.455ex" viewBox="0 -520.7 2571.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-73" x="2102" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ veces </script>  17 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.973ex" height="1.455ex" viewBox="0 -520.7 2571.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-65" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhhdCrFBdU43_t7miUY8c8Cy0fEOhA#MJMATHI-73" x="2102" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ veces </script>  2048. El tamaño de entrada puede variar, lo que conducirá a cambios en el tamaño del mapa de características y puede ser útil para reducir los costos computacionales cuando se trabaja con la red. <br><br>  Predictor es una red que genera resultados basados ​​en un mapa de características generado por Feature Extractor.  Como regla general, para la tarea de clasificación, Predictor es una capa de neuronas completamente conectada, cuyo número de salidas coincide con el número de clases del problema. <br><br>  El aprendizaje de transferencia clásico supone que tomamos una red capacitada, separamos Feature Extractor de ella y la complementamos con un nuevo predictor con la cantidad de clases que necesitamos.  La red resultante se entrena a baja velocidad con pesos parcial o completamente congelados de capas de Extractor de características. </p><br><p>  Aplicamos el aprendizaje de transferencia para clasificar estilos.  Tome la red Inception-v3 entrenada en un conjunto de datos imagenet y reemplace la capa de salida de neuronas en ella, que clasifica las imágenes de entrada en el número de estilos seleccionados.  Capacitamos a la red en imágenes de diferentes estilos, congelando la capacitación de todas las capas, excepto la última. </p><br><p>  Para el análisis de datos, mostramos la distribución del conjunto de validación por clase. <br><br><img src="https://habrastorage.org/webt/dj/rq/-9/djrq-9odlvd6uudi_9eofw7ufl4.jpeg"><br><br>  Cada fila corresponde a una clase del conjunto de validación.  El brillo de los cuadrados en la fila es proporcional al número de imágenes que caen en la clase correspondiente a la columna. <br><br>  Para mayor claridad, excluimos la diagonal principal y re-normalizamos los valores de cada fila. <br><br><img src="https://habrastorage.org/webt/tf/ch/oz/tfchozlbdfigafnapiq7dtbs53u.jpeg"><br><br>  Además, intentaremos mapear la distribución de estilos al espacio bidimensional usando TSNE. <br><br><img src="https://habrastorage.org/webt/v1/dq/bt/v1dqbtf7whkh1occcwdxp_cprcu.png"></p><br><p>  Se puede observar que se observan muchos errores, por ejemplo, en la clasificación de pinturas al estilo del fauvismo; una parte importante de ellas se refiere al expresionismo de la red.  El Renacimiento del Norte y el gótico a menudo se conocen como renacimiento.  Muchas imágenes del estilo rococó y el clasicismo se relacionan con el realismo.  El modernismo y la modernidad generalmente caen en muchos estilos. </p><br><p>  Después de lanzar un script simple que analizaba la base de datos de capacitación en carpetas de acuerdo con el estilo definido por la red, realizamos un análisis rápido de errores.  Resultó que el marcado de la base de datos al menos plantea preguntas. <br><br>  Muchas imágenes en el estilo del modernismo (que, aunque fue marcado por el cliente como obligatorio, pero en general no es un estilo, sino una tendencia en el arte en general), en realidad se duplicaron en otros estilos, especialmente en el modernismo (pero este ya es un estilo). </p><br><p>  En el estilo del realismo socialista, estaban presentes imágenes abstractas, por ejemplo, las obras de Lissitzky.  Lo más probable es que llegaron allí gracias al trabajo de Lissitzky en el cartel soviético, que tiene una relación muy indirecta con el realismo socialista. </p><br><p>  En muchos sentidos, estos son realmente errores, pero a veces la razón es la debatibilidad del tema de resaltar algunos estilos, especialmente modernos.  Vale la pena considerar que la base de datos está llena de varios usuarios, y entre ellos a veces no hay consenso. <br><br>  Los errores en los datos conducen a errores correspondientes en la clasificación de imágenes por la red.  En el proceso de limpieza de la base, tanto por nosotros como por el crítico de arte experto por parte del cliente, el margen de beneficio para la muestra de capacitación se mejoró significativamente. </p><br><p>  Sin embargo, el grueso de los errores de clasificación de la red (en total) se refiere a estilos más o menos bien establecidos, como el rococó, el clasicismo y el realismo.  La atribución de obras a estos estilos, por regla general, se lleva a cabo sobre la base de una época o autoría y, al parecer, no causa dudas ni disputas.  ¿Por qué la red no puede distinguir su estilo?  La razón principal radica en el uso de una red pre-entrenada para extraer rasgos. </p><br><p>  El hecho es que esta red fue entrenada para clasificar objetos, determinar qué se representa exactamente, al tiempo que descarta información que no es esencial para la tarea sobre cómo se representa.  Por ejemplo, desde el punto de vista de la red, en todas las imágenes al comienzo del artículo, en general, se representa a una persona. </p><br><p>  Para resolver este problema, creamos una red con salidas intermedias: se cree que los signos se vuelven más difíciles a medida que se mueven a lo largo de la red, y la información no esencial desaparece gradualmente.  Tratemos de extraer de las capas intermedias lo que no era esencial para la clasificación de imagenet. </p><br><br><img src="https://habrastorage.org/webt/yl/iw/ut/yliwutsxjouveu2g4k8ojxk7qwg.png" alt="Arquitectura general con salidas intermedias."><br><p>  Hay otro problema: gráficos, impresiones, bocetos.  En imagenet, en el que la red de inicio se entrenó previamente, simplemente no hay nada como esto, respectivamente, y las características resaltadas por la red no son adecuadas para clasificar tales imágenes. </p><br><br><table><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/hk/5c/sf/hk5csf3ivfa2yc8cperdjnrk50u.jpeg"><br></a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/1u/4b/ng/1u4bngyrvbacxvb-ue-7shvhkky.jpeg"><br></a> <br></td></tr><tr><td align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Realismo, Impresionismo.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Camille Carot, Agar y el ángel.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a> <br></td><td align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Barroco</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rembrandt Harmenszoon Van Rijn, Agar y el ángel</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a> <br></td></tr></tbody></table><br><p>  Por otro lado, las pinturas al estilo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ukiyo-e</a> , un tipo de grabado que se ha generalizado en Japón desde el siglo XVII, han colgado maravillosamente en una nube separada.  Aunque inicialmente no estaban en nuestra lista obligatoria, los agregamos allí. </p><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/ub/xz/fq/ubxzfqqe_iut0ljlbu1uab_0mey.jpeg" alt="Asakusa Rice Fields y Torinomachi Festival"><br></a> <br><br><p>  Después de trabajar con los datos, se logró una mejor distribución entre las clases. </p><br><h2>  Nos ocupamos de los géneros. </h2><br><p>  Del número total de géneros, se seleccionaron 13 (resaltados en negrita) </p><br><table><thead><tr><th>  Género </th><th>  cantidad </th></tr></thead><tbody><tr><td>  Escena alegórica </td><td>  2500 </td></tr><tr><td>  <strong>Retrato</strong> </td><td>  2308 </td></tr><tr><td>  <strong>Paisaje</strong> </td><td>  2213 </td></tr><tr><td>  Fantasía </td><td>  2191 </td></tr><tr><td>  Escena literaria </td><td>  2096 </td></tr><tr><td>  <strong>Paisaje de la ciudad</strong> </td><td>  2048 </td></tr><tr><td>  <strong>Desnudo</strong> </td><td>  1981 </td></tr><tr><td>  <strong>Bodegón</strong> </td><td>  1932 </td></tr><tr><td>  <strong>Escena de género</strong> </td><td>  1736 </td></tr><tr><td>  <strong>Animalismo</strong> </td><td>  1587 </td></tr><tr><td>  Escena religiosa </td><td>  1417 </td></tr><tr><td>  Escena mitológica </td><td>  1368 </td></tr><tr><td>  <strong>Marina</strong> </td><td>  1210 </td></tr><tr><td>  Arquitectura </td><td>  958 </td></tr><tr><td>  <strong>El interior</strong> </td><td>  635 </td></tr><tr><td>  Escena historica </td><td>  534 </td></tr><tr><td>  <strong>Escena de batalla</strong> </td><td>  201 </td></tr><tr><td>  <strong>Zakli</strong> </td><td>  180 </td></tr><tr><td>  <strong>Veduta</strong> </td><td>  124 </td></tr><tr><td>  Paisaje urbano </td><td>  16 </td></tr><tr><td>  <strong><em>Total</em></strong> </td><td>  27235 </td></tr></tbody></table><br><p>  Básicamente, la reducción en el número de géneros se logró reduciendo los géneros de varias escenas: "religiosa", "mitológica", "alegórica", "literaria" y combinándolas bajo el nombre general de "escena de género".  Llegamos a la conclusión de que la separación de estos géneros difícilmente se puede realizar con suficiente precisión sin un análisis cultural significativo. <br><br>  Por ejemplo, para una escena alegórica, por definición se supone que hay un significado oculto en la imagen, el uso de significados figurativos en los objetos representados.  También hay una dificultad con la "escena religiosa": es muy probable que una red entrenada para emitir tal clase también los llame imágenes de caricatura (por ejemplo, parodiando la Última Cena de Da Vinci), y esto puede ofender a alguien . </p><br><p>  El marcado de datos por género inicialmente parece ser bueno, excepto por varios géneros para los cuales hay pocas imágenes en la base de datos.  Al buscar en Internet, pudimos ampliar ligeramente la cantidad de imágenes en géneros (principalmente la escena de batalla, garzas y vedutas). <br>  Después de combinar géneros difíciles en una "escena de género" común, inmediatamente tratamos de entrenar la red "en la frente" usando redes de aprendizaje de transferencia. </p><br><p><img src="https://habrastorage.org/webt/tk/af/n4/tkafn43bprvet-oqzwi-2sg4t60.jpeg" alt="Géneros, Resultado 1"></p><br><p>  Se puede ver que los puntos correspondientes a imágenes de diferentes géneros se mezclan.  Para estas imágenes, la red proporciona valores altos de las probabilidades de pertenecer a varios géneros a la vez, y el género con la probabilidad más alta se determina casi por accidente.  Aparentemente, la razón es que los géneros, a diferencia de los estilos, tienen una jerarquía más pronunciada.  Intentamos entender estas conexiones, obtuvimos ese mapa de géneros: </p><br><p> <a href=""><br><img src="https://habrastorage.org/webt/wj/up/d4/wjupd4h-6mczoz_zo39rqscslpe.jpeg" alt="Jerarquía de géneros"></a> </p><br><p>  Los géneros de jerarquía subsidiaria y parental a menudo tienen características comunes desde el punto de vista de la red (y también desde nuestro punto de vista).  Por ejemplo, la escena de batalla en la tierra en su conjunto tiene las mismas características que el paisaje habitual: la imagen de una gran área abierta o ciudad, y la escena de batalla en el mar es más como el género del puerto deportivo.  Por lo tanto, dividimos el género de la escena de batalla en dos: en tierra y en el mar.  Otro ejemplo: los retratos, una escena de género y las imágenes de desnudos desde el punto de vista de una red preformada tienen un signo común: la presencia de personas. </p><br><p>  En la base de datos, las imágenes de contenido similar a menudo se refieren al género infantil o al padre, dependiendo de dónde fue determinado por el experto que trajo las imágenes a la base de datos.  En este sentido, se llevó a cabo una limpieza a gran escala y una nueva división de la base teniendo en cuenta la posible jerarquía de géneros, lo que requirió mucho esfuerzo (logramos automatizarlo, pero no mucho). </p><br><p>  Para transferir la jerarquía de géneros a la red, abandonamos el envío directo y configuramos la unidad para imágenes no solo en un género, sino también en su padre, si lo hay, y también reemplazamos la función objetivo del proceso de aprendizaje y la función de activar la capa de salida .  Por lo tanto, la tarea se convirtió en clasificación Multilabel (la imagen de entrada puede pertenecer a varias clases). </p><br><p><img src="https://habrastorage.org/webt/0k/k9/fo/0kk9foqusebcdte0pcmm11nw0ya.jpeg"></p><br><p>  Nos parece que falta otro género aquí: la abstracción.  Estrictamente hablando, este no es un género.  Al menos los expertos insistieron en que no existía ese género.  Para evitar que la red ofrezca respuestas aleatorias a imágenes abstractas, se agregó una más al desglose general de los géneros con el nombre "no se pudo determinar", incluidas las imágenes abstractas y controvertidas. </p><br><h2>  En lugar de una conclusión </h2><br><p>  En general, fue posible lograr una precisión satisfactoria en la clasificación de estilos y géneros de imágenes, pero hay mucho que mejorar. </p><br><p>  Desafortunadamente, la clasificación de estilos y técnicas no se finalizó, el soporte no se implementó en el servicio. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422357/">https://habr.com/ru/post/es422357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422339/index.html">"Creo que JavaScript no es adecuado para la web". 10 preguntas para el programador, 4 lanzamientos (desde Berlín)</a></li>
<li><a href="../es422341/index.html">IoT: promueve mientras otros piensan</a></li>
<li><a href="../es422345/index.html">Servidor en las nubes: resumen del proyecto</a></li>
<li><a href="../es422351/index.html">Ejecución remota de código cargando imágenes en su servidor o computadora local en ghostscript / imagick</a></li>
<li><a href="../es422353/index.html">Instrucciones de la API de detección de objetos TensorFlow</a></li>
<li><a href="../es422359/index.html">Los resultados de la búsqueda por la que pasaste. O no</a></li>
<li><a href="../es422361/index.html">Síndrome corporativo</a></li>
<li><a href="../es422363/index.html">Conferencia PyCon Rusia 2018: video de todos los informes y presentaciones</a></li>
<li><a href="../es422365/index.html">Yandex presentó una queja contra una decisión judicial de eliminar enlaces a contenido pirateado</a></li>
<li><a href="../es422367/index.html">Cómo restaurar videos para Full Throttle Remastered. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>