<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ค๐พ ๐ ูุชุงุจ "ุงูุดุฑุงุฑุฉ ุงููุนุงูุฉ. ุงูุชูุณุน ูุงูุชุญุณูู " ๐๐ฝ ๐ต ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐุง ุงูููุดูุฑ ุ ุณููุธุฑ ูู ุงููุตูู ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Spark ูู ูุบุงุช ุจุฑูุฌุฉ ูุฎุชููุฉ ูู JVM ุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ูุดููุงุช ุงูุฃุฏุงุก ุนูุฏ ุชุฌุงูุฒ ูุบุฉ Scala. ุญุชู ุฅ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุชุงุจ "ุงูุดุฑุงุฑุฉ ุงููุนุงูุฉ. ุงูุชูุณุน ูุงูุชุญุณูู "</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/414525/" style=";text-align:right;direction:rtl"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/g1/uu/lu/g1uulu2edgzcixecswin9lfylnc.jpeg" align="left" alt="ุงูุตูุฑุฉ"></a>  ูู ูุฐุง ุงูููุดูุฑ ุ ุณููุธุฑ ูู ุงููุตูู ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Spark ูู ูุบุงุช ุจุฑูุฌุฉ ูุฎุชููุฉ ูู JVM ุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ูุดููุงุช ุงูุฃุฏุงุก ุนูุฏ ุชุฌุงูุฒ ูุบุฉ Scala.  ุญุชู ุฅุฐุง ููุช ุชุนูู ุฎุงุฑุฌ JVM ุ ููุฏ ูููู ูุฐุง ุงููุณู ูููุฏูุง ุ ูุธุฑูุง ูุฃู ุงููุบุงุช ุบูุฑ JVM ุบุงูุจูุง ูุง ุชุนุชูุฏ ุนูู Java API ุ ูููุณ ุนูู Scala API. <br><br>  ูุง ูุนูู ุงูุนูู ุจูุบุงุช ุจุฑูุฌุฉ ุฃุฎุฑู ุฏุงุฆููุง ุฃูู ุจุญุงุฌุฉ ุฅูู ุชุฌุงูุฒ JVM ุ ูุงูุนูู ูู JVM ูู ูุฒุงูุง ุนุฏูุฏุฉ ูู ุญูุซ ุงูุฃุฏุงุก - ููุฑุฌุน ุฐูู ุฃุณุงุณูุง ุฅูู ุฃูู ูุณุช ุจุญุงุฌุฉ ุฅูู ูุณุฎ ุงูุจูุงูุงุช.  ุนูู ุงูุฑุบู ูู ุฃูู ููุณ ูู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู ููุชุจุงุช ุฃู ูุญููุงุช ุฑุจุท ุฎุงุตุฉ ูููุตูู ุฅูู Spark ูู ุฎุงุฑุฌ ูุบุฉ Scala ุ ุฅูุง ุฃู ุงุณุชุฏุนุงุก ููุฏ Scala ูู ูุบุงุช ุงูุจุฑูุฌุฉ ุงูุฃุฎุฑู ูุฏ ูููู ุตุนุจูุง.  ูุฏุนู ุฅุทุงุฑ ุนูู Spark ุงุณุชุฎุฏุงู Java 8 ูู ุชุนุจูุฑุงุช lambda ุ ูุฃููุฆู ุงูุฐูู ูุณุชุฎุฏููู ุฅุตุฏุงุฑุงุช ูุฏููุฉ ูู JDK ูุฏููู ุงููุฑุตุฉ ูุชุทุจูู ุงููุงุฌูุฉ ุงูููุงุณุจุฉ ูู ุญุฒูุฉ org.apache.spark.api.java.function.  ุญุชู ูู ุงูุญุงูุงุช ุงูุชู ูุง ุชุญุชุงุฌ ูููุง ุฅูู ูุณุฎ ุงูุจูุงูุงุช ุ ูุฏ ูููู ููุนูู ุจูุบุฉ ุจุฑูุฌุฉ ุฃุฎุฑู ูุฑูู ุฏูููุฉ ุตุบูุฑุฉ ูููููุง ูููุฉ ุชุชุนูู ุจุงูุฃุฏุงุก. <br><a name="habracut"></a><br>  ุชุธูุฑ ุงูุตุนูุจุงุช ูู ุงููุตูู ุฅูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Scala ุงููุฎุชููุฉ ุจุดูู ุฎุงุต ุนูุฏ ุงุณุชุฏุนุงุก ูุธุงุฆู ุจุงุณุชุฎุฏุงู ุนูุงูุงุช ุงููุฆุฉ ุฃู ุนูุฏ ุงุณุชุฎุฏุงู ุงูุฎุตุงุฆุต ุงูููุฏูุฉ ุจุงุณุชุฎุฏุงู ุชุญูููุงุช ุงูููุน ุงูุถูููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ุฌููุน ูุธุงุฆู ูุฌููุนุงุช RDD ุงููุชุนููุฉ ุจุงููุฆุชูู ุงููุฒุฏูุฌุฉ ู Tuple).  ุจุงููุณุจุฉ ููุขููุงุช ุงูุชู ุชุนุชูุฏ ุนูู ุชุญูููุงุช ุงูููุน ุงูุถูููุฉ ุ ุบุงูุจูุง ูุง ูุชู ุชูููุฑ ูุฆุงุช ููููุณุฉ ููุงูุฆุฉ ูุน ุชุญูููุงุช ุตุฑูุญุฉ ููุง.  ูููู ุชูุฑูุฑ ุนูุงูุงุช ูุฆุฉ ููููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ AnyRef) ุฅูู ุงููุธุงุฆู ุงูุชู ุชุนุชูุฏ ุนูู ุนูุงูุงุช ุงููุฆุฉ (ุบุงูุจูุง ูุง ุชููู ุงููุญููุงุช ุจุฐูู ุชููุงุฆููุง.  ุนุงุฏุฉู ูุง ูุคุฏู ุงุณุชุฎุฏุงู ูุฆุงุช ูุนููุฉ ุจุฏูุงู ูู ุชุญูููุงุช ุงูููุน ุงูุถูููุฉ ุฅูู ุฒูุงุฏุฉ ูู ุงูุญูู ุ ูููู ูููู ุฃู ุชูุฑุถ ุนูุงูุงุช ุงููุฆุฉ ุงูููููุฉ ูููุฏูุง ุนูู ุจุนุถ ุชุญุณููุงุช ุงููุชุฑุฌู. <br><br>  ูุง ุชุฎุชูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Java ูุซูุฑูุง ุนู Scala API ูู ุญูุซ ุงูุฎุตุงุฆุต ุ ููู ุจุนุถ ุงูุฃุญูุงู ุชููู ุจุนุถ ุงููุธุงุฆู ุฃู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช ุงููุทูุฑ ููููุฏุฉ.  ูุชู ุฏุนู ูุบุงุช ุจุฑูุฌุฉ JVM ุงูุฃุฎุฑู ุ ูุซู ูุบุฉ Clojure ูุน DSL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Flambo</a> ูุงูููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑุงูุฉ</a> ุ ุจุงุณุชุฎุฏุงู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Java ูุฎุชููุฉ ุจุฏูุงู ูู ุงุณุชุฏุนุงุก Scala API ูุจุงุดุฑุฉ.  ูุธุฑูุง ูุฃู ูุนุธู ุฑูุงุจุท ุงููุบุงุช ุ ุญุชู ุงููุบุงุช ุบูุฑ JVM ูุซู Python ู R ุ ุชูุฑ ุนุจุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Java</a> ุ ุณูููู ูู ุงููููุฏ ุงูุชุนุงูู ูุนูุง. <br><br>  ุชุชุดุงุจู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Java ุฅูู ุญุฏ ูุจูุฑ ูุน ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Scala ุ ุนูู ุงูุฑุบู ูู ุฃููุง ูุณุชููุฉ ุนู ุนูุงูุงุช ุงููุฆุฉ ูุงูุชุญูููุงุช ุงูุถูููุฉ.  ูุนูู ุบูุงุจ ูุฐุง ุงูุฃุฎูุฑ ุฃูู ุจุฏูุงู ูู ุชุญููู ูุฌููุนุงุช RDD ุชููุงุฆููุง ูู ูุงุฆูุงุช Tuple ุฃู ูุฒุฏูุฌุฉ ุฅูู ูุฆุงุช ุฎุงุตุฉ ูุน ูุธุงุฆู ุฅุถุงููุฉ ุ ูุฌุจ ุนููู ุงุณุชุฎุฏุงู ูุธุงุฆู ุชุญููู ุงูููุน ุงูุตุฑูุญ (ุนูู ุณุจูู ุงููุซุงู ุ mapToDouble ุฃู mapToPair).  ูุชู ุชุญุฏูุฏ ุงููุธุงุฆู ุงููุญุฏุฏุฉ ููุท ููุฌููุนุงุช Java RDD ุ  ูุญุณู ุงูุญุธ ูู ุฃุฌู ุงูุชูุงูู ุ ูุฐู ุงูุฃููุงุน ุงูุฎุงุตุฉ ูู ูุฌุฑุฏ ูุญููุงุช ููุฌููุนุงุช Scala RDD.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุฑุฌุน ูุฐู ุงููุธุงุฆู ุงูุฎุงุตุฉ ุฃููุงุนูุง ูุฎุชููุฉ ูู ุงูุจูุงูุงุช ุ ูุซู JavaDoubleRDD ู JavaPairRDD ุ ูุน ุงูููุฒุงุช ุงูุชู ุชููุฑูุง ุชุญูููุงุช ูุบุฉ Scala ุงูุถูููุฉ. <br><br>  ุฏุนูุง ููุชูู ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููุซุงู ุงููุชุนุงุฑู ุนููู ูุนุฏ ุงููููุงุช ุจุงุณุชุฎุฏุงู Java API (ูุซุงู 7.1).  ูุธุฑูุง ูุฃู ุงุณุชุฏุนุงุก Scala API ูู Java ูุฏ ูููู ุฃูุฑูุง ุตุนุจูุง ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุฅู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Java ูุฅุทุงุฑ ุนูู Spark ูุชู ุชูููุฐูุง ุชูุฑูุจูุง ูู ูุบุฉ Scala ูุน ุนูุงูุงุช ูุฆุฉ ูุฎููุฉ ูุชุญูููุงุช ุถูููุฉ.  ูุจุณุจุจ ูุฐุง ุ ูุฅู ูุญููุงุช Java ูู ุทุจูุฉ ุฑูููุฉ ุฌุฏูุง ุ ูู ุงููุชูุณุท โโุชุชููู ูู ุจุถุนุฉ ุฃุณุทุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุฅุนุงุฏุฉ ูุชุงุจุชูุง ุจุฏูู ุฌูุฏ ุชูุฑูุจูุง. <br><br>  ูุซุงู 7.1  ุนุฏ ุงููููุงุช (ุฌุงูุง) <br><br><pre style=";text-align:right;direction:rtl"><code class="hljs actionscript"><span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> scala.Tuple2;</span></span>  <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.apache.spark.api.java.JavaRDD;</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.apache.spark.api.java.JavaPairRDD </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> org.apache.spark.api.java.JavaSparkContext;</span></span>  <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> java.util.regex.Pattern;</span></span> <span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> java.util.Arrays;</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WordCount</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pattern pattern = Pattern.compile(<span class="hljs-string"><span class="hljs-string">" "</span></span>);  <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> main(String[] args) throws Exception { JavaSparkContext jsc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JavaSparkContext(); JavaRDD&lt;String&gt; lines = jsc.textFile(args[<span class="hljs-number"><span class="hljs-number">0</span></span>]); JavaRDD&lt;String&gt; words = lines.flatMap(e -&gt; Arrays.asList(                                           pattern.split(e)).iterator()); JavaPairRDD&lt;String, Integer&gt; wordsIntial = words.mapToPair(  e -&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tuple2&lt;String, Integer&gt;(e, <span class="hljs-number"><span class="hljs-number">1</span></span>));   } }</code> </pre> <br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุฏ ุชุญุชุงุฌ ุฅูู ุชุญููู ุฌุงูุง RDDs ุฅูู Scala RDDs ุฃู ุงูุนูุณ.  ุบุงูุจูุง ูุง ูููู ูุฐุง ูุทููุจูุง ููููุชุจุงุช ุงูุชู ุชุชุทูุจ ุฅุฏุฎุงู ุฃู ุฅุนุงุฏุฉ ูุฌููุนุงุช Scala RDD ุ ูููู ูู ุจุนุถ ุงูุฃุญูุงู ูุฏ ูุง ุชููู ุฎุตุงุฆุต Spark ุงูุฃุณุงุณูุฉ ูุชุงุญุฉ ุจุนุฏ ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Java.  ูุนุฏ ุชุญููู RDDs ุฅูู Java ุฅูู Scala RDDs ุฃุณูู ุทุฑููุฉ ูุงุณุชุฎุฏุงู ูุฐู ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ. <br><br>  ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ููู ูุฌููุนุฉ Java RDD ุฅูู ููุชุจุฉ Scala ุ ูุงูุชู ุชุชููุน ูุฌูุฏ RDD Spark ุนุงุฏู ุนูุฏ ุงูุฅุฏุฎุงู ุ ููููู ุงููุตูู ุฅูู Scala RDD ุงูุฃุณุงุณู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ rdd ().  ุบุงูุจูุง ูุง ูููู ูุฐุง ูุงูููุง ูููู RDD ุงูููุงุฆู ุฅูู ุฃู ููุชุจุฉ Scala ูุทููุจุฉ ุ  ูู ุจูู ุงูุงุณุชุซูุงุกุงุช ุงูุจุงุฑุฒุฉ ูู ููุชุจุงุช Scala ุ ุงูุชู ุชุนุชูุฏ ุนูู ุงูุชุญูููุงุช ุงูุถูููุฉ ูุฃููุงุน ุฃููุงุน ุฃููุงุน ุงููุญุชูู ุฃู ูุนูููุงุช ุนูุงูุงุช ุงูุตู ูู ุนูููุง.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฅู ุฃุณูู ุทุฑููุฉ ูููุตูู ุฅูู ุงูุชุญูููุงุช ุงูุถูููุฉ ูู ูุชุงุจุฉ ูุญูู ุตุบูุฑ ูู Scala.  ุฅุฐุง ูุงู ูุง ูููู ุงุณุชุฎุฏุงู ุงูุฃุตุฏุงู Scala ุ ูููููู ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงูููุงุจูุฉ ููุฆุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">JavaConverters</a> ูุชุดููู ุนูุงูุฉ ูุฆุฉ ููููุฉ. <br><br>  ูุฅูุดุงุก ุนูุงูุฉ ูุฆุฉ ููููุฉ ุ ููููู ุงุณุชุฎุฏุงู ุทุฑููุฉ scala.reflect.ClassTag $ .MODULE $ .AnyRef () ุฃู ุงูุญุตูู ุนูู ุงูุนูุงูุฉ ุงูุญููููุฉ ุจุงุณุชุฎุฏุงู scala.reflect.ClassTag $ .MODULE $ .apply (CLASS) ุ ููุง ูู ููุถุญ ูู ุงูุฃูุซูุฉ 7.2 ู 7.3. <br><br>  ููุชุญููู ูู Scala RDD ุฅูู RDD Java ุ ุบุงูุจูุง ูุง ุชููู ูุนูููุงุช ุนูุงูุฉ ุงููุตู ุฃูุซุฑ ุฃูููุฉ ูู ูุนุธู ููุชุจุงุช Spark.  ูุงูุณุจุจ ูู ุฃูู ุนูู ุงูุฑุบู ูู ุฃู ูุฆุงุช JavaRDD ุงููุฎุชููุฉ ุชููุฑ ููุดุฆูู ูููู ุงููุตูู ุฅูููู ุจุดูู ุนุงู ูุฃุฎุฐูู Scala RDD ููุณูุทุงุช ุ ุฅูุง ุฃููู ููุตุฏูู ุงุณุชุฏุนุงุคูู ูู ููุฏ Scala ุ ูุจุงูุชุงูู ูุชุทูุจูู ูุนูููุงุช ุญูู ุนูุงูุฉ ุงููุฆุฉ. <br><br>  ุบุงูุจูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุนูุงูุงุช ูุฆุฉ ููููุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุนุงูุฉ ุฃู ุงููุงูุจ ุ ุญูุซ ุชููู ุงูุฃููุงุน ุงูุฏูููุฉ ุบูุฑ ูุนุฑููุฉ ูู ููุช ุงูุชุฑุฌูุฉ.  ุบุงูุจูุง ูุง ุชููู ูุฐู ุงูุนูุงูุงุช ูุงููุฉ ุ ุนูู ุงูุฑุบู ูู ูุฌูุฏ ุงุญุชูุงู ูููุฏุงู ุจุนุถ ุงููุฑูู ุงูุฏูููุฉ ุนูู ุฌุงูุจ ุฑูุฒ Scala ุ  ูู ุญุงูุงุช ูุงุฏุฑุฉ ุฌุฏูุง ุ ูุชุทูุจ ุฑูุฒ Scala ูุนูููุงุช ุฏูููุฉ ูุนูุงูุงุช ุงููุฆุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ุนููู ุงุณุชุฎุฏุงู ุนูุงูุฉ ุญููููุฉ.  ูู ูุนุธู ุงูุญุงูุงุช ุ ูุง ูุชุทูุจ ูุฐุง ุงููุซูุฑ ูู ุงูุฌูุฏ ููุญุณู ุงูุฃุฏุงุก ุ ูุฐุง ุญุงูู ุงุณุชุฎุฏุงู ูุฐู ุงูุนูุงูุงุช ุญูุซูุง ุฃููู. <br><br>  ูุซุงู 7.2.  ุฌุนู ุฌุงูุง / ุณูุงูุง RDD ูุชูุงูู ูุน ุนูุงูุฉ ูุฆุฉ ููููุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static JavaPairRDD wrapPairRDDFakeCt( RDD&lt;Tuple2&lt;String, <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>&gt;&gt; RDD) { //       AnyRef โ   //        , //        , //        //    ClassTag&lt;<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>&gt; fake = ClassTag$.MODULE$.AnyRef(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> JavaPairRDD(rdd, fake, fake); }</code> </pre> <br>  ูุซุงู 7.3.  ุถูุงู ุชูุงูู Java / Scala RDD <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">public static JavaPairRDD wrapPairRDD( RDD&lt;Tuple2&lt;String, Object<span class="hljs-meta"><span class="hljs-meta">&gt;&gt; </span></span>RDD) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    ClassTag&lt;String&gt; strCt = ClassTag$.MODULE$.apply(String.class); ClassTag&lt;Long&gt; longCt = ClassTag$.MODULE$.apply(scala.Long.class); return new JavaPairRDD(rdd, strCt, longCt); }</code> </pre> <br>  ูู ูู Spark SQL ู API ูุฎุทูุท ุงูุฃูุงุจูุจ ML ูุงูุช ูู ูุนุธููุง ูุชูุงุณูุฉ ูู Java ู Scala.  ููุน ุฐูู ุ ุชูุฌุฏ ูุธุงุฆู ุงููุณุงุนุฏ ุงูุฎุงุตุฉ ุจู Java ุ ููุง ูุณูู ุงุณุชุฏุนุงุก ูุธุงุฆู Scala ุงูููุงูุฆุฉ ููุง.  ูููุง ููู ุฃูุซูุฉูู: ูุธุงุฆู ุนุฏุฏูุฉ ูุฎุชููุฉ ุ ูุซู ุงูุฌูุน ูุงูุทุฑุญ ุ ููุง ุฅูู ุฐูู ุ ููุฆุฉ ุงูุนููุฏ.  ูู ุงูุตุนุจ ุงุณุชุฏุนุงุก ููุงูุฆุงุชูุง ุงูุฒุงุฆุฏุฉ ูู ูุบุฉ ุณูุงูุง (+ ุ -).  ุจุฏูุงู ูู ุงุณุชุฎุฏุงู JavaDataFrame ู JavaSQLContext ุ ูุชู ุชูููุฑ ุงูุทุฑู ุงููุทููุจุฉ ูู Java ูู SQLContext ููุฌููุนุงุช DataFrame ุงูุนุงุฏูุฉ.  ูุฏ ูุฑุจูู ูุฐุง ุ ูุฃู ุจุนุถ ุงูุทุฑู ุงููุฐููุฑุฉ ูู ูุซุงุฆู Java ูุง ูููู ุงุณุชุฎุฏุงููุง ูู ููุฏ Java ุ ูููู ูู ูุซู ูุฐู ุงูุญุงูุงุช ูุชู ุชูููุฑ ูุธุงุฆู ุจููุณ ุงูุฃุณูุงุก ููุงุชุตุงู ูู Java. <br><br>  ุงููุธุงุฆู ุงููุนุฑูุฉ ูู ูุจู ุงููุณุชุฎุฏู (UDFs) ูู ูุบุฉ Java ุ ูููุฐุง ุงูุณุจุจ ุ ูู ูุนุธู ุงููุบุงุช ุงูุฃุฎุฑู ุจุงุณุชุซูุงุก Scala ุ ุชุชุทูุจ ุชุญุฏูุฏ ููุน ุงููููุฉ ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ ุงููุธููุฉ ุ ุญูุซ ูุง ูููู ุงุณุชูุชุงุฌูุง ููุทูููุง ุ ุนูู ุบุฑุงุฑ ููููุฉ ุชูููุฐูุง ูู Scala (ูุซุงู 7.4) . <br><br>  ูุซุงู 7.4.  ุนููุฉ UDF ูุฌุงูุง <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">sqlContext</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.udf</span></span>() <span class="hljs-selector-class"><span class="hljs-selector-class">.register</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">strlen</span></span>", (<span class="hljs-selector-tag"><span class="hljs-selector-tag">String</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>&gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">s</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.length</span></span>(), <span class="hljs-selector-tag"><span class="hljs-selector-tag">DataTypes</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.StringType</span></span>);</code> </pre> <br>  ุนูู ุงูุฑุบู ูู ุฃู ุงูุฃููุงุน ุงููุทููุจุฉ ูู ูุจู Scala ู Java APIs ูุฎุชููุฉ ุ ูุฅู ุงูุชูุงู ุฃููุงุน ูุฌููุนุงุช Java ูุง ูุชุทูุจ ูุณุฎูุง ุฅุถุงูููุง.  ูู ุญุงูุฉ ุงูุชูุฑุงุฑุงุช ุ ูุชู ุฅุฌุฑุงุก ุชุญููู ุงูููุน ุงููุทููุจ ูููุญูู ุจุทุฑููุฉ ูุชุฃุฎุฑุฉ ุนูุฏ ุงููุตูู ุฅูู ุงูุนูุงุตุฑ ุ ููุง ูุณูุญ ูุฅุทุงุฑ ุนูู Spark ุจุชูุฑูุบ ุงูุจูุงูุงุช ุฅุฐุง ูุฒู ุงูุฃูุฑ (ููุง ูู ููุถุญ ูู ูุณู "ุชูููุฐ ุชุญูููุงุช ุงูููุฑุฑ - ุงูููุฑุฑ ุจุงุณุชุฎุฏุงู ูุธููุฉ mapPartitions" ูู ุงูุตูุญุฉ 121).  ูุฐุง ููู ููุบุงูุฉ ูุฃูู ุจุงููุณุจุฉ ููุนุฏูุฏ ูู ุงูุนูููุงุช ุงูุจุณูุทุฉ ุ ูุฏ ุชููู ุชูููุฉ ูุณุฎ ุงูุจูุงูุงุช ุฃุนูู ูู ุชูููุฉ ุงูุญุณุงุจ ููุณู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุง ุจุนุฏ ุณูุงูุง ู JVM </h3><br>  ุฅุฐุง ูู ุชูุชุตุฑ ุนูู JVM ุ ูุณูุฒุฏุงุฏ ุนุฏุฏ ูุบุงุช ุงูุจุฑูุฌุฉ ุงููุชุงุญุฉ ููุนูู ุจุดูู ูุจูุฑ.  ููุน ุฐูู ุ ูุน ุจููุฉ Spark ุงูุญุงููุฉ ุ ูููู ุฃู ูุคุฏู ุงูุนูู ุฎุงุฑุฌ JVM - ุฎุงุตุฉ ูู ุนูุฏ ุงูุนูู - ุฅูู ุฒูุงุฏุงุช ูุจูุฑุฉ ูู ุงูุชูููุฉ ุจุณุจุจ ูุณุฎ ุงูุจูุงูุงุช ูู ุนูุฏ ุงูุนูู ุจูู JVM ูุฑูุฒ ุงููุบุฉ ุงููุฏู.  ูู ุงูุนูููุงุช ุงููุนูุฏุฉ ุ ุชููู ุญุตุฉ ุชูููุฉ ูุณุฎ ุงูุจูุงูุงุช ุตุบูุฑุฉ ูุณุจููุง ุ ูููู ูู ุงูุนูููุงุช ุงูุจุณูุทุฉ ูููู ุฃู ุชุคุฏู ุจุณูููุฉ ุฅูู ูุถุงุนูุฉ ุงูุชูููุฉ ุงูุญุณุงุจูุฉ ุงูุฅุฌูุงููุฉ. <br><br>  ุฃูู ูุบุฉ ุจุฑูุฌุฉ ุบูุฑ JVM ูุฏุนููุฉ ูุจุงุดุฑุฉ ุฎุงุฑุฌ Spark ูู Python ุ ูุฃุตุจุญุช ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุงููุงุฌูุฉ ุงูุฎุงุตุฉ ุจูุง ูู ุงููููุฐุฌ ุงูุฐู ุชุนุชูุฏ ุนููู ุชุทุจููุงุช ูุบุงุช ุงูุจุฑูุฌุฉ ุงูุฃุฎุฑู ุบูุฑ JVM. <br><br><h3 style=";text-align:right;direction:rtl">  ููู ูุนูู PySpark </h3><br>  ูุชุตู PySpark ุจู JVM Spark ุจุงุณุชุฎุฏุงู ูุฒูุฌ ูู ุงููููุงุช ุนูู ุงูุนูุงู ู Py4J ุ ููู ููุชุจุฉ ูุชุฎุตุตุฉ ุชููุฑ ุชูุงุนู Python / Java ุ ุนูู ุงูุณุงุฆู.  ุชุญุช ูุฐุง ุ ูููููุฉ ุงูุฃููู ุ ุชุฎูู ุงูุนูุงุฑุฉ ุงูุจุณูุทุฉ ุงููุซูุฑ ูู ุงููุฑูู ุงูุฏูููุฉ ุงููุนูุฏุฉ ุ ุจูุถููุง ูุนูู PySpark ุ ููุง ูู ููุถุญ ูู ุงูุดูู.  7.1.  ุฅุญุฏู ุงููุดุงูู ุงูุฑุฆูุณูุฉ: ุญุชู ุนูุฏูุง ูุชู ูุณุฎ ุงูุจูุงูุงุช ูู ุนุงูู Python ุฅูู JVM ุ ูุฅูู ููุณ ูู ุงูุดูู ุงูุฐู ูููู ููุฌูุงุฒ ุงูุธุงูุฑู ุชุญูููู ุจุณูููุฉ.  ููุฒู ุจุฐู ุฌููุฏ ุฎุงุตุฉ ูู ุฌุงูุจ ูู ูู ุนุงูู Python ู Java ูุถูุงู ุฃู JVM ูุฏูู ูุนูููุงุช ูุงููุฉ ูุนูููุงุช ูุซู ุงูุชูุณูู. <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/10/ez/wf/10ezwfv-1jvl1gxwsansnexwvj4.png" alt="ุงูุตูุฑุฉ"></div><br><h3 style=";text-align:right;direction:rtl">  ุฃุทูู PySpark RDD </h3><br>  ุชุนุชุจุฑ ุชูููุฉ ุงูููุงุฑุฏ ุงููุงุฒูุฉ ูููู ุงูุจูุงูุงุช ูู ูุฅูู JVM ุ ููุฐูู ูุชุดุบูู ูููุฐ Python ุงูุชูููุฐู ุ ูุจูุฑุฉ.  ููููู ุชุฌูุจ ุงูุนุฏูุฏ ูู ูุดููุงุช ุงูุฃุฏุงุก ูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช PySpark RDD Suite ุจุงุณุชุฎุฏุงู ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช DataFrame / Dataset ุ ูุฃู ุงูุจูุงูุงุช ุชุจูู ูู JVM ูุฃุทูู ูุชุฑุฉ ููููุฉ. <br><br>  ูุชู ูุณุฎ ุงูุจูุงูุงุช ูู JVM ุฅูู Python ุจุงุณุชุฎุฏุงู ุงูููุงุจุณ ูุงูุจุงูุชุงุช ุงููุชุณูุณูุฉ.  ูุชููุฑ ุฅุตุฏุงุฑ ุฃูุซุฑ ุนููููุฉ ููุชูุงุนู ูุน ุงูุจุฑุงูุฌ ุจูุบุงุช ุฃุฎุฑู ูู ุฎูุงู ูุงุฌูุฉ PipedRDD ุ ููุธูุฑ ุชุทุจููู ูู ุงููุณู ุงููุฑุนู "ุงุณุชุฎุฏุงู ุงูุฃูุจูุจ". <br><br>  ุณูููู ุชูุธูู ูููุงุช ุชุจุงุฏู ุงูุจูุงูุงุช (ูู ุงุชุฌุงููู) ูููููุง ููุบุงูุฉ.  ูุชูุฌุฉ ูุฐูู ุ ูููู PySpark ุจุชูุธูู (ุฅู ุฃููู) ุฎุท ุฃูุงุจูุจ ุชุญููู Python ุฏุงุฎู ูุชุฑุฌู Python ุ ูุชุณูุณู ุนูููุฉ ุงูุชุตููุฉ ุ ูุจุนุฏูุง ุงูุฎุฑูุทุฉ ุ ุนูู ููุฑุฑ ูุงุฆู Python ุจุงุณุชุฎุฏุงู ูุฆุฉ PipelinedRDD ุงููุชุฎุตุตุฉ.  ุญุชู ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุชุจุฏูู ุงูุจูุงูุงุช ููุง ูููู PySpark ูุงุฏุฑูุง ุนูู ุฑุจุท ุงูุชุญูููุงุช ูู ุขูุฉ ุงูุชุฑุงุถูุฉ ููุนุงูู ุงููุฑุฏู ุ ููููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุชุฑุฌู Python ุ ูุจุงูุชุงูู ูุฅู ุชูููุฉ ุจุฏุก ุชุดุบูู ุงููุชุฑุฌู ูู ุชุชุจุงุทุฃ ุฃูุซุฑ. <br><br>  ูุฐุง ููุณ ุณูู ุฌุฒุก ูู ุงููุบุฒ.  ุชุนูู ุฃูุฑุงุต PipedRDD ุงูุนุงุฏูุฉ ูุน ููุน ุงูุณูุณูุฉ ุ ูุงูุฐู ููุณ ูู ุงูุณูู ุชุจุฏููู ุจุณุจุจ ุนุฏู ูุฌูุฏ ููุชุงุญ ุทุจูุนู.  ูู PySpark ุ ููู ุตูุฑุชูุง ูุชุดุงุจููุง ูู ุงูููุชุจุงุช ุงููุฑุชุจุทุฉ ุจุงูุนุฏูุฏ ูู ูุบุงุช ุงูุจุฑูุฌุฉ ุงูุฃุฎุฑู ุ ูุชู ุงุณุชุฎุฏุงู ููุน ุฎุงุต ูู PairwiseRDD ุ ุญูุซ ูููู ุงูููุชุงุญ ุนุฏุฏูุง ุตุญูุญูุง ุทููููุง ุ ููุชู ุชูููุฐ ุนูููุฉ ุฅูุบุงุก ุงูุชุณูุณู ุจูุงุณุทุฉ ุฑูุฒ ุงููุณุชุฎุฏู ุจูุบุฉ ุณูุงูุง ุ ูุงููุฎุตุตุฉ ูุชุญููู ููู Python.  ุฅู ุชูููุฉ ุฅุฒุงูุฉ ุงูุชุณูุณู ูุฐู ููุณุช ุจุงูุธุฉ ููุบุงูุฉ ุ ูููููุง ุชูุถุญ ุฃู Scala ูู ุฅุทุงุฑ ุนูู Spark ูุนุชุจุฑ ุจุดูู ุฃุณุงุณู ุฃู ูุชุงุฆุฌ ููุฏ Python ุชุนูู ููุตูููุงุช ุจุงูุช "ุบูุฑ ุดูุงูุฉ". <br><br>  ุนูู ุงูุฑุบู ูู ุจุณุงุทุชู ุ ูุฅู ููุฌ ุงูุชูุงูู ูุฐุง ูุนูู ุจุดูู ุฌูุฏ ุจุดูู ูุฏูุด ุ ููุนุธู ุงูุนูููุงุช ุนูู ูุฌููุนุงุช Scala RDD ูุชุงุญุฉ ูู Python.  ูู ุจุนุถ ุฃุตุนุจ ุงูุฃูุงูู ูู ุงูููุฏ ุ ูุชู ุงููุตูู ุฅูู ุงูููุชุจุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ MLlib ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุญููู / ุญูุธ ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ. <br><br>  ููุง ููุฑุถ ุงูุนูู ูุน ุชูุณููุงุช ุงูุจูุงูุงุช ุงููุฎุชููุฉ ุญุฏูุฏู ุ ุญูุซ ูุนุชูุฏ ุฌุฒุก ูุจูุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุชุญููู / ุญูุธ ุงูุจูุงูุงุช ูู ุฅุทุงุฑ ุนูู Spark ุนูู ูุงุฌูุงุช Hadoop Java.  ูุฐุง ูุนูู ุฃู ุฌููุน ุงูุจูุงูุงุช ุงููุญููุฉ ูุชู ุชุญููููุง ุฃููุงู ูู JVM ุ ุซู ูุชู ููููุง ุฅูู Python ููุท. <br><br>  ุนุงุฏุฉ ูุง ูุชู ุงุณุชุฎุฏุงู ุทุฑููุชูู ููุชูุงุนู ูุน MLlib: ุฅูุง ุฃู ูุณุชุฎุฏู PySpark ููุน ุจูุงูุงุช ูุชุฎุตุต ูุน ุชุญูููุงุช ูู ููุน Scala ุ ุฃู ูุชู ุฅุนุงุฏุฉ ุชูููุฐ ุงูุฎูุงุฑุฒููุฉ ูู Python.  ูููู ุชุฌูุจ ูุฐู ุงููุดุงูู ุจุงุณุชุฎุฏุงู ุญุฒูุฉ Spark ML ุ ุงูุชู ุชุณุชุฎุฏู ูุงุฌูุฉ DataFrame / Dataset ุ ูุงูุชู ุนุงุฏุฉ ูุง ุชููู ุจุชุฎุฒูู ุงูุจูุงูุงุช ูู JVM. <br><br><h3 style=";text-align:right;direction:rtl">  PySpark DataFrame ููุฌููุนุงุช ุงูุจูุงูุงุช </h3><br>  ูุง ุชุญุชูู ูุฌููุนุงุช DataFrame ู Dataset ุนูู ุงูุนุฏูุฏ ูู ูุดููุงุช ุงูุฃุฏุงุก ูู ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Python RDD Set ูุฃููุง ุชุฎุฒู ุงูุจูุงูุงุช ูู JVM ูุฃุทูู ูุชุฑุฉ ููููุฉ.  ูุธูุฑ ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ููุณู ุงูุฐู ุฃุฌุฑููุงู ูุชูุถูุญ ุชููู ูุฌููุนุงุช DataFrame ุนูู ูุฌููุนุงุช RDD (ุงูุธุฑ ุงูุดูู 3.1) ุงุฎุชูุงูุงุช ูุจูุฑุฉ ุนูุฏ ุงูุชุดุบูู ูู Python (ุงูุดูู 7.2). <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/d9/mk/tl/d9mktl7qhe3hg8z2e9lnyanlgde.png" alt="ุงูุตูุฑุฉ"></div><br>  ุจุงููุณุจุฉ ููุนุฏูุฏ ูู ุงูุนูููุงุช ุจุงุณุชุฎุฏุงู ูุฌููุนุงุช DataFrame ู Dataset ุ ูุฏ ูุง ุชุญุชุงุฌ ุฅูู ููู ุงูุจูุงูุงุช ูู JVM ุนูู ุงูุฅุทูุงู ุ ุนูู ุงูุฑุบู ูู ุฃู ุงุณุชุฎุฏุงู ุชุนุจูุฑุงุช UDF ู UDAF ู Python lambda ุงููุฎุชููุฉ ุชุชุทูุจ ุจุทุจูุนุฉ ุงูุญุงู ููู ุจุนุถ ุงูุจูุงูุงุช ุฅูู JVM.  ูุฐุง ูุคุฏู ุฅูู ุงููุฎุทุท ุงููุจุณุท ุงูุชุงูู ููุนุฏูุฏ ูู ุงูุนูููุงุช ุ ูุงูุชู ุชุจุฏู ูุซู ุชูู ุงูููุถุญุฉ ูู ุงูุดูู.  7.3. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/4e/3q/el/4e3qel6hamrvb5ipzycqh9sftcg.png" alt="ุงูุตูุฑุฉ"></div><br><h3 style=";text-align:right;direction:rtl">  ุงููุตูู ุฅูู ูุงุฆูุงุช Java ุงูุฃุณุงุณูุฉ ูุงูุฑูุฒ ุงููุฎุชูุท ูู Scala </h3><br>  ุฅุญุฏู ุงููุชุงุฆุฌ ุงููููุฉ ูููุฏุณุฉ PySpark ูู ุฃู ุงูุนุฏูุฏ ูู ูุฆุงุช ุฅุทุงุฑ ุนูู Spark Python ูู ูู ุงููุงูุน ูุญููุงุช ูุชุฑุฌูุฉ ุงูููุงููุงุช ูู ููุฏ Python ุฅูู ูููุฐุฌ JVM ููููู. <br><br>  ุฅุฐุง ููุช ุชุนูู ูุน ูุทูุฑู Scala / Java ูุชุฑุบุจ ูู ุงูุชูุงุนู ูุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจูู ุ ููู ูููู ููุงู ุฃู ูุญููุงุช ูููุตูู ุฅูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู ูุณุจููุง ุ ูููู ููููู ุชุณุฌูู Java / Scala UDF ูุงุณุชุฎุฏุงููุง ูู ููุฏ Python.  ุจุฏุกูุง ูู Spark 2.1 ุ ูููู ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ registerJavaFunction ูููุงุฆู sqlContext. <br><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุง ุชูุชูู ูุฐู ุงููุญููุงุช ุฌููุน ุงูุขููุงุช ุงููุงุฒูุฉ ุ ูุจูุง ุฃู Python ูุง ุชุชูุชุน ุจุญูุงูุฉ ูููุฉ ุถุฏ ุงุณุชุฏุนุงุก ุงูุทุฑู ุงูุฎุงุตุฉ ุ ููููู ุงููุฌูุก ุนูู ุงูููุฑ ุฅูู JVM.  ุณุชุณูุญ ูู ููุณ ุงูุชูููุฉ ุจุงููุตูู ุฅูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฎุงุตุฉ ุจู ูู JVM ุ ูุจุฌููุฏ ููููุฉ ุ ูู ุจุชุญููู ุงููุชุงุฆุฌ ูุฑุฉ ุฃุฎุฑู ุฅูู ูุงุฆูุงุช Python. <br><br>  ูู ุงููุณู ุงููุฑุนู "ุฎุทุท ุงูุงุณุชุนูุงู ุงููุจูุฑุฉ ูุงูุฎูุงุฑุฒููุงุช ุงูุชูุฑุงุฑูุฉ" ุนูู ุต.  91 ูุงุญุธูุง ุฃูููุฉ ุงุณุชุฎุฏุงู ุฅุตุฏุงุฑ JVM ูู ูุฌููุนุงุช DataFrame ู RDD ูุชูููู ุฎุทุฉ ุงูุงุณุชุนูุงู.  ูุฐุง ุญู ุจุฏูู ุ ูุฃูู ุนูุฏูุง ุชุตุจุญ ุฎุทุท ุงูุงุณุชุนูุงู ูุจูุฑุฉ ุฌุฏูุง ุจุญูุซ ูุง ูููู ูุนุงูุฌุชูุง ุจูุงุณุทุฉ ููุญุณููู Spark SQL ุ ูุฅู ููุญุณููู SQL ุ ุจุณุจุจ ูุถุน ูุฌููุนุฉ RDD ูู ุงูููุชุตู ุ ูููุฏ ุงููุฏุฑุฉ ุนูู ุงููุธุฑ ุจุนุฏ ุงููุญุธุฉ ุงูุชู ุชุธูุฑ ูููุง ุงูุจูุงูุงุช ูู RDD.  ูููู ุชุญููู ููุณ ุงูุดูุก ุจูุณุงุนุฏุฉ ูุงุฌูุงุช ุจุฑูุฌุฉ ุชุทุจููุงุช Python ุงูุนุงูุฉ ุ ููุน ุฐูู ุ ูู ููุณ ุงูููุช ุ ุณุชููุฏ ุงูุนุฏูุฏ ูู ูุฒุงูุง ูุฌููุนุงุช DataFrame ุ ูุฃูู ุณูุชุนูู ุนูู ุฌููุน ุงูุจูุงูุงุช ุงูุงูุชูุงู ุฐูุงุจูุง ูุฅูุงุจูุง ูู ุฎูุงู ุนูุฏ ุนูู Python.  ุจุฏูุงู ูู ุฐูู ุ ููููู ุชูููู ุงูุฑุณู ุงูุจูุงูู ุงูุฃุตูู ูู ุฎูุงู ุงูุงุณุชูุฑุงุฑ ูู ุชุฎุฒูู ุงูุจูุงูุงุช ูู JVM (ููุง ูู ููุถุญ ูู ุงููุซุงู 7.5). <br><br>  ูุซุงู 7.5  ูุทุน ุฎุทุฉ ุงุณุชุนูุงู ูุจูุฑุฉ ูุฅุทุงุฑ DataFrame ุจุงุณุชุฎุฏุงู Python <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs python"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cutLineage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    DataFrame โ     .. :              &gt;&gt;&gt; df = RDD.toDF() &gt;&gt;&gt; cutDf = cutLineage(df) &gt;&gt;&gt; cutDf.count() 3 """</span></span> jRDD = df._jdf.toJavaRDD() jSchema = df._jdf.schema() jRDD.cache() sqlCtx = df.sql_ctx <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: javaSqlCtx = sqlCtx._jsqlContext <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: javaSqlCtx = sqlCtx._ssql_ctx newJavaDF = javaSqlCtx.createDataFrame(jRDD, jSchema) newDF = DataFrame(newJavaDF, sqlCtx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> newDF</code> </pre> <br>  ุจุดูู ุนุงู ุ ูู ุฎูุงู ุงูุงุตุทูุงุญ ุ ูุชู ุงุณุชุฎุฏุงู ุจูุงุก ุงูุฌููุฉ _j [abbreviated_name] ูููุตูู ุฅูู ุฅุตุฏุงุฑุงุช Java ุงูุฏุงุฎููุฉ ููุนุธู ูุงุฆูุงุช Python.  ูุฐุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู ูุงุฆู SparkContext ุนูู _jsc ุ ููุง ูุณูุญ ูู ุจุงูุญุตูู ุนูู ูุงุฆู SparkContext Java ุงูุฏุงุฎูู.  ูุฐุง ูููู ููุท ูู ุจุฑูุงูุฌ ุงูุชุดุบูู ุ ูุฐูู ุนูุฏูุง ุชุฑุณู ูุงุฆูุงุช PySpark ุฅูู ุนูุฏ ุงูุนูู ุ ูู ุชุชููู ูู ุงููุตูู ุฅูู ูููู Java ุงูุฏุงุฎูู ููู ุชุนูู ูุนุธู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช. <br><br>  ูููุตูู ุฅูู ูุฆุฉ Spark ูู JVM ุ ุงูุชู ูุง ุชุญุชูู ุนูู ูุญูู Python ุ ููููู ุงุณุชุฎุฏุงู ุจูุงุจุฉ Py4J ุนูู ุจุฑูุงูุฌ ุงูุชุดุบูู.  ูุญุชูู ุงููุงุฆู SparkContext ุนูู ุงุฑุชุจุงุท ุฅูู ุงูุนุจูุงุฑุฉ ูู ุฎุงุตูุฉ _gateway.  ุณูุณูุญ ุจูุงุก ุงูุฌููุฉ sc._gateway.jvm. [Full_class_name_in_JVM] ุจุงููุตูู ุฅูู ุฃู ูุงุฆู Java. <br><br>  ุณุชุนูู ุชูููุฉ ููุงุซูุฉ ูู ุตููู ุณูุงูุง ุงูุฎุงุตุฉ ุจู ุฅุฐุง ุชู ุชุฑุชูุจูุง ููููุง ููุณุงุฑ ุงููุตู.  ููููู ุฅุถุงูุฉ ูููุงุช JAR ุฅูู ูุณุงุฑ ุงููุตู ุงูุฏุฑุงุณู ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ spark-Submit ูุน ุงููุนููุฉ --jars ุฃู ุนู ุทุฑูู ุชุนููู ุฎุตุงุฆุต ุงูุชูููู spark.driver.extraClassPath.  ุงููุซุงู 7.6 ุ ุงูุฐู ุณุงุนุฏ ุนูู ุชูููุฏ ุงูุฃุฑุฒ.  7.2 ุ ุชู ุชุตูููู ุนู ูุตุฏ ูุฅูุดุงุก ุจูุงูุงุช ูุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ุจุงุณุชุฎุฏุงู ุฑูุฒ Scala ุงูุญุงูู. <br><br>  ูุซุงู 7.6  ุงุณุชุฏุนุงุก ูุฆุงุช ุบูุฑ Spark-JVM ุจุงุณุชุฎุฏุงู Py4J <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">sc = sqlCtx._sc #  <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span> Context,   <span class="hljs-number"><span class="hljs-number">2.1</span></span>, <span class="hljs-number"><span class="hljs-number">2.0</span></span>   , #  <span class="hljs-number"><span class="hljs-number">2.0</span></span>, โ  ,   :p try: try: javaSqlCtx = sqlCtx._jsqlContext <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: javaSqlCtx = sqlCtx._ssql_ctx <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: javaSqlCtx = sqlCtx._jwrapped jsc = sc._jsc scalasc = jsc.sc() gateway = sc._gateway #  java-,   RDD JVM- # <span class="hljs-keyword"><span class="hljs-keyword">Row</span></span> (<span class="hljs-type"><span class="hljs-type">Int</span></span>, <span class="hljs-type"><span class="hljs-type">Double</span></span>).   RDD  Python   #  RDD  Java (   <span class="hljs-keyword"><span class="hljs-keyword">Row</span></span>),   # ,      . #   Java-RDD  <span class="hljs-keyword"><span class="hljs-keyword">Row</span></span> โ     #    DataFrame,     #    RDD  <span class="hljs-keyword"><span class="hljs-keyword">Row</span></span>. java_rdd = (gateway.jvm.com.highperformancespark.examples. tools.GenerateScalingData. generateMiniScaleRows(scalasc, <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>, numCols)) #     <span class="hljs-type"><span class="hljs-type">JSON</span></span>     . #  Python-     Java-. schema = StructType([ StructField("zip", IntegerType()), StructField("fuzzyness", DoubleType())]) #   <span class="hljs-number"><span class="hljs-number">2.1</span></span> /  <span class="hljs-number"><span class="hljs-number">2.1</span></span> try: jschema = javaSqlCtx.parseDataType(<span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>.json()) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: jschema = sqlCtx._jsparkSession.parseDataType(<span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>.json()) #  RDD (Java)  DataFrame (Java) java_dataframe = javaSqlCtx.createDataFrame(java_rdd, jschema) #  DataFrame (Java)  DataFrame (Python) python_dataframe = DataFrame(java_dataframe, sqlCtx) #  DataFrame (Python)   RDD pairRDD = python_dataframe.rdd.map(lambda <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>: (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (python_dataframe, pairRDD)</code> </pre> <br><br>  ุนูู ุงูุฑุบู ูู ุฃู ุงูุนุฏูุฏ ูู ูุฆุงุช Python ูู ุจุจุณุงุทุฉ ูุญููุงุช ููุงุฆูุงุช Java ุ ุฅูุง ุฃูู ูุง ูููู ูู ุฌููุน ูุงุฆูุงุช Java ูู ูุงุฆูุงุช Python ุซู ุงุณุชุฎุฏุงููุง ูู Spark.  ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ุชูุซูู ุงููุงุฆูุงุช ูู ูุฌููุนุงุช PySpark RDD ูุณูุงุณู ูุชุณูุณูุฉ ุ ูุงูุชู ูุง ูููู ุชุญููููุง ุฅูุง ุจุณูููุฉ ูู ููุฏ Python.  ูุญุณู ุงูุญุธ ุ ูุชู ุชูุญูุฏ ูุงุฆูุงุช DataFrame ุจูู ูุบุงุช ุงูุจุฑูุฌุฉ ุงููุฎุชููุฉ ุ ูุฐูู ุฅุฐุง ูุงู ุจุฅููุงูู ุชุญููู ุจูุงูุงุชู ุฅูู ูุฌููุนุงุช DataFrame ุ ูููููู ุจุนุฏ ุฐูู ูููุง ูู ูุงุฆูุงุช Python ูุฅูุง ุงุณุชุฎุฏุงููุง ูุจุงุดุฑุฉ ู Python DataFrame ุ ุฃู ุชุญููู Python DataFrame ุฅูู RDD ููุฐุง ููุณ ุงููุบุฉ. <br><br>  ยปูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุงููุชุงุจ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุน ุงููุงุดุฑ ุนูู ุงูููุจ</a> <br>  ยป <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุญุชููุงุช</a> <br>  ยป <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุทูุงุช</a> <br><br>  ุฎุตู 20ูช ุนูู ููุจููุงุช ุงูุฑุดุงุดุงุช - <b>ุณุจุงุฑู</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar414525/">https://habr.com/ru/post/ar414525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar414513/index.html">27 ุฃุฏุงุฉ ุฑุงุฆุนุฉ ูุชุทููุฑ ุงูููุจ ููุชูุญุฉ ุงููุตุฏุฑ</a></li>
<li><a href="../ar414515/index.html">ุฏุฑุณ ุชุญุณูู ุฎุงุฏู ุชุทุจููุงุช ุงูููุจ</a></li>
<li><a href="../ar414517/index.html">ุนููุงุก ุฃูุณููุฑุฏ: ุงุญุชูุงู ุฃู ูููู ูุญุฏูุง ูู ุงูุฌุฒุก ุงูููุธูุฑ ูู ุงูููู ุฃุนูู ุจูุซูุฑ ูู ุงูุตูุฑ</a></li>
<li><a href="../ar414519/index.html">ููููุฉ ุชุญููู 15 ุฏูููุฉ ูู ุงุฌุชูุงุนุงุช ุณูุฑูู ุฅูู ููุฒู ูุงููุ</a></li>
<li><a href="../ar414523/index.html">ููุงุฑูุฉ ุจูู ุทุงุฆุฑุงุช ููุงุฏููุจุชุฑ DJI Mavic Pro ู Mavic Air</a></li>
<li><a href="../ar414527/index.html">ูุง ููุชุธุฑูุง ุนูู Highload ++ Siberia ุ ุจุงุณุชุซูุงุก ุงูุฏุจุจุฉ ุงููุทููุฉ</a></li>
<li><a href="../ar414531/index.html">ูุง ุฃุญุฏ ูุนุฑู ูุง ุณูุญุฏุซ ููุชุณูู ุนุจุฑ ุงูุฅูุชุฑูุช ูู 1 ููููู</a></li>
<li><a href="../ar414535/index.html">ูุงูุดุณุชุฑ: ูุณูุท ุฑุฃุณ ุงููุฃุณ ููุง ุจุนุฏ ูุงุณู ูุงุซููู ูู ุฃูุฏูุฉ ูุฑุฉ ุงููุฏู ุงูุดููุฑุฉ</a></li>
<li><a href="../ar414537/index.html">ููู ุตูุนูุง ูุงุญุฏุฉ ูู ุฃูุถู ุฃูุนุงุจ ุงููุงูุน ุงููุนุฒุฒ ูู ุงูุนุงูู ุจุฏูู ุญุฑูุฉ ูุฑูุฑ ูุฏููุนุฉ</a></li>
<li><a href="../ar414539/index.html">ูุณุฑู ูุฌุฑูู ุงูุฅูุชุฑูุช ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ููุฑูุณ ุจุดูู ูุชุฒุงูุฏ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>