<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ด ๐ต๐ผ ๐ ุดุฑุญ ุงูุญุฏูุซ ุนู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ุฌุงูุง ุณูุฑูุจุช ๐ ๐ ๐คน๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ุจุงูุฌููุน! 

 ููุง ุชุชุฐูุฑ ุ ูู ุดูุฑ ุฃูุชูุจุฑ ุ ูููุง ุจุชุฑุฌูุฉ ููุงู ูุซูุฑ ููุงูุชูุงู ุญูู ุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุถุจุท ุงูููุช ูู Javascript. ุชุณุจุจ ุฐูู ูู ููุงุด ูุจูุฑ ุ ููููุง ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุดุฑุญ ุงูุญุฏูุซ ุนู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ุฌุงูุง ุณูุฑูุจุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/434360/" style=";text-align:right;direction:rtl"> ูุฑุญุจุง ุจุงูุฌููุน! <br><br>  ููุง ุชุชุฐูุฑ ุ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดูุฑ ุฃูุชูุจุฑ ุ</a> ูููุง ุจุชุฑุฌูุฉ ููุงู ูุซูุฑ ููุงูุชูุงู ุญูู ุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุถุจุท ุงูููุช ูู Javascript.  ุชุณุจุจ ุฐูู ูู ููุงุด ูุจูุฑ ุ ููููุง ูููุชุงุฆุฌ ุงูุชู ุทุงููุง ุฃุฑุฏูุง ุงูุนูุฏุฉ ุฅูููุง ุ ูููุฏู ูู ุชุญููููุง ุชูุตููููุง ููุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ูุฐู ุงููุบุฉ.  ูุณุนุฏูุง ุฃููุง ุชูููุง ูู ุงูุนุซูุฑ ุนูู ููุงุฏ ูุงุฆูุฉ ููุดุฑูุง ูุจู ููุงูุฉ ุงูุนุงู.  ูู ูุฏูู ูุฑุงุกุฉ ูุทููุฉ! <br><a name="habracut"></a><br>  ูุฑุช ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ุฌุงูุงุณูุฑูุจุช ุจุชุทูุฑ ูุชุนุฏุฏ ุงููุฑุงุญู: ูู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุฅูู ุงููุนูุฏ ูุงููุฒูุฏ ุฅูู ุงููููุฏุงุช ุ ููุฑูุจุงู <code>async/await</code> .  ูู ูู ูุฑุญูุฉ ุ ูุงูุช ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ูู ุฌุงูุงุณูุฑูุจุช ูุจุณุทุฉ ููููุงู ุจุงููุณุจุฉ ูุฃููุฆู ุงูุฐูู ุฑุงูุนูุง ุจุงููุนู ูู ูุฐู ุงููุบุฉ ุ ูููู ุจุงููุณุจุฉ ูููุจุชุฏุฆูู ุฃุตุจุญ ุงูุฃูุฑ ุฃูุซุฑ ุฅุซุงุฑุฉ ููุฎูู ุ ูุฃูู ูุงู ูู ุงูุถุฑูุฑู ููู ุงููุฑูู ุงูุฏูููุฉ ูู ูู ูููุฐุฌ ุ ูุฅุชูุงู ุชุทุจูู ูู ูููู ุ ูููู ุฅุชูุงู ุชุทุจููู ุ ููู ูุนูู ูู ุดูุก. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุ ูุฑุฑูุง ุฃู ูุชุฐูุฑ ุจุฅูุฌุงุฒ ููููุฉ ุงุณุชุฎุฏุงู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ูุงููุนูุฏ ุ ูุชูุฏูู ููุฏูุฉ ูุฎุชุตุฑุฉ ูููููุฏุงุช ุ ุซู ูุณุงุนุฏู ุนูู ููู ุญุฏุณู ุชูุงููุง ููู ูุชู ุชุฑุชูุจ ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ "ุชุญุช ุงูุบุทุงุก" ูุน ุงููููุฏุงุช ูุชุฒุงูู / ุงูุชุธุงุฑ.  ูุฃูู ุฃู ุชุชููู ุจูุฐู ุงูุทุฑููุฉ ูู ุชุทุจูู ุงูููุงุฐุฌ ุงููุฎุชููุฉ ุจุซูุฉ ุฃูููุง ูุงูุช ููุงุณุจุฉ. <br><br>  ูู ุงูููุชุฑุถ ุฃู ูููู ุงููุงุฑุฆ ูุฏ ุงุณุชุฎุฏู ุจุงููุนู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ูุงููุนูุฏ ูุงููููุฏุงุช ููุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุ ููุง ุฃูู ูุฃููู ุชูุงููุง ุจุงูุฅุบูุงู ูุงููุงุฑู ูู Javascript. <br><br>  <b>ุฑุฏ ุงูุฌุญูู</b> <br><br>  ูู ุงูุจุฏุงูุฉ ุ ูุงูุช ููุงู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช.  ูุง ูุญุชูู Javascript ุนูู I / O ูุชุฒุงูู (ูุดุงุฑ ุฅููู ูููุง ููู I / O) ูุงูุญุธุฑ ุบูุฑ ูุนุชูุฏ ุนูู ุงูุฅุทูุงู.  ูุฐูู ุ ูุชูุธูู ุฃู ุฅุฏุฎุงู / ุฅุฎุฑุงุฌ ุฃู ูุชุฃุฌูู ุฃู ุฅุฌุฑุงุก ุ ุชู ุงุฎุชูุงุฑ ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ: ุชู ุชูุฑูุฑ ุงูููุฏ ุงููุทููุจ ุชูููุฐู ุจุดูู ุบูุฑ ูุชุฒุงูู ุฅูู ุงููุธููุฉ ูุน ุงูุชูููุฐ ุงููุคุฌู ุ ูุงูุฐู ุชู ุฅุทูุงูู ูู ููุงู ูุง ุฃุฏูุงู ูู ุญููุฉ ุงูุญุฏุซ.  ุฑุฏ ุงูุงุชุตุงู ูุงุญุฏ ููุณ ุณูุฆูุง ููุบุงูุฉ ุ ูููู ุงูุฑูุฒ ูููู ุ ูุนุงุฏุฉ ูุง ููุชุฌ ุนู ุนูููุงุช ุฑุฏ ุงูุงุชุตุงู ุฑุฏ ุงุชุตุงู ุฌุฏูุฏ.  ูุงููุชูุฌุฉ ูู ุดูุก ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">getUserData(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doStuff</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e, a</span></span></span><span class="hljs-function">) </span></span>{ getMoreUserData(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doMoreStuff</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e, b</span></span></span><span class="hljs-function">) </span></span>{ getEvenMoreUserData(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doEvenMoreStuff</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e, c</span></span></span><span class="hljs-function">) </span></span>{ getYetMoreUserData(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doYetMoreStuff</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e, c</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Welcome to callback hell!'</span></span>); }); }); }); })</code> </pre> <br>  ุจุตุฑู ุงููุธุฑ ุนู ูุชูุกุงุช ุงูุฃูุฒ ุนูุฏ ุฑุคูุฉ ูุซู ูุฐุง ุงูุฑูุฒ ุงูููุทู ููุฏุณู ูุชูุฑุฑ ุ ููุงู ูุดููุฉ ุฃุฎุฑู: ููุฏ ูููุง ุงูุขู ุจุชูููุถ ุงูุชุญูู ูู ููุทู <code>do*Stuff</code> ุฅูู ูุธุงุฆู ุฃุฎุฑู ( <code>get*UserData()</code> ) ุ ูุงูุชู ูุฏ ูุง ุชููู ูุฏูู ุดูุฑุฉ ูุตุฏุฑ ุ ููุฏ ูุง ุชููู ูุฏูู ุจุงูุชุฃููุฏ ุฅุฐุง ูุงููุง ูุคุฏูู ุฑุฏ ุงูุงุชุตุงู ุงูุฎุงุต ุจู.  ุนุธูู ุ ุฃููุณ ูุฐููุ <br><br>  <b>ุงููุนูุฏ</b> <br><br>  ุชุนุฏ ุงููุนูุฏ ุจุนูุณ ุงุชุฌุงู ุงูุชุญูู ุงูุฐู ุชููุฑู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ูุชุณุงุนุฏ ูู ูุดู ุชุดุงุจู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ูู ุณูุณูุฉ ุณูุณุฉ. <br>  ุงูุขู ูููู ุชุญููู ุงููุซุงู ุงูุณุงุจู ุฅูู ุดูุก ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">getUserData() .then(getUserData) .then(doMoreStuff) .then(getEvenMoreUserData) .then(doEvenMoreStuff) .then(getYetMoreUserData) .then(doYetMoreStuff);</code> </pre><br>  ุจุงููุนู ููุณุช ูุจูุญุฉ ุฌุฏุง ุ ูุงูุ <br><br>  ููู ุฏุนูู !!!  ุฏุนูุง ููุธุฑ ุฅูู ูุซุงู ุฑุฏ ุงุชุตุงู ุฃูุซุฑ ุญูููุฉ (ูููู ูุง ูุฒุงู ููุชูุฏูุง ุฅูู ุญุฏ ูุจูุฑ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ,     fetchJson(),   GET   , //    :         ,     โ   // . function fetchJson(url, callback) { ... } fetchJson('/api/user/self', function(e, user) { fetchJson('/api/interests?userId=' + user.id, function(e, interests) { var recommendations = []; interests.forEach(function () { fetchJson('/api/recommendations?topic=' + interest, function(e, recommendation) { recommendations.push(recommendation); if (recommendations.length == interests.length) { render(profile, interests, recommendations); } }); }); }); });</span></span></code> </pre><br>  ูุฐูู ุ ูุฎุชุงุฑ ููู ุชุนุฑูู ุงููุณุชุฎุฏู ุ ุซู ุงูุชูุงูุงุชู ุ ูุจูุงุกู ุนูู ุงูุชูุงูุงุชู ุ ูุฎุชุงุฑ ุงูุชูุตูุงุช ุ ูุฃุฎูุฑุงู ุ ุจุนุฏ ุฃู ุฌูุนูุง ูู ุงูุชูุตูุงุช ุ ูุนุฑุถ ุงูุตูุญุฉ.  ูุฐู ุงููุฌููุนุฉ ูู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ุ ูุงูุชู ุ ุนูู ุงูุฃุฑุฌุญ ุ ูููู ุฃู ุชูุฎุฑ ุจูุง ุ ููููุง ูุน ุฐูู ุฃุดุนุซ ุฅูู ุญุฏ ูุง.  ูุง ุดูุก ุ ูู ุจุชุทุจูู ุงููุนูุฏ ููุง - ููู ุดูุก ุณูู ููุฌุญ.  ุตุญูุญุ <br><br>  ุฏุนููุง ูุบูุฑ ุทุฑููุฉ <code>fetchJson()</code> ุญุชู ุชูุฑุฌุน ุงููุนุฏ ุจุฏูุงู ูู ูุจูู ุฑุฏ ุงูุงุชุตุงู.  ูุชู ุญู ุงููุนุฏ ุจูุงุณุทุฉ ููุฆุฉ ุงุณุชุฌุงุจุฉ ููุฒุนุฉ ุจุชูุณูู JSON. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id); }) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">interests</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all[interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))]; }) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">recommendations</span></span></span><span class="hljs-function">) </span></span>{ render(user, interests, recommendations); });</code> </pre> <br>  ูุทูู ุ ุฃููุณ ูุฐููุ  ูุง ูู ุงูุฎุทุฃ ูู ูุฐุง ุงูุฑูุฒ ุงูุขูุ <br><br>  ุนูููุง ... .. <br>  ููุณ ูุฏููุง ุฅููุงููุฉ ุงููุตูู ุฅูู ุงูููู ุงูุดุฎุตู ุฃู ุงูุงูุชูุงูุงุช ูู ุงููุธููุฉ ุงูุฃุฎูุฑุฉ ูู ูุฐู ุงูุณูุณูุฉุ  ูุฐูู ูุง ุดูุก ูุนูู!  ูุงุฐุง ุชูุนูุ  ููุฌุฑุจ ุงููุนูุฏ ุงููุชุฏุงุฎูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">interests</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: user, <span class="hljs-attr"><span class="hljs-attr">interests</span></span>: interests }); }) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">blob</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all[blob.interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))] .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">recommendations</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-attr"><span class="hljs-attr">user</span></span>: blob.user, <span class="hljs-attr"><span class="hljs-attr">interests</span></span>: blob.interests, <span class="hljs-attr"><span class="hljs-attr">recommendations</span></span>: recommendations }); }) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bigBlob</span></span></span><span class="hljs-function">) </span></span>{ render(bigBlob.user, bigBlob.interests, bigBlob.recommendations); });</code> </pre> <br>  ูุนู ... ุงูุขู ูุจุฏู ุฃูุซุฑ ุฎุฑูุงุก ุจูุซูุฑ ููุง ููุง ูุฃูู.  ูู ูุฐุง ุจุณุจุจ ุฏูู ุงูุชุนุดูุด ุงููุฌูููุฉ ุงูุชู ุณุนููุง ุ ุฃุฎูุฑูุง ูููุณ ุขุฎุฑูุง ุ ุฅูู ุงูุฎุฑูุฌ ูู ุฌุญูู ุงูุงุณุชุฑุฌุงุนุงุชุ  ูุงุฐุง ุชูุนู ุงูุขูุ <br><br>  ูููู ุชูุดูุท ุงูููุฏ ููููุงู ุ ููู ูุนุชูุฏ ุนูู ุนูููุงุช ุงูุฅุบูุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,     var user, interests; fetchJson('/api/user/self') .then(function (fetchedUser) { user = fetchedUser; return fetchJson('/api/user/interests?userId=' + self.id); }) .then(function (fetchedInterests) { interests = fetchedInterests; return Promise.all(interests.map(i =&gt; fetchJson('/api/recommendations?topic=' + i))); }) .then(function (recomendations) { render(user, interests, recommendations); }) .then(function () { console.log('We are done!'); });</span></span></code> </pre> <br>  ูุนู ุ ูู ุดูุก ุงูุขู ูู ุนูููุง ุจุงูุทุฑููุฉ ุงูุชู ุฃุฑุฏูุงูุง ุ ูููู ูุน ูุฒูุฉ ูุงุญุฏุฉ.  ูุงุญุธ ููู ุฃุทูููุง ุนูู ุงูุญุฌุฌ ุฏุงุฎู ุนูููุงุช ุงูุงุณุชุฑุฌุงุนุงุช ูู <code>fetchedInterests</code> <code>user</code> <code>fetchedInterests</code> ุ ุจุฏูุงู ูู <code>user</code> <code>interests</code> ุ  ุฅุฐุง ูุงู ุงูุฃูุฑ ูุฐูู ุ ูุฃูุช ููุชุฒู ููุบุงูุฉ! <br><br>  ุงูุนูุจ ูู ูุฐุง ุงูููุฌ ูู: ูุฌุจ ุฃู ุชููู ุญุฐุฑุงู ููุบุงูุฉ ูู ุนุฏู ุชุณููุฉ ุฃู ุดูุก ูู ุงููุธุงุฆู ุงูุฏุงุฎููุฉ ููุฐูู ุงููุชุบูุฑุงุช ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุชู ุณุชุณุชุฎุฏููุง ูู ุงูุฅุบูุงู.  ุญุชู ูู ูุงู ูุฏูู ูููุจุฉ ูุชุฌูุจ ุงูุชุธููู ุ ูุฅู ุงูุฅุดุงุฑุฉ ุฅูู ูุชุบูุฑ ุนุงูู ููุบุงูุฉ ูู ุงูุฅุบูุงู ูุง ุชุฒุงู ุฎุทูุฑุฉ ุฌุฏูุง ุ ููุฐุง ุจุงูุชุฃููุฏ ููุณ ุฌูุฏูุง. <br><br>  <b>ูููุฏุงุช ุบูุฑ ูุชุฒุงููุฉ</b> <br><br>  ุณูู ูููุฏุงุช ูุณุงุนุฏุฉ!  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงููููุฏุงุช ุ ูุฅู ูู ุงูุฅุซุงุฑุฉ ุชุฎุชูู.  ููุท ุณุญุฑูุฉ.  ุงูุญูููุฉ ูู.  ุฅููุงุก ูุธุฑุฉ ููุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> interests = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recommendations = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all( interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))); render(user, interests, recommendations); });</code> </pre> <br>  ูุฐุง ูู ุดูุก.  ุณูู ุชุนูู.  ุฃูุช ูุง ุชูููุฑ ุนูุฏูุง ุชุฑู ูู ูู ุฌููู ุงููููุฏุงุช ุ ูู ุชุดุนุฑ ุจุงูุฃุณู ูุฃูู ูุตุฑ ุงููุธุฑ ูุจุฏุฃุช ุชุชุนูู ุฌุงูุง ุณูุฑูุจุช ุญุชู ูุจู ุธููุฑ ุงููููุฏุงุช ูููุ  ุฃุนุชุฑู ุ ูุฐู ุงูููุฑุฉ ุฒุงุฑุชูู ุฐุงุช ูุฑุฉ. <br>  ููู ... ููู ูุนูู ูู ูุฐุงุ  ุญูุง ุงูุณุญุฑุ <br><br>  ุจุงูุทุจุน!  ููุชูู ุฅูู ุงูุชุนุฑุถ. <br><br>  <b>ูููุฏุงุช</b> <br><br>  ูู ูุซุงููุง ุ ูุจุฏู ุฃู ุงููููุฏุงุช ุณููุฉ ุงูุงุณุชุฎุฏุงู ุ ููู ูู ุงููุงูุน ููุงู ุงููุซูุฑ ูุญุฏุซ ูููุง.  ููุนุฑูุฉ ุงููุฒูุฏ ุญูู ุงููููุฏุงุช ุบูุฑ ุงููุชุฒุงููุฉ ุ ุชุญุชุงุฌ ุฅูู ููู ุฃูุถู ูููููุฉ ุนูู ุงููููุฏุงุช ูููู ุชููุฑ ุชูููุฐ ุบูุฑ ูุชุฒุงูู ุ ูุงูุฐู ูุจุฏู ูุชุฒุงูููุง. <br><br>  ููุง ููุญู ุงูุงุณู ุ ุงููููุฏ ูุฌุนู ุงูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">counts</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">start</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> start + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> start + <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> start + <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> start + <span class="hljs-number"><span class="hljs-number">4</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> counter = counts(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(counter.next()); <span class="hljs-comment"><span class="hljs-comment">// {value: 1, done: false} console.log(counter.next()); // {value: 2, done: false} console.log(counter.next()); // {value: 3, done: false} console.log(counter.next()); // {value: 4, done: true} console.log(counter.next()); // {value: undefined, done: true}</span></span></code> </pre><br>  ุงูุฃูุฑ ุจุณูุท ููุบุงูุฉ ุ ูููู ุนูู ุฃู ุญุงู ุ ุฏุนููุง ูุชุญุฏุซ ุนู ูุง ูุญุฏุซ ููุง: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>const counter = counts();</code>  - ุชููุฆุฉ ุงููููุฏ ูุญูุธู ูู ุนุฏุงุฏ ูุชุบูุฑ.  ุงููููุฏ ูู ุทู ุงููุณูุงู ุ ูู ูุชู ุชูููุฐ ุฃู ููุฏ ูู ุฌุณู ุงููููุฏ. </li><li style=";text-align:right;direction:rtl"> <code>console.log(counter.next());</code>  - ุชูุณูุฑ ุงููุฎุฑุฌุงุช ( <code>yield</code> ) 1 ุ ูุจุนุฏูุง ูุชู ุฅุฑุฌุงุน 1 <code>value</code> ุ <code>done</code> ูุชุงุฆุฌ <code>false</code> ุ ูุฃู ุงููุงุชุฌ ูุง ููุชูู ุนูุฏ ูุฐุง ุงูุญุฏ </li><li style=";text-align:right;direction:rtl"> <code>console.log(counter.next());</code>  - ุงูุขู 2! </li><li style=";text-align:right;direction:rtl"> <code>console.log(counter.next());</code>  - ุงูุขู 3!  ุงูุชูู.  ูู ูู ุดูุก ุนูู ุญูุ  ุฑูู  ุชู ุฅููุงู ุงูุชูููุฐ ูุคูุชูุง ูู ุงูุฎุทูุฉ ุฑูู <code>yield 3;</code>  ูุฅููุงู ุ ุชุญุชุงุฌ ุฅูู ุงูุงุชุตุงู ุงูุชุงูู () ูุฑุฉ ุฃุฎุฑู. </li><li style=";text-align:right;direction:rtl"> <code>console.log(counter.next());</code>  - ุงูุขู 4 ุ ูุชุนูุฏ ุ ูููู ูู ุชุตุฏุฑ ุ ูุฐูู ูุญู ุงูุขู ุงูุฎุฑูุฌ ูู ุงููุธููุฉ ุ ููู ุดูุก ุฌุงูุฒ. </li><li style=";text-align:right;direction:rtl"> <code>console.log(counter.next());</code>  - ุงูุชูู ุงููููุฏ ุงูุนูู!  ููุณ ูุฏูู ูุง ููุฏูู ุณูู "ูู ุดูุก ูุชู". </li></ol><br>  ูุฐูู ุงูุชุดููุง ููู ุชุนูู ุงููููุฏุงุช!  ููู ุงูุชุธุฑ ูุง ููุง ูู ุญูููุฉ ูุฑูุนุฉ: ูุง ูููู ูููููุฏุงุช ุฃู ุชุจุซ ุงูููู ูุญุณุจ ุ ุจู ุชูุชูููุง ุฃูุถูุง! <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"We are starting!"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"We are done!"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> counter = printer(); counter.next(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ! counter.next(2); // 2 counter.next(3); // 3 counter.next(4); // 4\n ! counter.next(5); //   </span></span></code> </pre><br>  ูุงูู ุ ูุงุฐุงุ  ูุณุชููู ุงููููุฏ ุงูููู ุ ุจุฏูุงู ูู ุงูุชูุฑูุฎ ูููุง.  ููู ูุฐุง ููููุ <br><br>  ุงูุณุฑ ูู ุงููุธููุฉ <code>next</code> .  ูุง ุชููู ุจุฅุฑุฌุงุน ุงูููู ูู ุงููููุฏ ูุญุณุจ ุ ุจู ูููููุง ุฃูุถูุง ุฅุนุงุฏุชูุง ุฅูู ุงููููุฏ.  ุฅุฐุง ุฃุฎุจุฑุช <code>next()</code> ุงููุณูุทุฉ ุ ูุฅู ุนูููุฉ ุงูุฅูุชุงุฌ ุ ุงูุชู ููุชุธุฑูุง ุงููููุฏ ุญุงูููุง ุ ุชุคุฏู ูุนูููุง ุฅูู ุงููุณูุทุฉ.  ูุฐุง ูู ุงูุณุจุจ ูู ุชุณุฌูู ุฃูู ุนุฏุงุฏ. ุงูุชุงูู <code>counter.next(1)</code> ุฃูู <code>undefined</code> .  ุจุจุณุงุทุฉ ูุง ููุฌุฏ ุชุณููู ูููู ุชุณููุชู. <br><br>  ูุจุฏู ุงูุฃูุฑ ููุง ูู ุฃู ุงููููุฏ ุณูุญ ูุฑูุฒ ุงูุงุชุตุงู (ุงูุฅุฌุฑุงุก) ูุฑูุฒ ุงููููุฏ (ุงูุฅุฌุฑุงุก) ุจุงูุดุฑุงูุฉ ูุน ุจุนุถููุง ุงูุจุนุถ ุจุญูุซ ููุฑุฑุงู ุงูููู ุฅูู ุจุนุถููุง ุงูุจุนุถ ููุง ุชู ุชูููุฐูุง ูุงูุชุธุงุฑ ุจุนุถููุง ุงูุจุนุถ.  ุงููุถุน ูู ููุณู ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ููุง ูู ูุงู ููููุฏู Javascript ุฅููุงููุฉ ุชูููุฐ ุงูุฅุฌุฑุงุกุงุช ุงูุชุนุงูููุฉ ุงููููุฐุฉ ุจุดูู ุชูุงูุณู ุ ููู ุฃูุถูุง "coroutines" ุ ูุงู ูู ุงููููู ุงูุชูููุฑ ูููุง.  ูู ุงููุงูุน ุ ุฅูู ุญุฏ ูุจูุฑ ูุซู <code>co()</code> ุ ุฃููุณ ูุฐููุ <br><br>  ูููู ุฏุนููุง ูุง ูุชุณุฑุน ุ ูุฅูุง ูุฅููุง ุณูู ูููุฒ ุนูู ุฃููุณูุง.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงูููู ุฃู ูููู ุงููุงุฑุฆ ุจุดูู ุฌููุฑู ุฌููุฑ ุงููููุฏุงุช ูุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ ุ ูุฃูุถู ุทุฑููุฉ ููููุงู ุจุฐูู ูู ุชุฌููุน ุงููููุฏ ุจููุณู.  ูุง ุชูุชุจ ูุธููุฉ ุงููููุฏ ููุง ุชุณุชุฎุฏู ุงููููุฏ ุงูููุงุฆู ุ ููู ุฃุนุฏ ุชุตููู ูุธููุฉ ุงููููุฏ ุจููุณู. <br><br>  <b>ุงูุฌูุงุฒ ุงูุฏุงุฎูู ูููููุฏ - ูุญู ูููุฏ ูููุฏุงุช</b> <br><br>  ุญุณููุง ุ ูุง ุฃุนุฑู ุญููุง ููู ุชุจุฏู ุงูุฃุฌุฒุงุก ุงูุฏุงุฎููุฉ ูููููุฏ ุจุฏูุฉ ูู ุฃููุงุช ุชุดุบูู JS ุงููุฎุชููุฉ.  ูููู ูุฐุง ููุณ ูููุง ุฌุฏุง.  ูููุฏุงุช ุชุชูุงูู ูุน ุงููุงุฌูุฉ.  "ูููุดุฆ" ูุฅูุดุงุก ูุซูู ูููููุฏ ุ ุงูุทุฑููุฉ <code>next(value? : any)</code> ุ ุงูุชู ูุทูุจ ุจูุง ูู ุงููููุฏ ููุงุตูุฉ ุงูุนูู ูุฅุนุทุงุฆู ููููุง ุ ุทุฑููุฉ <code>throw(error)</code> ูู ุญุงูุฉ ุฅูุดุงุก <code>throw(error)</code> ุจุฏูุงู ูู ุงููููุฉ ุ ูุฃุฎูุฑูุง ุ ุทุฑููุฉ <code>return()</code> ุ ูุงูุชู ูุง ุชุฒุงู ุตุงูุชุฉ.  ุฅุฐุง ุชุญูู ุงูุงูุชุซุงู ูููุงุฌูุฉ ุ ููู ุดูุก ุนูู ูุง ูุฑุงู. <br><br>  ูุฐูู ุ ุฏุนููุง ูุญุงูู ุฅูุดุงุก ูููุฏ <code>counts()</code> ุงููุฐููุฑ ุฃุนูุงู ุนูู ES5 ุงูุฎุงูุต ุ ุจุฏูู <code>function*</code> ุงููููุฉ ุงูุฃุณุงุณูุฉ <code>function*</code> .  ูู ุงูููุช ุงูุญุงูู ุ ููููู ุชุฌุงูู <code>throw()</code> ูุชูุฑูุฑ ุงููููุฉ ุฅูู <code>next()</code> ุ ูุฃู ุงูุทุฑููุฉ ูุง ุชูุจู ุฃู ุฅุฏุฎุงู.  ููู ููุนู ุฐููุ <br><br>  ูููู ูู Javascript ุ ููุงู ุขููุฉ ุฃุฎุฑู ูุฅููุงู ุชูููุฐ ุงูุจุฑูุงูุฌ ูุงุณุชุฆูุงูู: ุนูููุงุช ุงูุฅุบูุงู!  ูู ุชุจุฏู ูุฃูููุฉุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeCounter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count++; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> counter = makeCounter(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(counter()); <span class="hljs-comment"><span class="hljs-comment">// 1 console.log(counter()); // 2 console.log(counter()); // 3</span></span></code> </pre> <br>  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุนูููุงุช ุงูุฅุบูุงู ูู ูุจู ุ ูุฃูุง ูุชุฃูุฏ ูู ุฃูู ูุชุจุช ุจุงููุนู ุดูุฆูุง ููุฐุง.  ูููู ุฃู ุชููู ุงูุฏุงูุฉ ุงูุชู ูุชู ุฅุฑุฌุงุนูุง ุจูุงุณุทุฉ makeCounter ุจุฅูุดุงุก ุชุณูุณู ุบูุฑ ูุญุฏูุฏ ูู ุงูุฃุฑูุงู ุ ุชูุงููุง ูุซู ุงููููุฏ. <br><br>  ููุน ุฐูู ุ ูุฅู ูุฐู ุงููุธููุฉ ูุง ุชุชูุงูู ูุน ูุงุฌูุฉ ุงููููุฏ ุ ููุง ูููู ุชุทุจูููุง ูุจุงุดุฑุฉ ูู ูุซุงููุง ูุน <code>counts()</code> ุ ูุงูุชู ุชูุฑุฌุน 4 ููู ููุฎุงุฑุฌ.  ูุง ูู ุงููุทููุจ ูููุฌ ุนุงููู ููุชุงุจุฉ ูุธุงุฆู ุชุดุจู ุงููููุฏุ <br><br>  ุงูุฅุบูุงูุงุช ุ ูุฃุฌูุฒุฉ ุงูุฏููุฉ ุ ูุงูุนูู ุงูุฌุงุฏ! <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">counts</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">start</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> done = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">go</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: result = start + <span class="hljs-number"><span class="hljs-number">1</span></span>; state = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: result = start + <span class="hljs-number"><span class="hljs-number">2</span></span>; state = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: result = start + <span class="hljs-number"><span class="hljs-number">3</span></span>; state = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: result = start + <span class="hljs-number"><span class="hljs-number">4</span></span>; done = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; state = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">done</span></span>: done, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: result}; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: go } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> counter = counts(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(counter.next()); <span class="hljs-comment"><span class="hljs-comment">// {value: 1, done: false} console.log(counter.next()); // {value: 2, done: false} console.log(counter.next()); // {value: 3, done: false} console.log(counter.next()); // {value: 4, done: true} console.log(counter.next()); // {value: undefined, done: true}</span></span></code> </pre> <br>  ุนู ุทุฑูู ุชุดุบูู ูุฐุง ุงูุฑูุฒ ุ ุณุชุฑู ููุณ ุงููุชุงุฆุฌ ููุง ูู ุงูุฅุตุฏุงุฑ ูุน ุงููููุฏ.  ูุทูู ุ ุฃููุณ ูุฐููุ <br>  ูุฐูู ุ ูููุง ุจูุฑุฒ ุฌุงูุจ ุงูุชูููุฏ ูููููุฏ ุ  ุฏุนูุง ูุญูู ุงููุณุชูููุ <br>  ูู ุงููุงูุน ุ ูุง ุชูุฌุฏ ุงุฎุชูุงูุงุช ูุซูุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">start</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> done = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">go</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"We are starting!"</span></span>); state = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(input); state = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(input); state = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(input); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"We are done!"</span></span>); done = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; state = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">done</span></span>: done, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: result}; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: go } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> counter = printer(); counter.next(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ! counter.next(2); // 2 counter.next(3); // 3 counter.next(4); // 4 counter.next(5); // !</span></span></code> </pre> <br>  ูู ูุง ูุญุชุงุฌ ุฅููู ูู ุฅุถุงูุฉ <code>input</code> ูุญุฌุฉ ุงูุชูุงู ุ ููุชู ุฅุฎุฑุงุฌ ุงูููู.  ูุดุจู ุงูุณุญุฑ ูุฑุฉ ุฃุฎุฑูุ  ุชูุฑูุจุง ูุซู ุงููููุฏุงุชุ <br><br>  ุงูุตูุญุฉ!  ูุฐูู ูููุง ุจุฅุนุงุฏุฉ ุฅูุดุงุก ุงููููุฏ ูููุฑุฏ ูููุณุชููู.  ููุงุฐุง ูุง ุชุญุงูู ุงูุฌูุน ุจูู ูุฐู ุงููุธุงุฆู ูู ุฐููุ  ูููุง ููู ูุซุงู ูุตุทูุน ุฌููู ูููููุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">adder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialValue</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = initialValue; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { sum += <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> sum; } }</code> </pre> <br>  ูุธุฑูุง ูุฃููุง ุฌููุนูุง ูุชุฎุตุตูู ูู ุงููููุฏุงุช ุงูููุฑุจุงุฆูุฉ ุ ูุฅููุง ูููู ุฃู ูุฐุง ุงููููุฏ ูุถูู ุงููููุฉ ุงููุนุทุงุฉ ูู <code>next(value)</code> ุฅูู <code>sum</code> ุ ุซู ููุฑุฌุน sum.  ุฅูู ูุนูู ุชูุงููุง ููุง ุชููุนูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> add = adder(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(add.next()); <span class="hljs-comment"><span class="hljs-comment">// 0 console.log(add.next(1)); // 1 console.log(add.next(2)); // 3 console.log(add.next(3)); // 6</span></span></code> </pre><br>  ุฑุงุฆุน  ุงูุขู ุฏุนูุง ููุชุจ ูุฐู ุงููุงุฌูุฉ ูุฏุงูุฉ ุนุงุฏูุฉ! <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">adder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialValue</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> state = <span class="hljs-string"><span class="hljs-string">'initial'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> done = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = initialValue; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">go</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'initial'</span></span>: result = initialValue; state = <span class="hljs-string"><span class="hljs-string">'loop'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'loop'</span></span>: sum += input; result = sum; state = <span class="hljs-string"><span class="hljs-string">'loop'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">done</span></span>: done, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: result}; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">next</span></span>: go } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runner</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> add = adder(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(add.next()); <span class="hljs-comment"><span class="hljs-comment">// 0 console.log(add.next(1)); // 1 console.log(add.next(2)); // 3 console.log(add.next(3)); // 6 } runner();</span></span></code> </pre> <br>  ูุฌุงุญ ุจุงูุฑ ุ ูููุง ุจุชูููุฐ coroutine ูุงููุฉ. <br><br>  ูุง ูุฒุงู ููุงู ุดูุก ูููุงูุดุฉ ุญูู ุชุดุบูู ุงููููุฏุงุช ุงูููุฑุจุงุฆูุฉ.  ููู ุชุนูู ุงูุงุณุชุซูุงุกุงุชุ  ูุน ุงูุงุณุชุซูุงุกุงุช ุงูุชู ุชุญุฏุซ ุฏุงุฎู ุงููููุฏุงุช ุ ูู ุดูุก ุจุณูุท: <code>next()</code> ุณูุฌุนู ุงูุงุณุชุซูุงุก ูุตู ุฅูู ุงููุชุตู ูุณูู ูููุช ุงููููุฏ.  ูุชู ุชูุฑูุฑ ุงุณุชุซูุงุก ุฅูู ุงููููุฏ ูู ุทุฑููุฉ <code>throw()</code> ุ ูุงูุชู ุญุฐูุชูุง ุฃุนูุงู. <br><br>  ุฏุนููุง ุฅุซุฑุงุก ูุงุตู ูุฏููุง ูุน ููุฒุฉ ุฌุฏูุฏุฉ ุจุงุฑุฏุฉ.  ุฅุฐุง ูุงู ุงููุชุตู ุจุชูุฑูุฑ ุงูุงุณุชุซูุงุก ุฅูู ุงููููุฏ ุ ูุณูุนูุฏ ุฅูู ุงููููุฉ ุงูุฃุฎูุฑุฉ ูููุฌููุน. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">adder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialValue</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sum = initialValue; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lastSum = initialValue; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> temp; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { temp = sum; sum += <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> sum; lastSum = temp; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e) { sum = lastSum; } } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> add = adder(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(add.next()); <span class="hljs-comment"><span class="hljs-comment">// 0 console.log(add.next(1)); // 1 console.log(add.next(2)); // 3 console.log(add.throw(new Error('BOO)!'))); // 1 console.log(add.next(4)); // 5</span></span></code> </pre><br>  <b>ูุดููุฉ ุงูุจุฑูุฌุฉ - ูููุฏ ุฎุทุฃ ุงูุงุฎุชุฑุงู</b> <br><br>  ุงูุฑููู ุ ููู ูููุฐ ุฑูู ()ุ <br><br>  ุณูู  ุงูุฎุทุฃ ูู ูุฌุฑุฏ ูููุฉ ุฃุฎุฑู.  ูููููุง ุชูุฑูุฑู ุฅูู <code>go()</code> ูุงููุณูุทุฉ ุงูุชุงููุฉ.  ูู ุงููุงูุน ุ ููุงู ุญุงุฌุฉ ุฅูู ุจุนุถ ุงูุญุฐุฑ ููุง.  ุนูุฏูุง <code>throw(e)</code> ุงุณุชุฏุนุงุก <code>throw(e)</code> ุ ูุฅู <code>yield</code> ุณูุนูู ููุง ูู ุฃููุง ูุชุจูุง ุฑูู ู.  ูุฐุง ูุนูู ุฃูู ูุฌุจ ุนูููุง ุงูุชุญูู ูู ุงูุฃุฎุทุงุก ูู ูู ุญุงูุฉ ูู ุญุงูุงุช ุญุงูุฉ ุงูุฌูุงุฒ ูุฏููุง ุ ูุชุนุทู ุงูุจุฑูุงูุฌ ุฅุฐุง ูู ูุชููู ูู ูุนุงูุฌุฉ ุงูุฎุทุฃ. <br><br>  ููุจุฏุฃ ูุน ุงูุชูููุฐ ุงูุณุงุจู ูููุงุตู ุ ูุณุฎ <br><br>  <a href="">ููุท</a> <br><br>  <a href="">ุงูุญู</a> <br><br>  ุจูู!  ููุฏ ุทุจููุง ูุฌููุนุฉ ูู coroutines ุงูุชู ูู ูุงุฏุฑุฉ ุนูู ุชูุฑูุฑ ุงูุฑุณุงุฆู ูุงูุงุณุชุซูุงุกุงุช ูุจุนุถูุง ุงูุจุนุถ ุ ุชูุงูุง ูุซู ูููุฏ ุญูููู. <br><br>  ููู ุงููุถุน ูุฒุฏุงุฏ ุณูุกุง ุ ุฃููุณ ูุฐููุ  ุชูููุฐ ุฌูุงุฒ ุงูุฏููุฉ ูุชุญุฑู ุจุดูู ูุชุฒุงูุฏ ุจุนูุฏุง ุนู ุชูููุฐ ุงููููุฏ.  ููุณ ุฐูู ูุญุณุจ ุ ูุธุฑูุง ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุ ูุชู ุชุดููุด ุงูุดูุฑุฉ ุจุงูููุงูุฉ ุ  ุงูููุฏ ูู ุฃูุซุฑ ุชุนููุฏูุง ุจุณุจุจ <code>while</code> ุงูุทูููุฉ ุงูุชู ูุฏููุง ููุง.  ูุชุญููู <code>while</code> ุชุญุชุงุฌ ุฅูู "ูู ุงูุงุฑุชุจุงุท" ุจูุง ุฅูู ุญุงูุงุช.  ูุฐูู ุ ุชุชุถูู ุญุงูุชูุง 1 ูุนูููุง 2.5 ุชูุฑุงุฑ ูู <code>while</code> ุ ูุธุฑูุง ูุฃู <code>yield</code> ุชุชูุณุฑ ูู ุงูููุชุตู.  ุฃุฎูุฑูุง ุ ูุฌุจ ุนููู ุฅุถุงูุฉ ุฑูุฒ ุฅุถุงูู ูุฏูุน ุงูุงุณุชุซูุงุกุงุช ูู ุงููุชุตู ูุงูุนูุณ ุจุงูุนูุณ ุฅุฐุง ูู ููู ููุงู <code>try/catch</code> ูู ุงููููุฏ ููุนุงูุฌุฉ ูุฐุง ุงูุงุณุชุซูุงุก. <br><br>  ููุฏ ูุนูุช ุฐูู !!!  ููุฏ ุฃููููุง ุชุญููููุง ุชูุตููููุง ููุจุฏุงุฆู ุงููุญุชููุฉ ูุชูููุฐ ุงููููุฏุงุช ุ ูุขูู ุฃู ุชููู ูุฏ ูููุช ุจุงููุนู ููู ุชุนูู ุงููููุฏุงุช.  ูู ุงููุฎููุงุช ุงูุฌุงูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ูููููุฏ ุชูููุฏ ุงูููู ุฃู ุงุณุชููุงู ุงูููู ุฃู ูููููุง. </li><li style=";text-align:right;direction:rtl">  ูููู ุฅููุงู ุญุงูุฉ ุงููููุฏ (ุงูุญุงูุฉ ุ ุขูุฉ ุงูุญุงูุฉ ุ ุฃูุณูุ) </li><li style=";text-align:right;direction:rtl">  ูุณูุญ ูู ุงููุชุตู ูุงููููุฏ ุจุชูููู ูุฌููุนุฉ ูู corutin ุ ูุงูุชูุงุนู ูุน ุจุนุถููุง ุงูุจุนุถ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชูุฌูู ุงูุงุณุชุซูุงุกุงุช ูู ุฃู ุงุชุฌุงู. </li></ul><br>  ุงูุขู ูุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ููู ุฃูุถู ูููููุฏุงุช ุ ุฃูุชุฑุญ ุทุฑููุฉ ููุงุฆูุฉ ูุญุชููุฉ ููุชูููุฑ ุญูููุง: ูุฐู ุนุจุงุฑุฉ ุนู ุชุตูููุงุช ุจูุงุก ุฌููุฉ ููููู ูู ุฎูุงููุง ูุชุงุจุฉ ุฅุฌุฑุงุกุงุช ูููุฐุฉ ุจุทุฑููุฉ ุชูุงูุณูุฉ ุชููู ุงูููู ุฅูู ุจุนุถูุง ุงูุจุนุถ ูู ุฎูุงู ููุงุฉ ุชูุฑุฑ ุงูููู ูุงุญุฏูุง ุชูู ุงูุขุฎุฑ ( <code>yield</code> ).  ุณูููู ูุฐุง ูููุฏูุง ูู ุงููุณู ุงูุชุงูู ุ ุญูุซ ุณููุชุฌ ุชูููุฐ <code>co()</code> ูู coroutine. <br><br>  <b>Corutin ุชุญูู ุงูุนูุงุณ</b> <br><br>  ุงูุขู ููุฏ ุฃุตุจุญูุง ูุงูุฑูู ูู ุงูุนูู ูุน ุงููููุฏุงุช ุงูููุฑุจุงุฆูุฉ ุ ุฏุนููุง ูููุฑ ูู ููููุฉ ุงุณุชุฎุฏุงููุง ูู ุงูุจุฑูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ.  ุฅุฐุง ุงุณุชุทุนูุง ูุชุงุจุฉ ุงููููุฏุงุช ุนูู ูุฐุง ุงููุญู ุ ูุฅู ูุฐุง ูุง ูุนูู ุฃู ุงููุนูุฏ ูู ุงููููุฏุงุช ุณูุชู ุญููุง ุชููุงุฆููุง.  ูููู ูููุง ุ ููุณ ุงูููุตูุฏ ูู ุงููููุฏุงุช ุฃู ุชุนูู ุจููุฑุฏูุง.  ูุฌุจ ุฃู ูุชูุงุนููุง ูุน ุจุฑูุงูุฌ ุขุฎุฑ ุ ุงูุฅุฌุฑุงุก ุงูุฑุฆูุณู ุ ุงูุฅุฌุฑุงุก ุงูุฐู ูุณุชุฏุนู <code>.next()</code> ู. <code>.throw()</code> . <br><br>  ูุงุฐุง ูู ูุถุนูุง ููุทู ุฃุนูุงููุง ููุณ ูู ุงูุฅุฌุฑุงุก ุงูุฑุฆูุณู ุ ูููู ูู ุงููููุฏุ  ุนูุฏูุง ุชุญุฏุซ ูููุฉ ุบูุฑ ูุชุฒุงููุฉ ูุนููุฉ ุ ูุซู ุงููุนุฏ ุ ูููุทู ุงูุฃุนูุงู ุ ุณูููู ุงููููุฏ: "ูุง ุฃุฑูุฏ ุฃู ุฃุนุจุซ ูุน ูุฐุง ุงููุฑุงุก ุ ุฃููุธูู ุนูุฏูุง ูุญู" ุ ูุณูุชููู ูุคูุชูุง ููุตุฏุฑ ูุนุฏูุง ุจุฅุฌุฑุงุก ุงูุฅุฌุฑุงุก.  ุฅุฌุฑุงุก ุงูุตูุงูุฉ: "ุญุณููุง ุ ุณุฃุชุตู ุจู ูุงุญููุง."  ุจุนุฏ ุฐูู ูุณุฌู ุฑุฏ ุงุชุตุงู ูุน ูุฐุง ุงููุนุฏ ุ ููุฎุฑุฌ ูููุชุธุฑ ุญุชู ูููู ูู ุงููููู ุชุดุบูู ุฏูุฑุฉ ูู ุงูุฃุญุฏุงุซ (ุฃู ุนูุฏูุง ูุชู ุญู ุงููุนุฏ).  ุนูุฏูุง ูุญุฏุซ ูุฐุง ุ ุณูุนูู ุงูุฅุฌุฑุงุก "ูููุง ุ ุญุงู ุฏูุฑู" ุ ููุฑุณู ุงููููุฉ ุนุจุฑ <code>.next()</code> ูููุฏ ุงูููู.  ุณูู ุชูุชุธุฑ ุงููููุฏ ููููุงู ุจุนููู ุ ููู ุงูููุช ููุณู ุณูู ูููู ุจุฃุดูุงุก ุฃุฎุฑู ุบูุฑ ูุชุฒุงููุฉ ... ูููุฐุง.  ููุฏ ุงุณุชูุนุช ุฅูู ูุตุฉ ุญุฒููุฉ ุญูู ููููุฉ ุงุณุชูุฑุงุฑ ุงูุฅุฌุฑุงุก ูู ุฎุฏูุฉ ุงููููุฏ. <br><br>  ูุฐูู ุ ุงูุนูุฏุฉ ุฅูู ุงูููุถูุน ุงูุฑุฆูุณู.  ุงูุขู ุจุนุฏ ุฃู ุนุฑููุง ููู ุชุนูู ุงููููุฏุงุช ูุงููุนูุฏ ุ ูู ูููู ูู ุงูุตุนุจ ุนูููุง ุฅูุดุงุก ูุซู "ุฅุฌุฑุงุก ุงูุฎุฏูุฉ" ูุฐุง.  ุณูุชู ุชูููุฐ ุฅุฌุฑุงุก ุงูุฎุฏูุฉ ููุณู ุจุดูู ุชูุงูุณู ุจุงุนุชุจุงุฑู ูุนุฏูุง ุ ูุฅูุดุงุก ูุซูู ูููููุฏ ูุตูุงูุชู ุ ุซู ุงูุนูุฏุฉ ุฅูู ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ูุฅุฌุฑุงุกุงุชูุง ุงูุฑุฆูุณูุฉ ุจุงุณุชุฎุฏุงู ุฑุฏ ุงูุงุชุตุงู <code>.then()</code> . <br><br>  ุจุนุฏ ุฐูู ุ ุฏุนูุง ูุนูุฏ ุฅูู ุจุฑูุงูุฌ co () ูููุงูุดุชู ุจูุฒูุฏ ูู ุงูุชูุงุตูู.  <code>co()</code> ูู ุฅุฌุฑุงุก ุฎุฏูุฉ ูุฃุฎุฐ ุนูุงูุฉ ุงูุฑููู ุจุญูุซ ูุง ูุณุชุทูุน ุงููููุฏ ุงูุนูู ุฅูุง ูุน ุงูููู ุงููุชุฒุงููุฉ.  ูุจุฏู ุจุงููุนู ุฃูุซุฑ ููุทููุฉ ุ ุฃููุณ ูุฐููุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> interests = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recommendations = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all( interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))); render(user, interests, recommendations); });</code> </pre> <br> ,     ,   <code>co()</code>      ,  . <br><br> <b>   โ co() </b> <br><br>  ุนุธูู!     <code>co()</code> ,   ,      . <code>co()</code>  <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">    ,    </li><li style=";text-align:right;direction:rtl">   </li><li style=";text-align:right;direction:rtl">  <code>.next()</code>       ,     <code>{done: false, value: [a Promise]}</code> </li><li style=";text-align:right;direction:rtl">      </li><li style=";text-align:right;direction:rtl">    (   ),  <code>.next()</code>  ,         </li><li style=";text-align:right;direction:rtl">  ,    4 </li><li style=";text-align:right;direction:rtl">   -    <code>{done: true, value: ...}</code> ,  ,  <code>co()</code> </li></ol><br>      ,    co(),      : <br><br>  <a href="">ููุท</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deferred</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> resolve(val)); } co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">asyncAdds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialValue</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferred(initialValue + <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferred(initialValue + <span class="hljs-number"><span class="hljs-number">2</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferred(initialValue + <span class="hljs-number"><span class="hljs-number">3</span></span>)); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">co</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">generator</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   }); }</span></span></code> </pre><br> <a href=""></a> <br><br>  , ?  - 10         <code>co()</code> ,        .  ,    .    ? <br><br> <b>   โ    co()</b> <br><br>  ,  , ,  ,  <code>co()</code>     .   ,      <code>.throw()</code>   . <br><br>  <a href="">ููุท</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deferred</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> resolve(val)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deferReject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> reject(e)); } co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">asyncAdds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferred(<span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferredError(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'To fail, or to not fail.'</span></span>))); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'To not fail!'</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> deferred(<span class="hljs-number"><span class="hljs-number">3</span></span>)); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">co</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">generator</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   }); }</span></span></code> </pre> <br> <a href=""></a> <br><br>    .         ,      ,      <code>.next()</code>     <code>onResolve()</code> .      <code>onReject()</code> ,      <code>.throw()</code> .        <code>try/catch</code> ,     ,      <code>try/catch</code>   . <br><br> ,   <code>co()</code> ! ! <code>co()</code>    ,  ,   ,    .     , ? <br><br> <b> : async/await</b> <br><br>         <code>co()</code> .      - ,      async/await?  โ !       ,       <code>async await</code> . <br><br>     async   ,        <code>await</code> ,          <code>yield</code> . <code>await</code>            ,    <code>async</code> .   <code>async</code> -  . <br><br> ,     <code>async/await</code> ,   , -    <code>co()</code>  <code>async</code>  <code>yield</code>  <code>await</code> ,      <code>*</code> ,     . <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> interests = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recommendations = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all( interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))); render(user, interests, recommendations); });</code> </pre> <br> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/self'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> interests = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/user/interests?userId='</span></span> + self.id); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recommendations = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all( interests.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function"> =&gt;</span></span> fetchJson(<span class="hljs-string"><span class="hljs-string">'/api/recommendations?topic='</span></span> + i))); render(user, interests, recommendations); }();</code> </pre> <br> ,      : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <code>co()</code>     . async  ,        . <code>async</code>    <code>co()</code>   <code>co.wrap()</code> . </li><li style=";text-align:right;direction:rtl">  <code>co()</code>   ( <code>yield</code> ) ,  ,     .  <code>async</code>    ( <code>await</code> ) . </li></ul><br> <b></b> <br><br>       Javascript   , ,  ยซ ยป     <code>co()</code> ,  ,    ,    <code>async/await</code> . ?  ุตุญูุญ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434360/">https://habr.com/ru/post/ar434360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434346/index.html">ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง ุจุงูุทุจุน "ุฃูู ุฃูุธูุฉ ุงูููุจููุชุฑ". ูุญุงุถุฑุฉ 22: "ุฃูู ุงููุนูููุงุช ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง" ุ ุงูุฌุฒุก 3</a></li>
<li><a href="../ar434348/index.html">ูู ุชุชุฐูุฑ ูููุฉ ูุฑูุฑู ุนูู ุญุจุฑูุ</a></li>
<li><a href="../ar434354/index.html">ุฅูุดุงุก ูููุฐุฌ ุงูุชุนุฑู ุนูู ุงููุฌูู ุจุงุณุชุฎุฏุงู ุงูุชุนูู ุงูุนููู ูู ุจูุซูู</a></li>
<li><a href="../ar434356/index.html">ุจูุซูู ุณุชููุฑ ูุน ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</a></li>
<li><a href="../ar434358/index.html">ุงุณุชูุฑุงุฏ ุจุฏูู ูุฃูุธูุฉ ุงูุชุดุบูู. ููู ุฃุฑู ูุธุงู ุงูุชุดุบูู ุงููุญูู</a></li>
<li><a href="../ar434362/index.html">ูุง ูุชููุน ูุนุงู 2019</a></li>
<li><a href="../ar434364/index.html">ุฏุนู ูุงุฆูุฉ ุงูุชุธุงุฑ Hangfire</a></li>
<li><a href="../ar434368/index.html">ุชุนูู ุงูุขูุฉ ููุนุซูุฑ ุนูู ุงูุฃุฎุทุงุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ: ููู ุฃูุง ูุชุฏุฑุจ ูู JetBrains ุงูุจุญูุซ</a></li>
<li><a href="../ar434370/index.html">ูุงุชุญ ุธู ุขุฎุฑ ูู Phaser ุ ุฃู ุงุณุชุฎุฏุงู ุงูุฏุฑุงุฌุงุช</a></li>
<li><a href="../ar434374/index.html">ุงูุชุญูู ูู RBAC ูู Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>