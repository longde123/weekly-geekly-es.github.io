<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíáüèø üéã üò£ Nochmals zu phpQuery üé© üôáüèº üîì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gr√º√üe an alle. K√ºrzlich habe ich eine Bestellung aufgegeben, bei der es notwendig war, Daten automatisch auf die Site zu ziehen (mit anderen Worten, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nochmals zu phpQuery</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471644/"> Gr√º√üe an alle.  K√ºrzlich habe ich eine Bestellung aufgegeben, bei der es notwendig war, Daten automatisch auf die Site zu ziehen (mit anderen Worten, schreiben Sie einen Parser). <br><br>  Der Inhalt des Artikels: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorwort</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úber phpQuery</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erste Schritte</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Praktischer Teil</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fazit</a> </li></ul><br><a name="habracut"></a><br><h3><anchor>  Vorwort </anchor></h3><br>  Da ich in PHP arbeite, fiel mein Blick auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PHPQuery-</a> Bibliothek.  Nat√ºrlich stimme ich zu, dass es viele andere Bibliotheken gibt, einschlie√ülich der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">standardm√§√üig in PHP integrierten</a> , aber f√ºr einen normalen Programmierer, der √ºber das Wochenende freiberuflich arbeitet, braucht man eine Art Wunder.  Zum Gl√ºck treibt uns Faulheit alle an.  Eine tschechische Faulheit f√ºhrte zur Schaffung von phpQuery. <br><br>  Ich habe keine Dokumentation in russischer Sprache f√ºr diese Bibliothek gefunden (vielleicht habe ich schlecht ausgesehen?).  Als ich eine Reihe von Fragen von Neulingen in den Foren fand und die Dokumentation nicht auf Englisch lesen konnte, dachte ich dar√ºber nach, diesen Artikel zu schreiben.  Bitte beachten Sie, dass der Artikel haupts√§chlich <b>f√ºr Anf√§nger geschrieben wurde</b> . <br><cut><br><h3><anchor>  Fangen wir an </anchor></h3><br>  PhpQuery ist nicht die schnellste Bibliothek, sondern eine von.  Mit neueren PHP-Versionen ist es fast unsichtbar.  Die Hauptlast liegt nach wie vor beim Laden der Seite. <br>  Es hat viele Funktionen, die in vielen russischsprachigen Handb√ºchern nicht erw√§hnt werden. <br>  Einige Programmierer, ohne phpQuery verstanden zu haben, f√ºhren ihre eigenen Bibliotheken aus (genau wie unsere Kollegen aus der js-Welt).  Ja, diese Bibliothek hat einen gro√üen Nachteil: Der Code ist veraltet, funktioniert aber f√ºr sich. <br><br><h3><anchor>  Starten Sie </anchor>  Arbeit </h3><br>  F√ºr Anf√§nger ist es ziemlich schwierig, sofort zu verstehen, wie phpQuery funktioniert.  Aber ich werde versuchen, alle schwierigen Momente so weit wie m√∂glich zu ‚Äûkauen‚Äú. <br><br>  Viele Methoden dieser Bibliothek zielen darauf ab, mit Dom zu arbeiten, als ob wir an jQuery arbeiten w√ºrden.  Und die Namen dieser Bibliotheken sind so √§hnlich wie m√∂glich. <br><br>  Und so.  Zuerst m√ºssen wir uns f√ºr die Site entscheiden, von der wir den HTML-Code abholen.  Dies muss √ºbrigens keine Site sein.  Wenn wir bereits HTML (XML) in der Datei (Variable) haben, k√∂nnen wir es von dort laden. <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/**  : $siteName = "site.com/";  : $siteName = "index.html"; */</span></span> $html = file_get_contents(<span class="hljs-string"><span class="hljs-string">"$siteName"</span></span>);</code> </pre> <br>  Als n√§chstes m√ºssen wir den resultierenden Code an den phpQuery-Handler √ºbergeben <br><br><pre> <code class="php hljs">$dom = phpQuery::newDocument($html);</code> </pre> <br>  Die Methode "newDocument ()" gibt ein dom-Objekt zur√ºck, mit dem wir arbeiten k√∂nnen. <br><br>  Jetzt k√∂nnen wir etwas in diesem dom-Objekt finden.  Stellen wir uns vor, wir rufen eine Seite einer Site auf, auf der sich ein solcher Block befindet: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"product-essential"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"brand-link"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://-_.com/-_"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"- "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"brand-name"</span></span></span><span class="hljs-tag">&gt;</span></span>- <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"product-name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Jeans Denim<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"price-info"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"price-box"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"regular-price"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"product-price-424337"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"price"</span></span></span><span class="hljs-tag">&gt;</span></span>‚Ç¨ 200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"product-description"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sku"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> ID :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>830214303<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In diesem Beispiel gibt es eine Zeile mit einem Link zu Marke, Markenname, Produktname, Beschreibung, ID und Preis. <br><br><h3><anchor>  Praktisch </anchor>  Teil von </h3><br>  Versuchen wir, alle oben genannten Daten abzurufen. <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   $html = file_get_contents("https://-_.com/"); //   dom $dom = phpQuery::newDocument($html); //    dom    .product-essential,    find().        . foreach($dom-&gt;find(".product-essential") as $key =&gt; $value){ //  dom    phpQuery.       pq();    ($)  jQuery. $pq = pq($value); //        .brand-link     "href"    attr(); $productHref[$key]["brand-href"] = $pq-&gt;find(".brand-link")-&gt;attr("href"); //   .     &lt;span class="brand-name"&gt;- &lt;/span&gt;. //    ,   &lt;span&gt;       text(); $productHref[$key]["brand-name"] = $pq-&gt;find(".brand-name")-&gt;text(); //      . //    ,      . //         &lt;h1&gt;,     &lt;div class="brand-name"&gt; $productHref[$key]["product-name"] = $pq-&gt;find(".product-name h1")-&gt;text(); // PhpQuery    ,    , . //      ! //     . $productHref[$key]["product-price"] = $pq-&gt;find(".price-info .price-box .regular-price .price")-&gt;text(); //    $productHref[$key]["product-description"] = $pq-&gt;find(".description .product-description")-&gt;text(); //       . //      next(); //           . $productHref[$key]["product-id"] = $pq-&gt;find(".description .sku span")-&gt;next()-&gt;text(); }</span></span></code> </pre><br>  Am Ausgang erhalten wir dieses Array: <br><br><pre> <code class="xml hljs">Array ( [0] =&gt; Array ( [brand-href] =&gt; https://-_.com/-_ [brand-name] =&gt; -  [product-name] =&gt; Jeans Denim [product-price] =&gt; ‚Ç¨ 200 [product-description] =&gt;   [product-id] =&gt; 830214303 ) )</code> </pre><br><h3><anchor>  Fazit </anchor></h3><br>  PhpQuery ist eine sehr praktische Bibliothek, aber leider zu schwer.  Nach dem Durchlaufen der Elemente wird empfohlen, das Dokument zu entladen: <br><br><pre> <code class="php hljs">phpQuery::unloadDocuments();</code> </pre> <br>  Trotz der Bequemlichkeit der Bibliothek rate ich Ihnen, sich nicht daran zu gew√∂hnen.  Es ist wahrscheinlich am besten geeignet, um kleine Probleme zu l√∂sen.  Aber das ist immer noch eine etwas veraltete Bibliothek. <br><br>  Diese Bibliothek bietet die M√∂glichkeit, Elemente im laufenden Betrieb hinzuzuf√ºgen.  Wir werden dieses Thema jedoch im n√§chsten Artikel ansprechen. </cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de471644/">https://habr.com/ru/post/de471644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de471630/index.html">Verbotenes Vergn√ºgen: In welchen L√§ndern ist PornHub gesperrt und warum?</a></li>
<li><a href="../de471634/index.html">So bauen Sie E-Mail-Marketing in einem Unternehmen auf und vermeiden Probleme: 6 praktische Schritte</a></li>
<li><a href="../de471636/index.html">Unbemanntes Fahrzeug: Animationsalgorithmen. Yandex-Bericht</a></li>
<li><a href="../de471640/index.html">Ein √úberblick √ºber anonyme Blockchain-Analysetechniken</a></li>
<li><a href="../de471642/index.html">Zeitkiller von Kindheit an</a></li>
<li><a href="../de471650/index.html">KI-Pizza: Wie wir zwei wiederkehrende neuronale Netze verwendet haben</a></li>
<li><a href="../de471652/index.html">Mein Leben mit Boost Graph Library</a></li>
<li><a href="../de471654/index.html">Wie wir ein frostbest√§ndiges Internet-of-Things-Ger√§t entwickelt haben</a></li>
<li><a href="../de471658/index.html">Telefonbetr√ºger. Die erste Aktion, bei der mir freundlicherweise von anderen Betr√ºgern erz√§hlt wird</a></li>
<li><a href="../de471660/index.html">Vorlesung √ºber Spielerpsychologie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>