<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜí ‚¨áÔ∏è ‚ö†Ô∏è KiQ joke cat ou comment nous avons fabriqu√© un jouet parlant pour adultes üë©üèª‚Äçüî¨ üòî üì©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le monde, il y a une quantit√© incroyable de jouets parlants pour les enfants et cela ne fait que donner l'impression que les adultes s'ennuient. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>KiQ joke cat ou comment nous avons fabriqu√© un jouet parlant pour adultes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/398389/"><img src="https://ksr-ugc.imgix.net/assets/013/958/564/d6c061618e04b2f7d81d1d88c07c543d_original.jpg?w=680&amp;fit=max&amp;v=1475469443&amp;auto=format&amp;q=92&amp;s=94a8eb1e4d730d541ec407637a1490ee" alt="Jouet Kiq"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans le monde, il y a une quantit√© incroyable de jouets parlants pour les enfants et cela ne fait que donner l'impression que les adultes s'ennuient. </font><font style="vertical-align: inherit;">Notre √©quipe a d√©cid√© de rectifier cette situation.</font></font><br>
<a name="habracut"></a><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le d√©but de l'histoire</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout a commenc√© avec le fait qu'une </font><font style="vertical-align: inherit;">pens√©e brillante est venue </font><font style="vertical-align: inherit;">√† l'esprit curieux d'un de mes amis et d'un coll√®gue de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netnet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : pourquoi pas seulement des enfants, mais aussi des adultes pour amuser des blagues th√©matiques? L'avantage du fer abordable et bien √©prouv√© n'est d√©sormais jamais une raret√©, et il peut non seulement clignoter avec des lumi√®res, mais aussi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chanter des chansons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä cet √©gard, il m'a appel√© et m'a propos√© de </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©p√©ter l'exploit √©pique pour</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m'assurer que ESP8266 joue de la musique MP3 sur le r√©seau afin que ce soit bon et que </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">si le hamster se d√©chire,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y a </font><s><font style="vertical-align: inherit;">-</font></s><font style="vertical-align: inherit;"> t </font><s><font style="vertical-align: inherit;">-</font></s><font style="vertical-align: inherit;"> il vraiment assez de performances, ce que j'ai fait lors d'un rapide cong√© du Nouvel An en 2016:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pW-BoVe46O8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP8266 joue une radio Internet sur la vid√©o, √©mettant du son en utilisant le PWM 5 bits via le piratage I2S. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cependant, la lecture de la radio MP3 √† partir d'Internet a consomm√© la quasi-totalit√© de la ressource ESP8266 et sonnait "so-so", alors que l'imagination nous attirait d√©j√† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">quelque chose de plus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qu'une simple colonne de radio MP3. </font><font style="vertical-align: inherit;">Avec ces impulsions cr√©atives, nous sommes all√©s √† notre √©quipe et au chef bien-aim√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vladimir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s un petit brainstorming, une image plus d√©taill√©e et m√™me une </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cha√Æne logique</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de ce que nous voulons non seulement, mais pouvons faire:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour remplacer MP3 par quelque chose de moins gourmand en ressources et plus libre, nous nous sommes arr√™t√©s chez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn a port√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec succ√®s et rapidement sur ESP8266.</font></font><br>
<br>
</li>
<li>           SD , ..    ,    ESP8266     ‚Äî    .<br>
<br>
</li>
<li> ¬´ ¬ª  - ,     random .     ,        .         Apple Notification Center Service (ANCS),     iPod, iPhone  iPad.<br>
<br>
</li>
<li>     Bluetooth Low Energy (BLE),            .<br>
<br>
</li>
<li>                .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pawn language</a>.<br>
<br>
</li>
<li>       ,           ‚Äî          ¬´¬ª  ¬´¬ª (),   -        .</li>
</ul><br>
<h3> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©part, je voulais cr√©er un prototype tr√®s simple mais pleinement fonctionnel sur une carte tout-en-un, nous avons donc d√©cid√© d'essayer </font><font style="vertical-align: inherit;">MediaTek </font><font style="vertical-align: inherit;">sur </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LinkIt ONE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">netsnail a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> presque imm√©diatement r√©ussi. Il y avait une connexion avec le t√©l√©phone et la carte SD MP3 jouait parfaitement. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il semblerait - ici, c'est le bonheur et une plate-forme pr√™te √† l'emploi! Mais ensuite, nous avons √©t√© confront√©s √† la </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dure r√©alit√© des</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limites de leur SDK ferm√© et l'euphorie est pass√©e. </font></font><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons r√©alis√© que la plate-forme finie sur une planche, satisfaisant tous nos souhaits, n'√©tait pas dans la nature, ce qui signifie que nous devions la cr√©er √† partir de z√©ro.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc d√ª choisir (f√©vrier 2016) la puce BLE la plus adapt√©e, qui devait √™tre connect√©e √† l'ESP8266. </font><font style="vertical-align: inherit;">En tant que connexion entre l'ESP8266 et la puce BLE (nous ne savions pas encore de quel type de puce il s'agissait), nous avons d√©cid√© d'utiliser le TWI standard (I2C). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais avec BLE, le choix n'√©tait pas tr√®s grand alors:</font></font><br>
<br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TI CC2541</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Je ne l' </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">aimais</font></a><font style="vertical-align: inherit;"> pas tout de suite en raison de l'architecture de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8051</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et 8 Ko de RAM semblaient une vie facile sans promesse, compte tenu du nombre de services BLE et des caract√©ristiques dont nous avions besoin dans le jouet.</font></font><br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BCM20732</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - cela semblait tr√®s prometteur, mais en fait le SDK s'est av√©r√© tr√®s grossier, et le "trousseau" Broadcom WICED Smart BLE est tellement bogu√© que je n'√©crirai rien ici pour ne pas jurer. </font><font style="vertical-align: inherit;">Faites-moi savoir si la situation s'est am√©lior√©e maintenant.</font></font><br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nRF52832</a> ‚Äî  ,   .      BLE  ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">rekod</a>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>, SDK  ,    <i></i> .  BLE ANCS          iPhone    UART.           SEGGER J-Link,       .<br>
<br>
</li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nRF51822</a> ‚Äî      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>,     SEGGER  nRF52832.      ‚Äî     nRF52832     nRF51822  !</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, le premier fer ressemblait </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√† une araign√©e tarentule</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quelque chose comme ceci: il </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic1.jpg" alt="araign√©e de fer"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√©tait tr√®s triste d'attraper des probl√®mes en raison de la chute de c√¢bles Dupont, en particulier sur le module nRF51822, o√π les broches √©taient un peu plus petites.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Services BLE sur nRF51822 et application iOS</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√©anmoins, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affaire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et moi </font><font style="vertical-align: inherit;">d√©j√† sur ce fer araign√©e </font><font style="vertical-align: inherit;">avons </font><font style="vertical-align: inherit;">commenc√© √† impl√©menter les services et fonctionnalit√©s BLE sur nRF51822, divisant le tout en deux:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Service Apple Notification Center ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ANCS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) - pour recevoir des notifications d'√©v√©nements d'un smartphone.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apple Current Time Service (CTS) - une fois connect√©, le jouet prend du temps sur le t√©l√©phone.</font></font></li>
<li>HandShake Service (HSS) ‚Äî  , ,   ¬´¬ª        .   ,     lientID      pair     Bluetooth,    ,      .      ,    .</li>
<li>Battery As Service (BAS) ‚Äî       .</li>
<li>Content Service (CONTS) ‚Äî       ,   (     ).</li>
<li>Settings Service (SETTS) ‚Äî       ,      (, )  ..</li>
</ul><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MaximKit faisait</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en m√™me temps une </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application pour iOS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img src="https://ksr-ugc.imgix.net/assets/013/983/125/8dfbfd651b320b4818fa9ed65ebf67fc_original.jpg?w=680&amp;fit=max&amp;v=1475618060&amp;auto=format&amp;q=92&amp;s=952c7ac032d25e8b72ec4425cad5891d" alt="image"><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'image de droite montre l'√©cran principal de l'application. </font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n'a pas pu supporter nos souffrances en raison de la chute de fils et a fabriqu√© le </font><font style="vertical-align: inherit;">premier prototype normal </font><font style="vertical-align: inherit;">√† la maison avec un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fer √† repasser laser</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic2.jpg" alt="premier prototype plus ou moins"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
il n'est pas visible sur la photo, mais il y a d√©j√† un emplacement pour carte microSD. </font><font style="vertical-align: inherit;">Sur le petit ch√¢le carr√© ci-dessous - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALC5627</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , le son √©tait d√©j√† bien meilleur que le PWM 5 bits via I2S. </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">AXP209 a √©t√©</font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
choisi pour la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">gestion de l'</font></a><font style="vertical-align: inherit;"> alimentation</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Vous permet de charger et d'utiliser la batterie en m√™me temps, ainsi que de surveiller son √©tat. </font><font style="vertical-align: inherit;">La puce est tr√®s courante, mais poss√®de de nombreuses sp√©cificit√©s √† la fois dans la programmation et dans les composants externes requis, les soi-disant </font><font style="vertical-align: inherit;">"Harnais".</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Magie sur l'ESP8266</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parall√®lement √† cela, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flexxnn a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> port√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Speex</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FatFs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur l'ESP8266, a fait un chargeur de d√©marrage pour l'ESP8266 et le nRF51822 afin qu'il soit possible de ne pas mettre √† jour le firmware par fil, mais pour ce faire en pla√ßant les fichiers du firmware sur une carte microSD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Personnellement, il me semble que les extraterrestres l'ont aid√©, puisqu'il a fait tout cela en un mois environ. Mais il n'admet pas √™tre en contact avec un esprit √©tranger. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis le deuxi√®me prototype plus normal: </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic3.jpg" alt="premier prototype plus ou moins"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le prototype plus normal n'est plus mont√© dans une peluche. Et m√™me s'il montait, alors avec un mouvement brusque sur un utilisateur potentiel √† partir d'un jouet, un ¬´√©tranger¬ª grimperait, ce qui bien s√ªr √©tait inacceptable pour MVP. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, il a √©t√© d√©cid√© de facturer des honoraires aux professionnels et c'est ce qui s'est produit en cons√©quence:</font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic4.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un tel design s'int√®gre d√©j√† parfaitement dans le chat, bien qu'il semble en quelque sorte inhumain: </font></font><br>
<br>
<img src="https://kiqup.com/sites/default/files/images/pic5.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En m√™me temps, les craintes ont √©t√© confirm√©es que les √©v√©nements du t√©l√©phone pourraient arriver assez souvent et en cons√©quence, l'utilisateur serait ennuy√© au lieu de s'amuser. Une logique de filtrage flexible √©tait n√©cessaire, qui peut √™tre facilement modifi√©e √† tout moment sans clignoter. √Ä cet √©gard, apr√®s avoir √©tudi√© le mat√©riel et r√©alis√© qu'il n'y a pas de scripts rapides et compacts pour ESP8266 (Lua et microPython sont des interpr√®tes), j'ai d√©cid√© de porter le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">langage Pawn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui ex√©cute rapidement (seulement 18 fois plus lentement que le natif) un bytecode compact. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soit dit en passant, les sources Pawn sont tr√®s similaires √† C, c'est donc un plaisir de modifier les scripts - il suffit de les compiler en bytecode AMX et de les copier sur une carte SD.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gadgets de triche. </font><font style="vertical-align: inherit;">Faire semblant d'√™tre iOS sur Android</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et puis ¬´soudainement¬ª, nous nous sommes tous souvenus que les t√©l√©phones Android dans le monde n'√©taient pas si petits, mais encore plus que les t√©l√©phones avec iOS. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, j'ai d√ª ralentir pour v√©rifier si nous pouvions </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tromper les gadgets et faire semblant d'√™tre iOS sur Android</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> afin qu'ils voient le service ANCS indiscernable d'Apple. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fin de compte, tout a fonctionn√© et apr√®s une semaine, les gadgets (et notre chat ne fait pas exception) ont sinc√®rement cru que j'avais un iPhone avec un service ANCS, se connectant √† mon Nexus 5 et m√™me √† l'ancien Samsung Galaxy avec Android 4.4.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Passez au cloud</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√âtant donn√© que personne n'aime √©couter une blague plusieurs fois (fait), et qu'il existe √©galement des pr√©f√©rences et des restrictions culturelles, il a √©t√© d√©cid√© pour chaque utilisateur de cr√©er une liste de lecture unique. Pour ce faire, l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">affaire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est venue √† bout du serveur dans le cloud. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais comment d√©cider qui l'aimera? C'est vrai - laissez l'utilisateur d√©cider! Pour ce faire, j'ai effectu√© une d√©tection basique des gestes sur l'acc√©l√©rom√®tre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIS3DH</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de STMicroelectronics. J'ai aim√© la blague - j'ai inclin√© le chat, comme si "oui", je n'aimais pas la blague - j'ai inclin√© sur le c√¥t√©, comme si "non". </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et il a ajout√© un "oublie-moi" pour le t√©l√©phone - si la connexion BLE dispara√Æt et que l'acc√©l√©rom√®tre d√©tecte le mouvement, alors le chat est transport√© quelque part et le t√©l√©phone a √©t√© oubli√©.</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s que l'utilisateur ¬´polikal¬ª et ainsi d√©sign√© ses pr√©f√©rences - les informations vont √† un serveur o√π les ¬´g√©nomes¬ª des listes de lecture sont compar√©s et de nouveaux ensembles de blagues sont g√©n√©r√©s pour l'utilisateur. </font><font style="vertical-align: inherit;">Mais c'est un sujet pour un article s√©par√©.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©sum√©</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En cons√©quence, le divertissement s'est av√©r√© √™tre une excellente plate-forme qui peut:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">communiquer avec le t√©l√©phone via BLE et recevoir des notifications d'√©v√©nements;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">communiquer via WiFi et t√©l√©charger le contenu et les mises √† jour du firmware;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enregistrer et lire des fichiers en FAT32 sur microSD;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jouer des blagues remplies de codec speex;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D√©terminer les pr√©f√©rences de l'utilisateur √† l'aide d'un acc√©l√©rom√®tre (d√©tection de gestes)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cr√©er des listes de lecture pour chaque utilisateur en fonction de ses pr√©f√©rences en mati√®re d'humour;</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ce qui est remarquable, les ¬´poign√©es tr√®s intelligentes¬ª peuvent bien √™tre connect√©es aux broches correspondantes (m√™me les trous pour les connecteurs sur la carte sont laiss√©s) et ¬´sage le chat¬ª comme bon leur semble. </font><font style="vertical-align: inherit;">Cela rend la plate-forme tout-en-un attrayante pour les geeks. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec cette plate-forme, nous sommes all√©s sur kickstarter, appelant le jouet fini KiQ. </font><font style="vertical-align: inherit;">Le premier jour, 40% ont √©t√© collect√©s, et maintenant 57%. </font><font style="vertical-align: inherit;">Mais c'est une histoire compl√®tement diff√©rente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Merci √† tous ceux qui ont lu cette ligne. </font><font style="vertical-align: inherit;">En attente de questions int√©ressantes de votre part.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr398389/">https://habr.com/ru/post/fr398389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr398377/index.html">Qu'est-ce que l'information en termes de physique?</a></li>
<li><a href="../fr398379/index.html">Votre taxi sans pilote arrive</a></li>
<li><a href="../fr398381/index.html">Prototype de robot acc√©l√©r√© Arduino</a></li>
<li><a href="../fr398385/index.html">Illusions du cerveau. La premi√®re hallucination universelle au monde</a></li>
<li><a href="../fr398387/index.html">Attaque de voiture: bataille f√©roce</a></li>
<li><a href="../fr398391/index.html">"Gris, souffle, cool ...", ou la logique du contr√¥le climatique dans une maison intelligente</a></li>
<li><a href="../fr398393/index.html">Le Nikon D5500a r√©frig√©r√© prend de superbes photos spatiales</a></li>
<li><a href="../fr398395/index.html">Wow: le nobel au lieu des ondes gravitationnelles a √©t√© donn√© pour la topologie</a></li>
<li><a href="../fr398397/index.html">Des sources de rayons X ultra-brillantes ont √©t√© trouv√©es dans deux vieilles galaxies. Un nouveau ph√©nom√®ne naturel?</a></li>
<li><a href="../fr398399/index.html">Auto digest: Technologies du pr√©sent et du futur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>