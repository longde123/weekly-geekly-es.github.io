<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¾â€ğŸŒ¾ ğŸ‘¥ â˜ğŸ¿ ä½¿ç”¨Arduinoå’ŒNode.jsä»æ”¾å¤§å™¨é€šè¿‡é¥æ§å™¨æ§åˆ¶è®¡ç®—æœº ğŸ…ğŸ¾ âš”ï¸ ğŸ®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‰è¨€ 


æ•…äº‹å§‹äºåŠå¹´å‰æˆ‘è´­ä¹°äº†Yamaha A-S501æ”¾å¤§å™¨çš„äº‹å®ã€‚ 


  


 é™„å¸¦çš„é¥æ§å™¨å¯ä»¥æ§åˆ¶æ”¾å¤§å™¨å’ŒYamaha CDæ’­æ”¾å™¨ï¼Œè€Œæˆ‘è‡ªç„¶æ²¡æœ‰ã€‚ å› æ­¤ï¼Œæ ¹æœ¬æ²¡æœ‰ä½¿ç”¨é¥æ§å™¨ä¸Šçš„å¤§å¤šæ•°æŒ‰é’®ã€‚ é€šå¸¸ï¼Œæ§åˆ¶å°æœ¬èº«ä¸æ˜¯å¿…éœ€çš„ï¼Œå®ƒæ€»æ˜¯æ”¾åœ¨æ¶å­ä¸Šã€‚ 


 ä½†æ˜¯ï¼Œçœ‹ç€ä»–ï¼Œæˆ‘è¢«æœ€å¤§ç¨‹åº¦åœ°ä½¿ç”¨é¥æ§å™¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Arduinoå’ŒNode.jsä»æ”¾å¤§å™¨é€šè¿‡é¥æ§å™¨æ§åˆ¶è®¡ç®—æœº</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453474/"><h1 id="predislovie"> å‰è¨€ </h1><br><p>æ•…äº‹å§‹äºåŠå¹´å‰æˆ‘è´­ä¹°äº†Yamaha A-S501æ”¾å¤§å™¨çš„äº‹å®ã€‚ </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/el/pv/n0/elpvn0xtgl_tfu_q4qmy4lkvwoq.jpeg" alt="é›…é©¬å“ˆA-S501"></a> </p><br><p> é™„å¸¦çš„é¥æ§å™¨å¯ä»¥æ§åˆ¶æ”¾å¤§å™¨å’ŒYamaha CDæ’­æ”¾å™¨ï¼Œè€Œæˆ‘è‡ªç„¶æ²¡æœ‰ã€‚ å› æ­¤ï¼Œæ ¹æœ¬æ²¡æœ‰ä½¿ç”¨é¥æ§å™¨ä¸Šçš„å¤§å¤šæ•°æŒ‰é’®ã€‚ é€šå¸¸ï¼Œæ§åˆ¶å°æœ¬èº«ä¸æ˜¯å¿…éœ€çš„ï¼Œå®ƒæ€»æ˜¯æ”¾åœ¨æ¶å­ä¸Šã€‚ </p><br><p> ä½†æ˜¯ï¼Œçœ‹ç€ä»–ï¼Œæˆ‘è¢«æœ€å¤§ç¨‹åº¦åœ°ä½¿ç”¨é¥æ§å™¨çš„æƒ³æ³•æ‰€å›°æ‰°ã€‚ ä¾‹å¦‚ï¼Œèººåœ¨æ²™å‘ä¸Šçœ‹ç”µå½±ï¼Œå¿«é€Ÿç§»åŠ¨æ‰‹åé€€ï¼Œæš‚åœç­‰ä¼šå¾ˆæ–¹ä¾¿ã€‚ å½“ç„¶ï¼Œå‡ºäºè¿™äº›ç›®çš„ï¼Œæˆ‘æ›¾ç»ä½¿ç”¨æ™ºèƒ½æ‰‹æœºä¸Šçš„åº”ç”¨ç¨‹åºæ¥æ§åˆ¶MPC-HCï¼ŒFoobar2000ç¨‹åºï¼Œä½†æ˜¯è¿œç¨‹æ§åˆ¶å°†æ›´å¿«ï¼Œæ›´æ–¹ä¾¿ã€‚ </p><br><p> å°±åƒä»–ä»¬è¯´çš„é‚£æ ·ï¼Œçœ¼ç›åœ¨å®³æ€•ï¼ŒåŒæ‰‹åœ¨åšã€‚ é€šè¿‡é€‰æ‹©æŠ€æœ¯ï¼Œä¸€åˆ‡éƒ½å°†ä¸€ç›®äº†ç„¶ã€‚  Arduino-æˆ‘å¾ˆæƒ³å’Œå¥¹ä¸€èµ·ç©ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æœºä¼šã€‚ å¯¹äºæŒ‰é’®å¤„ç†ç¨‹åºï¼ŒNode.jsï¼Œå› ä¸º æˆ‘ä¸“æ³¨äºjavascriptï¼Œå¹¶ä¸”ä¸æƒ³åˆ‡æ¢ä¸Šä¸‹æ–‡ã€‚ </p><br><p> æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹... </p><a name="habracut"></a><br><h1 id="gotovye-resheniya"> ç°æˆçš„è§£å†³æ–¹æ¡ˆ </h1><br><p> æˆ‘å¯ä»¥æ‰¾åˆ°çš„ç°æœ‰ç±»ä¼¼ç‰©ä¹‹ä¸€æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Flirc</a> ã€‚ ä½¿ç”¨å®ƒï¼Œæ‚¨å¯ä»¥åœ¨è®¡ç®—æœºçš„ç‰©ç†é”®ç›˜ä¸Šæ¨¡æ‹Ÿå‡»é”®ã€‚ </p><br><img width="200" src="https://habrastorage.org/webt/cf/nm/vu/cfnmvujsms2igsg7jek8gxzyfu0.jpeg"><br><p> è¿™ç§çº¢å¤–æ¥æ”¶å™¨çš„ä»·æ ¼ä¸º100å…¹ç½—æï¼ˆçº¦åˆ28ç¾å…ƒï¼‰ã€‚ å±•æœ›æœªæ¥ï¼Œå®ƒçš„ä»·æ ¼æ˜¯æˆ‘çš„ä¸¤å€ã€‚ å¦å¤–ï¼Œåœ¨åŠŸèƒ½æ–¹é¢ï¼Œç»“æœæ›´å¥½ï¼ˆä¸»è§‚ï¼‰ã€‚ </p><br><h1 id="pokupka-detaley"> é‡‡è´­é›¶ä»¶ </h1><br><p><img width="200" src="https://habrastorage.org/webt/lq/ud/1x/lqud1xzv9gxeuhfyzouyq4swkhm.jpeg"><img width="200" src="https://habrastorage.org/webt/zh/vh/o6/zhvho6cvrv_uvs2fgqys4rtxkqo.jpeg"><img width="200" src="https://habrastorage.org/webt/jp/0x/65/jp0x65iitktmisnasrjkhnvja4w.jpeg"><img width="200" src="https://habrastorage.org/webt/go/bg/tu/gobgturuqnltrpkucsy5ar_gmnm.jpeg"><img width="200" src="https://habrastorage.org/webt/s6/kj/wy/s6kjwyoy-4r4vtkze8vj8pxxxrg.jpeg"></p><br><p> æˆ‘éœ€è¦ï¼š </p><br><ul><li> å®é™…ä¸Šï¼ŒArduino Unoå¼€å‘æ¿æœ¬èº«ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸æ˜¯åŸå§‹æ¿ï¼Œè€Œæ˜¯æŸç§æ³¢å…°å…‹éš†ã€‚ æ ¹æ®æè¿°-å®ƒä¸åŸå§‹ç‰ˆæœ¬å®Œå…¨ç›¸ä¼¼ã€‚  ï¼ˆ27.90zÅ‚ï¼‰ </li><li> çº¢å¤–æ¥æ”¶å™¨VS1838B HX1838ï¼ˆç”µå‹ï¼š3.3-5 Vï¼Œé¢‘ç‡ï¼š38 kHzï¼Œè§’åº¦ï¼š90Â°ï¼‰ï¼ˆ1.30zÅ‚ï¼‰ </li><li> åŸå‹æ¿+ç”µçº¿ï¼ˆ13.90zÅ‚ï¼‰ </li><li> ç”¨ä¸€å—ç©ºæ¿ç„Šæ¥æ‰€æœ‰ä¸œè¥¿ï¼ˆ2.10zÅ‚ï¼‰ </li><li> è¿æ¥æ¿çš„è¿æ¥å™¨ï¼ˆ2,51zÅ‚ï¼‰ </li></ul><br><p> æ€»è®¡ï¼š47,71zÅ‚ï¼ˆâ‰ˆ$ 14ï¼‰ </p><br><h1 id="programmnoe-obespechenie"> è½¯ä½“ç±» </h1><br><p> åœ¨ç­‰å¾…äº¤ä»˜æ—¶ï¼Œæˆ‘å¼€å§‹ç¼–å†™â€œé©±åŠ¨ç¨‹åºâ€ï¼Œè¯¥é©±åŠ¨ç¨‹åºåº”ä»Arduinoçš„ä¸²è¡Œç«¯å£è¯»å–æ•°æ®ï¼Œå¹¶å¯¹é¥æ§å™¨ä¸Šçš„æŒ‰ä¸‹æŒ‰é’®æ‰§è¡ŒæŸäº›æ“ä½œã€‚ </p><br><p> æƒ³æ³•æ˜¯èƒ½å¤Ÿè‡ªå®šä¹‰æ‰€æœ‰å†…å®¹ã€‚ å¯ä»¥ä¸ºé¥æ§å™¨ä¸Šçš„æ¯ä¸ªæŒ‰é’®åˆ†é…æŸäº›ç±»å‹çš„æŸäº›æ“ä½œï¼š </p><br><ul><li> åœ¨é”®ç›˜ä¸Šæ¨¡æ‹ŸæŒ‰é”®ï¼ˆé€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">node-key-sender</a> ï¼‰ï¼š </li></ul><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"key"</span></span>: <span class="hljs-string"><span class="hljs-string">"space"</span></span> }</code> </pre> <br><ul><li> ä½¿ç”¨å‚æ•°è¿è¡Œä»»æ„ç¨‹åºï¼š </li></ul><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"exec"</span></span>: [<span class="hljs-string"><span class="hljs-string">"c:\\Program Files (x86)\\foobar2000\\foobar2000.exe"</span></span>, <span class="hljs-string"><span class="hljs-string">"/play"</span></span>] }</code> </pre> <br><ul><li> æ¡ä»¶ï¼ˆä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ps-list</a> ï¼‰ï¼š </li></ul><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"if"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"running"</span></span>: <span class="hljs-string"><span class="hljs-string">"mpc-hc.exe"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"then"</span></span>: [ ... ], <span class="hljs-attr"><span class="hljs-attr">"else"</span></span>: [ ... ] }</code> </pre> <br><p> æ¯ç§ç±»å‹éƒ½æœ‰è‡ªå·±çš„å¤„ç†ç¨‹åºï¼Œè¿™äº›å¤„ç†ç¨‹åºå…·æœ‰ç›¸åŒçš„APIï¼Œå› æ­¤å¯ä»¥å°†æ‰€æœ‰å†…å®¹æŠ˜å åˆ°ä¸€ä¸ªç®€å•çš„å¾ªç¯ä¸­ï¼Œè¯¥å¾ªç¯æŒ‰é¡ºåºå¯åŠ¨æ‰€æœ‰å¤„ç†ç¨‹åºã€‚ </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> runHandlers = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./handlers'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">actions</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.isArray(actions)) { actions = [actions] } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> act <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> actions) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> runHandlers(act) } }</code> </pre> <br><p> æµ‹è¯•å¯ä»¥å‘Šè¯‰æ‚¨æ‰€æœ‰å†…å®¹ï¼Œè€Œä¸æ˜¯ä¸€åƒä¸ªæ–‡æ¡£çš„å•è¯ï¼š </p><br><pre> <code class="plaintext hljs">run when "exec" action âˆš executes the specified file without args (as array) (4ms) âˆš executes the specified file without args (as string) (1ms) âˆš executes the specified file with args âˆš rejects if "exec" has wrong type (5ms) when "key" action âˆš sends the specified key press if passed string (1ms) âˆš sends the specified key combination if passed array âˆš rejects if "key" has wrong type (1ms) when "if" action âˆš rejects if no "then" (1ms) âˆš rejects if operator is not supported when operator if "running" âˆš runs "then" actions if the condition is true (1ms) âˆš runs "else" actions if the condition is false âˆš does not run anything if the condition is false and no "else" statement (1ms) when multiple actions âˆš executes all actions (1ms) when multiple actions are mixed into one âˆš runs only first one alphabetically</code> </pre> <br><p> ç­‰å¾…çè´µçš„ç»†èŠ‚ä»ç„¶æ˜¯ç­‰å¾…ã€‚ </p><br><h1 id="zhelezo"> é“ </h1><br><p> æˆ‘æ‰¿è®¤ï¼Œæˆ‘æ²¡æœ‰å‘æ˜ä»»ä½•æ–°ä¸œè¥¿ï¼Œæ‰€æœ‰ä¸€åˆ‡éƒ½å·²ç»æ‘†åœ¨æˆ‘é¢å‰ã€‚ æˆ‘åªæ˜¯ä½¿ç”¨äº†æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><em>å¦‚ä½•åœ¨Arduinoä¸Šè®¾ç½®IRé¥æ§å™¨å’Œæ¥æ”¶å™¨</em></a>çš„ç°æˆå›¾è¡¨ã€‚ </p><br><p> è¯¥æ–¹æ¡ˆéå¸¸ç®€å•ï¼š </p><br><p><img src="https://habrastorage.org/webt/vf/aw/tp/vfawtp0mfsiprlpegqzgmmcc04k.png"></p><br><p> åœ¨å®è·µä¸­ï¼š </p><br><p><img src="https://habrastorage.org/webt/r3/c1/hn/r3c1hnw-hgy4dilsdgxnowpfehw.jpeg"></p><br><p><img src="https://habrastorage.org/webt/k1/ak/-z/k1ak-zmwawwc1ng3_c3lty2imha.jpeg"></p><br><h1 id="proshivka"> éŸ§ä½“ </h1><br><p> æˆ‘è¿˜è€å®åœ°ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡ç« ä¸­</a>å€Ÿç”¨äº†å›ºä»¶ï¼Œå› ä¸ºå®ƒçš„å·¥ä½œï¼Œæˆ‘å°†éœ€è¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IRremote Arduinoåº“</a> ã€‚ </p><br><p> æˆ‘ç”¨é¥æ§å™¨ä¸Šçš„å®é™…æŒ‰é’®ä»£ç æ›¿æ¢äº†æŒ‰é’®ä»£ç ï¼š </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (irrecv.decode(&amp;results)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (results.value == <span class="hljs-number"><span class="hljs-number">0xFFFFFFFF</span></span>) { results.value = key_value; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (results.value) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x9E6140BF</span></span>: Serial.println(<span class="hljs-string"><span class="hljs-string">"play"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x9E61AA55</span></span>: Serial.println(<span class="hljs-string"><span class="hljs-string">"pause"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* ...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x5EA1A857</span></span>: Serial.println(<span class="hljs-string"><span class="hljs-string">"cd"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: Serial.println(results.value, HEX); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } key_value = results.value; irrecv.resume(); } }</code> </pre> <br><p><img src="https://habrastorage.org/webt/xk/pv/xb/xkpvxb_frxgoxvuaftqij9zj5ji.png"></p><br><p> ä¸€æ—¦æŒ‰ä¸‹çš„æŒ‰é’®çš„åç§°å‡ºç°åœ¨Arduino IDEçš„ç«¯å£Monitorçª—å£ä¸­ï¼Œå°±éœ€è¦å‘é©±åŠ¨ç¨‹åºæ·»åŠ ä¸€ä¸ªç”¨äºä½¿ç”¨ä¸²è¡Œç«¯å£çš„ç»„ä»¶ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»“æœæ˜¯</a>å¯¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸²è¡Œç«¯å£</a>åº“<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>åŒ…è£…ï¼Œå®é™…ä¸Šæ˜¯æ¥è‡ªç«¯å£çš„æ•°æ®æµï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SerialPort = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'serialport'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SerialPortReader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(port) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> serialPort = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialPort(port) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lineStream = serialPort.pipe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialPort.parsers.Readline()) } start(handler) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lineStream.on(<span class="hljs-string"><span class="hljs-string">'readable'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lineStream.read().trim() handler(data) }) } }</code> </pre> <br><p> åæ¥ï¼Œæœ‰å¿…è¦å°†å¤„ç†ç¨‹åºè½¬å˜ä¸ºâ€œé˜²æŠ–â€åŠŸèƒ½ï¼Œå› ä¸ºé¥æ§å™¨æ¥æ”¶åˆ°ä¸€ä¸ªå¿«é€Ÿé‡å¤çš„ä¿¡å·ï¼Œå³ä½¿çŸ­æŒ‰æŒ‰é’®ï¼Œè¯¥ä¿¡å·ä¹Ÿèƒ½å‘å‡ºå¤šæ¬¡ä¿¡å·ã€‚ ä½†æ˜¯ï¼Œå¯¹äºæ‰€æœ‰æŒ‰é’®ï¼Œä¾‹å¦‚å¯¹äºéŸ³é‡ï¼Œåˆ é™¤æ‰€æœ‰æŒ‰é’®çš„é€‰é¡¹ä¹Ÿä¸æ˜¯å®Œå…¨åˆé€‚çš„ã€‚ </p><br><p> æœ€ç»ˆä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> debounce = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'debounce'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> settings = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./lib/settings'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> run = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./lib/run'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SerialPortReader = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./lib/SerialPortReader'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> simpleHandle = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> button =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = settings.mappings[button] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!actions) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.warn(<span class="hljs-string"><span class="hljs-string">`Action not found for remote control button "</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${button}</span></span></span><span class="hljs-string">"`</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> run(actions) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(e.message) process.exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> debouncedHandle = debounce(simpleHandle, settings.debounceDelay, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> callHandleFn = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">button</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (settings.noDebounce.includes(button) ? simpleHandle : debouncedHandle)(button) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SerialPortReader(settings.serialPort) reader.start(callHandleFn)</code> </pre> <br><h1 id="sozdanie-nezavisimoy-platy"> æˆç«‹ç‹¬ç«‹è‘£äº‹ä¼š </h1><br><p> ç¡®ä¿åŸå‹å¯ä»¥æ­£å¸¸å·¥ä½œåï¼Œæˆ‘ç»§ç»­åˆ›å»ºä¸€ä¸ªç”µè·¯æ¿ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹æˆ‘è€Œè¨€ï¼Œè¿™æ˜¯æ­¤ç±»äº‹åŠ¡çš„é¦–æ¬¡ç»éªŒã€‚ æˆ‘æ²¡æœ‰å¸¦å°é’ˆçš„åˆé€‚çƒ™é“ï¼Œåªæœ‰è€å¼çš„è‹è”å¤§é’ˆæ‰ç´§äº†ã€‚ </p><br><p> åœ¨ç—›è‹¦ä¸­ï¼Œæˆ‘è®¾æ³•ç„Šæ¥äº†â€œè„šâ€ï¼ˆä¸¤ä¸ªå¤§çš„8é’ˆè¿æ¥å™¨ä¸­ï¼Œåªæœ‰2é’ˆå¹¸å­˜äº†ï¼‰ã€‚ å…¶ä»–ä¸€åˆ‡éƒ½æ›´å®¹æ˜“ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ey/cp/of/eycpofhhrefekmejap-0py7dkvk.jpeg"></p><br><p>  ï¼ˆå¼¯æ›²ã€‚æœ€æœ‰å¯èƒ½æ˜¯ç”±äºArduinoå…‹éš†ã€‚åµŒå¥—ç›¸å¯¹äºå½¼æ­¤æ˜¯ä¸å‡åŒ€çš„ã€‚ï¼‰ </p><br><p><img src="https://habrastorage.org/webt/db/9f/t3/db9ft3ngxwxw05an1rewjepdgz4.jpeg"></p><br><p> æˆ‘æ•…æ„å°†çº¢å¤–æ¥æ”¶å™¨æ”¾åœ¨ä¸¤å—æ¿ä¹‹é—´ã€‚ å› æ­¤ï¼Œè¯¥è®¾å¤‡å¾ˆå®¹æ˜“å®‰è£…åœ¨æ”¾å¤§å™¨ä¸‹é¢ã€‚ æˆ‘å†³å®šé€šè¿‡ç”¨é”¡è¿æ¥æ¿ä¸Šçš„å­”è€Œä¸æ˜¯ç”¨ç”µçº¿æ¥è¿æ¥æ¥åˆ¶ä½œè½¨é“ã€‚ æœ€åï¼Œæˆ‘ç²˜ä¸Šèƒ¶å¸¦ï¼Œä»¥ä½¿ç”µè·¯æ¿ä¸ä¼šåœ¨æ”¾å¤§å™¨çš„é‡‘å±å¤–å£³ä¸Šé—­åˆã€‚ </p><br><p><img src="https://habrastorage.org/webt/hm/ko/ez/hmkoez0pew64szx6ivwwk6ypzfo.jpeg"></p><br><p><img src="https://habrastorage.org/webt/bs/at/av/bsatav95gqwwspbf_xzm4exhdug.jpeg"></p><br><p> ç»“æœæ˜¯ï¼šâ‰ˆ$ 14çš„åŠŸèƒ½å®Œå¤‡çš„è®¾å¤‡å’Œè½¯ä»¶ã€‚ æ‰€è·å¾—çš„ç»éªŒä»¥åŠæ‰€åšå·¥ä½œçš„å–œæ‚¦å’Œç»“æœæ˜¯æ— ä»·çš„ï¼  :-) </p><br><p> æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼ </p><br><hr><br><p> æ¼”ç¤ºï¼š </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YQVZRzwNWws" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¥æºGithub</a> ã€‚ </p><br><hr><br><p>  PSæ„Ÿ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">è°¢æ‹‰æ›¼å¥‡å…‹</a> 'ä½ çš„å’¨è¯¢:) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN453474/">https://habr.com/ru/post/zh-CN453474/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN453464/index.html">é‡å­æœªæ¥ï¼ˆç»­ï¼‰</a></li>
<li><a href="../zh-CN453466/index.html">HolyJS 2019ï¼šSEMrushçš„æ±‡æŠ¥ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN453468/index.html">Java Webåº”ç”¨ç¨‹åºçš„æ¼”å˜</a></li>
<li><a href="../zh-CN453470/index.html">æ‚¨åˆ†å¸ƒçš„å·¨çŸ³æ­£åœ¨æ‚¨èº«å</a></li>
<li><a href="../zh-CN453472/index.html">èƒ½é‡ç›‘æµ‹å™¨PZEM004Tå’ŒESP8266çš„è‡ªè¡Œè½¦ï¼Œå¸¦æœ‰äººå‘˜ç›‘æµ‹åŠŸèƒ½</a></li>
<li><a href="../zh-CN453478/index.html">æˆ‘ä»¬ç ”ç©¶äº†Starlinkå«æ˜ŸIlona Maskçš„å¥åº·çŠ¶å†µ</a></li>
<li><a href="../zh-CN453482/index.html">ä½¿ç”¨TensorFlowè¿›è¡Œæ·±åº¦å­¦ä¹ ç®€ä»‹</a></li>
<li><a href="../zh-CN453484/index.html">4ä½BCDè®¡æ•°å™¨</a></li>
<li><a href="../zh-CN453486/index.html">ç¾å›½è‡ªç”±å¸‚åœºåŸåˆ™</a></li>
<li><a href="../zh-CN453490/index.html">æ¥è‡ªOpenStreetMap No.461çš„ä¸–ç•Œæ–°é—»ï¼ˆ05/14/2019-05/05/2019ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>