<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💳 🥜 🥅 来自旧智能手机的精美精准手表 🍈 🌿 ♒️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文将重点介绍如何使用优质的挂钟来重新制作旧的不必要的手机，该挂钟具有大数量，始终准确的时间和备用电源。 

 我将讨论Android OS中一些明确的时间同步功能，以及智能手机电源系统中的各种电子技巧。 我将描述一个提供自动备用电源的简单模拟组件上的电路示例。 当然，我们将讨论android的软件...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>来自旧智能手机的精美精准手表</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443052/"><img src="https://habrastorage.org/webt/v3/zb/xe/v3zbxe4oreekk9jb1bdtkraqdcu.jpeg"><br><br> 本文将重点介绍如何使用优质的挂钟来重新制作旧的不必要的手机，该挂钟具有大数量，始终准确的时间和备用电源。 <br><br> 我将讨论Android OS中一些明确的时间同步功能，以及智能手机电源系统中的各种电子技巧。 我将描述一个提供自动备用电源的简单模拟组件上的电路示例。 当然，我们将讨论android的软件部分-如何以及在何种帮助下，您可以通过智能手机为各种口味制作精美的手表。 <br><a name="habracut"></a><br>  （ <i>传统免责声明-任何提及的品牌，商标等均非广告，我希望这很清楚。</i> ） <br><br><h4> 旧智能手机的第二人生 </h4><br> 我的旧飞利浦Xenium W732闲置了很长时间。 全屏工作，全屏显示。 我决定给他第二次生命-变成壁钟。 从几米处很难看到我那老旧的钟表，仍然是苏联的，闪烁着少量的数字。 此外，它们非常落后，必须不停地放下它们，然后在房子里停电的情况下，将它们重置为零，并且需要繁琐的操作过程，例如重新按一下按钮并重新设置时间。 长期以来，我已经厌倦了所有这些，因此，我决定用旧手机制作一款出色的“智能”手表，以克服所有这些缺点。 <br><br><h4> 我需要什么 </h4><br><ol><li> 任何所需颜色，字体和亮度的大而清晰的数字。 </li><li> 最高的精度和稳定性，无需任何外部干预。 </li><li> 非易失性，即 在临时停电期间，手表应继续运行。 </li><li> 从某种意义上说，完全自主的工作，无需使用任何付费数据网络，SIM卡，运营商等。 </li><li> 最大程度地遵循“制造，开启和忘记”的原则。 也就是说，设备永远不需要任何维护或任何其他种类的交互。 </li></ol><br><h4> 我们为Android提供准确的时间。 </h4><br> 首先要做的是在智能手机上获得持续准确的世界时间。 对我来说，“精确”的概念适合偏离世界1到2秒。 <br><br> 很明显，手机本身的系统计时器不会提供这种稳定性，这不是他所必需的。 因此，只有通过定期的外部同步才能确保符合世界时间。 <br><br> 在android中最简单的情况下，可以使用“网络”方法进行配置。 而且，甚至不需要具有不可避免的SIM卡和关税支付的蜂窝网络。 只需将家庭Wi-Fi分发到智能手机，然后将路由器配置为与Internet提供商或ntp服务器同步时间即可。 <br><br> 但是，还有第二种同步方法-GPS卫星，我个人认为更好。 <br><br> 从专家那里-您可以在世界上可以看到天空的任何地方进行同步。 时间的绝对精度，因为GPS本身就是基于此。 缺少额外的额外无线电信道和发射。 <br><br>  GPS的缺点-该设备应至少看到一点开阔的天空。 最有可能的是，任何东西都不会被夹在房间后面的任意地方，尤其是如果该设备具有旧且不灵敏的芯片。 而且由于我的手表正好位于窗户旁边，因此我需要一个远程GPS天线... <br><br><h4> 最简单的GPS接收外部天线 </h4><br> 在Internet上，关于该主题的一切都变得很紧。 我立即意识到我自己无法制造这样的天线-到处都提供了精心设计，庞大的设计以及一些复杂的复杂计算。 我试图找到购买商品-我也不喜欢所有东西。 有些体积很大，笨拙，需要外部电源，具有许多不必要的功能，同时价格也不足够。 <br><br> 解决方案是偶然发现的-我不知何故看到了“半波偶极子”类型天线的描述。 在最简单的设计中，它只是一条直的电线，长度等于所需信号波长的一半。 这种结构上的“复杂性”非常适合我，因此我只是选择了具有任意波阻抗的第一个同轴电缆，然后将其轻轻地焊接到智能手机上，与GPS贴片天线的相应触点焊接在一起。 <br><br><div class="spoiler">  <b class="spoiler_title">W732板上GPS天线触点的照片</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/nn/em/ci/nnemci1spx4laynkv4kd_fe_syy.jpeg"><br>  <i>编织层和同轴电缆的中心芯焊接到这些触点上</i> <br></div></div><br> 我只是将电缆的另一端从屏蔽编织层上松开了，以便保留了95毫米长的中心线芯-这是标准GPS信号L1频率（1575.42 MHz）处波长的一半。 <br><br><div class="spoiler">  <b class="spoiler_title">最简单的GPS天线。</b>  <b class="spoiler_title">半波偶极子</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/as/a2/yk/asa2yk0mwvmd034n7maxcwsexkq.jpeg"><br>  <i>该天线应放置在尽可能靠近窗户的地方。</i> <i><br></i>  <i>我用胶带把它粘在玻璃上。</i> <i><br></i> </div></div><br> 电话将其从窗户移开，另一方面，电线的95毫米剥皮端将其带到窗户，以便可以看到更多的天空。 <br><br> 如此-飞利浦很快就抓住了他诚实的5 ... 7颗卫星，并进行了修复！ 天线正在工作！ <br><br> 而且我仍然担心电缆，天线和接收器的波阻抗的协调，这在这种情况下可能是必要的，在天线论坛上，我被大脑上的灰尘打扫了。 后来，我发现，为了简单地获得传输线的最大效率（没有端反射和过度衰减），必须对电阻进行这种协调。 如果像我的那条线只有2 ... 3米，而任务只是简单地将至少一部分信号传送到接收器，那么您根本就不必考虑这种协调-一切都可以在任何同轴电缆上工作。 <br><br><h4>  GPS同步过程的功能 </h4><br> 收到可正常使用的GPS后，我当然会在android设置中立即设置“在GPS卫星上”的时间同步方法，并将手机置于该状态以进行验证。 几个小时后，手机上的时间与计算机上的控制时钟“分开”（Windows是ntp同步的），这让我感到惊讶。 我开始找出原因...事实证明，配置为通过GPS同步时间的android实际上仅<i>在固定坐标时</i>执行<i>一次</i>同步。 <br> 然后，即使智能手机继续连续监视卫星，其系统时间仍仅由内部生成器确定，也就是说，根本没有同步！ 至少在我的飞利浦Android 4.0.3中，所有操作都是这种方式。 <br><br> 对我来说，这是一个不愉快的惊喜。 我不会继续手动拉动GPS来更新确切的时间... <br><br> 找到解决方案的软件。 我使用Asamm软件的Locus程序进行导航，在该程序中，可以不配置处于活动状态的恒定GPS维护，而是配置给定时间间隔的定期一次定位坐标，这正是我所需要的。 我将时间间隔设置为15分钟，问题就安全地消失了-从那时起，手机中的时间始终与世界同步！  15分钟内，任何普通智能手机的系统计时器都不会累积超过1 ... 2秒的时间误差，这非常适合我。 如果愿意，您可以至少每十秒钟在炎热的天气中进行修复。 <br><br><h4> 餐饮固定式智能手机 </h4><br> 提供确切的时间后，该轮到我的手表做些合适的饮食了。 <br><br> 正如我已经提到的，我需要时钟在房子短期停电时不要关闭并且不为零，尽管这种情况很少发生，但确实会发生。 <br><br> 第一个最笨拙的解决方案是，将智能手机愚蠢地插入电源插座，然后将其保持原状。 的确，与此同时，停电问题得到了很好的解决-移动电话只需切换到电池即可，该电池将始终充满电并可以使用。 言归正传。 连接...一个星期过去了，第二个-我已经开始高兴了...在第三个晴天，有一个掌声，电池高兴地从电话中飞出，进入房间中间，由于内部压力使球充满。 <br><br><div class="spoiler">  <b class="spoiler_title">菲利普斯标准电池</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/p7/e6/oj/p7e6ojfzrl_xu9egovxblz_l6mi.jpeg"><br>  <i>这是他的正常情况。</i>  <i>平坦而坚硬...</i> <i><br></i> </div></div><br> 如您所知，我什至很幸运，电池盒的接缝无法承受并且不会被打开，否则我将能够避免锂起火，冒烟，恶臭和油毡变质。 <br><br> 只有一个结论-您不能只花<i>数月和数年就不断使用智能手机</i> 。 电话没有在这种情况下磨练。 其主要任务是正确充电至最大电量，不允许电压和温度超过此范围。 然后仍然应该放电。 如果设备从未与墙壁插座断开连接，则控制器通常会开始维持锯齿状的充电时间表-首先调整至100％，然后关闭电流，等待放电至90％左右，然后再次加油至100％。 这是一种或多或少的关怀方法。 而且许多旧手机可以愚蠢地始终将最大电压保持在电池上。 <br><br> 众所周知，锂离子电池上的电压越高，其老化和退化越快。 为了最大限度地延长电池寿命，某些智能手机通常会在4.2V以上填充电池。 但是只有一个结果-不断处于最大电压下，电池的退化速度更快。 如果它还很旧，那就像发生在我身上的微观内部电路，热加速和爆炸的逐渐发展就在不远处。 <br><br> 发生电池爆炸事故后，我想-如何同时拥有备用电源并防止电池始终处于满电压状态？ <br><br> 我经历了许多不同的场景，最终选择了以下内容。 <br><br> 在正常模式下，电话将始终通过USB连接器的插座供电，即5V。 <br><br> 使用简单的附加电路，后备电池会自动自动同时充电至其正常最大电压4.2V，然后将其<i>与充电完全断开</i> 。 此外，电池只是通过自放电而安静地放电，没有连接到任何地方。 在这种情况下，电路会不断监视其电压，并且仅在电池电压降至某个预定最小值以下（我为3.6V）时，才将单次充电打开，直至4.2。 依此类推，一切都是全自动的。 两次充电之间的实时时间为数年，在此期间，电池会缓慢地自我放电，但是即使在没有充足电的情况下，也仍然有能力随时提供负载。 <br><br> 万一插座电源出现故障，应立即将电池自动连接至智能手机（如不间断电源），然后系统将继续自发地工作，直到市电恢复供电或电池完全耗尽（并关闭）。 <br><br> 通过这种方法，与不断保持最大电压相比，锂电池的工作方式更为节制。 而且它肯定不会爆炸！ <br><br><h4> 智能手机电动技巧 </h4><br> 现在介绍如何实现所有这些电路。 <br><br> 在智能手机中，在电源系统中组织起来并不容易，这使事情变得复杂。 <br><br> 例如，如果没有电池，即使通过USB提供5V电压，电话也不会打开。 <br><br> 如果在使用USB时取出电池，所有内容也会立即变为空白。 尽管同时供电显然仅来自USB连接器！ <br><br> 最初，电池的第三触点有问题。 我不想被普通的飞利浦电池束缚，决定去发现-如果我完全不连接第三个接触端子，会发生什么？ 原来，智能手机无法同时打开……我什至开始担心某种复杂的数字总线（例如i2c）不仅会传送各种技术遥测信息，而且还会以“敌对友”风格传送各种工厂代码。 这意味着我将永远与飞利浦的原生电池联系在一起，因为我绝对不打算在这里搭建任何形式的欺骗性数字接口（我记得当我使用来自举世闻名和受人尊敬的日本公司的便携式摄像机电池时，我也有类似的惊讶）。 <br><br> 我看了一下示波器上第三次接触的情况。 对我来说幸运的是，飞利浦W732变得非常简单！ 它显示内部电池温度传感器的通常恒定电压。 智能手机中第三触点的输入为高阻抗。 <br><br> 我组装了一个简单的调谐分压器，并向中间触点施加了不同的电压，我得出了android显示的电池温度与第三个触点电压之间的依存关系的几点。 <br><br><div class="spoiler">  <b class="spoiler_title">显示的电池温度与第三个触点电压的关系图</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dc/-g/gd/dc-ggdncroj-gfw1mrxyiltj530.png"><br></div></div><br> 事实证明，如果第三个电池的电压低于153mV，则将启动有关电池过热的全屏警告，几秒钟后，手机将正常关闭。 在630mV以上的电压下，Android开始相信其电池会冻结到零下的温度，但会继续工作（甚至无声！）。 我不再需要进行实验-我只是意识到欺骗第三次接触是很基本的-只需在155至600 mV之间施加任何电位即可。 <br><br> 结果，我采用了形状2准则，没有它，智能手机将根本无法工作： <br><br>  <b>1.</b>电池正极上的强制电压（尽管系统由USB连接器供电） <br><br> 并且这不应该是某种假冒的潜在欺骗，只是让手机认为其中已插入电池。 它需要一个<i>成熟的低阻抗</i>电压<i>源</i> ，其电流至少要达到智能手机的工作电流。 <br><br>  <b>2.</b>电池组的第三个触点上存在的恒定电压范围为155 ... 600mV。 已经有足够的简单的高电势混合器。 <br><br><hr><br> 顺便说一句，我仍然不明白为什么Android的关机阈值如此之高（3.4V），而标准锂电池却可以轻松放电至3V甚至2.8V！ 唯一想到的是内部消费者的智能手机中存在3.3V电压，这需要为其降压转换器供电。 但是您可以放SEPIC并充分使用电池！ 还是在现代没有人考虑这个？ <br><hr><br> 接下来，有必要提出一个简单的辅助方案，该方案将监视所有这些并自动控制它。 我立即决定不使用任何微控制器，尽管我可以使用它们。 在这种情况下，您只需要考虑一下，彻底优化所有内容，所有功能都在简单的模拟组件上实现。 一切正常，永不冻结。 <br><br> 备用时钟电池需要定期用某种东西充电。 起初，我决定直接使用智能手机的电池和电池供电，因为我天真的相信它具有诚实不变的4.2V。 在示波器的帮助下，我看了看那里到底发生了什么。 原来，它没有任何恒定的气味！ <br><br> 首先，如果没有任何东西连接到电池正极端子，则充电控制器仍不会休眠，并定期进行“探测”检查。 <br><br><div class="spoiler">  <b class="spoiler_title">电池正极端子电压波形</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bi/hc/kq/bihckq8fd_wy5kabjuultdy7oai.png"><br>  （ <i>重建真实波形</i> ） <br></div></div><br> 您看到-大约每45毫秒，电话会从连续的“探测”中获得阶梯状信号-电池触点上是否出现了外部电压？ 在这些检查之间，将保持恒定的4.05V电平。 <br><br> 如果连接了电池，系统会识别出该电池并定期开始在其中填充电流。 但是，又一次，不是持续不断，而是在10秒内。 这10秒钟的充电完成后，智能手机会持续2秒钟充满全<i>反向电流</i> ，即 它从电池中获取电流，并具有不错的功率（我没有测量所有这些参数的确切数值，对此原理很感兴趣）。 在此短期电流采样过程中，智能手机会测量负载下的电池电量，从而获得百分比和电压的真实数字。 可以清楚地看到，在android进行此反向操作之后，如何精确更新所有电池参数的值。 <br><br> 所有这些棘手的充电机制根本不适合我，甚至不起作用，因为我打算基于对测量分流器的连续模拟电压控制来构建充电电路的逻辑。 并在分流器的压降降至预定的最小值时自动关闭充电，这表明充电电流已达到充电的最后阶段。 然后这种反转完全破坏了一切……最初，我试图以某种方式规避或欺骗它，但是结果我意识到，使用外部基准充电电压源更加容易。 对于进一步的了解，它将更加可靠和透明。 <br><br> 我安装了一个外部集成稳定器（正常，线性），从<i>稳定度</i>差的5 ... 6V USB充电器获得了准确且<i>温度稳定的</i> 4.2V电压。 首先，我和他们一起给智能手机充电了一个正极电池端子，这样他就一直以为自己拥有100％充电的电池，并且从未在此屏幕上完整播放过任何内容。 其次，备用电池充电系统通过该总线工作。 <br><br> 一路上，我遇到了一个奇怪的发现。 ,      USB       <i> </i>   ,     ,       ,    !        -    ,       ,     .    ,     ,       .      : <br><br><div class="spoiler"> <b class="spoiler_title">    « »</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/m-/_j/dc/m-_jdcx_h9vkganwg0-nuci6fdc.jpeg"><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b7/y_/vv/b7y_vvrfjlfd_5teazjmiksc8bi.jpeg"></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">您会看到，当屏幕运行正常并且电池端子的电流变得明显时，Android绘制了一个很好的斜率，大约是每小时下降幅度的5％。然后我关闭了背光灯，智能手机睡着了，电流下降到了一些小的待机值，并且图表几乎是水平的。他再次打开屏幕-再次打开斜坡。请注意，电池正极的电压始终严格</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">恒定</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。因此，Android仅根据测量的电流来计算其充电百分比。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但是，一旦电量达到15％（此处电话会发出有关电池电量已耗尽的警告），图表便会停止下降，然后再水平倾斜15％...这就是窍门（或故障）。</font></font><br><br>     . ,        USB       ,  <i>,  4,2</i> ,           ,     ,   " <i>  -  !    !</i> ".             ! <br><br>      4,2,   -  4,3        ,  .  « »    –  0,1. <br><br>         5  USB,     4,2    –      , ,        .    ,  ,      ! <br><br><hr><br>   , , , ,     ,          (..  4,2-    ,      «»).   ,         LDO       <i></i> .  .       ,    , ,      . <hr><br><br><h4> 方案 </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当传统知识最终被完全确定后，就可以开始制定特定的方案了。</font><font style="vertical-align: inherit;">尽管任务看起来很简单，但我还是特别努力！</font><font style="vertical-align: inherit;">我不得不发明，然后拒绝了十几种不同的选择，从不雅观的简单到笨重。</font></font>结果如下： <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电源计划</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5p/av/_r/5pav_ru8mahbacmdyz4xxr6covo.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">尽管有明显的冗余，该方案还是简单的。</font><font style="vertical-align: inherit;">借助SMD，一条35x22毫米大小的围巾可以轻松放入已卸下的普通电池的电池舱内。</font><font style="vertical-align: inherit;">作为备用电池，我使用了安装在表架上的普通锂离子18650。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该电路具有以下功能：</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 通过USB连接器从插座提供5V恒定主电源。 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> USB发生电源故障时，自动将智能手机转移到备用电池。 </font></font></li><li>   4,2     (    ). </li><li>       (   ). </li><li>            . </li><li>     ,   . </li><li>         . </li><li>        . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在，简要介绍一下电路的工作原理。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">为了获得稳定且独立于温度的4.2V，我使用了Analog Devices出色的集成LDO ADM7172。它为我提供了理想的电压和理想的4.22V均匀电压，最大负载为2A。我将其放在智能手机的电池连接器（VBAT）上，并用它为系统的备用电池充电。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第三个电池触点（TEMP）的电压仿真电路是在一个简单的二极管D2上制成的，该二极管由微弱的背景电流供电。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">只要主+ 5V USB电源总线上的电压消失，Q4 P通道mosfet就会立即将备用电池连接到智能手机。此处仅将LED2设置为仅在轮胎下垂过程中通过水平移动以获得较小的开口Q4加速度。它是红外线，在任何地方都不发光。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其余细节构成充电电路。备用电池BT1通过Q3 MOSFET和R9R10限流电阻器充电。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">YOU U2的工作在这里很有趣。它在此包含在内，因此它既可以控制放电程度，也可以控制电荷程度。运算放大器在这里工作在比较器模式下，由于它控制的电路中的过程，它本身会获得一个正OS。</font></font><br><br>    :    –   +5 USB      , ,     R4R5R6 –       4,2-  (   ),    Q3 .            (+3,63  ),    «»         Q3.    ,            (    )       .         ,         ,    . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电池电荷流经电阻R9R10（它是合成的，以增加耗散功率）。首先，它限制了充电电流，这在这里是绝对必要的，否则，即使是2安培的充电器也无法应付和跌落。其次，根据该电阻上的压降，电路确定必须关闭电荷的时刻。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这发生如下：一旦打开电荷，辅助mosfet Q2就会同时打开，这会为运放的反相输入重建控制分压器R4R5R6，因此运放开始监视充电电阻上释放的电压。充电开始时，当电池完全放电时，R9R10上的电压下降约0.5V，这使运算放大器在充电状态下可靠地失衡。并且只有当电池逐渐充满电时，通过控制电阻的电流才会减弱到某个值（大约20 mA），然后运放输入的电势才相等，然后通过相同的外部POS机制（输出加）将其转换为相反的状态，从而关闭Q2 MOSFET和Q3并停止充电。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">至于结果这样的计划</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">锂离子电池的</font><i><font style="vertical-align: inherit;">充电曲线，</font></i><font style="vertical-align: inherit;">此处的R9R10电阻器自动实现简单的充电功能，具有最大的初始电流，其自动逐渐减小并接近零。</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">充电功能图</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yx/6o/cx/yx6ocxkusa2pis2406l_y9jqvrq.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 反过来，电池制造商建议使用以下众所周知的充电曲线，以及电流和电压的稳定部分： </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">锂离子电池的典型推荐充电曲线</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rt/o0/ab/rto0abfgdgab_tlfpkkwdhx2cdu.jpeg"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">就我而言，电池上的电压和电流都没有特别稳定过，但是电池上的电压永远不会超过安全极限。因此，我认为这种简化的收费方法是切实可行和有效的。实际上，它工作得很好，并且同时仅需要一个电阻。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用Mosfet Q1的目的是，当仅使用备用电池工作时，无需浪费其电流来为其余电路供电。当电源从插座中丢失时，Q1闭合，并从公共电线上切断电路的所有未使用部分。因此，整个结构的自身消耗降低到可以忽略的3 ... 5微安，并且如果您长时间忘记了断电的系统，这会自动防止电池深度放电。</font></font><br><br>   D1     U1    –     U1 ( ADM7172   )         .         1,    1      +5 USB    ADM7172  33 ,     ,    ,   .          D1,             . <br><br><h4>    </h4><br> 作为输入稳定器，我使用了一个极低的最小直通压降出色的LDO，尽管在这个位置上它的电压永远不会降至0.4V以下。 我真的很喜欢ADM7172的许多规格。 因此，在这里几乎可以放置任何线性稳压器微电路，主要是它会产生可靠的电压，该电压不会随温度而浮动，并且电流至少为1.5A。 <br><br> 从mosfets到这里，我需要最小的开路电阻（RdsON）。 对于位P通道密钥Q4尤其如此。 我在这里放了一块宏伟的Toshibov TPH1R712MD样品-在一个小巧的扁平外壳中，通过通道电阻发现了最好的样品。 在打开状态下，它的实际值为1.3mOhm，在200 ... 300mA的智能手机的工作电流下，它的宝贵电池电压的传输损耗可以忽略不计0.4mV！ <br><br> 还希望Q1具有较低的RdsON，以便更准确地连接到公共线的电位。 飞兆半导体的FDMC8010 mosfets也做得很好。 还有更多的低阻抗样品，但是在这种设计中，零件的小尺寸对我来说也很重要。 <br><br> 其余的mosfet可以是任何一个，仅希望它们具有较低的打开阈值电压。 <br><br> 作为U2比较器，我使用了微功耗Microchip MCP6V11 IOW，我以其出色的效率而赞不绝口-后台仅7微安。 的确，与传统的YOW相比，它作为乌龟的速度当然很慢（GBW 80 kHz，压摆率仅为0.03 V /μs）。 但是无论如何它在这里都很棒。 顺便说一句，我试图在这里放置一个具有内置磁滞的真正比较器。 我发现了一个出色的示例MCP6541，它在后台仅消耗600纳安（！），并且在触发时可以以高达30 mA的功率拉动输出...但是，直接将其代替MCP6V11（它们的引脚排列重合），却突然出现电路故障。 事实证明，MCP6541的切换速度如此之快，以至于其脉冲的高速前沿很容易穿过栅电极电容Q2进入控制分压器R4R5R6的电路，并进入其自身的反相输入。 事实证明这种动态反馈，并且比较器不切换，而是开始生成。 <br> 只需在比较器的输出和Q2栅极之间添加一个高阻电阻器即可解决此问题，但是我已经有了一块板上，即使有一个额外的小型SMD电阻器也绝对没有位置，所以我只把MCP6V11留在了这里。 <br><br> 仅需要LED1来指示何时有电荷注入电池。 以一种好的方式，这种情况应该每隔几年发生一次。您可以绝对使用任何颜色，也可以完全不使用它。 <br><br> 电阻和电容器是最常见的SMD，除了体积小以外，对它们没有任何要求。 我在7343H的情况下使用了钽电容器lowESR，但任何电容器都可以装到板上，仅适合与板一起装入电池盒（对于W732 Philips，它的尺寸为55x60x8毫米）。 <br><br> 在给电池充电的过程中，整个电路板在最初的几个小时内会加热到60度。由于车厢中还有足够的空间，我故意增加了电路板的面积并加宽了加热部分，以免彼此和其他邻居白白地过热。 <br><br><div class="spoiler">  <b class="spoiler_title">电池仓中的电源管理板</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bt/bf/jy/btbfjybybqxy0ope5aikbng-efw.jpeg"><br></div></div><br> 手工制作，光刻胶。  FR法可以很容易地获得0.15mm的“工艺”，但是由于某种原因，我拥有所有质量差的纺织材料，以至于镀锡时狭窄的道路都会掉下来...如果有人知道在哪里可以买到有保证的优质纺织材料-请在评论中写下！ <br><br> 因此，智能手机终于可以正常供电，并且在各个方面都像时钟一样工作！ 借助插座的电源和电池的稳定电源，它们可以安静地工作。 连接充电器后，它始终显示100％的电量。 如果将其从电源插座中拔出，则它可以从备用电池继续安静地工作，并很快开始在其上显示实际电压。 恢复电源时，再次保持安静且无声显示100％电量。 一切都应该做！ <br><br> 原则上，通过类似的电路，您可以为通过电池的第三个触点接收简单恒定电压的任何移动电话供电。 <br><br><h4> 适用于Android的数字手表 </h4><br> 就此，此事用铁完成了。 现在是时候为软件打顶。 即，有必要在智能手机屏幕上获得大数字时钟。 <br><br> 这是我需要的： <br><br><ol><li> 尽可能多的数字！ 我不喜欢to着眼睛看远处的小东西。 </li><li> 能够放置任何颜色的任何字体。 可读性也取决于此。 </li><li> 在屏幕上显示时钟的排他性-除了时间数字外别无其他。  <i>永远不要</i>出现天气预报，警告，消息，状态栏和其他废话。 </li><li> 很明显，智能手机的屏幕绝对不能自己变黑。 </li><li> 屏幕正常工作的自动亮度功能。 </li><li> 最高的可靠性（我仍然依靠这款手表）。 视情况而定-排除所有这些。 </li></ol><br> 我从挂断电话开始，无情地铲除了我可以到达的所有垃圾。 各种各样的间隙，污渍和正常装载不需要的所有物品都飞到了篮子里。 包括许多系统应用程序，以及用于处理SIM卡，拨号器，SMS，浏览器，日历，墙纸和其他废话的各种实用程序。 我什至走了很多次-电话被错误循环。 但是我恢复了所有内容并再次清除了它。 <br><br> 然后很长一段时间，我在互联网上搜索了用于Android的全屏数字时钟的常规程序。 尽管有大量类似的程序，但几乎没有一个适合我！ 所有开发人员无一例外都在尝试将大量不必要的东西塞入他们的产品中-从某种有趣的背景（不可断开）开始，以天气预报，新闻，日历和其他类似垃圾结尾。 我通常对已经传播到所有人的弹出广告保持沉默……我只需要时间就可以了！ <br><br> 监视程序和窗口小部件的通用功能是完全不经济地使用屏幕区域。 到处的数字都很小，并且屏幕边缘的空白很大。 我的飞利浦，所以屏幕不是最大的-只有4.3英寸。 <br><br> 简而言之，我找到了几乎唯一适合的程序-Big Digital Clock 1.1.1。 <br><br><div class="spoiler">  <b class="spoiler_title">屏幕快照大数字时钟</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/i7/lw/eq/i7lweqe_tgvvqwiqqzdmjo_sk9q.png"><br></div></div><br> 她人数最多。 而且，它们距离矩阵区域的充分利用还很远。 该程序的优点-可以去除屏幕上的所有东西，除了时间，还可以选择任何颜色，24小时格式，不闪烁的分隔冒号，任何屏幕方向以及不褪色的背光自动维护。 缺点-一种紧密缝制的字体，模仿典型的七段式字体。 <br><br> 交付并开始日常使用。 刚开始时一切都很好-数字似乎很大，通常都可以看到，而在我上班后-一般都是天堂和大地！ 但是现在，经过大约一个月的连续工作，我突然发现时间<i>冻结了</i> ， <i>并且没有改变！</i> 什么废话！？ 我决定检查-这是该程序的一次性故障或“功能”。 <br><br> 重新开始计时，几周后再次出现fr发。 时间只是停止更新。 相反，该程序每7 ... 10分钟随机下垂，更新时钟，然后再次陷入昏昏欲睡的状态。 显然，这种“可靠性”不适合我。 <br><br><h4>  Android Automators及其“芯片” </h4><br> 由于这实际上是唯一合适的程序，因此我不得不为此发明拐杖。 我决定需要安装某种android自动化设备，以便它在有时间冻结之前会定期重新启动越野车时钟程序。 放塔斯克。 他很忙，整理了一下-但是我不喜欢...我将其更改为Automagic。 谁不知道-该自动化工具使用基于可视流程图的脚本。 而他的这一特性确实吸引了我！ <br><br><div class="spoiler">  <b class="spoiler_title">代表Automagic Automation方案</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dl/pr/ki/dlprki-84b4sgbvlax3ao2wm9kw.jpeg"><br></div></div><br> 几乎立即执行的定期重启我的越野车监视程序的功能。 然后，他将Automagic放在主要工作的智能手机上，并用有趣的实验挂了一个星期。 结果，我在手机上为日常生活带来了很多帮助。 <br><br> 但这不是主要内容。 我在诸如Custom Widgets这样的芯片上遇到了Automagic属性。 然后事实证明，借助它的帮助，您几乎可以绘制和“复兴” <i>任何</i>只有程序具有想象力和功能的<i>自制小部件</i> ！ 然后我意识到我可以自己动手制作这样的手表，这是我内心所渴望的！ 此外，程序帮助仅描述了创建时钟小部件的示例。 <br><br> 几天后，一切就绪，一切准备就绪！ 多亏了Nova lancer，我才能够将小部件拉伸到矩阵的最边缘。 我还隐藏了停靠栏和状态栏，将屏幕从所有界面元素中释放出来。 结果是什么-关于显示器边框的数量真是太多了……最后，祝大家开心！ <br><br><div class="spoiler">  <b class="spoiler_title">最后，数字占据了屏幕的整个宽度！</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5k/xv/9s/5kxv9sdud2mssdnn7xm1iuo8k5m.jpeg"><br></div></div><br> 使用Automagic使我能够满足我的所有要求。 您可以放置​​任何.ttf或.otf字体。 您可以按任意比例绘制和拉伸字符，以使其完全适合屏幕。 最后，您只能拥有所需的东西！ 我什至没有在表中画出一个冒号，因为它的空间很简单，所有内容都很可读。 在应用程序中不再需要任何外部程序和拐杖。 <br><br> 而且，现在我什至不需要Locus来定期固定GPS坐标以进行时间同步。 所有这一切都可以通过任何自动化工具完美地完成。 在控制场景中，您几乎可以实现所需的一切。 例如，将屏幕保持在不褪色状态。 <br><br> 更进一步地，出现了外观不同抛光的麻烦。 如果所有这些都可以轻松实现，为什么不呢？ <br><br> 例如，当选择字体大小和因子时，您需要从4个字符的时间格式（XX：XX）开始。 但是在0:00到9:59的时间段内，屏幕上只有三位数，它们的宽度小于四位数，因此不能完全使用矩阵。 一件小事，但丑陋。 使用Automagic，可以通过几个附加命令轻松解决此问题。 它具有一项功能，可让您<i>即时</i>更改自定义窗口小部件的几乎所有参数。 在这种情况下，这是字体字符宽度（展平）的因子，我可以通过上述时间间隔的触发来设置该因子。 有效！ <br><br><div class="spoiler">  <b class="spoiler_title">三个和四个字符适合相同的屏幕尺寸</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9t/ns/5r/9tns5rg_kbtelwl0fixwluearic.jpeg"><br>  <i>字体宽度因子从9:59到10:00转换为“即时”</i> <i><br></i>  <i>并从23:59返回0:00</i> <br></div></div><br> 起初，我首先对时钟读数每分钟<i>更新</i>的<i>时间</i>产生疑问。 我担心Automagic不会与智能手机的系统时钟的分钟变化同步地更新它，而是任意地更新，从而在一分钟内引入随机错误。 我开始检查... <br><br> 在Automagic中，有两种不同的方法可以在自定义窗口小部件中实现时间。 您可以通过外部操作事件将数值发送到小部件的普通文本字段。 对于每个此类事件，只有一个特殊选项“固定时间”，这意味着您需要在系统时间更改的那一刻完全同步地发送它。 <br><br> 第二种方法更简单-它不使用外部脚本，而是将类型的系统调用函数直接编写到小部件的所需文本字段中 <br><br><pre><code class="plaintext hljs">{getDate(),dateFormat,HH:mm}</code> </pre> <br> 但是没有“固定时间”这样的选项。 只需对窗口小部件进行“自动刷新”检查，并将其精确设置为“刷新间隔”一分钟即可。 在此，我担心的是，相对于系统时间分钟变化的时间“网格”，可以任意计算小部件在一分钟内的自我更新间隔。 我做了几次实验，但令我高兴的是，一切都井然有序。 只要系统时钟的分钟数发生变化，小部件就会立即立即清晰地自动更新！ <br><br> 无论小部件在什么时间开始工作。 <br><br><h4> 自动亮度屏幕 </h4><br> 我想做的下一件事是屏幕的清晰自动亮度。 我的旧飞利浦上的内置自动亮度效果非常差。 抽搐，不充分，范围很窄。 在这里，我没有打扰，而是放了许多自动亮度调节程序之一。 一开始我尝试使用Lux，但是我不喜欢一些不直观的tin剂和复杂的个人资料。 更改为Velis，这正是我们所需要的。 我特别喜欢的是-Velis使得绘制真实的亮度依赖于压力表读数的曲线成为可能，并在此图上实时显示智能手机如何根据其调整亮度。 您可以配置几乎完全不可见的亮度变化定律，当然，在屏幕几乎不可见时，也可以配置任意值，最高可达1％。 晚上，当数字几乎不发光时，这非常方便。 <br><br> 当我围着新手表奔跑时，我注意到即使是全黑的屏幕背景，智能手机矩阵仍会在背光穿透的情况下散发出光芒。 这在完全黑暗的环境中尤其明显-屏幕的矩形以灰色背景的形式清晰可见，类似于发光效果。 我决定用一个外部过滤器修复它。 我选择红色的时钟数字的颜色，因为 我从远处最清楚地看到了红色。 <br><br> 我手动制作了第一个过滤器-我在透明胶片上的喷墨打印机上打印了红色的实心填充物，并用墨水将两个静止的原始打印品相互折叠。 薄膜牢固地粘附在一起，并获得了良好的透明的深红色玻璃。 顺便说一句，现在这样的生活手段将不再起作用，这很老旧，因为在我的工作中，绝对所有的喷墨打印机都被时尚的激光多功能一体机所取代。 它们可以在纸上完美地打印，但是在他们的帮助下不可能在胶片上获得透明的颜色填充-会有一个嘈杂的无光泽层，通过该层看不到任何东西。 <br><br> 但是在这里我不知何故走进了科默斯（Komus）来写铅笔，偶然看到了这种东西： <br><br><div class="spoiler">  <b class="spoiler_title">相片</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/of/e8/pw/ofe8pwoxfgo5hvkmvhul5evpync.jpeg"><br></div></div><br> 这是一个普通的办公纸盘，但是请看它是由什么制成的。 有机玻璃或透明塑料，但其颜色和透光率与滤镜所需的相同。 我买了它，小心地从中切出一块盘子来适应屏幕并进行调整。 美女！ <br><br><div class="spoiler">  <b class="spoiler_title">带红色滤镜</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/oq/oh/dr/oqohdrcoghynsiygiugq_egez_0.jpeg"><br></div></div><br><h4> 画龙点睛 </h4><br> 从原则上讲，可以认为将不需要的旧手机转换成精美的手表就可以了。 <br><br> 没错，甚至在堆之前，我就对字体编辑器中的.otf字体稍作更改感到困惑，因为这些字符可以按照我的需要，一直到最细微的弯曲。 小事，但很好！ 还必须使字体等距，以便在更改字符时，行不会移出并爬出显示的边界。 使用了一种开源字体编辑器Glyphr Studio。 <br><br> 好吧，最后，剩下的只是将整个结构固定在房间角落的架子上。 创造力很大。 我只是弯曲了L形的铝带，然后用螺钉轻轻地拧紧了智能手机的后盖。 将另一端拧到架子上。 您可以通过设置任何视角来旋转。 还有一点可弯曲的铝材，可垂直调整角度。 实际上，我通常安装了所有东西，因此不再赘述。 <br><br> 备用电池已适应安装条的弯曲处。 在这里，我没有精巧的设计，从后面看不到任何东西。 我也没有打扰任何用于电池的端子容器，只是在不与电池内部物品相邻的那些地方，直接小心地将其直接焊接到18650金属外壳上，以免用烙铁使它过热。 <br><br> 所有连接均通过普通布线进行，并穿过智能手机后盖上的钻孔。 在内部，我直接发现了智能手机板的细节和轨迹。 <br><br> 总体上，设计采用了两条外部电线：来自电源充电器的5V电源和一条GPS天线电缆，该电缆连接到窗户并用胶带粘在玻璃上。 <br><br> 近一年来，手表以其美观大方的数字，精确的运转和不间断的可靠操作而令我感到高兴。 <br><br> 为了娱乐，我绘制了第二个时钟小部件-用于智能手机的垂直位置。 <br><br><div class="spoiler">  <b class="spoiler_title">相同比例的水平和垂直时钟</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hr/_b/o6/hr_bo6oelso-e2dyzglvbvnf9qa.jpeg"><br></div></div><br> 我之所以开始发明它，是因为可以使具有这种非常规排列的数字更大，也就是说，有效使用屏幕区域被证明是最大可能的。 而且，在这种情况下，从时间格式X：XX切换为XX：XX时，每次更改字符宽度因子的需求就消失了，反之亦然，因为一切总是自动中断的。 <br><br> 没错，向我展示过这种非标准立式手表的几乎每个人都说：“ fuu，水平更好！”。 好吧，这是一个业余问题，我个人都喜欢。 <br><br> 仅此而已。 谢谢大家阅读！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443052/">https://habr.com/ru/post/zh-CN443052/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443038/index.html">如果强力胶进入眼睛</a></li>
<li><a href="../zh-CN443040/index.html">在Google Play和AppStore上阻止应用程序的7个主要原因</a></li>
<li><a href="../zh-CN443042/index.html">在GLSL上发布了61.9万个俄罗斯方块，它们的渲染和一个简单的机器人</a></li>
<li><a href="../zh-CN443046/index.html">安全研究人员如何访问iOS代码的受保护站点</a></li>
<li><a href="../zh-CN443050/index.html">当今对称加密算法工作原理的最简单解释</a></li>
<li><a href="../zh-CN443054/index.html">Linux下程序员的实用程序选择</a></li>
<li><a href="../zh-CN443056/index.html">第二名艾滋病患者达到缓解</a></li>
<li><a href="../zh-CN443058/index.html">干净的架构。 第一部分-简介</a></li>
<li><a href="../zh-CN443060/index.html">星际飞船会到达火星吗？</a></li>
<li><a href="../zh-CN443062/index.html">我如何创建回收站！ 虚拟现实</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>