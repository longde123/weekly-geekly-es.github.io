<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ∏Ô∏è üéé ü§¶üèº Tarefa n√∫mero 1. Descubra g√™nero e grau de relacionamento üì° üëäüèæ ü§≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No artigo detalhado anterior sobre o Genoma Completo, prometemos publicar tr√™s problemas e testar o que resolver primeiro os tr√™s corretamente. Ao mes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tarefa n√∫mero 1. Descubra g√™nero e grau de relacionamento</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/atlasbiomed/blog/480954/">  No <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">artigo</a> detalhado anterior sobre o <a href="https://atlas.ru/wgs">Genoma Completo,</a> prometemos publicar tr√™s problemas e testar o que resolver primeiro os tr√™s corretamente.  Ao mesmo tempo, damos exemplos de como trabalhar com dados gen√©ticos nessas tarefas.  Hoje publicamos o primeiro. <br><br><img src="https://habrastorage.org/webt/qd/mz/ye/qdmzye9a9sdyp82atstpktqrnu4.png"><br><a name="habracut"></a><br>  No primeiro <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">artigo,</a> compartilhamos informa√ß√µes e links √∫teis para trabalhar com dados de bioinform√°tica.  Recomendamos que voc√™ o leia primeiro, caso tenha perdido. <br><br>  <b>Isen√ß√£o de responsabilidade</b> <br>  O trabalho com dados gen√©ticos √© realizado nos sistemas Unix (Linux, macOS), pois alguns comandos e software n√£o est√£o dispon√≠veis no Windows.  Portanto, para usu√°rios do Windows, uma das solu√ß√µes mais simples √© alugar uma m√°quina virtual Linux. <br><br>  Todas as opera√ß√µes descritas abaixo s√£o executadas na linha de comando - terminal.  Antes de come√ßar, aprenda a trabalhar em um terminal executando seu sistema operacional e use comandos, pois alguns deles podem prejudicar o sistema operacional e seus dados. <br><br><br><h2>  Software Necess√°rio </h2><br>  Coletamos a <a href="https://cloud.yandex.ru/marketplace/products/f2e5v4acgtukhi31n6o4">imagem de uma m√°quina virtual</a> (VM) com todo o software necess√°rio no Yandex.Cloud.  Registre-se no Yandex.Cloud, na sua conta na se√ß√£o Compute Cloud, clique em Criar VM.  Como imagem p√∫blica, selecione 1000 genomas no cat√°logo Atlas Data Analysis. <br><br>  Configura√ß√£o da VM: 100% 2vCPU, 8GB RAM, 20GB HDD.  Ao criar uma VM, voc√™ deve inserir os dados de pagamento, mas nada √© baixado da conta.  Uma partida e uma concess√£o adicional em uma palavra de c√≥digo s√£o suficientes para trabalhar com uma VM e uma imagem da Atlas at√© 31 de dezembro de 2019 gratuitamente.  Para receber uma concess√£o para concluir tarefas, envie a palavra de c√≥digo "ATLAS" para o <a href="https://console.cloud.yandex.ru/support">suporte do Yandex.Cloud</a> . <br><br>  Nota: a concess√£o √© v√°lida para novos usu√°rios do Yandex.Cloud que abriram uma conta desde 18 de dezembro de 2019 ou para aqueles que ainda t√™m um per√≠odo de avalia√ß√£o e t√™m uma concess√£o inicial.  A palavra de c√≥digo ATLAS √© v√°lida apenas uma vez. <br><br>  Primeiro, crie uma chave ssh no computador local a partir do qual voc√™ planeja se conectar √† VM: <br><br><pre><code class="bash hljs">ssh-keygen -o -t rsa -b 4096 -C <span class="hljs-string"><span class="hljs-string">"my-local-machine"</span></span> -f ~/.ssh/yandex-cloud -a 100</code> </pre> <br>  N√£o esque√ßa de copiar o conte√∫do do <code>~/.ssh/yandex-cloud.pub</code> para a janela apropriada ao criar a VM. <br><br>  Se voc√™ deseja instalar o software no seu computador, abaixo est√£o todas as informa√ß√µes de instala√ß√£o.  Se voc√™ decidir usar o Yandex.Cloud, crie uma VM e prossiga para a pr√≥xima se√ß√£o. <br><br><br><h3>  Plink </h3><br>  O Plink √© um pacote de software para manipula√ß√£o de dados gen√©ticos e a pesquisa de associa√ß√£o de genoma amplo (GWAS).  Foi desenvolvido pelo geneticista Sean Purcell (Shaun Purcell).  Desde 2008, com a ajuda do Plink, centenas de GWASs s√£o realizados em todo o mundo, cujos resultados s√£o os melhores que a Atlas usa como fonte de dados para algoritmos de c√°lculo de riscos de doen√ßas. <br><br>  O Plink oferece um conjunto de ferramentas para armazenar e converter dados de genotipagem e pesquis√°-los.  O Plink tamb√©m permite processamento estat√≠stico, an√°lise de desequil√≠brio de liga√ß√£o (LD), an√°lise de identidade por descida (IBD) e identidade (estado por IBS), estratifica√ß√£o populacional e testes de epistasia - a intera√ß√£o de v√°rias varia√ß√µes gen√©ticas entre si. <br><br>  O IBD e o IBS s√£o usados ‚Äã‚Äãpara analisar a composi√ß√£o da popula√ß√£o e determinar o parentesco. <br><br>  Um exemplo de epistasia s√£o as varia√ß√µes de rs7412 e rs429358 no gene APOE, uma certa combina√ß√£o de variantes que aumenta acentuadamente o risco de desenvolver a doen√ßa de Alzheimer, enquanto cada variante individualmente contribui apenas com uma pequena contribui√ß√£o para o risco. <br><br>  Fa√ßa o download da vers√£o est√°vel do Plink no <a href="https://www.cog-genomics.org/plink/">site</a> oficial. <br><br><br><h3>  BCFtools </h3><br>  BCFtools √© um conjunto de utilit√°rios para manipula√ß√£o de dados gen√©ticos no formato VCF e sua contraparte bin√°ria BCF.  A lista de poss√≠veis aplicativos do pacote BCFtools inclui anota√ß√£o, filtragem, mesclagem e divis√£o de arquivos VCF / BCF, localiza√ß√£o de interse√ß√µes, indexa√ß√£o, pesquisa seletiva, classifica√ß√£o, contagem de estat√≠sticas, etc. <br><br>  Para instalar, fa√ßa: <br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/htslib.git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/bcftools.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> bcftools <span class="hljs-comment"><span class="hljs-comment"># The following is optional: # autoheader &amp;&amp; autoconf &amp;&amp; ./configure --enable-libgsl --enable-perl-filters make</span></span></code> </pre> <br>  O processo de instala√ß√£o √© descrito em mais detalhes <a href="https://samtools.github.io/bcftools/howtos/install.html">aqui</a> . <br><br><br><h3>  KING </h3><br>  O pacote KING (INference for Gwas baseado em parentesco) √© usado em estudos populacionais quando se trabalha com dados de uma pesquisa em todo o genoma de associa√ß√µes para determinar as rela√ß√µes de parentesco nos dados estudados.  Nesta tarefa, o KING ajudar√° a determinar o grau de parentesco de v√°rias amostras do projeto 1000 Genomes. <br>  Voc√™ pode baix√°-lo <a href="http://people.virginia.edu/~wc9c/KING/Download.htm">aqui</a> .  Para resolver problemas, o manual do KING est√° dispon√≠vel <a href="http://people.virginia.edu/~wc9c/KING/manual.html">aqui</a> . <br><br><blockquote>  Quase todos os erros que podem surgir durante o trabalho com as ferramentas s√£o descritos no <a href="https://stackoverflow.com/">Stackoverflow</a> ou em seu equivalente bioinform√°tico - <a href="https://www.biostars.org/">Biostars</a> . </blockquote><br><h2>  Dados utilizados </h2><br>  Para orienta√ß√£o, usamos os dados abertos <a href="https://www.internationalgenome.org/">do</a> projeto 1000 Genomes.  Para an√°lise, selecionamos 10 amostras com informa√ß√µes sobre os gen√≥tipos de cerca de 85 milh√µes de varia√ß√µes obtidas pela an√°lise de dados NGS alinhados com a vers√£o do genoma de refer√™ncia GRCh37.  Os relacionamentos familiares e as popula√ß√µes de amostras s√£o mostrados na Figura 1. <br><br><img src="https://habrastorage.org/webt/yr/rt/bg/yrrtbgj6tct9huih0rg5gww63xc.png"><br>  <b>Figura 1</b>  Linhagem usada em amostras de VCF.  O quadrado corresponde ao sexo masculino, o c√≠rculo √† f√™mea.  Linha pontilhada significa parentesco indeterminado de segunda ordem. <br><br><br><h2>  Tome nota </h2><br>  O formato VCF permite armazenar informa√ß√µes sobre o campo de uma pessoa como um √∫nico n√∫mero, se essas informa√ß√µes forem conhecidas durante a gera√ß√£o do VCF.  √â assim: o campo GT (gen√≥tipo, gen√≥tipo) para registros do cromossomo X cont√©m um valor num√©rico que corresponde a um alelo, para homens e dois para mulheres.  Se n√£o houver informa√ß√µes sobre o campo biol√≥gico da amostra sequenciada, o campo GT conter√°, por padr√£o, dois valores num√©ricos (destacados em vermelho na Figura 2). <br><br>  Nos arquivos VCF usados ‚Äã‚Äãneste manual, o cromossomo Y √© exclu√≠do, mas a presen√ßa do cromossomo Y no arquivo VCF nem sempre significa que a amostra sequenciada realmente o possui.  Isso ocorre devido √†s regi√µes pseudo-autoss√¥micas (PARs), que s√£o id√™nticas para os cromossomos X e Y e est√£o localizadas em suas extremidades. <br><br>  Diferentes cromossomos normalmente n√£o t√™m regi√µes longas e id√™nticas (hom√≥logas), no entanto, os cromossomos X e Y possuem v√°rias regi√µes com v√°rios milh√µes de pares de bases no in√≠cio (PAR1) e no final (PAR2).  Portanto, ao analisar os dados de NGS em homens nas regi√µes PAR, s√£o encontrados dois alelos (um para cada cromossomo sexual) e, nas mulheres, os gen√≥tipos podem aparecer nas regi√µes PAR do cromossomo Y, embora, na verdade, sejam gen√≥tipos do cromossomo X. <br><br><img src="https://habrastorage.org/webt/xc/nx/ga/xcnxgajnkuainexvlp2a5ppsqrg.png"><br>  <b>Figura 2</b>  Arquivo VCF com gen√≥tipos do cromossomo X de um homem da regi√£o PAR1 (duas primeiras entradas) e regi√£o n√£o pseudo-autoss√¥mica (duas √∫ltimas entradas). <br><br><blockquote>  Unidade educacional <br>  O g√™nero gen√©tico √© um conjunto de cromossomos sexuais que corresponde √† manifesta√ß√£o das caracter√≠sticas sexuais prim√°rias e secund√°rias de um tipo masculino ou feminino.  Normalmente, os homens t√™m um cromossomo X e um cromossomo Y, enquanto as mulheres t√™m dois cromossomos X. Com v√°rios dist√∫rbios na forma√ß√£o de c√©lulas germinativas, √≥vulos e espermatoz√≥ides, uma crian√ßa com um excelente conjunto de cromossomos sexuais pode nascer dos pais, o que geralmente leva a dist√∫rbios do desenvolvimento caracter√≠sticas sexuais prim√°rias e secund√°rias. <br><br>  As duas anomalias sexuais cromoss√¥micas mais comuns s√£o a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%25A8%25D0%25B5%25D1%2580%25D0%25B5%25D1%2588%25D0%25B5%25D0%25B2%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE_%25E2%2580%2594_%25D0%25A2%25D1%2591%25D1%2580%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B0">s√≠ndrome de Turner</a> (um conjunto de cromossomos X0, ou seja, apenas um cromossomo X) e a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%259A%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD%25D1%2584%25D0%25B5%25D0%25BB%25D1%258C%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0">s√≠ndrome de Klinefelter</a> (um conjunto de cromossomos XXY). <br><br>  Um alelo √© um ou mais nucleot√≠deos que est√£o localizados em qualquer posi√ß√£o no genoma e t√™m uma alternativa.  O conceito √© usado para descrever gen√≥tipos.  Distinga entre alelos de refer√™ncia e alternativa.  Todos eles s√£o armazenados no arquivo VCF nos campos REF e ALT, respectivamente. </blockquote><br><h2>  Determinar o sexo </h2><br><div class="spoiler">  <b class="spoiler_title">Para usu√°rios do Yandex.Cloud</b> <div class="spoiler_text">  Todos os dados para concluir as tarefas manuais e independentes s√£o armazenados no Yandex.Cloud usando a estrutura mostrada abaixo.  A pasta <code>Tutorial</code> cont√©m o arquivo VCF necess√°rio para concluir o manual, a pasta <code>Test</code> para tarefas independentes.  A pasta <code>Technical</code> cont√©m dois arquivos com uma lista de identificadores de varia√ß√µes gen√©ticas: <code>rsids_for_subsetting.txt</code> usado no manual e tarefas para execu√ß√£o independente, <code>external_interpretation_rsids.txt</code> pode ser necess√°rio no futuro ao adquirir o seq√ºenciamento gen√¥mico no Atlas para fazer upload de dados de genotipagem para servi√ßos de terceiros.  A pasta <code>Tools</code> cont√©m, entre outras coisas, dois scripts usados ‚Äã‚Äãnas tarefas 2 e 3. <br><br><pre> <code class="bash hljs">home ‚îî‚îÄ‚îÄ ubuntu ‚îú‚îÄ‚îÄ Data ‚îÇ ‚îú‚îÄ‚îÄ Test ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz.tbi ‚îÇ ‚îî‚îÄ‚îÄ Tutorial ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz.tbi ‚îú‚îÄ‚îÄ Technical ‚îÇ ‚îú‚îÄ‚îÄ external_interpretation_rsids.txt ‚îÇ ‚îî‚îÄ‚îÄ rsids_for_subsetting.txt ‚îî‚îÄ‚îÄ Tools ‚îú‚îÄ‚îÄ convert_plink_delimiter.sh ‚îî‚îÄ‚îÄ create_23andme.sh</code> </pre> <br>  Uma pasta ser√° criada no diret√≥rio <code>/home</code> na VM Yandex.Cloud, cujo nome corresponde ao nome de usu√°rio especificado no est√°gio de cria√ß√£o da VM.  Copie tudo do diret√≥rio <code>/home/ubuntu</code> para o seu diret√≥rio atrav√©s dos seguintes comandos: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ cp -r /home/ubuntu/* ./</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para o resto</b> <div class="spoiler_text">  Ao trabalhar em um PC pessoal, voc√™ pode baixar os arquivos necess√°rios para a primeira tarefa no <a href="">link</a> .  O arquivo baixado suporta uma estrutura de armazenamento de arquivos semelhante √† usada no Yandex.Cloud: <br><br><pre> <code class="bash hljs">home ‚îî‚îÄ‚îÄ ubuntu ‚îú‚îÄ‚îÄ Data ‚îÇ ‚îú‚îÄ‚îÄ Test ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.test.vcf.gz.tbi ‚îÇ ‚îî‚îÄ‚îÄ Tutorial ‚îÇ ‚îú‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz ‚îÇ ‚îî‚îÄ‚îÄ CEI.1kg.2019.demo.vcf.gz.tbi ‚îú‚îÄ‚îÄ Technical ‚îÇ ‚îú‚îÄ‚îÄ external_interpretation_rsids.txt ‚îÇ ‚îî‚îÄ‚îÄ rsids_for_subsetting.txt ‚îî‚îÄ‚îÄ Tools ‚îú‚îÄ‚îÄ convert_plink_delimiter.sh ‚îî‚îÄ‚îÄ create_23andme.sh</code> </pre> <br>  Descompacte o arquivo <code>atlas_wgs_contest.tar.gz</code> com o comando <br> <code>tar -xvzf atlas_wgs_contest.tar.gz</code> <br> </div></div><br>  Os arquivos VCF para executar tarefas de forma n√£o arquivada ocupam cerca de 19 gigabytes cada, portanto, para economizar espa√ßo, recomendamos trabalhar apenas com arquivos.  Todos os programas listados acima j√° s√£o capazes de trabalhar com dados de VCF compactados.  Al√©m disso, voc√™ n√£o precisa fazer nada. <br><br>  Para determinar o sexo do sujeito, √© necess√°rio examinar os gen√≥tipos no cromossomo X e excluir as regi√µes PAR1 e PAR2 localizadas no in√≠cio e no final.  Esses s√£o os intervalos das posi√ß√µes 60001 a 2699520 e 154931044 a 155260560 na vers√£o GRCh37 do genoma.  Se o gen√≥tipo contiver uma designa√ß√£o num√©rica, esse √© o sexo biol√≥gico masculino, caso contr√°rio, a f√™mea.  Deve-se ter em mente que a designa√ß√£o de g√™nero no arquivo VCF depende da disponibilidade de informa√ß√µes sobre o campo biol√≥gico durante a gera√ß√£o do VCF, portanto, essa abordagem nem sempre pode ser usada. <br><br>  Use o seguinte comando para cada uma das amostras no conjunto de dados.  Substitua o identificador de amostra ap√≥s o argumento <code>-s</code> : <br><br><pre> <code class="bash hljs">(/Data/Tutotrial/CEI.1kg.2019.demo.vcf.gz): <span class="hljs-comment"><span class="hljs-comment">#      bcftools view -O v -H -s HG00731 -r chrX:2699521-154931043 CEI.1kg.2019.demo.vcf.gz | head</span></span></code> </pre> <br>  Ao executar os comandos, voc√™ ver√° uma parte do conte√∫do do arquivo VCF para o identificador de amostra especificado.  O <code>-r chrX:2699521-154931043</code> no BCFtools restringe a visualiza√ß√£o do conte√∫do do arquivo √† regi√£o do cromossomo X da posi√ß√£o 2699521 para a posi√ß√£o 154931043 (regi√£o n√£o PAR na Figura 3).  Esses limites excluem regi√µes pseudo-autoss√¥micas desnecess√°rias neste caso (PAR1 e PAR2).  Usando os valores num√©ricos no campo GT, determine o sexo de cada amostra. <br><br><img src="https://habrastorage.org/webt/vn/fx/et/vnfxetqzursuy3ltyytqj-giiko.png"><br>  <b>Figura 3</b>  A localiza√ß√£o das regi√µes pseudo-autoss√¥micas de PAR1 e PAR2 nos cromossomos sexuais. <br><br>  Voc√™ pode ver a lista de todos os identificadores de amostra no arquivo VCF na Figura 1 ou na √∫ltima linha do cabe√ßalho do arquivo VCF.  Eles ser√£o listados ap√≥s o nome da coluna FORMAT: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT HG00731 HG00732 HG02026 HG02025 HG02250 HG02373 HG00733 HG02024 HG02377 HG02381</span></span></code> </pre> <br>  O verdadeiro sexo dessas amostras tamb√©m √© mostrado na Figura 1. <br><br><br><h2>  N√≥s determinamos o relacionamento </h2><br>  Para determinar a rela√ß√£o, precisamos comparar aos pares os dados gen√©ticos de todas as amostras.  √â dif√≠cil fazer isso de acordo com o genoma completo: nesse caso, um arquivo VCF consome dezenas de gigabytes.  O VCF que usamos ocupa apenas cerca de 2 gigabytes, mas ainda o filtramos de acordo com a lista de identificadores de varia√ß√£o gen√©tica (rsIDs) genotipados em chips da Illumina: GSA v1, GSA v2, HumanOmniExpress v1.0, HumanOmniExpress v1.3, InfiniumExome v1. 1 e Infinium OmniExpressExome v1.4.  Estes s√£o os chips mais populares na genotipagem comercial. <br><br>  N√≥s compilamos uma lista de todos os identificadores de varia√ß√µes gen√©ticas desses chips em um arquivo separado com uma lista de rsIDs.  Ele cont√©m 1,4 milh√µes de identificadores.  Para filtrar o arquivo VCF, execute o seguinte comando: <br><br><pre> <code class="bash hljs">bcftools view -O z -i <span class="hljs-string"><span class="hljs-string">'ID=@rsids_for_subsetting.txt'</span></span> CEI.1kg.2019.demo.vcf.gz &gt; CEI.1kg.2019.demo.subset.vcf.gz</code> </pre> <br>  Cada vez que voc√™ usa o BCFtools e outros pacotes para trabalhar com arquivos VCF, o hist√≥rico dos comandos anteriores √© adicionado ao cabe√ßalho do arquivo.  Independentemente do m√©todo de filtragem do arquivo VCF e dos comandos executados anteriormente, voc√™ pode verificar a integridade e a identidade do conte√∫do principal do VCF calculando a soma de hash: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      gunzip -c CEI.1kg.2019.demo.subset.vcf.gz | grep -v "^#" &gt; CEI.1kg.2019.demo.subset.body.vcf md5sum --tag CEI.1kg.2019.demo.subset.body.vcf #       d609eb330908d4eb5feb9f1860fd508b</span></span></code> </pre> <br>  O comando <code>gunzip -c</code> descompacta o arquivo e <code>gunzip -c</code> seu conte√∫do em stdout, a partir do qual as linhas de cabe√ßalho do arquivo VCF iniciadas <code> #</code> s√£o exclu√≠das (portanto, o comando <code>grep -v "^#"</code> √© usado).  O cabe√ßalho √© removido para comparar a integridade apenas dos dados gen√©ticos, e n√£o dos metadados sobre quais ferramentas e quando foram usadas para trabalhar com esse arquivo VCF. <br><br>  Se o valor do hash corresponder, √© poss√≠vel seguir em frente e converter o VCF para o formato interno do Plink (por padr√£o, o formato do Plink √© de tr√™s arquivos com as extens√µes bed, bim e fam).  Nesses arquivos, apenas o gen√≥tipo, cromossomo, posi√ß√£o e alguns outros dados permanecem, e o restante √© eliminado.  Com esse formato, √© muito mais f√°cil trabalhar e resolver v√°rios problemas que n√£o exigem informa√ß√µes adicionais do VCF.  Por exemplo, conduza o GWAS. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     plink --vcf CEI.1kg.2019.demo.subset.vcf.gz --make-bed --out CEI.1kg.2019.demo.subset</span></span></code> </pre><br>  Este comando criar√° tr√™s arquivos na pasta: <br> <code>CEI.1kg.2019.demo.subset.bed <br> CEI.1kg.2019.demo.subset.bim <br> CEI.1kg.2019.demo.subset.fam</code> <br> <br>  Voc√™ pode determinar parentesco pareado para todas as 10 amostras.  Usamos o seguinte comando para analisar arquivos Plink: <br><br><pre> <code class="bash hljs">king -b CEI.1kg.2019.demo.subset.bed --kinship --prefix CEI.1kg.2019.demo.subset.kinship_analysis</code> </pre> <br>  Observe o arquivo <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> e preste aten√ß√£o √† coluna Parentesco, que cont√©m os coeficientes de parentesco para os pares de amostras indicados em ID1 e ID2, respectivamente. <br><br>  Compare os coeficientes que voc√™ obteve no arquivo <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> para todos os pares de amostras com o pedigree mostrado na Figura 1 (a linha tracejada corresponde ao parentesco de segunda ordem; no entanto, n√£o h√° dados de parentesco exatos, ou seja, pode haver primos, tia / sobrinho ou tio / sobrinha).  Tente fazer sua pr√≥pria conclus√£o sobre quais valores dos coeficientes de parentesco podem corresponder √† rela√ß√£o de primeira e segunda ordem. <br><br><div class="spoiler">  <b class="spoiler_title">Sugest√£o</b> <div class="spoiler_text">  Trecho da documenta√ß√£o do KING: coeficientes de parentesco&gt; 0,354 correspondem a amostras duplicadas ou g√™meos id√™nticos, de 0,177 a 0,354 a parentesco de primeira ordem (pais-filhos, irm√£os), de 0,0884 a 0,177 a parentesco de segunda ordem (primos, tias / tios-sobrinhos) e de 0,0442 a 0,0884 - at√© o parentesco de terceira ordem (av√≥s, netos, primos em segundo grau).  Qualquer coisa menor que 0,0442 √© dif√≠cil de interpretar sem ambiguidade. <br></div></div><br><br><h2>  A primeira tarefa da competi√ß√£o </h2><br>  Usando um conjunto de dados de teste de 12 amostras <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> , <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> sua linhagem, guiada pelos resultados da determina√ß√£o do sexo e an√°lise de parentesco.  Amostras que, de acordo com os resultados da an√°lise, n√£o est√£o em parentesco com algu√©m, escrevem nas proximidades, sem conect√°-las a uma linha com outras amostras.  O pedigree pode ser composto em um estilo semelhante √† Figura 1, no entanto, isso permanece a seu crit√©rio.  Os homens s√£o indicados por um quadrado, as mulheres por um c√≠rculo, o casamento por uma linha horizontal, um filho por uma linha vertical, v√°rios filhos por uma ramifica√ß√£o horizontal de uma linha vertical (na forma da letra P).  Leia mais sobre essas designa√ß√µes <a href="https://www.khanacademy.org/science/high-school-biology/hs-classical-genetics/hs-pedigrees/a/hs-pedigrees-review">aqui</a> . <br><br>  Como escrevemos acima, os coeficientes de parentesco n√£o podem caracterizar inequivocamente o parentesco de uma ou de outra ordem: os mesmos coeficientes de parentesco s√£o obtidos ao comparar os pares pai-filho e irm√£o-irm√£ (parentesco de primeira ordem).  Se n√£o for poss√≠vel estabelecer a natureza do relacionamento, indique algum dos poss√≠veis.  Observe que as amostras no conjunto de dados de teste t√™m identificadores diferentes daqueles usados ‚Äã‚Äãno conjunto de dados de treinamento. <br><br>  As respostas <a href="">devem ser enviadas</a> para o correio <a href="">wgs@atlas.ru</a> at√© 26 de dezembro √†s 23:59.  Mais duas tarefas ser√£o publicadas em breve, e os resultados finais das tarefas aparecer√£o em 28 de dezembro.  O vencedor receber√° o teste do Genoma Completo, e o segundo e o terceiro lugares receber√£o o teste gen√©tico do Atlas.  Tamb√©m haver√° pr√™mios especiais do <a href="https://cloud.yandex.ru/">Yandex.Cloud</a> .  Ex-funcion√°rios atuais e atuais da Atlas n√£o participam da competi√ß√£o;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt480954/">https://habr.com/ru/post/pt480954/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt480940/index.html">Executar teste de interface do usu√°rio no navegador com Pepino e Selenoid no Gitlab CI com relat√≥rio Allure</a></li>
<li><a href="../pt480944/index.html">As 5 principais tend√™ncias do marketing por e-mail em 2020</a></li>
<li><a href="../pt480946/index.html">Entra Kubernetes (e n√£o apenas) hoje: expectativas e realidade</a></li>
<li><a href="../pt480948/index.html">Mitap marketing e rela√ß√µes p√∫blicas em Ivanovo</a></li>
<li><a href="../pt480950/index.html">An√°lise do question√°rio Android no estande hh.ru no Mobius 2019 Moscow</a></li>
<li><a href="../pt480956/index.html">Como encontrei uma maneira de rastrear todos os drivers do Citimobil</a></li>
<li><a href="../pt480958/index.html">Conex√£o via sat√©lite. Vis√£o geral das empresas operadoras e um pouco sobre a classifica√ß√£o</a></li>
<li><a href="../pt480960/index.html">Encontre arquivos perdidos em v√°rios destinos do Xcode</a></li>
<li><a href="../pt480962/index.html">Desenvolvimento do compilador C para o novo neuroprocessador multiclet</a></li>
<li><a href="../pt480964/index.html">O que √© a zona Fresnel e o CCQ (Client Connection Quality) ou os fatores fundamentais de uma ponte sem fio de alta qualidade</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>