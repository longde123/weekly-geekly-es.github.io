<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàπ üöä üë©üèΩ‚Äçüéì Automatizar la compilaci√≥n de un proyecto Qt en Windows en Travis CI üïç ‚ö†Ô∏è ‚öôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recientemente, para QtProtobuf, me sorprendi√≥ configurar un CI mand√≥n para verificar las solicitudes de extracci√≥n aka y, por supuesto, insertar una i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatizar la compilaci√≥n de un proyecto Qt en Windows en Travis CI</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485034/"><p>  Recientemente, para <a href="https://github.com/semlanik/qtprotobuf" rel="nofollow">QtProtobuf,</a> me sorprendi√≥ configurar un CI mand√≥n para verificar las solicitudes de extracci√≥n aka y, por supuesto, insertar una insignia de moda en el archivo README del proyecto.  Las opciones fueron <a href="https://github.com/features/actions" rel="nofollow">GitHub Actions</a> y <a href="https://travis-ci.com/" rel="nofollow">Travis CI</a> .  Honestamente, no me propuse buscar, comparar, analizar, quer√≠a simplicidad y soluci√≥n r√°pida para una tarea muy simple.  Primero, descubr√≠ el CI para las acciones de GitHub y configur√© la verificaci√≥n de prueba de compilaci√≥n y unidad a trav√©s del contenedor acoplable.  Pero debido a la gran cantidad de limitaciones, las acciones de GitHub resultaron simplemente inadecuadas para la verificaci√≥n de proyectos en Windows.  Tuve que recurrir a Travis CI. </p><br><p>  <em>KDPV_not_found.png</em> </p><a name="habracut"></a><br><p>  Al momento de escribir este art√≠culo en Travis CI, hab√≠a tal descargo de responsabilidad: </p><br><blockquote>  Las compilaciones de Windows est√°n en la etapa de acceso temprano.  Dir√≠jase al foro de la comunidad de Travis CI para obtener ayuda o publicar ideas. </blockquote><p>  Esto caus√≥ preocupaci√≥n, porque inicialmente intent√© configurar todo a trav√©s del contenedor acoplable y colocarlo en las acciones de GitHub, pero esta empresa fall√≥ debido a restricciones en el tama√±o, tipo de contenedores, etc.  en github. </p><br><h2 id="k-delu">  A los negocios </h2><br><p> Para comenzar, debe autorizar Travis CI en GitHub, despu√©s de lo cual la <a href="https://github.com/settings/installations" rel="nofollow">aplicaci√≥n</a> Travis CI aparecer√° en la configuraci√≥n de su perfil.  Convenientemente, puede definir repositorios a los que Travis CI puede acceder: </p><br><p><img src="https://habrastorage.org/webt/x-/rl/lc/x-rllc93_hpbwe6vsoyqhd6ckj8.png"></p><br><p>  El siguiente paso es configurar los activadores de Travis CI.  Este procedimiento ya se est√° realizando desde el panel de administraci√≥n de Travis CI en s√≠; en el momento de la redacci√≥n, estaban disponibles los siguientes desencadenantes: </p><br><ul><li>  Empuje el lanzamiento a cualquier brunch de proyecto </li><li>  Ejecutar al crear solicitudes de fusi√≥n </li><li>  Disparador temporizado (cron) </li></ul><br><p>  En principio, un conjunto decente para construir CI. </p><br><p>  Despu√©s de seleccionar los desencadenantes para ejecutar las compilaciones, debe crear <em>.travis.yml</em> , con una descripci√≥n del procedimiento de compilaci√≥n y, seg√∫n los desencadenantes disponibles, colocar este archivo en el repositorio.  La documentaci√≥n dispersa y poco sistem√°tica de Travis CI en s√≠ con respecto a <em>.travis.yml qued√≥</em> perpleja de inmediato, pero puede resolverla si lo desea. </p><br><p>  La tarea principal que se mantuvo fue preparar el entorno para el ensamblaje, ya que el ensamblaje en s√≠ y la verificaci√≥n es asunto de CMake. </p><br><h2 id="opisyvaem-proceduru-sborki-v-travisyml">  Describimos el procedimiento de ensamblaje en <em>.travis.yml</em> </h2><br><p>  Primero debe elegir un sistema operativo que se ejecute como una m√°quina virtual en los servidores Travis CI y un lenguaje de programaci√≥n. </p><br><pre><code class="plaintext hljs">os: windows language: C++ ...</code> </pre> <br><p>  <em>El lenguaje</em> , seg√∫n tengo entendido, automatiza algunos pasos si no se especifican expl√≠citamente, pero su vinculaci√≥n es un misterio para m√≠.  Pens√© que sin √©l no habr√≠a MSVC preinstalado, pero durante los experimentos result√≥ que tambi√©n estaba presente para otros idiomas. </p><br><p>  El siguiente paso es descargar e instalar las dependencias necesarias.  Para QtProtobuf, estos son: </p><br><ul><li>  Qt 5.12.3 o superior </li><li>  cmake-3.1 o superior </li><li>  Fresa perl 5.28 o superior </li><li>  GoLang 1.10 o superior </li><li>  Yasm 1.3 o superior </li><li>  Visual Studio Compiler 14.16.x </li></ul><br><p>  Y aqu√≠ Travis CI fue de gran <a href="https://docs.travis-ci.com/user/reference/windows/" rel="nofollow">ayuda</a> .  Entre los paquetes preinstalados no solo estaban Git y MSVC, sino tambi√©n cmake, wget y <a href="https://chocolatey.org/" rel="nofollow">chocolatey</a> .  En prisnip en presencia de chocolate, se facilita enormemente la instalaci√≥n adicional de dependencias.  Es cierto, sigue siendo un misterio para m√≠ por qu√© Qt a√∫n no se ha entregado a chocolatey. </p><br><p>  Para comenzar, descargue el instalador completo de Qt del repositorio oficial: </p><br><pre> <code class="plaintext hljs">... before_install: - wget -q https://download.qt.io/official_releases/qt/5.13/5.13.2/qt-opensource-windows-x86-5.13.2.exe ...</code> </pre> <br><blockquote>  <em>Nota:</em> Al descargar, wget volca una gran cantidad de registros con el progreso de la descarga.  Travis CI, como GitHub, tiene un l√≠mite en el tama√±o del registro de compilaci√≥n, por lo que se deben evitar registros innecesarios.  La opci√≥n -q aka --quite oculta la salida del registro wget. </blockquote><p>  Realizamos la instalaci√≥n de las dependencias necesarias: </p><br><pre> <code class="plaintext hljs">... install: - choco install golang - choco install yasm - ./qt-opensource-windows-x86-5.13.2.exe --script ./.ci/qt_installer_windows.qs ...</code> </pre> <br><p>  Con la instalaci√≥n de GoLang y Yasm, creo que no deber√≠a haber preguntas.  Pero con el lanzamiento del instalador Qt, prestar√© m√°s atenci√≥n. </p><br><p>  <a href="https://doc.qt.io/qtinstallerframework/index.html" rel="nofollow">QtInstallerFramework</a> admite la automatizaci√≥n del proceso de instalaci√≥n al escribir <a href="https://doc.qt.io/qtinstallerframework/noninteractive.html" rel="nofollow">scripts</a> . </p><br><p>  Las secuencias de comandos listas para usar para instalar una versi√≥n particular de Qt solo est√°n en Google, solo dar√© un enlace a mi versi√≥n actual y prestar√© atenci√≥n a la elecci√≥n de los componentes para la instalaci√≥n: </p><br><pre> <code class="plaintext hljs">... Controller.prototype.ComponentSelectionPageCallback = function() { var widget = gui.currentPageWidget(); widget.deselectAll(); widget.selectComponent("qt.qt5.5132.win32_msvc2017"); gui.clickButton(buttons.NextButton); } ...</code> </pre> <br><p>  Aqu√≠ <code>widget.deselectAll();</code> todos los componentes de la casilla de verificaci√≥n llamando a <code>widget.deselectAll();</code>  e incluya el " <em>qt.qt5.5132.win32_msvc2017</em> " necesario para la construcci√≥n.  Hay 2 aspectos que son importantes al escribir este procedimiento: </p><br><ul><li>  selectComponent funciona igual que el componente gr√°fico y, por lo tanto, las dependencias y subcomponentes se seleccionan de acuerdo con la misma l√≥gica que si los seleccion√°ramos en la interfaz gr√°fica.  Es por eso que no hay necesidad de preocuparse por resolver dependencias. </li><li>  Los nombres de los componentes se pueden ver en el modo de instalaci√≥n "verbal".  Para hacer esto, realic√© <code>widget.selectAll();</code> en una de las iteraciones <code>widget.selectAll();</code>  e inici√≥ la instalaci√≥n con el <code>- ./qt-opensource-windows-x86-5.13.2.exe --verbose --script ./.ci/qt_installer_windows.qs</code> .  En los registros, puede encontrar f√°cilmente todos los componentes que necesita y moderar su instalaci√≥n utilizando widget.selectComponent / widget.deselectComponent. </li></ul><br><p>  Y el √∫ltimo punto importante que cubrir√© en este tutorial es el entorno de compilaci√≥n.  Debido al hecho de que la instalaci√≥n de dependencias y el ensamblaje se llevan a cabo dentro del mismo shell, despu√©s de configurar Go y Yasm en nuestro shell no hay una RUTA registrada antes de los archivos ejecutables.  Por lo tanto, debe registrar manualmente PATH, GOROOT antes de postrarse: </p><br><pre> <code class="plaintext hljs">script: ... - setx path "%path%;C:\Qt\5.13.2\msvc2017\bin;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" - set GOROOT="c:\Go" - set PATH="%PATH%;C:\Qt\5.13.2\msvc2017\bin;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" - cmake -DCMAKE_PREFIX_PATH="C:\Qt\5.13.2\msvc2017;C:\Go\bin;C:\ProgramData\chocolatey\lib\yasm\tools" .. ...</code> </pre> <br><p>  Tambi√©n quiero llamar la atenci√≥n sobre el hecho de que en CMAKE_PREFIX_PATH, por analog√≠a, debe especificar la ruta a Go y Yasm para que la funci√≥n find_program funcione correctamente. </p><br><p>  Quiz√°s m√°s adelante describa la creaci√≥n de un contenedor acoplable para construir con Qt a bordo. </p><br><p>  Todos los scripts se pueden encontrar <a href="https://github.com/semlanik/qtprotobuf" rel="nofollow">aqu√≠.</a> </p></div></div><p>Source: <a href="https://habr.com/ru/post/485034/">https://habr.com/ru/post/485034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../485024/index.html">¬øQu√© hay debajo de las optimizaciones del compilador GraalVM?</a></li>
<li><a href="../485026/index.html">Oportunidades de Georgia para profesionales de TI</a></li>
<li><a href="../485028/index.html">CRM 2020</a></li>
<li><a href="../485030/index.html">Top 8 tarifas de IEO y su capitalizaci√≥n ahora</a></li>
<li><a href="../485032/index.html">C√≥mo hacer que una aplicaci√≥n React sea m√°s r√°pida con el cohospedaje estatal</a></li>
<li><a href="../485036/index.html">¬øPor qu√© necesito soporte instrumental para la paginaci√≥n clave?</a></li>
<li><a href="../485042/index.html">Debido al soporte obligatorio 5G, los tel√©fonos inteligentes con Snapdragon 865 ser√°n peores en 2020</a></li>
<li><a href="../485044/index.html">Desmontamos el reloj digital de la nave espacial Soyuz</a></li>
<li><a href="../485046/index.html">C√≥mo planificar una estrategia de producto ganadora</a></li>
<li><a href="../485050/index.html">Hipercubo C√≥mo proporcionamos a los desarrolladores dispositivos de prueba y no los perdimos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>