<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👶 💆🏽 🤰🏽 培训Cisco 200-125 CCNA v3.0。 第36天。频道协议STP 🙆🏽 🎖️ 🕵🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今天，我们将探讨信道生成树协议STP。 这个话题由于表面上的复杂性而使许多人感到恐惧，因为他们无法理解STP协议的功能。 我希望在本视频教程结束时或在下一堂课中，您将了解“树”的工作原理。 在开始课程之前，我想向您展示本周桌面的新设计。 



 如果您使用此视频右上角的链接，也可以通过类似的方式设...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>培训Cisco 200-125 CCNA v3.0。 第36天。频道协议STP</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/466405/">今天，我们将探讨信道生成树协议STP。 这个话题由于表面上的复杂性而使许多人感到恐惧，因为他们无法理解STP协议的功能。 我希望在本视频教程结束时或在下一堂课中，您将了解“树”的工作原理。 在开始课程之前，我想向您展示本周桌面的新设计。 <br><br><img src="https://habrastorage.org/webt/qd/8j/_q/qd8j_qwzpce7ydqcvqggv4phr50.jpeg"><br><br> 如果您使用此视频右上角的链接，也可以通过类似的方式设置桌面。 并且，请不要忘记“喜欢”并与朋友分享我的视频课程。 <br><br> 与上次一样，今天我们将根据思科网站上提供的ICND2时间表讨论另一个主题。 这是第1.3节“配置，验证STP协议和问题”，第1.3a小节，“ STP模式（PVST +和RPVST +）”和第1.3b节“选择STP根桥交换机”。 <a name="habracut"></a><br><br> 由于这是一个广泛的主题，因此我将对1.3b小节的讨论移至下一课“第37天”，并将在此添加1.4小节。 因此，今天我们看一下STP是什么样的，看一下该协议PVST +和RPVST +的模式，然后看一下网桥交换机根交换机ID和到端口成本根端口的路由成本。 <br><br><img src="https://habrastorage.org/webt/wl/as/sj/wlassjxj2oqy2pvoyrb-ykzx5mi.jpeg"><br><br> 首先，我们需要了解在OSI模型的第二级（在帧级）出现的切换环是什么，以及与之相关的问题。 我们已经在上一集中讨论了流量循环，并且该课程可以被视为今天主题的介绍。 让我举一个例子：我们有通过两条通信线路相互连接的交换机A和交换机B，第一个用户叫Joe，第二个用户叫Jim。 <br><br><img src="https://habrastorage.org/webt/4c/g-/xm/4cg-xm-of2s7jzigdlzvl0zuwcy.jpeg"><br><br> 如果Joe向Jim发送消息，则他将帧发送到交换机A。交换机A不知道Jim的MAC地址，因此他通过所有端口发送广播帧，但Joe接收消息的端口除外。 当交换机B的端口接收到广播帧时，到达一个接口的数据包将发送到吉姆，并将到达第二个接口的数据包转发到第一个端口，然后发送回交换机A。 <br><br><img src="https://habrastorage.org/webt/ci/e0/w-/cie0w-pdwbcnwjakvrfbdyv3jjq.jpeg"><br><br> 同时，到达第一个接口的请求被转发到第二个端口，并且还发送到交换机A。 <br><br><img src="https://habrastorage.org/webt/oi/3l/gp/oi3lgpzuy8yklulq2hkefw-1z3k.jpeg"><br><br> 接收到这些广播帧后，交换机A将它们发送回去：第一个接口上接收的帧在第二个接口上发送，第二个接口上接收的帧通过第一个接口发送到网络。 此过程一遍又一遍地重复，形成广播请求的循环。 如果另一个广播进入网络，则其循环方式与第一个相同。 结果就是称为广播风暴或广播风暴的现象。 网络淹没了太多的广播帧，导致其崩溃。 仅当其中一台设备断开连接或断开连接时，风暴才能停止。 如果该线路仍然可操作，则在此类风暴开始后不久，其中一台交换机将由于内存溢出而停止工作。 在第二种情况下，由于转发具有单播MAC地址的帧，可能会发生环路。 此问题称为“ MAC地址表不稳定性”。 当交换机之间的连接超过两个时，就会发生这种情况。 我将绘制一个示意图，其中开关A，B和C相互连接，并且它们之间也可能形成环路。 <br><br> 交换机A具有三个接口：f0 / 1，f0 / 2和f0 / 3。 假设用户有一台具有AAA MAC地址的计算机，并将广播帧发送到交换机A。交换机通过f0 / 1接口接受此帧。 网络上还有另一个用户的计算机具有BBB MAC地址。 因此，我们有源地址AAA和目标地址BBB。 <br><br><img src="https://habrastorage.org/webt/vb/ny/sq/vbnysqpjkbkzx8fazia-l83dnwm.jpeg"><br><br> 交换机A不知道如何到达BBB的目标MAC地址，但它知道可以通过f0 / 1接口访问AAA的源MAC地址，并将有关它的记录放入其MAC地址表中。 交换机A然后将对目的地址的请求发送到其他两个接口-f0 / 2和f0 / 3。 <br><br> 在收到AAA请求后，交换机B看到它来自源f0 / 2，并将其通过f0 / 2接口可访问AAA设备的记录放入其MAC地址表中。 另外，他已经有一个记录，表明fB / 1接口与BBB目的地相对应，因此他将请求发送给了收件人。 <br><br><img src="https://habrastorage.org/webt/xt/ve/jh/xtvejhnvwv67ck8wezcu9idbbx4.jpeg"><br><br> 由于交换机A发送了广播帧，因此它不仅通过f0 / 2接口到达交换机B，而且还通过f0 / 3接口到达交换机C，后者又将其发送到交换机B的f0 / 3接口。 <br><br><img src="https://habrastorage.org/webt/01/qe/be/01qebe868rzvxx0we7qrxfiqm44.jpeg"><br><br> 收到帧后，交换机B会这样认为：“我知道AAA源以前位于f0 / 2接口上，但是现在它的帧是通过f0 / 3接口传给我的，所以我必须更新我的MAC地址表并替换f0 / 2等于f0 /3。“ <br><br><img src="https://habrastorage.org/webt/mx/f-/hu/mxf-hu_w2zknw2aodud5qxu6rpi.jpeg"><br><br> 接下来，该帧将返回到交换机A，并且非常“惊奇”它：在交换机A认为源AAA已连接到f0 / 1接口之前，现在发现消息来自f0 / 2接口。 通过交换机B和C在帧的相反方向上，交换机A将收到一条消息，这将再次使他感到困惑-现在事实证明AAA源位于f0 / 3接口上。 <br><br><img src="https://habrastorage.org/webt/v5/su/de/v5sudeyxunx2uctf1ssitxnirbk.jpeg"><br><br> 因此，该交换机的MAC地址表将在这三个接口之间不断地更新，即，将出现上述MAC地址表不稳定的问题。 与第一种情况一样，此处形成了帧循环，导致表每隔几秒钟更新一次。 <br><br> 第三个循环问题-框架的多个副本。 用户AAA将帧发送到交换机A，然后通过f0 / 2接口将其发送到交换机B，交换机B通过f0 / 1接口将其传递到BBB目的地。 没有问题。 <br><br> 但是同时，交换机A通过第二个接口f0 / 3将相同的帧发送到交换机C，交换机C将其转发到交换机B.从交换机C接收到数据包或帧后，交换机B看到将其发送给BBB并将其发送给收件人。 因此，BBB用户两次收到相同的数据包。 这里出现问题-如果这是由应用程序执行的数据分发，则同一帧不应两次出现给用户。 <br><br> 这是帧循环可能导致的三个问题。 使用STP协议，所有这些问题都以一种我们前面已经讨论过的方式解决了。 在前面的一个视频中，我不记得他的电话号码，当我们讨论端口模式时，已经提到了该协议，该协议可以防止网络中的流量环路。 <br><br> 因此，当三个设备彼此连接时形成一个环路，形成一个封闭的网络环路，并且属于同一广播域。 对于这种情况，STP协议使用的算法将其中一台交换机指定为根交换机-根网桥。 让我们选择交换机A作为根交换机。 <br><br><img src="https://habrastorage.org/webt/nz/qg/d5/nzqgd5e78l5oqonqp3kwuopwe0o.jpeg"><br><br> 连接到根交换机的每个端口都必须处于转发状态，这些端口是交换机C和B的左侧端口。这些端口向着根交换机A的方向提供数据包或帧的传输。在交换机C和B的连接线上，其中一个端口必须是处于阻塞状态阻塞。 <br><br><img src="https://habrastorage.org/webt/to/og/mw/toogmwtdhyreqmouwhoft7gznek.jpeg"><br><br> 这意味着它没有发送流量。 交换机B可能会继续向交换机C发送流量，但它的正确端口将在物理上继续运行，但不会处理此流量。 这是通过使用网桥标识符或BID开关标识符-网桥ID来完成的。 <br><br> 您必须记住，STP是在以太网交换机出现之前就创建的。 然后，代替了术语切换，而是使用了术语桥，并且许多协议仍然使用技术标准的经典术语。 因此，现在BID是交换机标识符。 <br><br> 根交换机与其他​​交换机交换的信息称为BPDU。 设备每2秒交换一次BPDU消息-这次称为“ hello计时器”。  BPDU消息包含根交换机的BID以及到根交换机的路由成本，或“根路径成本”（实际上是到根交换机的距离）。 每个端口上的路径成本用于计算到根交换机的最短路径，但是我们不会深入研究这个概念。 <br><br> 从逻辑上讲，该方案是这样工作的：由于交换机C的右侧端口被阻塞，流量朝着交换机A的方向流-交换机B-交换机C不会进入交换机A，也就是说，它不会在环路中闭合。  C引导流量A，将其发送到B，交换机B将其引导到C，此时环路中断。 <br><br><img src="https://habrastorage.org/webt/un/dn/vh/undnvh6pu8b09-f6v8y2jjryco0.jpeg"><br><br> 这是IEEE 802.1d标准的STP协议的工作方式。 这是一个非常古老的标准，其缺点是通信断开时更新信息的最大时间等于50秒。 除了“阻塞端口”阻塞状态外，它还支持2个其他中间状态-“侦听”和“学习”，然后切换到“转发”传输状态。 <br><br> 交换机每2秒交换一次问候消息-C将其发送到B和A，A发送问候C和B，依此类推。 如果哪个设备没有收到此消息，它将等待它再等待10倍的hello定时器，即20秒。 之后，它等待一些动作，进入监听状态，持续15秒，然后进入学习状态，并保持15秒钟。 因此，总的不活动时间为50 s。 对于现代网络，这是一个相当长的时间。 <br><br> 为了改善这种情况，引入了另一个标准-IEEE 802.1w或快速STP-快速STP协议，称为RSTP。 它没有中间状态，从阻塞状态变为转发状态。 <br><br> 在STP中，有根端口Root Port（根端口）-这些端口用于与根交换机进行通信。 在RSTP中，添加了与根交换机无关的备用端口的概念。 如果RP的根端口与根交换机之间断开连接，则备用ALT端口立即变为RP的根端口，并在不同的路由上进行通信。 <br><br><img src="https://habrastorage.org/webt/sp/gy/x1/spgyx1k4kfjhapc-ur0bdflad4o.jpeg"><br><br> 对于最困难的事件，整个过程最多需要10秒，而10秒的不活动比50秒要好得多。 这是STP和RSTP之间的主要区别。 <br><br> 思科现在以多种方式使用STP，但最初旨在与本机VLAN在同一广播域中工作，因此STP被视为VLAN1的一部分。 同时，人们认为所有流量都是该单个广播域的一部分。 随着网络设备的发展，思科开始以其他方式使用STP，创建了PVSTP（每VLAN生成树），这是一种专用于与多个VLAN配合使用的专有协议。 这意味着每个VLAN都有自己的STP，即自己的根根交换机根桥。 <br><br><img src="https://habrastorage.org/webt/mw/3u/mj/mw3umjyuucfzsnl2ugkludxfgpe.jpeg"><br><br> 与思科通过创建RSTP改进STP的方式一样，它开发了PVSTP的“加速”版本-RPVSTP。 这两种协议都使用专有的ISL协议封装，并且不支持802.1q标准，因为它们是在采用之前开发的。 为了提高互操作性，Cisco通过添加802.1q支持来增强了这些协议。 同时支持ISL和802.1q的新协议称为PVSTP +和RPVSTP +。 现在，它们已成为思科网络的行业标准。 <br>  STP过程的特征在于每个“端口成本”端口上的路径成本度量。 作为该指标的基础，使用了“端口速度”特性-端口速度（以mb / s为单位）。 因此，根据IEEE 1998标准，10 Mb / s的速度对应于端口100的成本，100 Mb / s的速度-19的成本，1 Gb / s的成本4和10 Gb / s的成本-2的成本。此标准未考虑100 Gb / s的速度和1 Tb / s，因此在2004年开发了一个新的IEEE，该端口成本的相对指标从200万到20不等。 <br><br><img src="https://habrastorage.org/webt/tm/ia/oo/tmiaoosw91_gsfeccaehnp6rbzu.jpeg"><br><br> 速度越高，成本越低，因此在计算路线时，选择成本较低的端口。 如果有两条线路-FastEthernet和GigabitEthernet，则最后一条通信线路的成本要低得多，因此，当选择到根交换机的路由时，GigabitEthern端口将具有优先权。 根交换机本身的端口成本为零。 在下一个视频中，我们将介绍选择路线的过程，您将了解很多内容。 现在，只记得定价原则是什么。 <br><br> 下一个主题是网桥ID发送者ID。 在STP中，它包含2个字节的交换机优先级信息和6个字节的MAC地址。 <br><br><img src="https://habrastorage.org/webt/lr/ei/3s/lrei3sclrlls8vbn-_kbgatovvq.jpeg"><br><br> 更高级的PVSTP由16位组成。 前12位称为扩展系统ID或扩展系统标识符。 它包含VLAN网络标识符-范围为0-4095的网络号和MAC地址。 另外4位用于指示网桥或交换机的优先级。 如果您回想起我们的魔术二进制表，将会看到如果所有4位均为0，那么我们将获得零优先级。 <br><br> 如果这些位的顺序为0001，则表示数字4096小于1，即优先级将为4096。根据16位组合，这些数字之一将用作优先级-从0到61440，随后每个比上一个多4096。 <br><br> 默认情况下，所有Cisco交换机的优先级为32768，但是您可以选择以下任何数字作为优先级。 使用扩展系统ID时，会将一个VLAN号添加到该号，即，如果您具有VLAN1，则网桥ID的优先级将为32768 + 1 = 32769。 <br><br><img src="https://habrastorage.org/webt/y_/hd/uf/y_hdufo0lyhy94jyx5l31jmg5gq.jpeg"><br><br> 我们也有一个MAC地址。 假设一台设备的网桥ID为32769：AAA：AAA：AAA，另一台为32769：BBB：BBB：BBB。 它们具有相同的数字优先级值，但是具有较低MAC地址的设备将具有一个优势，即AAA：AAA：AAA。 为了更好地了解网桥ID的工作原理，您可以再次观看此视频。 <br><br> 我们无法更改第二台设备的MAC地址，但是可以更改数字优先级值32769。如果您希望此设备具有更高的优先级，则可以将优先级值更改为0或小于32769的任何数字。如果我们使用0，网络号为VLAN1，那么我们得到优先级1的数值。在这种情况下，无论MAC地址的值如何，该设备都将具有比第一个设备更高的优先级。 <br><br> 如果您想从我们的网站下载此视频，可以使用优惠券享受50％的折扣，该优惠券的有效期至2017年11月22日。 提醒您，今天我们研究了一个非常重要的主题，因此建议您再次观看此视频教程。 <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/K-z4HPhKiTc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> 感谢您与我们在一起。 你喜欢我们的文章吗？ 想看更多有趣的资料吗？ 通过下订单或将其推荐给您的朋友来支持我们，为我们为您开发<b>的入门级​​服务器的独特模拟，为Habr用户</b>提供<b>30％的折扣：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于VPS（KVM）E5-2650 v4（6核）的全部真相10GB DDR4 240GB SSD 1Gbps从$ 20还是如何划分服务器？</a>  （RAID1和RAID10提供选件，最多24个内核和最大40GB DDR4）。 <br><br>  <b>戴尔R730xd便宜2倍？</b> 只有我们有<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2台Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100电视</a>在荷兰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">起价199美元</a> ！</b>  <b><b>戴尔R420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99起！</b></b> 阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何构建基础架构大厦的信息。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用价格为9000欧元的Dell R730xd E5-2650 v4服务器的上等课程？</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466405/">https://habr.com/ru/post/zh-CN466405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466383/index.html">Cryptocurrency Ocean：使用CoinMarketCap审查前50个项目</a></li>
<li><a href="../zh-CN466385/index.html">了解消息代理。 通过ActiveMQ和Kafka学习消息传递的机制。 第一章</a></li>
<li><a href="../zh-CN466397/index.html">我们对收银员进行重新编程，并在其上打印基努·里夫斯。 第2部分。PC软件</a></li>
<li><a href="../zh-CN466401/index.html">一点金融数学：计算通胀和利息</a></li>
<li><a href="../zh-CN466403/index.html">培训Cisco 200-125 CCNA v3.0。 第35天。动态DTP中继协议</a></li>
<li><a href="../zh-CN466407/index.html">大型Glassdoor统计公司的招聘文化</a></li>
<li><a href="../zh-CN466409/index.html">培训Cisco 200-125 CCNA v3.0。 第37天。STP：选择根网桥，PortFast和BPDU保护功能。 第一部分</a></li>
<li><a href="../zh-CN466413/index.html">Bitrix和1C的站点交换：解决主要问题</a></li>
<li><a href="../zh-CN466417/index.html">货运-通过常规邮件发送的网络威胁</a></li>
<li><a href="../zh-CN466419/index.html">为什么我们在Sitefinity工作</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>