<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦍 😣 👿 Cara lulus uji cyber di Checkpoint 💔 😥 👨🏽‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya, saya Nikita Kurtin , kurator Sekolah Tinggi IT Israel dan Peretas Keamanan 

 Checkpoint , perusahaan keamanan informasi Israel terkemu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara lulus uji cyber di Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Halo semuanya, saya <b>Nikita Kurtin</b> , kurator Sekolah Tinggi IT Israel dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><b>Peretas</b></a> Keamanan <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Checkpoint</a></b> , perusahaan keamanan informasi Israel terkemuka, menerbitkan serangkaian tes dunia maya musim panas ini. <br><br>  Tugas dibagi menjadi enam kategori: <br><br>  • Logika <br>  • Web <br>  • Pemrograman <br>  • Jaringan <br>  • Membalik <br>  • Kejutan <br><br>  Dua tugas untuk setiap arah.  Dalam posting ini saya akan memberi tahu Anda bagaimana saya hanya melalui empat tes, dalam tiga tes berikutnya: <br><br>  <b>Pos pemeriksaan</b> telah berhasil mendapatkan rasa hormat dan minat pada bagian saya, jadi saya memutuskan untuk menerima tantangan ini.  Namun, karena pekerjaan, saya mampu mengambil hanya 8 dari 12 tugas (dari empat kategori berbeda).  Dan saya berhasil memecahkan 7 dari mereka. <br><br>  Tantangan resmi berakhir pada akhir September 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="gambar"><br><br>  Jadi sekarang, dengan hati nurani yang jernih, saya dapat memberi tahu Anda selangkah demi selangkah tentang bagaimana saya memecahkan masalah-masalah berikut: <br><br>  • Tantangan logis "PNG ++" <br>  • Tantangan Web "Robot kembali" <br>  • Tantangan Web "Galeri Diego" <br>  • Tugas pemrograman "Langkah hati-hati" <br>  • Tugas pemrograman "Puzzle" <br>  • Tantangan Jaringan "Ping Pong" <br>  • Tantangan Jaringan "Protokol" <br><br>  <u><b>Tantangan: PNG ++</b></u> <u><br></u> <br>  Deskripsi: <br><br>  Gambar (tautan ke file PNG terenkripsi) <i>ini disandikan menggunakan cipher khusus.</i> <i><br><br></i>  <i>Kami berhasil membaca sebagian besar kode ini di sini (tautan ke kode python).</i> <i><br></i>  <i>Sayangnya, seseorang dengan lambat menumpahkan kopi di seluruh key_transformator.py.</i> <i><br><a name="habracut"></a></i>  <i>Bisakah Anda membantu kami mendekripsi gambar ini?</i> <br><br>  Kode python: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="gambar"><br><br>  Logika enkripsi adalah sebagai berikut: <br><br>  1. Atur panjang kunci (ukuran tombol) ke 4 byte <br><br>  2. Baca byte dari file "flag.png" dalam variabel "img" <br><br>  3. Tambahkan padding ke file, ke kelipatan terdekat pertama dari empat.  Padding sama dengan jumlah byte yang hilang.  Misalnya, jika panjang file adalah 29 byte (3 hilang), tambahkan tiga byte dengan nilai desimal 3 (ASCII 0x03).  Atau, dengan kata lain, padding byte tidak boleh kosong (ASCII 0x00), karena nilai desimalnya adalah nol, padding yang tidak menyiratkan. <br><br>  4. Atur kunci awal dengan empat huruf besar acak ([AZ]). <br><br>  5. Lakukan hal yang sama dengan semua byte dalam file, mengenkripsi rantai empat byte sekaligus <br><br>  a.  Setiap byte dalam file tersebut bertengkar dengan byte dari kunci <br>  b.  Kunci terus dikonversi ke kunci lain, key_transformator.transform (kunci) bertanggung jawab untuk ini <br>  c.  Byte terenkripsi ditambahkan ke enc_data <br><br>  6. Masukkan enc_data (byte terenkripsi) di encrypted.png <br><br>  Untuk memulai, saya memeriksa header format PNG dan menemukan bahwa delapan byte pertama adalah sebagai berikut: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  Saya mengambil delapan byte pertama dari file terenkripsi dan memutarnya dengan delapan byte ini: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="gambar"><br><br>  Kunci dari blok pertama ternyata seperti ini: <br>  [85, 80, 82, 81] <br><br>  Dan blok kedua - seperti ini: <br>  [86, 81, 83, 82] <br><br>  Karena setiap kunci selanjutnya dihasilkan secara dinamis menggunakan kunci sebelumnya (key = key_transformator.transform (key), saya memahami algoritme: tambahkan satu ke setiap byte pada kunci sebelumnya: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  Dan kemudian saya menyadari bahwa nama tantangan itu menyembunyikan petunjuk yang sakit-sakitan. <br><br>  Saya menulis dua "fungsi pembantu": <br><br>  • "nextKey", yang mengembalikan kunci berikutnya berdasarkan yang terakhir <br>  • "nextChar", yang mengembalikan huruf berikutnya, dan dalam kebanyakan kasus hanya bertambah satu jika jatuh dalam batas byte (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="gambar"><br><br>  Saya mengkonversi 4 byte asli [85, 80 82, 81] menjadi huruf: "UPRQ" dan menjalankan algoritma kembali <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="gambar"><br><br>  Bendera ditentukan dalam file yang didekripsi: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="gambar"><br><br>  <u><b>Tantangan: Kembalinya Robot</b></u> <u><br></u> <br><br>  Deskripsi: <br><br>  <i>Robot itu keren, tapi percayalah: akses mereka harus dibatasi!</i>  Lihat itu (tautan) <br><br>  Setelah mengikuti tautan, Anda melihat halaman tertentu yang dikhususkan untuk robot.  Pada dasarnya, semuanya menunjukkan bahwa Anda harus memeriksa keberadaan file "robots.txt". <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="gambar"><br><br>  Dengan menambahkan ./robots.txt ke url kita mendapatkan yang berikut: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="gambar"><br><br>  Saya memeriksa ./secret_login.html dan menemukan halaman pendaftaran <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="gambar"><br><br>  Selanjutnya, saya memeriksa kode sumber formulir untuk menemukan konfirmasi kata sandi dan melihat Javascript ini: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="gambar"><br><br>  Tampaknya ketika nilai dikonfirmasi, dikirim ke fungsi otorisasi, yang menerjemahkan nilai yang diteruskan menggunakan fungsi btoa (fungsi decoding base64 dalam Javascript) dan kemudian membandingkannya dengan string: "SzMzcFQjM1IwYjB0JDB1dA ==". <br><br>  Saya menerjemahkan kode ini <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="gambar"><br><br>  Saya memasukkan nilai yang dihasilkan ke string kata sandi.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="gambar"><br><br><br>  <b><u>Tantangan: Diego Gallery</u></b> <b><br></b> <br>  Deskripsi: <br><br>  <i>Baru-baru ini saya mulai mengembangkan platform untuk mengelola foto-foto kucing saya dan mengamankan flag.txt saya.</i>  <i>Silakan periksa sistem saya (tautan ke formulir pendaftaran).</i> <i><br><br></i>  <i>Untuk menghindari jambs dalam sistem keamanan, seperti kemampuan untuk menanamkan kode SQL, saya membuat skema sendiri.</i> <i><br><br></i>  <i>Deskripsi singkatnya tersedia di sini (tautan ke diagram)</i> <br><br>  Formulir Pendaftaran: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="gambar"><br><br>  Sirkuit yang telah ditetapkan: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="gambar"><br><br>  Setelah saya menetapkan nama pengguna dan kata sandi percobaan, saya mendapat akses ke galeri umum kucing "Diego". <br><br>  Karena saya terdaftar sebagai pengguna biasa, saya pikir mungkin saya perlu menemukan cara untuk meningkatkan hak istimewa PE (Privilege Escalation).  Melihat melalui skema untuk pengguna terdaftar, saya melihat bahwa perbedaan antara pengguna biasa dan administrator ada di bagian ketiga skema, dipisahkan oleh tiga garis. <br><br>  Setelah memperkirakan bahwa jika nilai pertama (nama pengguna) merujuk ke bagian pertama, dan yang kedua (kata sandi) merujuk ke bagian kedua, maka peran tersebut ditetapkan oleh sistem segera setelah pengguna dengan hak yang sekarang masuk. <br><br>  Sebagai contoh: <br><br>  MULAI ||| Nilai pertama ||| Nilai kedua ||| pengguna (Ditambahkan oleh layanan web) ||| END <br><br>  Payload saya adalah sebagai berikut: <br><br>  • Nilai pertama: “niki ||| niki ||| admin ||| END \ nSTART ||| lainnya“ <br>  • Nilai kedua: "lainnya" <br><br>  Ini mungkin menghasilkan baris log berikut: <br><br>  MULAI ||| niki ||| niki ||| admin ||| END <br>  MULAI ||| lainnya ||| lainnya ||| pengguna ||| END <br><br>  Setelah itu, saya bisa masuk sebagai administrator dan mendapatkan hak penuh: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="gambar"><br><br>  Menekan tombol hanya mengaktifkan peringatan bahwa bendera aman. <br>  Namun, di dalam URL Anda dapat membaca: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Yang secara eksplisit menyinggung <i>LFI (Inklusi File Lokal) melalui URL</i> <br><br>  Saya mencoba: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  Dan bendera itu milik saya. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="gambar"><br><br>  <b><u>Tantangan: Langkah-Langkah Hati-Hati</u></b> <b><br></b> <br>  Deskripsi: <br><br>  <i>Ini (tautan file) adalah sekelompok arsip yang kami temukan.</i>  <i>Kami yakin bendera rahasia disembunyikan di suatu tempat di dalamnya.</i> <i><br></i>  <i>Kami benar-benar yakin bahwa data yang kami cari tersembunyi di bagian komentar dari setiap file.</i> <i><br></i>  <i>Bisakah Anda dengan hati-hati pergi di antara file dan menemukan bendera?</i> <i><br></i>  <i>Semoga beruntung</i> <br><br>  Setelah mengekstraksi file, Anda mendapatkan direktori bernama "arsip" dengan dua ribu file di dalamnya, berjudul "unzipme. [Nomor]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="gambar"><br><br>  Saya menggunakan program binwalk untuk memeriksa file pertama.  Dan inilah yang diberikan program kepada saya: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="gambar"><br><br>  Ya, jadi di bagian komentar kami memiliki huruf dan angka.  Petunjuk lagi? <br><br>  Pada awalnya saya berpikir tentang apakah saya harus menghubungkan surat-surat dengan indeks yang diberikan dari file zip ini, dan periksa file berikutnya sudah dengan indeks 245. <br><br>  Tapi di sini muncul kejutan: file kedua tidak dalam zip, tetapi dalam format rar. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="gambar"><br><br>  Oleh karena itu, saya harus "membuat" itu untuk mendapatkan komentar: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="gambar"><br><br>  Logika saya adalah menjalankan file melalui binwalk, dan jika saya menemukan RAR, buka paketnya untuk mendapatkan komentar.  Jika tidak, langsung lihat bagian komentar untuk memahami tindakan lebih lanjut. <br><br>  Tebakan pertama saya: jumlahnya adalah indeks file (masing-masing diberi nomor dari 0 hingga 1999).  Namun, saya menemukan bahwa beberapa angka negatif, yang berarti mereka tidak bisa menjadi indeks. <br><br>  Tebakan kedua: jumlahnya adalah lompatan, yang mungkin negatif.  Untuk setiap nomor, saya perlu lompatan ke file berikutnya.  Saya tahu bahwa jika kode saya terus-menerus melompat ke file terhitung berikutnya, ini dapat membuat jebakan kecil dalam bentuk siklus dan kode saya akan terjebak dalam loop tanpa akhir.  Jadi saya menulis kode python dengan batas akun.  Dan setelah beberapa tes, saya menemukan bahwa angka 120 akan cukup: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="gambar"><br><br>  Dan bendera itu milik saya: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="gambar"><br><br>  Tiga lainnya saya jelaskan di posting berikutnya, baca, coba, saya akan senang dengan komentar Anda </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id429112/">https://habr.com/ru/post/id429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id429096/index.html">Barang antik: ZX Spectrum, program kaset dan definisi tinggi</a></li>
<li><a href="../id429102/index.html">Penjualan Kendaraan Listrik di Kanada</a></li>
<li><a href="../id429106/index.html">CIS untuk infrastruktur</a></li>
<li><a href="../id429108/index.html">Google: penghapusan tautan "bajakan" dari penerbitan tidak akan menyelesaikan masalah konten ilegal</a></li>
<li><a href="../id429110/index.html">Kiat-kiat CSS yang tidak mungkin Anda temukan di tutorial</a></li>
<li><a href="../id429114/index.html">Cara lulus uji cyber di Pos Pemeriksaan Bagian 2</a></li>
<li><a href="../id429116/index.html">Buat gambar responsif</a></li>
<li><a href="../id429118/index.html">Analis Bandara</a></li>
<li><a href="../id429120/index.html">Java Challengers # 3: Polimorfisme dan Warisan</a></li>
<li><a href="../id429122/index.html">NetApp dalam waktu dekat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>