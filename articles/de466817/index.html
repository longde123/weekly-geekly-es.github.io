<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèø üëµ üíë Varonis entdeckte ein Crypto-Mining-Virus: unsere Untersuchung üë®üèº‚Äçüöí üéæ üßñüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unsere Sicherheitsuntersuchungseinheit hat k√ºrzlich einen Fall eines fast vollst√§ndigen Crypto-Mining-Virennetzwerks in einem der mittelst√§ndischen Un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Varonis entdeckte ein Crypto-Mining-Virus: unsere Untersuchung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/466817/"><img src="https://habrastorage.org/webt/b3/fo/_5/b3fo_5ib64rlap_izdap4paolls.jpeg"><br><br>  Unsere Sicherheitsuntersuchungseinheit hat k√ºrzlich einen Fall eines fast vollst√§ndigen Crypto-Mining-Virennetzwerks in einem der mittelst√§ndischen Unternehmen durchgef√ºhrt.  Analyse <br>  Gesammelte Malware-Beispiele zeigten, dass eine neue √Ñnderung gefunden wurde <br>  Solche Viren, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Norman genannt</a> , verwenden verschiedene Methoden, um ihre Anwesenheit zu verbergen.  Dar√ºber hinaus wurde eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">interaktive Web-Shell</a> entdeckt, die sich m√∂glicherweise auf Bergbaubetreiber bezieht. <br><a name="habracut"></a><br><h2>  <font color="#D21927">Studien√ºbersicht</font> </h2><br><ul><li>  Varonis entdeckte eine gro√ü angelegte Infektion mit Kryptominern: Fast alle Server und Workstations im Unternehmen waren mit solcher Software infiziert </li><li>  Seit der ersten Infektion vor mehr als einem Jahr hat die Anzahl der Modifikationen und infizierten Ger√§te stetig zugenommen </li><li>  Der neu entdeckte Crypto Miner-Typ Monero (Norman) verwendet verschiedene Methoden, um ihn vor der Analyse durch Sicherheitssoftware zu verbergen, um eine Erkennung zu vermeiden </li><li>  Die meisten Malware-Varianten verwendeten DuckDNS (einen kostenlosen dynamischen DNS-Dienst), um eine Verbindung zum Kontrollzentrum (C &amp; C-Server) herzustellen, Konfigurationsparameter abzurufen oder neue Daten zu senden </li><li>  Norman - Hochleistungs-Open-Source-Miner-basierter Monero Cryptocurrency Miner - XMRig </li><li>  Wir haben keine schl√ºssigen Beweise f√ºr die Verbindung von Crypto Miner mit einer interaktiven PHP-Shell.  Es gibt jedoch gute Gr√ºnde zu der Annahme, dass ihre Quelle derselbe Angreifer ist.  Die Forscher sammeln zus√§tzliche Beweise f√ºr das Vorhandensein oder Fehlen einer solchen Beziehung. </li><li>  In diesem Artikel finden Sie Varonis-Empfehlungen zum Schutz vor Remote-Web-Shells und Crypto Miner. </li></ul><br><h2>  <font color="#D21927">Untersuchung</font> </h2><br>  Die Untersuchung begann w√§hrend des n√§chsten Pilotprojekts der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Plattform</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Varonis Cybersecurity</a> (Varonis Data Security Platform), mit der Sie schnell mehrere verd√§chtige anomale Ereignisse auf Netzwerkebene bei Internetanforderungen (√ºber Webproxys) identifizieren konnten, die mit abnormalen Aktionen im Dateisystem verbunden waren. <br>  Der Kunde gab sofort an, dass die von unserer Plattform identifizierten Ger√§te <br>  geh√∂rte denselben Benutzern, die k√ºrzlich Anwendungsabst√ºrze und Netzwerkverlangsamungen gemeldet haben. <br><br>  Unser Team untersuchte die Umgebung des Kunden manuell und wechselte gem√§√ü den von der Varonis-Plattform generierten Warnungen von einer infizierten Station zur anderen.  Das Incident-Response-Team entwickelte au√üerdem eine spezielle Regel im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DatAlert-Modul</a> , um Computer zu erkennen, die aktiv abgebaut wurden, wodurch die Bedrohung schnell beseitigt werden konnte.  Proben der gesammelten Malware wurden an die Teams der Forensik- und Entwicklungsabteilungen gesendet, die sagten, dass zus√§tzliche Untersuchungen an den Proben erforderlich seien. <br>  Infizierte Sites wurden mithilfe von <b>DuckDNS-Aufrufen</b> (Dynamic DNS) entdeckt, mit denen Benutzer ihre eigenen Domain-Namen erstellen und diese schnell wechselnden IP-Adressen <b>zuordnen</b> k√∂nnen.  Wie oben erw√§hnt, wandte sich der Hauptteil der Malware als Teil des Vorfalls an DuckDNS, um eine Verbindung zum Control Center (C &amp; C) herzustellen, der andere, um Konfigurationsparameter abzurufen oder neue Daten zu senden. <br><br>  Fast alle Server und Computer waren mit Malware infiziert.  Meistens angewendet <br>  g√§ngige Crypto Miner-Optionen.  Andere Malware umfasste Tools zum Speichern von Passw√∂rtern, PHP-Shells und eine Reihe von Tools, die seit mehreren Jahren funktionieren. <br><br>  Wir haben dem Kunden die Ergebnisse zur Verf√ºgung gestellt, die Malware aus seiner Umgebung entfernt und weitere Infektionen gestoppt. <br><br>  Unter allen entdeckten Proben von Kryptominern stand eine auseinander.  Wir haben ihn <strong>Norman genannt</strong> . <br><br><h2>  <font color="#D21927">Triff mich!</font>  <font color="#D21927">Norman</font>  <font color="#D21927">Cryptominer</font> </h2><br>  Norman ist ein leistungsstarker Monero Cryptocurrency Miner, der auf XMRig-Code basiert.  Im Gegensatz zu anderen gefundenen Miner-Proben verwendet Norman Methoden, um sie vor der Analyse mit Sicherheitssoftware zu verbergen, um eine Erkennung zu vermeiden und eine weitere Verteilung zu verhindern. <br><br>  Auf den ersten Blick ist diese Malware ein normaler Bergmann, der sich unter dem Namen svchost.exe versteckt.  Die Studie zeigte jedoch, dass sie interessantere Methoden verwendet, um sich vor der Erkennung und Aufrechterhaltung von Arbeit zu verstecken. <br><br>  Der Bereitstellungsprozess dieser Malware kann in drei Phasen unterteilt werden: <br><br><ul><li>  Erf√ºllung; </li><li>  Umsetzung; </li><li>  Bergbau. </li></ul><br><h2>  <font color="#D21927">Schritt-f√ºr-Schritt-Analyse</font> </h2><br><h3>  Stufe 1. Ausf√ºhrung </h3><br>  Der erste Schritt beginnt mit der ausf√ºhrbaren Datei svchost.exe. <br><br>  Sch√§dliche Software wird mit NSIS (Nullsoft Scriptable Install System) kompiliert, was ungew√∂hnlich ist.  NSIS ist ein Open Source-System zum Erstellen von Windows-Installationsprogrammen.  Wie SFX erstellt dieses System ein Dateiarchiv und eine Skriptdatei, die w√§hrend des Installationsprogramms ausgef√ºhrt werden.  Die Skriptdatei teilt dem Programm mit, welche Dateien ausgef√ºhrt werden sollen, und kann mit anderen Dateien im Archiv interagieren. <br><br>  <i><strong>Hinweis:</strong> Um die NSIS-Skriptdatei aus der ausf√ºhrbaren Datei abzurufen, m√ºssen Sie 7zip Version 9.38 verwenden, da diese Funktion in sp√§teren Versionen nicht implementiert ist.</i> <br><br>  Von NSIS archivierte Malware enth√§lt die folgenden Dateien: <br><br><ul><li>  CallAnsiPlugin.dll, CLR.dll - NSIS-Module zum Aufrufen von .NET DLL-Funktionen; </li><li>  5zmjbxUIOVQ58qPR.dll - die Hauptnutzlast-DLL; </li><li>  4jy4sobf.acz, es1qdxg2.5pk, OIM1iVhZ.txt - Nutzdaten; </li><li>  Retreat.mp3, Cropped_controller_config_controller_i_lb.png sind einfach Dateien, die in keiner Weise mit weiteren b√∂swilligen Aktivit√§ten verbunden sind. </li></ul><br>  Der Befehl aus der NSIS-Skriptdatei, mit der die Nutzdaten ausgef√ºhrt werden, ist unten angegeben. <br><br><img src="https://habrastorage.org/webt/dc/ch/st/dcchst5kvffhufreb1smhmw3lzs.png"><br><br>  Sch√§dliche Software wird ausgef√ºhrt, indem die Funktion 5zmjbxUIOVQ58qPR.dll aufgerufen wird, die andere Dateien als Parameter verwendet. <br><br><h3>  Stufe 2. Implementierung </h3><br>  Die Datei 5zmjbxUIOVQ58qPR.dll ist die Hauptnutzlast, die sich aus dem obigen NSIS-Skript ergibt.  Eine schnelle Analyse der Metadaten ergab, dass die DLL urspr√ºnglich Norman.dll hie√ü, weshalb wir sie so nannten. <br><br>  In .NET entwickelte DLL-Datei, die durch dreifache Verschleierung vor Reverse Engineering gesch√ºtzt ist <br>  unter Verwendung des bekannten Handelsprodukts Agile .NET Obfuscator. <br><br>  Im Verlauf der Implementierung sind viele Vorg√§nge zur Einf√ºhrung der Selbsteinf√ºhrung in Ihren eigenen Prozess sowie in andere Prozesse involviert.  Abh√§ngig von der Bittiefe des Betriebssystems wird die Malware <br>  W√§hlen Sie verschiedene Pfade zu Systemordnern und starten Sie verschiedene Prozesse. <br><br><img src="https://habrastorage.org/webt/jp/sy/zn/jpsyzngdt-zv5qoswztui4odjrs.png"><br><br>  Basierend auf dem Pfad zum Systemordner w√§hlt die Malware verschiedene Prozesse aus, die gestartet werden sollen. <br><br><img src="https://habrastorage.org/webt/wp/q9/jc/wpq9jcqxrvwvbfkgh9-wca2qmsi.png"><br><br>  Die bereitgestellte Nutzlast hat zwei Hauptfunktionen: Ausf√ºhren eines Crypto Miner und Verhindern der Erkennung. <br><br><h4>  Wenn das Betriebssystem 64-Bit ist </h4><br>  Beim Ausf√ºhren der Quelldatei svchosts.exe (NSIS-Datei) wird ein neuer eigener Prozess erstellt und die Nutzdaten in diese Datei eingef√ºgt (1).  Kurz darauf startet er notepad.exe oder explorer.exe und injiziert einen Cryptominer hinein (2). <br><br><img src="https://habrastorage.org/webt/3n/rc/bt/3nrcbtfzkotbmjp_zqdvrzt9r_0.jpeg"><br><br>  Danach wird die urspr√ºngliche Datei svchost.exe heruntergefahren, und die neue Datei svchost.exe wird als Programm verwendet, das den Betrieb des Miner-Prozesses √ºberwacht. <br><br><img src="https://habrastorage.org/webt/ng/ze/bq/ngzebqxper1bhxzwrqxvygimlac.png"><br><br><h4>  Wenn das Betriebssystem 32-Bit ist </h4><br>  W√§hrend der Ausf√ºhrung der urspr√ºnglichen Datei svchosts.exe (NSIS-Datei) dupliziert sie ihren eigenen Prozess und f√ºgt wie in der 64-Bit-Version eine Nutzlast ein. <br><br>  In diesem Fall injiziert die Malware die Nutzdaten in den Benutzerprozess explorer.exe.  Schon jetzt startet b√∂sartiger Code einen neuen Prozess (wuapp.exe oder vchost.exe) und injiziert den Miner hinein. <br><br><img src="https://habrastorage.org/webt/kb/c3/2q/kbc32qdqrmcwqzciy5vhesry224.png"><br><br>  Sch√§dliche Software verbirgt die Tatsache der Implementierung in explorer.exe und √ºberschreibt zuvor implementierten Code durch wuapp.exe und leere Werte. <br><br><img src="https://habrastorage.org/webt/dz/uz/ct/dzuzct_donm4jroc54uj4bqzy2i.png"><br><br>  Wie bei der Ausf√ºhrung in einer 64-Bit-Umgebung wird der urspr√ºngliche Prozess svchost.exe beendet, und der zweite wird verwendet, um sch√§dlichen Code erneut in explorer.exe einzuf√ºgen, wenn der Prozess vom Benutzer beendet wird. <br><br>  Am Ende des Ausf√ºhrungsalgorithmus injiziert Malware den Cryptominer immer in seinen legitimen Prozess. <br><br>  Es soll die Erkennung verhindern, indem der Miner heruntergefahren wird, wenn der Benutzer den Task-Manager startet. <br><br>  Bitte beachten Sie, dass nach dem Starten des Task-Managers der Prozess wuapp.exe endet. <br><br><img src="https://habrastorage.org/webt/nm/dw/y0/nmdwy02bz2qho6dgotsq_wprv6a.gif"><br><br>  Nach dem Schlie√üen des Task-Managers startet die Malware den Prozess wuapp.exe immer wieder <br>  f√ºhrt einen Bergmann ein. <br><br><h3>  Stufe 3. Bergmann </h3><br>  Betrachten Sie den oben genannten XMRig Miner. <br><br>  Sch√§dliche Software injiziert die getarnte UPX-Version des Miners in notepad, exe, explorer.exe, <br>  svchost.exe oder wuapp.exe, abh√§ngig von der Bittiefe des Betriebssystems und der Stufe des Ausf√ºhrungsalgorithmus. <br><br>  Der PE-Header im Miner wurde entfernt, und im folgenden Screenshot sehen wir, dass er mit UPX maskiert ist. <br><br><img src="https://habrastorage.org/webt/u0/es/8g/u0es8g-pm5lpx7bov_hwarxv-ws.png"><br><br>  Nachdem wir einen Dump erstellt und die ausf√ºhrbare Datei neu erstellt hatten, konnten wir sie ausf√ºhren: <br><br><img src="https://habrastorage.org/webt/il/nl/c-/ilnlc-lauzxcgsjrkg0pggo1wik.png"><br><br>  Es ist zu beachten, dass der Zugriff auf die Ziel-XMR-Site verboten ist, wodurch dieser Miner effektiv neutralisiert wird. <br><br>  <strong>Miner-Konfiguration:</strong> <br><br><pre><code class="plaintext hljs">"url": "pool.minexmr.com:5555","user": "49WvfokdnuK6ojQePe6x2M3UCD59v3BQiBszkuTGE7wmNJuyAvHM9ojedgxMwNx9tZA33P84EeMLte7t6qZhxNHqHyfq9xA","pass":"x"</code> </pre> <br><h2>  <font color="#D21927">Geheimnisvolle PHP-Shell, die Daten an C &amp; C √ºbertr√§gt</font> </h2><br>  Im Verlauf dieser Untersuchung entdeckten unsere Forensiker eine XSL-Datei, die ihre Aufmerksamkeit auf sich zog.  Nach eingehender Analyse der Probe wurde eine neue PHP-Shell entdeckt, die st√§ndig mit dem Kontrollzentrum (C &amp; C-Server) verbunden ist. <br><br>  Auf mehreren Servern in der Kundenumgebung wurde eine XSL-Datei gefunden, die von der bekannten ausf√ºhrbaren Windows-Datei (mscorsv.exe) aus einem Ordner im Verzeichnis sysWOW64 gestartet wurde. <br><br>  Der Malware-Ordner hie√ü AutoRecover und enthielt <b>mehrere Dateien:</b> <br><br><ul><li>  XSL-Datei: xml.XSL </li><li>  neun DLL-Dateien </li></ul><br>  <b>Ausf√ºhrbare Dateien:</b> <br><ul><li>  Msscorsv.exe </li><li>  Wmiprvse.exe </li></ul><br><img src="https://habrastorage.org/webt/dr/bc/nv/drbcnvij4atirz8jn_tncb6ndkc.png"><br><br><h2>  <font color="#D21927">XSL-Datei</font> </h2><br>  XSL-Dateien sind Stylesheets, die den in CSS verwendeten Tabellen √§hneln und beschreiben, wie ein XML-Dokument angezeigt wird. <br><br>  Mit Notepad haben wir festgestellt, dass es sich eigentlich nicht um eine XSL-Datei handelt, sondern um den verschleierten PHP-Code von Zend Guard.  Diese merkw√ºrdige Tatsache deutete darauf hin <br>  Malware-Nutzdaten basierend auf ihrem Ausf√ºhrungsalgorithmus. <br><br><img src="https://habrastorage.org/webt/b9/gx/z5/b9gxz56io5zcmlgbtephvyuxyn8.png"><br><br><h2>  <font color="#D21927">Neun DLLs</font> </h2><br>  Eine erste Analyse der XSL-Datei f√ºhrte zu dem Schluss, dass es so viele gibt <br>  DLLs machen Sinn.  Der Hauptordner enth√§lt eine DLL namens php.dll und drei weitere Bibliotheken, die sich auf SSL und MySQL beziehen.  In den Unterordnern fanden Experten vier PHP-Bibliotheken und eine Zend Guard-Bibliothek.  Alle von ihnen sind legitim und werden aus dem PHP-Installationspaket oder als externe DLLs bezogen. <br><br>  Zu diesem Zeitpunkt wurde angenommen, dass die Malware auf PHP basiert und von Zend Guard verschleiert wurde. <br><br><h2>  <font color="#D21927">Ausf√ºhrbare Dateien</font> </h2><br>  In diesem Ordner befanden sich auch zwei ausf√ºhrbare Dateien: Mscorsv.exe und Wmiprvse.exe. <br><br>  Nach der Analyse der Datei mscorsv.exe stellten wir fest, dass sie nicht von Microsoft signiert war, obwohl der Parameter ProductName auf ‚ÄûMicrosoft.  Net Framework. " <br>  Anfangs schien es nur seltsam, aber die Analyse von Wmiprvse.exe erm√∂glichte es, die Situation besser zu verstehen. <br><br>  Die Datei Wmiprvse.exe wurde ebenfalls nicht signiert, enthielt jedoch das Copyright-Symbol der PHP-Gruppe und das PHP-Symbol.  W√§hrend eines fl√ºchtigen Scans wurden Befehle aus der PHP-Hilfe in ihren Zeilen gefunden.  Bei der Ausf√ºhrung mit dem Schalter -version wurde festgestellt, dass es sich um eine ausf√ºhrbare Datei handelt, die zum Ausf√ºhren von Zend Guard entwickelt wurde. <br><br><img src="https://habrastorage.org/webt/9c/xw/ju/9cxwjuu7xoqggrzco-tgun7kpsw.png"><br><br>  Wenn mscorsv.exe auf dieselbe Weise gestartet wurde, wurden dieselben Daten angezeigt.  Wir haben die Bin√§rdaten dieser beiden Dateien verglichen und festgestellt, dass sie mit Ausnahme der Metadaten identisch sind <br>  Copyright und Firmenname / Produktname. <br><br><img src="https://habrastorage.org/webt/mp/7y/qk/mp7yqkfz6uqusknzixm5vrwun9e.png"><br><br>  Auf dieser Grundlage wurde der Schluss gezogen, dass die XSL-Datei PHP-Code enth√§lt, der mit der ausf√ºhrbaren Datei Zend Guard ausgef√ºhrt wird, die unter dem Namen mscorsv.exe versteckt ist. <br><br><h2>  <font color="#D21927">Analysieren einer XSL-Datei</font> </h2><br>  Mithilfe der Suche im Internet erhielten Experten schnell ein Tool zum Deobfuscieren von Zend Guard und stellten die urspr√ºngliche xml.XSL-Datei wieder her: <br><br><img src="https://habrastorage.org/webt/5a/ek/nj/5aeknjt7mwgxx96m3t5twger2h0.png"><br><br>  Es stellte sich heraus, dass die Malware selbst eine PHP-Shell ist, die st√§ndig mit dem Kontrollzentrum (C &amp; C-Server) verbunden ist. <br><br>  Die Befehle und Ausgaben, die gesendet und empfangen werden, sind verschl√ºsselt.  Seit wir den Quellcode erhalten haben, hatten wir sowohl einen Verschl√ºsselungsschl√ºssel als auch Befehle. <br><br>  Diese Malware enth√§lt die folgenden integrierten Funktionen: <br><br><ul><li>  Eval - Wird h√§ufig verwendet, um vorhandene Variablen im Code zu √§ndern </li><li>  Lokaler Dateidatensatz </li><li>  Datenbankfunktionen </li><li>  PSEXEC-Funktionen </li><li>  Versteckte Ausf√ºhrung </li><li>  Prozess- und Service-Mapping </li></ul><br>  Die folgende Variable legt nahe, dass Malware mehrere Versionen hat. <br><br><img src="https://habrastorage.org/webt/al/id/bs/alidbstswyy1huff1onuh5ma7bg.png"><br><br>  Beim Sammeln von Proben wurden folgende Versionen entdeckt: <br><br><ul><li>  0,5f </li><li>  0,4p </li><li>  0,4o </li></ul><br>  Die einzige Funktion, um das st√§ndige Vorhandensein von Malware im System sicherzustellen, besteht darin, dass bei der Ausf√ºhrung ein Dienst erstellt wird, der sich selbst und seinen Namen ausf√ºhrt <br>  variiert von Version zu Version. <br><br>  Spezialisten haben versucht, √§hnliche Beispiele im Internet zu finden, und Malware gefunden. <br>  Dies war ihrer Meinung nach die vorherige Version der vorhandenen Stichprobe.  Der Inhalt des Ordners war √§hnlich, aber die XSL-Datei war unterschiedlich und es wurde eine andere Versionsnummer angegeben. <br><br><h2>  <font color="#D21927">Parle Wu Malvare?</font> </h2><br>  M√∂glicherweise ist Frankreich oder ein anderes franz√∂sischsprachiges Land der Geburtsort dieser Malware: Die SFX-Datei enthielt Kommentare in franz√∂sischer Sprache, die darauf hinweisen, dass der Autor die franz√∂sische Version von WinRAR verwendet hat, um sie zu erstellen. <br><br><img src="https://habrastorage.org/webt/xq/e2/cd/xqe2cddtfruhzwvz3mro0iqglpm.png"><br><br>  Dar√ºber hinaus wurden einige Variablen und Funktionen im Code auch auf Franz√∂sisch benannt. <br><br><img src="https://habrastorage.org/webt/vx/95/9d/vx959dqslson6ybxzoawqzzyvog.png"><br><br><img src="https://habrastorage.org/webt/sk/cv/rd/skcvrd_tj6ntrgghhjzl1fhpjy8.png"><br><br><h2>  <font color="#D21927">√úberwachung der Ausf√ºhrung und Warten auf neue Teams</font> </h2><br>  Spezialisten haben den Malware-Code ge√§ndert und den bereits ge√§nderten sicher gestartet <br>  Version, um Informationen √ºber die Teams zu sammeln, die es erhalten hat. <br><br><img src="https://habrastorage.org/webt/xv/tf/uf/xvtfufticasuciea8sfzqyrpppc.png"><br><br>  Am Ende der ersten Kommunikationssitzung stellten Spezialisten fest, dass die Malware einen mit Base64 codierten Befehl als Argument f√ºr den EVAL64-Startschl√ºssel erhielt. <br>  Dieser Befehl wird dekodiert und ausgef√ºhrt.  Es √§ndert mehrere interne Variablen (die Gr√∂√üe der Lese- und Schreibpuffer), wonach die Malware in den Arbeitszyklus des Wartens auf Befehle eintritt. <br><br>  Zu diesem Zeitpunkt sind keine neuen Teams eingegangen. <br><br><h2>  <font color="#D21927">Interaktive PHP-Shell und Crypto Miner: Sind sie verwandt?</font> </h2><br>  Varonis-Experten sind sich nicht sicher, ob Norman mit der PHP-Shell verbunden ist, da es wichtige Argumente f√ºr und gegen diese Annahme gibt: <br><br><h3>  Warum k√∂nnen sie verwandt sein? </h3><br><ul><li>  Keines der Beispiele f√ºr b√∂sartige Crypto-Mining-Software konnte unabh√§ngig auf andere Systeme verteilt werden, obwohl sie auf verschiedenen Ger√§ten in verschiedenen Netzwerksegmenten gefunden wurden.  Es ist m√∂glich, dass der Angreifer jeden Knoten separat infiziert (m√∂glicherweise unter Verwendung des gleichen Angriffsvektors wie bei der Infektion des ‚ÄûNull-Patienten‚Äú), obwohl es effizienter w√§re, eine PHP-Shell zu verwenden, um sich √ºber das Netzwerk auszubreiten, das das Ziel des Angriffs war. </li><li>  Zielgerichtete automatisierte Kampagnen in gro√üem Ma√üstab, die gegen eine bestimmte Organisation gerichtet sind, hinterlassen bei ihrer Implementierung h√§ufig technische Artefakte oder erkennbare Spuren von Cybersicherheitsbedrohungen.  In diesem Fall wurde nichts dergleichen gefunden. </li><li>  Sowohl Norman als auch die PHP-Shell verwendeten den DuckDNS-Dienst. </li></ul><br><h3>  Warum k√∂nnen sie nicht verwandt sein </h3><br><ul><li>  Es gibt keine technischen √Ñhnlichkeiten zwischen den Crypto Mining-Malware-Optionen und der PHP-Shell.  Der b√∂swillige Cryptominer wurde in C ++ und die Shell in PHP erstellt.  Es gibt auch keine √Ñhnlichkeiten in der Codestruktur und Netzwerkfunktionen werden unterschiedlich implementiert. </li><li>  Es gibt keine direkte Interaktion zwischen den Malware-Optionen und der PHP-Shell f√ºr den Datenaustausch. </li><li>  Sie haben keine allgemeinen Entwicklerkommentare, Dateien, Metadaten oder Fingerabdr√ºcke. </li></ul><br><h3>  Drei Empfehlungen zum Schutz vor entfernten Schalen </h3><br>  Sch√§dliche Software, f√ºr die Befehle vom Kontrollzentrum (C &amp; C-Server) erforderlich sind, sieht nicht wie normale Viren aus.  Seine Aktionen sind nicht so vorhersehbar und √§hneln eher den Aktionen eines Hackers oder Pentesters, die ohne automatisierte Tools oder Skripte ausgef√ºhrt werden.  Das Erkennen dieser Angriffe ohne Malware-Signaturen ist daher eine komplexere Aufgabe als herk√∂mmliche Antivirenscans. <br><br>  <strong>Im Folgenden finden Sie drei Empfehlungen zum Schutz von Unternehmen vor Remote-Shells:</strong> <br><ol><li>  <b>Halten Sie die gesamte Software auf dem neuesten Stand</b> <br>  Angreifer nutzen h√§ufig Schwachstellen in Software und Betriebssystemen aus, um sich √ºber das Netzwerk des Unternehmens zu verteilen und nach Daten von Interesse zu suchen <br>  Diebstahl.  Durch die rechtzeitige Installation von Patches wird das Risiko solcher Bedrohungen erheblich verringert. </li><li>  <b>Verfolgen Sie abnormale Datenzugriffsereignisse</b> <br>  H√∂chstwahrscheinlich versuchen die Angreifer, die vertraulichen Daten der Organisation rund um den Umfang anzuzeigen.  Die √úberwachung abnormaler Ereignisse beim Zugriff auf diese Daten erm√∂glicht dies <br>  Erkennen Sie gef√§hrdete Benutzer und den gesamten Satz von Ordnern und Dateien, die tats√§chlich in die H√§nde von Angreifern fallen k√∂nnten, und betrachten Sie nicht nur alle Daten, die diesen Benutzern als solche zur Verf√ºgung stehen. </li><li>  <b>Verfolgen Sie den Netzwerkverkehr</b> <br>  Dank der Verwendung einer Firewall und / oder eines Proxyservers k√∂nnen b√∂swillige Verbindungen zu Malware-Kontrollzentren (C &amp; C-Servern) erkannt und blockiert werden, wodurch Angreifer daran gehindert werden, Befehle auszuf√ºhren, und die Ausgabe erschwert wird <br>  Perimeterdaten. </li></ol><br>  <strong>Besorgt √ºber das Thema Grauabbau?</strong>  <strong>Sechs Schutzempfehlungen:</strong> <br><br><ol><li>  <b>Halten Sie alle Betriebssysteme auf dem neuesten Stand.</b> <br>  Das Patch-Management ist sehr wichtig, um Missbrauch von Ressourcen und Malware-Infektionen zu verhindern. </li><li>  <b>√úberwachen Sie den Netzwerkverkehr und die Webproxys</b> <br>  Um einige Angriffe zu erkennen und einen Teil davon zu verhindern, k√∂nnen Sie den Datenverkehr basierend auf Informationen √ºber sch√§dliche Dom√§nen blockieren oder unn√∂tige Daten√ºbertragungskan√§le einschr√§nken. </li><li>  <b>Verwenden und warten Sie Antivirenl√∂sungen und Endpunktsicherheitssysteme</b> (beschr√§nken Sie sich jedoch keinesfalls darauf, nur diese Schutzschicht zu verwenden). <br>  Produkte auf den Endger√§ten erm√∂glichen die Erkennung bekannter Kryptominere und die Verhinderung von Infektionen, bevor die Leistung der Systeme und der Stromverbrauch beeintr√§chtigt werden.  Es ist zu beachten, dass neue √Ñnderungen oder neue Methoden zur Verhinderung der Erkennung dazu f√ºhren k√∂nnen, dass die Sicherheitsfunktionen auf den Endger√§ten keine neuen Versionen derselben Malware erkennen. </li><li>  <b>√úberwachen Sie die CPU-Aktivit√§t des Computers</b> <br>  Crypto Miner verwenden in der Regel den Zentralprozessor des Computers f√ºr das Mining.  Es ist erforderlich, alle Meldungen √ºber Leistungseinbu√üen zu analysieren (‚ÄûMein Computer wurde langsamer.‚Äú). </li><li>  <b>√úberwachen Sie DNS auf ungew√∂hnliche Nutzung dynamischer DNS-Dienste (wie DuckDNS)</b> \ <br><br>  Trotz der Tatsache, dass DuckDNS und andere dynamische DNS-Dienste selbst f√ºr das System nicht sch√§dlich sind, vereinfachte die Verwendung von DuckDNS-Malware die Erkennung infizierter Knoten f√ºr die an der Untersuchung beteiligten Spezialistenteams. </li><li>  <b>Entwickeln Sie einen Plan zur Reaktion auf Vorf√§lle</b> <br>  Stellen Sie sicher, dass Sie √ºber die f√ºr solche Vorf√§lle beschriebenen erforderlichen Verfahren verf√ºgen, mit denen die Bedrohung durch Gray Crypto Mining automatisch erkannt, begrenzt und beseitigt wird. </li></ol><br>  <strong>Hinweis f√ºr Varonis-Kunden.</strong> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Varonis DatAlert</a> enth√§lt Bedrohungsmodelle, die Malware f√ºr das Crypto Mining erkennen.  Kunden k√∂nnen auch ihre eigenen Regeln f√ºr die gezielte Erkennung von Software erstellen, die auf Dom√§nen basieren, die Kandidaten f√ºr die schwarze Liste sind.  Wenden Sie sich an Ihren Vertriebsmitarbeiter oder an den Varonis-Support, um sicherzustellen, dass Sie die neueste Version von DatAlert verwenden und die entsprechenden Bedrohungsmodelle anwenden. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466817/">https://habr.com/ru/post/de466817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466807/index.html">Python, das die Welt verschlingt: Als Nebenprojekt eines Entwicklers ist es zu einer beliebten Programmiersprache geworden</a></li>
<li><a href="../de466809/index.html">Der Kreis ist geschlossen. Wie Mitaps mir geholfen haben, einen Traumjob zu finden</a></li>
<li><a href="../de466811/index.html">Verlauf und Alternativen zur .NET-Plattform</a></li>
<li><a href="../de466813/index.html">Posit-Arithmetik: Besiegt einen Gleitkomma in seinem eigenen Feld. Teil 2</a></li>
<li><a href="../de466815/index.html">NEC HYDRAstor HS8 Technischer √úberblick und mehr</a></li>
<li><a href="../de466819/index.html">Implementierung von Werbeangeboten in iOS. Wie kann man mit Abonnements mehr verdienen?</a></li>
<li><a href="../de466821/index.html">Installieren Sie 3CX vom Amazon AWS Marketplace</a></li>
<li><a href="../de466823/index.html">So richten wir Migrationen f√ºr Gesch√§ftsprozesse in Bitrix24 ein</a></li>
<li><a href="../de466829/index.html">Ein paar Details zur Arbeit mit Bigint-IDs in R.</a></li>
<li><a href="../de466831/index.html">Entwicklung eines monolithischen Unix-√§hnlichen Betriebssystems - Heap (4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>