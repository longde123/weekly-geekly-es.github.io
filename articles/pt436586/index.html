<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçì üë®üèΩ‚ÄçüöÄ üçã Batalha JS: como eu escrevi meu eval () üôÄ üîπ ü§Æ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voc√™ pode se lembrar de Alexander Korotayev na vers√£o do navegador de ‚ÄúHer√≥is do Poder e da Magia‚Äù: a descriptografia de seu relat√≥rio sobre ela reuni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Batalha JS: como eu escrevi meu eval ()</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/436586/">  Voc√™ pode se lembrar de <b>Alexander Korotayev</b> na vers√£o do navegador de ‚ÄúHer√≥is do Poder e da Magia‚Äù: a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">descriptografia de</a> seu relat√≥rio sobre ela reuniu uma enorme quantidade de pontos de vista sobre Habr√©.  E agora ele criou um jogo focado em programadores: voc√™ precisa jog√°-lo com um c√≥digo JS. <br><br>  Desta vez, o desenvolvimento n√£o levou semanas, mas semanas, mas sem desafios interessantes de qualquer maneira que n√£o poderia ser feito.  Como tornar o jogo conveniente, mesmo para desenvolvedores que n√£o tocaram no JavaScript?  Como se proteger de maneiras simples de enganar um jogo? <br><br><img src="https://habrastorage.org/webt/to/1i/n0/to1in00dneigddmemqzjqonebuy.png"><br><br>  Como resultado, Alexander novamente fez um relat√≥rio sobre o HolyJS e n√≥s (os organizadores da confer√™ncia) preparamos novamente uma vers√£o em texto para Habr. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TJ7TGk5WJ5k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Meu nome √© Alexander Korotaev, trabalho na Tinkoff.ru, estou envolvido no front-end.  Al√©m disso, como parte da comunidade Spb-frontend, ajudo a organizar mitaps.  Eu fa√ßo o podcast Drinkcast, convidamos pessoas interessantes e discutimos v√°rios t√≥picos. <br><br>  Qual √© a ess√™ncia do brinquedo?  Primeiro, voc√™ precisa escolher uma unidade dentre as propostas, este √© um sistema de RPG: cada unidade tem seus pr√≥prios pontos fortes e fracos.  Voc√™ v√™ quais unidades o inimigo escolheu e se vingou dele.  Ent√£o voc√™ precisa escrever em JavaScript um script para o comportamento do seu ex√©rcito - em outras palavras, o script "o que todas as unidades devem fazer no campo de batalha". <br><br>  Isso √© feito no modo de depura√ß√£o: na verdade, voc√™ debita o c√≥digo e, em seguida, os dois oponentes pressionam seu c√≥digo, e a batalha entre os dois lados come√ßa. <br><br>  Assim, voc√™ pode ver como dois scripts, duas l√≥gicas e dois algoritmos se enfrentam.  Eu sempre quis fazer algo assim, e agora est√° finalmente implementado. <br><br>  Em a√ß√£o, tudo se parece com isso: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LfgaRFnmkhk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  E como foi o trabalho nele?  Muito trabalho foi feito na documenta√ß√£o.  Quando o jogador se senta no laptop, ele v√™ a documenta√ß√£o, na qual tudo √© descrito com bastante detalhes. <br><br>  Levei muito tempo para o seu layout, revis√£o e questionamento entre as pessoas, se √© claro.  Como resultado, ficou claro para sishnikov, javistas e outros desenvolvedores que n√£o sabem nada sobre JS.  Voc√™ pode at√© promover o JavaScript com este brinquedo: "N√£o √© assustador, veja como voc√™ pode escrever nele, at√© algo divertido acontece". <br><br><img src="https://habrastorage.org/webt/c3/9b/cf/c39bcfhakno9pvemjsm5rfj1_jo.png"><br><br>  Tivemos um grande torneio em nossa empresa, no qual praticamente todos os programadores de que participamos. <br><br>  Da tecnologia, usei o mecanismo de jogo mais popular do mundo do JS - Phaser.  O maior e mais usado Editor Ace.  Este √© um editor na Web, muito semelhante ao Sublime ou VSCode, que pode ser incorporado em uma p√°gina da Web.  Tamb√©m usei o RxJS para trabalhar com intera√ß√µes ass√≠ncronas de diferentes usu√°rios e o Preact para renderizar html.  Das tecnologias nativas, ele trabalhou especialmente com trabalhadores e websocket. <br><br><img src="https://habrastorage.org/webt/hr/7e/hj/hr7ehjcuxfyljukymq0yeiwsvou.png"><br><br><hr><br><h2>  Jogos para programadores </h2><br>  O que s√£o jogos para programadores em geral?  Na minha opini√£o, s√£o jogos em que voc√™ precisa codificar e, em seguida, obt√©m algum resultado engra√ßado que pode ser comparado a algu√©m, essa √© uma batalha.  Desses jogos online dispon√≠veis, eu conhe√ßo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Elevator Saga"</a> - voc√™ escreve scripts para elevadores de acordo com certos par√¢metros.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Screeps"</a> - sobre biologia, mol√©culas, escreva scripts para eles. <br><br>  Tamb√©m existem brinquedos que √†s vezes est√£o em confer√™ncias.  O mais popular deles √© o "Code in the Dark", tamb√©m o apresentamos hoje.  A prop√≥sito, ‚ÄúCode in the dark‚Äù me inspirou de v√°rias maneiras. <br><br><img src="https://habrastorage.org/webt/di/ri/xp/dirixpaaxzsners2q5wbecnqf_i.png"><br><br>  Por que isso foi feito?  Eu consegui a tarefa de que voc√™ precisasse de algo bacana com um estande na confer√™ncia, algo incomum.  N√£o que houvesse eychars com question√°rios.  √â claro que todo mundo quer atrair aten√ß√£o e coletar contatos.  Decidimos ir al√©m e criamos algo interessante e divertido para os programadores.  Percebi que os programadores querem lutar, competir e precisamos dar a eles essa oportunidade.  √â necess√°rio criar uma posi√ß√£o sobre a qual eles vir√£o e codificar√£o. <br><br>  Gamifica√ß√£o  Fizemos isso n√£o apenas entre os praticantes de programadores, mas tamb√©m entre os estudantes.  Realizamos essas partidas nos institutos no dia da carreira.  Precis√°vamos de alguma forma ver que tipo de caras havia, adequado para n√≥s ou n√£o.  Usamos a gamifica√ß√£o para atrair as pessoas para o processo, para ver como elas agem, o que fazem.  Eles tocaram e se distra√≠ram, mas isso nos deu informa√ß√µes.  Alguns pressionaram o c√≥digo sem execut√°-lo uma vez e ficou imediatamente √≥bvio que era muito cedo para o desenvolvimento. <br><br><img src="https://habrastorage.org/webt/zy/j7/-d/zyj7-dtcxgbzsnlm6eiakic1pri.png"><br><br>  Como parecia na primeira vers√£o.  Era uma tela principal e dois laptops para jogadores.  Tudo isso contatou o servidor, o servidor armazenou o Estado e vasculhou-o entre todos os clientes conectados.  Cada tela era um cliente conectado.  Os laptops dos players eram telas interativas a partir das quais esse estado podia ser alterado.  As telas s√£o rigidamente conectadas a um servidor. <br><br><h2>  Hist√≥ria de falta de tempo </h2><br>  A primeira hist√≥ria que me deparei neste desenvolvimento √© a hist√≥ria que eu tinha muito pouco tempo.  Literalmente em cinco minutos, surgiu uma id√©ia; em cinco segundos, um nome foi inventado quando foi necess√°rio criar um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio</a> no GitHub.  Eu poderia passar tudo apenas quatro horas da noite, tirando-as at√© da minha esposa.  Como resultado, eu s√≥ tinha tr√™s semanas antes da confer√™ncia para perceber isso pelo menos de alguma maneira.  Tudo come√ßou para que fosse apenas necess√°rio ter uma ideia no √¢mbito de um brainstorm, em cinco minutos a id√©ia nasceu: ‚ÄúVamos escrever algum tipo de intelig√™ncia artificial para RPG em JS‚Äù.  √â legal, divertido, eu posso implement√°-lo. <br><br><img src="https://habrastorage.org/webt/un/tq/kh/untqkhyleylozw4th97etc8grc0.png"><br><br>  Na primeira implementa√ß√£o, a tela tinha um editor de c√≥digo e uma tela de batalha, na qual a batalha estava em si.  Phaser, Ace Editor e Node.js puro foram usados ‚Äã‚Äãcomo um servidor sem estruturas.  Por√©m, o que me arrependi mais tarde, mas nada de especial foi exigido do servidor. <br><br><img src="https://habrastorage.org/webt/_g/lz/uz/_glzuzkixm5rkvgffsvxc6i0txi.png"><br><br>  Consegui perceber ent√£o o Renderer, que pintou a pr√≥pria batalha.  A parte mais dif√≠cil foi a sandbox para o c√≥digo JS, ou seja, uma sandbox na qual tudo deveria ser executado isoladamente para cada jogador.  Tamb√©m houve compartilhamento de estado que veio do servidor.  Os jogadores de alguma forma mudaram de estado, jogaram no servidor, o servidor enviou o restante para os soquetes da web.  O servidor era uma fonte de verdade e todos os clientes conectados confiavam no que vinha do servidor. <br><br><h2>  Sandbox </h2><br>  O que √© t√£o dif√≠cil de implementar uma caixa de areia?  O fato √© que a sandbox √© o mundo inteiro para o c√≥digo no qual o c√≥digo deve existir.  Ou seja, voc√™ cria para ele o mesmo mundo que o mundo inteiro, mas consistindo apenas de algumas conven√ß√µes, a partir de uma API com a qual voc√™ pode interagir.  Como implementar isso em JS?  Parece que o JS n√£o √© capaz disso, √© t√£o cheio de buracos e gratuito que n√£o d√° para colocar completamente o c√≥digo do usu√°rio em uma caixa sem usar uma m√°quina virtual separada com um sistema operacional separado. <br><br><img src="https://habrastorage.org/webt/gb/ok/yi/gbokyimz5h1piufn5yfoudov554.png"><br><br>  O que a caixa de areia deve fazer? <br><br>  Primeiro, como eu disse, isole o c√≥digo.  Deve ser um mundo do qual n√£o se possa sair. <br><br>  Al√©m disso, a API de gerenciamento de unidades deve ser lan√ßada l√°.  Os jogadores devem interagir com o campo de batalha, movendo as unidades, direcionando-as, dando-lhes um vetor de ataque. <br>  E quaisquer a√ß√µes de unidades s√£o ass√≠ncronas, ou seja, devem funcionar de alguma forma com c√≥digo ass√≠ncrono. <br><br><img src="https://habrastorage.org/webt/or/q1/y1/orq1y1fcofatt5oz2qieinaixay.png"><br><br>  O que eu queria dizer sobre assincronia?  O fato √© que no JS √© basicamente implementado usando promessas.  Tudo est√° claro para todos aqui, as promessas s√£o √≥timas, funcionam perfeitamente, quase sempre estivemos conosco.  Por muitos anos, todo mundo sabe como trabalhar com eles, mas esse brinquedo n√£o era apenas para javascripts.  Imagine se eu come√ßasse a explicar aos Javistas como escrever um c√≥digo de batalha usando promessas?  Como fazer ent√£o-ent√£o-ent√£o, por que √†s vezes n√£o √© necess√°rio ... O que fazer com condi√ß√µes ou loops? <br><br><img src="https://habrastorage.org/webt/z2/qn/ir/z2qnirhdy_puuuliwdnfu0sxalg.png"><br><br>  Obviamente, voc√™ pode seguir o melhor caminho e seguir a sintaxe ass√≠ncrona / aguardar.  [Slide 8:57] Mas voc√™ tamb√©m pode imaginar como programadores que n√£o s√£o javascript podem explicar que voc√™ precisa esperar antes de quase todas as linhas?  Como resultado, a melhor maneira de trabalhar com assincronia √© n√£o us√°-lo. <br><br><img src="https://habrastorage.org/webt/vm/yd/bi/vmydbi-ocp9npyl56wzqv-rnr4e.png"><br><br>  Crie o c√≥digo mais s√≠ncrono e a API mais simples, semelhante a quase qualquer linguagem de programa√ß√£o.  N√≥s fabricamos um brinquedo n√£o apenas para pessoas que escrevem em JS, queremos torn√°-lo acess√≠vel a todos que sabem codificar. <br><br><img src="https://habrastorage.org/webt/ng/et/2d/nget2dl8vrmwwi3y608ztrpn2pk.png"><br><br>  Todos n√≥s precisamos come√ßar de alguma forma.  O usu√°rio escreve o c√≥digo, e precisamos execut√°-lo, mova as unidades no mapa.  A primeira coisa que vem √† mente √© que precisamos de eval () mais a instru√ß√£o n√£o recomendada com, que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√£o</a> √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">recomendada para uso no MDN</a> .  Isso vai funcionar, mas h√° problemas. <br><br><img src="https://habrastorage.org/webt/ca/18/5a/ca185aygesba1t6wuxfymhvkghi.png"><br><br>  Por exemplo, temos um c√≥digo que destr√≥i completamente toda a nossa ideia, o que nos impede de fazer mais alguma coisa.  Este √© um c√≥digo que bloqueia a execu√ß√£o.  Algo precisa ser feito para que o usu√°rio n√£o possa bloquear o aplicativo.  Por exemplo, um loop sem fim pode quebrar tudo.  Se alert () e prompt () ainda puderem ser redefinidos, n√£o ser√° poss√≠vel redefinir um loop infinito. <br><br><h2>  eval () √© mau </h2><br>  Ent√£o chegamos ao ponto em que eval () √© mau.  N√£o √© √† toa que eles o chamam de mal, porque √© uma fun√ß√£o insidiosa que realmente incorpora tudo o mais livre e aberto que existe em JS e nos deixa completamente indefesos.  Com uma fun√ß√£o simples, fazemos um enorme buraco em nossa aplica√ß√£o. <br><br><img src="https://habrastorage.org/webt/-e/1s/yv/-e1syve2mujeqy_vpnr3obdk7sk.png"><br><br>  Mas e se eu disser, <i>[na voz de Steve Jobs]</i> que reinventamos o eval ()? <br><br>  Fizemos eval () em outras tecnologias, ele funciona quase da mesma forma que j√° temos.  Na verdade, eu tenho uma fun√ß√£o eval () no meu c√≥digo, mas implementada usando Workers, the with statement e Proxy. <br><br><img src="https://habrastorage.org/webt/wf/gj/ox/wfgjoxy3qrjkfnrnpvq-o06xr8k.png"><br><br>  Por que trabalhadores?  O fato √© que eles criam um thread de execu√ß√£o separado, ou seja, o JS √© de thread √∫nico, mas, gra√ßas aos trabalhadores, podemos obter outro thread.  Isso nos d√° muitos benef√≠cios.  Por exemplo, dentro dos mesmos loops intermin√°veis, podemos interromper o thread criado atrav√©s do worker a partir do thread principal, talvez seja esse o principal motivo pelo qual eu usei workers.  Se o trabalhador conseguiu trabalhar mais r√°pido do que em um segundo, n√≥s o consideramos bem-sucedido, obtemos seu resultado.  Caso contr√°rio, simplesmente cortamos.  De fato, o c√≥digo do usu√°rio, por algum motivo, n√£o funcionou, ocorreram alguns erros estranhos ou foram mais lentos devido a um loop infinito.  Muitos hoje tentaram escrever enquanto (verdadeiro), avisei que isso n√£o funcionaria. <br><br><img src="https://habrastorage.org/webt/ee/en/va/eeenvauyaknpsa7hizr52fvkcwk.png"><br><br>  Para escrever nosso trabalhador, precisamos apenas alimentar o script para o construtor do trabalhador, que ser√° baixado via http.  Dentro do script, precisamos criar um manipulador de mensagens a partir do thread principal.  Usando a fun√ß√£o postMessage () dentro do worker, podemos rotear mensagens para o thread principal.  Dessa forma, fazemos a comunica√ß√£o entre os dois threads.  Uma API simples bastante conveniente, mas algo est√° faltando nela, ou seja, o c√≥digo do usu√°rio que devemos executar neste trabalhador.  N√£o geraremos sempre um arquivo de script no servidor e o alimentaremos com o trabalhador. <br><br><img src="https://habrastorage.org/webt/u2/4h/ia/u24hian_cjbwwi-06mtfn6qldmo.png"><br><br>  Eu encontrei uma maneira usando URL.createObjectURL ().  Fazemos um bloco e o alimentamos ao src worker.  Assim, ele descarrega nosso c√≥digo diretamente da linha.  A prop√≥sito, dessa maneira funciona com qualquer objeto no DOM que possua src-image funciona assim, por exemplo, e mesmo em um iframe voc√™ pode carregar o html apenas gerando-o a partir de uma string.  Muito legal e flex√≠vel, eu acho.  Tamb√©m podemos gerenciar o trabalhador simplesmente transmitindo a ele nosso objeto especialmente gerado a partir da URL.  Tamb√©m podemos encerr√°-lo e ele j√° funciona como precisamos, e criamos a primeira sandbox. <br><br><img src="https://habrastorage.org/webt/mq/kp/mk/mqkpmkw8-ufofb05g8qb94-mzm4.png"><br><br>  As intera√ß√µes ass√≠ncronas v√£o mais longe, porque qualquer trabalho com trabalhadores √© ass√≠ncrono.  Enviamos alguma mensagem e n√£o podemos esperar pela pr√≥xima mensagem de forma s√≠ncrona, o worker apenas retorna uma inst√¢ncia para n√≥s e podemos assinar as mensagens.  Pegamos a mensagem usando o RxJS, criamos dois threads: um para uma mensagem bem-sucedida do trabalhador, o segundo para conclus√£o por tempo limite.  Dois threads que controlamos com sua mesclagem. <br><br><img src="https://habrastorage.org/webt/-x/mt/ny/-xmtnyqc5ytkd6w2zkzdeqfgsws.png"><br><br>  O RxJS possui operadores que nos permitem trabalhar com threads.  De fato, √© como um lodash para opera√ß√µes s√≠ncronas.  Podemos indicar alguma fun√ß√£o e n√£o pensar em como ela √© implementada por dentro, isso alivia a dor de cabe√ßa.  Precisamos come√ßar a pensar em threads, o operador de mesclagem mescla nossos threads, responde a qualquer mensagem.  Ele responder√° ao tempo limite e √† mensagem.  Precisamos apenas da primeira mensagem, respectivamente, ap√≥s a primeira mensagem que encerramos o worker.  Em caso de erro, imprima esse erro; em caso de sucesso, resolvemos. <br><br><img src="https://habrastorage.org/webt/l0/fj/lr/l0fjlrbzawogdkbhwkwkci-1osi.png"><br><br>  Tudo √© bem simples aqui.  Nosso c√≥digo se torna declarativo, a complexidade da assincronia vai para algum lugar.  O principal √© aprender esses operadores. <br><br><img src="https://habrastorage.org/webt/mi/oc/ev/miocevejr1in0eyfg30wqmozb10.png"><br><br>  √â assim que trabalhamos com a API da unidade.  Eu queria que a API da unidade fosse o mais simples poss√≠vel.  Falando sobre JS, muitas pessoas pensam que √© dif√≠cil, voc√™ precisa subir em algum lugar, aprender alguma coisa.  E eu queria simplificar o m√°ximo poss√≠vel: tudo na √°rea global, existe apenas o escopo da API da unidade, nada mais.  Tudo para gerenciamento de unidades, at√© preenchimento autom√°tico. <br><br><img src="https://habrastorage.org/webt/nl/-c/v8/nl-cv8_2s_3134omu8mqeanuiis.png"><br><br>  [Slide 15:20] A solu√ß√£o sugere que tudo isso pode ser jogado dentro do que √© proibido com a declara√ß√£o.  Vamos entender por que √© proibido. <br><br>  O fato √© que com tem seus problemas.  Por exemplo, infelizmente, h√° vazamentos fora do escopo que lan√ßamos nele, porque ele tenta parecer mais profundo que a API da unidade e analisa o escopo global. <br><br><img src="https://habrastorage.org/webt/tt/hw/gg/tthwggh1janwscz0t9poham_x44.png"><br>  Aqui o √∫ltimo exemplo √© especialmente interessante, porque at√© quatro pode ser perigoso para o nosso c√≥digo, pois todas essas fun√ß√µes podem ser executadas pelo c√≥digo do usu√°rio.  O usu√°rio pode fazer qualquer coisa.  Este √© um jogo para programadores e eles gostam de explorar os problemas e as maneiras de invadir alguma coisa. <br><br><img src="https://habrastorage.org/webt/b4/e0/hb/b4e0hbfhxr1l7xn51miw-qk8bzk.png"><br><br>  Como eu disse, os escopos s√£o muito vazados, portanto, um escopo global est√° sempre dispon√≠vel.  Independentemente de quantos escopos forne√ßamos em nosso c√≥digo personalizado, n√£o importa quantos escopos o agrupemos, o escopo global ainda estar√° vis√≠vel.  E tudo por causa de com. <br><br>  De fato, ele n√£o isola nada, apenas nos adiciona uma nova camada de abstra√ß√£o, um novo escopo global.  Mas podemos mudar esse comportamento com o Proxy. <br><br><img src="https://habrastorage.org/webt/zz/ed/qq/zzedqqwgeq-gxquunu4_ypeatak.png"><br><br>  O fato √© que o Proxy cuida de todas as nossas chamadas para o objeto em proxy por meio da nova API e podemos controlar como os novos pedidos de dados nesse objeto se comportam. <br><br><img src="https://habrastorage.org/webt/1u/lh/xa/1ulhxahfzy_yahdczgj7jbmacaw.png"><br><br>  De fato, com funciona de maneira bastante simples.  Quando o alimentamos com algum tipo de vari√°vel, ele verifica sob o cap√¥ se essa vari√°vel est√° no objeto (ou seja, executa o operador in) e, nesse caso, executa-o no objeto e, se n√£o, executa no escopo superior, em Nosso caso √© global.  √â bem simples aqui.  A principal coisa que o proxy nos ajuda √© que podemos substituir esse comportamento. <br><br><img src="https://habrastorage.org/webt/c0/jg/ie/c0jgie64g9zgd4fukgnjadkj2g4.png"><br><br>  Existe algo como ganchos no Proxy.  Uma coisa maravilhosa que nos permite fazer proxy de quaisquer solicita√ß√µes para o objeto.  Podemos alterar o comportamento da solicita√ß√£o de atributo, alterar o comportamento da tarefa de atributo e, o mais importante, podemos alterar o comportamento disso no operador.  Existe um gancho has, ao qual podemos retornar apenas true.  Assim, enganamos e enganamos completamente nossa declara√ß√£o with, tornando nossa API muito mais segura do que antes. <br><br><img src="https://habrastorage.org/webt/4w/-n/vy/4w-nvyhnsledhvcyl0tetw33hvq.png"><br><br>  Se tentarmos executar eval (), ele primeiro perguntar√° se esse eval () est√° em unitApi, eles responder√£o "sim" e ficar√£o "indefinidos n√£o √© uma fun√ß√£o".  Esta parece ser a primeira vez que estou feliz com esse erro!  Esse erro √© exatamente o que dever√≠amos ter recebido.  Pegamos e dissemos ao usu√°rio: "Desculpe, esque√ßa tudo o que voc√™ sabia sobre o objeto janela, isso n√£o √© mais."  J√° deixamos alguns problemas, mas isso n√£o √© tudo. <br><br><img src="https://habrastorage.org/webt/fo/yw/a2/foywa2mzbpbijvc3ndgpq-9tpxw.png"><br><br>  O fato √© que a declara√ß√£o with √© a mesma de JS, JS √© din√¢mico e um pouco estranho.  O estranho √© que nem tudo funciona como gostar√≠amos, sem olhar para a especifica√ß√£o.  O fato √© que tamb√©m funciona com propriedades de prot√≥tipo.  Ou seja, podemos brinca com um array, executar esse c√≥digo obscuro.  Todas as fun√ß√µes da matriz est√£o dispon√≠veis como globais neste escopo, o que parece um pouco estranho. <br><br><img src="https://habrastorage.org/webt/ih/2g/yr/ih2gyrz7isyixyvx7bswlamgvbe.png"><br><br>  Isso n√£o √© importante para n√≥s, √© importante para n√≥s que o usu√°rio possa executar valueOf () e obter toda a nossa sandbox.  Pegue e pegue diretamente, veja o que est√° nele.  Tamb√©m n√£o queria isso, ent√£o uma coisa interessante foi introduzida na especifica√ß√£o: Symbol.unscopables.  Ou seja, na nova especifica√ß√£o de s√≠mbolos, Symbol.unscopables foi introduzido especificamente para a instru√ß√£o with, que √© proibida.  Porque eles acreditam que algu√©m mais est√° usando.  Por exemplo, eu! <br><br><img src="https://habrastorage.org/webt/fv/9o/ns/fv9ons58tbtnrnc5rp7biuexgfk.png"><br><br>  Assim, faremos outro interceptador, onde verificamos especificamente se esse s√≠mbolo est√° na lista de todos os atributos que n√£o podem ser copiados.  Caso contr√°rio, devolva-o, mas, nesse caso, desculpe, n√£o retornaremos.  Tamb√©m n√£o o usamos.  E assim, com n√≥s n√£o podemos nem obter um prot√≥tipo de nossa caixa de areia. <br><br><img src="https://habrastorage.org/webt/07/5h/tt/075httw1dt0ekhe37frcstztzri.png"><br><br>  Ainda temos o ambiente de trabalho.  Isso √© algo que trava em uma √°rea global e ainda √© acess√≠vel.  O fato √© que, se voc√™ simplesmente substituir isso, ele estar√° dispon√≠vel no prot√≥tipo.  Quase tudo pode ser extra√≠do atrav√©s do prot√≥tipo em JS.  Surpreendentemente, todos esses m√©todos ainda est√£o dispon√≠veis atrav√©s do prot√≥tipo. <br><br><img src="https://habrastorage.org/webt/po/mt/fl/pomtflwlmxujubh-l8qzqqn2drg.png"><br><br>  Eu s√≥ tinha que pegar e limpar tudo isso.  Examinamos todas as chaves e limpamos tudo. <br><br><img src="https://habrastorage.org/webt/zg/9k/at/zg9katqtaothaqjip6trmosdig0.png"><br><br>  E ent√£o deixamos um pequeno ovo de P√°scoa para o usu√°rio, que ainda tenta chamar isso.  Pegamos a fun√ß√£o usual, o principal n√£o √© a fun√ß√£o de seta, que tem um escopo, e alteramos seu escopo para nosso objeto, no qual deixamos um pequeno ovo de P√°scoa para um usu√°rio particularmente curioso que deseja exibir um pouco disso ou de si no console.  Eu acredito que os ovos de P√°scoa s√£o maravilhosos e devem ser deixados no c√≥digo. <br><br><img src="https://habrastorage.org/webt/_s/7r/fq/_s7rfqdggfjikj2rjm7rcmhwja8.png"><br><br>  Acontece ainda que eles foram deixados apenas com nossa API de unidade.  Bloqueamos completamente tudo - na verdade, deixamos uma lista de permiss√µes.  Precisamos adicionar as APIs que s√£o √∫teis e necess√°rias.  Por exemplo, a API Math, que possui uma fun√ß√£o aleat√≥ria √∫til que muitas pessoas usam ao escrever c√≥digo para unidades. <br><br>  Tamb√©m precisamos de console e muitas outras fun√ß√µes utilit√°rias que n√£o possuem nenhuma fun√ß√£o destrutiva.  Criamos uma lista while para nossas APIs.  ,       blacklist,       ,     . <br><br><img src="https://habrastorage.org/webt/nz/mc/0o/nzmc0or7a_svlqdlhcdg36_bzi8.png"><br><br>  whitelist,     try-catch   .           ,     . <br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br>    ,     Worker       .  ,        worker,    ,    ¬´   ,    ¬ª   .       ,       JavaScript       ,  . <br><br>  ,    , -   .      ,     .      ,         webpack   . <br><br><img src="https://habrastorage.org/webt/cl/pa/q1/clpaq1aarq_8svpxquxahgyrkym.png"><br><br>      patchMethod(),     ,     postMessage().    postMessage()   console log, error, warn, info.        ,    .  ,       &lt;div&gt;,      ,    ,      ,     ,        . <br><br><img src="https://habrastorage.org/webt/nf/oq/yw/nfoqywkngugbgug6i5wwv_tpuhy.png"><br><br>     ,      .      : -   -  ‚Äî   ,     ,  -     . , ,    promises.   ,        actions,       . <br><br><img src="https://habrastorage.org/webt/jl/np/2f/jlnp2fcxsgtmghti8wzt4iwzbki.png"><br><br>          actions.   ,     real-time ?   ,  real-time    workers    ,        worker,       .       - ,    .    ,    , .   ,      ,   .        . <br><br><img src="https://habrastorage.org/webt/lk/zb/xp/lkzbxpal1f_bkmcq1pyk5sto8ey.png"><br><br>     workers,       .  workers ,           .      ,   .  ,     ,    (   ,  ),            .  :    ‚Äî . <br><hr><br><h2>  Math.random() </h2><br>   ,   ,         ,     .      Math.random(). <br><br>     ,   ,      ,                   .   ,  Math.random()     - . <br><br><img src="https://habrastorage.org/webt/g5/xs/zj/g5xszjwvqxhjxp4slm1hfmdfct4.png"><br><br>  ,     ,        (   ), JS   ,        .         . <br><br><img src="https://habrastorage.org/webt/ds/ic/sy/dsicsy7ra1vb8fuzq6xkry7y9zg.png"><br><br>   ,              ,  ,          .       ,    - . <br><br>            ,      . ,        random(),     . <br><br><img src="https://habrastorage.org/webt/cp/ew/ou/cpewoullokdb8p903gddmmgguj8.png"><br><br>  ,  random()     ‚Äî  ¬´ ¬ª      ,      .    ,    -  ,     random() ,       .    -    ,     .   ,          ,  random()    . <br><br><img src="https://habrastorage.org/webt/hu/tp/ot/hutpotesuqtwdc_p7yqelekwpjk.png"><br><br>       .    ,   ,   random()  .   - seed          (  ,        ,   ). <br><br><img src="https://habrastorage.org/webt/of/xs/da/ofxsdamysx7gcyfjgctqw1o72o0.png"><br>     ,     .            ,      random().                  ,  random()     -. <br><br>  <a href=""></a>  ,    worker,    ,   JS  .  ¬´¬ª ‚Äî     .   .     ,    JS .    random()  unit API.       ,    worker. <br><hr><br><br><h2> State sharing: RxJS,    </h2><br>  Ent√£o, descobrimos o que temos com o cliente.  Agora vamos falar sobre o compartilhamento de estado, por que isso √© necess√°rio e como foi organizado.  Temos estado armazenado no servidor, o servidor deve atrapalh√°-lo com os clientes conectados.  [Slide 28:48] <br><br>  Temos quatro fun√ß√µes de clientes diferentes que podem se conectar ao servidor: ‚Äúusu√°rio esquerdo‚Äù, ‚Äúusu√°rio certo‚Äù, um visualizador que olha para a tela principal e um administrador que pode fazer qualquer coisa. <br><br>  A tela esquerda n√£o pode alterar o estado do player certo, o visualizador n√£o pode alterar nada e o administrador pode fazer tudo. <br><br><img src="https://habrastorage.org/webt/qo/nw/xz/qonwxz54aiudwbywh6msiilucss.png"><br><br>  Por que isso foi um problema?  Tudo √© organizado de maneira simples.  Qualquer cliente conectado pode lan√ßar uma sess√£o, o servidor a aceita e se funde com o estado, que est√° dentro do servidor, e depois a distribui a todos os clientes.  Ele se atrapalha com qualquer mudan√ßa que venha a ele.  Era necess√°rio filtr√°-lo de alguma forma. <br><br><img src="https://habrastorage.org/webt/th/ol/vu/tholvuuygb9shbr5-de-aemuxs8.png"><br><br>  Primeiro, vou dizer por que o servidor tamb√©m tem RxJS.  Todas as intera√ß√µes com dois ou mais usu√°rios conectados se tornam ass√≠ncronas.  Devemos esperar pelos resultados de ambos os usu√°rios.  Por exemplo, os dois usu√°rios clicaram no bot√£o "Concluir", voc√™ deve esperar os dois clicarem e s√≥ ent√£o executar a a√ß√£o.  Foi tudo bastante direto no RxJS desta maneira: <br><br><img src="https://habrastorage.org/webt/xa/dp/6z/xadp6zds6_xaucjyb7hdrpskcmu.png"><br><br>  Estamos novamente operando com threads, existe um fluxo do soquete, chamado soquete.  Para criar um segmento que monitora apenas o jogador esquerdo, simplesmente pegamos e filtramos as mensagens desse soquete pelo jogador esquerdo (e da mesma forma que o direito).  Em seguida, podemos combin√°-los usando o operador forkJoin (), que funciona como Promise.all () e √© seu an√°logo.  Esperamos por essas duas a√ß√µes e chamamos o m√©todo setState (), que define nosso estado como "pronto".  Acontece que estamos esperando pelos dois jogadores e alteramos o estado do servidor.  No RxJS, isso √© o mais declarativo poss√≠vel, e √© por isso que eu o usei. <br><br>  Ainda existe um problema com o fato de que os jogadores podem mudar de estado entre si.  Eles devem ser proibidos de fazer isso.  Ainda assim, eles s√£o programadores, houve precedentes que algu√©m tentou.  Vamos criar classes separadas para elas que s√£o herdadas do Client. <br><br><img src="https://habrastorage.org/webt/jz/9-/6v/jz9-6vskw2b3lqcf3fxasd2w4kq.png"><br><br>  Eles ter√£o a l√≥gica b√°sica da comunica√ß√£o do jogador com o servidor e, em cada classe em particular, haver√° uma l√≥gica personalizada para filtrar dados. <br><br>  Cliente √© na verdade um conjunto de conex√µes, conex√µes com clientes. <br><br><img src="https://habrastorage.org/webt/sc/qz/kl/scqzklyflx8hylw3stj7drudpdy.png"><br><br>  Ele apenas as armazena e ele possui o fluxo onUnsafeMessage, que √© completamente inseguro: ele n√£o pode ser confi√°vel, s√£o apenas mensagens brutas do usu√°rio que ele recebe.  N√≥s escrevemos essas mensagens brutas no fluxo. <br><br>  Al√©m disso, ao implementar um player espec√≠fico, pegamos isso em UnsafeMessage e o filtramos. <br><br><img src="https://habrastorage.org/webt/yn/z0/1k/ynz01kbib00wt83k_5jwx5ix3ku.png"><br><br>  Precisamos filtrar apenas os dados que podemos obter desse player, em quem podemos confiar.  O jogador esquerdo s√≥ pode alterar o estado do jogador esquerdo, respectivamente, tiramos de todos os dados que ele poderia enviar, apenas o estado do jogador esquerdo.  Se voc√™ n√£o enviou, tudo bem.  Se enviado - n√≥s levamos.  Assim, a partir de mensagens completamente inseguras, recebemos mensagens seguras nas quais podemos confiar ao trabalhar na sala. <br><br><img src="https://habrastorage.org/webt/g3/-a/dg/g3-adglwnncvagey8nojzmksixw.png"><br><br>  Temos salas de jogos que re√∫nem jogadores.  Dentro da sala, podemos escrever exatamente as fun√ß√µes que podem mudar de estado diretamente, simplesmente assinando esses fluxos, nos quais j√° podemos confiar.  N√≥s abstra√≠mos de um monte de cheques.  Fizemos as verifica√ß√µes com base em fun√ß√µes e as chamamos de classes separadas.  Dividimos o c√≥digo de forma que, dentro do controlador, onde s√£o executadas as importantes fun√ß√µes de mudan√ßa de estado, o c√≥digo se tornou o mais simples e declarativo poss√≠vel. <br><br>  O RxJS tamb√©m √© usado no cliente, √© conectado ao soquete no verso, emite eventos e os redireciona de todas as maneiras. <br><br>  Nesse caso, gostaria de dar um exemplo quando precisar mudar o ex√©rcito do advers√°rio certo. <br><br><img src="https://habrastorage.org/webt/qf/u8/oy/qfu8oy7syyrcekd2z424rxuhplw.png"><br><br>  Para se inscrever, criamos um fluxo a partir do mesmo soquete e o filtramos.  Garantimos que este √© realmente o jogador certo e recebemos uma mensagem dele sobre qual √© o seu ex√©rcito.  Se n√£o houver essa mensagem, o fluxo n√£o retornar√° nada, n√£o haver√° uma √∫nica mensagem, permanecer√° em sil√™ncio at√© que o jogador mude o ex√©rcito.  N√≥s imediatamente resolvemos declarativamente o problema de filtrar eventos, n√£o o temos por brega. <br><br>  E quando algo j√° veio do fluxo, chamamos a fun√ß√£o setState ().  Isso √© bastante simples, a pr√≥pria abordagem que nos permite fazer tudo de forma transparente e declarativa.  Foi exatamente o que fiz no projeto RxJS e o que me ajudou muito. <br><br><img src="https://habrastorage.org/webt/gy/p9/qc/gyp9qchh3hadurc4_vmg0vjj1u4.png"><br><br>  Eu crio streams com os quais eu claramente nomeei, com os quais eu entendo como trabalhar, tudo √© declarativo, as fun√ß√µes necess√°rias s√£o chamadas, n√£o h√° problemas com muitos eventos if e de filtragem, tudo isso √© feito pelo RxJS. <br><br><h2>  Hist√≥ria: do single player ao multiplayer </h2><br><br>  Ent√£o, a primeira vers√£o do meu brinquedo foi escrita.  Podemos dizer que era um √∫nico jogador, porque apenas dois jogadores podiam reproduzi-lo, o n√∫mero de clientes conectados foi fixo.  T√≠nhamos um jogador esquerdo, um jogador direito e a tela atr√°s, tudo isso conectado diretamente ao servidor.  Tudo foi revestido, mas em tr√™s semanas foi feito. <br><br>  Recebi uma nova oferta: expandir o brinquedo para todos os programadores da empresa para que eles possam abrir e jogar em seus computadores.  Para que possamos obter uma lista de l√≠deres, multiplayer, para que eles possam jogar juntos.  Ent√£o percebi que tinha muita refatora√ß√£o. <br><br><img src="https://habrastorage.org/webt/qy/vs/-k/qyvs-khwziiaiv8xyfsnvcrlark.png"><br><br>  Acabou n√£o sendo t√£o dif√≠cil.  Simplesmente combinei todas as entidades que tinha em salas separadas.  Eu tenho a ess√™ncia de "Room", que poderia combinar todos os pap√©is.  Agora, n√£o s√£o os pr√≥prios jogadores que se comunicam diretamente com o servidor, mas as salas.  As salas j√° fizeram pedidos de proxy diretamente para o servidor, substituindo o estado, e o estado se tornou separado para cada sala. <br><br><img src="https://habrastorage.org/webt/cc/au/tt/ccautts_bfhkftuja4joqqeg9vm.png"><br><br>  Peguei e reescrevi tudo, adicionei uma lista de l√≠deres, ganhamos os melhores com pr√™mios.  S√≥ era necess√°rio ter um grande n√∫mero de usu√°rios, j√° era imposs√≠vel seguir todos, era necess√°rio escrever algo onde coletar todos os dados. <br><br><h2>  JS Gamedev e seus problemas </h2><br><br>  Assim, familiarizei-me mais seriamente com o JS-gamedev.  Fiz uma discuss√£o sobre o √∫ltimo projeto por cerca de tr√™s anos, descansando periodicamente.  E aqui eu tive as duas vezes por tr√™s semanas.  Todos os dias eu me sentava e fazia alguma coisa √† noite. <br><br>  Quais problemas existem no desenvolvimento de jogos em JS?  Tudo √© diferente de nossos aplicativos de neg√≥cios, onde n√£o √© um problema escrever algo do zero.  Al√©m disso, muito disso √© bem-vindo: faremos nossas pr√≥prias coisas, lembraremos das hist√≥rias com a NPM e daremos o seu tapinha. <br><br><img src="https://habrastorage.org/webt/f6/6l/zc/f66lzct-hy9vzyyixqvuplcd2qk.png"><br><br>  √â imposs√≠vel fazer isso no JS Gamedev, porque todas as tecnologias para exibir gr√°ficos s√£o t√£o baixas que √© banal economicamente in√∫til escrever algo sobre eles.  Se eu pegasse esse brinquedo e come√ßasse a escrev√™-lo do zero no WebGL, tamb√©m ficaria sentado por cerca de seis meses, tentando descobrir alguns erros estranhos.  O mecanismo de jogo mais popular da Phaser removeu esses problemas de mim ... <br><br><img src="https://habrastorage.org/webt/x1/zs/aa/x1zsaafnaxys0r9tssldvcper38.png"><br><br>  ... e adicionei novos para mim: 5 megabytes em um pacote.  E nada poderia ser feito sobre isso; ele n√£o sabe o que √© a mudan√ßa de √°rvores.  Al√©m disso, apenas a vers√£o mais recente do Phaser pode funcionar com pacotes e webpack.  Antes disso, Phaser era conectado apenas na tag html do script, era estranho para mim. <br><br>  Eu venho de todos os tipos de scripts de webpacks e, no jogo JS, quase nada pode fazer isso.  Todos os m√≥dulos t√™m uma digita√ß√£o extremamente ruim ou n√£o a possuem, ou basicamente n√£o sabem como usar o webpack, foi necess√°rio encontrar maneiras de envolv√™-lo.  Como se viu, mesmo o Ace Editor em sua forma pura n√£o funciona com o webpack.  Para come√ßar a trabalhar, voc√™ precisa fazer o download de um pacote separado onde j√° est√° empacotado (chave). <br><br>  Foi o mesmo com a Phaser, mas na nova vers√£o eles fizeram isso mais ou menos normalmente.  Continuei escrevendo na Phaser e descobri como fazer tudo funcionar com o webpack da maneira que costum√°vamos: tanto a digita√ß√£o quanto os testes podiam ser anexados a tudo isso.  Descobri que voc√™ pode pegar o <a href="">PixiJS</a> separadamente, que √© uma renderiza√ß√£o do webpack, e encontrar muitos m√≥dulos prontos para trabalhar com ele. <br><br><img src="https://habrastorage.org/webt/cz/cf/o7/czcfo7ib3-d7n3w-l1rpzxfo8cw.png"><br><br>  O PixiJS √© uma √≥tima biblioteca que pode renderizar no WebGL ou no Canvas.  Al√©m disso, voc√™ pode at√© escrever c√≥digo como se fosse para o Canvas, e ele ser√° renderizado no WebGL.  Esta biblioteca pode renderizar 2D muito rapidamente.  O principal √© saber como funciona com a mem√≥ria, para n√£o cair em uma posi√ß√£o quando a mem√≥ria acabar. <br><br>  Eu recomendo separadamente o reposit√≥rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">awesome-pixijs</a> no GitHub, onde voc√™ pode encontrar diferentes m√≥dulos.  Acima de tudo, gostei do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">React-pixi</a> .  Podemos simplesmente ignorar a solu√ß√£o de problemas com a visualiza√ß√£o quando escrevemos fun√ß√µes imperativas diretamente no controlador para desenhar formas geom√©tricas, sprites, anima√ß√µes e muito mais.  Todos n√≥s podemos marcar em JSX.  Viemos do mundo JSX com nosso aplicativo de neg√≥cios e podemos us√°-los ainda mais.  √â para isso que amo a abstra√ß√£o.  React-pixi nos d√° essa abstra√ß√£o familiar. <br><br>  Tamb√©m recomendo que voc√™ use o tween.js, o mesmo famoso mecanismo de anima√ß√£o da Phaser, que permite criar anima√ß√µes declarativas que s√£o um pouco semelhantes √†s anima√ß√µes CSS: fazemos uma transi√ß√£o entre estados e o tween.js decide exatamente como mover o objeto. <br><br><h2>  Tipos de jogadores: quem s√£o e como fazer amizade com eles </h2><br>  Me deparei com diferentes jogadores e tamb√©m gostaria de falar sobre o teste do brinquedo.  Reuni colegas em uma sala fechada e n√£o os soltei at√© que terminassem o jogo.  Infelizmente, nem todos conseguiram terminar o jogo, porque no come√ßo eu tinha muitos bugs.  Felizmente, comecei a testar assim que pelo menos algum prot√≥tipo em funcionamento apareceu.  Honestamente, o primeiro teste falhou porque alguns jogadores n√£o iniciaram nada.  Foi uma pena, mas me deu um chute que me permitiu seguir em frente. <br><br>  Quando seu brinquedo estiver pronto, voc√™ poder√° ser recebido muito bem ou com um forcado e tochas.  Todas as pessoas est√£o esperando por algum tipo de f√£ dos jogos, esperando a felicidade que voc√™ lhes dar√°.  E voc√™ lhes d√° algo que n√£o funciona, embora pare√ßa funcionar para voc√™.  Quando voc√™ tem um brinquedo on-line, existem ainda mais erros desse tipo. <br><br>  Como resultado, as pessoas mais agrad√°veis ‚Äã‚Äãque encontrei s√£o ‚Äúpesquisadores‚Äù que sempre encontram mais em seu brinquedo do que realmente s√£o.  Eles podem complement√°-lo agradavelmente com todo tipo de pequenas coisas, solicitando que voc√™ adicione algo.  Infelizmente, a comunica√ß√£o com essas pessoas n√£o deu o importante - a estabilidade do brinquedo. <br><br>  Existem jogadores comuns que v√™m apenas para o bem dos f√£s.  √Äs vezes, eles nem percebem insetos, de alguma forma deslizando atrav√©s deles a caminho do prazer. <br><br>  Outra categoria s√£o os coletores de erros, para os quais quase tudo n√£o funciona.  Voc√™ precisa ser amigo dessas pessoas, embora elas falem muita negatividade.  Precisamos estabelecer relacionamentos estranhos com eles: eles machucam voc√™ e voc√™ est√° tentando tirar algo √∫til deles: "vamos sentar no seu computador e ver".  Voc√™ precisa trabalhar com eles, porque no final s√£o essas pessoas que far√£o a qualidade do seu jogo. <br><br>  Voc√™ precisa testar apenas em pessoas vivas.  Seu olho est√° emba√ßado e os testes certamente mostrar√£o o que est√° oculto.  Voc√™ est√° desenvolvendo um brinquedo e mergulhando mais fundo, vendo alguns recursos, mas eles podem at√© n√£o ser necess√°rios.  Voc√™ vai diretamente aos seus consumidores, mostra a eles e observa como eles tocam, quais teclas pressionam.  Isso lhe d√° um incentivo para fazer exatamente o que voc√™ precisa.  Voc√™ v√™ que algumas pessoas pressionam constantemente Ctrl + S, porque est√£o acostumadas a salvar o c√≥digo - bem, pelo menos fa√ßa o c√≥digo rodar em Ctrl + S, o player se sentir√° mais confort√°vel.  Voc√™ precisa criar um ambiente confort√°vel para o jogador, para isso voc√™ precisa am√°-lo e segui-lo. <br><br>  A regra 80/20 funciona: voc√™ faz uma demonstra√ß√£o 20% do tempo com todo o desenvolvimento do jogo e, para o jogador, parece um jogo completo de 80%.  A percep√ß√£o funciona para que a mec√¢nica b√°sica esteja pronta, tudo se move e funciona, o que significa que o jogo est√° quase pronto, e o desenvolvedor terminar√° em breve.  Mas, na realidade, o desenvolvedor ainda tem uma sa√≠da de 80%.  Como eu disse, durante muito tempo tive que trabalhar na documenta√ß√£o para que fosse compreens√≠vel para todos.  Eu mostrei para muitas pessoas que fizeram seus coment√°rios, eu os filtrei, tentando entender a ess√™ncia das declara√ß√µes.  E demorou muito tempo para procurar bugs. <br><br>  Portanto, no desenvolvimento de jogos, eu s√≥ poderia aconselh√°-lo a fazer demos: eles encantam a todos, n√£o exigem muito tempo e ningu√©m espera realmente nada deles.  Terminar jogos √© um processo chato, mas √© √≥timo come√ßar. <br><br>  Por fim, deixo os links: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Reposit√≥rio com um jogo e instru√ß√µes para o lan√ßamento</a> (ficarei feliz em agrupar solicita√ß√µes se voc√™ encontrar bugs) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Phaser</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">awesome-pixijs</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servidor de jogo multiplayer de Colyseus</a> (eu mesmo escrevi multiplayer e vi um servidor pronto com salas) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Editor Ace</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Apresenta√ß√£o deste relat√≥rio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Confer√™ncias em russo para as quais voc√™ pode enviar um relat√≥rio</a> </li></ul><br><blockquote>  <b>O HolyJS 2019 Piter</b> , uma confer√™ncia para desenvolvedores de JavaScript, ser√° realizada de 24 a 25 de maio em S√£o Petersburgo.  Os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeiros palestrantes</a> j√° apareceram no site. <br>  Voc√™ tamb√©m pode solicitar um relat√≥rio, a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Chamada de Trabalhos est√°</a> aberta at√© 11 de mar√ßo. <br>  Os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pre√ßos dos</a> ingressos subir√£o em 1¬∫ de fevereiro. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436586/">https://habr.com/ru/post/pt436586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436568/index.html">Plataforma de v√≠deo pr√≥pria ou como usar muitos recursos de computa√ß√£o. Parte 1</a></li>
<li><a href="../pt436570/index.html">Programador Exorcismo</a></li>
<li><a href="../pt436572/index.html">Concurso Skolkovo Cybersecurity Challenge 2019 Cybersecurity Project</a></li>
<li><a href="../pt436578/index.html">Pre√ßo de seguran√ßa pessoal para diretores das principais empresas de TI por ano</a></li>
<li><a href="../pt436584/index.html">Lei de Gerenciamento de Runas - implementa√ß√£o de disposi√ß√µes e √°reas de responsabilidade</a></li>
<li><a href="../pt436588/index.html">MegaSlerm em Moscou no in√≠cio de junho: primeiro an√∫ncio e descontos</a></li>
<li><a href="../pt436590/index.html">Dicas para um cliente funcional. Pressione Œî para ler</a></li>
<li><a href="../pt436592/index.html">Back-end nos componentes de arquivo √∫nico do VueJS</a></li>
<li><a href="../pt436594/index.html">Adeus Chevy Volt: Hist√≥rias e lendas do h√≠brido recarreg√°vel</a></li>
<li><a href="../pt436596/index.html">Os desenvolvedores de pilha cheia est√£o de fato presos no n√≠vel intermedi√°rio. Poupe-se do sofrimento - n√£o siga esse caminho</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>