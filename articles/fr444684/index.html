<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤜🏽 ✌🏾 🙌 Nous travaillons avec les réseaux de neurones: une liste de contrôle pour le débogage 👨🏾‍🍳 🛐 🍊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le code logiciel d'apprentissage automatique est souvent complexe et assez déroutant. Détecter et éliminer les bogues est une tâche gourmande en resso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous travaillons avec les réseaux de neurones: une liste de contrôle pour le débogage</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/444684/"><img src="https://habrastorage.org/getpro/habr/post_images/84a/7dc/4b8/84a7dc4b81799226681bb176f1c518b0.png" alt="image"><br><br>  Le code logiciel d'apprentissage automatique est souvent complexe et assez déroutant.  Détecter et éliminer les bogues est une tâche gourmande en ressources.  Même les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réseaux de neurones à connexion directe</a> les plus simples nécessitent une approche sérieuse de l'architecture du réseau, de l'initialisation des pondérations et de l'optimisation du réseau.  Une petite erreur peut entraîner des problèmes désagréables. <br><br>  Cet article concerne l'algorithme de débogage de vos réseaux de neurones. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox recommande:</b> Un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">développeur de</a> cours pratique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python à partir de zéro</a> . <br><br>  <b>Nous vous rappelons:</b> <i>pour tous les lecteurs de «Habr» - une remise de 10 000 roubles lors de l'inscription à un cours Skillbox en utilisant le code promo «Habr».</i> </blockquote><cut></cut><br><h3>  L'algorithme comprend cinq étapes: </h3><br><ul><li>  démarrage simple; </li><li>  confirmation des pertes; </li><li>  vérification des résultats intermédiaires et des composés; </li><li>  diagnostic des paramètres; </li><li>  contrôle du travail. </li></ul><br>  Si quelque chose vous semble plus intéressant que les autres, vous pouvez accéder directement à ces sections. <br><br><h3>  Démarrage facile </h3><br>  Un réseau de neurones avec une architecture complexe, une régularisation et un planificateur de vitesse d'apprentissage est plus difficile à démarrer qu'un réseau régulier.  Nous sommes un peu compliqués ici, car l'élément lui-même a une relation indirecte avec le débogage, mais c'est toujours une recommandation importante. <br><br>  Un début simple consiste à créer un modèle simplifié et à le former sur un ensemble de données (point). <br><br>  <b>Nous créons d'abord un modèle simplifié</b> <br><br>  Pour un démarrage rapide, créez un petit réseau avec une seule couche cachée et vérifiez que tout fonctionne correctement.  Ensuite, nous compliquons progressivement le modèle, vérifions chaque nouvel aspect de sa structure (couche supplémentaire, paramètre, etc.) et continuons. <br><br>  <b>Nous formons le modèle sur un seul ensemble de données (point)</b> <br><br>  Pour tester rapidement la santé de votre projet, vous pouvez utiliser un ou deux points de données pour la formation afin de vérifier si le système fonctionne correctement.  Le réseau neuronal doit montrer une précision de 100% de l'entraînement et de la vérification.  Si ce n'est pas le cas, alors soit le modèle est trop petit soit vous avez déjà un bug. <br><br>  Même si tout va bien, préparez le modèle pour le passage d'une ou plusieurs époques avant de continuer. <br><br><h3>  Estimation des pertes </h3><br>  L'estimation des pertes est le principal moyen d'affiner les performances du modèle.  Vous devez vous assurer que la perte correspond à la tâche et que les fonctions de perte sont évaluées sur la bonne échelle.  Si vous utilisez plus d'un type de perte, assurez-vous qu'ils sont tous du même ordre et correctement mis à l'échelle. <br><br>  Il est important d'être attentif aux pertes initiales.  Vérifiez à quel point le résultat réel est proche de celui attendu si le modèle a commencé avec une hypothèse aléatoire.  Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">travail d'Andrei Karpati suggère ce qui suit</a> : «Assurez-vous d'obtenir le résultat attendu lorsque vous commencez à travailler avec un petit nombre de paramètres.  Il est préférable de vérifier immédiatement la perte de données (avec un degré de régularisation défini sur zéro).  Par exemple, pour CIFAR-10 avec le classificateur Softmax, nous nous attendons à ce que la perte initiale soit de 2,302, parce que la probabilité diffuse attendue est de 0,1 pour chaque classe (car il y a 10 classes), et la perte de Softmax est la probabilité logarithmique négative de la classe correcte comme - ln (0,1) = 2,302. " <br><br>  Pour un exemple binaire, un calcul similaire est simplement effectué pour chacune des classes.  Voici, par exemple, les données: 20% 0 et 80% 1.  La perte initiale attendue atteindra –0,2 ln (0,5) –0,8 ln (0,5) = 0,693147.  Si le résultat est supérieur à 1, cela peut indiquer que les poids du réseau neuronal ne sont pas correctement équilibrés ou que les données ne sont pas normalisées. <br><br><h3>  Vérification des résultats intermédiaires et des connexions </h3><br>  Pour déboguer un réseau neuronal, il est nécessaire de comprendre la dynamique des processus au sein du réseau et le rôle des couches intermédiaires individuelles, car elles sont connectées.  Voici quelques erreurs courantes que vous pourriez rencontrer: <br><br><ul><li>  Expressions incorrectes pour les mises à jour de dégradé </li><li>  les mises à jour de poids ne s'appliquent pas; </li><li>  disparaître ou exploser des gradients. </li></ul><br>  Si les valeurs du gradient sont nulles, cela signifie que la vitesse d'apprentissage dans l'optimiseur est trop lente ou que vous avez rencontré une expression incorrecte pour mettre à jour le gradient. <br><br>  De plus, il est nécessaire de surveiller les valeurs des fonctions d'activation, les poids et les mises à jour de chacune des couches.  Par exemple, la valeur des mises à jour des paramètres (poids et décalages) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">doit être 1-e3</a> . <br><br>  Il y a un phénomène appelé «Dying ReLU» ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«Disappearing Gradient Problem»</a> lorsque les neurones ReLU sortiront zéro après avoir étudié la grande valeur de biais négatif pour leurs poids.  Ces neurones ne sont plus jamais réactivés dans aucun emplacement de données. <br><br>  Vous pouvez utiliser des tests de gradient pour détecter ces erreurs en approximant le gradient à l'aide d'une approche numérique.  S'il est proche des gradients calculés, alors la propagation inverse a été correctement mise en œuvre.  Pour créer une vérification de gradient, consultez ces excellentes ressources CS231 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> , ainsi que le didacticiel d'Andrew Nga sur ce sujet. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fayzan Sheikh</a> souligne trois méthodes principales pour visualiser un réseau neuronal: <br><br><ul><li>  Préliminaire - méthodes simples qui nous montrent la structure générale du modèle entraîné.  Ils incluent la sortie de formes ou de filtres de couches individuelles du réseau neuronal et les paramètres de chaque couche. </li><li>  Basé sur l'activation.  On y déchiffre l'activation de neurones individuels ou de groupes de neurones afin de comprendre leurs fonctions. </li><li>  Basé sur un dégradé.  Ces méthodes ont tendance à manipuler les gradients qui se forment à partir du passage dans les deux sens lors de l'apprentissage du modèle (y compris les cartes de signification et les cartes d'activation de classe). </li></ul><br>  Il existe plusieurs outils utiles pour visualiser les activations et les connexions de couches individuelles, par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="noopener">ConX</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="noopener">Tensorboard</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d86/8ff/f33/d868fff33e5b7cb69563bfee29b9db08.png"><br><br><h3>  Diagnostic des paramètres </h3><br>  Les réseaux de neurones ont de nombreux paramètres qui interagissent entre eux, ce qui complique l'optimisation.  En fait, cette section fait l'objet d'une recherche active par des spécialistes, donc les propositions ci-dessous ne doivent être considérées que comme des conseils, les points de départ sur lesquels vous pouvez vous appuyer. <br><br>  Taille du lot - Si vous souhaitez que la taille du paquet soit suffisamment grande pour fournir des estimations précises du gradient d'erreur, mais suffisamment petite pour que la descente du gradient stochastique (SGD) rationalise votre réseau.  La petite taille des packages entraînera une convergence rapide due au bruit dans le processus d'apprentissage et à l'avenir à des difficultés d'optimisation.  Ceci est décrit plus en détail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  <b>Vitesse d'apprentissage</b> - Trop lent entraînera une convergence lente ou le risque d'être coincé dans les bas locaux.  Dans le même temps, une vitesse d'apprentissage élevée entraînera une divergence dans l'optimisation, car vous risquez de "sauter" à travers la partie profonde, mais en même temps étroite de la fonction de perte.  Essayez d'utiliser la planification de la vitesse pour la réduire pendant l'entraînement du réseau neuronal.  CS231n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">a une grande section sur cette question</a> . <br><br>  <b>Écrêtage de gradient</b> - coupe les gradients des paramètres pendant la propagation arrière à la valeur maximale ou à la norme limite.  Utile pour résoudre les problèmes de dégradés explosifs que vous pouvez rencontrer dans le troisième paragraphe. <br><br>  <b>Normalisation par lots</b> - utilisée pour normaliser les données d'entrée de chaque couche, ce qui permet de résoudre le problème de décalage covariant interne.  Si vous utilisez Dropout et Batch Norma ensemble, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consultez cet article</a> . <br><br>  <b>Descente de gradient stochastique (SGD)</b> - Il existe plusieurs variétés de SGD qui utilisent l'élan, les vitesses d'apprentissage adaptatives et la méthode de Nesterov.  Dans le même temps, aucun d'entre eux n'a un avantage clair en termes d'efficacité de formation et de généralisation ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">détails ici</a> ). <br><br>  <b>Régularisation</b> - est cruciale pour la construction d'un modèle généralisé, car elle ajoute une pénalité pour la complexité du modèle ou des valeurs de paramètres extrêmes.  C'est un moyen de réduire la variance du modèle sans augmenter significativement son déplacement.  Plus d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">informations ici</a> . <br><br>  Pour tout évaluer vous-même, vous devez désactiver la régularisation et vérifier vous-même le gradient de perte de données. <br><br>  <b>Le décrochage</b> est un autre moyen de rationaliser votre réseau pour éviter la congestion.  Pendant l'entraînement, la perte se produit uniquement en maintenant l'activité du neurone avec une certaine probabilité p (hyperparamètre) ou en la mettant à zéro dans le cas contraire.  Par conséquent, le réseau doit utiliser un sous-ensemble différent de paramètres pour chaque formation, ce qui réduit les changements de certains paramètres qui deviennent dominants. <br><br>  Important: si vous utilisez à la fois l'abandon et la normalisation par lots, faites attention à l'ordre de ces opérations ou même à leur utilisation conjointe.  Tout cela est encore activement discuté et complété.  Voici deux discussions importantes sur ce sujet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur Stackoverflow</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Arxiv</a> . <br><br><h3>  Contrôle du travail </h3><br>  Il s'agit de documenter les workflows et les expériences.  Si vous ne documentez rien, vous pouvez oublier, par exemple, quel type de vitesse d'entraînement ou de poids de classe est utilisé.  Grâce au contrôle, vous pouvez facilement visualiser et reproduire les expériences précédentes.  Cela réduit le nombre d'expériences en double. <br><br>  Il est vrai que la documentation manuelle peut être difficile en cas de grande quantité de travail.  Des outils tels que Comet.ml viennent à la rescousse ici, aidant à enregistrer automatiquement les ensembles de données, les modifications de code, l'historique des expériences et les modèles de production, y compris les informations clés sur votre modèle (hyperparamètres, indicateurs de performance du modèle et informations environnementales). <br><br>  Un réseau de neurones peut être très sensible aux petits changements, ce qui entraînera une diminution des performances du modèle.  Le suivi et la documentation du travail est la première étape à suivre pour normaliser votre environnement et votre modélisation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e0/52c/de4/0e052cde4414da934bdde111cc0f0bf5.png"><br><br>  J'espère que ce message pourra devenir le point de départ à partir duquel vous commencerez à déboguer votre réseau neuronal. <br><blockquote>  <b>Skillbox recommande:</b> <br><br><ul><li>  Cours pratique de deux ans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Je suis un développeur web PRO</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"</a> </li><li>  Cours en ligne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Développeur C # avec 0"</a> . </li><li>  Cours pratique annuel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Développeur PHP de 0 à PRO"</a> . <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr444684/">https://habr.com/ru/post/fr444684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr444672/index.html">Roskachestvo a présenté une évaluation des écouteurs filaires et sans fil disponibles en Russie</a></li>
<li><a href="../fr444674/index.html">Sony Xperia 10 et Xperia 10 Plus - smartphones à vue large</a></li>
<li><a href="../fr444676/index.html">Évaluation CRM, tops, avis - mentent-ils tous?</a></li>
<li><a href="../fr444678/index.html">Jour de disponibilité: 12 avril, vol normal</a></li>
<li><a href="../fr444682/index.html">Les stocks de Sony et Nintendo tombent en panne après le lancement du streaming vidéo pour les joueurs de Google</a></li>
<li><a href="../fr444686/index.html">Waves Smart Assets: listes noires et blanches, trading par intervalles</a></li>
<li><a href="../fr444688/index.html">Veuillez arrêter de parler du modèle de référentiel avec Eloquent</a></li>
<li><a href="../fr444690/index.html">Comment les chercheurs d'Uber appliquent et mettent à l'échelle les connaissances sur le comportement humain</a></li>
<li><a href="../fr444692/index.html">MOSDROID # 16 Soufre à Redmadrobot</a></li>
<li><a href="../fr444694/index.html">Comme nous l'avions prédit, la sortie comme une catastrophe naturelle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>