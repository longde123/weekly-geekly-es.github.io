<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÜ üëÇüèø üèä Conferencia DEFCON 17. ¬°R√≠ete de tus virus! Parte 1 üîπ üëñ ‚è´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Michael: Doy la bienvenida a todos, soy Michael Lai, este es Matthew Richard, puedes llamarlo Matt o Richard, porque tiene dos nombres, pero no import...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conferencia DEFCON 17. ¬°R√≠ete de tus virus! Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428858/"> <b>Michael: Doy la</b> bienvenida a todos, soy Michael Lai, este es Matthew Richard, puedes llamarlo Matt o Richard, porque tiene dos nombres, pero no importa. <br><br>  <b>Matt:</b> El tema de nuestra conversaci√≥n de hoy es el rid√≠culo del malware, y eso es exactamente lo que estamos tratando de hacer. <br><br><img src="https://habrastorage.org/webt/dg/yd/dw/dgyddwjbkvhvkngc1lug68ifhb8.jpeg"><br><br>  Entonces, no todos los que escriben el c√≥digo lo hacen bien, la gente comete muchos errores.  Y no todos los que usan el virus lo hacen bien.  Tambi√©n hay personas que fracasan en ambos casos.  As√≠ que si√©ntate m√°s c√≥modamente, rel√°jate y escucha, tal vez esta informaci√≥n te sea √∫til. <br><br>  Por si acaso, incluimos material t√©cnico factual en la presentaci√≥n para que al menos aprenda algo si la conversaci√≥n no le parece divertida.  Observo que esta es solo nuestra opini√≥n, que puede no coincidir con la opini√≥n de nuestros empleadores. <a name="habracut"></a><br><br>  <b>Michael: La</b> primera historia se llama "Cari√±o, reduje la entrop√≠a".  Ella habla sobre c√≥mo el autor de Silent Banker, un algoritmo de cifrado muy complejo, olvid√≥ crear entrop√≠a usando PRNG, un generador de n√∫meros pseudoaleatorios.  En la diapositiva, ver√° un fragmento de c√≥digo Zeus de septiembre de 2007 en el que PRNG se utiliza para evitar la detecci√≥n basada en hash.  La generaci√≥n consiste en iniciar esta variable global llamada ddTickCount: primero, la coloca en el registro EAX, desde donde se llama a la funci√≥n por primera vez.  Luego se verifica si el valor de la funci√≥n es igual a cero, y si no es igual, se llama a TickCount para generar SEED, es decir, para iniciar un n√∫mero pseudoaleatorio, utilizando el comando GetTickCount. <br><br><img src="https://habrastorage.org/webt/eq/lo/pv/eqlopvhuevvaq3r9k1oqbkdygy0.jpeg"><br><br>  No nos sorprendi√≥ ver las similitudes con este c√≥digo en el archivo binario Silent Banker de febrero de 2008.  Utiliza PRNG para generar nombres de archivo temporales.  Aqu√≠, tambi√©n, existe la misma variable global ddTickCount, que verifica si hay un cero, y si es as√≠, se inicia un n√∫mero pseudoaleatorio usando GetTickCount.  Primero, antes de ver msvsrt rand, el generador de n√∫meros pseudoaleatorios utilizado por la funci√≥n rand () de la biblioteca de Microsoft C Runtime Windows, pens√© que hab√≠a una conexi√≥n entre el autor Zeus y el autor de Silent Banker, solo basado en n√∫meros HEX codificados en un archivo binario .  Pero, de hecho, ambos estaban vinculados est√°ticamente a msvsrt. <br><br>  Ahora llegamos a la receta para el desastre.  Este es un fragmento de c√≥digo de la versi√≥n de Silent Banker de julio de 2008, lanzado unos meses despu√©s de la versi√≥n de febrero. <br><br><img src="https://habrastorage.org/webt/z9/wh/fr/z9whfrngqr3rhppqfx1xdficwio.jpeg"><br><br>  Actualizaron su c√≥digo y publicaron una nueva versi√≥n de Silent Banker, que era significativamente diferente de lo que vimos anteriormente.  En este programa, PRNG se utiliza para generar una clave de cifrado.  Aqu√≠ ya no ver√° que una variable global llamada CurrentSeed se verifica para determinar la igualdad a cero y se genera un n√∫mero pseudoaleatorio dependiendo de esto, simplemente se usa en este c√≥digo. <br><br><img src="https://habrastorage.org/webt/tz/ig/ny/tzignymsyqo08w5wjth2zugzo38.jpeg"><br><br>  Es posible que en alg√∫n lugar del archivo binario, incluso antes de este lugar, el valor de esta variable global se genere en forma de alg√∫n tipo de n√∫mero.  As√≠ que paso a desmontar este c√≥digo y ver si el valor CurrentSeed se usa en otra parte del programa antes de usarlo en esta funci√≥n rand ().  Ver√° que inicialmente dd comienza desde cero, y comprobaremos las referencias cruzadas a esta variable. <br><br><img src="https://habrastorage.org/webt/xb/gw/uh/xbgwuhestru6xn4re261ayainnk.jpeg"><br><br>  En la columna T, el valor w significa que solo hay una operaci√≥n v√°lida para esta variable global en todo el archivo binario: esta es la funci√≥n rand misma.  Repasar√© estas cosas con fluidez porque ya se mencionaron en la DefCon del a√±o pasado.  En la diapositiva "Receta para el desastre", la l√≠nea Seed the PRNG, o "Initiation of a Pseudo Random Number Generator", se muestra en gris para indicar que el autor de Silent Banker no hizo esta iniciaci√≥n. <br><br><img src="https://habrastorage.org/webt/bp/aj/n9/bpajn9ym0w4nhtdxaboum9cm2oe.jpeg"><br><br>  El siguiente paso es que generan una clave de 16 bytes, haciendo 1000 llamadas del sistema a la funci√≥n MyRand ().  Luego, a partir de una clave de 16 bytes, generan un n√∫mero de 8 bytes, la clave, usando una f√≥rmula espec√≠fica. <br><br>  Despu√©s de eso, generan otro n√∫mero de 8 bytes para crear una clave secundaria a partir del primer n√∫mero de 8 bytes, le agregan un valor arbitrario desde el archivo de configuraci√≥n INI y obtienen una clave terciaria, que tambi√©n es un n√∫mero de 8 bytes.  Finalmente, utilizan una funci√≥n matem√°tica de precisi√≥n arbitraria para convertir una clave de 8 bytes en una de 32 bytes. <br><br>  Despu√©s de eso, cifran los datos robados, como la contrase√±a del usuario, utilizando la clave original de 16 bytes.  Pero no pasan este n√∫mero de "16" bytes a "su" atacante con los datos robados, porque enviar la clave junto con el mensaje cifrado no es una buena idea.  En cambio, el autor de Silent Banker coloca un n√∫mero de 32 bytes dentro de los datos robados y lo env√≠a al destinatario, quien deber√≠a tener un programa que convierta ese n√∫mero nuevamente a la clave original de 16 bytes.  Sin embargo, no tenemos este programa! <br><br>  La siguiente diapositiva muestra una receta sobre c√≥mo usar este desastre con el n√∫mero 1, la falta de un generador de PRNG, para su ventaja. <br><br><img src="https://habrastorage.org/webt/al/wp/lm/alwplmsbxy8ej3auux-aa0v6qbk.jpeg"><br><br>  Para empezar, equiparamos el valor de PRNG a cero.  Podemos automatizar los siguientes cuatro pasos utilizando un script de Python para el depurador, porque tenemos una f√≥rmula que calcula una clave de 16 bytes, una clave de 8 bytes, la siguiente clave de 8 bytes y una clave de 32 bytes.  Esta f√≥rmula no est√° en el c√≥digo C, pero la tenemos porque tenemos una copia del archivo binario Silent Banker en el que existe. <br><br>  Le mostrar√© una demostraci√≥n de c√≥mo funciona este script de Python.  Tenemos un buen escenario: aqu√≠ tengo Silent Banker y un depurador independiente al que estoy conectado, as√≠ como Internet Explorer, en el que se ejecuta Silent Banker.  Not√© cuatro caracter√≠sticas que generan claves de cifrado.  Incluyo este script de Python que se muestra en la diapositiva anterior, que invoco con el comando bang keygen.  Puede ver que el depurador simplemente "pierde" estas pocas funciones que quiero realizar para esta demostraci√≥n 5 veces.  Pero en la vida real, realizamos esta acci√≥n 5.000 veces para obtener un conjunto de claves m√°s grande. <br><br>  En el panel de registro, puede ver que para cada iteraci√≥n del bucle, se emite una clave primaria de 16 bytes, que luego se asocia con una clave de 32 bytes.  Al mismo tiempo que el script imprime informaci√≥n en el registro, tambi√©n se crea un archivo de texto en el disco, que incluye pares de claves relacionadas de 16 y 32 bytes.  Es solo un archivo HEX hexadecimal, por lo que podemos usar nuestro script Python para procesar este archivo, tambi√©n tenemos un directorio de registro que recuperamos del nodo robado de comando y control. <br><br><img src="https://habrastorage.org/webt/3l/s8/q5/3ls8q5neoqhw_1vzzbx9iadyvuy.jpeg"><br><br>  En la parte superior, ver√° varios certificados de claves privadas cifradas, y debajo de ellos hay varios archivos de texto que contienen datos cifrados.  Simplemente podemos ejecutar el programa y buscar dentro de estos archivos de texto extrayendo esta clave de 32 bytes y la clave original de 16 bytes asociada a ella. <br><br>  Tan pronto como el programa encuentra una clave de 16 bytes, descifra la informaci√≥n que contiene y la presenta en forma de archivo de texto.  Ver√° este archivo en la pantalla y es imposible leerlo. <br><br><img src="https://habrastorage.org/webt/_l/65/sk/_l65skt8szevodoual8wimixbhi.jpeg"><br><br>  Pero luego tenemos un mont√≥n de archivos temporales .tmp legibles, desde donde podemos obtener esta informaci√≥n y devolverla a los propietarios "leg√≠timos".  Silent Banker hizo todo el trabajo duro para proteger la informaci√≥n en vano porque olvidaron iniciar un generador de n√∫meros pseudoaleatorio. <br><br><img src="https://habrastorage.org/webt/bm/kj/qn/bmkjqnl8fuofa6yhjzjfhg2golq.jpeg"><br><br>  Ahora mostrar√© la mejor parte de lo anterior: esta es la funci√≥n Silent Banker, que llam√© Why_Not_Use_This (¬øPor qu√© no usarla?). <br><br><img src="https://habrastorage.org/webt/nz/yi/-l/nzyi-lwhkvyqil67khx6wt6zeiy.jpeg"><br><br>  De hecho, dentro de su propio programa, tienen la funci√≥n GetCursorPos (determinar la posici√≥n del cursor) para generar entrop√≠a, que se puede utilizar para iniciar PRNG, y podemos verificar si hay referencias cruzadas a esta funci√≥n dentro del programa. <br><br><img src="https://habrastorage.org/webt/eb/7z/pu/eb7zpunaanojkiys5gc6wx8cgvi.jpeg"><br><br>  Vemos que se usa en 10-15 otros lugares en el c√≥digo.  Por lo tanto, resulta que los autores de Silent Banker no olvidaron insertar un generador de n√∫meros pseudoaleatorios en el programa, simplemente olvidaron ejecutar esta funci√≥n en el proceso de cifrado utilizando el operador de llamada. <br><br><img src="https://habrastorage.org/webt/lp/_n/e-/lp_ne-pmgawe-72jw9_x0fvj6ym.jpeg"><br><br>  La siguiente diapositiva se llama "Eso se escap√≥ ..." y muestra c√≥mo funcionar√≠a este programa si el autor no hubiera olvidado nada. <br><br><img src="https://habrastorage.org/webt/x0/wn/kb/x0wnkb_6crrojmz0r7twgomdav0.jpeg"><br><br>  La siguiente historia, titulada "DES o no DES", trata sobre un autor de malware que ni siquiera sabe c√≥mo usar correctamente la interfaz de programaci√≥n de Windows o no sabe cu√°l es el tama√±o m√°ximo de la clave DES.  Como resultado, debido al tama√±o no v√°lido de esta clave, su troyano se usa por defecto con el operador l√≥gico xor. <br><br>  Entonces, para la funci√≥n de interfaz del programa CryptDeriveKey, los dos bytes bajos del par√°metro dwFlags, banderas que establecen c√≥mo se ver√° la URL resultante, determinan el tama√±o de su clave de cifrado. <br><br><img src="https://habrastorage.org/webt/2a/jt/-q/2ajt-qrub9dk2qkyhbea_panhly.jpeg"><br><br>  Entonces, si los bytes bajos son 0080, entonces la clave de cifrado que solicitamos ser√° una clave RC4 de 128 bits.  Es lo mismo que dispararte en el pie, y te mostrar√© por qu√©. <br><br><img src="https://habrastorage.org/webt/02/fm/ev/02fmevcyb9eos_-2a5qcpofweqq.jpeg"><br><br>  En la diapositiva, ver√° una l√≠nea con el tama√±o incorrecto de la clave dwFlags de 128 bits: 800000 y una l√≠nea con el valor incorrecto de MSCryptoAPI.  Te mostrar√© el desmontaje de esta cosa.  Ver√° una funci√≥n llamada "inicializaci√≥n del subsistema de cifrado": el troyano llama al contexto cifrado y luego crea un contenedor para el hash MD5, despu√©s de lo cual crea un hash MD5 de la contrase√±a codificada en el archivo binario e intenta usar la salida de esta funci√≥n hash para crear una clave DES de 128 bits.  Sin embargo, no se crea ninguna clave en este caso, porque no existe una clave DES de 128 bits. <br><br><img src="https://habrastorage.org/webt/cp/kv/os/cpkvosn5t2fsqsxbgd3kjdrb5-c.jpeg"><br><br>  Si alguna de estas funciones API falla, salta a este lugar, que marqu√© en amarillo, y muestra un mensaje de que no se puede recibir la clave.  Y este lugar est√° aqu√≠, donde mueve el valor que est√° en ebp y en ese momento es 0, es decir, directamente en este valor booleano bUseMSCryptoAPI. <br><br>  Veamos qu√© efecto causa esto durante la ejecuci√≥n del programa.  Seguiremos este elemento de la estructura del c√≥digo para ver d√≥nde m√°s se usa en el programa y cu√°n diferente se comporta esta exposici√≥n de troyanos cuando la funci√≥n es verdadera y cuando la herida es falsa. <br><br><img src="https://habrastorage.org/webt/-4/0d/m1/-40dm1wrxg7y9pjzfdyv5wp_ov8.jpeg"><br><br>  Vemos que el valor l√≥gico se verifica en la funci√≥n que llam√© cifrar datos, "cifrado de datos", y si es cierto, se trata de este bloque, donde se usan el cifrado DES y CryptEncrypt MSAPI. <br><br><img src="https://habrastorage.org/webt/bf/14/oz/bf14oz0sgb2bwpj9fkorcziwhhw.jpeg"><br><br>  Sin embargo, si este valor es 0, y como sabemos, siempre ser√° temprano cero, la funci√≥n va a este bloque, que por defecto es xor. <br><br><img src="https://habrastorage.org/webt/3i/y2/go/3iy2gollhuccdcjwuclgygehxsq.jpeg"><br><br>  Ten√≠a curiosidad sobre en qu√© momento el autor del programa malicioso decidi√≥ hacer una copia de seguridad de todo esto.  Tal vez la gente lo estaba empujando desde arriba, por lo que se vio obligado a deshacerse del malware, pero en el √∫ltimo minuto se dio cuenta de que su DES no funcionaba, por lo que us√≥ xor para la grabaci√≥n de respaldo.  En general, fue bastante divertido, ¬°as√≠ que la moraleja de esta historia es hacer siempre copias de seguridad! <br><br>  La siguiente historia se llama "¬øQu√© has hecho con qu√©?".  Trat√© de encontrar un t√©rmino que describiera c√≥mo funciona el cifrado del troyano Coreflood, y decid√≠ llamarlo "cifrado dependiente de la ubicaci√≥n".  En resumen, los autores de este troyano inventaron un nuevo m√©todo de cifrado.  Pens√©, ¬øtal vez alguien ya escribi√≥ un art√≠culo sobre esto y deber√≠a ser "google"?  Google me dio un enlace a un sitio de patentes de los EE. UU. Donde alguien present√≥ una patente por "encriptaci√≥n dependiente de la ubicaci√≥n".  Este esquema es bastante confuso, por lo que tomar√° mucho tiempo estudiarlo.  As√≠ es como funciona: le estoy enviando un mensaje encriptado, y para descifrarlo y leerlo, debe tomar un dispositivo GPS e ir a un punto con la latitud y longitud indicadas por m√≠.  Por lo general, el cifrado es un compromiso entre la seguridad y la usabilidad, pero no hay uno ni el otro en este m√©todo. <br><br><img src="https://habrastorage.org/webt/ff/s5/bk/ffs5bkfdwagmbngmoms8efnmcje.jpeg"><br><br>  Esto definitivamente no es seguro y requiere que vayas a donde el remitente se√±ala para leer el mensaje.  Matt brome√≥ diciendo que si est√°s luchando en l√≠nea por correo electr√≥nico y realmente quieres deshacerte de alguien, env√≠ale un mensaje cifrado que pueda leer en alg√∫n lugar de Irak, y ya no tendr√°s problemas con √©l. <br><br>  ¬øC√≥mo se usa este m√©todo en el troyano Coreflood?  La diapositiva muestra un fragmento de c√≥digo del que se deduce que despu√©s de que el troyano ha robado la informaci√≥n del usuario, la cifra y la escribe en el disco para que el troyano pueda recibir esta informaci√≥n y cargar comandos y controles en su sitio web. <br><br>  Esta funci√≥n se llama SetFilePointer (establece el puntero del archivo) y su valor de retorno es dWord, que indica el desplazamiento en el archivo en el que se estableci√≥ el puntero si se super√≥.  Luego, la funci√≥n toma el n√∫mero de bytes para encriptar nNumberOfBitesToWrite y lo mueve al registro ecx.  Luego toma el puntero de datos para el cifrado y lo mueve al registro edx. <br><br><img src="https://habrastorage.org/webt/rg/lp/tu/rglptunvnn4tddlxgtivifxdg6w.jpeg"><br><br>  Despu√©s de eso, se utiliza el operador xor, que coloca cada byte en el b√∫fer al y ah, lo que significa bytes de nivel bajo y alto devueltos por SetFilePointer.  Por lo tanto, la clave de cifrado en este esquema es el desplazamiento en el archivo en el que existen los datos.  ¬°Esto es simplemente asombroso! <br><br>  La siguiente diapositiva se llama "C√≥mo restablecer un volcado de memoria".  Representa el programa dumpCore que acabo de escribir, que acaba de salir.  Puede descargarlo, hay todo el c√≥digo fuente.  Este programa lo ayudar√° si la computadora est√° infectada con el virus Coreflood, que por alguna raz√≥n no pudo acceder al servidor de comando y control para descargar los datos robados.  Por lo tanto, puede obtener estos archivos que guard√≥ en el disco y descifrarlos utilizando mi programa para averiguar qu√© le fue robado, por ejemplo, si necesita informar al cliente al respecto. <br><br>  Los registros de los datos robados est√°n rodeados en rojo en la diapositiva. <br><br><img src="https://habrastorage.org/webt/xb/ib/c6/xbibc6gjkihoami36sqhcopedky.jpeg"><br><br>  Lo que sigue siendo interesante en Coreflood: aunque tiene un algoritmo de cifrado bastante d√©bil, todav√≠a trata de transferir toda la informaci√≥n robada sobre la configuraci√≥n de la computadora de la v√≠ctima, toda la informaci√≥n objetivo de los bancos y cooperativas de cr√©dito, y as√≠ sucesivamente.  Entonces, otra forma de eliminar un volcado de n√∫cleo se llama "C√≥mo eliminar un volcado de n√∫cleo utilizando Wireshark".  Wireshark es un programa que analiza el tr√°fico de red Ethernet o el flujo de datos TCP. <br><br><img src="https://habrastorage.org/webt/ii/9h/4d/ii9h4d6emu0hiquq3xs1hxab78i.jpeg"><br><br>  La siguiente diapositiva muestra c√≥mo funciona Coreflood.  Estos son archivos DLL que se ingresan en Explorer e Internet Explorer.  Modifican el registro, requieren un reinicio de la aplicaci√≥n, pero no requieren un reinicio del sistema.  Hay varias formas de inyectar estos dlls en un proceso. <br><br><img src="https://habrastorage.org/webt/ak/gk/hb/akgkhblgwmnu5tq_l2fcg7wrags.jpeg"><br><br>  Importante para los piratas inform√°ticos que desean invadir el virus sin darse cuenta es c√≥mo ingresa el virus en la computadora del usuario: requiere un reinicio del sistema para que el malware tenga efecto, o es suficiente para que el usuario simplemente reinicie la aplicaci√≥n, en este caso Explorer. <br><br>  ¬°Y ahora est√° tranquilo para que nadie pueda escuchar! <br><br><img src="https://habrastorage.org/webt/yk/-q/97/yk-q97lw3wqjqp741oiik2yxudu.jpeg"><br><br>  Este es el c√≥digo que reconstruimos utilizando ingenier√≠a inversa.  Esto muestra c√≥mo Coreflood cierra manualmente Explorer para que los cambios surtan efecto de inmediato.  Probablemente est√© familiarizado con lo que sucede cuando el Explorer falla en la computadora: la barra de tareas desaparece, las ventanas de todas las aplicaciones abiertas, todos los √≠conos en el escritorio desaparecen, y luego, uno por uno, comienzan a regresar a su lugar. <br><br>  Los autores de Coreflood obviamente sab√≠an sobre esto, por lo que colocaron una llamada al sistema en este lugar para establecer el modo de error "correcto" del conductor justo antes de la llamada de OpenProcess. <br><br>  ¬øQu√© hace la funci√≥n SetErrorMode?  Evita una falla espec√≠fica de las notificaciones enviadas al sistema que crean una peque√±a ventana emergente y env√≠an un mensaje de error que llev√≥ a la finalizaci√≥n de la aplicaci√≥n.  Todo lo que hicieron con este mensaje de error fue evitar que una ventana emergente apareciera ante el usuario antes de que Explorer fallara.  D√≠game qu√© le parece m√°s sospechoso al usuario: una peque√±a ventana emergente acompa√±ada por la desaparici√≥n de todo lo que aparece en la pantalla y luego reaparece, o la desaparici√≥n y aparici√≥n de todo sin ning√∫n mensaje de error.  Escuch√© que dijiste: "ambos eventos". <br><br>  La siguiente diapositiva la llam√© "Con brazos y piernas, pero sin cabeza".  Coreflood, cuando se carga como un dll, no aparece en la lista de m√≥dulos cargados.  √âl asigna un poco de memoria en el mont√≥n y se copia a s√≠ mismo en este lugar del mont√≥n; lo puse en un marco rojo. <br><br><img src="https://habrastorage.org/webt/ns/zf/em/nszfemfch9kulz_ualmhjd-5cf4.jpeg"><br><br>  Luego elimina su encabezado PE, por lo que si se encuentra con una computadora infectada con este troyano, diga: "mi pr√≥ximo paso deber√≠a ser volcar este archivo ejecutable y subirlo a la IDA para su an√°lisis", pero es muy dif√≠cil volcar el archivo ejecutable, si no hay su encabezado PE.  Entonces, cuando Coreflood llama a aloc virtual, define el indicador de memoria de arriba a abajo, lo que hace que el sistema devuelva la direcci√≥n m√°s alta, no la m√°s baja, disponible.  Esto permite que el troyano oculte las comillas de apertura / cierre en un √°rea de memoria m√°s alta del modo de usuario entre otros dlls del sistema.  Por lo tanto, la pr√≥xima demostraci√≥n que llam√© "C√≥mo inutilizar todo lo que est√° oculto". <br><br><img src="https://habrastorage.org/webt/wz/h8/1u/wzh81uifnp2xp6vl-xak505logk.jpeg"><br><br>  Cuando te encuentras con algo como Coreflood que usa sigilo, y no hay herramientas listas para trabajar con tales virus, debes crear el tuyo propio. <br>  Si est√° familiarizado con el desempaquetado, usar un depurador es com√∫n para usted.  Especialmente si no hay un desempacador autom√°tico, ya que este no es un algoritmo com√∫n.  En este caso, puede usar el depurador para ir al punto de entrada original y luego eliminar el volcado del troyano usando ProcDump u otra utilidad.       PE     Import Reconstructor,  ,          ,     . <br><br>      ,    .           .       Volatility,       Internet Explorer  .    ,   Coreflood,       ,    .  ,      7FF81000. <br><br><img src="https://habrastorage.org/webt/-d/zw/9b/-dzw9b_qihk8hpoouzgomi3hv2c.jpeg"><br><br>       ,    HEX    ,     Coreflood.    ,      ,          .               . <br><br> ,     ,  Coreflood,       Volatility  .     ,     ID  Internet Explorer.     ,   ,   PID  1732.     Malfind,      ,      ,         ,   .          VAD  ,  ,     .    ,    . <br><br><img src="https://habrastorage.org/webt/aq/mg/_m/aqmg_mfa2sy70g_y-pk77lw-hek.jpeg"><br><br>   ,      ,      7FF81000. ,          Fix IAT,     PID 1732 Internet Explorer      ,   Coreflood. <br><br>     dll,    Internet Explorer,             ,   RBA ,    ,   . <br><br>     ,       7FF81000,    ,        .  ,        PE .  ,        Import Reconstructor:   ,     ,   .     Fix IAT    ,        PE modify viewer   ,     . <br><br><img src="https://habrastorage.org/webt/yz/9w/no/yz9wno8uv0z5jpt5922gwrhvofw.jpeg"><br><br> 21:15 <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> DEFCON 17.    !</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  <b>Ap√≥yenos</b> haciendo un pedido o recomend√°ndolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un an√°logo √∫nico de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps hasta diciembre de forma gratuita</b> al pagar por un per√≠odo de seis meses, puede ordenar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Pa√≠ses Bajos y los EE. UU.</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es428858/">https://habr.com/ru/post/es428858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es428848/index.html">Notas del proveedor de IoT: ¬øc√≥mo crear una red LoRa en una ciudad sin red en un d√≠a?</a></li>
<li><a href="../es428850/index.html">Gesti√≥n del desarrollo en un gran proyecto.</a></li>
<li><a href="../es428852/index.html">Transmisi√≥n abierta de la sala principal HighLoad ++ 2018</a></li>
<li><a href="../es428854/index.html">C√≥mo cortar la luz en un peque√±o centro de datos: una forma econ√≥mica de implementar emergencias</a></li>
<li><a href="../es428856/index.html">Un truco maravilloso para hacer que el responsable del proyecto de c√≥digo abierto al d√≠a</a></li>
<li><a href="../es428860/index.html">Conferencia DEFCON 17. ¬°R√≠ete de tus virus! Parte 2</a></li>
<li><a href="../es428864/index.html">Hagamos que la web sea grandiosa nuevamente</a></li>
<li><a href="../es428866/index.html">7 principios de dise√±o, actitud hacia las tendencias de dise√±o, cartera de dise√±adores UX, ...</a></li>
<li><a href="../es428868/index.html">JAR de lanzamiento m√∫ltiple: ¬ømalo o bueno?</a></li>
<li><a href="../es428870/index.html">Mrr: FRP total para reaccionar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>