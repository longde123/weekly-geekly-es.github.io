<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíí üåÆ üôèüèº Uma hist√≥ria de aut√≥psia: como revertemos o Hancitor üå† ü§≤üèæ üë©üèΩ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Para aqueles que j√° jogaram o suficiente com os quebra-cabe√ßas crackme , trouxemos um novo Trojan. Na natureza, o Hancitor downloader ainda √© encontra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uma hist√≥ria de aut√≥psia: como revertemos o Hancitor</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/418185/"><img src="https://habrastorage.org/webt/dn/-j/1o/dn-j1ohonpxz_urf0totdzgdxa4.jpeg"><br><br>  Para aqueles que j√° jogaram o suficiente com os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">quebra-cabe√ßas crackme</a> , trouxemos um novo Trojan.  Na natureza, o Hancitor downloader ainda √© encontrado em seu habitat natural - correspond√™ncias de spam.  Atualmente, ele √© usado ativamente para baixar o trojan Panda banking, que √© uma modifica√ß√£o do not√≥rio Zeus. <br><br>  Numa noite fria de ver√£o, o encontramos cara a cara, olhando para o spam de e-mail.  Se voc√™ gosta de assistir ao que o malware tem por tr√°s, leia nossa nova an√°lise inversa. <br><a name="habracut"></a><br>  Nosso documento malicioso √© assim: <br><br><img src="https://habrastorage.org/webt/am/z_/bu/amz_buin-rjqprnnk-v2xuaio28.png"><br><br>  Por padr√£o, as macros est√£o bloqueadas, ent√£o o sistema avisa: "As macros foram desativadas".  No entanto, o conte√∫do da mensagem diz que as macros devem ser inclu√≠das.  Bem, vamos l√°.  Depois de clicar no bot√£o Ativar conte√∫do, o computador est√° infectado.  Agora vamos ver que tipo de macro √© executada e como exatamente a infec√ß√£o ocorre.  Isso pode ser feito imediatamente no Word, indo para a guia Exibir-&gt; Vacros \ Exibir macros. <br><br><img src="https://habrastorage.org/webt/ly/uq/kd/lyuqkdosmy1commpds7-nu96gsa.png"><br><br>  Voc√™ pode fazer de forma mais profissional - use o olevba do pacote oletools.  Voc√™ pode instalar o pacote l√° no link.  Em seguida, digite olevba doc_file ‚Äìc ‚Äìdecode&gt; source.txt e obtenha a fonte da macro. <br><br><img src="https://habrastorage.org/webt/tc/tk/gp/tctkgps17vavk9-zgtmzyjgparw.png"><br><br>  Pelo c√≥digo, quero dizer imediatamente que o Trojan pertence √† classe de downloaders.  O script apenas esvazia de algum lugar para os Malwara.  Para provar isso, vamos decodificar cadeias base64.  √â mais conveniente fazer isso imediatamente atrav√©s do hiew, para n√£o copiar e colar centenas de vezes.  Para fazer isso, usamos um plug-in especial, descrito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Aqui est√° o que aconteceu: <br><br><img src="https://habrastorage.org/webt/az/tv/jo/aztvjo9bo-8zxu7vaus2mzxadcc.png"><br><br>  Este √© um script malicioso, dividido em duas partes e salvo como 1.hta.  Em princ√≠pio, n√£o estamos particularmente interessados ‚Äã‚Äãem como isso funciona.  √â tudo bastante comum.  O √∫nico ponto importante √© determinar a URL na qual o arquivo malicioso √© baixado.  Vamos tentar encontr√°-lo, pois essas informa√ß√µes podem ser √∫teis para a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">seguran√ßa</a> .  Eles podem adicionar regras de rede para bloquear solicita√ß√µes nesses URLs, o que pode salvar a empresa de infec√ß√µes. <br><br>  Ha!  N√£o h√° links.  Mas de onde vem o arquivo 6.exe, que inicia o 1.hta?  √â hora de dar uma olhada novamente no nosso arquivo dock no hiew, mas com mais cuidado: <br><br><img src="https://habrastorage.org/webt/b2/cc/y1/b2ccy1ewmolwz5wnaqojxdracbm.png"><br><br>  Sim, um exe-shnik est√° incorporado no documento de encaixe.  Sim, e fortemente embalado.  Vamos explicar o que est√° acontecendo.  A macro solta o script 1.hta malicioso na pasta Temp e o inicia, e o 1.hta, por sua vez, inicia o 6.exe em seu diret√≥rio.  √â claro que o 6.exe √© o mesmo pacote PE-shnik que vemos na tela.  Mas agora estamos nos perguntando como o 6.exe cai em% temp%.  E isso acontece por causa de um recurso interessante no pacote Microsoft Office.  O fato √© que, em qualquer documento OLE, qualquer outro arquivo no formato Ole10Native pode ser incorporado. <br><br>  Se for esse o caso, na inicializa√ß√£o, o pr√≥prio MS-Office descarta o arquivo criado dessa maneira na pasta% temp% com o nome especificado no cabe√ßalho da estrutura Ole10Native.  Vamos dar uma olhada neste objeto.  Fomos ajudados pelo plugin ao gerenciador de FAR - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OLE2Viewer</a> .  Abrimos nosso documento malicioso no plug-in, acesse o diret√≥rio ObjectPool \ _1593522492 e veja o seguinte: <br><br><img src="https://habrastorage.org/webt/cc/wn/mx/ccwnmx32xpqyiizulnovkdnrkla.png"><br><br>  Copie este arquivo (Ole10Native) e abra em hiew. <br><br><img src="https://habrastorage.org/webt/vr/xb/37/vrxb37l9_urz13rlu0jvxphqpus.png"><br><br>  Aqui, vemos sob que nome nosso objeto OLE - 5c.pif ser√° solto na pasta% temp%.  Agora, de volta √† nossa macro.  Sua tarefa √© lan√ßar um exe-shnik b√™bado. <br><br><img src="https://habrastorage.org/webt/lo/wk/li/lowkli2uxojiyiq0gsoq6iuxh7e.png"><br><br>  De fato, para ser mais preciso, a macro nem sempre inicia o arquivo descartado atrav√©s do 1.hta, mas tamb√©m √© assim: Shell ‚Äúcmd.exe / c executa ping localhost -n 100 &amp;&amp;‚Äù &amp; Environ (‚ÄúTemp‚Äù) &amp; "\ 6 .pif ", vbHide <br><br><img src="https://habrastorage.org/webt/ut/8p/va/ut8pvaykzvbydqbqdfw3wuapvyy.png"><br><br>  O m√©todo de inicializa√ß√£o, como vemos, depende da presen√ßa dos seguintes processos no sistema: bdagent.exe e PSUAMain.exe.  Por que, ent√£o, voc√™ precisa executar ping localhost -n 100?  E esse √© um truque grego antigo para criar um atraso artificial, apenas por precau√ß√£o.  Geralmente, suas varia√ß√µes s√£o usadas para remo√ß√£o autom√°tica. <br><br>  Nesta fase, examinamos a opera√ß√£o de um documento malicioso.  Ficou claro para n√≥s que o documento em si n√£o pertence a malware do tipo Trojan-Downloader, como parecia √† primeira vista, mas √© adequado para o tipo Trojan-Dropper.  Aqui est√° o que aconteceu na inicializa√ß√£o: <br><br><img src="https://habrastorage.org/webt/rd/qp/ki/rdqpkibxofr7rfrqloll1p_xf_q.png"><br><br>  Agora resta desmontar a carga √∫til.  J√° percebemos que nosso cavalo de Troia est√° empacotado, por isso devemos desempacot√°-lo primeiro.  Geralmente esse processo √© dividido em duas etapas: <br>  1. Removendo o dump descompactado + restaurando a tabela de importa√ß√£o. <br>  2. An√°lise e purifica√ß√£o de vari√°veis ‚Äã‚Äãglobais. <br><br>  Precisamos do segundo est√°gio, porque existem muitas fun√ß√µes da API que, como resultado de seu trabalho, retornam valores n√£o repetitivos para n√≥s.  Por exemplo, o CreatHeap retornar√° um descritor de heap para n√≥s, que ser√° usado posteriormente para o trabalho.  Muitas vezes, h√° verifica√ß√µes de tipo no c√≥digo: <i>se o descritor de heap == 0, obtenha o descritor de heap, caso contr√°rio, use um j√° inicializado</i> .  Por√©m, no momento do despejo, a vari√°vel que continha o descritor fornecido j√° havia sido inicializada por ele e naquele momento o descritor era v√°lido.  Quando tentamos iniciar o despejo, a vari√°vel com nosso descritor conter√° o valor antigo, ou seja, n√£o √© igual a 0, o que significa que o teste ser√° aprovado. <br><br>  Depois disso, assim que o programa tentar usar esse descritor, o sistema operacional lan√ßar√° uma exce√ß√£o e o programa falhar√° com um erro.  Portanto, para evitar isso, voc√™ precisa zerar essas vari√°veis.  Eles geralmente est√£o localizados em uma se√ß√£o grav√°vel dos dados.  Provavelmente, voc√™ sugere abrir esta se√ß√£o no editor hexadecimal e sobrescrever tudo com zeros?  Voc√™ est√° parcialmente certo, mas n√£o deve tomar a√ß√µes precipitadas.  Existem trojans que verificam vari√°veis ‚Äã‚Äãn√£o em 0, mas em um DWORD aleat√≥rio.  E, dependendo se o teste est√° sendo testado ou n√£o, v√°rias a√ß√µes s√£o tomadas.  Voc√™ n√£o precisa ir longe para obter exemplos.  Basta olhar para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cridex</a> (recentemente desapareceu em algum lugar dos radares, aparentemente foi completamente atualizado para o EMOTETA). <br><br>  Ent√£o, vamos executar nossa amostra (em uma m√°quina virtual, √© claro).  Tamb√©m √© desej√°vel que o tr√°fego que sair√° da m√°quina virtual passe por uma VPN. <br><br>  Lan√ßamos nosso Trojan, e ele simplesmente trava no processo.  √ìtimo!  Normalmente, os cavalos de Troia fazem as coisas rapidamente e, em seguida, terminam imediatamente e se auto-destr√≥em.  Portanto, voc√™ precisa procurar lugares no c√≥digo respons√°vel por essas a√ß√µes, colocar uma pausa neles e depois despejar.  No nosso caso, podemos fazer assim. <br><br>  Para o dump, usamos o maravilhoso utilit√°rio - Process Dump, que pode ser encontrado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Esse utilit√°rio n√£o apenas encontra todos os m√≥dulos execut√°veis ‚Äã‚Äãocultos e os despeja, mas tamb√©m restaura a pr√≥pria tabela de importa√ß√£o.  O utilit√°rio deve ser executado como administrador da seguinte maneira: pd / pid xxxx, em que xxxx √© o ID do processo de Trojan.  Depois disso, o utilit√°rio far√° o dump de todos os m√≥dulos do processo.  Removemos os extras e √© isso que resta: <br><br><img src="https://habrastorage.org/webt/tg/je/db/tgjedb068z9unx10xyhit2dftii.png"><br><br>  O nome do arquivo execut√°vel do processo Trojan √© 1.exe.  Acontece que o cavalo de Troia descompactado estava localizado em 0x2C0000.  Abra-o no hiew: <br><br><img src="https://habrastorage.org/webt/84/je/fc/84jefcffxabgt-pihoargfo-raa.png"><br><br>  Apenas um olho feliz!  Agora o arquivo est√° descompactado, est√° claramente vis√≠vel.  A tabela de importa√ß√£o tamb√©m foi reconhecida.  Vamos abri-lo no IDA-PRO. <br><br><img src="https://habrastorage.org/webt/fn/hd/nc/fnhdncwcqiqd7jx_f7m8czjyf3m.png"><br><br>  N√≥s j√° renomeamos algumas fun√ß√µes enquanto classificamos a amostra.  A primeira coisa que o Trojan come√ßa √© determinar o endere√ßo de carregamento do seu m√≥dulo.  E realmente: como ele sabia em que endere√ßo seu esbo√ßo foi descompactado?  Isso √© feito com uma antiga t√©cnica comprovada - inverter uma p√°gina de mem√≥ria em 0x1000 em rela√ß√£o ao endere√ßo atual at√© encontrarmos os bytes "MZ".  Isso funciona porque os m√≥dulos execut√°veis ‚Äã‚Äãsempre carregam o sistema operacional em um endere√ßo m√∫ltiplo de 0x1000.  Confira voc√™ mesmo.  No nosso caso, um limite de 100 descargas √© definido. <br><br><img src="https://habrastorage.org/webt/7z/cy/5c/7zcy5cbgu4nls8b9yxz8gv9x3ai.png"><br><br>  Se algu√©m n√£o entender onde h√° uma invers√£o, aqui √© onde: <br>  resultado + = 0xFFFFF000 √© equivalente a resultado - = 0x1000. <br><br>  Depois de receber o endere√ßo de download do seu m√≥dulo, o trojan descompactado recebe os endere√ßos das fun√ß√µes necess√°rias para sua opera√ß√£o.  Para come√ßar, os endere√ßos de duas fun√ß√µes s√£o pesquisados ‚Äã‚Äã- LoadLibraryA e GetProcAddress.  Conhecendo os endere√ßos dessas fun√ß√µes, voc√™ pode us√°-los para obter todo o resto.  Essas fun√ß√µes est√£o na biblioteca kernel32.  Seu endere√ßo √© obtido atrav√©s da leitura do primeiro (zero - ntdll, primeira base do kernel, etc.) da lista de an√©is que descreve todos os m√≥dulos carregados na ordem de inicializa√ß√£o com a estrutura _LDR_DATA_TABLE_ENTRY.  O ponteiro para a lista √© puxado do PEB. <br><br><img src="https://habrastorage.org/webt/zx/o3/s3/zxo3s3kevu7prcaoffacdxvklow.png"><br><br>  Ap√≥s receber o endere√ßo kernel32.dll (a partir do Windows 7 - kernelBase.dll), o cavalo de Troia pode analisar manualmente sua tabela de exporta√ß√£o e encontrar as duas fun√ß√µes necess√°rias, que s√£o previs√≠veis na sub-rotina sub_EF1E60. <br><br><img src="https://habrastorage.org/webt/7k/xz/4v/7kxz4vk7-ad4q4d221g-ealmkko.png"><br><br>  Agora, d√™ uma olhada na fun√ß√£o que chamamos de getHeap. <br><br><img src="https://habrastorage.org/webt/qc/gv/oz/qcgvozmioggzgsidsap-5frkfas.png"><br><br>  Aqui estamos observando apenas a situa√ß√£o descrita acima.  No momento do despejo, a vari√°vel hHeap continha um valor de 600000h.  Portanto, GetProcessHeap n√£o ser√° chamado.  Em vez disso, o programa ir√° para o r√≥tulo loc_EF11DD, onde HeapAlloc √© chamado com um identificador inv√°lido, o que nos dar√° um erro.  Portanto, pegamos o editor hexadecimal e zeramos esse n√∫mero.  Contamos seis lugares semelhantes. <br><br>  Em seguida, a divers√£o come√ßa.  O cavalo de Troia gera um ID de "cliente" exclusivo com base no n√∫mero de s√©rie do disco r√≠gido e no endere√ßo MAC.  Informa√ß√µes recebidas aqui: <br><br><img src="https://habrastorage.org/webt/hx/fo/ce/hxfoceeap2k3oqut_yjgwqsjnwu.png"><br><br>  Tamb√©m temos o seguinte: endere√ßo IP, vers√£o do SO, nome da rede e nome de usu√°rio.  Com base nisso, uma solicita√ß√£o HTTP √© gerada no painel de administra√ß√£o, cujo endere√ßo ainda n√£o sabemos.  N√£o est√° nas linhas (mesmo na forma descompactada).  Mas n√£o est√° l√°, porque est√° criptografado na configura√ß√£o.  Seu endere√ßo pode ser extra√≠do do c√≥digo: <br><br><img src="https://habrastorage.org/webt/vw/9n/ej/vw9nej-cbxk5jgjljgjgasiwikw.png"><br><br>  A configura√ß√£o pesa 0x2008 bytes e tem o seguinte formato: os primeiros 8 bytes s√£o a chave RC4, 0x2000 bytes s√£o os dados criptografados. <br><br><img src="https://habrastorage.org/webt/tf/ne/je/tfneje_zc_aeq5nzmnzmkfd5r6c.png"><br><br>  O fato de o algoritmo de criptografia RC4 ser usado fica claro na lista a seguir: <br><br><img src="https://habrastorage.org/webt/4g/jc/ci/4gjccirc5sxslir_xgfoiytzjhc.png"><br><br>  Observe que os primeiros 8 bytes por si s√≥ n√£o s√£o a chave para o RC4.  A chave √© o hash SHA1 desses bytes.  Voc√™ tamb√©m precisa prestar aten√ß√£o ao sinalizador 0x280011 para a fun√ß√£o CryptDeriveKey.  O MSDN tem uma isen√ß√£o de responsabilidade em rela√ß√£o a este sinalizador: <br><br><img src="https://habrastorage.org/webt/_t/2m/lu/_t2mlufhbsvpfivk9knvzdnoas0.png"><br><br>  A partir disso, fica claro que os 16 bits mais altos desse sinalizador definem o tamanho da chave em bits.  Ou seja, em bytes, o tamanho da chave √©: (0x280011 &gt;&gt; 16) / 8 = 5. Portanto, a chave ser√° os primeiros cinco bytes do hash dos oito primeiros bytes da configura√ß√£o.  Vamos despejar a configura√ß√£o e escrever um script python que ir√° descriptograf√°-lo para n√≥s.  O script fica assim: <br><br><img src="https://habrastorage.org/webt/fo/ow/7t/foow7ta0eo02epz-qp8vtkiozfy.png"><br><br>  O resultado de seu trabalho foi o arquivo config.rc4.  Abra-o no hiew: <br><br><img src="https://habrastorage.org/webt/rc/tz/dj/rctzdjyqwmh4ysz7pt7lhahlpna.png"><br><br>  Vemos uma lista descriptografada de √°reas administrativas.  A primeira palavra √© "19nep07" - n√∫mero da compila√ß√£o.  16 bytes s√£o alocados para ele.  A seguir, √© apresentada uma lista de URLs de administrador separados por "|". <br><br>  Portanto, a primeira chamada para o painel de administra√ß√£o ter√° este formato: <br>  GUID = 3068075364164635648 &amp; BUILD = 19nep07 &amp; INFO = WIN-56G04BL06SL @ WIN -56G04BL06SL \ Reverse &amp; IP = 35.0.127.52 &amp; TYPE = 1 &amp; WIN = 6.1 (x32 <br><br><img src="https://habrastorage.org/webt/1e/5o/bg/1e5obgayvnhe8mlproaehfms000.png"><br><br>  Em seguida, a solicita√ß√£o gerada √© enviada primeiro na lista do painel do administrador. <br><br><img src="https://habrastorage.org/webt/ou/u8/ue/ouu8ueyhzcz_3hh2zbkmdh_hqvw.png"><br><br>  Em seguida, a resposta do administrador √© lida, √© claro, se ainda estiver viva.  A resposta deve ser codificada em base64.  Se n√£o for esse o caso, o pr√≥ximo administrador da lista ser√° escolhido.  √Äs vezes, os administradores ao vivo retornam uma resposta estranha: <br><br><img src="https://habrastorage.org/webt/lu/d_/uo/lud_uoa61fkscmma-05nbxlkoic.png"><br><br>  √â familiar, n√£o √©?  Sim, esses s√£o os mesmos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√∫meros</a> !  De fato, um autor sabe por que o administrador come√ßa a devolv√™-los!  Na forma normal, o comando retorna.  Infelizmente, √© imposs√≠vel dizer com total certeza qual ser√° o formato da resposta, j√° que n√£o h√° tr√°fego, todos os administradores est√£o mortos.  O arquivo decodificado tamb√©m √© decodificado para 0x7A: <br><br><img src="https://habrastorage.org/webt/f0/sc/8k/f0sc8kchkod-u2luugrrlty75t8.png"><br><br>  A resposta deve conter um comando.  Caso contr√°rio, h√° um apelo ao pr√≥ximo painel de administra√ß√£o.  O c√≥digo de comando √© codificado como "x:", em que x √© a letra que codifica um comando espec√≠fico.  Existem 7 deles: 'r', 'l', 'e', ‚Äã‚Äã'b', 'd', 'c', 'n'.  Considere os comandos "b" e "r". <br><br>  Os manipuladores desses comandos t√™m a mesma fun√ß√£o.  N√≥s o nomeamos como GetExe.  Aqui est√° o que parece: <br><br><img src="https://habrastorage.org/webt/_a/rz/lk/_arzlkrepv0wjyhlt0k4krtjtv8.png"><br><br>  Eu acho que tudo est√° claro aqui.  O trojan faz uma solicita√ß√£o http e o arquivo execut√°vel √© retornado em resposta em um formato compactado, que √© descompactado.  Ent√£o varia√ß√µes s√£o poss√≠veis.  No caso do comando "b", ocorrem as tr√™s a√ß√µes a seguir: <br><br>  <b>1. Cria√ß√£o do processo svchost na forma congelada</b> <br><br><img src="https://habrastorage.org/webt/lz/yw/cy/lzywcy3d56o5tmkxdz8yu5ttvp4.png"><br><br>  <b>2. Inje√ß√£o no espa√ßo de endere√ßo do processo do m√≥dulo baixado</b> <br><br><img src="https://habrastorage.org/webt/7b/ab/fe/7babfemu0nyrag5bv6jtadst3o8.png"><br><br>  <b>3. Controle a transfer√™ncia para o m√≥dulo injetado</b> <br><br><img src="https://habrastorage.org/webt/xj/m4/i5/xjm4i5ch6cpnogd79cz47tn1pny.png"><br><br>  No caso do comando r, ocorrem as tr√™s a√ß√µes a seguir: <br>  1. Baixando o arquivo execut√°vel chamando a fun√ß√£o GetExe. <br>  2. Salvar o arquivo baixado em uma pasta tempor√°ria com um nome aleat√≥rio. <br>  3. Inicie um arquivo descartado. <br><br><img src="https://habrastorage.org/webt/qk/go/sj/qkgosjsrb_45ny1kkfi7cguuvbm.png"><br><br>  Conclu√≠do <br><br>  PS Da pr√≥xima vez, podemos analisar o Panda ou algum criptografador.  Escreva nos coment√°rios em qual malware voc√™ est√° mais interessado (para fins de pesquisa, √© claro). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418185/">https://habr.com/ru/post/pt418185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418169/index.html">O que h√° de novo na atualiza√ß√£o 1 do Veeam Availability Console 2.0?</a></li>
<li><a href="../pt418171/index.html">Em que m√©tricas confiar se os usu√°rios realizarem poucas convers√µes no site?</a></li>
<li><a href="../pt418173/index.html">Ida e volta para redes neurais ou uma revis√£o do uso de codificadores autom√°ticos na an√°lise de texto</a></li>
<li><a href="../pt418177/index.html">Edi√ß√£o de imagens .heic sem perda de cor</a></li>
<li><a href="../pt418183/index.html">Aplica√ß√£o da an√°lise de fala nos neg√≥cios</a></li>
<li><a href="../pt418187/index.html">Na Am√©rica, eles sugeriram a substitui√ß√£o de todas as bibliotecas pelos hubs da Amazon. O p√∫blico est√° indignado</a></li>
<li><a href="../pt418189/index.html">Herdeiro de Zeus: por que o Trojan IcedID √© perigoso para clientes de bancos</a></li>
<li><a href="../pt418191/index.html">An√°logos em Python e JavaScript. Parte tr√™s</a></li>
<li><a href="../pt418193/index.html">Como √© criar um jogo para o Game Boy em 2017</a></li>
<li><a href="../pt418195/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 4: ‚ÄúCompartilhando Privil√©gios‚Äù, Parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>