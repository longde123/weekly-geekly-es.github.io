<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎨 🏟️ 💡 Systèmes d'analyse de serveur 🚣🏾 👩🏾 🎁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il s'agit de la deuxième partie d'une série d'articles sur les systèmes analytiques ( lien vers la partie 1 ). 



 Aujourd'hui, il ne fait aucun dout...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Systèmes d'analyse de serveur</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444254/"> Il s'agit de la deuxième partie d'une série d'articles sur les systèmes analytiques ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lien vers la partie 1</a> ). <br><br><img src="https://habrastorage.org/webt/bn/xe/4l/bnxe4lnwruhoopwd582keuoybrc.png" alt="image"><br><br>  Aujourd'hui, il ne fait aucun doute qu'un traitement précis des données et une interprétation des résultats peuvent aider presque tous les types d'entreprises.  À cet égard, les systèmes analytiques sont de plus en plus chargés de paramètres, le nombre de déclencheurs et d'événements utilisateur dans les applications augmente. <br><br>  Pour cette raison, les entreprises fournissent de plus en plus à leurs analystes des informations «brutes» pour analyse et en font les bonnes décisions.  L'importance d'un système d'analyse pour une entreprise ne doit pas être sous-estimée, et le système lui-même doit être fiable et durable. <br><a name="habracut"></a><br><h2>  Analyse client </h2><br>  L'analyse client est un service qu'une entreprise connecte à son site Web ou à son application via le SDK officiel, l'intègre dans sa propre base de code et sélectionne les déclencheurs d'événements.  Cette approche présente un inconvénient évident: toutes les données collectées ne peuvent pas être entièrement traitées comme vous le souhaitez, en raison des limites de tout service sélectionné.  Par exemple, dans un système, il ne sera pas facile d'exécuter des tâches MapReduce, dans un autre, vous ne pourrez pas exécuter votre modèle.  Un autre inconvénient sera une facture de services régulière (impressionnante). <br>  Il existe de nombreuses solutions d'analyse client sur le marché, mais tôt ou tard, les analystes sont confrontés au fait qu'il n'y a pas de service universel adapté à chaque tâche (alors que les prix de tous ces services sont en constante augmentation).  Dans cette situation, les entreprises décident souvent de créer leur propre système d'analyse avec tous les paramètres et fonctionnalités personnalisés nécessaires. <br><br><h2>  Analyse du serveur </h2><br>  L'analyse de serveur est un service qui peut être déployé en interne dans une entreprise sur ses propres serveurs et (généralement) par ses propres efforts.  Dans ce modèle, tous les événements utilisateur sont stockés sur des serveurs internes, ce qui permet aux développeurs d'essayer différentes bases de données pour le stockage et de choisir l'architecture la plus pratique.  Et même si vous souhaitez toujours utiliser des analyses client tierces pour certaines tâches, cela sera toujours possible. <br>  L'analyse du serveur peut être déployée de deux manières.  Tout d'abord: sélectionnez des utilitaires open source, déployez-les sur vos machines et développez la logique métier. <br><br><table><tbody><tr><td>  <b>Avantages</b> </td><td>  <b>Inconvénients</b> </td></tr><tr><td>  Vous pouvez personnaliser n'importe quoi </td><td>  Souvent, c'est très difficile et des développeurs individuels sont nécessaires </td></tr></tbody></table><br>  Deuxièmement: prenez les services SaaS (Amazon, Google, Azure) au lieu de le déployer vous-même.  À propos du SaaS plus en détail, nous le dirons dans la troisième partie. <br><br><table><tbody><tr><td>  <b>Avantages</b> </td><td>  <b>Inconvénients</b> </td></tr><tr><td>  Il peut être moins cher sur des volumes moyens, mais avec une croissance importante, il deviendra toujours trop cher </td><td>  Impossible de contrôler tous les paramètres </td></tr><tr><td>  L'administration est entièrement transférée aux épaules du prestataire de services </td><td>  On ne sait pas toujours ce qui se trouve à l'intérieur du service (il peut ne pas être nécessaire) </td></tr></tbody></table><br><h2>  Comment collecter des analyses de serveur </h2><br>  Si nous voulons éviter d'utiliser l'analyse client et assembler la nôtre, nous devons tout d'abord réfléchir à l'architecture du nouveau système.  Ci-dessous, je vais vous dire étape par étape ce qu'il faut considérer, pourquoi chacune des étapes est nécessaire et quels outils vous pouvez utiliser. <br><br><h3>  1. Acquisition de données </h3><br>  Tout comme dans le cas de l'analyse client, tout d'abord, les analystes de l'entreprise choisissent les types d'événements qu'ils souhaitent étudier à l'avenir et les rassemblent dans une liste.  Habituellement, ces événements se déroulent dans un certain ordre, appelé «modèle d'événement». <br><br>  Imaginez ensuite qu'une application mobile (site Web) a des utilisateurs réguliers (appareils) et de nombreux serveurs.  Pour transférer en toute sécurité des événements des appareils vers les serveurs, une couche intermédiaire est nécessaire.  Selon l'architecture, plusieurs files d'attente d'événements différentes peuvent se produire. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apache Kafka</a> est une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">file d'attente pub / sub</a> qui est utilisée comme file d'attente pour la collecte d'événements. <br><blockquote>  Selon un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article sur Kvor</a> en 2014, le créateur d'Apache Kafka a décidé de nommer le logiciel d'après Franz Kafka parce que "c'est un système optimisé pour l'enregistrement" et parce qu'il aimait les œuvres de Kafka.  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wikipédia</a> </blockquote><br>  Dans notre exemple, il existe de nombreux producteurs de données et leurs consommateurs (appareils et serveurs), et Kafka aide à les connecter les uns aux autres.  Les consommateurs seront décrits plus en détail dans les prochaines étapes, où ils seront les principaux acteurs.  Nous allons maintenant considérer uniquement les producteurs de données (événements). <br><br>  Kafka encapsule les concepts de file d'attente et de partition; plus précisément, il est préférable de le lire ailleurs (par exemple, dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> ).  Sans entrer dans les détails, imaginez qu'une application mobile soit lancée pour deux OS différents.  Ensuite, chaque version crée son propre flux d'événements distinct.  Les producteurs envoient des événements à Kafka, ils sont enregistrés dans une file d'attente appropriée. <br><img src="https://habrastorage.org/webt/79/bi/0o/79bi0ooejp8zfiw4siua1gkhagu.png" alt="Files d'attente à Kafka"><br>  (photo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d'ici</a> ) <br><br>  En même temps, Kafka vous permet de lire en morceaux et de traiter le flux d'événements avec des mini-chauves-souris.  Kafka est un outil très pratique qui s'adapte bien aux besoins croissants (par exemple, par géolocalisation d'événements). <br><br>  Habituellement, un fragment suffit, mais les choses deviennent plus difficiles en raison de la mise à l'échelle (comme toujours).  Personne ne voudra probablement utiliser un seul fragment physique en production, car l'architecture doit être tolérante aux pannes.  En plus de Kafka, il existe une autre solution bien connue - RabbitMQ.  Nous ne l'avons pas utilisé en production comme file d'attente pour l'analyse d'événements (si vous avez une telle expérience, parlez-nous-en dans les commentaires!).  Cependant, ils ont utilisé AWS Kinesis. <br><br>  Avant de passer à l'étape suivante, nous devons mentionner une autre couche supplémentaire du système - le stockage des journaux bruts.  Ce n'est pas une couche obligatoire, mais cela sera utile si quelque chose se passe mal et que les files d'attente d'événements dans Kafka sont réinitialisées.  Le stockage des journaux bruts ne nécessite pas de solution compliquée et coûteuse; vous pouvez simplement les enregistrer quelque part dans le bon ordre (même sur un disque dur). <br><img src="https://habrastorage.org/webt/yt/tn/we/yttnwe1yfgconmy3z4frdmnypmc.jpeg" alt="Les événements s'alignent"><br><h3>  2. Traitement des flux d'événements </h3><br>  Après avoir préparé tous les événements et les avoir placés dans des files d'attente appropriées, nous passons à l'étape de traitement.  Ici, je vais parler des deux options de traitement les plus courantes. <br><br>  La première option consiste à activer Spark Streaming sur un système Apache.  Tous les produits Apache vivent dans HDFS, un système de fichiers de réplique de fichiers sécurisé.  Spark Streaming est un outil facile à utiliser qui traite les données en streaming et évolue bien.  Cependant, cela peut être un peu difficile à entretenir. <br><br>  Une autre option consiste à créer votre propre gestionnaire d'événements.  Pour ce faire, par exemple, vous devez écrire une application Python, la construire dans le menu fixe et vous abonner à la file d'attente Kafka.  Lorsque les déclencheurs arrivent sur les gestionnaires du docker, le traitement démarre.  Avec cette méthode, vous devez continuer à exécuter des applications en permanence. <br><br>  Supposons que nous avons choisi l'une des options décrites ci-dessus et procédons au traitement lui-même.  Les processeurs doivent commencer par vérifier la validité des données, filtrer les ordures et les événements "cassés".  Pour la validation, nous utilisons généralement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cerberus</a> .  Après cela, vous pouvez faire un mappage de données: les données de différentes sources sont normalisées et normalisées pour être ajoutées à l'étiquette générale. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/os/iu/m8/osium8y24ypxtq-bk3oesiszhc4.jpeg" alt="Les événements arrivent au gestionnaire"></div><br><h3>  3. Base de données </h3><br>  La troisième étape consiste à maintenir les événements normalisés.  Lorsque vous travaillez avec un système analytique prêt à l'emploi, nous devrons souvent les contacter, il est donc important de choisir une base de données pratique. <br><br>  Si les données s'intègrent bien dans un schéma fixe, vous pouvez choisir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Clickhouse</a> ou une autre base de données de colonnes.  Les agrégations fonctionneront donc très rapidement.  L'inconvénient est que le schéma est fixé de manière rigide et que le pliage d'objets arbitraires sans raffinement échouera (par exemple, lorsqu'un événement non standard se produit).  Mais vous pouvez compter très rapidement. <br><br>  Pour les données non structurées, vous pouvez prendre NoSQL, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apache Cassandra</a> .  Il fonctionne sur HDFS, est bien répliqué, vous pouvez déclencher de nombreuses instances, tolérant aux pannes. <br><br>  Vous pouvez choisir quelque chose de plus simple, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MongoDB</a> .  C'est assez lent et pour de petits volumes.  Mais le plus, c'est qu'il est très simple et donc adapté au démarrage. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zc/z0/54/zcz054-gr2mczuf_dns72caehec.jpeg" alt="image"></div><br><h3>  4. Agrégations </h3><br>  Après avoir soigneusement sauvegardé tous les événements, nous voulons collecter toutes les informations importantes du lot qui est venu et mettre à jour la base de données.  À l'échelle mondiale, nous voulons obtenir des tableaux de bord et des mesures pertinents.  Par exemple, à partir d'événements pour collecter un profil utilisateur et mesurer en quelque sorte le comportement.  Les événements sont agrégés, collectés et enregistrés à nouveau (déjà dans les tables utilisateur).  Dans le même temps, vous pouvez créer le système de manière à connecter également un filtre à l'agrégateur-coordinateur: collecter les utilisateurs uniquement à partir d'un certain type d'événements. <br><br>  Après cela, si un membre de l'équipe n'a besoin que d'analyses de haut niveau, vous pouvez connecter des systèmes d'analyse externes.  Vous pouvez reprendre Mixpanel.  mais comme c'est assez cher, il n'y envoie pas tous les événements utilisateur, mais seulement ce qui est nécessaire.  Pour ce faire, vous devez créer un coordinateur qui transmettra certains événements bruts ou quelque chose que nous avons nous-mêmes agrégés précédemment à des systèmes externes, des API ou des plateformes publicitaires. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pj/fn/ck/pjfnckuoonpbyua_5d3qbhyegfa.jpeg" alt="image"></div><br><h3>  5. Frontend </h3><br>  Vous devez connecter le frontend au système créé.  Un bon exemple est le service de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">redash</a> , une interface graphique pour les bases de données qui aide à créer des panneaux.  Comment fonctionne l'interaction: <br><br><ol><li>  L'utilisateur fait une requête SQL. </li><li>  En réponse, reçoit une tablette. </li><li>  Pour elle, elle crée une «nouvelle visualisation» et obtient un bel horaire qui peut déjà être sauvegardé pour elle-même. </li></ol><br>  Les visualisations dans le service sont mises à jour automatiquement, vous pouvez configurer et suivre votre surveillance.  Redash est gratuit, en cas d'auto-hébergement, et comment le SaaS coûtera 50 $ par mois. <br><img src="https://habrastorage.org/webt/mn/tv/vb/mntvvbd4vacpm4r6qvujl6xwc8s.jpeg" alt="image"><br><h2>  Conclusion </h2><br>  Après avoir effectué toutes les étapes ci-dessus, vous allez créer votre analyse de serveur.  Veuillez noter que ce n'est pas un moyen aussi simple que de simplement connecter l'analyse client, car tout doit être configuré indépendamment.  Par conséquent, avant de créer votre propre système, il convient de comparer la nécessité d'un système d'analyse sérieux avec les ressources que vous êtes prêt à lui consacrer. <br>  Si vous avez tout calculé et que les coûts sont trop élevés, dans la partie suivante, je parlerai de la façon de créer une version moins chère de l'analyse de serveur. <br><br>  Merci d'avoir lu!  Je serai heureux de questions dans les commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr444254/">https://habr.com/ru/post/fr444254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr444244/index.html">Se déplacer dans l'espace et le temps</a></li>
<li><a href="../fr444246/index.html">Vérification de FreeRDP avec PVS-Studio</a></li>
<li><a href="../fr444248/index.html">Test sans tête dans un navigateur. Avantages et inconvénients</a></li>
<li><a href="../fr444250/index.html">Les gens ne sont-ils pas prêts pour le bitcoin ou le bitcoin pour une adoption massive?</a></li>
<li><a href="../fr444252/index.html">AMD annonce son architecture de puce 3D pour rattraper Intel Foveros 3D</a></li>
<li><a href="../fr444256/index.html">Mon premier lecteur Sharp PC3000</a></li>
<li><a href="../fr444260/index.html">Nous développons un système d'évaluation du travail des agents de soutien</a></li>
<li><a href="../fr444262/index.html">Code source Markdown2pdf pour Linux</a></li>
<li><a href="../fr444264/index.html">Comment devenir un committer et en avez-vous vraiment besoin?</a></li>
<li><a href="../fr444268/index.html">Semaine de sécurité 12: attaques au clavier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>