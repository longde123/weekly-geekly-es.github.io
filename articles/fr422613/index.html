<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîª üë®üèª‚Äçüíº üåí Le cyber groupe PowerPool a ma√Ætris√© la vuln√©rabilit√© du jour z√©ro dans l'appel de proc√©dure locale avanc√©e üê≤ üßëüèΩ‚Äçü§ù‚Äçüßëüèª üõ•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le 27 ao√ªt 2018, des informations sur la vuln√©rabilit√© zero-day ont √©t√© publi√©es sur Twitter par un sp√©cialiste de la s√©curit√© des informations sous l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Le cyber groupe PowerPool a ma√Ætris√© la vuln√©rabilit√© du jour z√©ro dans l'appel de proc√©dure locale avanc√©e</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/422613/"> Le 27 ao√ªt 2018, des informations sur la vuln√©rabilit√© zero-day ont √©t√© publi√©es sur Twitter par un sp√©cialiste de la s√©curit√© des informations sous le surnom SandboxEscaper.  La vuln√©rabilit√© affecte les versions de Microsoft Windows de 7 √† 10, plus pr√©cis√©ment, l'interface Advanced Local Procedure Call (ALPC) dans le Planificateur de t√¢ches Windows.  Il fournit Local Privilege Escalation, qui permet √† un attaquant d'augmenter les droits du code malveillant du niveau Utilisateur vers SYSTEM.  Nous ne parlons pas de divulgation coordonn√©e de la vuln√©rabilit√© - le compte SandboxEscaper a rapidement √©t√© supprim√©, il n'y a pas eu de correctifs de fermeture. <br><br>  Le lien du tweet a conduit au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©f√©rentiel GitHub</a> avec le code d'exploitation Proof-of-Concept - non seulement la version compil√©e, mais aussi le code source.  Par cons√©quent, n'importe qui peut modifier et recompiler l'exploit afin de l'am√©liorer, d'√©viter la d√©tection ou de l'inclure dans son propre code. <br><br>  En g√©n√©ral, il n'est pas surprenant que deux jours plus tard, l'exploit soit apparu dans la nature dans la campagne du cybergroupe PowerPool.  Selon la t√©l√©m√©trie ESET, les pays cibles des attaquants sont la Russie, l'Ukraine, la Pologne, l'Allemagne, le Royaume-Uni, les √âtats-Unis, l'Inde, les Philippines et le Chili.  Il y a relativement peu de victimes, ce qui peut indiquer une campagne tr√®s cibl√©e. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/j9/jp/mvj9jpgpgqtisu48y3jazkb72ms.jpeg"></div><br><a name="habracut"></a><br><h3>  Bo√Æte √† outils PowerPool </h3><br>  ESET a enregistr√© un nouveau groupe relativement r√©cemment, cependant, √† la disposition des pirates de PowerPool une gamme assez large d'outils.  Ensuite, nous examinons bri√®vement certains d'entre eux. <br><br><h4>  Exploit par √©l√©vation de privil√®ges locale dans ALPC </h4> <br>  Les d√©veloppeurs de PowerPool n'ont pas utilis√© le fichier binaire publi√© par SandboxEscaper - ils ont l√©g√®rement modifi√© le code source et l'ont recompil√©.  Cet exploit a √©galement √©t√© constat√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">par des chercheurs en s√©curit√©</a> et des √©quipes du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CERT</a> . <br><br><img src="https://habrastorage.org/webt/0q/a5/8a/0qa58aieslsijwatki-cc9wbvae.png"><br>  <i>Figure 1. Description de l'exploit du droit d'auteur</i> <br><br>  La violation se trouve dans la <code>SchRpcSetSecurity</code> API <code>SchRpcSetSecurity</code> , qui ne valide pas correctement les droits des utilisateurs.  Ainsi, l'utilisateur peut √©crire n'importe quel fichier dans <code>C:\Windows\Task</code> , quelles que soient les autorisations r√©elles - s'il existe une autorisation de lecture, il est possible de remplacer le contenu d'un fichier prot√©g√© en √©criture. <br><br>  Tout utilisateur peut √©crire des fichiers dans <code>C:\Windows\Task</code> , donc dans ce dossier, vous pouvez cr√©er un fichier qui est un lien dur vers n'importe quel fichier <i>cible</i> .  Ensuite, en appelant la fonction <code>SchRpcSetSecurity</code> , vous pouvez acc√©der √† l'acc√®s en √©criture √† ce fichier cible.  Pour fournir une √©l√©vation de privil√®ges locale, l'attaquant doit s√©lectionner le fichier cible qui sera √©cras√© - il est important que ce fichier soit ex√©cut√© automatiquement avec les droits d'administrateur.  Il peut √©galement s'agir d'un fichier syst√®me ou d'un utilitaire de mise √† jour de logiciels pr√©c√©demment install√©s, qui s'ex√©cute r√©guli√®rement.  La derni√®re √©tape consiste √† remplacer le contenu du fichier cible par du code malveillant.  Ainsi, lors de la prochaine ex√©cution automatique, le malware aura des droits d'administrateur, quels que soient les droits d'origine. <br><br>  Les d√©veloppeurs de PowerPool ont d√©cid√© de modifier le contenu du fichier <code>C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</code> .  Il s'agit d'un programme de mise √† jour l√©gitime pour les applications Google, il est r√©guli√®rement ex√©cut√© avec des droits d'administrateur via la t√¢che Microsoft Windows. <br><br><img src="https://habrastorage.org/webt/qe/ef/as/qeefastmi_y_som113u2cmyutwa.png"><br>  <i>Figure 2. Cr√©ation d'un lien dur vers Google Updater</i> <br><br><img src="https://habrastorage.org/webt/7d/th/ua/7dthua4tv-1sglb8uq6udcwb6na.png"><br>  <i>Figure 3. Utilisation de SchRpcCreateFolder pour modifier les autorisations de l'ex√©cutable Google Updater</i> <br><br>  La s√©quence d'op√©rations de la figure ci-dessus permet aux op√©rateurs PowerPool d'obtenir des autorisations d'√©criture pour le fichier ex√©cutable <code>GoogleUpdate.exe</code> .  Ensuite, ils le remplacent, les rempla√ßant par une copie de leur logiciel malveillant de deuxi√®me √©tape (que nous d√©crirons ci-dessous) pour obtenir des droits d'administrateur la prochaine fois que le programme de mise √† jour est appel√©. <br><br><h3>  Compromis initial </h3><br>  L'√©quipe PowerPool utilise diff√©rentes m√©thodes pour compromettre d'abord la victime.  L'un d'eux est l'envoi de spam avec des logiciels malveillants de la premi√®re √©tape de la pi√®ce jointe.  Il est t√¥t pour tirer des conclusions, mais jusqu'√† pr√©sent, nous avons observ√© tr√®s peu d'√©chantillons dans les donn√©es de t√©l√©m√©trie, nous supposons donc que les destinataires sont soigneusement s√©lectionn√©s et nous ne parlons pas d'envoi massif. <br><br>  D'un autre c√¥t√©, nous savons que dans le pass√©, PowerPool pratiquait d√©j√† les envois de spam.  Selon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article de blog SANS</a> publi√© en mai 2018, ils ont utilis√© un sch√©ma avec des fichiers de liens symboliques (.slk) pour diffuser des logiciels malveillants.  Microsoft Excel peut charger ces fichiers qui mettent √† jour la cellule et obligent Excel √† ex√©cuter le code PowerShell.  Il semble que ces fichiers .slk soient √©galement distribu√©s dans les messages de spam.  Sur la base du premier fichier mentionn√© dans le post SANS (SHA-1: b2dc703d3af1d015f4d53b6dbbeb624f5ade5553), vous pouvez trouver l'exemple de spam correspondant sur VirusTotal (SHA-1: e0882e234cba94b5cf3df2c05949e2e228beddb) <br><br><img src="https://habrastorage.org/webt/vb/go/yc/vbgoycqhjfhtfptqv-24ob43i-8.png"><br>  <i>Figure 4. Spam PowerPool</i> <br><br><h3>  Portes d√©rob√©es Windows </h3><br>  Le groupe PowerPool fonctionne g√©n√©ralement avec deux portes d√©rob√©es: la porte d√©rob√©e du premier √©tage est utilis√©e apr√®s le compromis initial, la porte d√©rob√©e du deuxi√®me √©tage est impl√©ment√©e uniquement sur les machines concern√©es. <br><br><h4>  Porte d√©rob√©e du premier √©tage </h4><br>  Il s'agit du malware de base utilis√© pour le renseignement.  Se compose de deux ex√©cutables Windows. <br><br>  Le premier d'entre eux est la porte d√©rob√©e principale, qui assure la persistance via le service.  Il cr√©e √©galement un mutex appel√© <code>MyDemonMutex%d</code> , o√π <code>%d</code> est compris entre 0 et 10. La porte d√©rob√©e collecte des informations de proxy, l'adresse du serveur C&amp;C est cod√©e en dur dans un fichier binaire.  Les logiciels malveillants peuvent ex√©cuter des commandes et ex√©cuter des informations de base dans le syst√®me, en transf√©rant des donn√©es vers le serveur C&amp;C. <br><br><img src="https://habrastorage.org/webt/ps/km/ca/pskmcackoqhfcx_19gge_ryfvoa.png"><br>  <i>Figure 5. Collecte des informations de proxy</i> <br><br>  Le second des fichiers ex√©cutables a un objectif.  Il prend une capture d'√©cran et l'√©crit dans le fichier <code>MyScreen.jpg</code> , qui peut ensuite √™tre filtr√© par la porte d√©rob√©e principale. <br><br><h4>  Porte d√©rob√©e du deuxi√®me √©tage </h4><br>  Malvar est charg√© lors de la premi√®re √©tape, probablement si la machine semble int√©ressante pour les op√©rateurs.  Cependant, le programme n'est pas comme une porte d√©rob√©e ART moderne. <br><br>  L'adresse du serveur C&amp;C est cod√©e en dur au format binaire, il n'y a pas de m√©canisme pour mettre √† jour cet √©l√©ment de configuration important.  La porte d√©rob√©e recherche les commandes depuis <code>http://[C&amp;C domain]/cmdpool</code> et t√©l√©charge des fichiers suppl√©mentaires depuis <code>http://[C&amp;C domain]/upload</code> .  Les fichiers suppl√©mentaires sont principalement des outils de d√©placement horizontal, mentionn√©s ci-dessous. <br><br>  Commandes prises en charge: <br>  - ex√©cuter la commande <br>  - terminer le processus <br>  - envoyer un fichier <br>  - t√©l√©charger le fichier <br>  - afficher le contenu du dossier <br><br>  Les commandes sont envoy√©es au format JSON.  Les exemples ci-dessous sont des demandes d'ex√©cution de commandes et de listage des dossiers: <br><br><img src="https://habrastorage.org/webt/au/r1/nc/aur1ncfuer-g6aqayj0n7cjmkhy.png"><br>  <i>Figure 6. Exemples de commandes de porte d√©rob√©e</i> <br><br><h3>  Outils pour le mouvement horizontal </h3><br>  En fournissant un acc√®s constant au syst√®me √† l'aide de la porte d√©rob√©e du deuxi√®me √©tage, les op√©rateurs PowerPool utilisent plusieurs outils open-source, √©crits principalement dans PowerShell, pour le d√©placement horizontal sur le r√©seau. <br><br>  - <a href="">PowerDump</a> : module Metasploit qui peut r√©cup√©rer les noms d'utilisateur et les hachages du Security Account Manager. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PowerSploit</a> : une collection de modules PowerShell, √† la Metasploit. <br>  - <a href="">SMBExec</a> : un outil PowerShell pour ex√©cuter des attaques pass-the-hash en utilisant le protocole SMB. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Quarks PwDump</a> : un ex√©cutable Windows qui peut extraire les informations d'identification. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FireMaster</a> : ex√©cutable Windows qui peut extraire les mots de passe enregistr√©s d'Outlook, des navigateurs Web, etc. <br><br><h3>  Conclusion </h3><br>  La divulgation de vuln√©rabilit√© avant la publication des mises √† jour met les utilisateurs en danger.  Dans ce cas, m√™me la derni√®re version de Windows peut √™tre compromise.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CERT-CC propose une</a> solution de contournement pour le probl√®me, qui, cependant, n'a pas √©t√© officiellement approuv√©e par Microsoft. <br><br>  L'attaque PowerPool cible un nombre limit√© d'utilisateurs.  Cependant, l'incident montre que les attaquants sont toujours √† jour et impl√©mentent rapidement de nouveaux exploits. <br><br>  Les sp√©cialistes d'ESET continuent de surveiller l'exploitation de la nouvelle vuln√©rabilit√©.  Des indicateurs de compromis sont √©galement disponibles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur GitHub</a> . <br><br><h3>  Indicateurs de compromis </h3><br><h4>  Hashs </h4><br>  Porte d√©rob√©e Stage One (Win32 / Agent.SZS) 038f75dcf1e5277565c68d57fa1f4f7b3005f3f3 <br>  Porte d√©rob√©e Stage One (Win32 / Agent.TCH) 247b542af23ad9c63697428c7b77348681aadc9a <br>  Porte arri√®re de deuxi√®me √©tage (Win32 / Agent.TIA) 0423672fe9201c325e33f296595fb70dcd81bcd9 <br>  Porte d√©rob√©e de deuxi√®me √©tage (Win32 / Agent.TIA) b4ec4837d07ff64e34947296e73732171d1c1586 <br>  LPPC exploiter ALPC (Win64 / Exploit.Agent.H) 9dc173d4d4f74765b5fc1e1c9a2d188d5387beea <br><br><h4>  D√©tection ESET </h4><br>  - Win32 / Agent.SZS <br>  - Win32 / Agent.TCH <br>  - Win32 / Agent.TEL <br>  - Win32 / Agent.THT <br>  - Win32 / Agent.TDK <br>  - Win32 / Agent.TIA <br>  - Win32 / Agent.TID <br><br><h4>  Serveurs C&amp;C </h4><br>  - newsrental [.] Net <br>  - rosbusiness [.] Eu <br>  - afishaonline [.] Eu <br>  - collectionneurs sportifs [.] Com <br>  - 27.102.106 [.] 149 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422613/">https://habr.com/ru/post/fr422613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422601/index.html">Chrome 69 sort avec un g√©n√©rateur de mot de passe al√©atoire</a></li>
<li><a href="../fr422603/index.html">Un peu plus pr√®s de la perfection</a></li>
<li><a href="../fr422605/index.html">Cultiver un coffre-fort d√®s le plus jeune √¢ge - programme √©ducatif de Rostelecom et MIPT</a></li>
<li><a href="../fr422609/index.html">Barri√®re linguistique et PNL. Pourquoi les chatbots ne nous comprennent-ils pas?</a></li>
<li><a href="../fr422611/index.html">Gestionnaire d'erreurs standard dans RxJava2 ou pourquoi RxJava provoque des plantages d'application m√™me si onError est impl√©ment√©</a></li>
<li><a href="../fr422615/index.html">Toute la v√©rit√© sur RTOS. Article # 9. Scheduler: impl√©mentation</a></li>
<li><a href="../fr422617/index.html">Toute la v√©rit√© sur RTOS. Article # 8. Nucleus SE: conception interne et d√©ploiement</a></li>
<li><a href="../fr422623/index.html">Comment s√©curiser C</a></li>
<li><a href="../fr422625/index.html">Nous avons parl√© avec Troy Miles - le programmeur de "Neuromancer"</a></li>
<li><a href="../fr422627/index.html">Recherche sur le march√© du travail MongoDB et IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>