<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👏🏾 ❗️ 🏂🏻 Otentikasi otomatis perangkat Android di Wi-Fi Metro Moskow 🚶🏾 🕚 ⤵️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seperti yang Anda ketahui, hampir semua mobil Metro Moskow memiliki titik akses Wi-Fi, yang dengannya pengguna dapat mengakses Internet dan dengan sen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otentikasi otomatis perangkat Android di Wi-Fi Metro Moskow</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/383109/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti yang Anda ketahui, hampir semua mobil Metro Moskow memiliki titik akses Wi-Fi, yang dengannya pengguna dapat mengakses Internet dan dengan senang hati melewatkan waktu perjalanan ke metro dari tempat kerja: membaca berita, memeriksa surat, menonton stempel di YouTube, dll. . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setiap perangkat harus diautentikasi sebelum diberikan akses ke Internet. Untuk pertama kalinya, pengguna dikirim SMS dengan kode ke nomor telepon yang ditentukan, setelah itu sistem mengingat alamat MAC perangkat dan di masa depan, untuk otentikasi, pengguna hanya perlu mengklik tautan "Enter the Internet" dan tunggu sebentar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kerugian dari sistem organisasi semacam itu adalah bahwa bahkan jika pengguna tidak memerlukan browser, dan dia, misalnya, ingin masuk ke email atau membaca twitter menggunakan aplikasi khusus, dia masih perlu meluncurkan browser, mencoba mengakses beberapa halaman, menunggu untuk mengarahkan ulang, , klik pada tautan, tunggu halaman selamat datang untuk memuat (opsional: lihat komersial), dan hanya setelah itu ia akan dapat menggunakan aplikasi yang diinginkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika Anda bukan pengunjung yang sering ke metro, maka skema seperti itu mungkin tidak menyebabkan Anda jengkel, namun, jika digunakan setiap hari, itu tetap mengganggu, oleh karena itu, seperti yang dikatakan oleh seorang politisi terkenal dan karismatik: "Cukup untuk menanggung ini!", Hari ini kami akan mengotomatiskan otentikasi di metro Moskow.</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pertama-tama, kita membutuhkan aplikasi Tasker. Anda bisa mendapatkannya di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dengan sedikit uang), baik, atau di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suatu tempat di sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dengan risiko dan risiko Anda sendiri). Secara pribadi, saya lebih suka opsi pertama dan tidak menyesalinya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tasker adalah aplikasi yang memungkinkan, tergantung pada kondisi tertentu (tanggal / waktu / lokasi / status perangkat / pembacaan sensor, dll.) Untuk melakukan tindakan tertentu (mengirim pesan / menampilkan pemberitahuan / menghidupkan / mematikan perangkat / menghidupkan antarmuka sederhana, dll. d.). Daftar kondisi dan tindakan sangat besar dan tergantung pada versi Android dan perangkat keras perangkat, sehingga tidak ada gunanya membawa mereka sepenuhnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, setelah memulai Tasker, pertama-tama, Anda perlu menerjemahkan antarmuka ke dalam bahasa Inggris, karena terjemahannya lemah di kedua kaki: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pengaturan-&gt; Antarmuka-&gt; Bahasa-&gt; Bahasa Inggris</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan restart aplikasi. </font><font style="vertical-align: inherit;">Sekarang kami memiliki empat tab:</font></font><br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - profil mengontrol koneksi antara status perangkat / berbagai acara dan tugas;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - tugas menggambarkan urutan tindakan yang harus dilakukan;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adegan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - adegan seperti formulir buatan yang dibuat dan disesuaikan oleh tugas, dan kontrol untuk menjalankan tugas;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vars</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - daftar variabel global yang dapat digunakan untuk menyimpan data di antara peluncuran tugas.</font></font></li>
</ul><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buka tab </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tugas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan buat tugas baru, beri nama Metro Auth:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/58a/b9f/a77/58ab9fa777894cc2ab48e7d8e40ceb78.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di jendela yang terbuka, pertama kita perlu mendefinisikan beberapa variabel. </font><font style="vertical-align: inherit;">Variabel didefinisikan sebagai berikut:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/1e0/95a/df8/1e095adf89564c41a1f500df8d671ada.png"></div><br>
<ul>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nama variabel</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nama variabel, harus dimulai dengan simbol </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">%</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan terdiri dari huruf kecil. </font><font style="vertical-align: inherit;">Jika nama variabel berisi setidaknya satu huruf besar, variabel akan menjadi global, tetapi kami tidak memerlukannya;</font></font></li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah nilai variabel.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi, kita perlu membuat variabel berikut:</font></font><br>
<ul>
<li><i>%url</i> —    ,          .        —   (     ).   HTTPS  ,     HTTP;</li>
<li><i>%forms</i> —    HTML-,      .       — '<i>auth-form,hidden_form</i>',        - ,         ,          (  );</li>
<li><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% debug</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - variabel ini, ketika disetel ke nilai selain nol, akan menyebabkan informasi debugging tambahan ditampilkan, yang akan membantu kami membuat daftar formulir di atas.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selain tindakan sederhana, Tasker memberi kami kemampuan untuk menulis skrip dengan kompleksitas sewenang-wenang dengan bantuan beberapa alat. </font><font style="vertical-align: inherit;">Kami akan menggunakan JavaScript sederhana:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/69d/789/3e2/69d7893e20f5443784f873e8fd6e01ab.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di sini Anda perlu mengatur batas </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">waktu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eksekusi </font><font style="vertical-align: inherit;">maksimum </font><font style="vertical-align: inherit;">skrip - 50 detik, untuk berjaga-jaga. </font><font style="vertical-align: inherit;">Kotak </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">centang Keluar Otomatis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bertanggung jawab atas penyelesaian otomatis suatu tindakan setelah selesainya alur skrip utama. </font><font style="vertical-align: inherit;">Jika permintaan asinkron digunakan (kasus kami) atau fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setTimeout</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Anda perlu menghapus centang pada kotak ini, dan menentukan sendiri penyelesaian tindakan menggunakan fungsi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exit (); </font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Saya akan menyajikan skrip itu sendiri dalam dua opsi pemformatan: pemformatan yang layak diperlukan jika Anda ingin memeriksa skrip tanpa merusak mata Anda, dan memformat ke layar sempit memungkinkan skrip terlihat lebih atau kurang layak di layar sempit telepon. </font><font style="vertical-align: inherit;">Awalnya, skrip diketik di ponsel dalam versi "sempit", dan baru kemudian saya memformat ulang untuk artikel:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script dalam format yang layak</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUrl</span>(<span class="hljs-params">url1,url2</span>)</span>{<font></font>
    url1=url1.split(<span class="hljs-string">'?'</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">return</span> url2.length?<font></font>
        (<span class="hljs-regexp">/^http(s?):\/\//i</span>.test(url2)?url2:<font></font>
            (url2[<span class="hljs-number">0</span>]==<span class="hljs-string">'/'</span>?url1.split(<span class="hljs-string">'/'</span>).slice(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>).join(<span class="hljs-string">'/'</span>)+url2:url1.split(<span class="hljs-string">'/'</span>).slice(<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>).join(<span class="hljs-string">'/'</span>)+<span class="hljs-string">'/'</span>+url2)<font></font>
        ):url1;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getVars</span>(<span class="hljs-params">form,tag</span>)</span>{<font></font>
    vars=<span class="hljs-string">''</span>;<font></font>
    fields=form.getElementsByTagName(tag);<font></font>
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;fields.length;i++)<font></font>
        vars=vars+(i?<span class="hljs-string">'&amp;'</span>:<span class="hljs-string">''</span>)+fields[i].name+<span class="hljs-string">'='</span>+fields[i].value;
    <span class="hljs-keyword">return</span> vars;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submit</span>(<span class="hljs-params">xhr,request,form</span>)</span>{<font></font>
    request.url=getUrl(request.url,form.action);<font></font>
    request.method=form.method;<font></font>
    vars1=getVars(form,<span class="hljs-string">'input'</span>);<font></font>
    vars2=getVars(form,<span class="hljs-string">'textarea'</span>);<font></font>
    request.vars=vars1||vars2?(vars1?vars1:<span class="hljs-string">''</span>)+(vars1&amp;&amp;vars2?<span class="hljs-string">'&amp;'</span>:<span class="hljs-string">''</span>)+(vars2?vars2:<span class="hljs-string">''</span>):<span class="hljs-literal">null</span>;<font></font>
    getPage(request,processPage,xhr);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processPage</span>(<span class="hljs-params">xhr,request</span>)</span>{<font></font>
    redir=xhr.getResponseHeader(<span class="hljs-string">'Location'</span>);
    <span class="hljs-keyword">if</span>(redir){
        <span class="hljs-keyword">if</span>(redir==request.url) finalize(<span class="hljs-string">':  '</span>);
        <span class="hljs-keyword">else</span>{<font></font>
            log(<span class="hljs-string">'\n\n'</span>);<font></font>
            getPage({<span class="hljs-string">'url'</span>:redir},processPage,xhr);<font></font>
        }<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        forms=local(<span class="hljs-string">'forms'</span>).split(<span class="hljs-string">','</span>);<font></font>
        id=<span class="hljs-literal">null</span>;
        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;forms.length;i++)
            <span class="hljs-keyword">if</span>(xhr.response.getElementById(forms[i])) id=forms[i];
        <span class="hljs-keyword">if</span>(id)submit(xhr,request,xhr.response.getElementById(id));
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Number</span>(local(<span class="hljs-string">'debug'</span>))){<font></font>
            log(<span class="hljs-string">'  :\n'</span>);<font></font>
            forms=xhr.response.getElementsByTagName(<span class="hljs-string">'form'</span>);
            <span class="hljs-keyword">if</span>(forms.length)
                <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;forms.length;i++)<font></font>
                    log((i?<span class="hljs-string">', "'</span>:<span class="hljs-string">'"'</span>)+forms[i].id+<span class="hljs-string">'"'</span>);
            <span class="hljs-keyword">else</span> log(<span class="hljs-string">''</span>);<font></font>
            finalize();<font></font>
        } <span class="hljs-keyword">else</span> finalize(<span class="hljs-string">' '</span>);<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkConn</span>(<span class="hljs-params">xhr,request</span>)</span>{<font></font>
    redir=xhr.getResponseHeader(<span class="hljs-string">'Location'</span>);
    <span class="hljs-keyword">if</span>(redir){<font></font>
        log(<span class="hljs-string">'\n\n'</span>);<font></font>
        getPage({<span class="hljs-string">'url'</span>:redir},processPage,xhr);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
        log(<span class="hljs-string">'  '</span>);<font></font>
        finalize();<font></font>
    }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">txt</span>)</span>{<font></font>
    logs=logs+(txt?txt:<span class="hljs-string">''</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestToText</span>(<span class="hljs-params">request</span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">'URL: '</span>+request.url+<span class="hljs-string">'\nMethod: '</span>+request.method+<span class="hljs-string">', Vars: '</span>+request.vars+<span class="hljs-string">'\n\n'</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finalize</span>(<span class="hljs-params">txt</span>)</span>{<font></font>
    log(txt);<font></font>
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Number</span>(local(<span class="hljs-string">'debug'</span>))) alert(logs);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(txt) flashLong(txt);<font></font>
    exit();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPage</span>(<span class="hljs-params">request,func,xhr</span>)</span>{
    <span class="hljs-keyword">if</span>(!request.method) request.method=<span class="hljs-string">'GET'</span>;
    <span class="hljs-keyword">if</span>(!request.vars) request.vars=<span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span>(!xhr){<font></font>
        xhr=<span class="hljs-keyword">new</span> XMLHttpRequest();<font></font>
        xhr.responseType=<span class="hljs-string">"document"</span>;<font></font>
        xhr.timeout=<span class="hljs-number">20</span>*<span class="hljs-number">1000</span>;<font></font>
    }<font></font>
    xhr.open(request.method,request.url,<span class="hljs-literal">true</span>);<font></font>
    xhr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">if</span>(xhr.status==<span class="hljs-number">200</span> || xhr.status==<span class="hljs-number">401</span>){<font></font>
            log (requestToText(request)+<span class="hljs-string">'HTTP status: '</span>+xhr.status+<span class="hljs-string">' '</span>+xhr.statusText+<span class="hljs-string">'\n'</span>);<font></font>
            func(xhr,request);<font></font>
        } <span class="hljs-keyword">else</span> {<font></font>
            log(requestToText(request));<font></font>
            finalize(<span class="hljs-string">' HTTP: '</span>+xhr.status+<span class="hljs-string">' '</span>+xhr.statusText);<font></font>
        }<font></font>
    }<font></font>
    xhr.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
        log(requestToText(request));<font></font>
        finalize(<span class="hljs-string">':  '</span>);<font></font>
    }<font></font>
    xhr.ontimeout=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
        log(requestToText(request));<font></font>
        finalize(<span class="hljs-string">':  '</span>);<font></font>
    }<font></font>
    xhr.send(request.vars);<font></font>
}<font></font>
<font></font>
logs=<span class="hljs-string">''</span>;<font></font>
getPage({<span class="hljs-string">'url'</span>:local(<span class="hljs-string">'url'</span>)},checkConn);
</code></pre></div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script dalam format layar sempit</font></font></b><div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUrl</span>(<span class="hljs-params">url1,url2</span>)</span>{<font></font>
  url1=url1.split(<span class="hljs-string">'?'</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">return</span> url2.length?<font></font>
    (<span class="hljs-regexp">/^http(s?):\/\//i</span>.test(url2)?<font></font>
      url2:<font></font>
        (url2[<span class="hljs-number">0</span>]==<span class="hljs-string">'/'</span>?<font></font>
        url1.split(<span class="hljs-string">'/'</span>).slice(<span class="hljs-number">0</span>,<span class="hljs-number">3</span>).join(<span class="hljs-string">'/'</span>)+url2:<font></font>
        url1.split(<span class="hljs-string">'/'</span>).slice(<span class="hljs-number">0</span>,<span class="hljs-number">-1</span>).join(<span class="hljs-string">'/'</span>)+
      <span class="hljs-string">'/'</span>+url2)<font></font>
    ):url1;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getVars</span>(<span class="hljs-params">form,tag</span>)</span>{<font></font>
  vars=<span class="hljs-string">''</span>;<font></font>
  fields=form.getElementsByTagName(<font></font>
    tag);<font></font>
  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;fields.length;i++)<font></font>
    vars=vars+(i?<span class="hljs-string">'&amp;'</span>:<span class="hljs-string">''</span>)+fields[i].name+
      <span class="hljs-string">'='</span>+fields[i].value;
  <span class="hljs-keyword">return</span> vars;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">submit</span>(<span class="hljs-params">xhr,request,form</span>)</span>{<font></font>
  request.url=getUrl(request.url,<font></font>
    form.action);<font></font>
  request.method=form.method;<font></font>
  vars1=getVars(form,<span class="hljs-string">'input'</span>);<font></font>
  vars2=getVars(form,<span class="hljs-string">'textarea'</span>);<font></font>
  request.vars=vars1||vars2?<font></font>
    (vars1?vars1:<span class="hljs-string">''</span>)+<font></font>
    (vars1&amp;&amp;vars2?<span class="hljs-string">'&amp;'</span>:<span class="hljs-string">''</span>)+<font></font>
    (vars2?vars2:<span class="hljs-string">''</span>)<font></font>
    :<span class="hljs-literal">null</span>;<font></font>
  getPage(request,processPage,xhr);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processPage</span>(<span class="hljs-params">xhr,request</span>)</span>{<font></font>
  redir=xhr.getResponseHeader(<font></font>
    <span class="hljs-string">'Location'</span>);
  <span class="hljs-keyword">if</span>(redir){
    <span class="hljs-keyword">if</span>(redir==request.url)<font></font>
      finalize(<span class="hljs-string">':  '</span>+
        <span class="hljs-string">''</span>);
    <span class="hljs-keyword">else</span>{<font></font>
      log(<span class="hljs-string">'\n\n'</span>);<font></font>
      getPage({<span class="hljs-string">'url'</span>:redir},processPage,<font></font>
        xhr);<font></font>
    }<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    forms=local(<span class="hljs-string">'forms'</span>).split(<span class="hljs-string">','</span>);<font></font>
    id=<span class="hljs-literal">null</span>;
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;forms.length;i++)
      <span class="hljs-keyword">if</span>(xhr.response.getElementById(<font></font>
          forms[i]))<font></font>
        id=forms[i];<font></font>
    <span class="hljs-keyword">if</span>(id)submit(xhr,request,<font></font>
      xhr.response.getElementById(id));<font></font>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Number</span>(local(<span class="hljs-string">'debug'</span>))){<font></font>
      log(<span class="hljs-string">'  :\n'</span>);<font></font>
      forms=xhr.response.<font></font>
        getElementsByTagName(<span class="hljs-string">'form'</span>);
      <span class="hljs-keyword">if</span>(forms.length)
        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;forms.length;i++)<font></font>
          log((i?<span class="hljs-string">', "'</span>:<span class="hljs-string">'"'</span>)+forms[i].id+<span class="hljs-string">'"'</span>);
      <span class="hljs-keyword">else</span> log(<span class="hljs-string">''</span>);<font></font>
      finalize();<font></font>
    } <span class="hljs-keyword">else</span> finalize(
      <span class="hljs-string">' '</span>);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkConn</span>(<span class="hljs-params">xhr,request</span>)</span>{<font></font>
  redir=xhr.getResponseHeader(<font></font>
    <span class="hljs-string">'Location'</span>);
  <span class="hljs-keyword">if</span>(redir){<font></font>
    log(<span class="hljs-string">'\n\n'</span>);<font></font>
    getPage({<span class="hljs-string">'url'</span>:redir},processPage,<font></font>
      xhr);<font></font>
  } <span class="hljs-keyword">else</span> {<font></font>
    log(<span class="hljs-string">'  '</span>+
      <span class="hljs-string">''</span>);<font></font>
    finalize();<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">txt</span>)</span>{logs=logs+(txt?txt:<span class="hljs-string">''</span>);}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestToText</span>(<span class="hljs-params">request</span>)</span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'URL: '</span>+request.url+
    <span class="hljs-string">'\nMethod: '</span>+request.method+
    <span class="hljs-string">', Vars: '</span>+request.vars+<span class="hljs-string">'\n\n'</span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finalize</span>(<span class="hljs-params">txt</span>)</span>{<font></font>
  log(txt);<font></font>
  <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Number</span>(local(<span class="hljs-string">'debug'</span>))) alert(logs);
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(txt) flashLong(txt);<font></font>
  exit();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPage</span>(<span class="hljs-params">request,func,xhr</span>)</span>{
  <span class="hljs-keyword">if</span>(!request.method)<font></font>
    request.method=<span class="hljs-string">'GET'</span>;
  <span class="hljs-keyword">if</span>(!request.vars)request.vars=<span class="hljs-literal">null</span>;
  <span class="hljs-keyword">if</span>(!xhr){<font></font>
    xhr=<span class="hljs-keyword">new</span> XMLHttpRequest();<font></font>
    xhr.responseType=<span class="hljs-string">"document"</span>;<font></font>
    xhr.timeout=<span class="hljs-number">20</span>*<span class="hljs-number">1000</span>;<font></font>
  }<font></font>
  xhr.open(request.method,<font></font>
    request.url,<span class="hljs-literal">true</span>);<font></font>
  xhr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>(xhr.status==<span class="hljs-number">200</span> ||<font></font>
        xhr.status==<span class="hljs-number">401</span>){<font></font>
      log (requestToText(request)+<font></font>
        <span class="hljs-string">'HTTP status: '</span>+xhr.status+<span class="hljs-string">' '</span>+<font></font>
        xhr.statusText+<span class="hljs-string">'\n'</span>);<font></font>
        func(xhr,request);<font></font>
    } <span class="hljs-keyword">else</span> {<font></font>
      log(requestToText(request));<font></font>
      finalize(<span class="hljs-string">' HTTP: '</span>+<font></font>
        xhr.status+<span class="hljs-string">' '</span>+xhr.statusText);<font></font>
    }<font></font>
  }<font></font>
  xhr.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
    log(requestToText(request));<font></font>
    finalize(<span class="hljs-string">':  '</span>+
      <span class="hljs-string">''</span>);<font></font>
  }<font></font>
  xhr.ontimeout=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<font></font>
    log(requestToText(request));<font></font>
    finalize(<span class="hljs-string">':  '</span>+
      <span class="hljs-string">''</span>);<font></font>
  }<font></font>
  xhr.send(request.vars);<font></font>
}<font></font>
<font></font>
logs=<span class="hljs-string">''</span>;<font></font>
getPage({<span class="hljs-string">'url'</span>:local(<span class="hljs-string">'url'</span>)},checkConn);
</code></pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mengetik skrip dari keypad telepon, sayangnya, tidak menyukai komentar, tetapi saya akan menjelaskan algoritma secara singkat:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mencoba memuat halaman yang ditentukan dalam variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% url</font></font></i></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika respons tidak memiliki tajuk </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lokasi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTTP </font><font style="vertical-align: inherit;">, maka kami tidak diarahkan, yang berarti otentikasi tidak diperlukan saat ini, keluar</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami memuat halaman yang kami tuju.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika ada header </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lokasi</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kembali ke langkah 3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika halaman memiliki formulir dari daftar dalam variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , tampilkan pengirimannya dan kembali ke langkah 3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam kasus lain, kami berhasil mengautentikasi</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menyelesaikan skrip, kami mendapatkan tugas ini:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/acb/140/3e1/acb1403e172e48acb699aa299c48bace.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dengan menggunakan ikon pertama di baris bawah, Anda dapat mencoba menjalankannya. Sekarang adalah waktunya untuk turun ke kereta bawah tanah untuk mengaturnya! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di kereta bawah tanah, menghubungkan ke titik akses, kami mencoba memulai tugas. Jika tidak ada masalah nyata dengan ketersediaan server, maka kita akan melihat pesan yang mirip dengan yang ditunjukkan pada gambar berikut di sebelah kiri. Di bawah ini kita melihat pengenal formulir yang ada di halaman yang dimuat terakhir - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auth-form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Formulir ini jelas klien kami, kami memperkenalkan namanya ke dalam variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% formulir</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan menjalankan tugas lagi, kami mendapatkan kira-kira apa yang ditunjukkan pada gambar berikut di tengah. Pengenal formulir baru adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hidden_form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Tambahkan ke variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , sekarang nilainya akan berupa ' </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auth-form, hidden_form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font><font style="vertical-align: inherit;">Kami memulai tugas lagi dan melihat sesuatu seperti yang ditunjukkan pada gambar berikut di sebelah kanan - baik akan ada formulir tanpa pengenal, atau tanda "absen" (tergantung pada jalur metro). </font><font style="vertical-align: inherit;">Jika sekarang kami meluncurkan browser, akan jelas bahwa kami telah melewati otentikasi. </font><font style="vertical-align: inherit;">Atur variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% debug</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ke "0", dan tutup tugas - di sini kita selesai.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/a9c/0c2/6eb/a9c0c26eb5874153a28dc89c0240262b.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sekarang terserah Anda untuk mengkonfigurasi peluncuran tugas otomatis ketika terhubung ke jalur akses yang diinginkan. </font><font style="vertical-align: inherit;">Kami pergi ke tab </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Profil</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan membuat profil baru yang akan diaktifkan setelah menghubungkan ke titik akses metro Moskow. </font><font style="vertical-align: inherit;">Setelah kami selesai membuat deskripsi titik akses, Tasker akan menanyakan kepada kami tugas apa yang akan dikaitkan dengan profil ini, tentu saja, memilih </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metro Auth</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/3a5/7ef/5b5/3a57ef5b534f48f5a6b3ab5e00206a1f.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nuansa lain: meskipun jarang, otentikasi masih terbang, meskipun pemutusan dari titik tidak terjadi. </font><font style="vertical-align: inherit;">Jika tidak ada pemutusan, tidak ada koneksi ulang, yang berarti Tasker tidak akan memulai tugas lagi, jadi kami akan mengkonfigurasi Tasker sehingga otentikasi secara otomatis diperiksa setiap 2 menit (interval minimum yang mungkin), untuk ini kita perlu mengklik panjang pada kondisi yang sudah dikonfigurasi untuk memanggil menu, di mana untuk menambahkan kondisi sementara untuk mengatur interval.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/2b7/28a/9af/2b728a9affee411abb30c1174d941fb2.png"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jadi itu saja. </font><font style="vertical-align: inherit;">Mulai sekarang dan sampai Anda harus mengubah pengidentifikasi dalam variabel </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% form</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , algoritme tindakan Anda saat memasuki carriage adalah sebagai berikut:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nyalakan Wi-Fi;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tunggu pesan "Otentikasi selesai" di layar;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tersenyum secara misterius dan lanjutkan tentang bisnis Anda.</font></font></li>
</ol><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Atas saran  </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Self_Perfection</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya mengekspor proyek dan memasukkannya ke dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu file</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">File ini perlu diunduh dan dimasukkan ke dalam folder </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ sdcard / Tasker / proyek</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kemudian jalankan Tasker, tekan lama pada ikon rumah di sudut kiri bawah untuk memanggil menu dan pilih </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dalam versi ini, saya memeriksa sekali setiap dua menit dalam profil yang terpisah - ini akan bekerja lebih efisien.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id383109/">https://habr.com/ru/post/id383109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id383097/index.html">Pratinjau Insider Windows 10 10525 Membunuh Google Chrome</a></li>
<li><a href="../id383099/index.html">Masa depan BMW: air silinder dan torpedo di kabin</a></li>
<li><a href="../id383101/index.html">BioLite menawarkan sumber listrik yang ramah lingkungan</a></li>
<li><a href="../id383103/index.html">Sony SmartBand 2 melacak detak jantung dan stres</a></li>
<li><a href="../id383107/index.html">Saatnya Tutup: Kisah-kisah dari Bursa Saham Chicago yang Terkenal</a></li>
<li><a href="../id383111/index.html">Ada perang saudara untuk Bitcoin</a></li>
<li><a href="../id383115/index.html">"Palet 3D" akan membereskan segala sesuatu di desktop pemilik pena 3D</a></li>
<li><a href="../id383117/index.html">AfterShokz Trekz Titanium ™: Versi Baru dari Headphone yang Dilakukan Bone</a></li>
<li><a href="../id383119/index.html">Ulasan lain tentang Sailfish OS atau tepung memilih OS seluler yang cocok</a></li>
<li><a href="../id383121/index.html">Квадрокоптер научили находить уязвимые сети и гаджеты на большой высоте</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>