<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🔧 🍁 🤜🏾 Protegendo um servidor Web no Linux 👨‍🌾 🤚🏿 🐷</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Olá Habr! 

 Não publicamos nenhum livro novo no Linux para iniciantes há muito tempo - e agora estamos realizando a tradução de novos produtos desse ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Protegendo um servidor Web no Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/425571/">  Olá Habr! <br><br>  Não publicamos nenhum livro novo no Linux para iniciantes há muito tempo - e agora estamos realizando a tradução de novos produtos desse plano.  O livro de Clinton <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Linux in Action</a> , publicado por Manning, fala não apenas da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estrutura interna do Linux</a> , mas também dos problemas mais comuns e de como corrigi-los. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/vq/ow/pwvqowqz-ymlimiywgpbhj8rzqq.jpeg" width="450"></div><br>  O autor publicou um trecho do capítulo 9 no site Hackernoon, que sugerimos que você avalie. <br><a name="habracut"></a><br>  A montagem de um servidor LAMP, como configurá-lo, garantir um processamento de dados confiável, configurar a área de assunto e cuidar de um certificado TLS é apenas a metade do caminho para a vitória.  Você também precisa garantir que sua infraestrutura esteja protegida das muitas ameaças terríveis da Internet. <br><br>  Neste artigo, examinamos a segurança de um site aprendendo a trabalhar adequadamente com grupos de sistemas, garantir o isolamento do processo e auditar regularmente os recursos do sistema.  Obviamente, essa história não está completa (o livro Linux em ação também abordou outros tópicos, por exemplo, instalação de certificados TLS e trabalho com o SELinux), mas isso será suficiente para começar. <br><br><h3>  Grupos de sistemas e o princípio de privilégios mínimos </h3><br>  Os desenvolvedores que você está apoiando (finalmente) estão começando a perceber que é necessário limitar o acesso geral aos dados e arquivos de configuração localizados no servidor de aplicativos, mas, ao mesmo tempo, deixar esse acesso aberto para vários programadores e outras equipes de TI. <br><br>  A primeira parte da solução são <i>grupos</i> .  Um grupo é um objeto no sistema (bem como um usuário) com a ressalva de que nenhum usuário jamais efetuará login no sistema como um grupo.  A força dos grupos reside no fato de que eles, como usuários, podem ser "atribuídos" a arquivos ou diretórios, permitindo que cada membro do grupo use os privilégios fornecidos a ela.  Isso é ilustrado abaixo. <br><br>  Os desenvolvedores do grupo de desenvolvedores podem acessar um diretório específico e, para usuários que não são membros desse grupo, o diretório será fechado <br>  Tente você mesmo: crie um novo arquivo em um editor de texto.  Escreva texto simples nele, por exemplo, “Hello World”, para que você possa ver imediatamente quando o arquivo foi acessado com sucesso.  Em seguida, edite as permissões usando o <code>chmod 770</code> para que o proprietário do arquivo e os membros do grupo ao qual ele pertence tenham plenos direitos para trabalhar com o arquivo, enquanto outros não poderão lê-lo. <br><br><pre> <code class="hljs ruby">$ nano datafile.txt $ chmod <span class="hljs-number"><span class="hljs-number">770</span></span> datafile.txt</code> </pre> <br>  Se seu sistema ainda não possui outras contas de usuário, crie uma conta usando <code>adduser</code> - isso é feito no Debian / Ubuntu - ou usando <code>useradd</code> , como é habitual no CentOS.  O comando <code>useradd</code> também funcionará no Ubuntu. <br><br>  O comando <code>useradd</code> , diferente do <code>adduser</code> Debian <code>adduser</code> requer que a senha do usuário seja gerada separadamente: <br><br><pre> <code class="hljs pgsql"># useradd otheruser # passwd otheruser Enter <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> UNIX <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>: Retype <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> UNIX <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>: passwd: <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> updated successfully</code> </pre> <br>  Usando o comando <code>su</code> , mudamos para o novo usuário.  Depois de inserir sua senha, todos os comandos a seguir serão executados em nome desse usuário.  Você trabalhará em nome desse usuário específico;  nem mais nem menos.  Se você tentar ler o arquivo de dados <code>datafile.txt</code> (usando <code>cat</code> ), nada funcionará mais para você;  como você se lembra, apenas membros do grupo têm direitos de leitura.  Quando terminar, digite <code>exit</code> para sair do novo shell do usuário e retornar ao seu shell original. <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> su otheruser Password: <span class="hljs-variable"><span class="hljs-variable">$</span></span> cat /home/ubuntu/datafile.txt cat: /home/ubuntu/datafile.txt: Permission denied <span class="hljs-variable"><span class="hljs-variable">$</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span></code> </pre> <br>  Tudo isso é esperado e bastante compreensível.  Como você pode ver, quando você não pode ler um arquivo pertencente a outro usuário, isso às vezes é um problema.  Vamos ver o que você pode fazer associando o arquivo ao grupo e configurando corretamente as permissões do arquivo. <br><br>  Criaremos um novo grupo com o qual podemos gerenciar os dados do nosso aplicativo e, em seguida, editaremos as propriedades do nosso arquivo de dados usando o <code>chown</code> .  O argumento do ubuntu: app-data-group deixa a propriedade do arquivo para o usuário do Ubuntu, mas seu grupo muda para um novo: app-data-group. <br><br><pre> <code class="hljs pgsql"># groupadd app-data-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> # chown ubuntu:app-data-<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> datafile.txt</code> </pre> <br>  Execute ls para obter a saída "expandida" deste arquivo e ver suas novas permissões e status.  Observe: como esperado, o arquivo pertence ao usuário <code>ubuntu</code> pertencente ao <code>app-data-group</code> . <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> ls <span class="hljs-literal"><span class="hljs-literal">-l</span></span> | grep datafile.txt <span class="hljs-literal"><span class="hljs-literal">-rwxrwx</span></span> — — <span class="hljs-number"><span class="hljs-number">1</span></span> ubuntu app<span class="hljs-literal"><span class="hljs-literal">-data</span></span><span class="hljs-literal"><span class="hljs-literal">-group</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> Aug <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span> datafile.txt</code> </pre> <br>  Você pode usar o <code>usermod</code> para adicionar seu usuário ao <code>app-data-group</code> e, em seguida, usar o comando <code>su</code> para alternar para o shell no qual a conta de outro usuário está implantada.  Agora, mesmo que os direitos de acesso ao arquivo o bloqueiem de todos os “outros” - e você é definitivamente um usuário “diferente” no momento -, você deve ler esse arquivo livremente, porque pertence ao grupo necessário. <br><br><pre> <code class="hljs smalltalk"># usermod -aG app-data-group otheruser <span class="hljs-string"><span class="hljs-string">$ </span></span>su otheruser <span class="hljs-string"><span class="hljs-string">$ </span></span>cat datafile.txt <span class="hljs-type"><span class="hljs-type">Hello</span></span> <span class="hljs-type"><span class="hljs-type">World</span></span></code> </pre> <br>  Usando o comando <code>su</code> , alternamos entre contas de usuário.  Eles são gravados no meu arquivo <code>datafile.txt</code> .  Essa organização é a maneira correta e eficaz de eliminar uma variedade de problemas complexos com direitos de acesso que podem surgir em um sistema multiusuário. <br><br>  De fato, ele é usado não apenas para fornecer os direitos de acesso necessários para usuários individuais - muitos processos do sistema também não seriam capazes de executar suas tarefas se eles não fossem membros prescritos nos grupos necessários.  Você pode visualizar o arquivo / etc / group na diagonal - observe quantos processos do sistema pertencem aos seus próprios grupos ... <br><br>  Listagem abreviada do conteúdo do arquivo / etc / group: <br><br><pre> <code class="hljs ruby">$ cat /etc/group <span class="hljs-symbol"><span class="hljs-symbol">root:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">daemon:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">bin:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">sys:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">adm:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">:syslog</span></span> <span class="hljs-symbol"><span class="hljs-symbol">tty:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">disk:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">lp:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">mail:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">news:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">9</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">uucp:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">10</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">man:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">12</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">proxy:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">13</span></span>: […]</code> </pre> <br><h3>  Isolamento do processo de contêiner </h3><br>  Talvez você esteja preocupado que muitos serviços em execução no mesmo servidor estejam em risco se pelo menos um desses serviços estiver comprometido?  Uma opção para amenizar os danos que usuários descuidados ou mal-intencionados podem causar é isolar os recursos e processos do sistema.  Assim, mesmo que alguém deseje expandir sua autoridade além dos limites estabelecidos, ele não obterá acesso físico aos dados. <br><br>  Anteriormente, foi decidido resolver esse problema da seguinte maneira: cada serviço foi alocado em sua própria máquina física.  No entanto, a virtualização torna muito mais fácil e barato criar uma arquitetura "mesh".  Hoje, essa arquitetura é geralmente chamada de <i>microsserviço</i> e permite executar muitos contêineres de uma só vez, em um dos quais, por exemplo, um banco de dados pode funcionar, no outro - Apache e no terceiro - arquivos de mídia que podem ser incorporados às suas páginas da web.  A arquitetura de microsserviço permite não apenas aumentar significativamente a produtividade e a eficiência, mas também reduzir significativamente o risco de invasão de cada componente individual. <br><br>  Os “contêineres” de que estou falando não precisam ser convincentes com o LXC.  Outras tecnologias de contêiner, como o Docker, estão se tornando muito mais populares hoje em dia. <br><br><h3>  Verificando valores perigosos de ID do usuário </h3><br>  Obviamente, qualquer usuário com direitos de administrador pode fornecer temporariamente acesso root com o <code>sudo</code> , mas apenas o administrador é o administrador real.  Como você já sabe, não é seguro executar funções regulares sob acesso root.  No entanto, isso pode acontecer - puramente por acidente ou devido a fraude de dados maliciosos - que um usuário comum terá direitos administrativos sem interrupções. <br><br>  Nesse caso, é bom que não seja difícil identificar esses impostores: o usuário e / ou o ID do grupo, como o do administrador, será "0".  Dê uma olhada no arquivo passwd no diretório / etc /.  Este arquivo contém um registro para cada conta de usuário normal e do sistema que já existe no sistema.  O primeiro campo contém o nome da conta (neste caso, root e ubuntu), e no segundo campo x pode ser usado em vez da senha (se a senha existir, será criptografada no arquivo / etc / shadow).  Mas os dois campos a seguir contêm o usuário e o ID do grupo.  No caso do <code>ubuntu</code> neste exemplo, os dois IDs são 1000. E o administrador, como você pode ver, possui zeros aqui. <br><br><pre> <code class="hljs ruby">$ cat /etc/passwd <span class="hljs-symbol"><span class="hljs-symbol">root:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:root</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/root</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/bash</span></span> […] <span class="hljs-symbol"><span class="hljs-symbol">ubuntu:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">1000</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">1000</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/home/ubuntu</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/bash</span></span></code> </pre> <br>  Se você encontrar um usuário comum com um ID de usuário ou grupo = 0, tenha certeza de que o assunto não está limpo e que a situação precisa ser corrigida.  Uma maneira rápida e fácil de identificar esse problema é verificar o <code>passwd</code> com o comando <code>awk</code> , que exibirá todas as linhas no terceiro campo em que não há nada além de 0. No meu caso (você pode exalar), havia apenas uma dessas linhas - a raiz.  Você pode executá-lo novamente substituindo $ 4 por $ 3 - isso verificará o campo ID do grupo. <br><br><pre> <code class="hljs ruby">$ awk -<span class="hljs-symbol"><span class="hljs-symbol">F:</span></span> <span class="hljs-string"><span class="hljs-string">'($3 == “0”) {print}'</span></span> /etc/passwd <span class="hljs-symbol"><span class="hljs-symbol">root:</span></span><span class="hljs-symbol"><span class="hljs-symbol">x:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:root</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/root</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/bash</span></span></code> </pre> <br><h3>  Auditoria de Recursos do Sistema </h3><br>  Quanto mais coisas houver no seu sistema, maior a probabilidade de que algo nele se quebre.  Portanto, é aconselhável acompanhar o que funciona e como.  Nesse caso, estamos falando de portas de rede (se a porta estiver "aberta", então, por definição, deve ser uma entrada), serviços (se o serviço estiver ativo, deve ser possível usá-lo) e sobre programas instalados (se o programa estiver instalado, ele deve ser a capacidade de realizá-lo). <br><br>  Para que uma auditoria seja benéfica, ela deve ser mais ou menos regular.  Como todos nós esquecemos, é muito melhor escrever ferramentas de auditoria em um script especial que não apenas será executado regularmente, mas idealmente analisará os resultados para torná-los mais legíveis. <br><br>  Aqui, no entanto, apresento três ferramentas-chave de auditoria que ajudarão a exibir portas abertas, serviços ativos e pacotes de software desnecessários.  Sua tarefa é automatizar tudo isso. <br><br><h3>  Verificação de porta </h3><br>  Uma porta é considerada "aberta" se um host estiver executando um processo que escute solicitações nessa porta.  De olho nas portas abertas, você entenderá melhor o que exatamente está acontecendo no seu servidor. <br><br>  Você já sabe que as portas HTTP (80) e SSH (22) provavelmente devem estar abertas em um servidor Web comum, para que não surpreendam você.  Mas é muito mais importante prestar atenção a outros resultados inesperados.  O comando netstat exibe todas as portas abertas, bem como uma tonelada de informações sobre como elas são usadas. <br><br>  Neste exemplo, estamos testando um servidor multiuso muito típico, e o comando <code>-n</code> diz ao <code>netstat</code> para ativar todas as portas e endereços numéricos.  <code>-l</code> inclui apenas soquetes de escuta e <code>-p</code> adiciona o ID do processo do programa de escuta.  Naturalmente, se você vê algo - aja. <br><br><pre> <code class="hljs pgsql"># netstat -npl Active Internet connections (<span class="hljs-keyword"><span class="hljs-keyword">only</span></span> servers) Proto <span class="hljs-keyword"><span class="hljs-keyword">Local</span></span> Address <span class="hljs-keyword"><span class="hljs-keyword">Foreign</span></span> Address State PID/Program <span class="hljs-type"><span class="hljs-type">name</span></span> tcp <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">3306</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:* <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span> <span class="hljs-number"><span class="hljs-number">403</span></span>/mysqld tcp <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:<span class="hljs-number"><span class="hljs-number">139</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:* <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>/smbd tcp <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:* <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span> <span class="hljs-number"><span class="hljs-number">333</span></span>/sshd tcp <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:<span class="hljs-number"><span class="hljs-number">445</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:* <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span>/smbd tcp6 :::<span class="hljs-number"><span class="hljs-number">80</span></span> :::* <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span> <span class="hljs-number"><span class="hljs-number">417</span></span>/apache2 […]</code> </pre><br>  Nos últimos anos, o <code>ss</code> usado cada vez mais em vez do <code>netstat</code> .  Apenas no caso: se uma noite você se encontra em uma empresa e alguém pergunta sobre ss, então este exemplo (que lista todas as conexões SSH instaladas) deve ser informativo o suficiente para que você não possa enfrentar a sujeira: <br><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> ss <span class="hljs-literal"><span class="hljs-literal">-o</span></span> state established <span class="hljs-string"><span class="hljs-string">'( dport = :ssh or sport = :ssh )'</span></span> Netid Recv<span class="hljs-literal"><span class="hljs-literal">-Q</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Send-Q</span></span> Local Address:Port Peer Address:Port tcp <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">3.1</span></span>:<span class="hljs-number"><span class="hljs-number">39874</span></span> <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">3.96</span></span>:ssh timer:(keepalive,<span class="hljs-number"><span class="hljs-number">18</span></span>min,<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><h3>  Verificando os Serviços Ativos </h3><br>  Se você tirar uma foto rápida dos serviços gerenciados pelo <code>system</code> e atualmente ativos no seu computador, a máquina ajudará a identificar qualquer atividade indesejada.  O comando <code>systemctl</code> pode listar todos os serviços existentes e, em seguida, sua lista pode ser reduzida para aqueles cuja descrição contém <code>enabled</code> .  Portanto, apenas os serviços ativos serão retornados. <br><br><pre> <code class="hljs mel"># systemctl list-<span class="hljs-keyword"><span class="hljs-keyword">unit</span></span>-files — type=service — state=enabled autovt@.service enabled bind9.service enabled cron.service enabled dbus-org.freedesktop.thermald.service enabled docker.service enabled getty@.service enabled haveged.service enabled mysql.service enabled networking.service enabled resolvconf.service enabled rsyslog.service enabled ssh.service enabled sshd.service enabled syslog.service enabled systemd-timesyncd.service enabled thermald.service enabled unattended-upgrades.service enabled ureadahead.service enabled</code> </pre> <br>  Se você encontrar algo que obviamente não se <code>systemctl</code> , é possível usar o comando <code>systemctl</code> para interromper o serviço e garantir que ele não seja reiniciado na próxima inicialização. <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># systemctl stop haveged # systemctl disable haveged</span></span></code> </pre> <br>  Na verdade, não há nada sombrio e sombrio no serviço <code>haveged</code> que eu paro neste exemplo: é uma ferramenta que geralmente executo para criar atividade aleatória do sistema em segundo plano ao criar chaves de criptografia. <br>  Procure programas instalados <br><br>  Alguém poderia instalar programas no sistema sem o seu conhecimento?  Bem, para descobrir - você precisa procurar.  O comando <code>yum list installed</code> ou, no caso do Debian / Ubuntu, <code>dpkg — list</code> fornecerá um resumo detalhado e o comando remove deve remover todos os pacotes que não precisamos. <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># yum list installed # yum remove packageName</span></span></code> </pre> <br>  Aqui está como a mesma coisa é feita no Ubuntu: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># dpkg --list # apt-get remove packageName</span></span></code> </pre> <br>  Também é útil acompanhar as alterações que estão sendo feitas nos arquivos de configuração do sistema - falaremos sobre isso no Capítulo 11. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425571/">https://habr.com/ru/post/pt425571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425559/index.html">Curso MIT "Segurança de sistemas de computadores". Aula 10: Execução Simbólica, Parte 3</a></li>
<li><a href="../pt425561/index.html">Curso MIT "Segurança de sistemas de computadores". Palestra 10: Execução Simbólica, Parte 2</a></li>
<li><a href="../pt425563/index.html">A Califórnia proíbe a venda de dispositivos IoT com ou sem senhas simples</a></li>
<li><a href="../pt425565/index.html">Matemática rápida de ponto fixo para aplicativos financeiros em Java</a></li>
<li><a href="../pt425569/index.html">Teste funcional do PWB</a></li>
<li><a href="../pt425575/index.html">Neuroinflamação</a></li>
<li><a href="../pt425581/index.html">Jetpack 11 de outubro de 1961: O Presidente abriu a boca ...</a></li>
<li><a href="../pt425583/index.html">Tudo o que ainda confunde robomobiles, começando com gaivotas</a></li>
<li><a href="../pt425587/index.html">Planejado o primeiro teste de ratos com expressão alotópica</a></li>
<li><a href="../pt425589/index.html">Notícias antienvelhecimento</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>