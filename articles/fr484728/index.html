<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏾‍🤝‍🧑🏻 🥃 🆔 Client mystère de CityMobile 👨🏽‍🎓 ⛴️ ✖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Je m'appelle Narek Markosyan et je suis développeur backend chez Citimobil. Je veux vous parler de notre bot Telegram fermé "Client mystère" . 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Client mystère de CityMobile</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/citymobil/blog/484728/">  Salut  Je m'appelle Narek Markosyan et je suis développeur backend chez Citimobil.  Je veux vous parler de notre <b>bot Telegram</b> fermé <b>"Client mystère"</b> . <br><br><h2>  Prologue </h2><br>  Personne ne porte de lunettes roses dans CityMobile, nous comprenons bien que notre service n'est pas parfait, donc nous travaillons toujours pour l'améliorer.  Les problèmes clients peuvent être associés à l'application, au calcul du prix, mais le plus souvent au chauffeur. <br><br>  Nous aimons nos chauffeurs et essayons de rendre leur travail plus agréable et rentable, mais à cause d'un chauffeur sans scrupules, nous pouvons perdre plusieurs clients et ainsi priver des chauffeurs qui font honnêtement leur travail. <br><br>  Pour cette raison, nous avons décidé de développer un outil pour répondre rapidement aux réclamations liées aux conducteurs. <br><a name="habracut"></a><br><h2>  Pourquoi avons-nous besoin d'un bot </h2><br>  Absolument toutes les plaintes de nos clients sont prises en compte par les employés du service d'assistance, mais nous ne pouvons pas nous fier entièrement aux statistiques reçues des clients pour plusieurs raisons: <br><br><ul><li>  <b>tous les clients ne</b> laissent pas de commentaires en cas de problème; </li><li>  nous ne pouvons pas toujours être sûrs de l' <b>objectivité des</b> clients; </li><li>  nous ne voulons pas et ne pouvons pas obtenir des clients un tas de <b>questions</b> de <b>clarification</b> pour obtenir l'image complète. </li></ul><br>  Alors que faire?  Demandez à nos collègues de vous aider! <br><br><ul><li>  Les employés n'oublieront probablement <b>pas</b> de signaler un problème; </li><li>  Les employés sont plus <b>objectifs</b> .  Pas avant la fin, mais quand même :) </li><li>  Vous pouvez aller voir un collègue et découvrir tous les détails nécessaires. </li></ul><br>  Bien sûr, lorsque des problèmes surviennent, vous pouvez toujours appeler la salle de répartition et vous passer d'intermédiaires, mais le bot aide à effectuer deux tâches importantes: il vous <b>rappelle</b> ce à quoi vous devez faire attention et vous permet de signaler un problème en cliquant sur <b>un bouton</b> . <br><br><h2>  Comment fonctionne le bot? </h2><br><img src="https://drive.google.com/uc?export=view&amp;id=1FkPW2NhEdc8Mi1c_n-Oxcjf2a7I46QEL" alt="image"><br><br>  Le client mystère est très simple.  Il se compose de seulement deux gestionnaires: <br><br>  Le premier gestionnaire prend de nos voyages API qui ont récemment terminé ou sont dans l'état "En transit", et envoie la première question de voyage au chat. <br><br>  Le deuxième gestionnaire accède à l'API Telegram et récupère les messages non lus, passe en revue chaque message tour à tour et envoie une réponse au chat. <br><br>  Bien sûr, il était possible que notre serveur envoie automatiquement des messages au robot du voyage et les réponses des utilisateurs du télégramme ne venaient pas par lots, mais au moment de l'envoi, mais après discussions, nous avons décidé de faire le mécanisme décrit ci-dessus.  Il y avait plusieurs raisons à cela: <br><br><ul><li>  avec cette implémentation, le service est <b>complètement fermé</b> pour les demandes entrantes sur tous les ports, nous ne pouvons donc pas avoir peur des tentatives de piratage ou des attaques DDOS; </li><li>  si de nombreux messages proviennent d'utilisateurs en même temps, Telegram ne <b>nous bombardera pas de demandes</b> ; </li><li>  si le bot devient terne, cela <b>n'affectera pas</b> notre serveur principal et n'affectera pas les processus métier. </li></ul><br>  Nous avons choisi MySQL comme base pour le bot.  Toute base de données nous conviendrait, même noSQL, mais nous avons choisi MySQL pour faciliter le traitement des données nécessaires par le département analytique. <br><br>  Quant au langage, nous avons choisi ici entre PHP et GoLang.  Nous nous sommes arrêtés à PHP, car "pourquoi pas".  Avec l'implémentation que nous avons, nous n'utiliserions pas les principaux avantages de Go, mais compliquerions le développement ultérieur - tous nos développeurs n'écrivent pas sur Go.  Si vous avez une idée de ce qui serait mieux que PHP dans cette implémentation de Go, je serai heureux de lire dans les commentaires. <br><br><h2>  Améliorations </h2><br>  Il n'y a pas eu beaucoup d'améliorations depuis la première version.  Après le lancement officiel, nous avons commencé à recueillir des commentaires et, par conséquent, nous n'avons trouvé que deux problèmes. <br><br>  <b>Le premier problème est la mémoire courte</b> .  Dans la première mise en œuvre, le bot a commencé à interroger l'employé 5 minutes après le voyage.  Il s'est avéré que pendant ce temps, le passager a réussi à oublier certains détails, par exemple le numéro d'immatriculation de la voiture.  Après raffinement, le bot a commencé l'enquête une minute après que le passager soit monté dans la voiture.  Le bot a posé des questions dont la réponse est déjà connue avec certitude (propreté de la voiture, si la voiture a les bons numéros, etc.).  Après le voyage, le bot est revenu avec un autre paquet de questions, dont les réponses ne deviennent claires que pendant le voyage. <br><br>  <b>Le deuxième problème est que tout va presque toujours bien avec nous</b> .  Peu importe à quel point cela peut sembler étrange, mais du point de vue du bot, c'est devenu un problème.  Nos collègues sont fatigués 10 fois après chaque voyage pour répondre «tout va bien».  Nous avons résolu ce problème en regroupant les questions: nous avons combiné toutes les questions posées pendant le voyage et toutes les questions posées après en deux questions identiques: «Tout va bien?» Avec un ensemble de réponses différent. <br><br><img src="https://drive.google.com/uc?export=view&amp;id=1qi1ZO7J0HmygCH_lFMaBR_zKCfdSd-0q" alt="image"><br><br>  Dans un avenir proche, nous prévoyons d'augmenter le nombre de clients de confiance et ainsi rendre le bot plus efficace.  Pour ce faire, vous devrez refaire l'autorisation et ajouter une surveillance aux événements critiques.  S'il y aura des changements intéressants, j'écrirai un article séparé à leur sujet ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr484728/">https://habr.com/ru/post/fr484728/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr484716/index.html">Arrêtez d'appeler tout AI</a></li>
<li><a href="../fr484718/index.html">Les imprimantes modernes HP refusent de travailler sans abonnement à l'encre</a></li>
<li><a href="../fr484720/index.html">Concert pour une ville avec un orchestre: qui et pourquoi enregistre les sons de la vie quotidienne</a></li>
<li><a href="../fr484722/index.html">Quels outils de développement Ruby on Rails conviennent à votre projet: Top Ruby on Rails Gems for 2020</a></li>
<li><a href="../fr484724/index.html">Nouvelles du monde d'OpenStreetMap n ° 494 (12.31.2019-06.01.2020)</a></li>
<li><a href="../fr484730/index.html">Dell Inspiron 7490: un ordinateur portable léger en métal pour tous les jours avec une excellente autonomie</a></li>
<li><a href="../fr484732/index.html">Qu'est-ce que VMware et pourquoi sa compatibilité avec les SSD est-elle importante?</a></li>
<li><a href="../fr484734/index.html">Ce qui aurait pu être présenté au CES aux XIXe et XXe siècles</a></li>
<li><a href="../fr484736/index.html">Linux: suppression du pool de verrous / dev / random</a></li>
<li><a href="../fr484738/index.html">Procédure d'intégration continue pour Laravel 6 sur Google Cloud Run</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>