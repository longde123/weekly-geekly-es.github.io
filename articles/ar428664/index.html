<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คด๐ผ ๐ฉ๐พโโ๏ธ ๐ ุงูุชูููุฏ ููุงุฉ ููููุณ. ุงูุฌุฒุก ุงูุฃูู ๐ด๐ฝ ๐ฆ ๐ฉ๐ปโ๐คโ๐จ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุญูู ุงูุฅููุงุน ุฅูู ุงูููุงุฉ 

 ุฅุฐุง ูุฑุฃุช ุงูููุงูุงุช ุงูุณุงุจูุฉ ุ ูุฃูุช ุชุนุฑู ููุงูุชู ุงูุฌุฏูุฏุฉ ููุจุฑูุฌุฉ ููุฎูุถุฉ ุงููุณุชูู. ููุฏ ูุชุจุช ุงูุนุฏูุฏ ูู ุงูููุงูุงุช ุญูู ุจุฑูุฌุฉ ุงูุชุฌู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุชูููุฏ ููุงุฉ ููููุณ. ุงูุฌุฒุก ุงูุฃูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428664/" style=";text-align:right;direction:rtl"> <b>ูู ูุญูู ุงูุฅููุงุน ุฅูู ุงูููุงุฉ</b> <br><br>  ุฅุฐุง ูุฑุฃุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุงุช</a> ุงูุณุงุจูุฉ ุ ูุฃูุช ุชุนุฑู ููุงูุชู ุงูุฌุฏูุฏุฉ ููุจุฑูุฌุฉ ููุฎูุถุฉ ุงููุณุชูู.  ููุฏ ูุชุจุช ุงูุนุฏูุฏ ูู ุงูููุงูุงุช ุญูู ุจุฑูุฌุฉ ุงูุชุฌููุน ูู <code>x86_64</code> Linux ููู ููุณ ุงูููุช ุจุฏุฃุช ุงูุบูุต ูู ุดูุฑุฉ ุงููุตุฏุฑ ูู Linux kernel. <br><br>  ุฃูุง ููุชู ุฌุฏูุง ุจููู ููููุฉ ุนูู ุงูุฃุดูุงุก ููุฎูุถุฉ ุงููุณุชูู: ููู ุชุนูู ุงูุจุฑุงูุฌ ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู ุ ูููู ุชูุฌุฏ ูู ุงูุฐุงูุฑุฉ ุ ูููู ุชุฏูุฑ ุงูููุงุฉ ุงูุนูููุงุช ูุงูุฐุงูุฑุฉ ุ ูููู ุชุนูู ุญุฒูุฉ ุงูุดุจูุฉ ุนูู ูุณุชูู ููุฎูุถ ุ ูุฃูุซุฑ ูู ุฐูู ุจูุซูุฑ.  ูุฐุง ุ ูุฑุฑุช ูุชุงุจุฉ ุณูุณูุฉ ุฃุฎุฑู ูู ุงูููุงูุงุช ุญูู ููุงุฉ ููููุณ <b>ูุจููุฉ x86_64</b> . <br><br>  ูุฑุฌู ููุงุญุธุฉ ุฃููู ูุณุช ูุทูุฑูุง ูุญุชุฑููุง ูู kernel ููุง ุฃูุชุจ ุฑูุฒ kernel ูู ุงูุนูู.  ูุฐู ูุฌุฑุฏ ููุงูุฉ  ุฃูุง ููุท ุฃุญุจ ุงูุฃุดูุงุก ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ ููู ุงููุซูุฑ ููุงูุชูุงู ุงูุฎูุถ ูููุง.  ูุฐูู ุ ุฅุฐุง ูุงุญุธุช ุฃู ุงุฑุชุจุงู ุฃู ุฃุณุฆูุฉ / ุชุนูููุงุช ุชุธูุฑ ุ ุงุชุตู ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูู ุชููุชุฑ</a> ุ ุนู ุทุฑูู <a href="">ุงูุจุฑูุฏ</a> ุฃู ูุฌุฑุฏ ุฅูุดุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฐูุฑุฉ</a> .  ุณุฃููู ููุชูุง. <br><a name="habracut"></a><br>  ูุชู ูุดุฑ ุฌููุน ุงูููุงูุงุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุณุชูุฏุน GitHub</a> ุ ูุฅุฐุง ูุงู ููุงู ุฎุทุฃ ูุง ูู ูุบุชู ุงูุฅูุฌููุฒูุฉ ุฃู ูุญุชูู ุงูููุงูุฉ ุ ููุง ุชุชุฑุฏุฏ ูู ุฅุฑุณุงู ุทูุจ ุณุญุจ. <br><br>  <i>ูุฑุฌู ููุงุญุธุฉ ุฃู ูุฐู ููุณุช ูุซุงุฆู ุฑุณููุฉ ุ ูููู ุจุจุณุงุทุฉ ุงูุชุฏุฑูุจ ูุชุจุงุฏู ุงููุนุฑูุฉ.</i> <br><br>  <b>ุงููุนุฑูุฉ ุงููุทููุจุฉ</b> <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ููุฏ C </li><li style=";text-align:right;direction:rtl">  ููู ููุฏ ุงููุฌูุน (ุจูุงุก ุฌููุฉ AT&amp;T) </li></ul><br>  ุนูู ุฃู ุญุงู ุ ุฅุฐุง ููุช ูุฏ ุจุฏุฃุช ููุชู ูู ุชุนูู ูุซู ูุฐู ุงูุฃุฏูุงุช ุ ูุณุฃุญุงูู ุดุฑุญ ุดูุก ูุง ูู ูุฐู ุงูููุงูุงุช ูุงูููุงูุงุช ุงููุงุญูุฉ.  ุญุณููุง ุ ูุน ุงูุชูุงุก ุงูููุฏูุฉ ุ ุญุงู ุงูููุช ููุชุนูู ูู ููุงุฉ ููููุณ ูุงูุฃุดูุงุก ุฐุงุช ุงููุณุชูู ุงูููุฎูุถ. <br><br>  ููุฏ ุจุฏุฃุช ูู ูุชุงุจุฉ ูุฐุง ุงููุชุงุจ ูู ุฃูุงู Linux 3.18 kernel ุ ููุฏ ุชุบูุฑ ุงููุซูุฑ ููุฐ ุฐูู ุงูุญูู.  ุฅุฐุง ูุงูุช ููุงู ุชุบููุฑุงุช ุ ูุณุฃููู ุจุชุญุฏูุซ ุงูููุงูุงุช ููููุง ูุฐูู. <br><br><h1 style=";text-align:right;direction:rtl">  ุฒุฑ ุงูุทุงูุฉ ุงูุณุญุฑู ุ ูุง ูู ุงูุฎุทูุฉ ุงูุชุงููุฉุ </h1><br>  ุนูู ุงูุฑุบู ูู ุฃู ูุฐู ููุงูุงุช ุญูู ููุงุฉ ููููุณ ุ ุฅูุง ุฃููุง ูู ูุตู ุฅูููุง ุจุนุฏ - ุนูู ุงูุฃูู ูู ูุฐุง ุงููุณู.  ุจูุฌุฑุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุทุงูุฉ ุงูุณุญุฑู ุนูู ุงูููุจููุชุฑ ุงููุญููู ุฃู ุงูููุจููุชุฑ ุงูููุชุจู ุ ูุฅูู ูุจุฏุฃ ูู ุงูุนูู.  ุชุฑุณู ุงูููุญุฉ ุงูุฃู ุฅุดุงุฑุฉ ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฒูุฏ ุงูุทุงูุฉ</a> .  ุจุนุฏ ุชููู ุงูุฅุดุงุฑุฉ ุ ุชุฒูุฏ ุงูููุจููุชุฑ ุจุงููููุฉ ุงููุงุฒูุฉ ูู ุงูููุฑุจุงุก.  ุจูุฌุฑุฏ ุฃู ุชุชููู ุงูููุญุฉ ุงูุฃู ุฅุดุงุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Power OK"</a> ุ ูุฅููุง ุชุญุงูู ุจุฏุก ุชุดุบูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ.  ููุฑุบ ูู ุงูุจูุงูุงุช ุงููุชุจููุฉ ูู ุณุฌูุงุชู ููุญุฏุฏ ุงูููู ุงููุญุฏุฏุฉ ูุณุจููุง ููู ูููุง. <br><br>  ูุฌุจ ุฃู ุชุญุชูู ุงููุนุงูุฌุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">80386</a> ูุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ ุนูู ุงูููู ุงูุชุงููุฉ ูู ุชุณุฌููุงุช CPU ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู: <br><br><pre style=";text-align:right;direction:rtl">  IP 0xfff0
 ูุญุฏุฏ CS 0xf000
 ูุงุนุฏุฉ CS 0xffff0000 </pre><br>  ูุจุฏุฃ ุงููุนุงูุฌ ูู ุงูุนูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุถุน ุงูุญูููู</a> .  ุฏุนูุง ูุนูุฏ ููููุงู ููุญุงูู ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุณูู ุงูุฐุงูุฑุฉ</a> ูู ูุฐุง ุงููุถุน.  ุงููุถุน ุงูุญูููู ูุฏุนูู ุนูู ุฌููุน ุงููุนุงูุฌุงุช ุงููุชูุงููุฉ ูุน x86: ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">8086</a> ุฅูู ูุนุงูุฌุงุช Intel 64 ุจุช ุงูุญุฏูุซุฉ.  ูุณุชุฎุฏู ุงููุนุงูุฌ 8086 ูุงูู ุนููุงู 20 ุจุช ุ ุฃู ุฃูู ูููู ุฃู ูุนูู ูุน ูุณุงุญุฉ ุนููุงู <code>0-0xFFFFF</code> ุฃู <code>1 </code> .  ูููู ูุฏููุง ุณุฌูุงุช 16 ุจุช ููุท ูุน ุนููุงู ุฃูุตู <code>2^16-1</code> ุฃู <code>0xffff</code> (64 ููููุจุงูุช). <br><br>  ููุฒู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุณูู ุงูุฐุงูุฑุฉ</a> ูุงุณุชุฎุฏุงู ูุณุงุญุฉ ุงูุนููุงู ุงููุชุงุญุฉ ุจุงููุงูู.  ุชููุณู ุงูุฐุงูุฑุฉ ุจุงููุงูู ุฅูู ุฃุฌุฒุงุก ุตุบูุฑุฉ ุจุญุฌู ุซุงุจุช ูุจูุบ <code>65536</code> ุจุงูุช (64 ููููุจุงูุช).  ูุธุฑูุง ูุฃูู ุจุงุณุชุฎุฏุงู ุณุฌูุงุช 16 ุจุช ุ ูุง ูููููุง ุงููุตูู ุฅูู ุงูุฐุงูุฑุฉ ุงูุชู ุชุฒูุฏ ุนู 64 ููููุจุงูุช ุ ููุฏ ุชู ุชุทููุฑ ุทุฑููุฉ ุจุฏููุฉ. <br><br>  ูุชููู ุงูุนููุงู ูู ุฌุฒุฃูู: 1) ูุญุฏุฏ ูุทุนุฉ ุจุนููุงู ุฃุณุงุณู.  2) ุงูุฅุฒุงุญุฉ ูู ุงูุนููุงู ุงูุฃุณุงุณู.  ูู ุงููุถุน ุงูุญูููู ุ ูููู ุงูุนููุงู ุงูุฃุณุงุณู <code>  * 16</code> ุงูููุทุน <code>  * 16</code> .  ูุจุงูุชุงูู ุ ููุญุตูู ุนูู ุงูุนููุงู ุงููุนูู ูู ุงูุฐุงูุฑุฉ ุ ุชุญุชุงุฌ ุฅูู ุถุฑุจ ุฌุฒุก ูู ูุญุฏุฏ ุงูููุทุน ูู 16 ูุฅุถุงูุฉ ุงูุฅุฒุงุญุฉ ุฅููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs">  =   * 16 + </code> </pre> <br>  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุณุฌู <code>CS:IP</code> ูุญุชูู ุนูู ุงููููุฉ <code>0x2000:0x0010</code> ุ ูุณูููู ุงูุนููุงู ุงููุนูู ุงูููุงุจู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;</span></span>&gt; hex((<span class="hljs-number"><span class="hljs-number">0x2000</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + <span class="hljs-number"><span class="hljs-number">0x0010</span></span>) <span class="hljs-string"><span class="hljs-string">'0x20010'</span></span></code> </pre> <br>  ูููู ุฅุฐุง ุฃุฎุฐุช ูุญุฏุฏ ุงูุฌุฒุก ุงูุฃูุจุฑ ูุงูุฅุฒุงุญุฉ <code>0xffff:0xffff</code> ุ ูุณุชุญุตู ุนูู ุงูุนููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;</span></span>&gt; hex((<span class="hljs-number"><span class="hljs-number">0xffff</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + <span class="hljs-number"><span class="hljs-number">0xffff</span></span>) <span class="hljs-string"><span class="hljs-string">'0x10ffef'</span></span></code> </pre> <br>  ุฃู <code>65520</code> ุจุงูุช ุจุนุฏ ุฃูู ููุบุง ุจุงูุช.  ูุธุฑูุง ูุฃู ููุบุงุจุงูุช ูุงุญุฏ ููุท ูุชุงุญ ูู ุงููุถุน ุงูุญูููู ุ ูุตุจุญ <code>0x00ffef</code> ูุน ุชุนุทูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุท A20</a> . <br><br>  ุญุณููุง ุ ูุญู ุงูุขู ูุนุฑู ุงููููู ุนู ุงููุถุน ุงูุญูููู ูุงูุฐุงูุฑุฉ ุงูุชู ุชุนุงูุฌ ูู ูุฐุง ุงููุถุน.  ุฏุนูุง ูุนูุฏ ุฅูู ููุงูุดุฉ ููู ุงูุชุณุฌูู ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุนููู. <br><br>  ูุชููู ุณุฌู <code>CS</code> ูู ุฌุฒุฃูู: ูุญุฏุฏ ููุทุน ูุฑุฆู ูุนููุงู ุฃุณุงุณู ูุฎูู.  ุนูู ุงูุฑุบู ูู ุฃู ุงูุนููุงู ุงูุฃุณุงุณู ูุชููู ุนุงุฏุฉ ุจุถุฑุจ ูููุฉ ูุญุฏุฏ ุงูููุทุน ูู 16 ุ ุฃุซูุงุก ุฅุนุงุฏุฉ ุชุนููู ุงูุฌูุงุฒ ุ ูุฅู ูุญุฏุฏ ุงูููุทุน ูู ุณุฌู CS ูู <code>0xf000</code> ุ ูุงูุนููุงู ุงูุฃุณุงุณู ูู <code>0xffff0000</code> .  ูุณุชุฎุฏู ุงููุนุงูุฌ ูุฐุง ุงูุนููุงู ุงูุฃุณุงุณู ุงูุฎุงุต ุญุชู ุชุชุบูุฑ CS. <br><br>  ูุชููู ุนููุงู ุงูุจุฏุงูุฉ ุจุฅุถุงูุฉ ุงูุนููุงู ุงูุฃุณุงุณู ุฅูู ุงููููุฉ ูู ุณุฌู EIP: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;</span></span>&gt; <span class="hljs-number"><span class="hljs-number">0xffff0000</span></span> + <span class="hljs-number"><span class="hljs-number">0xfff0</span></span> <span class="hljs-string"><span class="hljs-string">'0xfffffff0'</span></span></code> </pre> <br>  ูุญุตู ุนูู <code>0xfffffff0</code> ุ ููู 16 ุจุงูุช ุฃูู ูู 4 ุบูุบุงุจุงูุช.  ุชุณูู ูุฐู ุงูููุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุฌู ุฅุนุงุฏุฉ ุงูุชุนููู</a> .  ูุฐุง ูู ุงููููุน ูู ุงูุฐุงูุฑุฉ ุญูุซ ุชูุชุธุฑ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุชูููุฐ ุงูุชุนูููุงุช ุงูุฃููู ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุนููู: ุนูููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุงู</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">jmp</a> ) ุ ูุงูุชู ุชุดูุฑ ุนุงุฏุฉู ุฅูู ููุทุฉ ุฅุฏุฎุงู BIOS.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง <code>src/cpu/x86/16bit/reset16.inc</code> ูุธุฑุฉ ุนูู ุดูุฑุฉ ุงููุตุฏุฑ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">coreboot</a> ( <code>src/cpu/x86/16bit/reset16.inc</code> ) ุ ูุณูู ูุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"> <span class="hljs-selector-class"><span class="hljs-selector-class">.section</span></span> "<span class="hljs-selector-class"><span class="hljs-selector-class">.reset</span></span>", "<span class="hljs-selector-tag"><span class="hljs-selector-tag">ax</span></span>", %<span class="hljs-selector-tag"><span class="hljs-selector-tag">progbits</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.code16</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.globl</span></span> _<span class="hljs-selector-tag"><span class="hljs-selector-tag">start</span></span> _<span class="hljs-selector-tag"><span class="hljs-selector-tag">start</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.byte</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">xe9</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.int</span></span> _<span class="hljs-selector-tag"><span class="hljs-selector-tag">start16bit</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> ( . + 2 ) ...</code> </pre> <br>  ููุง ูุฑู ููุฏ <code>jmp</code> (ุงูุนูููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">opcode</a> ) ุ ุฃู <code>0xe9</code> ุ ูุนููุงู ุงููุฌูุฉ <code>_start16bit - ( . + 2)</code> . <br><br>  ูุฑู ุฃูุถูุง ุฃู ูุณู <code>reset</code> ูู 16 ุจุงูุช ุ ููุชู <code>0xfffff0</code> ููุชุดุบูู ูู ุงูุนููุงู <code>0xfffff0</code> ( <code>src/cpu/x86/16bit/reset16.ld</code> ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">SECTIONS { <span class="hljs-comment"><span class="hljs-comment">/* Trigger an error if I have an unuseable start address */</span></span> _bogus = <span class="hljs-keyword"><span class="hljs-keyword">ASSERT</span></span>(_start16bit &gt;= <span class="hljs-number"><span class="hljs-number">0xffff0000</span></span>, "_start16bit too low. Please report."); _ROMTOP = <span class="hljs-number"><span class="hljs-number">0xfffffff0</span></span>; . = _ROMTOP; .<span class="hljs-keyword"><span class="hljs-keyword">reset</span></span> . : { *(.<span class="hljs-keyword"><span class="hljs-keyword">reset</span></span>); . = <span class="hljs-number"><span class="hljs-number">15</span></span>; BYTE(<span class="hljs-number"><span class="hljs-number">0x00</span></span>); } }</code> </pre> <br>  ูุจุฏุฃ BIOS ุงูุขู ุ  ุจุนุฏ ุชููุฆุฉ ุฌูุงุฒ BIOS ูุงูุชุญูู ููู ุ ุชุญุชุงุฌ ุฅูู ุงูุนุซูุฑ ุนูู ุฌูุงุฒ ุงูุชูููุฏ.  ูุชู ุญูุธ ุชุฑุชูุจ ุงูุชูููุฏ ูู ุชูููู BIOS.  ุนูุฏ ูุญุงููุฉ ุงูุชูููุฏ ูู ุงููุฑุต ุงูุตูุจ ุ ูุญุงูู BIOS ุงูุนุซูุฑ ุนูู ูุทุงุน ุงูุชูููุฏ.  ุนูู ุงูุฃูุฑุงุต <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุณูุฉ MBR</a> ุ ูุชู ุชุฎุฒูู ูุทุงุน ุงูุชูููุฏ ูู ุฃูู 446 ุจุงูุช ูู ุงููุทุงุน ุงูุฃูู ุ ุญูุซ ูููู ูู ูุทุงุน 512 ุจุงูุช.  <code>0x55</code> ูู ุงููุทุงุน ุงูุฃูู ููุง <code>0x55</code> ู <code>0xaa</code> .  ูุธูุฑูู BIOS ุฃูู ุฌูุงุฒ ุชูููุฏ. <br><br>  ุนูู ุณุจูู ุงููุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">; ; :       Intel x86 ; [<span class="hljs-type"><span class="hljs-type">BITS</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>] boot: mov al, <span class="hljs-string"><span class="hljs-string">'!'</span></span> mov ah, <span class="hljs-number"><span class="hljs-number">0</span></span>x0e mov bh, <span class="hljs-number"><span class="hljs-number">0</span></span>x00 mov bl, <span class="hljs-number"><span class="hljs-number">0</span></span>x07 int <span class="hljs-number"><span class="hljs-number">0</span></span>x10 jmp <span class="hljs-variable"><span class="hljs-variable">$</span></span> times <span class="hljs-number"><span class="hljs-number">510</span></span>-(<span class="hljs-variable"><span class="hljs-variable">$</span></span>-<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-variable"><span class="hljs-variable">$</span></span>) db <span class="hljs-number"><span class="hljs-number">0</span></span> db <span class="hljs-number"><span class="hljs-number">0</span></span>x55 db <span class="hljs-number"><span class="hljs-number">0</span></span>xaa</code> </pre> <br>  ูุฌูุน ููุฏูุฑ: <br><br> <code>nasm -f bin boot.nasm &amp;&amp; qemu-system-x86_64 boot</code> <br> <br>  ูุชููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">QEMU</a> ุฃูุฑูุง ูุงุณุชุฎุฏุงู ุซูุงุฆู <code>boot</code> ุงูุฐู ุฃูุดุฃูุงู ููุชู ูุตูุฑุฉ ูุฑุต.  ูุธุฑูุง ูุฃู ุงูููู ุงูุซูุงุฆู ุงูุฐู ุชู ุฅูุดุงุคู ุฃุนูุงู ููุจู ูุชุทูุจุงุช ูุทุงุน ุงูุชูููุฏ (ุจุฏุกูุง ูู <code>0x7c00</code> ูููุชูู ุจุงูุชุณูุณู ุงูุณุญุฑู) ุ ุณูุฃุฎุฐ QEMU ูู ุงูุงุนุชุจุงุฑ ุงูุซูุงุฆู ุจุงุนุชุจุงุฑู ุณุฌู ุงูุชูููุฏ ุงูุฑุฆูุณู (MBR) ูุตูุฑุฉ ุงููุฑุต. <br><br>  ุณุชุฑู: <br><br><img src="https://habrastorage.org/webt/e1/rk/nw/e1rknwgwcuouazuhzrmco1b8szg.png"><br><br>  ูู ูุฐุง ุงููุซุงู ุ ูุฑู ุฃู ุงูููุฏ ูุนูู ูู ุงููุถุน ุงูุญูููู 16 ุจุช ููุจุฏุฃ ูู ุงูุนููุงู <code>0x7c00</code> ูู ุงูุฐุงูุฑุฉ.  ุจุนุฏ ุงูุจุฏุก ุ ูุชุณุจุจ ูู ููุงุทุนุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">0x10</a> ุ ูุงูุชู ุจุจุณุงุทุฉ ุทุจุงุนุฉ ุญุฑู <code>!</code>  ุ  ูููุฃ 510 ุจุงูุช ุงููุชุจููุฉ <code>0xaa</code> ู <code>0x55</code> . <br><br>  ููููู ูุดุงูุฏุฉ ููู ุงูุชูุฑูุบ ุงูุซูุงุฆู ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ <code>objdump</code> : <br><br> <code>nasm -f bin boot.nasm <br> objdump -D -b binary -mi386 -Maddr16,data16,intel boot</code> <br> <br>  ุจุงูุทุจุน ุ ูู ูุทุงุน ุงูุชูููุฏ ุงูุญูููู ุ ููุงู ุฑูุฒ ูููุงุตูุฉ ุนูููุฉ ุงูุชูููุฏ ูุฌุฏูู ุงูุชูุณูู ุจุฏูุงู ูู ูุฌููุนุฉ ูู ุงูุฃุตูุงุฑ ูุนูุงูุฉ ุชุนุฌุจ :).  ูู ูุฐู ุงููุญุธุฉ ุ ูููู BIOS ุงูุชุญูู ุฅูู ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู. <br><br>  <i>ููุงุญุธุฉ</i> : ููุง ูู ููุถุญ ุฃุนูุงู ุ ูุฅู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูู ุงููุถุน ุงูุญูููู ุ  ุญูุซ ูููู ุญุณุงุจ ุงูุนููุงู ุงููุนูู ูู ุงูุฐุงูุฑุฉ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs">  =   * 16 + </code> </pre> <br>  ูุฏููุง ููุท ุชุณุฌููุงุช ููุฃุบุฑุงุถ ุงูุนุงูุฉ ุฐุงุช 16 ุจุช ุ ูุงููููุฉ ุงููุตูู ูุณุฌู 16 ุจุช ูู <code>0xffff</code> ุ ูุฐูู ุนูุฏ ุงูููู ุงูุฃูุจุฑ ุณุชููู ุงููุชูุฌุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;</span></span>&gt; hex((<span class="hljs-number"><span class="hljs-number">0xffff</span></span> * <span class="hljs-number"><span class="hljs-number">16</span></span>) + <span class="hljs-number"><span class="hljs-number">0xffff</span></span>) <span class="hljs-string"><span class="hljs-string">'0x10ffef'</span></span></code> </pre> <br>  ุญูุซ <code>0x10ffef</code> ูู <code>1  + 64  - 16 </code> .  ูุญุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุนุงูุฌ 8086</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุนุงูุฌ</a> ุงูุฃูู ูุน ุงููุถุน ุงูุญูููู) ุนูู ุณุทุฑ ุนููุงู 20 ุจุช.  ูุธุฑูุง ูุฃู <code>2^20 = 1048576</code> ุ ูุฅู ุงูุฐุงูุฑุฉ ุงููุนููุฉ ุงููุชููุฑุฉ ูู 1 ููุฌุงุจุงูุช. <br><br>  ุจุดูู ุนุงู ุ ุนูููุฉ ุงูุฐุงูุฑุฉ ูู ุงููุถุน ุงูุญูููู ูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl">  0x00000000 - 0x000003FF - ุฌุฏูู ูุงููุงุช ุงูููุงุทุนุฉ ูู ุงููุถุน ุงูุญูููู
 0x00000400 - 0x000004FF - ููุทูุฉ ุจูุงูุงุช BIOS
 0x00000500 - 0x00007BFF - ุบูุฑ ูุณุชุฎุฏู
 0x00007C00 - 0x00007DFF - ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู ุงูุฎุงุตุฉ ุจูุง
 0x00007E00 - 0x0009FFFF - ุบูุฑ ูุณุชุฎุฏู
 0x000A0000 - 0x000BFFFF - ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ููููุฏูู (VRAM) 
 0x000B0000 - 0x000B7777 - ุฐุงูุฑุฉ ููุฏูู ุฃุญุงุฏูุฉ ุงูููู
 0x000B8000 - 0x000BFFFF - ุฐุงูุฑุฉ ุงูููุฏูู ูู ูุถุน ุงูุฃููุงู
 0x000C0000 - 0x000C7FFF - BIOS ROM ููููุฏูู
 0x000C8000 - 0x000EFFFF - ููุทูุฉ ุงูุธู (ุธู BIOS)
 0x000F0000 - 0x000FFFFF - BIOS ุงููุธุงู </pre><br>  ูู ุจุฏุงูุฉ ุงูููุงู ุ ูุชุจ ุฃู ุงูุชุนูููุงุช ุงูุฃููู ูููุนุงูุฌ ุชูุน ูู <code>0xFFFFFFF0</code> ุ ููู ุฃูุซุฑ ุจูุซูุฑ ูู <code>0xFFFFF</code> (1 ููุฌุงุจุงูุช).  ููู ูููู ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุงููุตูู ุฅูู ูุฐุง ุงูุนููุงู ูู ุงููุถุน ุงูุญููููุ  ุงูุฅุฌุงุจุฉ ูู ูุซุงุฆู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุจ ุงููุงูุจ</a> : <br><br> <code>0xFFFE_0000 - 0xFFFF_FFFF: 128  ROM    </code> <br> <br>  ูู ุจุฏุงูุฉ ุงูุชูููุฐ ุ BIOS ููุณ ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุ ูููู ูู ROM. <br><br><h1 style=";text-align:right;direction:rtl">  ูุญูู ุงูุฅููุงุน </h1><br>  ูููู ุชุญููู ููุงุฉ ููููุณ ูุน ูุญูู ุฅููุงุน ูุฎุชูู ุ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GRUB 2</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">syslinux</a> .  ูุญุชูู kernel ุนูู ุจุฑูุชูููู ุชูููุฏ ูุญุฏุฏ ูุชุทูุจุงุช ุฃุฏุงุฉ ุชุญููู ุงูุชุดุบูู ูุชูููุฐ ุฏุนู Linux.  ูู ูุฐุง ุงููุซุงู ุ ูุนูู ูุน GRUB 2. <br><br>  ุงุณุชูุฑุงุฑูุง ูุนูููุฉ ุงูุชูููุฏ ุ ุญุฏุฏ BIOS ุฌูุงุฒ ุงูุชูููุฏ ูููู ุงูุชุญูู ุฅูู ูุทุงุน ุงูุชูููุฏ ุ ููุจุฏุฃ ุงูุชูููุฐ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">boot.img</a> .  ูุธุฑูุง ูุตุบุฑ ุญุฌููุง ุ ูุนุฏ ูุฐุง ุฑูุฒูุง ุจุณูุทูุง ููุบุงูุฉ.  ูุญุชูู ุนูู ูุคุดุฑ ููุงูุชูุงู ุฅูู ุงูุตูุฑุฉ ุงูุฑุฆูุณูุฉ ูู GRUB 2. ูุจุฏุฃ ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">diskboot.img</a> ูุนุงุฏุฉ ูุง ูุชู ุชุฎุฒููู ูุจุงุดุฑุฉ ุจุนุฏ ุงููุทุงุน ุงูุฃูู ูู ูุณุงุญุฉ ุบูุฑ ูุณุชุฎุฏูุฉ ูุจู ุงููุณู ุงูุฃูู.  ูุญููู ุงูุฑูุฒ ุฃุนูุงู ูู ุงูุฐุงูุฑุฉ ุจููุฉ ุงูุตูุฑุฉ ุงูุชู ุชุญุชูู ุนูู ููุงุฉ GRUB 2 ูุจุฑุงูุฌ ุชุดุบูู ูุนุงูุฌุฉ ุฃูุธูุฉ ุงููููุงุช.  ุจุนุฏ ุฐูู ุ ูุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููุฐ</a> ูุธููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">grub_main</a> . <br><br>  ุชููู ูุธููุฉ <code>grub_main</code> ุจุชููุฆุฉ ูุญุฏุฉ ุงูุชุญูู ุ ูุฅุฑุฌุงุน ุงูุนููุงู ุงูุฃุณุงุณู ูููุญุฏุงุช ุงูููุทูุฉ ุ <code>grub_main</code> ุงูุฌูุงุฒ ุงูุฌุฐุฑ ุ ูุชุญููู / ุชูุฒูุน ููู ุชูููู grub ุ ูุชุญููู ุงููุญุฏุงุช ุงูููุทูุฉ ุ ุฅูุฎ.  ูู ููุงูุฉ ุงูุชูููุฐ ุ ูุถุน ุงููุฑูุฉ ูู ุงููุถุน ุงูุนุงุฏู.  ูุธููุฉ <code>grub_normal_execute</code> (ูู ููู ุงููุตุฏุฑ <code>grub-core/normal/main.c</code> ) ุชููู ุขุฎุฑ ุงูุงุณุชุนุฏุงุฏุงุช ูุชุนุฑุถ ูุงุฆูุฉ ูุงุฎุชูุงุฑ ูุธุงู ุงูุชุดุบูู.  ุนูุฏ ุชุญุฏูุฏ ุฃุญุฏ ุนูุงุตุฑ ูุงุฆูุฉ grub ุ ูุชู <code>grub_menu_execute_entry</code> ูุธููุฉ <code>grub_menu_execute_entry</code> ุ ูุงูุชู ุชููุฐ ุฃูุฑ <code>boot</code> grub ูุชุญููู ูุธุงู ุงูุชุดุบูู ุงููุญุฏุฏ. <br><br>  ููุง ูู ููุถุญ ูู ุจุฑูุชูููู ุชูููุฏ kernel ุ ูุฌุจ ุฃู ูููู ุจุฑูุงูุฌ ุชุญููู ุงูุชูููุฏ ุจูุฑุงุกุฉ ูููุก ุจุนุถ ุญููู ุฑุฃุณ ุชุซุจูุช kernel ุ ูุงูุชู ุชุจุฏุฃ ุนูุฏ ุงูุฅุฒุงุญุฉ <code>0x01f1</code> ูู ุฑูุฒ ุชุซุจูุช kernel.  ูุดุงุฑ ุฅูู ูุฐุง ุงูุฅุฒุงุญุฉ ูู <a href="">ุงูุจุฑูุงูุฌ ุงููุตู linker</a> .  <a href="">ููุณ</a> ุฑุฃุณ kernel <a href="">/ x86 / boot / header.S</a> ูุจุฏุฃ ุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"> <span class="hljs-selector-class"><span class="hljs-selector-class">.globl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">hdr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">hdr</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">setup_sects</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.byte</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">root_flags</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ROOT_RDONLY</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">syssize</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.long</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">ram_size</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">vid_mode</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">SVGA_MODE</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">root_dev</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">boot_flag</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">xAA55</span></span></code> </pre> <br>  ูุฌุจ ุฃู ูููุฃ ูุญูู ุงูุฅููุงุน ูุฐุง ูุงูุนูุงููู ุงูุฃุฎุฑู (ุงูุชู ูุชู ูุถุน ุนูุงูุฉ ุนูููุง ููุท ูููุน <code>write</code> ูู ุจุฑูุชูููู ุชูููุฏ Linux ุ ููุง ูู ูุฐุง ุงููุซุงู) ุจููู ูุชู ุชููููุง ูู ุณุทุฑ ุงูุฃูุงูุฑ ุฃู ูุญุณูุจุฉ ูู ููุช ุงูุชูููุฏ.  ูู ูุชุทุฑู ุงูุขู ุฅูู ุงูุฃูุตุงู ูุงูุชูุณูุฑุงุช ูุฌููุน ุญููู ุงูุนูุงููู.  ุณููุงูุด ูุงุญููุง ููููุฉ ุงุณุชุฎุฏุงู ุงูููุงุฉ ููุง.  ููุญุตูู ุนูู ูุตู ูุฌููุน ุงูุญููู ุ ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑูุชูููู ุงูุชูุฒูู</a> . <br><br>  ููุง ุชุฑู ูู ุจุฑูุชูููู ุชูููุฏ kernel ุ ุณูุชู ุนุฑุถ ุงูุฐุงูุฑุฉ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl">  |  ูุถุน ุงูููุงุฉ ุงููุญูู |
 100000 + ------------------------ +
          |  ุชุนููู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ |
 0A0000 + ------------------------ +
          |  ุงูุงุญุชูุงุทู  ูู BIOS |  ุงุชุฑู ุฃูุจุฑ ูุฏุฑ ูููู ูู ุงูุญุฑูุฉ
          ~ ~
          |  ุณุทุฑ ุงูุฃูุงูุฑ |  (ูุฏ ูููู ุฃูุถูุง ุฃูู ูู X + 10000)
 X + 10000 + ------------------------ +
          |  ุชูุฏูุณ / ูููุฉ |  ูุงุณุชุฎุฏุงู ููุฏ ูุถุน kernel ุงูุญูููู
 X + 08000 + ------------------------ +
          |  ุชุฑููุจ ููุงุฉ |  ุฑูุฒ ุงููุถุน ุงูุญูููู ูู Kernel
          |  ูุทุงุน ุชูููุฏ ุงูููุงุฉ |  ูุทุงุน ุงูุชูููุฏ kernel ุงููุฏูู
        X + ------------------------ +
          |  ูุญูู |  &lt;- ููุทุฉ ุฅุฏุฎุงู 0x7C00 ูุทุงุน ุงูุชูููุฏ
 001000 + ------------------------ +
          |  ุงูุงุญุชูุงุทู  ูู MBR / BIOS |
 000800 + ------------------------ +
          |  ุชุณุชุฎุฏู ุนุงุฏุฉ  MBR |
 000600 + ------------------------ +
          |  ุชุณุชุฎุฏู  BIOS ููุท |
 000000 + ------------------------ +
</pre><br>  ูุฐูู ุ ุนูุฏูุง ูููู ุงูููุฏุฑ ุงูุชุญูู ุฅูู ุงูููุงุฉ ุ ูุจุฏุฃ ุจุงูุนููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs lisp">X + sizeof (<span class="hljs-name"><span class="hljs-name">KernelBootSector</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  ุญูุซ <code>X</code> ูู ุนููุงู ูุทุงุน ุชูููุฏ kernel.  ูู ุญุงูุชูุง ุ <code>X</code> ูู <code>0x10000</code> ุ ููุง ูู ููุถุญ ูู ุชูุฑูุบ ุงูุฐุงูุฑุฉ: <br><br><img src="https://habrastorage.org/webt/ot/1u/ep/ot1uepwbgvghzktwcbwwskwwjbs.png"><br><br>  ูุงู ุจุฑูุงูุฌ bootloader ุจููู ููุงุฉ Linux ุฅูู ุงูุฐุงูุฑุฉ ุ ูููุก ุญููู ุงูุฑุฃุณ ุ ุซู ููููุง ุฅูู ุนููุงู ุงูุฐุงูุฑุฉ ุงููุทุงุจู.  ูููููุง ุงูุขู ุงูุงูุชูุงู ูุจุงุดุฑุฉ ุฅูู ุฑูุฒ ุชุซุจูุช kernel. <br><br><h1 style=";text-align:right;direction:rtl">  ุจุฏุงูุฉ ูุฑุญูุฉ ุชุฑููุจ ุงูููุงุฉ </h1><br>  ุฃุฎูุฑุง ูุญู ูู ุตููู!  ุนูู ุงูุฑุบู ูู ุฃููุง ููุณุช ููุฏ ุงูุชุดุบูู ูู ุงููุงุญูุฉ ุงููููุฉ.  ุฃููุงู ุ ูุญุชุงุฌ ุฌุฒุก ุชุซุจูุช kernel ุฅูู ุชูููู ุดูุก ูุง ุ ุจูุง ูู ุฐูู ุจุฑูุงูุฌ ูู ุงูุถุบุท ูุจุนุถ ุงูุฃุดูุงุก ูู ุฅุฏุงุฑุฉ ุงูุฐุงูุฑุฉ.  ุจุนุฏ ูู ูุฐุง ุ ุณุชููู ุจุชูุฑูุบ ุงูููุงุฉ ุงูุญููููุฉ ูุชุฐูุจ ุฅูููุง.  ูุจุฏุฃ ุงูุชุซุจูุช ูู <a href="">arch / x86 / boot / header.S</a> ุจุญุฑู <a href="">_start</a> . <br><br>  ูููููุฉ ุงูุฃููู ุ ูุฏ ูุจุฏู ูุฐุง ุบุฑูุจูุง ุจุนุถ ุงูุดูุก ุ ูุธุฑูุง ููุฌูุฏ ุนุฏุฉ ุชุนูููุงุช ุฃูุงูู.  ูููู ููุฐ ูุชุฑุฉ ุทูููุฉ ุ ูุงู ูุฏู ููุงุฉ ููููุณ ูุญูู ุฅููุงุน ุฎุงุต ุจูุง.  ุงูุขู ุฅุฐุง ุฑูุถุช ุ ุนูู ุณุจูู ุงููุซุงู ุ <br><br> <code>qemu-system-x86_64 vmlinuz-3.18-generic</code> <br> <br>  ุณุชุฑู: <br><br><img src="https://habrastorage.org/webt/4r/5f/xg/4r5fxgpwl4l2vwlw9muscl3ygie.png"><br><br>  ูู ุงููุงูุน ุ ูุจุฏุฃ ููู <code>header.S</code> ุงูุณุญุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MZ</a> (ุงูุธุฑ ููุทุฉ ุดุงุดุฉ ุงูุชูุฑูุบ ุฃุนูุงู) ููุต ุฑุณุงูุฉ ุงูุฎุทุฃ ูุฑุฃุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PE</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs css"><span class="hljs-selector-id"><span class="hljs-selector-id">#ifdef</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">CONFIG_EFI_STUB</span></span> # "<span class="hljs-selector-tag"><span class="hljs-selector-tag">MZ</span></span>", <span class="hljs-selector-tag"><span class="hljs-selector-tag">MS-DOS</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">header</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.byte</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x4d</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.byte</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x5a</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#endif</span></span> ... ... ... <span class="hljs-selector-tag"><span class="hljs-selector-tag">pe_header</span></span>: <span class="hljs-selector-class"><span class="hljs-selector-class">.ascii</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">PE</span></span>" <span class="hljs-selector-class"><span class="hljs-selector-class">.word</span></span> 0</code> </pre> <br>  ููุงู ุญุงุฌุฉ ูุชุญููู ูุธุงู ุชุดุบูู ุจุฏุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">UEFI</a> .  ุณููุธุฑ ูู ุฌูุงุฒูุง ูู ุงููุตูู ุงูุชุงููุฉ. <br><br>  ููุทุฉ ุงูุฏุฎูู ุงููุนููุฉ ูุชุซุจูุช ุงูููุงุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">// header.S line 292 .globl _start _start:</span></span></code> </pre> <br>  ูุนุฑู ูุญูู ุงูุฅููุงุน (grub2 ูุบูุฑู) ูุฐู ุงูููุทุฉ (ุงูุฅุฒุงุญุฉ <code>0x200</code> ูู <code>MZ</code> ) ููุฐูุจ ุฅูููุง ูุจุงุดุฑุฉ ุ ุนูู ุงูุฑุบู ูู ุฃู <code>header.S</code> ูุจุฏุฃ ูู ูุณู <code>.bstext</code> ุ ุญูุซ ููุฌุฏ ูุต ุฑุณุงูุฉ ุงูุฎุทุฃ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/ /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ arch/x</span></span>86/boot/setup.ld /<span class="hljs-regexp"><span class="hljs-regexp">/ . = 0; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ current position .bstext : { *(.bstext) } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ put .bstext section to position 0 .bsdata : { *(.bsdata) }</span></span></code> </pre> <br>  ููุทุฉ ุฅุฏุฎุงู ุชุซุจูุช Kernel: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs go"> .globl _start _start: .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">0xeb</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> start_of_setup<span class="hljs-number"><span class="hljs-number">-1f</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-comment"><span class="hljs-comment">// // rest of the header //</span></span></code> </pre> <br>  ููุง ูุฑู ุฑูุฒ ุงูุนูููุฉ <code>jmp</code> ( <code>0xeb</code> ) ุ ุงูุฐู ูุฐูุจ ุฅูู ุงูููุทุฉ <code>start_of_setup-1f</code> .  ูู <code>Nf</code> ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุดูุฑ <code>2f</code> ุฅูู ุงูุชุณููุฉ ุงููุญููุฉ <code>2:</code>  ูู ุญุงูุชูุง ุ ูุฐู ูู ุงูุชุณููุฉ <code>1</code> ุ ูุงูุชู ุชููู ููุฌูุฏุฉ ูุจุงุดุฑุฉ ุจุนุฏ ุงูููู ุ ูุชุญุชูู ุนูู ูุง ุชุจูู ูู ุฑุฃุณ ุงูุฅุนุฏุงุฏ.  ูุจุงุดุฑุฉ ุจุนุฏ ุฑุฃุณ ุงูุชุซุจูุช ุ ูุฑู ูุณู <code>.entrytext</code> ุ ุงูุฐู ูุจุฏุฃ <code>start_of_setup</code> . <br><br>  ูุฐุง ูู ุงูุฑูุฒ ุงูุฃูู ุงูุฐู ุชู ุชูููุฐู ุจุงููุนู (ุจุฎูุงู ุชุนูููุงุช ุงูููุฒุฉ ุงูุณุงุจูุฉ ุ ุจุงูุทุจุน).  ุจุนุฏ ุฃู ูุชููู ุฌุฒุก ูู ุชุซุจูุช kernel ุงูุชุญูู ูู ุงูููุฏุฑ ุ ุชูุฌุฏ ุชุนูููุงุช <code>jmp</code> ุงูุฃููู ุนูุฏ ุงูุฅุฒุงุญุฉ <code>0x200</code> ูู ุจุฏุงูุฉ ูุถุน kernel ุงูุญูููู ุ ุฃู ุจุนุฏ 512 ุจุงูุช ุงูุฃููู.  ูููู ููุงุญุธุฉ ุฐูู ูู ูู ูู ุจุฑูุชูููู ุชูููุฏ kernel Linux ููู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ูู grub2: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs ruby">segment = grub_linux_real_target <span class="hljs-meta"><span class="hljs-meta">&gt;&gt; </span></span><span class="hljs-number"><span class="hljs-number">4</span></span>; state.gs = state.fs = state.es = state.ds = state.ss = segment; state.cs = segment + <span class="hljs-number"><span class="hljs-number">0x20</span></span>;</code> </pre> <br>  ูู ุญุงูุชูุง ุ ูุชู ุชุดุบูู ุงูููุงุฉ ุนูู ุงูุนููุงู <code>0x10000</code> .  ูุฐุง ูุนูู ุฃูู ุจุนุฏ ุจุฏุก ุชุซุจูุช kernel ุ ุณูููู ููุณุฌูุงุช ุงูููุทุน ุงูููู ุงูุชุงููุฉ: <br><br> <code>gs = fs = es = ds = ss = 0x10000 <br> cs = 0x10200</code> <br> <br>  ุจุนุฏ ุงูุฐูุงุจ ุฅูู <code>start_of_setup</code> ูุฌุจ ุฃู ุชููู ุงูููุงุฉ ุจูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฃูุฏ ูู ุฃู ุฌููุน ููู ุชุณุฌูู ุงูููุทุน ูู ููุณูุง </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูู ุจุชูููู ุงูููุฏุณ ุงูุตุญูุญ </li><li style=";text-align:right;direction:rtl">  ุชูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">bss</a> </li><li style=";text-align:right;direction:rtl">  ุงูุชูู ุฅูู ุฑูุฒ C ูู <a href="">arch / x86 / boot / main.c</a> </li></ul><br>  ุฏุนููุง ูุฑู ููู ูุชู ุชูููุฐ ุฐูู. <br><br><h1 style=";text-align:right;direction:rtl">  ูุญุงุฐุงุฉ ุญุงูุฉ ุงููุทุนุฉ </h1><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชุชุญูู ุงูููุงุฉ ูู ุฃู ุงูููุทุน <code>ds</code> ู <code>es</code> ูุดูุฑ ุฅูู ููุณ ุงูุนููุงู.  ุซู ููุณุญ ุนูู ุงูุงุชุฌุงู ุจุงุณุชุฎุฏุงู <code>cld</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl"> movw %ds, %ax movw %ax, %es cld</code> </pre> <br>  ููุง ูุชุจุช ุณุงุจููุง ุ ูููู grub2 ุงูุชุฑุงุถููุง ุจุชุญููู ุฑูุฒ ุชุซุจูุช kernel ุนูุฏ <code>0x10000</code> ุ ู <code>cs</code> ุนูุฏ <code>0x10200</code> ุ ูุฃู ุงูุชูููุฐ ูุง ูุจุฏุฃ ูู ุจุฏุงูุฉ ุงูููู ุ ูููู ูู ุงูุงูุชูุงู ููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs go">_start: .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> <span class="hljs-number"><span class="hljs-number">0xeb</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> start_of_setup<span class="hljs-number"><span class="hljs-number">-1f</span></span></code> </pre> <br>  ูุฐุง ูู ุฅุฒุงุญุฉ <code>512</code> ุจุงูุช ูู <a href="">4d 5a</a> .  ูู ุงูุถุฑูุฑู ุฃูุถูุง ูุญุงุฐุงุฉ <code>cs</code> ูู <code>0x10200</code> ุฅูู <code>0x10000</code> ุ ูุซู ุฌููุน ุณุฌูุงุช ุงูููุทุน ุงูุฃุฎุฑู.  ุจุนุฏ ุฐูู ูู ุจุชุซุจูุช ุงูููุฏุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl"> pushw %ds pushw $6f lretw</code> </pre> <br>  ุชุฏูุน ูุฐู ุงูุชุนูููุงุช ูููุฉ <code>ds</code> ุฅูู ุงูููุฏุณ ุ ูุชุจูุนุฉ ุจุนููุงู ุงูุชุณููุฉ <a href="">6</a> ูุชุนูููุงุช <code>lretw</code> ุ ุงูุชู ุชููู ุจุชุญููู ุนููุงู ุงูุชุณููุฉ <code>6</code> ูู ุณุฌู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนุฏุงุฏ ุงูุฃูุงูุฑ</a> ูุชุญููู <code>cs</code> ุจุงููููุฉ <code>ds</code> .  ุจุนุฏ ุฐูู ุ ุณูููู ููููู <code>ds</code> ู <code>cs</code> ููุณ ุงูููู. <br><br><h1 style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุงูููุฏุณ </h1><br>  ูู ูุฐุง ุงูุฑูุฒ ุชูุฑูุจูุง ุฌุฒุก ูู ุนูููุฉ ุฅุนุฏุงุฏ ุจูุฆุฉ C ูู ุงููุถุน ุงูุญูููู.  ุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุงูุชุญูู ูู ูููุฉ ุชุณุฌูู <code>ss</code> ูุฅูุดุงุก ุงูููุฏุณ ุงูุตุญูุญ ุฅุฐุง ูุงูุช ูููุฉ <code>ss</code> ุบูุฑ ุตุญูุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl"> movw %ss, %dx cmpw %ax, %dx movw %sp, %dx je <span class="hljs-number"><span class="hljs-number">2</span></span>f</code> </pre> <br>  ูููู ุฃู ูุคุฏู ูุฐุง ุฅูู ุซูุงุซุฉ ุณููุงุฑูููุงุช ูุฎุชููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>ss</code> ูููุฉ ุตุงูุญุฉ <code>0x1000</code> (ููุง ูู ุงูุญุงู ูุน ุฌููุน ุงูุณุฌูุงุช ุงูุฃุฎุฑู ุจุงุณุชุซูุงุก <code>cs</code> ) </li><li style=";text-align:right;direction:rtl">  <code>ss</code> ูููุฉ ุบูุฑ ุตุงูุญุฉ ูุชู <code>CAN_USE_HEAP</code> ุนูุงูุฉ <code>CAN_USE_HEAP</code> (ุงูุธุฑ ุฃุฏูุงู) </li><li style=";text-align:right;direction:rtl">  <code>ss</code> ูููุฉ ุบูุฑ ุตุงูุญุฉ ููู <code>CAN_USE_HEAP</code> ุชุนููู ุนูุงูุฉ <code>CAN_USE_HEAP</code> (ุงูุธุฑ ุฃุฏูุงู) </li></ul><br>  ุถุน ูู ุงุนุชุจุงุฑู ุฌููุน ุงูุณููุงุฑูููุงุช ุจุงูุชุฑุชูุจ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>ss</code> ูููุฉ ุตุงูุญุฉ ( <code>0x1000</code> ).  ูู ูุฐู ุงูุญุงูุฉ ุ ููุชูู ุฅูู ุงูุชุณููุฉ 2: </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs mel"><span class="hljs-number"><span class="hljs-number">2</span></span>: andw $~<span class="hljs-number"><span class="hljs-number">3</span></span>, %dx jnz <span class="hljs-number"><span class="hljs-number">3</span></span>f movw $0xfffc, %dx <span class="hljs-number"><span class="hljs-number">3</span></span>: movw %ax, %ss movzwl %dx, %esp sti</code> </pre> <br>  ูููู ููุง ุจุถุจุท ูุญุงุฐุงุฉ ุชุณุฌูู <code>dx</code> (ุงูุฐู ูุญุชูู ุนูู ูููุฉ <code>sp</code> ุงููุญุฏุฏุฉ ุจูุงุณุทุฉ ุงูููุญูู) ุฅูู <code>4</code> ุจุงูุช ูุงูุชุญูู ูู ุงูุตูุฑ.  ุฅุฐุง ูุงู ุตูุฑูุง ุ ูุฅููุง ูุถุน ุงููููุฉ <code>0xfffc</code> <code>dx</code> (ุนููุงู ูุญุงุฐู <code>4</code> ุจุงูุช ูุจู ุงูุญุฌู ุงูุฃูุตู <code>0xfffc</code> 64 ููููุจุงูุช).  ุฅุฐุง ูู ููู ูุณุงูู ุงูุตูุฑ ุ ูุฅููุง ููุงุตู ุงุณุชุฎุฏุงู ูููุฉ <code>sp</code> ุงููุญุฏุฏุฉ ุจูุงุณุทุฉ ุฃุฏุงุฉ <code>0xf7f4</code> ( <code>0xf7f4</code> ูู ุญุงูุชูุง).  ุซู ูุถุน ูููุฉ <code>ax</code> ูู <code>ss</code> ุ ููุง ูุญูุธ ุนููุงู ุงูููุทุน ุงูุตุญูุญ <code>0x1000</code> <code>sp</code> ุงูุตุญูุญ.  ุงูุขู ูุฏููุง ุงูููุฏุณ ุงูุตุญูุญ: <br><br><img src="https://habrastorage.org/webt/wf/dp/bl/wfdpblqpiltzdrprytvnoj3kygo.png"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุณููุงุฑูู ุงูุซุงูู ุ <code>ss != ds</code> .  ุฃููุงู ูุถุน ุงููููุฉ <a href="">_end</a> (ุนููุงู ููุงูุฉ ุฑูุฒ ุงูุชุซุจูุช) ูู <code>dx</code> <code>loadflags</code> ุญูู ุงูุฑุฃุณ ุ ุจุงุณุชุฎุฏุงู ุชุนูููุงุช <code>testb</code> ููุชุญูู ููุง ุฅุฐุง ูุงู ูููู ุงุณุชุฎุฏุงู ุงููููุฉ.  <a href="">loadflags</a> ูู ุฑุฃุณ ููุงุน ุงูุจุช ุงูุฐู ูุชู ุชุนุฑููู ุนูู ุงููุญู ุงูุชุงูู: </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> LOADED_HIGH (1&lt;&lt;0) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> QUIET_FLAG (1&lt;&lt;5) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> KEEP_SEGMENTS (1&lt;&lt;6) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CAN_USE_HEAP (1&lt;&lt;7)</span></span></code> </pre> <br>  ูููุง ูู ููุถุญ ูู ุจุฑูุชูููู ุงูุชูููุฏ: <br><br> <code> : loadflags <br> <br>     . <br> <br>  7 (): CAN_USE_HEAP <br>     1,  ,   <br> heap_end_ptr .    ,   <br>   .</code> <br> <br>  ุฅุฐุง ุชู <code>CAN_USE_HEAP</code> ุจุช <code>CAN_USE_HEAP</code> ุ ูุฅููุง ูู <code>dx</code> ูููู ุจุชุนููู ุงููููุฉ <code>heap_end_ptr</code> (ุงูุชู ุชุดูุฑ ุฅูู <code>_end</code> ) ููุถูู <code>STACK_SIZE</code> ุฅูููุง (ุงูุญุฏ ุงูุฃุฏูู ูุญุฌู ุงูููุฏุณ ูู <code>1024</code> ุจุงูุช).  ุจุนุฏ ุฐูู ุ ุงูุชูู ุฅูู ุงูุชุณููุฉ <code>2</code> (ููุง ูู ุงูุญุงูุฉ ุงูุณุงุจูุฉ) ููู ุจุนูู ุงูููุฏุณ ุงูุตุญูุญ. <br><br><img src="https://habrastorage.org/webt/1n/be/nw/1nbenww3ncnipvbi1g-jqdvsmok.png"><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู <code>CAN_USE_HEAP</code> ุชุนููู <code>CAN_USE_HEAP</code> ุณูู ุงุณุชุฎุฏุงู ุงูุญุฏ ุงูุฃุฏูู ูู ุงูููุฏุณ ูู <code>_end</code> ุฅูู <code>_end + STACK_SIZE</code> : </li></ul><br><img src="https://habrastorage.org/webt/5x/xg/fi/5xxgfikk1iskr_6pgjzvmcwhpjy.png"><br><br><h1 style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ BSS </h1><br>  ููุงู ุญุงุฌุฉ ุฅูู ุฎุทูุชูู ุฅุถุงููุชูู ูุจู ุงูุงูุชูุงู ุฅูู ุฑูุฒ C ุงูุฑุฆูุณู: ูุฐุง ูู ุฅุนุฏุงุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุทูุฉ BSS</a> ูุงูุชุญูู ูู ุงูุชูููุน "ุงูุณุญุฑู".  ุงูุชุญูู ูู ุงูุชูููุน ุฃููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">cmpl</span></span> <span class="hljs-variable"><span class="hljs-variable">$0</span></span>x5a5aaa55, setup_sig jne setup_bad</code> </pre> <br>  ุชูุงุฑู ุงูุชุนูููุงุช ุจุจุณุงุทุฉ <a href="">setup_sig ุจุงูุฑูู</a> ุงูุณุญุฑู 0x5a5aaa55.  ุฅุฐุง ูู ุชูู ูุชุณุงููุฉ ุ ูุชู ุงูุฅุจูุงุบ ุนู ุฎุทุฃ ูุงุฏุญ. <br><br>  ุฅุฐุง ูุงู ุงูุฑูู ุงูุณุญุฑู ูุทุงุจููุง ููุฏููุง ูุฌููุนุฉ ูู ุณุฌูุงุช ุงูููุทุน ุงูุตุญูุญุฉ ูููุฏุณูุง ุ ููู ูุง ุชุจูู ูู ุชูููู ูุณู BSS ูุจู ุงููุชุงุจุนุฉ ุฅูู ุฑูุฒ C. <br><br>  ูุชู ุงุณุชุฎุฏุงู ูุณู BSS ูุชุฎุฒูู ุงูุจูุงูุงุช ุบูุฑ ุงููููุฃุฉ ุจุดูู ุซุงุจุช.  ูุชุญูู Linux ุจุนูุงูุฉ ูู ุฅุนุงุฏุฉ ุชุนููู ููุทูุฉ ุงูุฐุงูุฑุฉ ูุฐู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl"> movw $__bss_start, %di movw $_end+<span class="hljs-number"><span class="hljs-number">3</span></span>, %cx xorl %eax, %eax subw %di, %cx shrw $2, %cx rep; stosl</code> </pre> <br>  ุฃููุงู ุ <a href="">ูุชู</a> ููู ุนููุงู ุจุฏุก <a href="">__bss_start</a> ุฅูู <code>di</code> .  ุซู ูุชู ููู ุงูุนููุงู <code>_end + 3</code> (+3 ูููุญุงุฐุงุฉ ุจู 4 ุจุงูุช) ุฅูู <code>cx</code> .  ูุชู ูุณุญ ุณุฌู <code>eax</code> (ุจุงุณุชุฎุฏุงู ุชุนูููุงุช <code>xor</code> ) ุ ููุชู ุญุณุงุจ ุญุฌู ูุณู bss ( <code>cx-di</code> ) ุ ููุชู ูุถุนู ูู <code>cx</code> .  ุซู ูุชู ุชูุณูู <code>cx</code> ุฅูู ุฃุฑุจุนุฉ (ุญุฌู "ุงููููุฉ") ููุชู ุงุณุชุฎุฏุงู ุชุนูููุงุช <code>stosl</code> ุ ูุชุฎุฒูู ุงููููุฉ <code></code> (ุตูุฑ) ูู ุงูุนููุงู ูุดูุฑูุง ุฅูู <code>di</code> ุ ูุฒูุงุฏุฉ <code>di</code> ุชููุงุฆููุง ุจููุฏุงุฑ ุฃุฑุจุนุฉ ูุชูุฑุงุฑ ุฐูู ุญุชู ูุตู <code></code> ุฅูู ุงูุตูุฑ).  ุงูุชุฃุซูุฑ ุงูุตุงูู ููุฐุง ุงูุฑูุฒ ูู ูุชุงุจุฉ ุงูุฃุตูุงุฑ ูุฌููุน ุงููููุงุช ูู ุงูุฐุงูุฑุฉ ูู <code>__bss_start</code> ุฅูู <code>_end</code> : <br><br><img src="https://habrastorage.org/webt/2s/bw/ym/2sbwymhai1qislpkru0btkrolcy.png"><br><br><h1 style=";text-align:right;direction:rtl">  ุงูุชูู ุฅูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ </h1><br>  ูุฐุง ูู ุดูุก: ูุฏููุง ููุฏุณ ู BSS ุ ูุฐูู ููููู ุงูุงูุชูุงู ุฅูู ุงููุธููุฉ <code>main()</code> C: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">calll</span></span> main</code> </pre> <br>  ุชูุน ุงููุธููุฉ <code>main()</code> ูู <a href="">arch / x86 / boot / main.c.</a>  ุณูุชุญุฏุซ ุนููุง ูู ุงูุฌุฒุก ุงูุชุงูู. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h1><br>  ูุฐุง ูู ููุงูุฉ ุงูุฌุฒุก ุงูุฃูู ุนู ุฌูุงุฒ Linux kernel.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูุงู ูุฏูู ุฃุณุฆูุฉ ุฃู ุงูุชุฑุงุญุงุชุ ูุฑุฌู ุงูุงุชุตุงู ุจู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุชููุชุฑ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ุนูู </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู ูุฌุฑุฏ ุฅูุดุงุก </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฐูุฑุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูู ุงูุฌุฒุก ุงููุงุฏู ุณูู ูุฑู ุฑูุฒ ุงูุฃูู ูู Cุ ูุงูุชู ุชุชู ุฃุซูุงุก ุชุซุจูุช ููุงุฉ ููููุณุ ูุชูููุฐ ุงูุจุฑุงูุฌ ุงููุฑุนูุฉ ุงูุฐุงูุฑุฉุ ูุซู </font></font><code>memset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ </font></font><code>earlyprintk</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุชูููุฐ ุงููุจูุฑ ูุชููุฆุฉ ูุญุฏุฉุ ูุฃูุซุฑ ูู ุฐูู.</font></font><br><br><h1 style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุฌุน ุฅูุชู 80386 ูููุจุฑูุฌูู 1986</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุญุฏ ุงูุฃุฏูู ูู ูุญูู ุงูุฅููุงุน ูุจููุฉ ุฅูุชู</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8086</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">80386</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุนุงุฏุฉ ุชุนููู ูุงูู</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุถุน ุงูุญูููู</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุฑูุชูููู ุชูููุฏ ููุงุฉ ููููุณ</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏููู ูุทูุฑู Coreboot</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุฉ ููุงุทุนุฉ ุฑุงูู ุจุฑุงูู</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุตุฏุฑ ุงูุทุงูุฉ</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุดุงุฑุฉ "ุงูููุฉ ุนูู ูุง ูุฑุงู"</font></font></a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar428664/">https://habr.com/ru/post/ar428664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar428654/index.html">ุฏูุฑุฉ ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง "ุฃูู ุฃูุธูุฉ ุงูููุจููุชุฑ". ุงููุญุงุถุฑุฉ 15: ุงูุจุฑูุฌูุงุช ุงูุทุจูุฉ ุ ุงูุฌุฒุก ุงูุซุงูู</a></li>
<li><a href="../ar428656/index.html">ุฏูุฑุฉ ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง "ุฃูู ุฃูุธูุฉ ุงูููุจููุชุฑ". ุงููุญุงุถุฑุฉ 15: ุงูุจุฑูุฌูุงุช ุงูุทุจูุฉ ุ ุงูุฌุฒุก 3</a></li>
<li><a href="../ar428658/index.html">ูุฑุด ุนูู ุชุนููููุฉ ูุฌุงููุฉ ูู ููุชุจ Mail.Ru Group</a></li>
<li><a href="../ar428660/index.html">ุชูููู ุณูุงุณุงุช ุทูุจ ุงูุณุญุจ ุงูููุณุนุฉ ูู VSTS ูุฏุนู ุนูููุฉ ุงูุชุทููุฑ</a></li>
<li><a href="../ar428662/index.html">ูููุฉ ุจุฑูุฌุฉ ุงูุจูุน ุจุงูุชุฌุฒุฆุฉ</a></li>
<li><a href="../ar428666/index.html">ููู ุฃูุดุฃุช ุฑุณูููุง ูุชุญุฑูุฉ ุชุบูุฑ ุงููุฒุงุฌ ุจุงุณุชุฎุฏุงู ุฃููุนุฉ CSS</a></li>
<li><a href="../ar428668/index.html">ุฃุนููุช Blizzard ุนู ุฅุทูุงู ุฅุนุงุฏุฉ ุฅุตุฏุงุฑ WarCraft III ูู 2019. ุงูุชุญ ุงูุทูุจ ุงููุณุจู</a></li>
<li><a href="../ar428672/index.html">ูุธุฑุฉ ุนุงูุฉ ุนูู QuietOn Active Squelch</a></li>
<li><a href="../ar428674/index.html">ุจูุงุก ุชูุฌูู ุงูุนููู / ุงูุจุญุซ ุงูุฏูุงูู ูู Profi.ru</a></li>
<li><a href="../ar428676/index.html">ูุณุฑ ุงูุฃุณุณ ุงูุฃุณุงุณูุฉ ูู C #: ุชุฎุตูุต ุงูุฐุงูุฑุฉ ูููุน ูุฑุฌุนู ุนูู ุงูููุฏุณ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>