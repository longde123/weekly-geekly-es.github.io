<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî≠ üí™ üè¥‚Äç‚ò†Ô∏è ArduPilot f√ºr Anf√§nger. Installieren und konfigurieren Sie auf BeagleBone Blue üèùÔ∏è üéñÔ∏è üë©üèø‚Äçü§ù‚Äçüë©üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir mit einem Team ( dem Sie beitreten k√∂nnen ) von Gleichgesinnten aus Habr entwickeln einen Roboter zum Sammeln von Golfb√§llen auf der Driving Range...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ArduPilot f√ºr Anf√§nger. Installieren und konfigurieren Sie auf BeagleBone Blue</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/robogazon/blog/429510/"> Wir mit einem Team ( <b>dem Sie beitreten k√∂nnen</b> ) von Gleichgesinnten aus Habr entwickeln einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Roboter zum Sammeln von Golfb√§llen auf der Driving Range</a> .  Dies ist ein hochspezialisierter Serviceroboter. Daher planen wir, gleichzeitig einen einzigen Software- und Hardwarekomplex zu entwickeln, der in Zukunft als Grundlage f√ºr andere Serviceroboter und <b>UGV verwendet werden k√∂nnte</b> . <br><br><img src="https://habrastorage.org/webt/3x/wy/of/3xwyof39bhwkwbvvqoyjqmxdmay.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Im letzten Beitrag haben</a> wir beschrieben, warum wir mit dieser Software aufgeh√∂rt haben.  Bei der Einrichtung unseres Projekts haben wir die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen aus dem Artikel verwendet</a> .  Eigentlich pr√§sentieren wir hier die √úbersetzung dieser Kurzanleitung, vielleicht ist sie f√ºr jemanden n√ºtzlich und hilft Ihnen bei der Herstellung Ihres ersten oder n√§chsten Roboters. <br><a name="habracut"></a><br>  Bevor ich anfange, m√∂chte ich betonen, dass es sich lohnt, BeagleBone Blue zu verwenden (es ist immer noch blau).  In der Regel werden einige Peripherieger√§te im Zusammenhang mit der Navigation angeschlossen, die ohne ausreichende Stromversorgung nicht ordnungsgem√§√ü funktionieren. <br><br><h2>  Teil 1. Vorbereiten des BeagleBone </h2><br>  Gehen Sie zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://rcn-ee.net/rootfs/bb.org/testing/</a> und w√§hlen Sie das Verzeichnis mit dem neuesten Datum aus.  √ñffnen Sie dann das Unterverzeichnis der <b>Stretch-Konsole</b> .  Hier sehen Sie mehrere Dateien.  Laden Sie eine Datei mit dem Namen <b>"Bone-Debian-VV-Konsole-Armhf-20YY-MM-DD-1gb.img.xz" herunter</b> .  Dies ist eine minimale Debian-Distribution, die nur das Wesentliche enth√§lt.  Eine Alternative ist das IoT-Image (IoT = Internet of Things), das mit zus√§tzlicher Software geliefert wird und die Arbeit komfortabler macht, wenn Sie Linux noch nicht kennen.  Es ist auf derselben Website verf√ºgbar. <br><br>  Wir verwenden: <a href="">https://rcn-ee.net/rootfs/bb.org/testing/2018-10-07/stretch-console/bone-debian-9.5-console-armhf-2018-10-07-1gb.img .xz</a> . <br><br>  Als n√§chstes m√ºssen Sie das Bild auf der microSD-Karte flashen.  Unabh√§ngig davon, ob Sie Linux oder Windows verwenden, empfehle ich dringend ein Programm namens Etcher f√ºr diese Aufgabe ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://etcher.io/</a> ). <br><br>  Jetzt k√∂nnen Sie BeagleBone Blue von der microSD-Karte herunterladen.  Dies w√ºrde den Rahmen dieses Dokuments sprengen, um alle Interaktionsmethoden detailliert zu beschreiben. Dies wird jedoch h√§ufig durch eine Verbindung √ºber ein Micro-USB-Kabel oder √ºber SSH (an 'debian@192.168.7.2', Passwort 'temppwd') oder √ºber einen COM-Port ( Debian-Benutzer ', Passwort' temppwd) in ein Programm wie minicom oder PuTTY.  Diese Verbindung zur Linux-Konsole √ºber den COM-Port.  UART1 bei BBB-Builds ist immer an die Konsole gebunden, zuerst U-Boot und dann Linux.  Weitere Informationen finden Sie hier: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://beagleboard.org/blue</a> <br><br>  BeagleBone-Treiber werden mit Windows 10 geliefert. Unter Linux wird BBB als universeller USB-COM-Anschluss m√∂glicherweise nicht verwendet.  Wenn Sie Probleme haben, versuchen Sie: <br><br><pre><code class="bash hljs">sudo -s cat &gt;/etc/udev/rules.d/73-beaglebone.rules &lt;&lt;EOF ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"usb"</span></span>, ENV{DEVTYPE}==<span class="hljs-string"><span class="hljs-string">"usb_interface"</span></span>, ATTRS{idVendor}==<span class="hljs-string"><span class="hljs-string">"0403"</span></span>, ATTRS{idProduct}==<span class="hljs-string"><span class="hljs-string">"a6d0"</span></span>, DRIVER==<span class="hljs-string"><span class="hljs-string">""</span></span>, RUN+=<span class="hljs-string"><span class="hljs-string">"/sbin/modprobe -b ftdi_sio"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"drivers"</span></span>, ENV{DEVPATH}==<span class="hljs-string"><span class="hljs-string">"/bus/usb-serial/drivers/ftdi_sio"</span></span>, ATTR{new_id}=<span class="hljs-string"><span class="hljs-string">"0403 a6d0"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"ttyUSB*"</span></span>, ATTRS{interface}==<span class="hljs-string"><span class="hljs-string">"BeagleBone"</span></span>, ATTRS{bInterfaceNumber}==<span class="hljs-string"><span class="hljs-string">"00"</span></span>, SYMLINK+=<span class="hljs-string"><span class="hljs-string">"beaglebone-jtag"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"ttyUSB*"</span></span>, ATTRS{interface}==<span class="hljs-string"><span class="hljs-string">"BeagleBone"</span></span>, ATTRS{bInterfaceNumber}==<span class="hljs-string"><span class="hljs-string">"01"</span></span>, SYMLINK+=<span class="hljs-string"><span class="hljs-string">"beaglebone-serial"</span></span> EOF udevadm control --reload-rules <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre> <br>  Ich hoffe, Sie sind jetzt in der Befehlszeile angemeldet.  Wir beginnen damit, dass der Debian-Benutzer sudo ausf√ºhren kann, ohne jedes (nachfolgende) Mal ein Passwort eingeben zu m√ºssen: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"debian ALL=(ALL) NOPASSWD: ALL"</span></span> | sudo tee -a /etc/sudoers.d/debian &gt;/dev/null</code> </pre><br>  Die n√§chste Aufgabe besteht darin, die Software √ºber eine kosteng√ºnstige Internetverbindung zu aktualisieren und zu installieren. Daher ist es an der Zeit, connman f√ºr den Wi-Fi-Zugang einzurichten.  Ich mache das, weil es die Arbeit in Zukunft erleichtern wird.  Notieren Sie sich zun√§chst die SSID und das WLAN-Passwort Ihres Routers.  Geben Sie dann Folgendes ein: <br><br><pre> <code class="bash hljs"> sudo -s connmanctl services | grep <span class="hljs-string"><span class="hljs-string">'&lt;your SSID&gt;'</span></span> | grep -Po <span class="hljs-string"><span class="hljs-string">'wifi_[^ ]+'</span></span></code> </pre><br>  Die Antwort sieht ungef√§hr so ‚Äã‚Äãaus: 'wifi_38d279e099a8_4254487562142d4355434b_managed_psk'.  Wenn Sie nichts sehen, versuchen Sie es erneut - Sie haben wahrscheinlich einen Tippfehler gemacht. <br><br>  Mit dieser Netzwerk-ID geben wir die Datei nun zeilenweise direkt √ºber die Tastatur (stdin) mit cat ein: <br><br><pre> <code class="bash hljs"> cat &gt;/var/lib/connman/wifi.config [service_&lt;your <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span>&gt;] Type = wifi Security = wpa2 Name = &lt;your SSID&gt; Passphrase = &lt;your WiFi password&gt;</code> </pre><br>  Wichtig!  Dr√ºcken Sie vor Strg + C unbedingt die Eingabetaste, da sonst die gesamte aktuelle Zeile verloren geht. <br>  Dr√ºcken Sie zum Beenden Strg-C und geben Sie Folgendes ein: exit <br><br>  Die sichtbare gr√ºne LED leuchtet auf, was bedeutet, dass WLAN aktiviert ist.  BBBlue ist mit dem Router verbunden und seine IP-Adresse in Ihrem Wi-Fi-Netzwerk kann wie folgt ermittelt werden: <br><br><pre> <code class="bash hljs">ip addr show wlan0</code> </pre><br>  Wenn Sie BBBlue aus irgendeinem Grund nicht direkt anfordern k√∂nnen, verwenden Sie andere Dienstprogramme wie nmap (sudo nmap 192.168.0.0/24) oder melden Sie sich bei Ihrem Router an und suchen Sie dort auf andere Weise nach der IP-Adresse. <br><br>  Versuchen Sie nun, √ºber die Wi-Fi-IP-Adresse eine Verbindung √ºber SSH herzustellen.  Denken Sie daran, dass 192.168.7.2 auch funktioniert. <br><br>  Wenn Sie WiFi nicht f√ºr Connman verwenden k√∂nnen oder Connman einfach nicht verwenden m√∂chten, k√∂nnen Sie die folgende Methode verwenden.  Geben Sie zun√§chst Folgendes ein: sudo systemctl disable connman.  Bearbeiten Sie dann mit Ihrer SSID und Ihrem WLAN-Passwort / etc / network / interfaces <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># The loopback network interface. auto lo iface lo inet loopback # WiFi w/ onboard device (dynamic IP). auto wlan0 iface wlan0 inet dhcp wpa-ssid "&lt;your SSID&gt;" wpa-psk "&lt;your WiFi password&gt;" dns-nameservers 8.8.8.8 1.1.1.1 # Ethernet/RNDIS gadget (g_ether). # Used by: /opt/scripts/boot/autoconfigure_usb0.sh iface usb0 inet static address 192.168.7.2 netmask 255.255.255.252 network 192.168.7.0 gateway 192.168.7.1</span></span></code> </pre><br>  Laden Sie nun BBBlue neu mit: <b>sudo reboot</b> <br><br>  Geben Sie nach dem Anmelden Folgendes ein: sudo ifup wlan0.  Die gr√ºne LED sollte aufleuchten. <br><br>  Wenn Sie m√∂chten, dass der BB eine statische IP hat (z. B. 192.168.0.99), √§ndern Sie den Abschnitt "# WiFi mit integriertem Ger√§t (dynamische IP)". Zu lesender Abschnitt / etc / network / interfaces: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># WiFi w/ onboard device (static IP). auto wlan0 iface wlan0 inet static wpa-ssid "&lt;your SSID&gt;" wpa-psk "&lt;your WiFi password&gt;" address 192.168.0.99 # &lt;--- The desired static IP address of the BBBlue. netmask 255.255.255.0 gateway 192.168.0.1 # &lt;--- The address of your router. dns-nameservers 8.8.8.8 1.1.1.1</span></span></code> </pre><br>  Aktualisieren und Installieren aller erforderlichen Support-Programme: <br><br><pre> <code class="bash hljs">sudo apt-get -y update sudo apt-get -y dist-upgrade sudo apt-get install -y cpufrequtils git</code> </pre><br>  Skripte aktualisieren: cd / opt / scripts &amp; &amp; git pull <br><br>  <b>Der Echtzeit-Kernel enth√§lt derzeit Fehler!</b>  <b>Verwenden Sie den folgenden Fix: Geben Sie den Ti-Echtzeitkern 4_4 an.</b>  <b>Verwenden Sie nicht 4_14.</b> <br><br><pre> <code class="bash hljs">sudo /opt/scripts/tools/update_kernel.sh --ti-rt-channel --lts-4_4 sudo sed -i <span class="hljs-string"><span class="hljs-string">'s|uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-14-TI-00A0.dtbo|#uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-14-TI-00A0.dtbo|g'</span></span> /boot/uEnv.txt sudo sed -i <span class="hljs-string"><span class="hljs-string">'s|#uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-4-TI-00A0.dtbo|uboot_overlay_pru=/lib/firmware/AM335X-PRU-RPROC-4-4-TI-00A0.dtbo|g'</span></span> /boot/uEnv.txt</code> </pre><br>  Kopieren Sie abschlie√üend am335x -bone blue.dtb (aus dem bin-Verzeichnis in diesem Repository) nach /boot/dtbs/4.4.113-ti-rt-r149 <br><br>  Installieren Sie das Skript bei der automatischen Ausf√ºhrung <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/#dtb=/dtb=am335x-boneblue.dtb/g'</span></span> /boot/uEnv.txt</code> </pre><br>  Frequenz einstellen <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/GOVERNOR="ondemand"/GOVERNOR="performance"/g'</span></span> /etc/init.d/cpufrequtils</code> </pre><br>  Konfigurieren von bb-wl18xx-wlan0.service <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/RestartSec=5/RestartSec=1/g'</span></span> /lib/systemd/system/bb-wl18xx-wlan0.service</code> </pre><br>  Konfigurieren von bb-wl18xx-wlan0.service <br><br><pre> <code class="bash hljs">sudo sed -i <span class="hljs-string"><span class="hljs-string">'s/RestartSec=5/RestartSec=1/g'</span></span> /lib/systemd/system/bb-wl18xx-wlan0.service</code> </pre><br>  Bluetooth deaktivieren (optional) <br><br><pre> <code class="bash hljs">sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> bb-wl18xx-bluetooth.service</code> </pre><br>  Erweitern Sie die vorhandene microSD-Kartenpartition (/ dev / mmcblk0p1): <br><br><pre> <code class="bash hljs">sudo /opt/scripts/tools/grow_partition.sh</code> </pre><br>  Jetzt neu starten: <br><br><pre> <code class="bash hljs">sudo reboot</code> </pre><br><h2>  Teil 2. Installieren Sie ArduPilot auf einem BeagleBone </h2><br>  Beim Neustart von BeagleBone m√ºssen einige Textdateien erstellt werden.  Verbessern Sie zun√§chst die Umgebungskonfigurationsdatei / etc / default / ardupilot: <br>  <i>(Hinweis: Geben Sie sudoedit / etc / default / ardupilot ein und geben Sie Ihre eigene Ziel-IP-Adresse ein, z. B. 192.168.0.13.)</i> <br><br><pre> <code class="bash hljs">TELEM1=<span class="hljs-string"><span class="hljs-string">"-C /dev/ttyO1"</span></span> TELEM2=<span class="hljs-string"><span class="hljs-string">"-A udp:&lt;target IP address&gt;:14550"</span></span> GPS=<span class="hljs-string"><span class="hljs-string">"-B /dev/ttyS2"</span></span></code> </pre><br>  Dies ist eine ziemlich typische Konfiguration. <br><br>  Dies ist der Startparameter -C, der die serielle Schnittstelle ‚ÄûTelem1‚Äú von ArduPilot (SERIAL1, Standard 57600) f√ºr UART1 in BBBlue abbildet.  Zum Beispiel habe ich ein 868x RFDesign-Radio an UART1 angeschlossen.  Dies ist ein bidirektionaler Datenkanal mit meiner Drohne.  Es sendet verschiedene Telemetriedaten an die Basisstation und empf√§ngt RTK-Befehle und Differentialkorrekturen von der Basisstation. <br><br>  Dies ist der Startparameter -A, der den seriellen Port ‚ÄûConsole‚Äú von ArduPilot (SERIAL0, Standard 115200) mit Protokoll, Ziel-IP-Adresse und optionaler Portnummer zuordnet.  Auf diese Weise kann ich beispielsweise MAVLink-Daten empfangen, die zu Testzwecken √ºber WLAN eingehen.  Sehr n√ºtzlich, zumal die Daten sofort an Mission Planner und QGroundControl gesendet werden k√∂nnen. <br><br><img src="https://habrastorage.org/webt/3d/d7/m1/3dd7m1ilxlbkd3elqxnddq_1rcm.jpeg" alt="Bild"><br><br>  Dies ist der Startparameter -B, der die serielle GPS-Schnittstelle von ArduPilot (SERIAL3, Standard 57600) mit Uart2 BBBlue (UART, vage markiert 'GPS' auf der Karte selbst) abbildet.  Zum Beispiel habe ich einen U-blox NEO-M8P an UART2 angeschlossen. <br><br>  Es gibt andere M√∂glichkeiten - es gibt andere Startoptionen mit vordefinierten Portgeschwindigkeiten und den Ports selbst: <br><br><pre> <code class="bash hljs">Switch -A --&gt; <span class="hljs-string"><span class="hljs-string">"Console"</span></span>, SERIAL0, default 115200 Switch -B --&gt; <span class="hljs-string"><span class="hljs-string">"GPS"</span></span>, SERIAL3, default 57600 Switch -C --&gt; <span class="hljs-string"><span class="hljs-string">"Telem1"</span></span>, SERIAL1, default 57600 Switch -D --&gt; <span class="hljs-string"><span class="hljs-string">"Telem2"</span></span>, SERIAL2, default 38400 Switch -E --&gt; Unnamed, SERIAL4, default 38400 Switch -F --&gt; Unnamed, SERIAL5, default 57600</code> </pre><br>  Weitere Informationen zu den verschiedenen seriellen Schnittstellen finden Sie in der offiziellen ArduPilot-Dokumentation: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://ardupilot.org/plane/docs/parameters.html?highlight=parameters</a> <br><br>  Als N√§chstes erstellen wir die ArduPilot systemd-Dienstdateien, eine f√ºr den ArduCopter, /lib/systemd/system/arducopter.service: <br><br><pre> <code class="bash hljs">[Unit] Description=ArduCopter Service After=networking.service StartLimitIntervalSec=0 Conflicts=arduplane.service ardurover.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/arducopter <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br>  Eine f√ºr ArduPlane, /lib/systemd/system/arduplane.service: <br><br><pre> <code class="bash hljs">[Unit] Description=ArduPlane Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service ardurover.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/arduplane <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br>  Eine f√ºr ArduRover, /lib/systemd/system/ardurover.service: <br><br><pre> <code class="bash hljs">[Unit] Description=ArduRover Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service arduplane.service antennatracker.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/ardurover <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br>  Wie w√§re es auch mit AntennaTracker?  Erstellen Sie /lib/systemd/system/antennatracker.service: <br><br><pre> <code class="bash hljs">[Unit] Description=AntennaTracker Service After=networking.service StartLimitIntervalSec=0 Conflicts=arducopter.service arduplane.service ardurover.service [Service] EnvironmentFile=/etc/default/ardupilot ExecStartPre=/usr/bin/ardupilot/aphw ExecStart=/usr/bin/ardupilot/antennatracker <span class="hljs-variable"><span class="hljs-variable">$TELEM1</span></span> <span class="hljs-variable"><span class="hljs-variable">$TELEM2</span></span> <span class="hljs-variable"><span class="hljs-variable">$GPS</span></span> Restart=on-failure RestartSec=1 [Install] WantedBy=multi-user.target</code> </pre><br>  Gehen wir zum sudo-Ordner mkdir -p / usr / bin / ardupilot <br><br>  Erstellen Sie eine Eisenkonfigurationsdatei f√ºr ArduPilot, / usr / bin / ardupilot / aphw, die vor ausf√ºhrbaren Dateien ausgef√ºhrt wird. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # aphw # ArduPilot hardware configuration. /bin/echo 80 &gt;/sys/class/gpio/export /bin/echo out &gt;/sys/class/gpio/gpio80/direction /bin/echo 1 &gt;/sys/class/gpio/gpio80/value /bin/echo pruecapin_pu &gt;/sys/devices/platform/ocp/ocp:P8_15_pinmux/state</span></span></code> </pre><br>  Die Zeilen 5 bis 7 enthalten BBBlue + 5 V Servospannung, d. H. Wenn Sie Servos verwenden.  Wird f√ºr ESC nicht ben√∂tigt. <br><br>  Zeile 8 enth√§lt die PRU. <br><br>  Verwenden Sie sudo chmod 0755 / usr / bin / ardupilot / aphw, um Berechtigungen f√ºr diese Datei festzulegen. <br><br>  Fast passiert!  Jetzt sollten Sie die neuesten ausf√ºhrbaren Dateien f√ºr ArduCopter, ArduPlane usw. erhalten, die speziell f√ºr die Arm BBBlue-Architektur erstellt wurden, und diese im Verzeichnis / usr / bin / ardupilot ablegen.  Mirko Denecke hat sie hier auf seiner Website hochgeladen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://bbbmini.org/download/blue/</a> <br><br>  Kopieren Sie in dieses Repository: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/imfatant/test/blob/master/bin/</a> <br><br>  Vergessen Sie nicht, die Rechte festzulegen: sudo chmod 0755 / usr / bin / ardupilot / a * <br><br>  Wenn Sie feststellen, dass Sie aus dem Quellcode kompilieren m√ºssen, haben Sie keine Angst - es ist nicht so schwierig.  Dies bedeutet au√üerdem, dass Sie Ihre eigene ArduPilot-Software erstellen k√∂nnen. <br><br>  Das Sammeln auf dem BBBlue selbst wird zu lange dauern.  Patrick Poirier erkl√§rt auf seiner Website den Prozess f√ºr BBBMINI (basierend auf dem schwarzen BeagleBone).  Hier ist die BBBlue-spezifische Prozedur, vorausgesetzt, Sie haben alle bisherigen Schritte ausgef√ºhrt und befinden sich im Verzeichnis / home / debian: <br><br><pre> <code class="bash hljs">sudo apt-get install g++ make pkg-config python python-dev python-lxml python-pip sudo pip install future git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ArduPilot/ardupilot <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ardupilot git checkout Copter-3.6 <span class="hljs-comment"><span class="hljs-comment"># &lt;-- For ArduCopter. git submodule update --init --recursive ./waf configure --board=blue # &lt;-- BeagleBone Blue. ./waf sudo cp ./build/blue/bin/a* /usr/bin/ardupilot</span></span></code> </pre><br>  Patrick bietet auch Anweisungen zum Cross-Kompilieren auf einem relativ leistungsstarken x64-Desktop-PC in Ubuntu, der viel, viel schneller ist. <br><br>  Abh√§ngig davon, welche Softwareoption Sie ben√∂tigen <br>  sudo systemctl enable arducopter.service <br>  oder <br>  sudo systemctl enable arduplane.service <br>  oder <br>  sudo systemctl enable ardurover.service <br>  oder <br>  sudo systemctl enable antennatracker.service <br><br>  Nach dem Neustart sollte Ihr ArduPilot automatisch gestartet werden.  Sie sehen eine blinkende rote LED! <br><br>  Sie k√∂nnen systemctl auschecken ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.freedesktop.org/software/systemd/man/systemctl.html</a> ).  Einige n√ºtzliche Beispielbefehle: <br><br><pre> <code class="bash hljs">sudo systemctl <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span> ... sudo systemctl start ... sudo systemctl stop ...</code> </pre><br><h3>  Teil 3. Peripherieger√§te anschlie√üen </h3><br><img src="https://habrastorage.org/webt/fx/xo/ae/fxxoaey0otck_4ti6yl0p1dzbgu.jpeg" alt="Bild"><br><br>  Die grundlegende Mindestkonfiguration umfasst wahrscheinlich: <br><br><ul><li>  R / C-Empf√§nger. </li><li>  GPS-Empf√§nger (mit oder ohne integriertem Kompass). </li><li>  Ein Funkmodem f√ºr einen bidirektionalen Datenkanal, insbesondere √ºber gro√üe Entfernungen. </li><li>  (Das integrierte WiFi BBBlue eignet sich hervorragend zum Debuggen und Testen aus n√§chster N√§he, wenn 2,4 GHz verf√ºgbar sind. F√ºr etwas Interessanteres wird jedoch ein dedizierter bidirektionaler Datenkanal empfohlen. Beachten Sie auch den Typ und die Platzierung der Antennen, die alle diese Elemente verwenden. ) </li></ul><br>  Ein paar Worte zu den Anschl√ºssen, Kabeln und Werkzeugen, die Sie ben√∂tigen.  Ich werde einige Empfehlungen geben, andernfalls k√∂nnen Sie als Anf√§nger viel Zeit, M√ºhe und Geld investieren.  Der am h√§ufigsten verwendete Steckertyp ist JST-SH 1,0 mm.  Sie m√ºssen mehrere Buchsen in 4 und 6 Positionen und Crimpkontakte kaufen.  Dann holen Sie sich ein paar Meter Dr√§hte in verschiedenen Farben. <br><br>  Zur√ºck zum Anschlie√üen der Peripherieger√§te: <br><br><img src="https://habrastorage.org/webt/h4/mq/7k/h4mq7kn51qxgbc4orkk4ghmluoo.jpeg"><br><br>  R / C-Empf√§nger: Kann an jedem + 5V-Kontakt und GND ausgeschaltet werden.  Sie m√ºssen lediglich den SBUS-Ausgang, den DSM-Ausgang oder den PPM-Ausgang des Empf√§ngers mit einem der beiden im Diagramm markierten SBUS-Pins verbinden.  Die folgenden Empf√§nger wurden getestet und funktionieren: <br><br>  FrSky ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.frsky-rc.com/</a> ): R-XSR, XR4SB, X6R, X8R, R9 Slim und R9 Mini (beide EU LBT 868 MHz- und Universal 915 MHz-Firmwares). <br><br>  Spektrum ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.spektrumrc.com/</a> ): AR7700 DSMX mit PPM / SRXL / Remote Rx. <br><br>  TBS ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://team-blacksheep.com/</a> ): 'Full' Crossfire mit Nano Rx (Rx auf SBUS-Modus eingestellt). <br><br>  √úbrigens reden sie viel √ºber den ‚Äûinvertierten SBUS‚Äú.  Tats√§chlich ist SBUS nur ein serielles Daten√ºbertragungsprotokoll, das Futaba erfunden und von FrSky kopiert hat.  Es ist verkehrt herum im Vergleich zum "Standard" UART.  Gl√ºcklicherweise erwartet der Ardupilot Blue dieses invertierte SBUS-Signal, sodass kein Signalinverter erforderlich ist. <br><br>  GPS-Empf√§nger: Die meisten Menschen verwenden U-Blox-Empf√§nger, insbesondere NEO-M8N und NEO-M8P.  NEO-M8N ist billig und erschwinglich f√ºr chinesische Unternehmen wie HobbyKing, normalerweise in Festplattenform.  Praktischerweise enthalten sie den Empf√§nger selbst, eine sehr kleine Keramik-Patchantenne, und enthalten h√§ufig einen Kompass.  W√§hrend BBBlue bereits √ºber einen eingebauten Kompass (AKM AK8963) verf√ºgt, kann ArduPilot so konfiguriert werden, dass dieser ‚Äûexterne‚Äú Kompass anstelle seines eigenen verwendet wird, um Interferenzen zu vermeiden. <br><br>  Eine (viel) teurere Alternative zu NEO-M8N ist NEO-M8P.  Dieser Empf√§nger unterst√ºtzt einen Betriebsmodus, der als ‚ÄûRTK‚Äú oder kinematisch in Echtzeit bezeichnet wird und in Echtzeit eine Positioniergenauigkeit von wenigen Zentimetern erreichen kann.  Diese Art der Pr√§sentation ist jedoch etwa zehnmal teurer als die NEO-M8N, und dies ohne Basisstation.  Sp√§ter im Handbuch werde ich dem M8P einen speziellen Abschnitt widmen. <br><br>  I2C ArduPilot-Konfigurationsdatei: /var/APM/{ArduCopter.stg,ArduPlane.stg,APMrover2.stg,AntennaTracker.stg} <br><br><pre> <code class="bash hljs">sudo apt-get install i2c-tools sudo i2cdetect -r -y 0 sudo i2cdetect -r -y 1 sudo i2cdetect -r -y 2</code> </pre><br><pre> <code class="bash hljs">$ sudo i2cdetect -r -y 2 0 1 2 3 4 5 6 7 8 9 abcdef 00: -- -- -- -- -- -- -- -- -- 0c -- -- -- 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 60: -- -- -- -- -- -- -- -- 68 -- -- -- -- -- -- -- 70: -- -- -- -- -- -- 76 --</code> </pre><br>  68 = InvenSense MPU-9250 IMU (an Bord), 0c = AKM AK8963-Kompass (an Bord), 76 = Bosch BMP280-Barometer (an Bord). <br><br><pre> <code class="bash hljs">$ sudo i2cdetect -r -y 1 0 1 2 3 4 5 6 7 8 9 abcdef 00: -- -- -- -- -- -- -- -- -- -- -- -- -- 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- 1e -- 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 70: -- -- -- -- -- -- -- --</code> </pre><br>  1e = Honeywell HMC5843-Kompass (extern) - h√§ufig in U-blox NEO-M8N-basierte GPS-Module integriert. <br><br><h2>  Erste Schritte mit der GCS-Software (Ground Control Station) </h2><br>  Laden Sie einen beliebigen Missionsplaner (http://firmware.ardupilot.org/Tools/MissionPlanner/MissionPlanner-latest.msi) f√ºr Windows oder QGroundControl (http://qgroundcontrol.com/) f√ºr Linux und Windows herunter.  Beide Programme stellen eine Verbindung zu den MAVLink-Datenstr√∂men her, die √ºber das Netzwerk (z. B. √ºber den UDP-Port 14550) oder √ºber COM-Ports ankommen. <br><br><h2>  Optional </h2><br>  Die Ausstattung Ihres Drohnen-basierten BBBLUE mit einem Bluetooth-Lautsprecher kann Spa√ü machen, vorausgesetzt, Bluetooth-HF-√úbertragungen st√∂ren keine anderen Systeme.  Es gibt eine Menge Informationen zu BlueZ / PulseAudio / ALSA, aber zum Gl√ºck kommt es auf etwas ziemlich Einfaches an. <br><br>  a) Installieren Sie zuerst die erforderliche Software (√ºber die Konsole oder das IoT-Image): <br><br><pre> <code class="bash hljs"> sudo apt-get install -y bluetooth pulseaudio pulseaudio-module-bluetooth alsa-utils</code> </pre><br>  b) Bluetooth aktivieren (falls deaktiviert): sudo systemctl enable bb-wl18xx-bluetooth.service <br><br>  c) Bearbeiten Sie /etc/pulse/default.pa: <br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">### Automatically suspend sinks/sources that become idle for too long # load-module module-suspend-on-idle</span></span></code> </pre><br>  d) Neustart: sudo Neustart <br><br>  e) Schalten Sie nach dem Laden von BBBlue die Bluetooth-Spalte im Verbindungsmodus ein: <br><br><pre> <code class="bash hljs"> bluetoothctl scan on agent on default-agent pair &lt;Bluetooth speaker<span class="hljs-string"><span class="hljs-string">'s MAC address&gt; # &lt;--- eg AB:58:EC:5C:0C:03 connect &lt;Bluetooth speaker'</span></span>s MAC address&gt; <span class="hljs-comment"><span class="hljs-comment"># &lt;--- Sometimes unnecessary. trust &lt;Bluetooth speaker's MAC address&gt; scan off exit</span></span></code> </pre><br>  f) Endlich: <br><br><pre> <code class="bash hljs"> pulseaudio --start <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"connect &lt;Bluetooth speaker's MAC address&gt;"</span></span> | bluetoothctl pactl list <span class="hljs-comment"><span class="hljs-comment"># &lt;--- Use this to check that your Bluetooth speaker has been picked up by PulseAudio. pacmd set-card-profile 0 a2dp_sink aplay /usr/share/sounds/alsa/Front_Center.wav</span></span></code> </pre><br>  Das ist alles!  √úbrigens, wenn Sie einen Sprachsynthesizer verwenden, empfehle ich Festival. <br><br>  Wenn Sie helfen m√∂chten, schreiben Sie mir bitte im LAN oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VK</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FB</a> . <br><br><img src="https://habrastorage.org/webt/mt/lh/91/mtlh91x8jag1t-ibt_np3uayuke.jpeg" alt="Bild">  <a href="">habrastorage.org/webt/mt/lh/91/mtlh91x8jag1t-ibt_np3uayuke.jpeg</a> <br><br>  Vielen Dank f√ºr das Lesen, Fragen und Kritisieren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de429510/">https://habr.com/ru/post/de429510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de429500/index.html">"Zeit, Gesch√§fte zu machen" flog schlie√ülich</a></li>
<li><a href="../de429502/index.html">Lohnt es sich, kompetenz√ºbergreifende Kompetenzen zu entwickeln?</a></li>
<li><a href="../de429504/index.html">So rufen Sie Audio-VK-Methoden auf</a></li>
<li><a href="../de429506/index.html">Wir schauen unter die Haube des neuen Google Mail</a></li>
<li><a href="../de429508/index.html">Zusammenfassung des Berichts ‚ÄûWie man ein cooler Spezialist f√ºr Datenbanken wird‚Äú (HL2018, Data Egret, Ilya Kosmodemyansky)</a></li>
<li><a href="../de429512/index.html">Digitale Veranstaltungen in Moskau vom 12. bis 18. November</a></li>
<li><a href="../de429514/index.html">Microsoft erkl√§rte, wie das Problem der Datensicherheit auf SSDs mit undichter Hardwareverschl√ºsselung gel√∂st werden kann</a></li>
<li><a href="../de429522/index.html">Entwerfen eines Serviceroboters. Problemstellung, L√∂sungsarchitektur</a></li>
<li><a href="../de429524/index.html">Die richtige JSON-API oder JSON-RPC</a></li>
<li><a href="../de429528/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 338 (5. - 11. November 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>