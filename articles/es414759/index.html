<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÜîÔ∏è üóª ‚õ±Ô∏è Competencia de servlet üìò üòæ ‚ú®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! 

 Estamos lanzando la s√©ptima secuencia del curso Java Developer . En m√°s de un a√±o de la existencia de este curso, fue refinado, perfe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Competencia de servlet</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/414759/">  Hola a todos! <br><br>  Estamos lanzando la s√©ptima secuencia del curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Java Developer</a> .  En m√°s de un a√±o de la existencia de este curso, fue refinado, perfeccionado, se agreg√≥ uno nuevo que fue m√°s all√° de este tiempo.  La misma secuencia difiere del resto en que introdujimos un nuevo sistema de pasos, dividiendo el curso en tres partes y aumentando ligeramente su duraci√≥n total.  Por lo tanto, ahora no ser√° necesario estar exhausto durante cinco meses consecutivos para obtener un certificado, sino elegir con calma per√≠odos de dos meses y recibir capacitaci√≥n.  Pero esta es la letra, volvamos a nuestra tradici√≥n sobre las diferentes utilidades que preceden al lanzamiento del curso. <br><br>  Vamos <br><br><h3>  1. Descripci√≥n general </h3><br>  El contenedor de servlet de Java (o servidor web) es multiproceso: se pueden ejecutar simult√°neamente varias solicitudes al mismo servlet.  Por lo tanto, al escribir un servlet, debe considerar la competencia. <br><br>  Como dijimos anteriormente, se crea una √∫nica instancia de servlet, y para cada nueva solicitud, Servlet Container crea un nuevo subproceso para ejecutar los m√©todos doGet () o doPost () del servlet. <br><br>  Por defecto, los servlets no son seguros para subprocesos; el programador debe ocuparse de esto por s√≠ mismo.  En este cap√≠tulo, discutiremos la competencia de servlets.  Este es un concepto muy importante, as√≠ que conc√©ntrate. <br><br><h3>  2. Resumen de hilos </h3><br><img src="https://habrastorage.org/webt/pd/ny/_n/pdny_ncj8kfu4odnv_15o_p6-ua.png"><a name="habracut"></a><br><br>  Un subproceso es un proceso ligero que tiene su propia pila de llamadas y accede a los datos abiertos de otros subprocesos en el mismo proceso (mont√≥n compartido).  Cada hilo tiene su propio cach√©. <br><br>  Cuando decimos que un programa es multiproceso, queremos decir que la misma instancia de un objeto genera varios hilos y procesa un solo elemento de c√≥digo.  Esto significa que varios flujos de control consecutivos pasan a trav√©s del mismo bloque de memoria.  Por lo tanto, varios subprocesos ejecutan una instancia de un programa y, por lo tanto, comparten variables de instancia y pueden intentar leer y escribir estas variables compartidas. <br><br>  Veamos un ejemplo simple de Java. <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Counter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> counter=<span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(‚ÄúInital Counter = ‚Äù + counter); counter ++; System.out.println(‚ÄúPost Increment Counter = ‚Äù + counter); } }</code> </pre> <br>  Ahora creamos dos hilos Thread1 y Thread2 para hacer <code>doSomething()</code> .  Como resultado, es posible que: <br><br><ol><li>  Thread1 lee un valor de contador de 10 </li><li>  Muestra el contador inicial = 10 y va a aumentar </li><li>  Antes de que Thread1 incremente el contador, Thread2 tambi√©n incrementa el contador, cambiando el contador a 11 </li><li>  Como resultado, Thread1 tiene un valor de contador de 10, que ya est√° desactualizado </li></ol><br>  Este escenario es posible en un entorno de subprocesos m√∫ltiples, como servlets, porque las variables de instancia son compartidas por todos los subprocesos que se ejecutan en la misma instancia. <br><br><h3>  3. Escribir servlets seguros para subprocesos </h3><br>  Espero que en esta secci√≥n comprenda los problemas que estoy tratando de enfatizar.  Si tiene dudas, lea el punto 2 nuevamente. <br><br>  Hay algunos puntos que debemos tener en cuenta al escribir servlets. <br><br><ol><li>  <code>Service()</code> , <code>doGet()</code> , <code>doPost()</code> o, m√°s generalmente, los m√©todos <code>doXXX()</code> no deben actualizar o modificar las variables de instancia, ya que las variables de instancia son compartidas por todos los hilos de la misma instancia. </li><li>  Si es necesario modificar la variable de instancia, h√°galo en un bloque sincronizado. </li><li>  Ambas reglas anteriores se aplican a las variables est√°ticas tambi√©n porque tambi√©n son comunes. </li><li>  Las variables locales siempre son seguras para subprocesos. </li><li>  Los objetos de solicitud y respuesta son seguros para el uso de subprocesos porque se crea una nueva instancia para cada solicitud en su servlet y, por lo tanto, para cada subproceso que se ejecuta en su servlet. </li></ol><br>  Los siguientes son dos enfoques para garantizar la seguridad de los hilos: <br><br>  a) Sincronice el bloque en el que modifica la instancia o las variables est√°ticas (consulte el fragmento de c√≥digo a continuaci√≥n). <br><br>  Recomendamos que sincronice el bloque en el que su c√≥digo modifica las variables de instancia en lugar de sincronizar el m√©todo completo para mejorar el rendimiento. <br><br>  Tenga en cuenta que debemos bloquear la instancia de servlet ya que debemos hacer que el subproceso de instancia de servlet espec√≠fico sea seguro. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreadSafeServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doGet</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ServletException, IOException </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> counter</span></span>; { <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//code in this block is thread-safe so update the instance variable } //other processing; }</span></span></code> </pre> <br>  b) Modelo de subproceso √∫nico: implemente la interfaz SingleThreadModel para hacer que el subproceso sea de un solo subproceso, lo que significa que solo un subproceso ejecutar√° el m√©todo service () o doXXX () a la vez.  Un servlet de subproceso √∫nico es m√°s lento bajo carga porque las nuevas solicitudes deben esperar a que se procese una instancia gratuita <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThreadSafeServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleThreadModel</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> counter; <span class="hljs-comment"><span class="hljs-comment">// no need to synchronize as implemented SingleThreadModel @override public void doGet (HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { }</span></span></code> </pre> <br>  El uso de SingleThreadModel est√° en desuso, ya que se recomienda usar bloques sincronizados. <br><br><h3>  4. Conclusi√≥n </h3><br>  Debemos tener mucho cuidado al escribir servlets, porque "por defecto, los servlets no son seguros para subprocesos" <br><br><ol><li>  Si su servlet no tiene ninguna variable est√°tica o miembro, no necesita preocuparse y su servlet es seguro para subprocesos </li><li>  Si su servlet solo lee la variable de instancia, su servlet es seguro para subprocesos. </li><li>  Si necesita cambiar una instancia o variables est√°ticas, actual√≠cela en un bloque sincronizado, manteniendo la instancia bloqueada </li></ol><br>  Si sigue las reglas anteriores y la pr√≥xima vez que alguien le pregunte: "¬øEs seguro el hilo del servlet?"  - responda con confianza: "Por defecto, no lo son, pero" Mis servlets "son seguros para subprocesos". <br><br>  El fin <br><br>  Como siempre, estamos esperando sus preguntas, sugerencias, etc. aqu√≠ o puede preguntarle a Sergey Petrelevich en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lecci√≥n Abierta</a> sobre multihilo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es414759/">https://habr.com/ru/post/es414759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es414749/index.html">Set de caballero sysadmin</a></li>
<li><a href="../es414751/index.html">Domando WSUS con Ansible y m√°s</a></li>
<li><a href="../es414753/index.html">Bus PCIe: ¬ølas limitaciones f√≠sicas afectan la velocidad de transferencia?</a></li>
<li><a href="../es414755/index.html">Hackathon es la soluci√≥n al problema.</a></li>
<li><a href="../es414757/index.html">Formato de presentaci√≥n moderno</a></li>
<li><a href="../es414761/index.html">5 sitios de noticias creativas en ingl√©s</a></li>
<li><a href="../es414763/index.html">Cuatro tipos de errores del gerente de producto que pueden (y deben) evitarse</a></li>
<li><a href="../es414767/index.html">Implementar IdM. ¬øA qui√©n debo acudir para resolver problemas?</a></li>
<li><a href="../es414769/index.html">Inicie el redireccionamiento m√≥vil con Appsflyer: configuraciones, informes y enlaces</a></li>
<li><a href="../es414771/index.html">DevOps en HightLoad ++ Siberia: desacreditando mitos y discutiendo herramientas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>