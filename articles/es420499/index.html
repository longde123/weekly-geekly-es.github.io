<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ±Ô∏è üìò üë©üèª‚Äçü§ù‚Äçüë®üèæ Anatom√≠a de los sistemas de recomendaci√≥n. Primera parte üßîüèº ü§¥üèª üï∫üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trabajo como cient√≠fico de datos en CleverDATA . Estamos involucrados en proyectos de aprendizaje autom√°tico, y una de las solicitudes m√°s frecuentes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Anatom√≠a de los sistemas de recomendaci√≥n. Primera parte</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/420499/"> Trabajo como cient√≠fico de datos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CleverDATA</a> .  Estamos involucrados en proyectos de aprendizaje autom√°tico, y una de las solicitudes m√°s frecuentes para el desarrollo de soluciones de marketing basadas en aprendizaje autom√°tico es el desarrollo de modelos de recomendaci√≥n. <br><br>  En este art√≠culo, hablar√© sobre los sistemas de recomendaci√≥n, tratar√© de dar una visi√≥n general m√°s completa de los enfoques existentes y explicar√© con los dedos c√≥mo funcionan los algoritmos.  Parte del material se basa en un buen curso sobre los sistemas de recomendaci√≥n del laboratorio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MovieLens</a> (con el que la mayor√≠a de las personas est√°n familiarizadas por el mismo conjunto de datos para evaluar las recomendaciones), el resto es por experiencia personal.  El art√≠culo consta de dos partes.  El primero describe el enunciado del problema y ofrece una visi√≥n general de los algoritmos de recomendaci√≥n simples (pero populares).  En el segundo art√≠culo hablar√© sobre m√©todos m√°s avanzados y algunos aspectos pr√°cticos de implementaci√≥n. <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/652/779/d2d/652779d2ded29db0c8412ad892d0df72.jpg"></a> </div>  <a href="">Fuente</a> <br><a name="habracut"></a><br><h3>  <font color="#0057b6">Revisi√≥n y exposici√≥n del problema.</font> </h3><br>  La tarea del sistema de recomendaci√≥n es informar al usuario sobre un producto en el que pueda estar m√°s interesado en un momento dado.  El cliente recibe informaci√≥n y el servicio gana dinero con la prestaci√≥n de servicios de calidad.  Los servicios no son necesariamente ventas directas de los productos ofrecidos.  El servicio tambi√©n puede ganar comisiones o simplemente aumentar la lealtad del usuario, que luego se traduce en publicidad y otros ingresos. <br><br>  Dependiendo del modelo de negocio, las recomendaciones pueden ser su base, como, por ejemplo, con TripAdvisor, o simplemente pueden ser un servicio adicional conveniente (como, por ejemplo, en alguna tienda de ropa en l√≠nea), dise√±ado para mejorar la experiencia del cliente y hacer que la navegaci√≥n por el cat√°logo sea m√°s C√≥modo <br><br>  La personalizaci√≥n del marketing en l√≠nea es una tendencia obvia de la √∫ltima d√©cada.  Seg√∫n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">McKinsey</a> , el 35% de los ingresos de Amazon o el 75% de los ingresos de Netflix provienen de productos recomendados, y es probable que este porcentaje crezca.  Los sistemas de referencia son acerca de qu√© ofrecer al cliente para hacerlo feliz. <br><br>  Para ilustrar toda la variedad de servicios de recomendaci√≥n, dar√© una lista de las caracter√≠sticas principales con las que puede describir cualquier sistema de recomendaci√≥n. <br><br><ol><li>  <b>Sujeto de recomendaci√≥n</b> : lo que se recomienda. <br><br>  Aqu√≠ hay mucha variedad: pueden ser bienes (Amazon, Ozon), art√≠culos (Arxiv.org), noticias (Surfingbird, Yandex.Zen), im√°genes (500 px), videos (YouTube, Netflix), personas (Linkedin, LonelyPlanet), m√∫sica (Last.fm, Pandora), listas de reproducci√≥n y m√°s.  En general, puedes recomendar cualquier cosa. <br></li><li>  <b>El prop√≥sito de la recomendaci√≥n</b> es por qu√© se recomienda. <br><br>  Por ejemplo: comprar, informar, capacitar, hacer contactos. <br></li><li>  <b>El contexto de la recomendaci√≥n</b> es lo que el usuario est√° haciendo en este momento. <br><br>  Por ejemplo: mirar productos, escuchar m√∫sica, hablar con la gente. <br></li><li>  <b>La fuente de la recomendaci√≥n</b> es qui√©n recomienda: <br><br>  - audiencia (calificaci√≥n promedio de restaurante en TripAdvisor), <br>  - Usuarios interesados <br>  - comunidad de expertos (a veces cuando se trata de un producto complejo, como, por ejemplo, el vino). <br></li><li>  <b>El grado de personalizaci√≥n</b> . <br><br>  Recomendaciones no personales: cuando se le recomienda lo mismo que todos los dem√°s.  Permiten la orientaci√≥n por regi√≥n u hora, pero no tienen en cuenta sus preferencias personales. <br><br>  Una opci√≥n m√°s avanzada es cuando las recomendaciones usan datos de su sesi√≥n actual.  Has mirado varios productos, y en la parte inferior de la p√°gina te ofrecen productos similares. <br><br>  Las recomendaciones personales utilizan toda la informaci√≥n disponible sobre el cliente, incluido el historial de sus compras. <br></li><li>  <b>Transparencia</b> <br><br>  Las personas conf√≠an m√°s en la recomendaci√≥n si entienden exactamente c√≥mo se recibi√≥.  Por lo tanto, hay menos riesgo de toparse con sistemas "inescrupulosos" que promueven los bienes pagados o colocan a los bienes m√°s caros en el ranking.  Adem√°s, un buen sistema de recomendaci√≥n en s√≠ mismo deber√≠a ser capaz de manejar las revisiones compradas y los trucos de ventas. <br><br>  Las manipulaciones, por cierto, tampoco son intencionales.  Por ejemplo, cuando se lanza un nuevo √©xito de taquilla, lo primero que hacen los fan√°ticos es, en consecuencia, la calificaci√≥n puede ser muy alta durante los primeros meses. <br></li><li>  <b>El formato de la recomendaci√≥n</b> . <br><br>  Esto puede ser una ventana emergente, una lista ordenada que aparece en una secci√≥n espec√≠fica del sitio, una cinta en la parte inferior de la pantalla u otra cosa. <br></li><li>  <b>Algoritmos</b> <br><br>  A pesar de los muchos algoritmos existentes, todos se reducen a varios enfoques b√°sicos, que se describir√°n m√°s adelante.  Los m√°s cl√°sicos son los algoritmos basados ‚Äã‚Äãen res√∫menes (no personales), basados ‚Äã‚Äãen contenido (modelos basados ‚Äã‚Äãen la descripci√≥n del producto), filtrado colaborativo (filtrado colaborativo), factorizaci√≥n matricial (m√©todos basados ‚Äã‚Äãen descomposici√≥n matricial) y algunos otros. <br></li></ol><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/db2/906/6d4db2906e4c73fe2dfc75325e55157b.png" width="400"></div>  <a href="">Fuente</a> <br><br>  En el centro de cualquier sistema de recomendaci√≥n est√° la llamada matriz de preferencias.  Esta es una matriz, en un eje del cual todos los clientes del servicio (Usuarios) se reservan, y en el otro, objetos de la recomendaci√≥n (Art√≠culos).  En la intersecci√≥n de algunos pares (usuario, elemento), esta matriz se llena con calificaciones (calificaciones): este es un indicador conocido del inter√©s del usuario en este producto, expresado en una escala dada (por ejemplo, de 1 a 5). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b9a/1cd/f0d/b9a1cdf0d459d5bd938dcd269dc04678.jpg"></div><br>  Los usuarios generalmente eval√∫an solo una peque√±a parte de los productos que est√°n en el cat√°logo, y la tarea del sistema de recomendaciones es resumir esta informaci√≥n y predecir la actitud del cliente hacia otros productos sobre los que no se sabe nada.  En otras palabras, debe completar todas las celdas vac√≠as en la imagen de arriba. <br><br>  Los patrones de consumo de las personas son diferentes y no es necesario recomendar nuevos productos.  Puede mostrar posiciones repetidas, por ejemplo, para reponer existencias.  Seg√∫n este principio, se distinguen dos grupos de bienes. <br><br><ul><li>  <b>Repetible</b>  Por ejemplo, champ√∫s o maquinillas de afeitar que siempre se necesitan. <br></li><li>  <b>√önico</b>  Por ejemplo, libros o pel√≠culas que rara vez se vuelven a adquirir. <br></li></ul><br>  Si el producto no se puede asignar expl√≠citamente a una de las clases, tiene sentido determinar la admisibilidad de las compras repetidas individualmente (alguien va a la tienda solo por el bien de la mantequilla de man√≠ de una determinada marca, y para alguien es importante probar todo lo que est√° en el cat√°logo). <br><br>  El concepto de "inter√©s" tambi√©n es subjetivo.  Algunos usuarios solo necesitan cosas de su categor√≠a favorita (recomendaciones conservadoras), mientras que alguien, por el contrario, responde mejor a productos o grupos de productos no est√°ndar (recomendaciones riesgosas).  Por ejemplo, el alojamiento de video puede recomendar al usuario solo nuevos episodios de sus series favoritas y peri√≥dicamente puede lanzarle nuevos programas o incluso nuevos g√©neros.  Idealmente, debe elegir una estrategia para mostrar recomendaciones para cada cliente por separado, utilizando el modelo de una categor√≠a de cliente. <br><br>  Las calificaciones de los usuarios se pueden obtener de dos maneras: <br><br><ul><li>  calificaciones expl√≠citas: el usuario coloca la calificaci√≥n del producto, deja una rese√±a, le gusta la p√°gina, <br></li><li>  calificaciones impl√≠citas: el usuario no expresa expl√≠citamente su actitud, pero se puede sacar una conclusi√≥n indirecta de sus acciones: compr√≥ el producto, eso significa que le gusta, ley√≥ la descripci√≥n durante mucho tiempo, significa que hay inter√©s, etc. <br></li></ul><br>  Por supuesto, las preferencias expl√≠citas son mejores: el propio usuario dice que le gust√≥.  Sin embargo, en la pr√°ctica, no todos los sitios brindan la oportunidad de expresar expl√≠citamente su inter√©s, y no todos los usuarios tienen el deseo de hacerlo.  Ambos tipos de calificaciones se usan con mayor frecuencia de una vez y se complementan bien. <br><br>  Tambi√©n es importante distinguir entre los t√©rminos Predicci√≥n (predicci√≥n del grado de inter√©s) y la propia Recomendaci√≥n (que muestra la recomendaci√≥n).  Qu√© y c√≥mo mostrar es una tarea separada que utiliza las estimaciones obtenidas en el paso de Predicci√≥n, pero se puede implementar de diferentes maneras. <br><br>  A veces, el t√©rmino "recomendaci√≥n" se usa en un sentido m√°s amplio y se refiere a cualquier optimizaci√≥n, ya sea una selecci√≥n de clientes para el env√≠o de publicidad, determinar el precio √≥ptimo de oferta o simplemente elegir la mejor estrategia de comunicaci√≥n con el cliente.  En el art√≠culo, me limito a la definici√≥n cl√°sica de este t√©rmino, que denota la elecci√≥n del producto m√°s interesante para el cliente. <br><br><h3>  <font color="#0057b6">Recomendaciones no personalizadas</font> </h3><br>  Comencemos con recomendaciones no personalizadas, ya que son las m√°s f√°ciles de implementar.  En ellos, el inter√©s potencial del usuario se determina simplemente por la calificaci√≥n promedio del producto: "A todos les gusta, por lo que te gustar√°".  La mayor√≠a de los servicios funcionan seg√∫n este principio cuando el usuario no ha iniciado sesi√≥n en el sistema, por ejemplo, el mismo TripAdvisor. <br><br>  Las recomendaciones se pueden mostrar de diferentes maneras, como un banner al lado de la descripci√≥n del producto (Amazon), como resultado de una solicitud ordenada por un par√°metro espec√≠fico (TripAdvisor), o de alguna otra manera. <br><br>  Las clasificaciones de productos tambi√©n se pueden mostrar de varias maneras.  Esto puede ser estrellas junto al producto, la cantidad de me gusta, la diferencia entre votos positivos y negativos (como se hace generalmente en los foros), la proporci√≥n de altas calificaciones o incluso un histograma de calificaciones.  Los histogramas son la forma m√°s informativa, pero tienen un inconveniente: son dif√≠ciles de comparar entre s√≠ u ordenar, cuando necesita enumerar productos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b73/0ea/d52/b730ead5266ac0ad83e4a22aef73e91f.jpg"></div><br><h4>  <font color="#0057b6">Problema de arranque en fr√≠o</font> </h4><br>  Un arranque en fr√≠o es una situaci√≥n t√≠pica en la que a√∫n no se han acumulado suficientes datos para que el sistema de recomendaci√≥n funcione correctamente (por ejemplo, cuando un producto es nuevo o apenas se compra).  Si la calificaci√≥n promedio se calcula mediante las estimaciones de solo tres usuarios (igor92, xyz_111 y oleg_s), dicha evaluaci√≥n claramente no ser√° confiable, y los usuarios entienden esto.  A menudo, en tales situaciones, las calificaciones se ajustan artificialmente. <br><br>  La primera forma es mostrar no el valor promedio, sino el promedio suavizado (media amortiguada).  El significado es este: con una peque√±a cantidad de calificaciones, la calificaci√≥n mostrada est√° m√°s inclinada hacia alg√∫n tipo de indicador "promedio" seguro, y tan pronto como se re√∫ne una cantidad suficiente de nuevas calificaciones, el ajuste "promedio" deja de funcionar. <br><br>  Otro enfoque es calcular los intervalos de confianza para cada calificaci√≥n.  Matem√°ticamente, cuanto m√°s estimaciones, menor variaci√≥n del promedio y, por lo tanto, m√°s confianza en su correcci√≥n.  Y como calificaci√≥n, puede mostrar, por ejemplo, el l√≠mite inferior del intervalo (Low CI Bound).  Al mismo tiempo, est√° claro que dicho sistema ser√° bastante conservador, con una tendencia a subestimar las calificaciones de los nuevos productos (a menos, por supuesto, que esto sea un √©xito). <br><br>  Dado que las estimaciones est√°n limitadas a cierta escala (por ejemplo, de 0 a 1), la forma habitual de calcular el intervalo de confianza es poco aplicable aqu√≠: debido a las colas de distribuci√≥n que van al infinito y la simetr√≠a del intervalo en s√≠.  Hay una forma alternativa y m√°s precisa de calcularlo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el intervalo de confianza de Wilson</a> .  En este caso, se obtienen intervalos asim√©tricos de aproximadamente este tipo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b3/ks/rt/b3ksrtynyspkk3lnfpawslijoou.jpeg"></div><br>  En la imagen de arriba, se traza la calificaci√≥n horizontal de la calificaci√≥n promedio, y la vertical es la distribuci√≥n alrededor del promedio.  El color indica diferentes tama√±os de muestra (obviamente, cuanto mayor es la muestra, menor es el intervalo de confianza). <br><br>  El problema del arranque en fr√≠o es tan relevante para las recomendaciones no personalizadas.  El enfoque general aqu√≠ es reemplazar lo que no se puede contar en este momento con varias heur√≠sticas (por ejemplo, reemplazar con una calificaci√≥n promedio, usar un algoritmo m√°s simple o no usar un producto hasta que se recopilen los datos). <br><br><h4>  <font color="#0057b6">Relevancia de las recomendaciones</font> </h4><br>  En algunos casos, tambi√©n es importante tener en cuenta la "frescura" de la recomendaci√≥n.  Esto es especialmente cierto para art√≠culos o publicaciones en foros.  Las nuevas entradas a menudo deber√≠an llegar a la cima.  Para hacer esto, use factores de amortiguaci√≥n.  A continuaci√≥n hay un par de f√≥rmulas para calcular la clasificaci√≥n de art√≠culos en sitios de medios. <br><br>  Ejemplo de c√°lculo de calificaci√≥n en la revista de noticias Hacker: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vc/yr/sn/vcyrsnoylizvctaq3ilbafaosbq.jpeg"></div>  donde U = votos positivos, D = votos negativos y P (penalizaci√≥n): ajuste adicional para la implementaci√≥n de otras reglas comerciales <br><br>  C√°lculo de calificaci√≥n en Reddit: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/zj/fg/g-zjfghqsstjvuryzd-b9c92hjk.jpeg"></div>  donde U = n√∫mero de votos a favor, D = n√∫mero de votos en contra, T = tiempo de registro.  El primer t√©rmino estima la "calidad de grabaci√≥n", y el segundo hace una correcci√≥n por tiempo. <br><br>  Obviamente, no existe una f√≥rmula universal, y cada servicio inventa la f√≥rmula que mejor resuelve su problema: se verifica emp√≠ricamente. <br><br><h3>  <font color="#0057b6">Recomendaciones basadas en contenido</font> </h3><br>  Las recomendaciones personales sugieren el uso m√°ximo de la informaci√≥n sobre el propio usuario, principalmente sobre sus compras anteriores.  Uno de los primeros fue el enfoque de filtrado basado en contenido.  En el marco de este enfoque, la descripci√≥n del producto (contenido) se compara con los intereses del usuario obtenidos de sus calificaciones anteriores.  Cuanto m√°s satisfaga el producto estos intereses, mayor ser√° el inter√©s potencial del usuario evaluado.  El requisito obvio aqu√≠ es que todos los productos en el cat√°logo deben tener una descripci√≥n. <br><br>  Hist√≥ricamente, el tema de las recomendaciones basadas en contenido ha sido a menudo productos con una descripci√≥n no estructurada: pel√≠culas, libros, art√≠culos.  Tales signos pueden ser, por ejemplo, descripciones de texto, rese√±as, reparto y m√°s.  Sin embargo, nada impide el uso de signos num√©ricos o categ√≥ricos ordinarios. <br><br>  Las caracter√≠sticas no estructuradas se describen de una manera t√≠pica para el texto: vectores en el espacio de las palabras ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modelo Vector-Space</a> ).  Cada elemento de dicho vector es una caracter√≠stica que potencialmente caracteriza el inter√©s del usuario.  Del mismo modo, un producto es un vector en el mismo espacio. <br><br>  A medida que el usuario interact√∫a con el sistema (por ejemplo, compra pel√≠culas), las descripciones vectoriales de los productos comprados por √©l se combinan (resumen y normalizan) en un solo vector y, por lo tanto, se forma un vector de sus intereses.  Adem√°s, es suficiente encontrar un producto cuya descripci√≥n est√© m√°s cerca del vector de intereses, es decir,  resuelve el problema de encontrar n vecinos m√°s cercanos. <br><br>  No todos los elementos son igualmente significativos: por ejemplo, las palabras aliadas, obviamente, no llevan ninguna carga √∫til.  Por lo tanto, cuando se determina el n√∫mero de elementos coincidentes en dos vectores, todas las mediciones deben sopesarse primero por su significado.  Esta tarea se resuelve mediante la transformaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">TF-IDF</a> , bien conocida en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Text Mining</a> , que asigna m√°s peso a los intereses m√°s raros.  La coincidencia de tales intereses es m√°s importante para determinar la proximidad de dos vectores que la coincidencia de los populares. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/yf/-l/nsyf-lljlfb0r7bjrc_l3xonto0.jpeg"></div><br>  El principio TF-IDF aqu√≠ es igualmente aplicable a los atributos nominales ordinarios, como, por ejemplo, g√©nero, director, idioma.  TF - una medida de la importancia del atributo para el usuario, IDF - una medida de la "rareza" del atributo. <br><br>  Hay toda una familia de transformaciones similares (por ejemplo, BM25 y similares), pero en esencia todas repiten la misma l√≥gica que TF-IDF: los atributos raros deber√≠an tener m√°s peso al comparar productos.  La imagen a continuaci√≥n ilustra c√≥mo el peso del TF-IDF depende del TF y el IDF.  El eje horizontal m√°s cercano es DF: frecuencia de atributo entre todos los productos, el eje horizontal lejano es TF: logaritmo de frecuencia de atributo del usuario. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/248/b71/1f2/248b711f2b0f9c813c8e88ced69bafbd.png"></div><br>  Algunos puntos que pueden tenerse en cuenta durante la implementaci√≥n. <br><br><ul><li>  Al formar una presentaci√≥n de bienes en el espacio vectorial, en lugar de palabras individuales, puede usar tejas o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">n-gramos</a> (pares consecutivos de palabras, triples, etc.).  Esto har√° que el modelo sea m√°s detallado, pero se necesitar√°n m√°s datos para la capacitaci√≥n. <br></li><li>  En diferentes lugares de la descripci√≥n del producto, el peso de las palabras clave puede diferir (por ejemplo, la descripci√≥n de una pel√≠cula puede consistir en un t√≠tulo, una breve descripci√≥n y una descripci√≥n detallada). <br></li><li>  Las descripciones de productos de diferentes usuarios se pueden ponderar de manera diferente.  Por ejemplo, podemos dar m√°s peso a los usuarios activos que tienen muchas calificaciones. <br></li><li>  Del mismo modo, puede pesar y producto.  Cuanto mayor sea la calificaci√≥n promedio de un objeto, mayor ser√° su peso (similar al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PageRank</a> ). <br></li><li>  Si la descripci√≥n del producto permite enlaces a fuentes externas, puede confundirse y analizar tambi√©n toda la informaci√≥n de terceros relacionada con el producto. <br></li></ul><br>  Se puede ver que el filtrado basado en contenido repite casi por completo el mecanismo de coincidencia de documentos de consulta utilizado en motores de b√∫squeda como Yandex y Google.  La √∫nica diferencia est√° en la forma de una consulta de b√∫squeda: aqu√≠ es un vector que describe los intereses del usuario, y est√°n las palabras clave del documento solicitado.  Cuando los motores de b√∫squeda comenzaron a agregar personalizaci√≥n, la distinci√≥n se borr√≥ a√∫n m√°s. <br><br>  Como medida de la proximidad de dos vectores, la distancia coseno se usa con mayor frecuencia. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a6/136/c9b/0a6136c9bd4144fabc84b53b4e0b6f49.png"></div><br>  Cuando se agrega una nueva evaluaci√≥n, el vector de intereses se actualiza de forma incremental (solo para aquellos elementos que han cambiado).  Al contar, tiene sentido dar a las nuevas estimaciones un poco m√°s de peso, ya que las preferencias pueden variar. <br><br><h3>  <font color="#0057b6">Filtrado colaborativo (opci√≥n basada en el usuario)</font> </h3><br>  Esta clase de sistemas comenz√≥ a desarrollarse activamente en los a√±os 90.  Como parte del enfoque, las recomendaciones se generan en funci√≥n de los intereses de otros usuarios similares.  Dichas recomendaciones son el resultado de una "colaboraci√≥n" de muchos usuarios.  De ah√≠ el nombre del m√©todo. <br><br>  La implementaci√≥n cl√°sica del algoritmo se basa en el principio de k vecinos m√°s cercanos.  En los dedos: para cada usuario, buscamos k m√°s similares a √©l (en t√©rminos de preferencias) y complementamos la informaci√≥n sobre el usuario con datos conocidos sobre sus vecinos.  Entonces, por ejemplo, si se sabe que sus vecinos interesados ‚Äã‚Äãest√°n encantados con la pel√≠cula "Sangre y concreto", y no la han visto por alguna raz√≥n, esta es una excelente ocasi√≥n para ofrecerles esta pel√≠cula para verla el s√°bado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/it/fv/alitfv0yszejlvhji0agoy01amg.jpeg"></div><br>  La imagen de arriba ilustra el principio del m√©todo.  En la matriz de preferencias, el usuario se resalta en amarillo para el que queremos determinar las calificaciones de los nuevos productos (signos de interrogaci√≥n).  Tres de sus vecinos m√°s cercanos est√°n resaltados en azul. <br><br>  En este caso, "similitud" es sin√≥nimo de "correlaci√≥n" de intereses y puede considerarse de muchas maneras (adem√°s de la correlaci√≥n de Pearson, tambi√©n hay una distancia coseno, hay una distancia Jacquard, distancia Hamming, etc.). <br><br>  La implementaci√≥n cl√°sica del algoritmo tiene una desventaja obvia: es poco aplicable en la pr√°ctica debido a la complejidad cuadr√°tica.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De hecho, como cualquier m√©todo del vecino m√°s cercano, requiere el c√°lculo de todas las distancias por pares entre usuarios (y puede haber millones de usuarios). </font><font style="vertical-align: inherit;">Es f√°cil calcular que la complejidad de calcular la matriz de distancia ser√°</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>n</mi><mn>2</mn></msup><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.072ex" height="2.901ex" viewBox="0 -935.7 3475.4 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMAIN-32" x="849" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMATHI-6D" x="2207" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhhcyFQ8KNxgwUNG8ypk2r063Im-bQ#MJMAIN-29" x="3085" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></mo><msup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn></msup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></mo></math></span></span><script type="math/tex" id="MathJax-Element-1">O(n^2m)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">donde n es el n√∫mero de usuarios ym es el n√∫mero de productos. </font><font style="vertical-align: inherit;">Con un mill√≥n de usuarios, se requiere un m√≠nimo de 4 TB para almacenar la matriz de distancia sin procesar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este problema puede resolverse parcialmente comprando hierro de alto rendimiento. </font><font style="vertical-align: inherit;">Pero si se acerca sabiamente, es mejor introducir correcciones en el algoritmo:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> actualizar distancias no con cada compra, sino con lotes (por ejemplo, una vez al d√≠a), </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No vuelva a calcular la matriz de distancia por completo, sino actual√≠cela gradualmente, </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> optar por algoritmos iterativos y aproximados (por ejemplo, ALS). </font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para que el algoritmo sea efectivo, es importante que se cumplan algunos supuestos. </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Los gustos de las personas no cambian con el tiempo (o cambian, pero para todos lo mismo). </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si los gustos de las personas coinciden, entonces coinciden en todo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por ejemplo, si dos clientes prefieren las mismas pel√≠culas, tambi√©n les gustan los mismos libros. </font><font style="vertical-align: inherit;">Esto sucede a menudo cuando los productos recomendados son homog√©neos (por ejemplo, solo pel√≠culas). </font><font style="vertical-align: inherit;">Si esto no es as√≠, entonces un par de clientes pueden tener las mismas preferencias alimentarias, y las opiniones pol√≠ticas son directamente opuestas: aqu√≠ el algoritmo ser√° menos efectivo.</font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El vecindario del usuario en el espacio de preferencia (sus vecinos), que analizaremos para generar nuevas recomendaciones, se puede elegir de diferentes maneras. Podemos trabajar con todos los usuarios del sistema en general, podemos establecer un cierto umbral de proximidad, podemos seleccionar varios vecinos al azar o tomar los n vecinos m√°s similares (este es el enfoque m√°s popular). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los autores de MovieLens como el n√∫mero √≥ptimo de vecinos dan cifras de 30-50 vecinos para pel√≠culas y 25-100 para recomendaciones arbitrarias. Est√° claro aqu√≠ que si tomamos demasiados vecinos, tendremos m√°s posibilidades de ruido aleatorio, y viceversa, si tomamos muy poco, obtendremos recomendaciones m√°s precisas, pero se pueden recomendar menos productos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una etapa importante en la preparaci√≥n de datos es la normalizaci√≥n de las estimaciones.</font></font><br><br><h3> <font color="#0057b6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estandarizaci√≥n de datos (escalado)</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dado que todos los usuarios eval√∫an de manera diferente (alguien pone cinco en una fila y rara vez espera cuatro de alguien), es mejor normalizar los datos antes de calcular, es decir </font><font style="vertical-align: inherit;">conducir a una escala √∫nica para que el algoritmo pueda compararlos correctamente entre s√≠. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Naturalmente, la estimaci√≥n pronosticada deber√° traducirse a la escala original mediante la transformaci√≥n inversa (y, si es necesario, redondear al entero m√°s cercano). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay varias formas de normalizar:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">centrado (centrado medio): de las calificaciones del usuario simplemente restamos la calificaci√≥n promedio, </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* relevante solo para matrices no binarias</font></font></i> <br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estandarizaci√≥n (puntaje z): adem√°s del centrado, dividimos su calificaci√≥n por la desviaci√≥n est√°ndar del usuario, </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* aqu√≠, despu√©s de la conversi√≥n inversa, la calificaci√≥n puede ir m√°s all√° de la escala (es decir, 6 en una escala de cinco puntos), pero tales situaciones son bastante raras y se resuelven simplemente redondeando hacia la estimaci√≥n aceptable m√°s cercana.</font></font></i> <br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doble estandarizaci√≥n: la primera vez que normalizamos las calificaciones de los usuarios, la segunda vez, las calificaciones de los productos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si la pel√≠cula "La mejor pel√≠cula" tiene una calificaci√≥n promedio de 2.5, y el usuario le da 5, entonces este es un factor importante que indica que tales pel√≠culas son claramente de su gusto.</font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La "similitud" o correlaci√≥n de las preferencias de dos usuarios puede considerarse de diferentes maneras. </font><font style="vertical-align: inherit;">De hecho, solo necesitamos comparar dos vectores. </font><font style="vertical-align: inherit;">Enumeramos algunos de los m√°s populares.</font></font><br><br><ol><li>   ‚Äî  ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/110/e8c/698/110e8c698e7cf685c3bc2041afb25cec.png"></div><br>    ‚Äî     ,      . <br><br>           50 / min(50, Rating intersection)    damping factor,       . <br></li><li>   <br><br>   ‚Äî  , ..      ,     .         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fdd/59e/325/fdd59e32550c21f7007bd4242a9a7b29.png"></div></li><li>   <br><br>    .  ,      ‚Äî     ,     . <br><br><img src="https://habrastorage.org/webt/jo/s3/vn/jos3vnkilzsvrkevdfsm8xl22gq.png"><br><br>   ‚Äî  ,     (..    ),       .  ,       . <br></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un desarrollo interesante del enfoque de colaboraci√≥n son las llamadas recomendaciones basadas en la confianza, que tienen en cuenta no solo la proximidad de las personas de acuerdo con sus intereses, sino tambi√©n su proximidad "social" y el grado de confianza entre ellas. </font><font style="vertical-align: inherit;">Si, por ejemplo, vemos que en Facebook la ni√±a visita peri√≥dicamente la p√°gina con las grabaciones de audio de su amiga, entonces conf√≠a en su gusto musical. </font><font style="vertical-align: inherit;">Por lo tanto, las recomendaciones para la ni√±a pueden mezclar completamente nuevas canciones de la lista de reproducci√≥n de la amiga.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/63b/62c/55e/63b62c55e1f68e966d6b4928617cc406.jpg"></div><br><h3> <font color="#0057b6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Justificaci√≥n de recomendaciones</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es importante que el usuario conf√≠e en el sistema de recomendaci√≥n, y para esto debe ser simple y comprensible. </font><font style="vertical-align: inherit;">Si es necesario, siempre debe estar disponible una explicaci√≥n comprensible de la recomendaci√≥n (en la explicaci√≥n terminol√≥gica en ingl√©s). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como parte de la explicaci√≥n, es bueno mostrar la evaluaci√≥n del producto de los vecinos, de acuerdo con qu√© atributo (por ejemplo, el actor o el director), hubo una coincidencia, as√≠ como mostrar la confianza del sistema en la evaluaci√≥n (confianza). </font><font style="vertical-align: inherit;">Para no sobrecargar la interfaz, puede poner toda esta informaci√≥n en el bot√≥n "M√°s informaci√≥n".</font></font><br><br>  Por ejemplo: <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Puede que te guste la pel√≠cula ... porque se reproduce all√≠ ... y ..." </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Los usuarios con gustos musicales similares calificaron el √°lbum ... 4.5 de 5". </font></font></li></ul><br><h3>  <font color="#0057b6">Resumen</font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esto finalizar√° la primera parte del art√≠culo. </font><font style="vertical-align: inherit;">Examinamos el enunciado general del problema, hablamos de recomendaciones no personales, describimos dos enfoques cl√°sicos (filtrado basado en contenido y colaborativo), y tambi√©n tocamos el tema de las recomendaciones sustanciales. </font><font style="vertical-align: inherit;">En general, estos dos enfoques son suficientes para construir un sistema de recomendaci√≥n listo para la producci√≥n. </font><font style="vertical-align: inherit;">En la siguiente parte, continuar√© la revisi√≥n y hablar√© sobre m√©todos m√°s modernos, incluidos los que involucran redes neuronales y aprendizaje profundo, as√≠ como sobre modelos h√≠bridos.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mientras tanto, vea nuestras vacantes.</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquitecto frontend</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desarrollador Java (Big Data)</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ingeniero de sistemas Linux</font></font></a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420499/">https://habr.com/ru/post/es420499/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420489/index.html">Los nuevos procesadores ARM pueden competir con Core i5</a></li>
<li><a href="../es420491/index.html">Mi forma de guerrero, o c√≥mo prepar√© una aplicaci√≥n para la vida en Sailfish</a></li>
<li><a href="../es420493/index.html">¬øPuede el servicio de pedidos de comida estadounidense convertirse en Amazon en el mundo de los restaurantes?</a></li>
<li><a href="../es420495/index.html">Pantalla de renderizado de agua</a></li>
<li><a href="../es420497/index.html">Singularidad de verduras: Kroger lanza robocouriers para clientes de frutas y verduras en Arizona</a></li>
<li><a href="../es420501/index.html">Linux en RAM: debirf way 2018</a></li>
<li><a href="../es420503/index.html">JS Developer Day, diferentes ciudades y comunidades: un d√≠a festivo</a></li>
<li><a href="../es420505/index.html">OpenAI Five ganar√° el equipo profesional en The International</a></li>
<li><a href="../es420507/index.html">Antecedentes: Internet global para todos y sus creadores.</a></li>
<li><a href="../es420509/index.html">Un problema obvio con el uso de afirmar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>