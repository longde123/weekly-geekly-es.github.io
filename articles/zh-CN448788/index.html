<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ› ğŸ‘¼ğŸ¾ ğŸƒ ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬2ç« ï¼Œç¼–å†™æµ‹è¯•å‡½æ•° ğŸ‘ğŸ¿ ğŸ˜® ğŸ˜»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿”å› ä¸‹ä¸€ä¸ª 


 æ‚¨å°†å­¦ä¹ å¦‚ä½•å°†æµ‹è¯•ç»„ç»‡åˆ°ç±»ï¼Œæ¨¡å—å’Œç›®å½•ä¸­ã€‚ ç„¶åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨æ ‡è®°æ¥æ ‡è®°è¦è¿è¡Œçš„æµ‹è¯•ï¼Œå¹¶è®¨è®ºå†…ç½®æ ‡è®°å¦‚ä½•å¸®åŠ©æ‚¨è·³è¿‡æµ‹è¯•å¹¶æ ‡è®°æµ‹è¯•ï¼Œä»¥é˜²å¤±è´¥ã€‚ æœ€åï¼Œæˆ‘å°†è®¨è®ºæµ‹è¯•çš„å‚æ•°åŒ–ï¼Œè¯¥å‚æ•°åŒ–å…è®¸ä½¿ç”¨ä¸åŒçš„æ•°æ®è°ƒç”¨æµ‹è¯•ã€‚ 





 æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨Python 3.6å’Œpyte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬2ç« ï¼Œç¼–å†™æµ‹è¯•å‡½æ•°</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448788/"><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿”å›</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹ä¸€ä¸ª</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p><br><p>  <em>æ‚¨å°†å­¦ä¹ å¦‚ä½•å°†æµ‹è¯•ç»„ç»‡åˆ°ç±»ï¼Œæ¨¡å—å’Œç›®å½•ä¸­ã€‚</em>  <em>ç„¶åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨æ ‡è®°æ¥æ ‡è®°è¦è¿è¡Œçš„æµ‹è¯•ï¼Œå¹¶è®¨è®ºå†…ç½®æ ‡è®°å¦‚ä½•å¸®åŠ©æ‚¨è·³è¿‡æµ‹è¯•å¹¶æ ‡è®°æµ‹è¯•ï¼Œä»¥é˜²å¤±è´¥ã€‚</em>  <em>æœ€åï¼Œæˆ‘å°†è®¨è®ºæµ‹è¯•çš„å‚æ•°åŒ–ï¼Œè¯¥å‚æ•°åŒ–å…è®¸ä½¿ç”¨ä¸åŒçš„æ•°æ®è°ƒç”¨æµ‹è¯•ã€‚</em> </p><br><p><img src="https://habrastorage.org/webt/hd/--/9w/hd--9w134j0rxhmxftrflbbdopy.png"></p><a name="habracut"></a><br><p> æœ¬ä¹¦ä¸­çš„ç¤ºä¾‹æ˜¯ä½¿ç”¨Python 3.6å’Œpytest 3.2ç¼–å†™çš„ã€‚  pytest 3.2æ”¯æŒPython 2.6ã€2.7å’ŒPython 3.3+ã€‚ </p><br><blockquote>æœ¬ä¹¦ç½‘é¡µä¸Šçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest/source_code">é“¾æ¥</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest">pragprog.com</a>ä¸Šæä¾›äº†Tasksé¡¹ç›®ä»¥åŠæœ¬ä¹¦ä¸­æ˜¾ç¤ºçš„æ‰€æœ‰æµ‹è¯•çš„æºä»£ç ã€‚ æ‚¨æ— éœ€ä¸‹è½½æºä»£ç å³å¯äº†è§£æµ‹è¯•ä»£ç ã€‚ ç¤ºä¾‹ä¸­ä»¥æ–¹ä¾¿çš„å½¢å¼æä¾›äº†æµ‹è¯•ä»£ç ã€‚ ä½†æ˜¯ï¼Œä¸ºäº†è·Ÿä¸Šé¡¹ç›®çš„ä»»åŠ¡ï¼Œæˆ–è€…æ”¹ç¼–æµ‹è¯•ç¤ºä¾‹æ¥æµ‹è¯•è‡ªå·±çš„é¡¹ç›®ï¼ˆä¸è´¹åŠ›æ°”ï¼ï¼‰ï¼Œæ‚¨å¿…é¡»è½¬åˆ°æœ¬ä¹¦çš„ç½‘é¡µå¹¶ä¸‹è½½å·¥ä½œã€‚ åœ¨è¯¥ä¹¦çš„ç½‘é¡µä¸Šï¼Œæœ‰ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://pragprog.com/titles/bopytest/errata">å‹˜è¯¯</a>ä¿¡æ¯é“¾æ¥å’Œä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" title="https://forums.pragprog.com/forums/438">è®ºå›</a> ã€‚ </blockquote><p> åœ¨å‰§é€ä¸‹æ–¹æ˜¯è¯¥ç³»åˆ—æ–‡ç« çš„åˆ—è¡¨ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ç›®å½•</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>å¼•è¨€</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬1ç« ï¼špytestå…¥é—¨</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬2ç« ï¼šç¼–å†™æµ‹è¯•å‡½æ•°</strong></a> ï¼ˆæœ¬æ–‡ï¼‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬3ç« ï¼šPytestå›ºå®šè£…ç½®</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬4ç« ï¼šå†…ç½®ç¯å…·</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬5ç« ï¼šæ’ä»¶</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬6ç« ï¼šé…ç½®</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç¬¬7ç« ï¼šä¸å…¶ä»–å·¥å…·ä¸€èµ·ä½¿ç”¨pytest</strong></a> </li></ul></div></div><br><p> åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæ‚¨è¿è¡Œäº†pytestã€‚ æ‚¨äº†è§£äº†å¦‚ä½•ä½¿ç”¨æ–‡ä»¶å’Œç›®å½•è¿è¡Œå®ƒä»¥åŠæœ‰å¤šå°‘ä¸ªé€‰é¡¹èµ·ä½œç”¨ã€‚ åœ¨æœ¬ç« ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•åœ¨æµ‹è¯•PythonåŒ…çš„ä¸Šä¸‹æ–‡ä¸­ç¼–å†™æµ‹è¯•å‡½æ•°ã€‚ å¦‚æœæ‚¨ä½¿ç”¨pytestæµ‹è¯•é™¤Pythonè½¯ä»¶åŒ…ä»¥å¤–çš„ä»»ä½•å†…å®¹ï¼Œé‚£ä¹ˆæœ¬ç« çš„å¤§éƒ¨åˆ†å†…å®¹å°†å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚ </p><br><p> æˆ‘ä»¬å°†ä¸ºTasksåŒ…ç¼–å†™æµ‹è¯•ã€‚ åœ¨æ‰§è¡Œæ­¤æ“ä½œä¹‹å‰ï¼Œæˆ‘å°†è®¨è®ºPythonåˆ†å‘åŒ…çš„ç»“æ„åŠå…¶æµ‹è¯•ï¼Œä»¥åŠå¦‚ä½•ä½¿æµ‹è¯•èƒ½å¤Ÿçœ‹åˆ°æµ‹è¯•åŒ…ã€‚ ç„¶åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨æµ‹è¯•ä¸­ä½¿ç”¨æ–­è¨€ï¼Œæµ‹è¯•å¦‚ä½•å¤„ç†æ„å¤–çš„å¼‚å¸¸ä»¥åŠæµ‹è¯•é¢„æœŸçš„å¼‚å¸¸ã€‚ </p><br><p> æœ€åï¼Œæˆ‘ä»¬å°†è¿›è¡Œè®¸å¤šæµ‹è¯•ã€‚ è¿™æ ·ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•å°†æµ‹è¯•ç»„ç»‡åˆ°ç±»ï¼Œæ¨¡å—å’Œç›®å½•ä¸­ã€‚ ç„¶åï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨æ ‡è®°æ¥æ ‡è®°è¦è¿è¡Œçš„æµ‹è¯•ï¼Œå¹¶è®¨è®ºå†…ç½®æ ‡è®°å¦‚ä½•å¸®åŠ©æ‚¨è·³è¿‡æµ‹è¯•å¹¶æ ‡è®°æµ‹è¯•ï¼Œä»¥é˜²å¤±è´¥ã€‚ æœ€åï¼Œæˆ‘å°†è®¨è®ºæµ‹è¯•çš„å‚æ•°åŒ–ï¼Œè¯¥å‚æ•°åŒ–å…è®¸ä½¿ç”¨ä¸åŒçš„æ•°æ®è°ƒç”¨æµ‹è¯•ã€‚ </p><br><blockquote> <strong><em>è¯‘è€…æ³¨ï¼š</em></strong> <strong><em>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Python 3.5æˆ–3.6ï¼Œ</em></strong>åˆ™åœ¨ç¬¬2ç« ä¸­è¿è¡Œæµ‹è¯•æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæ”¶åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æ¶ˆæ¯ <br><img src="https://habrastorage.org/webt/57/eq/4x/57eq4xsrdjfiyxn9g9ihresujc8.jpeg"><br> é€šè¿‡ä¿®å¤<code>...\code\tasks_proj\src\tasks\tasksdb_tinydb.py</code>å¹¶é‡æ–°å®‰è£…ä»»åŠ¡åŒ…ï¼Œå¯ä»¥è§£å†³æ­¤é—®é¢˜<code>...\code\tasks_proj\src\tasks\tasksdb_tinydb.py</code> <br><pre> <code class="plaintext hljs">$ cd /path/to/code $ pip install ./tasks_proj/`</code> </pre> <br><br> æ‚¨<code>eids</code>åœ¨æ¨¡å—ä¸­<code>doc_ids</code> <code>eids</code>ä¸Š<code>doc_ids</code>å‘½åå‚æ•°<code>eids</code>å’Œ<code>eids</code>ä¸Šçš„<code>eid</code> <code>...\code\tasks_proj\src\tasks\tasksdb_tinydb.py</code> <br><br> è¯´æ˜è¯·å‚é˜…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„çš„</a> <code>#83783</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ã€‚</a> </blockquote><br><h2 id="testirovanie-paketa"> åŒ…è£…æµ‹è¯• </h2><br><p> è¦äº†è§£å¦‚ä½•ä¸ºPythonåŒ…ç¼–å†™æµ‹è¯•åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¬¬xiié¡µä¸Šçš„Tasksé¡¹ç›®ä¸­æ‰€è¿°çš„ç¤ºä¾‹Tasksé¡¹ç›®ã€‚  Tasksæ˜¯ä¸€ä¸ªPythonè½¯ä»¶åŒ…ï¼Œå…¶ä¸­åŒ…å«å…·æœ‰ç›¸åŒä»»åŠ¡åç§°çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ </p><br><p> é™„å½•4ï¼Œæ‰“åŒ…å’Œåˆ†å‘Pythoné¡¹ç›®ï¼Œç¬¬175é¡µï¼Œä»‹ç»äº†å¦‚ä½•åœ¨ä¸€ä¸ªå°å›¢é˜Ÿå†…éƒ¨æˆ–é€šè¿‡PyPIåœ¨å…¨çƒèŒƒå›´å†…åˆ†å‘æ‚¨çš„é¡¹ç›®ï¼Œå› æ­¤ï¼Œæˆ‘å°†ä¸åšä»»ä½•è¯¦ç»†ä»‹ç»ã€‚ ä½†æ˜¯ï¼Œè®©æˆ‘ä»¬å¿«é€ŸæŸ¥çœ‹ä¸€ä¸‹Tasksé¡¹ç›®ä¸­çš„å†…å®¹ä»¥åŠä¸åŒæ–‡ä»¶å¦‚ä½•é€‚åˆè¯¥é¡¹ç›®çš„æµ‹è¯•å†å²è®°å½•ã€‚ </p><br><p> ä»¥ä¸‹æ˜¯Tasksé¡¹ç›®çš„æ–‡ä»¶ç»“æ„ï¼š </p><br><pre> <code class="plaintext hljs">tasks_proj/ â”œâ”€â”€ CHANGELOG.rst â”œâ”€â”€ LICENSE â”œâ”€â”€ MANIFEST.in â”œâ”€â”€ README.rst â”œâ”€â”€ setup.py â”œâ”€â”€ src â”‚ â””â”€â”€ tasks â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ api.py â”‚ â”œâ”€â”€ cli.py â”‚ â”œâ”€â”€ config.py â”‚ â”œâ”€â”€ tasksdb_pymongo.py â”‚ â””â”€â”€ tasksdb_tinydb.py â””â”€â”€ tests â”œâ”€â”€ conftest.py â”œâ”€â”€ pytest.ini â”œâ”€â”€ func â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ test_add.py â”‚ â””â”€â”€ ... â””â”€â”€ unit â”œâ”€â”€ __init__.py â”œâ”€â”€ test_task.py â””â”€â”€ ...</code> </pre> <br><p> æˆ‘æä¾›äº†é¡¹ç›®çš„å®Œæ•´åˆ—è¡¨ï¼ˆæµ‹è¯•æ–‡ä»¶çš„å®Œæ•´åˆ—è¡¨é™¤å¤–ï¼‰ï¼Œä»¥æŒ‡ç¤ºæµ‹è¯•å¦‚ä½•é€‚åˆé¡¹ç›®çš„å…¶ä½™éƒ¨åˆ†ï¼Œå¹¶æŒ‡å‘å‡ ä¸ªæµ‹è¯•çš„å…³é”®æ–‡ä»¶ï¼Œå³<em>conftest.pyï¼Œpytest.ini</em>å’Œå„ç§<em><code>__init__.py</code></em>æ–‡ä»¶å’Œ<em>setup.py</em> ã€‚ </p><br><p> æ‰€æœ‰æµ‹è¯•éƒ½å­˜å‚¨åœ¨<em>æµ‹è¯•ä¸­ï¼Œ</em>å¹¶ä¸”ä¸<em>srcä¸­</em>çš„åŒ…æºæ–‡ä»¶åˆ†å¼€ã€‚ è¿™ä¸æ˜¯pytestçš„è¦æ±‚ï¼Œä½†è¿™æ˜¯æœ€ä½³å®è·µã€‚ </p><br><p> æ‰€æœ‰é¡¶çº§æ–‡ä»¶<em>CHANGELOG.rstï¼ŒLICENSEï¼ŒREADME.rstï¼ŒMANIFEST.in</em>å’Œ<em>setup.py</em>åœ¨ç¬¬175é¡µçš„é™„å½•4ï¼Œæ‰“åŒ…å’Œåˆ†å‘Pythoné¡¹ç›®ä¸­éƒ½æœ‰æ›´è¯¦ç»†çš„è®¨è®ºã€‚å°½ç®¡<em>setup.py</em>å¯¹äºæ„å»ºå‘è¡Œç‰ˆ<em>å¾ˆ</em>é‡è¦ä»è½¯ä»¶åŒ…ä¸­ä¸‹è½½ï¼Œä»¥åŠç”¨äºåœ¨æœ¬åœ°å®‰è£…è½¯ä»¶åŒ…çš„åŠŸèƒ½ï¼Œä»¥ä¾¿å¯ä»¥å¯¼å…¥è¯¥è½¯ä»¶åŒ…ã€‚ </p><br><p> åŠŸèƒ½æµ‹è¯•å’Œå•å…ƒæµ‹è¯•åˆ†ä¸ºå„è‡ªçš„ç›®å½•ã€‚ è¿™æ˜¯ä¸€ä¸ªä»»æ„å†³å®šï¼Œä¸æ˜¯å¿…éœ€çš„ã€‚ ä½†æ˜¯ï¼Œå°†æµ‹è¯•æ–‡ä»¶ç»„ç»‡åˆ°å‡ ä¸ªç›®å½•ä¸­å¯ä»¥è½»æ¾åœ°è¿è¡Œæµ‹è¯•çš„å­é›†ã€‚ æˆ‘å–œæ¬¢å°†åŠŸèƒ½æµ‹è¯•å’Œå•å…ƒæµ‹è¯•åˆ†å¼€ï¼Œå› ä¸ºåªæœ‰åœ¨æˆ‘ä»¬æœ‰æ„æ›´æ”¹ç³»ç»ŸåŠŸèƒ½æ—¶ï¼ŒåŠŸèƒ½æµ‹è¯•æ‰ä¼šä¸­æ–­ï¼Œè€Œåœ¨é‡æ„æˆ–å®ç°æ›´æ”¹æœŸé—´ï¼Œå•å…ƒæµ‹è¯•å¯èƒ½ä¼šä¸­æ–­ã€‚ </p><br><p> è¯¥é¡¹ç›®åŒ…å«<code>__init__.py</code>æ–‡ä»¶çš„ä¸¤ç§ç±»å‹ï¼šåœ¨<code>src/</code>ç›®å½•ä¸­æ‰¾åˆ°çš„æ–‡ä»¶å’Œåœ¨<code>tests/</code>æ‰¾åˆ°çš„æ–‡ä»¶ã€‚  <code>src/tasks/__init__.py</code>å‘Šè¯‰Pythonè¯¥ç›®å½•æ˜¯ä¸€ä¸ªåŒ…ã€‚ å½“æœ‰äººä½¿ç”¨<code>import tasks</code>æ—¶ï¼Œå®ƒä¹Ÿå……å½“åŒ…çš„ä¸»è¦æ¥å£ã€‚ å®ƒåŒ…å«ç”¨äºä»<code>api.py</code>å¯¼å…¥æŸäº›å‡½æ•°çš„ä»£ç ï¼Œå› æ­¤<code>cli.py</code>å’Œæˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶å¯ä»¥è®¿é—®åŒ…å‡½æ•°ï¼Œä¾‹å¦‚<code>tasks.add()</code> ï¼Œè€Œä¸æ˜¯æ‰§è¡Œ<code>task.api.add ()</code> ã€‚  <code>tests/func/__init__.py</code>æ–‡ä»¶<code>tests/func/__init__.py</code>å’Œ<code>tests/unit/__init__.py</code>ä¸ºç©ºã€‚ ä»–ä»¬å‘Šè¯‰pyteståœ¨ä¸€ä¸ªç›®å½•ä¸­æŸ¥æ‰¾æµ‹è¯•ç›®å½•çš„æ ¹ç›®å½•å’Œ<code>pytest.ini</code>æ–‡ä»¶ã€‚ </p><br><p>  <code>pytest.ini</code>æ–‡ä»¶æ˜¯å¯é€‰çš„ã€‚ å®ƒåŒ…å«æ•´ä¸ªé¡¹ç›®çš„å¸¸è§„pytesté…ç½®ã€‚ æ‚¨çš„é¡¹ç›®æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚ å®ƒå¯èƒ½åŒ…å«æ›´æ”¹pytestè¡Œä¸ºçš„æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼Œè®¾ç½®å°†å§‹ç»ˆä½¿ç”¨çš„å‚æ•°åˆ—è¡¨ã€‚ æ‚¨å°†åœ¨ç¬¬113é¡µçš„ç¬¬6ç« â€œé…ç½®â€ä¸­äº†è§£æœ‰å…³<code>pytest.ini</code>å…¨éƒ¨ä¿¡æ¯ã€‚ </p><br><p>  conftest.pyæ–‡ä»¶ä¹Ÿæ˜¯å¯é€‰çš„ã€‚  pytestè¢«è§†ä¸ºâ€œæœ¬åœ°æ’ä»¶â€ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å«æŒ‚é’©å‡½æ•°å’Œè£…ç½®ã€‚  <em>æŒ‚é’©å‡½æ•°</em>æ˜¯ä¸€ç§å°†ä»£ç åµŒå…¥pytestè¿è¡Œæ—¶çš„ä¸€éƒ¨åˆ†ä»¥æ›´æ”¹pytestçš„å·¥ä½œæ–¹å¼çš„æ–¹æ³•ã€‚ å¤¹å…·æ˜¯åœ¨æµ‹è¯•åŠŸèƒ½ä¹‹å‰å’Œä¹‹åè¿è¡Œçš„è®¾ç½®å’Œæ‹†å¸åŠŸèƒ½ï¼Œå¯ç”¨äºè¡¨ç¤ºæµ‹è¯•ä½¿ç”¨çš„èµ„æºå’Œæ•°æ®ã€‚  ï¼ˆåœ¨ç¬¬49é¡µçš„ç¬¬3ç« pytestå›ºå®šè£…ç½®å’Œåœ¨ç¬¬71é¡µçš„ç¬¬4ç« å†…ç½®å›ºå®šè£…ç½®ä¸­è®¨è®ºäº†å›ºå®šè£…ç½®ï¼Œåœ¨ç¬¬95é¡µçš„ç¬¬5ç« â€œæ’ä»¶â€ä¸­è®¨è®ºäº†æŒ‚é’©å‡½æ•°ã€‚ï¼‰å¤šä¸ªå­ç›®å½•ä¸­çš„æµ‹è¯•åº”åŒ…å«åœ¨tests / conftest.pyä¸­ã€‚ æ‚¨å¯ä»¥æœ‰å‡ ä¸ªconftest.pyæ–‡ä»¶ï¼› ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ä¸­å¯ä»¥æœ‰ä¸€ä¸ªï¼Œè€Œåœ¨æ¯ä¸ªæµ‹è¯•å­ç›®å½•ä¸­å¯ä»¥æœ‰ä¸€ä¸ªã€‚ </p><br><p> å¦‚æœæ‚¨å°šæœªè¿™æ ·åšï¼Œåˆ™å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨</a>æœ¬ä¹¦çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç½‘ç«™</a>ä¸Šä¸‹è½½è¯¥é¡¹ç›®çš„æºä»£ç å‰¯æœ¬ã€‚ æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„ç»“æ„æ¥å¤„ç†é¡¹ç›®ã€‚ </p><br><p> è¿™æ˜¯test_task.pyï¼š </p><br><blockquote>  <strong>ch2 / task_proj /æµ‹è¯•/å•å…ƒ/ test_task.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""Test the Task data type.""" # -*- coding: utf-8 -*- from tasks import Task def test_asdict(): """_asdict()   .""" t_task = Task('do something', 'okken', True, 21) t_dict = t_task._asdict() expected = {'summary': 'do something', 'owner': 'okken', 'done': True, 'id': 21} assert t_dict == expected def test_replace(): """replace ()      .""" t_before = Task('finish book', 'brian', False) t_after = t_before._replace(id=10, done=True) t_expected = Task('finish book', 'brian', True, 10) assert t_after == t_expected def test_defaults(): """        .""" t1 = Task() t2 = Task(None, None, False, None) assert t1 == t2 def test_member_access(): """ .field  namedtuple.""" t = Task('buy milk', 'brian') assert t.summary == 'buy milk' assert t.owner == 'brian' assert (t.done, t.id) == (False, None)</code> </pre> <br><p>  <em>test_task.py</em>æ–‡ä»¶åŒ…å«ä»¥ä¸‹å¯¼å…¥è¯­å¥ï¼š </p><br><pre> <code class="plaintext hljs">from tasks import Task</code> </pre> <br><p> è®©æµ‹è¯•å¯¼å…¥ä»»åŠ¡æˆ–ä»ä»»åŠ¡ä¸­å¯¼å…¥æŸäº›ä¸œè¥¿çš„æœ€ä½³æ–¹æ³•æ˜¯ä½¿ç”¨pipåœ¨æœ¬åœ°å®‰è£…ä»»åŠ¡ã€‚ è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªsetup.pyæ–‡ä»¶å¯ç›´æ¥è°ƒç”¨pipã€‚ </p><br><p> é€šè¿‡è¿è¡Œ<code>pip install .</code>å®‰è£…ä»»åŠ¡<code>pip install .</code> æˆ–<code>pip install -e .</code> ä»task_projç›®å½•ä¸­ã€‚ æˆ–ä»ä¸Šä¸€çº§ç›®å½•è¿è¡Œ<code>pip install -e tasks_proj</code>å¦ä¸€ä¸ªé€‰é¡¹ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code $ pip install ./tasks_proj/ $ pip install --no-cache-dir ./tasks_proj/ Processing ./tasks_proj Collecting click (from tasks==0.1.0) Downloading click-6.7-py2.py3-none-any.whl (71kB) ... Collecting tinydb (from tasks==0.1.0) Downloading tinydb-3.4.0.tar.gz Collecting six (from tasks==0.1.0) Downloading six-1.10.0-py2.py3-none-any.whl Installing collected packages: click, tinydb, six, tasks Running setup.py install for tinydb ... done Running setup.py install for tasks ... done Successfully installed click-6.7 six-1.10.0 tasks-0.1.0 tinydb-3.4.0</code> </pre> <br><p> å¦‚æœåªæƒ³è¿è¡Œä»»åŠ¡æµ‹è¯•ï¼Œåˆ™å¯ä»¥æ‰§è¡Œæ­¤å‘½ä»¤ã€‚ å¦‚æœæ‚¨å¸Œæœ›èƒ½å¤Ÿåœ¨ä»»åŠ¡å®‰è£…è¿‡ç¨‹ä¸­æ›´æ”¹æºä»£ç ï¼Œåˆ™éœ€è¦ä½¿ç”¨å¸¦æœ‰-eé€‰é¡¹çš„å®‰è£…ï¼ˆå¯¹äºå¯ç¼–è¾‘çš„â€œå¯ç¼–è¾‘â€ï¼‰ï¼š </p><br><pre> <code class="plaintext hljs">$ pip install -e ./tasks_proj/ Obtaining file:///path/to/code/tasks_proj Requirement already satisfied: click in /path/to/venv/lib/python3.6/site-packages (from tasks==0.1.0) Requirement already satisfied: tinydb in /path/to/venv/lib/python3.6/site-packages (from tasks==0.1.0) Requirement already satisfied: six in /path/to/venv/lib/python3.6/site-packages (from tasks==0.1.0) Installing collected packages: tasks Found existing installation: tasks 0.1.0 Uninstalling tasks-0.1.0: Successfully uninstalled tasks-0.1.0 Running setup.py develop for tasks Successfully installed tasks</code> </pre> <br><p> ç°åœ¨å°è¯•è¿è¡Œæµ‹è¯•ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch2/tasks_proj/tests/unit $ pytest test_task.py ===================== test session starts ====================== collected 4 items test_task.py .... =================== 4 passed in 0.01 seconds ===================</code> </pre> <br><p> å¯¼å…¥æœ‰æ•ˆï¼ ç°åœ¨ï¼Œå…¶ä»–æµ‹è¯•å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨å¯¼å…¥ä»»åŠ¡ã€‚ ç°åœ¨è®©æˆ‘ä»¬ç¼–å†™ä¸€äº›æµ‹è¯•ã€‚ </p><br><h2 id="ispolzovanie-operatorov-assert"> ä½¿ç”¨æ–­è¨€è¯­å¥ </h2><br><p> åœ¨ç¼–å†™æµ‹è¯•å‡½æ•°æ—¶ï¼Œå¸¸è§„çš„Pythonè¯­å¥assertæ˜¯æŠ¥å‘Šæµ‹è¯•å¤±è´¥çš„ä¸»è¦å·¥å…·ã€‚  pytestçš„ç®€å•æ€§éå¸¸å‡ºè‰²ã€‚ è¿™å°±æ˜¯ä½¿è®¸å¤šå¼€å‘äººå‘˜åœ¨å…¶ä»–æ¡†æ¶ä¹‹ä¸Šä½¿ç”¨pytestçš„åŸå› ã€‚ </p><br><p> å¦‚æœæ‚¨ä½¿ç”¨ä»»ä½•å…¶ä»–æµ‹è¯•å¹³å°ï¼Œåˆ™å¯èƒ½ä¼šçœ‹åˆ°å„ç§æ–­è¨€åŠ©æ‰‹åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å½¢å¼çš„assertå’Œassertè¾…åŠ©å‡½æ•°çš„åˆ—è¡¨ï¼š </p><br><div class="scrollable-table"><table><thead><tr><th>  <strong>pytest</strong> </th><th>  <strong>å•å…ƒæµ‹è¯•</strong> </th></tr></thead><tbody><tr><td> æ–­è¨€ </td><td>  assertTrueï¼ˆæŸç‰©ï¼‰ </td></tr><tr><td> æ–­è¨€a == b </td><td>  assertEqualï¼ˆaï¼Œbï¼‰ </td></tr><tr><td> æ–­è¨€a &lt;= b </td><td>  assertLessEqualï¼ˆaï¼Œbï¼‰ </td></tr><tr><td>  ... </td><td>  ... </td></tr></tbody></table></div><br><p> ä½¿ç”¨pytestï¼Œæ‚¨å¯ä»¥å¯¹ä»»ä½•è¡¨è¾¾å¼ä½¿ç”¨assert &lt;è¡¨è¾¾å¼&gt;ã€‚ å¦‚æœå°†è¡¨è¾¾å¼è½¬æ¢ä¸ºboolæ—¶å…¶è®¡ç®—ç»“æœä¸ºFalseï¼Œåˆ™æµ‹è¯•å°†å¤±è´¥ã€‚ </p><br><p>  pyteståŒ…å«ä¸€ä¸ªç§°ä¸ºæ–­è¨€é‡å†™çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ‹¦æˆªæ–­è¨€è°ƒç”¨å¹¶å°†å…¶æ›¿æ¢ä¸ºå¯ä»¥å‘Šè¯‰æ‚¨æ›´å¤šæœ‰å…³è¯­å¥å¤±è´¥åŸå› çš„ä¿¡æ¯ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœçœ‹åˆ°ä¸€äº›è¯­å¥é”™è¯¯ï¼Œè¿™ç§é‡å†™æœ‰å¤šä¹ˆæœ‰ç”¨ï¼š </p><br><blockquote>  <strong>ch2 / task_proj /æµ‹è¯•/å•å…ƒ/ test_task_fail.py</strong> </blockquote><br><pre> <code class="plaintext hljs">""" the Task type    .""" from tasks import Task def test_task_equality(): """     .""" t1 = Task('sit there', 'brian') t2 = Task('do something', 'okken') assert t1 == t2 def test_dict_equality(): """ ,   dicts,    .""" t1_dict = Task('make sandwich', 'okken')._asdict() t2_dict = Task('make sandwich', 'okkem')._asdict() assert t1_dict == t2_dict</code> </pre> <br><p> æ‰€æœ‰è¿™äº›æµ‹è¯•å‡å¤±è´¥ï¼Œä½†æ˜¯è·Ÿè¸ªä¸­çš„ä¿¡æ¯å¾ˆæœ‰è¶£ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\unit&gt;pytest test_task_fail.py ============================= test session starts ============================= collected 2 items test_task_fail.py FF ================================== FAILURES =================================== _____________________________ test_task_equality ______________________________ def test_task_equality(): """Different tasks should not be equal.""" t1 = Task('sit there', 'brian') t2 = Task('do something', 'okken') &gt; assert t1 == t2 E AssertionError: assert Task(summary=...alse, id=None) == Task(summary='...alse, id=None) E At index 0 diff: 'sit there' != 'do something' E Use -v to get the full diff test_task_fail.py:9: AssertionError _____________________________ test_dict_equality ______________________________ def test_dict_equality(): """Different tasks compared as dicts should not be equal.""" t1_dict = Task('make sandwich', 'okken')._asdict() t2_dict = Task('make sandwich', 'okkem')._asdict() &gt; assert t1_dict == t2_dict E AssertionError: assert OrderedDict([...('id', None)]) == OrderedDict([(...('id', None)]) E Omitting 3 identical items, use -vv to show E Differing items: E {'owner': 'okken'} != {'owner': 'okkem'} E Use -v to get the full diff test_task_fail.py:16: AssertionError ========================== 2 failed in 0.30 seconds ===========================</code> </pre> <br><p> å“‡ï¼ è¿™æ˜¯å¾ˆå¤šä¿¡æ¯ã€‚ å¯¹äºæ¯ä¸ªä¸æˆåŠŸçš„æµ‹è¯•ï¼Œå°†æ˜¾ç¤ºç¡®åˆ‡çš„é”™è¯¯å­—ç¬¦ä¸²ï¼Œå¹¶å¸¦æœ‰&gt;å¤±è´¥æŒ‡é’ˆã€‚  Eè¡Œæ˜¾ç¤ºæœ‰å…³æ–­è¨€å¤±è´¥çš„å…¶ä»–ä¿¡æ¯ï¼Œä»¥å¸®åŠ©æ‚¨äº†è§£é—®é¢˜æ‰€åœ¨ã€‚ </p><br><p> æˆ‘æ•…æ„åœ¨<code>test_task_equality()</code>æ”¾ç½®äº†ä¸¤ä¸ªä¸åŒ¹é…<code>test_task_equality()</code> ï¼Œä½†åœ¨å‰é¢çš„ä»£ç ä¸­ä»…æ˜¾ç¤ºäº†ç¬¬ä¸€ä¸ªä¸åŒ¹é…<code>test_task_equality()</code> ã€‚ æ ¹æ®é”™è¯¯æ¶ˆæ¯ä¸­çš„å»ºè®®ï¼Œè®©æˆ‘ä»¬å†æ¬¡ä½¿ç”¨<code>-v</code>æ ‡å¿—ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\unit&gt;pytest -v test_task_fail.py ============================= test session starts ============================= collected 2 items test_task_fail.py::test_task_equality FAILED test_task_fail.py::test_dict_equality FAILED ================================== FAILURES =================================== _____________________________ test_task_equality ______________________________ def test_task_equality(): """Different tasks should not be equal.""" t1 = Task('sit there', 'brian') t2 = Task('do something', 'okken') &gt; assert t1 == t2 E AssertionError: assert Task(summary=...alse, id=None) == Task(summary='...alse, id=None) E At index 0 diff: 'sit there' != 'do something' E Full diff: E - Task(summary='sit there', owner='brian', done=False, id=None) E ? ^^^ ^^^ ^^^^ E + Task(summary='do something', owner='okken', done=False, id=None) E ? +++ ^^^ ^^^ ^^^^ test_task_fail.py:9: AssertionError _____________________________ test_dict_equality ______________________________ def test_dict_equality(): """Different tasks compared as dicts should not be equal.""" t1_dict = Task('make sandwich', 'okken')._asdict() t2_dict = Task('make sandwich', 'okkem')._asdict() &gt; assert t1_dict == t2_dict E AssertionError: assert OrderedDict([...('id', None)]) == OrderedDict([(...('id', None)]) E Omitting 3 identical items, use -vv to show E Differing items: E {'owner': 'okken'} != {'owner': 'okkem'} E Full diff: E {'summary': 'make sandwich', E - 'owner': 'okken', E ? ^... E E ...Full output truncated (5 lines hidden), use '-vv' to show test_task_fail.py:16: AssertionError ========================== 2 failed in 0.28 seconds ===========================</code> </pre> <br><p> å¥½å§ï¼Œæˆ‘è®¤ä¸ºè¿™å¤ªé…·äº†ï¼  pytestä¸ä»…èƒ½å¤Ÿæ‰¾åˆ°è¿™ä¸¤ä¸ªå·®å¼‚ï¼Œè€Œä¸”è¿˜å‘æˆ‘ä»¬ç¡®åˆ‡è¯´æ˜äº†è¿™äº›å·®å¼‚åœ¨å“ªé‡Œã€‚ è¿™ä¸ªä¾‹å­åªä½¿ç”¨ç›¸ç­‰æ–­è¨€ã€‚ æ‚¨å¯ä»¥åœ¨pytest.orgä¸Šæ‰¾åˆ°assertè¯­å¥çš„æ›´å¤šå˜ä½“ï¼Œä»¥åŠä»¤äººæƒŠå¹çš„è·Ÿè¸ªè°ƒè¯•ä¿¡æ¯ã€‚ </p><br><h2 id="ozhidanie-isklyucheniy-expected-exception"> é¢„æœŸå¼‚å¸¸ </h2><br><p>  Tasks APIä¸­çš„å¤šä¸ªåœ°æ–¹éƒ½å¯èƒ½å‘ç”Ÿå¼‚å¸¸ã€‚ è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹<em>task / api.py</em>ä¸­çš„å‡½æ•°ï¼š </p><br><pre> <code class="plaintext hljs">def add(task): # type: (Task) -\&gt; int def get(task_id): # type: (int) -\&gt; Task def list_tasks(owner=None): # type: (str|None) -\&gt; list of Task def count(): # type: (None) -\&gt; int def update(task_id, task): # type: (int, Task) -\&gt; None def delete(task_id): # type: (int) -\&gt; None def delete_all(): # type: () -\&gt; None def unique_id(): # type: () -\&gt; int def start_tasks_db(db_path, db_type): # type: (str, str) -\&gt; None def stop_tasks_db(): # type: () -\&gt; None</code> </pre> <br><p>  <em>cli.pyä¸­</em>çš„CLIä»£ç å’Œ<em>api.pyä¸­</em>çš„APIä»£ç ä¹‹é—´<em>å°±å°†</em>å“ªç§ç±»å‹ä¼ é€’ç»™APIå‡½æ•°è¾¾æˆäº†åè®®ã€‚ å¦‚æœç±»å‹ä¸æ­£ç¡®ï¼Œæˆ‘å¸Œæœ›å¯ä»¥åœ¨APIè°ƒç”¨ä¸­å¼•å‘å¼‚å¸¸ã€‚ è¦ç¡®ä¿è¿™äº›å‡½æ•°åœ¨æœªæ­£ç¡®è°ƒç”¨çš„æƒ…å†µä¸‹å¼•å‘å¼‚å¸¸ï¼Œè¯·åœ¨æµ‹è¯•å‡½æ•°ä¸­ä½¿ç”¨é”™è¯¯çš„ç±»å‹æ•…æ„å¼•å‘TypeErrorå¼‚å¸¸ï¼Œå¹¶ä¸pytest.raisesï¼ˆé¢„æœŸçš„å¼‚å¸¸ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š </p><br><blockquote>  <strong>ch2 / tasks_proj /æµ‹è¯•/func/test_api_exceptions.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""    -   API.""" import pytest import tasks def test_add_raises(): """add()       param.""" with pytest.raises(TypeError): tasks.add(task='not a Task object')</code> </pre> <br><p> åœ¨<code>test_add_raises()</code> ï¼Œä½¿ç”¨<code>pytest.raises(TypeError)</code> ï¼šè¯¥è¯­å¥æŠ¥å‘Šä¸‹ä¸€æ®µä»£ç ä¸­çš„æ‰€æœ‰å†…å®¹å‡åº”å¼•å‘TypeErrorå¼‚å¸¸ã€‚ å¦‚æœæœªå¼•å‘å¼‚å¸¸ï¼Œåˆ™æµ‹è¯•å°†å¤±è´¥ã€‚ å¦‚æœæµ‹è¯•å¼•å‘å¦ä¸€ä¸ªå¼‚å¸¸ï¼Œåˆ™å®ƒå°†å¤±è´¥ã€‚ </p><br><p> æˆ‘ä»¬åªæ˜¯åœ¨<code>test_add_raises()</code>æ£€æŸ¥äº†å¼‚å¸¸ç±»å‹ã€‚ æ‚¨è¿˜å¯ä»¥æ£€æŸ¥æ’é™¤é€‰é¡¹ã€‚ å¯¹äº<code>start_tasks_db(db_path, db_type)</code> ï¼Œä¸ä»…<em>db_type</em>åº”è¯¥æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸”å®é™…ä¸Šåº”è¯¥æ˜¯'tiny'æˆ–'mongo'ã€‚ æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ excinfoæ¥æ£€æŸ¥å¼‚å¸¸æ¶ˆæ¯æ˜¯å¦æ­£ç¡®ï¼š </p><br><blockquote>  <strong>ch2 / tasks_proj /æµ‹è¯•/func/test_api_exceptions.py</strong> </blockquote><br><pre> <code class="plaintext hljs">def test_start_tasks_db_raises(): """,     .""" with pytest.raises(ValueError) as excinfo: tasks.start_tasks_db('some/great/path', 'mysql') exception_msg = excinfo.value.args[0] assert exception_msg == "db_type must be a 'tiny' or 'mongo'"</code> </pre> <br><p> è¿™ä½¿æˆ‘ä»¬å¯ä»¥æ›´ä»”ç»†åœ°ç ”ç©¶æ­¤å¼‚å¸¸ã€‚  asä¹‹åçš„å˜é‡åï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºexcinfoï¼‰ä¸­å¡«å……äº†å¼‚å¸¸ä¿¡æ¯ï¼Œå¹¶ä¸”å…¶ç±»å‹ä¸ºExceptionInfoã€‚ </p><br><p> åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¦ç¡®ä¿ç¬¬ä¸€ä¸ªï¼ˆä¹Ÿæ˜¯å”¯ä¸€çš„ï¼‰å¼‚å¸¸å‚æ•°ä¸å­—ç¬¦ä¸²åŒ¹é…ã€‚ </p><br><h2 id="marking-test-functions"> æ ‡è®°æµ‹è¯•åŠŸèƒ½ </h2><br><p>  pytestæä¾›äº†ä¸€ç§å¾ˆé…·çš„æœºåˆ¶æ¥å°†æ ‡è®°æ”¾å…¥æµ‹è¯•å‡½æ•°ä¸­ã€‚ ä¸€ä¸ªæµ‹è¯•å¯ä»¥æœ‰å¤šä¸ªæ ‡è®°ï¼Œå¹¶ä¸”ä¸€ä¸ªæ ‡è®°å¯ä»¥å¤„äºå¤šä¸ªæµ‹è¯•ä¸­ã€‚ </p><br><p> åœ¨æ‚¨çœ‹åˆ°æ ‡è®°çš„ä½œç”¨åï¼Œæ ‡è®°å¯¹æ‚¨ä¾¿æœ‰æ„ä¹‰ã€‚ å‡è®¾æˆ‘ä»¬å¸Œæœ›å°†æµ‹è¯•çš„å­é›†ä½œä¸ºå¿«é€Ÿçš„â€œçƒŸé›¾æµ‹è¯•â€æ¥äº†è§£ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ä¸¥é‡çš„å·®è·ã€‚ æŒ‰ç…§æƒ¯ä¾‹ï¼ŒSmokeæµ‹è¯•ä¸æ˜¯å…¨é¢çš„ï¼Œå…¨é¢çš„æµ‹è¯•å¥—ä»¶ï¼Œè€Œæ˜¯å¯ä»¥å¿«é€Ÿè¿è¡Œçš„é€‰å®šå­é›†ï¼Œå¯ä¸ºå¼€å‘äººå‘˜æä¾›æœ‰å…³ç³»ç»Ÿæ‰€æœ‰éƒ¨åˆ†è¿è¡ŒçŠ¶å†µçš„è‰¯å¥½å°è±¡ã€‚ </p><br><p> è¦å°†çƒŸé›¾æµ‹è¯•å¥—ä»¶æ·»åŠ åˆ°Tasksé¡¹ç›®ï¼Œæ‚¨éœ€è¦ä¸ºæŸäº›æµ‹è¯•æ·»åŠ <code>@mark.pytest.smoke</code> ã€‚ è®©æˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°å‡ ä¸ª<code>test_api_exceptions.py</code>æµ‹è¯•ä¸­ï¼ˆè¯·æ³¨æ„ï¼Œ <code>test_api_exceptions.py</code>ä¸­æ²¡æœ‰å†…ç½®Smokeå’Œ<em>get</em>æ ‡è®°ï¼›æˆ‘åªæ˜¯æƒ³å‡ºäº†å®ƒä»¬ï¼‰ï¼š </p><br><blockquote>  <strong>ch2 / tasks_proj /æµ‹è¯•/func/test_api_exceptions.py</strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.smoke def test_list_raises(): """list()       param.""" with pytest.raises(TypeError): tasks.list_tasks(owner=123) @pytest.mark.get @pytest.mark.smoke def test_get_raises(): """get()       param.""" with pytest.raises(TypeError): tasks.get(task_id='123')</code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬ä»…è¿è¡Œé‚£äº›å¸¦æœ‰<code>-m marker_name</code>æ ‡è®°çš„æµ‹è¯•ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests&gt;cd func (venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v -m "smoke" test_api_exceptions.py ============================= test session starts ============================= collected 7 items test_api_exceptions.py::test_list_raises PASSED test_api_exceptions.py::test_get_raises PASSED ============================= 5 tests deselected ============================== =================== 2 passed, 5 deselected in 0.18 seconds ==================== (venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt; (venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v -m "get" test_api_exceptions.py ============================= test session starts ============================= collected 7 items test_api_exceptions.py::test_get_raises PASSED ============================= 6 tests deselected ============================== =================== 1 passed, 6 deselected in 0.13 seconds ====================</code> </pre> <br><p> è¯·è®°ä½ï¼Œ <code>-v</code> <code>--verbose</code>ç¼©å†™ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤ŸæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„æµ‹è¯•çš„åç§°ã€‚ ä½¿ç”¨-m'smoke'è¿è¡Œä¸¤ä¸ªæµ‹è¯•ï¼Œæ ‡è®°ä¸º@ pytest.mark.smokeã€‚ </p><br><p> ä½¿ç”¨<code>@pytest.mark.get</code> 'å°†è¿è¡Œä¸€ä¸ªæ ‡è®°ä¸º<code>@pytest.mark.get</code>æµ‹è¯•ã€‚ å¾ˆç®€å• </p><br><p> ä¸€åˆ‡éƒ½å˜æˆå¥‡è¿¹ï¼Œå¥‡è¿¹ï¼  <code>-m</code>ä¹‹åçš„è¡¨è¾¾å¼å¯ä»¥ä½¿ç”¨<code>and</code> ï¼Œ <code>or</code>å’Œ<code>not</code>ç»„åˆå¤šä¸ªæ ‡è®°ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v -m "smoke and get" test_api_exceptions.py ============================= test session starts ============================= collected 7 items test_api_exceptions.py::test_get_raises PASSED ============================= 6 tests deselected ============================== =================== 1 passed, 6 deselected in 0.13 seconds ====================</code> </pre> <br><p> æˆ‘ä»¬åªåœ¨<code>smoke</code>å¹¶<code>get</code>æ ‡è®°çš„æƒ…å†µä¸‹è¿›è¡Œäº†æ­¤æµ‹è¯•ã€‚ æˆ‘ä»¬å¯ä»¥<code>not</code>ä½¿ç”¨ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v -m "smoke and not get" test_api_exceptions.py ============================= test session starts ============================= collected 7 items test_api_exceptions.py::test_list_raises PASSED ============================= 6 tests deselected ============================== =================== 1 passed, 6 deselected in 0.13 seconds ====================</code> </pre> <br><p> æ·»åŠ <code>@pytest.mark.smoke</code> <code>-m 'smoke and not get'</code>é€‰æ‹©ä¸€ä¸ªæ ‡è®°ä¸º<code>@pytest.mark.smoke</code>è€Œä¸æ˜¯<code>@pytest.mark.get</code> ã€‚ </p><br><h3 id="zapolnenie-smoke-test"> çƒŸé›¾æµ‹è¯•å¡«å…… </h3><br><p> ä»¥å‰çš„æµ‹è¯•ä¼¼ä¹è¿˜ä¸æ˜¯ä¸€å¥—åˆç†çš„<code>smoke test</code> ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬æ²¡æœ‰è§¦æ‘¸æ•°æ®åº“ï¼Œä¹Ÿæ²¡æœ‰æ·»åŠ ä»»ä½•ä»»åŠ¡ã€‚ å½“ç„¶ï¼Œå¿…é¡»è¿›è¡Œ<code>smoke test</code> ã€‚ </p><br><p> è®©æˆ‘ä»¬æ·»åŠ ä¸€äº›è€ƒè™‘æ·»åŠ ä»»åŠ¡çš„æµ‹è¯•ï¼Œå¹¶å°†å…¶ä¸­ä¸€ä¸ªç”¨ä½œ<em>çƒŸé›¾</em>æµ‹è¯•å¥—ä»¶çš„ä¸€éƒ¨åˆ†ï¼š </p><br><blockquote>  <strong>ch2 / task_proj /æµ‹è¯•/ func / test_add.py</strong> </blockquote><br><pre> <code class="plaintext hljs">"""  API tasks.add ().""" import pytest import tasks from tasks import Task def test_add_returns_valid_id(): """tasks.add(valid task)    .""" # GIVEN an initialized tasks db # WHEN a new task is added # THEN returned task_id is of type int new_task = Task('do something') task_id = tasks.add(new_task) assert isinstance(task_id, int) @pytest.mark.smoke def test_added_task_has_id_set(): """,   task_id  tasks.add().""" # GIVEN an initialized tasks db # AND a new task is added new_task = Task('sit in chair', owner='me', done=True) task_id = tasks.add(new_task) # WHEN task is retrieved task_from_db = tasks.get(task_id) # THEN task_id matches id field assert task_from_db.id == task_id</code> </pre> <br><p> è¿™ä¸¤ä¸ªæµ‹è¯•åœ¨åˆå§‹åŒ–çš„ä»»åŠ¡æ•°æ®åº“ä¸Šéƒ½æœ‰GIVENæ³¨é‡Šï¼Œä½†æ˜¯æµ‹è¯•ä¸­æ²¡æœ‰åˆå§‹åŒ–çš„æ•°æ®åº“ã€‚ æˆ‘ä»¬å¯ä»¥å®šä¹‰å¤¹å…·æ¥åœ¨æµ‹è¯•ä¹‹å‰åˆå§‹åŒ–æ•°æ®åº“ï¼Œå¹¶åœ¨æµ‹è¯•ä¹‹åè¿›è¡Œæ¸…ç†ï¼š </p><br><blockquote>  <strong>ch2 / task_proj /æµ‹è¯•/ func / test_add.py</strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.fixture(autouse=True) def initialized_tasks_db(tmpdir): """Connect to db before testing, disconnect after.""" # Setup : start db tasks.start_tasks_db(str(tmpdir), 'tiny') yield #    # Teardown : stop db tasks.stop_tasks_db()</code> </pre> <br><p> æœ¬ç¤ºä¾‹ä¸­ä½¿ç”¨çš„å¤¹å…·tmpdiræ˜¯å†…ç½®å¤¹å…·ã€‚ æ‚¨å°†åœ¨ç¬¬71é¡µçš„ç¬¬4ç« ï¼Œå†…ç½®è£…ç½®ä¸­å­¦ä¹ æœ‰å…³å†…ç½®è£…ç½®çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¹¶åœ¨ç¬¬49é¡µçš„ç¬¬3ç« pytestè£…ç½®ä¸­å­¦ä¹ å¦‚ä½•ç¼–å†™è‡ªå·±çš„è£…ç½®ä»¥åŠå®ƒä»¬å¦‚ä½•å·¥ä½œï¼ŒåŒ…æ‹¬æ­¤å¤„ä½¿ç”¨çš„autouseå‚æ•°ã€‚ </p><br><p> æµ‹è¯•ä¸­ä½¿ç”¨çš„è‡ªåŠ¨ä½¿ç”¨æƒ…å†µè¡¨æ˜è¯¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰æµ‹è¯•éƒ½å°†ä½¿ç”¨fixtureã€‚ åœ¨æ¯æ¬¡æµ‹è¯•ä¹‹å‰æ‰§è¡Œ<code>yield</code>ä¹‹å‰çš„ä»£ç ï¼› æµ‹è¯•åæ‰§è¡Œ<code>yield</code>ä¹‹åçš„ä»£ç ã€‚ å¦‚æœéœ€è¦ï¼Œyieldå¯ä»¥å°†æ•°æ®è¿”å›åˆ°æµ‹è¯•ã€‚ åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæ‚¨å°†è€ƒè™‘æ‰€æœ‰è¿™äº›ä»¥åŠæ›´å¤šå†…å®¹ï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä»¥æŸç§æ–¹å¼é…ç½®æ•°æ®åº“ä»¥è¿›è¡Œæµ‹è¯•ï¼Œå› æ­¤æˆ‘ä¸å†éœ€è¦ç­‰å¾…ï¼Œè€Œæ˜¯å¿…é¡»å‘æ‚¨å±•ç¤ºè¯¥è®¾å¤‡ï¼ˆå½“ç„¶æ˜¯è®¾å¤‡ï¼ï¼‰ã€‚  ï¼ˆpytestè¿˜æ”¯æŒè€å¼çš„è®¾ç½®å’Œæ‹†å¸åŠŸèƒ½ï¼Œä¾‹å¦‚åœ¨<strong>unittest</strong>å’Œ<strong>é¼»å­ä¸­</strong>ä½¿ç”¨çš„åŠŸèƒ½ï¼Œä½†å¹¶ä¸é‚£ä¹ˆæœ‰è¶£ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ„Ÿå…´è¶£çš„è¯ï¼Œè¯·å‚è§ç¬¬183é¡µçš„é™„å½•5 xUnitå›ºå®šè£…ç½®ã€‚ï¼‰ </p><br><p> ç°åœ¨è®©æˆ‘ä»¬æ¨è¿Ÿå¯¹ç¯å…·çš„è®¨è®ºï¼Œç„¶åè½¬åˆ°é¡¹ç›®çš„å¼€å§‹å¹¶è¿è¡Œæˆ‘ä»¬çš„<em>çƒŸé›¾æµ‹è¯•å¥—ä»¶</em> ï¼š </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;cd .. (venv33) ...\bopytest-code\code\ch2\tasks_proj\tests&gt;cd .. (venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest -v -m "smoke" ============================= test session starts ============================= collected 56 items tests/func/test_add.py::test_added_task_has_id_set PASSED tests/func/test_api_exceptions.py::test_list_raises PASSED tests/func/test_api_exceptions.py::test_get_raises PASSED ============================= 53 tests deselected ============================= =================== 3 passed, 53 deselected in 0.49 seconds ===================</code> </pre> <br><p> å®ƒæ˜¾ç¤ºäº†æ¥è‡ªä¸åŒæ–‡ä»¶çš„æ ‡è®°æµ‹è¯•å¯ä»¥ä¸€èµ·è¿è¡Œã€‚ </p><br><h2 id="propusk-testov-skipping-tests"> è·³è¿‡æµ‹è¯• </h2><br><p> å°½ç®¡ç¬¬31é¡µçš„æ ‡è®°éªŒè¯æ–¹æ³•ä¸­è®¨è®ºçš„æ ‡è®°æ˜¯æ‚¨é€‰æ‹©çš„åç§°ï¼Œä½†æ˜¯pyteståŒ…å«ä¸€äº›æœ‰ç”¨çš„å†…ç½®æ ‡è®°ï¼š <code>skip</code> ï¼Œ <code>skipif</code>å’Œ<code>xfail</code> ã€‚ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†è®¨è®º<code>skip</code>å’Œ<code>skipif</code> ï¼Œä»¥åŠä¸‹ä¸€ä¸ª<code>-xfail</code> ã€‚ </p><br><p> ä½¿ç”¨<code>skip</code>å’Œ<code>skipif</code>å¯ä»¥è·³è¿‡ä¸éœ€è¦æ‰§è¡Œçš„æµ‹è¯•ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬ä¸çŸ¥é“<code>tasks.unique_id()</code>åº”è¯¥å¦‚ä½•å·¥ä½œã€‚ æ¯ä¸ªç”µè¯åº”è¿”å›ä¸åŒçš„å·ç ï¼Ÿ    ,       ? </p><br><p> -,    (,        <code>initialized_tasks_db</code> ;     ): </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_unique_id_1.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">"""Test tasks.unique_id().""" import pytest import tasks def test_unique_id(): """ unique_id ()     .""" id_1 = tasks.unique_id() id_2 = tasks.unique_id() assert id_1 != id_2</code> </pre> <br><p>    : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest test_unique_id_1.py ============================= test session starts ============================= collected 1 item test_unique_id_1.py F ================================== FAILURES =================================== _______________________________ test_unique_id ________________________________ def test_unique_id(): """Calling unique_id() twice should return different numbers.""" id_1 = tasks.unique_id() id_2 = tasks.unique_id() &gt; assert id_1 != id_2 E assert 1 != 1 test_unique_id_1.py:11: AssertionError ========================== 1 failed in 0.30 seconds ===========================</code> </pre> <br><p> å—¯  ,  .   API  ,  ,  docstring  """Return an integer that does not exist in the db.""",   <em>  ,     DB</em> .      .       ,   : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_unique_id_2.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.skip(reason='misunderstood the API') def test_unique_id_1(): """ unique_id ()     .""" id_1 = tasks.unique_id() id_2 = tasks.unique_id() assert id_1 != id_2 def test_unique_id_2(): """unique_id()    id.""" ids = [] ids.append(tasks.add(Task('one'))) ids.append(tasks.add(Task('two'))) ids.append(tasks.add(Task('three'))) #   id uid = tasks.unique_id() # ,        assert uid not in ids</code> </pre> <br><p>  ,   ,   ,   <code>@pytest..skip()</code>    . </p><br><p>  : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_unique_id_2.py ============================= test session starts ============================= collected 2 items test_unique_id_2.py::test_unique_id_1 SKIPPED test_unique_id_2.py::test_unique_id_2 PASSED ===================== 1 passed, 1 skipped in 0.19 seconds =====================</code> </pre> <br><p>  ,   -   ,       ,         0.2.0 .           skipif: </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_unique_id_3.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.skipif(tasks.__version__ &lt; '0.2.0', reason='not supported until version 0.2.0') def test_unique_id_1(): """ unique_id ()     .""" id_1 = tasks.unique_id() id_2 = tasks.unique_id() assert id_1 != id_2</code> </pre> <br><p> ,     <code>skipif()</code> ,      Python.   ,  ,    .      <em>skip</em> ,    <em>skipif</em> .     <em>skip</em> ,     <em>skipif</em> .      ( <em>reason</em> )   <em>skip</em> , <em>skipif</em>  <em>xfail</em> .    : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest test_unique_id_3.py ============================= test session starts ============================= collected 2 items test_unique_id_3.py s. ===================== 1 passed, 1 skipped in 0.20 seconds =====================</code> </pre> <br><p> <code>s.</code> ,     (skipped),    (passed).   ,    -  <code>-v</code> : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_unique_id_3.py ============================= test session starts ============================= collected 2 items test_unique_id_3.py::test_unique_id_1 SKIPPED test_unique_id_3.py::test_unique_id_2 PASSED ===================== 1 passed, 1 skipped in 0.19 seconds =====================</code> </pre> <br><p>       .        <code>-rs</code> : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -rs test_unique_id_3.py ============================= test session starts ============================= collected 2 items test_unique_id_3.py s. =========================== short test summary info =========================== SKIP [1] func\test_unique_id_3.py:8: not supported until version 0.2.0 ===================== 1 passed, 1 skipped in 0.22 seconds =====================</code> </pre> <br><p>  <code>-r chars</code>    : </p><br><pre> <code class="plaintext hljs">$ pytest --help ... -r chars show extra test summary info as specified by chars (     ,  ) (f)ailed, (E)error, (s)skipped, (x)failed, (X)passed, (p)passed, (P)passed with output, (a)all except pP. ...</code> </pre> <br><p>        ,           . </p><br><h2 id="markirovka-testov-ozhidayuschih-sboya">     </h2><br><p>    <code>skip</code>  <code>skipif</code>    ,   .    <code>xfail</code>   pytest   ,  ,    .     <code>unique_id ()</code> ,   <code>xfail</code> : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_unique_id_4.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.xfail(tasks.__version__ &lt; '0.2.0', reason='not supported until version 0.2.0') def test_unique_id_1(): """ unique_id()     .""" id_1 = tasks.unique_id() id_2 = tasks.unique_id() assert id_1 != id_2 @pytest.mark.xfail() def test_unique_id_is_a_duck(): """ xfail.""" uid = tasks.unique_id() assert uid == 'a duck' @pytest.mark.xfail() def test_unique_id_not_a_duck(): """ xpass.""" uid = tasks.unique_id() assert uid != 'a duck'</code> </pre> <br><p> Running this shows: </p><br><p>    ,   ,   <code>xfail</code> .         == vs.! =.      . </p><br><p>   : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest test_unique_id_4.py ============================= test session starts ============================= collected 4 items test_unique_id_4.py xxX. =============== 1 passed, 2 xfailed, 1 xpassed in 0.36 seconds ================</code> </pre> <br><p> X  XFAIL,   Â«  ( <em>expected to fail</em> )Â».  X   XPASS  Â«,    ,   ( <em>expected to fail but passed.</em> )Â». </p><br><p> <code>--verbose</code>    : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_unique_id_4.py ============================= test session starts ============================= collected 4 items test_unique_id_4.py::test_unique_id_1 xfail test_unique_id_4.py::test_unique_id_is_a_duck xfail test_unique_id_4.py::test_unique_id_not_a_duck XPASS test_unique_id_4.py::test_unique_id_2 PASSED =============== 1 passed, 2 xfailed, 1 xpassed in 0.36 seconds ================</code> </pre> <br><p>    <em>pytest</em> ,  ,  ,    <code>xfail</code> ,   FAIL.    <em>pytest.ini</em> : </p><br><pre> <code class="plaintext hljs">[pytest] xfail_strict=true</code> </pre> <br><p>    <em>pytest.ini</em>    6, ,  . 113. </p><br><h2 id="vypolnenie-podmnozhestva-testov">    </h2><br><p>    ,         â€‹â€‹    .       .        , ,          .      ,       .        .    . </p><br><h3 id="a-single-directory"> A Single Directory </h3><br><p>       ,      <em>pytest</em> : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest tests\func --tb=no ============================= test session starts ============================= collected 50 items tests\func\test_add.py .. tests\func\test_add_variety.py ................................ tests\func\test_api_exceptions.py ....... tests\func\test_unique_id_1.py F tests\func\test_unique_id_2.py s. tests\func\test_unique_id_3.py s. tests\func\test_unique_id_4.py xxX. ==== 1 failed, 44 passed, 2 skipped, 2 xfailed, 1 xpassed in 1.75 seconds =====</code> </pre> <br><p>     ,   <code>-v</code>      ,   . </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest -v tests\func --tb=no ============================= test session starts =============================</code> </pre> <br><p>  ... </p><br><pre> <code class="plaintext hljs">collected 50 items tests\func\test_add.py::test_add_returns_valid_id PASSED tests\func\test_add.py::test_added_task_has_id_set PASSED tests\func\test_add_variety.py::test_add_1 PASSED tests\func\test_add_variety.py::test_add_2[task0] PASSED tests\func\test_add_variety.py::test_add_2[task1] PASSED tests\func\test_add_variety.py::test_add_2[task2] PASSED tests\func\test_add_variety.py::test_add_2[task3] PASSED tests\func\test_add_variety.py::test_add_3[sleep-None-False] PASSED ... tests\func\test_unique_id_2.py::test_unique_id_1 SKIPPED tests\func\test_unique_id_2.py::test_unique_id_2 PASSED ... tests\func\test_unique_id_4.py::test_unique_id_1 xfail tests\func\test_unique_id_4.py::test_unique_id_is_a_duck xfail tests\func\test_unique_id_4.py::test_unique_id_not_a_duck XPASS tests\func\test_unique_id_4.py::test_unique_id_2 PASSED ==== 1 failed, 44 passed, 2 skipped, 2 xfailed, 1 xpassed in 2.05 seconds =====</code> </pre> <br><p>   ,      . </p><br><h3 id="odinochnyy-test-filemodule">   File/Module </h3><br><p>   ,  ,          pytest: </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch2/tasks_proj $ pytest tests/func/test_add.py =========================== test session starts =========================== collected 2 items tests/func/test_add.py .. ======================== 2 passed in 0.05 seconds =========================</code> </pre> <br><p>        . </p><br><h3 id="odinochnaya-testovaya-funkciya">    </h3><br><p>     ,  <code>::</code>    : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch2/tasks_proj $ pytest -v tests/func/test_add.py::test_add_returns_valid_id =========================== test session starts =========================== collected 3 items tests/func/test_add.py::test_add_returns_valid_id PASSED ======================== 1 passed in 0.02 seconds =========================</code> </pre> <br><p>  <code>-v</code> ,  ,    . </p><br><h3 id="odinochnyy-test-class">  Test Class </h3><br><p> Here's an example: </p><br><p>   â€”    ,     . <br> è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/</strong> <code>test_api_exceptions.py</code> </blockquote><br><pre> <code class="plaintext hljs">class TestUpdate(): """    tasks.update().""" def test_bad_id(self): """non-int id   excption.""" with pytest.raises(TypeError): tasks.update(task_id={'dict instead': 1}, task=tasks.Task()) def test_bad_task(self): """A non-Task task   excption.""" with pytest.raises(TypeError): tasks.update(task_id=1, task='not a task')</code> </pre> <br><p>      ,     <code>update()</code> ,     .     ,   ,        <code>::</code> ,      : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest -v tests/func/test_api_exceptions.py::TestUpdate ============================= test session starts ============================= collected 2 items tests\func\test_api_exceptions.py::TestUpdate::test_bad_id PASSED tests\func\test_api_exceptions.py::TestUpdate::test_bad_task PASSED ========================== 2 passed in 0.12 seconds ===========================</code> </pre> <br><h3 id="a-single-test-method-of-a-test-class"> A Single Test Method of a Test Class </h3><br><p>        ,     â€”     <code>::</code>   : </p><br><pre> <code class="plaintext hljs">$ cd /path/to/code/ch2/tasks_proj $ pytest -v tests/func/test_api_exceptions.py::TestUpdate::test_bad_id ===================== test session starts ====================== collected 1 item tests/func/test_api_exceptions.py::TestUpdate::test_bad_id PASSED =================== 1 passed in 0.03 seconds ===================</code> </pre> <br><blockquote> <strong> ,   </strong> <br><br> ,        , , ,      .   ,        <code>pytest -v</code> . </blockquote><br><h3 id="nabor-testov-na-osnove-bazovogo-imeni-testa">        </h3><br><p>  <code>-k</code>      ,         .       <code>and</code> , <code>or</code>  <code>not</code>  . ,        <code>_raises</code> : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest -v -k _raises ============================= test session starts ============================= collected 56 items tests/func/test_api_exceptions.py::test_add_raises PASSED tests/func/test_api_exceptions.py::test_list_raises PASSED tests/func/test_api_exceptions.py::test_get_raises PASSED tests/func/test_api_exceptions.py::test_delete_raises PASSED tests/func/test_api_exceptions.py::test_start_tasks_db_raises PASSED ============================= 51 tests deselected ============================= =================== 5 passed, 51 deselected in 0.54 seconds ===================</code> </pre> <br><p>    <code>and</code>  <code>not</code>    <code>test_delete_raises()</code>  : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj&gt;pytest -v -k "_raises and not delete" ============================= test session starts ============================= collected 56 items tests/func/test_api_exceptions.py::test_add_raises PASSED tests/func/test_api_exceptions.py::test_list_raises PASSED tests/func/test_api_exceptions.py::test_get_raises PASSED tests/func/test_api_exceptions.py::test_start_tasks_db_raises PASSED ============================= 52 tests deselected ============================= =================== 4 passed, 52 deselected in 0.44 seconds ===================</code> </pre> <br><p>     ,     , ,         <code>-k</code>     .     ,          ,         . </p><br><h2 id="parametrized-testing-parametrizovannoe-testirovanie"> [Parametrized Testing]:   </h2><br><p>         ,     ,       .                  .  -               pytest,  -    . </p><br><p>    ,     ,      <code>add()</code> : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">"""  API tasks.add().""" import pytest import tasks from tasks import Task def test_add_1(): """tasks.get ()  id,   add() works.""" task = Task('breathe', 'BRIAN', True) task_id = tasks.add(task) t_from_db = tasks.get(task_id) # ,  ,    assert equivalent(t_from_db, task) def equivalent(t1, t2): """   .""" #  ,   id return ((t1.summary == t2.summary) and (t1.owner == t2.owner) and (t1.done == t2.done)) @pytest.fixture(autouse=True) def initialized_tasks_db(tmpdir): """    ,  .""" tasks.start_tasks_db(str(tmpdir), 'tiny') yield tasks.stop_tasks_db()</code> </pre> <br><p>    tasks   <code>id</code>   <code>None</code> .           <code>id</code> .       <code>==</code> ,  ,        .   <code>equivalent()</code>  ,   <code>id</code> .  <code>autouse</code> ,  ,    .  ,   : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_1 ============================= test session starts ============================= collected 1 item test_add_variety.py::test_add_1 PASSED ========================== 1 passed in 0.69 seconds ===========================</code> </pre> <br><p>   .   ,      .  ,       ?  .    <code>@pytest.mark.parametrize(argnames, argvalues)</code>          , : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.parametrize('task', [Task('sleep', done=True), Task('wake', 'brian'), Task('breathe', 'BRIAN', True), Task('exercise', 'BrIaN', False)]) def test_add_2(task): """    .""" task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert equivalent(t_from_db, task)</code> </pre> <br><p>   <code>parametrize()</code> â€”        â€” 'task',   .   â€”   ,         Task. pytest               : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_2 ============================= test session starts ============================= collected 4 items test_add_variety.py::test_add_2[task0] PASSED test_add_variety.py::test_add_2[task1] PASSED test_add_variety.py::test_add_2[task2] PASSED test_add_variety.py::test_add_2[task3] PASSED ========================== 4 passed in 0.69 seconds ===========================</code> </pre> <br><p>  <code>parametrize()</code>    .      ,  ,      : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.parametrize('summary, owner, done', [('sleep', None, False), ('wake', 'brian', False), ('breathe', 'BRIAN', True), ('eat eggs', 'BrIaN', False), ]) def test_add_3(summary, owner, done): """    .""" task = Task(summary, owner, done) task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert equivalent(t_from_db, task)</code> </pre> <br><p>   ,        pytest,       ,      : </p><br><pre> <code class="plaintext hljs">(venv35) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_3 ============================= test session starts ============================= platform win32 -- Python 3.5.2, pytest-3.5.1, py-1.5.3, pluggy-0.6.0 -- cachedir: ..\.pytest_cache rootdir: ...\bopytest-code\code\ch2\tasks_proj\tests, inifile: pytest.ini collected 4 items test_add_variety.py::test_add_3[sleep-None-False] PASSED [ 25%] test_add_variety.py::test_add_3[wake-brian-False] PASSED [ 50%] test_add_variety.py::test_add_3[breathe-BRIAN-True] PASSED [ 75%] test_add_variety.py::test_add_3[eat eggs-BrIaN-False] PASSED [100%] ========================== 4 passed in 0.37 seconds ===========================</code> </pre> <br><p>  ,      ,     pytest,    : </p><br><pre> <code class="plaintext hljs">(venv35) c:\BOOK\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_3[sleep-None-False] ============================= test session starts ============================= test_add_variety.py::test_add_3[sleep-None-False] PASSED [100%] ========================== 1 passed in 0.22 seconds ===========================</code> </pre> <br><p>   ,     : </p><br><pre> <code class="plaintext hljs">(venv35) c:\BOOK\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v "test_add_variety.py::test_add_3[eat eggs-BrIaN-False]" ============================= test session starts ============================= collected 1 item test_add_variety.py::test_add_3[eat eggs-BrIaN-False] PASSED [100%] ========================== 1 passed in 0.56 seconds ===========================</code> </pre> <br><p>      ,        : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">tasks_to_try = (Task('sleep', done=True), Task('wake', 'brian'), Task('wake', 'brian'), Task('breathe', 'BRIAN', True), Task('exercise', 'BrIaN', False)) @pytest.mark.parametrize('task', tasks_to_try) def test_add_4(task): """ .""" task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert equivalent(t_from_db, task)</code> </pre> <br><p>      .     : </p><br><pre> <code class="plaintext hljs">(venv35) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_4 ============================= test session starts ============================= collected 5 items test_add_variety.py::test_add_4[task0] PASSED [ 20%] test_add_variety.py::test_add_4[task1] PASSED [ 40%] test_add_variety.py::test_add_4[task2] PASSED [ 60%] test_add_variety.py::test_add_4[task3] PASSED [ 80%] test_add_variety.py::test_add_4[task4] PASSED [100%] ========================== 5 passed in 0.34 seconds ===========================</code> </pre> <br><p>      ,     .    ,      ids  <code>parametrize()</code> ,          .  <code>ids</code>       ,     . ,         <code>tasks_to_try</code> ,       : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">task_ids = ['Task({},{},{})'.format(t.summary, t.owner, t.done) for t in tasks_to_try] @pytest.mark.parametrize('task', tasks_to_try, ids=task_ids) def test_add_5(task): """Demonstrate ids.""" task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert equivalent(t_from_db, task)</code> </pre> <br><p>     ,   : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::test_add_5 ============================= test session starts ============================= collected 5 items test_add_variety.py::test_add_5[Task(sleep,None,True)] PASSED test_add_variety.py::test_add_5[Task(wake,brian,False)0] PASSED test_add_variety.py::test_add_5[Task(wake,brian,False)1] PASSED test_add_variety.py::test_add_5[Task(breathe,BRIAN,True)] PASSED test_add_variety.py::test_add_5[Task(exercise,BrIaN,False)] PASSED ========================== 5 passed in 0.45 seconds ===========================</code> </pre> <br><p>        : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v "test_add_variety.py::test_add_5[Task(exercise,BrIaN,False)]" ============================= test session starts ============================= collected 1 item test_add_variety.py::test_add_5[Task(exercise,BrIaN,False)] PASSED ========================== 1 passed in 0.21 seconds ===========================</code> </pre> <br><p>       ;          shell.     <code>parametrize()</code>  .               : </p><br><blockquote> <strong>ch2/tasks_proj/tests/func/ <code>test_add_variety.py</code></strong> </blockquote><br><pre> <code class="plaintext hljs">@pytest.mark.parametrize('task', tasks_to_try, ids=task_ids) class TestAdd(): """   .""" def test_equivalent(self, task): """ ,   .""" task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert equivalent(t_from_db, task) def test_valid_id(self, task): """          .""" task_id = tasks.add(task) t_from_db = tasks.get(task_id) assert t_from_db.id == task_id</code> </pre> <br><p>    : </p><br><pre> <code class="plaintext hljs">(venv33) ...\bopytest-code\code\ch2\tasks_proj\tests\func&gt;pytest -v test_add_variety.py::TestAdd ============================= test session starts ============================= collected 10 items test_add_variety.py::TestAdd::test_equivalent[Task(sleep,None,True)] PASSED test_add_variety.py::TestAdd::test_equivalent[Task(wake,brian,False)0] PASSED test_add_variety.py::TestAdd::test_equivalent[Task(wake,brian,False)1] PASSED test_add_variety.py::TestAdd::test_equivalent[Task(breathe,BRIAN,True)] PASSED test_add_variety.py::TestAdd::test_equivalent[Task(exercise,BrIaN,False)] PASSED test_add_variety.py::TestAdd::test_valid_id[Task(sleep,None,True)] PASSED test_add_variety.py::TestAdd::test_valid_id[Task(wake,brian,False)0] PASSED test_add_variety.py::TestAdd::test_valid_id[Task(wake,brian,False)1] PASSED test_add_variety.py::TestAdd::test_valid_id[Task(breathe,BRIAN,True)] PASSED test_add_variety.py::TestAdd::test_valid_id[Task(exercise,BrIaN,False)] PASSED ========================== 10 passed in 1.16 seconds ==========================</code> </pre> <br><p>     ,            <code>@pytest.mark.parametrize()</code> .       <code>pytest.param(&lt;value\&gt;, id="something")</code> : </p><br><p>  : </p><br><pre> <code class="plaintext hljs">(venv35) ...\bopytest-code\code\ch2\tasks_proj\tests\func $ pytest -v test_add_variety.py::test_add_6 ======================================== test session starts ========================================= collected 3 items test_add_variety.py::test_add_6[just summary] PASSED [ 33%] test_add_variety.py::test_add_6[summary\owner] PASSED [ 66%] test_add_variety.py::test_add_6[summary\owner\done] PASSED [100%] ================================ 3 passed, 6 warnings in 0.35 seconds ================================</code> </pre> <br><p>  ,  <code>id</code>       . </p><br><h2 id="uprazhneniya"> ç»ƒä¹ é¢˜ </h2><br><ol><li>     , <code>task_proj</code> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-  </a>  ,         <code>pip install /path/to/tasks_proj</code> . </li><li>   . </li><li>  <em>pytest</em>   . </li><li>  <em>pytest</em>   ,  <code>tasks_proj/tests/func</code> .  pytest     ,     .     .  ,    ? </li><li>  xfail      ,     pytest   tests    . </li><li>      <code>tasks.count()</code> ,   .    API  ,     ,  ,    . </li><li>          ?       <code>test_api_exceptions.py</code> . ,      . (   <code>api.py</code>   .) </li></ol><br><h2 id="chto-dalshe"> æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆ </h2><br><p>         <em>pytest</em> . ,   ,   ,       .         <code>initialized_tasks_db</code> .     /        . </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»–ä»¬è¿˜å¯ä»¥åˆ†éš”é€šç”¨ä»£ç ï¼Œä»¥ä¾¿å¤šä¸ªæµ‹è¯•åŠŸèƒ½å¯ä»¥ä½¿ç”¨ç›¸åŒçš„è®¾ç½®ã€‚</font><font style="vertical-align: inherit;">åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæ‚¨å°†æ·±å…¥ç ”ç©¶pytestç¯å…·çš„ç¾å¥½ä¸–ç•Œã€‚</font></font></p><br><p><img src="https://habrastorage.org/webt/jl/jn/bb/jljnbbjr-ejh473xy_eccsmknpk.png">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿”å›</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹ä¸€ä¸ª</a> <img src="https://habrastorage.org/webt/rw/dy/-g/rwdy-grsvbpcetjttrmecdkxtlk.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN448788/">https://habr.com/ru/post/zh-CN448788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN448776/index.html">RxVMS-é€‚ç”¨äºFlutteråº”ç”¨ç¨‹åºçš„å®ç”¨æ¶æ„</a></li>
<li><a href="../zh-CN448778/index.html">ä¸ºVisual Studio Enterprise 2019å¼•å…¥æ—¶é—´æ—…è¡Œè°ƒè¯•</a></li>
<li><a href="../zh-CN448780/index.html">ä»€ä¹ˆä½¿è½¯ä»¶å¯ä»¥èµšé’±</a></li>
<li><a href="../zh-CN448782/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ pytestå…¥é—¨ï¼Œç¬¬1ç« </a></li>
<li><a href="../zh-CN448786/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ ç¬¬3ç« pytestå›ºå®šè£…ç½®</a></li>
<li><a href="../zh-CN448790/index.html">SpaceVIL-ç”¨äºåœ¨.Net Coreï¼Œ.Net Standardå’ŒJVMä¸Šå¼€å‘çš„è·¨å¹³å°GUIæ¡†æ¶</a></li>
<li><a href="../zh-CN448796/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ é…ç½®ï¼Œç¬¬6ç« </a></li>
<li><a href="../zh-CN448798/index.html">ä½¿ç”¨pytestè¿›è¡ŒPythonæµ‹è¯•ã€‚ å°†pytestä¸å…¶ä»–å·¥å…·ç»“åˆä½¿ç”¨ï¼Œç¬¬7ç« </a></li>
<li><a href="../zh-CN448800/index.html">ä½¿ç”¨.vsconfigåœ¨æ•´ä¸ªç»„ç»‡ä¸­é…ç½®Visual Studio</a></li>
<li><a href="../zh-CN448802/index.html">å…³äºé—¨æˆ·ç½‘ç«™çš„æ€è€ƒï¼šåœ¨è™šå¹»å¼•æ“4ä¸­åˆ›å»ºé—¨æˆ·ç½‘ç«™</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>