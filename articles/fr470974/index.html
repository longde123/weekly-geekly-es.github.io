<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíµ üë®üèª‚Äçüöí üë©üèæ‚Äçüè´ DNS passif entre les mains de l'analyste üö© ü¶ó üëêüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le syst√®me de noms de domaine (DNS) est une sorte d'annuaire t√©l√©phonique qui traduit des noms conviviaux, tels que ¬´ussc.ru¬ª, en adresses IP. √âtant d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DNS passif entre les mains de l'analyste</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470974/"><p>  Le syst√®me de noms de domaine (DNS) est une sorte d'annuaire t√©l√©phonique qui traduit des noms conviviaux, tels que ¬´ussc.ru¬ª, en adresses IP.  √âtant donn√© que l'activit√© DNS est pr√©sente dans presque toutes les sessions de communication, quel que soit le protocole.  Ainsi, la journalisation DNS est une source de donn√©es pr√©cieuse pour un sp√©cialiste de la s√©curit√© de l'information, lui permettant de d√©tecter des anomalies ou d'obtenir des donn√©es suppl√©mentaires sur le syst√®me √† l'√©tude. </p><br><p> En 2004, Florian Weimer a propos√© une telle m√©thode de journalisation en tant que DNS passif, qui vous permet de restaurer l'historique des modifications des donn√©es DNS avec la possibilit√© d'indexer et de rechercher, ce qui peut donner acc√®s aux donn√©es suivantes: </p><br><ul><li>  Nom de domaine </li><li>  Adresse IP du nom de domaine demand√© </li><li>  Date et heure de la r√©ponse </li><li>  Type de r√©ponse </li><li>  etc. </li></ul><br><p>  Les donn√©es pour le DNS passif sont collect√©es √† partir de serveurs DNS r√©cursifs avec des modules int√©gr√©s ou en interceptant les r√©ponses des serveurs DNS responsables de la zone. </p><br><img src="https://habrastorage.org/webt/zt/vg/gj/ztvggj6s1bxlduk5nfyw7cv0dy4.png" alt="image"><br><p>  <i>Figure 1. DNS passif (extrait de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ctovision.com</a> )</i> </p><a name="habracut"></a><br><p>  La particularit√© du DNS passif est qu'il n'est pas n√©cessaire d'enregistrer l'adresse IP du client, ce qui contribue √† prot√©ger la confidentialit√© des utilisateurs. </p><br><p>  √Ä l'heure actuelle, il existe de nombreux services qui permettent d'acc√©der aux donn√©es DNS passives: </p><br><div class="scrollable-table"><table><tbody><tr><th></th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DNSDB</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VirusTotal</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Passivetotal</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Poulpe</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Securitytrails</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Parapluie Enqu√™ter</a> </th></tr><tr><td>  <b>Compagnie</b> </td><td>  S√©curit√© prospective </td><td>  VirusTotal </td><td>  Riskisk </td><td>  SafeDNS </td><td>  Securitytrails </td><td>  Cisco </td></tr><tr><td>  <b>Acc√®s</b> </td><td>  Sur demande </td><td>  Aucune inscription requise </td><td>  Inscription gratuite </td><td>  Sur demande </td><td>  Aucune inscription requise </td><td>  Sur demande </td></tr><tr><td>  <b>API</b> </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td></tr><tr><td>  <b>Disponibilit√© client</b> </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est pr√©sent </td><td>  Est manquant </td><td>  Est manquant </td><td>  Est manquant </td></tr><tr><td>  <b>Commencer la collecte de donn√©es</b> </td><td>  2010 ann√©e </td><td>  2013 ann√©e </td><td>  2009 ann√©e </td><td>  Affiche uniquement les 3 derniers mois </td><td>  2008 ann√©e </td><td>  2006 ann√©e </td></tr></tbody></table></div><br><p>  <i>Tableau 1. Services avec acc√®s aux donn√©es DNS passives</i> </p><br><h4>  Options d'utilisation du DNS passif </h4><br><p>  √Ä l'aide du DNS passif, vous pouvez √©tablir des connexions entre les noms de domaine, les serveurs NS et les adresses IP.  Cela vous permet de construire des cartes des syst√®mes √©tudi√©s et de suivre les changements dans une telle carte de la premi√®re d√©tection au moment actuel. </p><br><p>  Le DNS passif facilite √©galement la d√©tection des anomalies de trafic.  Par exemple, le suivi des modifications dans les zones NS et les enregistrements tels que A et AAAA vous permet d'identifier les sites malveillants √† l'aide de la m√©thode de flux rapide, qui est con√ßue pour cacher C&amp;C de la d√©tection et du blocage.  √âtant donn√© que les noms de domaine l√©gitimes (√† l'exception de ceux utilis√©s pour l'√©quilibrage de charge) ne changeront pas souvent leurs adresses IP, et la plupart des zones l√©gitimes changent rarement leurs serveurs NS. </p><br><p>  Le DNS passif, contrairement √† l'√©num√©ration directe des sous-domaines dans les dictionnaires, vous permet de trouver m√™me les noms de domaine les plus exotiques, par exemple, ¬´222qmxacaiqaaaaazibq4aaidhmbqaaa0undefined7140c0.p.hoff.ru¬ª.  En outre, il vous permet parfois de trouver des zones de test (et vuln√©rables) d'un site Web, du mat√©riel pour les d√©veloppeurs, etc. </p><br><h4>  Examen des liens des e-mails √† l'aide du DNS passif </h4><br><p>  √Ä l'heure actuelle, le spam est l'un des principaux moyens par lesquels un attaquant p√©n√®tre dans l'ordinateur de la victime ou vole des informations confidentielles.  Essayons d'examiner le lien d'une telle lettre en utilisant le DNS passif pour √©valuer l'efficacit√© de cette m√©thode. </p><br><img src="https://habrastorage.org/webt/ok/er/po/okerponr7oatd6mmgunqldthynk.jpeg" alt="image"><br><p>  <i>Figure 2. Courriel de spam</i> </p><br><p>  Le lien de cette lettre conduit au site magnit-boss.rocks, qui propose de collecter automatiquement les bonus et de recevoir de l'argent: </p><br><img src="https://habrastorage.org/webt/f2/i9/cc/f2i9ccb3lrwvrrkkzzcu-tnmxtk.png" alt="image"><br><p>  <i>Figure 3. La page h√©berg√©e sur magnit-boss.rocks</i> </p><br><p>  Pour √©tudier ce site, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'API Riskiq a</a> √©t√© utilis√©e, qui compte d√©j√† 3 clients pr√™ts √† l'emploi en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ruby</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rust</a> . </p><br><p>  Tout d'abord, nous allons d√©couvrir toute l'histoire de ce nom de domaine, pour cela nous utilisons la commande: </p><br><p>  <i>pt-client pdns --query magnit-boss.rocks</i> </p><br><p>  Cette commande affichera des informations sur toutes les r√©solutions DNS associ√©es √† ce nom de domaine. </p><br><img src="https://habrastorage.org/webt/m4/wn/f6/m4wnf6telpyggxepwd3fwcqlros.png" alt="image"><br><p>  <i>Figure 4. R√©ponse de l'API Riskiq</i> </p><br><p>  Apportons la r√©ponse de l'API √† une forme plus visuelle: </p><br><img src="https://habrastorage.org/webt/fi/jh/dp/fijhdp0-c8csxrlyejytmcydgr4.png" alt="image"><br><p>  <i>Figure 5. Tous les enregistrements de la r√©ponse</i> </p><br><p>  Pour de plus amples recherches, des adresses IP ont √©t√© prises pour lesquelles ce nom de domaine a √©t√© r√©solu au moment de la r√©ception de la lettre 01.08.2019, ces adresses IP sont les adresses 92.119.113.112 et 85.143.219.65 suivantes. </p><br><p>  Utilisation de la commande: </p><br><p>  <i>pt-client pdns --query</i> </p><br><p>  Vous pouvez obtenir tous les noms de domaine associ√©s √† ces adresses IP. <br>  L'adresse IP 92.119.113.112 poss√®de 42 noms de domaine uniques r√©solus en cette adresse IP, parmi lesquels il existe de tels noms: </p><br><ul><li>  magnit-boss.club </li><li>  igrovie-avtomaty.me </li><li>  pro-x-audit.xyz </li><li>  zep3-www.xyz </li><li>  et autres </li></ul><br><p>  L'adresse IP 85.143.219.65 poss√®de 44 noms de domaine uniques r√©solus en cette adresse IP, parmi lesquels il existe de tels noms: </p><br><ul><li>  cvv2.name (site de vente de donn√©es de carte de cr√©dit) </li><li>  emaills.world </li><li>  www.mailru.space </li><li>  et autres </li></ul><br><p>  Les connexions avec ces noms de domaine sugg√®rent l'hame√ßonnage, mais nous croyons en de bonnes personnes, nous allons donc essayer d'obtenir un bonus de 332 501,72 roubles?  Apr√®s avoir cliqu√© sur le bouton "OUI", le site nous demande de transf√©rer 300 roubles de la carte pour d√©verrouiller le compte et nous envoie sur as-torpay.info pour saisir les donn√©es. </p><br><img src="https://habrastorage.org/webt/em/ng/e-/emnge-q11hjwa-v_km4fekbv5xc.png" alt="image"><br><p>  <i>Figure 6. Page d'accueil Ac-pay2day.net</i> </p><br><p>  Il ressemble √† un site l√©gal, il existe un certificat https, et la page principale propose de connecter ce syst√®me de paiement √† votre site, mais, h√©las, tous les liens vers la connexion ne fonctionnent pas.  Ce nom de domaine se r√©sout √† 1 seule adresse IP - 190.115.19.74.  √Ä son tour, il a 1475 noms de domaine uniques qui ont r√©solu cette adresse IP, y compris des noms tels que: </p><br><ul><li>  ac-pay2day.net </li><li>  ac-payfit.com </li><li>  as-manypay.com </li><li>  fletkass.net </li><li>  as-magicpay.com </li><li>  et autres </li></ul><br><p>  Comme nous pouvons le voir, le DNS passif vous permet de collecter rapidement et efficacement des donn√©es sur la ressource enqu√™t√©e et m√™me de cr√©er une sorte d'empreinte digitale qui vous permet de r√©v√©ler tout un sch√©ma de vol de donn√©es personnelles, de sa r√©ception au point de vente probable. </p><br><img src="https://habrastorage.org/webt/z_/wc/bc/z_wcbcwwi8zvjfp8zu7eyqbsrik.png" alt="image"><br><p>  <i>Figure 7. Carte du syst√®me √©tudi√©</i> </p><br><p>  Tout n'est pas aussi rose que nous le souhaiterions.  Par exemple, de telles enqu√™tes peuvent facilement se briser sur CloudFlare ou des services similaires.  Et l'efficacit√© de la base de donn√©es est tr√®s d√©pendante du nombre de requ√™tes DNS passant par le module pour collecter des donn√©es DNS passives.  N√©anmoins, le DNS passif est une source d'informations suppl√©mentaires pour le chercheur. </p><br><p>  <em>Auteur: sp√©cialiste du Centre de l'Oural pour les syst√®mes de s√©curit√©</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr470974/">https://habr.com/ru/post/fr470974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr470954/index.html">Installez Zimbra OSE 8.8.15 et Zextras Suite Pro sur Ubuntu 18.04 LTS</a></li>
<li><a href="../fr470958/index.html">Les sondes de vitalit√© √† Kubernetes peuvent √™tre dangereuses</a></li>
<li><a href="../fr470962/index.html">JSConf Budapest 2019</a></li>
<li><a href="../fr470964/index.html">Jouets en bois - inscriptions</a></li>
<li><a href="../fr470966/index.html">Mot de passe Unix de Ken Thompson</a></li>
<li><a href="../fr470976/index.html">Song of Ice (Bloody Enterprise) et Flames (DevOps et IaC)</a></li>
<li><a href="../fr470978/index.html">√âtude de march√© des analystes: o√π √©tudient-ils, quels outils utilisent-ils et combien gagnent-ils</a></li>
<li><a href="../fr470980/index.html">Les t√¢ches que les robots logiciels (RPA) r√©solvent dans le secteur bancaire</a></li>
<li><a href="../fr470982/index.html">Analyse des validations et des demandes d'extraction dans Travis CI, Buddy et AppVeyor √† l'aide de PVS-Studio</a></li>
<li><a href="../fr470984/index.html">Analyse des validations et des demandes d'extraction dans Travis CI, Buddy et AppVeyor √† l'aide de PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>