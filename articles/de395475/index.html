<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊🏾 👰🏼 👂🏽 4x4x4 LED RGB Würfel zur Musikvisualisierung 👂🏾 🕴🏽 💪🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel werden wir über die Erfahrungen beim Zusammenbau eines 4x4x4-Würfels auf RGB-LEDs sowie über die Entwicklung von Software sprechen, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>4x4x4 LED RGB Würfel zur Musikvisualisierung</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395475/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In diesem Artikel werden wir über die Erfahrungen beim Zusammenbau eines 4x4x4-Würfels auf RGB-LEDs sowie über die Entwicklung von Software sprechen, die erforderlich ist, um den Würfel als Visualisierer für Klang zu verwenden. </font><font style="vertical-align: inherit;">Der Mikrocontroller Arduino Uno wird verwendet.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8cc/708/0d1/8cc7080d1fde4dbd84bcb9c5c290e27d.png" height="500" alt="Bild"></div><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorbereitung</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Würfel</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bei der Untersuchung solcher Projekte wurde eine </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementierung namens „Charliecube“</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entdeckt, </font><font style="vertical-align: inherit;">die von Asher Glick und Kevin Baker verfasst wurde. </font><font style="vertical-align: inherit;">Diese Option ist insofern bemerkenswert, als sie im Gegensatz zu anderen Implementierungen keine Zähler, Schieberegister oder andere Komponenten zum Aufbau des Würfels zum Zweck seiner nachfolgenden Programmierung vorsieht und nur 16 Ausgänge des Mikrocontrollers verwendet (wobei 64 LEDs adressiert werden können). </font><font style="vertical-align: inherit;">Im Zentrum dieser Implementierung steht das Design der LED-Anzeige Charliplexing.</font></font><br>
<br>
<h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliplexing</font></font></h6><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die digitalen Ausgänge der Mikrocontroller haben eine dreistellige Logik: an die Stromversorgung angeschlossen, an die „Masse“ angeschlossen und an nichts angeschlossen. </font><font style="vertical-align: inherit;">Wenn wir die LED anzünden müssen, müssen Sie "+" auf X und "-" auf "Y" anwenden. Nur in diesem Fall leuchtet sie auf. </font><font style="vertical-align: inherit;">Wenn Y nichts zugeführt wird, leuchtet die LED nicht auf. </font><font style="vertical-align: inherit;">Weitere </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zur Methode finden Sie </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">in einem gleichnamigen Wikipedia-Artikel.</font></a><font style="vertical-align: inherit;"> Die Beschreibung der Arbeit speziell in unserem Fall finden Sie weiter unten.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/8c1/71f/223/8c171f223d194bfdac112c6896cf7abc.jpg" alt="Bild"></div><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED-</font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Spaltenlayout Angenommen, wir möchten LED1 grün leuchten lassen. </font><font style="vertical-align: inherit;">Wenn wir der blauen Linie folgen, ist es klar, dass es notwendig ist, "+" auf Eingang 1 anzuwenden. Nachdem wir der roten Linie gefolgt sind, verstehen wir, dass wir "-" auf Eingang 3 anwenden müssen. Den anderen Eingängen wird nichts zugeführt.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualisierung</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wurde beschlossen, die gesamte Musikanalyse auf einem mit dem Cube verbundenen PC durchzuführen. </font><font style="vertical-align: inherit;">Die Hauptidee: Der PC analysiert den Tonaufzeichnungskanal, wandelt den Ton in Frequenzinformationen um und überträgt die Musikrhythmusdaten an das Arduino. Außerdem hebt der auf diesen Informationen basierende Mikrocontroller bestimmte LEDs hervor. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Autoren des Projekts über umfangreiche Erfahrungen mit Ruby verfügen, möchte ich im Rahmen des Projekts auf diese Programmiersprache zurückgreifen. </font><font style="vertical-align: inherit;">Es wurde ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artikel von</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> David Guttman </font><font style="vertical-align: inherit;">entdeckt </font><font style="vertical-align: inherit;">, der die Visualisierung von Sound auf JRuby mit dem Rubin-Verarbeitungsjuwel und der Minim-Java-Bibliothek beschreibt. </font><font style="vertical-align: inherit;">Der gefundene Artikel wurde als Grundlage für das Schreiben eines Visualisierers verwendet.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Montage</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sammle die Spalte</font></font></h5><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/99a/910/37f/99a91037fe654e86b8a5e3a36c78fbdc.jpg" height="500" alt="Bild"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vor dem Anschließen der LEDs an die Säule muss bei jeder der vier LEDs die Beine so gebogen werden, dass jedes Bein um 90 ° benachbart ist. </font></font><br>
<br>
<img src="https://habrastorage.org/files/558/7ff/cc9/5587ffcc91684ddf98f128cf2b2b5028.png" width="475" alt="Bild"><img src="https://habrastorage.org/files/c4e/f7d/88e/c4ef7d88ea9d433f8ba764f1bd0859ed.jpg" width="475" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann muss jede der LEDs der Reihe nach um 90 ° gedreht werden (jede nachfolgende LED sollte relativ zur vorherigen um 90 ° im Uhrzeigersinn gedreht werden). </font><font style="vertical-align: inherit;">Zuvor konnte eines der Beine markiert werden (wir haben es mit grünem Lack markiert), um nicht verwirrt zu werden. </font></font><br>
<br>
<img src="https://habrastorage.org/files/c4e/f7d/88e/c4ef7d88ea9d433f8ba764f1bd0859ed.jpg" width="475" alt="Bild"><img src="https://habrastorage.org/files/748/2ad/fef/7482adfefcf9456991d3bb2d7cba0068.png" width="475" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir verbinden unsere LEDs in einer Spalte. </font><font style="vertical-align: inherit;">Nach dem Anschließen der LEDs schneiden wir die hervorstehenden Enden der Beine ab.</font></font><br>
<br>
<img src="https://habrastorage.org/files/7ec/381/295/7ec38129539b42e58d97d31688bc2e21.png" alt="Bild"><img src="https://habrastorage.org/files/376/e60/636/376e606368b84aae84fc1bbe79cfde31.png" alt="Bild"><img src="https://habrastorage.org/files/22a/18f/0d0/22a18f0d04e44fd2814877cab41678f1.png" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/files/df5/eac/786/df5eac7864b64c9887342f2ed5ebe86a.jpg" width="470" alt="Bild"> <img src="https://habrastorage.org/files/d98/76f/c7d/d9876fc7d5a64a4b8e7d20ed347f3f83.jpg" width="470" alt="Bild"><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir platzieren die Spalten</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die verbleibenden 15 Spalten werden auf die gleiche Weise gesammelt.</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6aa/0a2/5f7/6aa0a25f73eb40df874abf6779df7f42.jpg" height="500" alt="Bild"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Säulen werden im gleichen Abstand voneinander auf der Platine platziert und bilden so einen Würfel mit einer Seite von 4 LEDs. </font><font style="vertical-align: inherit;">Alle Pfosten sollten in die gleiche Richtung gedreht werden (eine vorläufige Markierung des „Stützbeins“ ist hier sehr nützlich).</font></font><br>
<br>
<img src="https://habrastorage.org/files/4a1/894/e89/4a1894e899454363bbcd37cdf1fac2b3.png" width="470" alt="Bild"> <img src="https://habrastorage.org/files/40f/0ba/b12/40f0bab12a1542628f924e87df170699.png" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/files/f94/e05/c5c/f94e05c5c01448498a5ad5487b83b4cf.jpg" width="470" alt="Bild"> <img src="https://habrastorage.org/files/1d6/2f5/a4b/1d62f5a4ba234b1f836334f9e9407375.jpg" width="470" alt="Bild"><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir verbinden die Säulen miteinander</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Drehen Sie die Struktur um und beginnen Sie, die Drähte anzuschließen. </font><font style="vertical-align: inherit;">Insgesamt gibt es 16 Drähte, die Verbindung wurde in 4 Stufen durchgeführt.</font></font><br>
<br>
<img src="https://habrastorage.org/files/e91/f53/d2e/e91f53d2e9f243a1afae139abfba6bed.png" width="470" alt="Bild"><img src="https://habrastorage.org/files/816/918/c4f/816918c4f19a4a6babe7cac6ea9c7ad8.jpg" width="470" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/files/d89/32b/b25/d8932bb25a4b435dba018d9c2554d51d.png" width="470" alt="Bild"><img src="https://habrastorage.org/files/2e6/8dc/bcd/2e68dcbcd92a45d8a26c4dcca8c4615a.jpg" width="470" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/files/28f/d81/65b/28fd8165b85c4b5c86708d809811c534.png" width="470" alt="Bild"><img src="https://habrastorage.org/files/703/7ef/517/7037ef5175aa4d90b4f0069aca659af3.jpg" width="470" alt="Bild"><br>
<br>
<img src="https://habrastorage.org/files/625/d44/a47/625d44a47e3444f08dd89a0e8eb402ab.png" width="470" alt="Bild"><img src="https://habrastorage.org/files/82c/c83/575/82cc83575e184f759f4204a4148fe7c1.jpg" width="470" alt="Bild"><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/36b/a9c/89f/36ba9c89f0d24475be59427d24df4bb7.jpg" height="500" alt="Bild"></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es bleibt eine Verbindung zum Arduino - und Sie können mit der Programmierung beginnen.</font></font><br>
<br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stellen Sie eine Verbindung zu Arduino her</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Charlikub-Autoren haben die Cubeplex-Bibliothek für die bequeme Cube-Programmierung mit dem Arduino bereitgestellt. </font><font style="vertical-align: inherit;">Damit diese Bibliothek ohne Änderungen verwendet werden kann, müssen unsere Drähte in der folgenden Reihenfolge angeschlossen werden (die Nummerierung entspricht den Drähten in den Bildern aus dem vorherigen Abschnitt):</font></font><br>
<br>
<img src="https://habrastorage.org/files/b5f/6d6/34e/b5f6d634e3344e5d912eb0ae2b268f3b.png" alt="Bild"> <img src="https://habrastorage.org/files/cf3/763/270/cf3763270b574d20b9eb7f5b7be3feef.png" width="470" alt="Bild"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino programmieren</font></font></h4><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grundfunktionalität</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie oben erwähnt, verwendeten die Autoren die Charlieplex-Bibliothek, die eine drawLed () -Funktion bereitstellt, die die Farbe und Position der LED in XYZ-Koordinaten akzeptiert.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Markieren Sie den gesamten Würfel rot</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"cubeplex.h"</span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cubeSides = <span class="hljs-number"><span class="hljs-number">4</span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  initCube();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ 
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; xpos &lt; cubeSides; xpos++) {
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">0</span></span>; ypos &lt; cubeSides; ypos++) {
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; zpos &lt; cubeSides; zpos++) {<font></font>
          drawLed(red, xpos, ypos, zpos);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PC-Nachrichten</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Messaging wird über serielle E / A an den Port implementiert, über den die Steuerung eine Verbindung zum Computer herstellt. </font><font style="vertical-align: inherit;">Die Arbeit mit solchen Ereignissen wird in Arduino über </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SerialEvent implementiert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Benutzerdefinierte Cube-Hervorhebung mit Benutzereingaben</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"cubeplex.h"</span></span></span></span><font></font>
<font></font>
String inputString = <span class="hljs-string"><span class="hljs-string">""</span></span>;         <font></font>
boolean stringComplete = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        SerialEvent,       inputString.</span></span>
<span class="hljs-comment"><span class="hljs-comment">//     Enter,    inputComplete      loop().</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> color = red;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  inputString.reserve(<span class="hljs-number"><span class="hljs-number">200</span></span>);<font></font>
  initCube();<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stringComplete) {<font></font>
      Serial.println(inputString);<font></font>
      drawString(inputString);<font></font>
      resetBuffer();<font></font>
      inputString = <span class="hljs-string"><span class="hljs-string">""</span></span>;<font></font>
      stringComplete = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Serial.available()) {
    <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> inChar = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)Serial.read();<font></font>
    inputString += inChar;<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inChar == <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) {<font></font>
      stringComplete = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ;       .</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resetBuffer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  flushBuffer();<font></font>
  clearBuffer();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//      .</span></span>
<span class="hljs-comment"><span class="hljs-comment">//   -     ,    .</span></span>
<span class="hljs-comment"><span class="hljs-comment">//    "000001002003"     { x: 0, y: 0 }.</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String inputString)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">-1</span></span>;<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; inputString[i + <span class="hljs-number"><span class="hljs-number">3</span></span>]; i += <span class="hljs-number"><span class="hljs-number">3</span></span>) {<font></font>
    xpos = charToInt(inputString[i]);<font></font>
    ypos = charToInt(inputString[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]);<font></font>
    zpos = charToInt(inputString[i + <span class="hljs-number"><span class="hljs-number">2</span></span>]);<font></font>
<font></font>
    drawLed(color, xpos, ypos, zpos);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">charToInt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (value - <span class="hljs-string"><span class="hljs-string">'0'</span></span>);<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmierung für Unterhaltungsmusik</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wird angenommen, dass der Würfel im Takt der Musik blinkt. </font><font style="vertical-align: inherit;">Dementsprechend kann das Nachrichtenformat auf eine Ziffer vereinfacht werden. </font><font style="vertical-align: inherit;">Der Algorithmus lautet wie folgt: Sobald der Musikanalysator den Beat "fängt", sollte der Würfel vollständig aufleuchten. </font><font style="vertical-align: inherit;">Danach geht der Würfel langsam aus (Schicht für Schicht). </font><font style="vertical-align: inherit;">Sobald der Analysator die nächste Messung erfasst, leuchtet der Würfel wieder vollständig auf. </font><font style="vertical-align: inherit;">Das heißt, es reicht aus, eine Figur auf den Würfel zu übertragen: Wie viele Ebenen müssen momentan hervorgehoben werden? </font><font style="vertical-align: inherit;">Außerdem bestimmen wir bei jeder Iteration zufällig eine neue Farbe.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Markieren Sie eine bestimmte Anzahl von Ebenen</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawBeat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String inputString)</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> height = charToInt(inputString[<span class="hljs-number"><span class="hljs-number">0</span></span>]);
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> color = random(red, white);<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; xpos &lt; cubeSides; xpos++) {
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = <span class="hljs-number"><span class="hljs-number">0</span></span>; ypos &lt; cubeSides; ypos++) {
      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zpos = <span class="hljs-number"><span class="hljs-number">0</span></span>; zpos &lt; height; zpos++) {<font></font>
          drawLed(color, xpos, ypos, zpos);<font></font>
      }<font></font>
    }<font></font>
  }<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Klanganalyse auf JRuby</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Minim-Bibliotheksset enthält die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BeatDetect-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klasse </font><font style="vertical-align: inherit;">, die Tools zum Bestimmen des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Musikrhythmus</font></a><font style="vertical-align: inherit;"> bereitstellt. </font><font style="vertical-align: inherit;">Im Allgemeinen ist es mit dieser Bibliothek äußerst einfach, eine Verbindung zum Tonempfangskanal herzustellen und dessen Frequenzanalyse durchzuführen. </font><font style="vertical-align: inherit;">Für unsere Zwecke wurde die Frequenzmethode zur Bestimmung des Rhythmus entwickelt. </font></font><br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Code wurde unter Ubuntu 15.10 getestet. </font><font style="vertical-align: inherit;">Version </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der JRuby</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , vom Autor selbst </font><font style="vertical-align: inherit;">benutzt - jruby 9.0.5.0. </font><font style="vertical-align: inherit;">Um das Skript auszuführen, müssen Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Processing</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> installieren </font><font style="vertical-align: inherit;">und die </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Minim-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bibliothek verbinden </font><font style="vertical-align: inherit;">.</font></font></i><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rhythmusanalyse</font></font></b><div class="spoiler_text"><pre><code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'ruby-processing'</span></span><font></font>
<font></font>
require_relative <span class="hljs-string"><span class="hljs-string">'translator'</span></span>
require_relative <span class="hljs-string"><span class="hljs-string">'serial_writer'</span></span><font></font>
<font></font>
<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SoundProcessor</span></span></span><span class="hljs-class"> &lt; Processing::App</span></span>
  load_library <span class="hljs-string"><span class="hljs-string">"minim"</span></span>
  import <span class="hljs-string"><span class="hljs-string">"ddf.minim"</span></span>
  import <span class="hljs-string"><span class="hljs-string">"ddf.minim.analysis"</span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span></span>
    @minim = Minim.new <span class="hljs-keyword"><span class="hljs-keyword">self</span></span><font></font>
    @input = @minim.get_line_in<font></font>
    @beat = BeatDetect.new @input.mix.size, <span class="hljs-number"><span class="hljs-number">44100</span></span>
    @beat_value = <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">001</span></span>
    @beat.set_sensitivity <span class="hljs-number"><span class="hljs-number">300</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span></span><font></font>
    process_beat<font></font>
    SerialWriter.instance.write(Translator.instance.translate(@beat_value))<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
  private<font></font>
<font></font>
  <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_beat</span></span></span></span><font></font>
    @beat.detect @input.mix<font></font>
    @beat_value = @beat.is_kick ? <span class="hljs-number"><span class="hljs-number">1</span></span> : @beat_value * <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">95</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
SoundProcessor.new<font></font>
</code></pre><br>
</div></div><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeitsdemonstration</font></font></h4><br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.youtube.com/embed/mXcTGpfKSxo%3Ffeature%3Doembed&amp;usg=ALkJrhgezy_fIoWX8r_Kn8razdkMM9rIJg" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mittels PulseAudio wurde dem Visualisierer ein Audioausgang als Audioeingang zugewiesen, d.h. </font><font style="vertical-align: inherit;">Wir erhalten eine Visualisierung aller Geräusche, die aus den Lautsprechern kommen. </font><font style="vertical-align: inherit;">Nach der Aufnahme wurde der Ton dem Video überlagert, das zum Zeitpunkt der Erstellung des Films wiedergegeben wurde.</font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachwort</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wir haben es geschafft, einen Sound Visualizer in Verbindung mit einem PC zu bekommen. </font><font style="vertical-align: inherit;">In Zukunft können Sie den Algorithmus zur Bestimmung des Rhythmus verbessern (Standardwerkzeuge zur Bestimmung des Rhythmus der Minim-Bibliothek sind alles andere als ideal), und Informationen zu Frequenzen können auch in den Cube ausgegeben werden. </font><font style="vertical-align: inherit;">Wie Sie sehen können, ist ein Würfel einfach zu erstellen und zu programmieren. </font><font style="vertical-align: inherit;">Darüber hinaus werden nur wenige Komponenten verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Referenzen:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliecube - Asher Glick</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charliplexing - Wikipedia</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie mit Ruby - David Guttman in 7 Schritten einen Musikvisualisierer</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code für Arduino</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualizer-Code</font></font></a></li>
</ul><br>
<br>
<i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Autoren</font></font></i><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Makoed Victor und Eugene Kunitsa, Studenten der BSUiR Naval Forces im 3. Jahr</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de395475/">https://habr.com/ru/post/de395475/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de395465/index.html">Microsoft zahlte 10.000 US-Dollar für ein problematisches Upgrade des PCs eines Benutzers auf Windows 10</a></li>
<li><a href="../de395467/index.html">Fragen Sie Ethan Nr. 62: Die größte Spiralgalaxie</a></li>
<li><a href="../de395469/index.html">Der Vorfall in den Wolken (Geschichte)</a></li>
<li><a href="../de395471/index.html">Edward Snowden lebt ein freies Leben - wie ein Roboter</a></li>
<li><a href="../de395473/index.html">Moscow Geek Picknick: Atlasbericht</a></li>
<li><a href="../de395477/index.html">Projekt "Auge". Das Ende</a></li>
<li><a href="../de395479/index.html">VR-Geräte sind für die Augen vorteilhafter als normale Bildschirme</a></li>
<li><a href="../de395481/index.html">Smart Ring Nimb von Mitbegründer KermlinRussia erschien auf Kickstarter</a></li>
<li><a href="../de395485/index.html">Wissenschaftler haben den Start des HGP-Schreibprojekts angekündigt, dessen letztendliches Ziel die Schaffung eines vollständigen synthetischen menschlichen Genoms ist</a></li>
<li><a href="../de395487/index.html">DIY FPV Renndrohne (Teil 2) - Setup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>